<div class='sheet-row'>
    <div class='sheet-col'>
        <h2>General Information</h2>
    	Name: <input type="text" name="attr_name" /> Race: <input type="text" name="attr_metatype" /><br />
		Sex: <input type="text" name="attr_sex" style='width:100px;' /> Age: <input type="number" name="attr_age" />
        Height: <input type='number' name='attr_height' style='width:46px' />cm
        Weight: <input type='number' name='attr_weight' step='0.01' style='width:60px' />kg
	</div>
</div>
<ul class='tabs'>
    <li>
        <input type='radio' name='tabs' id='tab-basics' CHECKED />
        <label for='tab-basics'>Basic Information</label>
        <div class='tab-content'>
            <div class='sheet-3colrow'>
                <div class='sheet-col'>
                    <h2>Attributes</h2>
                    <table>
                        <tr>
                            <td></td>
                            <td style='text-align:center'><h3>Natural</h3></td>
                            <td><h3>Augmented</h3></td>
                        </tr>
                        <tr>
                            <td>
                		        Body
                            </td>
                            <td>
                                <input type="number" name="attr_body" value=1 min=1 style='width:39px;' />
                                <button type="roll" class="d6-dice" name="roll_body_test" title="Body Test without cyber-/bio- ware" value="&{template:attrib} {{attribname=Body (Natural)}} {{attribtest= [[ [[@{body} + ?{How many dice are you taking from your pool?|0}]]d6>[[?{What is the Target Number?} + @{stun_pen} + @{wound_pen}]]!! ]] }}"></button>
                            </td>
                            <td style='text-align:center'>
                                <input type="number" name="attr_body_max" value=1 min=1 style='width:39px;' />
                                <button type="roll" class="d6-dice" name="roll_augment_body_test" title="Body Test with cyber-/bio- ware" value="&{template:attrib} {{attribname=Body (Augmented)}} {{attribtest= [[ [[@{body|max} + ?{How many dice are you taking from your pool?|0}]]d6>[[?{What is the Target Number?} + @{stun_pen} + @{wound_pen}]]!! ]] }}"></button>
                            </td>
                        </tr>
                        <tr>
                            <td>
                		        Quickness
                            </td>
                            <td>
                                <input type="number" name="attr_agility" value=1 min=1 style='width:39px;' />
                                <button type="roll" class="d6-dice" name="roll_quick_test" title="Quickness Test without cyber-/bio- ware" value="&{template:attrib} {{attribname=Quickness Test (Natural)}} {{attribtest= [[ [[@{agility} + ?{How many dice are you taking from your pool?|0}]]d6>[[?{What is the Target Number?} + @{stun_pen} + @{wound_pen}]]!! ]] }}"></button>
                            </td>
                            <td style='text-align:center'>
                                <input type="number" name="attr_agility_max" value=1 min=1 style='width:39px;' />
                                <button type="roll" class="d6-dice" name="roll_augment_quick_test" title="Quickness Test with cyber-/bio- ware" value="&{template:attrib} {{attribname=Quickness (Augmented)}} {{attribtest= [[ [[@{agility|max} + ?{How many dice are you taking from your pool?|0}]]d6>[[?{What is the Target Number?} + @{stun_pen} + @{wound_pen}]]!! ]] }}"></button>
                            </td>
                        </tr>
                        <tr>
                            <td>
                		        Strength
                            </td>
                            <td>
                                <input type="number" name="attr_strength" value=1 min=1 style='width:39px;' />
                                <button type="roll" class="d6-dice" name="roll_strength_test" title="Strength Test without cyber-/bio- ware" value="&{template:attrib} {{attribname=Strength (Natural)}} {{attribtest= [[ [[@{strength} + ?{How many dice are you taking from your pool?|0}]]d6>[[?{What is the Target Number?} + @{stun_pen} + @{wound_pen}]]!! ]] }}"></button><br />
                            </td>
                            <td style='text-align:center'>
                                <input type="number" name="attr_strength|max" value=1 min=1 style='width:39px;' />
                                <button type="roll" class="d6-dice" name="roll_augment_str_test" title="Strength Test with cyber-/bio- ware" value="&{template:attrib} {{attribname=Strength (Augmented)}} {{attribtest= [[ [[@{strength|max} + ?{How many dice are you taking from your pool?|0}]]d6>[[?{What is the Target Number?} + @{stun_pen} + @{wound_pen}]]!! ]] }}"></button>
                            </td>
                        </tr>
                        <tr>
                            <td>
                		        Charisma
                            </td>
                            <td>
                                <input type="number" name="attr_Charisma" value=1 min=1 style='width:39px;' />
                                <button type="roll" class="d6-dice" name="roll_cha_test" title="Charisma Test without cyber-/bio- ware" value="&{template:attrib} {{attribname=Charisma (Natural)}} {{attribtest= [[ [[@{Charisma} + ?{How many dice are you taking from your pool?|0}]]d6>[[?{What is the Target Number?} + @{stun_pen} + @{wound_pen}]]!! ]] }}"></button><br />
                            </td>
                            <td style='text-align:center'>
                                <input type="number" name="attr_Charisma_max" value=1 min=1 style='width:39px;' />
                                <button type="roll" class="d6-dice" name="roll_augment_cha_test" title="Charisma Test with cyber-/bio- ware" value="&{template:attrib} {{attribname=Charisma (Augmented)}} {{attribtest= [[ [[@{Charisma|max} + ?{How many dice are you taking from your pool?|0}]]d6>[[?{What is the Target Number?} + @{stun_pen} + @{wound_pen}]]!! ]] }}"></button>
                            </td>
                        </tr>
                        <tr>
                            <td>
                		        Intelligence
                            </td>
                            <td>
                                <input type="number" name="attr_intelligence" value=1 min=1 style='width:39px;' />
                                <button type="roll" class="d6-dice" name="roll_int_test" title="Intelligence Test without cyber-/bio- ware" value="&{template:attrib} {{attribname=Intelligence (Natural)}} {{attribtest= [[ [[@{intelligence} + ?{How many dice are you taking from your pool?|0}]]d6>[[?{What is the Target Number?} + @{stun_pen} + @{wound_pen}]]!! ]] }}"></button><br />
                            </td>
                            <td style='text-align:center'>
                                <input type="number" name="attr_intelligence_max" value=1 min=1 style='width:39px;' />
                                <button type="roll" class="d6-dice" name="roll_augment_int_test" title="Intelligence Test with cyber-/bio- ware" value="&{template:attrib} {{attribname=Intelligence (Augmented)}} {{attribtest= [[ [[@{intelligence|max} + ?{How many dice are you taking from your pool?|0}]]d6>[[?{What is the Target Number?} + @{stun_pen} + @{wound_pen}]]!! ]] }}"></button>
                            </td>
                        </tr>
                        <tr>
                            <td>
                		        Willpower
                            </td>
                            <td>
                                <input type="number" name="attr_willpower" value=1 min=1 style='width:39px;' />
                                <button type="roll" class="d6-dice" name="roll_will_test"  title="Willpower Test without cyber-/bio- ware" value="&{template:attrib} {{attribname=Willpower (Natural)}} {{attribtest= [[ [[@{willpower} + ?{How many dice are you taking from your pool?|0}]]d6>[[?{What is the Target Number?} + @{stun_pen} + @{wound_pen}]]!! ]] }}"></button><br />
                            </td>
                            <td style='text-align:center'>
                                <input type="number" name="attr_willpower_max" value=1 min=1 style='width:39px;' />
                                <button type="roll" class="d6-dice" name="roll_augment_will_test" title="Willpower Test with cyber-/bio- ware" value="&{template:attrib} {{attribname=Willpower (Augmented)}} {{attribtest= [[ [[@{willpower|max} + ?{How many dice are you taking from your pool?|0}]]d6>[[?{What is the Target Number?} + @{stun_pen} + @{wound_pen}]]!! ]] }}"></button>
                            </td>
                        </tr>
                        <tr>
                            <td>
                		        Essence
                            </td>
                            <td colspan=2>
                                <input type="number" name="attr_essence" value=6 step='0.01' min='0.01' style='width:55px' />
                                <button type="roll" class="d6-dice" name="roll_essence_test" title="Essence Test" value="&{template:attrib} {{attribname=Essence}} {{attribtest= [[ [[floor(@{essence}) + ?{How many dice are you taking from your pool?|0}]]d6>[[?{What is the Target Number?} + @{stun_pen} + @{wound_pen}]]!! ]] }}"></button><br />
                            </td>
                        </tr>
                        <tr>
                            <td>
                		        Magic
                            </td>
                            <td colspan=2>
                                <input type="number" name="attr_magic" style='width:39px;' />
                                <button type="roll" class="d6-dice" name="roll_magic_test" title="Magic Test" value="&{template:attrib} {{attribname=Magic}} {{attribtest= [[ [[@{magic} + ?{How many dice are you taking from your pool?|0}]]d6>[[?{What is the Target Number?} + @{stun_pen} + @{wound_pen}]]!! ]] }}"></button>
                            </td>
                        </tr>
                    </table>
                </div>
            	<div class='sheet-col'>
                    <br />REACTION<br />
            		<input type="number" name="attr_reaction" value=1 min=1 /><button type="roll" class="d6-dice" name="roll_reaction_test" title="Reaction Test without cyber-/bio- ware" value="&{template:attrib} {{attribname=Reaction (Natural)}} {{attribtest= [[ [[@{reaction} + ?{How many dice are you taking from your pool?|0}]]d6>[[?{What is the Target Number?} + @{stun_pen} + @{wound_pen}]]!! ]] }}"></button>
                    <input type="number" name="attr_reaction_max" value=1 min=1 /><button type="roll" class="d6-dice" name="roll_augment_reaction_test" title="Reaction Test with cyber-/bio- ware" value="&{template:attrib} {{attribname=Reaction (Augmented)}} {{attribtest= [[ [[@{reaction|max} + ?{How many dice are you taking from your pool?|0}]]d6>[[?{What is the Target Number?} + @{stun_pen} + @{wound_pen}]]!! ]] }}"></button><br />
            		INITIATIVE<br />
            		<input type="number" name="attr_initiative" value=1 min=1 />d6<button type="roll" class="d6-dice" name="roll_initiative" title="Initiative Roll without cyber-/bio- ware" value="&{template:init} {{type=Initiative Roll (Natural)}} {{character=@{character_name}}} {{roll=[[@{initiative}d6+@{reaction}-@{stun_pen}-@{wound_pen} &{tracker}]]}}"></button>
                    <input type="number" name="attr_initiative_max" value=1 min=1 />d6<button type="roll" class="d6-dice" name="roll_augment_initiative" title="Initiative Roll with cyber-/bio- ware" value="&{template:init} {{type=Initiative Roll (Augmented)}} {{character=@{character_name}}} {{roll=[[@{initiative|max}d6+@{reaction|max}-@{stun_pen}-@{wound_pen} &{tracker}]]}}"></button>
            	</div>
                <div class='sheet-col'>
                	<h2>Karma</h2>
            		Karma Pool: <input type="number" name="attr_karma_pool" value=1 />/<input type="number" name="attr_karma_pool_max" value=1 /><br />
            		Good Karma: <input type="number" name="attr_good_karma" value=0 />
            	</div>
            </div><br />
            <div class='sheet-row'>
            	<div class='sheet-col'>
            		<h2>Condition Monitor</h2>
            		<table style='text-align:center;vertical-align:top;' cellpadding=5>
            			<tr>
            				<td></td>
            				<td>Uninjured</td>
            				<td>Light Stun</td>
            				<td>Moderate Stun</td>
            				<td>Serious Stun</td>
            				<td>Unconscious</td>
            			</tr><tr>
            				<td>
            					Stun:<input type='number' name='attr_stun_pen' value=0 style='display:none' />
            				</td><td>
            					<input type="radio" name="attr_stun" value=0 CHECKED>
            				</td><td>
            					<input type="radio" name="attr_stun" value=1>
            					<input type="radio" name="attr_stun" value=2>
            				</td><td>
            					<input type="radio" name="attr_stun" value=3>
            					<input type="radio" name="attr_stun" value=4>
            					<input type="radio" name="attr_stun" value=5>
            				</td><td>
            					<input type="radio" name="attr_stun" value=6>
            					<input type="radio" name="attr_stun" value=7>
            					<input type="radio" name="attr_stun" value=8>
            					<input type="radio" name="attr_stun" value=9>
            				</td><td>
            					<input type="radio" name="attr_stun" value=10>
            				</td>
            			</tr><tr>
            				<td>
            				Physical:<input type='number' name='attr_wound_pen' value=0 style='display:none' />
            				</td><td>
            					<input type="radio" name="attr_wounds" value=0 CHECKED>
            				</td><td>
            					<input type="radio" name="attr_wounds" value=1>
            					<input type="radio" name="attr_wounds" value=2>
            				</td><td>
            					<input type="radio" name="attr_wounds" value=3>
            					<input type="radio" name="attr_wounds" value=4>
            					<input type="radio" name="attr_wounds" value=5>
            				</td><td>
            					<input type="radio" name="attr_wounds" value=6>
            					<input type="radio" name="attr_wounds" value=7>
            					<input type="radio" name="attr_wounds" value=8>
            					<input type="radio" name="attr_wounds" value=9>
            				</td><td>
            					<input type="radio" name="attr_wounds" value=10>
            				</td>
            			</tr><tr>
            				<td></td>
            				<td>Uninjured</td>
            				<td>Light Wound</td>
            				<td>Moderate Wound</td>
            				<td>Serious Wound</td>
            				<td>Unconscious<br />
            				maybe dead</td>
            			</tr>
            		</table>
            		PHYSICAL DAMAGE OVERFLOW: <input type="number" name="attr_overflow" value=0 min=0 />
            	</div>
            </div><br />
            <div class='sheet-2colrow'>
            	<div class='sheet-col'>
            		<h2>Skills</h2>
            		<table>
                        <tr>
                            <td width=212>Name</td>
                            <td width=50>Rating</td>
                            <td width=31></td>
                            <td style='text-align:center;width:31px;'>G</td>
                            <td style='text-align:center;width:31px;'>R</td>
                            <td style='text-align:center;width:31px;'>M</td>
                        </tr>
                    </table>
            		<fieldset class="repeating_skills">
                        <input type="text" name="attr_skillname" />
                        <input type="number" name="attr_skillrating" min=1 />
                        <button type="roll" class="d6-dice" name='roll_skill' title='Roll Generic Skill Test' value='&{template:skill} {{skillname=@{skillname}}} {{skilltest= [[ {[[@{skillrating} + ?{How many dice are you taking from your pool?|0}]]d6>[[?{What is the Target Number?} + @{stun_pen} + @{wound_pen}]]!!} ]] }}'></button>
                        <button type="roll" class="d6-dice" name='roll_skill_gen' title='Roll Skill Test with General Roll Info' value='&{template:skill} {{skillname=@{skillname} Test}} {{skilltest= [[ {[[@{skillrating} + ?{How many dice are you taking from your pool?|0}]]d6>@{generalTN}!!} ]] }}'></button>
                        <button type="roll" class="d6-dice" name='roll_skill_range' title='Roll Ranged Attack' value='&{template:default} {{name=@{skillname} Test}} {{ Success Test = [[ {@{skillrating}d6>@{rangedTN}!!} ]] }} {{ Pool Dice = [[ {?{How many dice are you taking from your pool?|0}d6>@{rangedTN}!!} ]] }}'></button>
                        <button type="roll" class="d6-dice" name='roll_skill_melee' title='Roll Melee Attack' value='&{template:default} {{name=@{skillname} Test}} {{ Success Test = [[ {@{skillrating}d6>@{meleeTN}!!} ]] }} {{ Pool Dice = [[ {?{How many dice are you taking from your pool?|0}d6>@{meleeTN}!!} ]] }}'></button>
            		</fieldset>
            	</div>
            	<div class='sheet-col'>
            		<h2>Dice Pools</h2>
            		<table>
                	    <tr>
                            <td width=130></td><td width=57>
                                Available
                            </td><td>
                                Max
                            </td>
                	    </tr>
                        <tr>
                            <td style='text-align:right'>
                                Combat Pool
                            </td><td>
                                <input type="number" name="attr_combat" value=1 min=0 /> /
                            </td><td>
                                <input type="number" name="attr_combat_max" value=1 min=1 />
                            </td>
                        </tr>
            		</table>
            		<fieldset class="repeating_pools">
            			<input type="text" name="attr_poolname" style='width:100px;' /> Pool <input type="number" name="attr_pool" value=1 min=1 /> / <input type="number" name="attr_pool_maxx" value=1 />
            		</fieldset><br />
            		<h2>Armour</h2>
                    Dermal <input type="number" name='attr_dermalarmour' value=0 min=0 />
                    Pain Resistance <input type='number' name='attr_pain_res' value=0 min=0 max=9 />
            		<fieldset class="repeating_armour">
            			<input type="text" name="attr_armourname" style='width:245px' /><br />
            			B<input type="number" name="attr_balistic" value=0 min=0 />
                        <button type="roll" class="d6-dice" name='roll_resist_balistic' title='Resist Damage with Balistic Armor, such as getting shot' value="&{template:damageresist} {{type=Balistic Armor}} {{roll= [[ [[@{body|max} + @{dermalarmour}]]d6>[[(2+ (?{What is the attack's power?|4} - @{balistic}) + abs(2 - (?{What is the attack's power?|4} - @{balistic})))/2]]!! ]]}} {{poolroll= [[ [[?{How many dice are you taking from your pool?|0}]]d6>[[(2+ (?{What is the attack's power?|4} - @{balistic}) + abs(2 - (?{What is the attack's power?|4} - @{balistic})))/2]]!! ]]}}"></button>
                        <button type="roll" class="d6-dice" name='roll_resist_half_balistic' title='Resist Damage with Half Balistic Armor, such as APDS ammo' value="&{template:damageresist} {{type=Half of Balistic Armor}} {{roll= [[ [[@{body|max} + @{dermalarmour}]]d6>[[(2+ (?{What is the attack's power?|4} - floor(@{balistic}/2)) + abs(2 - (?{What is the attack's power?|4} - floor(@{balistic}/2))))/2]]!! ]]}} {{poolroll= [[ [[?{How many dice are you taking from your pool?|0}]]d6>[[(2+ (?{What is the attack's power?|4} - floor(@{balistic}/2)) + abs(2 - (?{What is the attack's power?|4} - floor(@{balistic}/2))))/2]]!! ]]}}"></button>
            			I<input type="number" name="attr_impact" value=0 min=0 />
                        <button type="roll" class="d6-dice" name='roll_resist_impact' title='Resist Damage with Impact Armor, such as melee attachs' value="&{template:damageresist} {{type=Impact Armor}} {{roll= [[ [[@{body|max} + @{dermalarmour}]]d6>[[(2+ (?{What is the attack's power?|4} - @{impact}) + abs(2 - (?{What is the attack's power?|4} - @{impact})))/2]]!! ]]}} {{poolroll= [[ [[?{How many dice are you taking from your pool?|0}]]d6>[[(2+ (?{What is the attack's power?|4} - @{impact}) + abs(2 - (?{What is the attack's power?|4} - @{impact})))/2]]!! ]]}}"></button>
                        <button type="roll" class="d6-dice" name='roll_resist_half_impact' title='Resist Damage with Half Balistic Armor, such as damagin manipulation spells' value="&{template:damageresist} {{type=Half of Impact Armor}} {{roll= [[ [[@{body|max} + @{dermalarmour}]]d6>[[(2+ (?{What is the attack's power?|4} - floor(@{impact}/2)) + abs(2 - (?{What is the attack's power?|4} - floor(@{impact}/2))))/2]]!! ]]}} {{poolroll= [[ [[?{How many dice are you taking from your pool?|0}]]d6>[[(2+ (?{What is the attack's power?|4} - floor(@{impact}/2)) + abs(2 - (?{What is the attack's power?|4} - floor(@{impact}/2))))/2]]!! ]]}}"></button>
            		</fieldset>
            	</div>
            </div><br />
            <div class='sheet-2colrow'>
                <div class='sheet-col'>
                    <h2>Edges</h2>
                    <fieldset class='repeating_edges'>
                        <input type='text' name='attr_edgename' style='width:200px' /> <input type='number' name='attr_edgecost' min=1 />
                        <textarea style='width:300px' name='attr_edgedesc'></textarea>
                    </fieldset>
                </div>
                <div class='sheet-col'>
                    <h2>Flaws</h2>
                    <fieldset class='repeating_flaws'>
                        <input type='text' name='attr_flawname' style='width:200px' /> <input type='number' name='attr_flawcost' max='-1' />
                        <textarea style='width:300px' name='attr_flawdesc'></textarea>
                    </fieldset>
                </div>
            </div>
        </div>
    </li>
    <li>
        <input type='radio' name='tabs' id='tab-gear' />
        <label for='tab-gear'>Contacts, and Gear</label>
        <div class='tab-content'>
            <div class='sheet-2colrow'>
                <div class='sheet-col'>
            		<h2>Cyberware</h2>
            		<table>
                        <tr>
                            <td width='210px'>Name</td>
                            <td width='46px'>Rating</td>
                            <td>Essence Cost</td>
                        </tr>    
            		</table>
            		<fieldset class="repeating_cyberware">
            			<input type="text" name="attr_cyberware" /><input type="number" name="attr_cyberrating" />
                        <input type='number' name='attr_essencecost' step='0.01' width='55px' />
            		</fieldset>
            	</div>
                <div class="sheet-col">
                	<h2>Contacts</h2>
            		<fieldset class="repeating_contacts">
            			<select name="attr_contacttype">
            				<option SELECTED>Contact</option>
            				<option>Buddy</option>
            				<option>Gang</option>
            				<option>Followers</option>
            			</select>
            			<textarea name="attr_contactdetail" style='width:275px;height:50px'>Detail</textarea>
            		</fieldset>
            	</div>
            </div><br />
            <div class="sheet-row">
            	<div class="sheet-col">
            		<h2>Weapons</h2>
                    <table>
                        <tr>
                            <td style='width:160px;'>Name</td>
                            <td style='width:54px'>Type</td>
                            <td style='width:50px'>Conceal</td>
                            <td style='width:44px'>Reach</td>
                            <td style='width:76px'>Mode</td>
                            <td style='width:93px;text-align:center;'>Short</td>
                            <td style='width:98px;text-align:center;'>Medium</td>
                            <td style='width:105px;text-align:center;'>Long</td>
                            <td style='width:110px;text-align:center;'>Extreme</td>
                        </tr>
                    </table>
                    <table>
                        <tr>
                            <td style='width:63px'>Ammo</td>
                            <td style='width:70px'>Damage</td>
                            <td>Notes</td>
                        </tr>
                    </table>
            		<fieldset class="repeating_weapons">
            			<input type="text" name="attr_weaponname" style='width:160px' /> <input type="text" name="attr_weapontype" style='width:50px' />
            			<input type="number" name="attr_concealability" /> <input type="number" name="attr_reach" min=0 />
            			<input type="text" name="attr_mode" style='width:75px' /> <input type="number" name="attr_shortrange" min=0 style='width:40px' /> -
            			<input type="number" name="attr_shortrange_max" min=1 style='width:40px' /> <input type="number" name="attr_medrange" min=2  style='width:40px' /> -
            			<input type="number" name="attr_medrange_max" min=3 style='width:46px' /> <input type="number" name="attr_longrange" min=4 style='width:46px' /> -
            			<input type="number" name="attr_longrange_max" min=5 style='width:46px' /> <input type="number" name="attr_extrange" min=6 style='width:46px' /> -
            			<input type="number" name="attr_extrange_max" min=7 style='width:53px' /><br />
                        <input type="text" name="attr_ammo" style='width:45px' />
                        <input type="number" name="attr_weaponpower" min=2 style="width:40px" /><select name='attr_weapondmg'>
                			<option SELECTED>L</option>
            				<option>M</option>
            				<option>S</option>
            				<option>D</option>
            			</select> 
            			<textarea name="attr_weaponnotes" style='width:300px;height:50px;'></textarea>
            		</fieldset>
            	</div>
            </div><br />
            <div class="sheet-2colrow">
            	<div class="sheet-col">
            		<h2>Gear</h2>
                    Legal Credstick:<input type='number' name='attr_money' value=0 style='width:100px;' />¥
                    <fieldset class='repeating_credsticks'>
                        Rating <input type='number' name='attr_credrate' min=1 /> Credstick:<input type='number' name='attr_credmoney' value=0 style='width:100px;' />¥
                    </fieldset>
            		<table>
                	    <tr>
                            <td style='width:212px;'>Item</td>
                            <td style='width:50px'>Rating</td>
                            <td>Weight</td>
                	    </tr>
            		</table>
            		<fieldset class="repeating_gear">
            			<input type="text" name="attr_item" /> <input type="number" name="attr_itemrating" />
            			<input type="number" name="attr_wt" step='0.1' /><button type="roll" class="d6-dice" name="roll_use_item" title="Use Item" value="&{template:default} {{name=@{item}}} {{ Success Test = [[ {@{itemrating}d6>?{What is the Target Number?}!!} ]] }}"></button>
            		</fieldset>
            	</div>
            	<div class="sheet-col">
            		<h2>Cyberdeck</h2>
            		<fieldset class="repeating_deck">
                        <table>
                            <tr>
                                <td>Model</td>
                                <td><input type="text" name="attr_deck" /></td>
                                <td></td>
                            </tr><tr>
                                <td></td><td></td><td style='text-align:right;'><h4>Condition</h4></td>
                            </tr><tr>
                                <td></td>
                                <td><h4>RATING</h4></td>
                                <td style='text-align:right;'><h4>Monitor</h4></td>
                            </tr><tr>
                        		<td>Persona</td>
                                <td><input type="number" name="attr_persona" /></td>
                                <td style='text-align:right;'>Crash><input type="radio" name="attr_deckcond" /></td>
                            </tr><tr>
                        		<td>Hardening</td>
                                <td><input type="number" name="attr_hard" /></td>
                                <td style='text-align:right;'><input type="radio" name="attr_deckcond" /></td>
                            </tr><tr>
                                <td>Active Mem</td>
                                <td><input type="number" name="attr_active" />Mp</td>
                                <td style='text-align:right;'><input type="radio" name="attr_deckcond" /></td>
                            </tr><tr>
                                <td>Storage Mem</td>
                                <td><input type="number" name="attr_storage" />Mp</td>
                                <td style='text-align:right;'><input type="radio" name="attr_deckcond" /></td>
                            </tr><tr>
                        		<td>Offline Mem</td>
                                <td><input type="number" name="attr_offline" />Mp</td>
                                <td style='text-align:right;'>Serious><input type="radio" name="attr_deckcond" /></td>
                            </tr><tr>
                        		<td>I/O</td>
                                <td><input type="number" name="attr_io" /></td>
                                <td style='text-align:right;'><input type="radio" name="attr_deckcond" /></td>
                            </tr><tr>
                        		<td>Response</td>
                                <td><input type="number" name="attr_response" /><button type="roll" class="d6-dice" name="roll_matrix_initiative" title="Matrix Initiative" value="/r (1+@{response})d6+2*@{response}+@{reaction}-@{stun_pen}-@{wound_pen} &{tracker}"></button></td>
                                <td style='text-align:right;'><input type="radio" name="attr_deckcond" /></td>
                            </tr><tr>
                        		<td>Bod</td>
                                <td><input type="number" name="attr_bod" /></td>
                                <td style='text-align:right;'>Moderate><input type="radio" name="attr_deckcond" /></td>
                            </tr><tr>
                        		<td>Evasion</td>
                                <td><input type="number" name="attr_evasion" /></td>
                                <td style='text-align:right;'><input type="radio" name="attr_deckcond" /></td>
                            </tr><tr>
                        		<td>Masking</td>
                                <td><input type="number" name="attr_masking" /></td>
                                <td style='text-align:right;'>Light><input type="radio" name="attr_deckcond" /></td>
                            </tr><tr>
                        		<td>Sensors</td>
                                <td><input type="number" name="attr_sensors" /></td>
                                <td style='text-align:right;'>Undamaged><input type="radio" name="attr_deckcond" CHECKED /></td>
                            </tr>
                        </table>
            			Notes: <textarea name="attr_decknotes"></textarea><br />
            		</fieldset><br />
                    <h3>Programs</h3>
                    <table>
                        <tr>
                            <td style='width:176px;'>Name</td>
                            <td style='width:50px;'>Rating</td>
                            <td style='width:54px;'>Size</td>
                            <td style='width:45px;'>Active</td>
                            <td style='width:45px;'>Stored</td>
                        </tr>
                    </table>
            		<fieldset class="repeating_programs">
                        <table>
                            <tr>
                                <td style='width:176px;'><input type="text" name="attr_program" style='width:175px;' /></td>
                                <td style='width:50px;'><input type="number" name="attr_prograting" value=1 /></td>
                				<td style='width:54px;'><input type="number" name="attr_size" style='width:53px' /></td>
                                <td style='width:45px;text-align:center;'><input type='checkbox' name="attr_inactive" /></td>
                				<td style='width:45px;text-align:center;'><input type='checkbox' name="attr_instorage" /></td>
                            </tr>
                        </table>
        			</fieldset>
            	</div>
            </div>
        </div>
    </li>
    <li>
        <input type='radio' name='tabs' id='tab-magic' />
        <label for='tab-magic'>Magic</label>
        <div class='tab-content'>
            <h2>Spells</h2>
            Spells Stacked: <input type='number' name='attr_spellstack' min=0 value=0 />
            Spells Sustained: <input type='number' name='attr_spellsus' min=0 value=0 />
        	<div class='sheet-2colrow'>
                <div class='sheet-col'>
                    <b><table>
                	    <tr>
                            <td width='203px'>Name</td>
                            <td width='46px'>Force</td>
                            <td width='48px'>Type</td>
                            <td width='87px'>Range</td>
                        </tr>
                    </table>
                    <table width=100%>
                        <tr>
                            <td width='103px'>Target</td>
                            <td width='57px'>Damage</td>
                            <td width='55px'>Duration</td>
                            <td style='text-align:center'>Drain</td>
                	    </tr>
            		</table></b>
                </div>
                <div class='sheet-col'>
                    <b>Description</b>
                </div>
            </div>
            <fieldset class="repeating_spells">
                <div class='sheet-2colrow'>
                    <div class='sheet-col'>
            		    <input type="text" name="attr_spellname" style='width:200px;' />
            			<input type="number" name="attr_force" value=1 min=1 />
            			<select name="attr_spelltype">
            				<option value="mana">M</option>
            				<option value="physical">P</option>
            			</select>
            			<input type="text" name="attr_spellrange" style='width:86px' />
            			<input type="text" name="attr_target" style='width:100px' />
            			<select name="attr_spelldmg">
            				<option SELECTED>N/A</option>
            				<option>L</option>
            				<option>M</option>
            				<option>S</option>
            				<option>D</option>
            			</select>
            			<select name="attr_duration">
                            <option SELECTED>I</option>
                            <option>S</option>
                            <option>P</option>
                        </select>
            			F/2 +<input type="number" name="attr_drain" value=0 /><select name="attr_drainlvl">
            				<option SELECTED>L</option>
            				<option>M</option>
            				<option>S</option>
            				<option>D</option>
            			</select><br />
                        Base TN: <input type='number' name='attr_castTN' value=4 min=2 />
                        Misc Modifiers (barrier/lodge/etc): <input type='number' name='attr_spellmisc' /><br />
                        Cast at force <input type='number' name='attr_castforce' value=1 min=1 />
            			<button type="roll" class="d6-dice" name="roll_cast_spell" title="Cast Spell" value="&{template:spell}{{spellname=@{spellname}}}{{description=@{spelldesc}}}{{casttest=[[[[@{castforce}+?{How many dice are you taking for casting?|0}]]d6>[[{@{castTN}+2*(@{spellstack}+@{spellsus})+@{spellmisc}+@{stun_pen}+@{wound_pen},2}kh1]]!!}]]}}{{draintest=[[[[@{willpower|max}+?{How many dice are you taking for drain resistance?|0}]]d6>[[{floor(@{castforce}/2)+@{drain},2}kh1]]!!]]}}"></button>
            		</div>
                    <div class='sheet-col'>
                        <textarea name='attr_spelldesc' width=100%></textarea>
                    </div>
                </div>
            </fieldset><br />
            <div class='sheet-row'>
                <div class='sheet-col'>
                    <h2>Physical Adept Powers</h2>
                    <table>
                        <tr>
                            <td style='width:203px;'>Name</td>
                            <td style='width:46px;'>Rating</td>
                            <td>Cost</td>
                        </tr>
                    </table>
                    <fieldset class='repeating_powers'>
                        <input type='text' name='attr_powername' style='width:200px;' /> <input type='number' name ='attr_powerrating' min=1 />
                        <input type='number' name='attr_powercost' step='0.25' min='0.25' style='width:56px' />
                    </fieldset>
                </div>
            </div>
        </div>
    </li>
    <li>
        <input type='radio' name='tabs' id='tab-vehicle' />
        <label for='tab-vehicle'>Vehicles, and Drones</label>
        <div class='tab-content'>
            <div class="sheet-2colrow">
            	<div class="sheet-col">
            		<h2>Vehicles</h2>
            		<fieldset class="repeating_vehicle">
            			<table>
                            <tr>
                                <td>Name</td><td><input type="text" name="attr_vehicle" /></td><td style='text-align:right;'><h4>Condition</h4></td>
                            </tr>
                            <tr>
                                <td></td><td></td><td style='text-align:right;'><h4>Monitor</h4></td>
                            </tr>
                            <tr>
                                <td></td><td><h4>RATING</h4></td>
                                <td style='text-align:right;'>Crash><input type="radio" name="attr_vehiclecond" /></td>
                            </tr>
                            <tr>
                    		    <td>Handling</td>
                                <td><input type="number" name="attr_handling" /></td>
                                <td style='text-align:right;'><input type="radio" name="attr_vehiclecond" /></td>
                            </tr>
                            <tr>
                                <td>Speed</td>
                                <td><input type="number" name="attr_speed" />/<input type="number" name="attr_speed_max" /></td>
                                <td style='text-align:right;'><input type="radio" name="attr_vehiclecond" /></td>
                            </tr>
                            <tr>
                    		    <td>Acceleration</td>
                                <td><input type="number" name="attr_accel" /></td>
                                <td style='text-align:right;'><input type="radio" name="attr_vehiclecond" /></td>
                            </tr>
                            <tr>
                                <td>Body</td>
                                <td><input type="number" name="attr_vehiclebody" /></td>
                                <td style='text-align:right;'>Serious><input type="radio" name="attr_vehiclecond" /></td>
                            </tr>
                            <tr>
                    		    <td>Armor</td>
                                <td><input type="number" name="attr_vehiclearmor" /></td>
                                <td style='text-align:right;'><input type="radio" name="attr_vehiclecond" /></td>
                            </tr>
                            <tr>
                                <td>Signature</td>
                                <td><input type="number" name="attr_signature" /></td>
                                <td style='text-align:right;'><input type="radio" name="attr_vehiclecond" /></td>
                            </tr>
                            <tr>
                    		    <td>Sensor</td>
                                <td><input type="number" name="attr_vehiclesensor" /></td>
                                <td style='text-align:right;'>Moderate><input type="radio" name="attr_vehiclecond" /></td>
                            </tr>
                            <tr>
                    		    <td>Pilot</td>
                                <td><input type="number" name="attr_pilot" /></td>
                                <td style='text-align:right;'><input type="radio" name="attr_vehiclecond" /></td>
                            </tr>
                            <tr>
                    		    <td>Fuel</td>
                                <td><input type="number" name="attr_fuel" />/<input type="number" name="attr_fuel_max" /></td>
                                <td style='text-align:right;'>Light><input type="radio" name="attr_vehiclecond" /></td>
                            </tr>
                            <tr>
                    		    <td>Economy</td>
                                <td><input type="number" name="attr_fueleco" /></td>
                                <td style='text-align:right;'>Undamaged><input type="radio" name="attr_vehiclecond" CHECKED /></td>
                            </tr>
                            <tr>
                    		    <td>Firmpoints</td>
                                <td><input type="number" name="attr_firm" /></td>
                                <td><table width='100%'><tr><td>Cargo</td><td style='text-align:right;'><input type="number" name="attr_cargo" /></td></tr></table></td>
                            </tr>
                            <tr>
                    		    <td>Hardpoints</td>
                                <td><input type="number" name="attr_hard" /></td>
                                <td><table width='100%'><tr><td>Load</td><td style='text-align:right;'><input type="number" name="attr_load" /></td></tr></table></td>
                            </tr>
                            <tr>
                    		    <td>Stress</td>
                                <td><input type="number" name="attr_stress" /></td>
                            </tr>
                        </table>
            			Notes <textarea name="attr_vehiclenotes"></textarea>
            		</fieldset>
            	</div>
            	<div class="sheet-col">
            		<h2>Drones</h2>
            		<fieldset class="repeating_drone">
            			<table>
                            <tr>
                                <td>Name</td><td><input type="text" name="attr_drone" /></td><td style='text-align:right;'><h4>Condition</h4></td>
                            </tr>
                            <tr>
                                <td></td><td></td><td style='text-align:right;'><h4>Monitor</h4></td>
                            </tr>
                            <tr>
                                <td></td><td><h4>RATING</h4></td>
                                <td style='text-align:right;'>Crash><input type="radio" name="attr_dronecond" /></td>
                            </tr>
                            <tr>
                        	    <td>Handling</td>
                                <td><input type="number" name="attr_dronehandling" /></td>
                                <td style='text-align:right;'><input type="radio" name="attr_dronecond" /></td>
                            </tr>
                            <tr>
                                <td>Speed</td>
                                <td><input type="number" name="attr_dronespeed" />/<input type="number" name="attr_dronespeed_max" /></td>
                                <td style='text-align:right;'><input type="radio" name="attr_dronecond" /></td>
                            </tr>
                            <tr>
                    		    <td>Acceleration</td>
                                <td><input type="number" name="attr_droneaccel" /></td>
                                <td style='text-align:right;'><input type="radio" name="attr_dronecond" /></td>
                            </tr>
                            <tr>
                                <td>Body</td>
                                <td><input type="number" name="attr_dronebody" /></td>
                                <td style='text-align:right;'>Serious><input type="radio" name="attr_dronecond" /></td>
                            </tr>
                            <tr>
                    		    <td>Armor</td>
                                <td><input type="number" name="attr_dronearmor" /></td>
                                <td style='text-align:right;'><input type="radio" name="attr_dronecond" /></td>
                            </tr>
                            <tr>
                                <td>Signature</td>
                                <td><input type="number" name="attr_dronesignature" /></td>
                                <td style='text-align:right;'><input type="radio" name="attr_dronecond" /></td>
                            </tr>
                            <tr>
            			        <td>Autonav</td>
                                <td><input type="number" name="attr_dronepilot" /></td>
                                <td style='text-align:right;'><input type="radio" name="attr_dronecond" /></td>
                            </tr>
                            <tr>
                        	    <td>Fuel</td>
                                <td><input type="number" name="attr_dronefuel" />/<input type="number" name="attr_dronefuel_max" /></td>
                                <td style='text-align:right;'>Light><input type="radio" name="attr_dronecond" /></td>
                            </tr>
                            <tr>
                    		    <td>Economy</td>
                                <td><input type="number" name="attr_dronefueleco" /></td>
                                <td style='text-align:right;'>Undamaged><input type="radio" name="attr_dronecond" CHECKED /></td>
                            </tr>
                            <tr>
                    		    <td>Firmpoints</td>
                                <td><input type="number" name="attr_dronefirm" /></td>
                                <td><table width='100%'><tr><td>Cargo</td><td style='text-align:right;'><input type="number" name="attr_dronecargo" /></td></tr></table></td>
                            </tr>
                            <tr>
                    		    <td>Hardpoints</td>
                                <td><input type="number" name="attr_dronehard" /></td>
                                <td><table width='100%'><tr><td>Load</td><td style='text-align:right;'><input type="number" name="attr_droneload" /></td></tr></table></td>
                            </tr>
                            <tr>
                    		    <td>Stress</td>
                                <td><input type="number" name="attr_dronestress" /></td>
                            </tr>
                        </table>
            			<h4>Sensors</h4>
                        <table>
                            <tr>
                			    <td></td>
                                <td><h5>RATING</h5></td>
                                <td style='text-align:right;width:50px'>FLUX:</td>
                                <td style='text-align:center'>Current</td>
                                <td style='text-align:center'>Max</td>
                            </tr>
                            <tr>
                			    <td>Sensors</td>
                                <td><input type="number" name="attr_dronesensors" /></td>
                                <td></td>
                                <td><input type="number" name="attr_sensorsflux" /> /</td>
                                <td><input type="number" name="attr_sensorsflux_max" /></td>
                            </tr>
                            <tr>
                			    <td>ECM</td>
                                <td><input type="number" name="attr_ECM" /></td>
                                <td></td>
                                <td><input type="number" name="attr_ECMflux" /> /</td>
                                <td><input type="number" name="attr_ECMflux_max" /></td>
                            </tr>
                            <tr>
                			    <td>ECCM</td>
                                <td><input type="number" name="attr_ECCM" /></td>
                                <td></td>
                                <td><input type="number" name="attr_ECCMflux" /> /</td>
                                <td><input type="number" name="attr_ECCMflux_max" /></td>
                            </tr>
                            <tr>
                			    <td>ED</td>
                                <td><input type="number" name="attr_ED" /></td>
                                <td></td>
                                <td><input type="number" name="attr_EDflux" /> /</td>
                                <td><input type="number" name="attr_EDflux_max" /></td>
                            </tr>
                            <tr>
                			    <td>ECD</td>
                                <td><input type="number" name="attr_ECD" /></td>
                                <td></td>
                                <td><input type="number" name="attr_ECDflux" /> /</td>
                                <td><input type="number" name="attr_ECDflux_max" /></td>
                            </tr>
                        </table>
            			<h4>Signal Condition Monitors</h4>
            			<table>
                            <tr>
                                <td></td>
                                <td>Command<br />Channel</td>
                                <td>Simesense<br />Channel</td>
                                <td>System<br />Channel</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Channel Disengaged</td>
                                <td><input type="radio" name="attr_commcond" value=4 /></td>
                                <td><input type="radio" name="attr_simcond" value=4 /></td>
                                <td><input type="radio" name="attr_syscond" value=4 /></td>
                                <td>Channel Disengaged</td>
                            </tr>
                            <tr>
                                <td></td>
                                <td><input type="radio" name="attr_commcond" value=3 /></td>
                                <td><input type="radio" name="attr_simcond" value=3 /></td>
                                <td><input type="radio" name="attr_syscond" value=3 /></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td><input type="radio" name="attr_commcond" value=3 /></td>
                                <td><input type="radio" name="attr_simcond" value=3 /></td>
                                <td><input type="radio" name="attr_syscond" value=3 /></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td><input type="radio" name="attr_commcond" value=3 /></td>
                                <td><input type="radio" name="attr_simcond" value=3 /></td>
                                <td><input type="radio" name="attr_syscond" value=3 /></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Serious Degredation</td>
                                <td><input type="radio" name="attr_commcond" value=3 /></td>
                                <td><input type="radio" name="attr_simcond" value=3 /></td>
                                <td><input type="radio" name="attr_syscond" value=3 /></td>
                                <td>Serious Degredation</td>
                            </tr>
                            <tr>
                                <td></td>
                                <td><input type="radio" name="attr_commcond" value=2 /></td>
                                <td><input type="radio" name="attr_simcond" value=2 /></td>
                                <td><input type="radio" name="attr_syscond" value=2 /></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td><input type="radio" name="attr_commcond" value=2 /></td>
                                <td><input type="radio" name="attr_simcond" value=2 /></td>
                                <td><input type="radio" name="attr_syscond" value=2 /></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Moderate Degredation</td>
                                <td><input type="radio" name="attr_commcond" value=2 /></td>
                                <td><input type="radio" name="attr_simcond" value=2 /></td>
                                <td><input type="radio" name="attr_syscond" value=2 /></td>
                                <td>Moderate Degredation</td>
                            </tr>
                            <tr>
                                <td></td>
                                <td><input type="radio" name="attr_commcond" value=1 /></td>
                                <td><input type="radio" name="attr_simcond" value=1 /></td>
                                <td><input type="radio" name="attr_syscond" value=1 /></td>
                                <td></td>
                            </tr>
            				<tr>
                			    <td>Light Degredation</td>
                                <td><input type="radio" name="attr_commcond" value=1 /></td>
                                <td><input type="radio" name="attr_simcond" value=1 /></td>
                                <td><input type="radio" name="attr_syscond" value=1 /></td>
                                <td>Light Degredation</td>
            				</tr>
                            <tr>
                                <td>No Degredation</td>
                                <td><input type="radio" name="attr_commcond" value=0 /></td>
                                <td><input type="radio" name="attr_simcond" value=0 /></td>
                                <td><input type="radio" name="attr_syscond" value=0 /></td>
                                <td>No Degredation</td>
                            </tr>
            			</table>
            			Notes <textarea name="attr_dronenotes"></textarea>
            		</fieldset>
            	</div>
            </div>
        </div>
    </li>
    <li>
        <input type='radio' name='tabs' id='tab-math' />
        <label for='tab-math'>Roll Information</label>
        <div class='tab-content'>
            <div class='sheet-3colrow'>
                <div class='sheet-col'>
                    <h3>General</h3>
                    Base: <input type='number' name='attr_baseTN' min=2 value=4 />
                    Modifiers: <input type='number' name='attr_modifiers' /><br />
                    Final: <input type='number' name='attr_generalTN' min=2 />
                </div>
                <div class='sheet-col'>
                    <h3>Ranged Combat</h3>
                    Range: <select name='attr_combatrange'>
                        <option value=4 SELECTED>Short</option>
                        <option value=5>Medium</option>
                        <option value=6>Long</option>
                        <option value=9>Extreme</option>
                    </select><br />
                    Visibility: <select name='attr_rangevis'>
                        <option value=0 SELECTED>Clear</option>
                        <option disabled>Normal Vision</option>
                        <option value=8>Full Dark</option>
                        <option value=6>Minimal Light</option>
                        <option value=2>Partial Light</option>
                        <option value=2>Glare</option>
                        <option value=2>Mist</option>
                        <option value=4>Light Smoke/Fog/Rain</option>
                        <option value=6>Heavy Smoke/Fog/Rain</option>
                        <option disabled>Technological Low-Light Vision</option>
                        <option value=8>Full Dark</option>
                        <option value=4>Minimal Light</option>
                        <option value=1>Partial Light</option>
                        <option value=4>Glare</option>
                        <option value=2>Mist</option>
                        <option value=4>Light Smoke/Fog/Rain</option>
                        <option value=6>Heavy Smoke/Fog/Rain</option>
                        <option disabled>Natural Low-Light Vision</option>
                        <option value=8>Full Dark</option>
                        <option value=2>Minimal Light</option>
                        <option value=0>Partial Light</option>
                        <option value=2>Glare</option>
                        <option value=0>Mist</option>
                        <option value=2>Light Smoke/Fog/Rain</option>
                        <option value=4>Heavy Smoke/Fog/Rain</option>
                        <option disabled>Technological Thermographic Vision</option>
                        <option value=4>Full Dark</option>
                        <option value=4>Minimal Light</option>
                        <option value=2>Partial Light</option>
                        <option value=4>Glare</option>
                        <option value=0>Mist</option>
                        <option value=0>Light Smoke/Fog/Rain</option>
                        <option value=1>Heavy Smoke/Fog/Rain</option>
                        <option value=4>Light Thermal Smoke</option>
                        <option value=6>Heavy Thermal Smoke</option>
                        <option disabled>Natural Thermographic Vision</option>
                        <option value=2>Full Dark</option>
                        <option value=2>Minimal Light</option>
                        <option value=1>Partial Light</option>
                        <option value=2>Glare</option>
                        <option value=0>Mist</option>
                        <option value=0>Light Smoke/Fog/Rain</option>
                        <option value=0>Heavy Smoke/Fog/Rain</option>
                        <option value=4>Light Thermal Smoke</option>
                        <option value=6>Heavy Thermal Smoke</option>
                    </select><br />
                    Cover: <select name='attr_cover'>
                        <option value=0 SELECTED>None</option>
                        <option value=4>Partial</option>
                        <option value=8>Blind Fire</option>
                    </select><br />
                    Previous Targets: <input type='number' name='attr_prevtar' min=0 value=0 /><br />
                    Recoil: <input type='number' name='attr_recoil' value=0 min=0 title='+1 second Semiauto shot, +3 per burst, +1 per shot on FA, double for heavy weapons' />
                    Compensation: <input type='number' name='attr_recoil_comp' value=0 min=0 /><br />
                    You are <select name='attr_move'>
                        <option value=0 selected>not moving</option>
                        <option value=1>walking</option>
                        <option value=2>walking over difficult ground</option>
                        <option value=4>running</option>
                        <option value=6>running over difficult ground</option>
                    </select><br />
                    Your target is <select name='attr_tarmove'>
                        <option value='-1'>not moving</option>
                        <option value=0 selected>walking</option>
                        <option value=2>running</option>
                    </select><br />
                    Gyro Stabalization: <input type='number' name='attr_gyro' min=0 value=0 /><br />
                    Two Firearms? <input type='checkbox' name='attr_dualgun' value='2' /><br />
                    Tech: <input type='radio' name='attr_tech' value=0 CHECKED>None <input type='radio' name='attr_tech' value='-2'>Smartlink<br />
                    <input type='radio' name='attr_tech' value='-1'>Smart Goggles <input type='radio' name='attr_tech' value='-1'>Laser Sight<br />
                    Aim Actions Taken: <input type='number' name='attr_aim' value=0 min=0 /><br />
                    Enemies in Melee with you: <input type='number' name='attr_threats' min=0 value=0 /><br />
                    Dots crossed on the Skill Web: <input type='number' name='attr_rangeweb' min=0 value=0 /><br />
                    Misc. Modifiers <input type='number' name='attr_rangemisc' value=0 /><br />
                    Final: <input type='number' name='attr_rangedTN' min=2 value=4 />
                    <button type="roll" class="d6-dice" name='roll_ranged_attack' title='Roll a Ranged Attack' value='&{template:default} {{name=Ranged Attack}} {{ Success Test = [[ {?{What is your skill with the weapon?|1}d6>@{rangedTN}!!} ]] }} {{ Pool Dice = [[ {?{How many dice are you taking from your pool?|0}d6>@{rangedTN}!!} ]] }}' />
                </div>
                <div class='sheet-col'>
                    <h3>Melee Combat</h3>
                        People in Melee with you<br />
                        Enemies: <input type='number' name='attr_enemies' min=0 value=0 />
                        Friends: <input type='number' name='attr_friends' min=0 value=0 /><br />
                        Visibility: <select name='attr_meleevis'>
                        <option value=0 SELECTED>Clear</option>
                        <option disabled>Normal Vision</option>
                        <option value=8>Full Dark</option>
                        <option value=3>Minimal Light</option>
                        <option value=1>Partial Light</option>
                        <option value=1>Glare</option>
                        <option value=1>Mist</option>
                        <option value=2>Light Smoke/Fog/Rain</option>
                        <option value=3>Heavy Smoke/Fog/Rain</option>
                        <option disabled>Technological Low-Light Vision</option>
                        <option value=4>Full Dark</option>
                        <option value=2>Minimal Light</option>
                        <option value=0>Partial Light</option>
                        <option value=2>Glare</option>
                        <option value=1>Mist</option>
                        <option value=2>Light Smoke/Fog/Rain</option>
                        <option value=3>Heavy Smoke/Fog/Rain</option>
                        <option disabled>Natural Low-Light Vision</option>
                        <option value=4>Full Dark</option>
                        <option value=1>Minimal Light</option>
                        <option value=0>Partial Light</option>
                        <option value=1>Glare</option>
                        <option value=0>Mist</option>
                        <option value=1>Light Smoke/Fog/Rain</option>
                        <option value=2>Heavy Smoke/Fog/Rain</option>
                        <option disabled>Technological Thermographic Vision</option>
                        <option value=2>Full Dark</option>
                        <option value=2>Minimal Light</option>
                        <option value=1>Partial Light</option>
                        <option value=2>Glare</option>
                        <option value=0>Mist</option>
                        <option value=0>Light Smoke/Fog/Rain</option>
                        <option value=0>Heavy Smoke/Fog/Rain</option>
                        <option value=2>Light Thermal Smoke</option>
                        <option value=3>Heavy Thermal Smoke</option>
                        <option disabled>Natural Thermographic Vision</option>
                        <option value=1>Full Dark</option>
                        <option value=1>Minimal Light</option>
                        <option value=0>Partial Light</option>
                        <option value=1>Glare</option>
                        <option value=0>Mist</option>
                        <option value=0>Light Smoke/Fog/Rain</option>
                        <option value=0>Heavy Smoke/Fog/Rain</option>
                        <option value=2>Light Thermal Smoke</option>
                        <option value=3>Heavy Thermal Smoke</option>
                    </select><br />
                    Weapon Reach<br />
                    Yours: <input type='number' name='attr_youreach' value=0 min=0 />
                    Theirs: <input type='number' name='attr_enemyreach' value=0 min=0 /><br />
                    Additional Targets: <input type='number' name='attr_meleetargets' value=0 min=0 /><br />
                    Superior Position? <input type='checkbox' name='attr_position' value=-1 />
                    Enemy Prone? <input type='checkbox' name='attr_prone' value=-2 /><br />
                    Misc. Modifiers <input type='number' name='attr_meleemisc' value=0 /><br />
                    Final: <input type='number' name='attr_meleeTN' min=2 value=4 />
                    <button type="roll" class="d6-dice" name='roll_melee_attack' title='Roll a Melee Attack' value='&{template:default} {{name=Melee Attack}} {{ Success Test = [[ {?{What is your skill with the weapon?|1}d6>@{meleeTN}!!} ]] }} {{ Pool Dice = [[ {?{How many dice are you taking from your pool?|0}d6>@{meleeTN}!!} ]] }}' />
                </div>
        </div>
</ul>

<script type="text/worker">
    on("change:combatrange change:rangevis change:cover change:prevtar change:recoil change:recoil_comp change:move change:tarmove change:gyro change:dualgun change:tech change:aim change:threats change:rangeweb change:rangemisc change:stun_pen change:wound_pen", function() {
        updateRangeTN();
    });
    
    on("change:baseTN change:modifiers change:stun_pen change:wound_pen", function() {
        updateGeneralTN();
    });
    
    on("change:enemies change:friends change:meleevis change:youreach change:enemyreach change:meleetargets change:position change:prone change:stun_pen change:wound_pen change:meleemisc", function() {
        updateMeleeTN();
    });
    
    on("change:stun change:pain_res", function() {
        getAttrs(["stun","pain_res"], function(v) {
            var penalty = 0;
            var stun = parseInt(v.stun);
            var res = parseInt(v.pain_res);
            
            if (stun > res) {
                if (stun > 5) penalty = 3;
                else if (stun > 2) penalty = 2;
                else if (stun > 0) penalty = 1;
            }
            
            setAttrs({"stun_pen": penalty});
        });
    });
    
    on("change:wounds change:pain_res", function() {
        getAttrs(["wounds","pain_res"], function(v) {
            var penalty = 0;
            var wounds = parseInt(v.wounds);
            var res = parseInt(v.pain_res);
            
            if (wounds > res) {
                if (wounds > 5) penalty = 3;
                else if (wounds > 2) penalty = 2;
                else if (wounds > 0) penalty = 1;
            }
            
            setAttrs({"wound_pen": penalty});
        });
    });
        
    var updateRangeTN = function() {
        getAttrs(["combatrange","rangevis","cover","prevtar","recoil","recoil_comp","move","tarmove","gyro","dualgun","tech","aim","threats","rangeweb","rangemisc","stun_pen","wound_pen"], function(v) {
            var targetNumber = parseInt(v.recoil) - parseInt(v.recoil_comp);
            if (targetNumber < 0) targetNumber = 0;
            targetNumber += parseInt(v.move) - parseInt(v.gyro);
            if (targetNumber < 0) targetNumber = 0;
            targetNumber += parseInt(v.combatrange) + parseInt(v.rangevis) + parseInt(v.cover) + parseInt(v.tarmove) + parseInt(v.dualgun) + parseInt(v.tech) - parseInt(v.aim) + 2 * (parseInt(v.threats) + parseInt(v.rangeweb) + parseInt(v.prevtar)) + parseInt(v.rangemisc) + parseInt(v.stun_pen) + parseInt(v.wound_pen);
            if (targetNumber < 2) targetNumber = 2;
            setAttrs({"rangedTN": targetNumber});
        });
    };
    
    var updateGeneralTN = function() {
        getAttrs(["baseTN","modifiers","stun_pen","wound_pen"], function(v) {
            var targetNumber = parseInt(v.baseTN) + parseInt(v.modifiers) + parseInt(v.stun_pen) + parseInt(v.wound_pen);
            if (targetNumber < 2) targetNumber = 2;
            setAttrs({"generalTN": targetNumber});
        });
    };
    
    var updateMeleeTN = function() {
        var targetNumber = 4;
        getAttrs(["enemies", "friends", "meleevis", "youreach", "enemyreach","meleetargets","position","prone","stun_pen","wound_pen","meleemisc"], function(v) {
            var participants = parseInt(v.enemies) - parseInt(v.friends);
            if (participants > 4) participants = 4;
            else if (participants < -4) participants = -4;
            targetNumber += participants + parseInt(v.meleevis) + parseInt(v.enemyreach) - parseInt(v.youreach) + 2 * parseInt(v.meleetargets) + parseInt(v.position) + parseInt(v.prone) + parseInt(v.meleemisc) + parseInt(v.stun_pen) + parseInt(v.wound_pen);
            if (targetNumber < 2) targetNumber = 2;
            setAttrs({"meleeTN": targetNumber});
        });
    };
</script>

<rolltemplate class="sheet-rolltemplate-spell">
    <table>
        <tr><th>{{spellname}}</th></tr>
        {{#description}}
            <tr><td>
                {{description}}
            </td></tr>
        {{/description}}
        <tr><td>
            <span class="tcat">Casting Test: </span>{{casttest}}
        </td></tr>
        <tr><td>
            <span class="tcat">Drain Test: </span>{{draintest}}
        </td></tr>
    </table>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-skill">
    <table>
        <tr><th>{{skillname}}</th></tr>
        {{#description}}
            <tr><td>
                {{description}}
            </td></tr>
        {{/description}}
        <tr><td>
            <span class="tcat">Success Test: </span>{{skilltest}}
        </td></tr>
    </table>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-attrib">
    <table>
        <tr><th>{{attribname}}</th></tr>
        {{#description}}
            <tr><td>
                {{description}}
            </td></tr>
        {{/description}}
        <tr><td>
            <span class="tcat">Success Test: </span>{{attribtest}}
        </td></tr>
    </table>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-init">
    <table>
        <tr><th>{{type}}</th></tr>
        <tr><td>
            <span class="tcat">Roll: </span>{{roll}}
        </td></tr>
        {{#rollGreater() roll 10}}
            <tr><td>
                <span class="bonus">{{character}} has qualified for multiple combat phases!</span>
            </td></tr>
        {{/rollGreater() roll 10}}
    </table>
</rolltemplate>
        
<rolltemplate class="sheet-rolltemplate-damageresist">
    <table>
        <tr><th>{{type}}</th></tr>
        <tr><td>
            <span class="tcat">Resistance Roll: </span>{{roll}}
        </td></tr>
        <tr><td>
            <span class="tcat">Resistance from Pool: </span>{{poolroll}}<br />
            If this roll alone surpasses the attacker, it is a clean miss.
        </td></tr>
    </table>
</rolltemplate>