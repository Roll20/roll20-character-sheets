<!-- **** SCRIPTS / SHEET WORKERS -->
<script type="text/worker">
/* ---- PMT ---------------------- */
    var PMT = PMT || (function(){
        'use strict';
        var version = '1.0'
        ,majPoids = function() {
            getSectionIDs("repeating_equipement", function(idws) {
                var totwght = 0.0;
                idws.forEach(function(idw,index,arr){
                    var uqte = "repeating_equipement_" + idw + "_equipqte";
                    var uwght = "repeating_equipement_" + idw + "_equippoids";
                    var lng = parseInt(arr.length) || 0;
                    getAttrs(['' + uqte,'' + uwght], function(val) {
                        var sqte = parseFloat(val[uqte]) || 0.0;
                        var swght = parseFloat(val[uwght]) || 0.0;
                        totwght = totwght + (sqte * swght);
                        if ( (index+1) == lng ){
                            setAttrs({
                                encombrement: totwght
                            });
                        }
                    });
                });
            });
        }
        ,majEncombrement = function () {
            getAttrs(["encombrement"], function (values) {
                var enc = parseFloat(values.encombrement) || 0.0;
                var encfinal = enc.toFixed(2);
                var explo = 0;
                var combat = 0;
                if (enc>=71) {
                    explo = 3;
                    combat = 1;
                } else if (enc>=41 && enc<71) {
                    explo = 9;
                    combat = 3;
                } else if (enc>=31 && enc<41) {
                    explo = 18;
                    combat = 6;
                } else if (enc>=21 && enc<31) {
                    explo = 24;
                    combat = 9;
                } else {
                    explo = 36;
                    combat = 12;
                }
                setAttrs({
                    encombrement: encfinal,
                    mvtexploration: explo,
                    mvtcombat: combat,
                    mvtcourse: explo,
                    mvtexterieur: explo*3
                });
            });
        };
        return {
            majEncombrement: majEncombrement,
            majPoids: majPoids
        };
    }());
/* ---- FIN PMT ---------------------- */
// Création perso -- Ouverture de la fiche
    on('sheet:opened',function(){
        // **** Gestion 1ière ouverture après création du personnage
        getAttrs(["todoequip"], function(values) {
            //Equipements
            if(values.todoequip.length > 0){
                var newrowid ="";
                var newrowattrs = {};
                var TabEq = [];
                var arrayLength = 0;
                var obj = {};
                TabEq = values.todoequip.split("|");
                arrayLength = TabEq.length;
                if (arrayLength > 0){
                    setAttrs({todoequip: ""});
                    var poidsligne = 0.0;
                    var totpoids = 0.0;
                    for (var i = 0; i < arrayLength; i++) {
                        obj=JSON.parse(TabEq[i]);
                        newrowid = generateRowID();
                        newrowattrs = {};
                        newrowattrs["repeating_equipement_" + newrowid + "_equipnom"] = obj.nom;
                        newrowattrs["repeating_equipement_" + newrowid + "_equipqte"] = obj.qte;
                        newrowattrs["repeating_equipement_" + newrowid + "_equippoids"] = obj.poids;
                        poidsligne = ((parseFloat(obj.qte) || 1.0) * (parseFloat(obj.poids) || 0.0)).toFixed(1);
                        totpoids = (parseFloat(totpoids) || 0.0) + (parseFloat(poidsligne) || 0.0);
                        newrowattrs["repeating_equipement_" + newrowid + "_equippoidstot"] = poidsligne;
                        setAttrs(newrowattrs);
                    }
                    setAttrs({encombrement: totpoids});
                    PMT.majEncombrement();
                }
            }
        });
        getAttrs(["todosort"], function(values) {
            //Sorts
            if(values.todosort.length > 0){
                var newrowid ="";
                var newrowattrs = {};
                var TabSort = [];
                var arrayLength = 0;
                var obj = {};
                TabSort = values.todosort.split("|");
                arrayLength = TabSort.length;
                if (arrayLength > 0){
                    for (var i = 0; i < arrayLength; i++) {
                        obj=JSON.parse(TabSort[i]);
                        newrowid = generateRowID();
                        newrowattrs = {};
                        newrowattrs["repeating_sorts_" + newrowid + "_sort-nom"] = obj.nom;
                        newrowattrs["repeating_sorts_" + newrowid + "_sort-reversible"] = obj.reversible;
                        newrowattrs["repeating_sorts_" + newrowid + "_sort-niveau"] = obj.niveau;
                        newrowattrs["repeating_sorts_" + newrowid + "_sort-duree"] = obj.duree;
                        newrowattrs["repeating_sorts_" + newrowid + "_sort-portee"] = obj.portee;
                        newrowattrs["repeating_sorts_" + newrowid + "_sort-desc"] = obj.desc;
                        setAttrs(newrowattrs);
                    }
                }
                setAttrs({todosort: ""});
            }
        });
        getAttrs(["todoatk"], function(values) {
            //Attaques
            if(values.todoatk.length > 0){
                var newrowid ="";
                var newrowattrs = {};
                var TabAtk = [];
                var arrayLength = 0;
                var obj = {};
                TabAtk = values.todoatk.split("|");
                arrayLength = TabAtk.length;
                if (arrayLength > 0){
                    for (var i = 0; i < arrayLength; i++) {
                        obj=JSON.parse(TabAtk[i]);
                        newrowid = generateRowID();
                        newrowattrs = {};
                        newrowattrs["repeating_attaques_" + newrowid + "_attaque-nom"] = obj.nom;
                        newrowattrs["repeating_attaques_" + newrowid + "_attaque-carac"] = obj.mod;
                        newrowattrs["repeating_attaques_" + newrowid + "_attaque-bonus"] = obj.bonus;
                        newrowattrs["repeating_attaques_" + newrowid + "_attaque-degats-nbde"] = obj.nbde;
                        newrowattrs["repeating_attaques_" + newrowid + "_attaque-degats-de"] = obj.de;
                        newrowattrs["repeating_attaques_" + newrowid + "_attaque-degats-carac"] = obj.moddgt;
                        newrowattrs["repeating_attaques_" + newrowid + "_attaque-degats-bonus"] = obj.bonusdgt;
                        setAttrs(newrowattrs);
                    }
                }
                setAttrs({todoatk: ""});
            }
        });
    });
// Inventaire / équipement
    on("change:repeating_equipement:equipqte change:repeating_equipement:equippoids", function() {
        PMT.majPoids();
    });
     on('remove:repeating_equipement',function(){
        PMT.majPoids();
    });
    on("change:encombrement", function() {
        PMT.majEncombrement();
    });
// Gestion CA
    on("change:sheetoptionca", function() {
        getAttrs(["sheetoptionca","atk_bonus"], function(values) {
            var bonusatk=parseInt(values.atk_bonus);
            var option = parseInt(values.sheetoptionca);
            if ( (option > 0) && (bonusatk < 1) ) {
                setAttrs({
                    ATK_Bonus:1
                });
            } else if ( (option == 0) && (bonusatk > 0) ) {
                setAttrs({
                    ATK_Bonus:0
                });
            }
        });
    });
// Caractéristiques et modificateurs
    on("change:force", function(eventinfo) {
        var Force=parseInt(eventinfo.newValue) || 0;
        var MOD_FOR=0;
        if (Force <4) {MOD_FOR=-3;}
            else if (Force>3 && Force<6) {MOD_FOR=-2;}
            else if (Force>5 && Force<9) {MOD_FOR=-1;}
            else if (Force>12 && Force<16) {MOD_FOR=1;}
            else if (Force>15 && Force<18) {MOD_FOR=2;}
            else if (Force>17) {MOD_FOR=3;}
            else {MOD_FOR=0;}
        setAttrs({
            MOD_FOR:MOD_FOR
        });
    });
    on("change:dexterite", function(eventinfo) {
        var Dexterite=parseInt(eventinfo.newValue) || 0;
        var MOD_DEX=0;
        if (Dexterite <4) {MOD_DEX=-3;}
            else if (Dexterite>3 && Dexterite<6) {MOD_DEX=-2;}
            else if (Dexterite>5 && Dexterite<9) {MOD_DEX=-1;}
            else if (Dexterite>12 && Dexterite<16) {MOD_DEX=1;}
            else if (Dexterite>15 && Dexterite<18) {MOD_DEX=2;}
            else if (Dexterite>17) {MOD_DEX=3;}
            else {MOD_DEX=0;}
        setAttrs({
            MOD_DEX:MOD_DEX
        });
    });
    on("change:constitution", function(eventinfo) {
        var Constitution=parseInt(eventinfo.newValue) || 0;
        var MOD_CON=0;
        if (Constitution <4) {MOD_CON=-3;}
            else if (Constitution>3 && Constitution<6) {MOD_CON=-2;}
            else if (Constitution>5 && Constitution<9) {MOD_CON=-1;}
            else if (Constitution>12 && Constitution<16) {MOD_CON=1;}
            else if (Constitution>15 && Constitution<18) {MOD_CON=2;}
            else if (Constitution>17) {MOD_CON=3;}
            else {MOD_CON=0;}
        setAttrs({
            MOD_CON:MOD_CON
        });
    });
    on("change:intelligence", function(eventinfo) {
        var Intelligence=parseInt(eventinfo.newValue) || 0;
        var MOD_INT=0;
        if (Intelligence>12 && Intelligence<16) {MOD_INT=1;}
            else if (Intelligence>15 && Intelligence<18) {MOD_INT=2;}
            else if (Intelligence>17) {MOD_INT=3;}
            else {MOD_INT=0;}
         setAttrs({
            MOD_INT:MOD_INT
        });
    });
    on("change:sagesse", function(eventinfo) {
        var Sagesse=parseInt(eventinfo.newValue) || 0;
        var MOD_SAG=0;
        if (Sagesse <4) {MOD_SAG=-3;}
            else if (Sagesse>3 && Sagesse<6) {MOD_SAG=-2;}
            else if (Sagesse>5 && Sagesse<9) {MOD_SAG=-1;}
            else if (Sagesse>12 && Sagesse<16) {MOD_SAG=1;}
            else if (Sagesse>15 && Sagesse<18) {MOD_SAG=2;}
            else if (Sagesse>17) {MOD_SAG=3;}
            else {MOD_SAG=0;}
          setAttrs({
            MOD_SAG:MOD_SAG
        });
    });
    on("change:charisme", function(eventinfo) {
        var Charisme=parseInt(eventinfo.newValue) || 0;
        var MOD_CHA=0;
        var MaxCompagnons=0;
        var MoralCompagnons=0;
        if (Charisme <4) {
                MOD_CHA=2;
                MaxCompagnons=1;
                MoralCompagnons=4;
            }
            else if (Charisme>3 && Charisme<6) {
                MOD_CHA=1;
                MaxCompagnons=2;
                MoralCompagnons=5;
            }
            else if (Charisme>5 && Charisme<9) {
                MOD_CHA=1;
                MaxCompagnons=3;
                MoralCompagnons=6;
            }
            else if (Charisme>12 && Charisme<16) {
                MOD_CHA=-1;
                MaxCompagnons=5;
                MoralCompagnons=8;
            }
            else if (Charisme>15 && Charisme<18) {
                MOD_CHA=-1;
                MaxCompagnons=6;
                MoralCompagnons=9;
            }
            else if (Charisme>17) {
                MOD_CHA=-2;
                MaxCompagnons=7;
                MoralCompagnons=10;
            }
            else {
                MOD_CHA=0;
                MaxCompagnons=4;
                MoralCompagnons=7;
            }
        setAttrs({
            MOD_CHA:MOD_CHA,
            MaxCompagnons:MaxCompagnons,
            MoralCompagnons:MoralCompagnons
        });
    });
</script>
<!-- PARAMETRAGES -->
<span class="sheet-smallspan">v4.5 - <b>Options :</b></span>
<input type="radio" name="attr_sheetOptionCa" value="0" class="sheet-optionCaDesc" checked="checked" title="Utiliser la Classe d'Armure (CA) descendante" /><span>CA descendante</span>
<input type="radio" name="attr_sheetOptionCa" value="1" class="sheet-optionCaAsc" title="Utiliser la Classe d'Armure (CA) ascendante" /><span>CA ascendante</span>
<input type="radio" name="attr_Classe" value="0" class="sheet-classeClerc" checked="checked" />
<input type="radio" name="attr_Classe" value="1" class="sheet-classeGuerrier" />
<input type="radio" name="attr_Classe" value="2" class="sheet-classeMagicien" />
<input type="radio" name="attr_Classe" value="3" class="sheet-classeVoleur" />
<input type="radio" name="attr_Classe" value="4" class="sheet-classeElfe" />
<input type="radio" name="attr_Classe" value="5" class="sheet-classeHalfelin" />
<input type="radio" name="attr_Classe" value="6" class="sheet-classeNain" />
<!-- FdP -->
<div class="sheet-mainBg" style="width:832px;">
    <table style="width:100%;"> <!-- portrait, nom, classe etc... -->
        <tr>
            <!-- <td style="width:260px;text-align:center;vertical-align:top;">
                <img style="width:100%" src="http://lh4.googleusercontent.com/-Lx2C7ZSAnYE/VHYzI6JcLWI/AAAAAAAATLw/agtXHfY_jPM/w976-h85-no/FdPLogo2.png"/>
                <img style="width:200px;" src="http://lh5.googleusercontent.com/-RtdTN5mdBt8/VHCVJdiLETI/AAAAAAAATJQ/qH2mckC0xG0/w823-h646-no/dragon_noir.png"/>
            </td> -->
            <!-- <td style="width: 260px ; text-align: center ; vertical-align: top">
                <img style="width: 100%;" src="https://i.imgur.com/SErzFKj.png" title="Portes, Monstres & Trésors">
                https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/PortesMonstresTresors/FdPLogo2.png
                <img style="width: 240px;" src="https://i.imgur.com/NnEpgxI.png" title="Dragon Logo">
                https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/PortesMonstresTresors/dragon_noir.png
            </td> -->
            <td style="width: 260px ; text-align: center ; vertical-align: top">
                <img style="width: 100%;" src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/PortesMonstresTresors/FdPLogo2.png" title="Portes, Monstres & Trésors">
                <img style="width: 240px;" src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/PortesMonstresTresors/dragon_noir.png" title="Dragon Logo">
            </td>
            <!-- FIN portrait -->
            <td style="width:530px;"> <!--titre, nom, classe ... -->
                <table style="width:100%;">
                    <tr><td colspan="3"></td></tr>
                    <tr>
                        <td>
                            <input class="sheet-inMainTxt" type="text" style="font-weight: bold; text-align: center; font-size: 16px;" name="attr_character_name" placeholder="Nom du personnage" />
                        </td>
                        <td>
                            <SELECT name="attr_Classe" size="1"  style="width: 115px;">
                                <option value="0">Clerc</option>
                                <option value="1">Guerrier</option>
                                <option value="2">Magicien</option>
                                <option value="3">Voleur</option>
                                <option value="4">Elfe</option>
                                <option value="5">Halfelin</option>
                                <option value="6">Nain</option>
                            </SELECT>
                        </td>
                        <td>
                            <SELECT name="attr_Alignement" size="1"  style="width: 115px;">
                                <OPTION>Loi</OPTION>
                                <OPTION>Neutralité</OPTION>
                                <OPTION>Chaos</OPTION>
                            </SELECT>
                        </td>
                    </tr>
                    <tr>
                        <td class="sheet-libel1">Nom du personnage</td>
                        <td class="sheet-libel1">Classe</td>
                        <td class="sheet-libel1">Alignement</td>
                    </tr>
                    <tr>
                        <td><input class="sheet-inMainTxt" type="text" name="attr_titre" placeholder="Titre" /></td>
                        <td colspan="2"><input class="sheet-inMainTxt" type="text" name="attr_langues" style="width:300px;" placeholder="Langues supplémentaires" /></td>
                    </tr>
                    <tr>
                        <td class="sheet-libel1">Titre</td>
                        <td class="sheet-libel1" colspan="2">Langues supplémentaires</td>
                    </tr>
                    <tr>
                        <td>
                            <input class="sheet-inMainNum" type="number" name="attr_XP" style="width: 80px;text-align:right;" value="0" />
                            <b>/</b>
                            <input class="sheet-inMainNum" type="number" name="attr_XP_max" style="width: 80px;text-align:right;" value="0" />
                        </td>
                        <td><input class="sheet-inMainNum" type="number" name="attr_BonusXp" style="width: 50px;" value="0" /> %</td>
                        <td><input class="sheet-inMainNum" type="number" name="attr_Niveau" style="width: 50px;" value="1" /></td>
                    </tr>
                    <tr>
                        <td class="sheet-libel1">XP / Prochain niveau</td>
                        <td class="sheet-libel1">Bonus d'XP</td>
                        <td class="sheet-libel1">Niveau</td>
                    </tr>
                    <tr>
                        <td class="sheet-libel1">
                            <div class="sheet-optionCaDesc">
                                <input class="sheet-inCA" type="text" name="attr_CaDesc" title="Classe d'Armure totale"  value="[[@{CaDescArmure}-@{CaBouclier}-(@{MOD_DEX}*1)]]" disabled />=<input name="attr_CaDescArmure" type="number" class="sheet-inMainNum" style="width:40px;" value="9" title="Classe d'armure de l'armure (9 sans armure)"/>-<input name="attr_CaBouclier" type="number" class="sheet-inMainNum" style="width:35px;" value="0" title="Bonus de CA de bouclier"/>-<input name="attr_CaDex" type="number" class="sheet-inMainNum" style="width:40px;" value="@{MOD_DEX}" title="Modificateur de Dextérité" disabled />
                            </div>
                            <div class="sheet-optionCaAsc">
                                <input class="sheet-inCA" type="text" name="attr_CaAsc" title="Classe d'Armure totale" value="[[@{CaAscArmure}+@{CaBouclier}+@{MOD_DEX}]]" disabled />=<input name="attr_CaAscArmure" type="number" class="sheet-inMainNum" style="width:40px;" value="10" title="Classe d'armure de l'armure (10 sans armure)"/>+<input name="attr_CaBouclier" type="number" class="sheet-inMainNum" style="width:35px;" value="0" title="Bonus de CA de bouclier"/>+<input name="attr_CaDex" type="number" class="sheet-inMainNum" style="width:40px;" value="@{MOD_DEX}" title="Modificateur de Dextérité" disabled />
                            </div>
                        </td>
                        <td class="sheet-libel1">
                                <input class="sheet-inPV" type="number" name="attr_PV" placeholder="PV" title="Points de Vie courant" value="0"/>
                                <b>/</b>
                                <input class="sheet-inPVMax" type="number" name="attr_PV_max" placeholder="MAX" title="Points de Vie maximum"  value="0"/>
                        </td>
                        <td class="sheet-libel1">
                            <SELECT name="attr_DV" size="1"  style="text-align: right; width: 50px;">
                                <option value="4">d4</option>
                                <option value="6">d6</option>
                                <option value="8">d8</option>
                                <option value="10">d10</option>
                                <option value="12">d12</option>
                            </SELECT>
                            <button type="roll" value="&{template:pmt} {{perso=@{character_name}}} {{name=Dé de Vie}} {{DV=[[1d@{DV}+@{MOD_CON}]]}}" name='DV' />
                        </td>
                    </tr>
                    <tr>
                        <td class="sheet-libel1">
                            <div class="sheet-optionCaDesc sheet-libel1">CA=Armure-Bouclier-DEX</div>
                            <div class="sheet-optionCaAsc sheet-libel1">CA=Armure+Bouclier+DEX</div>
                        </td>
                        <td class="sheet-libel1">Points de Vie</td>
                        <td class="sheet-libel1">Dé de Vie</td>
                    </tr>
                </table>
            </td>  <!--titre, nom, classe ... -->
        </tr>
    </table> <!-- FIN portrait, nom, classe etc... -->
    <hr/>
    <div style="display: table; width:100%;"> <!-- TABLE carac & JS -->
        <div style="display: table-row"> <!-- LIGNE carac & JS -->
            <div style="display: table-cell; "> <!-- CELL carac  -->
                <div style="display: table; text-align: left;"> <!-- CARAC -->
                    <div  style="display: table-row;">
                        <div class="sheet-carac-num">
                            <input name="attr_Force" type="number" class="sheet-carac-num" value="10"/>
                        </div>
                        <div class="sheet-carac-roll">
                            <button type="roll"
                            value="&{template:pmt} {{perso=@{character_name}}} {{name=Force}} {{subtags=Jet de Caractéristique}} {{carac=[[1d20-(?{Bonus/Malus|0})]]}} {{target=[[@{Force}]]}}"
                             name='FOR' />
                        </div>
                        <div class="sheet-carac-lib">
                            Force
                        </div>
                        <div class="sheet-carac-mod">
                            <input name="attr_MOD_FOR" type="number" class="sheet-carac-mod" value="0" />
                        </div>
                        <div style="display: inline-block;">Toucher, dommages et for&ccedil;age de porte</div>
                    </div>
                    <div  style="display: table-row;">
                        <div class="sheet-carac-num">
                            <input name="attr_Dexterite" type="number" class="sheet-carac-num" value="10"/>
                        </div>
                        <div class="sheet-carac-roll">
                            <button type="roll"
                            value="&{template:pmt} {{perso=@{character_name}}} {{name=Dextérité}} {{subtags=Jet de Caractéristique}} {{carac=[[1d20-(?{Bonus/Malus|0})]]}} {{target=[[@{Dexterite}]]}}"
                             name='DEX' />
                        </div>
                        <div class="sheet-carac-lib">
                            Dextérité
                        </div>
                        <div class="sheet-carac-mod">
                            <input name="attr_MOD_DEX" type="number" class="sheet-carac-mod" value="0" />
                        </div>
                        <div style="display: inline-block;">CA, attaques à distance et initiative</div>
                    </div>
                    <div  style="display: table-row;">
                        <div class="sheet-carac-num">
                            <input name="attr_Constitution" type="number" class="sheet-carac-num" value="10"/>
                        </div>
                        <div class="sheet-carac-roll">
                            <button type="roll"
                            value="&{template:pmt} {{perso=@{character_name}}} {{name=Constitution}} {{subtags=Jet de Caractéristique}} {{carac=[[1d20-(?{Bonus/Malus|0})]]}} {{target=[[@{Constitution}]]}}"
                             name='CON' />
                        </div>
                        <div class="sheet-carac-lib">
                            Constitution
                        </div>
                        <div class="sheet-carac-mod">
                            <input name="attr_MOD_CON" type="number" class="sheet-carac-mod" value="0" />
                        </div>
                        <div style="display: inline-block;">Points de Vie, par Dé de Vie</div>
                    </div>
                    <div  style="display: table-row;">
                        <div class="sheet-carac-num">
                            <input name="attr_Intelligence" type="number" class="sheet-carac-num" value="10"/>
                        </div>
                        <div class="sheet-carac-roll">
                            <button type="roll"
                            value="&{template:pmt} {{perso=@{character_name}}} {{name=Intelligence}} {{subtags=Jet de Caractéristique}} {{carac=[[1d20-(?{Bonus/Malus|0})]]}} {{target=[[@{Intelligence}]]}}"
                             name='INT' />
                        </div>
                        <div class="sheet-carac-lib">
                            Intelligence
                        </div>
                        <div class="sheet-carac-mod">
                            <input name="attr_MOD_INT" type="number" class="sheet-carac-mod" value="0" />
                        </div>
                        <div style="display: inline-block;">Langues supplémentaires</div>
                    </div>
                    <div  style="display: table-row;">
                        <div class="sheet-carac-num">
                            <input name="attr_Sagesse" type="number" class="sheet-carac-num" value="10" />
                        </div>
                        <div class="sheet-carac-roll">
                            <button type="roll"
                            value="&{template:pmt} {{perso=@{character_name}}} {{name=Sagesse}} {{subtags=Jet de Caractéristique}} {{carac=[[1d20-(?{Bonus/Malus|0})]]}} {{target=[[@{Sagesse}]]}}"
                             name='SAG' />
                        </div>
                        <div class="sheet-carac-lib">
                            Sagesse
                        </div>
                        <div class="sheet-carac-mod">
                            <input name="attr_MOD_SAG" type="number" class="sheet-carac-mod" value="0" />
                        </div>
                        <div style="display: inline-block;">JS (effets magiques)</div>
                    </div>
                    <div  style="display: table-row;">
                        <div class="sheet-carac-num">
                            <input name="attr_Charisme" type="number" class="sheet-carac-num" value="10" />
                        </div>
                        <div class="sheet-carac-roll">
                            <button type="roll"
                            value="&{template:pmt} {{perso=@{character_name}}} {{name=Charisme}} {{subtags=Jet de Caractéristique}} {{carac=[[1d20-(?{Bonus/Malus|0})]]}} {{target=[[@{Charisme}]]}}"
                             name='CHA' />
                        </div>
                        <div class="sheet-carac-lib">
                            Charisme
                        </div>
                        <div class="sheet-carac-mod">
                            <input name="attr_MOD_CHA" type="number" class="sheet-carac-mod" value="0" title="Ajustement aux réactions"/>
                        </div>
                        <div style="display: inline-block;">Réactions</div>
                        <div class="sheet-carac-roll">
                            <button type="roll"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Réactions}} {{subtags=Action}} {{talent=[[2d6cs1cf6+(@{MOD_CHA})-(?{Bonus/Malus|0})]]}} {{target=[[0]]}}"
                                name="Reactions" title="Jet de Réaction" />
                        </div>
                        <div class="sheet-carac-mod">
                            <input name="attr_MaxCompagnons" type="number" class="sheet-carac-mod" value="0" title="Nombre maximum de Compagnons d'Armes"/>
                        </div>
                        <div style="display: inline-block;">Compagnons</div>
                        <div class="sheet-carac-mod">
                            <input name="attr_MoralCompagnons" type="number" class="sheet-carac-mod" value="0" title="Moral desCompagnons d'Armes"/>
                        </div>
                        <div style="display: inline-block;">Moral</div>
                    </div>
                </div> <!-- FIN CARACS -->
            </div> <!-- FIN CELL carac -->
            <div style="display: table-cell"> <!-- CELL JS -->
                <div style="display: table; text-align: left;"> <!-- JS -->
                    <div  style="display: table-row;">
                        <div class="sheet-carac-num">
                            <input name="attr_JS_Souffles" type="number" class="sheet-carac-num" value="10" />
                        </div>
                        <div class="sheet-carac-roll">
                            <button type="roll"
                            value="&{template:pmt} {{perso=@{character_name}}} {{name=Souffles}} {{subtags=Jet de Sauvegarde}} {{JS=[[1d20+(?{Bonus/Malus|0})]]}} {{target=[[@{JS_Souffles}]]}}"
                             name='Souffles' />
                        </div>
                        <div class="sheet-js-lib">
                            Souffles
                        </div>
                    </div>
                    <div  style="display: table-row;">
                        <div class="sheet-carac-num">
                            <input name="attr_JS_Poison" type="number" class="sheet-carac-num" value="10" />
                        </div>
                        <div class="sheet-carac-roll">
                            <button type="roll"
                            value="&{template:pmt} {{perso=@{character_name}}} {{name=Poison et Mort}} {{subtags=Jet de Sauvegarde}} {{JS=[[1d20+(?{Bonus/Malus|0})]]}} {{target=[[@{JS_Poison}]]}}"
                             name='Poison' />
                        </div>
                        <div class="sheet-js-lib">
                            Poison, Mort
                        </div>
                    </div>
                    <div  style="display: table-row;">
                        <div class="sheet-carac-num">
                            <input name="attr_JS_Petrification" type="number" class="sheet-carac-num" value="10" />
                        </div>
                        <div class="sheet-carac-roll">
                            <button type="roll"
                            value="&{template:pmt} {{perso=@{character_name}}} {{name=Pétrification, Paralysie}} {{subtags=Jet de Sauvegarde}} {{JS=[[1d20+(?{Bonus/Malus|0})]]}} {{target=[[@{JS_Petrification}]]}}"
                             name='Petrification' />
                        </div>
                        <div class="sheet-js-lib">
                            Pétrification, Paralysie
                        </div>
                    </div>
                    <div  style="display: table-row;">
                        <div class="sheet-carac-num">
                            <input name="attr_JS_Baton" type="number" class="sheet-carac-num" value="10" />
                        </div>
                        <div class="sheet-carac-roll">
                            <button type="roll"
                            value="&{template:pmt} {{perso=@{character_name}}} {{name=Bâtons, Baguettes}} {{subtags=Jet de Sauvegarde}} {{JS=[[1d20+(?{Bonus/Malus|0})]]}} {{target=[[@{JS_Baton}]]}}"
                             name='Baton' />
                        </div>
                        <div class="sheet-js-lib">
                            Bâtons, Baguettes
                        </div>
                    </div>
                    <div  style="display: table-row;">
                        <div class="sheet-carac-num">
                            <input name="attr_JS_Sorts" type="number" class="sheet-carac-num" value="10" />
                        </div>
                        <div class="sheet-carac-roll">
                            <button type="roll"
                            value="&{template:pmt} {{perso=@{character_name}}} {{name=Sorts, Objets Magiques}} {{subtags=Jet de Sauvegarde}} {{JS=[[1d20+(?{Bonus/Malus|0})]]}} {{target=[[@{JS_Sorts}]]}}"
                             name='Sorts' />
                        </div>
                        <div class="sheet-js-lib">
                            Sorts, Objets Magiques
                        </div>
                    </div>
                </div> <!-- FIN JS et + -->
                <div class="sheet-optionCaAsc">
                    <div style="display: table; text-align: left;margin-top:4px;">
                        <div style="display:table-row">
                            <div style="display:table-cell">
                                <input name="attr_ATK_Bonus" type="number" class="sheet-inMainNum" value="0"
                                    title="Bonus aux attaques avec la règle optionnelle de CA ascendante"/>
                            </div>
                            <div  style="display:table-cell;margin-left:4px;padding-left:4px;" class="sheet-libel1">
                                Bonus à l'attaque
                            </div>
                        </div>
                    </div>
                </div>
            </div> <!-- FIN CELL JS -->
        </div> <!-- FIN LIGNE carac & JS -->
    </div> <!-- TABLE carac & JS -->
    <div class="sheet-optionCaDesc" style="width: 100%;text-align:center;">  <!-- TABLE CA -->
        <hr/>
        <div style="width: 100%;text-align:center;">
            <div style="display: table; width:100%;">
                <div style="display: table-row;text-align: center;">
                    <div style="display: table-cell; text-align: left;"><b>CA :</b></div>
                    <div style="display: table-cell;text-align: center;">-6</div>
                    <div style="display: table-cell;text-align: center;">-5</div>
                    <div style="display: table-cell;text-align: center;">-4</div>
                    <div style="display: table-cell;text-align: center;">-3</div>
                    <div style="display: table-cell;text-align: center;">-2</div>
                    <div style="display: table-cell;text-align: center;">-1</div>
                    <div style="display: table-cell;text-align: center;">0</div>
                    <div style="display: table-cell;text-align: center;">1</div>
                    <div style="display: table-cell;text-align: center;">2</div>
                    <div style="display: table-cell;text-align: center;">3</div>
                    <div style="display: table-cell;text-align: center;">4</div>
                    <div style="display: table-cell;text-align: center;">5</div>
                    <div style="display: table-cell;text-align: center;">6</div>
                    <div style="display: table-cell;text-align: center;">7</div>
                    <div style="display: table-cell;text-align: center;">8</div>
                    <div style="display: table-cell;text-align: center;">9</div>
                </div>
                <div style="display: table-row;text-align: center;">
                    <div style="display: table-cell; text-align: left;"><b>D20&gt;=&nbsp;</b></div>
                    <div style="display: table-cell;"><input type="number" value="20" name="attr_ToucheCAm6" class="sheet-inPetitNum" /></div>
                    <div style="display: table-cell;"><input type="number" value="20" name="attr_ToucheCAm5" class="sheet-inPetitNum" /></div>
                    <div style="display: table-cell;"><input type="number" value="20" name="attr_ToucheCAm4" class="sheet-inPetitNum" /></div>
                    <div style="display: table-cell;"><input type="number" value="20" name="attr_ToucheCAm3" class="sheet-inPetitNum" /></div>
                    <div style="display: table-cell;"><input type="number" value="20" name="attr_ToucheCAm2" class="sheet-inPetitNum" /></div>
                    <div style="display: table-cell;"><input type="number" value="20" name="attr_ToucheCAm1" class="sheet-inPetitNum" /></div>
                    <div style="display: table-cell;"><input type="number" value="19" name="attr_ToucheCA0" class="sheet-inPetitNum" /></div>
                    <div style="display: table-cell;"><input type="number" value="18" name="attr_ToucheCA1" class="sheet-inPetitNum" /></div>
                    <div style="display: table-cell;"><input type="number" value="17" name="attr_ToucheCA2" class="sheet-inPetitNum" /></div>
                    <div style="display: table-cell;"><input type="number" value="16" name="attr_ToucheCA3" class="sheet-inPetitNum" /></div>
                    <div style="display: table-cell;"><input type="number" value="15" name="attr_ToucheCA4" class="sheet-inPetitNum" /></div>
                    <div style="display: table-cell;"><input type="number" value="14" name="attr_ToucheCA5" class="sheet-inPetitNum" /></div>
                    <div style="display: table-cell;"><input type="number" value="13" name="attr_ToucheCA6" class="sheet-inPetitNum" /></div>
                    <div style="display: table-cell;"><input type="number" value="12" name="attr_ToucheCA7" class="sheet-inPetitNum" /></div>
                    <div style="display: table-cell;"><input type="number" value="11" name="attr_ToucheCA8" class="sheet-inPetitNum" /></div>
                    <div style="display: table-cell;"><input type="number" value="10" name="attr_ToucheCA9" class="sheet-inPetitNum" /></div>
                </div>
            </div>
        </div>
    </div> <!-- FIN TABLE CA -->
    <hr />
    <div class="sheet-titre1">ATTAQUES</div>
    <div style="display: table; width: 100%; text-align:left;"> <!-- Attaques -->
        <fieldset class="repeating_attaques">
            <div style="display: table-row;width: 100%;">
                <div style="display: table-cell; text-align: center;width: 45px;">
                    <button type="roll" name="Attaque"
                        value="&{template:pmt} {{perso=@{character_name}}} {{name=@{attaque-nom}}} {{subtags=Attaque}} {{attaque=[[1d20cs20cf1+(@{attaque-carac})[Modificateur de Caractéristique]+@{ATK_Bonus}[Attaque en CA ascendante]+(@{attaque-bonus})[Modificateur permanent]+(?{Bonus/Malus d'attaque|0})[Bonus/Malus]]]}} {{degats=[[@{attaque-degats-nbde}d@{attaque-degats-de}+(@{attaque-degats-carac})[Modificateur de caractéristique]+(@{attaque-degats-bonus})[Modificateur permanent]]]}} {{critique=[[@{attaque-degats-nbde}*@{attaque-degats-de}[Dés(s) de dégâts maximum]+(@{attaque-degats-carac})[Modificateur de Caractéristique]+(@{attaque-degats-bonus})[Modificateur permanent]]]}}"></button>
                </div>
                <div style="display: table-cell;width:470px;">
                    <input type="text" name="attr_attaque-nom" class="sheet-inMainTxt" style="width:280px;" placeholder="Nom de l'arme / attaque" />
                    1d20+<select name="attr_attaque-carac" size="1"  style="text-align: left; width: 60px;" title="Bonus de caractéristique à l'attaque">
                        <option value="0">-</option>
                        <option value="@{MOD_FOR}" selected>FOR</option>
                        <option value="@{MOD_DEX}">DEX</option>
                    </select>+<input type="number" name="attr_attaque-bonus" class="sheet-inMainNum" style="width: 45px;" title="Modificateur permanent au jet d'attaque (arme magique, capacité spéciale ...)" value="0" />
                </div>
                <div style="display: table-cell; text-align: right;">
                    <b>Dégâts</b>
                    <input type="number" name="attr_attaque-degats-nbde" class="sheet-inMainNum" style="width: 45px;" title="Nombre de dés de dégâts" value="1" /><select name="attr_attaque-degats-de" size="1"  style="text-align: right; width:55px;" title="Dé de dégâts">
                        <option value="4" selected>d4</option>
                        <option value="6">d6</option>
                        <option value="8">d8</option>
                        <option value="10">d10</option>
                        <option value="12">d12</option>
                    </select>+<select name="attr_attaque-degats-carac" size="1"  style="text-align: left; width: 60px;" title="Bonus de caractéristique aux dégâts">
                        <option value="0">-</option>
                        <option value="@{MOD_FOR}" selected>FOR</option>
                        <option value="@{MOD_DEX}">DEX</option>
                    </select>+<input type="number" name="attr_attaque-degats-bonus" class="sheet-inMainNum"  style="width: 45px;" title="Modificateur permanent au jet de dégâts (arme magique, capacité spéciale ...)" value="0" />
                </div>
            </div>
        </fieldset>
    </div> <!-- FIN Attaques -->
    <hr/>
    <table style="width:100%;"> <!-- TALENT et SORTS -->
        <tr>
            <td style="width: 410px;border-right: 1px solid black;padding:0px 5px 0px 0px;vertical-align:top;"> <!-- CELL TALENT  -->
                <div class="sheet-Clerc">  <!-- ACTION CLERC -->
                    <table style="width:100%;">
                        <tr>
                            <td>Forcer une Porte</td>
                            <td style="text-align:right;white-space: nowrap;">1d6-FOR&lt;=</td>
                            <td><input type="number" name="attr_actionforceporte" class="sheet-inPetitNum" value="2" /></td>
                            <td><button type="roll" name="ForcerPorte"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Forcer une Porte}} {{subtags=Action}} {{talent=[[1d6cs1cf6-(@{MOD_FOR})-(?{Bonus/Malus|0})]]}} {{target=[[@{actionforceporte}]]}}"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Détecter une Porte Secrète</td>
                            <td style="text-align:right;white-space: nowrap;">1d6&lt;=</td>
                            <td><input type="number" name="attr_actiondetectportehumain" class="sheet-inPetitNum" value="1" /></td>
                            <td><button type="roll" name="PorteSecrete"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Détecter Porte Secrète}} {{subtags=Action}} {{talent=[[1d6cs1cf6-(?{Bonus/Malus|0})]]}} {{target=[[@{actiondetectportehumain}]]}}"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Écouter</td>
                            <td style="text-align:right;white-space: nowrap;">1d6&lt;=</td>
                            <td><input type="number" name="attr_actionecouter" class="sheet-inPetitNum" value="1" /></td>
                            <td><button type="roll" name="Ecouter"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Écouter}} {{subtags=Action}} {{talent=[[1d6cs1cf6-(?{Bonus/Malus|0})]]}} {{target=[[@{actionecouter}]]}}"/>
                            </td>
                        </tr>
                    </table>
                </div> <!-- FIN ACTION CLERC -->
                <div class="sheet-Guerrier">  <!-- ACTION GUERRIER -->
                    <table style="width:100%;">
                        <tr>
                            <td>Forcer une Porte</td>
                            <td style="text-align:right;white-space: nowrap;">1d6-FOR&lt;=</td>
                            <td><input type="number" name="attr_actionforceporte" class="sheet-inPetitNum" value="2" /></td>
                            <td><button type="roll" name="ForcerPorte"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Forcer une Porte}} {{subtags=Action}} {{talent=[[1d6cs1cf6-(@{MOD_FOR})-(?{Bonus/Malus|0})]]}} {{target=[[@{actionforceporte}]]}}"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Détecter une Porte Secrète</td>
                            <td style="text-align:right;white-space: nowrap;">1d6&lt;=</td>
                            <td><input type="number" name="attr_actiondetectportehumain" class="sheet-inPetitNum" value="1" /></td>
                            <td><button type="roll" name="PorteSecrete"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Détecter Porte Secrète}} {{subtags=Action}} {{talent=[[1d6cs1cf6-(?{Bonus/Malus|0})]]}} {{target=[[@{actiondetectportehumain}]]}}"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Écouter</td>
                            <td style="text-align:right;white-space: nowrap;">1d6&lt;=</td>
                            <td><input type="number" name="attr_actionecouter" class="sheet-inPetitNum" value="1" /></td>
                            <td><button type="roll" name="Ecouter"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Écouter}} {{subtags=Action}} {{talent=[[1d6cs1cf6-(?{Bonus/Malus|0})]]}} {{target=[[@{actionecouter}]]}}"/>
                            </td>
                        </tr>
                    </table>
                </div> <!-- FIN ACTION GUERRIER -->
                <div class="sheet-Magicien">  <!-- ACTION MAGICIEN -->
                    <table style="width:100%;">
                        <tr>
                            <td>Forcer une Porte</td>
                            <td style="text-align:right;white-space: nowrap;">1d6-FOR&lt;=</td>
                            <td><input type="number" name="attr_actionforceporte" class="sheet-inPetitNum" value="2" /></td>
                            <td><button type="roll" name="ForcerPorte"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Forcer une Porte}} {{subtags=Action}} {{talent=[[1d6cs1cf6-(@{MOD_FOR})-(?{Bonus/Malus|0})]]}} {{target=[[@{actionforceporte}]]}}"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Détecter une Porte Secrète</td>
                            <td style="text-align:right;white-space: nowrap;">1d6&lt;=</td>
                            <td><input type="number" name="attr_actiondetectportehumain" class="sheet-inPetitNum" value="1" /></td>
                            <td><button type="roll" name="PorteSecrete"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Détecter Porte Secrète}} {{subtags=Action}} {{talent=[[1d6cs1cf6-(?{Bonus/Malus|0})]]}} {{target=[[@{actiondetectportehumain}]]}}"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Écouter</td>
                            <td style="text-align:right;white-space: nowrap;">1d6&lt;=</td>
                            <td><input type="number" name="attr_actionecouter" class="sheet-inPetitNum" value="1" /></td>
                            <td><button type="roll" name="Ecouter"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Écouter}} {{subtags=Action}} {{talent=[[1d6cs1cf6-(?{Bonus/Malus|0})]]}} {{target=[[@{actionecouter}]]}}"/>
                            </td>
                        </tr>
                    </table>
                </div> <!-- FIN ACTION MAGICIEN -->
                <div class="sheet-Voleur">  <!-- ACTION VOLEUR -->
                    <table style="width:100%;">
                        <tr>
                            <td>Forcer une Porte</td>
                            <td style="text-align:right;white-space: nowrap;">1d6-FOR&lt;=</td>
                            <td><input type="number" name="attr_actionforceporte" class="sheet-inPetitNum" value="2" /></td>
                            <td><button type="roll" name="ForcerPorte"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Forcer une Porte}} {{subtags=Action}} {{talent=[[1d6cs1cf6-(@{MOD_FOR})-(?{Bonus/Malus|0})]]}} {{target=[[@{actionforceporte}]]}}"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Détecter une Porte Secrète</td>
                            <td style="text-align:right;white-space: nowrap;">1d6&lt;=</td>
                            <td><input type="number" name="attr_actiondetectportehumain" class="sheet-inPetitNum" value="1" /></td>
                            <td><button type="roll" name="PorteSecrete"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Détecter Porte Secrète}} {{subtags=Action}} {{talent=[[1d6cs1cf6-(?{Bonus/Malus|0})]]}} {{target=[[@{actiondetectportehumain}]]}}"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Surprise</td>
                            <td style="text-align:right;white-space: nowrap;">1d6&gt;</td>
                            <td><input type="number" name="attr_actionsurprise" class="sheet-inPetitNum" value="2" /></td>
                            <td><button type="roll" name="Surprise"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Surprise}} {{subtags=Action}} {{talent=[[1d6+(?{Bonus/Malus|0})]]}} {{suptarget=[[@{actionsurprise}]]}}"/>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="4">Coup Sournois (adversaire ignorant la présence du voleur) : Attaque+4, Dégâts*2.</td>
                        </tr>
                        <tr>
                            <td>Déchiffrage</td>
                            <td>(niveau 4+)</td>
                            <td><input type="number" name="attr_compvoldechiffrage" class="sheet-inPetitNum" value="80" /> %</td>
                            <td><button type="roll" name="Dechiffrage"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Déchiffrage}} {{subtags=Capacité Spéciale}} {{talent=[[1d100cs1cf100-(?{Bonus/Malus|0})]]}} {{target=[[@{compvoldechiffrage}]]}}"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Magicien dilettante</td>
                            <td>(niveau 10+)</td>
                            <td><input type="number" name="attr_compvolmage" class="sheet-inPetitNum" value="90" /> %</td>
                            <td><button type="roll" name="MagicienDilettante"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Magicien dilettante}} {{subtags=Capacité Spéciale}} {{talent=[[1d100cs1cf100-(?{Bonus/Malus|0})]]}} {{target=[[@{compvolmage}]]}}"/>
                            </td>
                        </tr>
                    </table>
                </div> <!-- FIN ACTION VOLEUR -->
                <div class="sheet-Elfe">  <!-- ACTION ELFE -->
                    <table style="width:100%;">
                        <tr>
                            <td>Forcer une Porte</td>
                            <td style="text-align:right;white-space: nowrap;">1d6-FOR&lt;=</td>
                            <td><input type="number" name="attr_actionforceporte" class="sheet-inPetitNum" value="2" /></td>
                            <td><button type="roll" name="ForcerPorte"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Forcer une Porte}} {{subtags=Action}} {{talent=[[1d6cs1cf6-(@{MOD_FOR})-(?{Bonus/Malus|0})]]}} {{target=[[@{actionforceporte}]]}}"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Détecter une Porte Secrète</td>
                            <td style="text-align:right;white-space: nowrap;">1d6&lt;=</td>
                            <td><input type="number" name="attr_actiondetectporteelfe" class="sheet-inPetitNum" value="2" /></td>
                            <td><button type="roll" name="PorteSecrete"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Détecter Porte Secrète}} {{subtags=Action}} {{talent=[[1d6cs1cf6-(?{Bonus/Malus|0})]]}} {{target=[[@{actiondetectporteelfe}]]}}"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Écouter</td>
                            <td style="text-align:right;white-space: nowrap;">1d6&lt;=</td>
                            <td><input type="number" name="attr_actionecouterelfe" class="sheet-inPetitNum" value="2" /></td>
                            <td><button type="roll" name="Ecouter"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Écouter}} {{subtags=Action}} {{talent=[[1d6cs1cf6-(?{Bonus/Malus|0})]]}} {{target=[[@{actionecouterelfe}]]}}"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Surprise</td>
                            <td style="text-align:right;white-space: nowrap;">1d6&gt;</td>
                            <td><input type="number" name="attr_actionsurprise" class="sheet-inPetitNum" value="2" /></td>
                            <td><button type="roll" name="Surprise"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Surprise}} {{subtags=Action}} {{talent=[[1d6+(?{Bonus/Malus|0})]]}} {{suptarget=[[@{actionsurprise}]]}}"/>
                            </td>
                        </tr>
                    </table>
                </div> <!-- FIN ACTION ELFE -->
                <div class="sheet-Halfelin">  <!-- ACTION HALFELIN -->
                    <table style="width:100%;">
                        <tr>
                            <td>Forcer une Porte</td>
                            <td style="text-align:right;white-space: nowrap;">1d6-FOR&lt;=</td>
                            <td><input type="number" name="attr_actionforceporte" class="sheet-inPetitNum" value="2" /></td>
                            <td><button type="roll" name="ForcerPorte"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Forcer une Porte}} {{subtags=Action}} {{talent=[[1d6cs1cf6-(@{MOD_FOR})-(?{Bonus/Malus|0})]]}} {{target=[[@{actionforceporte}]]}}"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Détecter une Porte Secrète</td>
                            <td style="text-align:right;white-space: nowrap;">1d6&lt;=</td>
                            <td><input type="number" name="attr_actiondetectportehumain" class="sheet-inPetitNum" value="1" /></td>
                            <td><button type="roll" name="PorteSecrete"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Détecter Porte Secrète}} {{subtags=Action}} {{talent=[[1d6cs1cf6-(?{Bonus/Malus|0})]]}} {{target=[[@{actiondetectportehumain}]]}}"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Écouter</td>
                            <td style="text-align:right;white-space: nowrap;">1d6&lt;=</td>
                            <td><input type="number" name="attr_actionecouterelfe" class="sheet-inPetitNum" value="2" /></td>
                            <td><button type="roll" name="Ecouter"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Écouter}} {{subtags=Action}} {{talent=[[1d6cs1cf6-(?{Bonus/Malus|0})]]}} {{target=[[@{actionecouterelfe}]]}}"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Détecter un Piège</td>
                            <td style="text-align:right;white-space: nowrap;">1d6&lt;=</td>
                            <td><input type="number" name="attr_actiondetecter" class="sheet-inPetitNum" value="1" /></td>
                            <td><button type="roll" name="DetecterPiege"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Détecter un Piège}} {{subtags=Action}} {{talent=[[1d6cs1cf6-(?{Bonus/Malus|0})]]}} {{target=[[@{actiondetecter}]]}}"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Surprise</td>
                            <td style="text-align:right;white-space: nowrap;">1d6&gt;</td>
                            <td><input type="number" name="attr_actionsurprise" class="sheet-inPetitNum" value="2" /></td>
                            <td><button type="roll" name="Surprise"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Surprise}} {{subtags=Action}} {{talent=[[1d6+(?{Bonus/Malus|0})]]}} {{suptarget=[[@{actionsurprise}]]}}"/>
                            </td>
                        </tr>
                    </table>
                </div> <!-- FIN ACTION HALFELIN -->
                <div class="sheet-Nain">  <!-- ACTION NAIN -->
                    <table style="width:100%;">
                        <tr>
                            <td>Forcer une Porte</td>
                            <td style="text-align:right;white-space: nowrap;">1d6-FOR&lt;=</td>
                            <td><input type="number" name="attr_actionforceporte" class="sheet-inPetitNum" value="2" /></td>
                            <td><button type="roll" name="ForcerPorte"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Forcer une Porte}} {{subtags=Action}} {{talent=[[1d6cs1cf6-(@{MOD_FOR})-(?{Bonus/Malus|0})]]}} {{target=[[@{actionforceporte}]]}}"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Détecter une Porte Secrète</td>
                            <td style="text-align:right;white-space: nowrap;">1d6&lt;=</td>
                            <td><input type="number" name="attr_actiondetectportehumain" class="sheet-inPetitNum" value="1" /></td>
                            <td><button type="roll" name="PorteSecrete"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Détecter Porte Secrète}} {{subtags=Action}} {{talent=[[1d6cs1cf6-(?{Bonus/Malus|0})]]}} {{target=[[@{actiondetectportehumain}]]}}"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Écouter</td>
                            <td style="text-align:right;white-space: nowrap;">1d6&lt;=</td>
                            <td><input type="number" name="attr_actionecouterelfe" class="sheet-inPetitNum" value="2" /></td>
                            <td><button type="roll" name="Ecouter"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Écouter}} {{subtags=Action}} {{talent=[[1d6cs1cf6-(?{Bonus/Malus|0})]]}} {{target=[[@{actionecouterelfe}]]}}"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Surprise</td>
                            <td style="text-align:right;white-space: nowrap;">1d6&gt;</td>
                            <td><input type="number" name="attr_actionsurprise" class="sheet-inPetitNum" value="2" /></td>
                            <td><button type="roll" name="Surprise"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Surprise}} {{subtags=Action}} {{talent=[[1d6+(?{Bonus/Malus|0})]]}} {{suptarget=[[@{actionsurprise}]]}}"/>
                            </td>
                        </tr>
                    </table>
                </div> <!-- FIN ACTION NAIN -->
            </td> <!-- FIN CELL Talents -->
            <td style="vertical-align:top;text-align:left;padding:0px 0px 0px 5px;"> <!-- CELL SORTS et talents suite -->
                <div class="sheet-Clerc">  <!-- ACTION CLERC -->
                    <table style="width:100%;">
                        <tr>
                            <td>Détecter un Piège</td>
                            <td style="text-align:right;white-space: nowrap;">1d6&lt;=</td>
                            <td><input type="number" name="attr_actiondetecter" class="sheet-inPetitNum" value="1" /></td>
                            <td><button type="roll" name="DetecterPiege"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Détecter un Piège}} {{subtags=Action}} {{talent=[[1d6cs1cf6-(?{Bonus/Malus|0})]]}} {{target=[[@{actiondetecter}]]}}"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Surprise</td>
                            <td style="text-align:right;white-space: nowrap;">1d6&gt;</td>
                            <td><input type="number" name="attr_actionsurprise" class="sheet-inPetitNum" value="2" /></td>
                            <td><button type="roll" name="Surprise"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Surprise}} {{subtags=Action}} {{talent=[[1d6+(?{Bonus/Malus|0})]]}} {{suptarget=[[@{actionsurprise}]]}}"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Renvoi des mort-vivants</td>
                            <td style="text-align:right;white-space: nowrap;">2d6</td>
                            <td></td>
                            <td><button type="roll" name="Renvoi"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Renvoi des mort-vivants}} {{subtags=Capacité Spéciale}} {{talent=[[2d6+(?{Bonus/Malus|0})]]}} {{suptarget=[[0]]}}"/>
                            </td>
                        </tr>
                    </table>
                </div> <!-- FIN ACTION CLERC -->
                <div class="sheet-Guerrier">  <!-- ACTION GUERRIER -->
                    <table style="width:100%;">
                        <tr>
                            <td>Détecter un Piège</td>
                            <td style="text-align:right;white-space: nowrap;">1d6&lt;=</td>
                            <td><input type="number" name="attr_actiondetecter" class="sheet-inPetitNum" value="1" /></td>
                            <td><button type="roll" name="DetecterPiege"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Détecter un Piège}} {{subtags=Action}} {{talent=[[1d6cs1cf6-(?{Bonus/Malus|0})]]}} {{target=[[@{actiondetecter}]]}}"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Surprise</td>
                            <td style="text-align:right;white-space: nowrap;">1d6&gt;</td>
                            <td><input type="number" name="attr_actionsurprise" class="sheet-inPetitNum" value="2" /></td>
                            <td><button type="roll" name="Surprise"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Surprise}} {{subtags=Action}} {{talent=[[1d6+(?{Bonus/Malus|0})]]}} {{suptarget=[[@{actionsurprise}]]}}"/>
                            </td>
                        </tr>
                    </table>
                </div> <!-- FIN ACTION GUERRIER -->
                <div class="sheet-Magicien">  <!-- ACTION MAGICIEN -->
                    <table style="width:100%;">
                        <tr>
                            <td>Détecter un Piège</td>
                            <td style="text-align:right;white-space: nowrap;">1d6&lt;=</td>
                            <td><input type="number" name="attr_actiondetecter" class="sheet-inPetitNum" value="1" /></td>
                            <td><button type="roll" name="DetecterPiege"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Détecter un Piège}} {{subtags=Action}} {{talent=[[1d6cs1cf6-(?{Bonus/Malus|0})]]}} {{target=[[@{actiondetecter}]]}}"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Surprise</td>
                            <td style="text-align:right;white-space: nowrap;">1d6&gt;</td>
                            <td><input type="number" name="attr_actionsurprise" class="sheet-inPetitNum" value="2" /></td>
                            <td><button type="roll" name="Surprise"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Surprise}} {{subtags=Action}} {{talent=[[1d6+(?{Bonus/Malus|0})]]}} {{suptarget=[[@{actionsurprise}]]}}"/>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="4">Création de sorts (niveau 9+) : le magicien peut créer des sorts et des objets magiques.</td>
                        </tr>
                    </table>
                </div> <!-- FIN ACTION MAGICIEN -->
                <div class="sheet-Voleur"> <!-- COMPÉTENCES DE VOLEUR -->
                    <table style="width:100%;">
                        <tr>
                            <td>Crochetage</td>
                            <td><input type="number" name="attr_compvolcrochetage" class="sheet-inPetitNum" value="25" /> %</td>
                            <td><button type="roll" name="Crochetage"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Crochetage}} {{subtags=Compétence de Voleur}} {{talent=[[1d100cs1cf100-(?{Bonus/Malus|0})]]}} {{target=[[@{compvolcrochetage}]]}}"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Détection / Désamorçage</td>
                            <td><input type="number" name="attr_compvoldetection" class="sheet-inPetitNum" value="20" /> %</td>
                            <td><button type="roll" name="Detection"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Détection / Désamorçage}} {{subtags=Compétence de Voleur}} {{talent=[[1d100cs1cf100-(?{Bonus/Malus|0})]]}} {{target=[[@{compvoldetection}]]}}"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Vol à la tire</td>
                            <td><input type="number" name="attr_compvolvol" class="sheet-inPetitNum" value="30" /> %</td>
                            <td><button type="roll" name="Vol"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Vol à la tire}} {{subtags=Compétence de Voleur}} {{talent=[[1d100cs1cf100-(?{Bonus/Malus|0})]]}} {{target=[[@{compvolvol}]]}}"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Déplacement silencieux</td>
                            <td><input type="number" name="attr_compvoldeplacement" class="sheet-inPetitNum" value="25" /> %</td>
                            <td><button type="roll" name="Deplacement"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Déplacement silencieux}} {{subtags=Compétence de Voleur}} {{talent=[[1d100cs1cf100-(?{Bonus/Malus|0})]]}} {{target=[[@{compvoldeplacement}]]}}"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Escalade</td>
                            <td><input type="number" name="attr_compvolescalade" class="sheet-inPetitNum" value="80" /> %</td>
                            <td><button type="roll" name="Escalade"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Escalade}} {{subtags=Compétence de Voleur}} {{talent=[[1d100cs1cf100-(?{Bonus/Malus|0})]]}} {{target=[[@{compvolescalade}]]}}"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Dissimulation</td>
                            <td><input type="number" name="attr_compvoldissimulation" class="sheet-inPetitNum" value="10" /> %</td>
                            <td><button type="roll" name="Dissimulation"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Dissimulation}} {{subtags=Compétence de Voleur}} {{talent=[[1d100cs1cf100-(?{Bonus/Malus|0})]]}} {{target=[[@{compvoldissimulation}]]}}"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Écoute</td>
                            <td><input type="number" name="attr_compvolecoute" class="sheet-inPetitNum" value="30" /> %</td>
                            <td><button type="roll" name="Ecoute"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Écoute}} {{subtags=Compétence de Voleur}} {{talent=[[1d100cs1cf100-(?{Bonus/Malus|0})]]}} {{target=[[@{compvolecoute}]]}}"/>
                            </td>
                        </tr>
                    </table>
                </div>  <!-- FIN COMPÉTENCES DE VOLEUR -->
                <div class="sheet-Elfe">  <!-- ACTION ELFE -->
                    <table style="width:100%;">
                        <tr>
                            <td>Détecter un Piège</td>
                            <td style="text-align:right;white-space: nowrap;">1d6&lt;=</td>
                            <td><input type="number" name="attr_actiondetecter" class="sheet-inPetitNum" value="1" /></td>
                            <td><button type="roll" name="DetecterPiege"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Détecter un Piège}} {{subtags=Action}} {{talent=[[1d6cs1cf6-(?{Bonus/Malus|0})]]}} {{target=[[@{actiondetecter}]]}}"/>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="4">Infravision 18m.</td>
                        </tr>
                        <tr>
                            <td colspan="4">Immunité à la paralysie des goules.</td>
                        </tr>
                        <tr>
                            <td colspan="4">Langues supplémentaires : elfe, gnoll, hobgobelin, orc.</td>
                        </tr>
                    </table>
                </div> <!-- FIN ACTION ELFE -->
                <div class="sheet-Halfelin">  <!-- ACTION HALFELIN -->
                    <table style="width:100%;">
                        <tr>
                            <td>Discrétion</td>
                            <td>(Bois)</td>
                            <td><input type="number" name="attr_halfdiscbois" class="sheet-inPetitNum" value="90" /> %</td>
                            <td><button type="roll" name="DiscretionBois"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Discrétion (Bois)}} {{subtags=Capacité Spéciale}} {{talent=[[1d100cs1cf100-(?{Bonus/Malus|0})]]}} {{target=[[@{halfdiscbois}]]}}"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Discrétion</td>
                            <td>(Donjon)</td>
                            <td><input type="number" name="attr_halfdiscdonj" class="sheet-inPetitNum" value="33" /> %</td>
                            <td><button type="roll" name="DiscretionDonjon"
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Discrétion (Donjon)}} {{subtags=Capacité Spéciale}} {{talent=[[1d100cs1cf100-(?{Bonus/Malus|0})]]}} {{target=[[@{halfdiscdonj}]]}}"/>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="4">Petit : -2 (+2) à la CA contre les adversaires plus grands que les humains.</td>
                        </tr>
                        <tr>
                            <td colspan="4">Tireur d'élite : +1 aux attaques avec armes à projectile.</td>
                        </tr>
                        <tr>
                            <td colspan="4">Vivacité : +1 au jet d'initiative (seul ou groupe de halfelins).</td>
                        </tr>
                    </table>
                </div> <!-- FIN ACTION HALFELIN -->
                <div class="sheet-Nain">  <!-- ACTION NAIN -->
                    <table style="width:100%;">
                        <tr>
                            <td>Détection</td>
                            <td style="text-align:right;white-space: nowrap;">1d6&lt;=</td>
                            <td><input type="number" name="attr_actiondetecternain" class="sheet-inPetitNum" value="2" title="Détection : s’il est en train de fouiller activement les environs, le nain a 2 chances sur 6 (1-2 sur 1d6) de détecter des pièges, des murs illusoires, des constructions cachées, ou de remarquer des passages inclinés." /></td>
                            <td><button type="roll" name="Detection"  title="Détection : s’il est en train de fouiller activement les environs, le nain a 2 chances sur 6 (1-2 sur 1d6) de détecter des pièges, des murs illusoires, des constructions cachées, ou de remarquer des passages inclinés."
                                value="&{template:pmt} {{perso=@{character_name}}} {{name=Détection}} {{subtags=Action}} {{talent=[[1d6cs1cf6-(?{Bonus/Malus|0})]]}} {{target=[[@{actiondetecternain}]]}}"/>
                            </td>
                        </tr>
                       <tr>
                            <td colspan="2">Infravision 18m.</td>
                        </tr>
                       <tr>
                            <td colspan="2">Résistance à la magie.</td>
                       </tr>
                        <tr>
                            <td colspan="4">Langues supplémentaires : nain, gobelin, gnome, kobold.</td>
                        </tr>
                    </table>
                </div> <!-- FIN ACTION NAIN -->
            </td> <!-- FIN CELL SORTS et talents suite -->
        </tr>
    </table> <!-- FIN TALENT  -->
    <div class="sheet-sorts"> <!-- SORTS -->
        <hr/>
        <table style="width:100%;">
            <tr>
                <td><div class="sheet-titre1">SORTS</div></td>
                <td>
                    <div style="text-align: right;">
                        Sorts mémorisés par Niveau de sort :
                        1|<input type= "number" class="sheet-carac-mod" name="attr_nbsortniv1" value="0" title="Nombre de sorts de niveau 1" />
                        2|<input type= "number" class="sheet-carac-mod" name="attr_nbsortniv2" value="0" title="Nombre de sorts de niveau 2" />
                        3|<input type= "number" class="sheet-carac-mod" name="attr_nbsortniv3" value="0" title="Nombre de sorts de niveau 3" />
                        4|<input type= "number" class="sheet-carac-mod" name="attr_nbsortniv4" value="0" title="Nombre de sorts de niveau 4" />
                        5|<input type= "number" class="sheet-carac-mod" name="attr_nbsortniv5" value="0" title="Nombre de sorts de niveau 5" />
                        6|<input type= "number" class="sheet-carac-mod" name="attr_nbsortniv6" value="0" title="Nombre de sorts de niveau 6" />
                        7|<input type= "number" class="sheet-carac-mod" name="attr_nbsortniv7" value="0" title="Nombre de sorts de niveau 7" />
                    </div>
                </td>
            </tr>
        </table>
        <fieldset class="repeating_sorts">
            <div style="display: inline-block;white-space: nowrap;width:100%; text-align:left;">
                <button type="roll" class="sheet-btDesc" title="Montrer dans le chat" value="&{template:pmt} {{perso=@{character_name}}} {{name=@{sort-nom}}} {{subtags=Sort}} {{sort=1}} {{reversible=[[@{sort-reversible}]]}} {{sortniveau=@{sort-niveau}}} {{sortduree=@{sort-duree}}} {{sortportee=@{sort-portee}}} {{sortdesc=@{sort-desc}}} "></button>
                <input type="text" name="attr_sort-nom" class="sheet-inMainTxt" style="width: 185px;" placeholder="Nom du sort" title="Nom du sort" />
                R<input type="checkbox" name="attr_sort-reversible" value="1" style="margin-right: -7px;" title="Sort réversible" />
                <input type="text" name="attr_sort-niveau" class="sheet-inMainNum"  style="width: 20px;" placeholder="1" title="Niveau du sort" />
                <input type="text" name="attr_sort-duree" class="sheet-inPetitTxt"  style="width: 80px;" placeholder="Durée" title="Durée du sort" />
                <input type="text" name="attr_sort-portee" class="sheet-inPetitTxt"  style="width: 50px;" placeholder="Portée" title="Portée du sort" />
                <input type="checkbox" name="attr_sort-disp" class="sheet-dispcheck" title="Agrandir/Réduire la description" /><span class="sheet-dispcheck">s</span>
                <textarea name="attr_sort-desc" class="sheet-textdesc" style="width: 300px;" placeholder="Description" title="Description du sort"></textarea>
                P<input type="checkbox" name="attr_sort-prepare1" title="Sort préparé une fois" style="margin-right: -7px;" />
                <input type="checkbox" name="attr_sort-prepare2" title="Sort préparé deux fois" style="margin-right: -7px;" />
                <input type="checkbox" name="attr_sort-prepare3" title="Sort préparé trois fois" style="margin-right: -7px;" />
            </div>
        </fieldset>
    </div>  <!-- FIN SORTS -->
    <hr/>
    <div style="display: table; text-align:left; width:100%;"> <!-- EQUIPEMENT -->
        <div style="display: table-row; width:100%;">
            <div  class="sheet-titre1" style="width:150px;">POSSESSIONS</div>
            <div style="display: table-cell;text-align:right;width:calc(100%-15px);"> <!-- CELL EQUIP LISTE -->
                Richesses
                <input name="attr_equip-pc" title="Pièces de Cuivre (pc)" class="sheet-inMainNum" type="number" style="width: 65px;" value="0" />
                pc
                <input name="attr_equip-pa" title="Pièces d'Argent (pa)" class="sheet-inMainNum" type="number" style="width: 65px;" value="0" />
                pa
                <input name="attr_equip-pe" title="Pièces d'Électrum (pe)" class="sheet-inMainNum" type="number" style="width: 65px;" value="0" />
                pe
                <input name="attr_equip-po" title="Pièces d'Or (po)" class="sheet-inMainNum" type="number" style="width: 65px;" value="0" />
                po
                <input name="attr_equip-pp" title="Pièces de Platine (pp)" class="sheet-inMainNum" type="number" style="width: 65px;" value="0" />
                pp
            </div>
        </div>
    </div>
    <br/>
    <div style="display: table; text-align:left; width:100%;">  <!-- Encombrement et deplacmeent -->
        <div style="display: table-row; width:100%;">
            <div style="display:table-cell;"><b>Encombrement</b></div>
            <div style="display: table-cell;">&nbsp;</div>
            <div style="display: table-cell;">Exploration</div>
            <div style="display: table-cell;">Combat</div>
            <div style="display: table-cell;">Course</div>
            <div style="display: table-cell;">Extérieur</div>
        </div>
        <div style="display: table-row; width:100%;">
            <div style="display:table-cell;text-align: center;">
                <input type="text" name="attr_encombrement" class="sheet-inPetitNum" title="Encombrement : poids total transporté par le personnage" value="0" readonly />
                kg
            </div>
            <div style="display: table-cell;text-align:right;"><b>Mouvement&nbsp;</b></div>
            <div style="display:table-cell;">
                <input type="number" name="attr_mvtexploration" class="sheet-inPetitNum" title="Distance parcourue par le personnage en un tour d'exploration" value="36"/>
                m/tour
            </div>
            <div style="display:table-cell;">
                <input type="number" name="attr_mvtcombat" class="sheet-inPetitNum" title="Distance parcourue par le personnage en un round de combat" value="12"/>
                m/round
            </div>
            <div style="display:table-cell;">
                <input type="number" name="attr_mvtcourse" class="sheet-inPetitNum" title="Distance parcourue par le personnage en un round de course" value="36"/>
                m/round
            </div>
            <div style="display:table-cell;">
                <input type="number" name="attr_mvtexterieur" class="sheet-inPetitNum" style="max-width: 50px; width: 50px;" title="Distance parcourue par le personnage en un tour à l'extérieur" value="108"/>
                m/tour
            </div>
        </div> <!-- Fin Encombrement et deplacmeent -->
    </div>
    <br/>
    <div style="display: table; text-align:left; width:100%;"> <!-- EQUIPEMENT suite -->
        <div style="display: table-row;">
            <div style="display: table-cell;"> <!-- CELL EQUIP LISTE -->
                <table style="width:100%;">
                    <tr>
                        <td class="sheet-libel1" style="width:320px;">Liste d'équipements</td>
                        <td style="width:50px;">Qté</td>
                        <td style="width:60px;">Poids</td>
                        <td style="width:50px;">Tot.</td>
                    </tr>
                </table>
                <fieldset class="repeating_equipement" >
                    <div style="display: table-row;">
                        <div style="display: table-cell;">
                                <input type="text" name="attr_equipnom" class="sheet-inMainTxt" style="width: 310px;" placeholder="Nom de l'équipement" />
                                <input type="number" name="attr_equipqte" class="sheet-inMainNum"  style="width: 50px;" value="1" title="Quantité" />
                                <input type="number" name="attr_equippoids" class="sheet-inMainNum"  style="width: 60px;" value="0" title="Poids unitaire" />
                                <input type="text" name="attr_equippoidstot" class="sheet-inMainNum"  style="width: 50px;" value="0" title="Poids total" readonly />
                        </div>
                    </div>
                </fieldset>
            </div> <!-- FIN CELL EQUIP LISTE -->
            <div style="display:table-cell;border-left: 1px solid black;padding:5px;"></div>
            <div style="display: table-cell;width:300px;"> <!-- CELL EQUIP DIVERS -->
                <div class="sheet-libel1">Divers</div>
                <textarea name="attr_equip-divers"  title="Équipement divers" placeholder="Notes & Équipement divers"></textarea>
            </div> <!-- FIN CELL EQUIP DIVERS -->
        </div>
    </div> <!-- FIN EQUIPEMENT -->
</div>
<!--- templates -->
<rolltemplate class="sheet-rolltemplate-pmt">
    <table>
        {{#perso}}
            <td style="text-align:left;"><b>{{perso}}</b></td></tr>
            <tr><td><hr/></td></tr>
        {{/perso}}
        <tr><td class="subheader">{{subtags}}</td></tr>
        <tr>
            <th>
                {{name}}
                {{#sort}}
                    {{#rollTotal() reversible 1}}(réversible){{/rollTotal() reversible 1}}
                {{/sort}}
            </th>
        </tr>
        <tr><td><hr/></td></tr>
        {{#sort}}
            <tr><td><span class="tcat">Niveau : </span>{{sortniveau}}</td></tr>
            <tr><td><span class="tcat">Durée : </span>{{sortduree}}</td></tr>
            <tr><td><span class="tcat">Portée : </span>{{sortportee}}</td></tr>
            <tr><td><span class="tcat">Desc. : </span></td></tr>
            <tr><td><div class="sheet-jetdesc">{{sortdesc}}</div></td></tr>
        {{/sort}}
        {{#DV}}
            <tr><td><span class="tcat">PV gagnés : </span>{{DV}}</td></tr>
        {{/DV}}
        {{#carac}}
            <tr><td><span class="tcat">Jet : </span>{{carac}} &lt;= {{target}}</td></tr>
            {{#rollGreater() carac target}}
                <tr><td class="subheader" style="color:red;"><b>Échec !</b></td></tr>
            {{/rollGreater() carac target}}
            {{#rollTotal() carac target}}
                <tr><td class="subheader" style="color:green;"><b>Réussite !</b></td></tr>
            {{/rollTotal() carac target}}
            {{#rollLess() carac target}}
                <tr><td class="subheader" style="color:green;"><b>Réussite !</b></td></tr>
            {{/rollLess() carac target}}
        {{/carac}}
        {{#JS}}
            <tr><td><span class="tcat">Jet : </span>{{JS}} &gt;= {{target}}</td></tr>
            {{#rollGreater() JS target}}
                <tr><td class="subheader" style="color:green;"><b>Réussite !</b></td></tr>
            {{/rollGreater() JS target}}
            {{#rollTotal() JS target}}
                <tr><td class="subheader" style="color:green;"><b>Réussite !</b></td></tr>
            {{/rollTotal() JS target}}
            {{#rollLess() JS target}}
                <tr><td class="subheader" style="color:red;"><b>Échec !</b></td></tr>
            {{/rollLess() JS target}}
        {{/JS}}
        {{#talent}}
            {{#target}}
                {{#rollTotal() target 0}}
                    <tr><td><span class="tcat">Jet : </span>{{talent}}</td></tr>
                {{/rollTotal() target 0}}
                {{#rollGreater() target 0}}
                    <tr><td><span class="tcat">Jet : </span>{{talent}} &lt;= {{target}}</td></tr>
                    {{#rollGreater() talent target}}
                        <tr><td class="subheader" style="color:red;"><b>Échec !</b></td></tr>
                    {{/rollGreater() talent target}}
                    {{#rollTotal() talent target}}
                        <tr><td class="subheader" style="color:green;"><b>Réussite !</b></td></tr>
                    {{/rollTotal() talent target}}
                    {{#rollLess() talent target}}
                        <tr><td class="subheader" style="color:green;"><b>Réussite !</b></td></tr>
                    {{/rollLess() talent target}}
                {{/rollGreater() target 0}}
            {{/target}}
            {{#suptarget}}
                {{#rollTotal() suptarget 0}}
                    <tr><td><span class="tcat">Jet : </span>{{talent}}</td></tr>
                {{/rollTotal() suptarget 0}}
                {{#rollGreater() suptarget 0}}
                    <tr><td><span class="tcat">Jet : </span>{{talent}} &gt; {{suptarget}}</td></tr>
                    {{#rollGreater() talent suptarget}}
                        <tr><td class="subheader" style="color:green;"><b>Réussite !</b></td></tr>
                    {{/rollGreater() talent suptarget}}
                    {{#rollTotal() talent suptarget}}
                        <tr><td class="subheader" style="color:red;"><b>Échec !</b></td></tr>
                    {{/rollTotal() talent suptarget}}
                    {{#rollLess() talent suptarget}}
                        <tr><td class="subheader" style="color:red;"><b>Échec !</b></td></tr>
                    {{/rollLess() talent suptarget}}
                {{/rollGreater() suptarget 0}}
            {{/suptarget}}
        {{/talent}}
        {{#attaque}}
            <tr><td><span class="tcat">Jet : </span>{{attaque}} contre CA</td></tr>
            {{#degats}}
                {{#rollLess() degats 1}}
                    <tr><td><span class="tcat">Dégâts : </span>1</td></tr>
                {{/rollLess() degats 1}}
                {{#rollGreater() degats 0}}
                    <tr><td><span class="tcat">Dégâts : </span>{{degats}}</td></tr>
                {{/rollGreater() degats 0}}
            {{/degats}}
            {{#rollWasCrit() attaque}}
                <tr><td><span class="tcat">Dégâts maximum : </span>{{critique}}</td></tr>
                <tr><td><hr/></td></tr>
                <tr><td class="subheader" style="color:green;"><b>Coup de Maître !</b></td></tr>
            {{/rollWasCrit() attaque}}
            {{#rollWasFumble() attaque}}
                <tr><td><hr/></td></tr>
                <tr><td class="subheader" style="color:red;"><b>Fumble !</b></td></tr>
            {{/rollWasFumble() attaque}}
        {{/attaque}}
    </table>
</rolltemplate>
<rolltemplate class="sheet-rolltemplate-pmtchar">
    <table>
        <tr><th colspan="2">{{name}}</th></tr>
        <tr><td colspan="2"><hr/></td></tr>
        {{#tabcar}}
            <tr><td><span class="tcat">Force</span></td><td style="text-align:right;">{{for}}</td></tr>
            <tr><td><span class="tcat">Dextérité</span></td><td style="text-align:right;">{{dex}}</td></tr>
            <tr><td><span class="tcat">Constitution</span></td><td style="text-align:right;">{{con}}</td></tr>
            <tr><td><span class="tcat">Intelligence</span></td><td style="text-align:right;">{{int}}</td></tr>
            <tr><td><span class="tcat">Sagesse</span></td><td style="text-align:right;">{{sag}}</td></tr>
            <tr><td><span class="tcat">Charisme</span></td><td style="text-align:right;">{{cha}}</td></tr>
            <tr><td colspan="2"><hr/></td></tr>
            <tr>
                <td style="text-align: center;" title="Cliquer pour créer automatiquement un nouveau personnage de cette classe, avec le tirage de caractéristiques ci-dessus.">[Clerc](!pmt-newchar clerc|?{Nom du personnage à créer|Un Clerc}|{{tabcar}})</td>
                <td style="text-align: center;" title="Cliquer pour créer automatiquement un nouveau personnage de cette classe, avec le tirage de caractéristiques ci-dessus.">[Guerrier](!pmt-newchar guerrier|?{Nom du personnage à créer|Un Guerrier}|{{tabcar}})</td>
            </tr>
            <tr>
                <td style="text-align: center;" title="Cliquer pour créer automatiquement un nouveau personnage de cette classe, avec le tirage de caractéristiques ci-dessus.">[Magicien](!pmt-newchar magicien|?{Nom du personnage à créer|Un Magicien}|{{tabcar}})</td>
                <td style="text-align: center;" title="Cliquer pour créer automatiquement un nouveau personnage de cette classe, avec le tirage de caractéristiques ci-dessus.">[Voleur](!pmt-newchar voleur|?{Nom du personnage à créer|Un Voleur}|{{tabcar}})</td>
            </tr>
            <tr>
                <td style="text-align: center;" title="Cliquer pour créer automatiquement un nouveau personnage de cette classe, avec le tirage de caractéristiques ci-dessus.">
                    {{#elfe}}
                        [Elfe](!pmt-newchar elfe|?{Nom du personnage à créer|Un Elfe}|{{tabcar}})
                    {{/elfe}}
                </td>
                <td style="text-align: center;" title="Cliquer pour créer automatiquement un nouveau personnage de cette classe, avec le tirage de caractéristiques ci-dessus.">
                    {{#halfelin}}
                        [Halfelin](!pmt-newchar halfelin|?{Nom du personnage à créer|Un Halfelin}|{{tabcar}})
                    {{/halfelin}}
                </td>
            </tr>
            <tr>
                <td style="text-align: center;" title="Cliquer pour créer automatiquement un nouveau personnage de cette classe, avec le tirage de caractéristiques ci-dessus.">
                    {{#nain}}
                        [Nain](!pmt-newchar nain|?{Nom du personnage à créer|Un Nain}|{{tabcar}})
                    {{/nain}}
                </td>
                <td style="text-align: center;" title="Cliquer pour créer automatiquement un nouveau personnage de cette classe, avec le tirage de caractéristiques ci-dessus.">

                </td>
            </tr>
        {{/tabcar}}
        {{#personnage}}
            <tr><td><span class="tcat">Nom</span></td><td style="text-align:right;"><b>{{personnage}}</b></td></tr>
            <tr><td><span class="tcat">Classe</span></td><td style="text-align:right;text-transform: capitalize;">{{classe}}</td></tr>
            <tr><td colspan="2" style="text-align: center;color:blue;font-weight:bold;text-decoration:underline;">[Ouvrir la Feuille de Personnage](http://journal.roll20.net/character/{{charid}})</a></td></tr>
        {{/personnage}}
    </table>
</rolltemplate>
