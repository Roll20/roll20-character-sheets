<main>

  <input type="hidden" class="tabs-toggle" name="attr_sheetTab"  value="character"  />

  <div class="tab-selector"> 
    <!--
    <select name="attr_sheet_mode">
      <option data-i18n-title="char_sheet" title="Character Sheet" value="char-sheet">CHARACTER</option>
      <option data-i18n-title="ship_sheet" title="Ship Sheet" value="ship-sheet">SHIP</option>
      <option data-i18n-title="npc_sheet" title="NPC Sheet" value="npc-sheet">NPC</option>
    </select>
    -->

      <button type="action" name="act_character" value="character" class="tab-button" data-i18n="character" data-i18n-dynamic>Character</button> 
      <button type="action" name="act_ship" value="ship" class="tab-button" data-i18n="ship" data-i18n-dynamic>Ship</button>
      <button type="action" name="act_npc" value="npc" class="tab-button" data-i18n="npc" data-i18n-dynamic>NPC</button>
    </div>

<section class="image-bg character char-sheet">
  <div class="transparent-bg flex-container">

    <div class="col transparent-bg">

      <div class="section white-bg pink-border">
        <label>
          <span data-i18n="name-u" class="unifraktur">Name</span>   
        </label>
        <div>
          <textarea class="singleline" name="attr_char_name"></textarea>
        </div>
      </div>
      <div class="section white-bg pink-border">
        <label>
          <span class="specialelite" data-i18n="description-u">Description</span>
        </label>
        <textarea name="attr_description"></textarea>
      </div>
      <div class="section white-bg pink-border">
        <label class="inline">
          <span class="specialelite" data-i18n="class-u">Class<span>
          </label>
          <input type=text name="attr_class" class="mediumwidth" />
          <br />
          <label>
            <span class="note specialelite" data-i18n="class-abilities-u">Class Abilities</span>
          </label>
          <textarea name="attr_class_abilities"></textarea>
        </div>
        <div class="section white-bg pink-border">
          <label>
            <span class="specialelite" data-i18n="powers-u">Neuromancy Points</span>
          </label>
          <div class="2colrow">
            <div class="col">
              <span class="note specialelite" data-i18n="powers-note-u">Presence+d4 times per day</span>
            </div>
            <div class="col">
              <button type="roll" name="roll_powers" value="/em (@{char_name}) @{labelrolls} @{labeldailypowers}: [[1d4 + @{presence}]]"></button>
            </div>
          </div>
          <label class="inline">
            <span class="note specialelite" data-i18n="powers-left-u">Remaining</span>
          </label>
          <input type="number" name="attr_power_total" value="0" />
          <br />
          <br />
			<label class="inline">
            <span class="note specialelite2" data-i18n="tribute-left-u">Tributes</span>
          </label>
          <fieldset class="repeating_powers" name="repeating_powers">
            <textarea type="text" name="attr_tribute" class="shorttextarea"></textarea>
          </fieldset>
          <br />
          <label class="inline">
            <span class="note specialelite2"  data-i18n="use-power-u">Use Tribute</span>
          </label>
          <button type="roll" value="/em (@{char_name}) @{labelrolls} @{labeltribute}: [[1d20 + @{presence}]]"></button>
          <br />
          <span class="note specialelite" data-i18n="powers-note2-u">Presence DR12, or -d2 HP and no Powers for 1 hr.</span>
        </div>
        <div class="section white-bg pink-border">
          <label><span data-i18n="notes-u">Notes</label>
            <textarea type="text" name="attr_notes"></textarea>
        </div>
      </div>

      <div class="col col-middle transparent-bg">

        <div class="transparent-bg centered">
          <img src="https://vastgrimm.com/wp-content/uploads/2021/11/vast_grimm-logo-roll20.png" alt="Vast Grimm RPG logo" />

          <br />

          <button type="roll" value="https://vastgrimm.com/character-generator/"><span class="special elite note" data-i18n="progenitor-u">PROGENITOR</span></button>
        </div>

        <div class="transparent-bg">
          <div class="transparent-bg">
            <label class="centered">
              <span class="specialelite all-caps" data-i18n="hit-points-u">Hit Points</span>
            </label>
          </div>
          <div class="2colrow-custom transparent-bg">
            <div class="col-custom transparent-bg col-right">
              <label class="aligns-right">
                <span class="specialelite note" data-i18n="current-hit-points-u">Current</span>
                </label>
                <br />
                <input name="attr_hp_curr" type="number" class="num" value="0" />
              </div>
              <div class="col-custom transparent-bg">
                <label>
                  <span class="specialelite note" data-i18n="max-hit-points-u">Max</span>
                </label>
                <br />
                <input name="attr_hp_max" type="number" class="num" value="0" />
              </div>
            </div>
          </div>

          <div class="clear transparent-bg">
          </div>

          <div class="section white-bg flex-container flex-wrap">
            <div class="col">
              <label class="transform1">
                <span class="roboto" data-i18n="strength-u">Strength</span>
              </label>
            </div>
            <div class="col">
              <input type=number name="attr_strength" class="num" value="0" />
              <button type="roll" value="/em (@{char_name}) @{labelrolls} @{labelstrength}: [[1d20 + @{strength}]]" name="roll_strength"></button>
            </div>
            <div class="2colrow">
              <fieldset class="repeating_strength" name="repeating_strength">
              <textarea class="singleline mediumwidth" name="attr_strspeciallabel" value="Add special ability details and modifier"></textarea>
              <input type="number" name="attr_strspecial" value="0" />
              <button type="roll" value="/em (@{char_name}) @{labelrolls} @{labelstrength} (@{strspeciallabel}): [[1d20 + @{strength} + @{strspecial}]]" name="roll_str_special"></button>
            </fieldset>
            </div>
          </div>

          <div class="2colrow section white-bg flex-container flex-wrap">
            <div class="col">
              <label class="transform2">
                <span class="roboto" data-i18n="agility-u">Agility</span>
              </label>
            </div>
            <div class="col">
              <input type=number name="attr_agility" class="num" value="0" />
              <button type="roll" value="/em (@{char_name}) @{labelrolls} @{labelagility}: [[1d20 + @{agility}]] (DR+@{agidr})" name="roll_agility"></button>
            </div>
            <div class="2colrow">
              <fieldset class="repeating_agility" name="repeating_agility">
              <textarea class="singleline" name="attr_agispeciallabel" value="Add special ability details and modifier" class="mediumwidth"></textarea>
              <input type="number" name="attr_agispecial" value="0" />
              <button type="roll" value="/em (@{char_name}) @{labelrolls} @{labelagility} (@{agispeciallabel}): [[1d20 + @{agility} + @{agispecial}]]" name="roll_agi_special"></button>
            </fieldset>
            </div>
          </div>

          <div class="2colrow section white-bg pink-border flex-container">
              <div class="col">
                <label>
                  <span class="note" data-i18n="defense-u">Defense</span>
                </label>
              </div>
              <div class="col">
                <!--
              <button type="roll" value="&{template:default} {{name=@{char_name} @{labelrolls} @{labeldefense}}} {{Defend:=[[1d20 + @{agility}]] (DR +@{defdr})}} {{@{labelifhit}:=[[?{Enemy Damage|1d6} - 1d@{armortier} - @{helmet}]] damage}} {{@{labelifcrit}:=@{labelcritmsg}.}} {{@{labeliffumble}:=@{labelfumblemsg} (@{labelcurrently} [[@{armortier}/2]]).}}" name="roll_defense2"></button>
              -->
              <button type="roll" value="&{template:defense} {{name=@{char_name} @{labelrolls} @{labeldefense}}} {{defend=@{labeldefense}: [[1d20 + @{agility}]] (DR +@{defdr})}} {{damage=@{labeldamage}: [[?{Enemy Damage|1d6} - 1d@{armortier} - @{helmet}]]}} {{critmsg=@{labelcritmsg}.}} {{fumblemsg=@{labelfumblemsg} (@{labelcurrently} [[@{armortier}/2]]).}}" name="roll_defense2"></button>
              </div>
          </div>
          <div class="2colrow section white-bg pink-border flex-container">
            <div class="col">
              <label>
                <span class="note" data-i18n="initiative-u">Initiative</span>
              </label>
              <br />
              <span class="note specialelite2" data-i18n="initiative-note-u">Agility + d6</span>
            </div>
            <div class="col">
              <button type="roll" value="/em (@{char_name}) @{labelrolls} @{labelinitiative}: [[@{agility} + 1d6 &{tracker}]]"></button>
            </div>
          </div>
        <div class="2colrow section white-bg flex-container flex-wrap">
          <div class="col">
            <label class="transform3">
              <span class="roboto" data-i18n="presence-u">Presence</span>
            </label>
          </div>
          <div class="col">
            <input type=number name="attr_presence" class="num"/>
            <button type="roll" value="/em (@{char_name}) @{labelrolls} @{labelpresence}: [[1d20 + @{presence}]]" name="roll_presence"></button>
          </div>
            <div class="2colrow">
              <fieldset class="repeating_presence" name="repeating_presence">
              <textarea class="singleline" name="attr_prespeciallabel" value="Add special ability details and modifier" class="mediumwidth"></textarea>
              <input type="number" name="attr_prespecial" value="0" />
              <button type="roll" value="/em (@{char_name}) @{labelrolls} @{labelpresence} (@{prespeciallabel}): [[1d20 + @{presence} + @{prespecial}]]" name="roll_pre_special"></button>
            </fieldset>
            </div>          
        </div>
        <div class="2colrow section white-bg flex-container flex-wrap">
          <div class="col">
            <label class="transform1">
              <span class="roboto" data-i18n="tech-u">Tech</span>
            </label>
          </div>
          <div class="col">
            <input type=number name="attr_tech" class="num" value="0" />
            <button type="roll" value="/em (@{char_name}) @{labelrolls} @{labeltech}: [[1d20 + @{tech}]]" name="roll_tech"></button>
          </div>
            <div class="2colrow">
            <fieldset class="repeating_tech" name="repeating_tech">
              <textarea class="singleline" name="attr_techspeciallabel" value="Add special ability details and modifier" class="mediumwidth"></textarea>
              <input type="number" name="attr_techspecial" value="0" />
              <button type="roll" value="/em (@{char_name}) @{labelrolls} @{labeltech} (@{techspeciallabel}): [[1d20 + @{tech} + @{techspecial}]]" name="roll_tech_special"></button>
            </fieldset>
          </div>
        </div>
        <div class="2colrow section white-bg flex-container flex-wrap">
          <div class="col">
            <label class="transform1">
              <span class="roboto" data-i18n="toughness-u">Toughness</span>
            </label>
          </div>
          <div class="col">
            <input type=number name="attr_toughness" class="num" value="0" />
            <button type="roll" value="/em (@{char_name}) @{labelrolls} @{labeltoughness}: [[1d20 + @{toughness}]]" name="roll_toughness"></button>
          </div>
            <div class="2colrow">
              <fieldset class="repeating_toughness" name="repeating_toughness">
              <textarea class="singleline" name="attr_touspeciallabel" value="Add special ability details and modifier" class="mediumwidth"></textarea>
              <input type="number" name="attr_touspecial" value="0" />
              <button type="roll" value="/em (@{char_name}) @{labelrolls} @{labeltoughness} (@{touspeciallabel}): [[1d20 + @{toughness} + @{touspecial}]]" name="roll_tou_special"></button>
            </fieldset>
            </div>
        </div>
        <div class="section white-bg">
          <label class="inline">
            <span class="unifraktur" data-i18n="favors-u">Favors</span>
          </label>
          <input name="attr_favors_curr" type="number" class="short" value="0" />
          <select name="attr_favors" class="short">
            <option value="2" selected="selected">d2</option>
            <option value="3">d3</option>
            <option value="4">d4</option>
            <option value="6">d6</option>
            <option value="8">d8</option>
            <option value="10">d10</option>
          </select>
          <button type="roll" value="/em (@{char_name}) @{labelrolls} [[1d@{favors}]] @{labelfavors}"></button>
          <br />
          <span class="note specialelite2" data-i18n="favors-note-u">Maximum damage, Reroll, -d6 damage, DR-4, No Crit/Fumble</span>
        </div>
         <div class="section white-bg">
          <label class="inline">
            <span class="unifraktur" data-i18n="rest-u">Getting Rest</span>
            </label>
            <select name="attr_hp_rest" class="mediumwidth">
              <option value="+ 1d4" selected="selected">Catch your breath, have a drink (d4)</option>
              <option value="+ 1d6">Get a full night's sleep (d6)</option>
              <option value="- 1d4">Starve without food or drink (-d4)</option>
              <option value="- 1d6">Suffer infection (-d6)</option>
            </select>
            <button type="roll" value="/em (@{char_name}) @{labelrests}: [[0 @{hp_rest}]] HP"></button>
          </div>
         <div class="section white-bg">
          <label class="inline">
            <span class="unifraktur"data-i18n="self-improvement-u">Self Improvement</span>
            </label>
            <button type="roll" value="&{template:default} {{name=@{char_name} @{labelrolls} @{labelselfimprovement}}} {{@{labelhpcheck}:=[[6d10 > @{hp_max}]]}} {{@{labelhpgain}:=[[1d6]]}} {{@{labelstrinc}=[[1d6 > @{strength}]]}} {{@{labelagiinc}=[[1d6 > @{agility}]]}} {{@{labelpreinc}=[[1d6 > @{presence}]]}} {{@{labeltechinc}=[[1d6 > @{tech}]]}} {{@{labeltouinc}=[[1d6 > @{toughness}]]}}" name="roll_selfimprovement"></button>
          </div>
        </div>

      <div class="col transparent-bg">
        <div class="section pink-border white-bg">
          <div>
            <label>
              <span class="unifraktur" data-i18n="weapons-u">Weapons</span>
            </label>
          </div>
<!--
          <div class="2colrow">
            <div class="col">
              <label>
                <span class="note specialelite2" data-i18n="weapons-type-u">Type</span>
              </label>
            </div>
            <div class="col">
              <label>
                <span class="note specialelite2" data-i18n="weapons-damage-u">Dmg Die</span>
              </label>
            </div>
          </div>
        -->
          <div>
            <fieldset class="repeating_weapons" name="repeating_weapons">
              <textarea type="text" name="attr_weaponname" class="singleline"></textarea>
              <select name="attr_attacktype" class="medshort">
                <option value="@{strength}">Melee</option>
                <option value="@{presence}">Ranged</option>
              </select>
              <input type="text" name="attr_weapondamage" class="short" value="1d6+0"/>
              <!--
              <button type="roll" value="&{template:default} {{name=@{char_name} @{labelattacks} @{labelwith} @{weaponname}}} {{@{labelattack}:=[[1d20 + @{attacktype}]]}} {{@{labeldamage}:=[[@{weapondamage} - ?{Enemy Armor|1d0} - ?{Enemy helmet?|no,0|yes,1}]]}} {{@{labelifcrit}:=@{labelfumblemsg}.}} {{@{labeliffumble}:=@{labelattackfumble}.}}" name="roll_strength2"></button>
              -->
              <button type="roll" value="&{template:attack} {{name=@{char_name} @{labelattacks} @{labelwith} @{weaponname}}} {{attack=@{labelattack}: [[1d20 + @{attacktype}]]}} {{damage=@{labeldamage}: [[@{weapondamage}]]}} {{critdmg=[[@{weapondamage}*2]]}} {{critmsg=@{labelfumblemsg}.}} {{dmgfumble=@{labelattackfumble}.}}" name="roll_strength2"></button>
            </fieldset>
          </div>
        </div>
        <div class="section white-bg blue-border">
          <label>
            <span data-i18n="armor-u" class="unifraktur">Armor</span>
          </label>
          <textarea name="attr_armor" class="inline-block singleline"></textarea>
          <br />
          <label class="inline">
            <span class="specialelite" data-i18n="armor-tier-u">Tier</span>
          </label>
          <br />
          <form class="inline-block" name="armortier">
            <input name="attr_armortier" type="radio" value="0" checked>
            <label class="widelabel" for="0">0</label>
            <input name="attr_armortier" type="radio" value="2">
            <label class="widelabel" for="2">1<br />-d2</label>
            <input name="attr_armortier" type="radio" value="4">
            <label class="widelabel" for="4">2<br />-d4</label>
            <input name="attr_armortier" type="radio" value="6">
            <label class="widelabel" for="6">3<br />-d6</label>
          </form>
          <label>
            <span class="specialelite2" data-i18n="helmet-u">helmet</span>
          </label>
          <form name="helmet">
            <input name="attr_helmet" type="checkbox" value="0" checked>
            <label for="0" data-i18n="no-u">No</label>
            <input name="attr_helmet" type="checkbox" value="1">
            <label for="1" data-i18n="yes-u">Yes</label>
          </form>
        </div>
        <div class="section white-bg pink-border">
          <label class="inline">
            <span class="unifraktur" data-i18n="equipment-u">Equipment</span>
          </label>
          <span class="specialelite italic note" data-i18n="equipment-note-u">
            Strength+8 items or DR+2 on Agility/Strength tests
          </span>
          <br />
          <label class="inline">
            <span class="note specialelite2">Items carried</span>
          </label>
          <input name="attr_items_carried" type="number" value="0" />
          <br />
          <div class="2colrow">
            <div class="col">
              <label>
                <span class="note specialelite2" data-i18n="equipment-item-u">Item</span>
              </label>
            </div>
            <div class="col">
              <label>
                <span class="note specialelite2" data-i18n="equipment-item-large-u">Large?</span>
              </label>
            </div>
          </div>
          <fieldset class="repeating_equipment" name="repeating_equipment">
            <textarea name="attr_equipment" class="shorttextarea mediumwidth"></textarea>
            <input name="attr_equipment_large" type="checkbox" value="large" class="valign-top">
          </fieldset>
        </div>
		   <div class="section white-bg pink-border">
          <label class="inline">
            <span class="unifraktur" data-i18n="batteries-u">Batteries</span>
          </label>
          <span class="specialelite italic note" data-i18n="batteries-note-u">
            Batteries hold 24 charges
          </span>
          <br />
          <label class="inline">
            <span class="note specialelite2">Batteries</span>
          </label>
          <input name="attr_battery_total" type="number" value="0" />
          <br />
          <div class="2colrow">
            <div class="col">
              <label>
                <span class="note specialelite2" data-i18n="batteries-item-u">Placement</span>
              </label>
            </div>
            <div class="col">
              <label>
                <span class="note specialelite2" data-i18n="batteries-item-charges-u">Charges</span>
              </label>
            </div>
          </div>
          <fieldset class="repeating_batteries" name="repeating_batteries">
            <textarea name="attr_batteries" class="shorttextarea mediumwidth"></textarea>
          <input name="attr_battery_charges" type="number" value="0" class="valign-top" />
          </fieldset>
        </div>
        <div class="section white-bg pink-border">
          <label><span class="unifraktur" data-i18n="credsticks-u">Credsticks</span> <input type="number" name="attr_credsticks" value="0" /></label>
        </div>
        <div class="section white-bg pink-border">
          <label><span class="" data-i18n="infestation-u">Parasite Infestation</span></label>
          <textarea name="attr_infestation" class="shorttextarea"></textarea>
          <label><span data-i18n="effects-survived-u">Effects Survived</span></label>
          <br />
          <label><span class="note" data-i18n="pain-u">Pain</span></label>
          <form>
            <input name="attr_pain1" type="checkbox" value="1">
            <label for="1">1</label>
            <input name="attr_pain2" type="checkbox" value="2">
            <label for="2">2</label>
            <input name="attr_pain3" type="checkbox" value="3">
            <label for="3">3</label>
            <input name="attr_pain4" type="checkbox" value="4">
            <label for="4">4</label>
            <input name="attr_pain5" type="checkbox" value="5">
            <label for="5">5</label>
            <input name="attr_pain6" type="checkbox" value="6">
            <label for="6">6</label>
          </form>
          <label><span class="note" data-i18n="pleasure-u">Pleasure</span></label>
          <form>
            <input name="attr_pleasure1" type="checkbox" value="1">
            <label for="1">1</label>
            <input name="attr_pleasure2" type="checkbox" value="2">
            <label for="2">2</label>
            <input name="attr_pleasure3" type="checkbox" value="3">
            <label for="3">3</label>
            <input name="attr_pleasure4" type="checkbox" value="4">
            <label for="4">4</label>
            <input name="attr_pleasure5" type="checkbox" value="5">
            <label for="5">5</label>
            <input name="attr_pleasure6" type="checkbox" value="6">
            <label for="6">6</label>
          </form>
        </div>
        <div class="section white-bg pink-border">
          <label class="centered">
            <span class="specialelite" data-i18n="torments-u">Torments</span>
          </label>
          <form>
            <input name="attr_torment1" type="checkbox" value="1">
            <label for="1">1</label>
            <input name="attr_torment2" type="checkbox" value="2">
            <label for="2">2</label>
            <input name="attr_torment3" type="checkbox" value="3">
            <label for="3">3</label>
            <input name="attr_torment4" type="checkbox" value="4">
            <label for="4">4</label>
            <input name="attr_torment5" type="checkbox" value="5">
            <label for="5">5</label>
            <input name="attr_torment6" type="checkbox" value="6">
            <label for="6">6</label>
            <input name="attr_torment7" type="checkbox" value="7">
            <label for="7">7</label>
          </form>
          <div>
            <!-- Disabled by playtester request but retained in case it gets reimplemented in the future
            <div>
              <label class="inline">
                <span class="" data-i18n="dawn-misery-u">Dawn Roll</span>
              </label>
              <select name="attr_daily" class="short">
                <option value="2" selected="selected">t2</option>
                <option value="6">t6</option>
                <option value="10">t10</option>
                <option value="20">t20</option>
                <option value="100">t100</option>
              </select>
              <button type="roll" value="/em (@{char_name}) @{labelrolls} @{labeldailymisery}: [[1d@{daily}]]" name="roll_dailymisery"></button>
            </div>
            <div>
              <label class="inline">
                <span data-i18n="psalm-u">Psalm Roll</span>
              </label>
              <button type="roll" value="/em (@{char_name}) @{labelrolls} @{labelpsalm}: [[1d6]]:[[1d6]]" name="roll_psalm"></button>
              </div>
              -->
            </div>
          </div>

        </div>

      </div>
    </section>

    <section class="image-bg ship ship-sheet">
      <div class="transparent-bg flex-container">
      <div class="col">

        <div class="transparent-bg centered">
          <img src="https://vastgrimm.com/wp-content/uploads/2021/11/vast_grimm-logo-roll20.png" alt="Vast Grimm RPG logo" />

          <br />

          <button type="roll" value="https://vastgrimm.com/starship-generator/"><span class="special elite note all-caps" data-i18n="starship-generator-u">STARSHIP GENERATOR</span></button>
        </div>

        <div class="section white-bg pink-border">
          <label class="inline">
            <span class="unifraktur" data-i18n="shipname">Ship Name</span>
          </label>
          <textarea class="singleline" name="attr_ship_name"></textarea>
        </div>

        <div class="section white-bg pink-border">
          <label class="inline">
            <span class="unifraktur" data-i18n="classtype">Class/Type</span>
          </label>
          <textarea  class="singleline" name="attr_shipclass"></textarea>
        </div>

        <div class="section white-bg">
          <div class="2colrow flex-container">
            <div class="col">
              <label class="transform1">
                <span class="roboto" data-i18n="maneuver-u">Maneuver</span>
              </label>
            </div>
            <div class="col">
              <input type=number name="attr_shipmaneuver" class="num" value="0" />
              <button type="roll" value="/em (@{ship_name}) @{labelrolls} @{labelmaneuver}: [[1d20 + @{shipmaneuver}]]" name="roll_shipmaneuver"></button>
            </div>
          </div>
        </div>

        <div class="section pink-border white-text">
          <div class="2colrow flex-container">
            <div class="col">
              <label>
                <span class="note white-text" data-i18n="defense-u">Defense</span>
              </label>
            </div>
            <div class="col">
              <button type="roll" value="&{template:shipdefense} {{name=@{ship_name} @{labelrolls} @{labeldefense}}} {{defend=@{labeldefense}: [[1d20 + @{shipmaneuver}]] (DR +@{defdr})}} {{damage=@{labeldamage}: [[?{Enemy Damage|1d6} - @{shiparmortier}]]}} {{critmsg=@{labelshipcritdefmsg}.}} {{fumblemsg=@{labelshipfumblemsg}}}" name="roll_defense2"></button>
            </div>
          </div>
        </div>

        <div class="section white-bg">
          <div class="2colrow flex-container">
            <div class="col">
              <label class="transform1">
                <span class="roboto" data-i18n="accuracy-u">Accuracy</span>
              </label>
            </div>
            <div class="col">
              <input type=number name="attr_shipaccuracy" class="num" value="0" />
              <button type="roll" value="/em (@{ship_name}) @{labelrolls} @{labelaccuracy}: [[1d20 + @{shipaccuracy}]]" name="roll_shipaccuracy"></button>
            </div>
          </div>
        </div>

        <div class="2colrow section white-bg flex-container">
          <div class="col">
            <label class="transform1">
              <span class="roboto" data-i18n="fortitude-u">Fortitude</span>
            </label>
          </div>
          <div class="col">
            <input type=number name="attr_shipfortitude" class="num" value="0" />
            <button type="roll" value="/em (@{ship_name}) @{labelrolls} @{labelfortitude}: [[1d20 + @{shipfortitude}]]" name="roll_shipfortitude"></button>
          </div>
        </div>

        <div class="2colrow section white-bg flex-container">
          <div class="col">
            <label class="transform1">
              <span class="roboto" data-i18n="speed-u">Speed</span>
            </label>
          </div>
          <div class="col">
            <input type=number name="attr_shipspeed" class="num" value="0" />
            <button type="roll" value="/em (@{ship_name}) @{labelrolls} @{labelspeed}: [[1d20 + @{shipspeed}]]" name="roll_shipspeed"></button>
          </div>
        </div>

      <div>

         <div class="transparent-bg white-text">
          <label class="centered">
            <span class="monospace all-caps white-text" data-i18n="hit-points-u">Hit Points</span>
          </label>
          <div class="2colrow-custom transparent-bg">
            <div class="col-custom transparent-bg">
              <label>
                <span class="monospace note white-text" data-i18n="max-hit-points-u">Max</span>
              </label>
              <br />
              <input name="attr_shiphp_max" type="number" class="num" value="0" />
            </div>
            <div class="col-custom transparent-bg col-right">
              <label class="aligns-right">
                <span class="monospace note white-text" data-i18n="current-hit-points-u">Current</span>
              </label>
              <br />
              <input name="attr_shiphp" type="number" class="num" value="0" />
            </div>
          </div>
        </div>

         <div class="transparent-bg white-text">
          <label class="centered">
            <span class="monospace all-caps white-text" data-i18n="power-u">Power</span>
          </label>
          <div class="2colrow-custom transparent-bg">
            <div class="col-custom transparent-bg">
              <label>
                <span class="monospace note white-text" data-i18n="max-hit-points-u">Max</span>
              </label>
              <br />
              <input name="attr_shippower_max" type="number" class="num" value="0" />
            </div>
            <div class="col-custom transparent-bg col-right">
              <label class="aligns-right">
                <span class="monospace note white-text" data-i18n="current-hit-points-u">Current</span>
              </label>
              <br />
              <input name="attr_shippower" type="number" class="num" value="0" />
            </div>
          </div>
        </div>  
      </div>      

          <div class="clear transparent-bg">
          </div>

        <div class="section white-bg blue-border">
          <div>
          <label>
            <span class="unifraktur" data-i18n="armor-u" class="monospace">Armor</span>
          </label>
          <textarea class="singleline inline-block" name="attr_shiparmor"></textarea>
          <br />
          <label class="inline">
            <span data-i18n="armor-tier-u">Tier</span>
          </label>
          <br />
          <form class="inline-block" name="shiparmortier">
            <input name="attr_shiparmortier" type="radio" value="1d8" checked>
            <label class="widelabel" for="4">4<br />-d8</label>
            <input name="attr_shiparmortier" type="radio" value="1d10">
            <label class="widelabel" for="5">5<br />-d10</label>
            <input name="attr_shiparmortier" type="radio" value="2d6">
            <label class="widelabel" for="6">6<br />-2d6</label>
            <input name="attr_shiparmortier" type="radio" value="2d8">
            <label class="widelabel" for="7">7<br />-2d8</label>
            <input name="attr_shiparmortier" type="radio" value="3d6">
            <label class="widelabel" for="8">8<br />-3d6</label>
          </form>
          </div>
          <div>
            <label>
              <span data-i18n="size">Size</span>
            </label>
            <div>
              <input name="attr_shipsize" type="number" class="num" value="0" />
            </div>
          </div>
          <div>
            <label>
              <span data-i18n="pilot-dr">Pilot DR</span>
            </label>
            <div>
              <input name="attr_shippilotdr" type="number" class="num" value="0" />
            </div>
          </div>
          <div>
            <label>
              <span data-i18n="min-crew">Min Crew</span>
            </label>
            <div>
              <input name="attr_shipmincrew" type="number" class="num" value="0" />
            </div>
          </div>
        </div>

        <div class="section white-bg">
          <label>
            <span class="specialelite" data-i18n="souvenir">Souvenir</span>
          </label>
          <textarea name="attr_shipsouvenir">
          </textarea>
        </div>
      </div>

      <div class="col wide">
        <div class="section white-bg pink-border">
          <label>
            <span class="specialelite" data-i18n="description-u">Description</span>
          </label>
          <textarea name="attr_shipdescription">
          </textarea>
        </div>

        <div class="section white-bg blue-border">
          <label>
            <span class="specialelite" data-i18n="capabilities">Capabilities</span>
          </label>
          <textarea name="attr_shipcapabilities">
          </textarea>
        </div>

        <div class="section pink-border white-bg">
          <div>
            <label>
              <span class="unifraktur" data-i18n="weapons-u">Weapons</span>
            </label>
          </div>

          <div>
            <fieldset class="repeating_weapons" name="repeating_shipweapons">
              <textarea type="text" name="attr_shipweaponname" class="singleline"></textarea>
              <select name="attr_shipattacktype" class="medshort">
                <option value="@{shipaccuracy}">Accuracy</option>
                <option value="@{shipmaneuver}">Maneuver</option>
              </select>
              <input type="text" name="attr_shipweapondamage" class="short" value="1d6+0"/>
              <button type="roll" value="&{template:shipattack} {{name=@{ship_name} @{labelattacks} @{labelwith} @{shipweaponname}}} {{attack=@{labelattack}: [[1d20 + @{shipattacktype}]]}} {{damage=@{labeldamage}: [[@{shipweapondamage}]]}} {{critdmg=[[@{shipweapondamage}*2]]}} {{critmsg=@{labelshipcritmsg}.}} {{dmgfumble=@{labelshipattackfumble}}}" name="roll_shipattack"></button>
            </fieldset>
          </div>
        </div>

        <div class="section white-bg pink-border">
          <label>
            <span class="unifraktur" data-i18n="modslots">Mod Slots</span>
          </label>
          <div>
            <input name="attr_modslot1" type="checkbox" id="modslot1">
            <input name="attr_modslot2" type="checkbox" id="modslot2">
            <input name="attr_modslot3" type="checkbox" id="modslot3">
            <input name="attr_modslot4" type="checkbox" id="modslot4">
            <input name="attr_modslot5" type="checkbox" id="modslot5">
            <input name="attr_modslot6" type="checkbox" id="modslot6">
          </div>
          <div>
              <fieldset class="repeating_modslots" name="repeating_modslots">
              <textarea class="singleline" name="attr_modslot" value="Add mod slot details">
              </textarea>
            </fieldset>
            </div>
        </div>

        <div class="section white-bg">
          <label>
            <span class="specialelite" data-i18n="characteristics">Characteristics</span>
          </label>
          <textarea name="attr_shipcharacteristics">
          </textarea>
        </div>

        <div class="section white-bg">
          <label>
            <span class="specialelite" data-i18n="whatsbroken">What's Broken</span>
          </label>
          <textarea name="attr_shipwhatsbroken">
          </textarea>
        </div>

      </div>
      </div>
    </section>

    <section class="image-bg npc npc-sheet">
      <div class="transparent-bg flex-container">
        <div class="col">
          <div class="section white-bg pink-border">
            <label class="transform1">
              <span class="unifraktur" data-i18n="name-u">Name</span>
            </label>
            <textarea class="singleline" name="attr_npc_name"></textarea>
          </div>

          <div class="transparent-bg white-text">
            <label class="centered">
              <span class="monospace all-caps white-text" data-i18n="hit-points-u">Hit Points</span>
            </label>
            <div class="2colrow-custom transparent-bg">
              <div class="col-custom transparent-bg">
                <label>
                  <span class="monospace note white-text" data-i18n="max-hit-points-u">Max</span>
                </label>
                <br />
                <input name="attr_npchp_max" type="number" class="num" value="0" />
              </div>
              <div class="col-custom transparent-bg col-right">
                <label class="aligns-right">
                  <span class="monospace note white-text" data-i18n="current-hit-points-u">Current</span>
                </label>
                <br />
                <input name="attr_npcphp" type="number" class="num" value="0" />
              </div>
            </div>
          </div>

          <div class="clear transparent-bg">
          </div>

          <div class="section white-bg pink-border">
            <label class="transform1">
              <span class="roboto" data-18n="morale-u">Morale</span>
            </label>
            <input name="attr_npc_morale" type="number" class="num" value="0" />
          </div>

          <div class="section white-bg blue-border">
            <label>
              <span data-i18n="armor-u" class="unifraktur">Armor</span>
            </label>
            <textarea name="attr_npc_armor" class="inline-block singleline"></textarea>
            <br />
            <label class="inline">
              <span class="specialelite" data-i18n="armor-tier-u">Tier</span>
            </label>
            <br />
            <form class="inline-block" name="armortier">
              <input name="attr_npcarmortier" type="radio" value="0" checked>
              <label class="widelabel" for="0">0</label>
              <input name="attr_npcarmortier" type="radio" value="1d2">
              <label class="widelabel" for="2">1<br />-d2</label>
              <input name="attr_npcarmortier" type="radio" value="1d4">
              <label class="widelabel" for="4">2<br />-d4</label>
              <input name="attr_npcarmortier" type="radio" value="1d6">
              <label class="widelabel" for="6">3<br />-d6</label>
            </form>

            <div class="clear transparent-bg">
            </div>

          </div>

          <div class="clear transparent-bg">
          </div>
        </div>

        <div class="col wide">
          <div class="section white-bg pink-border">
            <label>
              <span class="specialelite" data-i18n="description-u">Description</span>
            </label>
            <textarea type="text" name="attr_npcdescription"></textarea>
          </div>

          <div class="section white-bg blue-border">
            <label>
              <span class="unifraktur" data-i18n="attacks">Attacks</span>
            </label>
            <fieldset class="repeating_attacks" name="repeating_attacks">
              <textarea type="text" name="attr_attackname" class="singleline"></textarea>
              <select name="attr_attacktype" class="medshort">
                <option value="@{strength}">Melee</option>
                <option value="@{presence}">Ranged</option>
              </select>
            </fieldset>
          </div>

          <div class="section white-bg">
            <label>
              <span class="specialelite" data-i18n="specials">Specials</span>
            </label>
            <fieldset class="repeating_specials" name="repeating_specials">
              <textarea type="text" name="attr_specialname" class="singleline"></textarea>
            </fieldset>
          </div>

        </div>
      </div>
    </section>

    </main>

    <rolltemplate class="sheet-rolltemplate-attack">
      <div class="sheet-container sheet-yellow-bg">
        <div>
          <h1>{{name}}</h1>
        </div>
        <div>
          <span>{{attack}}</span>
          {{#rollWasCrit() attack}}
            <span data-i18n="crit-template" class="sheet-bold-text">CRIT</span>
          {{/rollWasCrit() attack}}
          {{#rollWasFumble() attack}}
            <span data-i18n="fumble-template" class="sheet-bold-text">FUMBLE</span>
          {{/rollWasFumble() attack}}
        </div>
        {{#^rollWasCrit() attack}}
          <div>
            <span>{{damage}}</span>
          </div>
        {{/^rollWasCrit() attack}}
        {{#rollWasCrit() attack}}
          <div>
            <span><span data-i18n="crit-damage-template">Crit Damage</span>: {{critdmg}}</span>
          </div>
          <div class="sheet-crit">
            <span>{{critmsg}}</span>
          </div>
        {{/rollWasCrit() attack}}
        {{#rollWasFumble() attack}}
          <div class="sheet-crit-black">
            <span class="specialelite"><b>{{dmgfumble}}</b></span>
          </div>
        {{/rollWasFumble() attack}}
      </div>
    </rolltemplate>

    <rolltemplate class="sheet-rolltemplate-defense">
      <div class="sheet-container sheet-yellow-bg">
        <div>
          <h1>{{name}}</h1>
        </div>
        <div>
          <span>{{defend}}</span>
          {{#rollWasCrit() defend}}
            <span data-i18n="crit-template" class="sheet-bold-text">CRIT</span>
          {{/rollWasCrit() defend}}
          {{#rollWasFumble() defend}}
            <span data-i18n="fumble-template" class="sheet-bold-text">FUMBLE</span>
          {{/rollWasFumble() defend}}
        </div>
        {{#damage}}
          <div>
            <span>{{damage}}</span>
          </div>
        {{/damage}}
        {{#rollWasCrit() defend}}
          <div class="sheet-crit">
            <span>{{critmsg}}</span>
          </div>
        {{/rollWasCrit() defend}}
        {{#rollWasFumble() defend}}
          <div class="sheet-crit-black">
            <span>{{fumblemsg}}</span>
          </div>
        {{/rollWasFumble() defend}}
      </div>
    </rolltemplate>


    <rolltemplate class="sheet-rolltemplate-shipattack">
      <div class="sheet-container sheet-yellow-bg">
        <div>
          <h1>{{name}}</h1>
        </div>
        <div>
          <span>{{attack}}</span>
          {{#rollWasCrit() attack}}
            <span data-i18n="crit-template" class="sheet-bold-text">CRIT</span>
          {{/rollWasCrit() attack}}
          {{#rollWasFumble() attack}}
            <span data-i18n="fumble-template" class="sheet-bold-text">FUMBLE</span>
          {{/rollWasFumble() attack}}
        </div>
        {{#^rollWasCrit() attack}}
          <div>
            <span>{{damage}}</span>
          </div>
        {{/^rollWasCrit() attack}}
        {{#rollWasCrit() attack}}
          <div>
            <span><span data-i18n="crit-damage-template">Crit Damage</span>: {{critdmg}}</span>
          </div>
          <div class="sheet-crit">
            <span>{{critmsg}}</span>
          </div>
        {{/rollWasCrit() attack}}
        {{#rollWasFumble() attack}}
          <div class="sheet-crit-black">
            <span class="specialelite"><b>{{dmgfumble}}</b></span>
          </div>
        {{/rollWasFumble() attack}}
      </div>
    </rolltemplate>

    <rolltemplate class="sheet-rolltemplate-shipdefense">
      <div class="sheet-container sheet-yellow-bg">
        <div>
          <h1>{{name}}</h1>
        </div>
        <div>
          <span>{{defend}}</span>
          {{#rollWasCrit() defend}}
            <span data-i18n="crit-template" class="sheet-bold-text">CRIT</span>
          {{/rollWasCrit() defend}}
          {{#rollWasFumble() defend}}
            <span data-i18n="fumble-template" class="sheet-bold-text">FUMBLE</span>
          {{/rollWasFumble() defend}}
        </div>
        {{#damage}}
          <div>
            <span>{{damage}}</span>
          </div>
        {{/damage}}
        {{#rollWasCrit() defend}}
          <div class="sheet-crit">
            <span>{{critmsg}}</span>
          </div>
        {{/rollWasCrit() defend}}
        {{#rollWasFumble() defend}}
          <div class="sheet-crit-black">
            <span>{{fumblemsg}}</span>
          </div>
        {{/rollWasFumble() defend}}
      </div>
    </rolltemplate>



    <div class="no-display">
      <span class="no-display" data-i18n="labeldailypowers">daily powers</span>
      <span class="no-display" data-i18n="labelpower">Power</span>

      <span class="no-display" data-i18n="labelstrength">Strength</span>
      <span class="no-display" data-i18n="labelagility">Agility</span>
      <span class="no-display" data-i18n="labeldefense">Defense</span>
      <span class="no-display" data-i18n="labelinitiative">Initiative</span>
      <span class="no-display" data-i18n="labelpresence">Presence</span>
      <span class="no-display" data-i18n="labeltech">Tech</span>
      <span class="no-display" data-i18n="labeltoughness">Toughness</span>
      <span class="no-display" data-i18n="labelfavors">Favors</span>
      <span class="no-display" data-i18n="labeltribute">Tribute</span>
      <span class="no-display" data-i18n="labelrests">rests</span>
      <span class="no-display" data-i18n="labelselfimprovement">Self Improvement</span>
      <span class="no-display" data-i18n="labelhpcheck">HP check</span>
      <span class="no-display" data-i18n="labelhpgain">HP gain</span>
      <span class="no-display" data-i18n="labelstrinc">Strength increase?</span>
      <span class="no-display" data-i18n="labelagiinc">Agility increase?</span>
      <span class="no-display" data-i18n="labelpreinc">Presence increase?</span>
      <span class="no-display" data-i18n="labeltechinc">Tech increase?</span>
      <span class="no-display" data-i18n="labeltouinc">Toughness increase?</span>

      <span class="no-display" data-i18n="labelrolls">rolls</span>
      <span class="no-display" data-i18n="labelattacks">attacks</span>
      <span class="no-display" data-i18n="labelwith">with</span>
      <span class="no-display" data-i18n="labelifhit">If hit</span>
      <span class="no-display" data-i18n="labelifcrit">If crit</span>
      <span class="no-display" data-i18n="labelcritmsg">PC gains a free attack</span>
      <span class="no-display" data-i18n="labeliffumble">If fumble</span>
      <span class="no-display" data-i18n="labelfumblemsg">Double damage, armor/protection reduced one tier</span>
      <span class="no-display" data-i18n="labelattack">Attack</span>
      <span class="no-display" data-i18n="labelattackfumble">Weapon breaks or is lost</span>
      <span class="no-display" data-i18n="labeldamage">Damage</span>
      <span class="no-display" data-i18n="labelcurrently">currently</span>

      <span class="no-display" data-i18n="labeldailymisery">for the day's potential misery</span>
      <span class="no-display" data-i18n="labelpsalm">a psalm</span>

      <span class="no-display" data-i18n="labelmaneuver">Maneuver</span>
      <span class="no-display" data-i18n="labelaccuracy">Accuracy</span>
      <span class="no-display" data-i18n="labelfortitude">Fortitude</span>
      <span class="no-display" data-i18n="labelspeed">Speed</span>

      <span class="no-display" data-i18n="labelshipcritmsg">Double damage, armor/protection reduced 1 Tier.</span>
      <span class="no-display" data-i18n="labelshipattackfumble">Roll d6: (1) Weapon malfunctions and is offline for d6 rounds. (2) The action pulled too much energy. Lose 1 point of Power. (3) You spilled a drink on your console. Spend d2 rounds cleaning it up. (4) The attack left your starship wide open. The next Defense roll is with disadvantage. (5) Overworked the parts; this weapon needs professional repairs. Will not operate until fixed. (6) Mashed the wrong button, sending a distress vid across the Netwürk. How many people saw your face?</span>
      <span class="no-display" data-i18n="labelshipfumblemsg">Roll d2: (1) Reduce armor 1 Tier. (2) A weak spot sustained double damage.</span>
      <span class="no-display" data-i18n="labelshipcritdefmsg">Roll d2: (1) Bounce back. Apply damage to the assailant. (2) Evaded. Fly d2 hexes away.</span>

    </div>


        <script type="text/worker">

          //Buttons for Tabs
          const buttonlist = ["character","ship", "npc"];
          buttonlist.forEach(button => {
            on(`clicked:${button}`, function() {
              setAttrs({
                sheetTab: button,
              });
            });
          });

            /* When I can figure out how to successfully automate the below, I will. For the time being, it seems to elude me--which I know is just due to some JS-related mental hiccup on my part.
             */

            on("sheet:opened", function (eventInfo) {
                 setAttrs({
                  ["labeldailypowers"]: getTranslationByKey("labeldailypowers"),
                  ["labelpower"]: getTranslationByKey("labelpower"),
                  ["labelstrength"]: getTranslationByKey("labelstrength"),
                  ["labelagility"]: getTranslationByKey("labelagility"),
                  ["labeldefense"]: getTranslationByKey("labeldefense"),
                  ["labelinitiative"]: getTranslationByKey("labelinitiative"),
                  ["labelpresence"]: getTranslationByKey("labelpresence"),
                  ["labeltech"]: getTranslationByKey("labeltech"),
                  ["labeltoughness"]: getTranslationByKey("labeltoughness"),
                  ["labelfavors"]: getTranslationByKey("labelfavors"),
                  ["labeltribute"]: getTranslationByKey("labeltribute"),
                  ["labelrests"]: getTranslationByKey("labelrests"),
                  ["labelselfimprovement"]: getTranslationByKey("labelselfimprovement"),
                  ["labelhpcheck"]: getTranslationByKey("labelhpcheck"),
                  ["labelhpgain"]: getTranslationByKey("labelhpgain"),
                  ["labelstrinc"]: getTranslationByKey("labelstrinc"),
                  ["labelagiinc"]: getTranslationByKey("labelagiinc"),
                  ["labelpreinc"]: getTranslationByKey("labelpreinc"),
                  ["labeltechinc"]: getTranslationByKey("labeltechinc"),
                  ["labeltouinc"]: getTranslationByKey("labeltouinc"),
                  ["labelrolls"]: getTranslationByKey("labelrolls"),
                  ["labelattacks"]: getTranslationByKey("labelattacks"),
                  ["labelwith"]: getTranslationByKey("labelwith"),
                  ["labelifhit"]: getTranslationByKey("labelifhit"),
                  ["labelifcrit"]: getTranslationByKey("labelifcrit"),
                  ["labelcritmsg"]: getTranslationByKey("labelcritmsg"),
                  ["labeliffumble"]: getTranslationByKey("labeliffumble"),
                  ["labelfumblemsg"]: getTranslationByKey("labelfumblemsg"),
                  ["labelattack"]: getTranslationByKey("labelattack"),
                  ["labelattackfumble"]: getTranslationByKey("labelattackfumble"),
                  ["labeldamage"]: getTranslationByKey("labeldamage"),
                  ["labelcurrently"]: getTranslationByKey("labelcurrently"),
                  ["labeldailymisery"]: getTranslationByKey("labeldailymisery"),
                  ["labelpsalm"]: getTranslationByKey("labelpsalm"),
                  ["labelmaneuver"]: getTranslationByKey("labelmaneuver"),
                  ["labelaccuracy"]: getTranslationByKey("labelaccuracy"),
                  ["labelfortitude"]: getTranslationByKey("labelfortitude"),
                  ["labelspeed"]: getTranslationByKey("labelspeed"),
                  ["labelshipcritmsg"]: getTranslationByKey("labelshipcritmsg"),
                  ["labelshipattackfumble"]: getTranslationByKey("labelshipattackfumble"),
                  ["labelshipfumblemsg"]: getTranslationByKey("labelshipfumblemsg"),
                  ["labelshipcritdefmsg"]: getTranslationByKey("labelshipcritdefmsg")
              });
            });


          on("change:armortier sheet:opened", function () {
            getAttrs(["armortier"], function (values) {
              const armorstat_score = parseInt(values["armortier"], 10)||0;
              var armor_agi_modifier = 0;
              var armor_def_modifier = 0;

              if (armorstat_score == 6) {
                armor_agi_modifier = 4;
                armor_def_modifier = 2;
              } else if (armorstat_score == 4) {
                armor_def_modifier = 2;
                armor_agi_modifier = 2;
              } else {
                armor_agi_modifier = 0;
                armor_def_modifier = 0;
              }
              setAttrs({
                ["agidr"]: armor_agi_modifier,
                ["defdr"]: armor_def_modifier
              });
            });
          });
        </script>




