<input type="hidden" name="attr_version" value="1">
<input class="tab" type="hidden" name="attr_tab" value="character">

<!--tabs-->
<button title="Character" name="act_tab_character" type="action">character</button>
<button title="Ark" name="act_tab_ark" type="action">ark</button>
<div class="logo"><img alt="Mutant Year Zero" src="https://raw.githubusercontent.com/clevett/roll20-character-sheets/myz-fl/Mutant%20Year%20Zero/images/logo.png"></div>

<div class="wrapper tab-content character">
    <div class="box character-details">
        <div class="details-grid">
            <div class="details-box1"><span class="label" data-i18n="name">Name</span></div>
            <div class="details-box2">
                <input class="input" type="text" name="attr_character_name" value="" title="@{character_name}" />
            </div>
            <div class="details-box3"><span class="label" data-i18n="role">Role</span></div>
            <div class="details-box4">
                <input class="input" type="text" name="attr_role" value="" title="@{role}" />        
            </div>
            <div class="conditions-grid">                
                <div class="conditions-box2">
                    <input class="input xbox conditions-starving" type="checkbox" name="attr_hungry" value="1" title="@{starving}" /><span></span>
                </div>
                <input class="conditions-starving" type="checkbox" name="attr_hungry" value="1" style="display:none;" />
                <div class="conditions-box3"><span class="header-h1 conditions-starving" data-i18n="starving">Starving</span></div>
            </div>
            <div class="conditions-grid"> 
                <div class="conditions-box4">
                    <input class="input xbox conditions-sleepless" type="checkbox" name="attr_sleepy" value="1" title="@{sleepless}" /><span></span>
                </div>
                <input class="conditions-sleepless" type="checkbox" name="attr_sleepy" value="1" style="display:none;" />
                <div class="conditions-box5"><span class="header-h1 conditions-sleepless" data-i18n="sleepless">Sleepless</span></div>
            </div>
            <div class="conditions-grid">    
                <div class="conditions-box6">
                    <input class="input xbox conditions-dehydrated" type="checkbox" name="attr_thirsty" value="1" title="@{dehydrated}" /><span></span>
                </div>
                <input class="conditions-dehydrated" type="checkbox" name="attr_thirsty" value="1" style="display:none;" />
                <div class="conditions-box7"><span class="header-h1 conditions-dehydrated" data-i18n="dehydrated">Dehydrated</span></div>
            </div>
            <div class="conditions-grid"> 
                <div class="conditions-box8">
                    <input class="input xbox conditions-hypothermic" type="checkbox" name="attr_cold" value="1" title="@{hypothermic}" /><span></span>
                </div>
                <input class="conditions-hypothermic" type="checkbox" name="attr_cold" value="1" style="display:none;" />
                <div class="conditions-box9"><span class="header-h1 conditions-hypothermic" data-i18n="hypothermic">Hypothermic</span></div>
            </div>            
        </div>
    </div>
    <div class="grid character-grid">
        <div class="box character-attributes">
            <div class="attributes-grid">
                <div class="attributes-box1 header"><h1 data-i18n="attribute-u">ATTRIBUTES</h1></div>
                <div class="attributes-box2"><span class="label" data-i18n="strength">Strength</span></div>
                <div class="attributes-box3">
                    <input class="input-number" type="number" name="attr_strength_max" value="0" min="0" title="@{strength_max}" />
                </div>
                <div class="attributes-box4">
                    <input class="input-number" type="text" name="attr_strength" value="0" title="@{strength}" readonly />
                </div>
                <div class="attributes-box5">
                    <input type="radio" name="attr_damage" value="0" style="margin:2px 8px 0 0;" data-i18n-title="no-damage" title="No Damage" checked="checked" />
                    <input class="skull" type="radio" name="attr_damage" value="1" title="@{damage}" /><span></span>
                    <input class="skull" type="radio" name="attr_damage" value="2" title="@{damage}" /><span></span>
                    <input class="skull" type="radio" name="attr_damage" value="3" title="@{damage}" /><span></span>
                    <input class="skull" type="radio" name="attr_damage" value="4" title="@{damage}" /><span></span>
                    <input class="skull" type="radio" name="attr_damage" value="5" title="@{damage}" /><span></span>
                    <input class="skull" type="radio" name="attr_damage" value="6" title="@{damage}" /><span></span>
                </div>
                <div class="attributes-box6"><span class="label" data-i18n="agility">Agility</span></div>
                <div class="attributes-box7">
                    <input class="input-number" type="number" name="attr_agility_max" value="0" min="0" title="@{agility}" />
                </div>
                <div class="attributes-box8">
                    <input class="input-number" type="text" name="attr_agility" value="0" title="@{agility}" readonly />        
                </div>
                <div class="attributes-box9">
                    <input type="radio" name="attr_fatigue" value="0" style="margin:2px 8px 0 0;" data-i18n-title="no-damage" title="No Damage" checked="checked" />
                    <input class="skull" type="radio" name="attr_fatigue" value="1" title="@{fatigue}" /><span></span>
                    <input class="skull" type="radio" name="attr_fatigue" value="2" title="@{fatigue}" /><span></span>
                    <input class="skull" type="radio" name="attr_fatigue" value="3" title="@{fatigue}" /><span></span>
                    <input class="skull" type="radio" name="attr_fatigue" value="4" title="@{fatigue}" /><span></span>
                    <input class="skull" type="radio" name="attr_fatigue" value="5" title="@{fatigue}" /><span></span>
                    <input class="skull" type="radio" name="attr_fatigue" value="6" title="@{fatigue}" /><span></span>
                </div>
                <div class="attributes-box10"><span class="label" data-i18n="wits">Wits</span></div>
                <div class="attributes-box11">
                    <input class="input-number" type="number" name="attr_wits_max" value="0" min="0" title="@{wits}" />
                </div>
                <div class="attributes-box12">
                    <input class="input-number" type="text" name="attr_wits" value="0" title="@{wits}" readonly />
                </div>
                <div class="attributes-box13">
                    <input type="radio" name="attr_confusion" value="0" style="margin:2px 8px 0 0;" data-i18n-title="no-damage" title="No Damage" checked="checked" />
                    <input class="skull" type="radio" name="attr_confusion" value="1" title="@{confusion}" /><span></span>
                    <input class="skull" type="radio" name="attr_confusion" value="2" title="@{confusion}" /><span></span>
                    <input class="skull" type="radio" name="attr_confusion" value="3" title="@{confusion}" /><span></span>
                    <input class="skull" type="radio" name="attr_confusion" value="4" title="@{confusion}" /><span></span>
                    <input class="skull" type="radio" name="attr_confusion" value="5" title="@{confusion}" /><span></span>
                    <input class="skull" type="radio" name="attr_confusion" value="6" title="@{confusion}" /><span></span>
                </div>
                <div class="attributes-box14"><span class="label" data-i18n="empathy">Empathy</span></div>
                <div class="attributes-box15">
                    <input class="input-number" type="number" name="attr_empathy_max" value="0" min="0" title="@{empathy}" />
                </div>
				<div class="attributes-box16">
                    <input class="input-number" type="text" name="attr_empathy" value="0" title="@{empathy}" readonly /> 
                </div>
                <div class="attributes-box17">
                    <input type="radio" name="attr_doubt" value="0" style="margin:2px 8px 0 0;" data-i18n-title="no-damage" title="No Damage" checked="checked" />
                    <input class="skull" type="radio" name="attr_doubt" value="1" title="@{doubt}" /><span></span>
                    <input class="skull" type="radio" name="attr_doubt" value="2" title="@{doubt}" /><span></span>
                    <input class="skull" type="radio" name="attr_doubt" value="3" title="@{doubt}" /><span></span>
                    <input class="skull" type="radio" name="attr_doubt" value="4" title="@{doubt}" /><span></span>
                    <input class="skull" type="radio" name="attr_doubt" value="5" title="@{doubt}" /><span></span>
                    <input class="skull" type="radio" name="attr_doubt" value="6" title="@{doubt}" /><span></span>
                </div>
            </div>
        </div>
        <div class="box character-appearance">
            <div class="appearance-grid">
                <div class="appearance-box1 header"><h1 data-i18n="appearance-u">APPEARANCE</h1></div>
                <input class="display" name="attr_appearence_reveal" type="hidden" value="display,face,body,clothing," />
                <div class="appearance-box2">
                    <button class="toggles" name="act_settings_face" type="action">y</button>
                    <span class="label" data-i18n="face">Face</span>
                </div>
                <div class="appearance-box3">
                    <span name="attr_face"></span>
                    <textarea class="input-textarea" name="attr_face" title="@{face}"></textarea>
                </div>
                <div class="appearance-box4">
                    <button class="toggles" name="act_settings_body" type="action">y</button>
                    <span class="label" data-i18n="body">Body</span>
                </div>
                <div class="appearance-box5">
                    <span name="attr_body"></span>
                    <textarea class="input-textarea" name="attr_body" title="@{body}"></textarea>
                </div>
                <div class="appearance-box6">
                    <button class="toggles" name="act_settings_clothing" type="action">y</button>
                    <span class="label" data-i18n="clothing">Clothing</span>
                </div>
                <div class="appearance-box7">
                    <span name="attr_clothing"></span>
                    <textarea class="input-textarea" name="attr_clothing" title="@{clothing}"></textarea>
                </div>
            </div>                    
        </div>        
        <div class="box character-injuries">
			<div class="injuries-grid">
				<div class="injuries-box1 header">
                    <h1 data-i18n="critical-u">CRITICAL INJURIES</h1>
                </div>		
                <div class="injuries-box7">
                    <fieldset class="repeating_injuries">
                        <button class="toggles toggles-repeating" name="act_settings" type="action">y</button>
                        <input class="display" name="attr_reveal" type="hidden" value="display,settings," />
                        <div class="display">
                            <span name="attr_injury_name"></span>
                            <span name="attr_injury_display"></span>
                        </div>
                        <div class="grid settings injuries-grid">
                            <label class="injuries-box2" data-i18n="injury">Injury</label>
                            <input type="text" class="injuries-box8 input" name="attr_injury_name" placeholder="Broken Leg" title="@{repeating_injuries_$X_injury_name}" value="" />
                            <label class="injuries-box3">Lethal</label>
                            <select class="injuries-box9 input" name="attr_injury_lethal" title="@{repeating_injuries_$X_injury_lethal}" value="">
                                <option value="no" data-i18n="no">No</option>
                                <option value="yes" data-i18n="yes">Yes</option>
                                <option value="yes -1" data-i18n="yes-1">Yes,-1</option>
                                <option value="" data-i18n="not-applicable-abbr" selected>-</option>
                            </select>
                            <label class="injuries-box4" data-i18n="time-limit">Time Limit</label>
                            <input type="text" class="injuries-box10 input" name="attr_injury_time_limit" placeholder="-" title="@{repeating_injuries_$X_injury_time_limit}" value="" />
                            <label class="injuries-box5" data-i18n="effects">Effects</label>
                            <input type="text" class="injuries-box11 input" name="attr_injury_effects" placeholder="âˆ’2 to Move and Sneak." title="@{repeating_injuries_$X_injury_effects}" value="" />
                            <label class="injuries-box6" data-i18n="healing-time">Heal Time</label>
                            <input type="text" class="injuries-box12 input" name="attr_injury_heal_time" placeholder="3d6" title="@{repeating_injuries_$X_injury_heal_time}" value="" />
                        </div>
                    </fieldset>
                </div>
            </div>
        </div>
        <div class="box character-skills">
            <div class="skills-grid" data-i18n-list="skills-list">
				<span>
					<div class="skills-box1 header"><h1 data-i18n="skill-u">SKILLS</h1></div>
					<div class="skills-box2 column-header"><span class="small-caps" data-i18n="lvl-abbr">Lvl</span></div>
					<div class="skills-box3 column-header"><span class="small-caps" data-i18n="attr-abbr">Attr</span></div>
					<div class="skills-box4 column-header"><span class="small-caps"></span></div>
					<div class="skills-box5 column-header"><span class="small-caps" data-i18n="total">Total</span></div>
				</span>
				<span data-i18n-list-item="endure">
					<button type="action" name="act_dice_pool_endure"><span data-i18n="endure">Endure</span><span class="small-caps" data-i18n="strength-abbr"> [str]</span></button>			
					<input class="input-number" type="number" name="attr_endure" value="0" min="0" title="@{endure}" />			
					<input class="input-number" type="text" name="attr_strength" value="0" title="@{strength}" readonly />
					<span class="equal">=</span>
					<input class="input-number" type="text" name="attr_endure_total" value="0" title="@{endure_total}" readonly />				
				</span>
                <span data-i18n-list-item="force">
                    <button type="action" name="act_dice_pool_force"><span data-i18n="force">Force</span><span class="small-caps" data-i18n="strength-abbr"> [str]</span></button>
                    <input class="input-number" type="number" name="attr_force" value="0" min="0" title="@{force}" />
                    <input class="input-number" type="text" name="attr_strength" value="0" title="@{strength}" readonly />
                    <span class="equal">=</span>
                    <input class="input-number" type="text" name="attr_force_total" value="0" title="@{force_total}" readonly />
                </span>
                <span data-i18n-list-item="fight">
                    <button type="action" name="act_dice_pool_fight"><span data-i18n="fight">fight</span><span class="small-caps" data-i18n="strength-abbr"> [str]</span></button>
                    <input class="input-number" type="number" name="attr_fight" value="0" min="0" title="@{fight}" />
                    <input class="input-number" type="text" name="attr_strength" value="0" title="@{strength}" readonly />
                    <span class="equal">=</span>
                    <input class="input-number" type="text" name="attr_fight_total" value="0" title="@{fight_total}" readonly />
                </span>
                <span data-i18n-list-item="sneak">
                    <button type="action" name="act_dice_pool_sneak"><span data-i18n="sneak">sneak</span><span class="small-caps" data-i18n="agility-abbr"> [agi]</span></button>
                    <input class="input-number" type="number" name="attr_sneak" value="0" min="0" title="@{sneak}" />
                    <input class="input-number" type="text" name="attr_agility" value="0" title="@{agility}" readonly />
                    <span class="equal">=</span>
                    <input class="input-number" type="text" name="attr_sneak_total" value="0" title="@{sneak_total}" readonly />
                </span>
                <span data-i18n-list-item="move">
                    <button type="action" name="act_dice_pool_move"><span data-i18n="move">Move</span><span class="small-caps" data-i18n="agility-abbr"> [agi]</span></button>
                    <input class="input-number" type="number" name="attr_move" value="0" min="0" title="@{move}" />
                    <input class="input-number" type="text" name="attr_agility" value="0" title="@{agility}" readonly />
                    <span class="equal">=</span>
                    <input class="input-number" type="text" name="attr_move_total" value="0" title="@{move_total}" readonly />
                </span>
                <span data-i18n-list-item="shoot">
                    <button type="action" name="act_dice_pool_shoot"><span data-i18n="shoot">shoot</span><span class="small-caps" data-i18n="agility-abbr"> [agi]</span></button>
                    <input class="input-number" type="number" name="attr_shoot" value="0" min="0" title="@{shoot}" />
                    <input class="input-number" type="text" name="attr_agility" value="0" title="@{agility}" readonly />
                    <span class="equal">=</span>
                    <input class="input-number" type="text" name="attr_shoot_total" value="0" title="@{shoot_total}" readonly />
                </span>
                <span data-i18n-list-item="scout">
                    <button type="action" name="act_dice_pool_scout"><span data-i18n="scout">scout</span><span class="small-caps" data-i18n="wits-abbr"> [wit]</span></button>
                    <input class="input-number" type="number" name="attr_scout" value="0" min="0" title="@{scout}" />
                    <input class="input-number" type="text" name="attr_wits" value="0" title="@{wits}" readonly />
                    <span class="equal">=</span>
                    <input class="input-number" type="text" name="attr_scout_total" value="0" title="@{scout_total}" readonly />
                </span>
                <span data-i18n-list-item="comprehend">
                    <button type="action" name="act_dice_pool_comprehend"><span data-i18n="comprehend">comprehend</span><span class="small-caps" data-i18n="wits-abbr"> [wit]</span></button>
                    <input class="input-number" type="number" name="attr_comprehend" value="0" min="0" title="@{comprehend}" />
                    <input class="input-number" type="text" name="attr_wits" value="0" title="@{wits}" readonly />
                    <span class="equal">=</span>
                    <input class="input-number" type="text" name="attr_comprehend_total" value="0" title="@{comprehend_total}" readonly />
                </span>
                <span data-i18n-list-item="know_the_zone">
                    <button type="action" name="act_dice_pool_know_the_zone"><span data-i18n="know_the_zone">Know the Zone</span><span class="small-caps" data-i18n="wits-abbr" style="font-size: 0.8em;"> [wit]</span></button>
                    <input class="input-number" type="number" name="attr_know_the_zone" value="0" min="0" title="@{know_the_zone}" />
                    <input class="input-number" type="text" name="attr_wits" value="0" title="@{wits}" readonly />
                    <span class="equal">=</span>
                    <input class="input-number" type="text" name="attr_know_the_zone_total" value="0" title="@{know_the_zone_total}" readonly />
                </span>
                <span data-i18n-list-item="sense_emotion">
                    <button type="action" name="act_dice_pool_sense_emotion"><span data-i18n="sense_emotion">sense emotion</span><span class="small-caps" data-i18n="empathy-abbr"> [emp]</span></button>
                    <input class="input-number" type="number" name="attr_sense_emotion" value="0" min="0" title="@{sense_emotion}" />
                    <input class="input-number" type="text" name="attr_empathy" value="0" title="@{empathy}" readonly />
                    <span class="equal">=</span>
                    <input class="input-number" type="text" name="attr_sense_emotion_total" value="0" title="@{sense_emotion_total}" readonly />
                </span>
                <span data-i18n-list-item="manipulate">
                    <button type="action" name="act_dice_pool_manipulate"><span data-i18n="manipulate">manipulate</span><span class="small-caps" data-i18n="empathy-abbr"> [emp]</span></button>
                    <input class="input-number" type="number" name="attr_manipulate" value="0" min="0" title="@{manipulate}" />
                    <input class="input-number" type="text" name="attr_empathy" value="0" title="@{empathy}" readonly />
                    <span class="equal">=</span>
                    <input class="input-number" type="text" name="attr_manipulate_total" value="0" title="@{manipulate_total}" readonly />
                </span>
                <span data-i18n-list-item="heal">           
                    <button type="action" name="act_dice_pool_heal"><span data-i18n="heal">Heal</span><span class="small-caps" data-i18n="empathy-abbr"> [emp]</span></button>
                    <input class="input-number" type="number" name="attr_heal" value="0" min="0" title="@{heal}" />
                    <input class="input-number" type="text" name="attr_empathy" value="0" title="@{empathy}" readonly />
                    <span class="equal">=</span>
                    <input class="input-number" type="text" name="attr_heal_total" value="0" title="@{heal_total}" readonly />
                </span>
                <fieldset class="repeating_skills">
                    <input class="display" name="attr_reveal" type="hidden" value="display,settings," />
                    <div class="repeating-skill-grid">
                        <button class="toggles toggles-repeating" name="act_settings" type="action">y</button>
                        <button type="action" name="act_dice-pool-skill"><span name="attr_name"></span></button>
                        <input class="input-number" type="number" name="attr_skill" value="0" min="0" title="@{repeating_skills_$X_skill}" />
                        <select name="attr_attribute" title="@{repeating_skills_$X_attribute}">
                            <option data-i18n="strength-abbr-u" value="strength">str</option>
                            <option data-i18n="agility-abbr-u" value="agility">agi</option>
                            <option data-i18n="wits-abbr-u" value="wits">wits</option>
                            <option data-i18n="empathy-abbr-u" value="empathy">emp</option>
                        </select>
                        <span class="equal">=</span>
                        <input class="input-number"name="attr_total"  type="text" value="0" title="@{repeating_skills_$X_total}" readonly />
                    </div>
                    <div class="settings repeating-skill-grid">
                        <input type="text" name="attr_name" placeholder="skill name" title="@{repeating_skills_$X_name}" value="" />
                    </div>
                </fieldset>
			</div>    
        </div>
        <div class="box character-dice_pool">
            <div class="dice_pool-grid">
                <div class="dice_pool-box1 header"><h1 data-i18n="dice-pool">DICE POOL</h1></div>
                <div class="grid-item">
                    <span class="label" data-i18n="attribute-score">Attribute Score</span>
                    <input type="radio" name="attr_base" value="6" class="dice-selection attribute" /><span title="6"></span>
                    <input type="radio" name="attr_base" value="5" class="dice-selection attribute" /><span title="5"></span>
                    <input type="radio" name="attr_base" value="4" class="dice-selection attribute" /><span title="4"></span>
                    <input type="radio" name="attr_base" value="3" class="dice-selection attribute" /><span title="3"></span>
                    <input type="radio" name="attr_base" value="2" class="dice-selection attribute" /><span title="2"></span>
                    <input type="radio" name="attr_base" value="1" class="dice-selection attribute" /><span title="1"></span>
                    <input type="radio" name="attr_base" value="0" class="dice-selection attribute" checked="checked" /><span title="0"></span>
                </div>
                <div class="grid-item">
                    <span class="label" data-i18n="skill-level">Skill Level</span>
                    <input type="radio" name="attr_skill" value="7" class="dice-selection skill" /><span title="7"></span>
                    <input type="radio" name="attr_skill" value="6" class="dice-selection skill" /><span title="6"></span>
                    <input type="radio" name="attr_skill" value="5" class="dice-selection skill" /><span title="5"></span>
                    <input type="radio" name="attr_skill" value="4" class="dice-selection skill" /><span title="4"></span>
                    <input type="radio" name="attr_skill" value="3" class="dice-selection skill" /><span title="3"></span>
                    <input type="radio" name="attr_skill" value="2" class="dice-selection skill" /><span title="2"></span>
                    <input type="radio" name="attr_skill" value="1" class="dice-selection skill" /><span title="1"></span>
                    <input type="radio" name="attr_skill" value="0" class="dice-selection skill" checked="checked" /><span title="0"></span>
                    <input type="radio" name="attr_skill" value="-1" class="dice-selection negative" /><span title="-1"></span>
                    <input type="radio" name="attr_skill" value="-2" class="dice-selection negative" /><span title="-2"></span>
                    <input type="radio" name="attr_skill" value="-3" class="dice-selection negative" /><span title="-3"></span>
                    <hr class="horizontal-rule">
                    <div class="sub-grid-item">
                        <button type="action" name="act_dice_pool_clear" data-i18n-title="reset-dice" title="Reset dice pool." data-i18n="clear-dice-pool">Clear Dice Pool</button>
                    </div>
                </div>
                <div class="grid-item">
                    <span class="label" data-i18n="gear-bonus">Gear Bonus</span>
                    <input type="radio" name="attr_gear" value="12" class="dice-selection gear" /><span title="12"></span>
                    <input type="radio" name="attr_gear" value="11" class="dice-selection gear" /><span title="11"></span>
                    <input type="radio" name="attr_gear" value="10" class="dice-selection gear" /><span title="10"></span>
                    <input type="radio" name="attr_gear" value="9" class="dice-selection gear" /><span title="9"></span>
                    <input type="radio" name="attr_gear" value="8" class="dice-selection gear" /><span title="8"></span>
                    <input type="radio" name="attr_gear" value="7" class="dice-selection gear" /><span title="7"></span>
                    <input type="radio" name="attr_gear" value="6" class="dice-selection gear" /><span title="6"></span>
                    <input type="radio" name="attr_gear" value="5" class="dice-selection gear" /><span title="5"></span>
                    <input type="radio" name="attr_gear" value="4" class="dice-selection gear" /><span title="4"></span>
                    <input type="radio" name="attr_gear" value="3" class="dice-selection gear" /><span title="3"></span>
                    <input type="radio" name="attr_gear" value="2" class="dice-selection gear" /><span title="2"></span>
                    <input type="radio" name="attr_gear" value="1" class="dice-selection gear" /><span title="1"></span>
                    <input type="radio" name="attr_gear" value="0" class="dice-selection gear" checked="checked" /><span title="0"></span>
                </div>
                <div class="grid-item span-three" style="padding: 10px 0 10px 0;">
                    <input class="input" type="hidden" name="attr_current_preset" value="" readonly />                    
                    <input type="hidden" name="attr_include_with_roll" value="" readonly />
                    <span class="label" data-i18n="current-preset">Current Preset</span>
                    <br>
                    <span class="header-h1" name="attr_current_preset"></span>
                </div>
                <div class="grid-item template-roll">
                    <input name="attr_base_roll" type="hidden" value="" />
                    <input name="attr_skill_roll" type="hidden" value="" />
                    <input name="attr_gear_roll" type="hidden" value="" />
                    <button class="dice-pool" type="roll" name="roll_the_dice" value="&{template:rolls} {{character_name=@{character_name}}} {{character_id=@{character_id}}} {{name=^{dice-pool}}} {{subtitle=@{current_preset}}} {{free-text}} {{footer}} @{base_roll} @{skill_roll} @{gear_roll} @{include_with_roll}" data-i18n-title="roll-dice" title="Roll the Dice!"><span class="small-caps" data-i18n="roll"> Roll </span></button>
                </div>
                <div class="grid-item template-roll">
                    <button class="dice-pool" type="roll" name="roll_a_push" value="&{template:rolls} {{character_name=@{character_name}}} {{character_id=@{character_id}}} {{name=^{pushes-the-roll}}} {{subtitle=@{current_preset}}} {{free-text}} {{footer}} @{base_roll} @{skill_roll} @{gear_roll} {{push-query=?{Did You Adjust the Dice Pool?|Yes ~ Of Course I Did.,The Pool of Dice was Adjusted.|No ~ I didn't ~ I need to Cancel this Roll.,The Pool of Dice was Not Adjusted.} }} @{include_with_roll}" data-i18n-title="push-dice" title="Push the Dice!"><span class="small-caps" data-i18n="push"> Push </span></button>
                </div>
                <div class="grid-item">
                    <button class="dice-pool" type="roll" name="roll_d66" value="&{template:rolls} {{character_name=@{character_name}}} {{character_id=@{character_id}}} {{name=D66 Roll}} {{subtitle}} {{free-text}}  {{skill-die-one=[[ 1 ]] }} {{skill-roll-one=[[ 1d6 ]] }} {{skill-die-two=[[ 1 ]] }} {{skill-roll-two=[[ 1d6 ]] }} {{footer}}" data-i18n-title="roll-dice-66" title="Roll d66!"><span class="small-caps"> D</span>66 </button>
                </div>
            </div>
        </div>
        <div class="box character-talents">
            <div class="talents-grid">
                <div class="talents-box header"><h1 data-i18n="talent-u">TALENTS</h1></div>
                <div class="talents-box2 column-header"><span data-i18n="type">Type</span></div>
                <div class="talents-box3 column-header"><span data-i18n="rank">Rank</span></div>
                <div class="talents-box4">
                    <fieldset class="repeating_talents">
                        <input class="display" name="attr_reveal" type="hidden" value="display,settings,collapse," />
                        <div class="grid talents-grid">
                            <button class="toggles toggles-repeating" name="act_settings" type="action">y</button>
                            <button class="collapse" name="act_collapse" type="action">
                                <span name="attr_talent_name" title="Talent name"></span>
                            </button>
                            <span name="attr_talent_type" title="Talent type"></span>
                            <span name="attr_talent_rank" title="Talent rank"></span>
                            <span class="collapsible" name="attr_talent_description"></span>
                        </div>
                        <div class="grid talents-grid settings">
                            <input class="talents-box1 input" type="text" name="attr_talent_name" value="" title="@{repeating_talents_$X_talent_name}" placeholder="Name" />
                            <select class="talents-box2 input" name="attr_talent_type" title="@{repeating_talents_$X_talent_type}">
                                <option value="Gen" data-i18n="general" selected>General</option>
                                <option value="Role" data-i18n="role">Role</option>
                            </select>
                            <input class="input" name="attr_talent_rank" title="@{repeating_talents_$X_talent_rank}" type="text" value="1" />
                            <textarea class="talents-box4 input-textarea" name="attr_talent_description" title="@{repeating_talents_$X_talent_description}" placeholder="description"></textarea>
                        </div>
                    </fieldset>                
                </div>
            </div>
            <div class="mutants-grid">
                <div class="mutant-box header"><h1 data-i18n="mutantions">MUTANTIONS</h1></div>
                <div class="dots">
                    <input name="attr_mutation" type="radio" value="0" checked/><span>0</span>
                    <input name="attr_mutation" type="radio" value="1"/><span>1</span>
                    <input name="attr_mutation" type="radio" value="2"/><span>2</span>
                    <input name="attr_mutation" type="radio" value="3"/><span>3</span>
                    <input name="attr_mutation" type="radio" value="4"/><span>4</span>
                    <input name="attr_mutation" type="radio" value="5"/><span>5</span>
                    <input name="attr_mutation" type="radio" value="6"/><span>6</span>
                    <input name="attr_mutation" type="radio" value="7"/><span>7</span>
                    <input name="attr_mutation" type="radio" value="8"/><span>8</span>
                    <input name="attr_mutation" type="radio" value="9"/><span>9</span>
                    <input name="attr_mutation" type="radio" value="10"/><span>10</span>
                </div>
                <div class="talents-box4">
                    <fieldset class="repeating_mutantions">
                        <input class="display" name="attr_reveal" type="hidden" value="display,settings,collapse," />
                        <div class="grid mutantions-grid">
                            <button class="toggles toggles-repeating" name="act_settings" type="action">y</button>
                            <button class="collapse" name="act_collapse" type="action">
                                <span name="attr_mutantion_name" title="Mutant Power name"></span>
                            </button>
                             <span class="collapsible" name="attr_mutantion_description"></span>
                        </div>
                        <div class="grid mutantions-grid settings">
                            <input class="talents-box1 input" type="text" name="attr_mutantion_name" value="" title="@{repeating_mutantions_$X_mutantion_name}" placeholder="Name" />
                            <textarea class="talents-box4 input-textarea" name="attr_mutantion_description" title="@{repeating_mutantions_$X_mutantion_description}" placeholder="description"></textarea>
                        </div>
                    </fieldset>                    
                </div>
            </div>
        </div>
        <div class="box character-weapons">
            <div class="weapons-grid">
                <div class="weapons-box header"><h1 data-i18n="weapon-u">WEAPONS</h1></div>
                <div class="weapons-box1 column-header"></div>
                <div class="weapons-box2 column-header"><span data-i18n="name">Name</span></div>                
                <div class="weapons-box3 column-header"><span data-i18n="grip">Grip</span></div>
                <div class="weapons-box4 column-header"><span data-i18n="skill">Skill</span></div>
                <div class="weapons-box5 column-header"><span data-i18n="bonus">Bonus</span></div>
                <div class="weapons-box6 column-header"><span data-i18n="dmg-abbr">Dmg</span></div>
                <div class="weapons-box7 column-header"><span data-i18n="range">Range</span></div>
                <div class="weapons-box8 column-header"><span data-i18n="features">Features</span></div>
                <div class="weapons-box9">
                    <fieldset class="repeating_weapons">
                        <div class="weapons-grid">
                            <button class="weapons-box11 roll-button dicefontd6" type="action" name="act_attack-roll" title="Update Dice Pool">L</button>
                            <input class="weapons-box12 input" type="text" name="attr_weapon_name" value="" title="@{repeating_weapons_$X_weapon_name}" />                            
                            <select class="weapons-box13 input" name="attr_weapon_grip" title="@{repeating_weapons_$X_weapon_grip}" title="@{repeating_weapons_$X_weapon_grip}">
                                <option data-i18n="not-applicable-abbr" value="n/a">n/a</option>
                                <option data-i18n="one-hand-abbr" value="1H" selected>1H</option>
                                <option data-i18n="two-hand-abbr" value="2H">2H</option>
                            </select>
                            <select class="weapons-box14 input" name="attr_weapon_skill" title="@{repeating_weapons_$X_weapon_skill}">
                                <option value="0" selected data-i18n="fight">Fight</option>
                                <option value="1" data-i18n="shoot">Shoot</option>
                            </select>
                            <select class="weapons-box15 input" name="attr_weapon_bonus" title="@{repeating_weapons_$X_weapon_bonus}">
                                <option value="0">0</option>
                                <option value="1" selected>1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                                <option value="7">7</option>
                                <option value="8">8</option>
                                <option value="9">9</option>
                                <option value="10">10</option>
                                <option value="11">11</option>
                                <option value="12">12</option>
                            </select>
                            <input class="weapons-box17 input-number" type="number" name="attr_weapon_damage" value="1" min="0" title="@{repeating_weapons_$X_weapon_damage}" />
                            <select class="weapons-box18 input" name="attr_weapon_range" title="@{repeating_weapons_$X_weapon_range}">
                                <option value="Arm" selected data-i18n="arms-length-abbr">Arm's L.</option>
                                <option value="Near" data-i18n="near">Near</option>
                                <option value="Short" data-i18n="short">Short</option>
                                <option value="Long" data-i18n="long">Long</option>
                            </select>
                            <input class="weapons-box19 input" type="text" name="attr_weapon_features" value="" title="@{repeating_weapons_$X_weapon_features}" />
                        </div>
                    </fieldset>
                </div>
            </div>
        </div>
    </div>
    <div class="second-row">
        <div class="armor-col">
            <div class="grid">
                <div class="box character-armor">
                    <div class="armor-container">
                        <div class="armor-grid">
                            <div class="armor-box header"><h1 data-i18n="armor">ARMOR</h1></div>
                            <div class="armor-box1 column-header"><span class="small-caps"></span></div>
                            <div class="armor-box2 column-header"><span class="small-caps"></span></div> 
                            <div class="armor-box3 column-header"><span class="small-caps" data-i18n="damage-abbr">Dmg</span></div>
                            <div class="armor-box4 column-header"><span class="small-caps" data-i18n="rating">Rating</span></div>
                            <div class="armor-box5 column-header"><span class="small-caps" data-i18n="total">Total</span></div>
                            <div class="armor-box6 armor-grid">                        
                                <input class="armor-box1 input" type="text" name="attr_armor1_name" value="" title="@{armor1_name}" placeholder="name" />
                                <input class="armor-box2 input" type="checkbox" name="attr_armor1_equiped" value="1" title="@{armor1_equiped}" checked />
                                <input class="armor-box3 input-number" type="number" name="attr_armor1_damage" value="0" max="0" title="@{armor1_damage}" />
                                <input class="armor-box4 input-number" type="number" name="attr_armor1_bonus" value="0" min="0" title="@{armor1_bonus}" />
                                <input class="armor-box5 input-number" type="text" name="attr_armor1_ar" value="0" title="@{armor1_ar}" readonly />
                            </div>
                            <div class="armor-box7 armor-grid">                        
                                <input class="armor-box1 input" type="text" name="attr_armor2_name" value="" title="@{armor2_name}" placeholder="name" />
                                <input class="armor-box2 input" type="checkbox" name="attr_armor2_equiped" value="1" title="@{armor2_equiped}" checked />
                                <input class="armor-box3 input-number" type="number" name="attr_armor2_damage" value="0" max="0" title="@{armor2_damage}" />
                                <input class="armor-box4 input-number" type="number" name="attr_armor2_bonus" value="0" min="0" title="@{armor2_bonus}" />
                                <input class="armor-box5 input-number" type="text" name="attr_armor2_ar" value="0" title="@{armor2_ar}" readonly />
                            </div>
                            <div class="armor-box8">
                                <div class="armor-subgrid">
                                    <span class="armor-box1">
                                        <button type="action" name="act_armor-roll" title="Update Dice Pool" data-i18n="armor">Armor</button>
                                    </span>                            
                                    <span class="armor-box4 label header" data-i18n="armor-rating-abbr">AR</span>
                                    <input class="armor-box5 input-number" type="text" name="attr_ar" value="0" title="@{ar}" style="border:1px solid #000;" readonly />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="box rot-level">
                    <div class="rot-grid">
                        <input name="attr_rot_roll" type="hidden" value="" />
                        <div class="rot-box header"><h1 data-i18n="rot-p">ROT POINTS</h1></div>
                        <div class="dots">
                            <input name="attr_rot" type="radio" value="0" checked /><span>0</span>
                            <input name="attr_rot" type="radio" value="1"/><span>1</span>
                            <input name="attr_rot" type="radio" value="2"/><span>2</span>
                            <input name="attr_rot" type="radio" value="3"/><span>3</span>
                            <input name="attr_rot" type="radio" value="4"/><span>4</span>
                            <input name="attr_rot" type="radio" value="5"/><span>5</span>
                            <input name="attr_rot" type="radio" value="6"/><span>6</span>
                            <input name="attr_rot" type="radio" value="7"/><span>7</span>
                            <input name="attr_rot" type="radio" value="8"/><span>8</span>
                            <input name="attr_rot" type="radio" value="9"/><span>9</span>
                            <input name="attr_rot" type="radio" value="10"/><span>10</span>
                        </div>
                        <label title="permaneant rot">
                            <span data-i18n="permaneant-rot">permaneant rot</span>
                            <input class="input-number" type="number" name="attr_rot_permenant" value="0" min="0" title="@{rot_permenant}" />
                        </label>
                        <button class="dicefontd6" name="rot" type="roll" value=" &{template:rolls} {{character_name=@{character_name}}} {{character_id=@{character_id}}} {{name=^{rot}}} @{rot_roll}">L</button>
                    </div>
                </div>
                <div class="box character-experience">
                    <div class="experience-grid">
                        <div class="experience-box header">
                            <h1 data-i18n="experience-u">EXPERIENCE</h1>
                        </div>
                    </div>
                </div>
                <div class="experience-dots dots">
                    <input name="attr_experience" type="radio" value="0" checked />
                    <input name="attr_experience" type="radio" value="1" checked/><span>0</span>
                    <input name="attr_experience" type="radio" value="2"/><span>1</span>
                    <input name="attr_experience" type="radio" value="3"/><span>2</span>
                    <input name="attr_experience" type="radio" value="4"/><span>3</span>
                    <input name="attr_experience" type="radio" value="5"/><span>4</span>
                    <input name="attr_experience" type="radio" value="6"/><span>5</span>
                    <input name="attr_experience" type="radio" value="7"/><span>6</span>
                    <input name="attr_experience" type="radio" value="8"/><span>7</span>
                    <input name="attr_experience" type="radio" value="9"/><span>8</span>
                    <input name="attr_experience" type="radio" value="10"/><span>10</span>
                </div>
                <div class="box character-relationships">
                    <div class="relationships-grid">                
                        <div class="relationships-box1 header">
                            <h1 data-i18n="relationships-u">RELATIONSHIPS</h1>
                        </div>
                        <div class="relationships-box2 column-header"><span data-i18n="buddy">Buddy</span></div>
                        <div class="relationships-box3">
                            <fieldset class="repeating_relationships">
                                <div class="relationships-grid">
                                    <input class="input-number" type="text" name="attr_pc_name" value="" title="@{repeating_relationships_$X_pc_name}" placeholder="PC's name" />
                                    <textarea class="input-textarea" name="attr_pc_description" title="@{repeating_relationships_$X_pc_description}" placeholder="Describe the relationship."></textarea>
                                    <input name="attr_buddy"  title="@{repeating_relationships_$X_buddy}" type="checkbox"><span></span>
                                    <hr />
                                </div>
                            </fieldset>
                        </div>
                        <label data-i18n="i-hate">i hate:</label><input name="attr_hate" value="0" title="@{hate}" type="text" value="0" />
                        <label data-i18n="i-protect">i need to protect:</label><input name="attr_protect" value="0" title="@{protect}" type="text" value="0" />
                        <label data-i18n="i-dream">my big dream:</label><input name="attr_dream" value="0" title="@{dream}" type="text" value="0" />
                    </div>
                </div>
                <div class="box character-notes">
                    <div class="notes-grid">                
                        <div class="notes-box1 header">
                            <h1 data-i18n="notes-u">NOTES</h1>
                        </div>
                        <div class="notes-box2">
                            <fieldset class="repeating_notes">
                                <div class="notes-grid">
                                    <input class="input-number" type="text" name="attr_note_name" value="" title="@{repeating_notes_$X_note_name}" placeholder="Note's name" />
                                    <textarea class="notes-box4 input-textarea" name="attr_note_description" title="@{repeating_notes_$X_note_description}" placeholder="Note's description."></textarea>
                                    <hr />
                                </div>
                            </fieldset>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="gear-col">
            <div class="grid">
                <div class="box character-gear">
                    <div class="gear-grid">
                        <div class="gear-box1 header"><h1 data-i18n="gea-u">GEAR</h1></div>                
                        <div class="gear-box2 column-header"><span class="small-caps" data-i18n="quantity-abbr">Qty</span></div>
                        <div class="gear-box3 column-header"><span class="small-caps" data-i18n="carried-abbr">Carr</span></div>
                        <div class="gear-box4 column-header"><span class="small-caps" data-i18n="weight-abbr">Wt</span></div>
                        <div class="gear-box5">
                            <fieldset class="repeating_gear">
                                <input class="display" name="attr_reveal" type="hidden" value="display,settings," />
                                <div class="grid gear-grid">
                                    <button class="toggles toggles-repeating" name="act_settings" type="action">y</button>
                                    <button class="collapse" name="act_collapse" type="action">
                                        <span name="attr_gear_name"></span>
                                    </button>
                                    <span name="attr_gear_qty"></span>
                                    <span name="attr_gear_carried"></span>
                                    <span name="attr_gear_weight"></span>
                                    <span class="collapsible" name="attr_gear_description"></span>
                                </div>
                                <div class="grid settings gear-grid">
                                    <input class="gear-box1 input" type="text" name="attr_gear_name" value="" title="@{repeating_gear_$X_gear_name}" placeholder="item" />
                                    <input class="gear-box2 input-number" type="number" name="attr_gear_qty" value="1" min="0" title="@{repeating_gear_$X_gear_qty}" />
                                    <input class="gear-box3 input" type="checkbox" name="attr_gear_carried" value="1" title="@{repeating_gear_$X_gear_carried}" checked />
                                    <select class="gear-box4 input" name="attr_gear_weight" title="@{repeating_gear_$X_gear_weight}">
                                        <option data-i18n="tiny-abbr" value="0" selected>T</option>
                                        <option data-i18n="light-abbr" value="0.5">L</option>
                                        <option data-i18n="normal-abbr" value="1">N</option>
                                        <option data-i18n="heavy-abbr" value="2">H</option>
                                    </select>
                                    <textarea class="gear-box5 input-textarea" name="attr_gear_description" title="@{repeating_talents_$X_gear_description}" placeholder="description"></textarea>
                                </div>
                            </fieldset>                    
                        </div>
                        <div class="gear-box6 header">
                            <div class="gear-subgrid">
                                <div class="gear-box7"><span class="label" data-i18n="carry">Carry</span></div>
                                <div class="gear-box8"><input class="input-number" type="text" name="attr_carry" value="" title="@{carry} = 2 x strength_max" readonly /></div>
                                <div class="gear-box9"><span class="label" data-i18n="encumbrance">Encumbrance</span></div>
                                <div class="gear-box10">
                                    <input type="hidden" name="attr_character_gear_encumbrance" value="0" />
                                    <input class="input-number" type="text" name="attr_character_encumbrance" value="0" title="@{character_encumbrance}" readonly />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="box character-vehicle_gear">
                    <div class="vehicle_gear-grid">
                        <div class="vehicle_gear-box1 header"><h1 data-i18n="on-vehicle">On Vehicle</h1></div>                
                        <div class="vehicle_gear-box2 column-header"><span class="small-caps" data-i18n="quantity-abbr">Qty</span></div>
                        <div class="vehicle_gear-box3 column-header"><span class="small-caps" data-i18n="carried-abbr">Carr</span></div>
                        <div class="vehicle_gear-box4 column-header"><span class="small-caps" data-i18n="weight-abbr" >Wt</span></div>
                        <div class="vehicle_gear-box5">
                            <fieldset class="repeating_vehicle">
                                <input class="display" name="attr_reveal" type="hidden" value="display,settings," />
                                <div class="grid vehicle_gear-grid">
                                    <button class="toggles toggles-repeating" name="act_settings" type="action">y</button>
                                    <button class="collapse" name="act_collapse" type="action">
                                        <span name="attr_vehicle_gear_name"></span>
                                    </button>
                                    <span name="attr_vehicle_gear_qty"></span>
                                    <span name="attr_vehicle_gear_carried"></span>
                                    <span name="attr_vehicle_gear_weight"></span>
                                    <span class="collapsible" name="attr_vehicle_gear_description"></span>
                                </div>
                                <div class="grid settings vehicle_gear-grid">
                                    <input class="vehicle_gear-box1 input" type="text" name="attr_vehicle_gear_name" value="" title="@{repeating_vehicle_gear_$X_gear_name}" placeholder="item" />
                                    <input class="vehicle_gear-box2 input-number" type="number" name="attr_vehicle_gear_qty" value="1" min="0" title="@{repeating_vehicle_gear_$X_gear_qty}" />
                                    <input class="vehicle_gear-box3 input" type="checkbox" name="attr_vehicle_gear_carried" value="1" title="@{repeating_vehicle_gear_$X_gear_carried}" checked />
                                    <select class="vehicle_gear-box4 input" name="attr_vehicle_gear_weight" title="@{repeating_gear_$X_vehicle_gear_weight}">
                                        <option data-i18n="tiny-abbr" value="0" selected>T</option>
                                        <option data-i18n="light-abbr" value="0.5">L</option>
                                        <option data-i18n="normal-abbr" value="1">N</option>
                                        <option data-i18n="heavy-abbr" value="2">H</option>
                                    </select>
                                    <textarea class="vehicle_gear-box5 input-textarea" name="attr_vehicle_gear_description" title="@{repeating_talents_$X_vehicle_gear_description}" placeholder="description"></textarea>
                                </div>
                            </fieldset>                    
                        </div>
                        <div class="vehicle_gear-box6 header">
                            <div class="vehicle_gear-subgrid">
                                <div class="vehicle_gear-box7"><span class="label" data-i18n="carry">Carry</span></div>
                                <div class="vehicle_gear-box8"><input class="input-number" type="text" name="attr_vehicle_carry" value="(2*(@{vehicle_strength}))" title="@{vehicle_carry} = 2 x vehicle_strength" disabled /></div>
                                <div class="vehicle_gear-box9"><span class="label" data-i18n="encumbrance">Encumbrance</span></div>
                                <div class="vehicle_gear-box10">
                                    <input class="input" type="hidden" name="attr_vehicle_gear_encumbrance" value="0" />
                                    <input class="input-number" type="text" name="attr_vehicle_encumbrance" value="0" title="@{vehicle_encumbrance}" readonly />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="wrapper tab-content ark">
    <div class="grid ark-details-grid">
        <input class="input-number" type="hidden" name="attr_ark_battle_level" value="0" />
        <div class="box ark-info-grid">
            <h1 data-i18n="ark-u">Ark</h1>
            <span class="label" data-i18n="type">Type</span>
            <input class="input-number" type="text" name="attr_ark_name" value="" title="@{ark_name}" />
            <span class="label" data-i18n="coordinates">Coordinates</span>
            <input class="input-number" type="text" name="attr_ark_coordinates" value="" title="@{ark_coordinates}" />
            <hr />
            <span class="label" data-i18n="battle-level">Battle Level</span>
            <input class="input-number" type="hidden" name="attr_ark_battle_level" value="0" title="@{ark_battle_level}" />
            <span name="attr_ark_battle_level"></span>
            <button class="dicefontd6" name="Battle Level" title="Battle Level" type="roll" value="&{template:rolls} {{character_name=^{ark-u}}} {{name=^{battle-level}}} ">L</button>
            <span class="label" data-i18n="description">Description</span>
            <textarea class="input-textarea" name="attr_ark_description" title="@{ark_description}"></textarea>
        </div>
        <div class="box ark-development-grid">
            <h1 data-i18n="dev-level">Development Levels</h1>
            <span class="label" data-i18n="food-supply">Food Supply</span>
            <input class="input-number" type="number" name="attr_ark_food_supply" value="" title="@{ark_food_supply}" />
            <hr>
            <span class="label" data-i18n="culture">Culture</span>
            <input class="input-number" type="number" name="attr_ark_culture" value="" title="@{ark_culture}" />
            <hr>
            <span class="label" data-i18n="technology">Technology</span>
            <input class="input-number" type="number" name="attr_ark_technology" value="" title="@{ark_technology}" />
            <hr>
            <span class="label" data-i18n="warfare">Warfare</span>
            <input class="input-number" type="number" name="attr_ark_warfare" value="" title="@{ark_warfare}" />
        </div>
    </div>
    <div class="ark-grid">
        <div class="box ark-notes">
            <div class="ark-notes-grid">
                <div class="ark-notes-box1 header">
                    <h1 data-i18n="ark-notes-u">ark NOTES</h1>
                </div>
                <textarea class="ark-ark_notes-box2 input-textarea" name="attr_ark_notes" title="@{ark_notes}"></textarea>
            </div>
        </div>
    </div>
</div>

<label class="footer">v.<span name="attr_version"></span></label>

<!-- Roll Templates -->
<rolltemplate class="sheet-rolltemplate-rolls">
    <div class="template-wrap">
        <div class="template-grid">
            <div class="template-grid-item template-span-six template-header">
                {{#character_name}}
                <div class="template-grid-item template-span-left template-header">
                {{#character_id}}[{{character_name}}](https://journal.roll20.net/character/{{character_id}}){{/character_id}}
                {{^character_id}}{{character_name}}{{/character_id}}
                </div>
                {{/character_name}}
                {{#name}}
                <div class="template-grid-item template-span-center template-header">â—‡</div>
                {{/name}}                
                {{#name}}
                <div class="template-grid-item template-span-right template-header">
                {{#name_link}}[{{name}}]({{name_link}}){{/name_link}}
                {{^name_link}}{{name}}{{/name_link}}
                </div>
                {{/name}}
            </div>
            {{#subtitle}}<div class="template-grid-item template-span-six template-subtitle"><span>{{subtitle}}</span></div>{{/subtitle}}

    <!--- dice pool -->
        {{#base1}}<div class="template-span-one template-base-dice dice">{{base1}}</div>{{/base1}}
        {{#base2}}<div class="template-span-two template-base-dice dice">{{base2}}</div>{{/base2}}
        {{#skill1}}<div class="template-span-three template-skill-dice dice">{{skill1}}</div>{{/skill1}}
        {{#skill2}}<div class="template-span-four template-skill-dice dice">{{skill2}}</div>{{/skill2}}
        {{#negative1}}<div class="template-span-three template-purple-dice dice">{{negative1}}</div>{{/negative1}}
        {{#negative2}}<div class="template-span-four template-purple-dice dice">{{negative2}}</div>{{/negative2}}
        {{#gear1}}<div class="template-span-five template-gear-dice dice">{{gear1}}</div>{{/gear1}}
        {{#gear2}}<div class="template-span-shix template-gear-dice dice">{{gear2}}</div>{{/gear2}}
        <!--- BEGIN ROW TWO --->
        {{#base3}}<div class="template-span-one template-base-dice dice">{{base3}}</div>{{/base3}}
        {{#base4}}<div class="template-span-two template-base-dice dice">{{base4}}</div>{{/base4}}
        {{#skill3}}<div class="template-span-three template-skill-dice dice">{{skill3}}</div>{{/skill3}}
        {{#skill4}}<div class="template-span-four template-skill-dice dice">{{skill4}}</div>{{/skill4}}
        {{#negative3}}<div class="template-span-three template-purple-dice dice">{{negative3}}</div>{{/negative3}}
        {{#gear3}}<div class="template-span-five template-gear-dice dice">{{gear3}}</div>{{/gear3}}
        {{#gear4}}<div class="template-span-shix template-gear-dice dice">{{gear4}}</div>{{/gear4}}
        <!--- BEGIN ROW THREE -->
        {{#base5}}<div class="template-span-one template-base-dice dice">{{base5}}</div>{{/base5}}
        {{#base6}}<div class="template-span-two template-base-dice dice">{{base6}}</div>{{/base6}}
        {{#skill5}}<div class="template-span-three template-skill-dice dice">{{skill5}}</div>{{/skill5}}
        {{#skill6}}<div class="template-span-four template-skill-dice dice">{{skill6}}</div>{{/skill6}}
        {{#gear5}}<div class="template-span-five template-gear-dice dice">{{gear5}}</div>{{/gear5}}
        {{#gear6}}<div class="template-span-shix template-gear-dice dice">{{gear6}}</div>{{/gear6}}
        <!--- BEGIN ROW FOUR -->
        {{#base7}}<div class="template-span-one template-base-dice dice">{{base7}}</div>{{/base7}}
        {{#base8}}<div class="template-span-two template-base-dice dice">{{base8}}</div>{{/base8}}
        {{#skill7}}<div class="template-span-three template-skill-dice dice">{{skill7}}</div>{{/skill7}}
        {{#gear7}}<div class="template-span-five template-gear-dice dice">{{gear7}}</div>{{/gear7}}
        {{#gear8}}<div class="template-span-shix template-gear-dice dice">{{gear8}}</div>{{/gear8}}
        <!--- BEGIN ROW FIVE -->
        {{#base9}}<div class="template-span-one template-base-dice dice">{{base7}}</div>{{/base9}}
        {{#base10}}<div class="template-span-two template-base-dice dice">{{base10}}</div>{{/base10}}
        {{#gear9}}<div class="template-span-five template-gear-dice dice">{{gear9}}</div>{{/gear9}}
        {{#gear10}}<div class="template-span-shix template-gear-dice dice">{{gear10}}</div>{{/gear10}}
        <!--- BEGIN ROW SIX -->
        {{#gear11}}<div class="template-span-five template-gear-dice dice">{{gear11}}</div>{{/gear11}}
        {{#gear12}}<div class="template-span-shix template-gear-dice dice">{{gear12}}</div>{{/gear12}}
        <!-- ROT & MUTATION points -->
        {{#other1}}<div class="template-other-dice dice">{{other1}}</div>{{/other1}}
        {{#other2}}<div class="template-other-dice dice">{{other2}}</div>{{/other2}}
        {{#other3}}<div class="template-other-dice dice">{{other3}}</div>{{/other3}}
        {{#other4}}<div class="template-other-dice dice">{{other4}}</div>{{/other4}}
        {{#other5}}<div class="template-other-dice dice">{{other5}}</div>{{/other5}}
        {{#other6}}<div class="template-other-dice dice">{{other6}}</div>{{/other6}}
        {{#other7}}<div class="template-other-dice dice">{{other7}}</div>{{/other7}}
        {{#other8}}<div class="template-other-dice dice">{{other8}}</div>{{/other8}}
        {{#other9}}<div class="template-other-dice dice">{{other9}}</div>{{/other9}}
        {{#other10}}<div class="template-other-dice dice">{{other10}}</div>{{/other10}}
<!--- dice pool column labels in footer-->            
            {{#attribute-die-one}}
            <div class="template-grid-item template-span-left">
                <span class="template-smaller" data-i18n="attribute-dice dice">Attribute Dice</span>
            </div>
            <div class="template-grid-item template-span-center">
                <span class="template-smaller" data-i18n="skill-dice dice">Skill Dice</span>
            </div>
            <div class="template-grid-item template-span-right">
                <span class="template-smaller" data-i18n="gear-dice dice">Gear Dice</span>
            </div>
            {{/attribute-die-one}}

<!--- attack -->
            {{#weapon-bonus}}{{#weapon-damage}}{{#weapon-range}}
            <div class="template-grid-item template-span-six">
                <span class="label" data-i18n="bonus">Bonus</span>:&nbsp;{{weapon-bonus}}
                <span class="label" data-i18n="damage">Damage</span>:&nbsp;{{weapon-damage}}
                <span class="label" data-i18n="range">Range</span>:&nbsp;{{weapon-range}}
            </div>
            {{/weapon-range}}{{/weapon-damage}}{{/weapon-bonus}}
            {{#weapon-features}}<div class="template-grid-item template-span-six">{{weapon-features}}</div>{{/weapon-features}}
        </div>
    </div>
</rolltemplate>

<script type="text/worker">
/* ===== PARAMETERS ==========
GiGs 'Super Simple Summarizer'
*/
const repeatingSum = (destination, section, fields, multiplier = 1) => {
    if (!Array.isArray(fields)) fields = [fields];
    getSectionIDs(`repeating_${section}`, idArray => {
        const attrArray = idArray.reduce( (m,id) => [...m, ...(fields.map(field => `repeating_${section}_${id}_${field}`))],[]);
        getAttrs(attrArray, v => {
            console.log(">>> values of v: "+ JSON.stringify(v) +" <<<");
                    // getValue: if not a number, returns 1 if it is 'on' (checkbox), otherwise returns 0..
            const getValue = (section, id,field) => parseFloat(v[`repeating_${section}_${id}_${field}`], 10) || (v[`repeating_${section}_${id}_${field}`] === 'on' ? 1 : 0);
            const sumTotal = idArray.reduce((total, id) => total + fields.reduce((subtotal,field) => subtotal * getValue(section, id,field),1),0);
            setAttrs({[destination]: sumTotal * multiplier});
        });
    });
};
on('change:repeating_gear remove:repeating_gear sheet_opened', () => {
    console.log(">>> Change Detected: Character Gear Encumbrance <<<");
    repeatingSum("character_gear_encumbrance","gear",["gear_weight","gear_qty","gear_carried"]);
});
on('change:repeating_vehicle remove:repeating_vehicle sheet_opened', () => {
    console.log(">>> Change Detected: vehicle's Gear Encumbrance <<<");
    repeatingSum("vehicle_gear_encumbrance","vehicle",["vehicle_gear_weight","vehicle_gear_qty","vehicle_gear_carried"]);
});
/* total encumbrance */
on('change:character_gear_encumbrance change:vehicle_gear_encumbrance', function() {
    getAttrs(["character_gear_encumbrance", "vehicle_gear_encumbrance"], function(values) {
        console.log(">>> Change Detected: Character Encumbrance <<<");
        const character_gear_encumbrance = parseFloat(values["character_gear_encumbrance"],10)||0;
        const vehicle_gear_encumbrance   = parseFloat(values["vehicle_gear_encumbrance"],10)||0;
        const sum_character_weight       = (character_gear_encumbrance);
        const sum_vehicle_weight         = (vehicle_gear_encumbrance);
            setAttrs({
            "character_encumbrance": sum_character_weight,
            "vehicle_encumbrance": sum_vehicle_weight
        });
    });		
});
/* ability damage calcs */    
const damages = { 
    strength: 'damage', 
    agility: 'fatigue', 
    wits: 'confusion', 
    empathy: 'doubt'
};
Object.keys(damages).forEach(stat => { 
    on(`change:${stat}_max change:${damages[stat]}`, () => {
        getAttrs([`${stat}_max`, damages[stat]], (v) => {
            const 	stat_score = parseInt(v[`${stat}_max`], 10) || 0,
                    damage_score = parseInt(v[damages[stat]], 10) || 0;
            setAttrs({
                [`${stat}`] : Math.max(0, stat_score - damage_score )
            });
        });
    });
});

/* skill total calcs */
const attributes = { 
    endure: 'strength',
    force: 'strength',
    fight: 'strength',
    sneak: 'agility',
    move: 'agility',
    shoot: 'agility',
    scout: 'wits',
    comprehend: `wits`,
    know_the_zone: 'wits',
    sense_emotion : 'empathy',
    manipulate: 'empathy',
    heal: 'empathy',
};
Object.keys(attributes).forEach(skill => {
    on(`change:${skill} change:${attributes[skill]}`, () => {
        getAttrs([`${skill}`, attributes[skill]], (v) => {
            const stat_score = parseInt(v[attributes[skill]], 10) || 0,
                  skill_score = parseInt(v[`${skill}`], 10) || 0;
            setAttrs({
                [`${skill}_total`]: stat_score + skill_score
            });
        });
    });
});

const update_roll_name = (attribute) => {
    const update = { roll_name: getTranslationByKey(attribute) };
    setAttributes(update, false);
};

on("change:strength_max", (eventinfo) => {
    getAttrs(["strength_max"], (v) => {
        const str = parseInt(v.strength_max) || 0;
        const update = { carry: str*2 };
        setAttributes(update, false);
    });
});

/* Clear the Dice pool on Click */
on("clicked:dice_pool_clear", () => {
    console.log(">>> Change Detected: Clear Dice Pool - button clicked <<<");
        setAttrs({
            attribute: 0, 
            skill: 0, 
            gear: 0, 
            current_preset: getTranslationByKey(`custom`), 
            include_with_roll: ""
        });
    });

/* set weapon dice pool */
on("clicked:repeating_weapons:attack-roll", () => {
    console.log(">>> Change Detected: Weapon - button clicked <<<");
    getAttrs(['repeating_weapons_weapon_skill', 'repeating_weapons_weapon_name' ,'repeating_weapons_weapon_bonus', 'repeating_weapons_weapon_damage', 'repeating_weapons_weapon_range', 'repeating_weapons_weapon_features', 'strength', 'agility', 'wits', 'empathy', 'shoot', 'fight'], (values) => {
        const 	weapon_skill = parseInt(values.repeating_weapons_weapon_skill,10)||0, 
                weapon_bonus = parseInt(values.repeating_weapons_weapon_bonus,10)||0,
                weapon_name = values.repeating_weapons_weapon_name,
                weapon_damage = parseInt(values.repeating_weapons_weapon_damage,10)||0,
                weapon_range = values.repeating_weapons_weapon_range,
                weapon_features = values.repeating_weapons_weapon_features,
                attribute = (weapon_skill === 0 ? parseInt(values.strength,10)||0 : parseInt(values.agility,10)||0 ),
                skill = (weapon_skill === 0 ? parseInt(values.fight,10)||0 : parseInt(values.shoot,10)||0 );                    
        setAttrs({
            base: attribute, 
            skill: skill,
            gear: weapon_bonus,
            current_preset: getTranslationByKey(`weapon-selected`) + ` - ${weapon_name}`,
            include_with_roll: `{{weapon-bonus=${weapon_bonus}}} {{weapon-damage=${weapon_damage}}} {{weapon-range=${weapon_range}}} {{weapon-features=${weapon_features}}}`
        });
    });
});

/* set armor dice pool */
on("clicked:armor-roll", () => {
    console.log(">>> Change Detected: Armor - button clicked <<<");
    getAttrs(["ar"], (values) => {
        const ar = parseInt(values.ar,10)||0;
        setAttrs({
            base: 0,
            skill: 0,
            gear: ar,
            current_preset: getTranslationByKey(`armor-roll`),
            include_with_roll: ""
        });
    });
});

/* set armor calcs */
on("change:armor1_equiped change:armor1_damage change:armor1_bonus change:armor2_equiped change:armor2_damage change:armor2_bonus", function() {
    console.log(">>> Change Detected: Armor/Helmet <<<");
    getAttrs(["armor1_equiped", "armor1_damage", "armor1_bonus", "armor2_equiped", "armor2_damage", "armor2_bonus"], function(values) {

        const   armor1_equiped = parseInt(values["armor1_equiped"],10)||0,
                armor1_damage = parseInt(values["armor1_damage"],10)||0,
                armor1_bonus = parseInt(values["armor1_bonus"],10)||0,
                armor2_equiped = parseInt(values["armor2_equiped"],10)||0,
                armor2_damage = parseInt(values["armor2_damage"],10)||0,
                armor2_bonus = parseInt(values["armor2_bonus"],10)||0,
                armor1_ar = parseInt(values["armor1_ar"],10)||0,
                armor2_ar = parseInt(values["armor2_ar"],10)||0,
                ar = parseInt(values["ar"],10)||0,
                tempAR1 = Math.max((armor1_equiped*(armor1_bonus+armor1_damage))),
                tempAR2 = Math.max((armor2_equiped*(armor2_bonus+armor2_damage))),
                tempAR = Math.max((tempAR1 + tempAR2));
        setAttrs({
            "armor1_ar": tempAR1,
            "armor2_ar": tempAR2,
            "ar": tempAR
        });
    });
});

/* Cassie's JAVASCRIPT */
    ['rot','base','skill','gear', "mutation"].forEach(attr => {
        on(`change:${attr}`, (eventinfo) => {
            const value    = parseInt(eventinfo.newValue) || 0;
            const type     = (attr === "rot" || attr === "mutation") ? "other" : (attr === "skill" && value < 0) ? "negative" : attr;
            const template = update_roll(type, Math.abs(value));
            const name     = (attr === "negative") ? "skill" : attr;
            let update = {
                [`${name}_roll`]: template
            };

            (eventinfo.sourceType === "player") ?  update["current_preset"] = getTranslationByKey(`custom`) : false;

            setAttributes(update, false);
        });
    });

     /* Build Roll Template */
    const update_roll = (type, number) => {
        //Type will equal base, gear, negative, or skill
        const int = parseInt(number) || 0; 
        //Set critical success or fail based on type
        const suffix = (type === "base" || type === "gear") ? "cs6cf1" : (type === "skill") ? "cs6cf0" : (type === "other") ? "cs0cf1" : "";
        let pool   = [];

        for (x = 1; x <= int; x++) {
            pool.push(`{{${type}`.concat(x, `=[[1d6${suffix}]]}}`)); 
        };
        return (pool.join())
    };

    on("change:repeating_skills:skill change:repeating_skills:attribute", (eventinfo) => {
        const source     = `repeating_skills_${eventinfo.sourceAttribute.split("_")[2]}`;
        const firstAttr  = eventinfo.newValue;
        const secondAttr = eventinfo.triggerName.includes("attribute") ? `${source}_skill` : `${source}_attribute`;
        console.log(eventinfo);
        if (eventinfo.triggerName.includes("attribute")) {
            getAttrs([firstAttr, `${source}_skill`], (v) => {
                 const stat_score = parseInt(v[firstAttr]) || 0,
                       skill_score = parseInt(v[`${source}_skill`]) || 0;
                 dicePoolTotals(source, skill_score, stat_score);
            });
        } else {
            getAttrs([`${source}_attribute`], (v) => {
                const attribute = v[`${source}_attribute`];
                getAttrs([attribute], (v) => {
                     const stat_score = parseInt(v[attribute]) || 0,
                           skill_score = parseInt(eventinfo.newValue) || 0;
                    dicePoolTotals(source, skill_score, stat_score);
                });
            });
        };
    });

    const dicePoolTotals = (source, skill, stat) => {
        setAttrs({
            [`${source}_total`]: stat + skill
        });
    };


    //SKILLS & SKILL NAME NEEDS UPDATE ON CLICK
    ['endure','force','fight','sneak','move','shoot','scout','comprehend','know_the_zone','sense_emotion','manipulate','heal'].forEach(skill => {
        on(`clicked:dice_pool_${skill}`, (eventinfo) => { 
            dicePoolButtons(skill);
        });
    });

    const dicePoolButtons = (attribute) => {
        console.log(`%c >>> Change Detected: Dice Pool ${attribute} - button clicked <<<`, "color:maroon;");
        getAttrs([attributes[attribute], `${attribute}`], (v) => {
            const stat = parseInt(v[attributes[attribute]], 10) || 0;
            translationKey = getTranslationByKey(attribute);
            const update = {
                attribute: (stat > 0) ? stat : 0,
                skill: parseInt(v[`${attribute}`], 10) || 0,
                current_preset: translationKey,
                include_with_roll: ""
            };
            setAttributes(update, false);
        });
    };

    //Repeating Custom Skills Button handler
    on("clicked:repeating_skills:dice-pool-skill", (eventinfo) => {
        const source = eventinfo.sourceAttribute.split("_dice-pool-skill")[0];
        getAttrs([`${source}_attribute`], (v) => {
            const attribute      = v[`${source}_attribute`];
            getAttrs([attribute, `${source}_name`, `${source}_skill`], (v) => {
                const stat = parseInt(v[`${attribute}`], 10) || 0;
                setAttrs({
                    attribute: (stat > 0) ? stat : 0,
                    skill: parseInt(v[`${source}_skill`], 10) || 0,
                    current_preset: v[`${source}_name`],
                    include_with_roll: ""
                });
            });
        });
    });

    //Switch between sheet types.
    [`character`, `ark`].forEach(attr => {
        on(`clicked:tab_${attr}`, () => {
            setAttrs({tab: attr});
        });
    });
    
   //toggle off and on show setting
   ["repeating_injuries:settings", "repeating_talents:settings", "repeating_talents:collapse", "repeating_mutantions:settings", "repeating_mutantions:collapse", "repeating_skills:settings", "repeating_gear:settings", "repeating_gear:collapse","repeating_vehicle:collapse", "repeating_vehicle:settings"].forEach((attr) => {
        on(`clicked:${attr}`, (eventinfo) => {
            const word    = eventinfo.sourceAttribute.split("_")[3];
            const reveal  = eventinfo.sourceAttribute.replace(word, "reveal");
            const keyword = attr.split(":")[1];
            settingsToggles(reveal, keyword);
        }); 
   });

   //Hide & show settings for appearance
      [`face`,`body`,`clothing`].forEach((attr) => {
        on(`clicked:settings_${attr}`, (eventinfo) => {;
            const reveal = "appearence_reveal";
            settingsToggles(reveal, attr);
        }); 
   });

    const settingsToggles = (reveal, keyword) => {
        let update = {};
        getAttrs([reveal], (v) => {
            let string = v[`${reveal}`];
            update[reveal] = (string.includes(`${keyword}`)) ? string.replace(`${keyword},`, "") : string += `${keyword},`;
            console.log(`%c Was ${v[`${reveal}`]}; Update  ${JSON.stringify(update)}`,"color:blue;font-size:15px;");
            setAttributes(update, true);
        });
    };

    //Notes toggles
    ['class_dc', 'strength', 'dexterity', 'constitution', 'intelligence', 'wisdom', 'charisma', 'perception', `ancestry`].forEach(attr => {
        on(`clicked:toggle_${attr}`, (eventinfo) => {
            const trigger = eventinfo.triggerName.split("clicked:toggle_")[1];
            getAttrs(["toggles"], (v) => {
                let string = v[`toggles`];
                let update = {};
                (string.includes(`${attr}`)) ? string = string.replace(`${attr},`, "") : string += `${attr},`;
                update["toggles"] = string;
                setAttributes(update, false);
            });
        });
    });

    //Create a string for repeating injuries display
   on("change:repeating_injuries", () => {
        getAttrs(["repeating_injuries_injury_lethal", "repeating_injuries_injury_time_limit","repeating_injuries_injury_effects","repeating_injuries_injury_heal_time"], (v) => {
            let display = "";
            let update = {};
            (v.repeating_injuries_injury_lethal) ? display += `${v.repeating_injuries_injury_lethal},` : "";
            (v.repeating_injuries_injury_time_limit) ? display += ` ${v.repeating_injuries_injury_time_limit},` : "";
            (v.repeating_injuries_injury_effects) ? display += ` ${v.repeating_injuries_injury_effects},` : "";
            (v.repeating_injuries_injury_heal_time) ? display += ` ${v.repeating_injuries_injury_heal_time} days`: "";
            update["repeating_injuries_injury_display"] = `[${display}]`;
            setAttributes(update, false);
        });
   });

   const setAttributes = (update, silent) => {
        (silent === true) ? setAttrs(update, {silent:true}) : setAttrs(update);
   };



</script>