<!-- === SCRIPT === -->
<script type="text/worker">
/* ---- mordiou ---------------------- */
    var mordiou = mordiou || (function(){
        'use strict';
        var version = '1.0',
        basejet = '(floor((1d6-1)/2.5))',
        jetplus = ' + ' + basejet,
        calcJet = function (pVal) {
            var nb = parseInt(pVal) || 0;
            if (nb > 8) {nb = 8};
            var jetarr = [];
            var jet = '0d0';
            if (nb > 0) {jet = basejet + jetplus.repeat(nb-1)};
            jetarr.push(jet); // jet normal
            jetarr.push(jet + jetplus.repeat(2)); // jet aspect
            jet = '0d0';
            if (nb > 2) jet = basejet + jetplus.repeat(nb-3);
            jetarr.push(jet); // jet difficile
            return jetarr;
        },
        recalcAll = function() {
            getAttrs(["fortune","defense","aide","reserves","maniere","attention","eloquence","erudition","panache","resolution","ruse","vigueur"], function(values) {
                var mods = (parseInt(values.fortune) || 0) + (parseInt(values.aide) || 0)  + (parseInt(values.reserves) || 0) - (parseInt(values.defense) || 0) - ((parseInt(values.maniere) || 0)*2);
                // Attention
                var attentiond = mods + (parseInt(values.attention) || 0);
                var attention_arr = mordiou.calcJet(attentiond);
                // Eloquence
                var eloquenced = mods + (parseInt(values.eloquence) || 0);
                var eloquence_arr = mordiou.calcJet(eloquenced);
                // Erudition
                var eruditiond = mods + (parseInt(values.erudition) || 0);
                var erudition_arr = mordiou.calcJet(eruditiond);
                // Panache
                var panached = mods + (parseInt(values.panache) || 0);
                var panache_arr = mordiou.calcJet(panached);
                // Resolution
                var resolutiond = mods + (parseInt(values.resolution) || 0);
                var resolution_arr = mordiou.calcJet(resolutiond);
                // Ruse
                var rused = mods + (parseInt(values.ruse) || 0);
                var ruse_arr = mordiou.calcJet(rused);
                // Vigueur
                var vigueurd = mods + (parseInt(values.vigueur) || 0);
                var vigueur_arr = mordiou.calcJet(vigueurd);
                setAttrs({
                    attention_jet: attention_arr[0],
                    attention_jetplus: attention_arr[1],
                    attention_jetmoins: attention_arr[2],
                    attentionD: Math.max(attentiond,0),
                    attentionDP: Math.min(Math.max(attentiond+2,0),8),
                    attentionDM: Math.max(attentiond-2,0),
                    eloquence_jet: eloquence_arr[0],
                    eloquence_jetplus: eloquence_arr[1],
                    eloquence_jetmoins: eloquence_arr[2],
                    eloquenceD : Math.max(eloquenced,0),
                    eloquenceDP: Math.min(Math.max(eloquenced+2,0),8),
                    eloquenceDM: Math.max(eloquenced-2,0),
                    erudition_jet: erudition_arr[0],
                    erudition_jetplus: erudition_arr[1],
                    erudition_jetmoins: erudition_arr[2],
                    eruditionD : Math.max(eruditiond,0),
                    eruditionDP: Math.min(Math.max(eruditiond+2,0),8),
                    eruditionDM: Math.max(eruditiond-2,0),
                    panache_jet: panache_arr[0],
                    panache_jetplus: panache_arr[1],
                    panache_jetmoins: panache_arr[2],
                    panacheD : Math.max(panached,0),
                    panacheDP: Math.min(Math.max(panached+2,0),8),
                    panacheDM: Math.max(panached-2,0),
                    resolution_jet: resolution_arr[0],
                    resolution_jetplus: resolution_arr[1],
                    resolution_jetmoins: resolution_arr[2],
                    resolutionD : Math.max(resolutiond,0),
                    resolutionDP: Math.min(Math.max(resolutiond+2,0),8),
                    resolutionDM: Math.max(resolutiond-2,0),
                    ruse_jet: ruse_arr[0],
                    ruse_jetplus: ruse_arr[1],
                    ruse_jetmoins: ruse_arr[2],
                    ruseD : Math.max(rused,0),
                    ruseDP: Math.min(Math.max(rused+2,0),8),
                    ruseDM: Math.max(rused-2,0),
                    vigueur_jet: vigueur_arr[0],
                    vigueur_jetplus: vigueur_arr[1],
                    vigueur_jetmoins: vigueur_arr[2],
                    vigueurD : Math.max(vigueurd,0),
                    vigueurDP: Math.min(Math.max(vigueurd+2,0),8),
                    vigueurDM: Math.max(vigueurd-2,0)
                });
            });
        };
        return {
            calcJet: calcJet,
            recalcAll: recalcAll
        };
    }());
/* ---- FIN mordiou ---------------------- */
    on("change:reservesmax", function(){
        getAttrs(["reserves","reservesmax","reserves_buffer"],function(values) {
            var max = (parseInt(values.reservesmax) || 0);
            var diff = (parseInt(values.reserves) || 0) + (parseInt(values.reserves_buffer) || 0) - max;
            setAttrs({
                reserves_buffer: max,
                reserves: diff
            });
        });
    });
    on("change:reservesraz", function(eventinfo){
        if (eventinfo.newValue == 1 ) {
            setAttrs({
                reserves: 0,
                reservesraz: 0
            });
        }
    });
    on("change:aide", function(){
        getAttrs(["aide","aidemax"], function(values) {
            var aid = parseInt(values.aide) || 0;
            if (aid != 0 ) {
                setAttrs({
                    aidemax: (parseInt(values.aidemax) || 0) - aid
                });
            }
            mordiou.recalcAll();
        });
    });
    on("change:aideraz", function(eventinfo){
        if (eventinfo.newValue == 1 ) {
            setAttrs({
                aide: 0,
                aideraz: 0
            });
        }
    });
    on("change:fortune change:defense change:reserves change:maniere", function(){
        mordiou.recalcAll();
    });
    on("change:attention", function(){
        getAttrs(["attention","fortune","defense","aide","reserves","maniere"], function(values) {
            var attentiond = (parseInt(values.attention) || 0) + (parseInt(values.fortune) || 0) + (parseInt(values.aide) || 0) + (parseInt(values.reserves) || 0) - (parseInt(values.defense) || 0) - ((parseInt(values.maniere) || 0)*2);
            var jetarr = mordiou.calcJet(attentiond);
            setAttrs({
                attention_jet: jetarr[0],
                attention_jetplus: jetarr[1],
                attention_jetmoins: jetarr[2],
                attentionD: Math.max(attentiond,0),
                attentionDP: Math.min(Math.max(attentiond+2,0),8),
                attentionDM: Math.max(attentiond-2,0)
            });
        });
    });
    on("change:eloquence", function(){
        getAttrs(["eloquence","fortune","defense","aide","reserves","maniere"], function(values) {
            var eloquenced = (parseInt(values.eloquence) || 0) + (parseInt(values.fortune) || 0) + (parseInt(values.aide) || 0) + (parseInt(values.reserves) || 0) - (parseInt(values.defense) || 0) - ((parseInt(values.maniere) || 0)*2);
            var jetarr = mordiou.calcJet(eloquenced);
            setAttrs({
                eloquence_jet: jetarr[0],
                eloquence_jetplus: jetarr[1],
                eloquence_jetmoins: jetarr[2],
                eloquenceD: Math.max(eloquenced,0),
                eloquenceDP: Math.min(Math.max(eloquenced+2,0),8),
                eloquenceDM: Math.max(eloquenced-2,0)
            });
        });
    });
    on("change:erudition", function(){
        getAttrs(["erudition","fortune","defense","aide","reserves","maniere"], function(values) {
            var eruditiond = (parseInt(values.erudition) || 0) + (parseInt(values.fortune) || 0) + (parseInt(values.aide) || 0) + (parseInt(values.reserves) || 0) - (parseInt(values.defense) || 0) - ((parseInt(values.maniere) || 0)*2);
            var jetarr = mordiou.calcJet(eruditiond);
            setAttrs({
                erudition_jet: jetarr[0],
                erudition_jetplus: jetarr[1],
                erudition_jetmoins: jetarr[2],
                eruditionD: Math.max(eruditiond,0),
                eruditionDP: Math.min(Math.max(eruditiond+2,0),8),
                eruditionDM: Math.max(eruditiond-2,0)
            });
        });
    });
    on("change:panache", function(){
        getAttrs(["panache","fortune","defense","aide","reserves","maniere"], function(values) {
            var panached = (parseInt(values.panache) || 0) + (parseInt(values.fortune) || 0) + (parseInt(values.aide) || 0) + (parseInt(values.reserves) || 0) - (parseInt(values.defense) || 0) - ((parseInt(values.maniere) || 0)*2);
            var jetarr = mordiou.calcJet(panached);
            setAttrs({
                panache_jet: jetarr[0],
                panache_jetplus: jetarr[1],
                panache_jetmoins: jetarr[2],
                panacheD: Math.max(panached,0),
                panacheDP: Math.min(Math.max(panached+2,0),8),
                panacheDM: Math.max(panached-2,0)
            });
        });
    });
    on("change:resolution", function(){
        getAttrs(["resolution","fortune","defense","aide","reserves","maniere"], function(values) {
            var resolutiond = (parseInt(values.resolution) || 0) + (parseInt(values.fortune) || 0) + (parseInt(values.aide) || 0) + (parseInt(values.reserves) || 0) - (parseInt(values.defense) || 0) - ((parseInt(values.maniere) || 0)*2);
            var jetarr = mordiou.calcJet(resolutiond);
            setAttrs({
                resolution_jet: jetarr[0],
                resolution_jetplus: jetarr[1],
                resolution_jetmoins: jetarr[2],
                resolutionD: Math.max(resolutiond,0),
                resolutionDP: Math.min(Math.max(resolutiond+2,0),8),
                resolutionDM: Math.max(resolutiond-2,0)
            });
        });
    });
    on("change:ruse", function(){
        getAttrs(["ruse","fortune","defense","aide","reserves","maniere"], function(values) {
            var rused = (parseInt(values.ruse) || 0) + (parseInt(values.fortune) || 0) + (parseInt(values.aide) || 0) + (parseInt(values.reserves) || 0) - (parseInt(values.defense) || 0) - ((parseInt(values.maniere) || 0)*2);
            var jetarr = mordiou.calcJet(rused);
            setAttrs({
                ruse_jet: jetarr[0],
                ruse_jetplus: jetarr[1],
                ruse_jetmoins: jetarr[2],
                ruseD: Math.max(rused,0),
                ruseDP: Math.min(Math.max(rused+2,0),8),
                ruseDM: Math.max(rused-2,0)
            });
        });
    });
    on("change:vigueur", function(){
        getAttrs(["vigueur","fortune","defense","aide","reserves","maniere"], function(values) {
            var vigueurd = (parseInt(values.vigueur) || 0) + (parseInt(values.fortune) || 0) + (parseInt(values.aide) || 0) + (parseInt(values.reserves) || 0) - (parseInt(values.defense) || 0) - ((parseInt(values.maniere) || 0)*2);
            var jetarr = mordiou.calcJet(vigueurd);
            setAttrs({
                vigueur_jet: jetarr[0],
                vigueur_jetplus: jetarr[1],
                vigueur_jetmoins: jetarr[2],
                vigueurD: Math.max(vigueurd,0),
                vigueurDP: Math.min(Math.max(vigueurd+2,0),8),
                vigueurDM: Math.max(vigueurd-2,0)
            });
        });
    });
    on("change:effort", function(){
        getAttrs(["effort","fortune"], function(values) {
            var eff = parseInt(values.effort) || 0;
            var fort = parseInt(values.fortune) || 0;
            if (eff == 5) {
                setAttrs({
                    effort: 0,
                    fortune: fort-1
                });
            }
        });
    });
    on("change:conflituse1 change:conflituse2 change:conflituse3 change:conflituse4", function(){
        getAttrs(["conflituse1","conflituse2","conflituse3","conflituse4"], function(values) {
            var conf = (parseInt(values.conflituse1) || 0) + (parseInt(values.conflituse2) || 0) + (parseInt(values.conflituse3) || 0) + (parseInt(values.conflituse4) || 0);
            if (conf == 4) {
                setAttrs({
                    conflituse1: 0,
                    conflituse2: 0,
                    conflituse3: 0,
                    conflituse4: 0
                });
            }
        });
    });
</script>
<!-- === attributs & jets cachées === -->
<div style="display: none;">
    <!-- version -->
    <input type="number" name="attr_sheetversion" value="1.0" />
    <!-- attention -->
    <input readonly name="attr_attention_jet" value="(floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5))" />
    <input readonly name="attr_attention_jetplus" value="(floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5))" />
    <input readonly name="attr_attention_jetmoins" value="(floor((1d6-1)/2.5))" />
    <!-- eloquence -->
    <input readonly name="attr_eloquence_jet" value="(floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5))" />
    <input readonly name="attr_eloquence_jetplus" value="(floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5))" />
    <input readonly name="attr_eloquence_jetmoins" value="(floor((1d6-1)/2.5))" />
    <!-- erudition -->
    <input readonly name="attr_erudition_jet" value="(floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5))" />
    <input readonly name="attr_erudition_jetplus" value="(floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5))" />
    <input readonly name="attr_erudition_jetmoins" value="(floor((1d6-1)/2.5))" />
    <!-- panache -->
    <input readonly name="attr_panache_jet" value="(floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5))" />
    <input readonly name="attr_panache_jetplus" value="(floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5))" />
    <input readonly name="attr_panache_jetmoins" value="(floor((1d6-1)/2.5))" />
    <!-- resolution -->
    <input readonly name="attr_resolution_jet" value="(floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5))" />
    <input readonly name="attr_resolution_jetplus" value="(floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5))" />
    <input readonly name="attr_resolution_jetmoins" value="(floor((1d6-1)/2.5))" />
    <!-- ruse -->
    <input readonly name="attr_ruse_jet" value="(floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5))" />
    <input readonly name="attr_ruse_jetplus" value="(floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5))" />
    <input readonly name="attr_ruse_jetmoins" value="(floor((1d6-1)/2.5))" />
    <!-- vigueur -->
    <input readonly name="attr_vigueur_jet" value="(floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5))" />
    <input readonly name="attr_vigueur_jetplus" value="(floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5)) + (floor((1d6-1)/2.5))" />
    <input readonly name="attr_vigueur_jetmoins" value="(floor((1d6-1)/2.5))" />
</div> <!-- === FIN jets cachées === -->
<!-- === SHEET === -->
<div class="bgmain">
    <div class="abs" style="left: 465px;top:10px;">
        <input type="text" name="attr_character_name" class="inptxt1" style="width: 280px;" placeholder="Nom du personnage" />
    </div>
    <div class="abs" style="left: 755px;top:14px;">
        <input type="text" name="attr_pseudos" class="" style="width: 250px;" placeholder="Pseudonymes et surnoms" />
    </div>
    <!-- NOM -->
    <div class="abs" style="left: 425px;top: 150px;">
        <textarea name="attr_description" style="width: 590px;height: 100px;" placeholder="Description"></textarea>
    </div> <!-- DESCRIPTION -->
    <!-- ASPECTS -->
    <div class="abs" style="left: 425px;top:41px;">
        <input type="text" name="attr_aspect1" class="aspect" placeholder="Aspect" />
    </div>
    <div class="abs" style="left: 425px;top:65px;">
        <input type="text" name="attr_aspect2" class="aspect" placeholder="Aspect" />
    </div>
    <div class="abs" style="left: 425px;top:89px;">
        <input type="text" name="attr_aspect3" class="aspect" placeholder="Aspect" />
    </div>
    <div class="abs" style="left: 425px;top:114px;">
        <input type="text" name="attr_aspect4" class="aspect" placeholder="Aspect" />
    </div>
    <!-- FIN ASPECTS -->
    <!-- Aspect de conflits -->
    <div class="abs" style="left: 878px;top:42px;">
        <input type="text" name="attr_conflit1" style="width: 118px;" placeholder="Aspect de conflit" />
    </div>
    <div class="abs" style="left: 996px;top:47px;">
        <input type="checkbox" name="attr_conflituse1" value="1" class="smallchk" title="Aspect de conflit utilisé" /><span>&#9884;</span>
    </div>
    <div class="abs" style="left: 878px;top:67px;">
        <input type="text" name="attr_conflit2" style="width: 118px;" placeholder="Aspect de conflit" />
    </div>
    <div class="abs" style="left: 996px;top:72px;">
        <input type="checkbox" name="attr_conflituse2" value="1" class="smallchk" title="Aspect de conflit utilisé" /><span>&#9884;</span>
    </div>
    <div class="abs" style="left: 878px;top:91px;">
        <input type="text" name="attr_conflit3" style="width: 118px;" placeholder="Aspect de conflit" />
    </div>
    <div class="abs" style="left: 996px;top:96px;">
        <input type="checkbox" name="attr_conflituse3" value="1" class="smallchk" title="Aspect de conflit utilisé" /><span>&#9884;</span>
    </div>
    <div class="abs" style="left: 878px;top:115px;">
        <input type="text" name="attr_conflit4" style="width: 118px;" placeholder="Aspect de conflit" />
    </div>
    <div class="abs" style="left: 996px;top:120px;">
        <input type="checkbox" name="attr_conflituse4" value="1" class="smallchk" title="Aspect de conflit utilisé" /><span>&#9884;</span>
    </div>
    <!-- FIN Aspect de conflits -->
    <!-- Fortune -->
    <div class="abs" style="left: 120px;top:100px;width: 115px;text-align: center;">
        <input type="number" name="attr_fortune" value="3" min="0" class="numbig2" title="Points de Fortune courants" />
        <div class="asbignb">|</div>
        <input type="number" name="attr_fortune_max" value="3" min="0" class="numbig2 nummax" title="Points de Fortune maximums" />
    </div>
    <div class="abs" style="left: 120px;top:150px;width: 115px;text-align: center;">
        <button type="roll" class="sheet-butd6small" name="Jet_Initiative" title="Jet d'initiative" value="&{template:tmpl} {{personnage=@{character_name}}} {{initiative=[[@{fortune}d6]]}}" ><span class="libf">Initiative</span></button>
    </div>
    <!-- FIN Fortune -->
    <!-- Défense -->
    <div class="abs" style="left: 248px;top:100px;width: 115px;text-align: center;">
        <input type="number" name="attr_defense" value="0" min="0" class="numbig2" title="Dés placés en Défense" />
    </div>
    <!-- FIN Défense -->
    <!-- Aide -->
    <div class="abs" style="left: 65px;top:215px;width: 115px;text-align: center;">
        <input type="number" name="attr_aide" value="0" min="0" class="numbig2" title="Dé(s) d'Aide utilisé(s) / ajouté(s) au prochain jet. A remettre à zéro manuellement après le jet." />
        <div class="asbignb">|</div>
        <input type="number" name="attr_aidemax" value="0" min="0" class="numbig2 nummax" title="Dé(s) d'Aide." />
    </div>
    <div class="abs" style="left: 80px;top:265px;z-index:1;">
        <input type="checkbox" name="attr_aideraz" value="1" class="gomme" title="Remettre à zéro l'Aide à utiliser pour le jet. A faire après le jet." /><span>*</span>
    </div>
    <!-- FIN Aide -->
    <!-- Manière -->
    <div class="abs" style="left: 300px;top:175px;">
        <div style="display: table-cell;padding-left:13px;vertical-align: middle; height: 77px;width: 77px;text-align: center;border: 1px solid #949597; border-radius:50%;">
            <input type="number" name="attr_maniere" value="0" min="0" class="numbig1" title="Manières (1 Manière = -2D au prochain jet)" />
            <span class="libf" style="margin-left: -5px;">Manières</span>
        </div>
    </div>
    <!-- FIN Manière -->
    <!-- Réserves -->
    <div class="abs" style="left: 175px;top:215px;width: 115px;text-align: center;">
        <input type="number" name="attr_reserves" value="0" class="numbig2 sheet-numtxt" title="Dé(s) de Réserve utilisé(s) / ajouté(s) au prochain jet. A remettre à zéro après le jet." readonly />
        <div class="asbignb">|</div>
        <input type="number" name="attr_reservesmax" value="0" min="0" class="numbig2 nummax" title="Dé(s) mis en Réserve. Augmenter la réserve va diminuer la poignée. Diminuer la réserve va augmenter la poignée." />
        <div style="display:none"><input type="number" name="attr_reserves_buffer" value="0" /></div>
    </div>
    <div class="abs" style="left: 190px;top:265px;z-index:1;">
        <input type="checkbox" name="attr_reservesraz" value="1" class="gomme" title="Remettre à zéro la Réserve de Dé à utiliser pour le jet. A faire après le jet." /><span>*</span>
    </div>
    <!-- FIN Réserves -->
    <!-- EFFORT -->
    <div class="abs" style="left: 310px;top:265px;width:350px;text-align: left;white-space: nowrap;">
        <input type="radio" name="attr_effort" value="0" class="bigchk" checked title="Remettre les Efforts à zéro" /><span></span>
        <input type="radio" name="attr_effort" value="1" class="bigchk" style="margin-left: 1px;" title="1er Effort" /><span>&#9884;</span>
        <input type="radio" name="attr_effort" value="2" style="margin-left: 5px;" class="bigchk" title="2nd Effort" /><span>&#9884;</span>
        <input type="radio" name="attr_effort" value="3" style="margin-left: 5px;" class="bigchk" title="3ième Effort" /><span>&#9884;</span>
        <input type="radio" name="attr_effort" value="4" style="margin-left: 5px;" class="bigchk" title="4ième Effort" /><span>&#9884;</span>
        <input type="radio" name="attr_effort" value="5" style="margin-left: 5px;" class="bigchk" title="5ième Effort" /><span>&#9884;</span>
    </div>
    <!-- FIN EFFORT -->
    <!-- Attention -->
    <div class="abs" style="left: 75px;top:367px;">
        <input type="number" name="attr_attention" value="0" min="0" class="numbig1 numtxt" />
    </div>
    <div class="abs" style="left: 30px;top:376px;">
        <button type="roll" class="sheet-butd6small block" name="Jet_Attention" title="Jet d'Attention" value="&{template:tmpl} {{personnage=@{character_name}}} {{style=Attention (@{attention})}} {{fortune=@{fortune}}} {{aide=[[@{aide}]]}} {{reserves=[[@{reserves}]]}} {{defense=[[@{defense}]]}} {{maniere=[[@{maniere}*2]]}} {{poignee=[[{({(0d0+@{attention}[Style]+@{fortune}[Fortune]+@{reserves}[Réserve]+@{aide}[Aide]-(@{maniere}*2)[Manières]-@{defense}[Défense]),0d0+0}kh1),0d0+8}kl1]]}} {{qualites=[[@{attention_jet}]]}}" ><input type="number" name="attr_attentionD" value="3" class="numtxt poigne libf" title="Poignée" readonly /></button>
    </div>
    <div class="abs" style="left: 120px;top:367px;">
        <button type="roll" class="sheet-butd6smallgreen block" name="Jet_AttentionAspect" title="Jet d'Attention + 2D (Aspect applicable)" value="&{template:tmpl} {{personnage=@{character_name}}} {{style=Attention (@{attention})}} {{fortune=@{fortune}}} {{aide=[[@{aide}]]}} {{reserves=[[@{reserves}]]}} {{defense=[[@{defense}]]}} {{maniere=[[@{maniere}*2]]}} {{aspect=1}} {{poignee=[[{({(0d0+@{attention}[Style]+@{fortune}[Fortune]+@{reserves}[Réserve]+@{aide}[Aide]-(@{maniere}*2)[Manières]-@{defense}[Défense]+2[Aspect]),0d0+0}kh1),0d0+8}kl1]]}} {{qualites=[[@{attention_jetplus}]]}}" ><input type="number" name="attr_attentionDP" value="5" class="numtxt poigne libf" title="Poignée avec Aspect" readonly /></button>
        <button type="roll" class="sheet-butd6smallred block" name="Jet_AttentionDef" title="Jet d'Attention - 2D (circonstances défavorables)" value="&{template:tmpl} {{personnage=@{character_name}}} {{style=Attention (@{attention})}} {{fortune=@{fortune}}} {{aide=[[@{aide}]]}} {{reserves=[[@{reserves}]]}} {{defense=[[@{defense}]]}} {{maniere=[[@{maniere}*2]]}} {{circonstance=1}} {{poignee=[[{({(0d0+@{attention}[Style]+@{fortune}[Fortune]+@{reserves}[Réserve]+@{aide}[Aide]-(@{maniere}*2)[Manières]-@{defense}[Défense]-2[Circonstances]),0d0+0}kh1),0d0+8}kl1]]}} {{qualites=[[@{attention_jetmoins}]]}}" ><input type="number" name="attr_attentionDM" value="1" class="numtxt poigne libf" title="Poignée avec Circonstances défavorables" readonly /></button>
    </div>
    <!-- FIN Attention -->
    <!-- Eloquence -->
    <div class="abs" style="left: 228px;top:367px;">
        <input type="number" name="attr_eloquence" value="0" min="0" class="numbig1 numtxt" />
    </div>
    <div class="abs" style="left: 183px;top:376px;">
        <button type="roll" class="sheet-butd6small block" name="Jet_Eloquence" title="Jet d'Eloquence" value="&{template:tmpl} {{personnage=@{character_name}}} {{style=Eloquence (@{eloquence})}} {{fortune=@{fortune}}} {{aide=[[@{aide}]]}} {{reserves=[[@{reserves}]]}} {{defense=[[@{defense}]]}} {{maniere=[[@{maniere}*2]]}} {{poignee=[[{({(0d0+@{eloquence}[Style]+@{fortune}[Fortune]+@{reserves}[Réserve]+@{aide}[Aide]-(@{maniere}*2)[Manières]-@{defense}[Défense]),0d0+0}kh1),0d0+8}kl1]]}} {{qualites=[[@{eloquence_jet}]]}}" ><input type="number" name="attr_eloquenceD" value="3" class="numtxt poigne libf" title="Poignée" readonly /></button>
    </div>
    <div class="abs" style="left: 273px;top:367px;">
        <button type="roll" class="sheet-butd6smallgreen block" name="Jet_EloquenceAspect" title="Jet d'Eloquence + 2D (Aspect applicable)" value="&{template:tmpl} {{personnage=@{character_name}}} {{style=Eloquence (@{eloquence})}} {{fortune=@{fortune}}} {{aide=[[@{aide}]]}} {{reserves=[[@{reserves}]]}} {{defense=[[@{defense}]]}} {{maniere=[[@{maniere}*2]]}} {{aspect=1}} {{poignee=[[{({(0d0+@{eloquence}[Style]+@{fortune}[Fortune]+@{reserves}[Réserve]+@{aide}[Aide]-(@{maniere}*2)[Manières]-@{defense}[Défense]+2[Aspect]),0d0+0}kh1),0d0+8}kl1]]}} {{qualites=[[@{eloquence_jetplus}]]}}" ><input type="number" name="attr_eloquenceDP" value="5" class="numtxt poigne libf" title="Poignée" readonly /></button>
        <button type="roll" class="sheet-butd6smallred block" name="Jet_EloquenceDef" title="Jet d'Eloquence - 2D (circonstances défavorables)" value="&{template:tmpl} {{personnage=@{character_name}}} {{style=Eloquence (@{eloquence})}} {{fortune=@{fortune}}} {{aide=[[@{aide}]]}} {{reserves=[[@{reserves}]]}} {{defense=[[@{defense}]]}} {{maniere=[[@{maniere}*2]]}} {{circonstance=1}} {{poignee=[[{({(0d0+@{eloquence}[Style]+@{fortune}[Fortune]+@{reserves}[Réserve]+@{aide}[Aide]-(@{maniere}*2)[Manières]-@{defense}[Défense]-2[Circonstances]),0d0+0}kh1),0d0+8}kl1]]}} {{qualites=[[@{eloquence_jetmoins}]]}}" ><input type="number" name="attr_eloquenceDM" value="1" class="numtxt poigne libf" title="Poignée" readonly /></button>
    </div>
    <!-- FIN ELOQUENCE -->
    <!-- Erudition -->
    <div class="abs" style="left: 379px;top:367px;">
        <input type="number" name="attr_erudition" value="0" min="0" class="numbig1 numtxt" />
    </div>
    <div class="abs" style="left: 334px;top:376px;">
        <button type="roll" class="sheet-butd6small block" name="Jet_Erudition" title="Jet d'Erudition" value="&{template:tmpl} {{personnage=@{character_name}}} {{style=Erudition (@{erudition})}} {{fortune=@{fortune}}} {{aide=[[@{aide}]]}} {{reserves=[[@{reserves}]]}} {{defense=[[@{defense}]]}} {{maniere=[[@{maniere}*2]]}} {{poignee=[[{({(0d0+@{erudition}[Style]+@{fortune}[Fortune]+@{reserves}[Réserve]+@{aide}[Aide]-(@{maniere}*2)[Manières]-@{defense}[Défense]),0d0+0}kh1),0d0+8}kl1]]}} {{qualites=[[@{erudition_jet}]]}}" ><input type="number" name="attr_eruditionD" value="3" class="numtxt poigne libf" title="Poignée" readonly /></button>
    </div>
    <div class="abs" style="left: 424px;top:367px;">
        <button type="roll" class="sheet-butd6smallgreen block" name="Jet_EruditionAspect" title="Jet d'Erudition + 2D (Aspect applicable)" value="&{template:tmpl} {{personnage=@{character_name}}} {{style=Erudition (@{erudition})}} {{fortune=@{fortune}}} {{aide=[[@{aide}]]}} {{reserves=[[@{reserves}]]}} {{defense=[[@{defense}]]}} {{maniere=[[@{maniere}*2]]}} {{aspect=1}} {{poignee=[[{({(0d0+@{erudition}[Style]+@{fortune}[Fortune]+@{reserves}[Réserve]+@{aide}[Aide]-(@{maniere}*2)[Manières]-@{defense}[Défense]+2[Aspect]),0d0+0}kh1),0d0+8}kl1]]}} {{qualites=[[@{erudition_jetplus}]]}}" ><input type="number" name="attr_eruditionDP" value="5" class="numtxt poigne libf" title="Poignée" readonly /></button>
        <button type="roll" class="sheet-butd6smallred block" name="Jet_EruditionDef" title="Jet d'Erudition - 2D (circonstances défavorables)" value="&{template:tmpl} {{personnage=@{character_name}}} {{style=Erudition (@{erudition})}} {{fortune=@{fortune}}} {{aide=[[@{aide}]]}} {{reserves=[[@{reserves}]]}} {{defense=[[@{defense}]]}} {{maniere=[[@{maniere}*2]]}} {{circonstance=1}} {{poignee=[[{({(0d0+@{erudition}[Style]+@{fortune}[Fortune]+@{reserves}[Réserve]+@{aide}[Aide]-(@{maniere}*2)[Manières]-@{defense}[Défense]-2[Circonstances]),0d0+0}kh1),0d0+8}kl1]]}} {{qualites=[[@{erudition_jetmoins}]]}}" ><input type="number" name="attr_eruditionDM" value="1" class="numtxt poigne libf" title="Poignée" readonly /></button>
    </div>
    <!-- FIN ERUDITION -->
    <!-- Panache -->
    <div class="abs" style="left: 531px;top:367px;">
        <input type="number" name="attr_panache" value="0" min="0" class="numbig1 numtxt" />
    </div>
    <div class="abs" style="left: 486px;top:376px;">
        <button type="roll" class="sheet-butd6small block" name="Jet_Panache" title="Jet de Panache" value="&{template:tmpl} {{personnage=@{character_name}}} {{style=Panache (@{panache})}} {{fortune=@{fortune}}} {{aide=[[@{aide}]]}} {{reserves=[[@{reserves}]]}} {{defense=[[@{defense}]]}} {{maniere=[[@{maniere}*2]]}} {{poignee=[[{({(0d0+@{panache}[Style]+@{fortune}[Fortune]+@{reserves}[Réserve]+@{aide}[Aide]-(@{maniere}*2)[Manières]-@{defense}[Défense]),0d0+0}kh1),0d0+8}kl1]]}} {{qualites=[[@{panache_jet}]]}}" ><input type="number" name="attr_panacheD" value="3" class="numtxt poigne libf" title="Poignée" readonly /></button>
    </div>
    <div class="abs" style="left: 576px;top:367px;">
        <button type="roll" class="sheet-butd6smallgreen block" name="Jet_PanacheAspect" title="Jet de Panache + 2D (Aspect applicable)" value="&{template:tmpl} {{personnage=@{character_name}}} {{style=Panache (@{panache})}} {{fortune=@{fortune}}} {{aide=[[@{aide}]]}} {{reserves=[[@{reserves}]]}} {{defense=[[@{defense}]]}} {{maniere=[[@{maniere}*2]]}} {{aspect=1}} {{poignee=[[{({(0d0+@{panache}[Style]+@{fortune}[Fortune]+@{reserves}[Réserve]+@{aide}[Aide]-(@{maniere}*2)[Manières]-@{defense}[Défense]+2[Aspect]),0d0+0}kh1),0d0+8}kl1]]}} {{qualites=[[@{panache_jetplus}]]}}" ><input type="number" name="attr_panacheDP" value="5" class="numtxt poigne libf" title="Poignée" readonly /></button>
        <button type="roll" class="sheet-butd6smallred block" name="Jet_PanacheDef" title="Jet de Panache - 2D (circonstances défavorables)" value="&{template:tmpl} {{personnage=@{character_name}}} {{style=Panache (@{panache})}} {{fortune=@{fortune}}} {{aide=[[@{aide}]]}} {{reserves=[[@{reserves}]]}} {{defense=[[@{defense}]]}} {{maniere=[[@{maniere}*2]]}} {{circonstance=1}} {{poignee=[[{({(0d0+@{panache}[Style]+@{fortune}[Fortune]+@{reserves}[Réserve]+@{aide}[Aide]-(@{maniere}*2)[Manières]-@{defense}[Défense]-2[Circonstances]),0d0+0}kh1),0d0+8}kl1]]}} {{qualites=[[@{panache_jetmoins}]]}}" ><input type="number" name="attr_panacheDM" value="1" class="numtxt poigne libf" title="Poignée" readonly /></button>
    </div>
    <!-- FIN PANACHE -->
    <!-- Resolution -->
    <div class="abs" style="left: 683px;top:367px;">
        <input type="number" name="attr_resolution" value="0" min="0" class="numbig1 numtxt" />
    </div>
    <div class="abs" style="left: 638px;top:376px;">
        <button type="roll" class="sheet-butd6small block" name="Jet_Resolution" title="Jet de Résolution" value="&{template:tmpl} {{personnage=@{character_name}}} {{style=Résolution (@{resolution})}} {{fortune=@{fortune}}} {{aide=[[@{aide}]]}} {{reserves=[[@{reserves}]]}} {{defense=[[@{defense}]]}} {{maniere=[[@{maniere}*2]]}} {{poignee=[[{({(0d0+@{resolution}[Style]+@{fortune}[Fortune]+@{reserves}[Réserve]+@{aide}[Aide]-(@{maniere}*2)[Manières]-@{defense}[Défense]),0d0+0}kh1),0d0+8}kl1]]}} {{qualites=[[@{resolution_jet}]]}}" ><input type="number" name="attr_resolutionD" value="3" class="numtxt poigne libf" title="Poignée" readonly /></button>
    </div>
    <div class="abs" style="left: 728px;top:367px;">
        <button type="roll" class="sheet-butd6smallgreen block" name="Jet_ResolutionAspect" title="Jet de Résolution + 2D (Aspect applicable)" value="&{template:tmpl} {{personnage=@{character_name}}} {{style=Résolution (@{resolution})}} {{fortune=@{fortune}}} {{aide=[[@{aide}]]}} {{reserves=[[@{reserves}]]}} {{defense=[[@{defense}]]}} {{maniere=[[@{maniere}*2]]}} {{aspect=1}} {{poignee=[[{({(0d0+@{resolution}[Style]+@{fortune}[Fortune]+@{reserves}[Réserve]+@{aide}[Aide]-(@{maniere}*2)[Manières]-@{defense}[Défense]+2[Aspect]),0d0+0}kh1),0d0+8}kl1]]}} {{qualites=[[@{resolution_jetplus}]]}}" ><input type="number" name="attr_resolutionDP" value="5" class="numtxt poigne libf" title="Poignée" readonly /></button>
        <button type="roll" class="sheet-butd6smallred block" name="Jet_ResolutionDef" title="Jet de Résolution - 2D (circonstances défavorables)" value="&{template:tmpl} {{personnage=@{character_name}}} {{style=Résolution (@{resolution})}} {{fortune=@{fortune}}} {{aide=[[@{aide}]]}} {{reserves=[[@{reserves}]]}} {{defense=[[@{defense}]]}} {{maniere=[[@{maniere}*2]]}} {{circonstance=1}} {{poignee=[[{({(0d0+@{resolution}[Style]+@{fortune}[Fortune]+@{reserves}[Réserve]+@{aide}[Aide]-(@{maniere}*2)[Manières]-@{defense}[Défense]-2[Circonstances]),0d0+0}kh1),0d0+8}kl1]]}} {{qualites=[[@{resolution_jetmoins}]]}}" ><input type="number" name="attr_resolutionDM" value="1" class="numtxt poigne libf" title="Poignée" readonly /></button>
    </div>
    <!-- FIN RESOLUTION -->
    <!-- Ruse -->
    <div class="abs" style="left: 834px;top:367px;">
        <input type="number" name="attr_ruse" value="0" min="0" class="numbig1 numtxt" />
    </div>
    <div class="abs" style="left: 789px;top:376px;">
        <button type="roll" class="sheet-butd6small block" name="Jet_Ruse" title="Jet de Ruse" value="&{template:tmpl} {{personnage=@{character_name}}} {{style=Ruse (@{ruse})}} {{fortune=@{fortune}}} {{aide=[[@{aide}]]}} {{reserves=[[@{reserves}]]}} {{defense=[[@{defense}]]}} {{maniere=[[@{maniere}*2]]}} {{poignee=[[{({(0d0+@{ruse}[Style]+@{fortune}[Fortune]+@{reserves}[Réserve]+@{aide}[Aide]-(@{maniere}*2)[Manières]-@{defense}[Défense]),0d0+0}kh1),0d0+8}kl1]]}} {{qualites=[[@{ruse_jet}]]}}" ><input type="number" name="attr_ruseD" value="3" class="numtxt poigne libf" title="Poignée" readonly /></button>
    </div>
    <div class="abs" style="left: 879px;top:367px;">
        <button type="roll" class="sheet-butd6smallgreen block" name="Jet_RuseAspect" title="Jet de Ruse + 2D (Aspect applicable)" value="&{template:tmpl} {{personnage=@{character_name}}} {{style=Ruse (@{ruse})}} {{fortune=@{fortune}}} {{aide=[[@{aide}]]}} {{reserves=[[@{reserves}]]}} {{defense=[[@{defense}]]}} {{maniere=[[@{maniere}*2]]}} {{aspect=1}} {{poignee=[[{({(0d0+@{ruse}[Style]+@{fortune}[Fortune]+@{reserves}[Réserve]+@{aide}[Aide]-(@{maniere}*2)[Manières]-@{defense}[Défense]+2[Aspect]),0d0+0}kh1),0d0+8}kl1]]}} {{qualites=[[@{ruse_jetplus}]]}}" ><input type="number" name="attr_ruseDP" value="5" class="numtxt poigne libf" title="Poignée" readonly /></button>
        <button type="roll" class="sheet-butd6smallred block" name="Jet_RuseDef" title="Jet de Ruse - 2D (circonstances défavorables)" value="&{template:tmpl} {{personnage=@{character_name}}} {{style=Ruse (@{ruse})}} {{fortune=@{fortune}}} {{aide=[[@{aide}]]}} {{reserves=[[@{reserves}]]}} {{defense=[[@{defense}]]}} {{maniere=[[@{maniere}*2]]}} {{circonstance=1}} {{poignee=[[{({(0d0+@{ruse}[Style]+@{fortune}[Fortune]+@{reserves}[Réserve]+@{aide}[Aide]-(@{maniere}*2)[Manières]-@{defense}[Défense]-2[Circonstances]),0d0+0}kh1),0d0+8}kl1]]}} {{qualites=[[@{ruse_jetmoins}]]}}" ><input type="number" name="attr_ruseDM" value="1" class="numtxt poigne libf" title="Poignée" readonly /></button>
    </div>
    <!-- FIN RUSE -->
    <!-- Vigueur -->
    <div class="abs" style="left: 986px;top:367px;">
        <input type="number" name="attr_vigueur" value="0" min="0" class="numbig1 numtxt" />
    </div>
    <div class="abs" style="left: 941px;top:376px;">
        <button type="roll" class="sheet-butd6small block" name="Jet_Vigueur" title="Jet de Vigueur" value="&{template:tmpl} {{personnage=@{character_name}}} {{style=Vigueur (@{vigueur})}} {{fortune=@{fortune}}} {{aide=[[@{aide}]]}} {{reserves=[[@{reserves}]]}} {{defense=[[@{defense}]]}} {{maniere=[[@{maniere}*2]]}} {{poignee=[[{({(0d0+@{vigueur}[Style]+@{fortune}[Fortune]+@{reserves}[Réserve]+@{aide}[Aide]-(@{maniere}*2)[Manières]-@{defense}[Défense]),0d0+0}kh1),0d0+8}kl1]]}} {{qualites=[[@{vigueur_jet}]]}}" ><input type="number" name="attr_vigueurD" value="3" class="numtxt poigne libf" title="Poignée" readonly /></button>
    </div>
    <div class="abs" style="left: 1031px;top:367px;">
        <button type="roll" class="sheet-butd6smallgreen block" name="Jet_VigueurAspect" title="Jet de Vigueur + 2D (Aspect applicable)" value="&{template:tmpl} {{personnage=@{character_name}}} {{style=Vigueur (@{vigueur})}} {{fortune=@{fortune}}} {{aide=[[@{aide}]]}} {{reserves=[[@{reserves}]]}} {{defense=[[@{defense}]]}} {{maniere=[[@{maniere}*2]]}} {{aspect=1}} {{poignee=[[{({(0d0+@{vigueur}[Style]+@{fortune}[Fortune]+@{reserves}[Réserve]+@{aide}[Aide]-(@{maniere}*2)[Manières]-@{defense}[Défense]+2[Aspect]),0d0+0}kh1),0d0+8}kl1]]}} {{qualites=[[@{vigueur_jetplus}]]}}" ><input type="number" name="attr_vigueurDP" value="5" class="numtxt poigne libf" title="Poignée" readonly /></button>
        <button type="roll" class="sheet-butd6smallred block" name="Jet_VigueurDef" title="Jet de Vigueur - 2D (circonstances défavorables)" value="&{template:tmpl} {{personnage=@{character_name}}} {{style=Vigueur (@{vigueur})}} {{fortune=@{fortune}}} {{aide=[[@{aide}]]}} {{reserves=[[@{reserves}]]}} {{defense=[[@{defense}]]}} {{maniere=[[@{maniere}*2]]}} {{circonstance=1}} {{poignee=[[{({(0d0+@{vigueur}[Style]+@{fortune}[Fortune]+@{reserves}[Réserve]+@{aide}[Aide]-(@{maniere}*2)[Manières]-@{defense}[Défense]-2[Circonstances]),0d0+0}kh1),0d0+8}kl1]]}} {{qualites=[[@{vigueur_jetmoins}]]}}" ><input type="number" name="attr_vigueurDM" value="1" class="numtxt poigne libf" title="Poignée" readonly /></button>
    </div>
    <!-- FIN VIGUEUR -->
</div>
<!-- === TEMPLATE   === -->
<rolltemplate class="sheet-rolltemplate-tmpl">
    <div class="tplmain">
        <div class="perso">{{personnage}}</div>
        {{#initiative}}
            <div class="qualites"><span class="lib plus">Initiative : </span>{{initiative}}</div>
        {{/initiative}}
        {{#poignee}}
            <div class="poignee"><span class="fat">{{style}}</span> + Fortune ({{fortune}})
            {{#^rollTotal() aide 0}}+ Aide ({{aide}}){{/^rollTotal() aide 0}}
            {{#^rollTotal() reserves 0}}+ Réserves ({{reserves}}){{/^rollTotal() reserves 0}}
            {{#aspect}}+ Aspect (2){{/aspect}}
            {{#circonstance}}- Circonstances (2){{/circonstance}}
            {{#^rollTotal() maniere 0}}- Manières ({{maniere}}){{/^rollTotal() maniere 0}}
            {{#^rollTotal() defense 0}}- Défense ({{defense}}){{/^rollTotal() defense 0}}
            = <span class="fat">{{poignee}}D</span></div>
        {{/poignee}}
        {{#qualites}}
            <div class="qualites"><span class="lib plus">Qualités : </span>{{qualites}}</div>
        {{/qualites}}
    </div>
</rolltemplate>
