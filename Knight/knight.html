
<script type="text/worker">
  /* eslint-disable no-global-assign */
/* eslint-disable no-unused-vars */
/* eslint-disable no-prototype-builtins */
/* eslint-disable no-undef */
/* ---- BEGIN: TheAaronSheet.js ---- */
// Github:   https://github.com/shdwjk/TheAaronSheet/blob/master/TheAaronSheet.js
// By:       The Aaron, Arcane Scriptomancer
// Contact:  https://app.roll20.net/users/104025/the-aaron

var TAS = TAS || (function(){
'use strict';

var version = '0.2.4',
    lastUpdate = 1457098091,

    loggingSettings = {
        debug: {
            key:     'debug',
            title:   'DEBUG',
            color: {
                bgLabel: '#7732A2',
                label:   '#F2EF40',
                bgText:  '#FFFEB7',
                text:    '#7732A2'
            }
        },
        error: {
            key:     'error',
            title:   'Error',
            color: {
                bgLabel: '#C11713',
                label:   'white',
                bgText:  '#C11713',
                text:    'white'
            }
        },
        warn: {
            key:     'warn',
            title:   'Warning',
            color: {
                bgLabel: '#F29140',
                label:   'white',
                bgText:  '#FFD8B7',
                text:    'black'
            }
        },
        info: {
            key:     'info',
            title:   'Info',
            color: {
                bgLabel: '#413FA9',
                label:   'white',
                bgText:  '#B3B2EB',
                text:    'black'
            }
        },
        notice: {
            key:     'notice',
            title:   'Notice',
            color: {
                bgLabel: '#33C133',
                label:   'white',
                bgText:  '#ADF1AD',
                text:    'black'
            }
        },
        log: {
            key:     'log',
            title:   'Log',
            color: {
                bgLabel: '#f2f240',
                label:   'black',
                bgText:  '#ffff90',
                text:    'black'
            }
        },
        callstack: {
            key:     'TAS',
            title:   'function',
            color: {
                bgLabel: '#413FA9',
                label:   'white',
                bgText:  '#B3B2EB',
                text:    'black'
            }
        },
        callstack_async: {
            key:     'TAS',
            title:   'ASYNC CALL',
            color: {
                bgLabel: '#413FA9',
                label:   'white',
                bgText:  '#413FA9',
                text:    'white'
            }
        },
        TAS: {
            key:     'TAS',
            title:   'TAS',
            color: {
                bgLabel: 'grey',
                label:   'black;background:linear-gradient(#304352,#d7d2cc,#d7d2cc,#d7d2cc,#304352)',
                bgText:  'grey',
                text:    'black;background:linear-gradient(#304352,#d7d2cc,#d7d2cc,#d7d2cc,#304352)'
            }
        }
    },


    config = {
        debugMode: false,
        logging: {
            log: true,
            notice: true,
            info: true,
            warn: true,
            error: true,
            debug: false
        }
    },

    callstackRegistry = [],
    queuedUpdates = {}, //< Used for delaying saves till the last momment.

complexType = function(o){
    switch(typeof o){
        case 'string':
            return 'string';
        case 'boolean':
            return 'boolean';
        case 'number':
            return (_.isNaN(o) ? 'NaN' : (o.toString().match(/\./) ? 'decimal' : 'integer'));
        case 'function':
            return 'function: '+(o.name ? o.name+'()' : '(anonymous)');
        case 'object':
            return (_.isArray(o) ? 'array' : (_.isArguments(o) ? 'arguments' : ( _.isNull(o) ? 'null' : 'object')));
        default:
            return typeof o;
    }
},

dataLogger = function(primaryLogger,secondaryLogger,data){
    _.each(data,function(m){
        var type = complexType(m);
        switch(type){
            case 'string':
                primaryLogger(m);
                break;
            case 'undefined':
            case 'null':
            case 'NaN':
                primaryLogger('['+type+']');
                break;
            case 'number':
            case 'not a number':
            case 'integer':
            case 'decimal':
            case 'boolean':
                primaryLogger('['+type+']: '+m);
                break;
            default:
                primaryLogger('['+type+']:=========================================');
                secondaryLogger(m);
                primaryLogger('=========================================================');
                break;
        }
    });
},


colorLog = function(options){
    var coloredLoggerFunction,
        key = options.key,
        label = options.title || 'TAS',
        lBGColor = (options.color && options.color.bgLabel) || 'blue',
        lTxtColor = (options.color && options.color.label) || 'white',
        mBGColor = (options.color && options.color.bgText) || 'blue',
        mTxtColor = (options.color && options.color.text) || 'white';

    coloredLoggerFunction = function(message){
        console.log(
            '%c '+label+': %c '+message + ' ',
            'background-color: '+lBGColor+';color: '+lTxtColor+'; font-weight:bold;',
            'background-color: '+mBGColor+';color: '+mTxtColor+';'
        ); 
    };
    return function(){
        if('TAS'===key || config.logging[key]){
            dataLogger(coloredLoggerFunction,function(m){console.log(m);},_.toArray(arguments)); 
        }
    };
},

logDebug  = colorLog(loggingSettings.debug),
logError  = colorLog(loggingSettings.error),
logWarn   = colorLog(loggingSettings.warn),
logInfo   = colorLog(loggingSettings.info),
logNotice = colorLog(loggingSettings.notice),
logLog    = colorLog(loggingSettings.log),
log       = colorLog(loggingSettings.TAS),
logCS     = colorLog(loggingSettings.callstack),
logCSA    = colorLog(loggingSettings.callstack_async),

registerCallstack = function(callstack,label){
    var idx=_.findIndex(callstackRegistry,function(o){
        return (_.difference(o.stack,callstack).length === _.difference(callstack,o.stack).length) &&
            _.difference(o.stack,callstack).length === 0 &&
            o.label === label;
    });
    if(-1 === idx){
        idx=callstackRegistry.length;
        callstackRegistry.push({
            stack: callstack,
            label: label
        });
    }
    return idx;
},

setConfigOption = function(options){
    var newconf =_.defaults(options,config);
    newconf.logging=_.defaults(
        (options && options.logging)||{},
        config.logging
    );
    config=newconf;
},

debugMode = function(){
    config.logging.debug=true;
    config.debugMode = true;
},

getCallstack = function(){
    var e = new Error('dummy'),
        // eslint-disable-next-line no-useless-escape
        stack = _.map(_.rest(e.stack.replace(/^[^\(]+?[\n$]/gm, '')
        .replace(/^\s+at\s+/gm, '')
        .replace(/^Object.<anonymous>\s*\(/gm, '{anonymous}()@')
        .split('\n')),function(l){
            return l.replace(/\s+.*$/,'');
        });
    return stack;
},
logCallstackSub = function(cs){
    var matches, csa;
    _.find(cs,function(line){
        matches = line.match(/TAS_CALLSTACK_(\d+)/);
        if(matches){
            csa=callstackRegistry[matches[1]];
            logCSA( '===================='+(csa.label ? '> '+csa.label+' <' : '')+'====================');
            logCallstackSub(csa.stack);
            return true;
        } 
        logCS(line);
        return false;
    });
},
logCallstack = function(){
    var cs;
    if(config.debugMode){
        cs = getCallstack();
        cs.shift();
        log('==============================> CALLSTACK <==============================');
        logCallstackSub(cs);
        log('=========================================================================');
    }
},


wrapCallback = function (label, callback, context){
    var callstack;
    if('function' === typeof label){
        context=callback;
        callback=label;
        label=undefined;
    }
    if(!config.debugMode){
        return (function(cb,ctx){
            return function(){
                cb.apply(ctx||{},arguments);
            };
        }(callback,context));
    }
    
    callstack = getCallstack();
    callstack.shift();
    
    return (function(cb,ctx,cs,lbl){
        var ctxref=registerCallstack(cs,lbl);

        /*jshint -W054 */
        return new Function('cb','ctx','TASlog',
            "return function TAS_CALLSTACK_"+ctxref+"(){"+
                "TASlog('Entering: '+(cb.name||'(anonymous function)'));"+
                "cb.apply(ctx||{},arguments);"+
                "TASlog('Exiting: '+(cb.name||'(anonymous function)'));"+
            "};")(cb,ctx,log);
        /*jshint +W054 */
    }(callback,context,callstack,label));
},


prepareUpdate = function( attribute, value ){
    queuedUpdates[attribute]=value;
},

applyQueuedUpdates = function() {
    setAttrs(queuedUpdates);
    queuedUpdates = {};
},

namesFromArgs = function(args,base){
    return _.chain(args)
        .reduce(function(memo,attr){
            if('string' === typeof attr) {
                memo.push(attr);
            } else if(_.isArray(args) || _.isArguments(args)){
                memo = namesFromArgs(attr,memo);
            }
            return memo;
        },(_.isArray(base) && base) || [])
        .uniq()
        .value();
},

addId = function(obj,value){
    Object.defineProperty(obj,'id',{
        value: value,
        writeable: false,
        enumerable: false
    });
},

addProp = function(obj,prop,value,fullname){
    (function(){
        var pname=(_.contains(['S','F','I','D'],prop) ? '_'+prop : prop),
            full_pname = fullname || prop,
            pvalue=value;

        _.each(['S','I','F'],function(p){
            if( !_.has(obj,p)){
                Object.defineProperty(obj, p, {
                    value: {},
                    enumerable: false,
                    readonly: true
                });
            }
        });
        if( !_.has(obj,'D')){
            Object.defineProperty(obj, 'D', {
                value: _.reduce(_.range(10),function(m,d){
                        Object.defineProperty(m, d, {
                            value: {},
                            enumerable: true,
                            readonly: true
                        });
                        return m;
                    },{}),
                enumerable: false,
                readonly: true
            });
        }


        // Raw value
        Object.defineProperty(obj, pname, {
            enumerable: true,
            set: function(v){
                if(v!==pvalue) {
                    pvalue=v;
                    prepareUpdate(full_pname,v);
                }
            },
            get: function(){
                return pvalue;
            }
        });
        
        // string value
        Object.defineProperty(obj.S, pname, {
            enumerable: true,
            set: function(v){
                var val=v.toString();
                if(val !== pvalue) {
                    pvalue=val;
                    prepareUpdate(full_pname,val);
                }
            },
            get: function(){
                return pvalue.toString();
            }
        });

        // int value
        Object.defineProperty(obj.I, pname, {
            enumerable: true,
            set: function(v){
                var val=parseInt(v,10) || 0;
                if(val !== pvalue){
                    pvalue=val;
                    prepareUpdate(full_pname,val);
                }
            },
            get: function(){
                return parseInt(pvalue,10) || 0;
            }
        });

        // float value
        Object.defineProperty(obj.F, pname, {
            enumerable: true,
            set: function(v){
                var val=parseFloat(v) || 0;
                if(val !== pvalue) {
                    pvalue=val;
                    prepareUpdate(full_pname,val);
                }
            },
            get: function(){
                return parseFloat(pvalue) || 0;
            }
        });
        _.each(_.range(10),function(d){
            Object.defineProperty(obj.D[d], pname, {
                enumerable: true,
                set: function(v){
                    var val=(parseFloat(v) || 0).toFixed(d);
                    if(val !== pvalue){
                        pvalue=val;
                        prepareUpdate(full_pname,val);
                    }
                },
                get: function(){
                    return (parseFloat(pvalue) || 0).toFixed(d);
                }
            });
        });

    }());
},

repeating = function( section ) {
    return (function(s){
        var sectionName = s,
            attrNames = [],
            fieldNames = [],
            operations = [],
            after = [],
        
        repAttrs = function TAS_Repeating_Attrs(){
            attrNames = namesFromArgs(arguments,attrNames);
            return this;
        },
        repFields = function TAS_Repeating_Fields(){
            fieldNames = namesFromArgs(arguments,fieldNames);
            return this;
        },
        repReduce = function TAS_Repeating_Reduce(func, initial, final, context) { 
            operations.push({
                type: 'reduce',
                func: (func && _.isFunction(func) && func) || _.noop,
                memo: (_.isUndefined(initial) && 0) || initial,
                final: (final && _.isFunction(final) && final) || _.noop,
                context: context || {}
            });
            return this;
        },
        repMap = function TAS_Repeating_Map(func, final, context) {
            operations.push({
                type: 'map',
                func: (func && _.isFunction(func) && func) || _.noop,
                final: (final && _.isFunction(final) && final) || _.noop,
                context: context || {}
            });
            return this;
        },
        repEach = function TAS_Repeating_Each(func, final, context) {
            operations.push({
                type: 'each',
                func: (func && _.isFunction(func) && func) || _.noop,
                final: (final && _.isFunction(final) && final) || _.noop,
                context: context || {}
            });
            return this;
        },
        repTap = function TAS_Repeating_Tap(final, context) {
            operations.push({
                type: 'tap',
                final: (final && _.isFunction(final) && final) || _.noop,
                context: context || {}
            });
            return this;
        },
        repAfter = function TAS_Repeating_After(callback,context) {
            after.push({
                callback: (callback && _.isFunction(callback) && callback) || _.noop,
                context: context || {}
            });
            return this;
        },
        repExecute = function TAS_Repeating_Execute(callback,context){
            var rowSet = {},
                attrSet = {},
                fieldIds = [],
                fullFieldNames = [];

            repAfter(callback,context);

            // call each operation per row.
            // call each operation's final
            getSectionIDs("repeating_"+sectionName,function(ids){
                fieldIds = ids;
                fullFieldNames = _.reduce(fieldIds,function(memo,id){
                    return memo.concat(_.map(fieldNames,function(name){
                        return 'repeating_'+sectionName+'_'+id+'_'+name;  
                    }));
                },[]);
                getAttrs( _.uniq(attrNames.concat(fullFieldNames)), function(values){
                    _.each(attrNames,function(aname){
                        if(values.hasOwnProperty(aname)){
                            addProp(attrSet,aname,values[aname]);
                        }
                    });

                    rowSet = _.reduce(fieldIds,function(memo,id){
                        var r={};
                        addId(r,id);
                        _.each(fieldNames,function(name){
                            var fn = 'repeating_'+sectionName+'_'+id+'_'+name;  
                            addProp(r,name,values[fn],fn);
                        });

                        memo[id]=r;

                        return memo;
                    },{});

                    _.each(operations,function(op){
                        var res;
                        switch(op.type){
                            case 'tap':
                                _.bind(op.final,op.context,rowSet,attrSet)();
                                break;

                            case 'each':
                                _.each(rowSet,function(r){
                                    _.bind(op.func,op.context,r,attrSet,r.id,rowSet)();
                                });
                                _.bind(op.final,op.context,rowSet,attrSet)();
                                break;

                            case 'map':
                                res = _.map(rowSet,function(r){
                                    return _.bind(op.func,op.context,r,attrSet,r.id,rowSet)();
                                });
                                _.bind(op.final,op.context,res,rowSet,attrSet)();
                                break;

                            case 'reduce':
                                res = op.memo;
                                _.each(rowSet,function(r){
                                    res = _.bind(op.func,op.context,res,r,attrSet,r.id,rowSet)();
                                });
                                _.bind(op.final,op.context,res,rowSet,attrSet)();
                                break;
                        }
                    });

                    // finalize attrs
                    applyQueuedUpdates();
                    _.each(after,function(op){
                        _.bind(op.callback,op.context)();
                    });
                });
            });
        };
            
        return {
            attrs: repAttrs,
            attr: repAttrs,

            column: repFields,
            columns: repFields,
            field: repFields,
            fields: repFields,

            reduce: repReduce,
            inject: repReduce,
            foldl: repReduce,

            map: repMap,
            collect: repMap,

            each: repEach,
            forEach: repEach,

            tap: repTap,
            'do': repTap,

            after: repAfter,
            last: repAfter,
            done: repAfter,

            execute: repExecute,
            go: repExecute,
            run: repExecute
        };
    }(section));
},


repeatingSimpleSum = function(section, field, destination){
    repeating(section)
        .attr(destination)
        .field(field)
        .reduce(function(m,r){
            return m + (r.F[field]);
        },0,function(t,r,a){
            a.S[destination]=t;
        })
        .execute();
};

console.log('%c•.¸¸.•*´¨`*•.¸¸.•*´¨`*•.¸  The Aaron Sheet  v'+version+'  ¸.•*´¨`*•.¸¸.•*´¨`*•.¸¸.•','background: linear-gradient(to right,green,white,white,green); color:black;text-shadow: 0 0 8px white;');
console.log('%c•.¸¸.•*´¨`*•.¸¸.•*´¨`*•.¸  Last update: '+(new Date(lastUpdate*1000))+'  ¸.•*´¨`*•.¸¸.•*´¨`*•.¸¸.•','background: linear-gradient(to right,green,white,white,green); color:black;text-shadow: 0 0 8px white;');


return {
    /* Repeating Sections */
    repeatingSimpleSum: repeatingSimpleSum,
    repeating: repeating,

    /* Configuration */
    config: setConfigOption,

    /* Debugging */
    callback: wrapCallback,
    callstack: logCallstack,
    debugMode: debugMode,
    _fn: wrapCallback,

    /* Logging */
    debug: logDebug,
    error: logError,
    warn: logWarn,
    info: logInfo,
    notice: logNotice,
    log: logLog
};
}());

/* ---- END: TheAaronSheet.js ---- */


const i18n_deplacement = getTranslationByKey("deplacement"),
    i18n_force = getTranslationByKey("force"),
    i18n_endurance = getTranslationByKey("endurance"),
    i18n_hargne = getTranslationByKey("hargne"),
    i18n_combat = getTranslationByKey("combat"),
    i18n_instinct = getTranslationByKey("instinct"),
    i18n_tir = getTranslationByKey("tir"),
    i18n_savoir = getTranslationByKey("savoir"),
    i18n_technique = getTranslationByKey("technique"),
    i18n_aura = getTranslationByKey("aura"),
    i18n_parole = getTranslationByKey("parole"),
    i18n_sangFroid = getTranslationByKey("sang-froid"),
    i18n_discretion = getTranslationByKey("discretion"),
    i18n_dexterite = getTranslationByKey("dexterite"),
    i18n_perception = getTranslationByKey("perception"),
    i18n_chair = getTranslationByKey("chair"),
    i18n_bete = getTranslationByKey("bete"),
    i18n_machine = getTranslationByKey("machine"),
    i18n_dame = getTranslationByKey("dame"),
    i18n_masque = getTranslationByKey("masque"),
    i18n_od = getTranslationByKey("od"),
    i18n_exploit = getTranslationByKey("exploit"),
    i18n_couteauService = getTranslationByKey("couteau-de-service"),
    i18n_marteauEpieuC = getTranslationByKey("marteau-epieu-contact"),
    i18n_pistoletService = getTranslationByKey("pistolet-de-service"),
    i18n_marteauEpieuD = getTranslationByKey("marteau-epieu-distance"),
    i18n_coupPoing = getTranslationByKey("coup-poing-pied"),
    i18n_energieRetiree = getTranslationByKey("energie-retiree"),
    i18n_espoirRetire = getTranslationByKey("espoir-retire"),
    i18n_pasEnergie = getTranslationByKey("pas-assez-energie"),
    i18n_plusEnergie = getTranslationByKey("panne-energie"),
    i18n_pasEspoir = getTranslationByKey("pas-assez-espoir"),
    i18n_plusEspoir = getTranslationByKey("panne-espoir"),
    i18n_typeSoldier = getTranslationByKey("warrior-type-soldier"),
    i18n_typeHunter = getTranslationByKey("warrior-type-hunter"),
    i18n_typeScholar = getTranslationByKey("warrior-type-scholar"),
    i18n_typeHerald = getTranslationByKey("warrior-type-herald"),
    i18n_typeScout = getTranslationByKey("warrior-type-scout"),
    i18n_ghost = getTranslationByKey("mode-ghost"),
    i18n_ghostActive = getTranslationByKey("mode-ghost-active"),
    i18n_changelingActive = getTranslationByKey("mode-changeling-active"),
    i18n_impregnation = getTranslationByKey("shaman-impregnation"),
    i18n_portee = getTranslationByKey("portee"),
    i18n_chocAutomatique = getTranslationByKey("choc-automatique-si-chair"),     
    i18n_tour = getTranslationByKey("tour"),
    i18n_tours = getTranslationByKey("tours"),
    i18n_affecteAnatheme = getTranslationByKey("wizard-affecte-uniquement-anatheme"),
    i18n_style = getTranslationByKey("style"),
    i18n_standard = getTranslationByKey("standard"),
    i18n_couvert = getTranslationByKey("couvert"),
    i18n_agressif = getTranslationByKey("agressif"),
    i18n_akimbo = getTranslationByKey("akimbo"),
    i18n_ambidextre = getTranslationByKey("ambidextre"),
    i18n_ambidextrie = getTranslationByKey("ambidextrie"),
    i18n_defensif = getTranslationByKey("defensif"),
    i18n_pilonnage = getTranslationByKey("pilonnage"),
    i18n_puissant = getTranslationByKey("puissant"),
    i18n_suppression = getTranslationByKey("suppression"),
    i18n_precis = getTranslationByKey("precis"),   
    i18n_anatheme = getTranslationByKey("anatheme"),    
    i18n_antiAnatheme = getTranslationByKey("anti-anatheme"),    
    i18n_antiAnathemeCondition = getTranslationByKey("anti-anatheme-condition"),
    i18n_antiVehicule = getTranslationByKey("anti-vehicule"),
    i18n_artillerie = getTranslationByKey("artillerie"),
    i18n_artillerieCondition = getTranslationByKey("artillerie-condition"),
    i18n_assistanceAttaque = getTranslationByKey("assistance-attaque"),
    i18n_assistanceAttaqueCondition = getTranslationByKey("assistance-attaque-condition"),
    i18n_assassin = getTranslationByKey("assassin"),
    i18n_barrage = getTranslationByKey("barrage"),
    i18n_cadence = getTranslationByKey("cadence"),
    i18n_chargeur = getTranslationByKey("chargeur"),
    i18n_choc = getTranslationByKey("choc"),
    i18n_chocCondition = getTranslationByKey("choc-condition"),
    i18n_degatsContinus = getTranslationByKey("degats-continus"),
    i18n_defense = getTranslationByKey("defense"),
    i18n_deuxMains = getTranslationByKey("deux-mains"),
    i18n_demoralisant = getTranslationByKey("demoralisant"),
    i18n_demoralisantCondition = getTranslationByKey("demoralisant-condition"),
    i18n_designation = getTranslationByKey("designation"),
    i18n_destructeur = getTranslationByKey("destructeur"),
    i18n_destructeurCondition = getTranslationByKey("destructeur-condition"),
    i18n_dispersion = getTranslationByKey("dispersion"),
    i18n_enChaine = getTranslationByKey("en-chaine"),
    i18n_enChaineCondition = getTranslationByKey("en-chaine-condition"),
    i18n_esperance = getTranslationByKey("esperance"),
    i18n_esperanceConditionD = getTranslationByKey("esperance-conditionD"),
    i18n_esperanceConditionV = getTranslationByKey("esperance-conditionV"),
    i18n_fureur = getTranslationByKey("fureur"),
    i18n_fureurCondition = getTranslationByKey("fureur-condition"),
    i18n_ignoreArmure = getTranslationByKey("ignore-armure"),
    i18n_ignoreCDF = getTranslationByKey("ignore-champ-de-force"),
    i18n_jAkimbo = getTranslationByKey("jumele-akimbo"),
    i18n_jAmbidextrie = getTranslationByKey("jumele-ambidextrie"),
    i18n_leste = getTranslationByKey("leste"),
    i18n_lourd = getTranslationByKey("lourd"),
    i18n_lumiere = getTranslationByKey("lumiere"),
    i18n_meurtrier = getTranslationByKey("meurtrier"),
    i18n_meurtrierCondition = getTranslationByKey("meurtrier-condition"),
    i18n_obliteration = getTranslationByKey("obliteration"),
    i18n_obliterationCondition = getTranslationByKey("obliteration-condition"),
    i18n_orfevrerie = getTranslationByKey("orfevrerie"),
    i18n_parasitage = getTranslationByKey("parasitage"),
    i18n_parasitageCondition = getTranslationByKey("parasitage-condition"),
    i18n_perceArmure = getTranslationByKey("perce-armure"),
    i18n_penetrant = getTranslationByKey("penetrant"),
    i18n_precision = getTranslationByKey("precision"),
    i18n_reaction = getTranslationByKey("reaction"),
    i18n_silencieux = getTranslationByKey("silencieux"),
    i18n_soumission = getTranslationByKey("soumission"),
    i18n_soumissionCondition = getTranslationByKey("soumission-condition"),
    i18n_tenebricide = getTranslationByKey("tenebricide"),
    i18n_tenebricideConditionD = getTranslationByKey("tenebricide-conditionD"),
    i18n_tenebricideConditionV = getTranslationByKey("tenebricide-conditionV"),
    i18n_tirRafale = getTranslationByKey("tir-rafale"),
    i18n_tirRafaleCondition = getTranslationByKey("tir-rafale-condition"),
    i18n_tirSecurite = getTranslationByKey("tir-securite"),
    i18n_canonLong = getTranslationByKey("canon-long"),
    i18n_canonLongCondition = getTranslationByKey("canon-long-condition"),
    i18n_canonRaccourci = getTranslationByKey("canon-raccourci"),
    i18n_canonRaccourciCondition = getTranslationByKey("canon-raccourci-condition"),
    i18n_chambreDouble = getTranslationByKey("chambre-double"),
    i18n_interfaceGuidage = getTranslationByKey("interface-guidage"),
    i18n_jumelage = getTranslationByKey("jumelage"),
    i18n_lunetteIntelligente = getTranslationByKey("lunette-intelligente"),
    i18n_lunetteIntelligenteCondition = getTranslationByKey("lunette-intelligente-condition"),
    i18n_munitionsHyperVelocite = getTranslationByKey("munitions-hyper-velocite"),
    i18n_munitionsIEMParasitage = getTranslationByKey("munitions-iem-parasitage"),
    i18n_munitionsNonLetales = getTranslationByKey("munitions-non-letales"),
    i18n_munitionsSubsoniques = getTranslationByKey("munitions-subsoniques"),
    i18n_protectionArme = getTranslationByKey("protection-d'arme"),
    i18n_revetementOmega = getTranslationByKey("revetement-omega"),
    i18n_systemeRefroidissement = getTranslationByKey("systeme-refroidissement"),
    i18n_ultraviolence = getTranslationByKey("ultraviolence"),
    i18n_ultraviolenceCondition = getTranslationByKey("ultraviolence-condition"),
    i18n_attaqueSurpriseCondition = getTranslationByKey("attaque-surprise-condition"),
    i18n_structureElementAlpha = getTranslationByKey("structure-element-alpha"),
    i18n_agressive = getTranslationByKey("agressive"),
    i18n_assassine = getTranslationByKey("assassine"),
    i18n_barbelee = getTranslationByKey("barbelee"),
    i18n_connectee = getTranslationByKey("connectee"),
    i18n_electrifiee = getTranslationByKey("electrifiee"),
    i18n_indestructible = getTranslationByKey("indestructible"),
    i18n_jumelle = getTranslationByKey("jumelle"),
    i18n_lumineuse = getTranslationByKey("lumineuse"),
    i18n_massive = getTranslationByKey("massive"),
    i18n_protectrice = getTranslationByKey("protectrice"),
    i18n_soeur = getTranslationByKey("soeur"),
    i18n_sournoise = getTranslationByKey("sournoise"),
    i18n_arabesques = getTranslationByKey("arabesques-iridescentes"),
    i18n_armeAzurine = getTranslationByKey("arme-azurine"),
    i18n_armeAzurineCondition = getTranslationByKey("arme-azurine-condition"),
    i18n_armeRougeSang = getTranslationByKey("arme-rouge-sang"),
    i18n_armeRougeSangCondition = getTranslationByKey("arme-rouge-sang-condition"),
    i18n_armureGravee = getTranslationByKey("armure-gravee"),
    i18n_blasonChevalier = getTranslationByKey("blason-chevalier"),
    i18n_bouclierGrave = getTranslationByKey("bouclier-grave"),
    i18n_cheneSculpte = getTranslationByKey("chene-sculpte"),
    i18n_cheneSculpteCondition = getTranslationByKey("chene-sculpte-condition"),
    i18n_chromee = getTranslationByKey("chromee"),
    i18n_codeKnight = getTranslationByKey("code-knight-grave"),
    i18n_craneRieur = getTranslationByKey("crane-rieur-grave"),
    i18n_fauconPlumesL = getTranslationByKey("faucon-plumes"),
    i18n_griffuresGravees = getTranslationByKey("griffures-gravees"),
    i18n_griffuresGraveesCondition = getTranslationByKey("griffures-gravees-condition"),
    i18n_masqueBrise = getTranslationByKey("masque-brise-sculpte"),
    i18n_masqueBriseCondition = getTranslationByKey("masque-brise-sculpte-condition"),
    i18n_rouagesCasses = getTranslationByKey("rouages-casses"),
    i18n_rouagesCassesCondition = getTranslationByKey("rouages-casses-graves-condition"),
    i18n_odDiscretion = getTranslationByKey("bonus-od-discretion"),
    i18n_inclus = getTranslationByKey("inclus"),
    i18n_contreCoupsDechirureT = getTranslationByKey("contrecoups-dechirure"),
    i18n_contreCoupsDechirureV = getTranslationByKey("contrecoups-dechirure-description"),
    i18n_contreCoupsDisparitionT = getTranslationByKey("contrecoups-disparition"),
    i18n_contreCoupsDisparitionV = getTranslationByKey("contrecoups-disparition-description"),
    i18n_contreCoupsIncidentT = getTranslationByKey("contrecoups-incident"),
    i18n_contreCoupsIncidentV1 = getTranslationByKey("contrecoups-incident-description-1"),
    i18n_contreCoupsIncidentV2 = getTranslationByKey("contrecoups-incident-description-2"),
    i18n_contreCoupsSiphonT = getTranslationByKey("contrecoups-siphon"),
    i18n_contreCoupsSiphonV1 = getTranslationByKey("contrecoups-siphon-description-1"),
    i18n_contreCoupsSiphonV2 = getTranslationByKey("contrecoups-siphon-description-2"),
    i18n_contreCoupsSursautT = getTranslationByKey("contrecoups-sursaut"),
    i18n_contreCoupsSursautV1 = getTranslationByKey("contrecoups-sursaut-description-1"),
    i18n_contreCoupsSursautV2 = getTranslationByKey("contrecoups-sursaut-description-2"),
    i18n_contreCoupsFragmentationT = getTranslationByKey("contrecoups-fragmentation"),
    i18n_contreCoupsFragmentationV1 = getTranslationByKey("contrecoups-fragmentation-description-1"),
    i18n_contreCoupsFragmentationV2 = getTranslationByKey("contrecoups-fragmentation-description-2"),
    i18n_contreCoupsDesorientationT = getTranslationByKey("contrecoups-desorientation"),
    i18n_contreCoupsDesorientationV1 = getTranslationByKey("contrecoups-desorientation-description-1"),
    i18n_contreCoupsDesorientationV2 = getTranslationByKey("contrecoups-desorientation-description-2"),
    i18n_contreCoupsDesagregationT = getTranslationByKey("contrecoups-desagregation"),
    i18n_contreCoupsDesagregationV1 = getTranslationByKey("contrecoups-desagregation-description-1"),
    i18n_contreCoupsDesagregationV2 = getTranslationByKey("contrecoups-desagregation-description-2"),
    i18n_contreCoupsDefaillanceT = getTranslationByKey("contrecoups-defaillance"),
    i18n_contreCoupsDefaillanceV1 = getTranslationByKey("contrecoups-defaillance-description-1"),
    i18n_contreCoupsDefaillanceV2 = getTranslationByKey("contrecoups-defaillance-description-2"),
    i18n_surVehicule = getTranslationByKey("sur-vehicule"),
    i18n_resilienceRepare = getTranslationByKey("resilience-repare"),
    i18n_blindageRepare = getTranslationByKey("blindage-repare"),
    i18n_briserResilience = getTranslationByKey("briser-resilience"),
    i18n_poingsSoniques = getTranslationByKey("poings-soniques-effets"),
    i18n_lameCinetique = getTranslationByKey("lames-cinetiques-geantes-effets"),
    i18n_attaquesOmbres = getTranslationByKey("capacite-fan-made-Attaque-dans-les-ombres"),
    i18n_porteeMoyenne = getTranslationByKey("portee-moyenne"),
    i18n_porteeCourte = getTranslationByKey("portee-courte"),
    i18n_devasterAnatheme = getTranslationByKey("devaster-anatheme"),
    i18n_bourreauTenebres = getTranslationByKey("bourreau-tenebres"),
    i18n_equilibrerBalance = getTranslationByKey("equilibrer-balance")
    ;

function maxCar(carac, score, aspect)
{
    if(score > aspect)
    {
        setAttrs({
            [carac]: aspect
        });
    }
}

function totalADruid(attrs, aspect) {
    let base = +attrs[`${aspect}Base`];
    let evol = +attrs[`${aspect}Evol`];

    return base+evol;
}

function totalAspect(attrs, aspect) {
    let min = +attrs[`${aspect}PNJAE`];
    let maj = +attrs[`${aspect}PNJAEMaj`];

    return min+maj;
}

function setPanneauInformation(texte, reset = false, slot = false, energie = false)
{	
    getAttrs(["panneauInformation", "nomIA", "fichePNJ"], function(value)
    {
        const TFiche = value["fichePNJ"];
        const PI = value["panneauInformation"];
        var IA = value["nomIA"];
        
        if(TFiche == 1)
            IA = "ALERTE : ";
        
        if(PI == "" || reset == true)
        {
            if(IA == "" && TFiche == 0)
            {
                setAttrs({
                    panneauInformation: "IA : "+texte+" "
                });
            }
            else
            {
                setAttrs({
                    panneauInformation: IA+" : "+texte+" "
                });
            }
        }
        else
        {
            setAttrs({
                panneauInformation: PI+texte+" "
            });
        }
    });
    
    if(reset == true && slot == false)
        PI["msgSlot"] = 0;
    
    if(slot == true)
        PI["msgSlot"] = 1;
        
    if(energie == true)
        PI["msgEnergie"] = 1;
}

function resetPanneauInformation()
{
    
    setAttrs({
        panneauInformation: ""
    });
        
    PI["msgSlot"] = 0;
    
    PI["msgEnergie"] = 0;
}

function setActiveCharacterId(charId){
    var oldAcid=getActiveCharacterId();
    var ev = new CustomEvent("message");
    ev.data={"id":"0", "type":"setActiveCharacter", "data":charId};
    self.dispatchEvent(ev); 
    return oldAcid;
}

var _sIn=setInterval;
setInterval=function(callback, timeout){
    var acid=getActiveCharacterId();
    _sIn(
        function(){
            var prevAcid=setActiveCharacterId(acid);
            callback();
            setActiveCharacterId(prevAcid);
        }
    ,timeout);
}

var _sto=setTimeout
setTimeout=function(callback, timeout){
    var acid=getActiveCharacterId();
    _sto(
        function(){
            var prevAcid=setActiveCharacterId(acid);
            callback();
            setActiveCharacterId(prevAcid);
        }
    ,timeout);
}

function getAttrsAsync(props){
    var acid=getActiveCharacterId(); //save the current activeCharacterID in case it has changed when the promise runs 
    var prevAcid=null;               //local variable defined here, because it needs to be shared across the promise callbacks defined below
    return new Promise((resolve,reject)=>{
            prevAcid=setActiveCharacterId(acid);  //in case the activeCharacterId has changed, restore it to what we were expecting and save the current value to restore later
            try{
                getAttrs(props,(values)=>{  resolve(values); }); 
            }
            catch{ reject(); }
    }).finally(()=>{
        setActiveCharacterId(prevAcid); //restore activeCharcterId to what it was when the promise first ran
    });
}

//use the same pattern for each of the following...
function setAttrsAsync(propObj, options){
    var acid=getActiveCharacterId(); 
    var prevAcid=null;               
    return new Promise((resolve,reject)=>{
            prevAcid=setActiveCharacterId(acid);  
            try{
                setAttrs(propObj,options,(values)=>{ resolve(values); });
            }
            catch{ reject(); }
    }).finally(()=>{
        setActiveCharacterId(prevAcid); 
    });
}

function getSectionIDsAsync(sectionName){
    var acid=getActiveCharacterId(); 
    var prevAcid=null;               
    return new Promise((resolve,reject)=>{
            prevAcid=setActiveCharacterId(acid);  
            try{
                getSectionIDs(sectionName,(values)=>{ resolve(values); });
            }
            catch{ reject(); }
    }).finally(()=>{
        setActiveCharacterId(prevAcid); 
    });
}

function getSingleAttrAsync(prop){ 
    var acid=getActiveCharacterId(); 
    var prevAcid=null;               
    return new Promise((resolve,reject)=>{
            prevAcid=setActiveCharacterId(acid);  
            try{
                getAttrs([prop],(values)=>{  resolve(values[prop]); }); 
            }
            catch{ reject(); }
    }).finally(()=>{
        setActiveCharacterId(prevAcid); 
    });
}

function isApplied(e) {
    let result = false;

    if(e != "0")
        result = e;

    return result;
}

var PI = {
    "msgSlot":0,
    "msgEnergie":0
};

const listeArmure = ["Guardian", "Barbarian", "Bard", "Berserk", "Druid", "Monk", "Necromancer", "Paladin", "Priest", "Psion", "Ranger", "Rogue", "Shaman", "Sorcerer", "Warlock","Warmaster", "Warrior", "Wizard"];

const dataArmure = {
    "sans":{
        armureMax:0,
        energieMax:0,
        cdfMax:0
    },
    "guardian":{
        armureMax:5,
        energieMax:0,
        cdfMax:5
    },
    "barbarian":{
        armureMax:60,
        energieMax:60,
        cdfMax:12,
    },
    "bard":{
        armureMax:40,
        energieMax:80,
        cdfMax:12
    },
    "berserk":{
        armureMax:60,
        energieMax:0,
        egide:6,
        cdfMax:8,
    },
    "druid":{
        armureMax:50,
        energieMax:80,
        cdfMax:12,
    },
    "monk":{
        armureMax:60,
        energieMax:50,
        cdfMax:14
    },
    "necromancer":{
        armureMax:80,
        energieMax:100,
        cdfMax:12
    },
    "paladin":{
        armureMax:120,
        energieMax:20,
        cdfMax:8
    },
    "priest":{
        armureMax:70,
        energieMax:60,
        cdfMax:10
    },
    "psion":{
        armureMax:50,
        energieMax:60,
        cdfMax:14
    },
    "ranger":{
        armureMax:50,
        energieMax:70,
        cdfMax:12
    },
    "rogue":{
        armureMax:50,
        energieMax:70,
        cdfMax:12
    },
    "shaman":{
        armureMax:60,
        energieMax:80,
        cdfMax:10
    },
    "sorcerer":{
        armureMax:60,
        energieMax:80,
        cdfMax:14
    },
    "warlock":{
        armureMax:60,
        energieMax:60,
        cdfMax:8
    },
    "warmaster":{
        armureMax:90,
        energieMax:50,
        cdfMax:8
    },
    "warrior":{
        armureMax:100,
        energieMax:40,
        cdfMax:8
    },		
    "wizard":{
        armureMax:40,
        energieMax:80,
        cdfMax:14
    }
};

const CaracNom = {
    "deplacement":i18n_deplacement,
    "force":i18n_force,
    "endurance":i18n_endurance,
    "hargne":i18n_hargne,
    "combat":i18n_combat,
    "instinct":i18n_instinct,
    "tir":i18n_tir,
    "savoir":i18n_savoir,
    "technique":i18n_technique,
    "aura":i18n_aura,
    "parole":i18n_parole,
    "sf":i18n_sangFroid,
    "discretion":i18n_discretion,
    "dexterite":i18n_dexterite,
    "perception":i18n_perception,
};

const ODValue = {
    "deplacement":"calODDep",
    "force":"calODFor",
    "endurance":"calODEnd",
    "hargne":"calODHar",
    "combat":"calODCom",
    "instinct":"calODIns",
    "tir":"calODTir",
    "savoir":"calODSav",
    "technique":"calODTec",
    "aura":"calODAur",
    "parole":"calODPar",
    "sf":"calODSFR",
    "discretion":"calODDis",
    "dexterite":"calODDex",
    "perception":"calODPer",
};

const aspectCompanionsDruid = {
    "druidLionChair":i18n_chair,
    "druidLionBete":i18n_bete,
    "druidLionMachine":i18n_machine,
    "druidLionDame":i18n_dame,
    "druidLionMasque":i18n_masque,
    "MALDruidLionChair":i18n_chair,
    "MALDruidLionBete":i18n_bete,
    "MALDruidLionMachine":i18n_machine,
    "MALDruidLionDame":i18n_dame,
    "MALDruidLionMasque":i18n_masque,
    "druidWolfChair":i18n_chair,
    "druidWolfBete":i18n_bete,
    "druidWolfMachine":i18n_machine,
    "druidWolfDame":i18n_dame,
    "druidWolfMasque":i18n_masque,
    "MALDruidWolfChair":i18n_chair,
    "MALDruidWolfBete":i18n_bete,
    "MALDruidWolfMachine":i18n_machine,
    "MALDruidWolfDame":i18n_dame,
    "MALDruidWolfMasque":i18n_masque,
    "druidCrowChair":i18n_chair,
    "druidCrowBete":i18n_bete,
    "druidCrowMachine":i18n_machine,
    "druidCrowDame":i18n_dame,
    "druidCrowMasque":i18n_masque,
    "MALDruidCrowChair":i18n_chair,
    "MALDruidCrowBete":i18n_bete,
    "MALDruidCrowMachine":i18n_machine,
    "MALDruidCrowDame":i18n_dame,
    "MALDruidCrowMasque":i18n_masque
};

const AspectNom = {
    "Chair":i18n_chair,
    "Bete":i18n_bete,
    "Machine":i18n_machine,
    "Dame":i18n_dame,
    "Masque":i18n_masque,
};

const AEValue = {
    "Chair_Min":"ChairPNJAE",
    "Chair_Maj":"ChairPNJAEMaj",
    "Bete_Min":"BetePNJAE",
    "Bete_Maj":"BetePNJAEMaj",
    "Machine_Min":"MachinePNJAE",
    "Machine_Maj":"MachinePNJAEMaj",
    "Dame_Min":"DamePNJAE",
    "Dame_Maj":"DamePNJAEMaj",
    "Masque_Min":"MasquePNJAE",
    "Masque_Maj":"MasquePNJAEMaj",
};

const listBase = [
    `armure`,
    `armureLegende`,
    `jetModifDes`,
    `bonusCarac`,
];

const listArmure = [
    `barbarianGoliath`,
    `bardChangeling`,
    `rogueGhost`,
    `shamanNbreTotem`,
    `caracteristiqueTotem1`,
    `caracteristiqueTotem2`,
    `caracteristiqueTotem3`,
    `warriorSoldierA`,
    `warriorHunterA`,
    `warriorHeraldA`,
    `warriorScholarA`,
    `warriorScoutA`,
    `warrior250PG`,
];

const listArmureLegende = [
    `MALBarbarianGoliath`,
    `MALBardChangeling`,
    `MALRogueGhost`,
    `MALShamanNbreTotem`,
    `MALCaracteristiqueTotem1`,
    `MALCaracteristiqueTotem2`,
    `MALWarriorSoldierA`,
    `MALWarriorHunterA`,
    `MALWarriorHeraldA`,
    `MALWarriorScholarA`,
    `MALWarriorScoutA`,
];

const listStyle = [
    `styleCombat`,
    `atkCouvert`,
    `atkAgressif`,
    `atkAkimbo`,
    `atkAmbidextre`,
    `atkDefensif`,
    `atkPilonnage`,
    `stylePuissantType`,
    `stylePuissantBonus`,
    `styleSuppressionD`,
    `styleSuppressionV`,
];

async function getCarac(hasBonus, C1, C2, C3, C4, CO1 = false) {
    let tC1 = isApplied(C1);
    let tC2 = isApplied(C2);
    let tC3 = isApplied(C3);
    let tC4 = isApplied(C4);
    let tCO1 = false;

    if(CO1)
        tCO1 = isApplied(CO1);

    let listCaracs = [];

    let result = {};

    let tC1Nom = "0"
    let tC2Nom = "0"
    let tC3Nom = "0"
    let tC4Nom = "0"
    let tCO1Nom = "0"

    if(tC1) {
        tC1Nom = String(tC1).slice(2, -1);
        result["C1"] = true;
        result["C1Brut"] = tC1Nom;
        result["C1Nom"] = CaracNom[tC1Nom];

        listCaracs.push(tC1Nom);
        listCaracs.push(ODValue[tC1Nom]);
    } else
    result["C1"] = false;

    if(tC2) {
        tC2Nom = String(tC2).slice(2, -1);
        result["C2"] = true;
        result["C2Brut"] = tC2Nom;
        result["C2Nom"] = CaracNom[tC2Nom];

        listCaracs.push(tC2Nom);
        listCaracs.push(ODValue[tC2Nom]);
    } else
    result["C2"] = false;

    if(hasBonus == 1 || hasBonus == 2) {
        if(tC3) {
            tC3Nom = String(tC3).slice(2, -1);
            result["C3"] = true;
            result["C3Brut"] = tC3Nom;
            result["C3Nom"] = CaracNom[tC3Nom];
    
            listCaracs.push(tC3Nom);
            listCaracs.push(ODValue[tC3Nom]);
        } else
        result["C3"] = false;

        if(hasBonus == 2) {
            if(tC4) {
                tC4Nom = String(tC4).slice(2, -1);
                result["C4"] = true;
                result["C4Brut"] = tC4Nom;
                result["C4Nom"] = CaracNom[tC4Nom];
        
                listCaracs.push(tC4Nom);
                listCaracs.push(ODValue[tC4Nom]);
            } else
            result["C4"] = false;
        } else
        result["C4"] = false;
    } else {
        result["C3"] = false;
        result["C4"] = false;
    }

    if(tCO1) {
        tCO1Nom = String(tCO1).slice(2, -1);
        result["CO1"] = true;
        result["CO1Brut"] = tCO1Nom;
        result["CO1Nom"] = CaracNom[tCO1Nom];

        listCaracs.push(tCO1Nom);
        listCaracs.push(ODValue[tCO1Nom]);
    }

    let attrsCarac = await getAttrsAsync(listCaracs);

    if(tC1) {
        result["C1Base"] = +attrsCarac[tC1Nom];
        result["C1OD"] = +attrsCarac[ODValue[tC1Nom]];
    }

    if(tC2) {
        result["C2Base"] = +attrsCarac[tC2Nom];
        result["C2OD"] = +attrsCarac[ODValue[tC2Nom]];
    }

    if(hasBonus == 1 || hasBonus == 2) {
        if(tC3) {
            result["C3Base"] = +attrsCarac[tC3Nom];
            result["C3OD"] = +attrsCarac[ODValue[tC3Nom]];
        }

        if(hasBonus == 2) {
            if(tC4) {
                result["C4Base"] = +attrsCarac[tC4Nom];
                result["C4OD"] = +attrsCarac[ODValue[tC4Nom]];
            }
        }
    }

    if(tCO1) {
        result["CO1Base"] = +attrsCarac[tCO1Nom];
        result["CO1OD"] = +attrsCarac[ODValue[tCO1Nom]];
    }

    return result;
}

//Versioning 
on("sheet:opened",function()
{
    getAttrs(["version"], function(v)
    {
        const version = parseInt(v["version"], 10)||0;
        
        if(version < 15)
        {
            getAttrs(["MAJSheetworker", "MonkMAJ", "MAJ", "PsionMAJ", "OD_MAJ", "PNJAEMAJ", "PNJPFMAJ", "WarriorOD_MAJ", "WarriorOD_MAJ_2", "PJINSMAJ", "MAJV15LDB_1", "MAJV15LDB_2", "MAJV15LDB_3", "DruidLionBF"], function(value)
            {
                const MAJSW = parseInt(value["MAJSheetworker"], 10)||0;
                const MAJMO = parseInt(value["MonkMAJ"], 10)||0;
                const MAJSA = parseInt(value["MAJ"], 10)||0;
                const MAJPS = parseInt(value["PsionMAJ"], 10)||0;
                const MAJOD = parseInt(value["OD_MAJ"], 10)||0;
                const MAJAE = parseInt(value["PNJAEMAJ"], 10)||0;
                const MAJPF = parseInt(value["PNJPFMAJ"], 10)||0;
                const MAJW1 = parseInt(value["WarriorOD_MAJ"], 10)||0;
                const MAJW2 = parseInt(value["WarriorOD_MAJ_2"], 10)||0;
                const MAJNS = parseInt(value["PJINSMAJ"], 10)||0;
                const MAJL1 = parseInt(value["MAJV15LDB_1"], 10)||0;
                const MAJL2 = parseInt(value["MAJV15LDB_2"], 10)||0;
                const MAJL3 = parseInt(value["MAJV15LDB_3"], 10)||0;
                const MAJBF = parseInt(value["DruidLionBF"], 10)||0;
                
                var versioning = 0;
                
                if(MAJSW == 1 || version > 0)
                    versioning += 1;
                else
                {
                    listeArmure.forEach(function (nom)
                    {
                        var nCorrection = nom;
                        var nMin = nom.toLowerCase();
                            
                        if(nCorrection == "Druid")
                        {
                            nCorrection = "Drui";
                        }

                        getAttrs(["armure"+nCorrection, "armure"+nCorrection+"Modif", "energie"+nCorrection, "energie"+nCorrection+"Modif", "cdf"+nCorrection+"Modif"], function(value)
                        {
                            var vArmure = parseInt(value["armure"+nCorrection], 10)||0;
                            var vArmureMax = parseInt(armure[nMin]["armureMax"], 10)||0;
                            var vArmureModif = parseInt(value["armure"+nCorrection+"Modif"], 10)||0;
                            
                            var vEnergie = parseInt(value["energie"+nCorrection], 10)||0;
                            var vEnergieMax = parseInt(armure[nMin]["energieMax"], 10)||0;
                            var vEnergieModif = parseInt(value["energie"+nCorrection+"Modif"], 10)||0;
                            
                            var vCdfModif = parseInt(value["cdf"+nCorrection+"Modif"], 10)||0;
                            
                            dataArmure[nMin]["armure"] = vArmure;
                            dataArmure[nMin]["armureModif"] = vArmureModif;
                            
                            dataArmure[nMin]["energie"] = vEnergie;
                            dataArmure[nMin]["energieModif"] = vEnergieModif;
                            
                            dataArmure[nMin]["cdfModif"] = vCdfModif;
                        });
                    });
                    
                    getAttrs(["armure", "barbarianGoliath", "sorcererMMCorpMetal", "sorcerer150PG", "sorcererMM250PG", "warmaster150PG", "warmaster250PG", "warmasterImpFPersonnel"], function(value)
                    {
                        const actuel = value["armure"];
                        const goliath = parseInt(value["barbarianGoliath"], 10)||0;
                        const CorpMetal = value["sorcererMMCorpMetal"];
                        const CM150PG = value["sorcerer150PG"];
                        const CM250PG = value["sorcererMM250PG"];
                        const WIPers = value["warmasterImpFPersonnel"];
                        const W150PG = value["warmaster150PG"];
                        const W250PG = value["warmaster250PG"];

                        const armModif = dataArmure[actuel]["armureModif"];
                        const eneModif = dataArmure[actuel]["energieModif"];
                        const cdfModif = dataArmure[actuel]["cdfModif"];
                        
                        var totalEnergie = dataArmure[actuel]["energieMax"]+eneModif;
                        
                        var bonusCDF = 0;
                        
                        if(actuel == "barbarian")
                            bonusCDF += goliath;
                                                
                        if(actuel == "sorcerer")
                        {
                            if(CorpMetal != 0 || CM250PG != 0)
                            {
                                bonusCDF += 2;
                                
                                if(CM150PG != 0)
                                    bonusCDF += 2;
                            }
                        }
                        
                        if(actuel == "warmaster")
                        {
                            if(WIPers != 0)
                                bonusCDF += 2;
                        
                            if(W150PG != 0)
                                totalEnergie = dataArmure[actuel]["energieMax150"]+eneModif;
                                
                            if(W250PG != 0)
                                totalEnergie = dataArmure[actuel]["energieMax250"]+eneModif;
                        }
                        
                        setAttrs({
                            armurePJ:armure[actuel]["armure"],
                            armurePJ_max:armure[actuel]["armureMax"]+armModif,
                            armurePJModif:armure[actuel]["armureModif"],
                            energiePJ:armure[actuel]["energie"],
                            energiePJ_max:totalEnergie,
                            energiePJModif:armure[actuel]["energieModif"],
                            cdfPJ:armure[actuel]["cdf"]+cdfModif+bonusCDF,
                            cdfPJ_max:armure[actuel]["cdfMax"]+cdfModif+bonusCDF,
                            cdfPJModif:armure[actuel]["cdfModif"]
                        });
                    });
                
                    versioning += 1;
                }
                
                if(MAJMO == 1 || version > 1)
                    versioning += 1;
                else
                {
                    getAttrs(["monk150PG", "monk250PG"], function(value)
                    {
                        var M150 = value.monk150PG;
                        var M250 = value.monk250PG;
                        
                        if(M150 == 2)
                        {
                            setAttrs({
                                monkSalveDegat: "5D6",
                                monkVagueDegat: "5D6",
                                monkRayonDegat: "6D6",
                                monkRayonViolence: "4D6"
                            });
                        }
                        else
                        {
                            setAttrs({
                                monkSalveDegat: "3D6",
                                monkVagueDegat: "3D6",
                                monkRayonDegat: "4D6",
                                monkRayonViolence: "2D6"
                            });
                        }
                        
                        if(M250 == 1)
                        {
                            setAttrs({
                                monkSalveEffets: "Parasitage 1 / Dispersion 6 / Ultraviolence / Destructeur",
                                monkVagueEffets: "Parasitage 4 / Dispersion 3 / Choc 2",
                                monkRayonEffets: "Parasitage 1 / Ignore Armure"
                            });
                        }
                        else
                        {
                            setAttrs({
                                monkSalveEffets: "Parasitage 1 / Dispersion 3 / Ultraviolence / Destructeur",
                                monkVagueEffets: "Parasitage 2 / Dispersion 3 / Choc 2",
                                monkRayonEffets: "Parasitage 1 / Perce Armure 40"
                            });
                        }
                    });
                
                    versioning += 1;
                }
                
                if(MAJSA == 1 || version > 2)
                    versioning += 1;
                else
                {
                    getAttrs(["sante"], function(value)
                    {
                        setAttrs({
                                santepj: value.sante,
                                santePNJ: value.sante
                        });
                    });
                
                    versioning += 1;
                }
                
                if(MAJPS == 1 || version > 3)
                    versioning += 1;
                else
                {
                    getAttrs(["psion200PG"], function(value)
                    {
                        if(value.psion200PG == "on")
                        {
                            setAttrs({
                                    psionMalusA: "3D",
                                    psionMalus: 3
                            });
                        }
                        else
                        {
                            setAttrs({
                                    psionMalusA: "2D",
                                    psionMalus: 2
                            });
                        }
                    });
                
                    versioning += 1;
                }
                
                if(MAJOD == 1 || version > 4)
                    versioning += 1;
                else
                {
                    getAttrs(["armure", "deplOD", "forOD", "endOD", "hargneOD", "combOD", "instOD", "tirOD", "savoirOD", "technOD", "auraOD", "paroleOD", "sfOD", "discrOD", "percOD", "dextOD", "warriorSoldierA", "warriorHunterA", "warriorScholarA", "warriorHeraldA", "warriorScoutA", "warrior250PG"], function(value) 
                    {
                        var armure = value.armure;

                        var ODDep = Number(value.deplOD);
                        var ODFor = Number(value.forOD);
                        var ODEnd = Number(value.endOD);
                        
                        var ODHar = Number(value.hargneOD);
                        var ODCom = Number(value.combOD);
                        var ODIns = Number(value.instOD);
                        
                        var ODTir = Number(value.tirOD);
                        var ODSav = Number(value.savoirOD);
                        var ODTec = Number(value.technOD);
                        
                        var ODAur = Number(value.auraOD);
                        var ODPar = Number(value.paroleOD);
                        var ODSFR = Number(value.sfOD);
                        
                        var ODDis = Number(value.discrOD);
                        var ODPer = Number(value.percOD);
                        var ODDex = Number(value.dextOD);
                        
                        var WEvol = Number(value.warrior250PG);
                        
                        var SolBonus = value.warriorSoldierA;
                        var HunBonus = value.warriorHunterA;
                        var SchBonus = value.warriorScholarA;
                        var HerBonus = value.warriorHeraldA;
                        var ScoBonus = value.warriorScoutA;
                                    
                        var sumSol = 0;
                        var sumHun = 0;
                        var sumSch = 0;
                        var sumHer = 0;
                        var sumSco = 0;
                        
                        if(armure == "warrior")
                        {
                            if(SolBonus != 0)
                                sumSol = 1+WEvol;
                            if(HunBonus != 0)
                                sumHun = 1+WEvol;
                            if(SchBonus != 0)
                                sumSch = 1+WEvol;
                            if(HerBonus != 0)
                                sumHer = 1+WEvol;
                            if(ScoBonus != 0)
                                sumSco = 1+WEvol;
                        }
                        
                        var totDep = ODDep+sumSol;
                        var totFor = ODFor+sumSol;
                        var totEnd = ODEnd+sumSol;
                        
                        var totHar = ODHar+sumHun;
                        var totCom = ODCom+sumHun;
                        var totIns = ODIns+sumHun;
                        
                        var totTir = ODTir+sumSch;
                        var totSav = ODSav+sumSch;
                        var totTec = ODTec+sumSch;
                        
                        var totAur = ODAur+sumHer;
                        var totPar = ODPar+sumHer;
                        var totSFR = ODSFR+sumHer;
                        
                        var totDis = ODDis+sumSco;
                        var totPer = ODPer+sumSco;
                        var totDex = ODDex+sumSco;

                        setAttrs({
                                calODDep: ODDep,
                                calODFor: totFor,
                                calODEnd: totEnd,
                                calODHar: totHar,
                                calODCom: totCom,
                                calODIns: totIns,
                                calODTir: totTir,
                                calODSav: totSav,
                                calODTec: totTec,
                                calODAur: totAur,
                                calODPar: totPar,
                                calODSFR: totSFR,
                                calODDis: totDis,
                                calODPer: totPer,
                                calODDex: totDex
                        });
                    });
                
                    versioning += 1;
                }
                
                if(MAJAE == 1 || version > 5)
                    versioning += 1;
                else
                {
                    getAttrs(["chairPNJAE"], function(value)
                    {
                        var PNJAE = value.chairPNJAE;
                        
                        if(PNJAE > 5)
                        {
                            setAttrs({
                                    chairPNJAE: 0,
                                    chairPNJAEMaj: PNJAE
                            });
                        }
                        
                    });
                    
                    getAttrs(["betePNJAE"], function(value)
                    {
                        var PNJAE = value.betePNJAE;
                        
                        if(PNJAE > 5)
                        {
                            setAttrs({
                                    betePNJAE: 0,
                                    betePNJAEMaj: PNJAE
                            });
                        }
                        
                    });
                    
                    getAttrs(["machinePNJAE"], function(value)
                    {
                        var PNJAE = value.machinePNJAE;
                        
                        if(PNJAE > 5)
                        {
                            setAttrs({
                                    machinePNJAE: 0,
                                    machinePNJAEMaj: PNJAE
                            });
                        }
                        
                    });
                    
                    getAttrs(["damePNJAE"], function(value)
                    {
                        var PNJAE = value.damePNJAE;
                        
                        if(PNJAE > 5)
                        {
                            setAttrs({
                                    damePNJAE: 0,
                                    damePNJAEMaj: PNJAE
                            });
                        }
                        
                    });
                    
                    getAttrs(["masquePNJAE"], function(value)
                    {
                        var PNJAE = value.masquePNJAE;
                        
                        if(PNJAE > 5)
                        {
                            setAttrs({
                                    masquePNJAE: 0,
                                    masquePNJAEMaj: PNJAE
                            });
                        }
                        
                    });
                
                    versioning += 1;
                }
                
                if(MAJPF == 1 || version > 6)
                    versioning += 1;
                else
                {
                    getAttrs(["motivationMajeure"], function(value)
                    {
                        var PJMM = value.motivationMajeure;

                        setAttrs({
                                ptsFaibles: PJMM
                        });
                        
                    });
                
                    versioning += 1;
                }
                
                if(MAJW1 == 1 || version > 7)
                    versioning += 1;
                else
                {
                    getSectionIDs("repeating_armeDist", function(idarray) 
                    { //Get oldSectionID
                        var setOrf={};
                        var setPre={};
                        _.each(idarray, function(currentID, i) 
                        {
                            getAttrs(['repeating_armeDist_' + currentID + '_orfevrerie'], function(v) 
                            {
                                if(v['repeating_armeDist_' + currentID + '_orfevrerie'] == "{{orfevrerie=[[@{dexterite}+@{dextOD}]]}}")
                                {
                                    setOrf['repeating_armeDist_' + currentID + '_orfevrerie'] = "{{orfevrerie=[[@{dexterite}+@{dextOD}]]}} {{orfevrerieWarrior=[[@{dexterite}+@{dextOD}+@{warriorScoutA}]]}}";
                                    setAttrs(setOrf); //Update
                                }
                            });
                            
                            getAttrs(['repeating_armeDist_' + currentID + '_precision'], function(v) 
                            {
                                if(v['repeating_armeDist_' + currentID + '_precision'] == "{{precision=[[@{tir}+@{tirOD}]]}}")
                                {
                                    setPre['repeating_armeDist_' + currentID + '_precision'] = "{{precision=[[@{tir}+@{tirOD}]]}} {{precisionWarrior=[[@{tir}+@{tirOD}+@{warriorScholarA}]]}}";
                                    setAttrs(setPre); //Update
                                }
                            });
                        });
                    });
                    
                    getSectionIDs("repeating_armeCaC", function(idarray) 
                    { 
                        //Get oldSectionID
                        var setOrf={};
                        var setPre={};
                        _.each(idarray, function(currentID, i) 
                        {
                            getAttrs(['repeating_armeCaC_' + currentID + '_orfevrerie'], function(v) 
                            {
                                if(v['repeating_armeCaC_' + currentID + '_orfevrerie'] == "{{orfevrerie=[[@{dexterite}+@{dextOD}]]}}")
                                {
                                    setOrf['repeating_armeCaC_' + currentID + '_orfevrerie'] = "{{orfevrerie=[[@{dexterite}+@{dextOD}]]}} {{orfevrerieWarrior=[[@{dexterite}+@{dextOD}+@{warriorScoutA}]]}}";
                                    setAttrs(setOrf); //Update
                                }
                            });
                            
                            getAttrs(['repeating_armeCaC_' + currentID + '_precision'], function(v) 
                            {
                                if(v['repeating_armeCaC_' + currentID + '_precision'] == "{{precision=[[@{tir}+@{tirOD}]]}}")
                                {
                                    setPre['repeating_armeCaC_' + currentID + '_precision'] = "{{precision=[[@{tir}+@{tirOD}]]}} {{precisionWarrior=[[@{tir}+@{tirOD}+@{warriorScholarA}]]}}";
                                    setAttrs(setPre); //Update
                                }
                            });
                            
                            getAttrs(['repeating_armeCaC_' + currentID + '_sournoise'], function(v) 
                            {
                                if(v['repeating_armeCaC_' + currentID + '_sournoise'] == "{{orfevrerie=[[@{dexterite}+@{dextOD}]]}} {{ASSournoiseL=Sournoise (Orfevrerie)}}")
                                {
                                    setPre['repeating_armeCaC_' + currentID + '_sournoise'] = "{{orfevrerie=[[@{dexterite}+@{dextOD}]]}} {{orfevrerieWarrior=[[@{dexterite}+@{dextOD}+@{warriorScoutA}]]}} {{ASSournoiseL=Sournoise (Orfevrerie)}}";
                                    setAttrs(setPre); //Update
                                }
                            });
                            
                            getAttrs(['repeating_armeCaC_' + currentID + '_surmesure'], function(v) 
                            {
                                if(v['repeating_armeCaC_' + currentID + '_surmesure'] == "{{ASSurMesureD=[[@{combat}+@{combOD}]]}} {{ASSurMesureWOD=[[@{combat}]]}} {{ASSurMesureL=Sur Mesure}}")
                                {
                                    setPre['repeating_armeCaC_' + currentID + '_surmesure'] = "{{ASSurMesureD=[[@{combat}+@{combOD}]]}} {{ASSurMesureDWarrior=[[@{combat}+@{combOD}+@{warriorHunterA}]]}} {{ASSurMesureWOD=[[@{combat}]]}} {{ASSurMesureL=Sur Mesure}}";
                                    setAttrs(setPre); //Update
                                }
                            });
                        });
                    });
                
                    versioning += 1;
                }
                
                if(MAJW2 == 1 || version > 8)
                    versioning += 1;
                else
                {
                    getAttrs(["discrOD", "dextOD", "percOD", "armure", "warriorScoutA", "warrior250PG"], function(values)
                    {
                        var armure = values.armure;
                        var mode = values.warriorScoutA;
                        var W250PG = values.warrior250PG;
                        var nBonus = 0;
                                
                        if(armure == "warrior")
                        {
                            if(mode != "0")
                            {
                                nBonus += 1;
                                if(W250PG != "0")
                                {
                                    nBonus += 1;
                                }
                            }
                        }
                        
                        setAttrs({
                                calODDis: Number(values.discrOD)+nBonus,
                                calODDex: Number(values.dextOD)+nBonus,
                                calODPer: Number(values.percOD)+nBonus
                            });
                    });
                    
                    getAttrs(["auraOD", "paroleOD", "sfOD", "armure", "warriorHeraldA", "warrior250PG"], function(values)
                    {
                        var armure = values.armure;
                        var mode = values.warriorHeraldA;
                        var W250PG = values.warrior250PG;
                        var nBonus = 0;
                                
                        if(armure == "warrior")
                        {
                            if(mode != "0")
                            {
                                nBonus += 1;
                                
                                if(W250PG != "0")
                                {
                                    nBonus += 1;
                                }
                            }
                        }
                        
                        setAttrs({
                                calODAur: Number(values.auraOD)+nBonus,
                                calODPar: Number(values.paroleOD)+nBonus,
                                calODSFR: Number(values.sfOD)+nBonus
                            });
                    });
                    
                    getAttrs(["tirOD", "savoirOD", "technOD", "armure", "warriorScholarA", "warrior250PG"], function(values)
                    {
                        var armure = values.armure;
                        var mode = values.warriorScholarA;
                        var W250PG = values.warrior250PG;
                        var nBonus = 0;
                                
                        if(armure == "warrior")
                        {
                            if(mode != "0")
                            {
                                nBonus += 1;
                                if(W250PG != "0")
                                {
                                    nBonus += 1;
                                }
                            }
                        }
                        
                        setAttrs({
                                calODTir: Number(values.tirOD)+nBonus,
                                calODSav: Number(values.savoirOD)+nBonus,
                                calODTec: Number(values.technOD)+nBonus
                            });
                    });
                    
                    getAttrs(["hargneOD", "combOD", "instOD", "armure", "warriorHunterA", "warrior250PG"], function(values)
                    {
                        var armure = values.armure;
                        var mode = values.warriorHunterA;
                        var W250PG = values.warrior250PG;
                        var nBonus = 0;
                                
                        if(armure == "warrior")
                        {
                            if(mode != "0")
                            {
                                nBonus += 1;
                                if(W250PG != "0")
                                {
                                    nBonus += 1;
                                }
                            }
                        }
                        
                        setAttrs({
                                calODHar: Number(values.hargneOD)+nBonus,
                                calODCom: Number(values.combOD)+nBonus,
                                calODIns: Number(values.instOD)+nBonus
                            });
                    });
                            
                    getAttrs(["deplOD", "forOD", "endOD", "armure", "warriorSoldierA", "warrior250PG"], function(values)
                    {
                        var armure = values.armure;
                        var mode = values.warriorSoldierA;
                        var W250PG = values.warrior250PG;
                        var nBonus = 0;
                                
                        if(armure == "warrior")
                        {
                            if(mode != "0")
                            {
                                nBonus += 1;
                                if(W250PG != "0")
                                {
                                    nBonus += 1;
                                }
                            }
                        }
                        
                        setAttrs({
                                calODDep: Number(values.deplOD)+nBonus,
                                calODFor: Number(values.forOD)+nBonus,
                                calODEnd: Number(values.endOD)+nBonus
                            });
                    });
                
                    versioning += 1;
                }
                
                if(MAJNS == 1 || version > 9)
                    versioning += 1;
                else
                {
                    getAttrs(["calODIns"], function(value)
                    {
                        var PJINS = value.calODIns;

                        if(PJINS >= 3)
                        {
                            setAttrs({
                                    initiativeODBonus:(3*PJINS)
                            });
                        }
                        else
                        {
                            setAttrs({
                                    initiativeODBonus:0
                            });
                        }
                    });
                
                    versioning += 1;
                }
                
                if(MAJL1 == 1 || version > 10)
                    versioning += 1;
                else
                {
                    getSectionIDs("repeating_armeAutre", function (ids) 
                    {
                        _.each(ids,function(id) 
                        {
                            getAttrs(["repeating_armeAutre_"+id+"_chambreDouble"], function (v) 
                            {
                                var CD = v["repeating_armeAutre_"+id+"_chambreDouble"];
                                
                                if(CD == "?{Chambre Double|Cadence, 1|Dégâts, 2|Violence, 3}")
                                {
                                    setAttrs({["repeating_armeAutre_"+id+"_chambreDouble"]: "[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]"});
                                }
                                
                            });
                        });
                    });
                    
                    getSectionIDs("repeating_armeDist", function (ids) 
                    {
                        _.each(ids,function(id) 
                        {
                            getAttrs(["repeating_armeDist_"+id+"_chambreDouble"], function (v) 
                            {
                                var CD = v["repeating_armeDist_"+id+"_chambreDouble"];
                                
                                if(CD == "?{Chambre Double|Cadence, 1|Dégâts, 2|Violence, 3}")
                                {
                                    setAttrs({["repeating_armeDist_"+id+"_chambreDouble"]: "[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]"});
                                }
                            });
                        });
                    });
                    
                    getSectionIDs("repeating_armeDruidLion", function (ids) 
                    {
                        _.each(ids,function(id) 
                        {
                            getAttrs(["repeating_armeDruidLion_"+id+"_chambreDouble"], function (v) 
                            {
                                var CD = v["repeating_armeDruidLion_"+id+"_chambreDouble"];
                                
                                if(CD == "?{Chambre Double|Cadence, 1|Dégâts, 2|Violence, 3}")
                                {
                                    setAttrs({["repeating_armeDruidLion_"+id+"_chambreDouble"]: "[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]"});
                                }
                            });
                        });
                    });
                
                    versioning += 1;
                }
                
                if(MAJL2 == 1 || version > 11)
                    versioning += 1;
                else
                {
                    getSectionIDs("repeating_armeAutre", function (ids) 
                    {
                        _.each(ids,function(id) 
                        {
                            getAttrs([
                            "repeating_armeAutre_"+id+"_interfaceGuidage", 
                            "repeating_armeAutre_"+id+"_tirSecurite", 
                            "repeating_armeAutre_"+id+"_akimbo",
                            "repeating_armeAutre_"+id+"_ambidextrie"], function (v) 
                            {
                                var IG = v["repeating_armeAutre_"+id+"_interfaceGuidage"];
                                var TS = v["repeating_armeAutre_"+id+"_tirSecurite"];
                                var Ak = v["repeating_armeAutre_"+id+"_akimbo"];
                                var Am = v["repeating_armeAutre_"+id+"_ambidextrie"];
                                
                                if(IG == "{{Interface de guidage (Tir en Sécurité)}}")
                                {
                                    setAttrs({["repeating_armeAutre_"+id+"_interfaceGuidage"]: "3"});
                                }
                                
                                if(TS == "{{tirSecurite=[[{3d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}")
                                {
                                    setAttrs({["repeating_armeAutre_"+id+"_tirSecurite"]: "3"});
                                }

                                if(Ak == "{{effetAkimbo=[[{2d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}")
                                {
                                    setAttrs({["repeating_armeAutre_"+id+"_akimbo"]: "2"});
                                }
                                
                                if(Am == "{{effetAmbidextrie=[[{2d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}")
                                {
                                    setAttrs({["repeating_armeAutre_"+id+"_ambidextrie"]: "2"});
                                }
                            });
                            
                        });
                    });
                    
                    getSectionIDs("repeating_armeDist", function (ids) 
                    {
                        _.each(ids,function(id) 
                        {
                            getAttrs([
                            "repeating_armeDist_"+id+"_interfaceGuidage",
                            "repeating_armeDist_"+id+"_tirSecurite",
                            "repeating_armeDist_"+id+"_akimbo",
                            "repeating_armeDist_"+id+"_ambidextrie"], function (v) 
                            {
                                var IG = v["repeating_armeDist_"+id+"_interfaceGuidage"];
                                var TS = v["repeating_armeDist_"+id+"_tirSecurite"];
                                var Ak = v["repeating_armeDist_"+id+"_akimbo"];
                                var Am = v["repeating_armeDist_"+id+"_ambidextrie"];
                                
                                if(IG == "{{Interface de guidage (Tir en Sécurité)}}")
                                {
                                    setAttrs({["repeating_armeDist_"+id+"_interfaceGuidage"]: "3"});
                                }
                                
                                if(TS == "{{tirSecurite=[[{3d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}")
                                {
                                    setAttrs({["repeating_armeDist_"+id+"_tirSecurite"]: "3"});
                                }
                                
                                if(Ak == "{{effetAkimbo=[[{2d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}")
                                {
                                    setAttrs({["repeating_armeDist_"+id+"_akimbo"]: "2"});
                                }
                                
                                if(Am == "{{effetAmbidextrie=[[{2d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}")
                                {
                                    setAttrs({["repeating_armeDist_"+id+"_ambidextrie"]: "2"});
                                }
                            });
                        });
                    });
                    
                    getSectionIDs("repeating_armeCaC", function (ids) 
                    {
                        _.each(ids,function(id) 
                        {						
                            getAttrs([
                            "repeating_armeCaC_"+id+"_tirSecurite",
                            "repeating_armeCaC_"+id+"_akimbo",
                            "repeating_armeCaC_"+id+"_ambidextrie",
                            "repeating_armeCaC_"+id+"_jumelle",
                            "repeating_armeCaC_"+id+"_soeur",
                            "repeating_armeCaC_"+id+"_protectrice"], function (v) 
                            {
                                var TS = v["repeating_armeCaC_"+id+"_tirSecurite"];
                                var Ak = v["repeating_armeCaC_"+id+"_akimbo"];
                                var Am = v["repeating_armeCaC_"+id+"_ambidextrie"];
                                var Ju = v["repeating_armeCaC_"+id+"_jumelle"];
                                var So = v["repeating_armeCaC_"+id+"_soeur"];
                                var Pr = v["repeating_armeCaC_"+id+"_protectrice"];
                                
                                if(Ak == "{{effetAkimbo=[[{2d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}")
                                {
                                    setAttrs({["repeating_armeCaC_"+id+"_akimbo"]: "2"});
                                }

                                if(Am == "{{effetAmbidextrie=[[{2d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}")
                                {
                                    setAttrs({["repeating_armeCaC_"+id+"_ambidextrie"]: "2"});
                                }
                                
                                if(TS == "{{tirSecurite=[[{3d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}")
                                {
                                    setAttrs({["repeating_armeCaC_"+id+"_tirSecurite"]: "3"});
                                }
                                
                                if(Ju == "{{effetAkimbo=[[{2d6cs2cs4cs6cf1cf3cf5s%2}=0]]}} {{ASJumelleL=Jumelle (Jumelée - Akimbo)}}")
                                {
                                    setAttrs({["repeating_armeCaC_"+id+"_jumelle"]: "2"});
                                }
                                
                                if(So == "{{effetAmbidextrie=[[{2d6cs2cs4cs6cf1cf3cf5s%2}=0]]}} {{ASSoeurL=Soeur (Jumelée - Ambidextrie)}}")
                                {
                                    setAttrs({["repeating_armeCaC_"+id+"_soeur"]: "2"});
                                }
                                
                                if(Pr == "{{ASProtectrice=[[{2d6cs2cs4cs6cf1cf3cf5s%2}=0]]}} {{ASProtectriceL=Protectrice}}")
                                {
                                    setAttrs({["repeating_armeCaC_"+id+"_protectrice"]: "2"});
                                }
                                
                            });
                        });
                    });
                    
                    getSectionIDs("repeating_armeDruidLion", function (ids) 
                    {
                        _.each(ids,function(id) 
                        {
                            getAttrs([
                            "repeating_armeDruidLion_"+id+"_interfaceGuidage",
                            "repeating_armeDruidLion_"+id+"_tirSecurite",
                            "repeating_armeDruidLion_"+id+"_akimbo",
                            "repeating_armeDruidLion_"+id+"_ambidextrie"], function (v) 
                            {
                                var IG = v["repeating_armeDruidLion_"+id+"_interfaceGuidage"];
                                var TS = v["repeating_armeDruidLion_"+id+"_tirSecurite"];
                                var Ak = v["repeating_armeDruidLion_"+id+"_akimbo"];
                                var Am = v["repeating_armeDruidLion_"+id+"_ambidextrie"];
                                
                                if(IG == "{{Interface de guidage (Tir en Sécurité)}}")
                                {
                                    setAttrs({["repeating_armeDruidLion_"+id+"_interfaceGuidage"]: "3"});
                                }

                                if(TS == "{{tirSecurite=[[{3d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}")
                                {
                                    setAttrs({["repeating_armeDruidLion_"+id+"_tirSecurite"]: "3"});
                                }

                                if(Ak == "{{effetAkimbo=[[{2d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}")
                                {
                                    setAttrs({["repeating_armeDruidLion_"+id+"_akimbo"]: "2"});
                                }

                                if(Am == "{{effetAmbidextrie=[[{2d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}")
                                {
                                    setAttrs({["repeating_armeDruidLion_"+id+"_ambidextrie"]: "2"});
                                }
                            });
                        });
                    });
                
                    versioning += 1;
                }
                
                if(MAJL3 == 1 || version > 12)
                    versioning += 1;
                else
                {
                    getAttrs(["warmaster250PG"], function(value)
                    {
                        var PJWM = value.warmaster250PG;

                        if(PJWM == "on")
                        {
                            setAttrs({
                                    warmaster250PG:10
                            });
                        }
                        
                    });
                
                    versioning += 1;
                }
                
                if(MAJBF == 1 || version > 13)
                    versioning += 1;
                else
                {
                    getSectionIDs("repeating_armeDruidLion", function (ids) 
                    {
                        _.each(ids,function(id) 
                        {
                            getAttrs(["repeating_armeDruidLion_"+id+"_leste"], function (v) 
                            {
                                var LL = v["repeating_armeDruidLion_"+id+"_leste"];
                                
                                if(LL == "{{leste=[[@{force}]]}}")
                                {
                                    setAttrs({["repeating_armeDruidLion_"+id+"_leste"]: "{{leste=[[@{druidLionChairTot}]]}}"});
                                }
                            });
                            
                        });
                    });
            
                    versioning += 1;
                }
            
                var newSheet = 0;
            
                getSectionIDs("repeating_slotsTete", function(idarray1) 
                {
                    if(idarray1.length == 0)
                        newSheet += 1;
                        
                    getSectionIDs("repeating_slotsTorse", function(idarray2) 
                    {
                        if(idarray2.length == 0)
                            newSheet += 1;
                            
                        getSectionIDs("repeating_slotsBG", function(idarray3) 
                        {
                            if(idarray3.length == 0)
                                newSheet += 1;
                                
                            getSectionIDs("repeating_slotsBD", function(idarray4) 
                            {
                                if(idarray4.length == 0)
                                    newSheet += 1;
                                    
                                getSectionIDs("repeating_slotsJG", function(idarray5) 
                                {
                                    if(idarray5.length == 0)
                                        newSheet += 1;
                                        
                                    getSectionIDs("repeating_slotsJD", function(idarray6) 
                                    {
                                        if(idarray6.length == 0)
                                            newSheet += 1;
                                        
                                        getSectionIDs("repeating_slotsDCLTete", function(idarray7) 
                                        {
                                            if(idarray7.length == 0)
                                            newSheet += 1;
                                            
                                            getSectionIDs("repeating_slotsDCLTorse", function(idarray8) 
                                            {		
                                                if(idarray8.length == 0)
                                                newSheet += 1;
                                                
                                                getSectionIDs("repeating_slotsDCLBG", function(idarray9) 
                                                {		
                                                    if(idarray9.length == 0)
                                                    newSheet += 1;
                                                    
                                                    getSectionIDs("repeating_slotsDCLBD", function(idarray10) 
                                                    {		
                                                        if(idarray10.length == 0)
                                                        newSheet += 1;
                                                        
                                                        getSectionIDs("repeating_slotsDCLJG", function(idarray11) 
                                                        {		
                                                            if(idarray11.length == 0)
                                                            newSheet += 1;
                                                            
                                                            getSectionIDs("repeating_slotsDCLJD", function(idarray12) 
                                                            {		
                                                                if(idarray12.length == 0)
                                                                newSheet += 1;
                                                                
                                                                if(newSheet == 12)
                                                                {
                                                                    versioning += 1;
                                                                }
                                                                
                                                                setAttrs({
                                                                    version: versioning
                                                                });
                                                            });
                                                        });
                                                    });
                                                });
                                            });
                                        });
                                    });
                                });
                            });
                        });
                    });
                });
            });
        }
    
        if(version < 16)
        {
            setAttrs({["pSDistPortee"]: "^{portee-moyenne}"});
            setAttrs({["mEDistPortee"]: "^{portee-courte}"});
            setAttrs({["pSCaCPortee"]: "^{portee-contact}"});
            setAttrs({["mECaCPortee"]: "^{portee-contact}"});
            setAttrs({["druidLionBasePortee"]: "^{portee-contact}"});
            
            var majDistance = ["repeating_armeDruidLion", "repeating_armeCaC", "repeating_armeDist", "repeating_armeAutre", "repeating_armeDistVehicule"];

            _.each(majDistance,function(listDistance) 
            {
                getSectionIDs(listDistance, function(idarray) 
                {
                    _.each(idarray,function(id) 
                    {
                        getAttrs([listDistance+"_"+id+"_armeCaCPortee", listDistance+"_"+id+"_armeDistPortee", listDistance+"_"+id+"_armeAutrePortee", listDistance+"_"+id+"_porteeDruidLion", listDistance+"_"+id+"_"+"barrage", listDistance+"_"+id+"_"+"chargeur", listDistance+"_"+id+"_"+"choc", listDistance+"_"+id+"_"+"defense", listDistance+"_"+id+"_"+"degatContinue", listDistance+"_"+id+"_"+"dispersion", listDistance+"_"+id+"_"+"lumiere", listDistance+"_"+id+"_"+"perceArmure", listDistance+"_"+id+"_"+"parasitage", listDistance+"_"+id+"_"+"penetrant", listDistance+"_"+id+"_"+"reaction", listDistance+"_"+id+"_"+"jumelage", listDistance+"_"+id+"_"+"lourd"], function (v) 
                        {
                            var barrage = v[listDistance+"_"+id+"_"+"barrage"];
                            var chargeur = v[listDistance+"_"+id+"_"+"chargeur"];
                            var choc = v[listDistance+"_"+id+"_"+"choc"];
                            var defense = v[listDistance+"_"+id+"_"+"defense"];
                            var degatContinue = v[listDistance+"_"+id+"_"+"degatContinue"];
                            var dispersion = v[listDistance+"_"+id+"_"+"dispersion"];
                            var lumiere = v[listDistance+"_"+id+"_"+"lumiere"];
                            var parasitage = v[listDistance+"_"+id+"_"+"parasitage"];
                            var pa = v[listDistance+"_"+id+"_"+"perceArmure"];
                            var penetrant = v[listDistance+"_"+id+"_"+"penetrant"];
                            var reaction = v[listDistance+"_"+id+"_"+"reaction"];
                            var jumelage = v[listDistance+"_"+id+"_"+"jumelage"];
                            var lourd = v[listDistance+"_"+id+"_"+"lourd"];
                            
                            if(barrage == "{{barrage=Barrage @{barrageValue}}} ")
                                setAttrs({[listDistance+"_"+id+"_"+"barrage"]: "{{barrage=^{barrage} @{barrageValue}}} "});
                                
                            if(chargeur == "{{chargeur=Chargeur @{chargeurValue}}} ")
                                setAttrs({[listDistance+"_"+id+"_"+"chargeur"]: "{{chargeur=^{chargeur} @{chargeurValue}}} "});
                                
                            if(choc == "{{choc=Choc @{chocValue}}}")
                                setAttrs({[listDistance+"_"+id+"_"+"choc"]: "{{choc=^{choc} @{chocValue}}}"});
                                
                            if(defense == "{{defense=Défense @{defenseValue}}}")
                                setAttrs({[listDistance+"_"+id+"_"+"defense"]: "{{defense=^{defense} @{defenseValue}}}"});
                                
                            if(degatContinue == "{{degatContinus=Dégâts Continus @{degatContinueValue} ([[1D6]] ^{tours})}}")
                                setAttrs({[listDistance+"_"+id+"_"+"degatContinue"]: "{{degatContinus=^{degats-continus} @{degatContinueValue} ([[1D6]] ^{tours})}}"});
                                
                            if(dispersion == "{{dispersion=Dispersion @{dispersionValue}}} ")
                                setAttrs({[listDistance+"_"+id+"_"+"dispersion"]: "{{dispersion=^{dispersion} @{dispersionValue}}} "});
                                
                            if(lumiere == "{{lumiere=Lumière @{lumiereValue}}}")
                                setAttrs({[listDistance+"_"+id+"_"+"lumiere"]: "{{lumiere=^{lumiere} @{lumiereValue}}}"});
                                
                            if(parasitage == "{{parasitage=Parasitage @{parasitageValue}}}")
                                setAttrs({[listDistance+"_"+id+"_"+"parasitage"]: "{{parasitage=^{parasitage} @{parasitageValue}}}"});
                                
                            if(penetrant == "{{penetrant=Pénétrant @{penetrantValue}}}")
                                setAttrs({[listDistance+"_"+id+"_"+"penetrant"]: "{{penetrant=^{penetrant} @{penetrantValue}}}"});
                                
                            if(pa == "{{perceArmure=Perce Armure @{perceArmureValue}}}")
                                setAttrs({[listDistance+"_"+id+"_"+"perceArmure"]: "{{perceArmure=^{perce-armure} @{perceArmureValue}}}"});
                                
                            if(reaction == "{{reaction=Réaction @{reactionValue}}}")
                                setAttrs({[listDistance+"_"+id+"_"+"reaction"]: "{{reaction=^{reaction} @{reactionValue}}}"});
                                
                            if(jumelage == "{{jumelage=Jumelage (@{jumelageValue})}}")
                                setAttrs({[listDistance+"_"+id+"_"+"jumelage"]: "{{jumelage=^{jumelage} (@{jumelageValue})}}"});
                                
                            if(lourd == "{{lourd=Lourd}}")
                                setAttrs({[listDistance+"_"+id+"_"+"lourd"]: "1"});
                                
                            var porteeAutre = v[listDistance+"_"+id+"_armeAutrePortee"];
                            
                            if(porteeAutre == "Contact")
                            {
                                setAttrs({[listDistance+"_"+id+"_armeAutrePortee"]: "^{portee-contact}"});
                            }
                            
                            if(porteeAutre == "Courte")
                            {
                                setAttrs({[listDistance+"_"+id+"_armeAutrePortee"]: "^{portee-courte}"});
                            }
                            
                            if(porteeAutre == "Moyenne")
                            {
                                setAttrs({[listDistance+"_"+id+"_armeAutrePortee"]: "^{portee-moyenne}"});
                            }
                            
                            if(porteeAutre == "Longue")
                            {
                                setAttrs({[listDistance+"_"+id+"_armeAutrePortee"]: "^{portee-longue}"});
                            }
                            
                            if(porteeAutre == "Lointaine")
                            {
                                setAttrs({[listDistance+"_"+id+"_armeAutrePortee"]: "^{portee-lointaine}"});
                            }	
                            
                            var porteeCaC = v[listDistance+"_"+id+"_armeCaCPortee"];
                            
                            if(porteeCaC == "Contact")
                            {
                                setAttrs({[listDistance+"_"+id+"_armeCaCPortee"]: "^{portee-contact}"});
                            }
                            
                            if(porteeCaC == "Courte")
                            {
                                setAttrs({[listDistance+"_"+id+"_armeCaCPortee"]: "^{portee-courte}"});
                            }
                            
                            if(porteeCaC == "Moyenne")
                            {
                                setAttrs({[listDistance+"_"+id+"_armeCaCPortee"]: "^{portee-moyenne}"});
                            }
                            
                            if(porteeCaC == "Longue")
                            {
                                setAttrs({[listDistance+"_"+id+"_armeCaCPortee"]: "^{portee-longue}"});
                            }
                            
                            if(porteeCaC == "Lointaine")
                            {
                                setAttrs({[listDistance+"_"+id+"_armeCaCPortee"]: "^{portee-lointaine}"});
                            }
                            
                            var portee = v[listDistance+"_"+id+"_armeDistPortee"];
                            
                            if(portee == "Contact")
                            {
                                setAttrs({[listDistance+"_"+id+"_armeDistPortee"]: "^{portee-contact}"});
                            }
                            
                            if(portee == "Courte")
                            {
                                setAttrs({[listDistance+"_"+id+"_armeDistPortee"]: "^{portee-courte}"});
                            }
                            
                            if(portee == "Moyenne")
                            {
                                setAttrs({[listDistance+"_"+id+"_armeDistPortee"]: "^{portee-moyenne}"});
                            }
                            
                            if(portee == "Longue")
                            {
                                setAttrs({[listDistance+"_"+id+"_armeDistPortee"]: "^{portee-longue}"});
                            }
                            
                            if(portee == "Lointaine")
                            {
                                setAttrs({[listDistance+"_"+id+"_armeDistPortee"]: "^{portee-lointaine}"});
                            }
                            
                            var pDruid = v[listDistance+"_"+id+"_porteeDruidLion"];
                            
                            if(pDruid == "Contact")
                            {
                                setAttrs({[listDistance+"_"+id+"_porteeDruidLion"]: "^{portee-contact}"});
                            }
                            
                            if(pDruid == "Courte")
                            {
                                setAttrs({[listDistance+"_"+id+"_porteeDruidLion"]: "^{portee-courte}"});
                            }
                            
                            if(pDruid == "Moyenne")
                            {
                                setAttrs({[listDistance+"_"+id+"_porteeDruidLion"]: "^{portee-moyenne}"});
                            }
                            
                            if(pDruid == "Longue")
                            {
                                setAttrs({[listDistance+"_"+id+"_porteeDruidLion"]: "^{portee-longue}"});
                            }
                            
                            if(pDruid == "Lointaine")
                            {
                                setAttrs({[listDistance+"_"+id+"_porteeDruidLion"]: "^{portee-lointaine}"});
                            }
                        });
                        
                    });
                });
            });
            
            var majSimple = ["pS", "pSC", "mE","mEC"];
            
            _.each(majSimple,function(listDistanceSimple) 
            {
                getAttrs([listDistanceSimple+"barrage", listDistanceSimple+"chargeur", listDistanceSimple+"choc", listDistanceSimple+"defense", listDistanceSimple+"degatContinue", listDistanceSimple+"dispersion", listDistanceSimple+"lumiere", listDistanceSimple+"parasitage", listDistanceSimple+"penetrant", listDistanceSimple+"perceArmure", listDistanceSimple+"reaction", listDistanceSimple+"jumelage", listDistanceSimple+"lourd"], function (v) 
                {													
                    var barrage = v[listDistanceSimple+"barrage"];
                    var chargeur = v[listDistanceSimple+"chargeur"];
                    var choc = v[listDistanceSimple+"choc"];
                    var defense = v[listDistanceSimple+"defense"];
                    var degatContinue = v[listDistanceSimple+"degatContinue"];
                    var dispersion = v[listDistanceSimple+"dispersion"];
                    var lumiere = v[listDistanceSimple+"lumiere"];
                    var parasitage = v[listDistanceSimple+"parasitage"];
                    var penetrant = v[listDistanceSimple+"penetrant"];
                    var pa = v[listDistanceSimple+"perceArmure"];
                    var reaction = v[listDistanceSimple+"reaction"];
                    var jumelage = v[listDistanceSimple+"jumelage"];
                    var lourd = v[listDistanceSimple+"lourd"];
                    
                    if(barrage == "{{barrage=Barrage @{"+listDistanceSimple+"barrageValue}}} ")
                        setAttrs({[listDistanceSimple+"barrage"]: "{{barrage=^{barrage} @{"+listDistanceSimple+"barrageValue}}} "});
                        
                    if(chargeur == "{{chargeur=Chargeur @{"+listDistanceSimple+"chargeurValue}}} ")
                        setAttrs({[listDistanceSimple+"chargeur"]: "{{chargeur=^{chargeur} @{"+listDistanceSimple+"chargeurValue}}} "});
                        
                    if(choc == "{{choc=Choc @{"+listDistanceSimple+"chocValue}}}")
                        setAttrs({[listDistanceSimple+"choc"]: "{{choc=^{choc} @{"+listDistanceSimple+"chocValue}}}"});
                        
                    if(defense == "{{defense=Défense @{"+listDistanceSimple+"defenseValue}}}")
                        setAttrs({[listDistanceSimple+"defense"]: "{{defense=^{defense} @{"+listDistanceSimple+"defenseValue}}}"});
                        
                    if(degatContinue == "{{degatContinus=Dégâts Continus @{"+listDistanceSimple+"degatContinueValue} ([[1D6]] Tours)}}")
                        setAttrs({[listDistanceSimple+"degatContinue"]: "{{degatContinus=^{degats-continus} @{"+listDistanceSimple+"degatContinueValue} ([[1D6]] ^{tours})}}"});
                        
                    if(dispersion == "{{dispersion=Dispersion @{"+listDistanceSimple+"dispersionValue}}} ")
                        setAttrs({[listDistanceSimple+"dispersion"]: "{{dispersion=^{dispersion} @{"+listDistanceSimple+"dispersionValue}}} "});
                        
                    if(lumiere == "{{lumiere=Lumière @{"+listDistanceSimple+"lumiereValue}}}")
                        setAttrs({[listDistanceSimple+"lumiere"]: "{{lumiere=^{lumiere} @{"+listDistanceSimple+"lumiereValue}}}"});
                        
                    if(parasitage == "{{parasitage=Parasitage @{"+listDistanceSimple+"parasitageValue}}}")
                        setAttrs({[listDistanceSimple+"parasitage"]: "{{parasitage=^{parasitage} @{"+listDistanceSimple+"parasitageValue}}}"});
                        
                    if(penetrant == "{{penetrant=Pénétrant @{"+listDistanceSimple+"penetrantValue}}}")
                        setAttrs({[listDistanceSimple+"penetrant"]: "{{penetrant=^{penetrant} @{"+listDistanceSimple+"penetrantValue}}}"});
                        
                    if(pa == "{{perceArmure=Perce Armure @{"+listDistanceSimple+"perceArmureValue}}}")
                        setAttrs({[listDistanceSimple+"perceArmure"]: "{{perceArmure=^{perce-armure} @{"+listDistanceSimple+"perceArmureValue}}}"});
                        
                    if(reaction == "{{reaction=Réaction @{"+listDistanceSimple+"reactionValue}}}")
                        setAttrs({[listDistanceSimple+"reaction"]: "{{reaction=^{reaction} @{"+listDistanceSimple+"reactionValue}}}"});
                        
                    if(jumelage == "{{jumelage=Jumelage (@{"+listDistanceSimple+"jumelageValue})}}")
                        setAttrs({[listDistanceSimple+"jumelage"]: "{{jumelage=^{jumelage} (@{"+listDistanceSimple+"jumelageValue})}}"});
                        
                    if(lourd == "{{lourd=Lourd}}")
                        setAttrs({[listDistanceSimple+"lourd"]: "1"});
                });
            });
        
            getAttrs(["rangerArmePortee", "rangerChoc", "rangerDegatContinue", "rangerPerceArmure", "rangerDispersion", "rangerLumiere", "rangerPenetrant", "rangerPerceArmure60", "rangerPenetrant10", "rangerPenetrant10", "ranger50PG3"], function (v) 
            {							
                var rangerChoc = v["rangerChoc"];
                var degatsContinus = v["rangerDegatContinue"];
                var pa = v["rangerPerceArmure"];
                var dispersion = v["rangerDispersion"];
                var lumiere = v["rangerLumiere"];
                var penetrant = v["rangerPenetrant"];
                var pa60 = v["rangerPerceArmure60"];
                var penetrant10 = v["rangerPenetrant10"];
                var PG = v["ranger50PG3"];
                
                if(rangerChoc == "{{choc=Choc @{rangerChocValue}}}")
                    setAttrs({["rangerChoc"]: "{{choc=^{choc} @{rangerChocValue}}}"});
                
                if(degatsContinus == "{{degatContinus=Dégâts Continus @{rangerDegatContinueValue} ([[1D6]] ^{tours})}}")
                    setAttrs({["rangerDegatContinue"]: "{{degatContinus=^{degats-continus} @{rangerDegatContinueValue} ([[1D6]] ^{tours})}}"});
                
                if(pa == "{{perceArmure=Perce Armure @{rangerPerceArmureValue}}}")
                    setAttrs({["rangerPerceArmure"]: "{{perceArmure=^{perce-armure} @{rangerPerceArmureValue}}}"});
                    
                if(dispersion == "{{dispersion=Dispersion @{rangerDispersionValue}}}")
                    setAttrs({["rangerDispersion"]: "{{dispersion=^{dispersion} @{rangerDispersionValue}}}"});
                    
                if(lumiere == "{{lumiere=Lumière @{rangerLumiereValue}}}")
                    setAttrs({["rangerLumiere"]: "{{lumiere=^{lumiere} @{rangerLumiereValue}}}"});
                    
                if(penetrant == "{{penetrant=Pénétrant @{rangerPenetrantValue}}}")
                    setAttrs({["rangerPenetrant"]: "{{penetrant=^{penetrant} @{rangerPenetrantValue}}}"});
                    
                if(pa60 == "{{perceArmure=Perce Armure @{rangerPerceArmure60Value}}}")
                    setAttrs({["rangerPerceArmure60"]: "{{perceArmure=^{perce-armure} @{rangerPerceArmure60Value}}}"});
                    
                if(penetrant10 == "{{penetrant=Pénétrant @{rangerPenetrant10Value}}}")
                    setAttrs({["rangerPenetrant10"]: "{{penetrant=^{penetrant} @{rangerPenetrant10Value}}}"});
                    
                if(PG == "{{rangerEvol=50PG3}}")
                    setAttrs({["ranger50PG3"]: "1"});
                    
                var portee = v["rangerArmePortee"];
                    
                if(portee == "Moyenne")
                {
                    setAttrs({["rangerArmePortee"]: "^{portee-moyenne}"});
                }
                
                if(portee == "Longue")
                {
                    setAttrs({["rangerArmePortee"]: "^{portee-longue}"});
                }
                
                if(portee == "Lointaine")
                {
                    setAttrs({["rangerArmePortee"]: "^{portee-lointaine}"});
                }
            });
        
            setAttrs({["version"]: 16});
        }

        if(version < 17) {
            setAttrs({
                caracteristique1: "0",
                caracteristique2: "0",
                caracteristique3: "0",
                caracteristique4: "0",
                caracteristique1Art: "0",
                caracteristique2Art: "0",
                caracteristique3Art: "0",
                caracteristique4Art: "0",
                caracteristiqueTotem1: "0",
                caracteristiqueTotem2: "0",
                caracteristiqueTotem3: "0",
                MALCaracteristiqueTotem1: "0",
                MALCaracteristiqueTotem2: "0",
                caracteristique1Priest:"@{technique}",
                caracteristique1Psion:"@{aura}",
                aspectDruidLionBase:"druidLionChair",
                MALAspectDruidLionBase:"MALDruidLionChair",
                caracteristique1Monk: "0",
                caracteristique2Monk: "0",
                poingCaCPortee: "^{portee-contact}",
                poingCcaracteristique1Equipement: "0",
                poingCcaracteristique2Equipement: "0",
                poingCcaracteristique3Equipement: "0",
                poingCcaracteristique4Equipement: "0",
                poingMACcaracteristique1Equipement: "0",
                poingMACcaracteristique2Equipement: "0",
                poingMACcaracteristique3Equipement: "0",
                poingMACcaracteristique4Equipement: "0",
                pSCcaracteristique1Equipement: "0",
                pSCcaracteristique2Equipement: "0",
                pSCcaracteristique3Equipement: "0",
                pSCcaracteristique4Equipement: "0",
                pSCcaracteristiqueSPrecis: "0",
                mECcaracteristique1Equipement: "0",
                mECcaracteristique2Equipement: "0",
                mECcaracteristique3Equipement: "0",
                mECcaracteristique4Equipement: "0",
                mECcaracteristiqueSPrecis: "0",
                pScaracteristique1Equipement: "0",
                pScaracteristique2Equipement: "0",
                pScaracteristique3Equipement: "0",
                pScaracteristique4Equipement: "0",
                mEcaracteristique1Equipement: "0",
                mEcaracteristique2Equipement: "0",
                mEcaracteristique3Equipement: "0",
                mEcaracteristique4Equipement: "0",
                utilisationArmeAI:"&{template:combat} {{portee=^{portee-contact}}}",
                utilisationArmeAIPNJ:"&{template:combat} {{portee=^{portee-contact}}}",
                caracteristique1Grenade:"0",
                caracteristique2Grenade:"0",
                caracteristique3Grenade:"0",
                caracteristique4Grenade:"0",
                caracteristique1MA: "0",
                caracteristique2MA: "0",
                caracteristique3MA: "0",
                caracteristique4MA: "0",
                MAUtilisationArmeAI: "&{template:mechaArmure} {{special1=@{mechaArmureNom}}} {{portee=^{portee-contact}}}",
                canonMagmaCaracteristique1:"0",
                canonMagmaCaracteristique2:"0",
                canonMagmaCaracteristique3:"0",
                canonMagmaCaracteristique4:"0",
                MSurturCaracteristique1:"0",
                MSurturCaracteristique2:"0",
                MSurturCaracteristique3:"0",
                MSurturCaracteristique4:"0",
                DSouffleCaracteristique1:"0",
                DSouffleCaracteristique2:"0",
                DSouffleCaracteristique3:"0",
                DSouffleCaracteristique4:"0",
                caracteristiqueWraith1:"0",
                caracteristiqueWraith2:"0",
                caracteristiqueWraith3:"0",
                caracteristiqueWraith4:"0",
                APoingsCaracteristique1:"0",
                APoingsCaracteristique2:"0",
                APoingsCaracteristique3:"0",
                APoingsCaracteristique4:"0",
                LCGCaracteristique1:"0",
                LCGCaracteristique2:"0",
                LCGCaracteristique3:"0",
                LCGCaracteristique4:"0",
                aspectPNJ:"0",
                pSCAspectPNJ:"0",
                mECAspectPNJ:"0",
                pSAspectPNJ:"0",
                mEAspectPNJ:"0",
                aspectPNJGrenade:"0",
                version:17,
            });
        }
    });
});/* eslint-disable prefer-destructuring */
/* eslint-disable default-case */
/* eslint-disable camelcase */
/* eslint-disable max-len */
/* eslint-disable no-undef */
/* eslint-disable no-unused-vars */
const wpnContactData = [
  'ArmeCaC',
  'armeCaCDegat', 'armeCaCBDegat',
  'armeCaCViolence', 'armeCaCBViolence',
  'armeCaCPortee', 'aspectPNJ',
  'caracteristique1Equipement',
  'caracteristique2Equipement',
  'caracteristique3Equipement',
  'caracteristique4Equipement',
  'caracteristiqueSPrecis',
];

const wpnDistanceData = [
  'ArmeDist',
  'armeDistDegat', 'armeDistBDegat',
  'armeDistViolence', 'armeDistBViolence',
  'armeDistPortee', 'aspectPNJ',
  'caracteristique1Equipement',
  'caracteristique2Equipement',
  'caracteristique3Equipement',
  'caracteristique4Equipement',
  'pilonnage',
];

const wpnAutreData = [
  'ArmeAutre',
  'armeAutreDegat', 'armeAutreBDegat',
  'armeAutreViolence', 'armeAutreBViolence',
  'armeAutrePortee',
  'armeAttaqueAutre',
  'armeODAutre',
];

const wpnEffects = [
  'akimbo', 'ambidextrie', 'anatheme', 'antiAnatheme', 'antiVehicule', 'artillerie', 'assassin', 'assistanceAttaque',
  'barrage', 'cadence', 'chargeur', 'choc', 'defense', 'degatContinue', 'deuxMains', 'demoralisant',
  'designation', 'destructeur', 'dispersion', 'enChaine', 'esperance', 'fureur', 'ignoreArmure',
  'ignoreCdF', 'leste', 'lestePNJ', 'lourd', 'lumiere', 'meurtrier', 'obliteration',
  'orfevrerie', 'orfevreriePNJ', 'parasitage', 'penetrant', 'perceArmure', 'precision', 'precisionPNJ', 'reaction', 'silencieux', 'soumission', 'tenebricite',
  'tirRafale', 'tirSecurite', 'ultraViolence',
];

const wpnEffectsValue = [
  'assassinValue', 'barrageValue', 'cadenceValue', 'chargeurValue', 'chocValue',
  'defenseValue', 'degatContinueValue', 'dispersionValue', 'lumiereValue', 'parasitageValue',
  'penetrantValue', 'perceArmureValue', 'reactionValue',
];

const wpnAmeliorationS = [
  'agressive', 'allegee', 'assassine', 'barbelee',
  'connectee', 'electrifiee', 'indestructible', 'jumelle',
  'lumineuse', 'massive', 'protectrice', 'soeur', 'sournoise', 'surmesure',
  'sournoisePNJ', 'surmesurePNJ',
];

const wpnAmeliorationO = [
  'arabesquesIridescentes', 'armeAzurine', 'armeRougeSang', 'armureGravee',
  'blasonChevalier', 'bouclierGrave', 'cheneSculpte', 'chromeeLignesLC',
  'codeKnightGrave', 'craneRieurGrave', 'faucheuseGravee', 'fauconsPlumesL',
  'flammesStylisees', 'griffuresGravees', 'masqueBriseSculpte', 'rouagesCassesGraves',
  'sillonsFLF',
];

const wpnAmeliorationA = [
  'chargeurGrappes', 'canonLong', 'canonRaccourci', 'chambreDouble', 'interfaceGuidage',
  'jumelage', 'lunetteIntelligente', 'munitionsHyperVelocite', 'munitionsDrone',
  'chargeurExplosives', 'munitionsIEM', 'munitionsNonLetales', 'munitionsSubsoniques',
  'pointeurLaser', 'protectionArme', 'revetementOmega', 'structureElement', 'systemeRefroidissement',
];

const wpnAmeliorationAValue = [
  'jumelageValue', 'jumelageType',
];

const wpnSpecial = [
  'BDDiversTotal', 'BVDiversTotal', 'energie',
];

const wpnSpecialValue = [
  'BDDiversD6', 'BDDiversFixe', 'BVDiversD6', 'BVDiversFixe', 'energieValue',
];

function getWeaponsEffects(prefix, effet, hasArmure, armure, vForce, vDexterite, oDexterite, vDiscretion, oDiscretion, vTir, oTir) {
  const result = {};

  const exec = [];
  const firstExec = [];

  let isConditionnelA = false;
  let isConditionnelD = false;
  let isConditionnelV = false;

  const attaquesSurprises = [];
  const attaquesSurprisesValue = [];
  let attaquesSurprisesCondition = '';

  const bDegats = [];
  const autresEffets = [];

  let rCadence = 0;
  let vCadence = 0;
  let eASAssassin = '';
  let eASAssassinValue = 0;

  let eLumiereS = '';
  let eLumiereValue = 0;

  let isAntiAnatheme = false;
  let isAssistantAttaque = false;
  let isAkimbo = false;
  let isAmbidextrie = false;
  let isCadence = false;
  const isChoc = false;
  let isDestructeur = false;
  let isDeuxMains = false;
  let isLeste = false;
  let isLourd = false;
  let isELumiere = false;
  let isFureur = false;
  let isMeurtrier = false;
  let isObliteration = false;
  let isOrfevrerie = false;
  let isSilencieux = false;
  let isTenebricide = false;
  let isTirRafale = false;
  let isUltraviolence = false;

  const eAntiAnatheme = isApplied(effet[`${prefix}antiAnatheme`]);
  const eAntiVehicule = isApplied(effet[`${prefix}antiVehicule`]);
  const eArtillerie = isApplied(effet[`${prefix}artillerie`]);
  const eAssassin = isApplied(effet[`${prefix}assassin`]);
  const eAssassinV = effet[`${prefix}assassinValue`] || 0;
  const eAssistanceAttaque = isApplied(effet[`${prefix}assistanceAttaque`]);
  const eBarrage = isApplied(effet[`${prefix}barrage`]);
  const eBarrageV = effet[`${prefix}barrageValue`] || 0;
  const eCadence = isApplied(effet[`${prefix}cadence`]);
  const eCadenceV = effet[`${prefix}cadenceValue`] || 0;
  const eChargeur = isApplied(effet[`${prefix}eChargeur`]);
  const eChargeurV = effet[`${prefix}chargeurValue`] || 0;
  const eChoc = isApplied(effet[`${prefix}choc`]);
  const eChocV = effet[`${prefix}chocValue`] || 0;
  const eDefense = isApplied(effet[`${prefix}eDefense`]);
  const eDefenseV = effet[`${prefix}defenseValue`] || 0;
  const eDegatsContinus = isApplied(effet[`${prefix}degatContinue`]);
  const eDegatsContinusV = effet[`${prefix}degatContinueValue`] || 0;
  const eDeuxMains = isApplied(effet[`${prefix}deuxMains`]);
  const eDemoralisant = isApplied(effet[`${prefix}eDemoralisant`]);
  const eDesignation = isApplied(effet[`${prefix}designation`]);
  const eDestructeur = isApplied(effet[`${prefix}destructeur`]);
  const eDestructeurV = 2;
  const eDispersion = isApplied(effet[`${prefix}dispersion`]);
  const eDispersionV = effet[`${prefix}dispersionValue`] || 0;
  const eEnChaine = isApplied(effet[`${prefix}enChaine`]);
  const eEsperance = isApplied(effet[`${prefix}esperance`]);
  const eFureur = isApplied(effet[`${prefix}fureur`]);
  const eFureurV = 4;
  const eIgnoreArmure = isApplied(effet[`${prefix}ignoreArmure`]);
  const eIgnoreCDF = isApplied(effet[`${prefix}ignoreCdF`]);
  const eJAkimbo = isApplied(effet[`${prefix}akimbo`]);
  const eJAmbidextrie = isApplied(effet[`${prefix}ambidextrie`]);
  const eLeste = isApplied(effet[`${prefix}leste`]);
  const eLourd = isApplied(effet[`${prefix}lourd`]);
  const eLumiere = isApplied(effet[`${prefix}lumiere`]);
  const eLumiereV = effet[`${prefix}lumiereValue`] || 0;
  const eMeurtrier = isApplied(effet[`${prefix}meurtrier`]);
  const eMeurtrierV = 2;
  const eObliteration = isApplied(effet[`${prefix}obliteration`]);
  const eOrfevrerie = isApplied(effet[`${prefix}orfevrerie`]);
  const eParasitage = isApplied(effet[`${prefix}parasitage`]);
  const eParasitageV = effet[`${prefix}parasitageValue`] || 0;
  const ePenetrant = isApplied(effet[`${prefix}penetrant`]);
  const ePenetrantV = effet[`${prefix}penetrantValue`] || 0;
  const ePerceArmure = isApplied(effet[`${prefix}perceArmure`]);
  const ePerceArmureV = effet[`${prefix}perceArmureValue`] || 0;
  const ePrecision = isApplied(effet[`${prefix}precision`]);
  const eReaction = isApplied(effet[`${prefix}reaction`]);
  const eReactionV = effet[`${prefix}reactionValue`] || 0;
  const eSilencieux = isApplied(effet[`${prefix}silencieux`]);
  const eSoumission = isApplied(effet[`${prefix}soumission`]);
  const eTenebricide = isApplied(effet[`${prefix}tenebricite`]);
  const eTirRafale = isApplied(effet[`${prefix}tirRafale`]);
  const eTirSecurite = isApplied(effet[`${prefix}tirSecurite`]);
  const eUltraviolence = isApplied(effet[`${prefix}ultraViolence`]);
  const eUltraviolenceV = 2;

  if (eAntiAnatheme || armure === 'berserk') {
    isConditionnelD = true;
    isConditionnelV = true;

    exec.push(`{{antiAnatheme=${i18n_antiAnatheme}}} {{antiAnathemeCondition=${i18n_antiAnathemeCondition}}}`);

    isAntiAnatheme = true;
  }

  if (eAssistanceAttaque) {
    isConditionnelD = true;
    isConditionnelV = true;

    exec.push(`{{assistanceAttaque=${i18n_assistanceAttaque}}} {{assistanceAttaqueCondition=${i18n_assistanceAttaqueCondition}}}`);

    isAssistantAttaque = true;
  }

  if (eArtillerie) {
    isConditionnelA = true;

    exec.push(`{{artillerie=${i18n_artillerie}}} {{artillerieCondition=${i18n_artillerieCondition}}}`);
  }

  if (eAssassin) {
    isConditionnelD = true;

    eASAssassin = i18n_assassin;
    eASAssassinValue = eAssassinV;

    if (attaquesSurprisesCondition === '') { attaquesSurprisesCondition = `{{attaqueSurpriseCondition=${i18n_attaqueSurpriseCondition}}}`; }
  }

  if (eCadence) {
    rCadence = '?{Plusieurs cibles ?|Oui, 3|Non, 0}';
    isCadence = true;
    vCadence = eCadenceV;
  }

  if (eChoc) {
    isConditionnelA = true;

    exec.push(`{{choc=${i18n_choc} ${eChocV}}} {{chocCondition=${i18n_chocCondition}}}`);
  }

  if (eDemoralisant) {
    isConditionnelA = true;

    exec.push(`{{demoralisant=${i18n_demoralisant}}} {{demoralisantCondition=${i18n_demoralisantCondition}}}`);
  }

  if (eDestructeur) {
    isConditionnelD = true;

    firstExec.push(`{{destructeurValue=[[${eDestructeurV}D6]]}}`);

    exec.push(`{{destructeur=${i18n_destructeur}}} {{destructeurCondition=${i18n_destructeurCondition}}}`);

    isDestructeur = true;
  }

  if (eEnChaine) {
    isConditionnelD = true;

    exec.push(`{{enChaine=${i18n_enChaine}}} {{enChaineCondition=${i18n_enChaineCondition}}}`);
  }

  if (eEsperance) {
    isConditionnelD = true;
    isConditionnelV = true;

    exec.push(`{{esperance=${i18n_esperance}}} {{esperanceConditionD=${i18n_esperanceConditionD}}} {{esperanceConditionV=${i18n_esperanceConditionV}}}`);
  }

  if (eFureur) {
    isConditionnelV = true;
    isFureur = true;

    firstExec.push(`{{fureurValue=[[${eFureurV}D6]]}}`);

    exec.push(`{{fureur=${i18n_fureur}}} {{fureurCondition=${i18n_fureurCondition}}}`);
  }

  if (eLeste) {
    bDegats.push(vForce);
    exec.push(`{{vLeste=${vForce}}}`);
    isLeste = true;
  }

  if (eMeurtrier) {
    isConditionnelD = true;

    firstExec.push(`{{meurtrierValue=[[${eMeurtrierV}D6]]}}`);

    exec.push(`{{meurtrier=${i18n_meurtrier}}} {{meurtrierCondition=${i18n_meurtrierCondition}}}`);

    isMeurtrier = true;
  }

  if (eObliteration) {
    isConditionnelD = true;

    exec.push(`{{obliteration=${i18n_obliteration}}} {{obliterationCondition=${i18n_obliterationCondition}}}`);

    isObliteration = true;
  }

  if (eOrfevrerie) {
    let vOrfevrerie = vDexterite;

    if (hasArmure) { vOrfevrerie += oDexterite; }

    bDegats.push(vOrfevrerie);
    exec.push(`{{vOrfevrerie=${vOrfevrerie}}}`);

    isOrfevrerie = true;
  }

  if (eParasitage) {
    isConditionnelA = true;

    exec.push(`{{parasitage=${i18n_parasitage} ${eParasitageV}}} {{parasitageCondition=${i18n_parasitageCondition}}}`);
  }

  if (ePrecision) {
    isConditionnelD = true;

    let vPrecision = vTir;

    if (hasArmure) { vPrecision += oTir; }

    bDegats.push(vPrecision);
    exec.push(`{{vPrecision=${vPrecision}}}`);
  }

  if (eSilencieux || prefix === 'pS' || prefix === 'pSC') {
    const ghost = +effet.rogueGhost;
    const MALghost = +effet.MALRogueGhost;
    const changeling = +effet.bardChangeling;
    const MALchangeling = +effet.MALBardChangeling;
    let totalSilencieux = vDiscretion;

    if (hasArmure) { totalSilencieux += oDiscretion; }

    if (hasArmure && ghost !== 0) {
      exec.push(`{{vSilencieuxD=${totalSilencieux}}}`);
      bDegats.push(totalSilencieux);
    } else if (hasArmure && MALghost !== 0) {
      exec.push(`{{vSilencieuxD=${totalSilencieux}}}`);
      bDegats.push(totalSilencieux);
    } else if (hasArmure && changeling !== 0) {
      exec.push(`{{vSilencieuxD=${totalSilencieux}}}`);
      bDegats.push(totalSilencieux);
    } else if (hasArmure && MALchangeling !== 0) {
      exec.push(`{{vSilencieuxD=${totalSilencieux}}}`);
      bDegats.push(totalSilencieux);
    } else {
      isConditionnelD = true;
      attaquesSurprises.push(i18n_silencieux);
      attaquesSurprisesValue.push(totalSilencieux);

      if (attaquesSurprisesCondition === '') { attaquesSurprisesCondition = `{{attaqueSurpriseCondition=${i18n_attaqueSurpriseCondition}}}`; }
    }

    isSilencieux = true;
  }

  if (eSoumission) {
    isConditionnelA = true;

    exec.push(`{{soumission=${i18n_soumission}}} {{soumissionCondition=${i18n_soumissionCondition}}}`);
  }

  if (eTenebricide || armure === 'berserk') {
    isConditionnelD = true;
    isConditionnelV = true;

    isTenebricide = true;
  }

  if (eTirRafale) {
    isConditionnelD = true;
    isTirRafale = true;

    exec.push(`{{tirRafale=${i18n_tirRafale}}} {{tirRafaleCondition=${i18n_tirRafaleCondition}}}`);
  }

  if (eUltraviolence) {
    isConditionnelV = true;
    isUltraviolence = true;

    firstExec.push(`{{ultraviolenceValue=[[${eUltraviolenceV}D6]]}}`);

    exec.push(`{{ultraviolence=${i18n_ultraviolence}}} {{ultraviolenceCondition=${i18n_ultraviolenceCondition}}}`);
  }

  if (eAntiVehicule) { autresEffets.push(i18n_antiVehicule); }

  if (eBarrage) { autresEffets.push(`${i18n_barrage} ${eBarrageV}`); }

  if (eChargeur) { autresEffets.push(`${i18n_chargeur} ${eChargeurV}`); }

  if (prefix === 'mE') { autresEffets.push(`${i18n_chargeur} 1`); }

  if (eDefense) { autresEffets.push(`${i18n_defense} ${eDefenseV}`); }

  if (eDegatsContinus) { autresEffets.push(`${i18n_degatsContinus} ${eDegatsContinusV} ([[1d6]] ${i18n_tours})`); }

  if (prefix === 'mE') { autresEffets.push(`${i18n_degatsContinus} 3 ([[1d6]] ${i18n_tours})`); }

  if (eDeuxMains) {
    autresEffets.push(i18n_deuxMains);
    isDeuxMains = true;
  }

  if (eDesignation) { autresEffets.push(i18n_designation); }

  if (eDispersion) { autresEffets.push(`${i18n_dispersion} ${eDispersionV}`); }

  if (prefix === 'mE') { autresEffets.push(`${i18n_dispersion} 3`); }

  if (eIgnoreArmure) { autresEffets.push(i18n_ignoreArmure); }

  if (eIgnoreCDF) { autresEffets.push(i18n_ignoreCDF); }

  if (eJAkimbo) {
    isAkimbo = true;
    autresEffets.push(i18n_jAkimbo);
  }

  if (eJAmbidextrie) {
    isAmbidextrie = true;
    autresEffets.push(i18n_jAmbidextrie);
  }

  if (eLourd) {
    autresEffets.push(i18n_lourd);
    isLourd = true;
  }

  if (eLumiere) {
    eLumiereS = i18n_lumiere;
    eLumiereValue = eLumiereV;
    isELumiere = true;
  }

  if (prefix === 'mE') {
    eLumiereS = i18n_lumiere;
    eLumiereValue = 2;
    isELumiere = true;
  }

  if (ePenetrant) { autresEffets.push(`${i18n_penetrant} ${ePenetrantV}`); }

  if (ePerceArmure) { autresEffets.push(`${i18n_perceArmure} ${ePerceArmureV}`); }

  if (prefix === 'mEC') { autresEffets.push(`${i18n_perceArmure} 40`); }

  if (eReaction) { autresEffets.push(`${i18n_reaction} ${eReactionV}`); }

  if (eTirSecurite) { autresEffets.push(i18n_tirSecurite); }

  result.isConditionnelA = isConditionnelA;
  result.isConditionnelD = isConditionnelD;
  result.isConditionnelV = isConditionnelV;

  result.eASAssassin = eASAssassin;
  result.eASAssassinValue = eASAssassinValue;
  result.isCadence = isCadence;
  result.sCadence = rCadence;
  result.vCadence = vCadence;
  result.isTenebricide = isTenebricide;
  result.isObliteration = isObliteration;
  result.isMeurtrier = isMeurtrier;
  result.vMeurtrier = eMeurtrierV;
  result.isDestructeur = isDestructeur;
  result.vDestructeur = eDestructeurV;
  result.nowSilencieux = isSilencieux;
  result.isChoc = isChoc;
  result.isLeste = isLeste;
  result.isOrfevrerie = isOrfevrerie;
  result.isAssistantAttaque = isAssistantAttaque;
  result.isAntiAnatheme = isAntiAnatheme;
  result.isTirRafale = isTirRafale;
  result.isFureur = isFureur;
  result.isUltraviolence = isUltraviolence;

  result.eLumiere = eLumiere;
  result.isELumiere = isELumiere;
  result.eLumiereValue = eLumiereValue;

  result.isAkimbo = isAkimbo;
  result.isAmbidextrie = isAmbidextrie;
  result.isDeuxMains = isDeuxMains;
  result.isLourd = isLourd;

  result.attaquesSurprises = attaquesSurprises;
  result.attaquesSurprisesValue = attaquesSurprisesValue;
  result.attaquesSurprisesCondition = attaquesSurprisesCondition;

  result.bDegats = bDegats;

  result.exec = exec;
  result.firstExec = firstExec;
  result.autresEffets = autresEffets;

  return result;
}

function getWeaponsEffectsPNJ(prefix, data, addChair, vChair, vMachine, vMachineAE, vMasque, vMasqueAE) {
  const result = {};

  const exec = [];
  const firstExec = [];

  let isConditionnelA = false;
  let isConditionnelD = false;
  let isConditionnelV = false;

  const attaquesSurprises = [];
  const attaquesSurprisesValue = [];
  let attaquesSurprisesCondition = '';

  let eASAssassin;
  let eASAssassinValue = 0;

  let bDegats = 0;
  const autresEffets = [];

  const isCadence = false;
  let rCadence = 0;
  let vCadence = 0;

  let isObliteration = false;
  let isTenebricide = false;

  let isAntiAnatheme = false;
  let isAssistanceAttaque = false;
  let isDestructeur = false;
  let isChoc = false;
  let isLeste = false;
  let isMeurtrier = false;
  let isOrfevrerie = false;
  let isSilencieux = false;
  let isFureur = false;
  let isUltraviolence = false;

  const eAnatheme = isApplied(data[`${prefix}anatheme`]);
  const eAntiAnatheme = isApplied(data[`${prefix}antiAnatheme`]);
  const eAntiVehicule = isApplied(data[`${prefix}antiVehicule`]);
  const eArtillerie = isApplied(data[`${prefix}artillerie`]);
  const eAssassin = isApplied(data[`${prefix}assassin`]);
  const eAssassinV = data[`${prefix}assassinValue`] || 0;
  const eAssistanceAttaque = isApplied(data[`${prefix}assistanceAttaque`]);
  const eBarrage = isApplied(data[`${prefix}barrage`]);
  const eBarrageV = data[`${prefix}barrageValue`] || 0;
  const eCadence = isApplied(data[`${prefix}cadence`]);
  const eCadenceV = data[`${prefix}cadenceValue`] || 0;
  const eChargeur = isApplied(data[`${prefix}eChargeur`]);
  const eChargeurV = data[`${prefix}chargeurValue`] || 0;
  const eChoc = isApplied(data[`${prefix}choc`]);
  const eChocV = data[`${prefix}chocValue`] || 0;
  const eDefense = isApplied(data[`${prefix}eDefense`]);
  const eDefenseV = data[`${prefix}defenseValue`] || 0;
  const eDegatsContinus = isApplied(data[`${prefix}degatContinue`]);
  const eDegatsContinusV = data[`${prefix}degatContinueValue`] || 0;
  const eDeuxMains = isApplied(data[`${prefix}deuxMains`]);
  const eDemoralisant = isApplied(data[`${prefix}eDemoralisant`]);
  const eDesignation = isApplied(data[`${prefix}designation`]);
  const eDestructeur = isApplied(data[`${prefix}destructeur`]);
  const eDestructeurV = 2;
  const eDispersion = isApplied(data[`${prefix}dispersion`]);
  const eDispersionV = data[`${prefix}dispersionValue`] || 0;
  const eEnChaine = isApplied(data[`${prefix}enChaine`]);
  const eEsperance = isApplied(data[`${prefix}esperance`]);
  const eFureur = isApplied(data[`${prefix}fureur`]);
  const eFureurV = 4;
  const eIgnoreArmure = isApplied(data[`${prefix}ignoreArmure`]);
  const eIgnoreCDF = isApplied(data[`${prefix}ignoreCdF`]);
  const eJAkimbo = isApplied(data[`${prefix}akimbo`]);
  const eJAmbidextrie = isApplied(data[`${prefix}ambidextrie`]);
  const eLeste = isApplied(data[`${prefix}lestePNJ`]);
  const eLourd = isApplied(data[`${prefix}lourd`]);
  const eLumiere = isApplied(data[`${prefix}lumiere`]);
  const eLumiereV = data[`${prefix}lumiereValue`] || 0;
  const eMeurtrier = isApplied(data[`${prefix}meurtrier`]);
  const eMeurtrierV = 2;
  const eObliteration = isApplied(data[`${prefix}obliteration`]);
  const eOrfevrerie = isApplied(data[`${prefix}orfevreriePNJ`]);
  const eParasitage = isApplied(data[`${prefix}parasitage`]);
  const eParasitageV = data[`${prefix}parasitageValue`] || 0;
  const ePenetrant = isApplied(data[`${prefix}penetrant`]);
  const ePenetrantV = data[`${prefix}penetrantValue`] || 0;
  const ePerceArmure = isApplied(data[`${prefix}perceArmure`]);
  const ePerceArmureV = data[`${prefix}perceArmureValue`] || 0;
  const ePrecision = isApplied(data[`${prefix}precisionPNJ`]);
  const eReaction = isApplied(data[`${prefix}reaction`]);
  const eReactionV = data[`${prefix}reactionValue`] || 0;
  const eSilencieux = isApplied(data[`${prefix}silencieux`]);
  const eSoumission = isApplied(data[`${prefix}soumission`]);
  const eTenebricide = isApplied(data[`${prefix}tenebricite`]);
  const eTirRafale = isApplied(data[`${prefix}tirRafale`]);
  const eTirSecurite = isApplied(data[`${prefix}tirSecurite`]);
  const eUltraviolence = isApplied(data[`${prefix}ultraViolence`]);
  const eUltraviolenceV = 2;

  if (eAntiAnatheme) {
    isConditionnelD = true;
    isConditionnelV = true;

    exec.push(`{{antiAnatheme=${i18n_antiAnatheme}}} {{antiAnathemeCondition=${i18n_antiAnathemeCondition}}}`);

    isAntiAnatheme = true;
  }

  if (eAssistanceAttaque) {
    isConditionnelD = true;
    isConditionnelV = true;

    exec.push(`{{assistanceAttaque=${i18n_assistanceAttaque}}} {{assistanceAttaqueCondition=${i18n_assistanceAttaqueCondition}}}`);

    isAssistanceAttaque = true;
  }

  if (eArtillerie) {
    isConditionnelA = true;

    exec.push(`{{artillerie=${i18n_artillerie}}} {{artillerieCondition=${i18n_artillerieCondition}}}`);
  }

  if (eAssassin) {
    isConditionnelD = true;

    eASAssassin = i18n_assassin;
    eASAssassinValue = eAssassinV;

    if (attaquesSurprisesCondition === '') { attaquesSurprisesCondition = `{{attaqueSurpriseCondition=${i18n_attaqueSurpriseCondition}}}`; }
  }

  if (eCadence) {
    rCadence = '?{Plusieurs cibles ?|Oui, 3|Non, 0}';
    vCadence = eCadenceV;
  }

  if (eChoc) {
    isConditionnelA = true;

    exec.push(`{{choc=${i18n_choc} ${eChocV}}} {{chocCondition=${i18n_chocCondition}}}`);

    isChoc = true;
  }

  if (eDemoralisant) {
    isConditionnelA = true;

    exec.push(`{{demoralisant=${i18n_demoralisant}}} {{demoralisantCondition=${i18n_demoralisantCondition}}}`);
  }

  if (eDestructeur) {
    isConditionnelD = true;

    firstExec.push(`{{destructeurValue=[[${eDestructeurV}D6]]}}`);

    exec.push(`{{destructeur=${i18n_destructeur}}} {{destructeurCondition=${i18n_destructeurCondition}}}`);

    isDestructeur = true;
  }

  if (eEnChaine) {
    isConditionnelD = true;

    exec.push(`{{enChaine=${i18n_enChaine}}} {{enChaineCondition=${i18n_enChaineCondition}}}`);
  }

  if (eEsperance) {
    isConditionnelD = true;
    isConditionnelV = true;

    exec.push(`{{esperance=${i18n_esperance}}} {{esperanceConditionD=${i18n_esperanceConditionD}}} {{esperanceConditionV=${i18n_esperanceConditionV}}}`);
  }

  if (eFureur) {
    isConditionnelV = true;
    isFureur = true;

    firstExec.push(`{{fureurValue=[[${eFureurV}D6]]}}`);

    exec.push(`{{fureur=${i18n_fureur}}} {{fureurCondition=${i18n_fureurCondition}}}`);
  }

  if (eLeste) {
    bDegats += Math.floor(vChair / 2);

    if (addChair) { exec.push(`{{vLeste=${Math.floor(vChair / 2)}}}`); } else { exec.push(`{{vLeste=${vChair}}}`); }

    isLeste = true;
  }

  if (eMeurtrier) {
    isConditionnelD = true;

    firstExec.push(`{{meurtrierValue=[[${eMeurtrierV}D6]]}}`);

    exec.push(`{{meurtrier=${i18n_meurtrier}}} {{meurtrierCondition=${i18n_meurtrierCondition}}}`);

    isMeurtrier = true;
  }

  if (eObliteration) {
    isConditionnelD = true;

    exec.push(`{{obliteration=${i18n_obliteration}}} {{obliterationCondition=${i18n_obliterationCondition}}}`);

    isObliteration = true;
  }

  if (eOrfevrerie) {
    const vOrfevrerie = Math.ceil(vMasque / 2);

    bDegats += vOrfevrerie;
    exec.push(`{{vOrfevrerie=${vOrfevrerie}}}`);

    isOrfevrerie = true;
  }

  if (eParasitage) {
    isConditionnelA = true;

    exec.push(`{{parasitage=${i18n_parasitage} ${eParasitageV}}} {{parasitageCondition=${i18n_parasitageCondition}}}`);
  }

  if (ePrecision) {
    isConditionnelD = true;

    const vPrecision = Math.ceil(vMachine / 2) + vMachineAE;

    bDegats += vPrecision;
    exec.push(`{{vPrecision=${vPrecision}}}`);
  }

  if (eSilencieux || prefix === 'pS' || prefix === 'pSC') {
    const totalSilencieux = Math.ceil(vMasque / 2) + vMasqueAE;

    isConditionnelD = true;

    attaquesSurprises.push(i18n_silencieux);
    attaquesSurprisesValue.push(totalSilencieux);

    if (attaquesSurprisesCondition === '') { attaquesSurprisesCondition = `{{attaqueSurpriseCondition=${i18n_attaqueSurpriseCondition}}}`; }

    isSilencieux = true;
  }

  if (eSoumission) {
    isConditionnelA = true;

    exec.push(`{{soumission=${i18n_soumission}}} {{soumissionCondition=${i18n_soumissionCondition}}}`);
  }

  if (eTenebricide) {
    isConditionnelD = true;
    isConditionnelV = true;

    exec.push(`{{tenebricide=${i18n_tenebricide}}} {{tenebricideConditionD=${i18n_tenebricideConditionD}}} {{tenebricideConditionV=${i18n_tenebricideConditionV}}}`);

    isTenebricide = true;
  }

  if (eTirRafale) {
    isConditionnelD = true;

    exec.push(`{{tirRafale=${i18n_tirRafale}}} {{tirRafaleCondition=${i18n_tirRafaleCondition}}}`);
  }

  if (eUltraviolence) {
    isConditionnelV = true;
    isUltraviolence = true;

    firstExec.push(`{{ultraviolenceValue=[[${eUltraviolenceV}D6]]}}`);

    exec.push(`{{ultraviolence=${i18n_ultraviolence}}} {{ultraviolenceCondition=${i18n_ultraviolenceCondition}}}`);
  }

  if (eAnatheme) { autresEffets.push(i18n_anatheme); }

  if (eAntiVehicule) { autresEffets.push(i18n_antiVehicule); }

  if (eBarrage) { autresEffets.push(`${i18n_barrage} ${eBarrageV}`); }

  if (eChargeur) { autresEffets.push(`${i18n_chargeur} ${eChargeurV}`); }

  if (prefix === 'mE') { autresEffets.push(`${i18n_chargeur} 1`); }

  if (eDefense) { autresEffets.push(`${i18n_defense} ${eDefenseV}`); }

  if (eDegatsContinus) { autresEffets.push(`${i18n_degatsContinus} ${eDegatsContinusV} ([[1d6]] ${i18n_tours})`); }

  if (prefix === 'mE') { autresEffets.push(`${i18n_degatsContinus} 3 ([[1d6]] ${i18n_tours})`); }

  if (eDeuxMains) { autresEffets.push(i18n_deuxMains); }

  if (eDesignation) { autresEffets.push(i18n_designation); }

  if (eDispersion) { autresEffets.push(`${i18n_dispersion} ${eDispersionV}`); }

  if (prefix === 'mE') { autresEffets.push(`${i18n_dispersion} 3`); }

  if (eIgnoreArmure) { autresEffets.push(i18n_ignoreArmure); }

  if (eIgnoreCDF) { autresEffets.push(i18n_ignoreCDF); }

  if (eJAkimbo) { autresEffets.push(i18n_jAkimbo); }

  if (eJAmbidextrie) { autresEffets.push(i18n_jAmbidextrie); }

  if (eLourd) { autresEffets.push(i18n_lourd); }

  if (eLumiere) { autresEffets.push(`${i18n_lumiere} ${eLumiereV}`); }

  if (prefix === 'mE') { autresEffets.push(`${i18n_lumiere} 2`); }

  if (ePenetrant) { autresEffets.push(`${i18n_penetrant} ${ePenetrantV}`); }

  if (ePerceArmure) { autresEffets.push(`${i18n_perceArmure} ${ePerceArmureV}`); }

  if (prefix === 'mEC') { autresEffets.push(`${i18n_perceArmure} 40`); }

  if (eReaction) { autresEffets.push(`${i18n_reaction} ${eReactionV}`); }

  if (eTirSecurite) { autresEffets.push(i18n_tirSecurite); }

  result.isConditionnelA = isConditionnelA;
  result.isConditionnelD = isConditionnelD;
  result.isConditionnelV = isConditionnelV;

  result.eASAssassin = eASAssassin;
  result.eASAssassinValue = eASAssassinValue;

  result.isCadence = isCadence;
  result.sCadence = rCadence;
  result.vCadence = vCadence;
  result.isTenebricide = isTenebricide;
  result.isObliteration = isObliteration;
  result.isAntiAnatheme = isAntiAnatheme;
  result.isAssistanceAttaque = isAssistanceAttaque;
  result.isChoc = isChoc;
  result.isDestructeur = isDestructeur;
  result.isLeste = isLeste;
  result.isMeurtrier = isMeurtrier;
  result.isOrfevrerie = isOrfevrerie;
  result.isSilencieux = isSilencieux;
  result.isFureur = isFureur;
  result.isUltraviolence = isUltraviolence;

  result.attaquesSurprises = attaquesSurprises;
  result.attaquesSurprisesValue = attaquesSurprisesValue;
  result.attaquesSurprisesCondition = attaquesSurprisesCondition;

  result.bDegats = bDegats;

  result.exec = exec;
  result.firstExec = firstExec;
  result.autresEffets = autresEffets;

  return result;
}

function getWeaponsEffectsAutre(prefix, effet) {
  const result = {};

  const exec = [];
  const firstExec = [];

  let isConditionnelA = false;
  let isConditionnelD = false;
  let isConditionnelV = false;

  const attaquesSurprises = [];
  const attaquesSurprisesValue = [];
  let attaquesSurprisesCondition = '';

  const bDegats = [];
  const autresEffets = [];

  let rCadence = 0;
  let vCadence = 0;
  let eASAssassin = '';
  let eASAssassinValue = 0;

  let eLumiereS = '';
  let eLumiereValue = 0;

  let isAntiAnatheme = false;
  let isAssistantAttaque = false;
  let isAkimbo = false;
  let isAmbidextrie = false;
  let isCadence = false;
  const isChoc = false;
  let isDestructeur = false;
  let isDeuxMains = false;
  let isLeste = false;
  let isLourd = false;
  let isELumiere = false;
  let isMeurtrier = false;
  let isObliteration = false;
  let isOrfevrerie = false;
  let isSilencieux = false;
  let isTenebricide = false;
  let isTirRafale = false;
  let isFureur = false;
  let isUltraviolence = false;

  const eAntiAnatheme = isApplied(effet[`${prefix}antiAnatheme`]);
  const eAntiVehicule = isApplied(effet[`${prefix}antiVehicule`]);
  const eArtillerie = isApplied(effet[`${prefix}artillerie`]);
  const eAssassin = isApplied(effet[`${prefix}assassin`]);
  const eAssassinV = effet[`${prefix}assassinValue`] || 0;
  const eAssistanceAttaque = isApplied(effet[`${prefix}assistanceAttaque`]);
  const eBarrage = isApplied(effet[`${prefix}barrage`]);
  const eBarrageV = effet[`${prefix}barrageValue`] || 0;
  const eCadence = isApplied(effet[`${prefix}cadence`]);
  const eCadenceV = effet[`${prefix}cadenceValue`] || 0;
  const eChargeur = isApplied(effet[`${prefix}eChargeur`]);
  const eChargeurV = effet[`${prefix}chargeurValue`] || 0;
  const eChoc = isApplied(effet[`${prefix}choc`]);
  const eChocV = effet[`${prefix}chocValue`] || 0;
  const eDefense = isApplied(effet[`${prefix}eDefense`]);
  const eDefenseV = effet[`${prefix}defenseValue`] || 0;
  const eDegatsContinus = isApplied(effet[`${prefix}degatContinue`]);
  const eDegatsContinusV = effet[`${prefix}degatContinueValue`] || 0;
  const eDeuxMains = isApplied(effet[`${prefix}deuxMains`]);
  const eDemoralisant = isApplied(effet[`${prefix}eDemoralisant`]);
  const eDesignation = isApplied(effet[`${prefix}designation`]);
  const eDestructeur = isApplied(effet[`${prefix}destructeur`]);
  const eDestructeurV = 2;
  const eDispersion = isApplied(effet[`${prefix}dispersion`]);
  const eDispersionV = effet[`${prefix}dispersionValue`] || 0;
  const eEnChaine = isApplied(effet[`${prefix}enChaine`]);
  const eEsperance = isApplied(effet[`${prefix}esperance`]);
  const eFureur = isApplied(effet[`${prefix}fureur`]);
  const eFureurV = 4;
  const eIgnoreArmure = isApplied(effet[`${prefix}ignoreArmure`]);
  const eIgnoreCDF = isApplied(effet[`${prefix}ignoreCdF`]);
  const eJAkimbo = isApplied(effet[`${prefix}akimbo`]);
  const eJAmbidextrie = isApplied(effet[`${prefix}ambidextrie`]);
  const eLeste = isApplied(effet[`${prefix}leste`]);
  const eLourd = isApplied(effet[`${prefix}lourd`]);
  const eLumiere = isApplied(effet[`${prefix}lumiere`]);
  const eLumiereV = effet[`${prefix}lumiereValue`] || 0;
  const eMeurtrier = isApplied(effet[`${prefix}meurtrier`]);
  const eMeurtrierV = 2;
  const eObliteration = isApplied(effet[`${prefix}obliteration`]);
  const eOrfevrerie = isApplied(effet[`${prefix}orfevrerie`]);
  const eParasitage = isApplied(effet[`${prefix}parasitage`]);
  const eParasitageV = effet[`${prefix}parasitageValue`] || 0;
  const ePenetrant = isApplied(effet[`${prefix}penetrant`]);
  const ePenetrantV = effet[`${prefix}penetrantValue`] || 0;
  const ePerceArmure = isApplied(effet[`${prefix}perceArmure`]);
  const ePerceArmureV = effet[`${prefix}perceArmureValue`] || 0;
  const ePrecision = isApplied(effet[`${prefix}precision`]);
  const eReaction = isApplied(effet[`${prefix}reaction`]);
  const eReactionV = effet[`${prefix}reactionValue`] || 0;
  const eSilencieux = isApplied(effet[`${prefix}silencieux`]);
  const eSoumission = isApplied(effet[`${prefix}soumission`]);
  const eTenebricide = isApplied(effet[`${prefix}tenebricite`]);
  const eTirRafale = isApplied(effet[`${prefix}tirRafale`]);
  const eTirSecurite = isApplied(effet[`${prefix}tirSecurite`]);
  const eUltraviolence = isApplied(effet[`${prefix}ultraViolence`]);
  const eUltraviolenceV = 2;

  if (eAntiAnatheme) {
    isConditionnelD = true;
    isConditionnelV = true;

    exec.push(`{{antiAnatheme=${i18n_antiAnatheme}}} {{antiAnathemeCondition=${i18n_antiAnathemeCondition}}}`);

    isAntiAnatheme = true;
  }

  if (eAssistanceAttaque) {
    isConditionnelD = true;
    isConditionnelV = true;

    exec.push(`{{assistanceAttaque=${i18n_assistanceAttaque}}} {{assistanceAttaqueCondition=${i18n_assistanceAttaqueCondition}}}`);

    isAssistantAttaque = true;
  }

  if (eArtillerie) {
    isConditionnelA = true;

    exec.push(`{{artillerie=${i18n_artillerie}}} {{artillerieCondition=${i18n_artillerieCondition}}}`);
  }

  if (eAssassin) {
    isConditionnelD = true;

    eASAssassin = i18n_assassin;
    eASAssassinValue = eAssassinV;

    if (attaquesSurprisesCondition === '') { attaquesSurprisesCondition = `{{attaqueSurpriseCondition=${i18n_attaqueSurpriseCondition}}}`; }
  }

  if (eCadence) {
    rCadence = '?{Plusieurs cibles ?|Oui, 3|Non, 0}';
    isCadence = true;
    vCadence = eCadenceV;
  }

  if (eChoc) {
    isConditionnelA = true;

    exec.push(`{{choc=${i18n_choc} ${eChocV}}} {{chocCondition=${i18n_chocCondition}}}`);
  }

  if (eDemoralisant) {
    isConditionnelA = true;

    exec.push(`{{demoralisant=${i18n_demoralisant}}} {{demoralisantCondition=${i18n_demoralisantCondition}}}`);
  }

  if (eDestructeur) {
    isConditionnelD = true;

    firstExec.push(`{{destructeurValue=[[${eDestructeurV}D6]]}}`);

    exec.push(`{{destructeur=${i18n_destructeur}}} {{destructeurCondition=${i18n_destructeurCondition}}}`);

    isDestructeur = true;
  }

  if (eEnChaine) {
    isConditionnelD = true;

    exec.push(`{{enChaine=${i18n_enChaine}}} {{enChaineCondition=${i18n_enChaineCondition}}}`);
  }

  if (eEsperance) {
    isConditionnelD = true;
    isConditionnelV = true;

    exec.push(`{{esperance=${i18n_esperance}}} {{esperanceConditionD=${i18n_esperanceConditionD}}} {{esperanceConditionV=${i18n_esperanceConditionV}}}`);
  }

  if (eFureur) {
    isConditionnelV = true;
    isFureur = true;

    firstExec.push(`{{fureurValue=[[${eFureurV}D6]]}}`);

    exec.push(`{{fureur=${i18n_fureur}}} {{fureurCondition=${i18n_fureurCondition}}}`);
  }

  if (eLeste) {
    autresEffets.push(i18n_leste);
    isLeste = true;
  }

  if (eMeurtrier) {
    isConditionnelD = true;

    firstExec.push(`{{meurtrierValue=[[${eMeurtrierV}D6]]}}`);

    exec.push(`{{meurtrier=${i18n_meurtrier}}} {{meurtrierCondition=${i18n_meurtrierCondition}}}`);

    isMeurtrier = true;
  }

  if (eObliteration) {
    isConditionnelD = true;

    exec.push(`{{obliteration=${i18n_obliteration}}} {{obliterationCondition=${i18n_obliterationCondition}}}`);

    isObliteration = true;
  }

  if (eOrfevrerie) {
    autresEffets.push(i18n_orfevrerie);

    isOrfevrerie = true;
  }

  if (eParasitage) {
    isConditionnelA = true;

    exec.push(`{{parasitage=${i18n_parasitage} ${eParasitageV}}} {{parasitageCondition=${i18n_parasitageCondition}}}`);
  }

  if (ePrecision) {
    isConditionnelD = true;

    autresEffets.push(i18n_precision);
  }

  if (eSilencieux) {
    isConditionnelD = true;

    autresEffets.push(i18n_silencieux);

    isSilencieux = true;
  }

  if (eSoumission) {
    isConditionnelA = true;

    exec.push(`{{soumission=${i18n_soumission}}} {{soumissionCondition=${i18n_soumissionCondition}}}`);
  }

  if (eTenebricide) {
    isConditionnelD = true;
    isConditionnelV = true;

    exec.push(`{{tenebricide=${i18n_tenebricide}}} {{tenebricideConditionD=${i18n_tenebricideConditionD}}} {{tenebricideConditionV=${i18n_tenebricideConditionV}}}`);

    isTenebricide = true;
  }

  if (eTirRafale) {
    isConditionnelD = true;
    isTirRafale = true;

    exec.push(`{{tirRafale=${i18n_tirRafale}}} {{tirRafaleCondition=${i18n_tirRafaleCondition}}}`);
  }

  if (eUltraviolence) {
    isConditionnelV = true;
    isUltraviolence = true;

    firstExec.push(`{{ultraviolenceValue=[[${eUltraviolenceV}D6]]}}`);

    exec.push(`{{ultraviolence=${i18n_ultraviolence}}} {{ultraviolenceCondition=${i18n_ultraviolenceCondition}}}`);
  }

  if (eAntiVehicule) { autresEffets.push(i18n_antiVehicule); }

  if (eBarrage) { autresEffets.push(`${i18n_barrage} ${eBarrageV}`); }

  if (eChargeur) { autresEffets.push(`${i18n_chargeur} ${eChargeurV}`); }

  if (eDefense) { autresEffets.push(`${i18n_defense} ${eDefenseV}`); }

  if (eDegatsContinus) { autresEffets.push(`${i18n_degatsContinus} ${eDegatsContinusV} ([[1d6]] ${i18n_tours})`); }

  if (eDeuxMains) {
    autresEffets.push(i18n_deuxMains);
    isDeuxMains = true;
  }

  if (eDesignation) { autresEffets.push(i18n_designation); }

  if (eDispersion) { autresEffets.push(`${i18n_dispersion} ${eDispersionV}`); }

  if (eIgnoreArmure) { autresEffets.push(i18n_ignoreArmure); }

  if (eIgnoreCDF) { autresEffets.push(i18n_ignoreCDF); }

  if (eJAkimbo) {
    isAkimbo = true;
    autresEffets.push(i18n_jAkimbo);
  }

  if (eJAmbidextrie) {
    isAmbidextrie = true;
    autresEffets.push(i18n_jAmbidextrie);
  }

  if (eLourd) {
    autresEffets.push(i18n_lourd);
    isLourd = true;
  }

  if (eLumiere) {
    eLumiereS = i18n_lumiere;
    eLumiereValue = eLumiereV;
    isELumiere = true;
  }

  if (ePenetrant) { autresEffets.push(`${i18n_penetrant} ${ePenetrantV}`); }

  if (ePerceArmure) { autresEffets.push(`${i18n_perceArmure} ${ePerceArmureV}`); }

  if (eReaction) { autresEffets.push(`${i18n_reaction} ${eReactionV}`); }

  if (eTirSecurite) { autresEffets.push(i18n_tirSecurite); }

  result.isConditionnelA = isConditionnelA;
  result.isConditionnelD = isConditionnelD;
  result.isConditionnelV = isConditionnelV;

  result.eASAssassin = eASAssassin;
  result.eASAssassinValue = eASAssassinValue;
  result.isCadence = isCadence;
  result.sCadence = rCadence;
  result.vCadence = vCadence;
  result.isTenebricide = isTenebricide;
  result.isObliteration = isObliteration;
  result.isMeurtrier = isMeurtrier;
  result.vMeurtrier = eMeurtrierV;
  result.isDestructeur = isDestructeur;
  result.vDestructeur = eDestructeurV;
  result.nowSilencieux = isSilencieux;
  result.isChoc = isChoc;
  result.isLeste = isLeste;
  result.isOrfevrerie = isOrfevrerie;
  result.isAssistantAttaque = isAssistantAttaque;
  result.isAntiAnatheme = isAntiAnatheme;
  result.isTirRafale = isTirRafale;
  result.isFureur = isFureur;
  result.isUltraviolence = isUltraviolence;

  result.eLumiere = eLumiere;
  result.isELumiere = isELumiere;
  result.eLumiereValue = eLumiereValue;

  result.isAkimbo = isAkimbo;
  result.isAmbidextrie = isAmbidextrie;
  result.isDeuxMains = isDeuxMains;
  result.isLourd = isLourd;

  result.attaquesSurprises = attaquesSurprises;
  result.attaquesSurprisesValue = attaquesSurprisesValue;
  result.attaquesSurprisesCondition = attaquesSurprisesCondition;

  result.bDegats = bDegats;

  result.exec = exec;
  result.firstExec = firstExec;
  result.autresEffets = autresEffets;

  return result;
}

function getWeaponsEffectsAutrePNJ(prefix, effet) {
  const result = {};

  const exec = [];
  const firstExec = [];

  let isConditionnelA = false;
  let isConditionnelD = false;
  let isConditionnelV = false;

  const attaquesSurprises = [];
  const attaquesSurprisesValue = [];
  let attaquesSurprisesCondition = '';

  const bDegats = [];
  const autresEffets = [];

  let rCadence = 0;
  let vCadence = 0;
  let eASAssassin = '';
  let eASAssassinValue = 0;

  let eLumiereS = '';
  let eLumiereValue = 0;

  let isAntiAnatheme = false;
  let isAssistantAttaque = false;
  let isAkimbo = false;
  let isAmbidextrie = false;
  let isCadence = false;
  const isChoc = false;
  let isDestructeur = false;
  let isDeuxMains = false;
  let isLeste = false;
  let isLourd = false;
  let isELumiere = false;
  let isMeurtrier = false;
  let isObliteration = false;
  let isOrfevrerie = false;
  let isSilencieux = false;
  let isTenebricide = false;
  let isTirRafale = false;
  let isUltraviolence = false;
  let isFureur = false;

  const eAnatheme = isApplied(effet[`${prefix}anatheme`]);
  const eAntiAnatheme = isApplied(effet[`${prefix}antiAnatheme`]);
  const eAntiVehicule = isApplied(effet[`${prefix}antiVehicule`]);
  const eArtillerie = isApplied(effet[`${prefix}artillerie`]);
  const eAssassin = isApplied(effet[`${prefix}assassin`]);
  const eAssassinV = effet[`${prefix}assassinValue`] || 0;
  const eAssistanceAttaque = isApplied(effet[`${prefix}assistanceAttaque`]);
  const eBarrage = isApplied(effet[`${prefix}barrage`]);
  const eBarrageV = effet[`${prefix}barrageValue`] || 0;
  const eCadence = isApplied(effet[`${prefix}cadence`]);
  const eCadenceV = effet[`${prefix}cadenceValue`] || 0;
  const eChargeur = isApplied(effet[`${prefix}eChargeur`]);
  const eChargeurV = effet[`${prefix}chargeurValue`] || 0;
  const eChoc = isApplied(effet[`${prefix}choc`]);
  const eChocV = effet[`${prefix}chocValue`] || 0;
  const eDefense = isApplied(effet[`${prefix}eDefense`]);
  const eDefenseV = effet[`${prefix}defenseValue`] || 0;
  const eDegatsContinus = isApplied(effet[`${prefix}degatContinue`]);
  const eDegatsContinusV = effet[`${prefix}degatContinueValue`] || 0;
  const eDeuxMains = isApplied(effet[`${prefix}deuxMains`]);
  const eDemoralisant = isApplied(effet[`${prefix}eDemoralisant`]);
  const eDesignation = isApplied(effet[`${prefix}designation`]);
  const eDestructeur = isApplied(effet[`${prefix}destructeur`]);
  const eDestructeurV = 2;
  const eDispersion = isApplied(effet[`${prefix}dispersion`]);
  const eDispersionV = effet[`${prefix}dispersionValue`] || 0;
  const eEnChaine = isApplied(effet[`${prefix}enChaine`]);
  const eEsperance = isApplied(effet[`${prefix}esperance`]);
  const eFureur = isApplied(effet[`${prefix}fureur`]);
  const eFureurV = 4;
  const eIgnoreArmure = isApplied(effet[`${prefix}ignoreArmure`]);
  const eIgnoreCDF = isApplied(effet[`${prefix}ignoreCdF`]);
  const eJAkimbo = isApplied(effet[`${prefix}akimbo`]);
  const eJAmbidextrie = isApplied(effet[`${prefix}ambidextrie`]);
  const eLeste = isApplied(effet[`${prefix}leste`]);
  const eLourd = isApplied(effet[`${prefix}lourd`]);
  const eLumiere = isApplied(effet[`${prefix}lumiere`]);
  const eLumiereV = effet[`${prefix}lumiereValue`] || 0;
  const eMeurtrier = isApplied(effet[`${prefix}meurtrier`]);
  const eMeurtrierV = 2;
  const eObliteration = isApplied(effet[`${prefix}obliteration`]);
  const eOrfevrerie = isApplied(effet[`${prefix}orfevrerie`]);
  const eParasitage = isApplied(effet[`${prefix}parasitage`]);
  const eParasitageV = effet[`${prefix}parasitageValue`] || 0;
  const ePenetrant = isApplied(effet[`${prefix}penetrant`]);
  const ePenetrantV = effet[`${prefix}penetrantValue`] || 0;
  const ePerceArmure = isApplied(effet[`${prefix}perceArmure`]);
  const ePerceArmureV = effet[`${prefix}perceArmureValue`] || 0;
  const ePrecision = isApplied(effet[`${prefix}precision`]);
  const eReaction = isApplied(effet[`${prefix}reaction`]);
  const eReactionV = effet[`${prefix}reactionValue`] || 0;
  const eSilencieux = isApplied(effet[`${prefix}silencieux`]);
  const eSoumission = isApplied(effet[`${prefix}soumission`]);
  const eTenebricide = isApplied(effet[`${prefix}tenebricite`]);
  const eTirRafale = isApplied(effet[`${prefix}tirRafale`]);
  const eTirSecurite = isApplied(effet[`${prefix}tirSecurite`]);
  const eUltraviolence = isApplied(effet[`${prefix}ultraViolence`]);
  const eUltraviolenceV = 2;

  if (eAntiAnatheme) {
    isConditionnelD = true;
    isConditionnelV = true;

    exec.push(`{{antiAnatheme=${i18n_antiAnatheme}}} {{antiAnathemeCondition=${i18n_antiAnathemeCondition}}}`);

    isAntiAnatheme = true;
  }

  if (eAssistanceAttaque) {
    isConditionnelD = true;
    isConditionnelV = true;

    exec.push(`{{assistanceAttaque=${i18n_assistanceAttaque}}} {{assistanceAttaqueCondition=${i18n_assistanceAttaqueCondition}}}`);

    isAssistantAttaque = true;
  }

  if (eArtillerie) {
    isConditionnelA = true;

    exec.push(`{{artillerie=${i18n_artillerie}}} {{artillerieCondition=${i18n_artillerieCondition}}}`);
  }

  if (eAssassin) {
    isConditionnelD = true;

    eASAssassin = i18n_assassin;
    eASAssassinValue = eAssassinV;

    if (attaquesSurprisesCondition === '') { attaquesSurprisesCondition = `{{attaqueSurpriseCondition=${i18n_attaqueSurpriseCondition}}}`; }
  }

  if (eCadence) {
    rCadence = '?{Plusieurs cibles ?|Oui, 3|Non, 0}';
    isCadence = true;
    vCadence = eCadenceV;
  }

  if (eChoc) {
    isConditionnelA = true;

    exec.push(`{{choc=${i18n_choc} ${eChocV}}} {{chocCondition=${i18n_chocCondition}}}`);
  }

  if (eDemoralisant) {
    isConditionnelA = true;

    exec.push(`{{demoralisant=${i18n_demoralisant}}} {{demoralisantCondition=${i18n_demoralisantCondition}}}`);
  }

  if (eDestructeur) {
    isConditionnelD = true;

    firstExec.push(`{{destructeurValue=[[${eDestructeurV}D6]]}}`);

    exec.push(`{{destructeur=${i18n_destructeur}}} {{destructeurCondition=${i18n_destructeurCondition}}}`);

    isDestructeur = true;
  }

  if (eEnChaine) {
    isConditionnelD = true;

    exec.push(`{{enChaine=${i18n_enChaine}}} {{enChaineCondition=${i18n_enChaineCondition}}}`);
  }

  if (eEsperance) {
    isConditionnelD = true;
    isConditionnelV = true;

    exec.push(`{{esperance=${i18n_esperance}}} {{esperanceConditionD=${i18n_esperanceConditionD}}} {{esperanceConditionV=${i18n_esperanceConditionV}}}`);
  }

  if (eFureur) {
    isConditionnelV = true;
    isFureur = true;

    firstExec.push(`{{fureurValue=[[${eFureurV}D6]]}}`);

    exec.push(`{{fureur=${i18n_fureur}}} {{fureurCondition=${i18n_fureurCondition}}}`);
  }

  if (eLeste) {
    autresEffets.push(i18n_leste);
    isLeste = true;
  }

  if (eMeurtrier) {
    isConditionnelD = true;

    firstExec.push(`{{meurtrierValue=[[${eMeurtrierV}D6]]}}`);

    exec.push(`{{meurtrier=${i18n_meurtrier}}} {{meurtrierCondition=${i18n_meurtrierCondition}}}`);

    isMeurtrier = true;
  }

  if (eObliteration) {
    isConditionnelD = true;

    exec.push(`{{obliteration=${i18n_obliteration}}} {{obliterationCondition=${i18n_obliterationCondition}}}`);

    isObliteration = true;
  }

  if (eOrfevrerie) {
    autresEffets.push(i18n_orfevrerie);

    isOrfevrerie = true;
  }

  if (eParasitage) {
    isConditionnelA = true;

    exec.push(`{{parasitage=${i18n_parasitage} ${eParasitageV}}} {{parasitageCondition=${i18n_parasitageCondition}}}`);
  }

  if (ePrecision) {
    isConditionnelD = true;

    autresEffets.push(i18n_precision);
  }

  if (eSilencieux) {
    isConditionnelD = true;

    autresEffets.push(i18n_silencieux);

    isSilencieux = true;
  }

  if (eSoumission) {
    isConditionnelA = true;

    exec.push(`{{soumission=${i18n_soumission}}} {{soumissionCondition=${i18n_soumissionCondition}}}`);
  }

  if (eTenebricide) {
    isConditionnelD = true;
    isConditionnelV = true;

    exec.push(`{{tenebricide=${i18n_tenebricide}}} {{tenebricideConditionD=${i18n_tenebricideConditionD}}} {{tenebricideConditionV=${i18n_tenebricideConditionV}}}`);

    isTenebricide = true;
  }

  if (eTirRafale) {
    isConditionnelD = true;
    isTirRafale = true;

    exec.push(`{{tirRafale=${i18n_tirRafale}}} {{tirRafaleCondition=${i18n_tirRafaleCondition}}}`);
  }

  if (eUltraviolence) {
    isConditionnelV = true;
    isUltraviolence = true;

    firstExec.push(`{{ultraviolenceValue=[[${eUltraviolenceV}D6]]}}`);

    exec.push(`{{ultraviolence=${i18n_ultraviolence}}} {{ultraviolenceCondition=${i18n_ultraviolenceCondition}}}`);
  }

  if (eAnatheme) { autresEffets.push(i18n_anatheme); }

  if (eAntiVehicule) { autresEffets.push(i18n_antiVehicule); }

  if (eBarrage) { autresEffets.push(`${i18n_barrage} ${eBarrageV}`); }

  if (eChargeur) { autresEffets.push(`${i18n_chargeur} ${eChargeurV}`); }

  if (eDefense) { autresEffets.push(`${i18n_defense} ${eDefenseV}`); }

  if (eDegatsContinus) { autresEffets.push(`${i18n_degatsContinus} ${eDegatsContinusV} ([[1d6]] ${i18n_tours})`); }

  if (eDeuxMains) {
    autresEffets.push(i18n_deuxMains);
    isDeuxMains = true;
  }

  if (eDesignation) { autresEffets.push(i18n_designation); }

  if (eDispersion) { autresEffets.push(`${i18n_dispersion} ${eDispersionV}`); }

  if (eIgnoreArmure) { autresEffets.push(i18n_ignoreArmure); }

  if (eIgnoreCDF) { autresEffets.push(i18n_ignoreCDF); }

  if (eJAkimbo) {
    isAkimbo = true;
    autresEffets.push(i18n_jAkimbo);
  }

  if (eJAmbidextrie) {
    isAmbidextrie = true;
    autresEffets.push(i18n_jAmbidextrie);
  }

  if (eLourd) {
    autresEffets.push(i18n_lourd);
    isLourd = true;
  }

  if (eLumiere) {
    eLumiereS = i18n_lumiere;
    eLumiereValue = eLumiereV;
    isELumiere = true;
  }

  if (ePenetrant) { autresEffets.push(`${i18n_penetrant} ${ePenetrantV}`); }

  if (ePerceArmure) { autresEffets.push(`${i18n_perceArmure} ${ePerceArmureV}`); }

  if (eReaction) { autresEffets.push(`${i18n_reaction} ${eReactionV}`); }

  if (eTirSecurite) { autresEffets.push(i18n_tirSecurite); }

  result.isConditionnelA = isConditionnelA;
  result.isConditionnelD = isConditionnelD;
  result.isConditionnelV = isConditionnelV;

  result.eASAssassin = eASAssassin;
  result.eASAssassinValue = eASAssassinValue;
  result.isCadence = isCadence;
  result.sCadence = rCadence;
  result.vCadence = vCadence;
  result.isTenebricide = isTenebricide;
  result.isObliteration = isObliteration;
  result.isMeurtrier = isMeurtrier;
  result.vMeurtrier = eMeurtrierV;
  result.isDestructeur = isDestructeur;
  result.vDestructeur = eDestructeurV;
  result.nowSilencieux = isSilencieux;
  result.isChoc = isChoc;
  result.isLeste = isLeste;
  result.isOrfevrerie = isOrfevrerie;
  result.isAssistantAttaque = isAssistantAttaque;
  result.isAntiAnatheme = isAntiAnatheme;
  result.isTirRafale = isTirRafale;
  result.isFureur = isFureur;
  result.isUltraviolence = isUltraviolence;

  result.eLumiere = eLumiere;
  result.isELumiere = isELumiere;
  result.eLumiereValue = eLumiereValue;

  result.isAkimbo = isAkimbo;
  result.isAmbidextrie = isAmbidextrie;
  result.isDeuxMains = isDeuxMains;
  result.isLourd = isLourd;

  result.attaquesSurprises = attaquesSurprises;
  result.attaquesSurprisesValue = attaquesSurprisesValue;
  result.attaquesSurprisesCondition = attaquesSurprisesCondition;

  result.bDegats = bDegats;

  result.exec = exec;
  result.firstExec = firstExec;
  result.autresEffets = autresEffets;

  return result;
}

function getWeaponsContactAS(prefix, AS, hasArmure, isSilencieux, isMeurtrier, isAssistantAttaque, isChoc, isLeste, isOrfevrerie, vForce, vDexterite, oDexterite, vDiscretion, oDiscretion, vCombat, oCombat) {
  const result = {};
  const exec = [];

  let isConditionnelA = false;
  let isConditionnelD = false;
  let isConditionnelV = false;

  const attaquesSurprises = [];
  const attaquesSurprisesValue = [];
  let attaquesSurprisesCondition = '';

  let aLumiere = '';
  let aLumiereValue = 0;

  let nowAgressive = false;
  let nowProtectrice = false;
  let nowSoeur = false;
  let nowJumelle = false;
  let nowAllegee = false;

  const bAttaque = [];
  let diceDegats = 0;
  const bDegats = [];
  const autresAmeliorations = [];

  const aAgressive = isApplied(AS[`${prefix}agressive`]);
  const aAllegee = isApplied(AS[`${prefix}allegee`]);
  const aAssassine = isApplied(AS[`${prefix}assassine`]);
  const aBarbelee = isApplied(AS[`${prefix}barbelee`]);
  const aBarbeleeV = 2;
  const aConnectee = isApplied(AS[`${prefix}connectee`]);
  const aElectrifiee = isApplied(AS[`${prefix}electrifiee`]);
  const aIndestructible = isApplied(AS[`${prefix}indestructible`]);
  const aJumelle = isApplied(AS[`${prefix}jumelle`]);
  const aLumineuse = isApplied(AS[`${prefix}lumineuse`]);
  const aMassive = isApplied(AS[`${prefix}massive`]);
  const aProtectrice = isApplied(AS[`${prefix}protectrice`]);
  const aSoeur = isApplied(AS[`${prefix}soeur`]);
  const aSournoise = isApplied(AS[`${prefix}sournoise`]);
  const aSurmesure = isApplied(AS[`${prefix}surmesure`]);

  if (aAgressive) {
    nowAgressive = true;
  }

  if (aAllegee) {
    exec.push('{{vAllegee=-1D6}}');
    diceDegats -= 1;
    nowAllegee = true;
  }

  if (aAssassine) {
    if (isSilencieux) { autresAmeliorations.push(i18n_assassine); } else {
      const ghost = +AS.rogueGhost;
      const MALghost = +AS.MALRogueGhost;
      const changeling = +AS.bardChangeling;
      const MALchangeling = +AS.MALBardChangeling;

      let totalAssassine = vDiscretion;

      if (hasArmure) { totalAssassine += oDiscretion; }

      if (hasArmure && ghost !== 0) {
        exec.push(`{{vAssassineD=${totalAssassine}}}`);
        bDegats.push(totalAssassine);
      } else if (hasArmure && MALghost !== 0) {
        exec.push(`{{vAssassineD=${totalAssassine}}}`);
        bDegats.push(totalAssassine);
      } else if (hasArmure && changeling !== 0) {
        exec.push(`{{vAssassineD=${totalAssassine}}}`);
        bDegats.push(totalAssassine);
      } else if (hasArmure && MALchangeling !== 0) {
        exec.push(`{{vAssassineD=${totalAssassine}}}`);
        bDegats.push(totalAssassine);
      } else {
        isConditionnelD = true;
        attaquesSurprises.push(i18n_assassine);
        attaquesSurprisesValue.push(totalAssassine);

        if (attaquesSurprisesCondition === '') { attaquesSurprisesCondition = `{{attaqueSurpriseCondition=${i18n_attaqueSurpriseCondition}}}`; }
      }
    }
  }

  if (aBarbelee) {
    if (isMeurtrier) { autresAmeliorations.push(i18n_barbelee); } else {
      isConditionnelD = true;

      exec.push(`{{meurtrier=${i18n_barbelee}}} {{meurtrierValue=[[${aBarbeleeV}D6]]}} {{meurtrierCondition=${i18n_meurtrierCondition}}}`);
    }
  }

  if (aConnectee) {
    if (isAssistantAttaque) { autresAmeliorations.push(i18n_connectee); } else {
      isConditionnelD = true;
      isConditionnelV = true;

      exec.push(`{{assistanceAttaque=${i18n_connectee}}} {{assistanceAttaqueCondition=${i18n_assistanceAttaqueCondition}}}`);
    }
  }

  if (aElectrifiee) {
    if (isChoc) { autresAmeliorations.push(i18n_electrifiee); } else {
      isConditionnelA = true;

      exec.push(`{{choc=${i18n_electrifiee} 1}} {{chocCondition=${i18n_chocCondition}}}`);
    }
  }

  if (aMassive) {
    if (isLeste) { autresAmeliorations.push(i18n_massive); } else {
      bDegats.push(vForce);
      exec.push(`{{vMassive=${vForce}}}`);
    }
  }

  if (aProtectrice) {
    autresAmeliorations.push(i18n_protectrice);
    nowProtectrice = true;
  }

  if (aJumelle) {
    autresAmeliorations.push(i18n_jumelle);
    nowJumelle = true;
  }

  if (aSoeur) {
    autresAmeliorations.push(i18n_soeur);
    nowSoeur = true;
  }

  if (aSournoise) {
    if (isOrfevrerie) { autresAmeliorations.push(i18n_sournoise); } else {
      let vSournoise = vDexterite;

      if (hasArmure) { vSournoise += oDexterite; }

      bDegats.push(vSournoise);
      exec.push(`{{vSournoise=${vSournoise}}}`);
    }
  }

  if (aSurmesure) {
    let vSurMesure = vCombat;

    if (hasArmure) { vSurMesure += oCombat; }

    bDegats.push(vSurMesure);
    exec.push(`{{vSurMesure=${vSurMesure}}}`);
  }

  if (aIndestructible) { autresAmeliorations.push(i18n_indestructible); }

  if (aLumineuse) {
    aLumiere = i18n_lumineuse;
    aLumiereValue = 2;
  }

  result.isConditionnelA = isConditionnelA;
  result.isConditionnelD = isConditionnelD;
  result.isConditionnelV = isConditionnelV;

  result.isAgressive = nowAgressive;
  result.isSoeur = nowSoeur;
  result.isJumelle = nowJumelle;
  result.isProtectrice = nowProtectrice;
  result.isAllegee = nowAllegee;

  result.aLumiere = aLumiere;
  result.aLumiereValue = aLumiereValue;

  result.attaquesSurprises = attaquesSurprises;
  result.attaquesSurprisesValue = attaquesSurprisesValue;
  result.attaquesSurprisesCondition = attaquesSurprisesCondition;

  result.bAttaque = bAttaque;
  result.diceDegats = diceDegats;
  result.bDegats = bDegats;

  result.exec = exec;
  result.autresAmeliorations = autresAmeliorations;

  return result;
}

function getWeaponsContactASPNJ(prefix, data, isAssistanceAttaque, isChoc, isLeste, isMeurtrier, isOrfevrerie, isSilencieux, vBete, vChair, vMasque, vMasqueAE) {
  const result = {};
  const exec = [];

  let isConditionnelA = false;
  let isConditionnelD = false;
  let isConditionnelV = false;

  const attaquesSurprises = [];
  const attaquesSurprisesValue = [];
  let attaquesSurprisesCondition = '';

  const bAttaque = [];
  let diceDegats = 0;
  let bDegats = 0;
  const autresAmeliorations = [];

  const aAgressive = isApplied(data[`${prefix}agressive`]);
  const aAllegee = isApplied(data[`${prefix}allegee`]);
  const aAssassine = isApplied(data[`${prefix}assassine`]);
  const aBarbelee = isApplied(data[`${prefix}barbelee`]);
  const aBarbeleeV = 2;
  const aConnectee = isApplied(data[`${prefix}connectee`]);
  const aElectrifiee = isApplied(data[`${prefix}electrifiee`]);
  const aIndestructible = isApplied(data[`${prefix}indestructible`]);
  const aJumelle = isApplied(data[`${prefix}jumelle`]);
  const aLumineuse = isApplied(data[`${prefix}lumineuse`]);
  const aMassive = isApplied(data[`${prefix}massive`]);
  const aProtectrice = isApplied(data[`${prefix}protectrice`]);
  const aSoeur = isApplied(data[`${prefix}soeur`]);
  const aSournoise = isApplied(data[`${prefix}sournoisePNJ`]);
  const aSurmesure = isApplied(data[`${prefix}surmesurePNJ`]);

  if (aAllegee) {
    exec.push('{{vAllegee=-1D6}}');
    diceDegats -= 1;
  }

  if (aAssassine) {
    if (isSilencieux) { autresAmeliorations.push(i18n_assassine); } else {
      const totalAssassine = Math.ceil(vMasque / 2) + vMasqueAE;

      isConditionnelD = true;
      attaquesSurprises.push(i18n_assassine);
      attaquesSurprisesValue.push(totalAssassine);

      if (attaquesSurprisesCondition === '') { attaquesSurprisesCondition = `{{attaqueSurpriseCondition=${i18n_attaqueSurpriseCondition}}}`; }
    }
  }

  if (aBarbelee) {
    if (isMeurtrier) { autresAmeliorations.push(i18n_barbelee); } else {
      isConditionnelD = true;

      exec.push(`{{meurtrier=${i18n_barbelee}}} {{meurtrierValue=[[${aBarbeleeV}D6]]}} {{meurtrierCondition=${i18n_meurtrierCondition}}}`);
    }
  }

  if (aConnectee) {
    if (isAssistanceAttaque) { autresAmeliorations.push(i18n_connectee); } else {
      isConditionnelD = true;
      isConditionnelV = true;

      exec.push(`{{assistanceAttaque=${i18n_connectee}}} {{assistanceAttaqueCondition=${i18n_assistanceAttaqueCondition}}}`);
    }
  }

  if (aElectrifiee) {
    if (isChoc) { autresAmeliorations.push(i18n_electrifiee); } else {
      isConditionnelA = true;

      exec.push(`{{choc=${i18n_electrifiee} 1}} {{chocCondition=${i18n_chocCondition}}}`);
    }
  }

  if (aMassive) {
    if (isLeste) { autresAmeliorations.push(i18n_massive); } else {
      bDegats += Math.floor(vChair / 2);
      exec.push(`{{vMassive=${Math.floor(vChair / 2)}}}`);
    }
  }

  if (aSournoise) {
    if (isOrfevrerie) { autresAmeliorations.push(i18n_sournoise); } else {
      const vSournoise = Math.ceil(vMasque / 2);

      bDegats += vSournoise;
      exec.push(`{{vSournoise=${vSournoise}}}`);
    }
  }

  if (aSurmesure) {
    const vSurMesure = Math.ceil(vBete / 2);

    bDegats.push(vSurMesure);
    exec.push(`{{vSurMesure=${vSurMesure}}}`);
  }

  if (aAgressive) { autresAmeliorations.push(i18n_agressive); }

  if (aIndestructible) { autresAmeliorations.push(i18n_indestructible); }

  if (aJumelle) { autresAmeliorations.push(i18n_jumelle); }

  if (aProtectrice) { autresAmeliorations.push(i18n_protectrice); }

  if (aSoeur) { autresAmeliorations.push(i18n_soeur); }

  if (aLumineuse) { autresAmeliorations.push(`${i18n_lumineuse} (${i18n_lumiere} 2)`); }

  result.isConditionnelA = isConditionnelA;
  result.isConditionnelD = isConditionnelD;
  result.isConditionnelV = isConditionnelV;

  result.attaquesSurprises = attaquesSurprises;
  result.attaquesSurprisesValue = attaquesSurprisesValue;
  result.attaquesSurprisesCondition = attaquesSurprisesCondition;

  result.bAttaque = bAttaque;
  result.diceDegats = diceDegats;
  result.bDegats = bDegats;

  result.exec = exec;
  result.autresAmeliorations = autresAmeliorations;

  return result;
}

function getWeaponsContactAO(prefix, AO, isCadence, vCadence, isObliteration, isAntiAnatheme) {
  const result = {};
  const exec = [];
  const firstExec = [];

  const isConditionnelA = false;
  let isConditionnelD = false;
  let isConditionnelV = false;

  let aLumiere = '';
  let aLumiereValue = 0;

  let isChromee = false;
  const isCraneRieur = false;
  let isArmeAzurine = false;
  let vArmeAzurine = 0;
  let isArmeRougeSang = false;
  let vArmeRougeSang = 0;
  let isCheneSculpte = false;
  let vCheneSculpte = 0;
  let isGriffureGravee = false;
  let vGriffureGravee = 0;
  let isMasqueBrise = false;
  let vMasqueBrise = 0;
  let isRouagesCasses = false;
  let vRouagesCasses = 0;

  let rCadence = '';
  let CadenceValue = 0;

  let nowObliteration = false;

  let diceDegats = 0;
  let diceViolence = 0;
  const bDegats = [];
  const autresAmeliorations = [];

  const aArabesques = isApplied(AO[`${prefix}arabesquesIridescentes`]);
  const aArmeAzurine = isApplied(AO[`${prefix}armeAzurine`]);
  const aArmeRougeSang = isApplied(AO[`${prefix}armeRougeSang`]);
  const aArmureGravee = isApplied(AO[`${prefix}armureGravee`]);
  const aBlasonChevalier = isApplied(AO[`${prefix}blasonChevalier`]);
  const aBouclierGrave = isApplied(AO[`${prefix}bouclierGrave`]);
  const aCheneSculpte = isApplied(AO[`${prefix}cheneSculpte`]);
  const aChromeeLignesLC = isApplied(AO[`${prefix}chromeeLignesLC`]);
  const aCodeKnightGrave = isApplied(AO[`${prefix}codeKnightGrave`]);
  const aCraneRieurGrave = isApplied(AO[`${prefix}craneRieurGrave`]);
  const aFaucheuseGravee = isApplied(AO[`${prefix}faucheuseGravee`]);
  const aFauconsPlumesL = isApplied(AO[`${prefix}fauconsPlumesL`]);
  const aFlammesStylisees = isApplied(AO[`${prefix}flammesStylisees`]);
  const aGriffuresGravees = isApplied(AO[`${prefix}griffuresGravees`]);
  const aMasqueBriseSculpte = isApplied(AO[`${prefix}masqueBriseSculpte`]);
  const aRouagesCassesGraves = isApplied(AO[`${prefix}rouagesCassesGraves`]);
  const aSillonsFLF = isApplied(AO[`${prefix}sillonsFLF`]);

  if (aArabesques) {
    aLumiere = i18n_arabesques;
    aLumiereValue = 1;
  }

  if (aArmeAzurine) {
    isConditionnelD = true;
    isConditionnelV = true;
    isArmeAzurine = true;
    vArmeAzurine = 1;

    exec.push(`{{armeAzurine=${i18n_armeAzurine}}} {{armeAzurineValueD=[[1D6]]}} {{armeAzurineValueV=[[1D6]]}} {{armeAzurineCondition=${i18n_armeAzurineCondition}}}`);
  }

  if (aArmeRougeSang) {
    isConditionnelD = true;
    isArmeRougeSang = true;
    vArmeRougeSang = 1;

    exec.push(`{{armeRougeSang=${i18n_armeRougeSang}}} {{armeRougeSangValueD=[[1D6]]}} {{armeRougeSangValueV=[[1D6]]}} {{armeRougeSangCondition=${i18n_armeRougeSangCondition}}}`);
  }

  if (aCheneSculpte) {
    isConditionnelD = true;
    isCheneSculpte = true;
    vCheneSculpte = 2;

    firstExec.push('{{cheneSculpteValue=[[2D6]]}}');

    exec.push(`{{cheneSculpte=${i18n_cheneSculpte}}} {{cheneSculpteCondition=${i18n_cheneSculpteCondition}}}`);
  }

  if (aChromeeLignesLC) {
    if (isCadence === true && vCadence >= 2) { autresAmeliorations.push(i18n_chromee); } else {
      rCadence = '?{Plusieurs cibles ?|Oui, 3|Non, 0}';
      isChromee = true;
      CadenceValue = 2;
    }
  }

  if (aCraneRieurGrave) {
    if (isObliteration) { autresAmeliorations.push(i18n_craneRieur); } else {
      isConditionnelD = true;

      exec.push(`{{obliteration=${i18n_craneRieur}}} {{obliterationCondition=${i18n_obliterationCondition}}}`);

      nowObliteration = true;
    }
  }

  if (aFaucheuseGravee) {
    diceDegats += 1;
    exec.push('{{vFaucheuse=+1D6}}');
  }

  if (aFauconsPlumesL) {
    if (isAntiAnatheme) { autresAmeliorations.push(i18n_fauconPlumesL); } else {
      isConditionnelD = true;
      isConditionnelV = true;

      exec.push(`{{antiAnatheme=${i18n_fauconPlumesL}}} {{antiAnathemeCondition=${i18n_antiAnathemeCondition}}}`);
    }
  }

  if (aFlammesStylisees) {
    diceViolence += 1;
    exec.push('{{vFlammesStylisees=+1D6}}');
  }

  if (aGriffuresGravees) {
    isConditionnelD = true;
    isConditionnelV = true;
    isGriffureGravee = true;
    vGriffureGravee = 1;

    exec.push(`{{griffuresGravees=${i18n_griffuresGravees}}} {{griffuresGraveesValueD=[[1D6]]}} {{griffuresGraveesValueV=[[1D6]]}} {{griffuresGraveesCondition=${i18n_griffuresGraveesCondition}}}`);
  }

  if (aMasqueBriseSculpte) {
    isConditionnelD = true;
    isConditionnelV = true;
    isMasqueBrise = true;
    vMasqueBrise = 1;

    exec.push(`{{masqueBrise=${i18n_masqueBrise}}} {{masqueBriseValueD=[[1D6]]}} {{masqueBriseValueV=[[1D6]]}} {{masqueBriseCondition=${i18n_masqueBriseCondition}}}`);
  }

  if (aRouagesCassesGraves) {
    isConditionnelD = true;
    isConditionnelV = true;
    isRouagesCasses = true;
    vRouagesCasses = 1;

    exec.push(`{{rouagesCasses=${i18n_rouagesCasses}}} {{rouagesCassesValueD=[[1D6]]}} {{rouagesCassesValueV=[[1D6]]}} {{rouagesCassesCondition=${i18n_rouagesCassesCondition}}}`);
  }

  if (aSillonsFLF) {
    bDegats.push(3);
    exec.push('{{vSillonsFLF=+3}}');
  }

  if (aArmureGravee) { autresAmeliorations.push(i18n_armureGravee); }

  if (aBlasonChevalier) { autresAmeliorations.push(i18n_blasonChevalier); }

  if (aBouclierGrave) { autresAmeliorations.push(i18n_bouclierGrave); }

  if (aCodeKnightGrave) { autresAmeliorations.push(i18n_codeKnight); }

  result.isConditionnelA = isConditionnelA;
  result.isConditionnelD = isConditionnelD;
  result.isConditionnelV = isConditionnelV;

  result.isChromee = isChromee;
  result.isCraneRieur = isCraneRieur;
  result.isObliteration = nowObliteration;

  result.isArmeAzurine = isArmeAzurine;
  result.vArmeAzurine = vArmeAzurine;

  result.isArmeRougeSang = isArmeRougeSang;
  result.vArmeRougeSang = vArmeRougeSang;

  result.isCheneSculpte = isCheneSculpte;
  result.vCheneSculpte = vCheneSculpte;

  result.isGriffureGravee = isGriffureGravee;
  result.vGriffureGravee = vGriffureGravee;

  result.isMasqueBrise = isMasqueBrise;
  result.vMasqueBrise = vMasqueBrise;

  result.isRouagesCasses = isRouagesCasses;
  result.vRouagesCasses = vRouagesCasses;

  result.aLumiere = aLumiere;
  result.aLumiereValue = aLumiereValue;

  result.rCadence = rCadence;
  result.vCadence = CadenceValue;

  result.diceDegats = diceDegats;
  result.bDegats = bDegats;
  result.diceViolence = diceViolence;

  result.exec = exec;
  result.firstExec = firstExec;
  result.autresAmeliorations = autresAmeliorations;

  return result;
}

function getWeaponsContactAOPNJ(prefix, data, isCadence, vCadence, isObliteration, isAntiAnatheme) {
  const result = {};
  const exec = [];
  const firstExec = [];

  const isConditionnelA = false;
  let isConditionnelD = false;
  let isConditionnelV = false;

  let isChromee = false;
  const isCraneRieur = false;
  let isArmeAzurine = false;
  let vArmeAzurine = 0;
  let isArmeRougeSang = false;
  let vArmeRougeSang = 0;
  let isCheneSculpte = false;
  let vCheneSculpte = 0;
  let isGriffureGravee = false;
  let vGriffureGravee = 0;
  let isMasqueBrise = false;
  let vMasqueBrise = 0;
  let isRouagesCasses = false;
  let vRouagesCasses = 0;

  let rCadence = '0';
  let CadenceValue = 0;

  let nowObliteration = false;

  let diceDegats = 0;
  let diceViolence = 0;
  let bDegats = 0;
  const autresAmeliorations = [];

  const aArabesques = isApplied(data[`${prefix}arabesquesIridescentes`]);
  const aArmeAzurine = isApplied(data[`${prefix}armeAzurine`]);
  const aArmeRougeSang = isApplied(data[`${prefix}armeRougeSang`]);
  const aArmureGravee = isApplied(data[`${prefix}armureGravee`]);
  const aBlasonChevalier = isApplied(data[`${prefix}blasonChevalier`]);
  const aBouclierGrave = isApplied(data[`${prefix}bouclierGrave`]);
  const aCheneSculpte = isApplied(data[`${prefix}cheneSculpte`]);
  const aChromeeLignesLC = isApplied(data[`${prefix}chromeeLignesLC`]);
  const aCodeKnightGrave = isApplied(data[`${prefix}codeKnightGrave`]);
  const aCraneRieurGrave = isApplied(data[`${prefix}craneRieurGrave`]);
  const aFaucheuseGravee = isApplied(data[`${prefix}faucheuseGravee`]);
  const aFauconsPlumesL = isApplied(data[`${prefix}fauconsPlumesL`]);
  const aFlammesStylisees = isApplied(data[`${prefix}flammesStylisees`]);
  const aGriffuresGravees = isApplied(data[`${prefix}griffuresGravees`]);
  const aMasqueBriseSculpte = isApplied(data[`${prefix}masqueBriseSculpte`]);
  const aRouagesCassesGraves = isApplied(data[`${prefix}rouagesCassesGraves`]);
  const aSillonsFLF = isApplied(data[`${prefix}sillonsFLF`]);

  if (aArmeAzurine) {
    isConditionnelD = true;
    isConditionnelV = true;
    isArmeAzurine = true;
    vArmeAzurine = 1;

    exec.push(`{{armeAzurine=${i18n_armeAzurine}}} {{armeAzurineValueD=[[1D6]]}} {{armeAzurineValueV=[[1D6]]}} {{armeAzurineCondition=${i18n_armeAzurineCondition}}}`);
  }

  if (aArmeRougeSang) {
    isConditionnelD = true;
    isArmeRougeSang = true;
    vArmeRougeSang = 1;

    exec.push(`{{armeRougeSang=${i18n_armeRougeSang}}} {{armeRougeSangValueD=[[1D6]]}} {{armeRougeSangValueV=[[1D6]]}} {{armeRougeSangCondition=${i18n_armeRougeSangCondition}}}`);
  }

  if (aCheneSculpte) {
    isConditionnelD = true;
    isCheneSculpte = true;
    vCheneSculpte = 2;

    firstExec.push('{{cheneSculpteValue=[[2D6]]}}');

    exec.push(`{{cheneSculpte=${i18n_cheneSculpte}}} {{cheneSculpteCondition=${i18n_cheneSculpteCondition}}}`);
  }

  if (aChromeeLignesLC) {
    if (isCadence === true && vCadence >= 2) { autresAmeliorations.push(i18n_chromee); } else {
      rCadence = '?{Plusieurs cibles ?|Oui, 3|Non, 0}';
      isChromee = true;
      CadenceValue = 2;
    }
  }

  if (aCraneRieurGrave) {
    if (isObliteration) { autresAmeliorations.push(i18n_craneRieur); } else {
      isConditionnelD = true;

      exec.push(`{{obliteration=${i18n_craneRieur}}} {{obliterationCondition=${i18n_obliterationCondition}}}`);

      nowObliteration = true;
    }
  }

  if (aFaucheuseGravee) {
    diceDegats += 1;
    exec.push('{{vFaucheuse=+1D6}}');
  }

  if (aFauconsPlumesL) {
    if (isAntiAnatheme) { autresAmeliorations.push(i18n_fauconPlumesL); } else {
      isConditionnelD = true;
      isConditionnelV = true;

      exec.push(`{{antiAnatheme=${i18n_fauconPlumesL}}} {{antiAnathemeCondition=${i18n_antiAnathemeCondition}}}`);
    }
  }

  if (aFlammesStylisees) {
    diceViolence += 1;
    exec.push('{{vFlammesStylisees=+1D6}}');
  }

  if (aGriffuresGravees) {
    isConditionnelD = true;
    isConditionnelV = true;
    isGriffureGravee = true;
    vGriffureGravee = 1;

    exec.push(`{{griffuresGravees=${i18n_griffuresGravees}}} {{griffuresGraveesValueD=[[1D6]]}} {{griffuresGraveesValueV=[[1D6]]}} {{griffuresGraveesCondition=${i18n_griffuresGraveesCondition}}}`);
  }

  if (aMasqueBriseSculpte) {
    isConditionnelD = true;
    isConditionnelV = true;
    isMasqueBrise = true;
    vMasqueBrise = 1;

    exec.push(`{{masqueBrise=${i18n_masqueBrise}}} {{masqueBriseValueD=[[1D6]]}} {{masqueBriseValueV=[[1D6]]}} {{masqueBriseCondition=${i18n_masqueBriseCondition}}}`);
  }

  if (aRouagesCassesGraves) {
    isConditionnelD = true;
    isConditionnelV = true;
    isRouagesCasses = true;
    vRouagesCasses = 1;

    exec.push(`{{rouagesCasses=${i18n_rouagesCasses}}} {{rouagesCassesValueD=[[1D6]]}} {{rouagesCassesValueV=[[1D6]]}} {{rouagesCassesCondition=${i18n_rouagesCassesCondition}}}`);
  }

  if (aSillonsFLF) {
    bDegats += 3;
    exec.push('{{vSillonsFLF=+3}}');
  }

  if (aArabesques) { autresAmeliorations.push(`${i18n_arabesques} (${i18n_lumiere} 1)`); }

  if (aArmureGravee) { autresAmeliorations.push(i18n_armureGravee); }

  if (aBlasonChevalier) { autresAmeliorations.push(i18n_blasonChevalier); }

  if (aBouclierGrave) { autresAmeliorations.push(i18n_bouclierGrave); }

  if (aCodeKnightGrave) { autresAmeliorations.push(i18n_codeKnight); }

  result.isConditionnelA = isConditionnelA;
  result.isConditionnelD = isConditionnelD;
  result.isConditionnelV = isConditionnelV;

  result.isChromee = isChromee;
  result.isCraneRieur = isCraneRieur;
  result.isObliteration = nowObliteration;

  result.isArmeAzurine = isArmeAzurine;
  result.vArmeAzurine = vArmeAzurine;

  result.isArmeRougeSang = isArmeRougeSang;
  result.vArmeRougeSang = vArmeRougeSang;

  result.isCheneSculpte = isCheneSculpte;
  result.vCheneSculpte = vCheneSculpte;

  result.isGriffureGravee = isGriffureGravee;
  result.vGriffureGravee = vGriffureGravee;

  result.isMasqueBrise = isMasqueBrise;
  result.vMasqueBrise = vMasqueBrise;

  result.isRouagesCasses = isRouagesCasses;
  result.vRouagesCasses = vRouagesCasses;

  result.rCadence = rCadence;
  result.vCadence = CadenceValue;

  result.diceDegats = diceDegats;
  result.bDegats = bDegats;
  result.diceViolence = diceViolence;

  result.exec = exec;
  result.firstExec = firstExec;
  result.autresAmeliorations = autresAmeliorations;

  return result;
}

function getWeaponsDistanceAA(prefix, AA, vDiscretion, oDiscretion, eAssistanceAttaque, eASAssassinValue, isCadence, vCadence, eSilencieux, eTirRafale, isObliteration, isAntiAnatheme) {
  const result = {};
  const exec = [];
  const armure = AA.armure;

  let hasArmure = true;

  let isConditionnelA = false;
  let isConditionnelD = false;
  let isConditionnelV = false;

  let isChambreDouble = false;
  let rChambreDouble = '';

  let isInterfaceGuidage = false;

  let isJAmbidextre = false;
  let isJAkimbo = false;

  let aASAssassin = '';
  let aASAssassinValue = 0;

  const bonus = [];
  let diceDegats = 0;
  let diceViolence = 0;
  const bDegats = [];
  const attaquesSurprises = [];
  let attaquesSurprisesCondition = '';
  const attaquesSurprisesValue = [];
  const autresAmeliorations = [];
  const autresEffets = [];

  const aChargeurGrappes = isApplied(AA[`${prefix}chargeurGrappes`]);
  const aCanonLong = isApplied(AA[`${prefix}canonLong`]);
  const aCanonRaccourci = isApplied(AA[`${prefix}canonRaccourci`]);
  const aChambreDouble = isApplied(AA[`${prefix}chambreDouble`]);
  const aInterfaceGuidage = isApplied(AA[`${prefix}interfaceGuidage`]);
  const aJumelage = isApplied(AA[`${prefix}jumelage`]);
  const aJumelageV = AA[`${prefix}jumelageValue`];
  const aJumelageT = AA[`${prefix}jumelageType`];
  const aLunetteIntelligente = isApplied(AA[`${prefix}lunetteIntelligente`]);
  const aMunitionsHyperVelocite = isApplied(AA[`${prefix}munitionsHyperVelocite`]);
  const aMunitionsDrone = isApplied(AA[`${prefix}munitionsDrone`]);
  const aChargeurExplosives = isApplied(AA[`${prefix}chargeurExplosives`]);
  const aMunitionsIEM = isApplied(AA[`${prefix}munitionsIEM`]);
  const aMunitionsNonLetales = isApplied(AA[`${prefix}munitionsNonLetales`]);
  const aMunitionsSubsoniques = isApplied(AA[`${prefix}munitionsSubsoniques`]);
  const aPointeurLaser = isApplied(AA[`${prefix}pointeurLaser`]);
  const aProtectionArme = isApplied(AA[`${prefix}protectionArme`]);
  const aRevetementOmega = isApplied(AA[`${prefix}revetementOmega`]);
  const aStructureElement = isApplied(AA[`${prefix}structureElement`]);
  const aSystemeRefroidissement = isApplied(AA[`${prefix}systemeRefroidissement`]);

  if (armure === 'sans' || armure === 'guardian') { hasArmure = false; }

  if (aChargeurGrappes) {
    diceDegats -= 1;
    diceViolence += 1;

    exec.push('{{vMGrappeD=-1D}} {{vMGrappeV=+1D}}');
  }

  if (aCanonLong) {
    isConditionnelA = true;

    exec.push(`{{canonLong=${i18n_canonLong}}} {{canonLongCondition=${i18n_canonLongCondition}}}`);
  }

  if (aCanonRaccourci) {
    isConditionnelA = true;

    exec.push(`{{canonRaccourci=${i18n_canonRaccourci}}} {{canonRaccourciCondition=${i18n_canonRaccourciCondition}}}`);
  }

  if (aChambreDouble) {
    if (isCadence && vCadence >= 2) { autresAmeliorations.push(i18n_chambreDouble); } else if (isCadence) {
      autresEffets.push(`${i18n_cadence} ${vCadence}`);
      rChambreDouble = '?{Plusieurs cibles ?|Oui, 3|Non, 0}';
      isChambreDouble = true;
    } else {
      rChambreDouble = '?{Plusieurs cibles ?|Oui, 3|Non, 0}';
      isChambreDouble = true;
    }
  }

  if (aInterfaceGuidage) {
    autresAmeliorations.push(i18n_interfaceGuidage);
    isInterfaceGuidage = true;
  }

  if (aJumelage) {
    if (aJumelageT === 'ambidextrie') {
      autresAmeliorations.push(`${i18n_jumelage} ${i18n_ambidextrie} (${aJumelageV})`);
      isJAmbidextre = true;
    } else if (aJumelageT === 'akimbo') {
      autresAmeliorations.push(`${i18n_jumelage} ${i18n_akimbo} (${aJumelageV})`);
      isJAkimbo = true;
    } else { autresAmeliorations.push(`${i18n_jumelage} (${aJumelageV})`); }
  }

  if (aLunetteIntelligente) {
    isConditionnelA = true;
    exec.push(`{{lunetteIntelligente=${i18n_lunetteIntelligente}}} {{lunetteIntelligenteCondition=${i18n_lunetteIntelligenteCondition}}}`);
  }

  if (aMunitionsHyperVelocite) {
    if (eAssistanceAttaque) { autresAmeliorations.push(i18n_munitionsHyperVelocite); } else {
      isConditionnelD = true;
      isConditionnelV = true;

      exec.push(`{{assistanceAttaque=${i18n_munitionsHyperVelocite}}} {{assistanceAttaqueCondition=${i18n_assistanceAttaqueCondition}}}`);
    }
  }

  if (aMunitionsDrone) {
    exec.push('{{vMDrone=+3}}');
    bonus.push(3);
  }

  if (aChargeurExplosives) {
    exec.push('{{vMExplosiveD=+1D6}} {{vMExplosiveV=-1D6}}');

    diceDegats += 1;
    diceViolence -= 1;
  }

  if (aMunitionsIEM) {
    exec.push('{{vMIEMD=-1D6}} {{vMIEMV=-1D6}}');

    diceDegats -= 1;
    diceViolence -= 1;
    autresAmeliorations.push(i18n_munitionsIEMParasitage);
  }

  if (aMunitionsSubsoniques) {
    if (eSilencieux) { autresAmeliorations.push(i18n_munitionsSubsoniques); } else {
      const ghost = +AA.rogueGhost;
      const MALghost = +AA.MALRogueGhost;
      const changeling = +AA.bardChangeling;
      const MALchangeling = +AA.MALBardChangeling;
      let totalSubsonique = vDiscretion;

      if (hasArmure) { totalSubsonique += oDiscretion; }

      if (hasArmure && ghost !== 0) {
        exec.push(`{{vSubsoniqueD=${totalSubsonique}}}`);
        bDegats.push(totalSubsonique);
      } else if (hasArmure && MALghost !== 0) {
        exec.push(`{{vSubsoniqueD=${totalSubsonique}}}`);
        bDegats.push(totalSubsonique);
      } else if (hasArmure && changeling !== 0) {
        exec.push(`{{vSubsoniqueD=${totalSubsonique}}}`);
        bDegats.push(totalSubsonique);
      } else if (hasArmure && MALchangeling !== 0) {
        exec.push(`{{vSubsoniqueD=${totalSubsonique}}}`);
        bDegats.push(totalSubsonique);
      } else {
        isConditionnelD = true;
        attaquesSurprises.push(i18n_munitionsSubsoniques);
        attaquesSurprisesValue.push(totalSubsonique);

        if (attaquesSurprisesCondition === '') { attaquesSurprisesCondition = `{{attaqueSurpriseCondition=${i18n_attaqueSurpriseCondition}}}`; }
      }
    }
  }

  if (aPointeurLaser) {
    exec.push('{{vMPLaser=+1}}');
    bonus.push(1);
  }

  if (aRevetementOmega) {
    if (eASAssassinValue < 2) {
      aASAssassin = i18n_revetementOmega;
      aASAssassinValue = 2;

      if (eASAssassinValue !== 0) { autresEffets.push(i18n_assassin); }
    } else if (eASAssassinValue > 2) { autresAmeliorations.push(i18n_revetementOmega); }
  }

  if (aSystemeRefroidissement) {
    if (!eTirRafale) { autresAmeliorations.push(`${i18n_systemeRefroidissement} (${i18n_barrage} 1)`); } else if (eTirRafale) { exec.push(`{{tirRafale=${i18n_systemeRefroidissement} + ${i18n_barrage} 1}} {{tirRafaleCondition=${i18n_tirRafaleCondition}}}`); }
  }

  if (aMunitionsNonLetales) { autresAmeliorations.push(i18n_munitionsNonLetales); }

  if (aProtectionArme) { autresAmeliorations.push(i18n_protectionArme); }

  if (aStructureElement) { autresAmeliorations.push(i18n_structureElementAlpha); }

  result.isConditionnelA = isConditionnelA;
  result.isConditionnelD = isConditionnelD;
  result.isConditionnelV = isConditionnelV;

  result.bonus = bonus;
  result.diceDegats = diceDegats;
  result.bDegats = bDegats;
  result.diceViolence = diceViolence;

  result.aASAssassin = aASAssassin;
  result.aASAssassinValue = aASAssassinValue;

  result.attaquesSurprises = attaquesSurprises;
  result.attaquesSurprisesValue = attaquesSurprisesValue;
  result.attaquesSurprisesCondition = attaquesSurprisesCondition;

  result.isChambreDouble = isChambreDouble;
  result.rChambreDouble = rChambreDouble;
  result.isJAmbidextre = isJAmbidextre;
  result.isJAkimbo = isJAkimbo;

  result.exec = exec;
  result.autresAmeliorations = autresAmeliorations;
  result.autresEffets = autresEffets;

  return result;
}

function getWeaponsDistanceAAPNJ(prefix, attrs, vMasque, vMasqueAE, eAssistanceAttaque, eASAssassinValue, isCadence, vCadence, eSilencieux, eTirRafale, isObliteration, isAntiAnatheme) {
  const result = {};
  const exec = [];

  let isConditionnelA = false;
  let isConditionnelD = false;
  let isConditionnelV = false;

  let isChambreDouble = false;
  let rChambreDouble = '';

  let isInterfaceGuidage = false;

  let aASAssassin = '';
  let aASAssassinValue = 0;

  const bonus = [];
  let diceDegats = 0;
  let diceViolence = 0;
  const bDegats = [];
  const attaquesSurprises = [];
  let attaquesSurprisesCondition = '';
  const attaquesSurprisesValue = [];
  const autresAmeliorations = [];
  const autresEffets = [];

  const aChargeurGrappes = isApplied(attrs[`${prefix}chargeurGrappes`]);
  const aCanonLong = isApplied(attrs[`${prefix}canonLong`]);
  const aCanonRaccourci = isApplied(attrs[`${prefix}canonRaccourci`]);
  const aChambreDouble = isApplied(attrs[`${prefix}chambreDouble`]);
  const aInterfaceGuidage = isApplied(attrs[`${prefix}interfaceGuidage`]);
  const aJumelage = isApplied(attrs[`${prefix}jumelage`]);
  const aJumelageV = attrs[`${prefix}jumelageValue`];
  const aJumelageT = attrs[`${prefix}jumelageType`];
  const aLunetteIntelligente = isApplied(attrs[`${prefix}lunetteIntelligente`]);
  const aMunitionsHyperVelocite = isApplied(attrs[`${prefix}munitionsHyperVelocite`]);
  const aMunitionsDrone = isApplied(attrs[`${prefix}munitionsDrone`]);
  const aChargeurExplosives = isApplied(attrs[`${prefix}chargeurExplosives`]);
  const aMunitionsIEM = isApplied(attrs[`${prefix}munitionsIEM`]);
  const aMunitionsNonLetales = isApplied(attrs[`${prefix}munitionsNonLetales`]);
  const aMunitionsSubsoniques = isApplied(attrs[`${prefix}munitionsSubsoniques`]);
  const aPointeurLaser = isApplied(attrs[`${prefix}pointeurLaser`]);
  const aProtectionArme = isApplied(attrs[`${prefix}protectionArme`]);
  const aRevetementOmega = isApplied(attrs[`${prefix}revetementOmega`]);
  const aStructureElement = isApplied(attrs[`${prefix}structureElement`]);
  const aSystemeRefroidissement = isApplied(attrs[`${prefix}systemeRefroidissement`]);

  if (aChargeurGrappes) {
    diceDegats -= 1;
    diceViolence += 1;

    exec.push('{{vMGrappeD=-1D}} {{vMGrappeV=+1D}}');
  }

  if (aCanonLong) {
    isConditionnelA = true;

    exec.push(`{{canonLong=${i18n_canonLong}}} {{canonLongCondition=${i18n_canonLongCondition}}}`);
  }

  if (aCanonRaccourci) {
    isConditionnelA = true;

    exec.push(`{{canonRaccourci=${i18n_canonRaccourci}}} {{canonRaccourciCondition=${i18n_canonRaccourciCondition}}}`);
  }

  if (aChambreDouble) {
    if (isCadence && vCadence >= 2) { autresAmeliorations.push(i18n_chambreDouble); } else if (isCadence) {
      autresEffets.push(`${i18n_cadence} ${vCadence}`);
      rChambreDouble = '?{Plusieurs cibles ?|Oui, 3|Non, 0}';
      isChambreDouble = true;
    } else {
      rChambreDouble = '?{Plusieurs cibles ?|Oui, 3|Non, 0}';
      isChambreDouble = true;
    }
  }

  if (aInterfaceGuidage) {
    autresAmeliorations.push(i18n_interfaceGuidage);
    isInterfaceGuidage = true;
  }

  if (aJumelage) {
    if (aJumelageT === 'ambidextrie') { autresAmeliorations.push(`${i18n_jumelage} ${i18n_ambidextrie} (${aJumelageV})`); } else if (aJumelageT === 'akimbo') { autresAmeliorations.push(`${i18n_jumelage} ${i18n_akimbo} (${aJumelageV})`); } else { autresAmeliorations.push(`${i18n_jumelage} (${aJumelageV})`); }
  }

  if (aLunetteIntelligente) {
    isConditionnelA = true;
    exec.push(`{{lunetteIntelligente=${i18n_lunetteIntelligente}}} {{lunetteIntelligenteCondition=${i18n_lunetteIntelligenteCondition}}}`);
  }

  if (aMunitionsHyperVelocite) {
    if (eAssistanceAttaque) { autresAmeliorations.push(i18n_munitionsHyperVelocite); } else {
      isConditionnelD = true;
      isConditionnelV = true;

      exec.push(`{{assistanceAttaque=${i18n_munitionsHyperVelocite}}} {{assistanceAttaqueCondition=${i18n_assistanceAttaqueCondition}}}`);
    }
  }

  if (aMunitionsDrone) {
    exec.push('{{vMDrone=+3}}');
    bonus.push(3);
  }

  if (aChargeurExplosives) {
    exec.push('{{vMExplosiveD=+1D6}} {{vMExplosiveV=-1D6}}');

    diceDegats += 1;
    diceViolence -= 1;
  }

  if (aMunitionsIEM) {
    exec.push('{{vMIEMD=-1D6}} {{vMIEMV=-1D6}}');

    diceDegats -= 1;
    diceViolence -= 1;
    autresAmeliorations.push(i18n_munitionsIEMParasitage);
  }

  if (aMunitionsSubsoniques) {
    if (eSilencieux) { autresAmeliorations.push(i18n_munitionsSubsoniques); } else {
      const totalSubsonique = Math.ceil(vMasque / 2) + vMasqueAE;

      attaquesSurprises.push(i18n_munitionsSubsoniques);
      attaquesSurprisesValue.push(totalSubsonique);

      if (attaquesSurprisesCondition === '') { attaquesSurprisesCondition = `{{attaqueSurpriseCondition=${i18n_attaqueSurpriseCondition}}}`; }
    }
  }

  if (aPointeurLaser) {
    exec.push('{{vMPLaser=+1}}');
    bonus.push(1);
  }

  if (aRevetementOmega) {
    if (eASAssassinValue < 2) {
      aASAssassin = i18n_revetementOmega;
      aASAssassinValue = 2;

      if (eASAssassinValue !== 0) { autresEffets.push(i18n_assassin); }
    } else if (eASAssassinValue > 2) { autresAmeliorations.push(i18n_revetementOmega); }
  }

  if (aSystemeRefroidissement) {
    if (!eTirRafale) { autresAmeliorations.push(`${i18n_systemeRefroidissement} (${i18n_barrage} 1)`); } else if (eTirRafale) { exec.push(`{{tirRafale=${i18n_systemeRefroidissement} + ${i18n_barrage} 1}} {{tirRafaleCondition=${i18n_tirRafaleCondition}}}`); }
  }

  if (aMunitionsNonLetales) { autresAmeliorations.push(i18n_munitionsNonLetales); }

  if (aProtectionArme) { autresAmeliorations.push(i18n_protectionArme); }

  if (aStructureElement) { autresAmeliorations.push(i18n_structureElementAlpha); }

  result.isConditionnelA = isConditionnelA;
  result.isConditionnelD = isConditionnelD;
  result.isConditionnelV = isConditionnelV;

  result.bonus = bonus;
  result.diceDegats = diceDegats;
  result.bDegats = bDegats;
  result.diceViolence = diceViolence;

  result.aASAssassin = aASAssassin;
  result.aASAssassinValue = aASAssassinValue;

  result.attaquesSurprises = attaquesSurprises;
  result.attaquesSurprisesValue = attaquesSurprisesValue;
  result.attaquesSurprisesCondition = attaquesSurprisesCondition;

  result.isChambreDouble = isChambreDouble;
  result.rChambreDouble = rChambreDouble;

  result.exec = exec;
  result.autresAmeliorations = autresAmeliorations;
  result.autresEffets = autresEffets;

  return result;
}

function getWeaponsAutreAA(prefix, AA, eAssistanceAttaque, eASAssassinValue, isCadence, vCadence, eSilencieux, eTirRafale, isObliteration, isAntiAnatheme) {
  const result = {};
  const exec = [];

  let isConditionnelA = false;
  let isConditionnelD = false;
  let isConditionnelV = false;

  let isChambreDouble = false;
  let rChambreDouble = '';

  let isInterfaceGuidage = false;

  let isJAmbidextre = false;
  let isJAkimbo = false;

  let aASAssassin = '';
  let aASAssassinValue = 0;

  const bonus = [];
  let diceDegats = 0;
  let diceViolence = 0;
  const bDegats = [];
  const attaquesSurprises = [];
  const attaquesSurprisesCondition = '';
  const attaquesSurprisesValue = [];
  const autresAmeliorations = [];
  const autresEffets = [];

  const aChargeurGrappes = isApplied(AA[`${prefix}chargeurGrappes`]);
  const aCanonLong = isApplied(AA[`${prefix}canonLong`]);
  const aCanonRaccourci = isApplied(AA[`${prefix}canonRaccourci`]);
  const aChambreDouble = isApplied(AA[`${prefix}chambreDouble`]);
  const aInterfaceGuidage = isApplied(AA[`${prefix}interfaceGuidage`]);
  const aJumelage = isApplied(AA[`${prefix}jumelage`]);
  const aJumelageV = AA[`${prefix}jumelageValue`];
  const aJumelageT = AA[`${prefix}jumelageType`];
  const aLunetteIntelligente = isApplied(AA[`${prefix}lunetteIntelligente`]);
  const aMunitionsHyperVelocite = isApplied(AA[`${prefix}munitionsHyperVelocite`]);
  const aMunitionsDrone = isApplied(AA[`${prefix}munitionsDrone`]);
  const aChargeurExplosives = isApplied(AA[`${prefix}chargeurExplosives`]);
  const aMunitionsIEM = isApplied(AA[`${prefix}munitionsIEM`]);
  const aMunitionsNonLetales = isApplied(AA[`${prefix}munitionsNonLetales`]);
  const aMunitionsSubsoniques = isApplied(AA[`${prefix}munitionsSubsoniques`]);
  const aPointeurLaser = isApplied(AA[`${prefix}pointeurLaser`]);
  const aProtectionArme = isApplied(AA[`${prefix}protectionArme`]);
  const aRevetementOmega = isApplied(AA[`${prefix}revetementOmega`]);
  const aStructureElement = isApplied(AA[`${prefix}structureElement`]);
  const aSystemeRefroidissement = isApplied(AA[`${prefix}systemeRefroidissement`]);

  if (aChargeurGrappes) {
    diceDegats -= 1;
    diceViolence += 1;

    exec.push('{{vMGrappeD=-1D}} {{vMGrappeV=+1D}}');
  }

  if (aCanonLong) {
    isConditionnelA = true;

    exec.push(`{{canonLong=${i18n_canonLong}}} {{canonLongCondition=${i18n_canonLongCondition}}}`);
  }

  if (aCanonRaccourci) {
    isConditionnelA = true;

    exec.push(`{{canonRaccourci=${i18n_canonRaccourci}}} {{canonRaccourciCondition=${i18n_canonRaccourciCondition}}}`);
  }

  if (aChambreDouble) {
    if (isCadence && vCadence >= 2) { autresAmeliorations.push(i18n_chambreDouble); } else if (isCadence) {
      autresEffets.push(`${i18n_cadence} ${vCadence}`);
      rChambreDouble = '?{Plusieurs cibles ?|Oui, 3|Non, 0}';
      isChambreDouble = true;
    } else {
      rChambreDouble = '?{Plusieurs cibles ?|Oui, 3|Non, 0}';
      isChambreDouble = true;
    }
  }

  if (aInterfaceGuidage) {
    autresAmeliorations.push(i18n_interfaceGuidage);
    isInterfaceGuidage = true;
  }

  if (aJumelage) {
    if (aJumelageT === 'ambidextrie') {
      autresAmeliorations.push(`${i18n_jumelage} ${i18n_ambidextrie} (${aJumelageV})`);
      isJAmbidextre = true;
    } else if (aJumelageT === 'akimbo') {
      autresAmeliorations.push(`${i18n_jumelage} ${i18n_akimbo} (${aJumelageV})`);
      isJAkimbo = true;
    } else { autresAmeliorations.push(`${i18n_jumelage} (${aJumelageV})`); }
  }

  if (aLunetteIntelligente) {
    isConditionnelA = true;

    exec.push(`{{lunetteIntelligente=${i18n_lunetteIntelligente}}} {{lunetteIntelligenteCondition=${i18n_lunetteIntelligenteCondition}}}`);
  }

  if (aMunitionsHyperVelocite) {
    if (eAssistanceAttaque) { autresAmeliorations.push(i18n_munitionsHyperVelocite); } else {
      isConditionnelD = true;
      isConditionnelV = true;

      exec.push(`{{assistanceAttaque=${i18n_munitionsHyperVelocite}}} {{assistanceAttaqueCondition=${i18n_assistanceAttaqueCondition}}}`);
    }
  }

  if (aMunitionsDrone) {
    exec.push('{{vMDrone=+3}}');
    bonus.push(3);
  }

  if (aChargeurExplosives) {
    exec.push('{{vMExplosiveD=+1D6}} {{vMExplosiveV=-1D6}}');
    diceDegats += 1;
    diceViolence -= 1;
  }

  if (aMunitionsIEM) {
    exec.push('{{vMIEMD=-1D6}} {{vMIEMV=-1D6}}');

    diceDegats -= 1;
    diceViolence -= 1;
    autresAmeliorations.push(i18n_munitionsIEMParasitage);
  }

  if (aMunitionsSubsoniques) { autresAmeliorations.push(i18n_munitionsSubsoniques); }

  if (aPointeurLaser) {
    exec.push('{{vMPLaser=+1}}');
    bonus.push(1);
  }

  if (aRevetementOmega) {
    if (eASAssassinValue < 2) {
      aASAssassin = i18n_revetementOmega;
      aASAssassinValue = 2;

      if (eASAssassinValue !== 0) { autresEffets.push(i18n_assassin); }
    } else if (eASAssassinValue > 2) { autresAmeliorations.push(i18n_revetementOmega); }
  }

  if (aSystemeRefroidissement) {
    if (!eTirRafale) { autresAmeliorations.push(`${i18n_systemeRefroidissement} (${i18n_barrage} 1)`); } else if (eTirRafale) { exec.push(`{{tirRafale=${i18n_systemeRefroidissement} + ${i18n_barrage} 1}} {{tirRafaleCondition=${i18n_tirRafaleCondition}}}`); }
  }

  if (aMunitionsNonLetales) { autresAmeliorations.push(i18n_munitionsNonLetales); }

  if (aProtectionArme) { autresAmeliorations.push(i18n_protectionArme); }

  if (aStructureElement) { autresAmeliorations.push(i18n_structureElementAlpha); }

  result.isConditionnelA = isConditionnelA;
  result.isConditionnelD = isConditionnelD;
  result.isConditionnelV = isConditionnelV;

  result.bonus = bonus;
  result.diceDegats = diceDegats;
  result.bDegats = bDegats;
  result.diceViolence = diceViolence;

  result.aASAssassin = aASAssassin;
  result.aASAssassinValue = aASAssassinValue;

  result.attaquesSurprises = attaquesSurprises;
  result.attaquesSurprisesValue = attaquesSurprisesValue;
  result.attaquesSurprisesCondition = attaquesSurprisesCondition;

  result.isChambreDouble = isChambreDouble;
  result.rChambreDouble = rChambreDouble;
  result.isJAmbidextre = isJAmbidextre;
  result.isJAkimbo = isJAkimbo;

  result.exec = exec;
  result.autresAmeliorations = autresAmeliorations;
  result.autresEffets = autresEffets;

  return result;
}

function getArmorBonus(value, armure, isELumiere, isASLumiere, vDiscretion, oDiscretion, hasBonus, C1Nom, C2Nom, C3Nom, C4Nom, aEffets = []) {
  const result = {};
  const exec = [];
  const cRoll = [];
  const bDegats = [];

  let diceDegats = 0;
  let diceViolence = 0;

  const ODBarbarian = [];
  const ODRogue = [];
  const ODShaman = [];
  const autresEffets = [];

  let goliath = 0;
  let changeling = '';
  let ghost = '';

  let shaman = 0;
  let C5 = '';
  let C6 = '';
  let C7 = '';
  let C5Nom = '';
  let C6Nom = '';
  let C7Nom = '';

  let ODWarrior = 0;
  let warrior250PG = 0;

  let typeSoldier = '';
  let typeHunter = '';
  let typeHerald = '';
  let typeScholar = '';
  let typeScout = '';

  let bonusWarrior = 0;

  switch (armure) {
    case 'barbarian':
      goliath = Number(value.barbarianGoliath);

      if (goliath !== 0) {
        exec.push(`{{goliath=[[${goliath}]]}}`);

        if (C1Nom === 'force' || C1Nom === 'endurance') { ODBarbarian.push(goliath); }

        if (C2Nom === 'force' || C2Nom === 'endurance') { ODBarbarian.push(goliath); }

        if (hasBonus === 1 || hasBonus === 2) {
          if (C3Nom === 'force' || C3Nom === 'endurance') { ODBarbarian.push(goliath); }
        }

        if (hasBonus === 2) {
          if (C4Nom === 'force' || C4Nom === 'endurance') { ODBarbarian.push(goliath); }
        }

        if (ODBarbarian.length === 0) { exec.push('{{vODBarbarian=[[0]]}}'); } else { exec.push(`{{vODBarbarian=[[${ODBarbarian.join('+')}]]}}`); }

        diceDegats += goliath;
        diceViolence += goliath;

        exec.push(`{{vBarbarianD=+${goliath}D6}}`);
        exec.push(`{{vBarbarianV=+${goliath}D6}}`);

        if (goliath >= 4 && !aEffets.includes(i18n_antiVehicule)) {
          autresEffets.push(i18n_antiVehicule);
        }
      }
      break;

    case 'bard':
      changeling = +value.bardChangeling;

      if (changeling !== 0) {
        exec.push(`{{special2=${i18n_changelingActive}}}`);
      }
      break;

    case 'rogue':
      ghost = +value.rogueGhost;

      if (ghost !== 0) {
        exec.push(`{{special2=${i18n_ghostActive}}}`);

        if (isELumiere === false && isASLumiere === false) {
          const totalGhost = vDiscretion + oDiscretion;

          exec.push(`{{vGhostA=${vDiscretion}D6+${oDiscretion}}}`);
          exec.push(`{{vGhostD=${totalGhost}}}`);
          cRoll.push(vDiscretion);
          ODRogue.push(oDiscretion);
          bDegats.push(totalGhost);
        }
      }

      break;

    case 'shaman':
      shaman = Number(value.shamanNbreTotem);
      C5 = value.caracteristiqueTotem1;
      C6 = value.caracteristiqueTotem2;
      C7 = value.caracteristiqueTotem3;

      C5Nom = C5.slice(2, -1);
      C6Nom = C6.slice(2, -1);
      C7Nom = C7.slice(2, -1);

      if (shaman === 1 || shaman === 2 || shaman === 3) {
        if (C5 !== '0') {
          exec.push(`{{totem1=${CaracNom[C5Nom]}}}`);
          cRoll.push(C5);
          ODShaman.push(`@{${ODValue[C5Nom]}}`);
        }
      }

      if (shaman === 2 || shaman === 3) {
        if (C6 !== '0') {
          exec.push(`{{totem2=${CaracNom[C6Nom]}}}`);
          cRoll.push(C6);
          ODShaman.push(`@{${ODValue[C6Nom]}}`);
        }
      }

      if (shaman === 3) {
        if (C7 !== '0') {
          exec.push(`{{totem3=${CaracNom[C7Nom]}}}`);
          cRoll.push(C7);
          ODShaman.push(`@{${ODValue[C7Nom]}}`);
        }
      }

      if (shaman === 1 || shaman === 2 || shaman === 3) {
        exec.push('{{totem=true}}');

        if (ODShaman.length === 0) { exec.push('{{vODShaman=[[0]]}}'); } else { exec.push(`{{vODShaman=[[${ODShaman.join('+')}]]}}`); }
      }
      break;

    case 'warrior':
      warrior250PG = +value.warrior250PG;
      bonusWarrior = 1 + warrior250PG;

      typeSoldier = +value.warriorSoldierA;
      typeHunter = +value.warriorHunterA;
      typeHerald = +value.warriorHeraldA;
      typeScholar = +value.warriorScholarA;
      typeScout = +value.warriorScoutA;

      if (typeSoldier !== 0) {
        exec.push(`{{special2=${i18n_typeSoldier}}}`);

        if (C1Nom === 'deplacement' || C1Nom === 'force' || C1Nom === 'endurance') { ODWarrior += bonusWarrior; }

        if (C2Nom === 'deplacement' || C2Nom === 'force' || C2Nom === 'endurance') { ODWarrior += bonusWarrior; }

        if (hasBonus === 1 || hasBonus === 2) {
          if (C3Nom === 'deplacement' || C3Nom === 'force' || C3Nom === 'endurance') { ODWarrior += bonusWarrior; }
        }

        if (hasBonus === 2) {
          if (C4Nom === 'deplacement' || C4Nom === 'force' || C4Nom === 'endurance') { ODWarrior += bonusWarrior; }
        }
      }

      if (typeHunter !== 0) {
        exec.push(`{{special2=${i18n_typeHunter}}}`);

        if (C1Nom === 'hargne' || C1Nom === 'combat' || C1Nom === 'instinct') { ODWarrior += bonusWarrior; }

        if (C2Nom === 'hargne' || C2Nom === 'combat' || C2Nom === 'instinct') { ODWarrior += bonusWarrior; }

        if (hasBonus === 1 || hasBonus === 2) {
          if (C3Nom === 'hargne' || C3Nom === 'combat' || C3Nom === 'instinct') { ODWarrior += bonusWarrior; }
        }

        if (hasBonus === 2) {
          if (C4Nom === 'hargne' || C4Nom === 'combat' || C4Nom === 'instinct') { ODWarrior += bonusWarrior; }
        }
      }

      if (typeHerald !== 0) {
        exec.push(`{{special2=${i18n_typeHerald}}}`);

        if (C1Nom === 'aura' || C1Nom === 'parole' || C1Nom === 'sf') { ODWarrior += bonusWarrior; }

        if (C2Nom === 'aura' || C2Nom === 'parole' || C2Nom === 'sf') { ODWarrior += bonusWarrior; }

        if (hasBonus === 1 || hasBonus === 2) {
          if (C3Nom === 'aura' || C3Nom === 'parole' || C3Nom === 'sf') { ODWarrior += bonusWarrior; }
        }

        if (hasBonus === 2) {
          if (C4Nom === 'aura' || C4Nom === 'parole' || C4Nom === 'sf') { ODWarrior += bonusWarrior; }
        }
      }

      if (typeScholar !== 0) {
        exec.push(`{{special2=${i18n_typeScholar}}}`);

        if (C1Nom === 'tir' || C1Nom === 'savoir' || C1Nom === 'technique') { ODWarrior += bonusWarrior; }

        if (C2Nom === 'tir' || C2Nom === 'savoir' || C2Nom === 'technique') { ODWarrior += bonusWarrior; }

        if (hasBonus === 1 || hasBonus === 2) {
          if (C3Nom === 'tir' || C3Nom === 'savoir' || C3Nom === 'technique') { ODWarrior += bonusWarrior; }
        }

        if (hasBonus === 2) {
          if (C4Nom === 'tir' || C4Nom === 'savoir' || C4Nom === 'technique') { ODWarrior += bonusWarrior; }
        }
      }

      if (typeScout !== 0) {
        exec.push(`{{special2=${i18n_typeScout}}}`);

        if (C1Nom === 'discretion' || C1Nom === 'dexterite' || C1Nom === 'perception') { ODWarrior += bonusWarrior; }

        if (C2Nom === 'discretion' || C2Nom === 'dexterite' || C2Nom === 'perception') { ODWarrior += bonusWarrior; }

        if (hasBonus === 1 || hasBonus === 2) {
          if (C3Nom === 'discretion' || C3Nom === 'dexterite' || C3Nom === 'perception') { ODWarrior += bonusWarrior; }
        }

        if (hasBonus === 2) {
          if (C4Nom === 'discretion' || C4Nom === 'dexterite' || C4Nom === 'perception') { ODWarrior += bonusWarrior; }
        }
      }

      if (ODWarrior.length !== 0) { exec.push(`{{vODWarrior=${ODWarrior}}}`); }
      break;
  }

  result.exec = exec;
  result.cRoll = cRoll;
  result.diceDegats = diceDegats;
  result.bDegats = bDegats;
  result.diceViolence = diceViolence;
  result.ODBarbarian = ODBarbarian;
  result.ODRogue = ODRogue;
  result.ODShaman = ODShaman;
  result.ODWarrior = ODWarrior;
  result.autresEffets = autresEffets;

  return result;
}

function getMALBonus(value, armureL, isELumiere, isASLumiere, vDiscretion, oDiscretion, hasBonus, C1Nom, C2Nom, C3Nom, C4Nom, aEffets = []) {
  const result = {};
  const exec = [];
  const cRoll = [];
  const bDegats = [];

  let diceDegats = 0;
  let diceViolence = 0;

  const ODMALBarbarian = [];
  const ODMALRogue = [];
  const ODMALShaman = [];
  const bonusWarrior = 1;
  const autresEffets = [];

  let MALGoliath = 0;
  let MALGhost = '';

  let MALShaman = 0;
  let C5 = '';
  let C6 = '';
  let C5Nom = '';
  let C6Nom = '';

  let ODMALWarrior = 0;

  switch (armureL) {
    case 'barbarian':
      MALGoliath = Number(value.MALBarbarianGoliath);

      if (MALGoliath !== 0) {
        exec.push(`{{MALGoliath=[[${MALGoliath}]]}}`);

        if (C1Nom === 'force' || C1Nom === 'endurance') { ODMALBarbarian.push(MALGoliath); }

        if (C2Nom === 'force' || C2Nom === 'endurance') { ODMALBarbarian.push(MALGoliath); }

        if (hasBonus === 1 || hasBonus === 2) {
          if (C3Nom === 'force' || C3Nom === 'endurance') { ODMALBarbarian.push(MALGoliath); }
        }

        if (hasBonus === 2) {
          if (C4Nom === 'force' || C4Nom === 'endurance') { ODMALBarbarian.push(MALGoliath); }
        }

        if (ODMALBarbarian.length === 0) { exec.push('{{vODMALBarbarian=[[0]]}}'); } else { exec.push(`{{vODMALBarbarian=[[${ODMALBarbarian.join('+')}]]}}`); }

        diceDegats += MALGoliath;
        diceViolence += MALGoliath;

        exec.push(`{{vMALBarbarianD=+${MALGoliath}D6}}`);
        exec.push(`{{vMALBarbarianV=+${MALGoliath}D6}}`);

        if (MALGoliath >= 4 && !aEffets.includes(i18n_antiVehicule)) {
          autresEffets.push(i18n_antiVehicule);
        }
      }
      break;

    case 'bard':
      MALchangeling = +value.MALBardChangeling;

      if (MALchangeling !== 0) {
        exec.push(`{{MALspecial2=${i18n_changelingActive}}}`);
      }
      break;

    case 'rogue':
      MALGhost = value.MALRogueGhost;

      if (MALGhost !== '') {
        exec.push(`{{MALspecial2=${i18n_ghostActive}}}`);

        if (isELumiere === false && isASLumiere === false) {
          const totalMALGhost = vDiscretion + oDiscretion;

          exec.push(`{{vMALGhostA=${vDiscretion}D6+${oDiscretion}}}`);
          exec.push(`{{vMALGhostD=${totalMALGhost}}}`);
          cRoll.push(vDiscretion);
          ODMALRogue.push(oDiscretion);
          bDegats.push(totalMALGhost);
        }
      }
      break;

    case 'shaman':
      MALShaman = Number(value.MALShamanNbreTotem);
      C5 = value.MALCaracteristiqueTotem1;
      C6 = value.MALCaracteristiqueTotem2;

      C5Nom = C5.slice(2, -1);
      C6Nom = C6.slice(2, -1);

      if (MALShaman === 1 || MALShaman === 2) {
        if (C5 !== '0') {
          exec.push(`{{MALTotem1=${CaracNom[C5Nom]}}}`);
          cRoll.push(C5);
          ODMALShaman.push(`@{${ODNom[C5Nom]}}`);
        }
      }

      if (MALShaman === 2) {
        if (C6 !== '0') {
          exec.push(`{{MALTotem2=${CaracNom[C6Nom]}}}`);
          cRoll.push(C6);
          ODMALShaman.push(`@{${ODNom[C6Nom]}}`);
        }
      }

      if (MALShaman === 1 || MALShaman === 2) {
        exec.push('{{MALTotem=true}}');

        if (ODMALShaman.length === 0) { exec.push('{{vODMALShaman=[[0]]}}'); } else { exec.push(`{{vODMALShaman=[[${ODMALShaman.join('+')}]]}}`); }
      }

      break;

    case 'warrior':
      MALTypeSoldier = +value.MALWarriorSoldierA;
      MALTypeHunter = +value.MALWarriorHunterA;
      MALTypeHerald = +value.MALWarriorHeraldA;
      MALTypeScholar = +value.MALWarriorScholarA;
      MALTypeScout = +value.MALWarriorScoutA;

      if (MALTypeSoldier !== 0) {
        exec.push(`{{MALspecial2=${i18n_typeSoldier}}}`);
        exec.push('{{MALTypeWarrior=true}}');

        if (C1Nom === 'deplacement' || C1Nom === 'force' || C1Nom === 'endurance') { ODMALWarrior += bonusWarrior; }

        if (C2Nom === 'deplacement' || C2Nom === 'force' || C2Nom === 'endurance') { ODMALWarrior += bonusWarrior; }

        if (hasBonus === 1 || hasBonus === 2) {
          if (C3Nom === 'deplacement' || C3Nom === 'force' || C3Nom === 'endurance') { ODMALWarrior += bonusWarrior; }
        }

        if (hasBonus === 2) {
          if (C4Nom === 'deplacement' || C4Nom === 'force' || C4Nom === 'endurance') { ODMALWarrior += bonusWarrior; }
        }
      }

      if (MALTypeHunter !== 0) {
        exec.push(`{{MALspecial2=${i18n_typeHunter}}}`);
        exec.push('{{MALTypeWarrior=true}}');

        if (C1Nom === 'hargne' || C1Nom === 'combat' || C1Nom === 'instinct') { ODMALWarrior += bonusWarrior; }

        if (C2Nom === 'hargne' || C2Nom === 'combat' || C2Nom === 'instinct') { ODMALWarrior += bonusWarrior; }

        if (hasBonus === 1 || hasBonus === 2) {
          if (C3Nom === 'hargne' || C3Nom === 'combat' || C3Nom === 'instinct') { ODMALWarrior += bonusWarrior; }
        }

        if (hasBonus === 2) {
          if (C4Nom === 'hargne' || C4Nom === 'combat' || C4Nom === 'instinct') { ODMALWarrior += bonusWarrior; }
        }
      }

      if (MALTypeHerald !== 0) {
        exec.push(`{{MALspecial2=${i18n_typeHerald}}}`);
        exec.push('{{MALTypeWarrior=true}}');

        if (C1Nom === 'aura' || C1Nom === 'parole' || C1Nom === 'sf') { ODMALWarrior += bonusWarrior; }

        if (C2Nom === 'aura' || C2Nom === 'parole' || C2Nom === 'sf') { ODMALWarrior += bonusWarrior; }

        if (hasBonus === 1 || hasBonus === 2) {
          if (C3Nom === 'aura' || C3Nom === 'parole' || C3Nom === 'sf') { ODMALWarrior += bonusWarrior; }
        }

        if (hasBonus === 2) {
          if (C4Nom === 'aura' || C4Nom === 'parole' || C4Nom === 'sf') { ODMALWarrior += bonusWarrior; }
        }
      }

      if (MALTypeScholar !== 0) {
        exec.push(`{{MALspecial2=${i18n_typeScholar}}}`);
        exec.push('{{MALTypeWarrior=true}}');

        if (C1Nom === 'tir' || C1Nom === 'savoir' || C1Nom === 'technique') { ODMALWarrior += bonusWarrior; }

        if (C2Nom === 'tir' || C2Nom === 'savoir' || C2Nom === 'technique') { ODMALWarrior += bonusWarrior; }

        if (hasBonus === 1 || hasBonus === 2) {
          if (C3Nom === 'tir' || C3Nom === 'savoir' || C3Nom === 'technique') { ODMALWarrior += bonusWarrior; }
        }

        if (hasBonus === 2) {
          if (C4Nom === 'tir' || C4Nom === 'savoir' || C4Nom === 'technique') { ODMALWarrior += bonusWarrior; }
        }
      }

      if (MALTypeScout !== 0) {
        exec.push(`{{MALspecial2=${i18n_typeScout}}}`);
        exec.push('{{MALTypeWarrior=true}}');

        if (C1Nom === 'discretion' || C1Nom === 'dexterite' || C1Nom === 'perception') { ODMALWarrior += bonusWarrior; }

        if (C2Nom === 'discretion' || C2Nom === 'dexterite' || C2Nom === 'perception') { ODMALWarrior += bonusWarrior; }

        if (hasBonus === 1 || hasBonus === 2) {
          if (C3Nom === 'discretion' || C3Nom === 'dexterite' || C3Nom === 'perception') { ODMALWarrior += bonusWarrior; }
        }

        if (hasBonus === 2) {
          if (C4Nom === 'discretion' || C4Nom === 'dexterite' || C4Nom === 'perception') { ODMALWarrior += bonusWarrior; }
        }
      }

      if (ODMALWarrior.length !== 0) { exec.push(`{{vODMALWarrior=${ODMALWarrior}}}`); }
      break;
  }

  result.exec = exec;
  result.cRoll = cRoll;
  result.diceDegats = diceDegats;
  result.diceViolence = diceViolence;
  result.bDegats = bDegats;
  result.ODMALBarbarian = ODMALBarbarian;
  result.ODMALRogue = ODMALRogue;
  result.ODMALShaman = ODMALShaman;
  result.ODMALWarrior = ODMALWarrior;
  result.autresEffets = autresEffets;

  return result;
}

function getStyleContactMod(value, cPrecis, diceDegats, diceViolence, hasArmure, oCombat, isEAkimbo, isEAmbidextrie, isAAgressive, isAJumelle, isASoeur, isAProtectrice, isEDeuxMains, isAAllegee, isELourd) {
  const result = {};

  const exec = [];
  const cRoll = [];
  const autresAmeliorationsS = [];

  let dDegats = 0;
  let dViolence = 0;

  const style = value.styleCombat || 'standard';
  let bName = '';
  let modA = 0;

  switch (style) {
    case 'standard':
      exec.push(`{{style=${i18n_style} ${i18n_standard}}}`);

      if (isAAgressive) { autresAmeliorationsS.push(i18n_agressive); }
      break;

    case 'couvert':
      bName = 'atkCouvert';
      modA = value[bName];

      exec.push(`{{style=${i18n_style} ${i18n_couvert}}}`);
      exec.push(`{{vMStyleA=${modA}D}}`);
      cRoll.push(Number(modA));

      if (isAAgressive) { autresAmeliorationsS.push(i18n_agressive); }
      break;

    case 'agressif':
      bName = 'atkAgressif';
      modA = value[bName];

      exec.push(`{{style=${i18n_style} ${i18n_agressif}}}`);
      exec.push(`{{vMStyleA=${modA}D}}`);
      cRoll.push(Number(modA));

      if (isAAgressive) {
        exec.push('{{vAgressive=+1D6}}');
        dDegats += 1;
      }
      break;

    case 'akimbo':
      bName = 'atkAkimbo';
      modA = value[bName];

      exec.push(`{{style=${i18n_style} ${i18n_akimbo}}}`);

      if (hasArmure) {
        if (oCombat >= 3 || isEAkimbo || isAJumelle) {
          exec.push('{{vMStyleA=-1D}}');
          cRoll.push(-1);
        } else {
          exec.push(`{{vMStyleA=${modA}D}}`);
          cRoll.push(Number(modA));
        }
      } else if (isEAkimbo || isAJumelle) {
        exec.push('{{vMStyleA=-1D}}');
        cRoll.push(-1);
      } else {
        exec.push(`{{vMStyleA=${modA}D}}`);
        cRoll.push(Number(modA));
      }

      exec.push(`{{vMStyleD=+${diceDegats}D6}}`);
      dDegats += Number(diceDegats);

      exec.push(`{{vMStyleV=+${Math.ceil(Number(diceViolence) / 2)}D6}}`);
      dViolence += Math.ceil(Number(diceViolence) / 2);

      if (isAAgressive) { autresAmeliorationsS.push(i18n_agressive); }
      break;

    case 'ambidextre':
      bName = 'atkAmbidextre';
      modA = value[bName];

      exec.push(`{{style=${i18n_style} ${i18n_ambidextre}}}`);

      if (hasArmure) {
        if (oCombat >= 4 || isEAmbidextrie || isASoeur) {
          exec.push('{{vMStyleA=-1D}}');
          cRoll.push(-1);
        } else {
          exec.push(`{{vMStyleA=${modA}D}}`);
          cRoll.push(Number(modA));
        }
      } else if (isEAmbidextrie || isASoeur) {
        exec.push('{{vMStyleA=-1D}}');
        cRoll.push(-1);
      } else {
        exec.push(`{{vMStyleA=${modA}D}}`);
        cRoll.push(Number(modA));
      }

      if (isAAgressive) { autresAmeliorationsS.push(i18n_agressive); }
      break;

    case 'defensif':
      bName = 'atkDefensif';
      modA = value[bName];

      exec.push(`{{style=${i18n_style} ${i18n_defensif}}}`);

      if (isAProtectrice) {
        exec.push('{{vMStyleA=-1D}}');
        cRoll.push(-1);
      } else {
        exec.push(`{{vMStyleA=${modA}D}}`);
        cRoll.push(Number(modA));
      }

      if (isAAgressive) { autresAmeliorationsS.push(i18n_agressive); }
      break;

    case 'pilonnage':
      exec.push(`{{style=${i18n_style} ${i18n_pilonnage}}}`);

      if (isAAgressive) { autresAmeliorationsS.push(i18n_agressive); }
      break;

    case 'suppression':
      exec.push(`{{style=${i18n_style} ${i18n_suppression}}}`);

      if (isAAgressive) { autresAmeliorationsS.push(i18n_agressive); }
      break;

    case 'precis':
      exec.push(`{{style=${i18n_style} ${i18n_precis}}}`);

      if (isEDeuxMains && !isAAllegee) {
        if (cPrecis.nom !== '0') {
          exec.push(`{{cPrecis=${cPrecis.nom}}}`);

          const CPValue = Number(cPrecis.base);

          cRoll.push(CPValue);

          exec.push(`{{vMStyleA=${CPValue}D}}`);
        }
      }
      break;

    case 'puissant':
      exec.push(`{{style=${i18n_style} ${i18n_puissant}}}`);

      if (isELourd) {
        const type = value.stylePuissantType;
        const bonus = +value.stylePuissantBonus;
        const malus = 0 - bonus;

        exec.push(`{{vMStyleA=${malus}D}}`);
        cRoll.push(malus);

        if (type.includes('stylePuissantD')) {
          exec.push(`{{vMStyleD=+${bonus}D}}`);
          dDegats += bonus;
        }

        if (type.includes('stylePuissantV')) {
          exec.push(`{{vMStyleV=+${bonus}D}}`);
          dViolence += bonus;
        }
      }
      break;
  }

  result.exec = exec;
  result.cRoll = cRoll;
  result.autresAmeliorationsS = autresAmeliorationsS;
  result.diceDegats = dDegats;
  result.diceViolence = dViolence;

  return result;
}

function getStyleDistanceMod(value, diceDegats, diceViolence, pilonnage, pilonnageType, hasArmure, oTir, isEAkimbo, isEAmbidextrie, isDeuxMains, isLourd) {
  const result = {};

  const exec = [];
  const cRoll = [];

  let dDegats = 0;
  let dViolence = 0;

  const style = value.styleCombat;
  let bName = '';
  let modA = 0;

  switch (style) {
    case 'standard':
      exec.push(`{{style=${i18n_style} ${i18n_standard}}}`);
      break;

    case 'couvert':
      bName = 'atkCouvert';
      modA = value[bName];

      exec.push(`{{style=${i18n_style} ${i18n_couvert}}}`);
      exec.push(`{{vMStyleA=${modA}D}}`);
      cRoll.push(Number(modA));
      break;

    case 'agressif':
      bName = 'atkAgressif';
      modA = value[bName];

      exec.push(`{{style=${i18n_style} ${i18n_agressif}}}`);
      exec.push(`{{vMStyleA=${modA}D}}`);
      cRoll.push(Number(modA));
      break;

    case 'akimbo':
      bName = 'atkAkimbo';
      modA = value[bName];

      exec.push(`{{style=${i18n_style} ${i18n_akimbo}}}`);

      if (hasArmure) {
        if (oTir >= 3 || isEAkimbo) {
          exec.push('{{vMStyleA=-1D}}');
          cRoll.push(-1);
        } else {
          exec.push(`{{vMStyleA=${modA}D}}`);
          cRoll.push(Number(modA));
        }
      } else if (isEAkimbo) {
        exec.push('{{vMStyleA=-1D}}');
        cRoll.push(-1);
      } else {
        exec.push(`{{vMStyleA=${modA}D}}`);
        cRoll.push(Number(modA));
      }

      exec.push(`{{vMStyleD=+${diceDegats}D6}}`);
      dDegats += Number(diceDegats);

      exec.push(`{{vMStyleV=+${Math.ceil(Number(diceViolence) / 2)}D6}}`);
      dViolence += Math.ceil(Number(diceViolence) / 2);
      break;

    case 'ambidextre':
      bName = 'atkAmbidextre';
      modA = value[bName];

      exec.push(`{{style=${i18n_style} ${i18n_ambidextre}}}`);

      if (hasArmure) {
        if (oTir >= 4 || isEAmbidextrie) {
          exec.push('{{vMStyleA=-1D}}');
          cRoll.push(-1);
        } else {
          exec.push(`{{vMStyleA=${modA}D}}`);
          cRoll.push(Number(modA));
        }
      } else if (isEAmbidextrie) {
        exec.push('{{vMStyleA=-1D}}');
        cRoll.push(-1);
      } else {
        exec.push(`{{vMStyleA=${modA}D}}`);
        cRoll.push(Number(modA));
      }
      break;

    case 'defensif':
      bName = 'atkDefensif';
      modA = value[bName];

      exec.push(`{{style=${i18n_style} ${i18n_defensif}}}`);

      exec.push(`{{vMStyleA=${modA}D}}`);
      cRoll.push(Number(modA));
      break;

    case 'pilonnage':
      bName = 'atkPilonnage';
      modA = value[bName];

      exec.push(`{{style=${i18n_style} ${i18n_pilonnage}}}`);

      exec.push(`{{vMStyleA=${modA}D}}`);
      cRoll.push(Number(modA));

      if (isDeuxMains) {
        let bPilonnage = Number(pilonnage) - 1;

        if (pilonnageType === 'degats') {
          if (bPilonnage < 0) { bPilonnage = 0; }

          exec.push(`{{vMStyleD=+${bPilonnage}D6}}`);
          dDegats += Number(bPilonnage);
        }

        if (pilonnageType === 'violence') {
          if (bPilonnage < 0) { bPilonnage = 0; }

          exec.push(`{{vMStyleV=+${bPilonnage}D6}}`);
          dViolence += Number(bPilonnage);
        }
      }
      break;

    case 'suppression':
      exec.push(`{{style=${i18n_style} ${i18n_suppression}}}`);

      if (isLourd) {
        const suppressionD = Number(value.styleSuppressionD);
        const suppressionV = Number(value.styleSuppressionV);

        if (suppressionD !== 0) {
          dDegats -= suppressionD;
          exec.push(`{{vMStyleD=-${suppressionD}D6}}`);
        }

        if (suppressionV !== 0) {
          dViolence -= suppressionV;
          exec.push(`{{vMStyleV=-${suppressionV}D6}}`);
        }
      }
      break;

    case 'precis':
      exec.push(`{{style=${i18n_style} ${i18n_precis}}}`);
      break;

    case 'puissant':
      exec.push(`{{style=${i18n_style} ${i18n_puissant}}}`);
      break;
  }

  result.exec = exec;
  result.cRoll = cRoll;
  result.diceDegats = dDegats;
  result.diceViolence = dViolence;

  return result;
}

function updateRoll(roll, totalDegats, diceDegats, bonusDegats, totalViolence, diceViolence, bonusViolence, conditions) {
  const tSurprise = roll.results.attaqueSurpriseValue || {};
  const tDestructeur = roll.results.destructeurValue || {};
  const tFureur = roll.results.fureurValue || {};
  const tMeurtrier = roll.results.meurtrierValue || {};
  const tUltraviolence = roll.results.ultraviolenceValue || {};

  const tArmeAzurineValueD = roll.results.armeAzurineValueD || {};
  const tArmeAzurineValueV = roll.results.armeAzurineValueV || {};
  const tArmeRougeSangValueD = roll.results.armeRougeSangValueD || {};
  const tArmeRougeSangValueV = roll.results.armeRougeSangValueV || {};
  const tCheneSculpte = roll.results.cheneSculpteValue || {};
  const tGriffuresGraveesValueD = roll.results.griffuresGraveesValueD || {};
  const tGriffuresGraveesValueV = roll.results.griffuresGraveesValueV || {};
  const tMasqueBriseValueD = roll.results.masqueBriseValueD || {};
  const tMasqueBriseValueV = roll.results.masqueBriseValueV || {};
  const tRouagesCassesValueD = roll.results.rouagesCassesValueD || {};
  const tRouagesCassesValueV = roll.results.rouagesCassesValueV || {};

  const isTenebricide = conditions.isTenebricide || false;
  const isSurprise = conditions.isSurprise || false;
  const isDestructeur = conditions.isDestructeur || false;
  const isFureur = conditions.isFureur || false;
  const isMeurtrier = conditions.isMeurtrier || false;
  const isUltraviolence = conditions.isUltraviolence || false;

  const isArmeAzurine = conditions.isArmeAzurine || false;
  const isArmeRougeSang = conditions.isArmeRougeSang || false;
  const isCheneSculpte = conditions.isCheneSculpte || false;
  const isGriffureGravee = conditions.isGriffureGravee || false;
  const isMasqueBrise = conditions.isMasqueBrise || false;
  const isRouagesCasses = conditions.isRouagesCasses || false;

  let tDegats = totalDegats;
  let tViolence = totalViolence;

  let hDestructeur = 0;
  let hFureur = 0;
  let hMeurtrier = 0;
  let hSurprise = 0;
  let hUltraviolence = 0;

  let hArmeAzurineValueD = 0;
  let hArmeAzurineValueV = 0;
  let hArmeRougeSangValueD = 0;
  let hArmeRougeSangValueV = 0;
  let hCheneSculpte = 0;
  let hGriffuresGraveesValueD = 0;
  let hGriffuresGraveesValueV = 0;
  let hMasqueBriseValueD = 0;
  let hMasqueBriseValueV = 0;
  let hRouagesCassesValueD = 0;
  let hRouagesCassesValueV = 0;

  if (isSurprise) { hSurprise = tSurprise.result; }
  if (isDestructeur) { hDestructeur = tDestructeur.result; }
  if (isFureur) { hFureur = tFureur.result; }
  if (isMeurtrier) { hMeurtrier = tMeurtrier.result; }
  if (isUltraviolence) { hUltraviolence = tUltraviolence.result; }

  if (isArmeAzurine) {
    hArmeAzurineValueD = tArmeAzurineValueD.result;
    hArmeAzurineValueV = tArmeAzurineValueV.result;
  }
  if (isArmeRougeSang) {
    hArmeRougeSangValueD = tArmeRougeSangValueD.result;
    hArmeRougeSangValueV = tArmeRougeSangValueV.result;
  }
  if (isCheneSculpte) { hCheneSculpte = tCheneSculpte.result; }
  if (isGriffureGravee) {
    hGriffuresGraveesValueD = tGriffuresGraveesValueD.result;
    hGriffuresGraveesValueV = tGriffuresGraveesValueV.result;
  }
  if (isMasqueBrise) {
    hMasqueBriseValueD = tMasqueBriseValueD.result;
    hMasqueBriseValueV = tMasqueBriseValueV.result;
  }
  if (isRouagesCasses) {
    hRouagesCassesValueD = tRouagesCassesValueD.result;
    hRouagesCassesValueV = tRouagesCassesValueV.result;
  }

  let vTDegats = 0;
  let vTViolence = 0;
  let vTDestructeur = 0;
  let vTFureur = 0;
  let vTMeurtrier = 0;
  let vTSurprise = 0;
  let vTUltraviolence = 0;

  let vTCheneSculpte = 0;

  if (conditions.bourreau || conditions.equilibre) {
    tDegats = diceDegats.reduce((accumulateur, valeurCourante) => {
      let newV = +valeurCourante;
      if (newV <= 3) { newV = 4; }

      return accumulateur + newV;
    }, 0);
    if (bonusDegats.length !== 0) { tDegats += bonusDegats.reduce((accumulateur, valeurCourante) => accumulateur + +valeurCourante); }

    if (isDestructeur) {
      hDestructeur = tDestructeur.dice.reduce((accumulateur, valeurCourante) => {
        let newV = +valeurCourante;
        if (newV <= 3) { newV = 4; }

        return accumulateur + newV;
      }, 0);
    }

    if (isMeurtrier) {
      hMeurtrier = tMeurtrier.dice.reduce((accumulateur, valeurCourante) => {
        let newV = +valeurCourante;
        if (newV <= 3) { newV = 4; }

        return accumulateur + newV;
      }, 0);
    }

    if (isSurprise) {
      if (tSurprise.dice.length !== 0) {
        const normalRoll = tSurprise.dice.reduce((accumulateur, valeurCourante) => accumulateur + +valeurCourante);
        const bonusSurprise = +tSurprise.result - +normalRoll;

        hSurprise = tSurprise.dice.reduce((accumulateur, valeurCourante) => {
          let newV = +valeurCourante;
          if (newV <= 3) { newV = 4; }

          return accumulateur + newV;
        }, 0);

        hSurprise += bonusSurprise;
      }
    }

    if (isArmeAzurine) {
      hArmeAzurineValueD = tArmeAzurineValueD.dice.reduce((accumulateur, valeurCourante) => {
        let newV = +valeurCourante;
        if (newV <= 3) { newV = 4; }

        return accumulateur + newV;
      }, 0);
    }

    if (isArmeRougeSang) {
      hArmeRougeSangValueD = tArmeRougeSangValueD.dice.reduce((accumulateur, valeurCourante) => {
        let newV = +valeurCourante;
        if (newV <= 3) { newV = 4; }

        return accumulateur + newV;
      }, 0);
    }

    if (isCheneSculpte) {
      hCheneSculpte = tCheneSculpte.dice.reduce((accumulateur, valeurCourante) => {
        let newV = +valeurCourante;
        if (newV <= 3) { newV = 4; }

        return accumulateur + newV;
      }, 0);
    }

    if (isGriffureGravee) {
      hGriffuresGraveesValueD = tGriffuresGraveesValueD.dice.reduce((accumulateur, valeurCourante) => {
        let newV = +valeurCourante;
        if (newV <= 3) { newV = 4; }

        return accumulateur + newV;
      }, 0);
    }

    if (isMasqueBrise) {
      hMasqueBriseValueD = tMasqueBriseValueD.dice.reduce((accumulateur, valeurCourante) => {
        let newV = +valeurCourante;
        if (newV <= 3) { newV = 4; }

        return accumulateur + newV;
      }, 0);
    }

    if (isRouagesCasses) {
      hRouagesCassesValueD = tRouagesCassesValueD.dice.reduce((accumulateur, valeurCourante) => {
        let newV = +valeurCourante;
        if (newV <= 3) { newV = 4; }

        return accumulateur + newV;
      }, 0);
    }
  }

  if (conditions.devaste || conditions.equilibre) {
    tViolence = diceViolence.reduce((accumulateur, valeurCourante) => {
      let newV = valeurCourante;
      if (newV <= 3) { newV = 4; }

      return accumulateur + newV;
    }, 0);

    if (bonusViolence.length !== 0) { tViolence += bonusViolence.reduce((accumulateur, valeurCourante) => accumulateur + +valeurCourante); }

    if (isFureur) {
      hFureur = tFureur.dice.reduce((accumulateur, valeurCourante) => {
        let newV = +valeurCourante;
        if (newV <= 3) { newV = 4; }

        return accumulateur + newV;
      }, 0);
    }

    if (isUltraviolence) {
      hUltraviolence = tUltraviolence.dice.reduce((accumulateur, valeurCourante) => {
        let newV = +valeurCourante;
        if (newV <= 3) { newV = 4; }

        return accumulateur + newV;
      }, 0);
    }

    if (isArmeAzurine) {
      hArmeAzurineValueV = tArmeAzurineValueV.dice.reduce((accumulateur, valeurCourante) => {
        let newV = +valeurCourante;
        if (newV <= 3) { newV = 4; }

        return accumulateur + newV;
      }, 0);
    }

    if (isArmeRougeSang) {
      hArmeRougeSangValueV = tArmeRougeSangValueV.dice.reduce((accumulateur, valeurCourante) => {
        let newV = +valeurCourante;
        if (newV <= 3) { newV = 4; }

        return accumulateur + newV;
      }, 0);
    }

    if (isGriffureGravee) {
      hGriffuresGraveesValueV = tGriffuresGraveesValueV.dice.reduce((accumulateur, valeurCourante) => {
        let newV = +valeurCourante;
        if (newV <= 3) { newV = 4; }

        return accumulateur + newV;
      }, 0);
    }

    if (isMasqueBrise) {
      hMasqueBriseValueV = tMasqueBriseValueV.dice.reduce((accumulateur, valeurCourante) => {
        let newV = +valeurCourante;
        if (newV <= 3) { newV = 4; }

        return accumulateur + newV;
      }, 0);
    }

    if (isRouagesCasses) {
      hRouagesCassesValueV = tRouagesCassesValueV.dice.reduce((accumulateur, valeurCourante) => {
        let newV = +valeurCourante;
        if (newV <= 3) { newV = 4; }

        return accumulateur + newV;
      }, 0);
    }
  }

  if (isTenebricide) {
    let limiteD = Math.floor(+diceDegats.length / 2);
    let limiteV = Math.floor(+diceViolence.length / 2);

    if (limiteD < 1) { limiteD = 1; }
    if (limiteV < 1) { limiteV = 1; }

    vTDegats = diceDegats.reduce((accumulateur, valeurCourante, index) => {
      let result = +accumulateur;

      if (index < limiteD) {
        let newV = +valeurCourante;

        if (conditions.bourreau || conditions.equilibre) {
          if (newV <= 3) { newV = 4; }
        }

        result += newV;
      }

      return result;
    }, 0);

    if (bonusDegats.length !== 0) { vTDegats += bonusDegats.reduce((accumulateur, valeurCourante) => accumulateur + +valeurCourante); }

    vTViolence = diceViolence.reduce((accumulateur, valeurCourante, index) => {
      let result = +accumulateur;

      if (index < limiteV) {
        let newV = +valeurCourante;

        if (conditions.bourreau || conditions.equilibre) {
          if (newV <= 3) { newV = 4; }
        }

        result += newV;
      }

      return result;
    }, 0);

    if (bonusViolence.length !== 0) { vTViolence += bonusViolence.reduce((accumulateur, valeurCourante) => accumulateur + +valeurCourante); }

    if (isMeurtrier) {
      let diceMeurtrier = +tMeurtrier.dice[0];

      if (conditions.bourreau || conditions.equilibre) {
        if (diceMeurtrier <= 3) { diceMeurtrier = 4; }
      }

      vTMeurtrier = diceMeurtrier;
    }

    if (isDestructeur) {
      let diceDestructeur = +tDestructeur.dice[0];

      if (conditions.bourreau || conditions.equilibre) {
        if (diceDestructeur <= 3) { diceDestructeur = 4; }
      }

      vTDestructeur = diceDestructeur;
    }

    if (isCheneSculpte) {
      let diceCheneSculpte = +tCheneSculpte.dice[0];

      if (conditions.bourreau || conditions.equilibre) {
        if (diceCheneSculpte <= 3) { diceCheneSculpte = 4; }
      }

      vTCheneSculpte = diceCheneSculpte;
    }

    if (isFureur) {
      let diceFureur1 = +tFureur.dice[0];
      let diceFureur2 = +tFureur.dice[1];

      if (conditions.devaste || conditions.equilibre) {
        if (diceFureur1 <= 3) { diceFureur1 = 4; }
        if (diceFureur2 <= 3) { diceFureur2 = 4; }
      }

      vTFureur = diceFureur1 + diceFureur2;
    }

    if (isSurprise) {
      let bonusSurprise = +tSurprise.result;

      if (tSurprise.dice.length !== 0) {
        const dices = tSurprise.dice;
        const limiteS = Math.floor(+dices.length / 2);
        const normalRoll = dices.reduce((accumulateur, valeurCourante) => accumulateur + +valeurCourante);
        bonusSurprise -= +normalRoll;

        vTSurprise = dices.reduce((accumulateur, valeurCourante, index) => {
          let result = accumulateur;

          if (index < limiteS) {
            let newV = +valeurCourante;

            if (conditions.bourreau || conditions.equilibre) {
              if (newV <= 3) { newV = 4; }
            }

            result += newV;
          }

          return result;
        }, 0);
      }

      vTSurprise += +bonusSurprise;
    }

    if (isUltraviolence) {
      let diceUltraviolence = +tUltraviolence.dice[0];

      if (conditions.devaste || conditions.equilibre) {
        if (diceUltraviolence <= 3) { diceUltraviolence = 4; }
      }

      vTUltraviolence = diceUltraviolence;
    }
  }

  const computed = {
    degats: tDegats,
    violence: tViolence,
    tenebricideValueD: vTDegats,
    tenebricideValueV: vTViolence,
    tenebricideASValue: vTSurprise,
    destructeurValue: hDestructeur,
    fureurValue: hFureur,
    meurtrierValue: hMeurtrier,
    attaqueSurpriseValue: hSurprise,
    ultraviolenceValue: hUltraviolence,
    armeAzurineValueD: hArmeAzurineValueD,
    armeAzurineValueV: hArmeAzurineValueV,
    armeRougeSangValueD: hArmeRougeSangValueD,
    armeRougeSangValueV: hArmeRougeSangValueV,
    cheneSculpteValue: hCheneSculpte,
    griffuresGraveesValueD: hGriffuresGraveesValueD,
    griffuresGraveesValueV: hGriffuresGraveesValueV,
    masqueBriseValueD: hMasqueBriseValueD,
    masqueBriseValueV: hMasqueBriseValueV,
    rouagesCassesValueD: hRouagesCassesValueD,
    rouagesCassesValueV: hRouagesCassesValueV,
    tDestructeurValue: vTDestructeur,
    tFureurValue: vTFureur,
    tMeurtrierValue: vTMeurtrier,
    tUltraviolenceValue: vTUltraviolence,
    tCheneSculpteValue: vTCheneSculpte,
  };

  return computed;
}
  /* eslint-disable no-restricted-syntax */
/* eslint-disable guard-for-in */
/* eslint-disable object-shorthand */
/* eslint-disable camelcase */
/* eslint-disable max-len */
/* eslint-disable default-case */
/* eslint-disable prefer-destructuring */
/* eslint-disable no-use-before-define */
/* eslint-disable no-unused-vars */
/* eslint-disable no-undef */
on('change:armure', async (newArmure) => {
  const armureName = newArmure.newValue;

  const dArmureModif = listDonneesArmures.map((a) => `${armureName}-${a}-modif`);
  const dArmureActuel = listDonneesArmures.map((a) => `${armureName}-${a}-actuel`);

  let listAttrs = ['warmaster150PG', 'warmaster250PG'];
  listAttrs = listAttrs.concat(dArmureModif, dArmureActuel);

  const attrs = await getAttrsAsync(listAttrs);

  const warmaster150 = +attrs.warmaster150PG;
  const warmaster250 = +attrs.warmaster250PG;

  const armureActuel = +attrs[`${armureName}-armure-actuel`] || 0;
  const energieActuel = +attrs[`${armureName}-energie-actuel`] || 0;

  const armureModif = +attrs[`${armureName}-armure-modif`] || 0;
  const energieModif = +attrs[`${armureName}-energie-modif`] || 0;
  const cdfModif = +attrs[`${armureName}-cdf-modif`] || 0;

  const armurePJMax = +dataArmure[armureName].armureMax || 0;
  const energiePJMax = +dataArmure[armureName].energieMax || 0;
  const cdfPJMax = +dataArmure[armureName].cdfMax || 0;

  let totalArmure = 0;
  let totalEnergie = 0;
  let totalCdf = 0;

  totalArmure = armurePJMax + armureModif;
  totalCdf = cdfPJMax + cdfModif;

  if (armureName === 'warmaster') totalEnergie = energiePJMax + warmaster150 + warmaster250 + energieModif;
  else { totalEnergie = energiePJMax + energieModif; }

  let sTete = 0;
  let sBG = 0;
  let sTorse = 0;
  let sJG = 0;
  let sBD = 0;
  let sJD = 0;

  switch (armureName) {
    case 'barbarian':
      sTete = 5;
      sBG = 5;
      sTorse = 8;
      sJG = 5;
      sBD = 5;
      sJD = 5;
      break;
    case 'bard':
      sTete = 5;
      sBG = 5;
      sTorse = 8;
      sJG = 5;
      sBD = 5;
      sJD = 5;
      break;
    case 'berserk':
      sTete = 6;
      sBG = 6;
      sTorse = 10;
      sJG = 6;
      sBD = 6;
      sJD = 6;
      break;
    case 'druid':
      sTete = 5;
      sBG = 5;
      sTorse = 8;
      sJG = 5;
      sBD = 5;
      sJD = 5;
      break;
    case 'monk':
      sTete = 7;
      sBG = 8;
      sTorse = 10;
      sJG = 6;
      sBD = 8;
      sJD = 6;
      break;
    case 'necromancer':
      sTete = 12;
      sBG = 12;
      sTorse = 12;
      sJG = 12;
      sBD = 12;
      sJD = 12;
      break;
    case 'paladin':
      sTete = 7;
      sBG = 7;
      sTorse = 10;
      sJG = 7;
      sBD = 7;
      sJD = 7;
      break;
    case 'priest':
      sTete = 5;
      sBG = 5;
      sTorse = 8;
      sJG = 5;
      sBD = 5;
      sJD = 5;
      break;
    case 'psion':
      sTete = 7;
      sBG = 10;
      sTorse = 12;
      sJG = 7;
      sBD = 10;
      sJD = 7;
      break;
    case 'ranger':
      sTete = 4;
      sBG = 4;
      sTorse = 6;
      sJG = 4;
      sBD = 4;
      sJD = 4;
      break;
    case 'rogue':
      sTete = 5;
      sBG = 5;
      sTorse = 8;
      sJG = 5;
      sBD = 5;
      sJD = 5;
      break;
    case 'shaman':
      sTete = 5;
      sBG = 5;
      sTorse = 8;
      sJG = 5;
      sBD = 5;
      sJD = 5;
      break;
    case 'sorcerer':
      sTete = 7;
      sBG = 8;
      sTorse = 10;
      sJG = 6;
      sBD = 8;
      sJD = 6;
      break;
    case 'warlock':
      sTete = 5;
      sBG = 8;
      sTorse = 8;
      sJG = 5;
      sBD = 8;
      sJD = 5;
      break;
    case 'warmaster':
      sTete = 5;
      sBG = 5;
      sTorse = 8;
      sJG = 5;
      sBD = 5;
      sJD = 5;
      break;
    case 'warrior':
      sTete = 7;
      sBG = 10;
      sTorse = 12;
      sJG = 7;
      sBD = 10;
      sJD = 7;
      break;
    case 'wizard':
      sTete = 5;
      sBG = 5;
      sTorse = 8;
      sJG = 5;
      sBD = 5;
      sJD = 5;
      break;
  }

  const newAttrs = {
    armurePJ: armureActuel,
    armurePJ_max: totalArmure,
    armurePJModif: armureModif,
    energiePJ: energieActuel,
    energiePJ_max: totalEnergie,
    energiePJModif: energieModif,
    cdfPJ: totalCdf,
    cdfPJ_max: totalCdf,
    cdfPJModif: cdfModif,
    barbarianGoliath: 0,
    berserkIlluminationBeaconA: 0,
    berserkIlluminationTorchA: 0,
    berserkIlluminationProjectorA: 0,
    berserkIlluminationLighthouseA: 0,
    berserkIlluminationLanternA: 0,
    berserkRageA: 0,
    shamanNbreTotem: 0,
    shamanAscension: 0,
    sorcererMMVolNuee: 0,
    sorcererMMPhase: 0,
    sorcererMMEtirement: 0,
    sorcererMMCorpMetal: 0,
    sorcererMMCorpFluide: 0,
    sorcererMMPMGuerre: 0,
    sorcererMM250PG: 0,
    warlockForward: 0,
    warlockRecord: 0,
    warlockRewind: 0,
    warmasterImpFPersonnel: 0,
    warmasterImpGPersonnel: 0,
    warriorSoldierA: 0,
    warriorHunterA: 0,
    warriorScholarA: 0,
    warriorHeraldA: 0,
    warriorScoutA: 0,
    MALShamanNbreTotem: 0,
    MALWarriorSoldierA: 0,
    MALWarriorHunterA: 0,
    MALWarriorScholarA: 0,
    MALWarriorHeraldA: 0,
    MALWarriorScoutA: 0,
    MALWarmasterImpFPersonnel: 0,
    MALWarmasterImpGPersonnel: 0,
    MALRogueGhost: 0,
    rogueGhost: 0,
    bardChangeling: 0,
    MALBarbarianGoliath: 0,
    slotTeteMax: sTete,
    slotTorseMax: sTorse,
    slotJGMax: sJG,
    slotJDMax: sJD,
    slotBGMax: sBG,
    slotBDMax: sBD,
  };

  await setAttrsAsync(newAttrs);
});

on('change:fichePNJ', async (newSheet) => {
  const sheet = +newSheet.newValue;
  const update = {};

  if (sheet === 0 || sheet === 1 || sheet === 2 || sheet === 3) {
    update.tab = 'dossier';
    update.armure = 'sans';
  }

  if (sheet === 4) {
    update.tab = 'vehicule';
    update.armure = 'sans';
  }

  await setAttrsAsync(update);
});

const listDonneesArmures = ['armure', 'energie', 'cdf'];

listDonneesArmures.forEach((data) => {
  on(`change:${data}pj sheet:opened`, async () => {
    const attrs = await getAttrsAsync([`${data}PJ`, 'armure']);
    const armure = attrs.armure;

    const nValue = {};
    nValue[`${armure}-${data}-actuel`] = +attrs[`${data}PJ`];

    await setAttrsAsync(nValue);
  });

  on(`change:${data}pjmodif sheet:opened`, async () => {
    const attrs = await getAttrsAsync([`${data}PJModif`, 'armure']);
    const armure = attrs.armure;

    const nValue = {};
    nValue[`${armure}-${data}-modif`] = +attrs[`${data}PJModif`];

    await setAttrsAsync(nValue);
  });
});

// ARMURE
on('change:armurePJModif', async () => {
  const attrs = await getAttrsAsync(['armurePJModif', 'armure']);
  const armure = attrs.armure;
  const modif = +attrs.armurePJModif;

  const armureValue = +dataArmure[armure].armureMax + modif;

  await setAttrsAsync({ armurePJ_max: armureValue });
});

// ENERGIE
on('change:energiePJModif change:warmaster150PG change:warmaster250PG', async () => {
  const attrs = await getAttrsAsync(['armure', 'warmaster150PG', 'warmaster250PG', 'energiePJModif']);
  const armure = attrs.armure;

  const warmaster150 = +attrs.warmaster150PG;
  const warmaster250 = +attrs.warmaster250PG;
  const modif = +attrs.energiePJModif;

  let energie = 0;

  if (armure === 'warmaster') energie = +dataArmure[armure].energieMax + warmaster150 + warmaster250 + modif;
  else energie = +dataArmure[armure].energieMax + modif;

  await setAttrsAsync({ energiePJ_max: energie });
});

// CDF
on('change:cdfPJModif change:barbarianGoliath change:MALBarbarianGoliath change:warmasterImpFPersonnel change:warmasterImpForce change:MALWarmasterImpFPersonnel change:MALWarmasterImpForce change:sorcererMMCorpMetal change:sorcerer150PG change:sorcererMM250PG', async () => {
  const attrs = await getAttrsAsync(['armure', 'armureLegende', 'cdfPJModif', 'barbarianGoliath', 'MALBarbarianGoliath', 'sorcererMMCorpMetal', 'sorcerer150PG', 'sorcererMM250PG', 'warmasterImpFPersonnel', 'warmasterImpForce', 'MALWarmasterImpFPersonnel', 'MALWarmasterImpForce']);

  const armure = attrs.armure;
  const armureL = attrs.armureLegende;

  const max = +dataArmure[armure].cdfMax;
  const modif = +attrs.cdfPJModif;

  const goliath = +attrs.barbarianGoliath;
  const goliathMAL = +attrs.MALBarbarianGoliath;

  const corpMetal = +attrs.sorcererMMCorpMetal;
  const CM150PG = attrs.sorcerer150PG;
  const CM250PG = +attrs.sorcererMM250PG;

  const warmasterForce = attrs.warmasterImpForce;
  const warmasterForcePers = +attrs.warmasterImpFPersonnel;

  const warmasterForceMAL = attrs.MALWarmasterImpForce;
  const warmasterForcePersMAL = +attrs.MALWarmasterImpFPersonnel;

  let total = max + modif;

  log(corpMetal);

  switch (armure) {
    case 'barbarian':
      total += goliath;
      break;

    case 'sorcerer':
      if (corpMetal !== 0 || CM250PG !== 0) {
        total += 2;

        if (CM150PG !== '0') total += 2;
      }
      break;

    case 'warmaster':
      if (warmasterForce === 'on' && warmasterForcePers !== 0) total += warmasterForcePers;
      break;
  }

  switch (armureL) {
    case 'barbarian':
      total += goliathMAL;
      break;

    case 'warmaster':
      if (warmasterForceMAL === 'on' && warmasterForcePersMAL !== 0) { total += warmasterForcePersMAL; }
      break;
  }

  await setAttrsAsync({
    cdfPJ: total,
    cdfPJ_max: total,
  });
});

// ESPOIR
on('change:espoirModif change:fichePNJ change:armure change:berserk250PG', async () => {
  const attrs = await getAttrsAsync(['armure', 'espoirModif', 'fichePNJ', 'berserk250PG']);

  const fiche = +attrs.fichePNJ;

  if (fiche !== 0) { return; }

  const armure = attrs.Armure;

  const modif = +attrs.espoirModif;

  const berserk250PG = attrs.berserk250PG;

  let max = 50;
  let bonus = 0;

  const newAttrs = {};

  switch (armure) {
    case 'berserk':
      if (berserk250PG === 'on') { bonus = 25; } else { bonus = 15; }
      break;

    case 'necromancer':
      max = 10;
      break;
  }

  newAttrs.espoir_max = max + modif + bonus;

  await setAttrsAsync(newAttrs);
});

// EGIDE
on('change:fichePNJ change:armure change:berserkNiveaux change:berserkRageN1Egide change:berserkRageN2Egide change:berserkRageN3Egide', async () => {
  const attrs = await getAttrsAsync(['armure', 'fichePNJ', 'berserkNiveaux', 'berserkRageN1Egide', 'berserkRageN2Egide', 'berserkRageN3Egide']);

  const fiche = +attrs.fichePNJ;

  if (fiche !== 0) { return; }

  const armure = attrs.armure;

  const rage = +attrs.berserkNiveaux;
  const N1 = +attrs.berserkRageN1Egide;
  const N2 = +attrs.berserkRageN2Egide;
  const N3 = +attrs.berserkRageN3Egide;

  let egide = 0;

  if (armure === 'berserk') {
    switch (rage) {
      case 1:
        egide += N1;
        break;

      case 2:
        egide += N2;
        break;

      case 3:
        egide += N3;
        break;
    }
  }

  await setAttrsAsync({ egideBonus: egide });
});

// DEFENSE
on('change:fichePNJ change:armure change:armureLegende change:defense change:defBM change:bonusDefense change:defenseODBonus change:defenseModifPerso change:barbarianDef change:berserkRageA change:berserkNiveaux change:berserkRageN1DR change:berserkRageN2DR change:berserkRageN3DR change:sorcererMMCorpFluide change:sorcerer150PG change:sorcererMM250PG change:warmasterImpEPersonnel change:warmasterImpEsquive change:MALWarmasterImpEPersonnel change:MALWarmasterImpEsquive change:MALBarbarianDef change:MasquePNJAE change:MasquePNJAEMaj change:defensePNJ change:MADDjinnNanobrumeActive', async () => {
  const attrs = await getAttrsAsync(['defense', 'defensePNJ', 'defBM', 'bonusDefense', 'defenseModifPerso', 'defenseODBonus',
    'fichePNJ', 'armure', 'armureLegende',
    'barbarianDef',
    'MALBarbarianDef',
    'berserkRageA', 'berserkNiveaux', 'berserkRageN1DR', 'berserkRageN2DR', 'berserkRageN3DR',
    'sorcererMMCorpFluide', 'sorcerer150PG', 'sorcerer250PG', 'sorcererMM250PG',
    'warmasterImpEsquive', 'warmasterImpEPersonnel',
    'MALWarmasterImpEsquive', 'MALWarmasterImpEPersonnel',
    'MasquePNJAE', 'MasquePNJAEMaj',
    'MADDjinnNanobrumeActive']);

  const fiche = +attrs.fichePNJ;

  const basePJ = +attrs.defense;
  const basePNJ = +attrs.defensePNJ;

  const modifStyle = parseInt(attrs.defBM, 10) || 0;
  const modifAutre = parseInt(attrs.bonusDefense, 10) || 0;
  const modifPJ = +attrs.defenseModifPerso;
  const modifOD = parseInt(attrs.defenseODBonus, 10) || 0;

  const armure = attrs.armure;
  const armureL = attrs.armureLegende;

  const goliath = +attrs.barbarianDef;
  const MALGoliath = +attrs.MALBarbarianDef;

  const berserkRage = attrs.berserkRageA;
  const berserkNiveau = attrs.berserkNiveaux;
  const berserkRageN1 = +attrs.berserkRageN1DR;
  const berserkRageN2 = +attrs.berserkRageN2DR;
  const berserkRageN3 = +attrs.berserkRageN3DR;

  const sorcererCorpFluide = attrs.sorcererMMCorpFluide;
  const sorcerer150PG = +attrs.sorcerer150PG;
  const sorcerer250PG = attrs.sorcerer250PG;
  const sorcererMM250PG = +attrs.sorcererMM250PG;

  const warmasterEsquive = attrs.warmasterImpEsquive;
  const warmasterEsquiveP = +attrs.warmasterImpEPersonnel;

  const MALWarmasterEsquive = attrs.MALWarmasterImpEsquive;
  const MALWarmasterEsquiveP = +attrs.MALWarmasterImpEPersonnel;

  const masqueAE = +attrs.MasquePNJAE;
  const masqueAEMaj = +attrs.MasquePNJAEMaj;

  const mechaArmureNanoBrume = attrs.MADDjinnNanobrumeActive;

  let base = 0;
  let modif = 0;
  let modifS = 0;
  let totalMecha = 0;
  let total = 0;

  switch (fiche) {
    case 0:
      base += basePJ;
      modifS += modifPJ;
      totalMecha = basePJ + modifAutre + modifOD;

      switch (armure) {
        case 'sans':
        case 'guardian':
          modif = modifStyle + modifAutre;
          break;

        default:
          modif = modifStyle + modifAutre + modifOD;
          break;
      }

      if (armure === 'barbarian') { modif -= goliath; }

      if (armure === 'berserk' && berserkRage === 'on') {
        if (berserkNiveau === 1) { modif -= berserkRageN1; } else if (berserkNiveau === 2) { modif -= berserkRageN2; } else if (berserkNiveau === 3) { modif -= berserkRageN3; }
      }

      if (armure === 'sorcerer') {
        if (sorcerer250PG === 'on') {
          if (sorcererMM250PG === 1) {
            modif += 2;

            if (sorcerer150PG !== 0) { modif += 1; }
          }
        } else if (sorcererCorpFluide !== '0') {
          modif += 2;

          if (sorcerer150PG !== 0) { modif += 1; }
        }
      }

      if (armure === 'warmaster' && warmasterEsquive !== '0' && warmasterEsquiveP !== 0) { modif += 2; }

      if (armureL === 'warmaster' && MALWarmasterEsquive !== '0' && MALWarmasterEsquiveP !== 0) { modif += 2; }

      if (armureL === 'barbarian') { modif -= MALGoliath; }

      if (mechaArmureNanoBrume === 1) { totalMecha += 3; }
      break;
    case 1:
    case 2:
      base += basePNJ;
      modifS += modifPJ;
      modif += modifAutre + masqueAE + masqueAEMaj;
      break;

    case 3:
      base += basePNJ;
      modifS += modifPJ;
      modif += masqueAE + masqueAEMaj;
      break;
  }

  total += Math.max(base + modif + modifS, 0);

  await setAttrsAsync({
    defenseModif: modif,
    defenseTotal: total,
    mechaArmureDefense: totalMecha,
  });
});

// REACTION
on('change:fichePNJ change:armure change:armureLegende change:reaction change:rctBM change:bonusReaction change:reactionODBonus change:reactionModifPerso change:barbarianRea change:berserkNiveaux change:berserkRageN1DR change:berserkRageN2DR change:berserkRageN3DR change:paladinWatchtower change:sorcererMMCorpFluide change:sorcerer150PG change:sorcererMM250PG change:warmasterImpEPersonnel change:warmasterImpEsquive change:MALWarmasterImpEsquive change:MALWarmasterImpEPersonnel change:MALBarbarianRea change:MachinePNJAE change:MachinePNJAEMaj change:reactionPNJ change:MADDjinnNanobrumeActive', async () => {
  const attrs = await getAttrsAsync(['reaction', 'reactionPNJ', 'rctBM', 'bonusReaction', 'reactionModifPerso', 'reactionODBonus',
    'fichePNJ', 'armure', 'armureLegende',
    'barbarianRea',
    'MALBarbarianRea',
    'berserkRageA', 'berserkNiveaux', 'berserkRageN1DR', 'berserkRageN2DR', 'berserkRageN3DR',
    'paladinWatchtower',
    'sorcererMMCorpFluide', 'sorcerer150PG', 'sorcerer250PG', 'sorcererMM250PG',
    'warmasterImpEsquive', 'warmasterImpEPersonnel',
    'MALWarmasterImpEsquive', 'MALWarmasterImpEPersonnel',
    'MachinePNJAE', 'MachinePNJAEMaj',
    'MADDjinnNanobrumeActive']);

  const fiche = +attrs.fichePNJ;

  const basePJ = +attrs.reaction;
  const basePNJ = +attrs.reactionPNJ;

  const modifStyle = parseInt(attrs.rctBM, 10) || 0;
  const modifAutre = parseInt(attrs.bonusReaction, 10) || 0;
  const modifPJ = +attrs.reactionModifPerso;
  const modifOD = parseInt(attrs.reactionODBonus, 10) || 0;

  const armure = attrs.armure;
  const armureL = attrs.armureLegende;

  const goliath = +attrs.barbarianRea;
  const MALGoliath = +attrs.MALBarbarianRea;

  const berserkRage = attrs.berserkRageA;
  const berserkNiveau = attrs.berserkNiveaux;
  const berserkRageN1 = +attrs.berserkRageN1DR;
  const berserkRageN2 = +attrs.berserkRageN2DR;
  const berserkRageN3 = +attrs.berserkRageN3DR;

  const paladinWatchtower = attrs.paladinWatchtower;

  const sorcererCorpFluide = attrs.sorcererMMCorpFluide;
  const sorcerer150PG = +attrs.sorcerer150PG;
  const sorcerer250PG = attrs.sorcerer250PG;
  const sorcererMM250PG = +attrs.sorcererMM250PG;

  const warmasterEsquive = attrs.warmasterImpEsquive;
  const warmasterEsquiveP = +attrs.warmasterImpEPersonnel;

  const MALWarmasterEsquive = attrs.MALWarmasterImpEsquive;
  const MALWarmasterEsquiveP = +attrs.MALWarmasterImpEPersonnel;

  const machineAE = +attrs.MachinePNJAE;
  const machineAEMaj = +attrs.MachinePNJAEMaj;

  const mechaArmureNanoBrume = attrs.MADDjinnNanobrumeActive;

  let base = 0;
  let modif = 0;
  let modifS = 0;
  let totalMecha = 0;
  let total = 0;

  switch (fiche) {
    case 0:
      base += basePJ;
      modifS += modifPJ;
      totalMecha += basePJ + modifAutre + modifOD;

      switch (armure) {
        case 'sans':
        case 'guardian':
          modif = modifStyle + modifAutre;
          break;

        default:
          modif = modifStyle + modifAutre + modifOD;
          break;
      }

      if (armure === 'barbarian') { modif -= goliath; }

      if (armure === 'berserk' && berserkRage === 'on') {
        if (berserkNiveau === 1) { modif -= berserkRageN1; } else if (berserkNiveau === 2) { modif -= berserkRageN2; } else if (berserkNiveau === 3) { modif -= berserkRageN3; }
      }

      if (armure === 'sorcerer') {
        if (sorcerer250PG === 'on') {
          if (sorcererMM250PG === 1) {
            modif += 2;

            if (sorcerer150PG !== 0) { modif += 1; }
          }
        } else if (sorcererCorpFluide !== '0') {
          modif += 2;

          if (sorcerer150PG !== 0) { modif += 1; }
        }
      }

      if (armure === 'warmaster' && warmasterEsquive !== '0' && warmasterEsquiveP !== 0) { modif += 2; }

      if (armureL === 'warmaster' && MALWarmasterEsquive !== '0' && MALWarmasterEsquiveP !== 0) { modif += 2; }

      if (armureL === 'barbarian') { modif -= MALGoliath; }

      if (armure === 'paladin' && paladinWatchtower === 'Activé') {
        const temp = base + modif + modifS;

        modif -= Math.ceil(temp / 2);
      }

      if (mechaArmureNanoBrume === 1) { totalMecha += 3; }
      break;
    case 1:
    case 2:
      base += basePNJ;
      modifS += modifPJ;
      modif += modifAutre + machineAE + machineAEMaj;
      break;

    case 3:
      base += basePNJ;
      modifS += modifPJ;
      modif += machineAE + machineAEMaj;
      break;
  }

  total += Math.max(base + modif + modifS, 0);

  await setAttrsAsync({
    reactionModif: modif,
    reactionTotal: total,
    mechaArmureReaction: totalMecha,
  });
});

// RESILIENCE
on('clicked:calculResilienceFinal', async () => {
  const attrs = await getAttrsAsync(['listeTypePNJ', 'armurePNJ_max', 'santePNJ_max']);

  const type = +attrs.listeTypePNJ;
  const armure = +attrs.armurePNJ_max;
  const sante = +attrs.santePNJ_max;

  let total = 0;

  switch (type) {
    case 1:
      if (sante > 0) { total = Math.floor(sante / 10); } else { total = Math.floor(armure / 10); }
      break;

    case 2:
      if (sante > 0) { total = Math.floor(sante / 10) * 2; } else { total = Math.floor(armure / 10) * 2; }
      break;

    case 3:
      if (sante > 0) { total = Math.floor(sante / 10) * 3; } else { total = Math.floor(armure / 10) * 3; }
      break;

    case 4:
      if (sante > 0) { total = Math.floor(sante / 30); } else { total = Math.floor(armure / 30); }
      break;

    case 5:
      if (sante > 0) { total = Math.floor(sante / 20); } else { total = Math.floor(armure / 20); }
      break;

    case 6:
      if (sante > 0) { total = Math.floor(sante / 10); } else { total = Math.floor(armure / 10); }
      break;
  }

  await setAttrsAsync({
    popup: 0,
    resilience: total,
    resilience_max: total,
  });
});

on('clicked:calculerResilience', async () => {
  await setAttrsAsync({
    popup: 2,
  });
});

on('change:berserk350PG', async () => {
  const attrs = await getAttrsAsync(['berserk350PG']);
  const state = attrs.berserk350PG;

  let dgts = '2D6';
  let violence = '2D6';
  let beacon = `2 ${getTranslationByKey('reussites-automatiques')}`;
  let egide = '2';

  if (state === 'on') {
    dgts = '4D6';
    violence = '4D6';
    beacon = `4 ${getTranslationByKey('reussites-automatiques')}`;
    egide = '4';
  }

  await setAttrsAsync({
    berserkIlluminationBlazeDgts: dgts,
    berserkIlluminationBlazeViolence: violence,
    berserkIlluminationBeaconBonus: beacon,
    berserkIlluminationTorchEgide: egide,
  });
});

// BARBARIAN
on('change:barbarianNoMDefense change:barbarianGoliath', async () => {
  const attrs = await getAttrsAsync(['barbarianGoliath', 'barbarianNoMDefense']);

  const goliath = +attrs.barbarianGoliath;
  const PG200 = attrs.barbarianNoMDefense;

  let defense = 0;
  const reaction = goliath * 2;
  const dgts = `${goliath}D6`;

  if (PG200 === '0') { defense = goliath; }

  await setAttrsAsync({
    barbarianDef: defense,
    barbarianRea: reaction,
    barbarianDegat: dgts,
  });
});

// SHAMAN
on('change:shamanAscensionEnergie', async () => {
  const attrs = await getAttrsAsync(['shamanAscension', 'shamanAscensionEnergie']);

  const ascension = +attrs.shamanAscension;
  const energie = +attrs.shamanAscensionEnergie;

  if (ascension === 1) { await setAttrsAsync({ energieAscension_max: energie }); }
});

on('change:armurePJModif', async () => {
  const attrs = await getAttrsAsync(['armurePJModif']);

  const base = 60;
  const modif = +attrs.armurePJModif;

  await setAttrsAsync({ armureAscension_max: base + modif });
});

on('change:cdfPJAscensionModif', async () => {
  const attrs = await getAttrsAsync(['cdfPJAscensionModif']);

  const base = 10;
  const modif = +attrs.cdfPJAscensionModif;
  const total = base + modif;

  await setAttrsAsync({
    cdfAscension: total,
    cdfAscension_max: total,
  });
});

on('change:shamanNbreTotem', async () => {
  const attrs = await getAttrsAsync(['shaman150PG', 'shamanNbreTotem']);

  const shaman150PG = +attrs.shaman150PG;
  const totem = +attrs.shamanNbreTotem;

  if (totem === 3 && shaman150PG === 0) { await setAttrsAsync({ shamanNbreTotem: 2 }); }
});

// GESTION DES ASPECTS ET CARACTERISTIQUES
// Chair
on('change:deplacement change:force change:endurance change:santeModif change:santeODBonus sheet:opened', async () => {
  const attrs = await getAttrsAsync(['fichePNJ', 'chair', 'deplacement', 'force', 'endurance', 'santeModif', 'santeODBonus']);

  const fiche = +attrs.fichePNJ;

  if (fiche !== 0) { return; }

  const chair = +attrs.chair;

  const deplacement = +attrs.deplacement;
  const force = +attrs.force;
  const endurance = +attrs.endurance;

  const modif = +attrs.santeModif;
  const OD = +attrs.santeODBonus;

  maxCar('deplacement', deplacement, chair);
  maxCar('force', force, chair);
  maxCar('endurance', endurance, chair);

  const total = 10 + (Math.max(deplacement, force, endurance) * 6) + modif + OD;

  await setAttrsAsync({ santepj_max: total });
});
// Bête
on('change:fichePNJ change:armure change:hargne change:combat change:instinct change:calODHar change:calODCom change:calODIns sheet:opened', async () => {
  const attrs = await getAttrsAsync(['fichePNJ', 'armure', 'bete', 'hargne', 'combat', 'instinct', 'calODHar', 'calODCom', 'calODIns']);

  const fiche = +attrs.fichePNJ;

  if (fiche !== 0) { return; }

  const armure = +attrs.armure;

  const aspect = +attrs.bete;

  const car1 = +attrs.hargne;
  const car2 = +attrs.combat;
  const car3 = +attrs.instinct;

  const OD1 = +attrs.calODHar;
  const OD2 = +attrs.calODCom;
  const OD3 = +attrs.calODIns;

  maxCar('hargne', car1, aspect);
  maxCar('combat', car2, aspect);
  maxCar('instinct', car3, aspect);

  let total = 0;

  switch (armure) {
    case 'sans':
    case 'guardian':
      total = Math.max(car1, car2, car3);
      break;

    default:
      total = Math.max(car1 + OD1, car2 + OD2, car3 + OD3);
      break;
  }

  await setAttrsAsync({ defense: total });
});
// Machine
on('change:fichePNJ change:armure change:tir change:savoir change:technique change:calODTir change:calODSav change:calODTec sheet:opened', async () => {
  const attrs = await getAttrsAsync(['fichePNJ', 'armure', 'machine', 'tir', 'savoir', 'technique', 'calODTir', 'calODSav', 'calODTec']);

  const fiche = +attrs.fichePNJ;

  if (fiche !== 0) { return; }

  const armure = +attrs.armure;

  const aspect = +attrs.machine;

  const car1 = +attrs.tir;
  const car2 = +attrs.savoir;
  const car3 = +attrs.technique;

  const OD1 = +attrs.calODTir;
  const OD2 = +attrs.calODSav;
  const OD3 = +attrs.calODTec;

  maxCar('tir', car1, aspect);
  maxCar('savoir', car2, aspect);
  maxCar('technique', car3, aspect);

  let total = 0;

  switch (armure) {
    case 'sans':
    case 'guardian':
      total = Math.max(car1, car2, car3);
      break;

    default:
      total = Math.max(car1 + OD1, car2 + OD2, car3 + OD3);
      break;
  }

  await setAttrsAsync({ reaction: total });
});
// Dame
on('change:aura change:parole change:sf', async () => {
  const attrs = await getAttrsAsync(['fichePNJ', 'dame', 'aura', 'parole', 'sf']);

  const fiche = +attrs.fichePNJ;

  if (fiche !== 0) { return; }

  const aspect = +attrs.dame;

  const car1 = +attrs.aura;
  const car2 = +attrs.parole;
  const car3 = +attrs.sf;

  maxCar('aura', car1, aspect);
  maxCar('parole', car2, aspect);
  maxCar('sf', car3, aspect);
});

on('change:fichePNJ change:armure change:discretion change:dexterite change:perception change:calODDis change:calODPer change:calODDex change:initiativeODBonus', async () => {
  const attrs = await getAttrsAsync(['fichePNJ', 'armure', 'masque', 'discretion', 'dexterite', 'perception', 'calODDis', 'calODPer', 'calODDex', 'initiativeODBonus']);

  const fiche = +attrs.fichePNJ;

  if (fiche !== 0) { return; }

  const armure = +attrs.armure;

  const aspect = +attrs.masque;

  const car1 = +attrs.discretion;
  const car2 = +attrs.dexterite;
  const car3 = +attrs.perception;

  const OD1 = +attrs.calODDis;
  const OD2 = +attrs.calODDex;
  const OD3 = +attrs.calODPer;

  const bonus = +attrs.initiativeODBonus;

  maxCar('discretion', car1, aspect);
  maxCar('dexterite', car2, aspect);
  maxCar('perception', car3, aspect);

  let total = 0;

  switch (armure) {
    case 'sans':
    case 'guardian':
      total = Math.max(car1, car2, car3);
      break;

    default:
      total = Math.max(car1 + OD1, car2 + OD2, car3 + OD3) + bonus;
      break;
  }

  await setAttrsAsync({ bonusInitiative: total });
});

on('change:sorcerer250PG', async () => {
  const attrs = await getAttrsAsync(['sorcerer250PG']);

  const PG250 = attrs.sorcerer250PG;

  if (PG250 === 'on') {
    await setAttrsAsync({
      sorcererMMVolNuee: 0,
      sorcererMMPhase: 0,
      sorcererMMEtirement: 0,
      sorcererMMCorpMetal: 0,
      sorcererMMCorpFluide: 0,
      sorcererMMPMGuerre: 0,
    });
  } else { await setAttrsAsync({ sorcererMM250PG: 0 }); }
});

on('change:monk150PG change:monk250PG sheet:opened', async () => {
  const attrs = await getAttrsAsync(['monk150PG', 'monk250PG']);

  const PG150 = +attrs.monk150PG;
  const PG250 = +attrs.monk250PG;

  let vagueDgts = 3;
  let salveDgts = 3;
  let rayonDgts = 4;
  let rayonViolence = 2;

  let vagueEffets = `${i18n_parasitage} 2 / ${i18n_dispersion} 3 / ${i18n_destructeur} / ${i18n_choc} 2`;
  let salveEffets = `${i18n_ultraviolence} / ${i18n_meurtrier} / ${i18n_dispersion} 3 / ${i18n_parasitage} 1`;
  let rayonEffets = `${i18n_parasitage} 1 / ${i18n_perceArmure} 40`;

  if (PG150 === 2) {
    vagueDgts += 2;
    salveDgts += 2;
    rayonDgts += 2;
    rayonViolence += 2;
  }

  if (PG250 === 1) {
    vagueDgts += 2;
    salveDgts += 2;
    rayonDgts += 2;
    rayonViolence += 2;

    vagueEffets = `${i18n_parasitage} 4 / ${i18n_dispersion} 3 / ${i18n_destructeur} / ${i18n_choc} 2`;
    salveEffets = `${i18n_ultraviolence} / ${i18n_meurtrier} / ${i18n_dispersion} 6 / ${i18n_parasitage} 1`;
    rayonEffets = `${i18n_parasitage} 1 / ${i18n_ignoreArmure}`;
  }

  await setAttrsAsync({
    monkVagueDegat: `${vagueDgts}D6`,
    monkSalveDegat: `${salveDgts}D6`,
    monkRayonDegat: `${rayonDgts}D6`,
    monkRayonViolence: `${rayonViolence}D6`,
    monkVagueEffets: vagueEffets,
    monkSalveEffets: salveEffets,
    monkRayonEffets: rayonEffets,
  });
});

on('change:priest200PG', async () => {
  const attrs = await getAttrsAsync(['priest200PG']);

  const PG200 = attrs.priest200PG;

  let contactDice = 3;
  let distanceDice = 2;

  let contactBonus = 6;
  let distanceBonus = 6;

  if (PG200 === 'on') {
    contactDice += 1;
    distanceDice += 1;

    contactBonus += 6;
    distanceBonus += 6;
  }

  await setAttrsAsync({
    priestMechanicContact: `${contactDice}D6+${contactBonus}`,
    priestMechanicDistance: `${distanceDice}D6+${distanceBonus}`,
  });
});

on('change:psion200PG', async () => {
  const attrs = await getAttrsAsync(['psion200PG']);

  const PG200 = +attrs.psion200PG;

  let malusAction = 2;
  let malusAutres = 2;

  if (PG200 === 'on') {
    malusAction += 1;
    malusAutres += 1;
  }

  await setAttrsAsync({
    psionMalusA: `${malusAction}D`,
    psionMalus: malusAutres,
  });
});

on('change:wizard150PG sheet:opened', async () => {
  const attrs = await getAttrsAsync(['wizard150PG']);

  const PG200 = +attrs.wizard150PG;

  let portee = i18n_porteeCourte;

  if (PG200 === 'on') { portee = i18n_porteeMoyenne; }

  await setAttrsAsync({ wizardBPortee: portee });
});

on('change:wizard250PG sheet:opened', async () => {
  const attrs = await getAttrsAsync(['wizard250PG']);

  const PG250 = attrs.wizard250PG;

  let portee = i18n_porteeCourte;

  if (PG250 === 'on') { portee = i18n_porteeMoyenne; }

  await setAttrsAsync({ wizardOPortee: portee });
});

on('change:styleCombat', async () => {
  const attrs = await getAttrsAsync(['styleCombat']);

  const Style = attrs.styleCombat;

  let agressif = '0';
  let akimbo = '0';
  let ambidextre = '0';
  let couvert = '0';
  let defensif = '0';
  let pilonnage = '0';
  let puissant = '0';
  const suppressionD = 0;
  const suppressionV = 0;
  let rctBM = '';
  let defBM = '';
  let description = '';

  switch (Style) {
    case 'couvert':
      couvert = '-3';
      rctBM = '+2';
      description = getTranslationByKey('bonus-style-couvert');
      break;
    case 'agressif':
      agressif = '+3';
      rctBM = '-2';
      defBM = '-2';
      description = getTranslationByKey('bonus-style-agressif');
      break;
    case 'akimbo':
      akimbo = '-3';
      description = getTranslationByKey('bonus-style-akimbo');
      break;
    case 'ambidextre':
      ambidextre = '-3';
      description = getTranslationByKey('bonus-style-ambidextre');
      break;
    case 'defensif':
      defensif = '-3';
      defBM = '+2';
      description = getTranslationByKey('bonus-style-defensif');
      break;
    case 'precis':
      description = getTranslationByKey('bonus-style-precis');
      break;
    case 'pilonnage':
      pilonnage = '-2';
      description = getTranslationByKey('bonus-style-pilonnage');
      break;
    case 'puissant':
      puissant = '@{stylePuissantBonus}';
      rctBM = '-2';
      defBM = '-2';
      description = getTranslationByKey('bonus-style-puissant');
      break;
    case 'suppression':
      description = getTranslationByKey('bonus-style-suppression');
      break;
  }

  await setAttrsAsync({
    atkAgressif: agressif,
    atkAkimbo: akimbo,
    atkAmbidextre: ambidextre,
    atkCouvert: couvert,
    atkDefensif: defensif,
    atkPilonnage: pilonnage,
    atkPuissant: puissant,
    styleSuppressionD: suppressionD,
    styleSuppressionV: suppressionV,
    rctBM: rctBM,
    defBM: defBM,
    styleCombatDescr: description,
  });
});

on('change:repeating_modules remove:repeating_modules', () => {
  TAS.repeatingSimpleSum('modules', 'moduleSlotTete', 'slotsOccupeTete');
  TAS.repeatingSimpleSum('modules', 'moduleSlotTorse', 'slotsOccupeTorse');
  TAS.repeatingSimpleSum('modules', 'moduleSlotBG', 'slotsOccupeBG');
  TAS.repeatingSimpleSum('modules', 'moduleSlotBD', 'slotsOccupeBD');
  TAS.repeatingSimpleSum('modules', 'moduleSlotJG', 'slotsOccupeJG');
  TAS.repeatingSimpleSum('modules', 'moduleSlotJD', 'slotsOccupeJD');
});

on('change:repeating_modulesDCLion remove:repeating_modulesDCLion', () => {
  TAS.repeatingSimpleSum('modulesDCLion', 'moduleSlotDCLTete', 'slotsUDCLTeteTot');
  TAS.repeatingSimpleSum('modulesDCLion', 'moduleSlotDCLTorse', 'slotsUDCLTorseTot');
  TAS.repeatingSimpleSum('modulesDCLion', 'moduleSlotDCLBG', 'slotsUDCLBGTot');
  TAS.repeatingSimpleSum('modulesDCLion', 'moduleSlotDCLBD', 'slotsUDCLBDTot');
  TAS.repeatingSimpleSum('modulesDCLion', 'moduleSlotDCLJG', 'slotsUDCLJGTot');
  TAS.repeatingSimpleSum('modulesDCLion', 'moduleSlotDCLJD', 'slotsUDCLJDTot');
});

on('change:slotsOccupeTete change:slotsOccupeTorse change:slotsOccupeBG change:slotsOccupeBD change:slotsOccupeJG change:slotsOccupeJD', async () => {
  const attrs = await getAttrsAsync([
    'slotsOccupeTete', 'slotTeteMax',
    'slotsOccupeTorse', 'slotTorseMax',
    'slotsOccupeBG', 'slotBGMax',
    'slotsOccupeBD', 'slotBDMax',
    'slotsOccupeJG', 'slotJGMax',
    'slotsOccupeJD', 'slotJDMax',
  ]);

  const TeO = parseInt(attrs.slotsOccupeTete, 10) || 0;
  const TeM = parseInt(attrs.slotTeteMax, 10) || 0;

  const ToO = parseInt(attrs.slotsOccupeTorse, 10) || 0;
  const ToM = parseInt(attrs.slotTorseMax, 10) || 0;

  const BGO = parseInt(attrs.slotsOccupeBG, 10) || 0;
  const BGM = parseInt(attrs.slotBGMax, 10) || 0;

  const BDO = parseInt(attrs.slotsOccupeBD, 10) || 0;
  const BDM = parseInt(attrs.slotBDMax, 10) || 0;

  const JGO = parseInt(attrs.slotsOccupeJG, 10) || 0;
  const JGM = parseInt(attrs.slotJGMax, 10) || 0;

  const JDO = parseInt(attrs.slotsOccupeJD, 10) || 0;
  const JDM = parseInt(attrs.slotJDMax, 10) || 0;

  const totalTe = TeM - TeO;
  const totalTo = ToM - ToO;
  const totalBG = BGM - BGO;
  const totalBD = BDM - BDO;
  const totalJG = JGM - JGO;
  const totalJD = JDM - JDO;

  let msg = '';

  PI.msgSlot = 0;

  if (PI.msgEnergie === 1) { msg += 'Erreur. Energie Indisponible. '; }

  if (totalTe < 0) {
    msg += 'Erreur. ';

    if (PI.msgSlot === 0) {
      PI.msgSlot = 1;
      msg += "Capacité de l'Armure dépassée. ";
    }

    msg += 'Trop de slots occupé au niveau de la tête. ';
  }

  if (totalTo < 0) {
    msg += 'Erreur. ';

    if (PI.msgSlot === 0) {
      PI.msgSlot = 1;
      msg += "Capacité de l'Armure dépassée. ";
    }

    msg += 'Trop de slots occupé au niveau du torse. ';
  }

  if (totalBG < 0) {
    msg += 'Erreur. ';

    if (PI.msgSlot === 0) {
      PI.msgSlot = 1;
      msg += "Capacité de l'Armure dépassée. ";
    }

    msg += 'Trop de slots occupé au niveau du bras gauche. ';
  }

  if (totalBD < 0) {
    msg += 'Erreur. ';

    if (PI.msgSlot === 0) {
      PI.msgSlot = 1;
      msg += "Capacité de l'Armure dépassée. ";
    }

    msg += 'Trop de slots occupé au niveau du bras droit. ';
  }

  if (totalJG < 0) {
    msg += 'Erreur. ';

    if (PI.msgSlot === 0) {
      PI.msgSlot = 1;
      msg += "Capacité de l'Armure dépassée. ";
    }

    msg += 'Trop de slots occupé au niveau de la jambe gauche. ';
  }

  if (totalJD < 0) {
    msg += 'Erreur. ';

    if (PI.msgSlot === 0) {
      PI.msgSlot = 1;
      msg += "Capacité de l'Armure dépassée. ";
    }

    msg += 'Trop de slots occupé au niveau de la jambe droite. ';
  }

  if (msg !== '') { setPanneauInformation(msg, true, true); } else { resetPanneauInformation(); }
});

on('change:slotsUDCLTeteTot change:slotsUDCLTorseTot change:slotsUDCLBGTot change:slotsUDCLBDTot change:slotsUDCLJGTot change:slotsUDCLJDTot', async () => {
  const attrs = await getAttrsAsync([
    'slotsUDCLTeteTot', 'slotsDCLTeteMax',
    'slotsUDCLTorseTot', 'slotsDCLTorseMax',
    'slotsUDCLBGTot', 'slotsDCLBGMax',
    'slotsUDCLBDTot', 'slotsDCLBDMax',
    'slotsUDCLJGTot', 'slotsDCLJGMax',
    'slotsUDCLJDTot', 'slotsDCLJDMax',
  ]);

  const TeO = parseInt(attrs.slotsUDCLTeteTot, 10) || 0;
  const TeM = parseInt(attrs.slotsDCLTeteMax, 10) || 0;

  const ToO = parseInt(attrs.slotsUDCLTorseTot, 10) || 0;
  const ToM = parseInt(attrs.slotsDCLTorseMax, 10) || 0;

  const BGO = parseInt(attrs.slotsUDCLBGTot, 10) || 0;
  const BGM = parseInt(attrs.slotsDCLBGMax, 10) || 0;

  const BDO = parseInt(attrs.slotsUDCLBDTot, 10) || 0;
  const BDM = parseInt(attrs.slotsDCLBDMax, 10) || 0;

  const JGO = parseInt(attrs.slotsUDCLJGTot, 10) || 0;
  const JGM = parseInt(attrs.slotsDCLJGMax, 10) || 0;

  const JDO = parseInt(attrs.slotsUDCLJDTot, 10) || 0;
  const JDM = parseInt(attrs.slotsDCLJDMax, 10) || 0;

  const totalTe = TeM - TeO;
  const totalTo = ToM - ToO;
  const totalBG = BGM - BGO;
  const totalBD = BDM - BDO;
  const totalJG = JGM - JGO;
  const totalJD = JDM - JDO;

  let msg = '';

  PI.msgSlot = 0;

  if (PI.msgEnergie === 1) { msg += 'Erreur. Energie Indisponible. '; }

  if (totalTe < 0) {
    msg += 'Erreur. ';

    if (PI.msgSlot === 0) {
      PI.msgSlot = 1;
      msg += 'Capacité du Compagnon dépassée. ';
    }

    msg += 'Trop de slots occupé au niveau de la tête. ';
  }

  if (totalTo < 0) {
    msg += 'Erreur. ';

    if (PI.msgSlot === 0) {
      PI.msgSlot = 1;
      msg += 'Capacité du Compagnon dépassée. ';
    }

    msg += 'Trop de slots occupé au niveau du torse. ';
  }

  if (totalBG < 0) {
    msg += 'Erreur. ';

    if (PI.msgSlot === 0) {
      PI.msgSlot = 1;
      msg += 'Capacité du Compagnon dépassée. ';
    }

    msg += 'Trop de slots occupé au niveau du bras gauche. ';
  }

  if (totalBD < 0) {
    msg += 'Erreur. ';

    if (PI.msgSlot === 0) {
      PI.msgSlot = 1;
      msg += 'Capacité du Compagnon dépassée. ';
    }

    msg += 'Trop de slots occupé au niveau du bras droit. ';
  }

  if (totalJG < 0) {
    msg += 'Erreur. ';

    if (PI.msgSlot === 0) {
      PI.msgSlot = 1;
      msg += 'Capacité du Compagnon dépassée. ';
    }

    msg += 'Trop de slots occupé au niveau de la jambe gauche. ';
  }

  if (totalJD < 0) {
    msg += 'Erreur. ';

    if (PI.msgSlot === 0) {
      PI.msgSlot = 1;
      msg += 'Capacité du Compagnon dépassée. ';
    }

    msg += 'Trop de slots occupé au niveau de la jambe droite. ';
  }

  if (msg !== '') { setPanneauInformation(msg, true, true); } else { resetPanneauInformation(); }
});

on('change:repeating_equipDefensif:porte change:repeating_equipDefensif:defenseBonus change:repeating_equipDefensif:reactionBonus', async (eventInfo) => {
  const attrs = await getAttrsAsync([
    'repeating_equipDefensif_defenseBonus',
    'repeating_equipDefensif_reactionBonus',
    'repeating_equipDefensif_porte',
  ]);

  const id = eventInfo.sourceAttribute.split('_')[2];
  const equipe = +attrs.repeating_equipDefensif_porte;

  let defense = 0;
  let reaction = 0;

  if (equipe === 1) {
    defense = +attrs.repeating_equipDefensif_defenseBonus;
    reaction = +attrs.repeating_equipDefensif_reactionBonus;
  }

  const update = {};

  update[`repeating_equipDefensif_${id}_defLigne`] = defense;
  update[`repeating_equipDefensif_${id}_reaLigne`] = reaction;

  await setAttrsAsync(update);
});

on('change:repeating_equipDefensif:reaLigne remove:repeating_equipDefensif:reaLigne', () => {
  TAS.repeatingSimpleSum('equipDefensif', 'reaLigne', 'bonusReaction');
});

on('change:repeating_equipDefensif:defLigne remove:repeating_equipDefensif:defLigne', () => {
  TAS.repeatingSimpleSum('equipDefensif', 'defLigne', 'bonusDefense');
});

on('change:calODEnd change:armure', async () => {
  const attrs = await getAttrsAsync([
    'armure',
    'calODEnd',
  ]);

  const armure = attrs.armure;

  const OD = +attrs.calODEnd;

  let bonus = 6;

  if (armure === 'sans' || armure === 'guardian' || OD < 3) { bonus = 0; }

  await setAttrsAsync({
    santeODBonus: bonus,
  });
});

on('change:calODCom change:armure', async () => {
  const attrs = await getAttrsAsync([
    'armure',
    'calODCom',
  ]);

  const armure = attrs.armure;

  const OD = +attrs.calODCom;

  let bonus = 0;
  let bonusAkimbo = 0;
  let bonusAmbidextrie = 0;

  if (armure === 'sans' || armure === 'guardian') {
    bonus = 0;
    bonusAkimbo = 0;
    bonusAmbidextrie = 0;
  } else {
    switch (OD) {
      case 2:
        bonus = 2;
        bonusAkimbo = 0;
        bonusAmbidextrie = 0;
        break;

      case 3:
        bonus = 2;
        bonusAkimbo = 2;
        bonusAmbidextrie = 0;
        break;

      case 4:
      case 5:
        bonus = 2;
        bonusAkimbo = 2;
        bonusAmbidextrie = 2;
        break;

      default:
        bonus = 0;
        bonusAkimbo = 0;
        bonusAmbidextrie = 0;
        break;
    }
  }

  await setAttrsAsync({
    reactionODBonus: bonus,
    akimboContactODBonus: bonusAkimbo,
    ambidextrieContactODBonus: bonusAmbidextrie,
  });
});

on('change:calODIns change:armure', async () => {
  const attrs = await getAttrsAsync([
    'armure',
    'calODIns',
  ]);

  const armure = attrs.armure;

  const OD = +attrs.calODIns;

  let bonus = 3 * OD;

  if (armure === 'sans' || armure === 'guardian' || OD < 3) { bonus = 0; }

  await setAttrsAsync({ initiativeODBonus: bonus });
});

on('change:calODTir change:armure', async () => {
  const attrs = await getAttrsAsync([
    'armure',
    'calODTir',
  ]);

  const armure = attrs.armure;

  const OD = +attrs.calODTir;

  let bonusAkimbo = 0;
  let bonusAmbidextrie = 0;

  if (armure === 'sans' || armure === 'guardian') {
    bonusAkimbo = 0;
    bonusAmbidextrie = 0;
  } else {
    switch (OD) {
      case 3:
        bonusAkimbo = 2;
        bonusAmbidextrie = 0;
        break;

      case 4:
      case 5:
        bonusAkimbo = 2;
        bonusAmbidextrie = 2;
        break;

      default:
        bonusAkimbo = 0;
        bonusAmbidextrie = 0;
        break;
    }
  }

  await setAttrsAsync({
    akimboDistanceODBonus: bonusAkimbo,
    ambidextrieDistanceODBonus: bonusAmbidextrie,
  });
});

on('change:calODAur change:aura change:armure', async () => {
  const attrs = await getAttrsAsync([
    'armure',
    'calODAur',
    'aura',
  ]);

  const armure = attrs.armure;

  const OD = +attrs.calODAur;
  const carac = +attrs.aura;

  let bonus = carac;

  if (armure === 'sans' || armure === 'guardian' || OD < 5) { bonus = 0; }

  await setAttrsAsync({
    defenseODBonus: bonus,
  });
});

on('change:calODDis change:armure', async () => {
  const attrs = await getAttrsAsync([
    'armure',
    'calODDis',
  ]);

  const armure = attrs.armure;

  const OD = +attrs.calODDis;

  let bonus = '';

  if (armure === 'sans' || armure === 'guardian' || OD < 3) { bonus = ''; } else if (OD === 4) { bonus = '{{ODDiscretion=[[@{discretion}]]}}'; } else if (OD === 5) { bonus = '{{ODDiscretion=[[@{discretion}+@{calODDis}]]}}'; }

  await setAttrsAsync({
    discretionDegatsBonus: bonus,
  });
});

on('change:warriorSoldierA change:warrior250PG change:deplOD change:forOD change:endOD', async () => {
  const attrs = await getAttrsAsync([
    'warriorSoldierA',
    'warrior250PG',
    'deplOD',
    'forOD',
    'endOD',
  ]);

  const PG250 = +attrs.warrior250PG;

  const mode = +attrs.warriorSoldierA;

  const OD1 = +attrs.deplOD;
  const OD2 = +attrs.forOD;
  const OD3 = +attrs.endOD;

  let bonus = 0;

  const update = {};

  if (mode !== 0) {
    bonus += 1;
    bonus += PG250;

    update.warriorHunterA = 0;
    update.warriorScholarA = 0;
    update.warriorHeraldA = 0;
    update.warriorScoutA = 0;
  }

  update.calODDep = OD1 + bonus;
  update.calODFor = OD2 + bonus;
  update.calODEnd = OD3 + bonus;

  await setAttrsAsync(update);
});

on('change:warriorHunterA change:warrior250PG change:hargneOD change:combOD change:instOD', async () => {
  const attrs = await getAttrsAsync([
    'warriorHunterA',
    'warrior250PG',
    'hargneOD',
    'combOD',
    'instOD',
  ]);

  const PG250 = +attrs.warrior250PG;

  const mode = +attrs.warriorHunterA;

  const OD1 = +attrs.hargneOD;
  const OD2 = +attrs.combOD;
  const OD3 = +attrs.instOD;

  let bonus = 0;

  const update = {};

  if (mode !== 0) {
    bonus += 1;
    bonus += PG250;

    update.warriorSoldierA = 0;
    update.warriorScholarA = 0;
    update.warriorHeraldA = 0;
    update.warriorScoutA = 0;
  }

  update.calODHar = OD1 + bonus;
  update.calODCom = OD2 + bonus;
  update.calODIns = OD3 + bonus;

  await setAttrsAsync(update);
});

on('change:warriorScholarA change:warrior250PG change:tirOD change:savoirOD change:technOD', async () => {
  const attrs = await getAttrsAsync([
    'warriorScholarA',
    'warrior250PG',
    'tirOD',
    'savoirOD',
    'technOD',
  ]);

  const PG250 = +attrs.warrior250PG;

  const mode = +attrs.warriorScholarA;

  const OD1 = +attrs.tirOD;
  const OD2 = +attrs.savoirOD;
  const OD3 = +attrs.technOD;

  let bonus = 0;

  const update = {};

  if (mode !== 0) {
    bonus += 1;
    bonus += PG250;

    update.warriorSoldierA = 0;
    update.warriorHunterA = 0;
    update.warriorHeraldA = 0;
    update.warriorScoutA = 0;
  }

  update.calODTir = OD1 + bonus;
  update.calODSav = OD2 + bonus;
  update.calODTec = OD3 + bonus;

  await setAttrsAsync(update);
});

on('change:warriorHeraldA change:warrior250PG change:auraOD change:paroleOD change:sfOD', async () => {
  const attrs = await getAttrsAsync([
    'warriorHeraldA',
    'warrior250PG',
    'auraOD',
    'paroleOD',
    'sfOD',
  ]);

  const PG250 = +attrs.warrior250PG;

  const mode = +attrs.warriorHeraldA;

  const OD1 = +attrs.auraOD;
  const OD2 = +attrs.paroleOD;
  const OD3 = +attrs.sfOD;

  let bonus = 0;

  const update = {};

  if (mode !== 0) {
    bonus += 1;
    bonus += PG250;

    update.warriorSoldierA = 0;
    update.warriorHunterA = 0;
    update.warriorScholarA = 0;
    update.warriorScoutA = 0;
  }

  update.calODAur = OD1 + bonus;
  update.calODPar = OD2 + bonus;
  update.calODSFR = OD3 + bonus;

  await setAttrsAsync(update);
});

on('change:warriorScoutA change:warrior250PG change:discrOD change:percOD change:dextOD', async () => {
  const attrs = await getAttrsAsync([
    'warriorScoutA',
    'warrior250PG',
    'discrOD',
    'percOD',
    'dextOD',
  ]);

  const PG250 = +attrs.warrior250PG;

  const mode = +attrs.warriorScoutA;

  const OD1 = +attrs.discrOD;
  const OD2 = +attrs.percOD;
  const OD3 = +attrs.dextOD;

  let bonus = 0;

  const update = {};

  if (mode !== 0) {
    bonus += 1;
    bonus += PG250;

    update.warriorSoldierA = 0;
    update.warriorHunterA = 0;
    update.warriorScholarA = 0;
    update.warriorHeraldA = 0;
  }

  update.calODDis = OD1 + bonus;
  update.calODPer = OD2 + bonus;
  update.calODDex = OD3 + bonus;

  await setAttrsAsync(update);
});

on('change:druidWolfConfiguration', async () => {
  const attrs = await getAttrsAsync([
    'druidWolfConfiguration',
  ]);

  const mode = attrs.druidWolfConfiguration;
  let PE = 0;

  if (mode === 'Labor' || mode === 'Medic' || mode === 'Recon') { PE = 1; }

  if (mode === 'Tech' || mode === 'Fighter') { PE = 2; }

  await setAttrsAsync({
    druidWolfConfigurationPE: PE,
  });
});

// META-ARMURE DE LEGENDE
on('change:armureLegende', (eventInfo) => {
  const mal = eventInfo.newValue;

  switch (mal) {
    case 'warrior':
      setAttrs({
        popup: 3,
      });
      break;
    case 'priest':
      setAttrs({
        popup: 4,
      });
      break;
    case 'warmaster':
      setAttrs({
        popup: 5,
      });
      break;
    case 'psion':
      setAttrs({
        popup: 6,
      });
      break;
    case 'warlock':
      setAttrs({
        popup: 7,
      });
      break;
    case 'druid':
      setAttrs({
        popup: 8,
      });
      break;
  }
});

on('clicked:selectionMALWarrior', async () => {
  const attrs = await getAttrsAsync([
    'listeTypeMALWarrior',
  ]);

  const choix = parseInt(attrs.listeTypeMALWarrior, 10) || 0;

  await setAttrsAsync({
    malwarriortype: choix,
    popup: 0,
  });
});

on('clicked:selectionMALPriest', async () => {
  const attrs = await getAttrsAsync([
    'listeTypeMALPriest',
  ]);

  const choix = parseInt(attrs.listeTypeMALPriest, 10) || 0;

  await setAttrsAsync({
    malpriestmode: choix,
    popup: 0,
  });
});

on('clicked:selectionMALWarmaster', async () => {
  const attrs = await getAttrsAsync([
    'listeTypeMALWarmaster',
  ]);

  const choix = parseInt(attrs.listeTypeMALWarmaster, 10) || 0;

  let popup = 0;

  if (choix === 1) { popup = 9; }

  await setAttrsAsync({
    malwarmastermode: choix,
    popup: popup,
  });
});

on('clicked:selectionMALWarmasterWarlord', async () => {
  const attrs = await getAttrsAsync([
    'listeTypeMALWarmasterWarlord',
  ]);

  const choix = parseInt(attrs.listeTypeMALWarmasterWarlord, 10) || 0;

  await setAttrsAsync({
    malwarmasterwarlord: choix,
    popup: 0,
  });
});

on('clicked:selectionMALPsion', async () => {
  const attrs = await getAttrsAsync([
    'listeModeMALPsion',
    'listeModeMALPsion2',
  ]);

  const choix = parseInt(attrs.listeModeMALPsion, 10) || 0;
  const choix2 = parseInt(attrs.listeModeMALPsion2, 10) || 0;

  await setAttrsAsync({
    malpsionmode: choix,
    malpsionmode2: choix2,
    popup: 0,
  });
});

on('clicked:selectionMALWarlock', async () => {
  const attrs = await getAttrsAsync([
    'listeModeMALWarlock',
  ]);

  const choix = parseInt(attrs.listeModeMALWarlock, 10) || 0;

  await setAttrsAsync({
    malwarlockmode: choix,
    popup: 0,
  });
});

on('clicked:selectionMALDruid', async () => {
  const attrs = await getAttrsAsync([
    'listeModeMALDruid',
  ]);

  const choix = parseInt(attrs.listeModeMALDruid, 10) || 0;

  await setAttrsAsync({
    maldruidmod: choix,
    popup: 0,
  });
});

on('change:repeating_modulesMALDCLion remove:repeating_modulesMALDCLion', () => {
  TAS.repeatingSimpleSum('modulesMALDCLion', 'moduleSlotMALDCLTete', 'slotsMALUDCLTeteTot');
  TAS.repeatingSimpleSum('modulesMALDCLion', 'moduleSlotMALDCLTorse', 'slotsMALUDCLTorseTot');
  TAS.repeatingSimpleSum('modulesMALDCLion', 'moduleSlotMALDCLBG', 'slotsMALUDCLBGTot');
  TAS.repeatingSimpleSum('modulesMALDCLion', 'moduleSlotMALDCLBD', 'slotsMALUDCLBDTot');
  TAS.repeatingSimpleSum('modulesMALDCLion', 'moduleSlotMALDCLJG', 'slotsMALUDCLJGTot');
  TAS.repeatingSimpleSum('modulesMALDCLion', 'moduleSlotMALDCLJD', 'slotsMALUDCLJDTot');
});

on('change:slotsMALUDCLTeteTot change:slotsMALUDCLTorseTot change:slotsMALUDCLBGTot change:slotsMALUDCLBDTot change:slotsMALUDCLJGTot change:slotsMALUDCLJDTot', async () => {
  const attrs = await getAttrsAsync([
    'slotsMALUDCLTeteTot', 'slotsMALDCLTeteMax',
    'slotsMALUDCLTorseTot', 'slotsMALDCLTorseMax',
    'slotsMALUDCLBGTot', 'slotsMALDCLBGMax',
    'slotsMALUDCLBDTot', 'slotsMALDCLBDMax',
    'slotsMALUDCLJGTot', 'slotsMALDCLJGMax',
    'slotsMALUDCLJDTot', 'slotsMALDCLJDMax',
  ]);

  const TeO = parseInt(attrs.slotsMALUDCLTeteTot, 10) || 0;
  const TeM = parseInt(attrs.slotsMALDCLTeteMax, 10) || 0;

  const ToO = parseInt(attrs.slotsMALUDCLTorseTot, 10) || 0;
  const ToM = parseInt(attrs.slotsMALDCLTorseMax, 10) || 0;

  const BGO = parseInt(attrs.slotsMALUDCLBGTot, 10) || 0;
  const BGM = parseInt(attrs.slotsMALDCLBGMax, 10) || 0;

  const BDO = parseInt(attrs.slotsMALUDCLBDTot, 10) || 0;
  const BDM = parseInt(attrs.slotsMALDCLBDMax, 10) || 0;

  const JGO = parseInt(attrs.slotsMALUDCLJGTot, 10) || 0;
  const JGM = parseInt(attrs.slotsMALDCLJGMax, 10) || 0;

  const JDO = parseInt(attrs.slotsMALUDCLJDTot, 10) || 0;
  const JDM = parseInt(attrs.slotsMALDCLJDMax, 10) || 0;

  const totalTe = TeM - TeO;
  const totalTo = ToM - ToO;
  const totalBG = BGM - BGO;
  const totalBD = BDM - BDO;
  const totalJG = JGM - JGO;
  const totalJD = JDM - JDO;

  let msg = '';

  PI.msgSlot = 0;

  if (PI.msgEnergie === 1) {
    msg += 'Erreur. Energie Indisponible. ';
  }

  if (totalTe < 0) {
    msg += 'Erreur. ';

    if (PI.msgSlot === 0) {
      PI.msgSlot = 1;
      msg += 'Capacité du Compagnon dépassée. ';
    }

    msg += 'Trop de slots occupé au niveau de la tête. ';
  }

  if (totalTo < 0) {
    msg += 'Erreur. ';

    if (PI.msgSlot === 0) {
      PI.msgSlot = 1;
      msg += 'Capacité du Compagnon dépassée. ';
    }

    msg += 'Trop de slots occupé au niveau du torse. ';
  }

  if (totalBG < 0) {
    msg += 'Erreur. ';

    if (PI.msgSlot === 0) {
      PI.msgSlot = 1;
      msg += 'Capacité du Compagnon dépassée. ';
    }

    msg += 'Trop de slots occupé au niveau du bras gauche. ';
  }

  if (totalBD < 0) {
    msg += 'Erreur. ';

    if (PI.msgSlot === 0) {
      PI.msgSlot = 1;
      msg += 'Capacité du Compagnon dépassée. ';
    }

    msg += 'Trop de slots occupé au niveau du bras droit. ';
  }

  if (totalJG < 0) {
    msg += 'Erreur. ';

    if (PI.msgSlot === 0) {
      PI.msgSlot = 1;
      msg += 'Capacité du Compagnon dépassée. ';
    }

    msg += 'Trop de slots occupé au niveau de la jambe gauche. ';
  }

  if (totalJD < 0) {
    msg += 'Erreur. ';

    if (PI.msgSlot === 0) {
      PI.msgSlot = 1;
      msg += 'Capacité du Compagnon dépassée. ';
    }

    msg += 'Trop de slots occupé au niveau de la jambe droite. ';
  }

  if (msg !== '') { setPanneauInformation(msg, true, true); } else { resetPanneauInformation(); }
});

on('clicked:repeating_modulesmaldclion:pemdlion', async () => {
  const attrs = await getAttrsAsync([
    'repeating_modules_moduleEnergieMALDCLion',
    'MALDruidLionPEAct',
  ]);

  const PEM = parseInt(attrs.repeating_modules_moduleEnergieMALDCLion, 10) || 0;
  const PE = parseInt(attrs.MALDruidLionPEAct, 10) || 0;

  const total = PE - PEM;

  if (total < 0) {
    setPanneauInformation('Erreur. Energie Indisponible.', false, false, true);

    PI.msgEnergie = 1;
  } else {
    setAttrs({
      MALDruidLionPEAct: total,
    });
  }
});

on('change:MALWarriorSoldierA change:deplOD change:forOD change:endOD', async () => {
  const attrs = await getAttrsAsync([
    'MALWarriorSoldierA',
    'deplOD',
    'forOD',
    'endOD',
  ]);

  const mode = +attrs.MALWarriorSoldierA;

  const OD1 = +attrs.deplOD;
  const OD2 = +attrs.forOD;
  const OD3 = +attrs.endOD;

  let bonus = 0;

  const update = {};

  if (mode !== 0) { bonus += 1; }

  update.calODDep = OD1 + bonus;
  update.calODFor = OD2 + bonus;
  update.calODEnd = OD3 + bonus;

  await setAttrsAsync(update);
});

on('change:MALWarriorHunterA change:hargneOD change:combOD change:instOD', async () => {
  const attrs = await getAttrsAsync([
    'MALWarriorHunterA',
    'hargneOD',
    'combOD',
    'instOD',
  ]);

  const mode = +attrs.MALWarriorHunterA;

  const OD1 = +attrs.hargneOD;
  const OD2 = +attrs.combOD;
  const OD3 = +attrs.instOD;

  let bonus = 0;

  const update = {};

  if (mode !== 0) { bonus += 1; }

  update.calODHar = OD1 + bonus;
  update.calODCom = OD2 + bonus;
  update.calODIns = OD3 + bonus;

  await setAttrsAsync(update);
});

on('change:MALWarriorScholarA change:tirOD change:savoirOD change:technOD', async () => {
  const attrs = await getAttrsAsync([
    'MALWarriorScholarA',
    'tirOD',
    'savoirOD',
    'technOD',
  ]);

  const mode = +attrs.MALWarriorScholarA;

  const OD1 = +attrs.tirOD;
  const OD2 = +attrs.savoirOD;
  const OD3 = +attrs.technOD;

  let bonus = 0;

  const update = {};

  if (mode !== 0) { bonus += 1; }

  update.calODTir = OD1 + bonus;
  update.calODSav = OD2 + bonus;
  update.calODTec = OD3 + bonus;

  await setAttrsAsync(update);
});

on('change:MALWarriorHeraldA change:auraOD change:paroleOD change:sfOD', async () => {
  const attrs = await getAttrsAsync([
    'MALWarriorHeraldA',
    'auraOD',
    'paroleOD',
    'sfOD',
  ]);

  const mode = +attrs.MALWarriorHeraldA;

  const OD1 = +attrs.auraOD;
  const OD2 = +attrs.paroleOD;
  const OD3 = +attrs.sfOD;

  let bonus = 0;

  const update = {};

  if (mode !== 0) { bonus += 1; }

  update.calODAur = OD1 + bonus;
  update.calODPar = OD2 + bonus;
  update.calODSFR = OD3 + bonus;

  await setAttrsAsync(update);
});

on('change:MALWarriorScoutA change:discrOD change:percOD change:dextOD', async () => {
  const attrs = await getAttrsAsync([
    'MALWarriorScoutA',
    'discrOD',
    'percOD',
    'dextOD',
  ]);

  const mode = +attrs.MALWarriorScoutA;

  const OD1 = +attrs.discrOD;
  const OD2 = +attrs.percOD;
  const OD3 = +attrs.dextOD;

  let bonus = 0;

  const update = {};

  if (mode !== 0) { bonus += 1; }

  update.calODDis = OD1 + bonus;
  update.calODPer = OD2 + bonus;
  update.calODDex = OD3 + bonus;

  await setAttrsAsync(update);
});

on('change:MALBarbarianGoliath', async () => {
  const attrs = await getAttrsAsync([
    'MALBarbarianGoliath',
  ]);

  const goliath = +attrs.MALBarbarianGoliath;

  const defense = goliath;
  const reaction = goliath * 2;
  const dgts = `${goliath}D6`;

  await setAttrsAsync({
    MALBarbarianDef: defense,
    MALBarbarianRea: reaction,
    MALBarbarianDegat: dgts,
  });
});

on('change:MALDruidWolfConfiguration', async () => {
  const attrs = await getAttrsAsync([
    'MALDruidWolfConfiguration',
  ]);

  const mode = attrs.MALDruidWolfConfiguration;
  let PE = 0;

  if (mode === 'Labor' || mode === 'Medic' || mode === 'Recon') { PE = 1; }

  if (mode === 'Tech' || mode === 'Fighter') { PE = 2; }

  await setAttrsAsync({
    MAJDruidWolfConfigurationPE: PE,
  });
});

on('change:tabArmureLegende', (eventInfo) => {
  const mal = eventInfo.newValue;

  if (mal === '0') {
    setAttrs({
      armureLegende: 'sans',
    });
  }
});
// FIN META-ARMURE DE LEGENDE

on('change:bonusCarac', async () => {
  const attrs = await getAttrsAsync([
    'bonusCarac',
  ]);

  const bonus = +attrs.bonusCarac;

  const update = {};

  if (bonus === 1) { update.caracteristique4 = ''; }

  if (bonus !== 2 && bonus !== 1) {
    update.caracteristique3 = '';
    update.caracteristique4 = '';
  }

  await setAttrsAsync(update);
});

on('clicked:capaciteUltime', async () => {
  const attrs = await getAttrsAsync([
    'coutCapaciteUltime',
    'energiePJ',
  ]);

  const cout = +attrs.coutCapaciteUltime;
  const PE = +attrs.energiePJ;

  const total = PE - cout;

  if (total < 0) {
    setPanneauInformation('Erreur. Energie Indisponible.', false, false, true);

    PI.msgEnergie = 1;
  } else {
    await setAttrsAsync({
      energiePJ: total,
    });
  }
});

on('change:fichePNJ change:diceInitiative change:bonusInitiativeP change:malusInitiative change:MasquePNJAEMaj', async () => {
  const attrs = await getAttrsAsync([
    'fichePNJ',
    'MasquePNJAEMaj',
  ]);

  const fiche = +attrs.fichePNJ;
  const masque = +attrs.MasquePNJAEMaj;

  if (fiche === 1 || fiche === 2) {
    if (masque > 0) {
      await setAttrsAsync({
        diceInitiative: 0,
        bonusInitiativeP: 30,
        malusInitiative: 0,
      });
    }
  }

  if (fiche === 3) {
    await setAttrsAsync({
      diceInitiative: 0,
      bonusInitiativeP: 1,
      malusInitiative: 0,
    });
  }
});

on('clicked:resetArmure', async () => {
  const attrs = await getAttrsAsync([
    'armurePJ_max',
    'energiePJ_max',
  ]);

  const armure = attrs.armurePJ_max;
  const energie = attrs.energiePJ_max;

  await setAttrsAsync({
    armurePJ: armure,
    energiePJ: energie,
  });
});

on('clicked:majV15', () => {
  getSectionIDs('repeating_slotsTete', (idarray) => {
    _.each(idarray, (currentID, i) => {
      getAttrs(
        [
          `repeating_slotsTete_${currentID}_slotsUTete`,
          `repeating_slotsTete_${currentID}_slotsNTete`,
          `repeating_slotsTete_${currentID}_slotsATete`,
          `repeating_slotsTete_${currentID}_slotsETete`,
          `repeating_slotsTete_${currentID}_slotsDureeTete`,
          `repeating_slotsTete_${currentID}_slotsDTete`,
        ], (v) => {
          const u = v[`repeating_slotsTete_${currentID}_slotsUTete`];
          const n = v[`repeating_slotsTete_${currentID}_slotsNTete`];
          const a = v[`repeating_slotsTete_${currentID}_slotsATete`];
          const e = v[`repeating_slotsTete_${currentID}_slotsETete`];
          const duree = v[`repeating_slotsTete_${currentID}_slotsDureeTete`];
          const d = v[`repeating_slotsTete_${currentID}_slotsDTete`];

          const newrowid = generateRowID();
          const newrowattrs = {};
          newrowattrs[`repeating_modules_${newrowid}_moduleSlotTete`] = u;
          newrowattrs[`repeating_modules_${newrowid}_moduleNom`] = n;
          newrowattrs[`repeating_modules_${newrowid}_moduleActivation`] = a;
          newrowattrs[`repeating_modules_${newrowid}_moduleEnergie`] = e;
          newrowattrs[`repeating_modules_${newrowid}_moduleDuree`] = duree;
          newrowattrs[`repeating_modules_${newrowid}_moduleDescription`] = d;
          setAttrs(newrowattrs);
        },
      );
    });
  });

  getSectionIDs('repeating_slotsTorse', (idarray) => {
    _.each(idarray, (currentID, i) => {
      getAttrs(
        [
          `repeating_slotsTorse_${currentID}_slotsUTorse`,
          `repeating_slotsTorse_${currentID}_slotsNTorse`,
          `repeating_slotsTorse_${currentID}_slotsATorse`,
          `repeating_slotsTorse_${currentID}_slotsETorse`,
          `repeating_slotsTorse_${currentID}_slotsDureeTorse`,
          `repeating_slotsTorse_${currentID}_slotsDTorse`,
        ], (v) => {
          const u = v[`repeating_slotsTorse_${currentID}_slotsUTorse`];
          const n = v[`repeating_slotsTorse_${currentID}_slotsNTorse`];
          const a = v[`repeating_slotsTorse_${currentID}_slotsATorse`];
          const e = v[`repeating_slotsTorse_${currentID}_slotsETorse`];
          const duree = v[`repeating_slotsTorse_${currentID}_slotsDureeTorse`];
          const d = v[`repeating_slotsTorse_${currentID}_slotsDTorse`];

          const newrowid = generateRowID();
          const newrowattrs = {};
          newrowattrs[`repeating_modules_${newrowid}_moduleSlotTorse`] = u;
          newrowattrs[`repeating_modules_${newrowid}_moduleNom`] = n;
          newrowattrs[`repeating_modules_${newrowid}_moduleActivation`] = a;
          newrowattrs[`repeating_modules_${newrowid}_moduleEnergie`] = e;
          newrowattrs[`repeating_modules_${newrowid}_moduleDuree`] = duree;
          newrowattrs[`repeating_modules_${newrowid}_moduleDescription`] = d;
          setAttrs(newrowattrs);
        },
      );
    });
  });

  getSectionIDs('repeating_slotsBG', (idarray) => {
    _.each(idarray, (currentID, i) => {
      getAttrs(
        [
          `repeating_slotsBG_${currentID}_slotsUBG`,
          `repeating_slotsBG_${currentID}_slotsNBG`,
          `repeating_slotsBG_${currentID}_slotsABG`,
          `repeating_slotsBG_${currentID}_slotsEBG`,
          `repeating_slotsBG_${currentID}_slotsDureeBG`,
          `repeating_slotsBG_${currentID}_slotsDBG`,
        ], (v) => {
          const u = v[`repeating_slotsBG_${currentID}_slotsUBG`];
          const n = v[`repeating_slotsBG_${currentID}_slotsNBG`];
          const a = v[`repeating_slotsBG_${currentID}_slotsABG`];
          const e = v[`repeating_slotsBG_${currentID}_slotsEBG`];
          const duree = v[`repeating_slotsBG_${currentID}_slotsDureeBG`];
          const d = v[`repeating_slotsBG_${currentID}_slotsDBG`];

          const newrowid = generateRowID();
          const newrowattrs = {};
          newrowattrs[`repeating_modules_${newrowid}_moduleSlotBG`] = u;
          newrowattrs[`repeating_modules_${newrowid}_moduleNom`] = n;
          newrowattrs[`repeating_modules_${newrowid}_moduleActivation`] = a;
          newrowattrs[`repeating_modules_${newrowid}_moduleEnergie`] = e;
          newrowattrs[`repeating_modules_${newrowid}_moduleDuree`] = duree;
          newrowattrs[`repeating_modules_${newrowid}_moduleDescription`] = d;
          setAttrs(newrowattrs);
        },
      );
    });
  });

  getSectionIDs('repeating_slotsBD', (idarray) => {
    _.each(idarray, (currentID, i) => {
      getAttrs(
        [
          `repeating_slotsBD_${currentID}_slotsUBD`,
          `repeating_slotsBD_${currentID}_slotsNBD`,
          `repeating_slotsBD_${currentID}_slotsABD`,
          `repeating_slotsBD_${currentID}_slotsEBD`,
          `repeating_slotsBD_${currentID}_slotsDureeBD`,
          `repeating_slotsBD_${currentID}_slotsDBD`,
        ], (v) => {
          const u = v[`repeating_slotsBD_${currentID}_slotsUBD`];
          const n = v[`repeating_slotsBD_${currentID}_slotsNBD`];
          const a = v[`repeating_slotsBD_${currentID}_slotsABD`];
          const e = v[`repeating_slotsBD_${currentID}_slotsEBD`];
          const duree = v[`repeating_slotsBD_${currentID}_slotsDureeBD`];
          const d = v[`repeating_slotsBD_${currentID}_slotsDBD`];

          const newrowid = generateRowID();
          const newrowattrs = {};
          newrowattrs[`repeating_modules_${newrowid}_moduleSlotBD`] = u;
          newrowattrs[`repeating_modules_${newrowid}_moduleNom`] = n;
          newrowattrs[`repeating_modules_${newrowid}_moduleActivation`] = a;
          newrowattrs[`repeating_modules_${newrowid}_moduleEnergie`] = e;
          newrowattrs[`repeating_modules_${newrowid}_moduleDuree`] = duree;
          newrowattrs[`repeating_modules_${newrowid}_moduleDescription`] = d;
          setAttrs(newrowattrs);
        },
      );
    });
  });

  getSectionIDs('repeating_slotsJG', (idarray) => {
    _.each(idarray, (currentID, i) => {
      getAttrs(
        [
          `repeating_slotsJG_${currentID}_slotsUJG`,
          `repeating_slotsJG_${currentID}_slotsNJG`,
          `repeating_slotsJG_${currentID}_slotsAJG`,
          `repeating_slotsJG_${currentID}_slotsEJG`,
          `repeating_slotsJG_${currentID}_slotsDureeJG`,
          `repeating_slotsJG_${currentID}_slotsDJG`,
        ], (v) => {
          const u = v[`repeating_slotsJG_${currentID}_slotsUJG`];
          const n = v[`repeating_slotsJG_${currentID}_slotsNJG`];
          const a = v[`repeating_slotsJG_${currentID}_slotsAJG`];
          const e = v[`repeating_slotsJG_${currentID}_slotsEJG`];
          const duree = v[`repeating_slotsJG_${currentID}_slotsDureeJG`];
          const d = v[`repeating_slotsJG_${currentID}_slotsDJG`];

          const newrowid = generateRowID();
          const newrowattrs = {};
          newrowattrs[`repeating_modules_${newrowid}_moduleSlotJG`] = u;
          newrowattrs[`repeating_modules_${newrowid}_moduleNom`] = n;
          newrowattrs[`repeating_modules_${newrowid}_moduleActivation`] = a;
          newrowattrs[`repeating_modules_${newrowid}_moduleEnergie`] = e;
          newrowattrs[`repeating_modules_${newrowid}_moduleDuree`] = duree;
          newrowattrs[`repeating_modules_${newrowid}_moduleDescription`] = d;
          setAttrs(newrowattrs);
        },
      );
    });
  });

  getSectionIDs('repeating_slotsJD', (idarray) => {
    _.each(idarray, (currentID, i) => {
      getAttrs(
        [
          `repeating_slotsJD_${currentID}_slotsUJD`,
          `repeating_slotsJD_${currentID}_slotsNJD`,
          `repeating_slotsJD_${currentID}_slotsAJD`,
          `repeating_slotsJD_${currentID}_slotsEJD`,
          `repeating_slotsJD_${currentID}_slotsDureeJD`,
          `repeating_slotsJD_${currentID}_slotsDJD`,
        ], (v) => {
          const u = v[`repeating_slotsJD_${currentID}_slotsUJD`];
          const n = v[`repeating_slotsJD_${currentID}_slotsNJD`];
          const a = v[`repeating_slotsJD_${currentID}_slotsAJD`];
          const e = v[`repeating_slotsJD_${currentID}_slotsEJD`];
          const duree = v[`repeating_slotsJD_${currentID}_slotsDureeJD`];
          const d = v[`repeating_slotsJD_${currentID}_slotsDJD`];

          const newrowid = generateRowID();
          const newrowattrs = {};
          newrowattrs[`repeating_modules_${newrowid}_moduleSlotJD`] = u;
          newrowattrs[`repeating_modules_${newrowid}_moduleNom`] = n;
          newrowattrs[`repeating_modules_${newrowid}_moduleActivation`] = a;
          newrowattrs[`repeating_modules_${newrowid}_moduleEnergie`] = e;
          newrowattrs[`repeating_modules_${newrowid}_moduleDuree`] = duree;
          newrowattrs[`repeating_modules_${newrowid}_moduleDescription`] = d;
          setAttrs(newrowattrs);
        },
      );
    });
  });

  getSectionIDs('repeating_slotsDCLTete', (idarray) => {
    _.each(idarray, (currentID, i) => {
      getAttrs(
        [
          `repeating_slotsDCLTete_${currentID}_slotsUDCLTete`,
          `repeating_slotsDCLTete_${currentID}_slotsNDCLTete`,
          `repeating_slotsDCLTete_${currentID}_slotsADCLTete`,
          `repeating_slotsDCLTete_${currentID}_slotsEDCLTete`,
          `repeating_slotsDCLTete_${currentID}_slotsDDCLTete`,
          `repeating_slotsDCLTete_${currentID}_slotsUDCLDTete`,
        ], (v) => {
          const u = v[`repeating_slotsDCLTete_${currentID}_slotsUDCLTete`];
          const n = v[`repeating_slotsDCLTete_${currentID}_slotsNDCLTete`];
          const a = v[`repeating_slotsDCLTete_${currentID}_slotsADCLTete`];
          const e = v[`repeating_slotsDCLTete_${currentID}_slotsEDCLTete`];
          const duree = v[`repeating_slotsDCLTete_${currentID}_slotsDDCLTete`];
          const d = v[`repeating_slotsDCLTete_${currentID}_slotsUDCLDTete`];

          const newrowid = generateRowID();
          const newrowattrs = {};
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleSlotDCLTete`] = u;
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleNomDCLion`] = n;
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleActivationDCLion`] = a;
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleEnergieDCLion`] = e;
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleDureeDCLion`] = duree;
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleDescriptionDCLion`] = d;
          setAttrs(newrowattrs);
        },
      );
    });
  });

  getSectionIDs('repeating_slotsDCLTorse', (idarray) => {
    _.each(idarray, (currentID, i) => {
      getAttrs(
        [
          `repeating_slotsDCLTorse_${currentID}_slotsUDCLTorse`,
          `repeating_slotsDCLTorse_${currentID}_slotsNDCLTorse`,
          `repeating_slotsDCLTorse_${currentID}_slotsADCLTorse`,
          `repeating_slotsDCLTorse_${currentID}_slotsEDCLTorse`,
          `repeating_slotsDCLTorse_${currentID}_slotsDDCLTorse`,
          `repeating_slotsDCLTorse_${currentID}_slotsUDCLDTorse`,
        ], (v) => {
          const u = v[`repeating_slotsDCLTorse_${currentID}_slotsUDCLTorse`];
          const n = v[`repeating_slotsDCLTorse_${currentID}_slotsNDCLTorse`];
          const a = v[`repeating_slotsDCLTorse_${currentID}_slotsADCLTorse`];
          const e = v[`repeating_slotsDCLTorse_${currentID}_slotsEDCLTorse`];
          const duree = v[`repeating_slotsDCLTorse_${currentID}_slotsDDCLTorse`];
          const d = v[`repeating_slotsDCLTorse_${currentID}_slotsUDCLDTorse`];

          const newrowid = generateRowID();
          const newrowattrs = {};
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleSlotDCLTorse`] = u;
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleNomDCLion`] = n;
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleActivationDCLion`] = a;
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleEnergieDCLion`] = e;
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleDureeDCLion`] = duree;
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleDescriptionDCLion`] = d;
          setAttrs(newrowattrs);
        },
      );
    });
  });

  getSectionIDs('repeating_slotsDCLBG', (idarray) => {
    _.each(idarray, (currentID, i) => {
      getAttrs(
        [
          `repeating_slotsDCLBG_${currentID}_slotsUDCLBG`,
          `repeating_slotsDCLBG_${currentID}_slotsNDCLBG`,
          `repeating_slotsDCLBG_${currentID}_slotsADCLBG`,
          `repeating_slotsDCLBG_${currentID}_slotsEDCLBG`,
          `repeating_slotsDCLBG_${currentID}_slotsDDCLBG`,
          `repeating_slotsDCLBG_${currentID}_slotsUDCLDBG`,
        ], (v) => {
          const u = v[`repeating_slotsDCLBG_${currentID}_slotsUDCLBG`];
          const n = v[`repeating_slotsDCLBG_${currentID}_slotsNDCLBG`];
          const a = v[`repeating_slotsDCLBG_${currentID}_slotsADCLBG`];
          const e = v[`repeating_slotsDCLBG_${currentID}_slotsEDCLBG`];
          const duree = v[`repeating_slotsDCLBG_${currentID}_slotsDDCLBG`];
          const d = v[`repeating_slotsDCLBG_${currentID}_slotsUDCLDBG`];

          const newrowid = generateRowID();
          const newrowattrs = {};
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleSlotDCLBG`] = u;
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleNomDCLion`] = n;
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleActivationDCLion`] = a;
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleEnergieDCLion`] = e;
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleDureeDCLion`] = duree;
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleDescriptionDCLion`] = d;
          setAttrs(newrowattrs);
        },
      );
    });
  });

  getSectionIDs('repeating_slotsDCLBD', (idarray) => {
    _.each(idarray, (currentID, i) => {
      getAttrs(
        [
          `repeating_slotsDCLBD_${currentID}_slotsUDCLBD`,
          `repeating_slotsDCLBD_${currentID}_slotsNDCLBD`,
          `repeating_slotsDCLBD_${currentID}_slotsADCLBD`,
          `repeating_slotsDCLBD_${currentID}_slotsEDCLBD`,
          `repeating_slotsDCLBD_${currentID}_slotsDDCLBD`,
          `repeating_slotsDCLBD_${currentID}_slotsUDCLDBD`,
        ], (v) => {
          const u = v[`repeating_slotsDCLBD_${currentID}_slotsUDCLBD`];
          const n = v[`repeating_slotsDCLBD_${currentID}_slotsNDCLBD`];
          const a = v[`repeating_slotsDCLBD_${currentID}_slotsADCLBD`];
          const e = v[`repeating_slotsDCLBD_${currentID}_slotsEDCLBD`];
          const duree = v[`repeating_slotsDCLBD_${currentID}_slotsDDCLBD`];
          const d = v[`repeating_slotsDCLBD_${currentID}_slotsUDCLDBD`];

          const newrowid = generateRowID();
          const newrowattrs = {};
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleSlotDCLBD`] = u;
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleNomDCLion`] = n;
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleActivationDCLion`] = a;
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleEnergieDCLion`] = e;
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleDureeDCLion`] = duree;
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleDescriptionDCLion`] = d;
          setAttrs(newrowattrs);
        },
      );
    });
  });

  getSectionIDs('repeating_slotsDCLJG', (idarray) => {
    _.each(idarray, (currentID, i) => {
      getAttrs(
        [
          `repeating_slotsDCLJG_${currentID}_slotsUDCLJG`,
          `repeating_slotsDCLJG_${currentID}_slotsNDCLJG`,
          `repeating_slotsDCLJG_${currentID}_slotsADCLJG`,
          `repeating_slotsDCLJG_${currentID}_slotsEDCLJG`,
          `repeating_slotsDCLJG_${currentID}_slotsDDCLJG`,
          `repeating_slotsDCLJG_${currentID}_slotsUDCLDJG`,
        ], (v) => {
          const u = v[`repeating_slotsDCLJG_${currentID}_slotsUDCLJG`];
          const n = v[`repeating_slotsDCLJG_${currentID}_slotsNDCLJG`];
          const a = v[`repeating_slotsDCLJG_${currentID}_slotsADCLJG`];
          const e = v[`repeating_slotsDCLJG_${currentID}_slotsEDCLJG`];
          const duree = v[`repeating_slotsDCLJG_${currentID}_slotsDDCLJG`];
          const d = v[`repeating_slotsDCLJG_${currentID}_slotsUDCLDJG`];

          const newrowid = generateRowID();
          const newrowattrs = {};
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleSlotDCLJG`] = u;
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleNomDCLion`] = n;
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleActivationDCLion`] = a;
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleEnergieDCLion`] = e;
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleDureeDCLion`] = duree;
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleDescriptionDCLion`] = d;
          setAttrs(newrowattrs);
        },
      );
    });
  });

  getSectionIDs('repeating_slotsDCLJD', (idarray) => {
    _.each(idarray, (currentID, i) => {
      getAttrs(
        [
          `repeating_slotsDCLJD_${currentID}_slotsUDCLJD`,
          `repeating_slotsDCLJD_${currentID}_slotsNDCLJD`,
          `repeating_slotsDCLJD_${currentID}_slotsADCLJD`,
          `repeating_slotsDCLJD_${currentID}_slotsEDCLJD`,
          `repeating_slotsDCLJD_${currentID}_slotsDDCLJD`,
          `repeating_slotsDCLJD_${currentID}_slotsUDCLDJD`,
        ], (v) => {
          const u = v[`repeating_slotsDCLJD_${currentID}_slotsUDCLJD`];
          const n = v[`repeating_slotsDCLJD_${currentID}_slotsNDCLJD`];
          const a = v[`repeating_slotsDCLJD_${currentID}_slotsADCLJD`];
          const e = v[`repeating_slotsDCLJD_${currentID}_slotsEDCLJD`];
          const duree = v[`repeating_slotsDCLJD_${currentID}_slotsDDCLJD`];
          const d = v[`repeating_slotsDCLJD_${currentID}_slotsUDCLDJD`];

          const newrowid = generateRowID();
          const newrowattrs = {};
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleSlotDCLJD`] = u;
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleNomDCLion`] = n;
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleActivationDCLion`] = a;
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleEnergieDCLion`] = e;
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleDureeDCLion`] = duree;
          newrowattrs[`repeating_modulesDCLion_${newrowid}_moduleDescriptionDCLion`] = d;
          setAttrs(newrowattrs);
        },
      );
    });
  });

  setAttrs({
    version: 15,
  });
});

on('clicked:repeating_modules:pem', async () => {
  const attrs = await getAttrsAsync([
    'repeating_modules_moduleEnergie',
    'fichePNJ',
    'armure',
    'espoir',
    'energiePNJ',
    'energiePJ',
  ]);

  const fiche = +attrs.fichePNJ;

  const armure = attrs.armure;
  const espoir = +attrs.espoir;

  const cout = +attrs.repeating_modules_moduleEnergie;

  let PE = 0;

  const update = {};

  let total = 0;

  if (fiche === 0) {
    if (armure === 'berserk') { PE = espoir; } else { PE = +attrs.energiePJ; }

    total = PE - cout;

    if (total < 0) {
      if (armure !== 'berserk') { setPanneauInformation('Erreur. Energie Indisponible.', false, false, true); } else { setPanneauInformation('Erreur. Espoir Indisponible.', false, false, true); }

      PI.msgEnergie = 1;
    } else if (armure === 'berserk') { update.espoir = total; } else { update.energiePJ = total; }
  } else if (fiche === 1) {
    PE = +attrs.energiePNJ;

    total = PE - cout;

    if (total < 0) {
      setPanneauInformation('Erreur. Energie Indisponible.', false, false, true);

      PI.msgEnergie = 1;
    } else { update.energiePNJ = total; }
  }

  await setAttrsAsync(update);
});

on('clicked:repeating_modulesdclion:pemdlion', async () => {
  const attrs = await getAttrsAsync([
    'repeating_modules_moduleEnergieDCLion',
    'druidLionPEAct',
  ]);

  const PE = +attrs.druidLionPEAct;
  const cout = +attrs.repeating_modules_moduleEnergieDCLion;

  const total = PE - cout;

  if (total < 0) {
    setPanneauInformation('Erreur. Energie Indisponible.', false, false, true);

    PI.msgEnergie = 1;
  } else {
    await setAttrsAsync({ druidLionPEAct: total });
  }
});

on('change:tab change:fichePNJ', () => {
  resetPanneauInformation();
});

// MECHAARMURE
const mechaArmure = {
  0: {
    vitesse: 0,
    manoeuvrabilite: 0,
    puissance: 0,
    senseurs: 0,
    systemes: 0,
    resilience: 0,
    blindage: 0,
    cdf: 0,
    noyaux: 0,
  },
  archangel: {
    vitesse: 3,
    manoeuvrabilite: 5,
    puissance: 5,
    senseurs: 6,
    systemes: 8,
    resilience: 30,
    blindage: 70,
    cdf: 30,
    noyaux: 100,
  },
  nephilim: {
    vitesse: 2,
    manoeuvrabilite: -4,
    puissance: 10,
    senseurs: 10,
    systemes: 10,
    resilience: 28,
    blindage: 120,
    cdf: 20,
    noyaux: 100,
  },
  demon: {
    vitesse: 2,
    manoeuvrabilite: 4,
    puissance: 12,
    senseurs: 8,
    systemes: 4,
    resilience: 20,
    blindage: 80,
    cdf: 30,
    noyaux: 100,
  },
};

on('change:mechaArmure change:mechaArmureVitesseModif change:mechaArmureManoeuvrabiliteModif change:mechaArmurePuissanceModif change:mechaArmureSenseursModif change:mechaArmureSystemesModif change:mechaArmureResilienceModif change:MANOGSTActive change:mechaArmureBlindageModif change:mechaArmureCdfModif change:mechaArmureNoyauxEnergieModif sheet:opened', async () => {
  const attrs = await getAttrsAsync([
    'mechaArmure',
    'mechaArmureVitesseModif',
    'mechaArmureManoeuvrabiliteModif',
    'mechaArmurePuissanceModif',
    'mechaArmureSystemesModif',
    'mechaArmureResilienceModif',
    'MANOGSTActive',
    'mechaArmureBlindageModif',
    'mechaArmureCdfModif',
    'mechaArmureNoyauxEnergieModif',
  ]);

  const MA = attrs.mechaArmure;
  const type = mechaArmure[MA] || [];

  const vitesse = parseInt(type.vitesse, 10) || 0;
  const manoeuvrabilite = parseInt(type.manoeuvrabilite, 10) || 0;
  const puissance = parseInt(type.puissance, 10) || 0;
  const senseurs = parseInt(type.senseurs, 10) || 0;
  const systemes = parseInt(type.systemes, 10) || 0;
  const resilience = parseInt(type.resilience, 10) || 0;
  const blindage = parseInt(type.blindage, 10) || 0;
  const cdf = parseInt(type.cdf, 10) || 0;
  const noyaux = parseInt(type.noyaux, 10) || 0;

  const vitesseM = parseInt(attrs.mechaArmureVitesseModif, 10) || 0;
  const manoeuvrabiliteM = parseInt(attrs.mechaArmureManoeuvrabiliteModif, 10) || 0;
  const puissanceM = parseInt(attrs.mechaArmurePuissanceModif, 10) || 0;
  const senseursM = parseInt(attrs.mechaArmureSenseursModif, 10) || 0;
  const systemesM = parseInt(attrs.mechaArmureSystemesModif, 10) || 0;
  const resilienceM = parseInt(attrs.mechaArmureResilienceModif, 10) || 0;
  const blindageM = parseInt(attrs.mechaArmureBlindageModif, 10) || 0;
  const cdfM = parseInt(attrs.mechaArmureCdfModif, 10) || 0;
  const noyauxM = parseInt(attrs.mechaArmureNoyauxEnergieModif, 10) || 0;

  const MST = parseInt(attrs.MANOGSTActive, 10) || 0;

  let resilienceB = 0;

  if (MST === 1) { resilienceB += 10; }

  const vitesseTotal = vitesse + vitesseM;
  const manoeuvrabiliteTotal = manoeuvrabilite + manoeuvrabiliteM;
  const puissanceTotal = puissance + puissanceM;
  const senseursTotal = senseurs + senseursM;
  const systemesTotal = systemes + systemesM;
  const resilienceTotal = resilience + resilienceM + resilienceB;
  const blindageTotal = blindage + blindageM;
  const cdfTotal = cdf + cdfM;
  const noyauxTotal = noyaux + noyauxM;

  let translation;

  if (!MA) { translation = ''; } else { translation = getTranslationByKey(MA); }

  await setAttrsAsync({
    mechaArmureNom: translation,
    mechaArmureVitesse: vitesseTotal,
    mechaArmureManoeuvrabilite: manoeuvrabiliteTotal,
    mechaArmurePuissance: puissanceTotal,
    mechaArmureSenseurs: senseursTotal,
    mechaArmureSystemes: systemesTotal,
    mechaArmureResilience_max: resilienceTotal,
    mechaArmureBlindage_max: blindageTotal,
    mechaArmureCdf_max: cdfTotal,
    mechaArmureNoyauxEnergie_max: noyauxTotal,
  });
});

on('change:mechaArmureTypeJets change:mechaArmureManoeuvrabilite change:mechaArmurePuissance change:mechaArmureSenseurs change:mechaArmureSystemes sheet:opened', async () => {
  const attrs = await getAttrsAsync([
    'mechaArmureTypeJets',
    'mechaArmureManoeuvrabilite',
    'mechaArmurePuissance',
    'mechaArmureSenseurs',
    'mechaArmureSystemes',
  ]);

  const type = parseInt(attrs.mechaArmureTypeJets, 10) || 0;
  const manoeuvrabilite = parseInt(attrs.mechaArmureManoeuvrabilite, 10) || 0;
  const puissance = parseInt(attrs.mechaArmurePuissance, 10) || 0;
  const senseurs = parseInt(attrs.mechaArmureSenseurs, 10) || 0;
  const systemes = parseInt(attrs.mechaArmureSystemes, 10) || 0;

  const update = {};

  switch (type) {
    case 1:
      update.mechaArmureJetBonus = manoeuvrabilite;
      update.mechaArmureJetBonusType = 'Manoeuvrabilité';
      break;
    case 2:
      update.mechaArmureJetBonus = puissance;
      update.mechaArmureJetBonusType = 'Puissance';
      break;
    case 3:
      update.mechaArmureJetBonus = senseurs;
      update.mechaArmureJetBonusType = 'Senseurs';
      break;
    case 4:
      update.mechaArmureJetBonus = systemes;
      update.mechaArmureJetBonusType = 'Systèmes';
      break;
    case 5:
      update.mechaArmureJetBonus = 0;
      update.mechaArmureJetBonusType = '';
      break;
  }

  await setAttrsAsync(update);
});

on('change:mechaArmure change:mechaArmureArchangelConfiguration change:mechaArmureNephilimConfiguration change:mechaArmureDemonConfiguration', async () => {
  await setAttrsAsync({
    MADABAmritaActive: 0,
    MAAEvacuationActive: 0,
    MANOGStationActive: 0,
    MANOGInvulnerabiliteActive: 0,
    MANOGSTActive: 0,
    MADDjinnWraithActive: 0,
    MADDjinnNanobrumeActive: 0,
    MADACSoniqueActive: 0,
    MAArchangelVolActive: 0,
    MANephilimSautActive: 0,
    MANephilimEmblemActive: 0,
    MADemonSautActive: 0,
    MANephilimDronesAirainActive: 0,
  });
});
// FIN MECHAARMURE

// LONGBOW
on('change:rangerArmeDegatEvol change:rangerArmeDegat change:rangerArmeViolenceEvol change:rangerArmeViolence change:rangerArmePortee change:rangerChoc change:rangerDegatContinue change:rangerDesignation change:rangerSilencieux change:rangerPerceArmure change:rangerUltraViolence change:rangerAntiVehicule change:rangerArtillerie change:rangerDispersion change:rangerLumiere change:rangerPenetrant change:rangerPerceArmure60 change:rangerAntiAnatheme change:rangerDemoralisant change:rangerEnChaine change:rangerFureur change:rangerIgnoreArmure change:rangerPenetrant10 change:ranger100PG change:ranger50PG2 sheet:opened', async () => {
  const attrs = await getAttrsAsync([
    'rangerArmeDegatEvol',
    'rangerArmeDegat',
    'rangerArmeViolenceEvol',
    'rangerArmeViolence',
    'rangerArmePortee',
    'rangerChoc',
    'rangerDegatContinue',
    'rangerDesignation',
    'rangerSilencieux',
    'rangerPerceArmure',
    'rangerUltraViolence',
    'rangerAntiVehicule',
    'rangerArtillerie',
    'rangerDispersion',
    'rangerLumiere',
    'rangerPenetrant',
    'rangerPerceArmure60',
    'rangerAntiAnatheme',
    'rangerDemoralisant',
    'rangerEnChaine',
    'rangerFureur',
    'rangerIgnoreArmure',
    'rangerPenetrant10',
    'ranger100PG',
    'ranger50PG2',
  ]);

  const PG50 = attrs.ranger50PG2;
  const PG100 = attrs.ranger100PG;

  let baseD = 3;
  let baseV = 1;

  let E1 = 2;
  let E2 = 3;
  let E3 = 6;

  let dgts = Number(attrs.rangerArmeDegat);
  let violence = Number(attrs.rangerArmeViolence);

  const portee = attrs.rangerArmePortee;

  if (PG50 === 'on') {
    baseD = 5;
    baseV = 3;

    dgts = Number(attrs.rangerArmeDegatEvol);
    violence = Number(attrs.rangerArmeViolenceEvol);
  }

  if (PG100 === 'on') {
    E1 = 1;
    E2 = 1;
    E3 = 4;
  }

  const eChoc = attrs.rangerChoc;
  const eDegatsContinus = attrs.rangerDegatContinue;
  const eDesignation = attrs.rangerDesignation;
  const eSilencieux = attrs.rangerSilencieux;
  const ePerceArmure = attrs.rangerPerceArmure;
  const eUltraviolence = attrs.rangerUltraViolence;
  const eAntiVehicule = attrs.rangerAntiVehicule;
  const eArtillerie = attrs.rangerArtillerie;
  const eDispersion = attrs.rangerDispersion;
  const eLumiere = attrs.rangerLumiere;
  const ePenetrant = attrs.rangerPenetrant;
  const ePerceArmure60 = attrs.rangerPerceArmure60;
  const eAntiAnatheme = attrs.rangerAntiAnatheme;
  const eDemoralisant = attrs.rangerDemoralisant;
  const eEnChaine = attrs.rangerEnChaine;
  const eFureur = attrs.rangerFureur;
  const eIgnoreArmure = attrs.rangerIgnoreArmure;
  const ePenetrant10 = attrs.rangerPenetrant10;

  let energie = 0;

  energie += (dgts - baseD);
  energie += (violence - baseV);

  switch (portee) {
    case '^{portee-longue}':
      energie += 1;
      break;

    case '^{portee-lointaine}':
      energie += 2;
      break;
  }

  let energieDepense = 0;

  if (eChoc !== '0') { energieDepense += E1; }

  if (eSilencieux !== '0') { energieDepense += E1; }

  if (eUltraviolence !== '0') { energieDepense += E1; }

  if (eArtillerie !== '0') { energieDepense += E2; }

  if (eAntiAnatheme !== '0') { energieDepense += E3; }

  if (eDemoralisant !== '0') { energieDepense += E3; }

  if (eEnChaine !== '0') { energieDepense += E3; }

  if (eFureur !== '0') { energieDepense += E3; }

  if (eAntiVehicule !== '0') { energieDepense += E2; }

  if (eDegatsContinus !== '0') { energieDepense += E1; }

  if (eDesignation !== '0') { energieDepense += E1; }

  if (eDispersion !== '0') { energieDepense += E2; }

  if (eLumiere !== '0') { energieDepense += E2; }

  if (ePenetrant !== '0') { energieDepense += E2; }

  if (ePerceArmure !== '0') { energieDepense += E1; }

  if (ePerceArmure60 !== '0') { energieDepense += E2; }

  if (eIgnoreArmure !== '0') { energieDepense += E3; }

  if (ePenetrant10 !== '0') { energieDepense += E3; }

  energie += energieDepense;

  await setAttrsAsync({ longbowEnergie: `(${getTranslationByKey('depense-energie-prevue')} : ${energie})` });
});
// LONGBOW

// HERAUT DE LEQUILIBRE - CHEVALIER DE LA LUMIERE
const chevalierHerauts = ['devasterAnatheme', 'bourreauTenebres', 'equilibreBalance'];

chevalierHerauts.forEach((button) => {
  on(`clicked:${button}`, async () => {
    const attrs = await getAttrsAsync([button]);
    const value = +attrs[button];
    const result = {};

    let newValue = 1;

    if (value === 1) { newValue = 0; }

    result[button] = newValue;

    await setAttrsAsync(result);
  });
});
// HERAUT DE LEQUILIBRE - CHEVALIER DE LA LUMIERE

// Import NPC
on('clicked:importKNPCG', () => {
  getAttrs(['importKNPCG'], (value) => {
    const json = JSON.parse(value.importKNPCG);
    const aspects = json.aspects;
    const capacites = json.capacities;
    const weapons = json.weapons;

    const type = json.type.charAt(0).toUpperCase() + json.type.substr(1);
    const level = json.level.charAt(0).toUpperCase() + json.level.substr(1);

    const chair = { score: 0, majeur: 0, mineur: 0 };
    const bete = { score: 0, majeur: 0, mineur: 0 };
    const machine = { score: 0, majeur: 0, mineur: 0 };
    const dame = { score: 0, majeur: 0, mineur: 0 };
    const masque = { score: 0, majeur: 0, mineur: 0 };
    const lAspects = {
      chair: chair, bête: bete, machine: machine, dame: dame, masque: masque,
    };

    const health = json.health || 0;
    const armor = json.armor || 0;
    const energy = json.energy || 0;
    const shield = json.shield || 0;
    const forcefield = json.forcefield || 0;
    let defense = json.defense || 0;
    let reaction = json.reaction || 0;

    let diceInitiative = 3;
    const initiative = json.initiative || 1;

    let tabResilience = 0;
    const resilience = json.resilience || 0;

    const debordement = json.outbreak || 0;

    const weakness = json.weakness || '';

    for (const keyA in aspects) {
      const result = aspects[keyA];
      lAspects[result.name].score = result.score;

      if (result.major === true) { lAspects[result.name].majeur = result.exceptional; } else { lAspects[result.name].mineur = result.exceptional; }
    }

    getSectionIDs('repeating_capacites', (idarray) => {
      for (let i = 0; i < idarray.length; i += 1) {
        removeRepeatingRow(`repeating_capacites_${idarray[i]}`);
      }
    });

    for (const keyC in capacites) {
      const result = capacites[keyC];

      const newrowid = generateRowID();
      const newrowattrs = {};
      newrowattrs[`repeating_capacites_${newrowid}_nomCapacite`] = result.name;
      newrowattrs[`repeating_capacites_${newrowid}_descCapacite`] = result.description;
      setAttrs(newrowattrs);
    }

    getSectionIDs('repeating_armeCaC', (idarray) => {
      for (let i = 0; i < idarray.length; i += 1) {
        removeRepeatingRow(`repeating_armeCaC_${idarray[i]}`);
      }
    });

    getSectionIDs('repeating_armedist', (idarray) => {
      for (let i = 0; i < idarray.length; i += 1) {
        removeRepeatingRow(`repeating_armedist_${idarray[i]}`);
      }
    });

    const otherWPNEffects = [];

    for (const keyW in weapons) {
      const result = weapons[keyW];
      const contact = result.contact;
      const range = result.range;
      let path = '';
      const otherEffects = [];

      const effects = result.effects;

      const newrowidW = generateRowID();
      const newrowattrsW = {};

      if (contact === true) {
        path = 'repeating_armeCaC_';

        let raw = result.raw - lAspects.bête.mineur - lAspects.bête.majeur;

        if (lAspects.bête.majeur > 0) { raw -= bete.score; }

        if (raw < 0) { raw = 0; }

        newrowattrsW[`${path + newrowidW}_ArmeCaC`] = result.name;
        newrowattrsW[`${path + newrowidW}_armeCaCDegat`] = result.dices;
        newrowattrsW[`${path + newrowidW}_armeCaCBDegat`] = raw;
        newrowattrsW[`${path + newrowidW}_armeCaCViolence`] = result.violenceDices;
        newrowattrsW[`${path + newrowidW}_armeCaCBDegat`] = raw;
        newrowattrsW[`${path + newrowidW}_armeCaCBViolence`] = result.violenceRaw;
        newrowattrsW[`${path + newrowidW}_armeCaCPortee`] = `^{portee-${range}}`;
      } else {
        path = 'repeating_armedist_';

        newrowattrsW[`${path + newrowidW}_ArmeDist`] = result.name;
        newrowattrsW[`${path + newrowidW}_armeDistDegat`] = result.dices;
        newrowattrsW[`${path + newrowidW}_armeDistViolence`] = result.violenceDices;
        newrowattrsW[`${path + newrowidW}_armeDistBDegat`] = result.raw;
        newrowattrsW[`${path + newrowidW}_armeDistBViolence`] = result.violenceRaw;
        newrowattrsW[`${path + newrowidW}_armeDistPortee`] = `^{portee-${range}}`;
      }

      for (const cle in effects) {
        const eff = effects[cle].name.split(' ');
        let length = eff.length;

        if (length > 1) { length -= 1; } else { length = 1; }

        const name = effects[cle].name.split(' ', length).join(' ').toLowerCase();
        const value2 = eff[length] || 0;

        const uEff = name === 'ignore' || name === 'perce' || name === 'dégâts' ? `${name} ${eff[1]}` : name;

        switch (uEff) {
          case 'anathème':
            newrowattrsW[`${path + newrowidW}_anatheme`] = '{{anatheme=Anathème}}';
            break;

          case 'anti-anathème':
            newrowattrsW[`${path + newrowidW}_antiAnatheme`] = '{{antiAnathème=Anti Anathème}}';
            break;

          case 'anti-véhicule':
            newrowattrsW[`${path + newrowidW}_antiVehicule`] = '{{antiVehicule=Anti Véhicule}} ';
            break;

          case 'artillerie':
            newrowattrsW[`${path + newrowidW}_artillerie`] = '{{artillerie=Artillerie}}';
            break;

          case 'assassin':
            newrowattrsW[`${path + newrowidW}_assassin`] = '{{assassin=[[@{assassinValue}d6]]}} ';
            newrowattrsW[`${path + newrowidW}_assassinValue`] = Number(value2);
            break;

          case "assistance à l'attaque":
            newrowattrsW[`${path + newrowidW}_assistanceAttaque`] = "{{assistanceAttaque=Assistance à l'attaque}}";
            break;

          case 'barrage':
            newrowattrsW[`${path + newrowidW}_barrage`] = '{{barrage=^{barrage} @{barrageValue}}} ';
            newrowattrsW[`${path + newrowidW}_barrageValue`] = Number(value2);
            break;

          case 'cadence':
            newrowattrsW[`${path + newrowidW}_cadence`] = '[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]';
            newrowattrsW[`${path + newrowidW}_cadenceValue`] = Number(value2);
            break;

          case 'chargeur':
            newrowattrsW[`${path + newrowidW}_chargeur`] = '{{chargeur=^{chargeur} @{chargeurValue}}} ';
            newrowattrsW[`${path + newrowidW}_chargeurValue`] = Number(value2);
            break;

          case 'choc':
            newrowattrsW[`${path + newrowidW}_choc`] = '{{choc=^{choc} @{chocValue}}}';
            newrowattrsW[`${path + newrowidW}_chocValue`] = Number(value2);
            break;

          case 'défense':
            newrowattrsW[`${path + newrowidW}_defense`] = '{{defense=^{defense} @{defenseValue}}}';
            newrowattrsW[`${path + newrowidW}_defenseValue`] = Number(value2);
            break;

          case 'dégâts continus':
            newrowattrsW[`${path + newrowidW}_degatContinue`] = '{{degatContinus=^{degats-continus} @{degatContinueValue} ([[1D6]] ^{tours})}}';
            newrowattrsW[`${path + newrowidW}_degatContinueValue`] = Number(value2);
            break;

          case 'deux mains':
            newrowattrsW[`${path + newrowidW}_deuxMains`] = '{{deuxMains=Deux Mains}}';
            break;

          case 'démoralisant':
            newrowattrsW[`${path + newrowidW}_demoralisant`] = '{{demoralisant=Démoralisant}}';
            break;

          case 'désignation':
            newrowattrsW[`${path + newrowidW}_designation`] = '{{designation=Désignation}}';
            break;

          case 'destructeur':
            newrowattrsW[`${path + newrowidW}_destructeur`] = '{{destructeur=[[2D6]]}}';
            break;

          case 'dispersion':
            newrowattrsW[`${path + newrowidW}_dispersion`] = '{{dispersion=^{dispersion} @{dispersionValue}}} ';
            newrowattrsW[`${path + newrowidW}_dispersionValue`] = Number(value2);
            break;

          case 'en chaîne':
            newrowattrsW[`${path + newrowidW}_enChaine`] = '{{enChaine=En Chaîne}}';
            break;

          case 'espérance':
            newrowattrsW[`${path + newrowidW}_esperance`] = '{{esperance=Espérance}}';
            break;

          case 'fureur':
            newrowattrsW[`${path + newrowidW}_fureur`] = '{{fureur=[[4D6]]}}';
            break;

          case 'ignore armure':
            newrowattrsW[`${path + newrowidW}_ignoreArmure`] = '{{ignoreArmure=Ignore Armure}}';
            break;

          case 'ignore CdF':
            newrowattrsW[`${path + newrowidW}_ignoreCdF`] = '{{ignoreCdF=Ignore Champs de Force}}';
            break;

          case 'jumelé (akimbo)':
            newrowattrsW[`${path + newrowidW}_akimbo`] = '2';
            break;

          case 'jumelé (ambidextrie)':
            newrowattrsW[`${path + newrowidW}_ambidextrie`] = '2';
            break;

          case 'lesté':
            newrowattrsW[`${path + newrowidW}_lestePNJ`] = '{{leste=[[@{Chair}]]}}';
            break;

          case 'lourd':
            newrowattrsW[`${path + newrowidW}_lourd`] = '1';
            break;

          case 'lumière':
            newrowattrsW[`${path + newrowidW}_lumiere`] = '{{lumiere=^{lumiere} @{lumiereValue}}}';
            newrowattrsW[`${path + newrowidW}_lumiereValue`] = Number(value2);
            break;

          case 'meurtrier':
            newrowattrsW[`${path + newrowidW}_meurtrier`] = '{{meurtrier=[[2D6]]}}';
            break;

          case 'oblitération':
            newrowattrsW[`${path + newrowidW}_obliteration`] = '{{obliteration=Oblitération}}';
            break;

          case 'orfèvrerie':
            newrowattrsW[`${path + newrowidW}_orfevreriePNJ`] = '{{orfevrerie=[[ceil(@{masque}/2)]]}}';
            break;

          case 'parasitage':
            newrowattrsW[`${path + newrowidW}_parasitage`] = '{{parasitage=^{parasitage} @{parasitageValue}}}';
            newrowattrsW[`${path + newrowidW}_parasitageValue`] = Number(value2);
            break;

          case 'pénétrant':
            newrowattrsW[`${path + newrowidW}_penetrant`] = '{{penetrant=^{penetrant} @{penetrantValue}}}';
            newrowattrsW[`${path + newrowidW}_penetrantValue`] = Number(value2);
            break;

          case 'perce armure':
            newrowattrsW[`${path + newrowidW}_perceArmure`] = '{{perceArmure=^{perce-armure} @{perceArmureValue}}}';
            newrowattrsW[`${path + newrowidW}_perceArmureValue`] = Number(value2);
            break;

          case 'précision':
            newrowattrsW[`${path + newrowidW}_precisionPNJ`] = '{{precision=[[(ceil((@{machine})/2))]]}}';
            break;

          case 'réaction':
            newrowattrsW[`${path + newrowidW}_reaction`] = '{{reaction=^{reaction} @{reactionValue}}}';
            newrowattrsW[`${path + newrowidW}_reactionValue`] = Number(value2);
            break;

          case 'silencieux':
            newrowattrsW[`${path + newrowidW}_silencieux`] = '{{silencieux=Silencieux}}';
            break;

          case 'soumission':
            newrowattrsW[`${path + newrowidW}_soumission`] = '{{soumission=Soumission}}';
            break;

          case 'ténébricide':
            newrowattrsW[`${path + newrowidW}_tenebricite`] = '{{tenebricide=Ténébricide}}';
            break;

          case 'tir en rafale':
            newrowattrsW[`${path + newrowidW}_tirRafale`] = '{{tirRafale=Tir en Rafale}}';
            break;

          case 'tir en sécurité':
            newrowattrsW[`${path + newrowidW}_tirSecurite`] = '3';
            break;

          case 'ultraviolence':
            newrowattrsW[`${path + newrowidW}_ultraViolence`] = '{{ultraviolence=[[2D6]]}}';
            break;

          default:
            otherEffects.push(effects[cle].name);
            break;
        }
      }

      if (otherEffects.length > 0) {
        otherWPNEffects.push(`${result.name} : ${otherEffects.join(', ')}`);
      }

      setAttrs(newrowattrsW);
    }

    if (json.resilience > 0) { tabResilience = 1; }

    if (type === 'Bande') {
      setAttrs({
        fichePNJ: 3,
      });

      diceInitiative = 0;
    }

    defense = defense - lAspects.masque.majeur - lAspects.masque.mineur;
    reaction = reaction - lAspects.machine.majeur - lAspects.machine.mineur;

    setAttrs({
      character_name: json.name,
      typePNJ: `${type} (${level})`,

      chair: lAspects.chair.score,
      chairPNJAE: lAspects.chair.mineur,
      chairPNJAEMaj: lAspects.chair.majeur,
      bete: lAspects['bête'].score,
      betePNJAE: lAspects['bête'].mineur,
      betePNJAEMaj: lAspects['bête'].majeur,
      machine: lAspects.machine.score,
      machinePNJAE: lAspects.machine.mineur,
      machinePNJAEMaj: lAspects.machine.majeur,
      dame: lAspects.dame.score,
      damePNJAE: lAspects.dame.mineur,
      damePNJAEMaj: lAspects.dame.majeur,
      masque: lAspects.masque.score,
      masquePNJAE: lAspects.masque.mineur,
      masquePNJAEMaj: lAspects.masque.majeur,

      santePNJ: health,
      santePNJ_max: health,

      armurePNJ: armor,
      armurePNJ_max: armor,

      energiePNJ: energy,
      energiePNJ_max: energy,

      bouclierPNJ: shield,
      bouclierPNJ_max: shield,

      cdfPNJ: forcefield,
      cdfPNJ_max: forcefield,

      defensePNJ: defense,
      reactionPNJ: reaction,

      diceInitiative: diceInitiative,
      bonusInitiativeP: initiative,

      ptsFaibles: weakness,

      pnjCapaciteNotes: otherWPNEffects.join('\r\n'),

      tabResilience: tabResilience,
      resilience: resilience,
      resilience_max: resilience,

      bandeDebordement: debordement,
    });
  });
});

// TRADUCTIONS
on('sheet:opened', async () => {
  const bard = [i18n_ignoreArmure, i18n_ignoreCDF, `${i18n_dispersion} 6`, `${i18n_choc} 1`];
  bard.sort();

  const wizardBorealis = [i18n_antiAnatheme, `${i18n_degatsContinus} 3`];
  wizardBorealis.sort();

  const wizardOriflamme = [i18n_antiAnatheme, `${i18n_lumiere} 2`, i18n_affecteAnatheme];
  wizardOriflamme.sort();

  const MADSD = [i18n_antiVehicule, i18n_briserResilience, `${i18n_parasitage} 2`];
  MADSD.sort();

  const MANMJ = [i18n_antiVehicule, i18n_antiAnatheme, i18n_demoralisant, i18n_briserResilience];
  MANMJ.sort();

  const MAACM = [i18n_antiVehicule, `${i18n_parasitage} 2`, `${i18n_degatsContinus} 10`, i18n_briserResilience];
  MAACM.sort();

  const MANCM = [i18n_antiVehicule, `${i18n_dispersion} 12`, i18n_antiAnatheme, i18n_briserResilience, i18n_fureur];
  MANCM.sort();

  const MANMS = [i18n_antiVehicule, i18n_demoralisant, i18n_ultraviolence];
  MANMS.sort();

  await setAttrsAsync({
    bardEffetAttSpe: bard.join(' / '),
    berserkIlluminationBlazePortee: getTranslationByKey('portee-contact'),
    berserkIlluminationBeaconPortee: getTranslationByKey('portee-courte'),
    berserkIlluminationProjectorPortee: getTranslationByKey('portee-courte'),
    berserkIlluminationLighthousePortee: getTranslationByKey('portee-courte'),
    berserkIlluminationLanternPortee: getTranslationByKey('portee-courte'),
    berserkIlluminationLanternEffets: getTranslationByKey('esperance'),
    monkVaguePortee: `${getTranslationByKey('portee-contact')} / ${getTranslationByKey('portee-courte')}`,
    monkSalvePortee: getTranslationByKey('portee-moyenne'),
    monkRayonPortee: getTranslationByKey('portee-moyenne'),
    wizardBEffets: wizardBorealis.join(' / '),
    wizardOEffets: wizardOriflamme.join(' / '),
    MALWizardOEffets: wizardOriflamme.join(' / '),
    MALWizardOPortee: getTranslationByKey('portee-moyenne'),
    traumasInsignifiants: getTranslationByKey('traumas-insignifiants'),
    traumasLegers: getTranslationByKey('traumas-legers'),
    traumasGraves: getTranslationByKey('traumas-graves'),
    traumasLourds: getTranslationByKey('traumas-lourds'),
    MADSDPortee: getTranslationByKey('portee-contact'),
    MADSDEffetsListe: MADSD.join(' / '),
    MAAGOfferingDuree: `1D3 ${getTranslationByKey('tours')}`,
    MAAGOfferingPortee: getTranslationByKey('portee-moyenne'),
    MAAGCurseDuree: `1 ${getTranslationByKey('tour')}`,
    MAAGCursePortee: getTranslationByKey('portee-moyenne'),
    MAAGMiracleDuree: `2D6 ${getTranslationByKey('tours')}`,
    MAAGMiraclePortee: getTranslationByKey('portee-contact'),
    MAAGEvacuationDuree: `1 ${getTranslationByKey('tour')}`,
    MAAGEvacuationPortee: getTranslationByKey('zone-entiere'),
    MANOGInvulnerabilitePortee: getTranslationByKey('portee-courte'),
    MANOGInvulnerabiliteDuree: `2D6 ${getTranslationByKey('tours')}`,
    MANOGInvulnerabiliteEffets: getTranslationByKey('invulnerabilite'),
    MANOGStationPortee: getTranslationByKey('portee-moyenne'),
    MANOGStationDuree: getTranslationByKey('sans-limite'),
    MANMJEffetsL: MANMJ.join(' / '),
    MANMJPortee: getTranslationByKey('portee-lointaine'),
    MADAPSEffets: getTranslationByKey('poings-soniques-effets'),
    MADAPSPortee: getTranslationByKey('portee-contact'),
    MADACSPortee: getTranslationByKey('portee-courte'),
    MADACSEffets: `${getTranslationByKey('choc')} 6 / ${getTranslationByKey('choc')} 4 / ${getTranslationByKey('choc')} 2`,
    MANSautPortee: getTranslationByKey('portee-longue'),
    MANSautHauteur: getTranslationByKey('portee-longue'),
    MANSautDuree: `1 ${getTranslationByKey('tour')}`,
    MANEmblemPortee: getTranslationByKey('portee-longue'),
    MADSautPortee: getTranslationByKey('portee-longue'),
    MADSautHauteur: getTranslationByKey('portee-longue'),
    MADSautDuree: `1 ${getTranslationByKey('tour')}`,
    MAAVagueSoinPortee: getTranslationByKey('portee-moyenne'),
    MANDronesAirainDuree: getTranslationByKey('sans-limite'),
    MANDronesAirainPortee: getTranslationByKey('portee-longue'),
    MAAMIPortee: getTranslationByKey('portee-courte'),
    MAACanonMetatronEffets: MAACM.join(' / '),
    MAACanonMetatronPortee: getTranslationByKey('portee-moyenne'),
    MANCanonMagmaEffets: MANCM.join(' / '),
    MANCanonMagmaPortee: getTranslationByKey('portee-moyenne'),
    MADLCGEffets: getTranslationByKey('lames-cinetiques-geantes-effets'),
    MAACanonNoePortée: getTranslationByKey('portee-longue'),
    MANMSEffetsListe: MANMS.join(' / '),
    MANMSurturPortee: getTranslationByKey('portee-moyenne'),
    MAATLAPortee: getTranslationByKey('portee-courte'),
    MAATLAEffets: getTranslationByKey('anti-anatheme'),
    druidLionBaseNom: getTranslationByKey('coups'),
    MALDruidLionBaseNom: getTranslationByKey('coups'),
    pSCaC: getTranslationByKey('couteau-de-service'),
    mECaC: getTranslationByKey('marteau-epieu-contact'),
    pSDist: getTranslationByKey('pistolet-de-service'),
    mEDist: getTranslationByKey('marteau-epieu-distance'),
    poingCaC: getTranslationByKey('coup-poing-pied'),
    poingMACaC: getTranslationByKey('coup-poing-pied'),
  });
});

on('change:effetArmes', (eventInfo) => {
  const text = eventInfo.newValue;

  const update = {};

  update['effetArmes-description'] = getTranslationByKey(text);

  setAttrsAsync(update);
});

on('change:ameliorationArmes', (eventInfo) => {
  const text = eventInfo.newValue;

  const update = {};

  update['ameliorationArmes-description'] = getTranslationByKey(text);

  setAttrsAsync(update);
});

on('change:ameliorationOArmes', (eventInfo) => {
  const text = eventInfo.newValue;

  const update = {};

  update['ameliorationOArmes-description'] = getTranslationByKey(text);

  setAttrsAsync(update);
});

on('change:chevaliersHerauts', () => {
  const update = {};

  update.devasterAnatheme = 0;
  update.bourreauTenebres = 0;
  update.equilibreBalance = 0;

  setAttrsAsync(update);
});
  /* eslint-disable prefer-destructuring */
/* eslint-disable no-undef */
const buttontab = ['dossier', 'armure', 'combat', 'module', 'overdrive', 'ia', 'ia-incarnee', 'historique', 'art', 'heroisme', 'vehicule', 'mecha-armure', 'capacites', 'equipage'];

// MENU
buttontab.forEach((button) => {
  on(`clicked:${button}`, () => {
    setAttrs({
      tab: button,
    });
  });
});

// EQUIPEMENT PORTE
const buttonPorte = ['barbarian', 'bard', 'berserk', 'druid', 'monk', 'necromancer', 'paladin', 'priest', 'psion', 'ranger', 'rogue', 'shaman', 'sorcerer', 'warlock', 'warmaster', 'warrior', 'wizard', 'sans', 'guardian'];

buttonPorte.forEach((button) => {
  on(`clicked:${button}`, () => {
    setAttrs({
      armure: button,
    });
  });
});

// CHOIX ARMURE
on('clicked:choixArmure', () => {
  setAttrs({
    popup: 1,
  });
});

on('change:choixArmure', (event) => {
  const newValue = event.newValue;

  setAttrs({
    armure: 'sans',
  });

  if (newValue === 'sorcerer') {
    setAttrs({
      armure: 'sorcerer',
    });
  }

  if (newValue === 'necromancer') {
    setAttrs({
      armure: 'necromancer',
    });
  }
});

// BONUS GAIN ESPOIR
const buttonGainEspoir = ['appliquerGainEspoir_1'];

buttonGainEspoir.forEach((button) => {
  on(`clicked:${button}`, () => {
    const name = button.split('_')[0];
    let newValue = button.split('_')[1];

    getAttrs([name], (value) => {
      const active = value[name];

      if (active === newValue) { newValue = '0'; }

      const newAttr = {};
      newAttr[name] = newValue;

      setAttrs(newAttr);
    });
  });
});

// SELECTION ARMURE
on('clicked:selectionArmure', () => {
  setAttrs({
    popup: 0,
  });
});

// SELECTION META-ARMURES LEGENDES
on('change:armureLegende', () => {
  setAttrs({
    MALChoixCompanons: 'aucun',
  });
});

// CARACTERISTIQUES BONUS
const buttonCaracBonus = ['bonusCarac_1', 'bonusCarac_2'];

buttonCaracBonus.forEach((button) => {
  on(`clicked:${button}`, () => {
    getAttrs(['bonusCarac'], (value) => {
      const bonusCarac = parseInt(value.bonusCarac, 10) || 0;
      let newValue = +button.split('_')[1];

      if (bonusCarac === newValue) { newValue = 0; }

      setAttrs({
        bonusCarac: newValue,
      });
    });
  });
});

// CAPACITES ACTIVES META-ARMURES LEGENDES
const buttonCapaciteActive = ['capaciteUltimeType_1', 'capaciteUltimeType_2'];

buttonCapaciteActive.forEach((button) => {
  on(`clicked:${button}`, () => {
    getAttrs(['capaciteUltimeType'], (value) => {
      const capaciteActive = parseInt(value.capaciteUltimeType, 10) || 0;
      let newValue = button.split('_')[1];

      if (capaciteActive === newValue) { newValue = 0; }

      setAttrs({
        capaciteUltimeType: newValue,
      });
    });
  });
});

// CAPACITES BARD
const buttonBard = ['bardChangeling', 'MALBardChangeling'];

buttonBard.forEach((button) => {
  on(`clicked:${button}`, () => {
    getAttrs([button], (value) => {
      const active = value[button];
      let newValue = '{{modeChangeling=Activé}}';

      if (active === '{{modeChangeling=Activé}}') { newValue = ''; }

      const newAttr = {};
      newAttr[button] = newValue;

      setAttrs(newAttr);
    });
  });
});

// CAPACITES BERSERK
const buttonBerserk = ['berserkBlaze', 'berserkCandle', 'berserkBeacon', 'berserkTorch', 'berserkProjector', 'berserkLighthouse', 'berserkLantern', 'berserkIlluminationBeaconA', 'berserkIlluminationTorchA', 'berserkIlluminationProjectorA', 'berserkIlluminationLighthouseA', 'berserkIlluminationLanternA', 'berserkRageA'];

buttonBerserk.forEach((button) => {
  on(`clicked:${button}`, () => {
    getAttrs([button], (value) => {
      const active = value[button];
      let newValue = 'on';
      const newAttr = {};

      if (active === 'on') {
        newValue = '';

        if (button === 'berserkRageA') { newAttr.berserkNiveaux = 0; }
      }

      newAttr[button] = newValue;

      setAttrs(newAttr);
    });
  });
});

const buttonNiveauRage = ['berserkNiveaux_1', 'berserkNiveaux_2', 'berserkNiveaux_3'];

buttonNiveauRage.forEach((button) => {
  on(`clicked:${button}`, () => {
    getAttrs(['berserkNiveaux'], (value) => {
      const niveauRage = parseInt(value.berserkNiveaux, 10) || 0;
      let newValue = +button.split('_')[1];

      if (niveauRage === newValue) { newValue = 0; }

      setAttrs({
        berserkNiveaux: newValue,
      });
    });
  });
});

// CAPACITES DRUID + MALDruid

const buttonDruid = ['choixCompanons_aucun', 'choixCompanons_lion', 'choixCompanons_wolf', 'choixCompanons_crow',
  'MALChoixCompanons_aucun', 'MALChoixCompanons_lion', 'MALChoixCompanons_wolf', 'MALChoixCompanons_crow'];

const buttonCompanions = [
  'tabDruidLion_1', 'tabDruidLion_2', 'tabDruidLion_3',
  'tabDruidWolf_3',
  'tabDruidCrow_3',
  'MALTabDruidLion_1', 'MALTabDruidLion_2', 'MALTabDruidLion_3',
  'MALTabDruidWolf_3',
  'MALTabDruidCrow_3'];

const buttonTabCompanions = [
  'tabDCoups-3',
  'repeating_armeDruidLion:tab-1', 'repeating_armeDruidLion:tab-2', 'repeating_armeDruidLion:tab-3',
  'repeating_modulesDCLion:affichagedclion-1', 'repeating_modulesDCLion:slotsdclplus-1',
  'MALTabDCoups-3',
  'repeating_armeMALDruidLion:tab-1', 'repeating_armeMALDruidLion:tab-2', 'repeating_armeMALDruidLion:tab-3',
  'repeating_modulesMALDCLion:affichagemaldclion-1', 'repeating_modulesMALDCLion:slotsmaldclplus-1'];

buttonDruid.forEach((button) => {
  on(`clicked:${button}`, () => {
    const name = button.split('_')[0];
    const newValue = button.split('_')[1];

    const newAttr = {};
    newAttr[name] = newValue;

    setAttrs(newAttr);
  });
});

buttonCompanions.forEach((button) => {
  on(`clicked:${button}`, () => {
    const name = button.split('_')[0];
    let newValue = button.split('_')[1];

    getAttrs([name], (value) => {
      const active = value[name];

      if (active === newValue) { newValue = '0'; }

      const newAttr = {};
      newAttr[name] = newValue;

      setAttrs(newAttr);
    });
  });
});

buttonTabCompanions.forEach((button) => {
  on(`clicked:${button}`, (eventinfo) => {
    const source = eventinfo.sourceAttribute;
    let name = button.split('-')[0];
    let newValue = button.split('-')[1];

    if (source !== undefined) {
      if (source.includes('repeating')) {
        const length = source.split('-').length - 1;
        name = source.slice(0, -2);
        newValue = source.split('-')[length];
      }
    }

    getAttrs([name], (value) => {
      const active = value[name];

      if (active === newValue) { newValue = '0'; }

      const newAttr = {};
      newAttr[name] = newValue;

      setAttrs(newAttr);
    });
  });
});

// CAPACITES PALADIN + MALPaladin

const buttonPaladin = ['paladinCdFShrine', 'paladinWatchtower',
  'MALPaladinCdFShrine'];

buttonPaladin.forEach((button) => {
  on(`clicked:${button}`, () => {
    getAttrs([button], (value) => {
      const active = value[button];
      let newValue = 'Activé';

      if (active === 'Activé' || active === 'Activer') { newValue = ''; }

      const newAttr = {};
      newAttr[button] = newValue;

      setAttrs(newAttr);
    });
  });
});

// CAPACITES PSION

const buttonPsion = ['psionDiscord', 'MALPsionDiscord'];

buttonPsion.forEach((button) => {
  on(`clicked:${button}`, () => {
    getAttrs([button], (value) => {
      const active = value[button];
      let newValue = 'Activé';

      if (active === 'Activé' || active === 'Activer') { newValue = ''; }

      const newAttr = {};
      newAttr[button] = newValue;

      setAttrs(newAttr);
    });
  });
});

// CAPACITES RANGER
const buttonTabLongbow = ['armeDistOptionsRanger-1', 'armeDistOptionsRanger-2'];

buttonTabLongbow.forEach((button) => {
  on(`clicked:${button}`, (eventinfo) => {
    const source = eventinfo.sourceAttribute;
    let name = button.split('-')[0];
    let newValue = button.split('-')[1];

    if (source !== undefined) {
      if (source.includes('repeating')) {
        const length = source.split('-').length - 1;
        name = source.slice(0, -2);
        newValue = source.split('-')[length];
      }
    }

    getAttrs([name], (value) => {
      const active = value[name];

      if (active === newValue) { newValue = '0'; }

      const newAttr = {};
      newAttr[name] = newValue;

      setAttrs(newAttr);
    });
  });
});

// CAPACITES ROGUE

const buttonRogue = ['rogueGhost', 'MALRogueGhost'];

buttonRogue.forEach((button) => {
  on(`clicked:${button}`, () => {
    getAttrs([button], (value) => {
      const active = value[button];
      let newValue = '{{modeGhost=Activé}}';

      if (active === '{{modeGhost=Activé}}') { newValue = ''; }

      const newAttr = {};
      newAttr[button] = newValue;

      setAttrs(newAttr);
    });
  });
});

// CAPACITES SHAMAN

const buttonShaman = ['shamanAscension'];

buttonShaman.forEach((button) => {
  on(`clicked:${button}`, () => {
    getAttrs(['shamanAscension'], (value) => {
      const active = value[button];
      let newValue = '1';

      if (active === '1') { newValue = ''; }

      const newAttr = {};
      newAttr[button] = newValue;

      setAttrs(newAttr);
    });
  });
});

// CAPACITES SORCERER

const buttonSorcerer = ['sorcererMM250PG'];

buttonSorcerer.forEach((button) => {
  on(`clicked:${button}`, () => {
    getAttrs(['sorcererMM250PG'], (value) => {
      const active = value[button];
      let newValue = '1';

      if (active === '1') { newValue = ''; }

      const newAttr = {};
      newAttr[button] = newValue;

      setAttrs(newAttr);
    });
  });
});

// CAPACITES WARLOCK

const buttonWarlock = ['warlockForward', 'warlockRecord', 'warlockRewind', 'MALWarlockRecord', 'MALWarlockRewind'];

buttonWarlock.forEach((button) => {
  on(`clicked:${button}`, () => {
    getAttrs([button], (value) => {
      const active = value[button];
      let newValue = '1';

      if (active === '1') { newValue = ''; }

      const newAttr = {};
      newAttr[button] = newValue;

      setAttrs(newAttr);
    });
  });
});

// CAPACITES WARMASTER

const buttonWarmaster = ['warmasterImpActionC', 'warmasterImpEsquiveC', 'warmasterImpForceC', 'warmasterImpGuerreC', 'warmasterImpEnergieC', 'warmasterImpAPersonnel', 'warmasterImpAction', 'warmasterImpEsquive', 'warmasterImpForce', 'warmasterImpGuerre', 'warmasterImpEnergie',
  'MALWarmasterImpAction', 'MALWarmasterImpEsquive', 'MALWarmasterImpForce', 'MALWarmasterImpGuerre', 'MALWarmasterImpEnergie'];

buttonWarmaster.forEach((button) => {
  on(`clicked:${button}`, () => {
    getAttrs([button], (value) => {
      const active = value[button];
      let newValue = 'on';

      if (active === 'on') { newValue = ''; }

      const newAttr = {};
      newAttr[button] = newValue;

      setAttrs(newAttr);
    });
  });
});

// CAPACITES WARRIOR

const buttonWarrior = ['warriorSoldier', 'warriorHunter', 'warriorScholar', 'warriorHerald', 'warriorScout'];

buttonWarrior.forEach((button) => {
  on(`clicked:${button}`, () => {
    getAttrs([button], (value) => {
      const active = value[button];
      let newValue = 'on';

      if (active === 'on') { newValue = ''; }

      const newAttr = {};
      newAttr[button] = newValue;

      setAttrs(newAttr);
    });
  });
});

// CAPACITES WIZARD

const buttonWizard = ['wizardBorealis'];

buttonWizard.forEach((button) => {
  on(`clicked:${button}`, () => {
    getAttrs([button], (value) => {
      const active = value[button];
      let newValue = 'on';

      if (active === 'on') { newValue = ''; }

      const newAttr = {};
      newAttr[button] = newValue;

      setAttrs(newAttr);
    });
  });
});

// CAPACITES PNJ - CREATURES

const buttonCapacitesSpeciales = ['phase2'];

buttonCapacitesSpeciales.forEach((button) => {
  on(`clicked:${button}`, () => {
    getAttrs([button], (value) => {
      const active = value[button];
      let newValue = '1';

      if (active === '1') { newValue = ''; }

      const newAttr = {};
      newAttr[button] = newValue;

      setAttrs(newAttr);
    });
  });
});

// SUBTAB ONGLET COMBAT
const buttonSubTabCombat = [
  'tabDistance_1', 'tabMelee_2', 'tabAutre_3', 'tabEquipementDefensif_4', 'tabCapaciteArmure_5', 'tabArmesImprovisees_6',
  'poingMACOptions_4',
  'pSContactOptions_1', 'pSContactOptions_2', 'pSContactOptions_3', 'pSContactOptions_4',
  'mEContactOptions_1', 'mEContactOptions_2', 'mEContactOptions_3', 'mEContactOptions_4',
  'repeating_armeCaC:armecontactoptions-1', 'repeating_armeCaC:armecontactoptions-2', 'repeating_armeCaC:armecontactoptions-3', 'repeating_armeCaC:armecontactoptions-4',
  'pSDistOptions_1', 'pSDistOptions_3', 'pSDistOptions_4',
  'mEDistOptions_1', 'mEDistOptions_3', 'mEDistOptions_4',
  'repeating_armeDist:armedistoptions-1', 'repeating_armeDist:armedistoptions-3', 'repeating_armeDist:armedistoptions-4',
  'repeating_armeAutre:armeautreoptions-1', 'repeating_armeAutre:armeautreoptions-3', 'repeating_armeAutre:armeautreoptions-4',
  'grenadeOptions_1'];

buttonSubTabCombat.forEach((button) => {
  on(`clicked:${button}`, (eventInfo) => {
    const source = eventInfo.sourceAttribute;
    let name = button.split('_')[0];
    let newValue = button.split('_')[1];

    if (source !== undefined) {
      if (source.includes('repeating')) {
        const length = source.split('-').length - 1;
        name = source.slice(0, -2);
        newValue = source.split('-')[length];
      }
    }

    getAttrs([name], (value) => {
      const active = value[name];

      if (active === newValue) { newValue = '0'; }

      const newAttr = {};
      newAttr[name] = newValue;

      setAttrs(newAttr);
    });
  });
});

// BOUTON EQUIPE DES PROTECTIONS
const buttonEquipe = [
  'repeating_equipDefensif:porte-1'];

buttonEquipe.forEach((button) => {
  on(`clicked:${button}`, (eventInfo) => {
    const source = eventInfo.sourceAttribute;
    let name = button.split('_')[0];
    let newValue = button.split('_')[1];

    if (source !== undefined) {
      if (source.includes('repeating')) {
        const length = source.split('-').length - 1;
        name = source.slice(0, -2);
        newValue = source.split('-')[length];
      }
    }

    getAttrs([name], (value) => {
      const active = value[name];

      if (active === newValue) { newValue = '0'; }

      const newAttr = {};
      newAttr[name] = newValue;

      setAttrs(newAttr);
    });
  });
});

// BOUTON MODULES
const buttonModules = [
  'repeating_modules:affichage-1', 'repeating_modules:slotsplus-1'];

buttonModules.forEach((button) => {
  on(`clicked:${button}`, (eventinfo) => {
    const source = eventinfo.sourceAttribute;
    let name = button.split('-')[0];
    let newValue = button.split('-')[1];

    if (source !== undefined) {
      if (source.includes('repeating')) {
        const length = source.split('-').length - 1;
        name = source.slice(0, -2);
        newValue = source.split('-')[length];
      }
    }

    getAttrs([name], (value) => {
      const active = value[name];

      if (active === newValue) { newValue = '0'; }

      const newAttr = {};
      newAttr[name] = newValue;

      setAttrs(newAttr);
    });
  });
});

// BOUTON AFFICHER OD
const buttonAfficherOD = [
  'showDepl', 'showFor', 'showEnd', 'showHar', 'showCom', 'showIns', 'showTir', 'showSav', 'showTec', 'showAur', 'showPar', 'showSF', 'showSF', 'showDis', 'showDex', 'showPer'];

buttonAfficherOD.forEach((button) => {
  on(`clicked:${button}`, () => {
    getAttrs([button], (value) => {
      const active = value[button];
      let newValue = 'on';

      if (active === 'on') { newValue = ''; }

      const newAttr = {};
      newAttr[button] = newValue;

      setAttrs(newAttr);
    });
  });
});

// BOUTONS EXPAND HISTORIQUE
const buttonHistorique = [
  'repeating_avantages:expand-1',
  'repeating_inconvénient:expand-1',
  'repeating_blessuresGraves:expand-1',
  'repeating_traumas:expand-1',
];

buttonHistorique.forEach((button) => {
  on(`clicked:${button}`, (eventinfo) => {
    const source = eventinfo.sourceAttribute;
    let name = button.split('-')[0];
    let newValue = button.split('-')[1];

    if (source !== undefined) {
      if (source.includes('repeating')) {
        const length = source.split('-').length - 1;
        name = source.slice(0, -2);
        newValue = source.split('-')[length];
      }
    }

    getAttrs([name], (value) => {
      const active = value[name];

      if (active === newValue) { newValue = '0'; }

      const newAttr = {};
      newAttr[name] = newValue;

      setAttrs(newAttr);
    });
  });
});

// ONGLET VEHICULE
const buttonSubTabVehicule = [
  'repeating_armeDistVehicule:armedistoptions-1', 'repeating_armeDistVehicule:armedistoptions-3', 'repeating_armeDistVehicule:armedistoptions-4'];

buttonSubTabVehicule.forEach((button) => {
  on(`clicked:${button}`, (eventInfo) => {
    const source = eventInfo.sourceAttribute;
    let name = button.split('_')[0];
    let newValue = button.split('_')[1];

    if (source !== undefined) {
      if (source.includes('repeating')) {
        const length = source.split('-').length - 1;
        name = source.slice(0, -2);
        newValue = source.split('-')[length];
      }
    }

    getAttrs([name], (value) => {
      const active = value[name];

      if (active === newValue) { newValue = '0'; }

      const newAttr = {};
      newAttr[name] = newValue;

      setAttrs(newAttr);
    });
  });
});

// ONGLET MECHA-ARMURE
const buttonSubTabMechaArmure = [
  'mechaArmure_archangel', 'mechaArmure_nephilim', 'mechaArmure_demon',
  'tabMechaArmureSpecial_1', 'tabMechaArmureModules_1', 'tabMechaArmureArmes_1', 'tabMechaArmureArmesImprovisees_1'];

buttonSubTabMechaArmure.forEach((button) => {
  on(`clicked:${button}`, () => {
    const name = button.split('_')[0];
    let newValue = button.split('_')[1];

    getAttrs([name], (value) => {
      const active = value[name];

      if (active === newValue) { newValue = '0'; }

      const newAttr = {};
      newAttr[name] = newValue;

      setAttrs(newAttr);
    });
  });
});

const buttonSubTabMAConfiguration = [
  'mechaArmureArchangelConfiguration_1', 'mechaArmureArchangelConfiguration_2',
  'mechaArmureNephilimConfiguration_1', 'mechaArmureNephilimConfiguration_2',
  'mechaArmureDemonConfiguration_1', 'mechaArmureDemonConfiguration_2',
];

buttonSubTabMAConfiguration.forEach((button) => {
  on(`clicked:${button}`, () => {
    const name = button.split('_')[0];
    const newValue = button.split('_')[1];

    const newAttr = {};
    newAttr[name] = newValue;

    setAttrs(newAttr);
  });
});

const buttonSubTabMAActive = [
  'MAAEvacuationActive_1',
  'MAArchangelVolActive_1',
  'MANOGStationActive_1',
  'MANOGSTActive_1',
  'MANOGInvulnerabiliteActive_1',
  'MANephilimSautActive_1',
  'MANephilimEmblemActive_1',
  'MANephilimDronesAirainActive_1',
  'MADABAmritaActive_1',
  'MADDjinnNanobrumeActive_1',
  'MADACSoniqueActive_1',
  'MADemonSautActive_1',
];

buttonSubTabMAActive.forEach((button) => {
  on(`clicked:${button}`, () => {
    const name = button.split('_')[0];
    let newValue = button.split('_')[1];

    getAttrs([name], (value) => {
      const active = value[name];

      if (active === newValue) { newValue = '0'; }

      const newAttr = {};
      newAttr[name] = newValue;

      setAttrs(newAttr);
    });
  });
});

  /* eslint-disable camelcase */
/* eslint-disable no-undef */
on('clicked:domaineArtistique', (info) => {
  const roll = info.htmlAttributes.value;

  const attributs = [
    'jetModifDes',
    'bonusCarac',
    'caracteristique1Art',
    'caracteristique2Art',
    'caracteristique3Art',
    'caracteristique4Art',
  ];

  getAttrs(attributs, (value) => {
    const exec = [];

    const mod = Number(value.jetModifDes);
    const hasBonus = Number(value.bonusCarac);

    const C1 = value.caracteristique1Art;
    const C2 = value.caracteristique2Art;
    const C3 = value.caracteristique3Art;
    const C4 = value.caracteristique4Art;

    const C1Nom = C1.slice(2, -1);
    const C2Nom = C2.slice(2, -1);
    const C3Nom = C3.slice(2, -1);
    const C4Nom = C4.slice(2, -1);

    const cRoll = [];
    const cNom1 = [];
    const cNom2 = [];

    const bonus = [];

    exec.push(roll);

    if (C1 !== '0') {
      cNom1.push(CaracNom[C1Nom]);
      cRoll.push(C1);
    }

    if (C2 !== '0') {
      cNom1.push(CaracNom[C2Nom]);
      cRoll.push(C2);
    }

    if (hasBonus === 1 || hasBonus === 2) {
      if (C3 !== '0') {
        cNom2.push(CaracNom[C3Nom]);
        cRoll.push(C3);
      }
    }

    if (hasBonus === 2) {
      if (C4 !== '0') {
        cNom2.push(CaracNom[C4Nom]);
        cRoll.push(C4);
      }
    }

    exec.push(`{{cBase=${cNom1.join(' - ')}}}`);

    if (hasBonus > 0) { exec.push(`{{cBonus=${cNom2.join(' - ')}}}`); }

    if (mod !== 0) {
      cRoll.push(mod);
      exec.push(`{{mod=[[${mod}]]}}`);
    }

    if (cRoll.length === 0) { cRoll.push(0); }

    exec.push(`{{jet=[[ {[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`);
    exec.push(`{{tBonus=[[${bonus.join('+')}+0]]}}`);
    exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);

    startRoll(exec.join(' '), (results) => {
      const tJet = results.results.jet.result;
      const tBonus = results.results.tBonus.result;
      const tExploit = results.results.Exploit.result;

      const total = tJet + tBonus;

      finishRoll(
        results.rollId,
        {
          jet: total,
        },
      );

      if (tJet !== 0 && tJet === tExploit) {
        startRoll(`${roll}@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${i18n_exploit}}}{{jet=[[ {[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`, (exploit) => {
          const tExploit2 = exploit.results.jet.result;

          finishRoll(
            exploit.rollId,
            {
              jet: tExploit2,
            },
          );
        });
      }
    });
  });
});
  /* eslint-disable camelcase */
/* eslint-disable no-undef */
on('clicked:distanceBard', async (info) => {
  const roll = info.htmlAttributes.value;

  let attributs = [
    'armureLegende',
    'bardAttSpe',
    'devasterAnatheme',
    'bourreauTenebres',
    'equilibreBalance',
  ];

  attributs = attributs.concat(listArmureLegende);
  const attrs = await getAttrsAsync(attributs);

  const exec = [];

  const armureL = attrs.armureLegende;

  const degats = attrs.bardAttSpe;
  const violence = attrs.bardAttSpe;
  const devaste = +attrs.devasterAnatheme;
  const bourreau = +attrs.bourreauTenebres;
  const equilibre = +attrs.equilibreBalance;

  let MALGoliath;
  let MALGhost;
  let MALTypeSoldier;
  let MALTypeHunter;
  let MALTypeHerald;
  let MALTypeScholar;
  let MALTypeScout;

  exec.push(roll);

  switch (armureL) {
    case 'barbarian':
      MALGoliath = Number(attrs.MALBarbarianGoliath);

      if (MALGoliath !== 0) { exec.push(`{{MALGoliath=[[${MALGoliath}]]}}`); }
      break;

    case 'rogue':
      MALGhost = attrs.MALRogueGhost;

      if (MALGhost !== '') { exec.push(`{{MALspecial2=${i18n_ghostActive}}}`); }
      break;

    case 'warrior':
      MALTypeSoldier = attrs.MALWarriorSoldierA;
      MALTypeHunter = attrs.MALWarriorHunterA;
      MALTypeHerald = attrs.MALWarriorHeraldA;
      MALTypeScholar = attrs.MALWarriorScholarA;
      MALTypeScout = attrs.MALWarriorScoutA;

      if (MALTypeSoldier !== 0) { exec.push(`{{MALspecial2=${i18n_typeSoldier}}}`); }

      if (MALTypeHunter !== 0) { exec.push(`{{MALspecial2=${i18n_typeHunter}}}`); }

      if (MALTypeHerald !== 0) { exec.push(`{{MALspecial2=${i18n_typeHerald}}}`); }

      if (MALTypeScholar !== 0) { exec.push(`{{MALspecial2=${i18n_typeScholar}}}`); }

      if (MALTypeScout !== 0) { exec.push(`{{MALspecial2=${i18n_typeScout}}}`); }
      break;

    default:
      MALGoliath = 0;

      MALGhost = '';

      MALTypeSoldier = '';
      MALTypeHunter = '';
      MALTypeHerald = '';
      MALTypeScholar = '';
      MALTypeScout = '';
      break;
  }

  exec.push(`{{degats=[[${degats}]]}}`);
  exec.push(`{{violence=[[${violence}]]}}`);
  exec.push('{{succesConditionnel=true}}');
  exec.push(`{{chocAutomatique=${i18n_choc} 1}}`);
  exec.push(`{{chocAutomatiqueCondition=${i18n_chocAutomatique} < 12}}`);
  exec.push(`{{effets=${i18n_ignoreArmure} / ${i18n_ignoreCDF} / ${i18n_dispersion} 6}}`);

  if (devaste || bourreau || equilibre) {
    const herauts = [];

    if (devaste) { herauts.push(i18n_devasterAnatheme); }
    if (bourreau) { herauts.push(i18n_bourreauTenebres); }
    if (equilibre) { herauts.push(i18n_equilibrerBalance); }

    exec.push(`{{herauts=${herauts.join(' / ')}}}`);
  }

  // ROLL
  const finalRoll = await startRoll(exec.join(' '));

  const rDegats = finalRoll.results.degats.rolls[0].results;
  const rViolence = finalRoll.results.violence.rolls[0].results;

  let tDegats = finalRoll.results.degats.result;
  let tViolence = finalRoll.results.violence.result;

  if (bourreau || equilibre) {
    tDegats = rDegats.reduce((accumulateur, valeurCourante) => {
      let newV = valeurCourante;
      if (newV <= 3) { newV = 4; }

      return accumulateur + newV;
    }, 0);

    tDegats += 6;
  }

  if (devaste || equilibre) {
    tViolence = rViolence.reduce((accumulateur, valeurCourante) => {
      let newV = valeurCourante;
      if (newV <= 3) { newV = 4; }

      return accumulateur + newV;
    }, 0);

    tViolence += 6;
  }

  const computed = {
    degats: tDegats,
    violence: tViolence,
  };

  finishRoll(finalRoll.rollId, computed);
  // ROLL
});
  /* eslint-disable camelcase */
/* eslint-disable no-undef */
const berserkIlluminationRoll = ['berserkIlluminationBlaze', 'berserkIlluminationLantern'];

berserkIlluminationRoll.forEach((button) => {
  on(`clicked:${button}`, async (info) => {
    const roll = info.htmlAttributes.value;

    const attributs = [
      'devasterAnatheme',
      'bourreauTenebres',
      'equilibreBalance',
    ];

    if (button === 'berserkIlluminationBlaze') {
      attributs.push(`${button}Dgts`);
      attributs.push(`${button}Violence`);
      attributs.push(`${button}Portee`);
    }

    if (button === 'berserkIlluminationLantern') {
      attributs.push(`${button}Dgts`);
      attributs.push(`${button}Portee`);
    }

    const attrs = await getAttrsAsync(attributs);
    const exec = [];
    exec.push(roll);

    const dgts = attrs[`${button}Dgts`];
    let violence = 0;
    const portee = attrs[`${button}Portee`];
    const devaste = +attrs.devasterAnatheme;
    const bourreau = +attrs.bourreauTenebres;
    const equilibre = +attrs.equilibreBalance;

    if (button === 'berserkIlluminationBlaze') {
      violence = attrs[`${button}Violence`];
      exec.push(`{{violence=[[${violence}]]}}`);
    }

    if (button === 'berserkIlluminationLantern') {
      exec.push(`{{esperance=${i18n_esperance}}}`);
      exec.push(`{{esperanceConditionD=${i18n_esperanceConditionD}}}`);
      exec.push('{{degatsConditionnel=true}}');
    }

    exec.push(`{{degats=[[${dgts}]]}}`);
    exec.push(`{{portee=${i18n_portee} ${portee}}}`);

    if (devaste || bourreau || equilibre) {
      const herauts = [];

      if (devaste) { herauts.push(i18n_devasterAnatheme); }
      if (bourreau) { herauts.push(i18n_bourreauTenebres); }
      if (equilibre) { herauts.push(i18n_equilibrerBalance); }

      exec.push(`{{herauts=${herauts.join(' / ')}}}`);
    }

    // ROLL
    const finalRoll = await startRoll(exec.join(' '));

    const rDegats = finalRoll.results.degats.rolls[0].results;

    let tDegats = finalRoll.results.degats.result;
    let tViolence = 0;

    if (bourreau || equilibre) {
      tDegats = rDegats.reduce((accumulateur, valeurCourante) => {
        let newV = valeurCourante;
        if (newV <= 3) { newV = 4; }

        return accumulateur + newV;
      }, 0);
    }

    if (finalRoll.results.violence !== undefined) {
      const rViolence = finalRoll.results.violence.rolls[0].results;

      tViolence = finalRoll.results.violence.result;

      if (devaste || equilibre) {
        tViolence = rViolence.reduce((accumulateur, valeurCourante) => {
          let newV = valeurCourante;
          if (newV <= 3) { newV = 4; }

          return accumulateur + newV;
        }, 0);
      }
    }

    const computed = {
      degats: tDegats,
      violence: tViolence,
    };

    finishRoll(finalRoll.rollId, computed);
  });
});

const berserkIlluminationRollSimple = ['berserkIlluminationCandle', 'berserkRageSacrificeEspoir', 'berserkRageN3Dgts',
  'berserkRageHostileHumain', 'berserkRageSalopardHumain', 'berserkRagePatronHumain', 'berserkRageBandeHumain',
  'berserkRageHostileAnathème', 'berserkRageSalopardAnathème', 'berserkRagePatronAnathème', 'berserkRageBandeAnathème'];

berserkIlluminationRollSimple.forEach((button) => {
  on(`clicked:${button}`, (info) => {
    const roll = info.htmlAttributes.value;

    const exec = [];
    exec.push(roll);

    startRoll(exec.join(' '), (results) => {
      finishRoll(
        results.rollId,
        {},
      );
    });
  });
});
  /* eslint-disable prefer-destructuring */
/* eslint-disable camelcase */
/* eslint-disable max-len */
/* eslint-disable no-undef */
const rollCombatAutre = ['repeating_armeautre:armeautrepj', 'repeating_armeautre:armeautrepjvehicule'];

rollCombatAutre.forEach((button) => {
  on(`clicked:${button}`, async (info) => {
    const roll = info.htmlAttributes.value;

    let listAttrs = [];

    const id = info.triggerName.split('_')[2];

    const prefix = `repeating_armeautre_${id}_`;

    const effet = wpnEffects.map((a) => `${prefix}${a}`);
    const effetValue = wpnEffectsValue.map((a) => `${prefix}${a}`);
    const AA = wpnAmeliorationA.map((a) => `${prefix}${a}`);
    const AAValue = wpnAmeliorationAValue.map((a) => `${prefix}${a}`);
    const special = wpnSpecial.map((a) => `${prefix}${a}`);
    const specialValue = wpnSpecialValue.map((a) => `${prefix}${a}`);

    listAttrs.push(`${prefix}ArmeAutre`);
    listAttrs.push(`${prefix}armeAutrePortee`);

    listAttrs.push(`${prefix}armeODAutre`);
    listAttrs.push(`${prefix}armeAttaqueAutre`);

    listAttrs.push(`${prefix}armeAutreDegat`);
    listAttrs.push(`${prefix}armeAutreViolence`);

    listAttrs.push(`${prefix}armeAutreBDegat`);
    listAttrs.push(`${prefix}armeAutreBViolence`);

    listAttrs.push('energieVehicule');

    listAttrs = listAttrs.concat(effet, effetValue, AA, AAValue, special, specialValue);

    const attrs = await getAttrsAsync(listAttrs);

    const name = attrs[`${prefix}ArmeAutre`] || '';
    const portee = attrs[`${prefix}armeAutrePortee`] || '^{portee-contact}';

    let firstExec = [];
    let exec = [];
    firstExec.push(roll);

    firstExec.push(`{{special1=${name}}}`);
    firstExec.push(`{{portee=^{portee} ${portee}}}`);

    let isConditionnelA = false;
    let isConditionnelD = false;
    let isConditionnelV = false;

    const OD = Number(attrs[`${prefix}armeODAutre`]) || 0;

    const cRoll = [
      Number(attrs[`${prefix}armeAttaqueAutre`]) || 0,
    ];

    let bonus = [
      OD,
    ];

    let diceDegats = 0;
    let diceViolence = 0;

    let bDegats = [];
    const bViolence = [];

    diceDegats += Number(attrs[`${prefix}armeAutreDegat`]) || 0;
    diceViolence += Number(attrs[`${prefix}armeAutreViolence`]) || 0;

    bDegats.push(Number(attrs[`${prefix}armeAutreBDegat`]) || 0);
    bViolence.push(Number(attrs[`${prefix}armeAutreBViolence`]) || 0);

    let degats = [];
    let violence = [];

    let attaquesSurprises = [];
    let attaquesSurprisesValue = [];
    let attaquesSurprisesCondition = '';

    let eASAssassin = '';
    let eASAssassinValue = 0;

    let isAssistantAttaque = false;
    let isAntiAnatheme = false;
    let isCadence = false;
    let sCadence = 0;
    let vCadence = 0;
    let isDestructeur = false;
    let vDestructeur = 0;
    let isFureur = false;
    let isMeurtrier = false;
    let vMeurtrier = 0;
    let nowSilencieux = false;
    let isObliteration = false;
    let isTenebricide = false;
    let isTirRafale = false;
    let isChambreDouble = false;
    let isUltraviolence = false;
    let isSurprise = false;

    let isELumiere = false;
    let lumiereValue = 0;

    const energie = attrs.energieVehicule;

    let autresEffets = [];
    let autresAmeliorationsA = [];
    const autresSpecial = [];

    // GESTION DES EFFETS

    const effets = getWeaponsEffectsAutre(prefix, attrs);

    bDegats = bDegats.concat(effets.bDegats);
    eASAssassin = effets.eASAssassin;
    eASAssassinValue = effets.eASAssassinValue;

    if (attaquesSurprisesCondition === '' && effets.attaquesSurprisesCondition !== '') { attaquesSurprisesCondition = effets.attaquesSurprisesCondition; }

    attaquesSurprises = attaquesSurprises.concat(effets.attaquesSurprises);
    attaquesSurprisesValue = attaquesSurprisesValue.concat(effets.attaquesSurprisesValue);

    autresEffets = autresEffets.concat(effets.autresEffets);

    isAntiAnatheme = effets.isAntiAnatheme;

    isAssistantAttaque = effets.isAssistantAttaque;

    isCadence = effets.isCadence;
    sCadence = effets.sCadence;
    vCadence = effets.vCadence;

    isDestructeur = effets.isDestructeur;
    vDestructeur = effets.vDestructeur;

    isMeurtrier = effets.isMeurtrier;
    vMeurtrier = effets.vMeurtrier;

    isFureur = effets.isFureur;

    isUltraviolence = effets.isUltraviolence;

    nowSilencieux = effets.nowSilencieux;

    isTenebricide = effets.isTenebricide;

    isObliteration = effets.isObliteration;
    isTirRafale = effets.isTirRafale;

    isELumiere = effets.isELumiere;
    lumiereValue = Number(effets.eLumiereValue);

    if (effets.isConditionnelA) { isConditionnelA = true; }

    if (effets.isConditionnelD) { isConditionnelD = true; }

    if (effets.isConditionnelV) { isConditionnelV = true; }

    // FIN GESTION DES EFFETS

    // GESTION DES AMELIORATIONS D'ARMES

    const ameliorationsA = getWeaponsAutreAA(prefix, attrs, isAssistantAttaque, eASAssassinValue, isCadence, vCadence, nowSilencieux, isTirRafale, isObliteration, isAntiAnatheme);

    exec = exec.concat(ameliorationsA.exec);

    bonus = bonus.concat(ameliorationsA.bonus);

    diceDegats += ameliorationsA.diceDegats;
    diceViolence += ameliorationsA.diceViolence;

    bDegats = bDegats.concat(ameliorationsA.bDegats);

    attaquesSurprises = attaquesSurprises.concat(ameliorationsA.attaquesSurprises);
    attaquesSurprisesValue = attaquesSurprisesValue.concat(ameliorationsA.attaquesSurprisesValue);

    if (attaquesSurprisesCondition === '') { attaquesSurprisesCondition = ameliorationsA.attaquesSurprisesCondition; }

    if (ameliorationsA.isChambreDouble) {
      isCadence = false;
      isChambreDouble = ameliorationsA.isChambreDouble;
      sCadence = ameliorationsA.rChambreDouble;
    }

    autresEffets = autresEffets.concat(ameliorationsA.autresEffets);
    autresAmeliorationsA = autresAmeliorationsA.concat(ameliorationsA.autresAmeliorations);

    if (ameliorationsA.aASAssassin !== '') {
      eASAssassin = ameliorationsA.aASAssassin;
      eASAssassinValue = ameliorationsA.aASAssassinValue;
    }

    if (ameliorationsA.isConditionnelA) { isConditionnelA = true; }

    if (ameliorationsA.isConditionnelD) { isConditionnelD = true; }

    if (ameliorationsA.isConditionnelV) { isConditionnelV = true; }

    // FIN GESTION DES AMELIORATIONS D'ARMES

    // GESTION DES BONUS SPECIAUX

    const sBonusDegats = isApplied(attrs[`${prefix}BDDiversTotal`]);
    const sBonusDegatsD6 = attrs[`${prefix}BDDiversD6`];
    const sBonusDegatsFixe = attrs[`${prefix}BDDiversFixe`];

    const sBonusViolence = isApplied(attrs[`${prefix}BVDiversTotal`]);
    const sBonusViolenceD6 = attrs[`${prefix}BVDiversD6`];
    const sBonusViolenceFixe = attrs[`${prefix}BVDiversFixe`];

    const sEnergie = isApplied(attrs[`${prefix}energie`]);
    const sEnergieValue = attrs[`${prefix}energieValue`];

    let newEnergie = 0;
    let pasEnergie = false;
    let sEnergieText = '';

    if (sBonusDegats) {
      exec.push(`{{vMSpecialD=+${sBonusDegatsD6}D6+${sBonusDegatsFixe}}}`);
      diceDegats += Number(sBonusDegatsD6);
      bDegats.push(sBonusDegatsFixe);
    }

    if (sBonusViolence) {
      exec.push(`{{vMSpecialV=+${sBonusViolenceD6}D6+${sBonusViolenceFixe}}}`);
      diceViolence += Number(sBonusViolenceD6);
      bViolence.push(sBonusViolenceFixe);
    }

    if (sEnergie) {
      if (button === 'repeating_armeautre:armeautrepjvehicule') {
        autresSpecial.push(`${i18n_energieRetiree} (${sEnergieValue})`);

        newEnergie = Number(energie) - Number(sEnergieValue);

        if (newEnergie === 0) {
          sEnergieText = i18n_plusEnergie;
        } else if (newEnergie < 0) {
          newEnergie = 0;
          sEnergieText = i18n_pasEnergie;
          pasEnergie = true;
        }
      } else { autresSpecial.push(`^{energie} (${sEnergieValue})`); }
    }

    // FIN DE GESTION DES BONUS SPECIAUX

    if (cRoll.length === 0) { cRoll.push(0); }

    if (bonus.length === 0) { bonus.push(0); }

    exec.push('{{OD=true}}');
    exec.push(`{{vOD=${OD}}}`);

    if (diceDegats < 0) { diceDegats = 0; }

    if (diceViolence < 0) { diceViolence = 0; }

    degats.push(`${diceDegats}D6`);
    degats = degats.concat(bDegats);

    violence.push(`${diceViolence}D6`);
    violence = violence.concat(bViolence);

    const jet = `{{jet=[[ {{[[{${cRoll.join('+')}-${sCadence}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0}]]}}`;

    firstExec.push(jet);
    exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);
    exec.push(`{{bonus=[[${bonus.join('+')}]]}}`);

    exec.push(`{{degats=[[${degats.join('+')}]]}}`);
    exec.push(`{{violence=[[${violence.join('+')}]]}}`);

    if (isObliteration) {
      let ASObliteration = [];
      let ASValueObliteration = [];

      diceDegatsObliteration = diceDegats * 6;

      degatsFObliteration = _.reduce(bDegats, (n1, n2) => Number(n1) + Number(n2));

      const vObliteration = diceDegatsObliteration + degatsFObliteration;

      exec.push(`{{obliterationValue=${vObliteration}}}`);

      if (isMeurtrier) { exec.push(`{{obliterationMeurtrierValue=${vMeurtrier * 6}}}`); }

      if (isDestructeur) { exec.push(`{{obliterationDestructeurValue=${vDestructeur * 6}}}`); }

      if (eASAssassinValue > 0) {
        eAssassinTenebricideValue = eASAssassinValue * 6;

        ASObliteration.unshift(eASAssassin);
        ASValueObliteration.unshift(eAssassinTenebricideValue);

        if (attaquesSurprises.length > 0) {
          ASObliteration = ASObliteration.concat(attaquesSurprises);
          ASValueObliteration = ASValueObliteration.concat(attaquesSurprisesValue);
        }

        exec.push(`{{obliterationAS=${ASObliteration.join('\n+')}}}`);
        exec.push(`{{obliterationASValue=${_.reduce(ASValueObliteration, (n1, n2) => n1 + n2, 0)}}}`);
      } else if (attaquesSurprises.length > 0) {
        ASObliteration = ASObliteration.concat(attaquesSurprises);
        ASValueObliteration = ASValueObliteration.concat(attaquesSurprisesValue);

        exec.push(`{{obliterationAS=${ASTenebricide.join('\n+')}}}`);
        exec.push(`{{obliterationASValue=${_.reduce(ASValueObliteration, (n1, n2) => n1 + n2, 0)}}}`);
      }
    }

    if (isCadence) {
      exec.push(`{{rCadence=${i18n_cadence} ${vCadence} ${i18n_inclus}}}`);
      exec.push(`{{vCadence=${sCadence}D}}`);
    }

    if (isChambreDouble) {
      exec.push(`{{rCadence=${i18n_chambreDouble} (${i18n_cadence} 2) ${i18n_inclus}}}`);
      exec.push(`{{vCadence=${sCadence}D}}`);
    }

    if (eASAssassinValue > 0) {
      attaquesSurprises.unshift(eASAssassin);
      attaquesSurprisesValue.unshift(`${eASAssassinValue}D6`);
    }

    if (attaquesSurprises.length > 0) {
      exec.push(`{{attaqueSurprise=${attaquesSurprises.join('\n+')}}}`);
      exec.push(`{{attaqueSurpriseValue=[[${attaquesSurprisesValue.join('+')}]]}}`);
      exec.push(attaquesSurprisesCondition);

      isSurprise = true;
    }

    if (isTenebricide) {
      exec.push(`{{tenebricide=${i18n_tenebricide}}} {{tenebricideConditionD=${i18n_tenebricideConditionD}}} {{tenebricideConditionV=${i18n_tenebricideConditionV}}}`);
      exec.push('{{tenebricideValueD=[[0]]}}');
      exec.push('{{tenebricideValueV=[[0]]}}');

      if (attaquesSurprises.length > 0) {
        exec.push(`{{tenebricideAS=${attaquesSurprises.join('\n+')}}}`);
        exec.push('{{tenebricideASValue=[[0]]}}');
      }

      if (isMeurtrier) { firstExec.push('{{tMeurtrierValue=[[0]]}}'); }
      if (isDestructeur) { firstExec.push('{{tDestructeurValue=[[0]]}}'); }
      if (isFureur) { firstExec.push('{{tFureurValue=[[0]]}}'); }
      if (isUltraviolence) { firstExec.push('{{tUltraviolenceValue=[[0]]}}'); }
    }

    if (isELumiere) { autresEffets.push(`${i18n_lumiere} ${lumiereValue}`); }

    if (autresEffets.length > 0) {
      autresEffets.sort();
      exec.push(`{{effets=${autresEffets.join(' / ')}}}`);
    }

    if (autresAmeliorationsA.length > 0) {
      autresAmeliorationsA.sort();
      exec.push(`{{ameliorations=${autresAmeliorationsA.join(' / ')}}}`);
    }

    if (autresSpecial.length > 0) {
      autresSpecial.sort();
      exec.push(`{{special=${autresSpecial.join(' / ')}}}`);
    }

    if (isConditionnelA) { exec.push('{{succesConditionnel=true}}'); }

    if (isConditionnelD) { exec.push('{{degatsConditionnel=true}}'); }

    if (isConditionnelV) { exec.push('{{violenceConditionnel=true}}'); }

    if (effets.exec) { exec = exec.concat(effets.exec); }

    if (effets.firstExec) { firstExec = firstExec.concat(effets.firstExec); }

    exec = firstExec.concat(exec);

    // ROLL
    let finalRoll;

    if (pasEnergie === false) {
      finalRoll = await startRoll(exec.join(' '));
      const tJet = finalRoll.results.jet.result;

      const tBonus = finalRoll.results.bonus.result;
      const tExploit = finalRoll.results.Exploit.result;

      const rDegats = finalRoll.results.degats.dice;
      const rViolence = finalRoll.results.violence.dice;

      const tDegats = finalRoll.results.degats.result;
      const tViolence = finalRoll.results.violence.result;

      const conditions = {
        isTenebricide,
        isDestructeur,
        isFureur,
        isSurprise,
        isMeurtrier,
        isUltraviolence,
      };

      const computed = updateRoll(finalRoll, tDegats, rDegats, bDegats, tViolence, rViolence, bViolence, conditions);

      const finalComputed = {
        jet: tJet + tBonus,
      };

      Object.assign(finalComputed, computed);

      finishRoll(finalRoll.rollId, finalComputed);

      if (tJet !== 0 && tJet === tExploit) {
        const exploitRoll = await startRoll(`${roll}@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${i18n_exploit}}}${jet}`);
        const tRExploit = exploitRoll.results.jet.result;
        const exploitComputed = {
          jet: tRExploit,
        };

        finishRoll(exploitRoll.rollId, exploitComputed);
      }

      if (sEnergie !== false && button === 'repeating_armeautre:armeautrepjvehicule') {
        setAttrs({ energieVehicule: newEnergie });

        if (newEnergie === 0) {
          const noEnergieRoll = await startRoll(`@{jetGM} &{template:simple} {{Nom=@{name}}} {{text=${sEnergieText}}}${name}`);
          finishRoll(noEnergieRoll.rollId, {});
        }
      }
    } else {
      finalRoll = await startRoll(`@{jetGM} &{template:simple} {{Nom=@{name}}} {{text=${sEnergieText}}}${name}`);
      finishRoll(finalRoll.rollId, {});
    }
  });
});
  /* eslint-disable max-len */
/* eslint-disable prefer-destructuring */
/* eslint-disable camelcase */
/* eslint-disable no-undef */
const rollCombatContact = ['poingContact', 'poingMAContact', 'pSContact', 'mEContact', 'repeating_armeCaC:armecontact'];

rollCombatContact.forEach((button) => {
  on(`clicked:${button}`, async (info) => {
    const roll = info.htmlAttributes.value;
    let id = '';

    let firstExec = [];
    let exec = [];
    firstExec.push(roll);

    let hasArmure = true;
    let hasOptions = true;
    let hasSpecial = true;

    let prefix = '';
    let name = '';
    let portee = '';

    let dEffets = [];
    let dEffetsValue = [];
    let AS = [];
    let AO = [];
    let special = [];
    let specialValue = [];

    let baseDegats = 0;
    let baseViolence = 0;

    let diceDegats = 0;
    let diceViolence = 0;

    let bDegats = [];
    const bViolence = [];

    let listAttrs = [
      'force',
      `${ODValue.force}`,
      'discretion',
      `${ODValue.discretion}`,
      'dexterite',
      `${ODValue.dexterite}`,
      'tir',
      `${ODValue.tir}`,
      'combat',
      `${ODValue.combat}`,
      'energiePJ',
      'espoir',
      'devasterAnatheme',
      'bourreauTenebres',
      'equilibreBalance',
    ];

    listAttrs = listAttrs.concat(listArmure, listArmureLegende, listStyle, listBase);

    switch (button) {
      case 'poingContact':
        name = `{{special1=${i18n_coupPoing}}}`;

        prefix = 'poingC';

        listAttrs.push('poingCcaracteristique1Equipement');
        listAttrs.push('poingCcaracteristique2Equipement');
        listAttrs.push('poingCcaracteristique3Equipement');
        listAttrs.push('poingCcaracteristique4Equipement');

        baseDegats = 0;
        baseViolence = 0;

        diceDegats = 0;
        bDegats.push(0);

        diceViolence = 0;
        bViolence.push(1);

        hasOptions = false;
        hasSpecial = false;
        break;

      case 'poingMAContact':
        name = `{{special1=${i18n_coupPoing}}}`;

        prefix = 'poingMAC';

        special = wpnSpecial.map((a) => `${prefix}${a}`);
        specialValue = wpnSpecialValue.map((a) => `${prefix}${a}`);

        listAttrs.push('poingMACcaracteristique1Equipement');
        listAttrs.push('poingMACcaracteristique2Equipement');
        listAttrs.push('poingMACcaracteristique3Equipement');
        listAttrs.push('poingMACcaracteristique4Equipement');

        listAttrs = listAttrs.concat(special, specialValue);

        baseDegats = 1;
        baseViolence = 0;

        diceDegats = 1;
        bDegats.push(0);

        diceViolence = 0;
        bViolence.push(1);

        hasOptions = false;
        break;

      case 'pSContact':
        name = `{{special1=${i18n_couteauService}}}`;

        prefix = 'pSC';

        dEffets = wpnEffects.map((a) => `${prefix}${a}`);
        dEffetsValue = wpnEffectsValue.map((a) => `${prefix}${a}`);
        AS = wpnAmeliorationS.map((a) => `${prefix}${a}`);
        AO = wpnAmeliorationO.map((a) => `${prefix}${a}`);
        special = wpnSpecial.map((a) => `${prefix}${a}`);
        specialValue = wpnSpecialValue.map((a) => `${prefix}${a}`);

        listAttrs.push('pSCcaracteristique1Equipement');
        listAttrs.push('pSCcaracteristique2Equipement');
        listAttrs.push('pSCcaracteristique3Equipement');
        listAttrs.push('pSCcaracteristique4Equipement');
        listAttrs.push('pSCcaracteristiqueSPrecis');

        listAttrs = listAttrs.concat(dEffets, dEffetsValue, AS, AO, special, specialValue);

        baseDegats = 1;
        baseViolence = 0;

        diceDegats = 1;
        bDegats.push(0);

        diceViolence = 0;
        bViolence.push(1);
        break;

      case 'mEContact':
        name = `{{special1=${i18n_marteauEpieuC}}}`;

        prefix = 'mEC';

        dEffets = wpnEffects.map((a) => `${prefix}${a}`);
        dEffetsValue = wpnEffectsValue.map((a) => `${prefix}${a}`);
        AS = wpnAmeliorationS.map((a) => `${prefix}${a}`);
        AO = wpnAmeliorationO.map((a) => `${prefix}${a}`);
        special = wpnSpecial.map((a) => `${prefix}${a}`);
        specialValue = wpnSpecialValue.map((a) => `${prefix}${a}`);

        listAttrs.push('mECcaracteristique1Equipement');
        listAttrs.push('mECcaracteristique2Equipement');
        listAttrs.push('mECcaracteristique3Equipement');
        listAttrs.push('mECcaracteristique4Equipement');
        listAttrs.push('mECcaracteristiqueSPrecis');

        listAttrs = listAttrs.concat(dEffets, dEffetsValue, AS, AO, special, specialValue);

        baseDegats = 3;
        baseViolence = 1;

        diceDegats = 3;
        bDegats.push(0);

        diceViolence = 1;
        bViolence.push(0);
        break;

      case 'repeating_armeCaC:armecontact':
        id = info.triggerName.split('_')[2];

        prefix = `repeating_armeCaC_${id}_`;

        dEffets = wpnEffects.map((a) => `${prefix}${a}`);
        dEffetsValue = wpnEffectsValue.map((a) => `${prefix}${a}`);
        AS = wpnAmeliorationS.map((a) => `${prefix}${a}`);
        AO = wpnAmeliorationO.map((a) => `${prefix}${a}`);
        special = wpnSpecial.map((a) => `${prefix}${a}`);
        specialValue = wpnSpecialValue.map((a) => `${prefix}${a}`);

        listAttrs.push(`${prefix}caracteristique1Equipement`);
        listAttrs.push(`${prefix}caracteristique2Equipement`);
        listAttrs.push(`${prefix}caracteristique3Equipement`);
        listAttrs.push(`${prefix}caracteristique4Equipement`);
        listAttrs.push(`${prefix}caracteristiqueSPrecis`);

        listAttrs.push(`${prefix}ArmeCaC`);
        listAttrs.push(`${prefix}armeCaCPortee`);

        listAttrs.push(`${prefix}armeCaCDegat`);
        listAttrs.push(`${prefix}armeCaCViolence`);

        listAttrs.push(`${prefix}armeCaCBDegat`);
        listAttrs.push(`${prefix}armeCaCBViolence`);

        listAttrs = listAttrs.concat(dEffets, dEffetsValue, AS, AO, special, specialValue);
        break;

      default:
        name = '';

        prefix = '';

        special = [];
        specialValue = [];

        listAttrs = listAttrs.concat(special, specialValue);

        baseDegats = 0;
        baseViolence = 0;

        diceDegats = 0;
        bDegats.push(0);

        diceViolence = 0;
        bViolence.push(0);

        hasOptions = false;
        break;
    }

    const attrs = await getAttrsAsync(listAttrs);

    const armure = attrs.armure;
    const armureL = attrs.armureLegende;

    const mod = +attrs.jetModifDes;
    const hasBonus = attrs.bonusCarac;

    if (button === 'repeating_armeCaC:armecontact') {
      name = attrs[`${prefix}ArmeCaC`] || '';
      portee = attrs[`${prefix}armeCaCPortee`] || '^{portee-contact}';

      exec.push(`{{special1=${name}}}`);
      exec.push(`{{portee=^{portee} ${portee}}}`);

      baseDegats = Number(attrs[`${prefix}armeCaCDegat`]) || 0;
      baseViolence = Number(attrs[`${prefix}armeCaCViolence`]) || 0;

      diceDegats = Number(attrs[`${prefix}armeCaCDegat`]) || 0;
      bDegats.push(Number(attrs[`${prefix}armeCaCBDegat`]) || 0);

      diceViolence = Number(attrs[`${prefix}armeCaCViolence`]) || 0;
      bViolence.push(Number(attrs[`${prefix}armeCaCBViolence`]) || 0);
    }

    const C1 = attrs[`${prefix}caracteristique1Equipement`] || '0';
    const C2 = attrs[`${prefix}caracteristique2Equipement`] || '0';
    const C3 = attrs[`${prefix}caracteristique3Equipement`] || '0';
    const C4 = attrs[`${prefix}caracteristique4Equipement`] || '0';
    const CPrecis = attrs[`${prefix}caracteristiqueSPrecis`] || '0';

    const attrsCarac = await getCarac(hasBonus, C1, C2, C3, C4, CPrecis);

    const CPrecisValues = {
      nom: '0',
      base: 0,
    };

    if (attrsCarac.CO1) {
      CPrecisValues.nom = attrsCarac.CO1Nom;
      CPrecisValues.base = attrsCarac.CO1Base;
    }

    if (armure === 'sans' || armure === 'guardian') { hasArmure = false; }

    let isConditionnelA = false;
    let isConditionnelD = false;
    let isConditionnelV = false;

    const cBase = [];
    const cBonus = [];
    let cRoll = [];
    let bonus = [];

    let OD = 0;

    let degats = [];
    let violence = [];

    let ODBarbarian = [];
    let ODMALBarbarian = [];
    let ODRogue = [];
    let ODMALRogue = [];
    let ODShaman = [];
    let ODMALShaman = [];
    const ODWarrior = [];
    const ODMALWarrior = [];

    const vForce = +attrs.force;
    const oForce = +attrs[`${ODValue.force}`];
    const vDiscretion = +attrs.discretion;
    const oDiscretion = +attrs[`${ODValue.discretion}`];
    const vDexterite = +attrs.dexterite;
    const oDexterite = +attrs[`${ODValue.dexterite}`];
    const vTir = +attrs.tir;
    const oTir = +attrs[`${ODValue.tir}`];
    const vCombat = +attrs.combat;
    const oCombat = +attrs[`${ODValue.combat}`];

    let attaquesSurprises = [];
    let attaquesSurprisesValue = [];
    let attaquesSurprisesCondition = '';

    let eASAssassin = '';
    let eASAssassinValue = 0;

    let isSurprise = false;
    let isAssistantAttaque = false;
    let isAntiAnatheme = false;
    let isCadence = false;
    let isChromee = false;
    let sCadence = 0;
    let vCadence = 0;
    let isChoc = false;
    let isDestructeur = false;
    let vDestructeur = 0;
    let isLeste = false;
    let isFureur = false;
    let isMeurtrier = false;
    let vMeurtrier = 0;
    let nowSilencieux = false;
    let isObliteration = false;
    let isOrfevrerie = false;
    let isTenebricide = false;
    let isUltraviolence = false;

    let isCheneSculpte = false;
    let vCheneSculpte = 0;
    let isArmeAzurine = false;
    let vArmeAzurine = 0;
    let isArmeRougeSang = false;
    let vArmeRougeSang = 0;
    let isGriffureGravee = false;
    let vGriffureGravee = 0;
    let isMasqueBrise = false;
    let vMasqueBrise = 0;
    let isRouagesCasses = false;
    let vRouagesCasses = 0;

    let lumiere = '';
    let isELumiere = false;
    let isASLumiere = false;
    let lumiereValue = 0;

    let isEAkimbo = false;
    let isEAmbidextrie = false;
    let isELourd = false;
    let isEDeuxMains = false;

    let isAAgressive = false;
    let isASoeur = false;
    let isAJumelle = false;
    let isAProtectrice = false;
    let isAAllegee = false;

    let pasEnergie = false;
    let sEnergieText = '';
    const energie = attrs.energiePJ;
    const espoir = attrs.espoir;

    const devaste = +attrs.devasterAnatheme;
    const bourreau = +attrs.bourreauTenebres;
    const equilibre = +attrs.equilibreBalance;

    let autresEffets = [];
    let autresAmeliorationsS = [];
    let autresAmeliorationsO = [];
    const autresSpecial = [];

    if (hasArmure) { exec.push('{{OD=true}}'); }

    let C1Nom = '';
    let C2Nom = '';
    let C3Nom = '';
    let C4Nom = '';

    if (attrsCarac.C1) {
      C1Nom = attrsCarac.C1Brut;

      const C1Value = attrsCarac.C1Base;
      const C1OD = attrsCarac.C1OD;

      cBase.push(attrsCarac.C1Nom);
      cRoll.push(C1Value);

      if (hasArmure) { OD += C1OD; }
    }

    if (attrsCarac.C2) {
      C2Nom = attrsCarac.C2Brut;

      const C2Value = attrsCarac.C2Base;
      const C2OD = attrsCarac.C2OD;

      cBase.push(attrsCarac.C2Nom);
      cRoll.push(C2Value);

      if (hasArmure) { OD += C2OD; }
    }

    if (attrsCarac.C3) {
      C3Nom = attrsCarac.C3Brut;

      const C3Value = attrsCarac.C3Base;
      const C3OD = attrsCarac.C3OD;

      cBonus.push(attrsCarac.C3Nom);
      cRoll.push(C3Value);

      if (hasArmure) { OD += C3OD; }
    }

    if (attrsCarac.C4) {
      C4Nom = attrsCarac.C4Brut;

      const C4Value = attrsCarac.C4Base;
      const C4OD = attrsCarac.C4OD;

      cBonus.push(attrsCarac.C4Nom);
      cRoll.push(C4Value);

      if (hasArmure) { OD += C4OD; }
    }

    if (mod !== 0) {
      cRoll.push(mod);
      exec.push(`{{mod=${mod}}}`);
    }

    // GESTION DES BONUS DE BASE
    let dForce = vForce;

    if (hasArmure) { dForce += oForce * 3; }

    bDegats.push(dForce);
    exec.push(`{{vForce=${dForce}}}`);

    // FIN GESTION DES BONUS DE BASE

    // GESTION DES BONUS DES OD
    if (oDiscretion >= 2 && hasArmure) {
      let bODDiscretion = vDiscretion;
      attaquesSurprises.push(i18n_odDiscretion);

      if (oDiscretion >= 5) { bODDiscretion += vDiscretion + oDiscretion; }

      attaquesSurprisesValue.push(bODDiscretion);
      attaquesSurprisesCondition = `{{attaqueSurpriseCondition=${i18n_attaqueSurpriseCondition}}}`;
    }
    // FIN DE GESTION DES BONUS DES OD
    let effets = [];
    let ameliorationsS = [];
    let ameliorationsO = [];

    if (hasOptions) {
      // GESTION DES EFFETS

      effets = getWeaponsEffects(prefix, attrs, hasArmure, armure, vForce, vDexterite, oDexterite, vDiscretion, oDiscretion, vTir, oTir);

      bDegats = bDegats.concat(effets.bDegats);
      eASAssassin = effets.eASAssassin;
      eASAssassinValue = effets.eASAssassinValue;

      if (attaquesSurprisesCondition === '' && effets.attaquesSurprisesCondition !== '') { attaquesSurprisesCondition = effets.attaquesSurprisesCondition; }

      attaquesSurprises = attaquesSurprises.concat(effets.attaquesSurprises);
      attaquesSurprisesValue = attaquesSurprisesValue.concat(effets.attaquesSurprisesValue);

      autresEffets = autresEffets.concat(effets.autresEffets);

      isAntiAnatheme = effets.isAntiAnatheme;

      isAssistantAttaque = effets.isAssistantAttaque;

      isCadence = effets.isCadence;
      sCadence = effets.sCadence;
      vCadence = effets.vCadence;

      isChoc = effets.isChoc;

      isDestructeur = effets.isDestructeur;
      vDestructeur = effets.vDestructeur;

      isEDeuxMains = effets.isDeuxMains;
      isELourd = effets.isLourd;

      isLeste = effets.isLeste;

      isMeurtrier = effets.isMeurtrier;
      vMeurtrier = effets.vMeurtrier;

      nowSilencieux = effets.nowSilencieux;

      isOrfevrerie = effets.isOrfevrerie;

      isTenebricide = effets.isTenebricide;

      isObliteration = effets.isObliteration;

      isFureur = effets.isFureur;

      isUltraviolence = effets.isUltraviolence;

      lumiere = effets.eLumiere;
      isELumiere = effets.isELumiere;
      lumiereValue = Number(effets.eLumiereValue);

      isEAkimbo = effets.isAkimbo;
      isEAmbidextrie = effets.isAmbidextrie;

      if (effets.isConditionnelA) { isConditionnelA = true; }

      if (effets.isConditionnelD) { isConditionnelD = true; }

      if (effets.isConditionnelV) { isConditionnelV = true; }

      // FIN GESTION DES EFFETS

      // GESTION DES AMELIORATIONS STRUCTURELLES

      ameliorationsS = getWeaponsContactAS(prefix, attrs, hasArmure, nowSilencieux, isMeurtrier, isAssistantAttaque, isChoc, isLeste, isOrfevrerie, vForce, vDexterite, oDexterite, vDiscretion, oDiscretion, vCombat, oCombat);

      autresAmeliorationsS = autresAmeliorationsS.concat(ameliorationsS.autresAmeliorations);

      bonus = bonus.concat(ameliorationsS.bAttaque);
      baseDegats += ameliorationsS.diceDegats;
      diceDegats += ameliorationsS.diceDegats;
      bDegats = bDegats.concat(ameliorationsS.bDegats);

      isAAgressive = ameliorationsS.isAgressive;
      isASoeur = ameliorationsS.isSoeur;
      isAProtectrice = ameliorationsS.isProtectrice;
      isAJumelle = ameliorationsS.isJumelle;
      isAAllegee = ameliorationsS.isAllegee;

      if (lumiereValue >= ameliorationsS.aLumiereValue) { autresAmeliorationsS.push(ameliorationsS.aLumiere); } else if (ameliorationsS.aLumiereValue > 0) {
        lumiere = `${ameliorationsS.aLumiere} (${i18n_lumiere} ${ameliorationsS.aLumiereValue})`;
        lumiereValue = ameliorationsS.aLumiereValue;
        isASLumiere = true;
        isELumiere = false;
      }

      if (attaquesSurprisesCondition === '' && ameliorationsS.attaquesSurprisesCondition !== '') { attaquesSurprisesCondition = ameliorationsS.attaquesSurprisesCondition; }

      attaquesSurprises = attaquesSurprises.concat(ameliorationsS.attaquesSurprises);
      attaquesSurprisesValue = attaquesSurprisesValue.concat(ameliorationsS.attaquesSurprisesValue);

      if (ameliorationsS.isConditionnelA) { isConditionnelA = true; }

      if (ameliorationsS.isConditionnelD) { isConditionnelD = true; }

      if (ameliorationsS.isConditionnelV) { isConditionnelV = true; }

      // FIN GESTION DES AMELIORATIONS STRUCTURELLES

      // GESTION DES AMELIORATIONS ORNEMENTALES

      ameliorationsO = getWeaponsContactAO(prefix, attrs, isCadence, vCadence, isObliteration, isAntiAnatheme);

      if (ameliorationsO.isChromee) {
        sCadence = ameliorationsO.rCadence;
        isChromee = ameliorationsO.isChromee;
        vCadence = ameliorationsO.vCadence;
      }

      if (lumiereValue >= ameliorationsO.aLumiereValue) {
        lumiereValue += Number(ameliorationsO.aLumiereValue);
        autresAmeliorationsO.push(ameliorationsO.aLumiere);
      } else {
        lumiere = `${ameliorationsO.aLumiere} (${i18n_lumiere} ${ameliorationsO.aLumiereValue})`;
        lumiereValue = ameliorationsO.aLumiereValue;
      }

      if (isObliteration === false) { isObliteration = ameliorationsO.isObliteration; }

      if (ameliorationsO.isConditionnelA) { isConditionnelA = true; }

      if (ameliorationsO.isConditionnelD) { isConditionnelD = true; }

      if (ameliorationsO.isConditionnelV) { isConditionnelV = true; }

      isArmeAzurine = ameliorationsO.isArmeAzurine;
      vArmeAzurine = ameliorationsO.vArmeAzurine;
      isArmeRougeSang = ameliorationsO.isArmeRougeSang;
      vArmeRougeSang = ameliorationsO.vArmeRougeSang;
      isCheneSculpte = ameliorationsO.isCheneSculpte;
      vCheneSculpte = ameliorationsO.vCheneSculpte;
      isGriffureGravee = ameliorationsO.isGriffureGravee;
      vGriffureGravee = ameliorationsO.vGriffureGravee;
      isMasqueBrise = ameliorationsO.isMasqueBrise;
      vMasqueBrise = ameliorationsO.vMasqueBrise;
      isRouagesCasses = ameliorationsO.isRouagesCasses;
      vRouagesCasses = ameliorationsO.vRouagesCasses;

      autresAmeliorationsO = autresAmeliorationsO.concat(ameliorationsO.autresAmeliorations);

      baseDegats += ameliorationsO.diceDegats;
      baseViolence += ameliorationsO.diceViolence;

      diceDegats += ameliorationsO.diceDegats;
      bDegats = bDegats.concat(ameliorationsO.bDegats);
      diceViolence += ameliorationsO.diceViolence;

      // FIN GESTION DES AMELIORATIONS ORNEMENTALES
    } else if (armure === 'berserk') {
      isConditionnelD = true;
      isConditionnelV = true;

      exec.push(`{{antiAnatheme=${i18n_antiAnatheme}}} {{antiAnathemeCondition=${i18n_antiAnathemeCondition}}}`);

      isAntiAnatheme = true;
      isTenebricide = true;
    }

    // GESTION DU STYLE

    const getStyle = getStyleContactMod(attrs, CPrecisValues, baseDegats, baseViolence, hasArmure, oCombat, isEAkimbo, isEAmbidextrie, isAAgressive, isAJumelle, isASoeur, isAProtectrice, isEDeuxMains, isAAllegee, isELourd);

    exec = exec.concat(getStyle.exec);
    cRoll = cRoll.concat(getStyle.cRoll);
    diceDegats += getStyle.diceDegats;
    diceViolence += getStyle.diceViolence;
    autresAmeliorationsS = autresAmeliorationsS.concat(getStyle.autresAmeliorationsS);

    // FIN GESTION DU STYLE
    let sEnergie = false;
    let newEnergie = 0;

    if (hasSpecial) {
      // GESTION DES BONUS SPECIAUX

      const sBonusDegats = isApplied(attrs[`${prefix}BDDiversTotal`]);
      const sBonusDegatsD6 = attrs[`${prefix}BDDiversD6`];
      const sBonusDegatsFixe = attrs[`${prefix}BDDiversFixe`];

      const sBonusViolence = isApplied(attrs[`${prefix}BVDiversTotal`]);
      const sBonusViolenceD6 = attrs[`${prefix}BVDiversD6`];
      const sBonusViolenceFixe = attrs[`${prefix}BVDiversFixe`];

      if (button !== 'poingMAContact') { sEnergie = isApplied(attrs[`${prefix}energie`]); }

      const sEnergieValue = attrs[`${prefix}energieValue`];

      if (sBonusDegats) {
        exec.push(`{{vMSpecialD=+${sBonusDegatsD6}D6+${sBonusDegatsFixe}}}`);
        diceDegats += Number(sBonusDegatsD6);
        bDegats.push(sBonusDegatsFixe);
      }

      if (sBonusViolence) {
        exec.push(`{{vMSpecialV=+${sBonusViolenceD6}D6+${sBonusViolenceFixe}}}`);
        diceViolence += Number(sBonusViolenceD6);
        bViolence.push(sBonusViolenceFixe);
      }

      if (sEnergie) {
        if (armure === 'berserk') {
          let sEspoirValue = Math.floor((Number(sEnergieValue) / 2) - 1);

          if (sEspoirValue < 1) { sEspoirValue = 1; }

          autresSpecial.push(`${i18n_espoirRetire} (${sEspoirValue})`);

          newEnergie = Number(espoir) - Number(sEspoirValue);

          if (newEnergie === 0) {
            sEnergieText = i18n_plusEspoir;
          } else if (newEnergie < 0) {
            newEnergie = 0;
            sEnergieText = i18n_pasEspoir;
            pasEnergie = true;
          }
        } else {
          autresSpecial.push(`${i18n_energieRetiree} (${sEnergieValue})`);

          newEnergie = Number(energie) - Number(sEnergieValue);

          if (newEnergie === 0) {
            sEnergieText = i18n_plusEnergie;
          } else if (newEnergie < 0) {
            newEnergie = 0;
            sEnergieText = i18n_pasEnergie;
            pasEnergie = true;
          }
        }

        exec.push(`{{energieR=${newEnergie}}}`);
      }

      // FIN DE GESTION DES BONUS SPECIAUX
    }

    // GESTION DES BONUS D'ARMURE

    const armorBonus = getArmorBonus(attrs, armure, isELumiere, isASLumiere, vDiscretion, oDiscretion, hasBonus, C1Nom, C2Nom, C3Nom, C4Nom, autresEffets);

    exec = exec.concat(armorBonus.exec);
    cRoll = cRoll.concat(armorBonus.cRoll);

    diceDegats += Number(armorBonus.diceDegats);
    bDegats = bDegats.concat(armorBonus.bDegats);
    diceViolence += Number(armorBonus.diceViolence);

    ODBarbarian = ODBarbarian.concat(armorBonus.ODBarbarian);
    ODRogue = ODRogue.concat(armorBonus.ODRogue);
    ODShaman = ODShaman.concat(armorBonus.ODShaman);
    ODWarrior.push(armorBonus.ODWarrior);

    autresEffets = autresEffets.concat(armorBonus.autresEffets);

    const MALBonus = getMALBonus(attrs, armureL, isELumiere, isASLumiere, vDiscretion, oDiscretion, hasBonus, C1Nom, C2Nom, C3Nom, C4Nom, autresEffets);

    exec = exec.concat(MALBonus.exec);
    cRoll = cRoll.concat(MALBonus.cRoll);

    diceDegats += Number(MALBonus.diceDegats);
    bDegats = bDegats.concat(MALBonus.bDegats);
    diceViolence += Number(MALBonus.diceViolence);

    ODMALBarbarian = ODMALBarbarian.concat(MALBonus.ODMALBarbarian);
    ODMALRogue = ODMALRogue.concat(MALBonus.ODMALRogue);
    ODMALShaman = ODMALShaman.concat(MALBonus.ODMALShaman);
    ODMALWarrior.push(MALBonus.ODMALWarrior);

    autresEffets = autresEffets.concat(MALBonus.autresEffets);

    // FIN GESTION DES BONUS D'ARMURE
    OD -= armorBonus.ODWarrior;
    OD -= MALBonus.ODMALWarrior;

    exec.push(`{{vOD=${OD}}}`);

    if (cRoll.length === 0) { cRoll.push(0); }

    if (bonus.length === 0) { bonus.push(0); }

    bonus = bonus.concat(OD);
    bonus = bonus.concat(ODBarbarian);
    bonus = bonus.concat(ODMALBarbarian);
    bonus = bonus.concat(ODRogue);
    bonus = bonus.concat(ODMALRogue);
    bonus = bonus.concat(ODShaman);
    bonus = bonus.concat(ODMALShaman);
    bonus = bonus.concat(ODWarrior);
    bonus = bonus.concat(ODMALWarrior);

    if (diceDegats < 0) { diceDegats = 0; }

    if (diceViolence < 0) { diceViolence = 0; }

    degats.push(`${diceDegats}D6`);
    degats = degats.concat(bDegats);

    violence.push(`${diceViolence}D6`);
    violence = violence.concat(bViolence);

    if (cBase.length !== 0) { exec.push(`{{cBase=${cBase.join(' - ')}}}`); }

    if (cBonus.length !== 0) { exec.push(`{{cBonus=${cBonus.join(' - ')}}}`); }

    const jet = `{{jet=[[ {{[[{${cRoll.join('+')}-${sCadence}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0}]]}}`;

    firstExec.push(jet);
    exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);
    exec.push(`{{bonus=[[${bonus.join('+')}]]}}`);

    exec.push(`{{degats=[[${degats.join('+')}]]}}`);
    exec.push(`{{violence=[[${violence.join('+')}]]}}`);

    if (isObliteration) {
      let ASObliteration = [];
      let ASValueObliteration = [];

      diceDegatsObliteration = diceDegats * 6;

      degatsFObliteration = _.reduce(bDegats, (n1, n2) => Number(n1) + Number(n2));

      const vObliteration = diceDegatsObliteration + degatsFObliteration;

      exec.push(`{{obliterationValue=${vObliteration}}}`);

      if (isMeurtrier) { exec.push(`{{obliterationMeurtrierValue=${vMeurtrier * 6}}}`); }

      if (isDestructeur) { exec.push(`{{obliterationDestructeurValue=${vDestructeur * 6}}}`); }

      if (eASAssassinValue > 0) {
        eAssassinTenebricideValue = eASAssassinValue * 6;

        ASObliteration.unshift(eASAssassin);
        ASValueObliteration.unshift(eAssassinTenebricideValue);

        if (attaquesSurprises.length > 0) {
          ASObliteration = ASObliteration.concat(attaquesSurprises);
          ASValueObliteration = ASValueObliteration.concat(attaquesSurprisesValue);
        }

        exec.push(`{{obliterationAS=${ASObliteration.join('\n+')}}}`);
        exec.push(`{{obliterationASValue=${_.reduce(ASValueObliteration, (n1, n2) => n1 + n2, 0)}}}`);
      } else if (attaquesSurprises.length > 0) {
        ASObliteration = ASObliteration.concat(attaquesSurprises);
        ASValueObliteration = ASValueObliteration.concat(attaquesSurprisesValue);

        exec.push(`{{obliterationAS=${attaquesSurprises.join('\n+')}}}`);
        exec.push(`{{obliterationASValue=${_.reduce(ASValueObliteration, (n1, n2) => n1 + n2, 0)}}}`);
      }

      if (isArmeAzurine) { exec.push(`{{obliterationArmeAzurineValue=${vArmeAzurine * 6}}}`); }

      if (isArmeRougeSang) { exec.push(`{{obliterationArmeRougeSangValue=${vArmeRougeSang * 6}}}`); }

      if (isCheneSculpte) { exec.push(`{{obliterationCheneSculpteValue=${vCheneSculpte * 6}}}`); }

      if (isGriffureGravee) { exec.push(`{{obliterationGriffureGraveeValue=${vGriffureGravee * 6}}}`); }

      if (isMasqueBrise) { exec.push(`{{obliterationMasqueBriseValue=${vMasqueBrise * 6}}}`); }

      if (isRouagesCasses) { exec.push(`{{obliterationRouagesCassesValue=${vRouagesCasses * 6}}}`); }
    }

    if (isCadence) {
      exec.push(`{{rCadence=${i18n_cadence} ${vCadence} ${i18n_inclus}}}`);
      exec.push(`{{vCadence=${sCadence}D}}`);
    }

    if (isChromee) {
      exec.push(`{{rCadence=${i18n_chromee} (${i18n_cadence} ${vCadence}) ${i18n_inclus}}}`);
      exec.push(`{{vCadence=${sCadence}D}}`);
    }

    if (eASAssassinValue > 0) {
      attaquesSurprises.unshift(eASAssassin);
      attaquesSurprisesValue.unshift(`${eASAssassinValue}D6`);
    }

    if (attaquesSurprises.length > 0) {
      exec.push(`{{attaqueSurprise=${attaquesSurprises.join('\n+')}}}`);
      exec.push(`{{attaqueSurpriseValue=[[${attaquesSurprisesValue.join('+')}]]}}`);
      exec.push(attaquesSurprisesCondition);
      isSurprise = true;
    }

    if (isTenebricide) {
      exec.push(`{{tenebricide=${i18n_tenebricide}}} {{tenebricideConditionD=${i18n_tenebricideConditionD}}} {{tenebricideConditionV=${i18n_tenebricideConditionV}}}`);
      exec.push('{{tenebricideValueD=[[0]]}}');
      exec.push('{{tenebricideValueV=[[0]]}}');

      if (attaquesSurprises.length > 0) {
        exec.push(`{{tenebricideAS=${attaquesSurprises.join('\n+')}}}`);
        exec.push('{{tenebricideASValue=[[0]]}}');
      }

      if (isMeurtrier) { firstExec.push('{{tMeurtrierValue=[[0]]}}'); }
      if (isDestructeur) { firstExec.push('{{tDestructeurValue=[[0]]}}'); }
      if (isFureur) { firstExec.push('{{tFureurValue=[[0]]}}'); }
      if (isUltraviolence) { firstExec.push('{{tUltraviolenceValue=[[0]]}}'); }
      if (isCheneSculpte) { firstExec.push('{{tCheneSculpteValue=[[0]]}}'); }
    }

    if (isELumiere) { autresEffets.push(`${i18n_lumiere} ${lumiereValue}`); } else if (isASLumiere) { autresAmeliorationsS.push(lumiere); }

    if (autresEffets.length > 0) {
      autresEffets.sort();
      exec.push(`{{effets=${autresEffets.join(' / ')}}}`);
    }

    if (autresAmeliorationsS.length > 0) {
      autresAmeliorationsS.sort();
      exec.push(`{{ameliorationsS=${autresAmeliorationsS.join(' / ')}}}`);
    }

    if (autresAmeliorationsO.length > 0) {
      autresAmeliorationsO.sort();
      exec.push(`{{ameliorationsO=${autresAmeliorationsO.join(' / ')}}}`);
    }

    if (autresSpecial.length > 0) {
      autresSpecial.sort();
      exec.push(`{{special=${autresSpecial.join(' / ')}}}`);
    }

    if (isConditionnelA) { exec.push('{{succesConditionnel=true}}'); }

    if (isConditionnelD) { exec.push('{{degatsConditionnel=true}}'); }

    if (isConditionnelV) { exec.push('{{violenceConditionnel=true}}'); }

    if (hasOptions) {
      if (effets.exec) { exec = exec.concat(effets.exec); }

      if (effets.firstExec) { firstExec = firstExec.concat(effets.firstExec); }

      if (ameliorationsS.exec) { exec = exec.concat(ameliorationsS.exec); }

      if (ameliorationsO.exec) { exec = exec.concat(ameliorationsO.exec); }

      if (ameliorationsO.firstExec) { firstExec = firstExec.concat(ameliorationsO.firstExec); }
    }

    if (devaste || bourreau || equilibre) {
      const herauts = [];

      if (devaste) { herauts.push(i18n_devasterAnatheme); }
      if (bourreau) { herauts.push(i18n_bourreauTenebres); }
      if (equilibre) { herauts.push(i18n_equilibrerBalance); }

      exec.push(`{{herauts=${herauts.join(' / ')}}}`);
    }

    exec = firstExec.concat(exec);

    // ROLL
    let finalRoll;

    if (pasEnergie === false) {
      finalRoll = await startRoll(exec.join(' '));
      const rDegats = finalRoll.results.degats.dice;
      const rViolence = finalRoll.results.violence.dice;

      const tJet = finalRoll.results.jet.result;

      const tBonus = finalRoll.results.bonus.result;
      const tExploit = finalRoll.results.Exploit.result;

      const tDegats = finalRoll.results.degats.result;
      const tViolence = finalRoll.results.violence.result;

      const conditions = {
        bourreau,
        devaste,
        equilibre,
        isTenebricide,
        isSurprise,
        isDestructeur,
        isFureur,
        isMeurtrier,
        isUltraviolence,
        isArmeAzurine,
        isArmeRougeSang,
        isCheneSculpte,
        isGriffureGravee,
        isMasqueBrise,
        isRouagesCasses,
      };

      const computed = updateRoll(finalRoll, tDegats, rDegats, bDegats, tViolence, rViolence, bViolence, conditions);

      const finalComputed = {
        jet: tJet + tBonus,
      };

      Object.assign(finalComputed, computed);

      finishRoll(finalRoll.rollId, finalComputed);

      if (tJet !== 0 && tJet === tExploit) {
        const exploitRoll = await startRoll(`${roll}@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${i18n_exploit}}}${jet}`);
        const tRExploit = exploitRoll.results.jet.result;

        const exploitComputed = {
          jet: tRExploit,
        };

        finishRoll(exploitRoll.rollId, exploitComputed);
      }

      if (sEnergie !== false) {
        if (armure === 'berserk') {
          setAttrs({ espoir: newEnergie });
        } else {
          setAttrs({ energiePJ: newEnergie });
        }

        if (newEnergie === 0) {
          const noEnergieRoll = await startRoll(`@{jetGM} &{template:simple} {{Nom=@{name}}} {{text=${sEnergieText}}}${name}`);
          finishRoll(noEnergieRoll.rollId, {});
        }
      }
    } else if (button === 'repeating_armeCaC:armecontact') {
      finalRoll = await startRoll(`@{jetGM} &{template:simple} {{Nom=@{name}}} {{text=${sEnergieText}}}${name}`);
      finishRoll(finalRoll.rollId, {});
    } else {
      finalRoll = await startRoll(`@{jetGM} &{template:simple} {{Nom=@{name}}} {{text=${sEnergieText}}}${name}`);
      finishRoll(finalRoll.rollId, {});
    }
  });
  // ROLL
});
  /* eslint-disable max-len */
/* eslint-disable prefer-destructuring */
/* eslint-disable camelcase */
/* eslint-disable no-undef */
const rollCombatDistance = ['pSDistance', 'mEDistance', 'repeating_armeDist:armedistance', 'repeating_armeDistVehicule:armedistance'];

rollCombatDistance.forEach((button) => {
  on(`clicked:${button}`, async (info) => {
    const roll = info.htmlAttributes.value;

    let firstExec = [];
    let exec = [];
    firstExec.push(roll);

    let hasArmure = true;

    let listAttrs = [
      'espoir',
      'energiePJ',
      'force',
      'discretion',
      `${ODValue.discretion}`,
      'dexterite',
      `${ODValue.dexterite}`,
      'tir',
      `${ODValue.tir}`,
      'devasterAnatheme',
      'bourreauTenebres',
      'equilibreBalance',
    ];

    listAttrs = listAttrs.concat(listArmure, listArmureLegende, listStyle, listBase);

    let prefix = '';
    let id = '';
    let name = '';
    let portee = '';

    let dEffets = [];
    let dEffetsValue = [];
    let AA = [];
    let AAValue = [];
    let special = [];
    let specialValue = [];

    let baseDegats = 0;
    let baseViolence = 0;

    let diceDegats = 0;
    let diceViolence = 0;

    let bDegats = [];
    const bViolence = [];

    switch (button) {
      case 'pSDistance':
        name = i18n_pistoletService;

        prefix = 'pS';

        dEffets = wpnEffects.map((a) => `${prefix}${a}`);
        dEffetsValue = wpnEffectsValue.map((a) => `${prefix}${a}`);
        AA = wpnAmeliorationA.map((a) => `${prefix}${a}`);
        AAValue = wpnAmeliorationAValue.map((a) => `${prefix}${a}`);
        special = wpnSpecial.map((a) => `${prefix}${a}`);
        specialValue = wpnSpecialValue.map((a) => `${prefix}${a}`);

        listAttrs.push('pScaracteristique1Equipement');
        listAttrs.push('pScaracteristique2Equipement');
        listAttrs.push('pScaracteristique3Equipement');
        listAttrs.push('pScaracteristique4Equipement');
        listAttrs.push('pSpilonnage');
        listAttrs.push('pSpilonnageType');

        baseDegats = 2;
        baseViolence = 1;

        diceDegats = 2;
        bDegats.push(6);

        diceViolence = 1;
        bViolence.push(0);

        listAttrs = listAttrs.concat(dEffets, dEffetsValue, AA, AAValue, special, specialValue);
        break;

      case 'mEDistance':
        name = i18n_marteauEpieuD;

        prefix = 'mE';

        dEffets = wpnEffects.map((a) => `${prefix}${a}`);
        dEffetsValue = wpnEffectsValue.map((a) => `${prefix}${a}`);
        AA = wpnAmeliorationA.map((a) => `${prefix}${a}`);
        AAValue = wpnAmeliorationAValue.map((a) => `${prefix}${a}`);
        special = wpnSpecial.map((a) => `${prefix}${a}`);
        specialValue = wpnSpecialValue.map((a) => `${prefix}${a}`);

        listAttrs.push('mEcaracteristique1Equipement');
        listAttrs.push('mEcaracteristique2Equipement');
        listAttrs.push('mEcaracteristique3Equipement');
        listAttrs.push('mEcaracteristique4Equipement');
        listAttrs.push('mEpilonnage');
        listAttrs.push('mEpilonnageType');

        baseDegats = 3;
        baseViolence = 3;

        diceDegats = 3;
        bDegats.push(12);

        diceViolence = 3;
        bViolence.push(12);

        listAttrs = listAttrs.concat(dEffets, dEffetsValue, AA, AAValue, special, specialValue);
        break;

      case 'repeating_armeDist:armedistance':
        id = info.triggerName.split('_')[2];

        prefix = `repeating_armeDist_${id}_`;

        dEffets = wpnEffects.map((a) => `${prefix}${a}`);
        dEffetsValue = wpnEffectsValue.map((a) => `${prefix}${a}`);
        AA = wpnAmeliorationA.map((a) => `${prefix}${a}`);
        AAValue = wpnAmeliorationAValue.map((a) => `${prefix}${a}`);
        special = wpnSpecial.map((a) => `${prefix}${a}`);
        specialValue = wpnSpecialValue.map((a) => `${prefix}${a}`);

        listAttrs.push(`${prefix}caracteristique1Equipement`);
        listAttrs.push(`${prefix}caracteristique2Equipement`);
        listAttrs.push(`${prefix}caracteristique3Equipement`);
        listAttrs.push(`${prefix}caracteristique4Equipement`);
        listAttrs.push(`${prefix}pilonnage`);
        listAttrs.push(`${prefix}pilonnageType`);

        listAttrs.push(`${prefix}ArmeDist`);
        listAttrs.push(`${prefix}armeDistPortee`);

        listAttrs.push(`${prefix}armeDistDegat`);
        listAttrs.push(`${prefix}armeDistViolence`);

        listAttrs.push(`${prefix}armeDistBDegat`);
        listAttrs.push(`${prefix}armeDistBViolence`);

        listAttrs = listAttrs.concat(dEffets, dEffetsValue, AA, AAValue, special, specialValue);
        break;

      case 'repeating_armeDistVehicule:armedistance':
        id = info.triggerName.split('_')[2];

        prefix = `repeating_armeDistVehicule_${id}_`;

        dEffets = wpnEffects.map((a) => `${prefix}${a}`);
        dEffetsValue = wpnEffectsValue.map((a) => `${prefix}${a}`);
        AA = wpnAmeliorationA.map((a) => `${prefix}${a}`);
        AAValue = wpnAmeliorationAValue.map((a) => `${prefix}${a}`);
        special = wpnSpecial.map((a) => `${prefix}${a}`);
        specialValue = wpnSpecialValue.map((a) => `${prefix}${a}`);

        listAttrs.push(`${prefix}caracteristique1Equipement`);
        listAttrs.push(`${prefix}caracteristique2Equipement`);
        listAttrs.push(`${prefix}caracteristique3Equipement`);
        listAttrs.push(`${prefix}caracteristique4Equipement`);
        listAttrs.push(`${prefix}pilonnage`);
        listAttrs.push(`${prefix}pilonnageType`);

        listAttrs.push(`${prefix}ArmeDist`);
        listAttrs.push(`${prefix}armeDistPortee`);

        listAttrs.push(`${prefix}armeDistDegat`);
        listAttrs.push(`${prefix}armeDistViolence`);

        listAttrs.push(`${prefix}armeDistBDegat`);
        listAttrs.push(`${prefix}armeDistBViolence`);

        listAttrs = listAttrs.concat(dEffets, dEffetsValue, AA, AAValue, special, specialValue);
        break;

      default:
        name = '';

        prefix = '';

        dEffets = [];
        dEffetsValue = [];
        AA = [];
        AAValue = [];
        special = [];
        specialValue = [];

        baseDegats = 0;
        baseViolence = 0;

        diceDegats = 0;
        bDegats.push(0);

        diceViolence = 0;
        bViolence.push(0);

        listAttrs = listAttrs.concat(dEffets, dEffetsValue, AA, AAValue, special, specialValue);
        break;
    }

    const attrs = await getAttrsAsync(listAttrs);

    const armure = attrs.armure;
    const armureL = attrs.armureLegende;

    if (button === 'repeating_armeDist:armedistance' || button === 'repeating_armeDistVehicule:armedistance') {
      name = attrs[`${prefix}ArmeDist`] || '';
      portee = attrs[`${prefix}armeDistPortee`] || '^{portee-contact}';

      exec.push(`{{special1=${name}}}`);
      exec.push(`{{portee=^{portee} ${portee}}}`);

      baseDegats = Number(attrs[`${prefix}armeDistDegat`]) || 0;
      baseViolence = Number(attrs[`${prefix}armeDistViolence`]) || 0;

      diceDegats = Number(attrs[`${prefix}armeDistDegat`]) || 0;
      bDegats.push(Number(attrs[`${prefix}armeDistBDegat`]) || 0);

      diceViolence = Number(attrs[`${prefix}armeDistViolence`]) || 0;
      bViolence.push(Number(attrs[`${prefix}armeDistBViolence`]) || 0);
    }

    const C1 = attrs[`${prefix}caracteristique1Equipement`] || '0';
    const C2 = attrs[`${prefix}caracteristique2Equipement`] || '0';
    const C3 = attrs[`${prefix}caracteristique3Equipement`] || '0';
    const C4 = attrs[`${prefix}caracteristique4Equipement`] || '0';
    const vPilonnage = attrs[`${prefix}pilonnage`] || 0;
    const vPilonnageType = attrs[`${prefix}pilonnageType`] || 0;

    if (armure === 'sans' || armure === 'guardian') { hasArmure = false; }

    let isConditionnelA = false;
    let isConditionnelD = false;
    let isConditionnelV = false;

    const cBase = [];
    const cBonus = [];
    let cRoll = [];
    let bonus = [];

    let OD = 0;

    const mod = +attrs.jetModifDes;
    const hasBonus = attrs.bonusCarac;

    let degats = [];
    let violence = [];

    const attrsCarac = await getCarac(hasBonus, C1, C2, C3, C4);

    let ODBarbarian = [];
    let ODMALBarbarian = [];
    let ODRogue = [];
    let ODMALRogue = [];
    let ODShaman = [];
    let ODMALShaman = [];
    const ODWarrior = [];
    const ODMALWarrior = [];

    const vForce = +attrs.force;
    const vDiscretion = +attrs.discretion;
    const oDiscretion = +attrs[`${ODValue.discretion}`];
    const vDexterite = +attrs.dexterite;
    const oDexterite = +attrs[`${ODValue.dexterite}`];
    const vTir = +attrs.tir;
    const oTir = +attrs[`${ODValue.tir}`];

    let attaquesSurprises = [];
    let attaquesSurprisesValue = [];
    let attaquesSurprisesCondition = '';

    let eASAssassin = '';
    let eASAssassinValue = 0;

    let isSurprise = false;
    let isAssistantAttaque = false;
    let isAntiAnatheme = false;
    let isCadence = false;
    let sCadence = 0;
    let vCadence = 0;
    let isDeuxMains = false;
    let isDestructeur = false;
    let vDestructeur = 0;
    let isFureur = false;
    let isMeurtrier = false;
    let vMeurtrier = 0;
    let nowSilencieux = false;
    let isObliteration = false;
    let isTenebricide = false;
    let isTirRafale = false;
    let isUltraviolence = false;
    let isChambreDouble = false;

    let isELumiere = false;
    let lumiereValue = 0;

    let isEAkimbo = false;
    let isEAmbidextrie = false;

    let pasEnergie = false;
    let sEnergieText = '';
    const energie = attrs.energiePJ;
    const espoir = attrs.espoir;

    const devaste = +attrs.devasterAnatheme;
    const bourreau = +attrs.bourreauTenebres;
    const equilibre = +attrs.equilibreBalance;

    let autresEffets = [];
    let autresAmeliorationsA = [];
    const autresSpecial = [];

    if (hasArmure) { exec.push('{{OD=true}}'); }

    let C1Nom = '';
    let C2Nom = '';
    let C3Nom = '';
    let C4Nom = '';

    if (attrsCarac.C1) {
      C1Nom = attrsCarac.C1Brut;

      const C1Value = attrsCarac.C1Base;
      const C1OD = attrsCarac.C1OD;

      cBase.push(attrsCarac.C1Nom);
      cRoll.push(C1Value);

      if (hasArmure) { OD += C1OD; }
    }

    if (attrsCarac.C2) {
      C2Nom = attrsCarac.C2Brut;

      const C2Value = attrsCarac.C2Base;
      const C2OD = attrsCarac.C2OD;

      cBase.push(attrsCarac.C2Nom);
      cRoll.push(C2Value);

      if (hasArmure) { OD += C2OD; }
    }

    if (attrsCarac.C3) {
      C3Nom = attrsCarac.C3Brut;

      const C3Value = attrsCarac.C3Base;
      const C3OD = attrsCarac.C3OD;

      cBonus.push(attrsCarac.C3Nom);
      cRoll.push(C3Value);

      if (hasArmure) { OD += C3OD; }
    }

    if (attrsCarac.C4) {
      C4Nom = attrsCarac.C4Brut;

      const C4Value = attrsCarac.C4Base;
      const C4OD = attrsCarac.C4OD;

      cBonus.push(attrsCarac.C4Nom);
      cRoll.push(C4Value);

      if (hasArmure) { OD += C4OD; }
    }

    if (mod !== 0) {
      cRoll.push(mod);
      exec.push(`{{mod=${mod}}}`);
    }

    // GESTION DES BONUS DES OD
    if (oDiscretion >= 2 && hasArmure) {
      let bODDiscretion = vDiscretion;
      attaquesSurprises.push(i18n_odDiscretion);

      if (oDiscretion >= 5) { bODDiscretion += vDiscretion + oDiscretion; }

      attaquesSurprisesValue.push(bODDiscretion);
      attaquesSurprisesCondition = `{{attaqueSurpriseCondition=${i18n_attaqueSurpriseCondition}}}`;
    }
    // FIN DE GESTION DES BONUS DES OD

    // GESTION DES EFFETS

    const effets = getWeaponsEffects(prefix, attrs, hasArmure, armure, vForce, vDexterite, oDexterite, vDiscretion, oDiscretion, vTir, oTir);

    bDegats = bDegats.concat(effets.bDegats);
    eASAssassin = effets.eASAssassin;
    eASAssassinValue = effets.eASAssassinValue;

    if (attaquesSurprisesCondition === '' && effets.attaquesSurprisesCondition !== '') { attaquesSurprisesCondition = effets.attaquesSurprisesCondition; }

    attaquesSurprises = attaquesSurprises.concat(effets.attaquesSurprises);
    attaquesSurprisesValue = attaquesSurprisesValue.concat(effets.attaquesSurprisesValue);

    autresEffets = autresEffets.concat(effets.autresEffets);

    isAntiAnatheme = effets.isAntiAnatheme;

    isAssassin = effets.isAssassin;
    isAssistantAttaque = effets.isAssistantAttaque;

    isCadence = effets.isCadence;
    sCadence = effets.sCadence;
    vCadence = effets.vCadence;

    isDestructeur = effets.isDestructeur;
    vDestructeur = effets.vDestructeur;

    isDeuxMains = effets.isDeuxMains;
    isLourd = effets.isLourd;

    isMeurtrier = effets.isMeurtrier;
    vMeurtrier = effets.vMeurtrier;

    nowSilencieux = effets.nowSilencieux;

    isTenebricide = effets.isTenebricide;

    isFureur = effets.isFureur;
    isUltraviolence = effets.isUltraviolence;

    isObliteration = effets.isObliteration;
    isTirRafale = effets.isTirRafale;

    isELumiere = effets.isELumiere;
    lumiereValue = Number(effets.eLumiereValue);

    isEAkimbo = effets.isAkimbo;
    isEAmbidextrie = effets.isAmbidextrie;

    if (effets.isConditionnelA) { isConditionnelA = true; }

    if (effets.isConditionnelD) { isConditionnelD = true; }

    if (effets.isConditionnelV) { isConditionnelV = true; }

    // FIN GESTION DES EFFETS

    // GESTION DES AMELIORATIONS D'ARMES

    const ameliorationsA = getWeaponsDistanceAA(prefix, attrs, vDiscretion, oDiscretion, isAssistantAttaque, eASAssassinValue, isCadence, vCadence, nowSilencieux, isTirRafale, isObliteration, isAntiAnatheme);

    exec = exec.concat(ameliorationsA.exec);

    bonus = bonus.concat(ameliorationsA.bonus);

    baseDegats += ameliorationsA.diceDegats;
    baseViolence += ameliorationsA.diceViolence;

    diceDegats += ameliorationsA.diceDegats;
    diceViolence += ameliorationsA.diceViolence;

    bDegats = bDegats.concat(ameliorationsA.bDegats);

    attaquesSurprises = attaquesSurprises.concat(ameliorationsA.attaquesSurprises);
    attaquesSurprisesValue = attaquesSurprisesValue.concat(ameliorationsA.attaquesSurprisesValue);

    if (attaquesSurprisesCondition === '') { attaquesSurprisesCondition = ameliorationsA.attaquesSurprisesCondition; }

    if (ameliorationsA.isChambreDouble) {
      isCadence = false;
      isChambreDouble = ameliorationsA.isChambreDouble;
      sCadence = ameliorationsA.rChambreDouble;
    }

    if (ameliorationsA.isJAkimbo) { isEAkimbo = ameliorationsA.isJAkimbo; }

    if (ameliorationsA.isJAmbidextre) { isEAmbidextrie = ameliorationsA.isJAmbidextre; }

    autresEffets = autresEffets.concat(ameliorationsA.autresEffets);
    autresAmeliorationsA = autresAmeliorationsA.concat(ameliorationsA.autresAmeliorations);

    if (ameliorationsA.aASAssassin !== '') {
      eASAssassin = ameliorationsA.aASAssassin;
      eASAssassinValue = ameliorationsA.aASAssassinValue;
    }

    if (ameliorationsA.isConditionnelA) { isConditionnelA = true; }

    if (ameliorationsA.isConditionnelD) { isConditionnelD = true; }

    if (ameliorationsA.isConditionnelV) { isConditionnelV = true; }

    // FIN GESTION DES AMELIORATIONS D'ARMES

    // GESTION DU STYLE

    const getStyle = getStyleDistanceMod(attrs, baseDegats, baseViolence, vPilonnage, vPilonnageType, hasArmure, oTir, isEAkimbo, isEAmbidextrie, isDeuxMains, isLourd);

    exec = exec.concat(getStyle.exec);
    cRoll = cRoll.concat(getStyle.cRoll);
    diceDegats += getStyle.diceDegats;
    diceViolence += getStyle.diceViolence;

    // FIN GESTION DU STYLE

    // GESTION DES BONUS SPECIAUX

    const sBonusDegats = isApplied(attrs[`${prefix}BDDiversTotal`]);
    const sBonusDegatsD6 = attrs[`${prefix}BDDiversD6`];
    const sBonusDegatsFixe = attrs[`${prefix}BDDiversFixe`];

    const sBonusViolence = isApplied(attrs[`${prefix}BVDiversTotal`]);
    const sBonusViolenceD6 = attrs[`${prefix}BVDiversD6`];
    const sBonusViolenceFixe = attrs[`${prefix}BVDiversFixe`];

    const sEnergie = isApplied(attrs[`${prefix}energie`]);
    const sEnergieValue = attrs[`${prefix}energieValue`];
    let newEnergie = 0;

    if (sBonusDegats) {
      exec.push(`{{vMSpecialD=+${sBonusDegatsD6}D6+${sBonusDegatsFixe}}}`);
      diceDegats += Number(sBonusDegatsD6);
      bDegats.push(sBonusDegatsFixe);
    }

    if (sBonusViolence) {
      exec.push(`{{vMSpecialV=+${sBonusViolenceD6}D6+${sBonusViolenceFixe}}}`);
      diceViolence += Number(sBonusViolenceD6);
      bViolence.push(sBonusViolenceFixe);
    }

    if (sEnergie) {
      if (armure === 'berserk') {
        let sEspoirValue = Math.floor((Number(sEnergieValue) / 2) - 1);

        if (sEspoirValue < 1) { sEspoirValue = 1; }

        autresSpecial.push(`${i18n_espoirRetire} (${sEspoirValue})`);

        newEnergie = Number(espoir) - Number(sEspoirValue);

        if (newEnergie === 0) {
          sEnergieText = i18n_plusEspoir;
        } else if (newEnergie < 0) {
          newEnergie = 0;
          sEnergieText = i18n_pasEspoir;
          pasEnergie = true;
        }
      } else {
        autresSpecial.push(`${i18n_energieRetiree} (${sEnergieValue})`);

        newEnergie = Number(energie) - Number(sEnergieValue);

        if (newEnergie === 0) {
          sEnergieText = i18n_plusEnergie;
        } else if (newEnergie < 0) {
          newEnergie = 0;
          sEnergieText = i18n_pasEnergie;
          pasEnergie = true;
        }
      }

      exec.push(`{{energieR=${newEnergie}}}`);
    }

    // FIN DE GESTION DES BONUS SPECIAUX

    // GESTION DES BONUS D'ARMURE

    const armorBonus = getArmorBonus(attrs, armure, isELumiere, false, vDiscretion, oDiscretion, hasBonus, C1Nom, C2Nom, C3Nom, C4Nom, autresEffets);

    exec = exec.concat(armorBonus.exec);
    cRoll = cRoll.concat(armorBonus.cRoll);

    diceDegats += Number(armorBonus.diceDegats);
    bDegats = bDegats.concat(armorBonus.bDegats);
    diceViolence += Number(armorBonus.diceViolence);

    ODBarbarian = ODBarbarian.concat(armorBonus.ODBarbarian);
    ODRogue = ODRogue.concat(armorBonus.ODRogue);
    ODShaman = ODShaman.concat(armorBonus.ODShaman);
    ODWarrior.push(armorBonus.ODWarrior);

    autresEffets = autresEffets.concat(armorBonus.autresEffets);

    const MALBonus = getMALBonus(attrs, armureL, isELumiere, false, vDiscretion, oDiscretion, hasBonus, C1Nom, C2Nom, C3Nom, C4Nom, autresEffets);

    exec = exec.concat(MALBonus.exec);
    cRoll = cRoll.concat(MALBonus.cRoll);

    diceDegats += Number(MALBonus.diceDegats);
    bDegats = bDegats.concat(MALBonus.bDegats);
    diceViolence += Number(MALBonus.diceViolence);

    ODMALBarbarian = ODMALBarbarian.concat(MALBonus.ODMALBarbarian);
    ODMALRogue = ODMALRogue.concat(MALBonus.ODMALRogue);
    ODMALShaman = ODMALShaman.concat(MALBonus.ODMALShaman);
    ODMALWarrior.push(MALBonus.ODMALWarrior);

    autresEffets = autresEffets.concat(MALBonus.autresEffets);

    // FIN GESTION DES BONUS D'ARMURE
    OD -= armorBonus.ODWarrior;
    OD -= MALBonus.ODMALWarrior;

    exec.push(`{{vOD=${OD}}}`);

    if (cRoll.length === 0) { cRoll.push(0); }

    if (bonus.length === 0) { bonus.push(0); }

    bonus = bonus.concat(OD);
    bonus = bonus.concat(ODBarbarian);
    bonus = bonus.concat(ODMALBarbarian);
    bonus = bonus.concat(ODRogue);
    bonus = bonus.concat(ODMALRogue);
    bonus = bonus.concat(ODShaman);
    bonus = bonus.concat(ODMALShaman);
    bonus = bonus.concat(ODWarrior);
    bonus = bonus.concat(ODMALWarrior);

    if (diceDegats < 0) { diceDegats = 0; }

    if (diceViolence < 0) { diceViolence = 0; }

    degats.push(`${diceDegats}D6`);
    degats = degats.concat(bDegats);

    violence.push(`${diceViolence}D6`);
    violence = violence.concat(bViolence);

    if (cBase.length !== 0) { exec.push(`{{cBase=${cBase.join(' - ')}}}`); }

    if (cBonus.length !== 0) { exec.push(`{{cBonus=${cBonus.join(' - ')}}}`); }

    const jet = `{{jet=[[ {{[[{${cRoll.join('+')}-${sCadence}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0}]]}}`;

    firstExec.push(jet);
    exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);
    exec.push(`{{bonus=[[${bonus.join('+')}]]}}`);

    exec.push(`{{degats=[[${degats.join('+')}]]}}`);
    exec.push(`{{violence=[[${violence.join('+')}]]}}`);

    if (isObliteration) {
      let ASObliteration = [];
      let ASValueObliteration = [];

      diceDegatsObliteration = diceDegats * 6;

      degatsFObliteration = _.reduce(bDegats, (n1, n2) => Number(n1) + Number(n2));

      const vObliteration = diceDegatsObliteration + degatsFObliteration;

      exec.push(`{{obliterationValue=${vObliteration}}}`);

      if (isMeurtrier) { exec.push(`{{obliterationMeurtrierValue=${vMeurtrier * 6}}}`); }

      if (isDestructeur) { exec.push(`{{obliterationDestructeurValue=${vDestructeur * 6}}}`); }

      if (eASAssassinValue > 0) {
        eAssassinTenebricideValue = eASAssassinValue * 6;

        ASObliteration.unshift(eASAssassin);
        ASValueObliteration.unshift(eAssassinTenebricideValue);

        if (attaquesSurprises.length > 0) {
          ASObliteration = ASObliteration.concat(attaquesSurprises);
          ASValueObliteration = ASValueObliteration.concat(attaquesSurprisesValue);
        }

        exec.push(`{{obliterationAS=${ASObliteration.join('\n+')}}}`);
        exec.push(`{{obliterationASValue=${_.reduce(ASValueObliteration, (n1, n2) => n1 + n2, 0)}}}`);
      } else if (attaquesSurprises.length > 0) {
        ASObliteration = ASObliteration.concat(attaquesSurprises);
        ASValueObliteration = ASValueObliteration.concat(attaquesSurprisesValue);

        exec.push(`{{obliterationAS=${ASTenebricide.join('\n+')}}}`);
        exec.push(`{{obliterationASValue=${_.reduce(ASValueObliteration, (n1, n2) => n1 + n2, 0)}}}`);
      }
    }

    if (isCadence) {
      exec.push(`{{rCadence=${i18n_cadence} ${vCadence} ${i18n_inclus}}}`);
      exec.push(`{{vCadence=${sCadence}D}}`);
    }

    if (isChambreDouble) {
      exec.push(`{{rCadence=${i18n_chambreDouble} (${i18n_cadence} 2) ${i18n_inclus}}}`);
      exec.push(`{{vCadence=${sCadence}D}}`);
    }

    if (eASAssassinValue > 0) {
      attaquesSurprises.unshift(eASAssassin);
      attaquesSurprisesValue.unshift(`${eASAssassinValue}D6`);
    }

    if (attaquesSurprises.length > 0) {
      exec.push(`{{attaqueSurprise=${attaquesSurprises.join('\n+')}}}`);
      exec.push(`{{attaqueSurpriseValue=[[${attaquesSurprisesValue.join('+')}]]}}`);
      exec.push(attaquesSurprisesCondition);
      isSurprise = true;
    }

    if (isTenebricide) {
      exec.push(`{{tenebricide=${i18n_tenebricide}}} {{tenebricideConditionD=${i18n_tenebricideConditionD}}} {{tenebricideConditionV=${i18n_tenebricideConditionV}}}`);
      exec.push('{{tenebricideValueD=[[0]]}}');
      exec.push('{{tenebricideValueV=[[0]]}}');

      if (attaquesSurprises.length > 0) {
        exec.push(`{{tenebricideAS=${attaquesSurprises.join('\n+')}}}`);
        exec.push('{{tenebricideASValue=[[0]]}}');
      }

      if (isMeurtrier) { firstExec.push('{{tMeurtrierValue=[[0]]}}'); }
      if (isDestructeur) { firstExec.push('{{tDestructeurValue=[[0]]}}'); }
      if (isFureur) { firstExec.push('{{tFureurValue=[[0]]}}'); }
      if (isUltraviolence) { firstExec.push('{{tUltraviolenceValue=[[0]]}}'); }
    }

    if (isELumiere) { autresEffets.push(`${i18n_lumiere} ${lumiereValue}`); }

    if (devaste || bourreau || equilibre) {
      const herauts = [];

      if (devaste) { herauts.push(i18n_devasterAnatheme); }
      if (bourreau) { herauts.push(i18n_bourreauTenebres); }
      if (equilibre) { herauts.push(i18n_equilibrerBalance); }

      exec.push(`{{herauts=${herauts.join(' / ')}}}`);
    }

    if (autresEffets.length > 0) {
      autresEffets.sort();
      exec.push(`{{effets=${autresEffets.join(' / ')}}}`);
    }

    if (autresAmeliorationsA.length > 0) {
      autresAmeliorationsA.sort();
      exec.push(`{{ameliorations=${autresAmeliorationsA.join(' / ')}}}`);
    }

    if (autresSpecial.length > 0) {
      autresSpecial.sort();
      exec.push(`{{special=${autresSpecial.join(' / ')}}}`);
    }

    if (isConditionnelA) { exec.push('{{succesConditionnel=true}}'); }

    if (isConditionnelD) { exec.push('{{degatsConditionnel=true}}'); }

    if (isConditionnelV) { exec.push('{{violenceConditionnel=true}}'); }

    if (effets.exec) { exec = exec.concat(effets.exec); }

    if (effets.firstExec) { firstExec = firstExec.concat(effets.firstExec); }

    exec = firstExec.concat(exec);

    // ROLL
    let finalRoll;

    if (pasEnergie === false) {
      finalRoll = await startRoll(exec.join(' '));
      const tJet = finalRoll.results.jet.result;

      const tBonus = finalRoll.results.bonus.result;
      const tExploit = finalRoll.results.Exploit.result;

      const rDegats = finalRoll.results.degats.dice;
      const rViolence = finalRoll.results.violence.dice;

      const tDegats = finalRoll.results.degats.result;
      const tViolence = finalRoll.results.violence.result;

      const conditions = {
        bourreau,
        devaste,
        equilibre,
        isTenebricide,
        isSurprise,
        isDestructeur,
        isFureur,
        isMeurtrier,
        isUltraviolence,
      };

      const computed = updateRoll(finalRoll, tDegats, rDegats, bDegats, tViolence, rViolence, bViolence, conditions);

      const finalComputed = {
        jet: tJet + tBonus,
      };

      Object.assign(finalComputed, computed);

      finishRoll(finalRoll.rollId, finalComputed);

      if (tJet !== 0 && tJet === tExploit) {
        const exploitRoll = await startRoll(`${roll}@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${i18n_exploit}}}${jet}`);
        const tRExploit = exploitRoll.results.jet.result;
        const exploitComputed = {
          jet: tRExploit,
        };

        finishRoll(exploitRoll.rollId, exploitComputed);
      }

      if (sEnergie !== false) {
        if (armure === 'berserk') {
          setAttrs({
            espoir: newEnergie,
          });
        } else {
          setAttrs({
            energiePJ: newEnergie,
          });
        }

        if (newEnergie === 0) {
          const noEnergieRoll = await startRoll(`@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${name}}} {{text=${sEnergieText}}}`);
          finishRoll(noEnergieRoll.rollId, {});
        }
      }
    } else if (button === 'repeating_armeCaC:armecontact') {
      finalRoll = await startRoll(`@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${name}}} {{text=${sEnergieText}}}`);
      finishRoll(finalRoll.rollId, {});
    } else {
      finalRoll = await startRoll(`@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${name}}} {{text=${sEnergieText}}}`);
      finishRoll(finalRoll.rollId, {});
    }
  });
});
  /* eslint-disable max-len */
/* eslint-disable camelcase */
/* eslint-disable prefer-destructuring */
/* eslint-disable no-undef */

const rollCombatGrenade = ['grenade1', 'grenade2', 'grenade3', 'grenade4', 'grenade5'];

rollCombatGrenade.forEach((button) => {
  on(`clicked:${button}`, async (info) => {
    const roll = info.htmlAttributes.value;

    let hasArmure = true;
    let hasDgts = true;
    let hasLumiere = false;

    if (button === 'grenade2' || button === 'grenade4') { hasDgts = false; }

    if (button === 'grenade2') { hasLumiere = true; }

    const firstExec = [];
    let exec = [];
    firstExec.push(roll);

    let isConditionnelA = false;
    let isConditionnelD = false;
    let isConditionnelV = false;

    const cBase = [];
    const cBonus = [];
    let cRoll = [];
    let bonus = [];

    let OD = 0;

    let ameliorations = false;

    let diceDegats = 3;
    let diceViolence = 3;

    let bDegats = [];
    const bViolence = [];

    let degats = [];
    let violence = [];

    let listAttrs = [
      'caracteristique1Grenade',
      'caracteristique2Grenade',
      'caracteristique3Grenade',
      'caracteristique4Grenade',
      'grenadeAvancee',
      'discretion',
      `${ODValue.discretion}`,
      'tir',
      'devasterAnatheme',
      'bourreauTenebres',
      'equilibreBalance',
    ];

    listAttrs = listAttrs.concat(listArmure, listArmureLegende, listStyle, listBase);

    const attrs = await getAttrsAsync(listAttrs);

    const armure = attrs.armure;
    const armureL = attrs.armureLegende;

    if (armure === 'sans' || armure === 'guardian') { hasArmure = false; }

    if (attrs.grenadeAvancee !== '0') { ameliorations = true; }

    const mod = +attrs.jetModifDes;
    const hasBonus = attrs.bonusCarac;

    const C1 = attrs.caracteristique1Grenade || '0';
    const C2 = attrs.caracteristique2Grenade || '0';
    const C3 = attrs.caracteristique3Grenade || '0';
    const C4 = attrs.caracteristique4Grenade || '0';

    const attrsCarac = await getCarac(hasBonus, C1, C2, C3, C4);

    let ODBarbarian = [];
    let ODMALBarbarian = [];
    let ODRogue = [];
    let ODMALRogue = [];
    let ODShaman = [];
    let ODMALShaman = [];
    const ODWarrior = [];
    const ODMALWarrior = [];

    const vDiscretion = +attrs.discretion;
    const oDiscretion = +attrs[`${ODValue.discretion}`];
    const oTir = +attrs.tir;

    const attaquesSurprises = [];
    const attaquesSurprisesValue = [];
    let attaquesSurprisesCondition = '';

    let isTenebricide = false;
    let isDestructeur = false;
    let isMeurtrier = false;
    let isUltraviolence = false;
    let isSurprise = false;

    const devaste = +attrs.devasterAnatheme;
    const bourreau = +attrs.bourreauTenebres;
    const equilibre = +attrs.equilibreBalance;

    let autresEffets = [];

    if (hasArmure) { exec.push('{{OD=true}}'); }

    let C1Nom = '';
    let C2Nom = '';
    let C3Nom = '';
    let C4Nom = '';

    if (attrsCarac.C1) {
      C1Nom = attrsCarac.C1Brut;

      const C1Value = attrsCarac.C1Base;
      const C1OD = attrsCarac.C1OD;

      cBase.push(attrsCarac.C1Nom);
      cRoll.push(C1Value);

      if (hasArmure) { OD += C1OD; }
    }

    if (attrsCarac.C2) {
      C2Nom = attrsCarac.C2Brut;

      const C2Value = attrsCarac.C2Base;
      const C2OD = attrsCarac.C2OD;

      cBase.push(attrsCarac.C2Nom);
      cRoll.push(C2Value);

      if (hasArmure) { OD += C2OD; }
    }

    if (attrsCarac.C3) {
      C3Nom = attrsCarac.C3Brut;

      const C3Value = attrsCarac.C3Base;
      const C3OD = attrsCarac.C3OD;

      cBonus.push(attrsCarac.C3Nom);
      cRoll.push(C3Value);

      if (hasArmure) { OD += C3OD; }
    }

    if (attrsCarac.C4) {
      C4Nom = attrsCarac.C4Brut;

      const C4Value = attrsCarac.C4Base;
      const C4OD = attrsCarac.C4OD;

      cBonus.push(attrsCarac.C4Nom);
      cRoll.push(C4Value);

      if (hasArmure) { OD += C4OD; }
    }

    if (mod !== 0) {
      cRoll.push(mod);
      exec.push(`{{mod=${mod}}}`);
    }

    // GESTION DES BONUS DE BASE
    if (ameliorations) {
      diceDegats += 2;
      diceViolence += 2;

      exec.push('{{vGrenadesAmeliorees=+2D}}');
    }

    // FIN GESTION DES BONUS DE BASE

    // GESTION DES BONUS DES OD
    if (oDiscretion >= 2 && hasArmure) {
      let bODDiscretion = vDiscretion;
      attaquesSurprises.push(i18n_odDiscretion);

      if (oDiscretion >= 5) { bODDiscretion += vDiscretion + oDiscretion; }

      attaquesSurprisesValue.push(bODDiscretion);
      attaquesSurprisesCondition = `{{attaqueSurpriseCondition=${i18n_attaqueSurpriseCondition}}}`;
    }
    // FIN DE GESTION DES BONUS DES OD

    // GESTION DES EFFETS

    switch (button) {
      case 'grenade1':
        isConditionnelD = true;
        isConditionnelV = true;

        firstExec.push('{{ultraviolenceValue=[[2D6]]}} {{meurtrierValue=[[2D6]]}}');

        exec.push(`{{ultraviolence=${i18n_ultraviolence}}} {{ultraviolenceCondition=${i18n_ultraviolenceCondition}}} {{meurtrier=${i18n_meurtrier}}} {{meurtrierCondition=${i18n_meurtrierCondition}}}`);
        autresEffets.push(`${i18n_dispersion} 6`);

        isMeurtrier = true;
        isUltraviolence = true;
        break;
      case 'grenade2':
        isConditionnelA = true;

        exec.push(`{{choc=${i18n_choc} 1}} {{chocCondition=${i18n_chocCondition}}}`);
        autresEffets.push(`${i18n_barrage} 2`);
        autresEffets.push(`${i18n_lumiere} 2`);
        autresEffets.push(`${i18n_dispersion} 6`);
        break;
      case 'grenade3':
        isConditionnelD = true;

        firstExec.push('{{destructeurValue=[[2D6]]}}');

        exec.push(`{{destructeur=${i18n_destructeur}}} {{destructeurCondition=${i18n_destructeurCondition}}}`);
        autresEffets.push(`${i18n_perceArmure} 20`);
        autresEffets.push(`${i18n_penetrant} 6`);
        autresEffets.push(`${i18n_dispersion} 6`);

        isDestructeur = true;
        break;
      case 'grenade4':
        isConditionnelA = true;

        exec.push(`{{parasitage=${i18n_parasitage} 2}} {{parasitageCondition=${i18n_parasitageCondition}}}`);
        autresEffets.push(`${i18n_dispersion} 6`);
        hasDgts = false;
        break;
      case 'grenade5':
        isConditionnelA = true;

        exec.push(`{{choc=${i18n_choc} 1}} {{chocCondition=${i18n_chocCondition}}} {{grenadeExplosive=${i18n_surVehicule}}} {{grenadeExplosiveD=[[3D6]]}}`);
        autresEffets.push(i18n_antiVehicule);
        autresEffets.push(`${i18n_dispersion} 3`);
        break;
      default:
        isConditionnelA = false;
        hasDgts = false;
        break;
    }

    // FIN GESTION DES EFFETS

    // GESTION DU STYLE

    const getStyle = getStyleDistanceMod(attrs, diceDegats, diceViolence, '', '', hasArmure, oTir, false, false, false, false);

    exec = exec.concat(getStyle.exec);
    cRoll = cRoll.concat(getStyle.cRoll);
    diceDegats += getStyle.diceDegats;
    diceViolence += getStyle.diceViolence;

    // FIN GESTION DU STYLE

    // GESTION DES BONUS D'ARMURE

    const armorBonus = getArmorBonus(attrs, armure, hasLumiere, false, vDiscretion, oDiscretion, hasBonus, C1Nom, C2Nom, C3Nom, C4Nom, autresEffets);

    exec = exec.concat(armorBonus.exec);
    cRoll = cRoll.concat(armorBonus.cRoll);

    diceDegats += Number(armorBonus.diceDegats);
    bDegats = bDegats.concat(armorBonus.bDegats);
    diceViolence += Number(armorBonus.diceViolence);

    ODBarbarian = ODBarbarian.concat(armorBonus.ODBarbarian);
    ODRogue = ODRogue.concat(armorBonus.ODRogue);
    ODShaman = ODShaman.concat(armorBonus.ODShaman);
    ODWarrior.push(armorBonus.ODWarrior);

    autresEffets = autresEffets.concat(armorBonus.autresEffets);

    if (armure === 'berserk') {
      isTenebricide = true;
      isConditionnelD = true;
      isConditionnelV = true;

      exec.push(`{{antiAnatheme=${i18n_antiAnatheme}}} {{antiAnathemeCondition=${i18n_antiAnathemeCondition}}}`);
    }

    const MALBonus = getMALBonus(attrs, armureL, hasLumiere, false, vDiscretion, oDiscretion, hasBonus, C1Nom, C2Nom, C3Nom, C4Nom, autresEffets);

    exec = exec.concat(MALBonus.exec);
    cRoll = cRoll.concat(MALBonus.cRoll);

    diceDegats += Number(MALBonus.diceDegats);
    bDegats = bDegats.concat(MALBonus.bDegats);
    diceViolence += Number(MALBonus.diceViolence);

    ODMALBarbarian = ODMALBarbarian.concat(MALBonus.ODMALBarbarian);
    ODMALRogue = ODRogue.concat(MALBonus.ODMALRogue);
    ODMALShaman = ODMALShaman.concat(MALBonus.ODMALShaman);
    ODMALWarrior.push(MALBonus.ODMALWarrior);

    autresEffets = autresEffets.concat(MALBonus.autresEffets);

    // FIN GESTION DES BONUS D'ARMURE
    OD -= armorBonus.ODWarrior;
    OD -= MALBonus.ODMALWarrior;

    exec.push(`{{vOD=${OD}}}`);

    if (cRoll.length === 0) { cRoll.push(0); }

    if (bonus.length === 0) { bonus.push(0); }

    bonus = bonus.concat(OD);
    bonus = bonus.concat(ODBarbarian);
    bonus = bonus.concat(ODMALBarbarian);
    bonus = bonus.concat(ODRogue);
    bonus = bonus.concat(ODMALRogue);
    bonus = bonus.concat(ODShaman);
    bonus = bonus.concat(ODMALShaman);
    bonus = bonus.concat(ODWarrior);
    bonus = bonus.concat(ODMALWarrior);

    if (hasDgts) {
      if (diceDegats < 0) { diceDegats = 0; }

      if (diceViolence < 0) { diceViolence = 0; }

      degats.push(`${diceDegats}D6`);
      degats = degats.concat(bDegats);

      violence.push(`${diceViolence}D6`);
      violence = violence.concat(bViolence);

      exec.push(`{{degats=[[${degats.join('+')}]]}}`);
      exec.push(`{{violence=[[${violence.join('+')}]]}}`);
    }

    if (cBase.length !== 0) { exec.push(`{{cBase=${cBase.join(' - ')}}}`); }

    if (cBonus.length !== 0) { exec.push(`{{cBonus=${cBonus.join(' - ')}}}`); }

    const jet = `{{jet=[[ {{[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0}]]}}`;

    firstExec.push(jet);
    exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);
    exec.push(`{{bonus=[[${bonus.join('+')}]]}}`);

    if (attaquesSurprises.length > 0 && hasDgts) {
      exec.push(`{{attaqueSurprise=${attaquesSurprises.join('\n+')}}}`);
      exec.push(`{{attaqueSurpriseValue=[[${attaquesSurprisesValue.join('+')}]]}}`);
      exec.push(attaquesSurprisesCondition);

      isSurprise = true;
    }

    if (isTenebricide && hasDgts) {
      exec.push(`{{tenebricide=${i18n_tenebricide}}} {{tenebricideConditionD=${i18n_tenebricideConditionD}}} {{tenebricideConditionV=${i18n_tenebricideConditionV}}}`);
      exec.push('{{tenebricideValueD=[[0]]}}');
      exec.push('{{tenebricideValueV=[[0]]}}');

      if (attaquesSurprises.length > 0) {
        exec.push(`{{tenebricideAS=${attaquesSurprises.join('\n+')}}}`);
        exec.push('{{tenebricideASValue=[[0]]}}');
      }
    }

    if (devaste || bourreau || equilibre) {
      const herauts = [];

      if (devaste) { herauts.push(i18n_devasterAnatheme); }
      if (bourreau) { herauts.push(i18n_bourreauTenebres); }
      if (equilibre) { herauts.push(i18n_equilibrerBalance); }

      exec.push(`{{herauts=${herauts.join(' / ')}}}`);
    }

    if (autresEffets.length > 0) {
      autresEffets.sort();
      exec.push(`{{effets=${autresEffets.join(' / ')}}}`);
    }

    if (isConditionnelA) { exec.push('{{succesConditionnel=true}}'); }

    if (isConditionnelD && hasDgts) { exec.push('{{degatsConditionnel=true}}'); }

    if (isConditionnelV && hasDgts) { exec.push('{{violenceConditionnel=true}}'); }

    exec = firstExec.concat(exec);

    const finalRoll = await startRoll(exec.join(' '));
    const tJet = finalRoll.results.jet.result;
    const tBonus = finalRoll.results.bonus.result;
    const tExploit = finalRoll.results.Exploit.result;

    const finalComputed = {
      jet: tJet + tBonus,
    };

    if (hasDgts) {
      const rDegats = finalRoll.results.degats.dice;
      const rViolence = finalRoll.results.violence.dice;

      const tDegats = finalRoll.results.degats.result;
      const tViolence = finalRoll.results.violence.result;

      const conditions = {
        bourreau,
        devaste,
        equilibre,
        isTenebricide,
        isSurprise,
        isDestructeur,
        isMeurtrier,
        isUltraviolence,
      };

      const computed = updateRoll(finalRoll, tDegats, rDegats, bDegats, tViolence, rViolence, bViolence, conditions);
      Object.assign(finalComputed, computed);
    }

    finishRoll(finalRoll.rollId, finalComputed);

    if (tJet !== 0 && tJet === tExploit) {
      const exploitRoll = await startRoll(`${roll}@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${i18n_exploit}}}${jet}`);
      const tRExploit = exploitRoll.results.jet.result;
      const exploitComputed = {
        jet: tRExploit,
      };

      finishRoll(exploitRoll.rollId, exploitComputed);
    }
  });
});
  /* eslint-disable no-loop-func */
/* eslint-disable camelcase */
/* eslint-disable max-len */
/* eslint-disable prefer-destructuring */
/* eslint-disable no-undef */
const rollCombatImprovise = 14;

for (let i = 0; i < rollCombatImprovise; i += 1) {
  const str = `AI${i}`;

  on(`clicked:${str}`, async (info) => {
    const roll = info.htmlAttributes.value;

    let hasArmure = true;

    let dDgts = 0;
    let dViolence = 0;

    switch (i) {
      case 1:
        dDgts = 4;
        dViolence = 4;
        break;

      case 2:
        dDgts = 2;
        dViolence = 5;
        break;

      case 3:
        dDgts = 4;
        dViolence = 4;
        break;

      case 4:
        dDgts = 6;
        dViolence = 4;
        break;

      case 5:
        dDgts = 4;
        dViolence = 6;
        break;

      case 6:
        dDgts = 5;
        dViolence = 5;
        break;

      case 7:
        dDgts = 7;
        dViolence = 5;
        break;

      case 8:
        dDgts = 5;
        dViolence = 7;
        break;

      case 9:
        dDgts = 6;
        dViolence = 6;
        break;

      case 10:
        dDgts = 7;
        dViolence = 9;
        break;

      case 11:
        dDgts = 8;
        dViolence = 8;
        break;

      case 12:
        dDgts = 10;
        dViolence = 12;
        break;

      case 13:
        dDgts = 11;
        dViolence = 11;
        break;

      default:
        dDgts = 0;
        dViolence = 0;
        break;
    }

    let exec = [];
    exec.push(roll);

    let isConditionnelD = false;
    let isConditionnelV = false;

    const cBase = [];
    const cBonus = [];
    let cRoll = [];
    let bonus = [];

    let OD = 0;

    const baseDegats = dDgts;
    const baseViolence = dViolence;

    let diceDegats = baseDegats;
    let diceViolence = baseDegats;

    let bDegats = [];
    const bViolence = [];

    let degats = [];
    let violence = [];

    let C1Nom;
    let C2Nom;

    let listAttrs = [
      'utilisationArmeAI',
      'caracteristique3ArmeImprovisee',
      'caracteristique4ArmeImprovisee',
      'force',
      `${ODValue.force}`,
      'discretion',
      `${ODValue.discretion}`,
      'tir',
      `${ODValue.tir}`,
      'combat',
      `${ODValue.combat}`,
      'devasterAnatheme',
      'bourreauTenebres',
      'equilibreBalance',
    ];

    listAttrs = listAttrs.concat(listBase);
    listAttrs = listAttrs.concat(listArmure);
    listAttrs = listAttrs.concat(listArmureLegende);
    listAttrs = listAttrs.concat(listStyle);

    const attrs = await getAttrsAsync(listAttrs);

    const armure = attrs.armure;
    const armureL = attrs.armureLegende;

    if (armure === 'sans' || armure === 'guardian') { hasArmure = false; }

    const type = attrs.utilisationArmeAI;
    const mod = +attrs.jetModifDes;
    const hasBonus = attrs.bonusCarac;

    const C3 = attrs.caracteristique3ArmeImprovisee;
    const C4 = attrs.caracteristique4ArmeImprovisee;

    if (type === '&{template:combat} {{portee=^{portee-contact}}}') {
      C1Nom = 'force';
      C2Nom = 'combat';
    } else {
      C1Nom = 'force';
      C2Nom = 'tir';
    }

    let C3Nom = '';
    let C4Nom = '';

    let ODBarbarian = [];
    let ODMALBarbarian = [];
    let ODRogue = [];
    let ODMALRogue = [];
    let ODShaman = [];
    let ODMALShaman = [];
    const ODWarrior = [];
    const ODMALWarrior = [];

    const vForce = +attrs.force;
    const oForce = +attrs[ODValue.force];
    const vDiscretion = +attrs.discretion;
    const oDiscretion = +attrs[ODValue.discretion];
    const oTir = +attrs[ODValue.tir];
    const oCombat = +attrs[ODValue.combat];

    let isSurprise = false;
    let isTenebricide = false;

    const attaquesSurprises = [];
    const attaquesSurprisesValue = [];
    let attaquesSurprisesCondition = '';

    const devaste = +attrs.devasterAnatheme;
    const bourreau = +attrs.bourreauTenebres;
    const equilibre = +attrs.equilibreBalance;

    let autresEffets = [];
    if (hasArmure) { exec.push('{{OD=true}}'); }

    const C1Value = +attrs[C1Nom];
    const C1OD = +attrs[ODValue[C1Nom]];

    cBase.push(CaracNom[C1Nom]);
    cRoll.push(C1Value);

    if (hasArmure) { OD += C1OD; }

    const C2Value = +attrs[C2Nom];
    const C2OD = +attrs[ODValue[C2Nom]];

    cBase.push(CaracNom[C2Nom]);
    cRoll.push(C2Value);

    if (hasArmure) { OD += C2OD; }

    const attrsCarac = await getCarac(hasBonus, '0', '0', C3, C4);

    if (attrsCarac.C3) {
      C3Nom = attrsCarac.C3Brut;

      const C3Value = attrsCarac.C3Base;
      const C3OD = attrsCarac.C3OD;

      cBonus.push(attrsCarac.C3Nom);
      cRoll.push(C3Value);

      if (hasArmure) { OD += C3OD; }
    }

    if (attrsCarac.C4) {
      C4Nom = attrsCarac.C4Brut;

      const C4Value = attrsCarac.C4Base;
      const C4OD = attrsCarac.C4OD;

      cBonus.push(attrsCarac.C4Nom);
      cRoll.push(C4Value);

      if (hasArmure) { OD += C4OD; }
    }

    if (mod !== 0) {
      cRoll.push(mod);
      exec.push(`{{mod=${mod}}}`);
    }

    // GESTION DES BONUS DE BASE
    if (type === '&{template:combat} {{portee=^{portee-contact}}}') {
      let dForce = vForce;

      if (hasArmure) { dForce += oForce * 3; }

      bDegats.push(dForce);
      exec.push(`{{vForce=${dForce}}}`);
    }

    // FIN GESTION DES BONUS DE BASE

    // GESTION DES BONUS DES OD
    if (oDiscretion >= 2 && hasArmure) {
      let bODDiscretion = vDiscretion;
      attaquesSurprises.push(i18n_odDiscretion);

      if (oDiscretion >= 5) { bODDiscretion += vDiscretion + oDiscretion; }

      attaquesSurprisesValue.push(bODDiscretion);
      attaquesSurprisesCondition = `{{attaqueSurpriseCondition=${i18n_attaqueSurpriseCondition}}}`;
    }
    // FIN DE GESTION DES BONUS DES OD

    // GESTION DU STYLE
    let getStyle;

    if (type.includes('&{template:combat} {{portee=^{portee-contact}}}')) {
      getStyle = getStyleContactMod(attrs, [], baseDegats, baseViolence, hasArmure, oCombat, false, false, false, false, false, false, false, false, false);
    } else {
      getStyle = getStyleDistanceMod(attrs, baseDegats, baseViolence, 0, 0, hasArmure, oTir, false, false, false, false);
    }

    exec = exec.concat(getStyle.exec);
    cRoll = cRoll.concat(getStyle.cRoll);
    diceDegats += getStyle.diceDegats;
    diceViolence += getStyle.diceViolence;

    // FIN GESTION DU STYLE

    // GESTION DES BONUS D'ARMURE

    const armorBonus = getArmorBonus(attrs, armure, false, false, vDiscretion, oDiscretion, hasBonus, C1Nom, C2Nom, C3Nom, C4Nom, autresEffets);

    exec = exec.concat(armorBonus.exec);
    cRoll = cRoll.concat(armorBonus.cRoll);

    diceDegats += Number(armorBonus.diceDegats);
    bDegats = bDegats.concat(armorBonus.bDegats);
    diceViolence += Number(armorBonus.diceViolence);

    ODBarbarian = ODBarbarian.concat(armorBonus.ODBarbarian);
    ODRogue = ODRogue.concat(armorBonus.ODRogue);
    ODShaman = ODShaman.concat(armorBonus.ODShaman);
    ODWarrior.push(armorBonus.ODWarrior);

    autresEffets = autresEffets.concat(armorBonus.autresEffets);

    const MALBonus = getMALBonus(attrs, armureL, false, false, vDiscretion, oDiscretion, hasBonus, C1Nom, C2Nom, C3Nom, C4Nom, autresEffets);

    exec = exec.concat(MALBonus.exec);
    cRoll = cRoll.concat(MALBonus.cRoll);

    diceDegats += Number(MALBonus.diceDegats);
    bDegats = bDegats.concat(MALBonus.bDegats);
    diceViolence += Number(MALBonus.diceViolence);

    ODMALBarbarian = ODMALBarbarian.concat(MALBonus.ODMALBarbarian);
    ODMALRogue = ODMALRogue.concat(MALBonus.ODMALRogue);
    ODMALShaman = ODMALShaman.concat(MALBonus.ODMALShaman);
    ODMALWarrior.push(MALBonus.ODMALWarrior);

    autresEffets = autresEffets.concat(MALBonus.autresEffets);

    // FIN GESTION DES BONUS D'ARMURE
    OD -= armorBonus.ODWarrior;
    OD -= MALBonus.ODMALWarrior;

    exec.push(`{{vOD=${OD}}}`);

    if (cRoll.length === 0) { cRoll.push(0); }

    if (bonus.length === 0) { bonus.push(0); }

    bonus = bonus.concat(OD);
    bonus = bonus.concat(ODBarbarian);
    bonus = bonus.concat(ODMALBarbarian);
    bonus = bonus.concat(ODRogue);
    bonus = bonus.concat(ODMALRogue);
    bonus = bonus.concat(ODShaman);
    bonus = bonus.concat(ODMALShaman);
    bonus = bonus.concat(ODWarrior);
    bonus = bonus.concat(ODMALWarrior);

    degats.push(`${diceDegats}D6`);
    degats = degats.concat(bDegats);

    violence.push(`${diceViolence}D6`);
    violence = violence.concat(bViolence);

    if (cBase.length !== 0) { exec.push(`{{cBase=${cBase.join(' - ')}}}`); }

    if (cBonus.length !== 0) { exec.push(`{{cBonus=${cBonus.join(' - ')}}}`); }

    const jet = `{{jet=[[ {{[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0}]]}}`;

    exec.push(jet);
    exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);
    exec.push(`{{bonus=[[${bonus.join('+')}]]}}`);

    exec.push(`{{degats=[[${degats.join('+')}]]}}`);
    exec.push(`{{violence=[[${violence.join('+')}]]}}`);

    if (attaquesSurprises.length > 0) {
      exec.push(`{{attaqueSurprise=${attaquesSurprises.join('\n+')}}}`);
      exec.push(`{{attaqueSurpriseValue=[[${attaquesSurprisesValue.join('+')}]]}}`);
      exec.push(attaquesSurprisesCondition);

      isSurprise = true;
    }

    if (armure === 'berserk') {
      isConditionnelD = true;
      isConditionnelV = true;

      exec.push(`{{antiAnatheme=${i18n_antiAnatheme}}}`);
      exec.push(`{{antiAnathemeCondition=${i18n_antiAnathemeCondition}}}`);

      exec.push('{{tenebricideValueD=[[0]]}}');
      exec.push('{{tenebricideValueV=[[0]]}}');

      exec.push(`{{tenebricide=${i18n_tenebricide}}}`);
      exec.push(`{{tenebricideConditionD=${i18n_tenebricideConditionD}}}`);
      exec.push(`{{tenebricideConditionV=${i18n_tenebricideConditionV}}}`);

      isTenebricide = true;

      if (attaquesSurprises.length > 0) {
        exec.push(`{{tenebricideAS=${attaquesSurprises.join('\n+')}}}`);
        exec.push('{{tenebricideASValue=[[0]]}}');
      }
    }

    if (devaste || bourreau || equilibre) {
      const herauts = [];

      if (devaste) { herauts.push(i18n_devasterAnatheme); }
      if (bourreau) { herauts.push(i18n_bourreauTenebres); }
      if (equilibre) { herauts.push(i18n_equilibrerBalance); }

      exec.push(`{{herauts=${herauts.join(' / ')}}}`);
    }

    if (autresEffets.length > 0) {
      autresEffets.sort();
      exec.push(`{{effets=${autresEffets.join(' / ')}}}`);
    }

    if (isConditionnelD) { exec.push('{{degatsConditionnel=true}}'); }

    if (isConditionnelV) { exec.push('{{violenceConditionnel=true}}'); }

    // ROLL
    const finalRoll = await startRoll(exec.join(' '));

    const tJet = finalRoll.results.jet.result;

    const tBonus = finalRoll.results.bonus.result;
    const tExploit = finalRoll.results.Exploit.result;

    const rDegats = finalRoll.results.degats.dice;
    const rViolence = finalRoll.results.violence.dice;

    const tDegats = finalRoll.results.degats.result;
    const tViolence = finalRoll.results.violence.result;

    const conditions = {
      bourreau,
      devaste,
      equilibre,
      isSurprise,
      isTenebricide,
    };

    const computed = updateRoll(finalRoll, tDegats, rDegats, bDegats, tViolence, rViolence, bViolence, conditions);

    const finalComputed = {
      jet: tJet + tBonus,
    };

    Object.assign(finalComputed, computed);

    finishRoll(finalRoll.rollId, finalComputed);

    if (tJet !== 0 && tJet === tExploit) {
      const exploitRoll = await startRoll(`${roll}@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${i18n_exploit}}}${jet}`);
      const tRExploit = exploitRoll.results.jet.result;

      const exploitComputed = {
        jet: tRExploit,
      };

      finishRoll(exploitRoll.rollId, exploitComputed);
    }
  });
}
  /* eslint-disable prefer-destructuring */
/* eslint-disable max-len */
/* eslint-disable camelcase */
/* eslint-disable no-undef */
// DRUID
const druidRollSimple = [
  'druidLionChair', 'druidLionBete', 'druidLionMachine', 'druidLionDame', 'druidLionMasque',
  'druidWolfChair', 'druidWolfBete', 'druidWolfMachine', 'druidWolfDame', 'druidWolfMasque',
  'druidCrowChair', 'druidCrowBete', 'druidCrowMachine', 'druidCrowDame', 'druidCrowMasque',
];

druidRollSimple.forEach((button) => {
  on(`clicked:${button}Roll`, async (info) => {
    const roll = info.htmlAttributes.value;

    const attributs = [
      'jetModifDesComp',
    ];

    const attrs = await getAttrsAsync(attributs);

    const exec = [];
    const cRoll = [];
    const bonus = [];

    const mod = +attrs.jetModifDesComp;

    const aspect = button;
    const aNom = aspectCompanionsDruid[aspect];

    const attrsAspects = await getAttrsAsync([
      `${aspect}Base`,
      `${aspect}Evol`,
      `${aspect}AE`,
    ]);

    const aValue = totalADruid(attrsAspects, aspect);

    if (button !== 'druidCrowChair' && button !== 'druidCrowBete' && button !== 'druidCrowMachine' && button !== 'druidCrowDame' && button !== 'druidCrowMasque') {
      const aAE = +attrsAspects[`${aspect}AE`];
      exec.push(`{{vAE=${aAE}}}`);
      bonus.push(aAE);
    } else { bonus.push(0); }

    cRoll.push(aValue);
    cRoll.push(mod);

    exec.push(roll);
    exec.push(`{{cBase=${aNom}}}`);
    exec.push(`{{jet=[[ {{[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0}]]}}`);
    exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);
    exec.push(`{{tBonus=[[${bonus.join('+')}]]}}`);

    startRoll(exec.join(' '), (results) => {
      const tJet = results.results.jet.result;
      const tBonus = results.results.tBonus.result;
      const tExploit = results.results.Exploit.result;

      const total = tJet + tBonus;

      finishRoll(
        results.rollId,
        {
          jet: total,
        },
      );

      if (tJet !== 0 && tJet === tExploit) {
        startRoll(`${roll}@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${i18n_exploit}}}{{jet=[[ {[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`, (exploit) => {
          const tExploit2 = exploit.results.jet.result;

          finishRoll(
            exploit.rollId,
            {
              jet: tExploit2,
            },
          );
        });
      }
    });
  });
});

on('clicked:druidLionArmeBase', async (info) => {
  const roll = info.htmlAttributes.value;

  let attributs = [
    'aspectDruidLionBase',
    'jetModifDesComp',
    'druidLionChairBase',
    'druidLionChairEvol',
    'druidLionBeteBase',
    'druidLionBeteEvol',
    'druidLionBeteAE',
  ];

  const arme = [
    'druidLionBaseNom',
    'druidLionBaseDegats',
    'druidLionBaseDegatsBonus',
    'druidLionBaseViolence',
    'druidLionBaseViolenceBonus',
    'druidLionBasePortee',
  ];

  const special = [
    'coupBDDiversTotal',
    'bDDiversD6',
    'bDDiversFixe',
    'coupBVDiversTotal',
    'bVDiversD6',
    'bVDiversFixe',
    'devasterAnatheme',
    'bourreauTenebres',
    'equilibreBalance',
  ];

  attributs = attributs.concat(arme, special);

  const attrs = await getAttrsAsync(attributs);

  const exec = [];
  exec.push(roll);

  const isConditionnelA = false;
  const isConditionnelD = false;
  const isConditionnelV = false;

  let diceDegats = 0;
  let degats = [];
  const bonusDegats = [];

  let diceViolence = 0;
  let violence = [];
  const bonusViolence = [];

  const portee = attrs.druidLionBasePortee;

  const mod = +attrs.jetModifDesComp;

  const aspect = attrs.aspectDruidLionBase;

  const aspectNom = aspectCompanionsDruid[aspect];

  const attrsAspects = await getAttrsAsync([
    `${aspect}Base`,
    `${aspect}Evol`,
    `${aspect}AE`,
  ]);

  const aspectValue = totalADruid(attrsAspects, aspect);
  const AEValue = +attrsAspects[`${aspect}AE`];

  const vChair = totalADruid(attrs, 'druidLionChair');

  const bete = totalADruid(attrs, 'druidLionBete');
  const AEBete = +attrs.druidLionBeteAE;

  const devaste = +attrs.devasterAnatheme;
  const bourreau = +attrs.bourreauTenebres;
  const equilibre = +attrs.equilibreBalance;

  const cRoll = [];
  const AE = [];
  let bonus = [];

  AE.push(AEValue);

  if (AE.length === 0) { exec.push('{{vAE=0}}'); } else { exec.push(`{{vAE=${AEValue}}}`); }

  cRoll.push(aspectValue);

  diceDegats = +attrs.druidLionBaseDegats;
  bonusDegats.push(+attrs.druidLionBaseDegatsBonus);

  diceViolence = +attrs.druidLionBaseViolence;
  bonusViolence.push(+attrs.druidLionBaseViolenceBonus);

  // GESTION DES BONUS DIVERS
  const bChairD = Math.ceil(vChair / 2);

  bonusDegats.push(bChairD);
  exec.push(`{{vChair=${bChairD}}}`);
  // FIN DE GESTION DES BONUS DIVERS

  // GESTION DES ASPECTS EXCEPTIONNELS
  if (AEBete > 0) {
    let bonusBete = +AEBete;

    if (AEBete > 5) { bonusBete += +bete; }

    exec.push(`{{vBeteD=+${bonusBete}}}`);
    bonusDegats.push(bonusBete);
  }
  // FIN DE GESTION DES ASPECTS EXCEPTIONNELS

  // GESTION DES BONUS SPECIAUX
  const sBonusDegats = attrs.coupBDDiversTotal;
  const sBonusDegatsD6 = attrs.bDDiversD6;
  const sBonusDegatsFixe = +attrs.bDDiversFixe;

  const sBonusViolence = attrs.coupBVDiversTotal;
  const sBonusViolenceD6 = attrs.bVDiversD6;
  const sBonusViolenceFixe = +attrs.bVDiversFixe;

  if (sBonusDegats !== '0') {
    exec.push(`{{vMSpecialD=+${sBonusDegatsD6}D6+${sBonusDegatsFixe}}}`);
    diceDegats += Number(sBonusDegatsD6);
    bonusDegats.push(sBonusDegatsFixe);
  }

  if (sBonusViolence !== '0') {
    exec.push(`{{vMSpecialV=+${sBonusViolenceD6}D6+${sBonusViolenceFixe}}}`);
    diceViolence += Number(sBonusViolenceD6);
    bonusViolence.push(sBonusViolenceFixe);
  }
  // FIN DE GESTION DES BONUS SPECIAUX

  exec.push(`{{cBase=${aspectNom}}}`);

  if (mod !== 0) {
    cRoll.push(mod);
    exec.push(`{{mod=${mod}}}`);
  }

  if (cRoll.length === 0) { cRoll.push(0); }

  bonus = bonus.concat(AE);

  exec.push(`{{jet=[[ {{[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0}]]}}`);
  exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);
  exec.push(`{{bonus=[[${bonus.join('+')}]]}}`);

  degats.push(`${diceDegats}D6`);
  degats = degats.concat(bonusDegats);

  violence.push(`${diceViolence}D6`);
  violence = violence.concat(bonusViolence);

  exec.push(`{{portee=${i18n_portee} ${portee}}}`);
  exec.push(`{{degats=[[${degats.join('+')}]]}}`);
  exec.push(`{{violence=[[${violence.join('+')}]]}}`);

  if (devaste || bourreau || equilibre) {
    const herauts = [];

    if (devaste) { herauts.push(i18n_devasterAnatheme); }
    if (bourreau) { herauts.push(i18n_bourreauTenebres); }
    if (equilibre) { herauts.push(i18n_equilibrerBalance); }

    exec.push(`{{herauts=${herauts.join(' / ')}}}`);
  }

  if (isConditionnelA === true) { exec.push('{{succesConditionnel=true}}'); }

  if (isConditionnelD === true) { exec.push('{{degatsConditionnel=true}}'); }

  if (isConditionnelV === true) { exec.push('{{violenceConditionnel=true}}'); }

  const finalRoll = await startRoll(exec.join(' '));

  const tJet = finalRoll.results.jet.result;

  const tBonus = finalRoll.results.bonus.result;
  const tExploit = finalRoll.results.Exploit.result;

  const rDegats = finalRoll.results.degats.dice;
  const rViolence = finalRoll.results.violence.dice;

  const tDegats = finalRoll.results.degats.result;
  const tViolence = finalRoll.results.violence.result;

  const conditions = {
    bourreau,
    devaste,
    equilibre,
  };

  const computed = updateRoll(finalRoll, tDegats, rDegats, bonusDegats, tViolence, rViolence, bonusViolence, conditions);

  const finalComputed = {
    jet: tJet + tBonus,
  };

  Object.assign(finalComputed, computed);

  finishRoll(finalRoll.rollId, finalComputed);

  if (tJet !== 0 && tJet === tExploit) {
    const exploitRoll = await startRoll(`${roll}@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${i18n_exploit}}}{{jet=[[ {[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`);
    const tRExploit = exploitRoll.results.jet.result;

    const exploitComputed = {
      jet: tRExploit,
    };

    finishRoll(exploitRoll.rollId, exploitComputed);
  }
});

on('clicked:repeating_armeDruidLion:combatdruidroll', async (info) => {
  const roll = info.htmlAttributes.value;

  let attributs = [
    'repeating_armeDruidLion_armeDruidLion',
    'repeating_armeDruidLion_aspectDruidLion',
    'jetModifDesComp',
    'druidLionPEAct',
    'druidLionChairBase',
    'druidLionChairEvol',
    'druidLionBeteBase',
    'druidLionBeteEvol',
    'druidLionBeteAE',
    'druidLionMachineBase',
    'druidLionMachineEvol',
    'druidLionMachineAE',
    'druidLionMasqueBase',
    'druidLionMasqueEvol',
    'druidLionMasqueAE',
  ];

  const wpn = [
    'repeating_armeDruidLion_druidLionBaseNom',
    'repeating_armeDruidLion_degatDruidLion',
    'repeating_armeDruidLion_degatBonusDruidLion',
    'repeating_armeDruidLion_violenceDruidLion',
    'repeating_armeDruidLion_violenceBonusDruidLion',
    'repeating_armeDruidLion_porteeDruidLion',
  ];

  const effets = [
    'repeating_armeDruidLion_antiAnatheme',
    'repeating_armeDruidLion_antiVehicule',
    'repeating_armeDruidLion_artillerie',
    'repeating_armeDruidLion_assassin',
    'repeating_armeDruidLion_assassinValue',
    'repeating_armeDruidLion_assistanceAttaque',
    'repeating_armeDruidLion_barrage',
    'repeating_armeDruidLion_barrageValue',
    'repeating_armeDruidLion_cadence',
    'repeating_armeDruidLion_cadenceValue',
    'repeating_armeDruidLion_chargeur',
    'repeating_armeDruidLion_chargeurValue',
    'repeating_armeDruidLion_choc',
    'repeating_armeDruidLion_chocValue',
    'repeating_armeDruidLion_defense',
    'repeating_armeDruidLion_defenseValue',
    'repeating_armeDruidLion_degatContinue',
    'repeating_armeDruidLion_degatContinueValue',
    'repeating_armeDruidLion_deuxMains',
    'repeating_armeDruidLion_demoralisant',
    'repeating_armeDruidLion_designation',
    'repeating_armeDruidLion_destructeur',
    'repeating_armeDruidLion_dispersion',
    'repeating_armeDruidLion_dispersionValue',
    'repeating_armeDruidLion_enChaine',
    'repeating_armeDruidLion_esperance',
    'repeating_armeDruidLion_fureur',
    'repeating_armeDruidLion_ignoreArmure',
    'repeating_armeDruidLion_ignoreCdF',
    'repeating_armeDruidLion_akimbo',
    'repeating_armeDruidLion_ambidextrie',
    'repeating_armeDruidLion_leste',
    'repeating_armeDruidLion_lourd',
    'repeating_armeDruidLion_lumiere',
    'repeating_armeDruidLion_lumiereValue',
    'repeating_armeDruidLion_meurtrier',
    'repeating_armeDruidLion_obliteration',
    'repeating_armeDruidLion_orfevrerie',
    'repeating_armeDruidLion_parasitage',
    'repeating_armeDruidLion_parasitageValue',
    'repeating_armeDruidLion_penetrant',
    'repeating_armeDruidLion_penetrantValue',
    'repeating_armeDruidLion_perceArmure',
    'repeating_armeDruidLion_perceArmureValue',
    'repeating_armeDruidLion_precision',
    'repeating_armeDruidLion_reaction',
    'repeating_armeDruidLion_reactionValue',
    'repeating_armeDruidLion_silencieux',
    'repeating_armeDruidLion_soumission',
    'repeating_armeDruidLion_tenebricite',
    'repeating_armeDruidLion_tirRafale',
    'repeating_armeDruidLion_tirSecurite',
    'repeating_armeDruidLion_ultraViolence',
  ];

  const ameliorations = [
    'repeating_armeDruidLion_chargeurGrappes',
    'repeating_armeDruidLion_canonLong',
    'repeating_armeDruidLion_canonRaccourci',
    'repeating_armeDruidLion_chambreDouble',
    'repeating_armeDruidLion_interfaceGuidage',
    'repeating_armeDruidLion_jumelage',
    'repeating_armeDruidLion_jumelageValue',
    'repeating_armeDruidLion_jumelageType',
    'repeating_armeDruidLion_lunetteIntelligente',
    'repeating_armeDruidLion_munitionsHyperVelocite',
    'repeating_armeDruidLion_munitionsDrone',
    'repeating_armeDruidLion_chargeurExplosives',
    'repeating_armeDruidLion_munitionsIEM',
    'repeating_armeDruidLion_munitionsNonLetales',
    'repeating_armeDruidLion_munitionsSubsoniques',
    'repeating_armeDruidLion_pointeurLaser',
    'repeating_armeDruidLion_protectionArme',
    'repeating_armeDruidLion_revetementOmega',
    'repeating_armeDruidLion_structureElement',
    'repeating_armeDruidLion_systemeRefroidissement',
  ];

  const special = [
    'repeating_armeDruidLion_bDDiversTotal',
    'repeating_armeDruidLion_bDDiversD6',
    'repeating_armeDruidLion_bDDiversFixe',
    'repeating_armeDruidLion_bVDiversTotal',
    'repeating_armeDruidLion_bVDiversD6',
    'repeating_armeDruidLion_bVDiversFixe',
    'repeating_armeDruidLion_energie',
    'repeating_armeDruidLion_energieValue',
    'devasterAnatheme',
    'bourreauTenebres',
    'equilibreBalance',
  ];

  attributs = attributs.concat(wpn, effets, ameliorations, special);

  const attrs = await getAttrsAsync(attributs);

  const exec = [];
  exec.push(roll);

  let isConditionnelA = false;
  let isConditionnelD = false;
  let isConditionnelV = false;

  const arme = attrs.repeating_armeDruidLion_armeDruidLion;

  let diceDegats = 0;
  let degats = [];
  const bonusDegats = [];

  let diceViolence = 0;
  let violence = [];
  const bonusViolence = [];

  const attaquesSurprises = [];
  const attaquesSurprisesValue = [];
  let attaquesSurprisesCondition = '';

  let eASAssassin = '';
  let eASAssassinValue = 0;

  const energie = +attrs.druidLionPEAct;
  const nEnergie = 'druidLionPEAct';
  const portee = attrs.repeating_armeDruidLion_porteeDruidLion;
  const autresEffets = [];
  const autresAmeliorations = [];
  const autresSpecial = [];

  const mod = +attrs.jetModifDesComp;

  const aspect = attrs.repeating_armeDruidLion_aspectDruidLion;

  const aspectNom = aspectCompanionsDruid[aspect];

  const attrsAspects = await getAttrsAsync([
    `${aspect}Base`,
    `${aspect}Evol`,
    `${aspect}AE`,
  ]);

  const aspectValue = totalADruid(attrsAspects, aspect);
  const AEValue = +attrsAspects[`${aspect}AE`];

  const vChair = totalADruid(attrs, 'druidLionChair');

  const vBete = totalADruid(attrs, 'druidLionBete');
  const vAEBete = +attrs.druidLionBeteAE;

  const vMachine = totalADruid(attrs, 'druidLionMachine');
  const vAEMachine = +attrs.druidLionMachineAE;

  const vMasque = totalADruid(attrs, 'druidLionMasque');
  const vAEMasque = +attrs.druidLionMasqueAE;

  const devaste = +attrs.devasterAnatheme;
  const bourreau = +attrs.bourreauTenebres;
  const equilibre = +attrs.equilibreBalance;

  let isDestructeur = false;
  let isFureur = false;
  let isMeurtrier = false;
  let isUltraviolence = false;
  let isSurprise = false;
  let isTenebricide = false;

  const cRoll = [];
  const AE = [];
  let bonus = [];

  AE.push(AEValue);

  exec.push(`{{special1B=${arme}}}`);

  if (AE.length === 0) { exec.push('{{vAE=0}}'); } else { exec.push(`{{vAE=${AEValue}}}`); }

  cRoll.push(aspectValue);

  diceDegats = Number(attrs.repeating_armeDruidLion_degatDruidLion);
  bonusDegats.push(+attrs.repeating_armeDruidLion_degatBonusDruidLion);

  diceViolence = Number(attrs.repeating_armeDruidLion_violenceDruidLion);
  bonusViolence.push(+attrs.repeating_armeDruidLion_violenceBonusDruidLion);

  // GESTION DES BONUS DIVERS
  let bChairD = Math.ceil(vChair / 2);

  if (portee === '^{portee-contact}') {
    bonusDegats.push(bChairD);
    exec.push(`{{vChair=${bChairD}}}`);
  }
  // FIN DE GESTION DES BONUS DIVERS

  // GESTION DES ASPECTS EXCEPTIONNELS
  if (vAEBete > 0) {
    let bonusBete = +vAEBete;

    if (vAEBete > 5) { bonusBete += vBete; }

    exec.push(`{{vBeteD=+${bonusBete}}}`);
    bonusDegats.push(bonusBete);
  }
  // FIN DE GESTION DES ASPECTS EXCEPTIONNELS

  // GESTION DES EFFETS
  let rCadence = 0;

  const eAntiAnatheme = attrs.repeating_armeDruidLion_antiAnatheme;
  const eAntiVehicule = attrs.repeating_armeDruidLion_antiVehicule;
  const eArtillerie = attrs.repeating_armeDruidLion_artillerie;
  const eAssassin = attrs.repeating_armeDruidLion_repeating_armeDruidLion_assassin;
  const eAssassinV = attrs.repeating_armeDruidLion_assassinValue;
  const eAssistanceAttaque = attrs.repeating_armeDruidLion_assistanceAttaque;
  const eBarrage = attrs.repeating_armeDruidLion_barrage;
  const eBarrageV = attrs.repeating_armeDruidLion_barrageValue;
  const eCadence = attrs.repeating_armeDruidLion_cadence;
  const eCadenceV = attrs.repeating_armeDruidLion_cadenceValue;
  const eChargeur = attrs.repeating_armeDruidLion_chargeur;
  const eChargeurV = attrs.repeating_armeDruidLion_chargeurValue;
  const eChoc = attrs.repeating_armeDruidLion_choc;
  const eChocV = attrs.repeating_armeDruidLion_chocValue;
  const eDefense = attrs.repeating_armeDruidLion_defense;
  const eDefenseV = attrs.repeating_armeDruidLion_defenseValue;
  const eDegatsContinus = attrs.repeating_armeDruidLion_degatContinue;
  const eDegatsContinusV = attrs.repeating_armeDruidLion_degatContinueValue;
  const eDeuxMains = attrs.repeating_armeDruidLion_deuxMains;
  const eDemoralisant = attrs.repeating_armeDruidLion_demoralisant;
  const eDesignation = attrs.repeating_armeDruidLion_designation;
  const eDestructeur = attrs.repeating_armeDruidLion_destructeur;
  const eDestructeurV = 2;
  const eDispersion = attrs.repeating_armeDruidLion_dispersion;
  const eDispersionV = attrs.repeating_armeDruidLion_dispersionValue;
  const eEnChaine = attrs.repeating_armeDruidLion_enChaine;
  const eEsperance = attrs.repeating_armeDruidLion_esperance;
  const eFureur = attrs.repeating_armeDruidLion_fureur;
  const eFureurV = 4;
  const eIgnoreArmure = attrs.repeating_armeDruidLion_ignoreArmure;
  const eIgnoreCDF = attrs.repeating_armeDruidLion_ignoreCdF;
  const eJAkimbo = attrs.repeating_armeDruidLion_akimbo;
  const eJAmbidextrie = attrs.repeating_armeDruidLion_ambidextrie;
  const eLeste = attrs.repeating_armeDruidLion_leste;
  const eLourd = attrs.repeating_armeDruidLion_lourd;
  const eLumiere = attrs.repeating_armeDruidLion_lumiere;
  const eLumiereV = attrs.repeating_armeDruidLion_lumiereValue;
  const eMeurtrier = attrs.repeating_armeDruidLion_meurtrier;
  const eMeurtrierV = 2;
  const eObliteration = attrs.repeating_armeDruidLion_obliteration;
  const eOrfevrerie = attrs.repeating_armeDruidLion_orfevrerie;
  const eParasitage = attrs.repeating_armeDruidLion_parasitage;
  const eParasitageV = attrs.repeating_armeDruidLion_parasitageValue;
  const ePenetrant = attrs.repeating_armeDruidLion_penetrant;
  const ePenetrantV = attrs.repeating_armeDruidLion_penetrantValue;
  const ePerceArmure = attrs.repeating_armeDruidLion_perceArmure;
  const ePerceArmureV = attrs.repeating_armeDruidLion_perceArmureValue;
  const ePrecision = attrs.repeating_armeDruidLion_precision;
  const eReaction = attrs.repeating_armeDruidLion_reaction;
  const eReactionV = attrs.repeating_armeDruidLion_reactionValue;
  const eSilencieux = attrs.repeating_armeDruidLion_silencieux;
  const eSoumission = attrs.repeating_armeDruidLion_soumission;
  const eTenebricide = attrs.repeating_armeDruidLion_tenebricite;
  const eTirRafale = attrs.repeating_armeDruidLion_tirRafale;
  const eTirSecurite = attrs.repeating_armeDruidLion_tirSecurite;
  const eUltraviolence = attrs.repeating_armeDruidLion_ultraViolence;
  const eUltraviolenceV = 2;

  if (eAntiAnatheme !== '0') {
    isConditionnelD = true;
    isConditionnelV = true;
    exec.push(`{{antiAnatheme=${i18n_antiAnatheme}}}`);
    exec.push(`{{antiAnathemeCondition=${i18n_antiAnathemeCondition}}}`);
  }

  if (eAssistanceAttaque !== '0') {
    isConditionnelD = true;
    isConditionnelV = true;

    exec.push(`{{assistanceAttaque=${i18n_assistanceAttaque}}}`);
    exec.push(`{{assistanceAttaqueCondition=${i18n_assistanceAttaqueCondition}}}`);
  }

  if (eArtillerie !== '0') {
    isConditionnelA = true;
    exec.push(`{{artillerie=${i18n_artillerie}}}`);
    exec.push(`{{artillerieCondition=${i18n_artillerieCondition}}}`);
  }

  if (eAssassin !== '0') {
    isConditionnelD = true;
    eASAssassin = i18n_assassin;
    eASAssassinValue = eAssassinV;

    if (attaquesSurprisesCondition === '') { attaquesSurprisesCondition = `{{attaqueSurpriseCondition=${i18n_attaqueSurpriseCondition}}}`; }
  }

  if (eCadence !== '0') {
    rCadence = '?{Plusieurs cibles ?|Oui, 3|Non, 0}';
  }

  if (eChoc !== '0') {
    isConditionnelA = true;
    exec.push(`{{choc=${i18n_choc} ${eChocV}}}`);
    exec.push(`{{chocCondition=${i18n_chocCondition}}}`);
  }

  if (eDemoralisant !== '0') {
    isConditionnelA = true;
    exec.push(`{{demoralisant=${i18n_demoralisant}}}`);
    exec.push(`{{demoralisantCondition=${i18n_demoralisantCondition}}}`);
  }

  if (eDestructeur !== '0') {
    isConditionnelD = true;
    exec.push(`{{destructeur=${i18n_destructeur}}}`);
    exec.push(`{{destructeurValue=[[${eDestructeurV}D6]]}}`);
    exec.push(`{{destructeurCondition=${i18n_destructeurCondition}}}`);

    isDestructeur = true;
  }

  if (eEnChaine !== '0') {
    isConditionnelD = true;
    exec.push(`{{enChaine=${i18n_enChaine}}}`);
    exec.push(`{{enChaineCondition=${i18n_enChaineCondition}}}`);
  }

  if (eEsperance !== '0') {
    isConditionnelD = true;
    isConditionnelV = true;
    exec.push(`{{esperance=${i18n_esperance}}}`);
    exec.push(`{{esperanceConditionD=${i18n_esperanceConditionD}}}`);
    exec.push(`{{esperanceConditionV=${i18n_esperanceConditionV}}}`);
  }

  if (eFureur !== '0') {
    isConditionnelV = true;
    exec.push(`{{fureur=${i18n_fureur}}}`);
    exec.push(`{{fureurValue=[[${eFureurV}D6]]}}`);
    exec.push(`{{fureurCondition=${i18n_fureurCondition}}}`);

    isFureur = true;
  }

  if (eLeste !== '0') {
    if (portee !== '^{portee-contact}') { bChairD = vChair; }

    bonusDegats.push(bChairD);
    exec.push(`{{vLeste=${bChairD}}}`);
  }

  if (eMeurtrier !== '0') {
    isConditionnelD = true;
    exec.push(`{{meurtrier=${i18n_meurtrier}}}`);
    exec.push(`{{meurtrierValue=[[${eMeurtrierV}D6]]}}`);
    exec.push(`{{meurtrierCondition=${i18n_meurtrierCondition}}}`);

    isMeurtrier = true;
  }

  if (eObliteration !== '0') {
    isConditionnelD = true;
    exec.push(`{{obliteration=${i18n_obliteration}}}`);
    exec.push(`{{obliterationCondition=${i18n_obliterationCondition}}}`);
  }

  if (eOrfevrerie !== '0') {
    const vOrfevrerie = Math.ceil((vMasque / 2) + vAEMasque);

    bonusDegats.push(vOrfevrerie);
    exec.push(`{{vOrfevrerie=${vOrfevrerie}}}`);
  }

  if (eParasitage !== '0') {
    isConditionnelA = true;
    exec.push(`{{parasitage=${i18n_parasitage} ${eParasitageV}}}`);
    exec.push(`{{parasitageCondition=${i18n_parasitageCondition}}}`);
  }

  if (ePrecision !== '0') {
    isConditionnelD = true;
    const vPrecision = Math.ceil((vMachine / 2) + vAEMachine);

    bonusDegats.push(vPrecision);
    exec.push(`{{vPrecision=${vPrecision}}}`);
  }

  if (eSilencieux !== '0') {
    const totalSilencieux = Math.ceil((vMasque / 2) + vAEMasque);

    attaquesSurprises.push(i18n_silencieux);
    attaquesSurprisesValue.push(totalSilencieux);
    isConditionnelD = true;

    if (attaquesSurprisesCondition === '') { attaquesSurprisesCondition = `{{attaqueSurpriseCondition=${i18n_attaqueSurpriseCondition}}}`; }
  }

  if (eSoumission !== '0') {
    isConditionnelA = true;
    exec.push(`{{soumission=${i18n_soumission}}}`);
    exec.push(`{{soumissionCondition=${i18n_soumissionCondition}}}`);
  }

  if (eTenebricide !== '0') {
    exec.push(`{{tenebricide=${i18n_tenebricide}}}`);
    exec.push(`{{tenebricideConditionD=${i18n_tenebricideConditionD}}}`);
    exec.push(`{{tenebricideConditionV=${i18n_tenebricideConditionV}}}`);
    isConditionnelD = true;
    isConditionnelV = true;
  }

  if (eTirRafale !== '0') {
    exec.push(`{{tirRafale=${i18n_tirRafale}}}`);
    exec.push(`{{tirRafaleCondition=${i18n_tirRafaleCondition}}}`);
    isConditionnelD = true;
  }

  if (eUltraviolence !== '0') {
    exec.push(`{{ultraviolence=${i18n_ultraviolence}}}`);
    exec.push(`{{ultraviolenceValue=[[${eUltraviolenceV}D6]]}}`);
    exec.push(`{{ultraviolenceCondition=${i18n_ultraviolenceCondition}}}`);

    isConditionnelV = true;
    isUltraviolence = true;
  }

  if (eAntiVehicule !== '0') { autresEffets.push(i18n_antiVehicule); }

  if (eBarrage !== '0') { autresEffets.push(`${i18n_barrage} ${eBarrageV}`); }

  if (eChargeur !== '0') { autresEffets.push(`${i18n_chargeur} ${eChargeurV}`); }

  if (eDefense !== '0') { autresEffets.push(`${i18n_defense} ${eDefenseV}`); }

  if (eDegatsContinus !== '0') { autresEffets.push(`${i18n_degatsContinus} ${eDegatsContinusV} ([[1d6]] ${i18n_tours})`); }

  if (eDeuxMains !== '0') { autresEffets.push(i18n_deuxMains); }

  if (eDesignation !== '0') { autresEffets.push(i18n_designation); }

  if (eDispersion !== '0') { autresEffets.push(`${i18n_dispersion} ${eDispersionV}`); }

  if (eIgnoreArmure !== '0') { autresEffets.push(i18n_ignoreArmure); }

  if (eIgnoreCDF !== '0') { autresEffets.push(i18n_ignoreCDF); }

  if (eJAkimbo !== '0') { autresEffets.push(i18n_jAkimbo); }

  if (eJAmbidextrie !== '0') { autresEffets.push(i18n_jAmbidextrie); }

  if (eLourd !== '0') { autresEffets.push(i18n_lourd); }

  if (eLumiere !== '0') { autresEffets.push(`${i18n_lumiere} ${eLumiereV}`); }

  if (ePenetrant !== '0') { autresEffets.push(`${i18n_penetrant} ${ePenetrantV}`); }

  if (ePerceArmure !== '0') { autresEffets.push(`${i18n_perceArmure} ${ePerceArmureV}`); }

  if (eReaction !== '0') { autresEffets.push(`${i18n_reaction} ${eReactionV}`); }

  if (eTirSecurite !== '0') { autresEffets.push(i18n_tirSecurite); }

  // FIN GESTION DES EFFETS

  // GESTION DES AMELIORATIONS
  let rChambreDouble = 0;

  const aChargeurGrappes = attrs.repeating_armeDruidLion_chargeurGrappes;
  const aCanonLong = attrs.repeating_armeDruidLion_canonLong;
  const aCanonRaccourci = attrs.repeating_armeDruidLion_canonRaccourci;
  const aChambreDouble = attrs.repeating_armeDruidLion_chambreDouble;
  const aInterfaceGuidage = attrs.repeating_armeDruidLion_interfaceGuidage;
  const aJumelage = attrs.repeating_armeDruidLion_jumelage;
  const aJumelageV = attrs.repeating_armeDruidLion_jumelageValue;
  const aLunetteIntelligente = attrs.repeating_armeDruidLion_lunetteIntelligente;
  const aMunitionsDrone = attrs.repeating_armeDruidLion_munitionsDrone;
  const aMunitionsHyperVelocite = attrs.repeating_armeDruidLion_munitionsHyperVelocite;
  const aChargeurExplosives = attrs.repeating_armeDruidLion_chargeurExplosives;
  const aMunitionsIEM = attrs.repeating_armeDruidLion_munitionsIEM;
  const aMunitionsNonLetales = attrs.repeating_armeDruidLion_munitionsNonLetales;
  const aMunitionsSubsoniques = attrs.repeating_armeDruidLion_munitionsSubsoniques;
  const aPointeurLaser = attrs.repeating_armeDruidLion_pointeurLaser;
  const aProtectionArme = attrs.repeating_armeDruidLion_protectionArme;
  const aRevetementOmega = attrs.repeating_armeDruidLion_revetementOmega;
  const aStructureElement = attrs.repeating_armeDruidLion_structureElement;
  const aSystemeRefroidissement = attrs.repeating_armeDruidLion_systemeRefroidissement;

  if (aChargeurGrappes !== '0') {
    exec.push('{{vMGrappeD=-1D6}}');
    exec.push('{{vMGrappeV=+1D6}}');
    diceDegats -= 1;
    diceViolence += 1;
  }

  if (aCanonLong !== '0') {
    isConditionnelA = true;
    exec.push(`{{canonLong=${i18n_canonLong}}}`);
    exec.push(`{{canonLongCondition=${i18n_canonLongCondition}}}`);
  }

  if (aCanonRaccourci !== '0') {
    isConditionnelA = true;
    exec.push(`{{canonRaccourci=${i18n_canonRaccourci}}}`);
    exec.push(`{{canonRaccourciCondition=${i18n_canonRaccourciCondition}}}`);
  }

  if (aChambreDouble !== '0') {
    if (eCadence !== 0) { autresAmeliorations.push(i18n_chambreDouble); } else if (eCadence === 0) { rChambreDouble = '?{Plusieurs cibles ?|Oui, 3|Non, 0}'; }
  }

  if (aLunetteIntelligente !== '0') {
    isConditionnelA = true;
    exec.push(`{{lunetteIntelligente=${i18n_lunetteIntelligente}}}`);
    exec.push(`{{lunetteIntelligenteCondition=${i18n_lunetteIntelligenteCondition}}}`);
  }

  if (aMunitionsDrone !== '0') {
    exec.push('{{vMDrone=+3}}');
    bonus.push(3);
  }

  if (aMunitionsHyperVelocite !== '0') {
    if (eAssistanceAttaque !== '0') { autresAmeliorations.push(i18n_munitionsHyperVelocite); } else if (eAssistanceAttaque === '0') {
      isConditionnelD = true;
      isConditionnelV = true;

      exec.push(`{{assistanceAttaque=${i18n_munitionsHyperVelocite}}}`);
      exec.push(`{{assistanceAttaqueCondition=${i18n_assistanceAttaqueCondition}}}`);
    }
  }

  if (aChargeurExplosives !== '0') {
    exec.push('{{vMExplosiveD=+1D6}}');
    exec.push('{{vMExplosiveV=-1D6}}');
    diceDegats += 1;
    diceViolence -= 1;
  }

  if (aMunitionsIEM !== '0') {
    exec.push('{{vMIEMD=-1D6}}');
    exec.push('{{vMIEMV=-1D6}}');
    diceDegats -= 1;
    diceViolence -= 1;
    autresAmeliorations.push(i18n_munitionsIEMParasitage);
  }

  if (aMunitionsSubsoniques !== '0') {
    if (eSilencieux !== '0') { autresAmeliorations.push(i18n_munitionsSubsoniques); } else if (eSilencieux === '0') {
      const totalSubsonique = vDiscretion + oDiscretion;

      attaquesSurprises.push(i18n_munitionsSubsoniques);
      attaquesSurprisesValue.push(totalSubsonique);

      if (attaquesSurprisesCondition === '') { attaquesSurprisesCondition = `{{attaqueSurpriseCondition=${i18n_attaqueSurpriseCondition}}}`; }
    }
  }

  if (aPointeurLaser !== '0') {
    exec.push('{{vMPLaser=+1}}');
    bonus.push(1);
  }

  if (aSystemeRefroidissement !== '0') {
    if (eTirRafale !== '0') { autresAmeliorations.push(`${i18n_systemeRefroidissement} (${i18n_barrage} 1)`); } else if (eTirRafale === '0') {
      exec.push(`{{tirRafale=${i18n_systemeRefroidissement} + ${i18n_barrage} 1}}`);
      exec.push(`{{tirRafaleCondition=${i18n_tirRafaleCondition}}}`);
    }
  }

  if (aRevetementOmega !== '0') {
    if (eASAssassinValue < 2) {
      eASAssassin = i18n_revetementOmega;
      eASAssassinValue = 2;

      if (eASAssassinValue !== 0) { autresEffets.push(i18n_assassin); }
    } else if (eASAssassinValue > 2) { autresAmeliorations.push(i18n_revetementOmega); }
  }

  if (aInterfaceGuidage !== '0') { autresAmeliorations.push(i18n_interfaceGuidage); }

  if (aJumelage !== '0') { autresAmeliorations.push(`${i18n_jumelage} (${aJumelageV})`); }

  if (aMunitionsNonLetales !== '0') { autresAmeliorations.push(i18n_munitionsNonLetales); }

  if (aProtectionArme !== '0') { autresAmeliorations.push(i18n_protectionArme); }

  if (aStructureElement !== '0') { autresAmeliorations.push(i18n_structureElementAlpha); }

  // FIN GESTION DES AMELIORATIONS

  // GESTION DES BONUS SPECIAUX
  const sBonusDegats = attrs.repeating_armeDruidLion_bDDiversTotal;
  const sBonusDegatsD6 = attrs.repeating_armeDruidLion_bDDiversD6;
  const sBonusDegatsFixe = +attrs.repeating_armeDruidLion_bDDiversFixe;

  const sBonusViolence = attrs.repeating_armeDruidLion_bVDiversTotal;
  const sBonusViolenceD6 = attrs.repeating_armeDruidLion_bVDiversD6;
  const sBonusViolenceFixe = +attrs.repeating_armeDruidLion_bVDiversFixe;

  const sEnergie = attrs.repeating_armeDruidLion_energie;
  const sEnergieValue = attrs.repeating_armeDruidLion_energieValue;

  let pasDEnergie = false;
  let sEnergieText = '';
  let newEnergie = 0;

  if (sBonusDegats !== '0') {
    exec.push(`{{vMSpecialD=+${sBonusDegatsD6}D6+${sBonusDegatsFixe}}}`);

    diceDegats += Number(sBonusDegatsD6);
    bonusDegats.push(sBonusDegatsFixe);
  }

  if (sBonusViolence !== '0') {
    exec.push(`{{vMSpecialV=+${sBonusViolenceD6}D6+${sBonusViolenceFixe}}}`);

    diceViolence += Number(sBonusViolenceD6);
    bonusViolence.push(sBonusViolenceFixe);
  }

  if (sEnergie !== '0') {
    autresSpecial.push(`${i18n_energieRetiree} (${sEnergieValue})`);

    newEnergie = Number(energie) - Number(sEnergieValue);

    if (newEnergie === 0) {
      sEnergieText = i18n_plusEnergie;
    } else if (newEnergie < 0) {
      newEnergie = 0;
      sEnergieText = i18n_pasEnergie;
      pasDEnergie = true;
    }

    exec.push(`{{energieR=${newEnergie}}}`);
  }
  // FIN DE GESTION DES BONUS SPECIAUX

  exec.push(`{{cBase=${aspectNom}}}`);

  if (mod !== 0) {
    cRoll.push(mod);
    exec.push(`{{mod=${mod}}}`);
  }

  if (cRoll.length === 0) { cRoll.push(0); }

  bonus = bonus.concat(AE);

  exec.push(`{{jet=[[ {[[{${cRoll.join('+')}-${rCadence}-${rChambreDouble}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`);
  exec.push(`{{Exploit=[[${cRoll.join('+')}-${rCadence}-${rChambreDouble}]]}}`);
  exec.push(`{{bonus=[[${bonus.join('+')}]]}}`);

  if (diceDegats < 0) { diceDegats = 0; }

  degats.push(`${diceDegats}D6`);
  degats = degats.concat(bonusDegats);

  if (diceViolence < 0) { diceViolence = 0; }

  violence.push(`${diceViolence}D6`);
  violence = violence.concat(bonusViolence);

  exec.push(`{{portee=${i18n_portee} ${portee}}}`);
  exec.push(`{{degats=[[${degats.join('+')}]]}}`);
  exec.push(`{{violence=[[${violence.join('+')}]]}}`);

  if (eObliteration !== '0') {
    let ASObliteration = [];
    let ASValueObliteration = [];

    diceDegatsObliteration = diceDegats * 6;

    degatsFObliteration = _.reduce(bonusDegats, (n1, n2) => Number(n1) + Number(n2));

    const vObliteration = diceDegatsObliteration + degatsFObliteration;

    exec.push(`{{obliterationValue=${vObliteration}}}`);

    if (eMeurtrier !== '0') { exec.push(`{{obliterationMeurtrierValue=${eMeurtrierV * 6}}}`); }

    if (eDestructeur !== '0') { exec.push(`{{obliterationDestructeurValue=${eDestructeurV * 6}}}`); }

    if (eASAssassinValue > 0) {
      eAssassinTenebricideValue = eASAssassinValue * 6;

      ASObliteration.unshift(eASAssassin);
      ASValueObliteration.unshift(eAssassinTenebricideValue);

      if (attaquesSurprises.length > 0) {
        ASObliteration = ASObliteration.concat(attaquesSurprises);
        ASValueObliteration = ASValueObliteration.concat(attaquesSurprisesValue);
      }

      exec.push(`{{obliterationAS=${ASObliteration.join('\n+')}}}`);
      exec.push(`{{obliterationASValue=[[${ASValueObliteration.join('+')}]]}}`);
    } else if (attaquesSurprises.length > 0) {
      ASObliteration = ASObliteration.concat(attaquesSurprises);
      ASValueObliteration = ASValueObliteration.concat(attaquesSurprisesValue);

      exec.push(`{{obliterationAS=${ASTenebricide.join('\n+')}}}`);
      exec.push(`{{obliterationASValue=${_.reduce(ASValueObliteration, (n1, n2) => n1 + n2, 0)}}}`);
    }
  }

  if (rCadence !== 0) {
    exec.push(`{{rCadence=${i18n_cadence} ${eCadenceV} ${i18n_inclus}}}`);
    exec.push(`{{vCadence=${rCadence}D6}}`);
  }

  if (rChambreDouble !== 0) { exec.push(`{{vChambreDouble=${rChambreDouble}}}`); }

  if (eASAssassinValue > 0) {
    attaquesSurprises.unshift(eASAssassin);
    attaquesSurprisesValue.unshift(`${eASAssassinValue}D6`);
  }

  if (attaquesSurprises.length > 0) {
    exec.push(`{{attaqueSurprise=${attaquesSurprises.join('\n+')}}}`);
    exec.push(`{{attaqueSurpriseValue=[[${attaquesSurprisesValue.join('+')}]]}}`);
    exec.push(attaquesSurprisesCondition);

    isSurprise = true;
  }

  if (eTenebricide !== '0') {
    isTenebricide = true;

    exec.push('{{tenebricideValueD=[[0]]}}');
    exec.push('{{tenebricideValueV=[[0]]}}');

    if (attaquesSurprises.length > 0) {
      exec.push(`{{tenebricideAS=${attaquesSurprises.join('\n+')}}}`);
      exec.push('{{tenebricideASValue=[[0]]}}');
    }

    if (isMeurtrier) { firstExec.push('{{tMeurtrierValue=[[0]]}}'); }
    if (isDestructeur) { firstExec.push('{{tDestructeurValue=[[0]]}}'); }
    if (isFureur) { firstExec.push('{{tFureurValue=[[0]]}}'); }
    if (isUltraviolence) { firstExec.push('{{tUltraviolenceValue=[[0]]}}'); }
  }

  if (devaste || bourreau || equilibre) {
    const herauts = [];

    if (devaste) { herauts.push(i18n_devasterAnatheme); }
    if (bourreau) { herauts.push(i18n_bourreauTenebres); }
    if (equilibre) { herauts.push(i18n_equilibrerBalance); }

    exec.push(`{{herauts=${herauts.join(' / ')}}}`);
  }

  if (autresEffets.length > 0) { exec.push(`{{effets=${autresEffets.join(' / ')}}}`); }

  if (autresAmeliorations.length > 0) { exec.push(`{{ameliorations=${autresAmeliorations.join(' / ')}}}`); }

  if (autresSpecial.length > 0) { exec.push(`{{special=${autresSpecial.join(' / ')}}}`); }

  if (isConditionnelA === true) { exec.push('{{succesConditionnel=true}}'); }

  if (isConditionnelD === true) { exec.push('{{degatsConditionnel=true}}'); }

  if (isConditionnelV === true) { exec.push('{{violenceConditionnel=true}}'); }

  log(exec);

  if (pasDEnergie === false) {
    const finalRoll = await startRoll(exec.join(' '));

    const tJet = finalRoll.results.jet.result;
    const tJetDice = finalRoll.results.jet.dice.length;

    const tBonus = finalRoll.results.bonus.result;
    const tExploit = finalRoll.results.Exploit.result;

    const rDegats = finalRoll.results.degats.dice;
    const rViolence = finalRoll.results.violence.dice;

    const tDegats = finalRoll.results.degats.result;
    const tViolence = finalRoll.results.violence.result;

    const conditions = {
      bourreau,
      devaste,
      equilibre,
      isTenebricide,
      isSurprise,
      isDestructeur,
      isFureur,
      isMeurtrier,
      isUltraviolence,
    };

    const computed = updateRoll(finalRoll, tDegats, rDegats, bonusDegats, tViolence, rViolence, bonusViolence, conditions);

    const finalComputed = {
      jet: tJet + tBonus,
    };

    Object.assign(finalComputed, computed);

    finishRoll(finalRoll.rollId, finalComputed);

    if (tJet !== 0 && tJet === tExploit) {
      const exploitRoll = await startRoll(`@{jetGM} &{template:simple} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}} {{special1B=${i18n_exploit}}} {{jet=[[ {[[{${tJetDice}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`);
      const tRExploit = exploitRoll.results.jet.result;
      const exploitComputed = {
        jet: tRExploit,
      };

      finishRoll(exploitRoll.rollId, exploitComputed);
    }

    if (sEnergie !== '0') {
      setAttrs({
        [nEnergie]: newEnergie,
      });

      if (newEnergie === 0) {
        const noEnergieRoll = await startRoll(`@{jetGM} &{template:simple} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}} {{special1B=${arme}}} {{text=${sEnergieText}}}`);
        finishRoll(noEnergieRoll.rollId, {});
      }
    }
  } else {
    finalRoll = await startRoll(`@{jetGM} &{template:simple} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}} {{special1B=${arme}}} {{text=${sEnergieText}}}`);
    finishRoll(finalRoll.rollId, {});
  }
});

// MALDRUID
const MALDruidRollSimple = [
  'MALDruidLionChair', 'MALDruidLionBete', 'MALDruidLionMachine', 'MALDruidLionDame', 'MALDruidLionMasque',
  'MALDruidWolfChair', 'MALDruidWolfBete', 'MALDruidWolfMachine', 'MALDruidWolfDame', 'MALDruidWolfMasque',
  'MALDruidCrowChair', 'MALDruidCrowBete', 'MALDruidCrowMachine', 'MALDruidCrowDame', 'MALDruidCrowMasque',
];

MALDruidRollSimple.forEach((button) => {
  on(`clicked:${button}Roll`, async (info) => {
    const roll = info.htmlAttributes.value;

    const attributs = [
      'MALJetModifDesComp',
    ];

    const attrs = await getAttrsAsync(attributs);

    const exec = [];
    const cRoll = [];
    const bonus = [];

    const mod = +attrs.MALJetModifDesComp;

    const aspect = button;
    const aNom = aspectCompanionsDruid[aspect];

    const attrsAspects = await getAttrsAsync([
      `${aspect}Base`,
      `${aspect}Evol`,
      `${aspect}AE`,
    ]);

    const aValue = totalADruid(attrsAspects, aspect);

    if (button !== 'MALDruidCrowChair' && button !== 'MALDruidCrowBete' && button !== 'MALDruidCrowMachine' && button !== 'MALDruidCrowDame' && button !== 'MALDruidCrowMasque') {
      const aAE = attrsAspects[`${aspect}AE`];
      exec.push(`{{vAE=${aAE}}}`);
      bonus.push(aAE);
    } else { bonus.push(0); }

    cRoll.push(aValue);
    cRoll.push(mod);

    exec.push(roll);
    exec.push(`{{cBase=${aNom}}}`);
    exec.push(`{{jet=[[ {{[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0}]]}}`);
    exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);
    exec.push(`{{tBonus=[[${bonus.join('+')}]]}}`);

    startRoll(exec.join(' '), (results) => {
      const tJet = results.results.jet.result;
      const tBonus = results.results.tBonus.result;
      const tExploit = results.results.Exploit.result;

      const total = tJet + tBonus;

      finishRoll(
        results.rollId,
        {
          jet: total,
        },
      );

      if (tJet !== 0 && tJet === tExploit) {
        startRoll(`${roll}@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${i18n_exploit}}}{{jet=[[ {[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`, (exploit) => {
          const tExploit2 = exploit.results.jet.result;

          finishRoll(
            exploit.rollId,
            {
              jet: tExploit2,
            },
          );
        });
      }
    });
  });
});

on('clicked:MALDruidLionArmeBase', async (info) => {
  const roll = info.htmlAttributes.value;

  let attributs = [
    'MALAspectDruidLionBase',
    'MALJetModifDesComp',
    'MALDruidLionChairBase',
    'MALDruidLionChairEvol',
    'MALDruidLionBeteBase',
    'MALDruidLionBeteEvol',
    'MALDruidLionBeteAE',
  ];

  const arme = [
    'MALDruidLionBaseNom',
    'MALDruidLionBaseDegats',
    'MALDruidLionBaseDegatsBonus',
    'MALDruidLionBaseViolence',
    'MALDruidLionBaseViolenceBonus',
    'MALDruidLionBasePortee',
  ];

  const special = [
    'MALCoupBDDiversTotal',
    'MALBDDiversD6',
    'MALBDDiversFixe',
    'MALCoupBVDiversTotal',
    'MALBVDiversD6',
    'MALBVDiversFixe',
    'devasterAnatheme',
    'bourreauTenebres',
    'equilibreBalance',
  ];

  attributs = attributs.concat(arme, special);

  const attrs = await getAttrsAsync(attributs);

  const exec = [];
  exec.push(roll);

  const isConditionnelA = false;
  const isConditionnelD = false;
  const isConditionnelV = false;

  let diceDegats = 0;
  let degats = [];
  const bonusDegats = [];

  let diceViolence = 0;
  let violence = [];
  const bonusViolence = [];

  const portee = attrs.MALDruidLionBasePortee;

  const mod = Number(attrs.MALJetModifDesComp);

  const aspect = attrs.MALAspectDruidLionBase;

  const aspectNom = aspectCompanionsDruid[aspect];

  const attrsAspects = await getAttrsAsync([
    `${aspect}Base`,
    `${aspect}Evol`,
    `${aspect}AE`,
  ]);

  const aspectValue = totalADruid(attrsAspects, aspect);
  const AEValue = +attrsAspects[`${aspect}AE`] || 0;

  const vChair = totalADruid(attrs, 'MALDruidLionChair');

  const bete = totalADruid(attrs, 'MALDruidLionBete');
  const AEBete = +attrs.MALDruidLionBeteAE;

  const devaste = +attrs.devasterAnatheme;
  const bourreau = +attrs.bourreauTenebres;
  const equilibre = +attrs.equilibreBalance;

  const cRoll = [];
  const AE = [];
  let bonus = [];

  AE.push(AEValue);

  exec.push(`{{vAE=${AEValue}}}`);

  cRoll.push(aspectValue);

  diceDegats = Number(attrs.MALDruidLionBaseDegats);
  bonusDegats.push(+attrs.MALDruidLionBaseDegatsBonus);

  diceViolence = Number(attrs.MALDruidLionBaseViolence);
  bonusViolence.push(+attrs.MALDruidLionBaseViolenceBonus);

  // GESTION DES BONUS DIVERS
  const bChairD = Math.ceil(vChair / 2);

  bonusDegats.push(bChairD);
  exec.push(`{{vChair=${bChairD}}}`);
  // FIN DE GESTION DES BONUS DIVERS

  // GESTION DES ASPECTS EXCEPTIONNELS
  if (AEBete > 0) {
    let bonusBete = +AEBete;

    if (AEBete > 5) { bonusBete += +bete; }

    exec.push(`{{vBeteD=+${bonusBete}}}`);
    bonusDegats.push(bonusBete);
  }
  // FIN DE GESTION DES ASPECTS EXCEPTIONNELS

  // GESTION DES BONUS SPECIAUX
  const sBonusDegats = attrs.MALCoupBDDiversTotal;
  const sBonusDegatsD6 = attrs.MALBDDiversD6;
  const sBonusDegatsFixe = +attrs.MALBDDiversFixe;

  const sBonusViolence = attrs.MALCoupBVDiversTotal;
  const sBonusViolenceD6 = attrs.MALBVDiversD6;
  const sBonusViolenceFixe = +attrs.MALBVDiversFixe;

  if (sBonusDegats !== '0') {
    exec.push(`{{vMSpecialD=+${sBonusDegatsD6}D6+${sBonusDegatsFixe}}}`);
    diceDegats += Number(sBonusDegatsD6);
    bonusDegats.push(sBonusDegatsFixe);
  }

  if (sBonusViolence !== '0') {
    exec.push(`{{vMSpecialV=+${sBonusViolenceD6}D6+${sBonusViolenceFixe}}}`);
    diceViolence += Number(sBonusViolenceD6);
    bonusViolence.push(sBonusViolenceFixe);
  }
  // FIN DE GESTION DES BONUS SPECIAUX

  exec.push(`{{cBase=${aspectNom}}}`);

  if (mod !== 0) {
    cRoll.push(mod);
    exec.push(`{{mod=${mod}}}`);
  }

  if (cRoll.length === 0) { cRoll.push(0); }

  bonus = bonus.concat(AE);

  exec.push(`{{jet=[[ {{[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0}]]}}`);
  exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);
  exec.push(`{{bonus=[[${bonus.join('+')}]]}}`);

  degats.push(`${diceDegats}D6`);
  degats = degats.concat(bonusDegats);

  violence.push(`${diceViolence}D6`);
  violence = violence.concat(bonusViolence);

  exec.push(`{{portee=${i18n_portee} ${portee}}}`);
  exec.push(`{{degats=[[${degats.join('+')}]]}}`);
  exec.push(`{{violence=[[${violence.join('+')}]]}}`);

  if (devaste || bourreau || equilibre) {
    const herauts = [];

    if (devaste) { herauts.push(i18n_devasterAnatheme); }
    if (bourreau) { herauts.push(i18n_bourreauTenebres); }
    if (equilibre) { herauts.push(i18n_equilibrerBalance); }

    exec.push(`{{herauts=${herauts.join(' / ')}}}`);
  }

  if (isConditionnelA === true) { exec.push('{{succesConditionnel=true}}'); }

  if (isConditionnelD === true) { exec.push('{{degatsConditionnel=true}}'); }

  if (isConditionnelV === true) { exec.push('{{violenceConditionnel=true}}'); }

  const finalRoll = await startRoll(exec.join(' '));

  const tJet = finalRoll.results.jet.result;

  const tBonus = finalRoll.results.bonus.result;
  const tExploit = finalRoll.results.Exploit.result;

  const tDegats = finalRoll.results.degats.result;
  const tViolence = finalRoll.results.violence.result;

  const rDegats = finalRoll.results.degats.dice;
  const rViolence = finalRoll.results.violence.dice;

  const conditions = {
    bourreau,
    devaste,
    equilibre,
  };

  const computed = updateRoll(finalRoll, tDegats, rDegats, bonusDegats, tViolence, rViolence, bonusViolence, conditions);

  const finalComputed = {
    jet: tJet + tBonus,
  };

  Object.assign(finalComputed, computed);

  finishRoll(finalRoll.rollId, finalComputed);

  if (tJet !== 0 && tJet === tExploit) {
    const exploitRoll = await startRoll(`$${roll}@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${i18n_exploit}}}{{jet=[[ {[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`);
    const tRExploit = exploitRoll.results.jet.result;

    const exploitComputed = {
      jet: tRExploit,
    };

    finishRoll(exploitRoll.rollId, exploitComputed);
  }
});

on('clicked:repeating_armeMALDruidLion:combatdruidroll', async (info) => {
  const roll = info.htmlAttributes.value;

  let attributs = [
    'repeating_armeMALDruidLion_armeDruidLion',
    'repeating_armeMALDruidLion_aspectDruidLion',
    'MALJetModifDesComp',
    'MALDruidLionPEAct',
    'MALDruidLionChairBase',
    'MALDruidLionChairEvol',
    'MALDruidLionBeteBase',
    'MALDruidLionBeteEvol',
    'MALDruidLionBeteAE',
    'MALDruidLionMachineBase',
    'MALDruidLionMachineEvol',
    'MALDruidLionMachineAE',
    'MALDruidLionMasqueBase',
    'MALDruidLionMasqueEvol',
    'MALDruidLionMasqueAE',
  ];

  const wpn = [
    'repeating_armeMALDruidLion_druidLionBaseNom',
    'repeating_armeMALDruidLion_degatDruidLion',
    'repeating_armeMALDruidLion_degatBonusDruidLion',
    'repeating_armeMALDruidLion_violenceDruidLion',
    'repeating_armeMALDruidLion_violenceBonusDruidLion',
    'repeating_armeMALDruidLion_porteeDruidLion',
  ];

  const effets = [
    'repeating_armeMALDruidLion_antiAnatheme',
    'repeating_armeMALDruidLion_antiVehicule',
    'repeating_armeMALDruidLion_artillerie',
    'repeating_armeMALDruidLion_assassin',
    'repeating_armeMALDruidLion_assassinValue',
    'repeating_armeMALDruidLion_assistanceAttaque',
    'repeating_armeMALDruidLion_barrage',
    'repeating_armeMALDruidLion_barrageValue',
    'repeating_armeMALDruidLion_cadence',
    'repeating_armeMALDruidLion_cadenceValue',
    'repeating_armeMALDruidLion_chargeur',
    'repeating_armeMALDruidLion_chargeurValue',
    'repeating_armeMALDruidLion_choc',
    'repeating_armeMALDruidLion_chocValue',
    'repeating_armeMALDruidLion_defense',
    'repeating_armeMALDruidLion_defenseValue',
    'repeating_armeMALDruidLion_degatContinue',
    'repeating_armeMALDruidLion_degatContinueValue',
    'repeating_armeMALDruidLion_deuxMains',
    'repeating_armeMALDruidLion_demoralisant',
    'repeating_armeMALDruidLion_designation',
    'repeating_armeMALDruidLion_destructeur',
    'repeating_armeMALDruidLion_dispersion',
    'repeating_armeMALDruidLion_dispersionValue',
    'repeating_armeMALDruidLion_enChaine',
    'repeating_armeMALDruidLion_esperance',
    'repeating_armeMALDruidLion_fureur',
    'repeating_armeMALDruidLion_ignoreArmure',
    'repeating_armeMALDruidLion_ignoreCdF',
    'repeating_armeMALDruidLion_akimbo',
    'repeating_armeMALDruidLion_ambidextrie',
    'repeating_armeMALDruidLion_leste',
    'repeating_armeMALDruidLion_lourd',
    'repeating_armeMALDruidLion_lumiere',
    'repeating_armeMALDruidLion_lumiereValue',
    'repeating_armeMALDruidLion_meurtrier',
    'repeating_armeMALDruidLion_obliteration',
    'repeating_armeMALDruidLion_orfevrerie',
    'repeating_armeMALDruidLion_parasitage',
    'repeating_armeMALDruidLion_parasitageValue',
    'repeating_armeMALDruidLion_penetrant',
    'repeating_armeMALDruidLion_penetrantValue',
    'repeating_armeMALDruidLion_perceArmure',
    'repeating_armeMALDruidLion_perceArmureValue',
    'repeating_armeMALDruidLion_precision',
    'repeating_armeMALDruidLion_reaction',
    'repeating_armeMALDruidLion_reactionValue',
    'repeating_armeMALDruidLion_silencieux',
    'repeating_armeMALDruidLion_soumission',
    'repeating_armeMALDruidLion_tenebricite',
    'repeating_armeMALDruidLion_tirRafale',
    'repeating_armeMALDruidLion_tirSecurite',
    'repeating_armeMALDruidLion_ultraViolence',
  ];

  const ameliorations = [
    'repeating_armeMALDruidLion_chargeurGrappes',
    'repeating_armeMALDruidLion_canonLong',
    'repeating_armeMALDruidLion_canonRaccourci',
    'repeating_armeMALDruidLion_chambreDouble',
    'repeating_armeMALDruidLion_interfaceGuidage',
    'repeating_armeMALDruidLion_jumelage',
    'repeating_armeMALDruidLion_jumelageValue',
    'repeating_armeMALDruidLion_jumelageType',
    'repeating_armeMALDruidLion_lunetteIntelligente',
    'repeating_armeMALDruidLion_munitionsHyperVelocite',
    'repeating_armeMALDruidLion_munitionsDrone',
    'repeating_armeMALDruidLion_chargeurExplosives',
    'repeating_armeMALDruidLion_munitionsIEM',
    'repeating_armeMALDruidLion_munitionsNonLetales',
    'repeating_armeMALDruidLion_munitionsSubsoniques',
    'repeating_armeMALDruidLion_pointeurLaser',
    'repeating_armeMALDruidLion_protectionArme',
    'repeating_armeMALDruidLion_revetementOmega',
    'repeating_armeMALDruidLion_structureElement',
    'repeating_armeMALDruidLion_systemeRefroidissement',
  ];

  const special = [
    'repeating_armeMALDruidLion_bDDiversTotal',
    'repeating_armeMALDruidLion_bDDiversD6',
    'repeating_armeMALDruidLion_bDDiversFixe',
    'repeating_armeMALDruidLion_bVDiversTotal',
    'repeating_armeMALDruidLion_bVDiversD6',
    'repeating_armeMALDruidLion_bVDiversFixe',
    'repeating_armeMALDruidLion_energie',
    'repeating_armeMALDruidLion_energieValue',
    'devasterAnatheme',
    'bourreauTenebres',
    'equilibreBalance',
  ];

  attributs = attributs.concat(wpn, effets, ameliorations, special);

  const attrs = await getAttrsAsync(attributs);

  const exec = [];
  exec.push(roll);

  let isConditionnelA = false;
  let isConditionnelD = false;
  let isConditionnelV = false;

  const arme = attrs.repeating_armeMALDruidLion_armeDruidLion;

  let diceDegats = 0;
  let degats = [];
  const bonusDegats = [];

  let diceViolence = 0;
  let violence = [];
  const bonusViolence = [];

  const attaquesSurprises = [];
  const attaquesSurprisesValue = [];
  let attaquesSurprisesCondition = '';

  let eASAssassin = '';
  let eASAssassinValue = 0;

  const energie = attrs.MALDruidLionPEAct;
  const nEnergie = 'MALDruidLionPEAct';
  const portee = attrs.repeating_armeMALDruidLion_porteeDruidLion;
  const autresEffets = [];
  const autresAmeliorations = [];
  const autresSpecial = [];

  const mod = +attrs.MALJetModifDesComp;

  const aspect = attrs.repeating_armeMALDruidLion_aspectDruidLion;

  const aspectNom = aspectCompanionsDruid[aspect];

  const attrsAspects = await getAttrsAsync([
    `${aspect}Base`,
    `${aspect}Evol`,
    `${aspect}AE`,
  ]);

  const aspectValue = totalADruid(attrsAspects, aspect);
  const AEValue = +attrsAspects[`${aspect}AE`] || 0;

  const vChair = totalADruid(attrs, 'MALDruidLionChair');

  const vBete = totalADruid(attrs, 'MALDruidLionBete');
  const vAEBete = +attrs.MALDruidLionBeteAE;

  const vMachine = totalADruid(attrs, 'MALDruidLionMachine');
  const vAEMachine = +attrs.MALDruidLionMachineAE;

  const vMasque = totalADruid(attrs, 'MALDruidLionMasque');
  const vAEMasque = +attrs.MALDruidLionMasqueAE;

  const devaste = +attrs.devasterAnatheme;
  const bourreau = +attrs.bourreauTenebres;
  const equilibre = +attrs.equilibreBalance;

  const cRoll = [];
  const AE = [];
  let bonus = [];

  let isDestructeur = false;
  let isFureur = false;
  let isMeurtrier = false;
  let isUltraviolence = false;
  let isTenebricide = false;
  let isSurprise = false;

  AE.push(AEValue);

  exec.push(`{{special1B=${arme}}}`);

  exec.push(`{{vAE=${AEValue}}}`);

  cRoll.push(aspectValue);

  diceDegats = +attrs.repeating_armeMALDruidLion_degatDruidLion;
  bonusDegats.push(+attrs.repeating_armeMALDruidLion_degatBonusDruidLion);

  diceViolence = +attrs.repeating_armeMALDruidLion_violenceDruidLion;
  bonusViolence.push(+attrs.repeating_armeMALDruidLion_violenceBonusDruidLion);

  // GESTION DES BONUS DIVERS
  let bChairD = Math.ceil(vChair / 2);

  if (portee === '^{portee-contact}') {
    bonusDegats.push(bChairD);
    exec.push(`{{vChair=${bChairD}}}`);
  }
  // FIN DE GESTION DES BONUS DIVERS

  // GESTION DES ASPECTS EXCEPTIONNELS
  if (vAEBete > 0) {
    let bonusBete = +vAEBete;

    if (vAEBete > 5) { bonusBete += +vBete; }

    exec.push(`{{vBeteD=+${bonusBete}}}`);
    bonusDegats.push(bonusBete);
  }
  // FIN DE GESTION DES ASPECTS EXCEPTIONNELS

  // GESTION DES EFFETS
  let rCadence = 0;

  const eAntiAnatheme = attrs.repeating_armeMALDruidLion_antiAnatheme;
  const eAntiVehicule = attrs.repeating_armeMALDruidLion_antiVehicule;
  const eArtillerie = attrs.repeating_armeMALDruidLion_artillerie;
  const eAssassin = attrs.repeating_armeMALDruidLion_repeating_armeMALDruidLion_assassin;
  const eAssassinV = attrs.repeating_armeMALDruidLion_assassinValue;
  const eAssistanceAttaque = attrs.repeating_armeMALDruidLion_assistanceAttaque;
  const eBarrage = attrs.repeating_armeMALDruidLion_barrage;
  const eBarrageV = attrs.repeating_armeMALDruidLion_barrageValue;
  const eCadence = attrs.repeating_armeMALDruidLion_cadence;
  const eCadenceV = attrs.repeating_armeMALDruidLion_cadenceValue;
  const eChargeur = attrs.repeating_armeMALDruidLion_chargeur;
  const eChargeurV = attrs.repeating_armeMALDruidLion_chargeurValue;
  const eChoc = attrs.repeating_armeMALDruidLion_choc;
  const eChocV = attrs.repeating_armeMALDruidLion_chocValue;
  const eDefense = attrs.repeating_armeMALDruidLion_defense;
  const eDefenseV = attrs.repeating_armeMALDruidLion_defenseValue;
  const eDegatsContinus = attrs.repeating_armeMALDruidLion_degatContinue;
  const eDegatsContinusV = attrs.repeating_armeMALDruidLion_degatContinueValue;
  const eDeuxMains = attrs.repeating_armeMALDruidLion_deuxMains;
  const eDemoralisant = attrs.repeating_armeMALDruidLion_demoralisant;
  const eDesignation = attrs.repeating_armeMALDruidLion_designation;
  const eDestructeur = attrs.repeating_armeMALDruidLion_destructeur;
  const eDestructeurV = 2;
  const eDispersion = attrs.repeating_armeMALDruidLion_dispersion;
  const eDispersionV = attrs.repeating_armeMALDruidLion_dispersionValue;
  const eEnChaine = attrs.repeating_armeMALDruidLion_enChaine;
  const eEsperance = attrs.repeating_armeMALDruidLion_esperance;
  const eFureur = attrs.repeating_armeMALDruidLion_fureur;
  const eFureurV = 4;
  const eIgnoreArmure = attrs.repeating_armeMALDruidLion_ignoreArmure;
  const eIgnoreCDF = attrs.repeating_armeMALDruidLion_ignoreCdF;
  const eJAkimbo = attrs.repeating_armeMALDruidLion_akimbo;
  const eJAmbidextrie = attrs.repeating_armeMALDruidLion_ambidextrie;
  const eLeste = attrs.repeating_armeMALDruidLion_leste;
  const eLourd = attrs.repeating_armeMALDruidLion_lourd;
  const eLumiere = attrs.repeating_armeMALDruidLion_lumiere;
  const eLumiereV = attrs.repeating_armeMALDruidLion_lumiereValue;
  const eMeurtrier = attrs.repeating_armeMALDruidLion_meurtrier;
  const eMeurtrierV = 2;
  const eObliteration = attrs.repeating_armeMALDruidLion_obliteration;
  const eOrfevrerie = attrs.repeating_armeMALDruidLion_orfevrerie;
  const eParasitage = attrs.repeating_armeMALDruidLion_parasitage;
  const eParasitageV = attrs.repeating_armeMALDruidLion_parasitageValue;
  const ePenetrant = attrs.repeating_armeMALDruidLion_penetrant;
  const ePenetrantV = attrs.repeating_armeMALDruidLion_penetrantValue;
  const ePerceArmure = attrs.repeating_armeMALDruidLion_perceArmure;
  const ePerceArmureV = attrs.repeating_armeMALDruidLion_perceArmureValue;
  const ePrecision = attrs.repeating_armeMALDruidLion_precision;
  const eReaction = attrs.repeating_armeMALDruidLion_reaction;
  const eReactionV = attrs.repeating_armeMALDruidLion_reactionValue;
  const eSilencieux = attrs.repeating_armeMALDruidLion_silencieux;
  const eSoumission = attrs.repeating_armeMALDruidLion_soumission;
  const eTenebricide = attrs.repeating_armeMALDruidLion_tenebricite;
  const eTirRafale = attrs.repeating_armeMALDruidLion_tirRafale;
  const eTirSecurite = attrs.repeating_armeMALDruidLion_tirSecurite;
  const eUltraviolence = attrs.repeating_armeMALDruidLion_ultraViolence;
  const eUltraviolenceV = 2;

  if (eAntiAnatheme !== '0') {
    isConditionnelD = true;
    isConditionnelV = true;
    exec.push(`{{antiAnatheme=${i18n_antiAnatheme}}}`);
    exec.push(`{{antiAnathemeCondition=${i18n_antiAnathemeCondition}}}`);
  }

  if (eAssistanceAttaque !== '0') {
    isConditionnelD = true;
    isConditionnelV = true;

    exec.push(`{{assistanceAttaque=${i18n_assistanceAttaque}}}`);
    exec.push(`{{assistanceAttaqueCondition=${i18n_assistanceAttaqueCondition}}}`);
  }

  if (eArtillerie !== '0') {
    isConditionnelA = true;
    exec.push(`{{artillerie=${i18n_artillerie}}}`);
    exec.push(`{{artillerieCondition=${i18n_artillerieCondition}}}`);
  }

  if (eAssassin !== '0') {
    eASAssassin = i18n_assassin;
    eASAssassinValue = eAssassinV;

    if (attaquesSurprisesCondition === '') { attaquesSurprisesCondition = `{{attaqueSurpriseCondition=${i18n_attaqueSurpriseCondition}}}`; }
  }

  if (eCadence !== '0') {
    rCadence = '?{Plusieurs cibles ?|Oui, 3|Non, 0}';
  }

  if (eChoc !== '0') {
    isConditionnelA = true;
    exec.push(`{{choc=${i18n_choc} ${eChocV}}}`);
    exec.push(`{{chocCondition=${i18n_chocCondition}}}`);
  }

  if (eDemoralisant !== '0') {
    isConditionnelA = true;
    exec.push(`{{demoralisant=${i18n_demoralisant}}}`);
    exec.push(`{{demoralisantCondition=${i18n_demoralisantCondition}}}`);
  }

  if (eDestructeur !== '0') {
    isConditionnelD = true;
    isDestructeur = true;
    exec.push(`{{destructeur=${i18n_destructeur}}}`);
    exec.push(`{{destructeurValue=[[${eDestructeurV}D6]]}}`);
    exec.push(`{{destructeurCondition=${i18n_destructeurCondition}}}`);
  }

  if (eEnChaine !== '0') {
    isConditionnelD = true;
    exec.push(`{{enChaine=${i18n_enChaine}}}`);
    exec.push(`{{enChaineCondition=${i18n_enChaineCondition}}}`);
  }

  if (eEsperance !== '0') {
    isConditionnelD = true;
    isConditionnelV = true;
    exec.push(`{{esperance=${i18n_esperance}}}`);
    exec.push(`{{esperanceConditionD=${i18n_esperanceConditionD}}}`);
    exec.push(`{{esperanceConditionV=${i18n_esperanceConditionV}}}`);
  }

  if (eFureur !== '0') {
    isConditionnelV = true;
    isFureur = true;
    exec.push(`{{fureur=${i18n_fureur}}}`);
    exec.push(`{{fureurValue=[[${eFureurV}D6]]}}`);
    exec.push(`{{fureurCondition=${i18n_fureurCondition}}}`);
  }

  if (eLeste !== '0') {
    if (portee !== '^{portee-contact}') { bChairD = vChair; }

    bonusDegats.push(bChairD);
    exec.push(`{{vLeste=${bChairD}}}`);
  }

  if (eMeurtrier !== '0') {
    isConditionnelD = true;
    isMeurtrier = true;
    exec.push(`{{meurtrier=${i18n_meurtrier}}}`);
    exec.push(`{{meurtrierValue=[[${eMeurtrierV}D6]]}}`);
    exec.push(`{{meurtrierCondition=${i18n_meurtrierCondition}}}`);
  }

  if (eObliteration !== '0') {
    isConditionnelD = true;
    exec.push(`{{obliteration=${i18n_obliteration}}}`);
    exec.push(`{{obliterationCondition=${i18n_obliterationCondition}}}`);
  }

  if (eOrfevrerie !== '0') {
    const vOrfevrerie = Math.ceil((vMasque / 2) + vAEMasque);

    bonusDegats.push(vOrfevrerie);
    exec.push(`{{vOrfevrerie=${vOrfevrerie}}}`);
  }

  if (eParasitage !== '0') {
    isConditionnelA = true;
    exec.push(`{{parasitage=${i18n_parasitage} ${eParasitageV}}}`);
    exec.push(`{{parasitageCondition=${i18n_parasitageCondition}}}`);
  }

  if (ePrecision !== '0') {
    isConditionnelD = true;
    const vPrecision = Math.ceil((vMachine / 2) + vAEMachine);

    bonusDegats.push(vPrecision);
    exec.push(`{{vPrecision=${vPrecision}}}`);
  }

  if (eSilencieux !== '0') {
    const totalSilencieux = Math.ceil((vMasque / 2) + vAEMasque);

    attaquesSurprises.push(i18n_silencieux);
    attaquesSurprisesValue.push(totalSilencieux);

    if (attaquesSurprisesCondition === '') { attaquesSurprisesCondition = `{{attaqueSurpriseCondition=${i18n_attaqueSurpriseCondition}}}`; }
  }

  if (eSoumission !== '0') {
    isConditionnelA = true;
    exec.push(`{{soumission=${i18n_soumission}}}`);
    exec.push(`{{soumissionCondition=${i18n_soumissionCondition}}}`);
  }

  if (eTenebricide !== '0') {
    exec.push(`{{tenebricide=${i18n_tenebricide}}}`);
    exec.push(`{{tenebricideConditionD=${i18n_tenebricideConditionD}}}`);
    exec.push(`{{tenebricideConditionV=${i18n_tenebricideConditionV}}}`);

    isTenebricide = true;
    isConditionnelD = true;
    isConditionnelV = true;
  }

  if (eTirRafale !== '0') {
    exec.push(`{{tirRafale=${i18n_tirRafale}}}`);
    exec.push(`{{tirRafaleCondition=${i18n_tirRafaleCondition}}}`);

    isConditionnelD = true;
  }

  if (eUltraviolence !== '0') {
    exec.push(`{{ultraviolence=${i18n_ultraviolence}}}`);
    exec.push(`{{ultraviolenceValue=[[${eUltraviolenceV}D6]]}}`);
    exec.push(`{{ultraviolenceCondition=${i18n_ultraviolenceCondition}}}`);

    isConditionnelV = true;
    isUltraviolence = true;
  }

  if (eAntiVehicule !== '0') { autresEffets.push(i18n_antiVehicule); }

  if (eBarrage !== '0') { autresEffets.push(`${i18n_barrage} ${eBarrageV}`); }

  if (eChargeur !== '0') { autresEffets.push(`${i18n_chargeur} ${eChargeurV}`); }

  if (eDefense !== '0') { autresEffets.push(`${i18n_defense} ${eDefenseV}`); }

  if (eDegatsContinus !== '0') { autresEffets.push(`${i18n_degatsContinus} ${eDegatsContinusV} ([[1d6]] ${i18n_tours})`); }

  if (eDeuxMains !== '0') { autresEffets.push(i18n_deuxMains); }

  if (eDesignation !== '0') { autresEffets.push(i18n_designation); }

  if (eDispersion !== '0') { autresEffets.push(`${i18n_dispersion} ${eDispersionV}`); }

  if (eIgnoreArmure !== '0') { autresEffets.push(i18n_ignoreArmure); }

  if (eIgnoreCDF !== '0') { autresEffets.push(i18n_ignoreCDF); }

  if (eJAkimbo !== '0') { autresEffets.push(i18n_jAkimbo); }

  if (eJAmbidextrie !== '0') { autresEffets.push(i18n_jAmbidextrie); }

  if (eLourd !== '0') { autresEffets.push(i18n_lourd); }

  if (eLumiere !== '0') { autresEffets.push(`${i18n_lumiere} ${eLumiereV}`); }

  if (ePenetrant !== '0') { autresEffets.push(`${i18n_penetrant} ${ePenetrantV}`); }

  if (ePerceArmure !== '0') { autresEffets.push(`${i18n_perceArmure} ${ePerceArmureV}`); }

  if (eReaction !== '0') { autresEffets.push(`${i18n_reaction} ${eReactionV}`); }

  if (eTirSecurite !== '0') { autresEffets.push(i18n_tirSecurite); }

  // FIN GESTION DES EFFETS

  // GESTION DES AMELIORATIONS
  let rChambreDouble = 0;

  const aChargeurGrappes = attrs.repeating_armeMALDruidLion_chargeurGrappes;
  const aCanonLong = attrs.repeating_armeMALDruidLion_canonLong;
  const aCanonRaccourci = attrs.repeating_armeMALDruidLion_canonRaccourci;
  const aChambreDouble = attrs.repeating_armeMALDruidLion_chambreDouble;
  const aInterfaceGuidage = attrs.repeating_armeMALDruidLion_interfaceGuidage;
  const aJumelage = attrs.repeating_armeMALDruidLion_jumelage;
  const aJumelageV = attrs.repeating_armeMALDruidLion_jumelageValue;
  const aLunetteIntelligente = attrs.repeating_armeMALDruidLion_lunetteIntelligente;
  const aMunitionsDrone = attrs.repeating_armeMALDruidLion_munitionsDrone;
  const aMunitionsHyperVelocite = attrs.repeating_armeMALDruidLion_munitionsHyperVelocite;
  const aChargeurExplosives = attrs.repeating_armeMALDruidLion_chargeurExplosives;
  const aMunitionsIEM = attrs.repeating_armeMALDruidLion_munitionsIEM;
  const aMunitionsNonLetales = attrs.repeating_armeMALDruidLion_munitionsNonLetales;
  const aMunitionsSubsoniques = attrs.repeating_armeMALDruidLion_munitionsSubsoniques;
  const aPointeurLaser = attrs.repeating_armeMALDruidLion_pointeurLaser;
  const aProtectionArme = attrs.repeating_armeMALDruidLion_protectionArme;
  const aRevetementOmega = attrs.repeating_armeMALDruidLion_revetementOmega;
  const aStructureElement = attrs.repeating_armeMALDruidLion_structureElement;
  const aSystemeRefroidissement = attrs.repeating_armeMALDruidLion_systemeRefroidissement;

  if (aChargeurGrappes !== '0') {
    exec.push('{{vMGrappeD=-1D6}}');
    exec.push('{{vMGrappeV=+1D6}}');
    diceDegats -= 1;
    diceViolence += 1;
  }

  if (aCanonLong !== '0') {
    isConditionnelA = true;
    exec.push(`{{canonLong=${i18n_canonLong}}}`);
    exec.push(`{{canonLongCondition=${i18n_canonLongCondition}}}`);
  }

  if (aCanonRaccourci !== '0') {
    isConditionnelA = true;
    exec.push(`{{canonRaccourci=${i18n_canonRaccourci}}}`);
    exec.push(`{{canonRaccourciCondition=${i18n_canonRaccourciCondition}}}`);
  }

  if (aChambreDouble !== '0') {
    if (eCadence !== 0) { autresAmeliorations.push(i18n_chambreDouble); } else if (eCadence === 0) { rChambreDouble = '?{Plusieurs cibles ?|Oui, 3|Non, 0}'; }
  }

  if (aLunetteIntelligente !== '0') {
    isConditionnelA = true;
    exec.push(`{{lunetteIntelligente=${i18n_lunetteIntelligente}}}`);
    exec.push(`{{lunetteIntelligenteCondition=${i18n_lunetteIntelligenteCondition}}}`);
  }

  if (aMunitionsDrone !== '0') {
    exec.push('{{vMDrone=+3}}');
    bonus.push(3);
  }

  if (aMunitionsHyperVelocite !== '0') {
    if (eAssistanceAttaque !== '0') { autresAmeliorations.push(i18n_munitionsHyperVelocite); } else if (eAssistanceAttaque === '0') {
      isConditionnelD = true;
      isConditionnelV = true;

      exec.push(`{{assistanceAttaque=${i18n_munitionsHyperVelocite}}}`);
      exec.push(`{{assistanceAttaqueCondition=${i18n_assistanceAttaqueCondition}}}`);
    }
  }

  if (aChargeurExplosives !== '0') {
    exec.push('{{vMExplosiveD=+1D6}}');
    exec.push('{{vMExplosiveV=-1D6}}');
    diceDegats += 1;
    diceViolence -= 1;
  }

  if (aMunitionsIEM !== '0') {
    exec.push('{{vMIEMD=-1D6}}');
    exec.push('{{vMIEMV=-1D6}}');
    diceDegats -= 1;
    diceViolence -= 1;
    autresAmeliorations.push(i18n_munitionsIEMParasitage);
  }

  if (aMunitionsSubsoniques !== '0') {
    if (eSilencieux !== '0') { autresAmeliorations.push(i18n_munitionsSubsoniques); } else if (eSilencieux === '0') {
      const totalSubsonique = vDiscretion + oDiscretion;

      attaquesSurprises.push(i18n_munitionsSubsoniques);
      attaquesSurprisesValue.push(totalSubsonique);

      if (attaquesSurprisesCondition === '') { attaquesSurprisesCondition = `{{attaqueSurpriseCondition=${i18n_attaqueSurpriseCondition}}}`; }
    }
  }

  if (aPointeurLaser !== '0') {
    exec.push('{{vMPLaser=+1}}');
    bonus.push(1);
  }

  if (aSystemeRefroidissement !== '0') {
    if (eTirRafale !== '0') { autresAmeliorations.push(`${i18n_systemeRefroidissement} (${i18n_barrage} 1)`); } else if (eTirRafale === '0') {
      exec.push(`{{tirRafale=${i18n_systemeRefroidissement} + ${i18n_barrage} 1}}`);
      exec.push(`{{tirRafaleCondition=${i18n_tirRafaleCondition}}}`);
    }
  }

  if (aRevetementOmega !== '0') {
    if (eASAssassinValue < 2) {
      eASAssassin = i18n_revetementOmega;
      eASAssassinValue = 2;

      if (eASAssassinValue !== 0) { autresEffets.push(i18n_assassin); }
    } else if (eASAssassinValue > 2) { autresAmeliorations.push(i18n_revetementOmega); }
  }

  if (aInterfaceGuidage !== '0') { autresAmeliorations.push(i18n_interfaceGuidage); }

  if (aJumelage !== '0') { autresAmeliorations.push(`${i18n_jumelage} (${aJumelageV})`); }

  if (aMunitionsNonLetales !== '0') { autresAmeliorations.push(i18n_munitionsNonLetales); }

  if (aProtectionArme !== '0') { autresAmeliorations.push(i18n_protectionArme); }

  if (aStructureElement !== '0') { autresAmeliorations.push(i18n_structureElementAlpha); }

  // FIN GESTION DES AMELIORATIONS

  // GESTION DES BONUS SPECIAUX
  const sBonusDegats = attrs.repeating_armeMALDruidLion_bDDiversTotal;
  const sBonusDegatsD6 = attrs.repeating_armeMALDruidLion_bDDiversD6;
  const sBonusDegatsFixe = +attrs.repeating_armeMALDruidLion_bDDiversFixe;

  const sBonusViolence = attrs.repeating_armeMALDruidLion_bVDiversTotal;
  const sBonusViolenceD6 = attrs.repeating_armeMALDruidLion_bVDiversD6;
  const sBonusViolenceFixe = +attrs.repeating_armeMALDruidLion_bVDiversFixe;

  const sEnergie = attrs.repeating_armeMALDruidLion_energie;
  const sEnergieValue = attrs.repeating_armeMALDruidLion_energieValue;

  let pasDEnergie = false;
  let sEnergieText = '';
  let newEnergie = 0;

  if (sBonusDegats !== '0') {
    exec.push(`{{vMSpecialD=+${sBonusDegatsD6}D6+${sBonusDegatsFixe}}}`);

    diceDegats += Number(sBonusDegatsD6);
    bonusDegats.push(sBonusDegatsFixe);
  }

  if (sBonusViolence !== '0') {
    exec.push(`{{vMSpecialV=+${sBonusViolenceD6}D6+${sBonusViolenceFixe}}}`);

    diceViolence += Number(sBonusViolenceD6);
    bonusViolence.push(sBonusViolenceFixe);
  }

  if (sEnergie !== '0') {
    autresSpecial.push(`${i18n_energieRetiree} (${sEnergieValue})`);

    newEnergie = Number(energie) - Number(sEnergieValue);

    if (newEnergie === 0) {
      sEnergieText = i18n_plusEnergie;
    } else if (newEnergie < 0) {
      newEnergie = 0;
      sEnergieText = i18n_pasEnergie;
      pasDEnergie = true;
    }

    exec.push(`{{energieR=${newEnergie}}}`);
  }
  // FIN DE GESTION DES BONUS SPECIAUX

  exec.push(`{{cBase=${aspectNom}}}`);

  if (mod !== 0) {
    cRoll.push(mod);
    exec.push(`{{mod=${mod}}}`);
  }

  if (cRoll.length === 0) { cRoll.push(0); }

  bonus = bonus.concat(AE);

  exec.push(`{{jet=[[ {[[{${cRoll.join('+')}-${rCadence}-${rChambreDouble}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`);
  exec.push(`{{Exploit=[[${cRoll.join('+')}-${rCadence}-${rChambreDouble}]]}}`);
  exec.push(`{{bonus=[[${bonus.join('+')}]]}}`);

  if (diceDegats < 0) { diceDegats = 0; }

  degats.push(`${diceDegats}D6`);
  degats = degats.concat(bonusDegats);

  if (diceViolence < 0) { diceViolence = 0; }

  violence.push(`${diceViolence}D6`);
  violence = violence.concat(bonusViolence);

  exec.push(`{{portee=${i18n_portee} ${portee}}}`);
  exec.push(`{{degats=[[${degats.join('+')}]]}}`);
  exec.push(`{{violence=[[${violence.join('+')}]]}}`);

  if (eObliteration !== '0') {
    let ASObliteration = [];
    let ASValueObliteration = [];

    diceDegatsObliteration = diceDegats * 6;

    degatsFObliteration = _.reduce(bonusDegats, (n1, n2) => Number(n1) + Number(n2));

    const vObliteration = diceDegatsObliteration + degatsFObliteration;

    exec.push(`{{obliterationValue=${vObliteration}}}`);

    if (eMeurtrier !== '0') { exec.push(`{{obliterationMeurtrierValue=${eMeurtrierV * 6}}}`); }

    if (eDestructeur !== '0') { exec.push(`{{obliterationDestructeurValue=${eDestructeurV * 6}}}`); }

    if (eASAssassinValue > 0) {
      eAssassinTenebricideValue = eASAssassinValue * 6;

      ASObliteration.unshift(eASAssassin);
      ASValueObliteration.unshift(eAssassinTenebricideValue);

      if (attaquesSurprises.length > 0) {
        ASObliteration = ASObliteration.concat(attaquesSurprises);
        ASValueObliteration = ASValueObliteration.concat(attaquesSurprisesValue);
      }

      exec.push(`{{obliterationAS=${ASObliteration.join('\n+')}}}`);
      exec.push(`{{obliterationASValue=[[${ASValueObliteration.join('+')}]]}}`);
    } else if (attaquesSurprises.length > 0) {
      ASObliteration = ASObliteration.concat(attaquesSurprises);
      ASValueObliteration = ASValueObliteration.concat(attaquesSurprisesValue);

      exec.push(`{{obliterationAS=${ASTenebricide.join('\n+')}}}`);
      exec.push(`{{obliterationASValue=${_.reduce(ASValueObliteration, (n1, n2) => n1 + n2, 0)}}}`);
    }
  }

  if (rCadence !== 0) {
    exec.push(`{{rCadence=${i18n_cadence} ${eCadenceV} ${i18n_inclus}}}`);
    exec.push(`{{vCadence=${rCadence}D6}}`);
  }

  if (rChambreDouble !== 0) { exec.push(`{{vChambreDouble=${rChambreDouble}}}`); }

  if (eASAssassinValue > 0) {
    attaquesSurprises.unshift(eASAssassin);
    attaquesSurprisesValue.unshift(`${eASAssassinValue}D6`);
  }

  if (attaquesSurprises.length > 0) {
    exec.push(`{{attaqueSurprise=${attaquesSurprises.join('\n+')}}}`);
    exec.push(`{{attaqueSurpriseValue=[[${attaquesSurprisesValue.join('+')}]]}}`);
    exec.push(attaquesSurprisesCondition);
    isSurprise = true;
    isConditionnelD = true;
  }

  if (eTenebricide !== '0') {
    isTenebricide = true;
    exec.push('{{tenebricideValueD=[[0]]}}');
    exec.push('{{tenebricideValueV=[[0]]}}');

    if (attaquesSurprises.length > 0) {
      exec.push(`{{tenebricideAS=${attaquesSurprises.join('\n+')}}}`);
      exec.push('{{tenebricideASValue=[[0]]}}');
    }
  }

  if (autresEffets.length > 0) { exec.push(`{{effets=${autresEffets.join(' / ')}}}`); }

  if (autresAmeliorations.length > 0) { exec.push(`{{ameliorations=${autresAmeliorations.join(' / ')}}}`); }

  if (autresSpecial.length > 0) { exec.push(`{{special=${autresSpecial.join(' / ')}}}`); }

  if (isConditionnelA === true) { exec.push('{{succesConditionnel=true}}'); }

  if (isConditionnelD === true) { exec.push('{{degatsConditionnel=true}}'); }

  if (isConditionnelV === true) { exec.push('{{violenceConditionnel=true}}'); }

  if (pasDEnergie === false) {
    const finalRoll = await startRoll(exec.join(' '));

    const tJet = finalRoll.results.jet.result;
    const tJetDice = finalRoll.results.jet.dice.length;

    const tBonus = finalRoll.results.bonus.result;
    const tExploit = finalRoll.results.Exploit.result;

    const rDegats = finalRoll.results.degats.dice;
    const rViolence = finalRoll.results.violence.dice;

    const tDegats = finalRoll.results.degats.result;
    const tViolence = finalRoll.results.violence.result;

    const conditions = {
      bourreau,
      devaste,
      equilibre,
      isTenebricide,
      isSurprise,
      isDestructeur,
      isFureur,
      isMeurtrier,
      isUltraviolence,
    };

    const computed = updateRoll(finalRoll, tDegats, rDegats, bonusDegats, tViolence, rViolence, bonusViolence, conditions);

    const finalComputed = {
      jet: tJet + tBonus,
    };

    Object.assign(finalComputed, computed);

    finishRoll(finalRoll.rollId, finalComputed);

    if (tJet !== 0 && tJet === tExploit) {
      const exploitRoll = await startRoll(`@{jetGM} &{template:simple} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}} {{special1B=${i18n_exploit}}} {{jet=[[ {[[{${tJetDice}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`);
      const tRExploit = exploitRoll.results.jet.result;
      const exploitComputed = {
        jet: tRExploit,
      };

      finishRoll(exploitRoll.rollId, exploitComputed);
    }

    if (sEnergie !== '0') {
      setAttrs({
        [nEnergie]: newEnergie,
      });

      if (newEnergie === 0) {
        const noEnergieRoll = await startRoll(`@{jetGM} &{template:simple} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}} {{special1B=${arme}}} {{text=${sEnergieText}}}`);
        finishRoll(noEnergieRoll.rollId, {});
      }
    }
  } else {
    finalRoll = await startRoll(`@{jetGM} &{template:simple} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}} {{special1B=${arme}}} {{text=${sEnergieText}}}`);
    finishRoll(finalRoll.rollId, {});
  }
});

const druidRollInit = [
  'druidLionInitiative', 'MALDruidLionInitiative', 'druidWolfInitiative', 'MALDruidWolfInitiative', 'druidCrowInitiative', 'MALDruidCrowInitiative',
];

druidRollInit.forEach((button) => {
  on(`clicked:${button}Roll`, async (info) => {
    const roll = info.htmlAttributes.value;

    const attributs = [
      `${button}Base`,
      `${button}Evol`,
      'druidLionMasqueAE',
      'MALDruidLionMasqueAE',
      'druidWolfMasqueAE',
      'MALDruidWolfMasqueAE',
    ];

    const attrs = await getAttrsAsync(attributs);

    const exec = [];
    const cRoll = [];

    let total = totalADruid(attrs, button);

    let masqueAE = 0;

    if (button !== 'druidCrowInitiative' && button !== 'MALDruidCrowInitiative') {
      if (button === 'druidLionInitiative') { masqueAE = attrs.druidLionMasqueAE; } else if (button === 'MALDruidLionInitiative') { masqueAE = +attrs.MALDruidLionMasqueAE; } else if (button === 'druidWolfInitiative') {
        total = 2;
        masqueAE = +attrs.druidWolfMasqueAE;
      } else if (button === 'MALDruidWolfInitiative') {
        total = 2;
        masqueAE = +attrs.MALDruidWolfMasqueAE;
      }

      if (masqueAE > 5) { cRoll.push(30); } else {
        cRoll.push('3D6');
        cRoll.push(total);
      }
    } else {
      cRoll.push(1);
    }

    exec.push(roll);
    exec.push(`{{initiative=[[${cRoll.join('+')} &{tracker}]]}}`);

    startRoll(exec.join(' '), (results) => {
      finishRoll(
        results.rollId,
        {},
      );
    });
  });
});

const druidRollFighter = [
  'DWolfFighterRoll', 'MALDWolfFighterN1Roll',
];

druidRollFighter.forEach((button) => {
  on(`clicked:${button}`, async (info) => {
    const roll = info.htmlAttributes.value;

    const attributs = [
      'devasterAnatheme',
      'bourreauTenebres',
      'equilibreBalance',
    ];
    let nbreW = '';

    if (button === 'DWolfFighterRoll') { nbreW = 'druidNombreCompagnon'; } else if (button === 'MALDWolfFighterN1Roll') { nbreW = 'MALDruidNombreCompagnon'; }

    attributs.push(nbreW);

    const attrs = await getAttrsAsync(attributs);

    const nbre = attrs[nbreW];

    const exec = [];
    exec.push(roll);

    const devaste = +attrs.devasterAnatheme;
    const bourreau = +attrs.bourreauTenebres;
    const equilibre = +attrs.equilibreBalance;

    const degats = [];
    const violence = [];

    degats.push(`${nbre}D6`);
    violence.push(`${nbre}D6`);

    exec.push(`{{degats=[[${degats.join('+')}]]}}`);
    exec.push(`{{violence=[[${violence.join('+')}]]}}`);

    if (devaste || bourreau || equilibre) {
      const herauts = [];

      if (devaste) { herauts.push(i18n_devasterAnatheme); }
      if (bourreau) { herauts.push(i18n_bourreauTenebres); }
      if (equilibre) { herauts.push(i18n_equilibrerBalance); }

      exec.push(`{{herauts=${herauts.join(' / ')}}}`);
    }

    // ROLL

    const finalRoll = await startRoll(exec.join(' '));

    const rDegats = finalRoll.results.degats.dice;
    const rViolence = finalRoll.results.violence.dice;

    const tDegats = finalRoll.results.degats.result;
    const tViolence = finalRoll.results.violence.result;

    const conditions = {
      bourreau,
      devaste,
      equilibre,
    };

    const computed = updateRoll(finalRoll, tDegats, rDegats, [], tViolence, rViolence, [], conditions);

    finishRoll(finalRoll.rollId, computed);
  });
});

const druidRollCrow = [
  'druidCrowAttaque', 'MALDruidCrowAttaque',
];

druidRollCrow.forEach((button) => {
  on(`clicked:${button}`, async (info) => {
    const roll = info.htmlAttributes.value;

    const attributs = [];

    if (button === 'druidCrowAttaque') {
      attributs.push('druidCrowTAttaque');
      attributs.push('druidNiveauCrow');
    } else if (button === 'MALDruidCrowAttaque') {
      attributs.push('MALDruidCrowTAttaque');
    }

    const attrs = await getAttrsAsync(attributs);

    let tour = 0;
    let valeur = 0;

    if (button === 'druidCrowAttaque') {
      tour = attrs.druidCrowTAttaque;
      valeur = `[[2*${attrs.druidNiveauCrow}]]`;
    } else if (button === 'MALDruidCrowAttaque') {
      tour = attrs.MALDruidCrowTAttaque;
      valeur = 4;
    }

    const exec = [];
    exec.push(roll);

    const debordement = `${tour}*${valeur}`;

    exec.push(`{{debordement=[[${debordement}]]}}`);

    startRoll(exec.join(' '), (results) => {
      finishRoll(
        results.rollId,
        {},
      );
    });
  });
});
  /* eslint-disable no-loop-func */
/* eslint-disable default-case */
/* eslint-disable prefer-destructuring */
/* eslint-disable max-len */
/* eslint-disable camelcase */
/* eslint-disable no-undef */
on('clicked:mechaArmureARResilience', async (info) => {
  const roll = info.htmlAttributes.value;

  const attributs = [
    'mechaArmureSystemes',
    'mechaArmureResilience',
    'mechaArmureResilience_max',
  ];

  const attrs = await getAttrsAsync(attributs);

  const exec = [];

  const system = +attrs.mechaArmureSystemes;
  const resilience = +attrs.mechaArmureResilience;
  const resilienceMax = +attrs.mechaArmureResilience_max;
  const difficulte = Math.floor((resilienceMax - resilience) / 2);

  const cRoll = [system];

  exec.push(roll);

  if (cRoll.length === 0) { cRoll.push(0); }

  exec.push(`{{jDivers=^{test-autoreparation}}} {{jDiversV=[[ {[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}} {{jDivers2=^{difficulte}}} {{jDivers2V=${difficulte}}} {{rollText=[[0]]}}`);

  startRoll(exec.join(' '), (results) => {
    const test = results.results.jDiversV.result;
    let text = '';

    if (test > difficulte) {
      let recup = (test - difficulte) + resilience;

      if (recup > resilienceMax) { recup = resilienceMax; }

      const newAttr = {};
      newAttr.mechaArmureResilience = recup;

      setAttrs(newAttr);

      text = `${i18n_resilienceRepare} (${test - difficulte})`;
    } else { text = `${i18n_resilienceRepare} (0)`; }

    finishRoll(
      results.rollId,
      {
        rollText: text,
      },
    );
  });
});

on('clicked:mechaArmureARBlindage', async (info) => {
  const roll = info.htmlAttributes.value;

  const attributs = [
    'mechaArmureSystemes',
    'mechaArmureBlindage',
    'mechaArmureBlindage_max',
  ];

  const attrs = await getAttrsAsync(attributs);

  const exec = [];

  const system = +attrs.mechaArmureSystemes;
  const blindage = +attrs.mechaArmureBlindage;
  const blindageMax = +attrs.mechaArmureBlindage_max;
  const difficulte75 = Math.floor(blindageMax * 0.75);
  const difficulte50 = Math.floor(blindageMax * 0.50);
  const difficulte25 = Math.floor(blindageMax * 0.25);
  let difficulte;

  if (blindage >= difficulte75) { difficulte = 4; } else if (blindage >= difficulte50) { difficulte = 7; } else if (blindage >= difficulte25) { difficulte = 10; } else { difficulte = 15; }

  const cRoll = [system];

  exec.push(roll);

  if (cRoll.length === 0) { cRoll.push(0); }

  exec.push(`{{jDivers=^{test-autoreparation}}} {{jDiversV=[[ {[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}} {{jDivers2=^{difficulte}}} {{jDivers2V=${difficulte}}}`);

  startRoll(exec.join(' '), (results) => {
    const test = results.results.jDiversV.result;

    if (test > difficulte) {
      startRoll(`${roll} {{jDivers=${i18n_blindageRepare}}} {{jDiversV=[[2D6+6]]}}`, (results2) => {
        let recup = blindage + Number(results2.results.jDiversV.result);

        if (recup > blindageMax) { recup = blindageMax; }

        const newAttr = {};
        newAttr.mechaArmureBlindage = recup;

        setAttrs(newAttr);

        finishRoll(
          results2.rollId, {},
        );
      });
    }

    finishRoll(
      results.rollId, {},
    );
  });
});

on('clicked:manoeuvrabilite', async (info) => {
  const roll = info.htmlAttributes.value;

  const attributs = [
    'jetModifDes',
    'bonusCarac',
    'caracteristique1MA',
    'caracteristique2MA',
    'caracteristique3MA',
    'caracteristique4MA',
    'mechaArmureTypeJets',
    'mechaArmureManoeuvrabilite',
    'mechaArmurePuissance',
    'mechaArmureSenseurs',
    'mechaArmureSystemes',
  ];

  const attrs = await getAttrsAsync(attributs);

  const exec = [];
  const isConditionnel = false;

  const type = +attrs.mechaArmureTypeJets;

  const manoeuvrabilite = +attrs.mechaArmureManoeuvrabilite;
  const puissance = +attrs.mechaArmurePuissance;
  const senseurs = +attrs.mechaArmureSenseurs;
  const systemes = +attrs.mechaArmureSystemes;

  const mod = +attrs.jetModifDes;
  const hasBonus = +attrs.bonusCarac;

  const C1 = attrs.caracteristique1MA;
  const C2 = attrs.caracteristique2MA;
  const C3 = attrs.caracteristique3MA;
  const C4 = attrs.caracteristique4MA;

  const cRoll = [];
  const cNom1 = [];
  const cNom2 = [];

  const bonus = [];
  let OD = 0;

  exec.push(roll);

  exec.push('{{OD=true}}');

  const attrsCarac = await getCarac(hasBonus, C1, C2, C3, C4);

  if (attrsCarac.C1) {
    const C1Value = attrsCarac.C1Base;
    const C1OD = attrsCarac.C1OD;

    cNom1.push(attrsCarac.C1Nom);
    cRoll.push(C1Value);

    OD += C1OD;
  }

  if (attrsCarac.C2) {
    const C2Value = attrsCarac.C2Base;
    const C2OD = attrsCarac.C2OD;

    cNom1.push(attrsCarac.C2Nom);
    cRoll.push(C2Value);

    OD += C2OD;
  }

  if (attrsCarac.C3) {
    const C3Value = attrsCarac.C3Base;
    const C3OD = attrsCarac.C3OD;

    cNom2.push(attrsCarac.C3Nom);
    cRoll.push(C3Value);

    OD += C3OD;
  }

  if (attrsCarac.C4) {
    const C4Value = attrsCarac.C4Base;
    const C4OD = attrsCarac.C4OD;

    cNom2.push(attrsCarac.C4Nom);
    cRoll.push(C4Value);

    OD += C4OD;
  }

  exec.push(`{{vOD=${OD}}}`);

  exec.push(`{{cBase=${cNom1.join(' - ')}}}`);

  if (hasBonus > 0) { exec.push(`{{cBonus=${cNom2.join(' - ')}}}`); }

  if (mod !== 0) {
    cRoll.push(mod);
    exec.push(`{{mod=[[${mod}]]}}`);
  }

  switch (type) {
    case 1:
      cRoll.push(manoeuvrabilite);
      exec.push(`{{vManoeuvrabilite=+${manoeuvrabilite}D6}}`);
      break;
    case 2:
      cRoll.push(puissance);
      exec.push(`{{vPuissance=+${puissance}D6}}`);
      break;
    case 3:
      cRoll.push(senseurs);
      exec.push(`{{vSenseurs=+${senseurs}D6}}`);
      break;
    case 4:
      cRoll.push(systemes);
      exec.push(`{{vSystemes=+${systemes}D6}}`);
      break;
    default:
      break;
  }

  if (cRoll.length === 0) { cRoll.push(0); }

  bonus.push(OD);

  exec.push(`{{jet=[[ {[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`);
  exec.push(`{{tBonus=[[${bonus.join('+')}+0]]}}`);
  exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);

  if (isConditionnel === true) { exec.push('{{conditionnel=true}}'); }

  log(exec);

  startRoll(exec.join(' '), (results) => {
    const tJet = results.results.jet.result;
    const tBonus = results.results.tBonus.result;
    const tExploit = results.results.Exploit.result;

    const total = tJet + tBonus;

    finishRoll(
      results.rollId,
      {
        jet: total,
      },
    );

    if (tJet !== 0 && tJet === tExploit) {
      startRoll(`${roll}@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${i18n_exploit}}}{{jet=[[ {[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`, (exploit) => {
        const tExploit2 = exploit.results.jet.result;

        finishRoll(
          exploit.rollId,
          {
            jet: tExploit2,
          },
        );
      });
    }
  });
});

const rollMAImprovise = 14;

for (let i = 0; i < rollMAImprovise; i += 1) {
  const str = `MAAI${i}`;
  const strDgts = `dgts${i}`;
  const strViolence = `violence${i}`;

  on(`clicked:${str}`, async (info) => {
    const roll = info.htmlAttributes.value;

    let attributs = [
      'mechaArmurePuissance',
      'MAUtilisationArmeAI',
      'jetModifDes',
      'bonusCarac',
      'caracteristique3ArmeImprovisee',
      'caracteristique4ArmeImprovisee',
      'force',
      `${ODValue.force}`,
      'discretion',
      `${ODValue.discretion}`,
      'tir',
      `${ODValue.tir}`,
      'combat',
      `${ODValue.combat}`,
      'devasterAnatheme',
      'bourreauTenebres',
      'equilibreBalance',
      'MADDjinnWraithActive',
    ];

    const arme = [];

    arme.push(strDgts);
    arme.push(strViolence);

    attributs = attributs.concat(arme, listStyle);

    const attrs = await getAttrsAsync(attributs);

    let exec = [];
    exec.push(roll);

    const isConditionnelD = false;

    const cBase = [];
    const cBonus = [];
    let cRoll = [];
    const bonus = [];

    let OD = 0;

    const wraith = attrs.MADDjinnWraithActive;

    const type = attrs.MAUtilisationArmeAI;
    const mod = +attrs.jetModifDes;
    const hasBonus = +attrs.bonusCarac;

    const baseDegats = +attrs[strDgts].split('D')[0];
    const baseViolence = +attrs[strViolence].split('D')[0];

    let diceDegats = baseDegats;
    let diceViolence = baseDegats;

    const bDegats = [];
    const bViolence = [];

    let degats = [];
    let violence = [];

    let C1Nom;
    let C2Nom;

    const C3 = attrs.caracteristique3ArmeImprovisee;
    const C4 = attrs.caracteristique4ArmeImprovisee;

    if (type === '&{template:mechaArmure} {{special1=@{mechaArmureNom}}} {{portee=^{portee-contact}}}') {
      C1Nom = 'force';
      C2Nom = 'combat';
    } else {
      C1Nom = 'force';
      C2Nom = 'tir';
    }

    const attaquesSurprises = [];
    const attaquesSurprisesValue = [];
    const attaquesSurprisesCondition = '';

    const devaste = +attrs.devasterAnatheme;
    const bourreau = +attrs.bourreauTenebres;
    const equilibre = +attrs.equilibreBalance;

    let isSurprise = false;

    const autresEffets = [];

    exec.push('{{OD=true}}');

    const C1Value = +attrs[C1Nom];
    const C1OD = +attrs[ODValue[C1Nom]];

    cBase.push(CaracNom[C1Nom]);
    cRoll.push(C1Value);

    OD += C1OD;

    const C2Value = +attrs[C2Nom];
    const C2OD = +attrs[ODValue[C2Nom]];

    cBase.push(CaracNom[C2Nom]);
    cRoll.push(C2Value);

    OD += C2OD;

    const attrsCarac = await getCarac(hasBonus, '0', '0', C3, C4);

    if (attrsCarac.C3) {
      const C3Value = attrsCarac.C3Base;
      const C3OD = attrsCarac.C3OD;

      cBonus.push(attrsCarac.C3Nom);
      cRoll.push(C3Value);

      OD += C3OD;
    }

    if (attrsCarac.C4) {
      const C4Value = attrsCarac.C4Base;
      const C4OD = attrsCarac.C4OD;

      cBonus.push(attrsCarac.C4Nom);
      cRoll.push(C4Value);

      OD += C4OD;
    }

    exec.push(`{{vOD=${OD}}}`);

    if (mod !== 0) {
      cRoll.push(mod);
      exec.push(`{{mod=${mod}}}`);
    }

    // GESTION DU STYLE
    let getStyle;

    if (type === '&{template:combat} {{portee=^{portee-contact}}}') {
      getStyle = getStyleContactMod(attrs, '', baseDegats, baseViolence, true, 0, false, false, false, false, false, false, false, false, false);
    } else {
      getStyle = getStyleDistanceMod(attrs, baseDegats, baseViolence, 0, 0, true, 0, false, false, false, false);
    }

    exec = exec.concat(getStyle.exec);
    cRoll = cRoll.concat(getStyle.cRoll);
    diceDegats += getStyle.diceDegats;
    diceViolence += getStyle.diceViolence;

    // FIN GESTION DU STYLE

    if (wraith !== '0') {
      cRoll.push(+attrs.discretion);
      cBonus.push(+attrs[ODValue.discretion]);
      bDegats.push(+attrs.discretion);
      bDegats.push(+attrs[ODValue.discretion]);
      exec.push(`{{vWraithA=${+attrs.discretion}D6+${+attrs[ODValue.discretion]}}} {{vWraithD=[[${+attrs.discretion}+${+attrs[ODValue.discretion]}]]}}`);
    }

    if (cRoll.length === 0) { cRoll.push(0); }

    if (bonus.length === 0) { bonus.push(0); }

    bonus.push(OD);

    degats.push(`${diceDegats}D6`);
    degats = degats.concat(bDegats);

    violence.push(`${diceViolence}D6`);
    violence = violence.concat(bViolence);

    if (cBase.length !== 0) { exec.push(`{{cBase=${cBase.join(' - ')}}}`); }

    if (cBonus.length !== 0) { exec.push(`{{cBonus=${cBonus.join(' - ')}}}`); }

    cRoll.push(Number(attrs.mechaArmurePuissance));
    exec.push(`{{vPuissance=+${Number(attrs.mechaArmurePuissance)}D}}`);

    const jet = `{{jet=[[ {{[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0}]]}}`;

    exec.push(jet);
    exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);
    exec.push(`{{bonus=[[${bonus.join('+')}]]}}`);

    exec.push(`{{degats=[[${degats.join('+')}]]}}`);
    exec.push(`{{violence=[[${violence.join('+')}]]}}`);

    autresEffets.push(i18n_antiVehicule);
    autresEffets.push(`${i18n_dispersion} 9 (sur les ennemis de taille < 6m)`);

    if (attaquesSurprises.length > 0) {
      exec.push(`{{attaqueSurprise=${attaquesSurprises.join('\n+')}}}`);
      exec.push(`{{attaqueSurpriseValue=[[${attaquesSurprisesValue.join('+')}]]}}`);
      exec.push(attaquesSurprisesCondition);

      isSurprise = true;
    }

    if (devaste || bourreau || equilibre) {
      const herauts = [];

      if (devaste) { herauts.push(i18n_devasterAnatheme); }
      if (bourreau) { herauts.push(i18n_bourreauTenebres); }
      if (equilibre) { herauts.push(i18n_equilibrerBalance); }

      exec.push(`{{herauts=${herauts.join(' / ')}}}`);
    }

    if (autresEffets.length > 0) {
      autresEffets.sort();
      exec.push(`{{effets=${autresEffets.join(' / ')}}}`);
    }

    if (isConditionnelD) { exec.push('{{degatsConditionnel=true}}'); }

    const finalRoll = await startRoll(exec.join(' '));

    const tJet = finalRoll.results.jet.result;

    const tBonus = finalRoll.results.bonus.result;
    const tExploit = finalRoll.results.Exploit.result;
    const rDegats = finalRoll.results.degats.dice;

    const rViolence = finalRoll.results.violence.dice;

    const tDegats = finalRoll.results.degats.result;
    const tViolence = finalRoll.results.violence.result;

    const conditions = {
      bourreau,
      devaste,
      equilibre,
      isSurprise,
    };

    const computed = updateRoll(finalRoll, tDegats, rDegats, bDegats, tViolence, rViolence, bViolence, conditions);

    const finalComputed = {
      jet: tJet + tBonus,
    };

    Object.assign(finalComputed, computed);

    finishRoll(finalRoll.rollId, finalComputed);

    if (tJet !== 0 && tJet === tExploit) {
      const exploitRoll = await startRoll(`@{jetGM} &{template:mechaArmure} {{special1=@{mechaArmureNom}}} {{special1B=${i18n_exploit}}}${jet}`);
      const tRExploit = exploitRoll.results.jet.result;
      const exploitComputed = {
        jet: tRExploit,
      };

      finishRoll(exploitRoll.rollId, exploitComputed);
    }
  });
}

const rollArchangel = ['MAAGOffering', 'MAAGCurse', 'MAARMiracle', 'MAACanonNoe'];

rollArchangel.forEach((button) => {
  on(`clicked:${button}`, async (info) => {
    const roll = info.htmlAttributes.value.split(';');

    const exec = [];

    const base = roll[0];

    let noyaux;
    let armure;
    let blindage;
    let sante;
    let duree;
    let resilience;
    let choc;

    exec.push(base);

    let attrs = [];

    switch (button) {
      case 'MAAGOffering':
        attrs = await getAttrsAsync([roll[1]]);

        noyaux = +attrs[roll[1]];
        degats = roll[2];
        duree = roll[3];

        exec.push(`{{jDivers=^{duree-en-tours}}} {{jDiversV=[[${duree}]]}} {{jDivers3F12=^{si-bonus-degats-violence}}} {{jDiver3F12V=[[${degats}]]}}`);

        if (noyaux >= 2) { exec.push(`{{jDivers2=^{noyaux-depenses}}} {{jDivers2V=${noyaux}}}`); } else { exec.push(`{{jDivers2=^{noyau-depense}}} {{jDivers2V=${noyaux}}}`); }
        break;

      case 'MAAGCurse':
        attrs = await getAttrsAsync([roll[1]]);

        noyaux = +attrs[roll[1]];
        degats = roll[2];
        resilience = roll[3];
        choc = roll[4];

        exec.push(`{{jDivers3F12=^{si-malus-degats-violence}}} {{jDiver3F12V=[[${degats}]]}} {{jDivers4F12=^{si-baisse-resilience}}} {{jDiver4F12V=[[${resilience}]] / 3}}  {{jDivers5F12=^{si-choc}}} {{jDiver5F12V=[[${choc}]]}}`);

        if (noyaux >= 2) { exec.push(`{{jDivers2=^{noyaux-depenses}}} {{jDivers2V=${noyaux}}}`); } else { exec.push(`{{jDivers2=^{noyau-depense}}} {{jDivers2V=${noyaux}}}`); }
        break;

      case 'MAARMiracle':
        attrs = await getAttrsAsync([
          roll[1],
          roll[2],
          roll[3],
          roll[4],
        ]);

        sante = attrs[roll[1]];
        armure = attrs[roll[2]];
        blindage = attrs[roll[3]];
        resilience = attrs[roll[4]];
        duree = roll[5];

        exec.push(`{{jDivers=^{duree-en-tours}}} {{jDiversV=[[${duree}]]}} {{jDivers2F12=^{armure}}} {{jDivers2F12V=[[${armure}]]}} {{jDivers3F12=^{sante}}} {{jDiver3F12V=[[${sante}]]}} {{jDivers4F12=^{blindage}}} {{jDiver4F12V=[[${blindage}]]}} {{jDivers5F12=^{resilience}}} {{jDiver5F12V=${resilience}}}`);

        log(exec);
        break;

      case 'MAACanonNoe':
        attrs = await getAttrsAsync([
          roll[1],
          roll[2],
          roll[3],
        ]);

        armure = attrs[roll[1]];
        blindage = attrs[roll[2]];
        resilience = attrs[roll[3]];

        exec.push(`{{jDivers=^{armure}}} {{jDiversV=${armure}}} {{jDivers2=^{blindage}}} {{jDivers2V=${blindage}}} {{jDivers3=^{resilience}}} {{jDivers3V=[[${resilience}]]}}`);
        break;
      default:
        armure = 0;
        blindage = 0;
        resilience = 0;
        break;
    }

    startRoll(exec.join(' '), (results) => {
      finishRoll(
        results.rollId, {},
      );
    });
  });
});

const rollCombatArchangel = ['MAACanonMetatron'];

rollCombatArchangel.forEach((button) => {
  on(`clicked:${button}`, async (info) => {
    const roll = info.htmlAttributes.value.split(';');

    let exec = [];
    let listAttrs = [];
    let attrs = [];
    let attrsCarac = [];

    const base = roll[0];

    let mod;
    let C1;
    let C2;
    let C3;
    let C4;

    let bCarac;

    let jet;
    let cRoll = [];
    const rollBonus = [];
    const cBase = [];
    const cBonus = [];
    let cOD = 0;

    let degats;
    let bDegats;
    let violence;
    let bViolence;

    let getStyle;
    let autresEffets = [];

    exec.push(base);

    switch (button) {
      case 'MAACanonMetatron':
        listAttrs = [
          'mechaArmurePuissance',
          'bonusCarac',
          'jetModifDes',
          'canonMetatronCaracteristique1',
          'canonMetatronCaracteristique2',
          'canonMetatronCaracteristique3',
          'canonMetatronCaracteristique4',
          roll[1],
          roll[2],
          'devasterAnatheme',
          'bourreauTenebres',
          'equilibreBalance',
        ];

        listAttrs = listAttrs.concat(listStyle);

        attrs = await getAttrsAsync(listAttrs);

        bCarac = attrs.bonusCarac;
        mod = +attrs.jetModifDes;

        C1 = attrs.canonMetatronCaracteristique1;
        C2 = attrs.canonMetatronCaracteristique2;
        C3 = attrs.canonMetatronCaracteristique3;
        C4 = attrs.canonMetatronCaracteristique4;

        attrsCarac = await getCarac(bCarac, C1, C2, C3, C4);

        if (attrsCarac.C1) {
          const C1Value = attrsCarac.C1Base;
          const C1OD = attrsCarac.C1OD;

          cBase.push(attrsCarac.C1Nom);
          cRoll.push(C1Value);
          cOD += C1OD;
        }

        if (attrsCarac.C2) {
          const C2Value = attrsCarac.C2Base;
          const C2OD = attrsCarac.C2OD;

          cBase.push(attrsCarac.C2Nom);
          cRoll.push(C2Value);
          cOD += C2OD;
        }

        if (attrsCarac.C3) {
          const C3Value = attrsCarac.C3Base;
          const C3OD = attrsCarac.C3OD;

          cBonus.push(attrsCarac.C3Nom);
          cRoll.push(C3Value);
          cOD += C3OD;
        }

        if (attrsCarac.C4) {
          const C4Value = attrsCarac.C4Base;
          const C4OD = attrsCarac.C4OD;

          cBonus.push(attrsCarac.C4Nom);
          cRoll.push(C4Value);
          cOD += C4OD;
        }

        degats = Number(attrs[roll[1]].split('D')[0]);
        bDegats = Number(attrs[roll[1]].split('D')[1].split('+')[1]) || 0;

        violence = Number(attrs[roll[2]].split('D')[0]);
        bViolence = Number(attrs[roll[2]].split('D')[1].split('+')[1]) || 0;

        if (cBase.length > 0) { exec.push(cBase.join(' - ')); }

        if (cBonus.length > 0) { exec.push(cBonus.join(' - ')); }

        getStyle = getStyleDistanceMod(attrs, degats, violence, '', '', true, 0, false, false, false, false);

        exec = exec.concat(getStyle.exec);
        cRoll = cRoll.concat(getStyle.cRoll);
        cRoll.push(Number(attrs.mechaArmurePuissance));
        exec.push(`{{vPuissance=+${Number(attrs.mechaArmurePuissance)}D}}`);

        rollBonus.push(cOD);

        degats += getStyle.diceDegats;
        violence += getStyle.diceViolence;

        if (mod !== 0) {
          cRoll.push(mod);
          exec.push(`{{mod=${mod}}}`);
        }

        jet = `{{jet=[[ {{[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0}]]}}`;

        exec.push(jet);
        exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);

        if (rollBonus.length === 0) { rollBonus.push(0); }

        exec.push(`{{vOD=${cOD}}}`);
        exec.push(`{{bonus=[[${rollBonus.join('+')}]]}}`);

        exec.push(`{{degats=[[${degats}D6+${bDegats}]]}}`);
        exec.push(`{{violence=[[${violence}D6+${bViolence}]]}}`);

        if (cBase.length > 0) { exec.push(`{{cBase=${cBase.join(' - ')}}}`); }

        if (cBonus.length > 0) { exec.push(`{{cBonus=${cBonus.join(' - ')}}}`); }

        exec.push(`{{succesConditionnel=true}} {{parasitage=${i18n_parasitage} 2}} {{parasitageCondition=${i18n_parasitageCondition}}}`);

        autresEffets = [
          i18n_antiVehicule,
          i18n_briserResilience,
          `${i18n_degatsContinus} 10 ([[1d6]] ${i18n_tours})`,
        ];

        autresEffets.sort();

        exec.push(`{{effets=${autresEffets.join(' / ')}}}`);
        break;
    }

    const devaste = +attrs.devasterAnatheme;
    const bourreau = +attrs.bourreauTenebres;
    const equilibre = +attrs.equilibreBalance;

    if (devaste || bourreau || equilibre) {
      const herauts = [];

      if (devaste) { herauts.push(i18n_devasterAnatheme); }
      if (bourreau) { herauts.push(i18n_bourreauTenebres); }
      if (equilibre) { herauts.push(i18n_equilibrerBalance); }

      exec.push(`{{herauts=${herauts.join(' / ')}}}`);
    }

    const finalRoll = await startRoll(exec.join(' '));

    const tJet = finalRoll.results.jet.result;

    const tBonus = finalRoll.results.bonus.result;
    const tExploit = finalRoll.results.Exploit.result;

    const rDegats = finalRoll.results.degats.dice;
    const rViolence = finalRoll.results.violence.dice;

    const tDegats = finalRoll.results.degats.result;
    const tViolence = finalRoll.results.violence.result;

    const conditions = {
      bourreau,
      devaste,
      equilibre,
    };

    const computed = updateRoll(finalRoll, tDegats, rDegats, [bDegats], tViolence, rViolence, [bViolence], conditions);

    const finalComputed = {
      jet: tJet + tBonus,
    };

    Object.assign(finalComputed, computed);

    finishRoll(finalRoll.rollId, finalComputed);

    if (tJet !== 0 && tJet === tExploit) {
      const exploitRoll = await startRoll(`${roll}@{jetGM} &{template:mechaArmure} {{special1=@{mechaArmureNom}}} {{special1B=${i18n_exploit}}}${jet}`);
      const tRExploit = exploitRoll.results.jet.result;
      const exploitComputed = {
        jet: tRExploit,
      };

      finishRoll(exploitRoll.rollId, exploitComputed);
    }
  });
});

const rollNephilim = ['MANOGInvulnerabilite', 'MANOGStationDebordement', 'MANOGStationMissile', 'MANOGStationRoquette', 'MANMJ'];

rollNephilim.forEach((button) => {
  on(`clicked:${button}`, async (info) => {
    const roll = info.htmlAttributes.value.split(';');

    const exec = [];
    let attrs = [];

    const base = roll[0];

    let duree;
    let tours;
    let degats;
    let violence;

    let devaste = false;
    let bourreau = false;
    let equilibre = false;

    let isMeurtrier = false;
    let isFureur = false;

    const effets = [];

    exec.push(base);

    switch (button) {
      case 'MANOGInvulnerabilite':
        attrs = await getAttrsAsync([roll[1]]);

        duree = attrs[roll[1]];

        exec.push(`{{jDivers=^{duree-en-tours}}} {{jDiversV=[[${duree}]]}}`);
        break;

      case 'MANOGStationDebordement':
        attrs = await getAttrsAsync([roll[1]]);

        tours = attrs[roll[1]];

        exec.push(`{{jDivers=^{debordement}}} {{jDiversV=[[${tours}*10]]}}`);
        break;

      case 'MANOGStationMissile':
        attrs = await getAttrsAsync([
          'devasterAnatheme',
          'bourreauTenebres',
          'equilibreBalance',
        ]);

        devaste = +attrs.devasterAnatheme;
        bourreau = +attrs.bourreauTenebres;
        equilibre = +attrs.equilibreBalance;

        degats = roll[1];
        violence = roll[2];

        effets.push(i18n_antiVehicule);
        effets.push(i18n_artillerie);
        effets.sort();

        exec.push(`{{degats=[[${degats}]]}} {{violence=[[${violence}]]}} {{effets=${effets.join(' / ')}}}`);
        break;

      case 'MANOGStationRoquette':
        attrs = await getAttrsAsync([
          'devasterAnatheme',
          'bourreauTenebres',
          'equilibreBalance',
        ]);

        degats = roll[1];
        violence = roll[2];

        devaste = +attrs.devasterAnatheme;
        bourreau = +attrs.bourreauTenebres;
        equilibre = +attrs.equilibreBalance;

        exec.push(`{{degats=[[${degats}]]}} {{violence=[[${violence}]]}}`);
        break;

      case 'MANMJ':
        attrs = await getAttrsAsync([
          roll[1],
          roll[2],
          'devasterAnatheme',
          'bourreauTenebres',
          'equilibreBalance',
        ]);

        degats = attrs[roll[1]];
        violence = attrs[roll[2]];

        effets.push(i18n_antiVehicule);
        effets.push(i18n_demoralisant);
        effets.push(i18n_briserResilience);
        effets.sort();

        isMeurtrier = true;
        isFureur = true;

        exec.push(`{{degats=[[${degats}]]}} {{degatsConditionnel=true}} {{meurtrier=${i18n_meurtrier}}} {{meurtrierValue=[[2D6]]}} {{meurtrierCondition=${i18n_meurtrierCondition}}} {{violence=[[${violence}]]}} {{violenceConditionnel=true}} {{fureur=${i18n_fureur}}} {{fureurValue=[[2D6]]}} {{fureurCondition=${i18n_fureurCondition}}} {{antiAnatheme=${i18n_antiAnatheme}}} {{antiAnathemeCondition=${i18n_antiAnathemeCondition}}} {{effets=${effets.join(' / ')}}}`);
        break;
    }

    if (devaste || bourreau || equilibre) {
      const herauts = [];

      if (devaste) { herauts.push(i18n_devasterAnatheme); }
      if (bourreau) { herauts.push(i18n_bourreauTenebres); }
      if (equilibre) { herauts.push(i18n_equilibrerBalance); }

      exec.push(`{{herauts=${herauts.join(' / ')}}}`);
    }

    const finalRoll = await startRoll(exec.join(' '));

    let computed = {};

    if (button === 'MANOGStationMissile' || button === 'MANOGStationRoquette' || button === 'MANMJ') {
      const rDegats = finalRoll.results.degats.dice;
      const rViolence = finalRoll.results.violence.dice;

      const tDegats = finalRoll.results.degats.result;
      const tViolence = finalRoll.results.violence.result;

      const conditions = {
        bourreau,
        devaste,
        equilibre,
        isFureur,
        isMeurtrier,
      };

      computed = updateRoll(finalRoll, tDegats, rDegats, [], tViolence, rViolence, [], conditions);
    }

    finishRoll(finalRoll.rollId, computed);
  });
});

const rollCombatNephilim = ['MANCanonMagma', 'MANMSurtur'];

rollCombatNephilim.forEach((button) => {
  on(`clicked:${button}`, async (info) => {
    const roll = info.htmlAttributes.value.split(';');

    let exec = [];
    let listAttrs = [];
    let attrs = [];
    let attrsCarac = [];

    const base = roll[0];

    let mod;
    let C1;
    let C2;
    let C3;
    let C4;

    let bCarac;

    let jet;
    let cRoll = [];
    const rollBonus = [];
    const cBase = [];
    const cBonus = [];
    let cOD = 0;

    let degats;
    let bDegats;
    let violence;
    let bViolence;
    let isFureur = false;
    let isUltraviolence = false;

    let getStyle;

    let autresEffets;

    exec.push(base);

    switch (button) {
      case 'MANCanonMagma':
        listAttrs = [
          roll[1],
          roll[2],
          'mechaArmurePuissance',
          'bonusCarac',
          'jetModifDes',
          'canonMagmaCaracteristique1',
          'canonMagmaCaracteristique2',
          'canonMagmaCaracteristique3',
          'canonMagmaCaracteristique4',
          'devasterAnatheme',
          'bourreauTenebres',
          'equilibreBalance',
        ];

        listAttrs = listAttrs.concat(listStyle);

        attrs = await getAttrsAsync(listAttrs);

        bCarac = attrs.bonusCarac;
        mod = +attrs.jetModifDes;

        isFureur = true;

        C1 = attrs.canonMagmaCaracteristique1;
        C2 = attrs.canonMagmaCaracteristique2;
        C3 = attrs.canonMagmaCaracteristique3;
        C4 = attrs.canonMagmaCaracteristique4;

        attrsCarac = await getCarac(bCarac, C1, C2, C3, C4);

        if (attrsCarac.C1) {
          const C1Value = attrsCarac.C1Base;
          const C1OD = attrsCarac.C1OD;

          cBase.push(attrsCarac.C1Nom);
          cRoll.push(C1Value);
          cOD += C1OD;
        }

        if (attrsCarac.C2) {
          const C2Value = attrsCarac.C2Base;
          const C2OD = attrsCarac.C2OD;

          cBase.push(attrsCarac.C2Nom);
          cRoll.push(C2Value);
          cOD += C2OD;
        }

        if (attrsCarac.C3) {
          const C3Value = attrsCarac.C3Base;
          const C3OD = attrsCarac.C3OD;

          cBonus.push(attrsCarac.C3Nom);
          cRoll.push(C3Value);
          cOD += C3OD;
        }

        if (attrsCarac.C4) {
          const C4Value = attrsCarac.C4Base;
          const C4OD = attrsCarac.C4OD;

          cBonus.push(attrsCarac.C4Nom);
          cRoll.push(C4Value);
          cOD += C4OD;
        }

        degats = Number(attrs[roll[1]].split('D')[0]);
        bDegats = Number(attrs[roll[1]].split('D')[1].split('+')[1]) || 0;

        violence = Number(attrs[roll[2]].split('D')[0]);
        bViolence = Number(attrs[roll[2]].split('D')[1].split('+')[1]) || 0;

        getStyle = getStyleDistanceMod(attrs, degats, violence, '', '', true, 0, false, false, false, false);

        exec = exec.concat(getStyle.exec);
        cRoll = cRoll.concat(getStyle.cRoll);
        cRoll.push(Number(attrs.mechaArmurePuissance));
        exec.push(`{{vPuissance=+${Number(attrs.mechaArmurePuissance)}D}}`);

        rollBonus.push(cOD);

        degats += getStyle.diceDegats;
        violence += getStyle.diceViolence;

        jet = `{{jet=[[ {{[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0}]]}}`;

        exec.push(jet);
        exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);

        if (rollBonus.length === 0) { rollBonus.push(0); }

        exec.push(`{{vOD=${cOD}}}`);
        exec.push(`{{bonus=[[${rollBonus.join('+')}]]}}`);

        exec.push(`{{degats=[[${degats}D6+${bDegats}]]}}`);
        exec.push(`{{violence=[[${violence}D6+${bViolence}]]}}`);

        if (cBase.length > 0) { exec.push(`{{cBase=${cBase.join(' - ')}}}`); }

        if (cBonus.length > 0) { exec.push(`{{cBonus=${cBonus.join(' - ')}}}`); }

        exec.push(`{{degatsConditionnel=true}} {{violenceConditionnel=true}} {{antiAnatheme=${i18n_antiAnatheme}}} {{antiAnathemeCondition=${i18n_antiAnathemeCondition}}} {{fureur=${i18n_fureur}}} {{fureurValue=[[2D6]]}} {{fureurCondition=${i18n_fureurCondition}}}`);

        autresEffets = [
          `${i18n_dispersion} 12`,
          i18n_briserResilience,
          i18n_antiVehicule,
        ];

        autresEffets.sort();

        exec.push(`{{effets=${autresEffets.join(' / ')}}}`);
        break;

      case 'MANMSurtur':
        listAttrs = [
          roll[1],
          roll[2],
          'mechaArmurePuissance',
          'bonusCarac',
          'jetModifDes',
          'MSurturCaracteristique1',
          'MSurturCaracteristique2',
          'MSurturCaracteristique3',
          'MSurturCaracteristique4',
          'devasterAnatheme',
          'bourreauTenebres',
          'equilibreBalance',
        ];

        listAttrs = listAttrs.concat(listStyle);

        attrs = await getAttrsAsync(listAttrs);

        isUltraviolence = true;

        bCarac = attrs.bonusCarac;
        mod = +attrs.jetModifDes;

        C1 = attrs.MSurturCaracteristique1;
        C2 = attrs.MSurturCaracteristique2;
        C3 = attrs.MSurturCaracteristique3;
        C4 = attrs.MSurturCaracteristique4;

        attrsCarac = await getCarac(bCarac, C1, C2, C3, C4);

        if (attrsCarac.C1) {
          const C1Value = attrsCarac.C1Base;
          const C1OD = attrsCarac.C1OD;

          cBase.push(attrsCarac.C1Nom);
          cRoll.push(C1Value);
          cOD += C1OD;
        }

        if (attrsCarac.C2) {
          const C2Value = attrsCarac.C2Base;
          const C2OD = attrsCarac.C2OD;

          cBase.push(attrsCarac.C2Nom);
          cRoll.push(C2Value);
          cOD += C2OD;
        }

        if (attrsCarac.C3) {
          const C3Value = attrsCarac.C3Base;
          const C3OD = attrsCarac.C3OD;

          cBonus.push(attrsCarac.C3Nom);
          cRoll.push(C3Value);
          cOD += C3OD;
        }

        if (attrsCarac.C4) {
          const C4Value = attrsCarac.C4Base;
          const C4OD = attrsCarac.C4OD;

          cBonus.push(attrsCarac.C4Nom);
          cRoll.push(C4Value);
          cOD += C4OD;
        }

        degats = Number(attrs[roll[1]].split('D')[0]);
        bDegats = Number(attrs[roll[1]].split('D')[1].split('+')[1]) || 0;

        violence = Number(attrs[roll[2]].split('D')[0]);
        bViolence = Number(attrs[roll[2]].split('D')[1].split('+')[1]) || 0;

        getStyle = getStyleDistanceMod(attrs, degats, violence, '', '', true, 0, false, false, false, false);

        exec = exec.concat(getStyle.exec);
        cRoll = cRoll.concat(getStyle.cRoll);
        cRoll.push(Number(attrs.mechaArmurePuissance));
        exec.push(`{{vPuissance=+${Number(attrs.mechaArmurePuissance)}D}}`);

        rollBonus.push(cOD);

        degats += getStyle.diceDegats;
        violence += getStyle.diceViolence;

        if (mod !== 0) {
          cRoll.push(mod);
          exec.push(`{{mod=${mod}}}`);
        }

        jet = `{{jet=[[ {{[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0}]]}}`;

        exec.push(jet);
        exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);

        if (rollBonus.length === 0) { rollBonus.push(0); }

        exec.push(`{{vOD=${cOD}}}`);
        exec.push(`{{bonus=[[${rollBonus.join('+')}]]}}`);

        exec.push(`{{degats=[[${degats}D6+${bDegats}]]}}`);
        exec.push(`{{violence=[[${violence}D6+${bViolence}]]}}`);

        if (cBase.length > 0) { exec.push(`{{cBase=${cBase.join(' - ')}}}`); }

        if (cBonus.length > 0) { exec.push(`{{cBonus=${cBonus.join(' - ')}}}`); }

        exec.push(`{{violenceConditionnel=true}} {{ultraviolence=${i18n_ultraviolence}}} {{ultraViolenceValue=[[2D6]]}} {{ultraviolenceCondition=${i18n_ultraviolenceCondition}}}`);

        autresEffets = [
          i18n_demoralisant,
          i18n_antiVehicule,
        ];

        autresEffets.sort();

        exec.push(`{{effets=${autresEffets.join(' / ')}}}`);
        break;
    }

    const devaste = +attrs.devasterAnatheme;
    const bourreau = +attrs.bourreauTenebres;
    const equilibre = +attrs.equilibreBalance;

    if (devaste || bourreau || equilibre) {
      const herauts = [];

      if (devaste) { herauts.push(i18n_devasterAnatheme); }
      if (bourreau) { herauts.push(i18n_bourreauTenebres); }
      if (equilibre) { herauts.push(i18n_equilibrerBalance); }

      exec.push(`{{herauts=${herauts.join(' / ')}}}`);
    }

    const finalRoll = await startRoll(exec.join(' '));

    const tJet = finalRoll.results.jet.result;

    const tBonus = finalRoll.results.bonus.result;
    const tExploit = finalRoll.results.Exploit.result;

    const rDegats = finalRoll.results.degats.dice;
    const rViolence = finalRoll.results.violence.dice;

    const tDegats = finalRoll.results.degats.result;
    const tViolence = finalRoll.results.violence.result;

    const conditions = {
      bourreau,
      devaste,
      equilibre,
      isFureur,
      isUltraviolence,
    };

    const computed = updateRoll(finalRoll, tDegats, rDegats, [bDegats], tViolence, rViolence, [bViolence], conditions);

    const finalComputed = {
      jet: tJet + tBonus,
    };

    Object.assign(finalComputed, computed);

    finishRoll(finalRoll.rollId, finalComputed);

    if (tJet !== 0 && tJet === tExploit) {
      const exploitRoll = await startRoll(`${roll}@{jetGM} &{template:mechaArmure} {{special1=@{mechaArmureNom}}} {{special1B=${i18n_exploit}}}${jet}`);
      const tRExploit = exploitRoll.results.jet.result;
      const exploitComputed = {
        jet: tRExploit,
      };

      finishRoll(exploitRoll.rollId, exploitComputed);
    }
  });
});

const rollDemon = ['MAAMI', 'MAATLA'];

rollDemon.forEach((button) => {
  on(`clicked:${button}`, async (info) => {
    const roll = info.htmlAttributes.value.split(';');

    const exec = [];
    let attrs = [];

    const base = roll[0];

    let wraith;

    let degats;
    let violence;
    let bDegats = 0;
    let bViolence = 0;

    exec.push(base);

    switch (button) {
      case 'MAAMI':

        attrs = await getAttrsAsync([
          roll[1],
          roll[2],
          'devasterAnatheme',
          'bourreauTenebres',
          'equilibreBalance',
          'MADDjinnWraithActive',
          'discretion',
          `${ODValue.discretion}`,
        ]);

        wraith = attrs.MADDjinnWraithActive;

        degats = attrs[roll[1]];
        violence = attrs[roll[2]];

        bDegats = +degats.split('+')[1];
        bViolence = +violence.split('+')[1];

        if (wraith !== '0') {
          degats += `+${+attrs.discretion + +attrs[ODValue.discretion]}`;
          bDegats += +attrs.discretion + +attrs[ODValue.discretion];
          exec.push(`{{vWraithD=[[${+attrs.discretion}+${+attrs[ODValue.discretion]}]]}}`);
        }

        exec.push(`{{degats=[[${degats}]]}} {{violence=[[${violence}]]}} {{effets=^{CDF-desactive-pendant} [[1D3]] ^{tours}}}`);
        break;

      case 'MAATLA':
        attrs = await getAttrsAsync([
          roll[1],
          roll[2],
          'devasterAnatheme',
          'bourreauTenebres',
          'equilibreBalance',
          'MADDjinnWraithActive',
          'discretion',
          `${ODValue.discretion}`,
        ]);

        wraith = attrs.MADDjinnWraithActive;

        degats = attrs[roll[1]];
        violence = attrs[roll[2]];

        if (wraith !== '0') {
          degats += `+${+attrs.discretion + +attrs[ODValue.discretion]}`;
          bDegats += +attrs.discretion + +attrs[ODValue.discretion];
          exec.push(`{{vWraithD=[[${+attrs.discretion}+${+attrs[ODValue.discretion]}]]}}`);
        }

        exec.push(`{{degats=[[${degats}]]}} {{violence=[[${violence}]]}} {{degatsConditionnel=true}} {{violenceConditionnel=true}} {{antiAnatheme=${i18n_antiAnatheme}}} {{antiAnathemeCondition=${i18n_antiAnathemeCondition}}} {{effets=${i18n_antiVehicule}}}`);
        break;
    }

    if (wraith !== '0') {
      exec.push('{{special2=^{module-wraith} ^{active}}}');
    }

    const devaste = +attrs.devasterAnatheme;
    const bourreau = +attrs.bourreauTenebres;
    const equilibre = +attrs.equilibreBalance;

    if (devaste || bourreau || equilibre) {
      const herauts = [];

      if (devaste) { herauts.push(i18n_devasterAnatheme); }
      if (bourreau) { herauts.push(i18n_bourreauTenebres); }
      if (equilibre) { herauts.push(i18n_equilibrerBalance); }

      exec.push(`{{herauts=${herauts.join(' / ')}}}`);
    }

    const finalRoll = await startRoll(exec.join(' '));

    const rDegats = finalRoll.results.degats.dice;
    const rViolence = finalRoll.results.violence.dice;

    const tDegats = finalRoll.results.degats.result;
    const tViolence = finalRoll.results.violence.result;

    const conditions = {
      bourreau,
      devaste,
      equilibre,
    };

    const computed = updateRoll(finalRoll, tDegats, rDegats, [bDegats], tViolence, rViolence, [bViolence], conditions);

    finishRoll(finalRoll.rollId, computed);
  });
});

const rollCombatDemon = ['MADSouffle', 'MADjinnWraith', 'MADPSoniques', 'MADLCG'];

rollCombatDemon.forEach((button) => {
  on(`clicked:${button}`, async (info) => {
    const roll = info.htmlAttributes.value.split(';');

    let exec = [];

    const base = roll[0];

    let mod;
    let C1;
    let C2;
    let C3;
    let C4;

    let bCarac;

    let listAttrs = [];
    let attrs = [];
    let attrsCarac = [];

    let jet;
    let cRoll = [];
    const rollBonus = [];
    const cBase = [];
    const cBonus = [];
    let cOD = 0;

    let wraith;

    let degats;
    let bDegats;
    let violence;
    let bViolence;

    let getStyle;

    let autresEffets;

    exec.push(base);

    switch (button) {
      case 'MADSouffle':
        listAttrs = [
          'bonusCarac',
          'jetModifDes',
          'mechaArmurePuissance',
          'DSouffleCaracteristique1',
          'DSouffleCaracteristique2',
          'DSouffleCaracteristique3',
          'DSouffleCaracteristique4',
          roll[1],
          roll[2],
          'devasterAnatheme',
          'bourreauTenebres',
          'equilibreBalance',
          'MADDjinnWraithActive',
          'discretion',
          `${ODValue.discretion}`,
        ];

        listAttrs = listAttrs.concat(listStyle);

        attrs = await getAttrsAsync(listAttrs);

        wraith = attrs.MADDjinnWraithActive;

        bCarac = attrs.bonusCarac;
        mod = +attrs.jetModifDes;

        C1 = attrs.DSouffleCaracteristique1;
        C2 = attrs.DSouffleCaracteristique2;
        C3 = attrs.DSouffleCaracteristique3;
        C4 = attrs.DSouffleCaracteristique4;

        attrsCarac = await getCarac(bCarac, C1, C2, C3, C4);

        if (attrsCarac.C1) {
          const C1Value = attrsCarac.C1Base;
          const C1OD = attrsCarac.C1OD;

          cBase.push(attrsCarac.C1Nom);
          cRoll.push(C1Value);
          cOD += C1OD;
        }

        if (attrsCarac.C2) {
          const C2Value = attrsCarac.C2Base;
          const C2OD = attrsCarac.C2OD;

          cBase.push(attrsCarac.C2Nom);
          cRoll.push(C2Value);
          cOD += C2OD;
        }

        if (attrsCarac.C3) {
          const C3Value = attrsCarac.C3Base;
          const C3OD = attrsCarac.C3OD;

          cBonus.push(attrsCarac.C3Nom);
          cRoll.push(C3Value);
          cOD += C3OD;
        }

        if (attrsCarac.C4) {
          const C4Value = attrsCarac.C4Base;
          const C4OD = attrsCarac.C4OD;

          cBonus.push(attrsCarac.C4Nom);
          cRoll.push(C4Value);
          cOD += C4OD;
        }

        degats = Number(attrs[roll[1]].split('D')[0]);
        bDegats = Number(attrs[roll[1]].split('D')[1].split('+')[1]) || 0;

        violence = Number(attrs[roll[2]]);
        bViolence = 0;

        getStyle = getStyleDistanceMod(attrs, degats, violence, '', '', true, 0, false, false, false, false);

        exec = exec.concat(getStyle.exec);
        cRoll = cRoll.concat(getStyle.cRoll);
        cRoll.push(Number(attrs.mechaArmurePuissance));
        exec.push(`{{vPuissance=+${Number(attrs.mechaArmurePuissance)}D}}`);

        rollBonus.push(cOD);

        degats += getStyle.diceDegats;
        violence += getStyle.diceViolence;

        if (wraith !== '0') {
          cRoll.push(+attrs.discretion);
          rollBonus.push(+attrs[ODValue.discretion]);

          bDegats += +attrs.discretion + +attrs[ODValue.discretion];
          exec.push(`{{vWraithA=${+attrs.discretion}D6+${+attrs[ODValue.discretion]}}} {{vWraithD=[[${+attrs.discretion}+${+attrs[ODValue.discretion]}]]}}`);
        }

        jet = `{{jet=[[ {{[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0}]]}}`;

        exec.push(jet);
        exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);

        if (rollBonus.length === 0) { rollBonus.push(0); }

        exec.push(`{{vOD=${cOD}}}`);
        exec.push(`{{bonus=[[${rollBonus.join('+')}]]}}`);

        exec.push(`{{degats=[[${degats}D6+${bDegats}]]}}`);
        exec.push(`{{violence=[[${violence}D6+${bViolence}]]}}`);

        if (cBase.length > 0) { exec.push(`{{cBase=${cBase.join(' - ')}}}`); }

        if (cBonus.length > 0) { exec.push(`{{cBonus=${cBonus.join(' - ')}}}`); }

        autresEffets = [
          `${i18n_parasitage} 2`,
          i18n_briserResilience,
          i18n_antiVehicule,
        ];

        autresEffets.sort();

        exec.push(`{{effets=${autresEffets.join(' / ')}}}`);
        break;

      case 'MADjinnWraith':
        listAttrs = [
          'jetModifDes',
          'bonusCarac',
          'mechaArmureManoeuvrabilite',
          'MADDjinnWraithActive',
          'caracteristiqueWraith2',
          'caracteristiqueWraith3',
          'caracteristiqueWraith4',
          roll[1],
          roll[2],
          'devasterAnatheme',
          'bourreauTenebres',
          'equilibreBalance',
        ];

        attrs = await getAttrsAsync(listAttrs);

        wraith = attrs.MADDjinnWraithActive;

        bCarac = attrs.bonusCarac;
        mod = +attrs.jetModifDes;

        C1 = '@{discretion}';
        C2 = attrs.caracteristiqueWraith2;
        C3 = attrs.caracteristiqueWraith3;
        C4 = attrs.caracteristiqueWraith4;

        attrsCarac = await getCarac(bCarac, C1, C2, C3, C4);

        if (attrsCarac.C1) {
          const C1Value = attrsCarac.C1Base;
          const C1OD = attrsCarac.C1OD;

          cBase.push(attrsCarac.C1Nom);
          cRoll.push(C1Value);
          cOD += C1OD;
        }

        if (attrsCarac.C2) {
          const C2Value = attrsCarac.C2Base;
          const C2OD = attrsCarac.C2OD;

          cBase.push(attrsCarac.C2Nom);
          cRoll.push(C2Value);
          cOD += C2OD;
        }

        if (attrsCarac.C3) {
          const C3Value = attrsCarac.C3Base;
          const C3OD = attrsCarac.C3OD;

          cBonus.push(attrsCarac.C3Nom);
          cRoll.push(C3Value);
          cOD += C3OD;
        }

        if (attrsCarac.C4) {
          const C4Value = attrsCarac.C4Base;
          const C4OD = attrsCarac.C4OD;

          cBonus.push(attrsCarac.C4Nom);
          cRoll.push(C4Value);
          cOD += C4OD;
        }

        cRoll.push(Number(attrs.mechaArmureManoeuvrabilite));
        exec.push(`{{vManoeuvrabilite=+${Number(attrs.mechaArmureManoeuvrabilite)}D}}`);

        rollBonus.push(cOD);

        jet = `{{jet=[[ {{[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0}]]}}`;

        exec.push(jet);
        exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);

        if (rollBonus.length === 0) { rollBonus.push(0); }

        exec.push(`{{vOD=${cOD}}}`);
        exec.push(`{{bonus=[[${rollBonus.join('+')}]]}}`);

        if (cBase.length > 0) { exec.push(`{{cBase=${cBase.join(' - ')}}}`); }

        if (cBonus.length > 0) { exec.push(`{{cBonus=${cBonus.join(' - ')}}}`); }
        break;

      case 'MADPSoniques':
        listAttrs = [
          'jetModifDes',
          'bonusCarac',
          'mechaArmurePuissance',
          'APoingsCaracteristique1',
          'APoingsCaracteristique2',
          'APoingsCaracteristique3',
          'APoingsCaracteristique4',
          roll[1],
          roll[2],
          'devasterAnatheme',
          'bourreauTenebres',
          'equilibreBalance',
          'MADDjinnWraithActive',
          'discretion',
          `${ODValue.discretion}`,
        ];

        listAttrs = listAttrs.concat(listStyle);

        attrs = await getAttrsAsync(listAttrs);

        wraith = attrs.MADDjinnWraithActive;

        bCarac = attrs.bonusCarac;
        mod = +attrs.jetModifDes;

        C1 = attrs.APoingsCaracteristique1;
        C2 = attrs.APoingsCaracteristique2;
        C3 = attrs.APoingsCaracteristique3;
        C4 = attrs.APoingsCaracteristique4;

        attrsCarac = await getCarac(bCarac, C1, C2, C3, C4);

        if (attrsCarac.C1) {
          const C1Value = attrsCarac.C1Base;
          const C1OD = attrsCarac.C1OD;

          cBase.push(attrsCarac.C1Nom);
          cRoll.push(C1Value);
          cOD += C1OD;
        }

        if (attrsCarac.C2) {
          const C2Value = attrsCarac.C2Base;
          const C2OD = attrsCarac.C2OD;

          cBase.push(attrsCarac.C2Nom);
          cRoll.push(C2Value);
          cOD += C2OD;
        }

        if (attrsCarac.C3) {
          const C3Value = attrsCarac.C3Base;
          const C3OD = attrsCarac.C3OD;

          cBonus.push(attrsCarac.C3Nom);
          cRoll.push(C3Value);
          cOD += C3OD;
        }

        if (attrsCarac.C4) {
          const C4Value = attrsCarac.C4Base;
          const C4OD = attrsCarac.C4OD;

          cBonus.push(attrsCarac.C4Nom);
          cRoll.push(C4Value);
          cOD += C4OD;
        }

        degats = Number(attrs[roll[1]].split('D')[0]);
        bDegats = Number(attrs[roll[1]].split('D')[1].split('+')[1]) || 0;

        violence = Number(attrs[roll[2]].split('D')[0]);
        bViolence = Number(attrs[roll[2]].split('D')[1].split('+')[1]) || 0;

        getStyle = getStyleDistanceMod(attrs, degats, violence, '', '', true, 0, false, false, false, false);

        exec = exec.concat(getStyle.exec);
        cRoll = cRoll.concat(getStyle.cRoll);
        cRoll.push(Number(attrs.mechaArmurePuissance));
        exec.push(`{{vPuissance=+${Number(attrs.mechaArmurePuissance)}D}}`);

        rollBonus.push(cOD);

        degats += getStyle.diceDegats;
        violence += getStyle.diceViolence;

        if (wraith !== '0') {
          cRoll.push(+attrs.discretion);
          rollBonus.push(+attrs[ODValue.discretion]);

          bDegats += +attrs.discretion + +attrs[ODValue.discretion];
          exec.push(`{{vWraithA=${+attrs.discretion}D6+${+attrs[ODValue.discretion]}}} {{vWraithD=[[${+attrs.discretion}+${+attrs[ODValue.discretion]}]]}}`);
        }

        jet = `{{jet=[[ {{[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0}]]}}`;

        exec.push(jet);
        exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);

        if (rollBonus.length === 0) { rollBonus.push(0); }

        exec.push(`{{vOD=${cOD}}}`);
        exec.push(`{{bonus=[[${rollBonus.join('+')}]]}}`);

        exec.push(`{{degats=[[${degats}D6+${bDegats}]]}}`);
        exec.push(`{{violence=[[${violence}D6+${bViolence}]]}}`);

        if (cBase.length > 0) { exec.push(`{{cBase=${cBase.join(' - ')}}}`); }

        if (cBonus.length > 0) { exec.push(`{{cBonus=${cBonus.join(' - ')}}}`); }

        autresEffets = [
          i18n_antiVehicule,
          i18n_poingsSoniques,
        ];

        autresEffets.sort();

        exec.push(`{{effets=${autresEffets.join(' / ')}}}`);
        break;

      case 'MADLCG':
        listAttrs = [
          'jetModifDes',
          'bonusCarac',
          'mechaArmurePuissance',
          'LCGCaracteristique1',
          'LCGCaracteristique2',
          'LCGCaracteristique3',
          'LCGCaracteristique4',
          roll[1],
          roll[2],
          'devasterAnatheme',
          'bourreauTenebres',
          'equilibreBalance',
          'MADDjinnWraithActive',
          'discretion',
          `${ODValue.discretion}`,
        ];

        listAttrs = listAttrs.concat(listStyle);
        attrs = await getAttrsAsync(listAttrs);

        wraith = attrs.MADDjinnWraithActive;

        bCarac = attrs.bonusCarac;
        mod = +attrs.jetModifDes;

        C1 = attrs.LCGCaracteristique1;
        C2 = attrs.LCGCaracteristique2;
        C3 = attrs.LCGCaracteristique3;
        C4 = attrs.LCGCaracteristique4;

        attrsCarac = await getCarac(bCarac, C1, C2, C3, C4);

        if (attrsCarac.C1) {
          const C1Value = attrsCarac.C1Base;
          const C1OD = attrsCarac.C1OD;

          cBase.push(attrsCarac.C1Nom);
          cRoll.push(C1Value);
          cOD += C1OD;
        }

        if (attrsCarac.C2) {
          const C2Value = attrsCarac.C2Base;
          const C2OD = attrsCarac.C2OD;

          cBase.push(attrsCarac.C2Nom);
          cRoll.push(C2Value);
          cOD += C2OD;
        }

        if (attrsCarac.C3) {
          const C3Value = attrsCarac.C3Base;
          const C3OD = attrsCarac.C3OD;

          cBonus.push(attrsCarac.C3Nom);
          cRoll.push(C3Value);
          cOD += C3OD;
        }

        if (attrsCarac.C4) {
          const C4Value = attrsCarac.C4Base;
          const C4OD = attrsCarac.C4OD;

          cBonus.push(attrsCarac.C4Nom);
          cRoll.push(C4Value);
          cOD += C4OD;
        }

        degats = Number(attrs[roll[1]].split('D')[0]);
        bDegats = Number(attrs[roll[1]].split('D')[1].split('+')[1]) || 0;

        violence = Number(attrs[roll[2]].split('D')[0]);
        bViolence = Number(attrs[roll[2]].split('D')[1].split('+')[1]) || 0;

        getStyle = getStyleDistanceMod(attrs, degats, violence, '', '', true, 0, false, false, false, false);

        exec = exec.concat(getStyle.exec);
        cRoll = cRoll.concat(getStyle.cRoll);
        cRoll.push(Number(attrs.mechaArmurePuissance));
        exec.push(`{{vPuissance=+${Number(attrs.mechaArmurePuissance)}D}}`);

        rollBonus.push(cOD);

        degats += getStyle.diceDegats;
        violence += getStyle.diceViolence;

        if (mod !== 0) {
          cRoll.push(mod);
          exec.push(`{{mod=${mod}}}`);
        }

        if (wraith !== '0') {
          cRoll.push(+attrs.discretion);
          rollBonus.push(+attrs[ODValue.discretion]);

          bDegats += +attrs.discretion + +attrs[ODValue.discretion];
          exec.push(`{{vWraithA=${+attrs.discretion}D6+${+attrs[ODValue.discretion]}}} {{vWraithD=[[${+attrs.discretion}+${+attrs[ODValue.discretion]}]]}}`);
        }

        jet = `{{jet=[[ {{[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0}]]}}`;

        exec.push(jet);
        exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);

        if (cOD.length === 0) { cOD.push(0); }

        if (rollBonus.length === 0) { rollBonus.push(0); }

        exec.push(`{{vOD=${cOD}}}`);
        exec.push(`{{bonus=[[${rollBonus.join('+')}]]}}`);

        exec.push(`{{degats=[[${degats}D6+${bDegats}]]}}`);
        exec.push(`{{violence=[[${violence}D6+${bViolence}]]}}`);

        if (cBase.length > 0) { exec.push(`{{cBase=${cBase.join(' - ')}}}`); }

        if (cBonus.length > 0) { exec.push(`{{cBonus=${cBonus.join(' - ')}}}`); }

        autresEffets = [
          `(${i18n_penetrant} 10)`,
          i18n_antiVehicule,
          `(${i18n_ignoreCDF})`,
        ];

        autresEffets.sort();

        exec.push(`{{effets=${autresEffets.join(' / ')}}}`);
        break;
    }

    const devaste = +attrs.devasterAnatheme;
    const bourreau = +attrs.bourreauTenebres;
    const equilibre = +attrs.equilibreBalance;

    if (button !== 'MADjinnWraith') {
      if (devaste || bourreau || equilibre) {
        const herauts = [];

        if (devaste) { herauts.push(i18n_devasterAnatheme); }
        if (bourreau) { herauts.push(i18n_bourreauTenebres); }
        if (equilibre) { herauts.push(i18n_equilibrerBalance); }

        exec.push(`{{herauts=${herauts.join(' / ')}}}`);
      }
    }

    if (wraith !== '0') {
      exec.push('{{special2=^{module-wraith} ^{active}}}');
    }

    const finalRoll = await startRoll(exec.join(' '));

    const tJet = finalRoll.results.jet.result;

    const tBonus = finalRoll.results.bonus.result;
    const tExploit = finalRoll.results.Exploit.result;

    const finalComputed = {
      jet: tJet + tBonus,
    };

    if (button !== 'MADjinnWraith') {
      const rDegats = finalRoll.results.degats.dice;
      const rViolence = finalRoll.results.violence.dice;

      const tDegats = finalRoll.results.degats.result;
      const tViolence = finalRoll.results.violence.result;

      const conditions = {
        bourreau,
        devaste,
        equilibre,
      };

      const computed = updateRoll(finalRoll, tDegats, rDegats, [bDegats], tViolence, rViolence, [bViolence], conditions);

      Object.assign(finalComputed, computed);
    }

    finishRoll(finalRoll.rollId, finalComputed);

    if (tJet !== 0 && tJet === tExploit) {
      const exploitRoll = await startRoll(`${roll}@{jetGM} &{template:mechaArmure} {{special1=@{mechaArmureNom}}} {{special1B=${i18n_exploit}}}${jet}`);
      const tRExploit = exploitRoll.results.jet.result;
      const exploitComputed = {
        jet: tRExploit,
      };

      finishRoll(exploitRoll.rollId, exploitComputed);
    }
  });
});
  /* eslint-disable default-case */
/* eslint-disable max-len */
/* eslint-disable prefer-destructuring */
/* eslint-disable camelcase */
/* eslint-disable no-undef */
const monkZenRoll = ['jetModeZen'];

monkZenRoll.forEach((button) => {
  on(`clicked:${button}`, async (info) => {
    const roll = info.htmlAttributes.value;

    const attributs = [
      'armureLegende',
      'jetModifDes',
      'MALWarriorSoldierA',
      'MALWarriorHunterA',
      'MALWarriorScholarA',
      'MALWarriorHeraldA',
      'MALWarriorScoutA',
    ];

    const attrs = await getAttrsAsync(attributs);

    const armureL = attrs.armureLegende;

    const exec = [];

    const mod = +attrs.jetModifDes;

    const cRoll = [];
    const cNom1 = [];

    let bonus = [];
    const OD = [];

    const ODMALWarrior = [];

    let MALTypeSoldier;
    let MALTypeHunter;
    let MALTypeHerald;
    let MALTypeScholar;
    let MALTypeScout;

    exec.push(roll);
    exec.push('{{OD=true}}');

    cNom1.push(CaracNom.hargne);
    cRoll.push('@{hargne}');
    OD.push('@{hargneOD}');

    cNom1.push(CaracNom.sf);
    cRoll.push('@{sf}');
    OD.push('@{sfOD}');

    exec.push(`{{vOD=[[${OD.join('+')}]]}}`);

    switch (armureL) {
      case 'warrior':
        MALTypeSoldier = attrs.MALWarriorSoldierA;
        MALTypeHunter = attrs.MALWarriorHunterA;
        MALTypeHerald = attrs.MALWarriorHeraldA;
        MALTypeScholar = attrs.MALWarriorScholarA;
        MALTypeScout = attrs.MALWarriorScoutA;

        if (MALTypeSoldier !== 0) {
          exec.push(`{{MALspecial2=${i18n_typeSoldier}}}`);
          exec.push('{{MALTypeWarrior=true}}');
        }

        if (MALTypeHunter !== 0) {
          exec.push(`{{MALspecial2=${i18n_typeHunter}}}`);
          exec.push('{{MALTypeWarrior=true}}');

          ODMALWarrior.push(MALTypeHunter);
        }

        if (MALTypeHerald !== 0) {
          exec.push(`{{MALspecial2=${i18n_typeHerald}}}`);
          exec.push('{{MALTypeWarrior=true}}');

          ODMALWarrior.push(MALTypeHerald);
        }

        if (MALTypeScholar !== 0) {
          exec.push(`{{MALspecial2=${i18n_typeScholar}}}`);
          exec.push('{{MALTypeWarrior=true}}');
        }

        if (MALTypeScout !== 0) {
          exec.push(`{{MALspecial2=${i18n_typeScout}}}`);
          exec.push('{{MALTypeWarrior=true}}');
        }

        if (ODMALWarrior.length !== 0) { exec.push(`{{vODMALWarrior=[[${ODMALWarrior.join('+')}]]}}`); }

        break;
      default:
        MALTypeSoldier = '';
        MALTypeHunter = '';
        MALTypeHerald = '';
        MALTypeScholar = '';
        MALTypeScout = '';
        break;
    }

    exec.push(`{{cBase=${cNom1.join(' - ')}}}`);

    if (mod !== 0) {
      cRoll.push(mod);
      exec.push(`{{mod=[[${mod}]]}}`);
    }

    if (cRoll.length === 0) { cRoll.push(0); }

    bonus = bonus.concat(OD);
    bonus = bonus.concat(ODMALWarrior);

    exec.push(`{{jet=[[ {[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`);
    exec.push(`{{tBonus=[[${bonus.join('+')}+0]]}}`);
    exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);

    startRoll(exec.join(' '), (results) => {
      const tJet = results.results.jet.result;
      const tBonus = results.results.tBonus.result;
      const tExploit = results.results.Exploit.result;

      const total = tJet + tBonus;

      finishRoll(
        results.rollId,
        {
          jet: total,
        },
      );

      if (tJet !== 0 && tJet === tExploit) {
        startRoll(`${roll}@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${i18n_exploit}}}{{jet=[[ {[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`, (exploit) => {
          const tExploit2 = exploit.results.jet.result;

          finishRoll(
            exploit.rollId,
            {
              jet: tExploit2,
            },
          );
        });
      }
    });
  });
});

// A MODIFIER CEA

const monkCeaRoll = ['monkJetVague', 'monkJetSalve', 'monkJetRayonSpe'];

monkCeaRoll.forEach((button) => {
  on(`clicked:${button}`, async (info) => {
    const roll = info.htmlAttributes.value;
    const hasArmure = true;

    let attributs = [
      'caracteristique1Monk',
      'caracteristique2Monk',
      'caracteristique3',
      'caracteristique4',
      'monk250PG',
      'monkRayonTour',
      ODValue.tir,
      ODValue.discretion,
      'discretion',
      'devasterAnatheme',
      'bourreauTenebres',
      'equilibreBalance',
    ];

    const attDegats = [];
    const attViolence = [];

    if (button === 'monkJetVague') {
      attDegats.push('monkVagueDegat');
    }

    if (button === 'monkJetSalve') {
      attDegats.push('monkSalveDegat');
    }

    if (button === 'monkJetRayonSpe') {
      attDegats.push('monkRayonDegat');
      attViolence.push('monkRayonViolence');
    }

    attributs = attributs.concat(listBase, listStyle, listArmureLegende, attDegats, attViolence);

    const attrs = await getAttrsAsync(attributs);

    const armureL = attrs.armureLegende;

    let exec = [];
    let isConditionnelA = false;
    let isConditionnelD = false;
    let isConditionnelV = false;

    const attaquesSurprises = [];
    const attaquesSurprisesValue = [];
    let attaquesSurprisesCondition = '';

    const mod = +attrs.jetModifDes;
    const hasBonus = +attrs.bonusCarac;

    const PG250 = +attrs.monk250PG;

    const C1 = attrs.caracteristique1Monk;
    const C2 = attrs.caracteristique2Monk;
    const C3 = attrs.caracteristique3;
    const C4 = attrs.caracteristique4;

    const attrsCarac = await getCarac(hasBonus, C1, C2, C3, C4);

    let C1Nom = '';
    let C2Nom = '';
    let C3Nom = '';
    let C4Nom = '';

    let cRoll = [];
    const cBase = [];
    const cBonus = [];

    let bonus = [];
    let OD = 0;

    let ODMALBarbarian = [];
    let ODMALRogue = [];
    let ODMALShaman = [];
    const ODMALWarrior = [];

    let capaDgts = 0;
    let capaViolence = 0;
    let bonusRayonD = 0;

    const vDiscretion = +attrs.discretion;
    const oDiscretion = +attrs[`${ODValue.discretion}`];
    const oTir = attrs[ODValue.tir];

    let diceDegats = 0;
    let diceViolence = 0;

    const bonusDegats = [];
    const bonusViolence = [];

    let degats = [];
    let violence = [];

    const devaste = +attrs.devasterAnatheme;
    const bourreau = +attrs.bourreauTenebres;
    const equilibre = +attrs.equilibreBalance;

    let isSurprise = false;
    let isDestructeur = false;
    let isMeurtrier = false;
    let isUltraviolence = false;

    let autresEffets = [];

    exec.push(roll);
    exec.push('{{OD=true}}');

    if (attrsCarac.C1) {
      C1Nom = attrsCarac.C1Brut;

      const C1Value = attrsCarac.C1Base;
      const C1OD = attrsCarac.C1OD;

      cBase.push(attrsCarac.C1Nom);
      cRoll.push(C1Value);

      if (hasArmure) { OD += C1OD; }
    }

    if (attrsCarac.C2) {
      C2Nom = attrsCarac.C2Brut;

      const C2Value = attrsCarac.C2Base;
      const C2OD = attrsCarac.C2OD;

      cBase.push(attrsCarac.C2Nom);
      cRoll.push(C2Value);

      if (hasArmure) { OD += C2OD; }
    }

    if (attrsCarac.C3) {
      C3Nom = attrsCarac.C3Brut;

      const C3Value = attrsCarac.C3Base;
      const C3OD = attrsCarac.C3OD;

      cBonus.push(attrsCarac.C3Nom);
      cRoll.push(C3Value);

      if (hasArmure) { OD += C3OD; }
    }

    if (attrsCarac.C4) {
      C4Nom = attrsCarac.C4Brut;

      const C4Value = attrsCarac.C4Base;
      const C4OD = attrsCarac.C4OD;

      cBonus.push(attrsCarac.C4Nom);
      cRoll.push(C4Value);

      if (hasArmure) { OD += C4OD; }
    }

    const MALBonus = getMALBonus(attrs, armureL, false, false, vDiscretion, oDiscretion, hasBonus, C1Nom, C2Nom, C3Nom, C4Nom, autresEffets);

    exec = exec.concat(MALBonus.exec);
    cRoll = cRoll.concat(MALBonus.cRoll);

    diceDegats += Number(MALBonus.diceDegats);
    diceViolence += Number(MALBonus.diceViolence);

    ODMALBarbarian = ODMALBarbarian.concat(MALBonus.ODMALBarbarian);
    ODMALRogue = ODMALRogue.concat(MALBonus.ODMALRogue);
    ODMALShaman = ODMALShaman.concat(MALBonus.ODMALShaman);
    ODMALWarrior.push(MALBonus.ODMALWarrior);

    autresEffets = autresEffets.concat(MALBonus.autresEffets);

    // GESTION DES EFFETS DES DIFFERENTES ATTAQUES

    if (button === 'monkJetVague') {
      capaDgts = Number(attrs.monkVagueDegat.split('D')[0]);
      capaViolence = Number(attrs.monkVagueDegat.split('D')[0]);

      exec.push(`{{portee=${i18n_portee} @{monkVaguePortee}}}`);

      isConditionnelA = true;
      isConditionnelD = true;
      isDestructeur = true;

      if (PG250 === 1) { exec.push(`{{parasitage=${i18n_parasitage} 4}}`); } else { exec.push(`{{parasitage=${i18n_parasitage} 2}}`); }

      exec.push(`{{parasitageCondition=${i18n_parasitageCondition}}}`);

      autresEffets.push(`${i18n_dispersion} 3`);

      exec.push(`{{destructeur=${i18n_destructeur}}}`);
      exec.push('{{destructeurValue=[[2D6]]}}');
      exec.push(`{{destructeurCondition=${i18n_destructeurCondition}}}`);

      exec.push(`{{choc=${i18n_choc} 2}}`);
      exec.push(`{{chocCondition=${i18n_chocCondition}}}`);
    }

    if (button === 'monkJetSalve') {
      capaDgts = Number(attrs.monkSalveDegat.split('D')[0]);
      capaViolence = Number(attrs.monkSalveDegat.split('D')[0]);

      exec.push(`{{portee=${i18n_portee} @{monkSalvePortee}}}`);

      isConditionnelA = true;
      isConditionnelD = true;
      isConditionnelV = true;
      isMeurtrier = true;
      isUltraviolence = true;

      exec.push(`{{parasitage=${i18n_parasitage} 1}}`);
      exec.push(`{{parasitageCondition=${i18n_parasitageCondition}}}`);

      autresEffets.push(`${i18n_dispersion} 3`);

      exec.push(`{{meurtrier=${i18n_meurtrier}}}`);
      exec.push('{{meurtrierValue=[[2D6]]}}');
      exec.push(`{{meurtrierCondition=${i18n_meurtrierCondition}}}`);

      exec.push(`{{ultraviolence=${i18n_ultraviolence}}}`);
      exec.push('{{ultraviolenceValue=[[2D6]]}}');
      exec.push(`{{ultraviolenceCondition=${i18n_ultraviolenceCondition}}}`);
    }

    if (button === 'monkJetRayonSpe') {
      bonusRayonD = Number(attrs.monkRayonTour);

      capaDgts = Number(attrs.monkRayonDegat.split('D')[0]);
      capaViolence = Number(attrs.monkRayonViolence.split('D')[0]);

      exec.push(`{{portee=${i18n_portee} @{monkRayonPortee}}}`);

      isConditionnelA = true;
      isConditionnelD = true;

      exec.push(`{{parasitage=${i18n_parasitage} 1}}`);
      exec.push(`{{parasitageCondition=${i18n_parasitageCondition}}}`);

      if (PG250 === 1) { autresEffets.push(i18n_ignoreArmure); } else { autresEffets.push(`${i18n_perceArmure} 40`); }
    }

    // FIN GESTION DES EFFETS DES DIFFERENTES ATTAQUES

    // GESTION DES BONUS DES OD
    if (oDiscretion >= 2 && hasArmure) {
      let bODDiscretion = vDiscretion;
      attaquesSurprises.push(i18n_odDiscretion);

      if (oDiscretion >= 5) { bODDiscretion += vDiscretion + oDiscretion; }

      attaquesSurprisesValue.push(bODDiscretion);
      attaquesSurprisesCondition = `{{attaqueSurpriseCondition=${i18n_attaqueSurpriseCondition}}}`;
    }
    // FIN DE GESTION DES BONUS DES OD

    // GESTION DU STYLE

    const style = attrs.styleCombat;
    let bName = '';
    let modA = 0;

    switch (style) {
      case 'standard':
        exec.push(`{{style=${i18n_style} ${i18n_standard}}}`);
        break;

      case 'couvert':
        bName = 'atkCouvert';
        modA = attrs[bName];

        exec.push(`{{style=${i18n_style} ${i18n_couvert}}}`);

        if (aIGuidage === 0) {
          exec.push(`{{vMStyleA=${modA}D}}`);
          cRoll.push(Number(modA));
        }
        break;

      case 'agressif':
        bName = 'atkAgressif';
        modA = attrs[bName];

        exec.push(`{{style=${i18n_style} ${i18n_agressif}}}`);
        exec.push(`{{vMStyleA=${modA}D}}`);
        cRoll.push(Number(modA));
        break;

      case 'akimbo':
        bName = 'atkAkimbo';
        modA = attrs[bName];

        exec.push(`{{style=${i18n_style} ${i18n_akimbo}}}`);

        if (oTir >= 3) {
          exec.push('{{vMStyleA=-1D}}');
          cRoll.push(-1);
        } else {
          exec.push(`{{vMStyleA=${modA}D}}`);
          cRoll.push(Number(modA));
        }

        exec.push(`{{vMStyleD=+${capaDgts}D}}`);
        exec.push(`{{vMStyleV=+${Math.ceil(capaViolence / 2)}D}}`);

        capaDgts += capaDgts;
        capaViolence += Math.ceil(capaViolence / 2);
        break;

      case 'ambidextre':
        bName = 'atkAmbidextre';
        modA = attrs[bName];

        exec.push(`{{style=${i18n_style} ${i18n_ambidextre}}}`);
        break;

      case 'defensif':
        bName = 'atkDefensif';
        modA = attrs[bName];

        exec.push(`{{style=${i18n_style} ${i18n_defensif}}}`);
        exec.push(`{{vMStyleA=${modA}D}}`);
        cRoll.push(Number(modA));
        break;

      case 'pilonnage':
        modA = attrs[bName];

        exec.push(`{{style=${i18n_style} ${i18n_pilonnage}}}`);
        exec.push(`{{vMStyleA=${modA}D}}`);
        cRoll.push(Number(modA));
        break;

      case 'suppression':
        exec.push(`{{style=${i18n_style} ${i18n_pilonnage}}}`);
        break;
    }

    // FIN GESTION DU STYLE
    OD -= MALBonus.ODMALWarrior;

    exec.push(`{{vOD=${OD}}}`);

    exec.push(`{{cBase=${cBase.join(' - ')}}}`);

    if (hasBonus > 0) { exec.push(`{{cBonus=${cBonus.join(' - ')}}}`); }

    if (mod !== 0) {
      cRoll.push(mod);
      exec.push(`{{mod=[[${mod}]]}}`);
    }

    if (cRoll.length === 0) { cRoll.push(0); }

    bonus = bonus.concat(OD);

    bonus = bonus.concat(ODMALBarbarian);
    bonus = bonus.concat(ODMALRogue);
    bonus = bonus.concat(ODMALShaman);
    bonus = bonus.concat(ODMALWarrior);

    if (bonusRayonD !== 0) {
      capaDgts += bonusRayonD;

      exec.push(`{{vRayonDegats=${bonusRayonD}D}}`);
    }

    diceDegats += capaDgts;
    diceViolence += capaViolence;

    degats = degats.concat(`${diceDegats}D6`);
    degats = degats.concat(bonusDegats);

    violence = violence.concat(`${diceViolence}D6`);
    violence = violence.concat(bonusViolence);

    exec.push(`{{jet=[[ {[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`);
    exec.push(`{{tBonus=[[${bonus.join('+')}+0]]}}`);
    exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);

    exec.push(`{{degats=[[${degats.join('+')}]]}}`);
    exec.push(`{{violence=[[${violence.join('+')}]]}}`);

    if (attaquesSurprises.length > 0) {
      exec.push(`{{attaqueSurprise=${attaquesSurprises.join('\n+')}}}`);
      exec.push(`{{attaqueSurpriseValue=[[${attaquesSurprisesValue.join('+')}]]}}`);
      exec.push(attaquesSurprisesCondition);
      isSurprise = true;
    }

    if (devaste || bourreau || equilibre) {
      const herauts = [];

      if (devaste) { herauts.push(i18n_devasterAnatheme); }
      if (bourreau) { herauts.push(i18n_bourreauTenebres); }
      if (equilibre) { herauts.push(i18n_equilibrerBalance); }

      exec.push(`{{herauts=${herauts.join(' / ')}}}`);
    }

    if (isConditionnelA === true) { exec.push('{{succesConditionnel=true}}'); }

    if (isConditionnelD === true) { exec.push('{{degatsConditionnel=true}}'); }

    if (isConditionnelV === true) { exec.push('{{violenceConditionnel=true}}'); }

    if (autresEffets.length > 0) { exec.push(`{{effets=${autresEffets.join(' / ')}}}`); }

    // ROLL
    const finalRoll = await startRoll(exec.join(' '));

    const tJet = finalRoll.results.jet.result;

    const tBonus = finalRoll.results.tBonus.result;
    const tExploit = finalRoll.results.Exploit.result;

    const rDegats = finalRoll.results.degats.dice;
    const rViolence = finalRoll.results.violence.dice;

    const tDegats = finalRoll.results.degats.result;
    const tViolence = finalRoll.results.violence.result;

    const conditions = {
      bourreau,
      devaste,
      equilibre,
      isDestructeur,
      isMeurtrier,
      isUltraviolence,
      isSurprise,
    };

    const computed = updateRoll(finalRoll, tDegats, rDegats, bonusDegats, tViolence, rViolence, bonusViolence, conditions);

    const finalComputed = {
      jet: tJet + tBonus,
    };

    Object.assign(finalComputed, computed);

    finishRoll(finalRoll.rollId, finalComputed);

    if (tJet !== 0 && tJet === tExploit) {
      const exploitRoll = await startRoll(`${roll}@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${i18n_exploit}}}{{jet=[[ {[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`);
      const tRExploit = exploitRoll.results.jet.result;
      const exploitComputed = {
        jet: tRExploit,
      };

      finishRoll(exploitRoll.rollId, exploitComputed);
    }
  });
});
  /* eslint-disable no-undef */
const priestRollMechanic = ['priestJetMechanicContact', 'priestJetMechanicDistance', 'rollMALPriestJetMechanicContact', 'rollMALPriestJetMechanicDistance'];

priestRollMechanic.forEach((button) => {
  on(`clicked:${button}`, (info) => {
    const roll = info.htmlAttributes.value;

    const attributs = [];

    getAttrs(attributs, () => {
      const exec = [];
      exec.push(roll);

      startRoll(exec.join(' '), (results) => {
        finishRoll(
          results.rollId,
          {},
        );
      });
    });
  });
});
  /* eslint-disable default-case */
/* eslint-disable camelcase */
/* eslint-disable prefer-destructuring */
/* eslint-disable max-len */
/* eslint-disable no-undef */

on('clicked:distanceRangerLongbow', async (info) => {
  const roll = info.htmlAttributes.value;
  const hasArmure = true;

  let attributs = [
    'pilonnageRanger',
    'energiePJ',
    'caracteristique1',
    'caracteristique2',
    'caracteristique3',
    'caracteristique4',
    'discretion',
    ODValue.discretion,
    ODValue.tir,
  ];

  const arme = [
    'rangerArmeDegat',
    'rangerArmeDegatEvol',
    'rangerArmeViolence',
    'rangerArmeViolenceEvol',
    'rangerArmePortee',
  ];

  const evolutions = [
    'ranger50PG3',
    'ranger50PG2',
    'ranger100PG',
  ];

  const effets = [
    'rangerChoc',
    'rangerChocValue',
    'rangerDegatContinue',
    'rangerDegatContinueValue',
    'rangerDesignation',
    'rangerSilencieux',
    'rangerPerceArmure',
    'rangerPerceArmureValue',
    'rangerUltraViolence',
    'rangerAntiVehicule',
    'rangerArtillerie',
    'rangerDispersion',
    'rangerDispersionValue',
    'rangerLumiere',
    'rangerLumiereValue',
    'rangerPenetrant',
    'rangerPenetrantValue',
    'rangerPerceArmure60',
    'rangerPerceArmure60Value',
    'rangerAntiAnatheme',
    'rangerDemoralisant',
    'rangerEnChaine',
    'rangerFureur',
    'rangerIgnoreArmure',
    'rangerPenetrant10',
    'rangerPenetrant10Value',
  ];

  const ameliorations = [
    'chargeurGrappesRanger',
    'canonLongRanger',
    'canonRaccourciRanger',
    'chambreDoubleRanger',
    'interfaceGuidageRanger',
    'lunetteIntelligenteRanger',
    'chargeurExplosivesRanger',
    'munitionsDroneRanger',
    'munitionsIEMRanger',
    'munitionsNonLetalesRanger',
    'munitionsSubsoniquesRanger',
    'pointeurLaserRanger',
    'protectionArmeRanger',
    'revetementOmegaRanger',
    'structureElementRanger',
  ];

  const special = [
    'bDDiversTotalRanger',
    'bDDiversD6',
    'bDDiversFixe',
    'bVDiversTotalRanger',
    'bVDiversD6',
    'bVDiversFixe',
    'devasterAnatheme',
    'bourreauTenebres',
    'equilibreBalance',
  ];

  attributs = attributs.concat(arme, evolutions, effets, ameliorations, special, listBase, listArmureLegende, listStyle);

  const attrs = await getAttrsAsync(attributs);

  const armureL = attrs.armureLegende;

  let exec = [];

  let isConditionnelA = false;
  let isConditionnelD = true;
  let isConditionnelV = true;

  const attaquesSurprises = [];
  const attaquesSurprisesValue = [];
  let attaquesSurprisesCondition = '';

  const PG50_3 = attrs.ranger50PG3;
  const PG50_2 = attrs.ranger50PG2;
  const PG100 = attrs.ranger100PG;

  let diceDegats = 0;
  let degats = [];
  const bonusDegats = [];

  let diceViolence = 0;
  let violence = [];
  const bonusViolence = [];

  const devaste = +attrs.devasterAnatheme;
  const bourreau = +attrs.bourreauTenebres;
  const equilibre = +attrs.equilibreBalance;

  const portee = attrs.rangerArmePortee;
  let autresEffets = [];
  const autresAmeliorations = [];
  const autresSpecial = [];

  const energie = attrs.energiePJ;
  let energieDepense = 0;

  let isSurprise = false;
  let isFureur = false;
  let isUltraviolence = false;

  if (PG50_2 === 'on') {
    diceDegats = Number(attrs.rangerArmeDegatEvol.split('D')[0]);
    diceViolence = Number(attrs.rangerArmeViolenceEvol.split('D')[0]);

    energieDepense += (diceDegats - 5);
    energieDepense += (diceViolence - 3);
  } else {
    diceDegats = Number(attrs.rangerArmeDegat.split('D')[0]);
    diceViolence = Number(attrs.rangerArmeViolence.split('D')[0]);

    energieDepense += (diceDegats - 3);
    energieDepense += (diceViolence - 1);
  }

  switch (portee) {
    case '^{portee-longue}':
      energieDepense += 1;
      break;

    case '^{portee-lointaine}':
      energieDepense += 2;
      break;

    default:
      energieDepense += 0;
      break;
  }

  const mod = +attrs.jetModifDes;
  const hasBonus = +attrs.bonusCarac;

  const C1 = attrs.caracteristique1;
  const C2 = attrs.caracteristique2;
  const C3 = attrs.caracteristique3;
  const C4 = attrs.caracteristique4;

  const attrsCarac = await getCarac(hasBonus, C1, C2, C3, C4);

  let C1Nom = '';
  let C2Nom = '';
  let C3Nom = '';
  let C4Nom = '';

  const vDiscretion = +attrs.discretion;
  const oDiscretion = +attrs[ODValue.discretion];
  const oTir = +attrs[ODValue.tir];

  let E1 = 2;
  let E2 = 3;
  let E3 = 6;

  let cRoll = [];
  const cBase = [];
  const cBonus = [];

  let bonus = [];
  let OD = 0;

  const ODMALWarrior = [];
  let ODMALRogue = [];
  let ODMALShaman = [];
  let ODMALBarbarian = [];

  let isELumiere = false;

  exec.push(roll);

  if (PG100 === 'on') {
    E1 = 1;
    E2 = 1;
    E3 = 4;
  }

  if (hasArmure) { exec.push('{{OD=true}}'); }

  if (attrsCarac.C1) {
    C1Nom = attrsCarac.C1Brut;

    const C1Value = attrsCarac.C1Base;
    const C1OD = attrsCarac.C1OD;

    cBase.push(attrsCarac.C1Nom);
    cRoll.push(C1Value);

    if (hasArmure) { OD += C1OD; }
  }

  if (attrsCarac.C2) {
    C2Nom = attrsCarac.C2Brut;

    const C2Value = attrsCarac.C2Base;
    const C2OD = attrsCarac.C2OD;

    cBase.push(attrsCarac.C2Nom);
    cRoll.push(C2Value);

    if (hasArmure) { OD += C2OD; }
  }

  if (attrsCarac.C3) {
    C3Nom = attrsCarac.C3Brut;

    const C3Value = attrsCarac.C3Base;
    const C3OD = attrsCarac.C3OD;

    cBonus.push(attrsCarac.C3Nom);
    cRoll.push(C3Value);

    if (hasArmure) { OD += C3OD; }
  }

  if (attrsCarac.C4) {
    C4Nom = attrsCarac.C4Brut;

    const C4Value = attrsCarac.C4Base;
    const C4OD = attrsCarac.C4OD;

    cBonus.push(attrsCarac.C4Nom);
    cRoll.push(C4Value);

    if (hasArmure) { OD += C4OD; }
  }

  // GESTION DES BONUS DES OD
  if (oDiscretion >= 2) {
    let bODDiscretion = vDiscretion;
    attaquesSurprises.push(i18n_odDiscretion);

    if (oDiscretion >= 5) { bODDiscretion += vDiscretion + oDiscretion; }

    attaquesSurprisesValue.push(bODDiscretion);
  }
  // FIN DE GESTION DES BONUS DES OD

  // GESTION DES EFFETS

  const eChoc = attrs.rangerChoc;
  const eChocV = attrs.rangerChocValue;
  const eDegatsContinus = attrs.rangerDegatContinue;
  const eDegatsContinusV = attrs.rangerDegatContinueValue;
  const eDesignation = attrs.rangerDesignation;
  const eSilencieux = attrs.rangerSilencieux;
  const ePerceArmure = attrs.rangerPerceArmure;
  const ePerceArmureV = attrs.rangerPerceArmureValue;
  const eUltraviolence = attrs.rangerUltraViolence;
  const eAntiVehicule = attrs.rangerAntiVehicule;
  const eArtillerie = attrs.rangerArtillerie;
  const eDispersion = attrs.rangerDispersion;
  const eDispersionV = attrs.rangerDispersionValue;
  const eLumiere = attrs.rangerLumiere;
  const eLumiereV = attrs.rangerLumiereValue;
  const ePenetrant = attrs.rangerPenetrant;
  const ePenetrantV = attrs.rangerPenetrantValue;
  const ePerceArmure60 = attrs.rangerPerceArmure60;
  const ePerceArmure60V = attrs.rangerPerceArmure60Value;
  const eAntiAnatheme = attrs.rangerAntiAnatheme;
  const eDemoralisant = attrs.rangerDemoralisant;
  const eEnChaine = attrs.rangerEnChaine;
  const eFureur = attrs.rangerFureur;
  const eIgnoreArmure = attrs.rangerIgnoreArmure;
  const ePenetrant10 = attrs.rangerPenetrant10;
  const ePenetrant10V = attrs.rangerPenetrant10Value;

  exec.push(`{{assistanceAttaque=${i18n_assistanceAttaque}}}`);
  exec.push(`{{assistanceAttaqueCondition=${i18n_assistanceAttaqueCondition}}}`);

  if (eChoc !== '0') {
    isConditionnelA = true;
    exec.push(`{{choc=${i18n_choc} ${eChocV}}}`);
    exec.push(`{{chocCondition=${i18n_chocCondition}}}`);

    energieDepense += E1;
  }

  if (eSilencieux !== '0') {
    const MALghost = +attrs.MALRogueGhost;
    const MALchangeling = +attrs.MALBardChangeling;
    const totalSilencieux = vDiscretion + oDiscretion;

    if (MALghost !== 0) {
      exec.push(`{{vSilencieuxD=${totalSilencieux}}}`);
      bonusDegats.push(totalSilencieux);
    } else if (MALchangeling !== 0) {
      exec.push(`{{vSilencieuxD=${totalSilencieux}}}`);
      bonusDegats.push(totalSilencieux);
    } else {
      isConditionnelD = true;
      attaquesSurprises.push(i18n_silencieux);
      attaquesSurprisesValue.push(totalSilencieux);

      if (attaquesSurprisesCondition === '') { attaquesSurprisesCondition = `{{attaqueSurpriseCondition=${i18n_attaqueSurpriseCondition}}}`; }
    }

    energieDepense += E1;
  }

  if (eUltraviolence !== '0') {
    isUltraviolence = true;

    exec.push(`{{ultraviolence=${i18n_ultraviolence}}}`);
    exec.push('{{ultraviolenceValue=[[2D6]]}}');
    exec.push(`{{ultraviolenceCondition=${i18n_ultraviolenceCondition}}}`);

    energieDepense += E1;
  }

  if (eArtillerie !== '0') {
    isConditionnelA = true;
    exec.push(`{{artillerie=${i18n_artillerie}}}`);
    exec.push(`{{artillerieCondition=${i18n_artillerieCondition}}}`);

    energieDepense += E2;
  }

  if (eAntiAnatheme !== '0') {
    isConditionnelD = true;
    isConditionnelV = true;
    exec.push(`{{antiAnatheme=${i18n_antiAnatheme}}}`);
    exec.push(`{{antiAnathemeCondition=${i18n_antiAnathemeCondition}}}`);

    energieDepense += E3;
  }

  if (eDemoralisant !== '0') {
    isConditionnelA = true;
    exec.push(`{{demoralisant=${i18n_demoralisant}}}`);
    exec.push(`{{demoralisantCondition=${i18n_demoralisantCondition}}}`);

    energieDepense += E3;
  }

  if (eEnChaine !== '0') {
    isConditionnelD = true;
    exec.push(`{{enChaine=${i18n_enChaine}}}`);
    exec.push(`{{enChaineCondition=${i18n_enChaineCondition}}}`);

    energieDepense += E3;
  }

  if (eFureur !== '0') {
    isFureur = true;
    isConditionnelV = true;
    exec.push(`{{fureur=${i18n_fureur}}}`);
    exec.push('{{fureurValue=[[4D6]]}}');
    exec.push(`{{fureurCondition=${i18n_fureurCondition}}}`);

    energieDepense += E3;
  }

  if (eAntiVehicule !== '0') {
    autresEffets.push(i18n_antiVehicule);

    energieDepense += E2;
  }

  if (eDegatsContinus !== '0') {
    autresEffets.push(`${i18n_degatsContinus} ${eDegatsContinusV} ([[1d6]] ${i18n_tours})`);

    energieDepense += E1;
  }

  autresEffets.push(i18n_deuxMains);

  if (eDesignation !== '0') {
    autresEffets.push(i18n_designation);

    energieDepense += E1;
  }

  if (eDispersion !== '0') {
    autresEffets.push(`${i18n_dispersion} ${eDispersionV}`);

    energieDepense += E2;
  }

  if (PG50_3 !== '1') { autresEffets.push(i18n_lourd); }

  if (eLumiere !== '0') {
    autresEffets.push(`${i18n_lumiere} ${eLumiereV}`);
    isELumiere = true;

    energieDepense += E2;
  }

  if (ePenetrant !== '0') {
    autresEffets.push(`${i18n_penetrant} ${ePenetrantV}`);

    energieDepense += E2;
  }

  if (ePerceArmure !== '0') {
    autresEffets.push(`${i18n_perceArmure} ${ePerceArmureV}`);

    energieDepense += E1;
  }

  if (ePerceArmure60 !== '0') {
    autresEffets.push(`${i18n_perceArmure} ${ePerceArmure60V}`);

    energieDepense += E2;
  }

  if (eIgnoreArmure !== '0') {
    autresEffets.push(i18n_ignoreArmure);

    energieDepense += E3;
  }

  if (ePenetrant10 !== '0') {
    autresEffets.push(`${i18n_penetrant} ${ePenetrant10V}`);

    energieDepense += E3;
  }

  // FIN GESTION DES EFFETS

  // GESTION DES AMELIORATIONS
  let rChambreDouble = 0;

  const aGrappe = attrs.chargeurGrappesRanger;
  const aCLong = attrs.canonLongRanger;
  const aCRaccourci = attrs.canonRaccourciRanger;
  const aChambreDouble = attrs.chambreDoubleRanger;
  const aIGuidage = attrs.interfaceGuidageRanger;
  const aLIntelligente = attrs.lunetteIntelligenteRanger;
  const aExplosive = attrs.chargeurExplosivesRanger;
  const aMDrone = attrs.munitionsDroneRanger;
  const aMIEM = attrs.munitionsIEMRanger;
  const aMNLetales = attrs.munitionsNonLetalesRanger;
  const aMSubsoniques = attrs.munitionsSubsoniquesRanger;
  const aPLaser = attrs.pointeurLaserRanger;
  const aPArme = attrs.protectionArmeRanger;
  const aROmega = attrs.revetementOmegaRanger;
  const aSElement = attrs.structureElementRanger;

  if (aGrappe !== '0') {
    exec.push('{{vMGrappeD=-1D6}}');
    exec.push('{{vMGrappeV=+1D6}}');
    diceDegats -= 1;
    bonusViolence.push('1D6');
  }

  if (aCLong !== '0') {
    isConditionnelA = true;
    exec.push(`{{canonLong=${i18n_canonLong}}}`);
    exec.push(`{{canonLongCondition=${i18n_canonLongCondition}}}`);
  }

  if (aCRaccourci !== '0') {
    isConditionnelA = true;
    exec.push(`{{canonRaccourci=${i18n_canonRaccourci}}}`);
    exec.push(`{{canonRaccourciCondition=${i18n_canonRaccourciCondition}}}`);
  }

  if (aChambreDouble !== '0') {
    rChambreDouble = '?{Plusieurs cibles ?|Oui, 3|Non, 0}';
  }

  if (aLIntelligente !== '0') {
    isConditionnelA = true;
    exec.push(`{{lunetteIntelligente=${i18n_lunetteIntelligente}}}`);
    exec.push(`{{lunetteIntelligenteCondition=${i18n_lunetteIntelligenteCondition}}}`);
  }

  if (aExplosive !== '0') {
    exec.push('{{vMExplosiveD=+1D6}}');
    exec.push('{{vMExplosiveV=-1D6}}');
    bonusDegats.push('1D6');
    diceViolence -= 1;
  }

  if (aMDrone !== '0') {
    exec.push('{{vMDrone=+3}}');
    bonus.push(3);
  }

  if (aMIEM !== '0') {
    exec.push('{{vMIEMD=-1D6}}');
    exec.push('{{vMIEMV=-1D6}}');
    diceDegats -= 1;
    diceViolence -= 1;
    autresAmeliorations.push(i18n_munitionsIEMParasitage);
  }

  if (aMSubsoniques !== '0') {
    if (eSilencieux !== '0') { autresAmeliorations.push(i18n_munitionsSubsoniques); } else if (eSilencieux === '0') {
      const MALghost = +attrs.MALRogueGhost;
      const MALchangeling = +attrs.MALBardChangeling;
      const totalSubsonique = vDiscretion + oDiscretion;

      if (MALghost !== 0) {
        exec.push(`{{vSubsoniqueD=${totalSubsonique}}}`);
        bonusDegats.push(totalSubsonique);
      } else if (MALchangeling !== 0) {
        exec.push(`{{vSubsoniqueD=${totalSubsonique}}}`);
        bonusDegats.push(totalSubsonique);
      } else {
        isConditionnelD = true;
        attaquesSurprises.push(i18n_munitionsSubsoniques);
        attaquesSurprisesValue.push(totalSubsonique);

        if (attaquesSurprisesCondition === '') { attaquesSurprisesCondition = `{{attaqueSurpriseCondition=${i18n_attaqueSurpriseCondition}}}`; }
      }
    }
  }

  if (aPLaser !== '0') {
    exec.push('{{vMPLaser=+1}}');
    bonus.push(1);
  }

  if (aROmega !== '0') {
    attaquesSurprises.push(i18n_revetementOmega);
    attaquesSurprisesValue.push('2D6');

    if (attaquesSurprisesCondition === '') { attaquesSurprisesCondition = `{{attaqueSurpriseCondition=${i18n_attaqueSurpriseCondition}}}`; }
  }

  if (aIGuidage !== '0') { autresAmeliorations.push(i18n_interfaceGuidage); }

  if (aMNLetales !== '0') { autresAmeliorations.push(i18n_munitionsNonLetales); }

  if (aPArme !== '0') { autresAmeliorations.push(i18n_protectionArme); }

  if (aSElement !== '0') { autresAmeliorations.push(i18n_structureElementAlpha); }

  // FIN DE LA GESTION DES AMELIORATIONS

  // GESTION DES BONUS SPECIAUX
  const sBonusDegats = attrs.bDDiversTotalRanger;
  const sBonusDegatsD6 = attrs.bDDiversD6;
  const sBonusDegatsFixe = attrs.bDDiversFixe;

  const sBonusViolence = attrs.bVDiversTotalRanger;
  const sBonusViolenceD6 = attrs.bVDiversD6;
  const sBonusViolenceFixe = attrs.bVDiversFixe;

  if (sBonusDegats !== '0') {
    exec.push(`{{vMSpecialD=+${sBonusDegatsD6}D6+${sBonusDegatsFixe}}}`);
    diceDegats += Number(sBonusDegatsD6);
    bonusDegats.push(sBonusDegatsFixe);
  }

  if (sBonusViolence !== '0') {
    exec.push(`{{vMSpecialV=+${sBonusViolenceD6}D6+${sBonusViolenceFixe}}}`);
    diceViolence += Number(sBonusViolenceD6);
    bonusViolence.push(sBonusViolenceFixe);
  }
  // FIN DE GESTION DES BONUS SPECIAUX

  const MALBonus = getMALBonus(attrs, armureL, isELumiere, false, vDiscretion, oDiscretion, hasBonus, C1Nom, C2Nom, C3Nom, C4Nom, autresEffets);

  exec = exec.concat(MALBonus.exec);
  cRoll = cRoll.concat(MALBonus.cRoll);

  diceDegats += Number(MALBonus.diceDegats);
  diceViolence += Number(MALBonus.diceViolence);

  ODMALBarbarian = ODMALBarbarian.concat(MALBonus.ODMALBarbarian);
  ODMALRogue = ODMALRogue.concat(MALBonus.ODMALRogue);
  ODMALShaman = ODMALShaman.concat(MALBonus.ODMALShaman);
  ODMALWarrior.push(MALBonus.ODMALWarrior);

  autresEffets = autresEffets.concat(MALBonus.autresEffets);

  exec.push(`{{cBase=${cBase.join(' - ')}}}`);

  if (hasBonus > 0) { exec.push(`{{cBonus=${cBonus.join(' - ')}}}`); }

  if (mod !== 0) {
    cRoll.push(mod);
    exec.push(`{{mod=${mod}}}`);
  }

  // GESTION DU STYLE

  const style = attrs.styleCombat;
  let bName = '';
  let modA = 0;
  let vPilonnage = 0;

  switch (style) {
    case 'standard':
      exec.push(`{{style=${i18n_style} ${i18n_standard}}}`);
      break;

    case 'couvert':
      bName = 'atkCouvert';
      modA = attrs[bName];

      exec.push(`{{style=${i18n_style} ${i18n_couvert}}}`);

      if (aIGuidage === 0) {
        exec.push(`{{vMStyleA=${modA}D}}`);
        cRoll.push(Number(modA));
      }
      break;

    case 'agressif':
      bName = 'atkAgressif';
      modA = attrs[bName];

      exec.push(`{{style=${i18n_style} ${i18n_agressif}}}`);
      exec.push(`{{vMStyleA=${modA}D}}`);
      cRoll.push(Number(modA));
      break;

    case 'akimbo':
      bName = 'atkAkimbo';
      modA = attrs[bName];

      exec.push(`{{style=${i18n_style} ${i18n_akimbo}}}`);

      if (oTir >= 3) {
        exec.push('{{vMStyleA=-1D}}');
        cRoll.push(-1);
      } else {
        exec.push(`{{vMStyleA=${modA}D}}`);
        cRoll.push(Number(modA));
      }
      break;

    case 'ambidextre':
      bName = 'atkAmbidextre';
      modA = attrs[bName];

      exec.push(`{{style=${i18n_style} ${i18n_ambidextre}}}`);

      if (oTir >= 3) {
        exec.push('{{vMStyleA=-1D}}');
        cRoll.push(-1);
      } else {
        exec.push(`{{vMStyleA=${modA}D}}`);
        cRoll.push(Number(modA));
      }
      break;

    case 'defensif':
      bName = 'atkDefensif';
      modA = attrs[bName];

      exec.push(`{{style=${i18n_style} ${i18n_defensif}}}`);
      exec.push(`{{vMStyleA=${modA}D}}`);
      cRoll.push(Number(modA));
      break;

    case 'pilonnage':
      bName = 'atkPilonnage';
      modA = attrs[bName];
      vPilonnage = Number(attrs.pilonnageRanger) - 1;

      exec.push(`{{style=${i18n_style} ${i18n_pilonnage}}}`);
      exec.push(`{{vMStyleA=${modA}D}}`);
      cRoll.push(Number(modA));

      exec.push(`{{vMStyleD=+${vPilonnage}D}}`);
      bonusDegats.push(`${vPilonnage}D6`);
      break;

    case 'suppression':
      exec.push(`{{style=${i18n_style} ${i18n_pilonnage}}}`);
      if (PG50_3 !== '1') {
        const vSuppressionD = Math.floor(Number(attrs.styleSuppressionD) / 2);
        const vSuppressionV = Math.floor(Number(attrs.styleSuppressionV) / 2);

        if (vSuppressionD > 0) {
          diceDegats -= vSuppressionD;
          exec.push(`{{vMStyleD=-${vSuppressionD}D}}`);
        }

        if (vSuppressionV > 0) {
          diceViolence -= vSuppressionV;
          exec.push(`{{vMStyleV=-${vSuppressionV}D}}`);
        }
      }
      break;
  }

  // FIN GESTION DU STYLE
  OD -= MALBonus.ODMALWarrior;
  exec.push(`{{vOD=${OD}}}`);

  if (cRoll.length === 0) { cRoll.push(0); }

  bonus.push(OD);

  bonus = bonus.concat(ODMALBarbarian);
  bonus = bonus.concat(ODMALRogue);
  bonus = bonus.concat(ODMALShaman);
  bonus = bonus.concat(ODMALWarrior);

  exec.push(`{{jet=[[ {{[[{${cRoll.join('+')}-${rChambreDouble}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0}]]}}`);
  exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);
  exec.push(`{{bonus=[[${bonus.join('+')}]]}}`);

  degats.push(`${diceDegats}D6`);
  degats = degats.concat(bonusDegats);

  violence.push(`${diceViolence}D6`);
  violence = violence.concat(bonusViolence);

  exec.push(`{{portee=${i18n_portee} ${portee}}}`);
  exec.push(`{{degats=[[${degats.join('+')}]]}}`);
  exec.push(`{{violence=[[${violence.join('+')}]]}}`);

  const resultatEnergie = energie - energieDepense;
  let pasEnergie = false;

  if (resultatEnergie < 0) { pasEnergie = true; }

  autresSpecial.push(`${i18n_energieRetiree} (${energieDepense})`);

  if (autresEffets.length > 0) { exec.push(`{{effets=${autresEffets.join(' / ')}}}`); }

  if (autresAmeliorations.length > 0) { exec.push(`{{ameliorations=${autresAmeliorations.join(' / ')}}}`); }

  if (autresSpecial.length > 0) { exec.push(`{{special=${autresSpecial.join(' / ')}}}`); }

  if (attaquesSurprises.length > 0) {
    exec.push(`{{attaqueSurprise=${attaquesSurprises.join('\n+')}}}`);
    exec.push(`{{attaqueSurpriseValue=[[${attaquesSurprisesValue.join('+')}]]}}`);
    exec.push(attaquesSurprisesCondition);
    isSurprise = true;
  }

  if (rChambreDouble !== 0) { exec.push(`{{vChambreDouble=${rChambreDouble}}}`); }

  if (devaste || bourreau || equilibre) {
    const herauts = [];

    if (devaste) { herauts.push(i18n_devasterAnatheme); }
    if (bourreau) { herauts.push(i18n_bourreauTenebres); }
    if (equilibre) { herauts.push(i18n_equilibrerBalance); }

    exec.push(`{{herauts=${herauts.join(' / ')}}}`);
  }

  if (isConditionnelA === true) { exec.push('{{succesConditionnel=true}}'); }

  if (isConditionnelD === true) { exec.push('{{degatsConditionnel=true}}'); }

  if (isConditionnelV === true) { exec.push('{{violenceConditionnel=true}}'); }

  let finalRoll;
  if (!pasEnergie) {
    finalRoll = await startRoll(exec.join(' '));

    const tJet = finalRoll.results.jet.result;

    const tBonus = finalRoll.results.bonus.result;
    const tExploit = finalRoll.results.Exploit.result;

    const rDegats = finalRoll.results.degats.dice;
    const rViolence = finalRoll.results.violence.dice;

    const tDegats = finalRoll.results.degats.result;
    const tViolence = finalRoll.results.violence.result;

    const conditions = {
      bourreau,
      devaste,
      equilibre,
      isFureur,
      isUltraviolence,
      isSurprise,
    };

    const computed = updateRoll(finalRoll, tDegats, rDegats, bonusDegats, tViolence, rViolence, bonusViolence, conditions);

    const finalComputed = {
      jet: tJet + tBonus,
    };

    Object.assign(finalComputed, computed);

    finishRoll(finalRoll.rollId, finalComputed);

    if (tJet !== 0 && tJet === tExploit) {
      const exploitRoll = await startRoll(`${roll}@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${i18n_exploit}}}{{jet=[[ {[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`);
      const tRExploit = exploitRoll.results.jet.result;
      const exploitComputed = {
        jet: tRExploit,
      };

      finishRoll(exploitRoll.rollId, exploitComputed);
    }

    setAttrs({
      energiePJ: resultatEnergie,
    });

    if (resultatEnergie === 0) {
      finalRoll = await startRoll(`@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{ranger-fusil-longbow}}} {{text=${i18n_plusEnergie}}}`);
      finishRoll(finalRoll.rollId, {});
    }
  } else {
    finalRoll = await startRoll(`@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{ranger-fusil-longbow}}} {{text=${i18n_pasEnergie}}}`);
    finishRoll(finalRoll.rollId, {});
  }
});
  /* eslint-disable no-undef */
on('clicked:recuperation', (info) => {
  const roll = info.htmlAttributes.value;

  getAttrs(['espoir', 'espoir_max'], (value) => {
    const espoir = Number(value.espoir);
    const max = Number(value.espoir_max);

    startRoll(`${roll} {{oldE=[[${espoir}]]}}`, (results) => {
      const result = Number(results.results.jet.result);
      let total = espoir + result;

      if (results.results.gainBonus !== undefined) { total += results.results.gainBonus.result; }

      if (total > max) { total = max; }

      const newAttr = {};
      newAttr.espoir = total;

      setAttrs(newAttr);
      finishRoll(
        results.rollId, {
          oldE: total,
        },
      );
    });
  });
});
  /* eslint-disable default-case */
/* eslint-disable camelcase */
/* eslint-disable max-len */
/* eslint-disable prefer-destructuring */
/* eslint-disable no-undef */
on('clicked:simple clicked:simpleRogue', async (info) => {
  const roll = info.htmlAttributes.value;

  let hasArmure = true;

  let attributs = [
    'caracteristique1',
    'caracteristique2',
    'caracteristique3',
    'caracteristique4',
    'discretion',
    ODValue.discretion,
  ];

  attributs = attributs.concat(listBase, listArmure, listArmureLegende);

  const attrs = await getAttrsAsync(attributs);

  const armure = attrs.armure;
  const armureL = attrs.armureLegende;

  if (armure === 'sans' || armure === 'guardian') { hasArmure = false; }

  let exec = [];
  let isConditionnel = false;

  const mod = +attrs.jetModifDes;
  const hasBonus = +attrs.bonusCarac;

  const vDiscretion = attrs.discretion;
  const oDiscretion = attrs[ODValue.discretion];

  const C1 = attrs.caracteristique1;
  const C2 = attrs.caracteristique2;
  const C3 = attrs.caracteristique3;
  const C4 = attrs.caracteristique4;

  const attrsCarac = await getCarac(hasBonus, C1, C2, C3, C4);

  let C1Nom = '';
  let C2Nom = '';
  let C3Nom = '';
  let C4Nom = '';

  let cRoll = [];
  const cBase = [];
  const cBonus = [];

  let bonus = [];
  let OD = 0;
  let ODBarbarian = [];
  let ODShaman = [];
  const ODWarrior = [];

  let ODMALBarbarian = [];
  let ODMALShaman = [];
  const ODMALWarrior = [];

  exec.push(roll);

  if (hasArmure) { exec.push('{{OD=true}}'); }

  if (attrsCarac.C1) {
    C1Nom = attrsCarac.C1Brut;

    const C1Value = attrsCarac.C1Base;
    const C1OD = attrsCarac.C1OD;

    cBase.push(attrsCarac.C1Nom);
    cRoll.push(C1Value);

    if (hasArmure) { OD += C1OD; }
  }

  if (attrsCarac.C2) {
    C2Nom = attrsCarac.C2Brut;

    const C2Value = attrsCarac.C2Base;
    const C2OD = attrsCarac.C2OD;

    cBase.push(attrsCarac.C2Nom);
    cRoll.push(C2Value);

    if (hasArmure) { OD += C2OD; }
  }

  if (attrsCarac.C3) {
    C3Nom = attrsCarac.C3Brut;

    const C3Value = attrsCarac.C3Base;
    const C3OD = attrsCarac.C3OD;

    cBonus.push(attrsCarac.C3Nom);
    cRoll.push(C3Value);

    if (hasArmure) { OD += C3OD; }
  }

  if (attrsCarac.C4) {
    C4Nom = attrsCarac.C4Brut;

    const C4Value = attrsCarac.C4Base;
    const C4OD = attrsCarac.C4OD;

    cBonus.push(attrsCarac.C4Nom);
    cRoll.push(C4Value);

    if (hasArmure) { OD += C4OD; }
  }

  const armorBonus = getArmorBonus(attrs, armure, false, false, vDiscretion, oDiscretion, hasBonus, C1Nom, C2Nom, C3Nom, C4Nom);

  exec = exec.concat(armorBonus.exec);
  cRoll = cRoll.concat(armorBonus.cRoll);

  if (isConditionnel === false) { isConditionnel = armorBonus.isConditionnelA; }

  ODBarbarian = ODBarbarian.concat(armorBonus.ODBarbarian);
  ODShaman = ODShaman.concat(armorBonus.ODShaman);
  ODWarrior.push(armorBonus.ODWarrior);

  const MALBonus = getMALBonus(attrs, armureL, false, false, vDiscretion, oDiscretion, hasBonus, C1Nom, C2Nom, C3Nom, C4Nom);

  exec = exec.concat(MALBonus.exec);
  cRoll = cRoll.concat(MALBonus.cRoll);

  if (isConditionnel === false) { isConditionnel = MALBonus.isConditionnelA; }

  ODMALBarbarian = ODMALBarbarian.concat(MALBonus.ODMALBarbarian);
  ODMALShaman = ODMALShaman.concat(MALBonus.ODMALShaman);
  ODMALWarrior.push(MALBonus.ODMALWarrior);

  exec.push(`{{cBase=${cBase.join(' - ')}}}`);

  if (hasBonus > 0) { exec.push(`{{cBonus=${cBonus.join(' - ')}}}`); }

  if (mod !== 0) {
    cRoll.push(mod);
    exec.push(`{{mod=[[${mod}]]}}`);
  }

  OD -= armorBonus.ODWarrior;
  OD -= MALBonus.ODMALWarrior;
  exec.push(`{{vOD=${OD}}}`);

  if (cRoll.length === 0) { cRoll.push(0); }

  bonus.push(OD);
  bonus = bonus.concat(ODBarbarian);
  bonus = bonus.concat(ODShaman);
  bonus = bonus.concat(ODWarrior);

  bonus = bonus.concat(ODMALBarbarian);
  bonus = bonus.concat(ODMALShaman);
  bonus = bonus.concat(ODMALWarrior);

  exec.push(`{{jet=[[ {[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`);
  exec.push(`{{tBonus=[[${bonus.join('+')}+0]]}}`);
  exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);

  if (isConditionnel === true) { exec.push('{{conditionnel=true}}'); }

  startRoll(exec.join(' '), (results) => {
    const tJet = results.results.jet.result;
    const tBonus = results.results.tBonus.result;
    const tExploit = results.results.Exploit.result;

    const total = tJet + tBonus;

    finishRoll(
      results.rollId,
      {
        jet: total,
      },
    );

    if (tJet !== 0 && tJet === tExploit) {
      startRoll(`${roll}@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${i18n_exploit}}}{{jet=[[ {[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`, (exploit) => {
        const tExploit2 = exploit.results.jet.result;

        finishRoll(
          exploit.rollId,
          {
            jet: tExploit2,
          },
        );
      });
    }
  });
});

on('clicked:simplePriest', async (info) => {
  const roll = info.htmlAttributes.value;

  const hasArmure = true;

  let attributs = [
    'caracteristique1Priest',
    'caracteristique2',
    'caracteristique3',
    'caracteristique4',
    'discretion',
    ODValue.discretion,
  ];

  attributs = attributs.concat(listBase, listArmureLegende);

  const attrs = await getAttrsAsync(attributs);

  const armureL = attrs.armureLegende;

  let exec = [];
  let isConditionnel = false;

  const mod = +attrs.jetModifDes;
  const hasBonus = +attrs.bonusCarac;

  const vDiscretion = attrs.discretion;
  const oDiscretion = attrs[ODValue.discretion];

  const C1 = attrs.caracteristique1Priest;
  const C2 = attrs.caracteristique2;
  const C3 = attrs.caracteristique3;
  const C4 = attrs.caracteristique4;

  const attrsCarac = await getCarac(hasBonus, C1, C2, C3, C4);

  let C1Nom = '';
  let C2Nom = '';
  let C3Nom = '';
  let C4Nom = '';

  let cRoll = [];
  const cBase = [];
  const cBonus = [];

  let bonus = [];
  let OD = 0;

  let ODMALBarbarian = [];
  const ODMALWarrior = [];
  let ODMALShaman = [];

  exec.push(roll);
  exec.push('{{special1=^{priest-mode-nanoc}}}');

  if (hasArmure) { exec.push('{{OD=true}}'); }

  if (attrsCarac.C1) {
    C1Nom = attrsCarac.C1Brut;

    const C1Value = attrsCarac.C1Base;
    const C1OD = attrsCarac.C1OD;

    cBase.push(attrsCarac.C1Nom);
    cRoll.push(C1Value);

    if (hasArmure) { OD += C1OD; }
  }

  if (attrsCarac.C2) {
    C2Nom = attrsCarac.C2Brut;

    const C2Value = attrsCarac.C2Base;
    const C2OD = attrsCarac.C2OD;

    cBase.push(attrsCarac.C2Nom);
    cRoll.push(C2Value);

    if (hasArmure) { OD += C2OD; }
  }

  if (attrsCarac.C3) {
    C3Nom = attrsCarac.C3Brut;

    const C3Value = attrsCarac.C3Base;
    const C3OD = attrsCarac.C3OD;

    cBonus.push(attrsCarac.C3Nom);
    cRoll.push(C3Value);

    if (hasArmure) { OD += C3OD; }
  }

  if (attrsCarac.C4) {
    C4Nom = attrsCarac.C4Brut;

    const C4Value = attrsCarac.C4Base;
    const C4OD = attrsCarac.C4OD;

    cBonus.push(attrsCarac.C4Nom);
    cRoll.push(C4Value);

    if (hasArmure) { OD += C4OD; }
  }

  const MALBonus = getMALBonus(attrs, armureL, false, false, vDiscretion, oDiscretion, hasBonus, C1Nom, C2Nom, C3Nom, C4Nom);

  exec = exec.concat(MALBonus.exec);
  cRoll = cRoll.concat(MALBonus.cRoll);

  if (isConditionnel === false) { isConditionnel = MALBonus.isConditionnelA; }

  ODMALBarbarian = ODMALBarbarian.concat(MALBonus.ODMALBarbarian);
  ODMALShaman = ODMALShaman.concat(MALBonus.ODMALShaman);
  ODMALWarrior.push(MALBonus.ODMALWarrior);

  exec.push(`{{cBase=${cBase.join(' - ')}}}`);

  if (hasBonus > 0) { exec.push(`{{cBonus=${cBonus.join(' - ')}}}`); }

  if (mod !== 0) {
    cRoll.push(mod);
    exec.push(`{{mod=[[${mod}]]}}`);
  }

  OD -= MALBonus.ODMALWarrior;
  exec.push(`{{vOD=${OD}}}`);

  if (cRoll.length === 0) { cRoll.push(0); }

  bonus.push(OD);

  bonus = bonus.concat(ODMALBarbarian);
  bonus = bonus.concat(ODMALWarrior);
  bonus = bonus.concat(ODMALShaman);

  if (isConditionnel === true) { exec.push('{{conditionnel=true}}'); }

  exec.push(`{{jet=[[ {[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`);
  exec.push(`{{tBonus=[[${bonus.join('+')}+0]]}}`);
  exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);

  startRoll(exec.join(' '), (results) => {
    const tJet = results.results.jet.result;
    const tBonus = results.results.tBonus.result;
    const tExploit = results.results.Exploit.result;

    const total = tJet + tBonus;

    finishRoll(
      results.rollId,
      {
        jet: total,
      },
    );

    if (tJet !== 0 && tJet === tExploit) {
      startRoll(`${roll}@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${i18n_exploit}}}{{jet=[[ {[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`, (exploit) => {
        const tExploit2 = exploit.results.jet.result;

        finishRoll(
          exploit.rollId,
          {
            jet: tExploit2,
          },
        );
      });
    }
  });
});

on('clicked:simplePsionPuppet clicked:simplePsionDiscord', async (info) => {
  const roll = info.htmlAttributes.value;
  const hasArmure = true;

  let attributs = [
    'caracteristique1Psion',
    'caracteristique2',
    'caracteristique3',
    'caracteristique4',
    'discretion',
    ODValue.discretion,
  ];

  attributs = attributs.concat(listBase, listArmureLegende);

  const attrs = await getAttrsAsync(attributs);

  const armureL = attrs.armureLegende;

  let exec = [];
  let isConditionnel = false;

  const mod = +attrs.jetModifDes;
  const hasBonus = +attrs.bonusCarac;

  const vDiscretion = attrs.discretion;
  const oDiscretion = attrs[ODValue.discretion];

  const C1 = attrs.caracteristique1Psion;
  const C2 = attrs.caracteristique2;
  const C3 = attrs.caracteristique3;
  const C4 = attrs.caracteristique4;

  const attrsCarac = await getCarac(hasBonus, C1, C2, C3, C4);

  let C1Nom = '';
  let C2Nom = '';
  let C3Nom = '';
  let C4Nom = '';

  let cRoll = [];
  const cBase = [];
  const cBonus = [];

  let bonus = [];
  let OD = 0;

  let ODMALBarbarian = [];
  const ODMALWarrior = [];
  let ODMALShaman = [];

  exec.push(roll);

  if (hasArmure) { exec.push('{{OD=true}}'); }

  if (attrsCarac.C1) {
    C1Nom = attrsCarac.C1Brut;

    const C1Value = attrsCarac.C1Base;
    const C1OD = attrsCarac.C1OD;

    cBase.push(attrsCarac.C1Nom);
    cRoll.push(C1Value);

    if (hasArmure) { OD += C1OD; }
  }

  if (attrsCarac.C2) {
    C2Nom = attrsCarac.C2Brut;

    const C2Value = attrsCarac.C2Base;
    const C2OD = attrsCarac.C2OD;

    cBase.push(attrsCarac.C2Nom);
    cRoll.push(C2Value);

    if (hasArmure) { OD += C2OD; }
  }

  if (attrsCarac.C3) {
    C3Nom = attrsCarac.C3Brut;

    const C3Value = attrsCarac.C3Base;
    const C3OD = attrsCarac.C3OD;

    cBonus.push(attrsCarac.C3Nom);
    cRoll.push(C3Value);

    if (hasArmure) { OD += C3OD; }
  }

  if (attrsCarac.C4) {
    C4Nom = attrsCarac.C4Brut;

    const C4Value = attrsCarac.C4Base;
    const C4OD = attrsCarac.C4OD;

    cBonus.push(attrsCarac.C4Nom);
    cRoll.push(C4Value);

    if (hasArmure) { OD += C4OD; }
  }

  const MALBonus = getMALBonus(attrs, armureL, false, false, vDiscretion, oDiscretion, hasBonus, C1Nom, C2Nom, C3Nom, C4Nom);

  exec = exec.concat(MALBonus.exec);
  cRoll = cRoll.concat(MALBonus.cRoll);

  if (isConditionnel === false) { isConditionnel = MALBonus.isConditionnelA; }

  ODMALBarbarian = ODMALBarbarian.concat(MALBonus.ODMALBarbarian);
  ODMALShaman = ODMALShaman.concat(MALBonus.ODMALShaman);
  ODMALWarrior.push(MALBonus.ODMALWarrior);

  exec.push(`{{cBase=${cBase.join(' - ')}}}`);

  if (hasBonus > 0) { exec.push(`{{cBonus=${cBonus.join(' - ')}}}`); }

  if (mod !== 0) {
    cRoll.push(mod);
    exec.push(`{{mod=[[${mod}]]}}`);
  }

  OD -= MALBonus.ODMALWarrior;
  exec.push(`{{vOD=${OD}}}`);

  if (cRoll.length === 0) { cRoll.push(0); }

  bonus.push(OD);

  bonus = bonus.concat(ODMALBarbarian);
  bonus = bonus.concat(ODMALWarrior);
  bonus = bonus.concat(ODMALShaman);

  if (isConditionnel === true) { exec.push('{{conditionnel=true}}'); }

  exec.push(`{{jet=[[ {[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`);
  exec.push(`{{tBonus=[[${bonus.join('+')}+0]]}}`);
  exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);

  startRoll(exec.join(' '), (results) => {
    const tJet = results.results.jet.result;
    const tBonus = results.results.tBonus.result;
    const tExploit = results.results.Exploit.result;

    const total = tJet + tBonus;

    finishRoll(
      results.rollId,
      {
        jet: total,
      },
    );

    if (tJet !== 0 && tJet === tExploit) {
      startRoll(`${roll}@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${i18n_exploit}}}{{jet=[[ {[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`, (exploit) => {
        const tExploit2 = exploit.results.jet.result;

        finishRoll(
          exploit.rollId,
          {
            jet: tExploit2,
          },
        );
      });
    }
  });
});

on('clicked:simpleRangerVision', async (info) => {
  const roll = info.htmlAttributes.value;
  const hasArmure = true;

  let attributs = [
    'caracteristique1Ranger',
    'caracteristique2',
    'caracteristique3',
    'caracteristique4',
    'discretion',
    ODValue.discretion,
  ];

  attributs = attributs.concat(listBase, listArmureLegende);

  const attrs = await getAttrsAsync(attributs);

  const armureL = attrs.armureLegende;

  let exec = [];
  exec.push('{{special1=^{ranger-vision}}}');

  let isConditionnel = false;

  const mod = +attrs.jetModifDes;
  const hasBonus = +attrs.bonusCarac;

  const vDiscretion = attrs.discretion;
  const oDiscretion = attrs[ODValue.discretion];

  const C1 = attrs.caracteristique1Ranger;
  const C2 = attrs.caracteristique2;
  const C3 = attrs.caracteristique3;
  const C4 = attrs.caracteristique4;

  const attrsCarac = await getCarac(hasBonus, C1, C2, C3, C4);

  let C1Nom = '';
  let C2Nom = '';
  let C3Nom = '';
  let C4Nom = '';

  let cRoll = [];
  const cBase = [];
  const cBonus = [];

  let bonus = [];
  let OD = 0;

  let ODMALBarbarian = [];
  const ODMALWarrior = [];
  let ODMALShaman = [];

  exec.push(roll);

  if (hasArmure) { exec.push('{{OD=true}}'); }

  if (attrsCarac.C1) {
    C1Nom = attrsCarac.C1Brut;

    const C1Value = attrsCarac.C1Base;
    const C1OD = attrsCarac.C1OD;

    cBase.push(attrsCarac.C1Nom);
    cRoll.push(C1Value);

    if (hasArmure) { OD += C1OD; }
  }

  if (attrsCarac.C2) {
    C2Nom = attrsCarac.C2Brut;

    const C2Value = attrsCarac.C2Base;
    const C2OD = attrsCarac.C2OD;

    cBase.push(attrsCarac.C2Nom);
    cRoll.push(C2Value);

    if (hasArmure) { OD += C2OD; }
  }

  if (attrsCarac.C3) {
    C3Nom = attrsCarac.C3Brut;

    const C3Value = attrsCarac.C3Base;
    const C3OD = attrsCarac.C3OD;

    cBonus.push(attrsCarac.C3Nom);
    cRoll.push(C3Value);

    if (hasArmure) { OD += C3OD; }
  }

  if (attrsCarac.C4) {
    C4Nom = attrsCarac.C4Brut;

    const C4Value = attrsCarac.C4Base;
    const C4OD = attrsCarac.C4OD;

    cBonus.push(attrsCarac.C4Nom);
    cRoll.push(C4Value);

    if (hasArmure) { OD += C4OD; }
  }

  const MALBonus = getMALBonus(attrs, armureL, false, false, vDiscretion, oDiscretion, hasBonus, C1Nom, C2Nom, C3Nom, C4Nom);

  exec = exec.concat(MALBonus.exec);
  cRoll = cRoll.concat(MALBonus.cRoll);

  if (isConditionnel === false) { isConditionnel = MALBonus.isConditionnelA; }

  ODMALBarbarian = ODMALBarbarian.concat(MALBonus.ODMALBarbarian);
  ODMALShaman = ODMALShaman.concat(MALBonus.ODMALShaman);
  ODMALWarrior.push(MALBonus.ODMALWarrior);

  exec.push(`{{cBase=${cBase.join(' - ')}}}`);

  if (hasBonus > 0) { exec.push(`{{cBonus=${cBonus.join(' - ')}}}`); }

  if (mod !== 0) {
    cRoll.push(mod);
    exec.push(`{{mod=[[${mod}]]}}`);
  }
  OD -= MALBonus.ODMALWarrior;
  exec.push(`{{vOD=${OD}}}`);

  if (cRoll.length === 0) { cRoll.push(0); }

  bonus.push(OD);

  bonus = bonus.concat(ODMALBarbarian);
  bonus = bonus.concat(ODMALWarrior);
  bonus = bonus.concat(ODMALShaman);

  if (isConditionnel === true) { exec.push('{{conditionnel=true}}'); }

  exec.push(`{{jet=[[ {[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`);
  exec.push(`{{tBonus=[[${bonus.join('+')}+0]]}}`);
  exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);

  startRoll(exec.join(' '), (results) => {
    const tJet = results.results.jet.result;
    const tBonus = results.results.tBonus.result;
    const tExploit = results.results.Exploit.result;

    const total = tJet + tBonus;

    finishRoll(
      results.rollId,
      {
        jet: total,
      },
    );

    if (tJet !== 0 && tJet === tExploit) {
      startRoll(`${roll}@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${i18n_exploit}}}{{jet=[[ {[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`, (exploit) => {
        const tExploit2 = exploit.results.jet.result;

        finishRoll(
          exploit.rollId,
          {
            jet: tExploit2,
          },
        );
      });
    }
  });
});

on('clicked:simpleShamanImpregnation', async (info) => {
  const roll = info.htmlAttributes.value;

  const hasArmure = true;

  let attributs = [
    'caracteristique1ShamanImpregnation',
    'caracteristique2ShamanImpregnation',
    'caracteristique3',
    'caracteristique4',
    'discretion',
    ODValue.discretion,
  ];

  attributs = attributs.concat(listBase, listArmureLegende);

  const attrs = await getAttrsAsync(attributs);

  const armureL = attrs.armureLegende;

  let exec = [];
  let isConditionnel = false;

  const hasBonus = +attrs.bonusCarac;

  const C1 = attrs.caracteristique1ShamanImpregnation;
  const C2 = attrs.caracteristique2ShamanImpregnation;
  const C3 = attrs.caracteristique3;
  const C4 = attrs.caracteristique4;

  const attrsCarac = await getCarac(hasBonus, C1, C2, C3, C4);

  const vDiscretion = attrs.discretion;
  const oDiscretion = attrs[ODValue.discretion];

  let C1Nom = '';
  let C2Nom = '';
  let C3Nom = '';
  let C4Nom = '';

  let cRoll = [];
  const cBase = [];
  const cBonus = [];

  let bonus = [];
  let OD = 0;

  let ODMALBarbarian = [];
  const ODMALWarrior = [];
  let ODMALShaman = [];

  exec.push(roll);

  if (hasArmure) { exec.push('{{OD=true}}'); }

  if (attrsCarac.C1) {
    C1Nom = attrsCarac.C1Brut;

    const C1Value = attrsCarac.C1Base;
    const C1OD = attrsCarac.C1OD;

    cBase.push(attrsCarac.C1Nom);
    cRoll.push(C1Value);

    if (hasArmure) { OD += C1OD; }
  }

  if (attrsCarac.C2) {
    C2Nom = attrsCarac.C2Brut;

    const C2Value = attrsCarac.C2Base;
    const C2OD = attrsCarac.C2OD;

    cBase.push(attrsCarac.C2Nom);
    cRoll.push(C2Value);

    if (hasArmure) { OD += C2OD; }
  }

  if (attrsCarac.C3) {
    C3Nom = attrsCarac.C3Brut;

    const C3Value = attrsCarac.C3Base;
    const C3OD = attrsCarac.C3OD;

    cBonus.push(attrsCarac.C3Nom);
    cRoll.push(C3Value);

    if (hasArmure) { OD += C3OD; }
  }

  if (attrsCarac.C4) {
    C4Nom = attrsCarac.C4Brut;

    const C4Value = attrsCarac.C4Base;
    const C4OD = attrsCarac.C4OD;

    cBonus.push(attrsCarac.C4Nom);
    cRoll.push(C4Value);

    if (hasArmure) { OD += C4OD; }
  }

  const MALBonus = getMALBonus(attrs, armureL, false, false, vDiscretion, oDiscretion, hasBonus, C1Nom, C2Nom, C3Nom, C4Nom);

  exec = exec.concat(MALBonus.exec);
  cRoll = cRoll.concat(MALBonus.cRoll);

  if (isConditionnel === false) { isConditionnel = MALBonus.isConditionnelA; }

  ODMALBarbarian = ODMALBarbarian.concat(MALBonus.ODMALBarbarian);
  ODMALShaman = ODMALShaman.concat(MALBonus.ODMALShaman);
  ODMALWarrior.push(MALBonus.ODMALWarrior);

  exec.push(`{{cBase=${cBase.join(' - ')}}}`);

  if (hasBonus > 0) { exec.push(`{{cBonus=${cBonus.join(' - ')}}}`); }

  OD -= MALBonus.ODMALWarrior;
  exec.push(`{{vOD=${OD}}}`);

  if (cRoll.length === 0) { cRoll.push(0); }

  bonus.push(OD);

  bonus = bonus.concat(ODMALBarbarian);
  bonus = bonus.concat(ODMALShaman);
  bonus = bonus.concat(ODMALWarrior);

  if (isConditionnel === true) { exec.push('{{conditionnel=true}}'); }

  exec.push(`{{jet=[[ {[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`);
  exec.push(`{{tBonus=[[${bonus.join('+')}+0]]}}`);
  exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);

  startRoll(exec.join(' '), (results) => {
    const tJet = results.results.jet.result;
    const tBonus = results.results.tBonus.result;
    const tExploit = results.results.Exploit.result;

    const total = tJet + tBonus;

    finishRoll(
      results.rollId,
      {
        jet: total,
      },
    );

    if (tJet !== 0 && tJet === tExploit) {
      startRoll(`${roll}@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${i18n_exploit}}} {{jet=[[ {[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`, (exploit) => {
        const tExploit2 = exploit.results.jet.result;

        finishRoll(
          exploit.rollId,
          {
            jet: tExploit2,
          },
        );
      });
    }
  });
});

on('clicked:simpleMALShamanImpregnation', async (info) => {
  const roll = info.htmlAttributes.value;
  const hasArmure = true;

  let attributs = [
    'caracteristique1MALShamanImpregnation',
    'caracteristique2MALShamanImpregnation',
    'caracteristique3',
    'caracteristique4',
    'discretion',
    ODValue.discretion,
  ];

  attributs = attributs.concat(listBase, listArmureLegende);

  const attrs = await getAttrsAsync(attributs);

  const armureL = attrs.armureLegende;

  let exec = [];
  let isConditionnel = false;

  const hasBonus = +attrs.bonusCarac;

  const C1 = attrs.caracteristique1MALShamanImpregnation;
  const C2 = attrs.caracteristique2MALShamanImpregnation;
  const C3 = attrs.caracteristique3;
  const C4 = attrs.caracteristique4;

  const attrsCarac = await getCarac(hasBonus, C1, C2, C3, C4);

  const vDiscretion = attrs.discretion;
  const oDiscretion = attrs[ODValue.discretion];

  let C1Nom = '';
  let C2Nom = '';
  let C3Nom = '';
  let C4Nom = '';

  let cRoll = [];
  const cBase = [];
  const cBonus = [];

  let bonus = [];
  let OD = 0;

  let ODMALBarbarian = [];
  const ODMALWarrior = [];

  exec.push(roll);

  if (hasArmure) { exec.push('{{OD=true}}'); }

  if (attrsCarac.C1) {
    C1Nom = attrsCarac.C1Brut;

    const C1Value = attrsCarac.C1Base;
    const C1OD = attrsCarac.C1OD;

    cBase.push(attrsCarac.C1Nom);
    cRoll.push(C1Value);

    if (hasArmure) { OD += C1OD; }
  }

  if (attrsCarac.C2) {
    C2Nom = attrsCarac.C2Brut;

    const C2Value = attrsCarac.C2Base;
    const C2OD = attrsCarac.C2OD;

    cBase.push(attrsCarac.C2Nom);
    cRoll.push(C2Value);

    if (hasArmure) { OD += C2OD; }
  }

  if (attrsCarac.C3) {
    C3Nom = attrsCarac.C3Brut;

    const C3Value = attrsCarac.C3Base;
    const C3OD = attrsCarac.C3OD;

    cBonus.push(attrsCarac.C3Nom);
    cRoll.push(C3Value);

    if (hasArmure) { OD += C3OD; }
  }

  if (attrsCarac.C4) {
    C4Nom = attrsCarac.C4Brut;

    const C4Value = attrsCarac.C4Base;
    const C4OD = attrsCarac.C4OD;

    cBonus.push(attrsCarac.C4Nom);
    cRoll.push(C4Value);

    if (hasArmure) { OD += C4OD; }
  }

  const MALBonus = getMALBonus(attrs, armureL, false, false, vDiscretion, oDiscretion, hasBonus, C1Nom, C2Nom, C3Nom, C4Nom);

  exec = exec.concat(MALBonus.exec);
  cRoll = cRoll.concat(MALBonus.cRoll);

  if (isConditionnel === false) { isConditionnel = MALBonus.isConditionnelA; }

  ODMALBarbarian = ODMALBarbarian.concat(MALBonus.ODMALBarbarian);
  ODMALWarrior.push(MALBonus.ODMALWarrior);

  exec.push(`{{cBase=${cBase.join(' - ')}}}`);

  if (hasBonus > 0) { exec.push(`{{cBonus=${cBonus.join(' - ')}}}`); }

  OD -= MALBonus.ODMALWarrior;
  exec.push(`{{vOD=${OD}}}`);

  if (cRoll.length === 0) { cRoll.push(0); }

  bonus.push(OD);

  bonus = bonus.concat(ODMALBarbarian);
  bonus = bonus.concat(ODMALWarrior);

  if (isConditionnel === true) { exec.push('{{conditionnel=true}}'); }

  exec.push(`{{jet=[[ {[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`);
  exec.push(`{{tBonus=[[${bonus.join('+')}+0]]}}`);
  exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);

  startRoll(exec.join(' '), (results) => {
    const tJet = results.results.jet.result;
    const tBonus = results.results.tBonus.result;
    const tExploit = results.results.Exploit.result;

    const total = tJet + tBonus;

    finishRoll(
      results.rollId,
      {
        jet: total,
      },
    );

    if (tJet !== 0 && tJet === tExploit) {
      startRoll(`${roll}@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${i18n_exploit}}}{{jet=[[ {[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`, (exploit) => {
        const tExploit2 = exploit.results.jet.result;

        finishRoll(
          exploit.rollId,
          {
            jet: tExploit2,
          },
        );
      });
    }
  });
});

on('clicked:simpleSorcererEtirement', async (info) => {
  const roll = info.htmlAttributes.value;
  const hasArmure = true;

  let attributs = [
    'caracteristique1',
    'caracteristique2',
    'caracteristique3',
    'caracteristique4',
    'discretion',
    ODValue.discretion,
  ];

  attributs = attributs.concat(listBase, listArmureLegende);

  const attrs = await getAttrsAsync(attributs);

  const armureL = attrs.armureLegende;

  let exec = [];
  let isConditionnel = false;

  const vDiscretion = attrs.discretion;
  const oDiscretion = attrs[ODValue.discretion];

  const mod = +attrs.jetModifDes;
  const hasBonus = +attrs.bonusCarac;

  const C1 = attrs.caracteristique1;
  const C2 = attrs.caracteristique2;
  const C3 = attrs.caracteristique3;
  const C4 = attrs.caracteristique4;

  const attrsCarac = await getCarac(hasBonus, C1, C2, C3, C4);

  let C1Nom = '';
  let C2Nom = '';
  let C3Nom = '';
  let C4Nom = '';

  let cRoll = [];
  const cBase = [];
  const cBonus = [];

  let bonus = [];
  let OD = 0;

  let ODMALBarbarian = [];
  const ODMALWarrior = [];
  let ODMALShaman = [];

  exec.push(roll);

  if (hasArmure) { exec.push('{{OD=true}}'); }

  if (attrsCarac.C1) {
    C1Nom = attrsCarac.C1Brut;

    const C1Value = attrsCarac.C1Base;
    const C1OD = attrsCarac.C1OD;

    cBase.push(attrsCarac.C1Nom);
    cRoll.push(C1Value);

    if (hasArmure) { OD += C1OD; }
  }

  if (attrsCarac.C2) {
    C2Nom = attrsCarac.C2Brut;

    const C2Value = attrsCarac.C2Base;
    const C2OD = attrsCarac.C2OD;

    cBase.push(attrsCarac.C2Nom);
    cRoll.push(C2Value);

    if (hasArmure) { OD += C2OD; }
  }

  if (attrsCarac.C3) {
    C3Nom = attrsCarac.C3Brut;

    const C3Value = attrsCarac.C3Base;
    const C3OD = attrsCarac.C3OD;

    cBonus.push(attrsCarac.C3Nom);
    cRoll.push(C3Value);

    if (hasArmure) { OD += C3OD; }
  }

  if (attrsCarac.C4) {
    C4Nom = attrsCarac.C4Brut;

    const C4Value = attrsCarac.C4Base;
    const C4OD = attrsCarac.C4OD;

    cBonus.push(attrsCarac.C4Nom);
    cRoll.push(C4Value);

    if (hasArmure) { OD += C4OD; }
  }

  const MALBonus = getMALBonus(attrs, armureL, false, false, vDiscretion, oDiscretion, hasBonus, C1Nom, C2Nom, C3Nom, C4Nom);

  exec = exec.concat(MALBonus.exec);
  cRoll = cRoll.concat(MALBonus.cRoll);

  if (isConditionnel === false) { isConditionnel = MALBonus.isConditionnelA; }

  ODMALBarbarian = ODMALBarbarian.concat(MALBonus.ODMALBarbarian);
  ODMALShaman = ODMALShaman.concat(MALBonus.ODMALShaman);
  ODMALWarrior.push(MALBonus.ODMALWarrior);

  exec.push(`{{cBase=${cBase.join(' - ')}}}`);

  if (hasBonus > 0) { exec.push(`{{cBonus=${cBonus.join(' - ')}}}`); }

  if (mod !== 0) {
    cRoll.push(mod);
    exec.push(`{{mod=[[${mod}]]}}`);
  }

  OD -= MALBonus.ODMALWarrior;
  exec.push(`{{vOD=${OD}}}`);

  if (cRoll.length === 0) { cRoll.push(0); }

  bonus.push(OD);
  bonus = bonus.concat(3);

  bonus = bonus.concat(ODMALBarbarian);
  bonus = bonus.concat(ODMALWarrior);
  bonus = bonus.concat(ODMALShaman);

  exec.push('{{vODSorcerer=[[3]]}}');
  exec.push(`{{jet=[[ {[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`);
  exec.push(`{{tBonus=[[${bonus.join('+')}+0]]}}`);
  exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);

  startRoll(exec.join(' '), (results) => {
    const tJet = results.results.jet.result;
    const tBonus = results.results.tBonus.result;
    const tExploit = results.results.Exploit.result;

    const total = tJet + tBonus;

    finishRoll(
      results.rollId,
      {
        jet: total,
      },
    );

    if (tJet !== 0 && tJet === tExploit) {
      startRoll(`${roll}@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${i18n_exploit}}}{{jet=[[ {[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`, (exploit) => {
        const tExploit2 = exploit.results.jet.result;

        finishRoll(
          exploit.rollId,
          {
            jet: tExploit2,
          },
        );
      });
    }
  });
});

on('clicked:pilotage', async (info) => {
  const roll = info.htmlAttributes.value;
  let hasArmure = true;

  let attributs = [
    'vehicule_manoeuvrabilite',
    'caracteristique1',
    'caracteristique2',
    'caracteristique3',
    'caracteristique4',
    'discretion',
    ODValue.discretion,
  ];

  attributs = attributs.concat(listBase, listArmure, listArmureLegende);

  const attrs = await getAttrsAsync(attributs);

  const armure = attrs.armure;
  const armureL = attrs.armureLegende;

  if (armure === 'sans' || armure === 'guardian') { hasArmure = false; }

  let exec = [];
  let isConditionnel = false;

  const manoeuvrabilite = +attrs.vehicule_manoeuvrabilite;
  const mod = +attrs.jetModifDes;
  const hasBonus = +attrs.bonusCarac;

  const vDiscretion = attrs.discretion;
  const oDiscretion = attrs[ODValue.discretion];

  const C1 = attrs.caracteristique1;
  const C2 = attrs.caracteristique2;
  const C3 = attrs.caracteristique3;
  const C4 = attrs.caracteristique4;

  const attrsCarac = await getCarac(hasBonus, C1, C2, C3, C4);

  let C1Nom = '';
  let C2Nom = '';
  let C3Nom = '';
  let C4Nom = '';

  let cRoll = [];
  const cBase = [];
  const cBonus = [];

  let bonus = [];
  let OD = 0;

  let ODBarbarian = [];
  let ODShaman = [];
  const ODWarrior = [];

  let ODMALBarbarian = [];
  let ODMALShaman = [];
  const ODMALWarrior = [];

  exec.push(roll);

  if (hasArmure) { exec.push('{{OD=true}}'); }

  if (attrsCarac.C1) {
    C1Nom = attrsCarac.C1Brut;

    const C1Value = attrsCarac.C1Base;
    const C1OD = attrsCarac.C1OD;

    cBase.push(attrsCarac.C1Nom);
    cRoll.push(C1Value);

    if (hasArmure) { OD += C1OD; }
  }

  if (attrsCarac.C2) {
    C2Nom = attrsCarac.C2Brut;

    const C2Value = attrsCarac.C2Base;
    const C2OD = attrsCarac.C2OD;

    cBase.push(attrsCarac.C2Nom);
    cRoll.push(C2Value);

    if (hasArmure) { OD += C2OD; }
  }

  if (attrsCarac.C3) {
    C3Nom = attrsCarac.C3Brut;

    const C3Value = attrsCarac.C3Base;
    const C3OD = attrsCarac.C3OD;

    cBonus.push(attrsCarac.C3Nom);
    cRoll.push(C3Value);

    if (hasArmure) { OD += C3OD; }
  }

  if (attrsCarac.C4) {
    C4Nom = attrsCarac.C4Brut;

    const C4Value = attrsCarac.C4Base;
    const C4OD = attrsCarac.C4OD;

    cBonus.push(attrsCarac.C4Nom);
    cRoll.push(C4Value);

    if (hasArmure) { OD += C4OD; }
  }

  const armorBonus = getArmorBonus(attrs, armure, false, false, vDiscretion, oDiscretion, hasBonus, C1Nom, C2Nom, C3Nom, C4Nom);

  exec = exec.concat(armorBonus.exec);
  cRoll = cRoll.concat(armorBonus.cRoll);

  if (isConditionnel === false) { isConditionnel = armorBonus.isConditionnelA; }

  ODBarbarian = ODBarbarian.concat(armorBonus.ODBarbarian);
  ODShaman = ODShaman.concat(armorBonus.ODShaman);
  ODWarrior.push(armorBonus.ODWarrior);

  const MALBonus = getMALBonus(attrs, armureL, false, false, vDiscretion, oDiscretion, hasBonus, C1Nom, C2Nom, C3Nom, C4Nom);

  exec = exec.concat(MALBonus.exec);
  cRoll = cRoll.concat(MALBonus.cRoll);

  if (isConditionnel === false) { isConditionnel = MALBonus.isConditionnelA; }

  ODMALBarbarian = ODMALBarbarian.concat(MALBonus.ODMALBarbarian);
  ODMALShaman = ODMALShaman.concat(MALBonus.ODMALShaman);
  ODMALWarrior.push(MALBonus.ODMALWarrior);

  exec.push(`{{cBase=${cBase.join(' - ')}}}`);

  if (hasBonus > 0) { exec.push(`{{cBonus=${cBonus.join(' - ')}}}`); }

  if (mod !== 0) {
    cRoll.push(mod);
    exec.push(`{{mod=[[${mod}]]}}`);
  }

  cRoll.push(manoeuvrabilite);
  exec.push(`{{vManoeuvrabilite=+${manoeuvrabilite}D6}}`);

  OD -= armorBonus.ODWarrior;
  OD -= MALBonus.ODMALWarrior;
  exec.push(`{{vOD=${OD}}}`);

  if (cRoll.length === 0) { cRoll.push(0); }

  bonus.push(OD);

  bonus = bonus.concat(ODBarbarian);
  bonus = bonus.concat(ODShaman);
  bonus = bonus.concat(ODWarrior);

  bonus = bonus.concat(ODMALBarbarian);
  bonus = bonus.concat(ODMALShaman);
  bonus = bonus.concat(ODMALWarrior);

  exec.push(`{{jet=[[ {[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`);
  exec.push(`{{tBonus=[[${bonus.join('+')}+0]]}}`);
  exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);

  if (isConditionnel) { exec.push('{{conditionnel=true}}'); }

  startRoll(exec.join(' '), (results) => {
    const tJet = results.results.jet.result;
    const tBonus = results.results.tBonus.result;
    const tExploit = results.results.Exploit.result;

    const total = tJet + tBonus;

    finishRoll(
      results.rollId,
      {
        jet: total,
      },
    );

    if (tJet !== 0 && tJet === tExploit) {
      startRoll(`${roll}@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${i18n_exploit}}}{{jet=[[ {[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`, (exploit) => {
        const tExploit2 = exploit.results.jet.result;

        finishRoll(
          exploit.rollId,
          {
            jet: tExploit2,
          },
        );
      });
    }
  });
});

on('clicked:initiative', async (info) => {
  const roll = info.htmlAttributes.value;
  let hasArmure = true;

  let listAttrs = [
    'diceInitiative',
    'bonusInitiative',
    'bonusInitiativeP',
    'malusInitiative',
    'discretion',
    ODValue.discretion,
    ODValue.instinct,
  ];

  listAttrs = listAttrs.concat(listBase);

  const attrs = await getAttrsAsync(listAttrs);

  const armure = attrs.armure;

  if (armure === 'sans' || armure === 'guardian') { hasArmure = false; }

  const dice = +attrs.diceInitiative || 3;
  const bonus = +attrs.bonusInitiative || 0;
  const bonusP = +attrs.bonusInitiativeP || 0;
  const malus = +attrs.malusInitiative || 0;

  const str = '';

  const ODInstinct = +attrs[ODValue.instinct];

  let result1 = 0;
  let result2 = 0;
  let resultF = 0;

  if (ODInstinct > 1 && hasArmure) {
    startRoll(`${roll} {{special1=^{initiative} 1}} {{jDivers=^{resultat}}} {{jDiversV=[[${dice}D6+${bonus}+${bonusP}-${malus}]]}}`, (results) => {
      result1 = results.results.jDiversV.result;

      finishRoll(
        results.rollId, {},
      );

      startRoll(`${roll} {{special1=^{initiative} 2}} {{jDivers=^{resultat}}} {{jDiversV=[[${dice}D6+${bonus}+${bonusP}-${malus}]]}}`, (results2) => {
        result2 = results2.results.jDiversV.result;

        finishRoll(
          results2.rollId, {},
        );

        resultF = Math.max(result1, result2);

        startRoll(`${roll} {{special1=^{initiative-finale}}} {{jDivers=^{resultat}}} {{jDiversV=[[${resultF} &{tracker}]]}} ${str}`, (results3) => {
          finishRoll(
            results3.rollId, {},
          );
        });
      });
    });
  } else {
    startRoll(`${roll} {{special1=^{initiative}}} {{jDivers=^{resultat}}} {{jDiversV=[[${dice}D6+${bonus}+${bonusP}-${malus} &{tracker}]]}} ${str}`, (results) => {
      finishRoll(
        results.rollId, {},
      );
    });
  }
});

const nods = ['nodsSoin', 'nodsArmure', 'nodsEnergie'];

nods.forEach((button) => {
  on(`clicked:${button}`, async (info) => {
    const roll = info.htmlAttributes.value;

    let sActuel = '';
    let sMax = '';

    let actuel = 0;
    let max = 0;

    switch (button) {
      case 'nodsSoin':
        sActuel = 'santepj';
        sMax = 'santepj_max';
        break;
      case 'nodsArmure':
        sActuel = 'armurePJ';
        sMax = 'armurePJ_max';
        break;
      case 'nodsEnergie':
        sActuel = 'energiePJ';
        sMax = 'energiePJ_max';
        break;
      default:
        sActuel = '';
        sMax = '';
        break;
    }

    const attrs = await getAttrsAsync([
      sActuel,
      sMax,
    ]);

    actuel = +attrs[sActuel];
    max = +attrs[sMax];

    startRoll(`${roll} {{jDivers=^{recupere}}} {{jDiversV=[[3D6]]}}`, (results) => {
      const recup = Number(results.results.jDiversV.result);
      let total = actuel + recup;

      if (total > max) { total = max; }

      switch (button) {
        case 'nodsSoin':
          setAttrsAsync({
            santepj: total,
          });
          break;
        case 'nodsArmure':
          setAttrsAsync({
            armurePJ: total,
          });
          break;
        case 'nodsEnergie':
          setAttrsAsync({
            energiePJ: total,
          });
          break;
      }

      finishRoll(
        results.rollId, {},
      );
    });
  });
});

on('clicked:blessuresGraves', (info) => {
  const roll = info.htmlAttributes.value;

  startRoll(`${roll} {{rollTitre=[[1D6]]}} {{rollText=[[1D6]]}}`, (results) => {
    const D1 = Number(results.results.rollTitre.result);
    const D2 = Number(results.results.rollText.result);

    let titre = '';
    let text = '';

    switch (D1) {
      case 1:
        switch (D2) {
          case 1:
            titre = getTranslationByKey('blessures-mort');
            text = getTranslationByKey('blessures-mort-description');
            break;

          case 2:
            titre = getTranslationByKey('blessures-organes-internes');
            text = getTranslationByKey('blessures-organes-internes-touches-description');
            break;

          case 3:
            titre = getTranslationByKey('blessures-cerveau-touche');
            text = getTranslationByKey('blessures-cerveau-touche-description');
            break;

          case 4:
            titre = getTranslationByKey('blessures-colonne-vertebrale-touchee');
            text = getTranslationByKey('blessures-colonne-vertebrale-touchee-description');
            break;

          case 5:
            titre = getTranslationByKey('blessures-hemorragie-interne');
            text = getTranslationByKey('blessures-hemorragie-interne-description');
            break;

          case 6:
            titre = getTranslationByKey('blessures-poumons-perfores');
            text = getTranslationByKey('blessures-poumons-perfores-description');
            break;

          default:
            titre = '';
            text = '';
            break;
        }
        break;

      case 2:
      case 3:
        switch (D2) {
          case 1:
            titre = getTranslationByKey('blessures-crane-brise');
            text = getTranslationByKey('blessures-crane-brise-description');
            break;

          case 2:
            titre = getTranslationByKey('blessures-yeux-detruits');
            text = getTranslationByKey('blessures-yeux-detruits-description');
            break;

          case 3:
            titre = getTranslationByKey('blessures-dos-brise');
            text = getTranslationByKey('blessures-dos-brise-description');
            break;

          case 4:
            titre = getTranslationByKey('blessures-main-brise');
            text = getTranslationByKey('blessures-main-brise-description');
            break;

          case 5:
            titre = getTranslationByKey('blessures-oreille-eclatee');
            text = getTranslationByKey('blessures-oreille-eclatee-description');
            break;

          case 6:
            titre = getTranslationByKey('blessures-cotes-brisees');
            text = getTranslationByKey('blessures-cotes-brisees-description');
            break;

          default:
            titre = '';
            text = '';
            break;
        }
        break;

      case 4:
      case 5:
        switch (D2) {
          case 1:
            titre = getTranslationByKey('blessures-colonne-vertebrale-brisee');
            text = getTranslationByKey('blessures-colonne-vertebrale-brisee-description');
            break;

          case 2:
            titre = getTranslationByKey('blessures-machoire-langue-dents-detruites');
            text = getTranslationByKey('blessures-machoire-langue-dents-detruites-description');
            break;

          case 3:
            titre = getTranslationByKey('blessures-pied-brise');
            text = getTranslationByKey('blessures-pied-brise-description');
            break;

          case 4:
            titre = getTranslationByKey('blessures-dos-touche');
            text = getTranslationByKey('blessures-dos-touche-description');
            break;

          case 5:
            titre = getTranslationByKey('blessures-tempe-touchee');
            text = getTranslationByKey('blessures-tempe-touchee-description');
            break;

          case 6:
            titre = getTranslationByKey('blessures-blessure-mineure');
            text = getTranslationByKey('blessures-blessure-mineure-description');
            break;

          default:
            titre = '';
            text = '';
            break;
        }
        break;

      case 6:
        switch (D2) {
          case 1:
            titre = getTranslationByKey('blessures-bras-mutile');
            text = getTranslationByKey('blessures-bras-mutile-description');
            break;

          case 2:
            titre = getTranslationByKey('blessures-jambe-mutilee');
            text = getTranslationByKey('blessures-jambe-mutilee-description');
            break;

          case 3:
            titre = getTranslationByKey('blessures-traumatisme-cranien');
            text = getTranslationByKey('blessures-traumatisme-cranien-description');
            break;

          case 4:
            titre = getTranslationByKey('blessures-borgne');
            text = getTranslationByKey('blessures-borgne-description');
            break;

          case 5:
            titre = getTranslationByKey('blessures-blessure-mineure');
            text = getTranslationByKey('blessures-blessure-mineure-description');
            break;

          case 6:
            titre = getTranslationByKey('blessures-rien');
            text = getTranslationByKey('blessures-rien-description');
            break;

          default:
            titre = '';
            text = '';
            break;
        }
        break;

      default:
        titre = '';
        text = '';
        break;
    }

    finishRoll(
      results.rollId, {
        rollTitre: titre,
        rollText: text,
      },
    );
  });
});

on('clicked:traumas', (info) => {
  const roll = info.htmlAttributes.value;

  startRoll(`${roll}`, (results) => {
    const D1 = Number(results.results.rollTitre.result);
    const D2 = Number(results.results.rollText.result);

    let titre = '';
    let text = '';

    switch (D1) {
      case 0:
        switch (D2) {
          case 1:
            titre = getTranslationByKey('traumas-anxiete');
            text = getTranslationByKey('traumas-anxiete-description');
            break;

          case 2:
            titre = getTranslationByKey('traumas-tic');
            text = getTranslationByKey('traumas-tic-description');
            break;

          case 3:
            titre = getTranslationByKey('traumas-perte-confiance');
            text = getTranslationByKey('traumas-perte-confiance-description');
            break;

          case 4:
            titre = getTranslationByKey('traumas-peur-monstre');
            text = getTranslationByKey('traumas-peur-monstre-description');
            break;

          case 5:
            titre = getTranslationByKey('traumas-rituel');
            text = getTranslationByKey('traumas-rituel-description');
            break;

          case 6:
            titre = getTranslationByKey('traumas-collection');
            text = getTranslationByKey('traumas-collection-description');
            break;

          default:
            titre = '';
            text = '';
            break;
        }
        break;

      case 1:
        switch (D2) {
          case 1:
            titre = getTranslationByKey('traumas-faiblesse');
            text = getTranslationByKey('traumas-faiblesse-description');
            break;

          case 2:
            titre = getTranslationByKey('traumas-somatisation');
            text = getTranslationByKey('traumas-somatisation-description');
            break;

          case 3:
            titre = getTranslationByKey('traumas-distanciation');
            text = getTranslationByKey('traumas-distanciation-description');
            break;

          case 4:
            titre = getTranslationByKey('traumas-reveries');
            text = getTranslationByKey('traumas-reveries-description');
            break;

          case 5:
            titre = getTranslationByKey('traumas-hypersensibilite');
            text = getTranslationByKey('traumas-hypersensibilite-description');
            break;

          case 6:
            titre = getTranslationByKey('traumas-trouble-sensitif');
            text = getTranslationByKey('traumas-trouble-sensitif-description');
            break;

          default:
            titre = '';
            text = '';
            break;
        }
        break;

      case 2:
        switch (D2) {
          case 1:
            titre = getTranslationByKey('traumas-dissociation');
            text = getTranslationByKey('traumas-dissociation-description');
            break;

          case 2:
            titre = getTranslationByKey('traumas-depression');
            text = getTranslationByKey('traumas-depression-description');
            break;

          case 3:
            titre = getTranslationByKey('traumas-paranoia');
            text = getTranslationByKey('traumas-paranoia-description');
            break;

          case 4:
            titre = getTranslationByKey('traumas-trouble-memoriel');
            text = getTranslationByKey('traumas-trouble-memoriel-description');
            break;

          case 5:
            titre = getTranslationByKey('traumas-addiction');
            text = getTranslationByKey('traumas-addiction-description');
            break;

          case 6:
            titre = getTranslationByKey('traumas-hallucinations');
            text = getTranslationByKey('traumas-hallucinations-description');
            break;

          default:
            titre = '';
            text = '';
            break;
        }
        break;

      case 3:
        switch (D2) {
          case 1:
            titre = getTranslationByKey('traumas-anatheme');
            text = getTranslationByKey('traumas-anatheme-description');
            break;

          case 2:
            titre = getTranslationByKey('traumas-abattement');
            text = getTranslationByKey('traumas-abattement-description');
            break;

          case 3:
            titre = getTranslationByKey('traumas-decouragement');
            text = getTranslationByKey('traumas-decouragement-description');
            break;

          case 4:
            titre = getTranslationByKey('traumas-oubli');
            text = getTranslationByKey('traumas-oubli-description');
            break;

          case 5:
            titre = getTranslationByKey('traumas-phobie-sociale');
            text = getTranslationByKey('traumas-phobie-sociale-description');
            break;

          case 6:
            titre = getTranslationByKey('traumas-perte-controle');
            text = getTranslationByKey('traumas-perte-controle-description');
            break;

          default:
            titre = '';
            text = '';
            break;
        }
        break;

      default:
        titre = '';
        text = '';
        break;
    }

    finishRoll(
      results.rollId, {
        rollTitre: titre,
        rollText: text,
      },
    );
  });
});
  /* eslint-disable max-len */
/* eslint-disable prefer-destructuring */
/* eslint-disable camelcase */
/* eslint-disable no-undef */
const warlockRollCoutrecoups = ['rollWarlockContrecoups', 'rollMALWarlockContrecoups'];

warlockRollCoutrecoups.forEach((button) => {
  on(`clicked:${button}`, (info) => {
    const roll = info.htmlAttributes.value;

    const exec = [];
    exec.push(roll);
    exec.push('{{rollTitre=[[1D6]]}}');
    exec.push('{{rollText=[[1D6]]}}');
    exec.push('{{roll6D6=[[6D6]]}}');
    exec.push('{{roll1D3=[[1D3]]}}');

    startRoll(exec.join(' '), (results) => {
      const tD1 = results.results.rollTitre.result;
      const tD2 = results.results.rollText.result;

      const t6D6D = results.results.roll6D6.dice;
      const t6D6R = results.results.roll6D6.result;

      const t1D3 = results.results.roll1D3.result;

      let resultTitre = '';
      let resultText = '';
      let calcul = 0;

      switch (tD1) {
        case 1:
          switch (tD2) {
            case 1:
              resultTitre = i18n_contreCoupsDechirureT;
              resultText = i18n_contreCoupsDechirureV;
              break;

            case 2:
              resultTitre = i18n_contreCoupsDisparitionT;
              resultText = i18n_contreCoupsDisparitionV;
              break;

            case 3:
            case 4:
              calcul = t6D6D[0] + t6D6D[1] + t6D6D[2] + t6D6D[3];

              resultTitre = i18n_contreCoupsIncidentT;
              resultText = i18n_contreCoupsIncidentV1 + calcul + i18n_contreCoupsIncidentV2;
              break;

            case 5:
              resultTitre = i18n_contreCoupsSiphonT;
              resultText = i18n_contreCoupsSiphonV1 + t6D6R + i18n_contreCoupsSiphonV2;
              break;

            case 6:
              resultTitre = i18n_contreCoupsSursautT;
              resultText = i18n_contreCoupsSursautV1 + t6D6D[0] + i18n_contreCoupsSursautV2;
              break;

            default:
              resultTitre = '';
              resultText = '';
              break;
          }
          break;

        case 2:
          switch (tD2) {
            case 1:
              resultTitre = i18n_contreCoupsDisparitionT;
              resultText = i18n_contreCoupsDisparitionV;
              break;

            case 2:
            case 3:
              calcul = t6D6D[0] + t6D6D[1] + t6D6D[2] + t6D6D[3];

              resultTitre = i18n_contreCoupsIncidentT;
              resultText = i18n_contreCoupsIncidentV1 + calcul + i18n_contreCoupsIncidentV2;
              break;

            case 4:
              calcul = t6D6D[0];

              resultTitre = i18n_contreCoupsFragmentationT;
              resultText = i18n_contreCoupsFragmentationV1 + calcul + i18n_contreCoupsFragmentationV2;
              break;

            case 5:
              resultTitre = i18n_contreCoupsSiphonT;
              resultText = i18n_contreCoupsSiphonV1 + t6D6R + i18n_contreCoupsSiphonV2;
              break;

            case 6:
              resultTitre = i18n_contreCoupsSursautT;
              resultText = i18n_contreCoupsSursautV1 + t6D6D[0] + i18n_contreCoupsSursautV2;
              break;

            default:
              resultTitre = '';
              resultText = '';
              break;
          }
          break;

        case 3:
          switch (tD2) {
            case 1:
              resultTitre = i18n_contreCoupsDisparitionT;
              resultText = i18n_contreCoupsDisparitionV;
              break;

            case 2:
              calcul = t6D6D[0] + t6D6D[1] + t6D6D[2] + t6D6D[3];

              resultTitre = i18n_contreCoupsIncidentT;
              resultText = i18n_contreCoupsIncidentV1 + calcul + i18n_contreCoupsIncidentV2;
              break;

            case 3:
              calcul = t6D6D[0];

              resultTitre = i18n_contreCoupsFragmentationT;
              resultText = i18n_contreCoupsFragmentationV1 + calcul + i18n_contreCoupsFragmentationV2;
              break;

            case 4:
              resultTitre = i18n_contreCoupsSiphonT;
              resultText = i18n_contreCoupsSiphonV1 + t6D6R + i18n_contreCoupsSiphonV2;
              break;

            case 5:
              resultTitre = i18n_contreCoupsSursautT;
              resultText = i18n_contreCoupsSursautV1 + t6D6D[0] + i18n_contreCoupsSursautV2;
              break;

            case 6:
              resultTitre = i18n_contreCoupsDesorientationT;
              resultText = i18n_contreCoupsDesorientationV1 + t6D6D[0] + i18n_contreCoupsDesorientationV2;
              break;

            default:
              resultTitre = '';
              resultText = '';
              break;
          }
          break;

        case 4:
          switch (tD2) {
            case 1:
              calcul = t6D6D[0] + t6D6D[1] + t6D6D[2] + t6D6D[3];

              resultTitre = i18n_contreCoupsIncidentT;
              resultText = i18n_contreCoupsIncidentV1 + calcul + i18n_contreCoupsIncidentV2;
              break;

            case 2:
              calcul = t6D6D[0];

              resultTitre = i18n_contreCoupsFragmentationT;
              resultText = i18n_contreCoupsFragmentationV1 + calcul + i18n_contreCoupsFragmentationV2;
              break;

            case 3:
              resultTitre = i18n_contreCoupsSiphonT;
              resultText = i18n_contreCoupsSiphonV1 + t6D6R + i18n_contreCoupsSiphonV2;
              break;

            case 4:
              resultTitre = i18n_contreCoupsSursautT;
              resultText = i18n_contreCoupsSursautV1 + t6D6D[0] + i18n_contreCoupsSursautV2;
              break;

            case 5:
              resultTitre = i18n_contreCoupsDesorientationT;
              resultText = i18n_contreCoupsDesorientationV1 + t6D6D[0] + i18n_contreCoupsDesorientationV2;
              break;

            case 6:
              calcul = t6D6D[0] + t6D6D[1] + t6D6D[2];

              resultTitre = i18n_contreCoupsDesagregationT;
              resultText = i18n_contreCoupsDesagregationV1 + calcul + i18n_contreCoupsDesagregationV2;
              break;

            default:
              resultTitre = '';
              resultText = '';
              break;
          }
          break;

        case 5:
          switch (tD2) {
            case 1:
            case 2:
              resultTitre = i18n_contreCoupsSiphonT;
              resultText = i18n_contreCoupsSiphonV1 + t6D6R + i18n_contreCoupsSiphonV2;
              break;

            case 3:
              resultTitre = i18n_contreCoupsSursautT;
              resultText = i18n_contreCoupsSursautV1 + t6D6D[0] + i18n_contreCoupsSursautV2;
              break;

            case 4:
              resultTitre = i18n_contreCoupsDesorientationT;
              resultText = i18n_contreCoupsDesorientationV1 + t6D6D[0] + i18n_contreCoupsDesorientationV2;
              break;

            case 5:
              calcul = t6D6D[0] + t6D6D[1] + t6D6D[2];

              resultTitre = i18n_contreCoupsDesagregationT;
              resultText = i18n_contreCoupsDesagregationV1 + calcul + i18n_contreCoupsDesagregationV2;
              break;

            case 6:
              resultTitre = i18n_contreCoupsDefaillanceT;
              resultText = i18n_contreCoupsDefaillanceV1 + t1D3 + i18n_contreCoupsDefaillanceV2;
              break;

            default:
              resultTitre = '';
              resultText = '';
              break;
          }
          break;

        case 6:
          switch (tD2) {
            case 1:
            case 2:
              resultTitre = i18n_contreCoupsSursautT;
              resultText = i18n_contreCoupsSursautV1 + t6D6D[0] + i18n_contreCoupsSursautV1;
              break;

            case 3:
              resultTitre = i18n_contreCoupsDesorientationT;
              resultText = i18n_contreCoupsDesorientationV1 + t6D6D[0] + i18n_contreCoupsDesorientationV2;
              break;

            case 4:
            case 5:
            case 6:
              resultTitre = i18n_contreCoupsDefaillanceT;
              resultText = i18n_contreCoupsDefaillanceV1 + t1D3 + i18n_contreCoupsDefaillanceV2;
              break;

            default:
              resultTitre = '';
              resultText = '';
              break;
          }
          break;

        default:
          resultTitre = '';
          resultText = '';
          break;
      }

      finishRoll(
        results.rollId,
        {
          rollTitre: resultTitre,
          rollText: resultText,
        },
      );
    });
  });
});
  /* eslint-disable default-case */
/* eslint-disable camelcase */
/* eslint-disable max-len */
/* eslint-disable prefer-destructuring */
/* eslint-disable no-undef */
on('clicked:distanceWizardBorealis', async (info) => {
  const roll = info.htmlAttributes.value;
  const hasArmure = true;

  let attributs = [
    'caracteristique1',
    'caracteristique2',
    'caracteristique3',
    'caracteristique4',
    'wizardBDmg',
    'wizardBViolence',
    'wizardBPortee',
    'wizardBTypeAttaque',
    'calODTir',
    'calODCom',
    'discretion',
    ODValue.discretion,
    'devasterAnatheme',
    'bourreauTenebres',
    'equilibreBalance',
  ];

  attributs = attributs.concat(listBase, listStyle, listArmureLegende);

  const attrs = await getAttrsAsync(attributs);

  const armureL = attrs.armureLegende;

  let exec = [];
  let autresEffets = [];

  const typeAttaque = attrs.wizardBTypeAttaque;

  let diceDegats = Number(attrs.wizardBDmg.split('D')[0]);
  let diceViolence = Number(attrs.wizardBViolence.split('D')[0]);
  const portee = attrs.wizardBPortee;

  const mod = +attrs.jetModifDes;
  const hasBonus = +attrs.bonusCarac;

  const vDiscretion = +attrs.discretion;
  const oDiscretion = +attrs[ODValue.discretion];

  const C1 = attrs.caracteristique1;
  const C2 = attrs.caracteristique2;
  const C3 = attrs.caracteristique3;
  const C4 = attrs.caracteristique4;

  const attrsCarac = await getCarac(hasBonus, C1, C2, C3, C4);

  let C1Nom = '';
  let C2Nom = '';
  let C3Nom = '';
  let C4Nom = '';

  let cRoll = [];
  const cBase = [];
  const cBonus = [];

  let bonus = [];
  let OD = 0;

  const devaste = +attrs.devasterAnatheme;
  const bourreau = +attrs.bourreauTenebres;
  const equilibre = +attrs.equilibreBalance;

  let ODMALBarbarian = [];
  let ODMALRogue = [];
  const ODMALWarrior = [];
  let ODMALShaman = [];

  exec.push(roll);

  if (hasArmure) { exec.push('{{OD=true}}'); }

  if (attrsCarac.C1) {
    C1Nom = attrsCarac.C1Brut;

    const C1Value = attrsCarac.C1Base;
    const C1OD = attrsCarac.C1OD;

    cBase.push(attrsCarac.C1Nom);
    cRoll.push(C1Value);

    if (hasArmure) { OD += C1OD; }
  }

  if (attrsCarac.C2) {
    C2Nom = attrsCarac.C2Brut;

    const C2Value = attrsCarac.C2Base;
    const C2OD = attrsCarac.C2OD;

    cBase.push(attrsCarac.C2Nom);
    cRoll.push(C2Value);

    if (hasArmure) { OD += C2OD; }
  }

  if (attrsCarac.C3) {
    C3Nom = attrsCarac.C3Brut;

    const C3Value = attrsCarac.C3Base;
    const C3OD = attrsCarac.C3OD;

    cBonus.push(attrsCarac.C3Nom);
    cRoll.push(C3Value);

    if (hasArmure) { OD += C3OD; }
  }

  if (attrsCarac.C4) {
    C4Nom = attrsCarac.C4Brut;

    const C4Value = attrsCarac.C4Base;
    const C4OD = attrsCarac.C4OD;

    cBonus.push(attrsCarac.C4Nom);
    cRoll.push(C4Value);

    if (hasArmure) { OD += C4OD; }
  }

  const MALBonus = getMALBonus(attrs, armureL, false, false, vDiscretion, oDiscretion, hasBonus, C1Nom, C2Nom, C3Nom, C4Nom, autresEffets);

  exec = exec.concat(MALBonus.exec);
  cRoll = cRoll.concat(MALBonus.cRoll);

  ODMALBarbarian = ODMALBarbarian.concat(MALBonus.ODMALBarbarian);
  ODMALRogue = ODMALRogue.concat(MALBonus.ODMALRogue);
  ODMALShaman = ODMALShaman.concat(MALBonus.ODMALShaman);
  ODMALWarrior.push(MALBonus.ODMALWarrior);

  autresEffets = autresEffets.concat(MALBonus.autresEffets);

  exec.push(`{{cBase=${cBase.join(' - ')}}}`);

  if (hasBonus > 0) { exec.push(`{{cBonus=${cBonus.join(' - ')}}}`); }

  if (mod !== 0) {
    cRoll.push(mod);
    exec.push(`{{mod=[[${mod}]]}}`);
  }

  // GESTION DU STYLE

  const ODTir = attrs.calODTir;
  const ODCombat = attrs.calODCom;
  const style = attrs.styleCombat;
  let bName = '';
  let modA = 0;
  let violenceB = 0;

  switch (style) {
    case 'standard':
      exec.push(`{{style=${i18n_style} ${i18n_standard}}}`);
      break;

    case 'couvert':
      bName = 'atkCouvert';
      modA = attrs[bName];

      exec.push(`{{style=${i18n_style} ${i18n_couvert}}}`);
      exec.push(`{{vMStyleA=${modA}D}}`);
      cRoll.push(Number(modA));
      break;

    case 'agressif':
      bName = 'atkAgressif';
      modA = attrs[bName];

      exec.push(`{{style=${i18n_style} ${i18n_agressif}}}`);
      exec.push(`{{vMStyleA=${modA}D}}`);
      cRoll.push(Number(modA));
      break;

    case 'akimbo':
      bName = 'atkAkimbo';
      modA = attrs[bName];
      violenceB = Math.ceil(diceViolence / 2);

      exec.push(`{{style=${i18n_style} ${i18n_akimbo}}}`);
      exec.push(`{{vMStyleD=+${diceDegats}}}`);
      exec.push(`{{vMStyleV=+${violenceB}D6}}`);
      diceDegats += diceDegats;
      diceViolence += violenceB;

      if (typeAttaque === 'distance' && ODTir >= 3) {
        exec.push('{{vMStyleA=-1D}}');
        cRoll.push(-1);
      } else if (typeAttaque === 'contact' && ODCombat >= 3) {
        exec.push('{{vMStyleA=-1D}}');
        cRoll.push(-1);
      } else {
        exec.push(`{{vMStyleA=${modA}D}}`);
        cRoll.push(Number(modA));
      }

      break;

    case 'ambidextre':
      bName = 'atkAmbidextre';
      modA = attrs[bName];

      exec.push(`{{style=${i18n_style} ${i18n_ambidextre}}}`);

      if (typeAttaque === 'distance' && ODTir >= 3) {
        exec.push('{{vMStyleA=-1D}}');
        cRoll.push(-1);
      } else if (typeAttaque === 'contact' && ODCombat >= 3) {
        exec.push('{{vMStyleA=-1D}}');
        cRoll.push(-1);
      } else {
        exec.push(`{{vMStyleA=${modA}D}}`);
        cRoll.push(Number(modA));
      }
      break;

    case 'defensif':
      bName = 'atkDefensif';
      modA = attrs[bName];

      exec.push(`{{style=${i18n_style} ${i18n_defensif}}}`);
      exec.push(`{{vMStyleA=${modA}D}}`);
      cRoll.push(Number(modA));
      break;
  }

  // FIN GESTION DU STYLE
  OD -= MALBonus.ODMALWarrior;
  exec.push(`{{vOD=${OD}}}`);

  if (cRoll.length === 0) { cRoll.push(0); }

  bonus.push(OD);

  bonus = bonus.concat(ODMALBarbarian);
  bonus = bonus.concat(ODMALRogue);
  bonus = bonus.concat(ODMALWarrior);
  bonus = bonus.concat(ODMALShaman);

  exec.push(`{{jet=[[ {[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`);
  exec.push(`{{tBonus=[[${bonus.join('+')}+0]]}}`);
  exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);

  exec.push(`{{portee=${i18n_portee} ${portee}}}`);
  exec.push(`{{degats=[[${diceDegats}D6]]}}`);
  exec.push(`{{violence=[[${diceViolence}D6]]}}`);
  exec.push(`{{effets=${i18n_degatsContinus} ([[1d6]] ${i18n_tours})}}`);

  exec.push('{{degatsConditionnel=true}}');
  exec.push('{{violenceConditionnel=true}}');
  exec.push(`{{antiAnatheme=${i18n_antiAnatheme}}}`);
  exec.push(`{{antiAnathemeCondition=${i18n_antiAnathemeCondition}}}`);

  if (devaste || bourreau || equilibre) {
    const herauts = [];

    if (devaste) { herauts.push(i18n_devasterAnatheme); }
    if (bourreau) { herauts.push(i18n_bourreauTenebres); }
    if (equilibre) { herauts.push(i18n_equilibrerBalance); }

    exec.push(`{{herauts=${herauts.join(' / ')}}}`);
  }

  // ROLL
  const finalRoll = await startRoll(exec.join(' '));

  const tJet = finalRoll.results.jet.result;

  const tBonus = finalRoll.results.tBonus.result;
  const tExploit = finalRoll.results.Exploit.result;

  const rDegats = finalRoll.results.degats.dice;
  const rViolence = finalRoll.results.violence.dice;

  const tDegats = finalRoll.results.degats.result;
  const tViolence = finalRoll.results.violence.result;

  const conditions = {
    bourreau,
    devaste,
    equilibre,
  };

  const computed = updateRoll(finalRoll, tDegats, rDegats, [], tViolence, rViolence, [], conditions);

  const finalComputed = {
    jet: tJet + tBonus,
  };

  Object.assign(finalComputed, computed);

  finishRoll(finalRoll.rollId, finalComputed);

  if (tJet !== 0 && tJet === tExploit) {
    const exploitRoll = await startRoll(`${roll}@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${i18n_exploit}}}{{jet=[[ {[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`);
    const tRExploit = exploitRoll.results.jet.result;
    const exploitComputed = {
      jet: tRExploit,
    };

    finishRoll(exploitRoll.rollId, exploitComputed);
  }
});

on('clicked:distanceWizardOriflamme', async (info) => {
  const roll = info.htmlAttributes.value;

  let attributs = [
    'wizardODmg',
    'wizardOViolence',
    'wizardOPortee',
    'devasterAnatheme',
    'bourreauTenebres',
    'equilibreBalance',
  ];

  attributs = attributs.concat(listBase);
  attributs = attributs.concat(listArmureLegende);

  const attrs = await getAttrsAsync(attributs);

  const armureL = attrs.armureLegende;

  const exec = [];
  const autresEffets = [];

  let MALGoliath;
  let MALChangeling;
  let MALGhost;
  let MALTypeSoldier;
  let MALTypeHunter;
  let MALTypeHerald;
  let MALTypeScholar;
  let MALTypeScout;

  const degats = attrs.wizardODmg;
  const violence = attrs.wizardOViolence;
  const portee = attrs.wizardOPortee;

  const devaste = +attrs.devasterAnatheme;
  const bourreau = +attrs.bourreauTenebres;
  const equilibre = +attrs.equilibreBalance;

  exec.push(roll);

  switch (armureL) {
    case 'barbarian':
      MALGoliath = +attrs.MALBarbarianGoliath;

      if (MALGoliath !== 0) { exec.push(`{{MALGoliath=[[${MALGoliath}]]}}`); }
      break;

    case 'bard':
      MALChangeling = +attrs.MALBardChangeling;

      if (MALChangeling !== 0) {
        exec.push(`{{MALspecial2=${i18n_changelingActive}}}`);
      }
      break;

    case 'rogue':
      MALGhost = attrs.MALRogueGhost;

      if (MALGhost !== '') { exec.push(`{{MALspecial2=${i18n_ghostActive}}}`); }
      break;

    case 'warrior':
      MALTypeSoldier = attrs.MALWarriorSoldierA;
      MALTypeHunter = attrs.MALWarriorHunterA;
      MALTypeHerald = attrs.MALWarriorHeraldA;
      MALTypeScholar = attrs.MALWarriorScholarA;
      MALTypeScout = attrs.MALWarriorScoutA;

      if (MALTypeSoldier !== 0) { exec.push(`{{MALspecial2=${i18n_typeSoldier}}}`); }

      if (MALTypeHunter !== 0) { exec.push(`{{MALspecial2=${i18n_typeHunter}}}`); }

      if (MALTypeHerald !== 0) { exec.push(`{{MALspecial2=${i18n_typeHerald}}}`); }

      if (MALTypeScholar !== 0) { exec.push(`{{MALspecial2=${i18n_typeScholar}}}`); }

      if (MALTypeScout !== 0) { exec.push(`{{MALspecial2=${i18n_typeScout}}}`); }
      break;

    default:
      MALGoliath = 0;
      MALGhost = '';
      MALChangeling = '';
      MALTypeSoldier = '';
      MALTypeHunter = '';
      MALTypeHerald = '';
      MALTypeScholar = '';
      MALTypeScout = '';
      break;
  }

  autresEffets.push(`${i18n_lumiere} 2`);

  exec.push(`{{portee=${i18n_portee} ${portee}}}`);
  exec.push(`{{degats=[[${degats}]]}}`);
  exec.push(`{{violence=[[${violence}]]}}`);

  exec.push(`{{antiAnatheme=${i18n_antiAnatheme}}}`);
  exec.push(`{{antiAnathemeCondition=${i18n_antiAnathemeCondition}}}`);

  exec.push('{{degatsConditionnel=true}}');
  exec.push('{{violenceConditionnel=true}}');
  exec.push(`{{affecteAnathemeD=${i18n_affecteAnatheme}}}`);
  exec.push(`{{affecteAnathemeV=${i18n_affecteAnatheme}}}`);

  exec.push(`{{effets=${autresEffets.join(' / ')}}}`);

  if (devaste || bourreau || equilibre) {
    const herauts = [];

    if (devaste) { herauts.push(i18n_devasterAnatheme); }
    if (bourreau) { herauts.push(i18n_bourreauTenebres); }
    if (equilibre) { herauts.push(i18n_equilibrerBalance); }

    exec.push(`{{herauts=${herauts.join(' / ')}}}`);
  }

  // ROLL
  const finalRoll = await startRoll(exec.join(' '));

  const rDegats = finalRoll.results.degats.dice;
  const rViolence = finalRoll.results.violence.dice;

  const tDegats = finalRoll.results.degats.result;
  const tViolence = finalRoll.results.violence.result;

  const conditions = {
    bourreau,
    devaste,
    equilibre,
  };

  const computed = updateRoll(finalRoll, tDegats, rDegats, [], tViolence, rViolence, [], conditions);

  finishRoll(finalRoll.rollId, computed);
});

on('clicked:distanceMALWizardOriflamme', async (info) => {
  const roll = info.htmlAttributes.value;

  let attributs = [
    'MALWizardODmg',
    'MALWizardOViolence',
    'MALWizardOPortee',
    'devasterAnatheme',
    'bourreauTenebres',
    'equilibreBalance',
  ];

  attributs = attributs.concat(listArmureLegende);

  const attrs = await getAttrsAsync(attributs);

  const armureL = attrs.armureLegende;

  const exec = [];

  const degats = attrs.MALWizardODmg;
  const violence = attrs.MALWizardOViolence;
  const portee = attrs.MALWizardOPortee;

  const devaste = +attrs.devasterAnatheme;
  const bourreau = +attrs.bourreauTenebres;
  const equilibre = +attrs.equilibreBalance;

  const autresEffets = [];

  let MALGoliath;
  let MALChangeling;
  let MALGhost;
  let MALTypeSoldier;
  let MALTypeHunter;
  let MALTypeHerald;
  let MALTypeScholar;
  let MALTypeScout;

  exec.push(roll);

  switch (armureL) {
    case 'barbarian':
      MALGoliath = +attrs.MALBarbarianGoliath;

      if (MALGoliath !== 0) { exec.push(`{{MALGoliath=[[${MALGoliath}]]}}`); }
      break;

    case 'bard':
      MALChangeling = +attrs.MALBardChangeling;

      if (MALChangeling !== 0) {
        exec.push(`{{MALspecial2=${i18n_changelingActive}}}`);
      }
      break;

    case 'rogue':
      MALGhost = attrs.MALRogueGhost;

      if (MALGhost !== '') { exec.push(`{{MALspecial2=${i18n_ghostActive}}}`); }
      break;

    case 'warrior':
      MALTypeSoldier = attrs.MALWarriorSoldierA;
      MALTypeHunter = attrs.MALWarriorHunterA;
      MALTypeHerald = attrs.MALWarriorHeraldA;
      MALTypeScholar = attrs.MALWarriorScholarA;
      MALTypeScout = attrs.MALWarriorScoutA;

      if (MALTypeSoldier !== 0) { exec.push(`{{MALspecial2=${i18n_typeSoldier}}}`); }

      if (MALTypeHunter !== 0) { exec.push(`{{MALspecial2=${i18n_typeHunter}}}`); }

      if (MALTypeHerald !== 0) { exec.push(`{{MALspecial2=${i18n_typeHerald}}}`); }

      if (MALTypeScholar !== 0) { exec.push(`{{MALspecial2=${i18n_typeScholar}}}`); }

      if (MALTypeScout !== 0) { exec.push(`{{MALspecial2=${i18n_typeScout}}}`); }
      break;

    default:
      MALGoliath = 0;
      MALGhost = '';
      MALChangeling = '';
      MALTypeSoldier = '';
      MALTypeHunter = '';
      MALTypeHerald = '';
      MALTypeScholar = '';
      MALTypeScout = '';
  }

  autresEffets.push(`${i18n_lumiere} 2`);

  exec.push(`{{portee=${i18n_portee} ${portee}}}`);
  exec.push(`{{degats=[[${degats}]]}}`);
  exec.push(`{{violence=[[${violence}]]}}`);

  exec.push(`{{antiAnatheme=${i18n_antiAnatheme}}}`);
  exec.push(`{{antiAnathemeCondition=${i18n_antiAnathemeCondition}}}`);

  exec.push('{{degatsConditionnel=true}}');
  exec.push('{{violenceConditionnel=true}}');
  exec.push(`{{affecteAnathemeD=${i18n_affecteAnatheme}}}`);
  exec.push(`{{affecteAnathemeV=${i18n_affecteAnatheme}}}`);

  if (devaste || bourreau || equilibre) {
    const herauts = [];

    if (devaste) { herauts.push(i18n_devasterAnatheme); }
    if (bourreau) { herauts.push(i18n_bourreauTenebres); }
    if (equilibre) { herauts.push(i18n_equilibrerBalance); }

    exec.push(`{{herauts=${herauts.join(' / ')}}}`);
  }

  exec.push(`{{effets=${autresEffets.join(' / ')}}}`);

  // ROLL
  const finalRoll = await startRoll(exec.join(' '));

  const rDegats = finalRoll.results.degats.dice;
  const rViolence = finalRoll.results.violence.dice;

  const tDegats = finalRoll.results.degats.result;
  const tViolence = finalRoll.results.violence.result;

  const conditions = {
    bourreau,
    devaste,
    equilibre,
  };

  const computed = updateRoll(finalRoll, tDegats, rDegats, [], tViolence, rViolence, [], conditions);

  finishRoll(finalRoll.rollId, computed);
});
  /* eslint-disable camelcase */
/* eslint-disable no-undef */
on('clicked:simplePNJ', async (info) => {
  const roll = info.htmlAttributes.value;

  const listAttrs = [
    'jetModifDes',
    'aspectPNJ',
  ];

  const attrs = await getAttrsAsync(listAttrs);
  let attrsAspect = [];

  const exec = [];
  const isConditionnel = false;

  const mod = +attrs.jetModifDes;
  const aspect = attrs.aspectPNJ;

  const aspectNom = aspect.slice(2, -1);

  const aRoll = [];
  let aNom = '';

  const bonus = [];
  let AE = 0;

  exec.push(roll);

  if (aspect !== '0') {
    attrsAspect = await getAttrsAsync([
      aspectNom,
      `${aspectNom}PNJAE`,
      `${aspectNom}PNJAEMaj`,
    ]);

    const tAE = totalAspect(attrsAspect, aspectNom);

    aNom = AspectNom[aspectNom];
    aRoll.push(attrsAspect[aspectNom]);
    AE += tAE;

    exec.push(`{{vAE=${tAE}}}`);
  }

  exec.push(`{{cBase=${aNom}}}`);

  if (mod !== 0) {
    aRoll.push(mod);
    exec.push(`{{mod=[[${mod}]]}}`);
  }

  if (aRoll.length === 0) { aRoll.push(0); }

  bonus.push(AE);

  exec.push(`{{jet=[[ {[[{${aRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}} {{tBonus=[[${bonus.join('+')}+0]]}} {{Exploit=[[${aRoll.join('+')}]]}}`);

  if (isConditionnel === true) { exec.push('{{conditionnel=true}}'); }

  startRoll(exec.join(' '), (results) => {
    const tJet = results.results.jet.result;
    const tBonus = results.results.tBonus.result;
    const tExploit = results.results.Exploit.result;

    const total = tJet + tBonus;

    finishRoll(
      results.rollId,
      {
        jet: total,
      },
    );

    if (tJet !== 0 && tJet === tExploit) {
      startRoll(`${roll}@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${i18n_exploit}}} {{jet=[[ {[[{${aRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`, (exploit) => {
        const tExploit2 = exploit.results.jet.result;

        finishRoll(
          exploit.rollId,
          {
            jet: tExploit2,
          },
        );
      });
    }
  });
});
  /* eslint-disable max-len */
/* eslint-disable prefer-destructuring */
/* eslint-disable camelcase */
/* eslint-disable no-undef */
const rollCombatPNJContact = ['pSContactPNJ', 'mEContactPNJ', 'repeating_armeCaC:armecontactpnj'];

rollCombatPNJContact.forEach((button) => {
  on(`clicked:${button}`, async (info) => {
    const roll = info.htmlAttributes.value;

    let firstExec = [];
    let exec = [];

    let listAttrs = [
      'jetModifDes',
      'energiePNJ',
      'Chair',
      'Bete',
      'BetePNJAE',
      'BetePNJAEMaj',
      'Machine',
      'MachinePNJAE',
      'MachinePNJAEMaj',
      'Masque',
      'MasquePNJAE',
      'MasquePNJAEMaj',
      'capaciteFanMade',
      'attaqueOmbre',
    ];

    let prefix = '';
    let name = '';
    let id = '';

    let effets = [];
    let effetsValue = [];
    let AS = [];
    let AO = [];
    let special = [];
    let specialValue = [];

    let vBeteD = 0;

    let diceDegats = 0;
    let bDegats = 0;
    let addChair = 0;

    let diceViolence = 0;
    let bViolence = 0;

    let portee = '';

    let aspectValue = 0;
    let AEValue = 0;

    let isConditionnelA = false;
    let isConditionnelD = false;
    let isConditionnelV = false;

    const cRoll = [];
    let bonus = [];
    let autresEffets = [];
    let autresAmeliorationsS = [];
    let autresAmeliorationsO = [];
    const autresSpecial = [];

    let eASAssassin = '';
    let eASAssassinValue = 0;

    let isObliteration = false;
    let isTenebricide = false;

    let isAntiAnatheme = false;
    let isAssistanceAttaque = false;
    let isChoc = false;
    let isDestructeur = false;
    let isLeste = false;
    let isMeurtrier = false;
    let isOrfevrerie = false;
    let isSilencieux = false;

    let isFureur = false;
    let isUltraviolence = false;
    let isSurprise = false;

    let isCadence = false;
    let rCadence = '0';
    let vCadence = 0;

    let isChromee = false;

    let isArmeAzurine = false;
    let vArmeAzurine = 0;

    let isArmeRougeSang = false;
    let vArmeRougeSang = 0;

    let isCheneSculpte = false;
    let vCheneSculpte = 0;

    let isGriffureGravee = false;
    let vGriffureGravee = 0;

    let isMasqueBrise = false;
    let vMasqueBrise = 0;

    let isRouagesCasses = false;
    let vRouagesCasses = 0;

    let attaquesSurprises = [];
    let attaquesSurprisesValue = [];
    let attaquesSurprisesCondition = '';

    switch (button) {
      case 'pSContactPNJ':
        prefix = 'pSC';

        effets = wpnEffects.map((a) => `${prefix}${a}`);
        effetsValue = wpnEffectsValue.map((a) => `${prefix}${a}`);
        AS = wpnAmeliorationS.map((a) => `${prefix}${a}`);
        AO = wpnAmeliorationO.map((a) => `${prefix}${a}`);
        special = wpnSpecial.map((a) => `${prefix}${a}`);
        specialValue = wpnSpecialValue.map((a) => `${prefix}${a}`);

        name = `{{special1=${i18n_couteauService}}}`;

        diceDegats = 1;

        bViolence = 1;

        portee = '{{portee=^{portee} ^{portee-contact}}}';

        listAttrs.push('pSCAspectPNJ');
        listAttrs.push('pSCAddChair');

        listAttrs = listAttrs.concat(effets, effetsValue, AS, AO, special, specialValue);
        break;

      case 'mEContactPNJ':
        prefix = 'mEC';

        effets = wpnEffects.map((a) => `${prefix}${a}`);
        effetsValue = wpnEffectsValue.map((a) => `${prefix}${a}`);
        AS = wpnAmeliorationS.map((a) => `${prefix}${a}`);
        AO = wpnAmeliorationO.map((a) => `${prefix}${a}`);
        special = wpnSpecial.map((a) => `${prefix}${a}`);
        specialValue = wpnSpecialValue.map((a) => `${prefix}${a}`);

        name = `{{special1=${i18n_marteauEpieuC}}}`;

        diceDegats = 3;

        diceViolence = 1;

        portee = '{{portee=^{portee} ^{portee-contact}}}';

        listAttrs.push('mECAspectPNJ');
        listAttrs.push('mECAddChair');

        listAttrs = listAttrs.concat(effets, effetsValue, AS, AO, special, specialValue);
        break;

      case 'repeating_armeCaC:armecontactpnj':
        id = info.triggerName.split('_')[2];

        prefix = `repeating_armeCaC_${id}_`;

        effets = wpnEffects.map((a) => `${prefix}${a}`);
        effetsValue = wpnEffectsValue.map((a) => `${prefix}${a}`);
        AS = wpnAmeliorationS.map((a) => `${prefix}${a}`);
        AO = wpnAmeliorationO.map((a) => `${prefix}${a}`);
        special = wpnSpecial.map((a) => `${prefix}${a}`);
        specialValue = wpnSpecialValue.map((a) => `${prefix}${a}`);

        listAttrs.push(`${prefix}ArmeCaC`);
        listAttrs.push(`${prefix}AspectPNJ`);
        listAttrs.push(`${prefix}armeCaCPortee`);

        listAttrs.push(`${prefix}armeCaCDegat`);
        listAttrs.push(`${prefix}armeCaCBDegat`);
        listAttrs.push(`${prefix}addChair`);
        listAttrs.push(`${prefix}armeCaCViolence`);
        listAttrs.push(`${prefix}armeCaCBViolence`);

        listAttrs = listAttrs.concat(effets, effetsValue, AS, AO, special, specialValue);
        break;

      default:
        prefix = '';

        effets = [];
        effetsValue = [];
        AS = [];
        AO = [];
        special = [];
        specialValue = [];

        name = '';

        diceDegats = 0;

        diceViolence = 0;

        portee = '';

        listAttrs = listAttrs.concat(effets, effetsValue, AS, AO, special, specialValue);
        break;
    }

    const attrs = await getAttrsAsync(listAttrs);

    const capacitesFM = attrs.capaciteFanMade;
    const attaquesOmbres = attrs.attaqueOmbre;

    const mod = +attrs.jetModifDes;
    const energie = +attrs.energiePNJ;

    const vChair = +attrs.Chair;
    const vBete = +attrs.Bete;
    const vBeteAEMin = +attrs.BetePNJAE;
    const vBeteAEMaj = +attrs.BetePNJAEMaj;
    const vMachine = +attrs.Machine;
    const vMachineAE = totalAspect(attrs, 'Machine');
    const vMasque = +attrs.Masque;
    const vMasqueAE = totalAspect(attrs, 'Masque');

    const aBase = attrs[`${prefix}AspectPNJ`] || '0';
    let aspect = '0';

    if (button === 'repeating_armeCaC:armecontactpnj') {
      const dName = attrs[`${prefix}ArmeCaC`] || '';
      const dPortee = attrs[`${prefix}armeCaCPortee`] || '^{portee-contact}';

      name = `{{special1=${dName}}}`;
      portee = `{{portee=^{portee} ${dPortee}}}`;

      diceDegats = Number(attrs[`${prefix}armeCaCDegat`]) || 0;
      bDegats = Number(attrs[`${prefix}armeCaCBDegat`]) || 0;
      addChair = isApplied(attrs[`${prefix}addChair`]);

      diceViolence = Number(attrs[`${prefix}armeCaCViolence`]) || 0;
      bViolence = Number(attrs[`${prefix}armeCaCBViolence`]) || 0;
    } else { addChair = isApplied(attrs[`${prefix}AddChair`]); }

    firstExec.push(roll);
    exec.push(portee);
    exec.push(name);

    let attrsAspect = [];

    if (aBase !== '0') {
      aspect = aBase.slice(2, -1);

      attrsAspect = await getAttrsAsync([
        aspect,
        `${aspect}PNJAE`,
        `${aspect}PNJAEMaj`,
      ]);

      aspectValue = +attrsAspect[aspect];
      AEValue = totalAspect(attrsAspect, aspect);
      aspect = `{{cBase=${AspectNom[aspect]}}}`;

      cRoll.push(aspectValue);
      exec.push(aspect);
    }

    if (mod !== 0) {
      cRoll.push(mod);
      exec.push(`{{mod=[[${mod}]]}}`);
    }

    if (vChair > 0 && addChair === '1') {
      const vChairD = Math.ceil(vChair / 2);

      bDegats += vChairD;
      exec.push(`{{vChair=${vChairD}}}`);
    }

    // GESTION DES ASPECTS EXCEPTIONNELS

    if (vBeteAEMin > 0 || vBeteAEMaj > 0) {
      bDegats += vBeteAEMin;
      bDegats += vBeteAEMaj;

      vBeteD += vBeteAEMin;
      vBeteD += vBeteAEMaj;
    }

    if (vBeteAEMaj > 0) {
      bDegats += vBete;
      vBeteD += vBete;
    }

    if (vBeteD > 0) { exec.push(`{{vBeteD=${vBeteD}}}`); }

    // FIN GESTION DES ASPECTS EXCEPTIONNELS

    // GESTION DES EFFETS

    const rEffets = getWeaponsEffectsPNJ(prefix, attrs, addChair, vChair, vMachine, vMachineAE, vMasque, vMasqueAE);

    firstExec = firstExec.concat(rEffets.firstExec);
    exec = exec.concat(rEffets.exec);

    eASAssassin = rEffets.eASAssassin;
    eASAssassinValue = rEffets.eASAssassinValue;

    isObliteration = rEffets.isObliteration;
    isTenebricide = rEffets.isTenebricide;

    isAntiAnatheme = rEffets.isAntiAnatheme;
    isAssistanceAttaque = rEffets.isAssistanceAttaque;
    isChoc = rEffets.isChoc;
    isDestructeur = rEffets.isDestructeur;
    isLeste = rEffets.isLeste;
    isMeurtrier = rEffets.isMeurtrier;
    isOrfevrerie = rEffets.isOrfevrerie;
    isSilencieux = rEffets.isSilencieux;
    isUltraviolence = rEffets.isUltraviolence;
    isFureur = rEffets.isFureur;

    isCadence = rEffets.isCadence;
    rCadence = rEffets.rCadence || '0';
    vCadence = rEffets.vCadence;

    attaquesSurprises = attaquesSurprises.concat(rEffets.attaquesSurprises);
    attaquesSurprisesValue = attaquesSurprisesValue.concat(rEffets.attaquesSurprisesValue);
    attaquesSurprisesCondition = rEffets.attaquesSurprisesCondition;

    bDegats += Number(rEffets.bDegats);

    autresEffets = autresEffets.concat(rEffets.autresEffets);

    if (rEffets.isConditionnelA) { isConditionnelA = true; }

    if (rEffets.isConditionnelD) { isConditionnelD = true; }

    if (rEffets.isConditionnelV) { isConditionnelV = true; }

    if (attaquesOmbres !== '0' && capacitesFM !== '0') {
      isConditionnelD = true;

      attaquesSurprises.push(i18n_attaquesOmbres);
      attaquesSurprisesValue.push(vMasque);

      if (attaquesSurprisesCondition === '') { attaquesSurprisesCondition = `{{attaqueSurpriseCondition=${i18n_attaqueSurpriseCondition}}}`; }
    }

    // FIN GESTION DES EFFETS

    // GESTION DES AMELIORATIONS STRUCTURELLES

    const rAS = getWeaponsContactASPNJ(prefix, attrs, isAssistanceAttaque, isChoc, isLeste, isMeurtrier, isOrfevrerie, isSilencieux, vBete, vChair, vMasque, vMasqueAE);

    exec = exec.concat(rAS.exec);

    bonus = bonus.concat(rAS.bAttaque);
    diceDegats += Number(rAS.diceDegats);
    bDegats += Number(rAS.bDegats);

    attaquesSurprises = attaquesSurprises.concat(rAS.attaquesSurprises);
    attaquesSurprisesValue = attaquesSurprisesValue.concat(rAS.attaquesSurprisesValue);

    if (attaquesSurprisesCondition === '') { attaquesSurprisesCondition = rAS.attaquesSurprisesCondition; }

    autresAmeliorationsS = autresAmeliorationsS.concat(rAS.autresAmeliorations);

    if (rAS.isConditionnelA) { isConditionnelA = true; }

    if (rAS.isConditionnelD) { isConditionnelD = true; }

    if (rAS.isConditionnelV) { isConditionnelV = true; }

    // FIN GESTION DES AMELIORATIONS STRUCTURELLES

    // GESTION DES AMELIORATIONS ORNEMENTALLES
    const rAO = getWeaponsContactAOPNJ(prefix, attrs, isCadence, vCadence, isObliteration, isAntiAnatheme);

    firstExec = firstExec.concat(rAO.firstExec);
    exec = exec.concat(rAO.exec);

    diceDegats += Number(rAO.diceDegats);
    bDegats += Number(rAO.bDegats);

    diceViolence += rAO.diceViolence;

    if (rAO.vCadence > 0) {
      isCadence = false;
      rCadence = rAO.rCadence;
      vCadence = rAO.vCadence;
    }

    if (rAO.isObliteration) { isObliteration = true; }

    isChromee = rAO.isChromee;
    isCraneRieur = rAO.isCraneRieur;

    isArmeAzurine = rAO.isArmeAzurine;
    vArmeAzurine = rAO.vArmeAzurine;

    isArmeRougeSang = rAO.isArmeRougeSang;
    vArmeRougeSang = rAO.vArmeRougeSang;

    isCheneSculpte = rAO.isCheneSculpte;
    vCheneSculpte = rAO.vCheneSculpte;

    isGriffureGravee = rAO.isGriffureGravee;
    vGriffureGravee = rAO.vGriffureGravee;

    isMasqueBrise = rAO.isMasqueBrise;
    vMasqueBrise = rAO.vMasqueBrise;

    isRouagesCasses = rAO.isRouagesCasses;
    vRouagesCasses = rAO.vRouagesCasses;

    autresAmeliorationsO = autresAmeliorationsO.concat(rAO.autresAmeliorations);

    if (rAO.isConditionnelA) { isConditionnelA = true; }

    if (rAO.isConditionnelD) { isConditionnelD = true; }

    if (rAO.isConditionnelV) { isConditionnelV = true; }

    // FIN GESTION DES AMELIORATIONS ORNEMENTALLES

    // GESTION DES BONUS SPECIAUX

    const sBonusDegats = isApplied(attrs[`${prefix}BDDiversTotal`]);
    const sBonusDegatsD6 = attrs[`${prefix}BDDiversD6`];
    const sBonusDegatsFixe = attrs[`${prefix}BDDiversFixe`];

    const sBonusViolence = isApplied(attrs[`${prefix}BVDiversTotal`]);
    const sBonusViolenceD6 = attrs[`${prefix}BVDiversD6`];
    const sBonusViolenceFixe = attrs[`${prefix}BVDiversFixe`];

    const sEnergie = isApplied(attrs[`${prefix}energie`]);
    const sEnergieValue = attrs[`${prefix}energieValue`];
    let sEnergieText = '';
    let pasEnergie = false;
    let newEnergie = 0;

    if (sBonusDegats) {
      exec.push(`{{vMSpecialD=+${sBonusDegatsD6}D6+${sBonusDegatsFixe}}}`);
      diceDegats += Number(sBonusDegatsD6);
      bDegats += Number(sBonusDegatsFixe);
    }

    if (sBonusViolence) {
      exec.push(`{{vMSpecialV=+${sBonusViolenceD6}D6+${sBonusViolenceFixe}}}`);
      diceViolence += Number(sBonusViolenceD6);
      bViolence += Number(sBonusViolenceFixe);
    }

    if (sEnergie) {
      autresSpecial.push(`${i18n_energieRetiree} (${sEnergieValue})`);

      newEnergie = Number(energie) - Number(sEnergieValue);

      if (newEnergie === 0) {
        sEnergieText = i18n_plusEnergie;
      } else if (newEnergie < 0) {
        newEnergie = 0;
        sEnergieText = i18n_pasEnergie;
        pasEnergie = true;
      }

      exec.push(`{{energieR=${newEnergie}}}`);
    }

    // FIN DE GESTION DES BONUS SPECIAUX

    if (cRoll.length === 0) { cRoll.push(0); }

    const jet = `{{jet=[[ {{[[{${cRoll.join('+')}-${rCadence}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0}]]}}`;
    firstExec.push(jet);

    bonus.push(AEValue);

    exec.push(`{{vAE=${AEValue}}}`);
    exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);
    exec.push(`{{bonus=[[${bonus.join('+')}]]}}`);

    if (diceDegats < 0) { diceDegats = 0; }

    if (diceViolence < 0) { diceViolence = 0; }

    firstExec.push(`{{degats=[[${diceDegats}D6+${bDegats}]]}}`);
    firstExec.push(`{{violence=[[${diceViolence}D6+${bViolence}]]}}`);

    if (isCadence) {
      exec.push(`{{rCadence=${i18n_cadence} ${vCadence} ${i18n_inclus}}}`);
      exec.push(`{{vCadence=${sCadence}D}}`);
    }

    if (isChromee) {
      exec.push(`{{rCadence=${i18n_chromee} (${i18n_cadence} ${vCadence}) ${i18n_inclus}}}`);
      exec.push(`{{vCadence=${rCadence}D}}`);
    }

    if (isObliteration) {
      let ASObliteration = [];
      let ASValueObliteration = [];

      const diceDegatsObliteration = diceDegats * 6;

      const vObliteration = diceDegatsObliteration + bDegats;

      exec.push(`{{obliterationValue=${vObliteration}}}`);

      if (isMeurtrier) { exec.push(`{{obliterationMeurtrierValue=${2 * 6}}}`); }

      if (isDestructeur) { exec.push(`{{obliterationDestructeurValue=${2 * 6}}}`); }

      if (eASAssassinValue > 0) {
        const eAssassinObliterationValue = eASAssassinValue * 6;

        ASObliteration.unshift(eASAssassin);
        ASValueObliteration.unshift(eAssassinObliterationValue);

        if (attaquesSurprises.length > 0) {
          ASObliteration = ASObliteration.concat(attaquesSurprises);
          ASValueObliteration = ASValueObliteration.concat(attaquesSurprisesValue);
        }

        exec.push(`{{obliterationAS=${ASObliteration.join('\n+')}}}`);
        exec.push(`{{obliterationASValue=${_.reduce(ASValueObliteration, (n1, n2) => n1 + n2, 0)}}}`);
      } else if (attaquesSurprises.length > 0) {
        ASObliteration = ASObliteration.concat(attaquesSurprises);
        ASValueObliteration = ASValueObliteration.concat(attaquesSurprisesValue);

        exec.push(`{{obliterationAS=${ASTenebricide.join('\n+')}}}`);
        exec.push(`{{obliterationASValue=${_.reduce(ASValueObliteration, (n1, n2) => n1 + n2, 0)}}}`);
      }

      if (isArmeAzurine) { exec.push(`{{obliterationArmeAzurineValue=${vArmeAzurine * 6}}}`); }

      if (isArmeRougeSang) { exec.push(`{{obliterationArmeRougeSangValue=${vArmeRougeSang * 6}}}`); }

      if (isCheneSculpte) { exec.push(`{{obliterationCheneSculpteValue=${vCheneSculpte * 6}}}`); }

      if (isGriffureGravee) { exec.push(`{{obliterationGriffureGraveeValue=${vGriffureGravee * 6}}}`); }

      if (isMasqueBrise) { exec.push(`{{obliterationMasqueBriseValue=${vMasqueBrise * 6}}}`); }

      if (isRouagesCasses) { exec.push(`{{obliterationRouagesCassesValue=${vRouagesCasses * 6}}}`); }
    }

    if (eASAssassinValue > 0) {
      attaquesSurprises.unshift(eASAssassin);
      attaquesSurprisesValue.unshift(`${eASAssassinValue}D6`);
    }

    if (attaquesSurprises.length > 0) {
      exec.push(`{{attaqueSurprise=${attaquesSurprises.join('\n+')}}}`);
      exec.push(`{{attaqueSurpriseValue=[[${attaquesSurprisesValue.join('+')}]]}}`);
      exec.push(attaquesSurprisesCondition);

      isSurprise = true;
    }

    if (isTenebricide) {
      exec.push(`{{tenebricide=${i18n_tenebricide}}} {{tenebricideConditionD=${i18n_tenebricideConditionD}}} {{tenebricideConditionV=${i18n_tenebricideConditionV}}}`);
      exec.push('{{tenebricideValueD=[[0]]}}');
      exec.push('{{tenebricideValueV=[[0]]}}');

      if (attaquesSurprises.length > 0) {
        exec.push(`{{tenebricideAS=${attaquesSurprises.join('\n+')}}}`);
        exec.push('{{tenebricideASValue=[[0]]}}');
      }

      if (isMeurtrier) { firstExec.push('{{tMeurtrierValue=[[0]]}}'); }
      if (isDestructeur) { firstExec.push('{{tDestructeurValue=[[0]]}}'); }
      if (isFureur) { firstExec.push('{{tFureurValue=[[0]]}}'); }
      if (isUltraviolence) { firstExec.push('{{tUltraviolenceValue=[[0]]}}'); }
      if (isCheneSculpte) { firstExec.push('{{tCheneSculpteValue=[[0]]}}'); }
    }

    if (autresEffets.length > 0) {
      autresEffets.sort();
      exec.push(`{{effets=${autresEffets.join(' / ')}}}`);
    }

    if (autresAmeliorationsS.length > 0) {
      autresAmeliorationsS.sort();
      exec.push(`{{ameliorationsS=${autresAmeliorationsS.join(' / ')}}}`);
    }

    if (autresAmeliorationsO.length > 0) {
      autresAmeliorationsO.sort();
      exec.push(`{{ameliorationsO=${autresAmeliorationsO.join(' / ')}}}`);
    }

    if (autresSpecial.length > 0) {
      autresSpecial.sort();
      exec.push(`{{special=${autresSpecial.join(' / ')}}}`);
    }

    if (isConditionnelA) { exec.push('{{succesConditionnel=true}}'); }

    if (isConditionnelD) { exec.push('{{degatsConditionnel=true}}'); }

    if (isConditionnelV) { exec.push('{{violenceConditionnel=true}}'); }

    firstExec = firstExec.concat(exec);

    // ROLL
    let finalRoll;

    if (pasEnergie === false) {
      finalRoll = await startRoll(firstExec.join(' '));

      const rDegats = finalRoll.results.degats.dice;
      const rViolence = finalRoll.results.violence.dice;

      const tJet = finalRoll.results.jet.result;

      const tBonus = finalRoll.results.bonus.result;
      const tExploit = finalRoll.results.Exploit.result;

      const tDegats = finalRoll.results.degats.result;
      const tViolence = finalRoll.results.violence.result;

      const conditions = {
        isTenebricide,
        isSurprise,
        isDestructeur,
        isFureur,
        isMeurtrier,
        isUltraviolence,
        isArmeAzurine,
        isArmeRougeSang,
        isCheneSculpte,
        isGriffureGravee,
        isMasqueBrise,
        isRouagesCasses,
      };

      const computed = updateRoll(finalRoll, tDegats, rDegats, [bDegats], tViolence, rViolence, [bViolence], conditions);

      const finalComputed = {
        jet: tJet + tBonus,
      };

      Object.assign(finalComputed, computed);

      finishRoll(finalRoll.rollId, finalComputed);

      if (tJet !== 0 && tJet === tExploit) {
        const exploitRoll = await startRoll(`${roll}@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${i18n_exploit}}}${jet}`);
        const tRExploit = exploitRoll.results.jet.result;

        const exploitComputed = {
          jet: tRExploit,
        };

        finishRoll(exploitRoll.rollId, exploitComputed);
      }

      if (sEnergie !== false) {
        setAttrs({
          energiePNJ: newEnergie,
        });

        if (newEnergie === 0) {
          const noEnergieRoll = await startRoll(`@{jetGM} &{template:simple} {{Nom=@{name}}} {{text=${sEnergieText}}}${name}`);
          finishRoll(noEnergieRoll.rollId, {});
        }
      }
    } else if (button === 'repeating_armeCaC:armecontactpnj') {
      finalRoll = await startRoll(`@{jetGM} &{template:simple} {{Nom=@{name}}} {{text=${sEnergieText}}}${name}`);
      finishRoll(finalRoll.rollId, {});
    } else {
      finalRoll = await startRoll(`@{jetGM} &{template:simple} {{Nom=@{name}}} {{text=${sEnergieText}}}${name}`);
      finishRoll(finalRoll.rollId, {});
    }
  });
});
  /* eslint-disable max-len */
/* eslint-disable prefer-destructuring */
/* eslint-disable camelcase */
/* eslint-disable no-undef */
const rollCombatDistancePNJ = ['pSDistancePNJ', 'mEDistancePNJ', 'repeating_armeDist:armedistancepnj'];

rollCombatDistancePNJ.forEach((button) => {
  on(`clicked:${button}`, async (info) => {
    const roll = info.htmlAttributes.value;

    let firstExec = [];
    let exec = [];
    firstExec.push(roll);

    let listAttrs = [
      'jetModifDes',
      'energiePNJ',
      'Chair',
      'Bete',
      'BetePNJAE',
      'BetePNJAEMaj',
      'Machine',
      'MachinePNJAE',
      'MachinePNJAEMaj',
      'Masque',
      'MasquePNJAE',
      'MasquePNJAEMaj',
      'capaciteFanMade',
      'attaqueOmbre',
    ];

    let prefix = '';
    let id = '';
    let name = '';
    let portee = '';

    let dEffets = [];
    let dEffetsValue = [];
    let AA = [];
    let AAValue = [];
    let special = [];
    let specialValue = [];

    let AE = 0;

    let diceDegats = 0;
    let diceViolence = 0;

    let bDegats = 0;
    let bViolence = 0;

    switch (button) {
      case 'pSDistancePNJ':
        name = i18n_pistoletService;

        prefix = 'pS';

        dEffets = wpnEffects.map((a) => `${prefix}${a}`);
        dEffetsValue = wpnEffectsValue.map((a) => `${prefix}${a}`);
        AA = wpnAmeliorationA.map((a) => `${prefix}${a}`);
        AAValue = wpnAmeliorationAValue.map((a) => `${prefix}${a}`);
        special = wpnSpecial.map((a) => `${prefix}${a}`);
        specialValue = wpnSpecialValue.map((a) => `${prefix}${a}`);

        listAttrs.push('pSAspectPNJ');

        diceDegats = 2;
        bDegats = 6;

        diceViolence = 1;

        listAttrs = listAttrs.concat(dEffets, dEffetsValue, AA, AAValue, special, specialValue);
        break;

      case 'mEDistancePNJ':
        name = i18n_marteauEpieuD;

        prefix = 'mE';

        dEffets = wpnEffects.map((a) => `${prefix}${a}`);
        dEffetsValue = wpnEffectsValue.map((a) => `${prefix}${a}`);
        AA = wpnAmeliorationA.map((a) => `${prefix}${a}`);
        AAValue = wpnAmeliorationAValue.map((a) => `${prefix}${a}`);
        special = wpnSpecial.map((a) => `${prefix}${a}`);
        specialValue = wpnSpecialValue.map((a) => `${prefix}${a}`);

        listAttrs.push('mEAspectPNJ');

        diceDegats = 3;
        bDegats = 12;

        diceViolence = 3;
        bViolence = 12;

        listAttrs = listAttrs.concat(dEffets, dEffetsValue, AA, AAValue, special, specialValue);
        break;

      case 'repeating_armeDist:armedistancepnj':
        id = info.triggerName.split('_')[2];

        prefix = `repeating_armeDist_${id}_`;

        dEffets = wpnEffects.map((a) => `${prefix}${a}`);
        dEffetsValue = wpnEffectsValue.map((a) => `${prefix}${a}`);
        AA = wpnAmeliorationA.map((a) => `${prefix}${a}`);
        AAValue = wpnAmeliorationAValue.map((a) => `${prefix}${a}`);
        special = wpnSpecial.map((a) => `${prefix}${a}`);
        specialValue = wpnSpecialValue.map((a) => `${prefix}${a}`);

        listAttrs.push(`${prefix}AspectPNJ`);
        listAttrs.push(`${prefix}ArmeDist`);
        listAttrs.push(`${prefix}armeDistPortee`);

        listAttrs.push(`${prefix}armeDistDegat`);
        listAttrs.push(`${prefix}armeDistBDegat`);

        listAttrs.push(`${prefix}armeDistViolence`);
        listAttrs.push(`${prefix}armeDistBViolence`);

        listAttrs = listAttrs.concat(dEffets, dEffetsValue, AA, AAValue, special, specialValue);
        break;

      case 'repeating_armeDistVehicule:armedistancepnj':
        id = info.triggerName.split('_')[2];

        prefix = `repeating_armeDistVehicule_${id}_`;

        dEffets = wpnEffects.map((a) => `${prefix}${a}`);
        dEffetsValue = wpnEffectsValue.map((a) => `${prefix}${a}`);
        AA = wpnAmeliorationA.map((a) => `${prefix}${a}`);
        AAValue = wpnAmeliorationAValue.map((a) => `${prefix}${a}`);
        special = wpnSpecial.map((a) => `${prefix}${a}`);
        specialValue = wpnSpecialValue.map((a) => `${prefix}${a}`);

        listAttrs.push(`${prefix}aspectPNJ`);
        listAttrs.push(`${prefix}ArmeDist`);
        listAttrs.push(`${prefix}armeDistPortee`);

        listAttrs.push(`${prefix}armeDistDegat`);
        listAttrs.push(`${prefix}armeDistBDegat`);

        listAttrs.push(`${prefix}armeDistViolence`);
        listAttrs.push(`${prefix}armeDistBViolence`);

        listAttrs = listAttrs.concat(dEffets, dEffetsValue, AA, AAValue, special, specialValue);
        break;

      default:
        name = '';

        prefix = '';

        dEffets = [];
        dEffetsValue = [];
        AA = [];
        AAValue = [];
        special = [];
        specialValue = [];

        diceDegats = 0;
        bDegats = 0;

        diceViolence = 0;

        listAttrs = listAttrs.concat(dEffets, dEffetsValue, AA, AAValue, special, specialValue);
        break;
    }

    const attrs = await getAttrsAsync(listAttrs);
    let attrsAspect = [];

    const vChair = +attrs.Chair;
    const vMachine = +attrs.Machine;
    const vMachineAE = totalAspect(attrs, 'Machine');
    const vMasque = +attrs.Masque;
    const vMasqueAE = totalAspect(attrs, 'Masque');

    let aspect = attrs[`${prefix}AspectPNJ`] || '0';

    if (button === 'repeating_armeDist:armedistancepnj' || button === 'repeating_armeDistVehicule:armedistancepnj') {
      const dName = attrs[`${prefix}ArmeDist`] || '';
      const dPortee = attrs[`${prefix}armeDistPortee`] || '^{portee-contact}';

      name = `{{special1=${dName}}}`;
      portee = `{{portee=^{portee} ${dPortee}}}`;

      diceDegats = Number(attrs[`${prefix}armeDistDegat`]) || 0;
      bDegats = Number(attrs[`${prefix}armeDistBDegat`]) || 0;

      diceViolence = Number(attrs[`${prefix}armeDistViolence`]) || 0;
      bViolence = Number(attrs[`${prefix}armeDistBViolence`]) || 0;

      exec.push(name);
      exec.push(portee);
    }

    let isConditionnelA = false;
    let isConditionnelD = false;
    let isConditionnelV = false;

    const cBase = [];
    const cRoll = [];
    let bonus = [];

    const mod = +attrs.jetModifDes;

    let aspectNom = '';
    let AEValue = 0;

    let attaquesSurprises = [];
    let attaquesSurprisesValue = [];
    let attaquesSurprisesCondition = '';

    const capacitesFM = attrs.capaciteFanMade;
    const attaquesOmbres = attrs.attaqueOmbre;

    let eASAssassin = '';
    let eASAssassinValue = 0;

    let isAssistantAttaque = false;
    let isAntiAnatheme = false;
    let isCadence = false;
    let sCadence = 0;
    let vCadence = 0;
    let isDestructeur = false;
    let isMeurtrier = false;
    let nowSilencieux = false;
    let isObliteration = false;
    let isTenebricide = false;
    let isTirRafale = false;
    let isChambreDouble = false;
    let isSurprise = false;
    let isUltraviolence = false;
    let isFureur = false;

    let pasEnergie = false;
    let sEnergieText = '';
    const energie = attrs.energiePNJ;

    let autresEffets = [];
    let autresAmeliorationsA = [];
    const autresSpecial = [];

    if (aspect !== '0') {
      aspectNom = aspect.slice(2, -1);

      attrsAspect = await getAttrsAsync([
        aspectNom,
        `${aspectNom}PNJAE`,
        `${aspectNom}PNJAEMaj`,
      ]);

      aspectValue = +attrsAspect[aspectNom];
      AEValue = totalAspect(attrsAspect, aspectNom);
      aspect = `{{cBase=${AspectNom[aspectNom]}}}`;

      cRoll.push(aspectValue);
      AE += AEValue;
      exec.push(aspect);
      exec.push(`{{vAE=${AEValue}}}`);
    }

    if (mod !== 0) {
      cRoll.push(mod);
      exec.push(`{{mod=${mod}}}`);
    }

    // GESTION DES EFFETS
    const effets = getWeaponsEffectsPNJ(prefix, attrs, false, vChair, vMachine, vMachineAE, vMasque, vMasqueAE);

    bDegats += Number(effets.bDegats);
    eASAssassin = effets.eASAssassin;
    eASAssassinValue = effets.eASAssassinValue;

    if (attaquesSurprisesCondition === '' && effets.attaquesSurprisesCondition !== '') { attaquesSurprisesCondition = effets.attaquesSurprisesCondition; }

    attaquesSurprises = attaquesSurprises.concat(effets.attaquesSurprises);
    attaquesSurprisesValue = attaquesSurprisesValue.concat(effets.attaquesSurprisesValue);

    autresEffets = autresEffets.concat(effets.autresEffets);

    isAntiAnatheme = effets.isAntiAnatheme;

    isAssistantAttaque = effets.isAssistantAttaque;

    isCadence = effets.isCadence;
    sCadence = effets.sCadence;
    vCadence = effets.vCadence;

    isDestructeur = effets.isDestructeur;
    vDestructeur = effets.vDestructeur;

    isLeste = effets.isLeste;

    isMeurtrier = effets.isMeurtrier;
    vMeurtrier = effets.vMeurtrier;

    nowSilencieux = effets.isSilencieux;

    isTenebricide = effets.isTenebricide;

    isObliteration = effets.isObliteration;
    isTirRafale = effets.isTirRafale;

    isFureur = effets.isFureur;
    isUltraviolence = effets.isUltraviolence;

    if (isLeste) {
      bDegats += Math.ceil(vChair / 2);
      exec.push(`{{vLeste=${vChair}}}`);
    }

    if (effets.isConditionnelA) { isConditionnelA = true; }

    if (effets.isConditionnelD) { isConditionnelD = true; }

    if (effets.isConditionnelV) { isConditionnelV = true; }

    if (attaquesOmbres !== '0' && capacitesFM !== '0') {
      isConditionnelD = true;

      attaquesSurprises.push(i18n_attaquesOmbres);
      attaquesSurprisesValue.push(vMasque);

      if (attaquesSurprisesCondition === '') { attaquesSurprisesCondition = `{{attaqueSurpriseCondition=${i18n_attaqueSurpriseCondition}}}`; }
    }

    // FIN GESTION DES EFFETS

    // GESTION DES AMELIORATIONS D'ARMES

    const ameliorationsA = getWeaponsDistanceAAPNJ(prefix, attrs, vMasque, vMasqueAE, isAssistantAttaque, eASAssassinValue, isCadence, vCadence, nowSilencieux, isTirRafale, isObliteration, isAntiAnatheme);

    exec = exec.concat(ameliorationsA.exec);

    bonus = bonus.concat(ameliorationsA.bonus);

    diceDegats += ameliorationsA.diceDegats;
    diceViolence += ameliorationsA.diceViolence;

    bDegats += Number(ameliorationsA.bDegats);

    attaquesSurprises = attaquesSurprises.concat(ameliorationsA.attaquesSurprises);
    attaquesSurprisesValue = attaquesSurprisesValue.concat(ameliorationsA.attaquesSurprisesValue);

    if (attaquesSurprisesCondition === '') { attaquesSurprisesCondition = ameliorationsA.attaquesSurprisesCondition; }

    if (ameliorationsA.isChambreDouble) {
      isCadence = false;
      isChambreDouble = ameliorationsA.isChambreDouble;
      sCadence = ameliorationsA.rChambreDouble;
    }

    autresEffets = autresEffets.concat(ameliorationsA.autresEffets);
    autresAmeliorationsA = autresAmeliorationsA.concat(ameliorationsA.autresAmeliorations);

    if (ameliorationsA.aASAssassin !== '') {
      eASAssassin = ameliorationsA.aASAssassin;
      eASAssassinValue = ameliorationsA.aASAssassinValue;
    }

    if (ameliorationsA.isConditionnelA) { isConditionnelA = true; }

    if (ameliorationsA.isConditionnelD) { isConditionnelD = true; }

    if (ameliorationsA.isConditionnelV) { isConditionnelV = true; }

    // FIN GESTION DES AMELIORATIONS D'ARMES

    // GESTION DES BONUS SPECIAUX

    const sBonusDegats = isApplied(attrs[`${prefix}BDDiversTotal`]);
    const sBonusDegatsD6 = attrs[`${prefix}BDDiversD6`];
    const sBonusDegatsFixe = attrs[`${prefix}BDDiversFixe`];

    const sBonusViolence = isApplied(attrs[`${prefix}BVDiversTotal`]);
    const sBonusViolenceD6 = attrs[`${prefix}BVDiversD6`];
    const sBonusViolenceFixe = attrs[`${prefix}BVDiversFixe`];

    const sEnergie = isApplied(attrs[`${prefix}energie`]);
    const sEnergieValue = attrs[`${prefix}energieValue`];
    let newEnergie = 0;

    if (sBonusDegats) {
      exec.push(`{{vMSpecialD=+${sBonusDegatsD6}D6+${sBonusDegatsFixe}}}`);
      diceDegats += Number(sBonusDegatsD6);
      bDegats += Number(sBonusDegatsFixe);
    }

    if (sBonusViolence) {
      exec.push(`{{vMSpecialV=+${sBonusViolenceD6}D6+${sBonusViolenceFixe}}}`);
      diceViolence += Number(sBonusViolenceD6);
      bViolence += Number(sBonusViolenceFixe);
    }

    if (sEnergie) {
      autresSpecial.push(`${i18n_energieRetiree} (${sEnergieValue})`);

      newEnergie = Number(energie) - Number(sEnergieValue);

      if (newEnergie === 0) {
        sEnergieText = i18n_plusEnergie;
      } else if (newEnergie < 0) {
        newEnergie = 0;
        sEnergieText = i18n_pasEnergie;
        pasEnergie = true;
      }

      exec.push(`{{energieR=${newEnergie}}}`);
    }

    // FIN DE GESTION DES BONUS SPECIAUX

    if (cRoll.length === 0) { cRoll.push(0); }

    if (bonus.length === 0) { bonus.push(0); }

    bonus.push(AE);

    if (cBase.length !== 0) { exec.push(`{{cBase=${cBase.join(' - ')}}}`); }

    const jet = `{{jet=[[ {{[[{${cRoll.join('+')}-${sCadence}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0}]]}}`;

    firstExec.push(jet);
    exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);
    exec.push(`{{bonus=[[${bonus.join('+')}]]}}`);

    if (diceDegats < 0) { diceDegats = 0; }

    if (diceViolence < 0) { diceViolence = 0; }

    exec.push(`{{degats=[[${diceDegats}D6+${bDegats}]]}}`);
    exec.push(`{{violence=[[${diceViolence}D6+${bViolence}]]}}`);

    if (isObliteration) {
      let ASObliteration = [];
      let ASValueObliteration = [];

      diceDegatsObliteration = diceDegats * 6;

      degatsFObliteration = bDegats;

      const vObliteration = diceDegatsObliteration + degatsFObliteration;

      exec.push(`{{obliterationValue=${vObliteration}}}`);

      if (isMeurtrier) { exec.push(`{{obliterationMeurtrierValue=${2 * 6}}}`); }

      if (isDestructeur) { exec.push(`{{obliterationDestructeurValue=${2 * 6}}}`); }

      if (eASAssassinValue > 0) {
        eAssassinTenebricideValue = eASAssassinValue * 6;

        ASObliteration.unshift(eASAssassin);
        ASValueObliteration.unshift(eAssassinTenebricideValue);

        if (attaquesSurprises.length > 0) {
          ASObliteration = ASObliteration.concat(attaquesSurprises);
          ASValueObliteration = ASValueObliteration.concat(attaquesSurprisesValue);
        }

        exec.push(`{{obliterationAS=${ASObliteration.join('\n+')}}}`);
        exec.push(`{{obliterationASValue=${_.reduce(ASValueObliteration, (n1, n2) => n1 + n2, 0)}}}`);
      } else if (attaquesSurprises.length > 0) {
        ASObliteration = ASObliteration.concat(attaquesSurprises);
        ASValueObliteration = ASValueObliteration.concat(attaquesSurprisesValue);

        exec.push(`{{obliterationAS=${ASTenebricide.join('\n+')}}}`);
        exec.push(`{{obliterationASValue=${_.reduce(ASValueObliteration, (n1, n2) => n1 + n2, 0)}}}`);
      }
    }

    if (isCadence) {
      exec.push(`{{rCadence=${i18n_cadence} ${vCadence} ${i18n_inclus}}}`);
      exec.push(`{{vCadence=${sCadence}D}}`);
    }

    if (isChambreDouble) {
      exec.push(`{{rCadence=${i18n_chambreDouble} (${i18n_cadence} 2) ${i18n_inclus}}}`);
      exec.push(`{{vCadence=${sCadence}D}}`);
    }

    if (eASAssassinValue > 0) {
      attaquesSurprises.unshift(eASAssassin);
      attaquesSurprisesValue.unshift(`${eASAssassinValue}D6`);
    }

    if (attaquesSurprises.length > 0) {
      isSurprise = true;

      exec.push(`{{attaqueSurprise=${attaquesSurprises.join('\n+')}}}`);
      exec.push(`{{attaqueSurpriseValue=[[${attaquesSurprisesValue.join('+')}]]}}`);
      exec.push(attaquesSurprisesCondition);
    }

    if (isTenebricide) {
      exec.push(`{{tenebricide=${i18n_tenebricide}}} {{tenebricideConditionD=${i18n_tenebricideConditionD}}} {{tenebricideConditionV=${i18n_tenebricideConditionV}}}`);
      exec.push('{{tenebricideValueD=[[0]]}}');
      exec.push('{{tenebricideValueV=[[0]]}}');

      if (attaquesSurprises.length > 0) {
        exec.push(`{{tenebricideAS=${attaquesSurprises.join('\n+')}}}`);
        exec.push('{{tenebricideASValue=[[0]]}}');
      }

      if (isMeurtrier) { firstExec.push('{{tMeurtrierValue=[[0]]}}'); }
      if (isDestructeur) { firstExec.push('{{tDestructeurValue=[[0]]}}'); }
      if (isFureur) { firstExec.push('{{tFureurValue=[[0]]}}'); }
      if (isUltraviolence) { firstExec.push('{{tUltraviolenceValue=[[0]]}}'); }
    }

    if (autresEffets.length > 0) {
      autresEffets.sort();
      exec.push(`{{effets=${autresEffets.join(' / ')}}}`);
    }

    if (autresAmeliorationsA.length > 0) {
      autresAmeliorationsA.sort();
      exec.push(`{{ameliorations=${autresAmeliorationsA.join(' / ')}}}`);
    }

    if (autresSpecial.length > 0) {
      autresSpecial.sort();
      exec.push(`{{special=${autresSpecial.join(' / ')}}}`);
    }

    if (isConditionnelA) { exec.push('{{succesConditionnel=true}}'); }

    if (isConditionnelD) { exec.push('{{degatsConditionnel=true}}'); }

    if (isConditionnelV) { exec.push('{{violenceConditionnel=true}}'); }

    if (effets.exec) { exec = exec.concat(effets.exec); }

    if (effets.firstExec) { firstExec = firstExec.concat(effets.firstExec); }

    exec = firstExec.concat(exec);

    // ROLL
    let finalRoll;

    if (pasEnergie === false) {
      finalRoll = await startRoll(exec.join(' '));
      const tJet = finalRoll.results.jet.result;

      const tBonus = finalRoll.results.bonus.result;
      const tExploit = finalRoll.results.Exploit.result;

      const rDegats = finalRoll.results.degats.dice;
      const rViolence = finalRoll.results.violence.dice;

      const tDegats = finalRoll.results.degats.result;
      const tViolence = finalRoll.results.violence.result;

      const conditions = {
        isTenebricide,
        isSurprise,
        isDestructeur,
        isFureur,
        isMeurtrier,
        isUltraviolence,
      };

      const computed = updateRoll(finalRoll, tDegats, rDegats, [bDegats], tViolence, rViolence, [bViolence], conditions);

      const finalComputed = {
        jet: tJet + tBonus,
      };

      Object.assign(finalComputed, computed);

      finishRoll(finalRoll.rollId, finalComputed);

      if (tJet !== 0 && tJet === tExploit) {
        const exploitRoll = await startRoll(`${roll}@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${i18n_exploit}}}${jet}`);
        const tRExploit = exploitRoll.results.jet.result;
        const exploitComputed = {
          jet: tRExploit,
        };

        finishRoll(exploitRoll.rollId, exploitComputed);
      }

      if (sEnergie !== false) {
        setAttrs({
          energiePNJ: newEnergie,
        });

        if (newEnergie === 0) {
          const noEnergieRoll = await startRoll(`@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${name}}} {{text=${sEnergieText}}}`);
          finishRoll(noEnergieRoll.rollId, {});
        }
      }
    } else {
      finalRoll = await startRoll(`@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${name}}} {{text=${sEnergieText}}}`);
      finishRoll(finalRoll.rollId, {});
    }
  });
});
  /* eslint-disable max-len */
/* eslint-disable prefer-destructuring */
/* eslint-disable camelcase */
/* eslint-disable no-undef */

const rollCombatGrenadePNJ = ['grenade1PNJ', 'grenade2PNJ', 'grenade3PNJ', 'grenade4PNJ', 'grenade5PNJ'];

rollCombatGrenadePNJ.forEach((button) => {
  on(`clicked:${button}`, async (info) => {
    const roll = info.htmlAttributes.value;

    let hasDgts = true;

    if (button === 'grenade2' || button === 'grenade4') { hasDgts = false; }

    const firstExec = [];
    let exec = [];
    firstExec.push(roll);

    let isConditionnelA = false;
    let isConditionnelD = false;
    let isConditionnelV = false;

    const cBase = [];
    const cRoll = [];
    const bonus = [];

    let AE = 0;

    let ameliorations = false;
    let isSurprise = false;
    let isDestructeur = false;
    let isMeurtrier = false;
    let isUltraviolence = false;

    let diceDegats = 3;
    let diceViolence = 3;

    const bDegats = 0;
    const bViolence = 0;

    const listAttrs = [
      'jetModifDes',
      'aspectPNJGrenade',
      'Masque',
      'capaciteFanMade',
      'attaqueOmbre',
      'grenadeAvancee',
    ];

    const attrs = await getAttrsAsync(listAttrs);
    let attrsAspect = [];

    const mod = +attrs.jetModifDes;

    if (attrs.grenadeAvancee !== '0') { ameliorations = true; }

    const vMasque = +attrs.Masque;

    const aspect = attrs.aspectPNJGrenade || '0';

    let aspectNom = '';

    const attaquesSurprises = [];
    const attaquesSurprisesValue = [];
    let attaquesSurprisesCondition = '';

    const capacitesFM = attrs.capaciteFanMade;
    const attaquesOmbres = attrs.attaqueOmbre;

    const autresEffets = [];

    if (aspect !== '0') {
      aspectNom = aspect.slice(2, -1);

      attrsAspect = await getAttrsAsync([
        aspectNom,
        `${aspectNom}PNJAE`,
        `${aspectNom}PNJAEMaj`,
      ]);

      const aspectValue = +attrsAspect[aspectNom];
      AE = totalAspect(attrsAspect, aspectNom);

      cBase.push(AspectNom[aspectNom]);
      cRoll.push(aspectValue);

      exec.push(`{{vAE=${AE}}}`);
    }

    if (mod !== 0) {
      cRoll.push(mod);
      exec.push(`{{mod=${mod}}}`);
    }

    // GESTION DES BONUS DE BASE
    if (ameliorations) {
      diceDegats += 2;
      diceViolence += 2;

      exec.push('{{vGrenadesAmeliorees=+2D}}');
    }

    // FIN GESTION DES BONUS DE BASE

    // GESTION DES EFFETS

    switch (button) {
      case 'grenade1PNJ':
        isConditionnelD = true;
        isConditionnelV = true;

        firstExec.push('{{ultraviolenceValue=[[2D6]]}} {{meurtrierValue=[[2D6]]}}');

        exec.push(`{{ultraviolence=${i18n_ultraviolence}}} {{ultraviolenceCondition=${i18n_ultraviolenceCondition}}} {{meurtrier=${i18n_meurtrier}}} {{meurtrierCondition=${i18n_meurtrierCondition}}}`);
        autresEffets.push(`${i18n_dispersion} 6`);

        isUltraviolence = true;
        isMeurtrier = true;
        break;
      case 'grenade2PNJ':
        isConditionnelA = true;

        exec.push(`{{choc=${i18n_choc} 1}} {{chocCondition=${i18n_chocCondition}}}`);
        autresEffets.push(`${i18n_barrage} 2`);
        autresEffets.push(`${i18n_lumiere} 2`);
        autresEffets.push(`${i18n_dispersion} 6`);
        break;
      case 'grenade3PNJ':
        isConditionnelD = true;

        firstExec.push('{{destructeurValue=[[2D6]]}}');

        exec.push(`{{destructeur=${i18n_destructeur}}} {{destructeurCondition=${i18n_destructeurCondition}}}`);
        autresEffets.push(`${i18n_perceArmure} 20`);
        autresEffets.push(`${i18n_penetrant} 6`);
        autresEffets.push(`${i18n_dispersion} 6`);

        isDestructeur = true;
        break;
      case 'grenade4PNJ':
        isConditionnelA = true;

        exec.push(`{{parasitage=${i18n_parasitage} 2}} {{parasitageCondition=${i18n_parasitageCondition}}}`);
        autresEffets.push(`${i18n_dispersion} 6`);
        hasDgts = false;
        break;
      case 'grenade5PNJ':
        isConditionnelA = true;

        exec.push(`{{choc=${i18n_choc} 1}} {{chocCondition=${i18n_chocCondition}}} {{grenadeExplosive=${i18n_surVehicule}}} {{grenadeExplosiveD=[[3D6]]}}`);
        autresEffets.push(i18n_antiVehicule);
        autresEffets.push(`${i18n_dispersion} 3`);
        break;
      default:
        isConditionnelA = false;
        break;
    }

    if (attaquesOmbres !== '0' && capacitesFM !== '0') {
      isConditionnelD = true;

      attaquesSurprises.push(i18n_attaquesOmbres);
      attaquesSurprisesValue.push(vMasque);

      if (attaquesSurprisesCondition === '') { attaquesSurprisesCondition = `{{attaqueSurpriseCondition=${i18n_attaqueSurpriseCondition}}}`; }
    }

    // FIN GESTION DES EFFETS

    if (cRoll.length === 0) { cRoll.push(0); }

    if (bonus.length === 0) { bonus.push(0); }

    bonus.push(AE);

    if (hasDgts) {
      if (diceDegats < 0) { diceDegats = 0; }

      if (diceViolence < 0) { diceViolence = 0; }

      exec.push(`{{degats=[[${diceDegats}D6+${bDegats}]]}}`);
      exec.push(`{{violence=[[${diceViolence}D6+${bViolence}]]}}`);
    }

    if (cBase.length !== 0) { exec.push(`{{cBase=${cBase.join(' - ')}}}`); }

    const jet = `{{jet=[[ {{[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0}]]}}`;

    firstExec.push(jet);
    exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);
    exec.push(`{{bonus=[[${bonus.join('+')}]]}}`);

    if (attaquesSurprises.length > 0 && hasDgts) {
      exec.push(`{{attaqueSurprise=${attaquesSurprises.join('\n+')}}}`);
      exec.push(`{{attaqueSurpriseValue=[[${attaquesSurprisesValue.join('+')}]]}}`);
      exec.push(`${attaquesSurprisesCondition}`);

      isSurprise = true;
    }

    if (autresEffets.length > 0) {
      autresEffets.sort();
      exec.push(`{{effets=${autresEffets.join(' / ')}}}`);
    }

    if (isConditionnelA) { exec.push('{{succesConditionnel=true}}'); }

    if (isConditionnelD && hasDgts) { exec.push('{{degatsConditionnel=true}}'); }

    if (isConditionnelV && hasDgts) { exec.push('{{violenceConditionnel=true}}'); }

    exec = firstExec.concat(exec);

    // ROLL
    const finalRoll = await startRoll(exec.join(' '));
    const tJet = finalRoll.results.jet.result;
    const tBonus = finalRoll.results.bonus.result;
    const tExploit = finalRoll.results.Exploit.result;

    const finalComputed = {
      jet: tJet + tBonus,
    };

    if (hasDgts) {
      const rDegats = finalRoll.results.degats.dice;
      const rViolence = finalRoll.results.violence.dice;

      const tDegats = finalRoll.results.degats.result;
      const tViolence = finalRoll.results.violence.result;

      const conditions = {
        isSurprise,
        isDestructeur,
        isMeurtrier,
        isUltraviolence,
      };

      const computed = updateRoll(finalRoll, tDegats, rDegats, bDegats, tViolence, rViolence, bViolence, conditions);
      Object.assign(finalComputed, computed);
    }

    finishRoll(finalRoll.rollId, finalComputed);

    if (tJet !== 0 && tJet === tExploit) {
      const exploitRoll = await startRoll(`${roll}@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${i18n_exploit}}}${jet}`);
      const tRExploit = exploitRoll.results.jet.result;
      const exploitComputed = {
        jet: tRExploit,
      };

      finishRoll(exploitRoll.rollId, exploitComputed);
    }
  });
});
  /* eslint-disable camelcase */
/* eslint-disable no-undef */
for (let i = 0; i < rollCombatImprovise; i += 1) {
  const str = `AIPNJ${i}`;

  // eslint-disable-next-line no-loop-func
  on(`clicked:${str}`, async (info) => {
    const roll = info.htmlAttributes.value;

    let dDgts = 0;
    let dViolence = 0;

    switch (i) {
      case 1:
        dDgts = 4;
        dViolence = 4;
        break;

      case 2:
        dDgts = 2;
        dViolence = 5;
        break;

      case 3:
        dDgts = 4;
        dViolence = 4;
        break;

      case 4:
        dDgts = 6;
        dViolence = 4;
        break;

      case 5:
        dDgts = 4;
        dViolence = 6;
        break;

      case 6:
        dDgts = 5;
        dViolence = 5;
        break;

      case 7:
        dDgts = 7;
        dViolence = 5;
        break;

      case 8:
        dDgts = 5;
        dViolence = 7;
        break;

      case 9:
        dDgts = 6;
        dViolence = 6;
        break;

      case 10:
        dDgts = 7;
        dViolence = 9;
        break;

      case 11:
        dDgts = 8;
        dViolence = 8;
        break;

      case 12:
        dDgts = 10;
        dViolence = 12;
        break;

      case 13:
        dDgts = 11;
        dViolence = 11;
        break;

      default:
        dDgts = 0;
        dViolence = 0;
        break;
    }

    const listAttrs = [
      'jetModifDes',
      'utilisationArmeAIPNJ',
      'Chair',
      'ChairPNJAE',
      'ChairPNJAEMaj',
      'Bete',
      'BetePNJAE',
      'BetePNJAEMaj',
      'Machine',
      'Masque',
      'capaciteFanMade',
      'attaqueOmbre',
    ];

    const attrs = await getAttrsAsync(listAttrs);

    const exec = [];
    exec.push(roll);

    const isConditionnelA = false;
    let isConditionnelD = false;
    const isConditionnelV = false;

    const cBase = [];
    const cRoll = [];
    let bonus = [];

    const type = attrs.utilisationArmeAIPNJ;
    const mod = +attrs.jetModifDes;

    let diceDegats = dDgts;
    let diceViolence = dViolence;

    let bDegats = 0;
    const bViolence = 0;

    const aspectNom = 'Chair';

    const vChair = +attrs.Chair;
    const vChairAE = totalAspect(attrs, 'Chair');
    const vBete = +attrs.Bete;
    const vBeteAEMin = +attrs.BetePNJAE;
    const vBeteAEMaj = +attrs.BetePNJAEMaj;
    const vMasque = +attrs.Masque;

    let vBeteD = 0;

    const attaquesSurprises = [];
    const attaquesSurprisesValue = [];
    let attaquesSurprisesCondition = '';

    const autresEffets = [];

    const aspectValue = vChair;
    const AE = vChairAE;

    cBase.push(AspectNom[aspectNom]);
    cRoll.push(aspectValue);
    exec.push(`{{vAE=${AE}}}`);

    if (mod !== 0) {
      cRoll.push(mod);
      exec.push(`{{mod=${mod}}}`);
    }

    // GESTION DES BONUS DE BASE ET ASPECTS EXCEPTIONNELS
    if (type === '&{template:combat} {{portee=^{portee-contact}}}') {
      if (vChair > 0) {
        const vChairD = Math.ceil(vChair / 2);

        bDegats += vChairD;
        exec.push(`{{vChair=${vChairD}}}`);
      }

      if (vBeteAEMin > 0 || vBeteAEMaj > 0) {
        bDegats += vBeteAEMin;
        bDegats += vBeteAEMaj;

        vBeteD += vBeteAEMin;
        vBeteD += vBeteAEMaj;
      }

      if (vBeteAEMaj > 0) {
        bDegats += vBete;
        vBeteD += vBete;
      }

      if (vBeteD > 0) { exec.push(`{{vBeteD=${vBeteD}}}`); }
    }

    // FIN GESTION DES BONUS DE BASE ET ASPECTS EXCEPTIONNELS

    const capacitesFM = attrs.capaciteFanMade;
    const attaquesOmbres = attrs.attaqueOmbre;

    if (attaquesOmbres !== '0' && capacitesFM !== '0') {
      isConditionnelD = true;

      attaquesSurprises.push(i18n_attaquesOmbres);
      attaquesSurprisesValue.push(vMasque);

      if (attaquesSurprisesCondition === '') { attaquesSurprisesCondition = `{{attaqueSurpriseCondition=${i18n_attaqueSurpriseCondition}}}`; }
    }

    if (cRoll.length === 0) { cRoll.push(0); }

    if (bonus.length === 0) { bonus.push(0); }

    bonus = bonus.concat(AE);

    if (cBase.length !== 0) { exec.push(`{{cBase=${cBase.join(' - ')}}}`); }

    const jet = `{{jet=[[ {{[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0}]]}}`;

    exec.push(jet);
    exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);
    exec.push(`{{bonus=[[${bonus.join('+')}]]}}`);

    if (diceDegats < 0) { diceDegats = 0; }

    if (diceViolence < 0) { diceViolence = 0; }

    exec.push(`{{degats=[[${diceDegats}D6+${bDegats}]]}}`);
    exec.push(`{{violence=[[${diceViolence}D6+${bViolence}]]}}`);

    if (attaquesSurprises.length > 0) {
      exec.push(`{{attaqueSurprise=${attaquesSurprises.join('\n+')}}}`);
      exec.push(`{{attaqueSurpriseValue=[[${attaquesSurprisesValue.join('+')}]]}}`);
      exec.push(attaquesSurprisesCondition);
    }

    if (autresEffets.length > 0) {
      autresEffets.sort();
      exec.push(`{{effets=${autresEffets.join(' / ')}}}`);
    }

    if (isConditionnelA) { exec.push('{{succesConditionnel=true}}'); }

    if (isConditionnelD) { exec.push('{{degatsConditionnel=true}}'); }

    if (isConditionnelV) { exec.push('{{violenceConditionnel=true}}'); }

    startRoll(exec.join(' '), (results) => {
      const tJet = results.results.jet.result;

      const tBonus = results.results.bonus.result;
      const tExploit = results.results.Exploit.result;

      finishRoll(
        results.rollId,
        {
          jet: tJet + tBonus,
        },
      );

      if (tJet !== 0 && tJet === tExploit) {
        startRoll(`${roll}@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${i18n_exploit}}}${jet}`, (exploit) => {
          const tExploit2 = exploit.results.jet.result;

          finishRoll(
            exploit.rollId,
            {
              jet: tExploit2,
            },
          );
        });
      }
    });
  });
}
  /* eslint-disable prefer-destructuring */
/* eslint-disable camelcase */
/* eslint-disable max-len */
/* eslint-disable no-undef */
const rollCombatAutrePNJ = ['repeating_armeautre:armeautrepnj'];

rollCombatAutrePNJ.forEach((button) => {
  on(`clicked:${button}`, async (info) => {
    const roll = info.htmlAttributes.value;

    let listAttrs = [];

    const id = info.triggerName.split('_')[2];

    const prefix = `repeating_armeautre_${id}_`;

    const effet = wpnEffects.map((a) => `${prefix}${a}`);
    const effetValue = wpnEffectsValue.map((a) => `${prefix}${a}`);
    const AA = wpnAmeliorationA.map((a) => `${prefix}${a}`);
    const AAValue = wpnAmeliorationAValue.map((a) => `${prefix}${a}`);
    const special = wpnSpecial.map((a) => `${prefix}${a}`);
    const specialValue = wpnSpecialValue.map((a) => `${prefix}${a}`);

    listAttrs.push(`${prefix}ArmeAutre`);
    listAttrs.push(`${prefix}armeAutrePortee`);

    listAttrs.push(`${prefix}armeODAutre`);
    listAttrs.push(`${prefix}armeAttaqueAutre`);

    listAttrs.push(`${prefix}armeAutreDegat`);
    listAttrs.push(`${prefix}armeAutreViolence`);

    listAttrs.push(`${prefix}armeAutreBDegat`);
    listAttrs.push(`${prefix}armeAutreBViolence`);

    listAttrs = listAttrs.concat(effet, effetValue, AA, AAValue, special, specialValue);

    const attrs = await getAttrsAsync(listAttrs);

    const name = attrs[`${prefix}ArmeAutre`] || '';
    const portee = attrs[`${prefix}armeAutrePortee`] || '^{portee-contact}';

    let firstExec = [];
    let exec = [];
    firstExec.push(roll);

    firstExec.push(`{{special1=${name}}}`);
    firstExec.push(`{{portee=^{portee} ${portee}}}`);

    let isConditionnelA = false;
    let isConditionnelD = false;
    let isConditionnelV = false;

    const OD = Number(attrs[`${prefix}armeODAutre`]) || 0;

    const cRoll = [
      Number(attrs[`${prefix}armeAttaqueAutre`]) || 0,
    ];

    let bonus = [
      OD,
    ];

    let diceDegats = 0;
    let diceViolence = 0;

    let bDegats = [];
    const bViolence = [];

    diceDegats += Number(attrs[`${prefix}armeAutreDegat`]) || 0;
    diceViolence += Number(attrs[`${prefix}armeAutreViolence`]) || 0;

    bDegats.push(Number(attrs[`${prefix}armeAutreBDegat`]) || 0);
    bViolence.push(Number(attrs[`${prefix}armeAutreBViolence`]) || 0);

    let degats = [];
    let violence = [];

    let attaquesSurprises = [];
    let attaquesSurprisesValue = [];
    let attaquesSurprisesCondition = '';

    let eASAssassin = '';
    let eASAssassinValue = 0;

    let isAssistantAttaque = false;
    let isAntiAnatheme = false;
    let isCadence = false;
    let sCadence = 0;
    let vCadence = 0;
    let isDestructeur = false;
    let vDestructeur = 0;
    let isMeurtrier = false;
    let vMeurtrier = 0;
    let nowSilencieux = false;
    let isObliteration = false;
    let isTenebricide = false;
    let isTirRafale = false;
    let isChambreDouble = false;
    let isFureur = false;
    let isUltraviolence = false;
    let isSurprise = false;

    let isELumiere = false;
    let lumiereValue = 0;

    let autresEffets = [];
    let autresAmeliorationsA = [];
    const autresSpecial = [];

    // GESTION DES EFFETS

    const effets = getWeaponsEffectsAutrePNJ(prefix, attrs);

    bDegats = bDegats.concat(effets.bDegats);
    eASAssassin = effets.eASAssassin;
    eASAssassinValue = effets.eASAssassinValue;

    if (attaquesSurprisesCondition === '' && effets.attaquesSurprisesCondition !== '') { attaquesSurprisesCondition = effets.attaquesSurprisesCondition; }

    attaquesSurprises = attaquesSurprises.concat(effets.attaquesSurprises);
    attaquesSurprisesValue = attaquesSurprisesValue.concat(effets.attaquesSurprisesValue);

    autresEffets = autresEffets.concat(effets.autresEffets);

    isAntiAnatheme = effets.isAntiAnatheme;

    isAssistantAttaque = effets.isAssistantAttaque;

    isCadence = effets.isCadence;
    sCadence = effets.sCadence;
    vCadence = effets.vCadence;

    isDestructeur = effets.isDestructeur;
    vDestructeur = effets.vDestructeur;

    isMeurtrier = effets.isMeurtrier;
    vMeurtrier = effets.vMeurtrier;

    nowSilencieux = effets.nowSilencieux;

    isOrfevrerie = effets.isOrfevrerie;

    isTenebricide = effets.isTenebricide;

    isObliteration = effets.isObliteration;
    isTirRafale = effets.isTirRafale;
    isFureur = effets.isFureur;
    isUltraviolence = effets.isUltraviolence;

    isELumiere = effets.isELumiere;
    lumiereValue = Number(effets.eLumiereValue);

    if (effets.isConditionnelA) { isConditionnelA = true; }

    if (effets.isConditionnelD) { isConditionnelD = true; }

    if (effets.isConditionnelV) { isConditionnelV = true; }

    // FIN GESTION DES EFFETS

    // GESTION DES AMELIORATIONS D'ARMES

    const ameliorationsA = getWeaponsAutreAA(prefix, attrs, isAssistantAttaque, eASAssassinValue, isCadence, vCadence, nowSilencieux, isTirRafale, isObliteration, isAntiAnatheme);

    exec = exec.concat(ameliorationsA.exec);

    bonus = bonus.concat(ameliorationsA.bonus);

    diceDegats += ameliorationsA.diceDegats;
    diceViolence += ameliorationsA.diceViolence;

    bDegats = bDegats.concat(ameliorationsA.bDegats);

    attaquesSurprises = attaquesSurprises.concat(ameliorationsA.attaquesSurprises);
    attaquesSurprisesValue = attaquesSurprisesValue.concat(ameliorationsA.attaquesSurprisesValue);

    if (attaquesSurprisesCondition === '') { attaquesSurprisesCondition = ameliorationsA.attaquesSurprisesCondition; }

    if (ameliorationsA.isChambreDouble) {
      isCadence = false;
      isChambreDouble = ameliorationsA.isChambreDouble;
      sCadence = ameliorationsA.rChambreDouble;
    }

    autresEffets = autresEffets.concat(ameliorationsA.autresEffets);
    autresAmeliorationsA = autresAmeliorationsA.concat(ameliorationsA.autresAmeliorations);

    if (ameliorationsA.aASAssassin !== '') {
      eASAssassin = ameliorationsA.aASAssassin;
      eASAssassinValue = ameliorationsA.aASAssassinValue;
    }

    if (ameliorationsA.isConditionnelA) { isConditionnelA = true; }

    if (ameliorationsA.isConditionnelD) { isConditionnelD = true; }

    if (ameliorationsA.isConditionnelV) { isConditionnelV = true; }

    // FIN GESTION DES AMELIORATIONS D'ARMES

    // GESTION DES BONUS SPECIAUX

    const sBonusDegats = isApplied(attrs[`${prefix}BDDiversTotal`]);
    const sBonusDegatsD6 = attrs[`${prefix}BDDiversD6`];
    const sBonusDegatsFixe = attrs[`${prefix}BDDiversFixe`];

    const sBonusViolence = isApplied(attrs[`${prefix}BVDiversTotal`]);
    const sBonusViolenceD6 = attrs[`${prefix}BVDiversD6`];
    const sBonusViolenceFixe = attrs[`${prefix}BVDiversFixe`];

    const sEnergie = isApplied(attrs[`${prefix}energie`]);
    const sEnergieValue = attrs[`${prefix}energieValue`];

    if (sBonusDegats) {
      exec.push(`{{vMSpecialD=+${sBonusDegatsD6}D6+${sBonusDegatsFixe}}}`);
      diceDegats += Number(sBonusDegatsD6);
      bDegats.push(sBonusDegatsFixe);
    }

    if (sBonusViolence) {
      exec.push(`{{vMSpecialV=+${sBonusViolenceD6}D6+${sBonusViolenceFixe}}}`);
      diceViolence += Number(sBonusViolenceD6);
      bViolence.push(sBonusViolenceFixe);
    }

    if (sEnergie) {
      autresSpecial.push(`^{energie} (${sEnergieValue})`);
    }

    // FIN DE GESTION DES BONUS SPECIAUX

    if (cRoll.length === 0) { cRoll.push(0); }

    if (bonus.length === 0) { bonus.push(0); }

    exec.push('{{OD=true}}');
    exec.push(`{{vOD=${OD}}}`);

    if (diceDegats < 0) { diceDegats = 0; }

    if (diceViolence < 0) { diceViolence = 0; }

    degats.push(`${diceDegats}D6`);
    degats = degats.concat(bDegats);

    violence.push(`${diceViolence}D6`);
    violence = violence.concat(bViolence);

    const jet = `{{jet=[[ {{[[{${cRoll.join('+')}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0}]]}}`;

    firstExec.push(jet);
    exec.push(`{{Exploit=[[${cRoll.join('+')}]]}}`);
    exec.push(`{{bonus=[[${bonus.join('+')}]]}}`);

    exec.push(`{{degats=[[${degats.join('+')}]]}}`);
    exec.push(`{{violence=[[${violence.join('+')}]]}}`);

    if (isObliteration) {
      let ASObliteration = [];
      let ASValueObliteration = [];

      diceDegatsObliteration = diceDegats * 6;

      degatsFObliteration = _.reduce(bDegats, (n1, n2) => Number(n1) + Number(n2));

      const vObliteration = diceDegatsObliteration + degatsFObliteration;

      exec.push(`{{obliterationValue=${vObliteration}}}`);

      if (isMeurtrier) { exec.push(`{{obliterationMeurtrierValue=${vMeurtrier * 6}}}`); }

      if (isDestructeur) { exec.push(`{{obliterationDestructeurValue=${vDestructeur * 6}}}`); }

      if (eASAssassinValue > 0) {
        eAssassinTenebricideValue = eASAssassinValue * 6;

        ASObliteration.unshift(eASAssassin);
        ASValueObliteration.unshift(eAssassinTenebricideValue);

        if (attaquesSurprises.length > 0) {
          ASObliteration = ASObliteration.concat(attaquesSurprises);
          ASValueObliteration = ASValueObliteration.concat(attaquesSurprisesValue);
        }

        exec.push(`{{obliterationAS=${ASObliteration.join('\n+')}}}`);
        exec.push(`{{obliterationASValue=${_.reduce(ASValueObliteration, (n1, n2) => n1 + n2, 0)}}}`);
      } else if (attaquesSurprises.length > 0) {
        ASObliteration = ASObliteration.concat(attaquesSurprises);
        ASValueObliteration = ASValueObliteration.concat(attaquesSurprisesValue);

        exec.push(`{{obliterationAS=${ASTenebricide.join('\n+')}}}`);
        exec.push(`{{obliterationASValue=${_.reduce(ASValueObliteration, (n1, n2) => n1 + n2, 0)}}}`);
      }
    }

    if (isCadence) {
      exec.push(`{{rCadence=${i18n_cadence} ${vCadence} ${i18n_inclus}}}`);
      exec.push(`{{vCadence=${sCadence}D}}`);
    }

    if (isChambreDouble) {
      exec.push(`{{rCadence=${i18n_chambreDouble} (${i18n_cadence} 2) ${i18n_inclus}}}`);
      exec.push(`{{vCadence=${sCadence}D}}`);
    }

    if (eASAssassinValue > 0) {
      attaquesSurprises.unshift(eASAssassin);
      attaquesSurprisesValue.unshift(`${eASAssassinValue}D6`);
    }

    if (attaquesSurprises.length > 0) {
      exec.push(`{{attaqueSurprise=${attaquesSurprises.join('\n+')}}}`);
      exec.push(`{{attaqueSurpriseValue=[[${attaquesSurprisesValue.join('+')}]]}}`);
      exec.push(attaquesSurprisesCondition);

      isSurprise = true;
    }

    if (isTenebricide) {
      exec.push(`{{tenebricide=${i18n_tenebricide}}} {{tenebricideConditionD=${i18n_tenebricideConditionD}}} {{tenebricideConditionV=${i18n_tenebricideConditionV}}}`);
      exec.push('{{tenebricideValueD=[[0]]}}');
      exec.push('{{tenebricideValueV=[[0]]}}');

      if (attaquesSurprises.length > 0) {
        exec.push(`{{tenebricideAS=${attaquesSurprises.join('\n+')}}}`);
        exec.push('{{tenebricideASValue=[[0]]}}');
      }

      if (isMeurtrier) { firstExec.push('{{tMeurtrierValue=[[0]]}}'); }
      if (isDestructeur) { firstExec.push('{{tDestructeurValue=[[0]]}}'); }
      if (isFureur) { firstExec.push('{{tFureurValue=[[0]]}}'); }
      if (isUltraviolence) { firstExec.push('{{tUltraviolenceValue=[[0]]}}'); }
    }

    if (isELumiere) { autresEffets.push(`${i18n_lumiere} ${lumiereValue}`); }

    if (autresEffets.length > 0) {
      autresEffets.sort();
      exec.push(`{{effets=${autresEffets.join(' / ')}}}`);
    }

    if (autresAmeliorationsA.length > 0) {
      autresAmeliorationsA.sort();
      exec.push(`{{ameliorations=${autresAmeliorationsA.join(' / ')}}}`);
    }

    if (autresSpecial.length > 0) {
      autresSpecial.sort();
      exec.push(`{{special=${autresSpecial.join(' / ')}}}`);
    }

    if (isConditionnelA) { exec.push('{{succesConditionnel=true}}'); }

    if (isConditionnelD) { exec.push('{{degatsConditionnel=true}}'); }

    if (isConditionnelV) { exec.push('{{violenceConditionnel=true}}'); }

    if (effets.exec) { exec = exec.concat(effets.exec); }

    if (effets.firstExec) { firstExec = firstExec.concat(effets.firstExec); }

    exec = firstExec.concat(exec);

    const finalRoll = await startRoll(exec.join(' '));

    const tJet = finalRoll.results.jet.result;

    const tBonus = finalRoll.results.bonus.result;
    const tExploit = finalRoll.results.Exploit.result;

    const rDegats = finalRoll.results.degats.dice;
    const rViolence = finalRoll.results.violence.dice;

    const tDegats = finalRoll.results.degats.result;
    const tViolence = finalRoll.results.violence.result;

    const conditions = {
      isTenebricide,
      isDestructeur,
      isFureur,
      isSurprise,
      isMeurtrier,
      isUltraviolence,
    };

    const computed = updateRoll(finalRoll, tDegats, rDegats, bDegats, tViolence, rViolence, bViolence, conditions);

    const finalComputed = {
      jet: tJet + tBonus,
    };

    Object.assign(finalComputed, computed);

    finishRoll(finalRoll.rollId, finalComputed);

    if (tJet !== 0 && tJet === tExploit) {
      const exploitRoll = await startRoll(`${roll}@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${i18n_exploit}}}${jet}`);
      const tRExploit = exploitRoll.results.jet.result;
      const exploitComputed = {
        jet: tRExploit,
      };

      finishRoll(exploitRoll.rollId, exploitComputed);
    }
  });
});
  /* eslint-disable camelcase */
/* eslint-disable no-undef */
on('clicked:rollVehicule', async (info) => {
  const roll = info.htmlAttributes.value;

  let exec = '';

  const listAttrs = [
    'desVehicule',
    'jetModifDes',
    'ODVehicule',
  ];

  const attrs = await getAttrsAsync(listAttrs);

  const base = +attrs.desVehicule || 0;
  const mod = +attrs.jetModifDes || 0;
  const bonus = +attrs.ODVehicule || 0;
  const rollT = base + mod;

  exec = `${roll}{{jet=[[ {[[{${rollT}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}} {{OD=true}} {{vOD=${bonus}}} {{tBonus=[[${bonus}]]}} {{Exploit=[[${rollT}]]}}`;

  startRoll(exec, (results) => {
    const tJet = results.results.jet.result;
    const tBonus = results.results.tBonus.result;
    const tExploit = results.results.Exploit.result;

    const total = tJet + tBonus;

    finishRoll(
      results.rollId,
      {
        jet: total,
      },
    );

    if (tJet !== 0 && tJet === tExploit) {
      startRoll(`${roll}@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=${i18n_exploit}}} {{jet=[[ {[[{${rollT}, 0}kh1]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}`, (exploit) => {
        const tExploit2 = exploit.results.jet.result;

        finishRoll(
          exploit.rollId,
          {
            jet: tExploit2,
          },
        );
      });
    }
  });
});

</script>
<div class="content">
  <input class="version" type="hidden" name="attr_version" value="0"/><input type="hidden" name="attr_popup" class="popup" value="0" />

<div class="popup">
	<div class="popupChoixArmure">
		<h1 class="titre" data-i18n="choisir-meta-armure">Choisir ma Méta-Armure</h1>
		<select name="attr_choixArmure">
			<option value="choix" selected></option>
			<option value="barbarian" data-i18n="barbarian">Barbarian</option>
			<option value="bard" data-i18n="bard">Bard</option>
			<option value="berserk" data-i18n="berserk">Berserk</option>
			<option value="druid" data-i18n="druid">Druid</option>
			<option value="monk" data-i18n="monk">Monk</option>
			<option value="necromancer" data-i18n="necromancer">Necromancer</option>
			<option value="paladin" data-i18n="paladin">Paladin</option>
			<option value="priest" data-i18n="priest">Priest</option>
			<option value="psion" data-i18n="psion">Psion</option>
			<option value="ranger" data-i18n="ranger">Ranger</option>
			<option value="rogue" data-i18n="rogue">Rogue</option>
			<option value="shaman" data-i18n="shaman">Shaman</option>
			<option value="sorcerer" data-i18n="sorcerer">Sorcerer</option>
			<option value="warlock" data-i18n="warlock">Warlock</option>
			<option value="warmaster" data-i18n="warmaster">Warmaster</option>
			<option value="warrior" data-i18n="warrior">Warrior</option>
			<option value="wizard" data-i18n="wizard">Wizard</option>
		</select>
		<span data-i18n="note-popup-selection-armure">Note : Vous pourrez en changer plus tard via les options de la fiche.</span>
		<button type="action" name="act_selectionArmure" data-i18n="selectionner">Sélectionner</button>
	</div>

	<div class="popupResilience">
		<h1 class="titre" data-i18n="type">Type</h1>
		<select name="attr_listeTypePNJ">
			<option value=""></option>
			<option value="1" data-i18n="colosse-recrue">Colosse (Recrue)</option>
			<option value="2" data-i18n="colosse-initie">Colosse (Initié)</option>
			<option value="3" data-i18n="colosse-heros">Colosse (Héros)</option>
			<option value="4" data-i18n="patron-recrue">Patron (Recrue)</option>
			<option value="5" data-i18n="patron-initie">Patron (Initié)</option>
			<option value="6" data-i18n="patron-heros">Patron (Héros)</option>
		</select>
		<button type="action" name="act_calculResilienceFinal" data-i18n="calculer-resilience">Calculer la résilience</button>
	</div>

	<div class="popupWarrior">
		<h1 class="titre" data-i18n="type">Type</h1>
		<select name="attr_listeTypeMALWarrior">
			<option value=""></option>
			<option value="1" data-i18n="warrior-type-soldier">Type Soldier</option>
			<option value="2" data-i18n="warrior-type-hunter">Type Hunter</option>
			<option value="3" data-i18n="warrior-type-scholar">Type Scholar</option>
			<option value="4" data-i18n="warrior-type-herald">Type Herald</option>
			<option value="5" data-i18n="warrior-type-scout">Type Scout</option>
		</select>
		<button type="action" name="act_selectionMALWarrior" data-i18n="selectionner">Sélectionner</button>
	</div>
	<div class="popupPriest">
		<h1 class="titre" data-i18n="mode">Mode</h1>
		<select name="attr_listeTypeMALPriest">
			<option value=""></option>
			<option value="1" data-i18n="priest-mode-mechanic">Mode Mechanic</option>
			<option value="2" data-i18n="priest-mode-nanoc">Mode NanoC</option>
		</select>
		<button type="action" name="act_selectionMALPriest" data-i18n="selectionner">Sélectionner</button>
	</div>
	<div class="popupWarmaster">
		<h1 class="titre" data-i18n="mode">Mode</h1>
		<select name="attr_listeTypeMALWarmaster">
			<option value=""></option>
			<option value="1" data-i18n="mode-warlord">Mode Warlord</option>
			<option value="2" data-i18n="mode-falcon">Mode Falcon</option>
		</select>
		<button type="action" name="act_selectionMALWarmaster" data-i18n="selectionner">Sélectionner</button>
	</div>
	<div class="popupPsion">
		<h1 class="titre" data-i18n="mode">Mode</h1>
		<select name="attr_listeModeMALPsion">
			<option value=""></option>
			<option value="1" data-i18n="mode-puppet-master">Mode Puppet Master</option>
			<option value="2" data-i18n="mode-discord">Mode Discord</option>
			<option value="3" data-i18n="mode-windtalker">Mode Windtalker</option>
		</select>
		<select name="attr_listeModeMALPsion2">
			<option value=""></option>
			<option value="1" data-i18n="mode-puppet-master">Mode Puppet Master</option>
			<option value="2" data-i18n="mode-discord">Mode Discord</option>
			<option value="3" data-i18n="mode-windtalker">Mode Windtalker</option>
		</select>
		<button type="action" name="act_selectionMALPsion" data-i18n="selectionner">Sélectionner</button>
	</div>
	<div class="popupWarlock">
		<h1 class="titre" data-i18n="mode">Mode</h1>
		<select name="attr_listeModeMALWarlock">
			<option value=""></option>
			<option value="1" data-i18n="warlock-mode-record">Mode Record</option>
			<option value="2" data-i18n="warlock-mode-rewind">Mode Rewind</option>
		</select>
		<button type="action" name="act_selectionMALWarlock" data-i18n="selectionner">Sélectionner</button>
	</div>
	<div class="popupDruid">
		<h1 class="titre" data-i18n="druid-mod-companions">Mod Companions</h1>
		<select name="attr_listeModeMALDruid">
			<option value=""></option>
			<option value="1" data-i18n="druid-companion-lion">Lion</option>
			<option value="2" data-i18n="druid-companion-wolf">Wolf</option>
			<option value="3" data-i18n="druid-companion-crow">Crow</option>
		</select>
		<button type="action" name="act_selectionMALDruid" data-i18n="selectionner">Sélectionner</button>
	</div>

	<div class="popupWarmasterWarlord">
		<h1 class="titre" data-i18n="mode-warlord">Mode Warlord</h1>
		<select name="attr_listeTypeMALWarmasterWarlord">
			<option value=""></option>
			<option value="1" data-i18n="warlord-impulsion-d'esquive">Impulsion d'Esquive</option>
			<option value="2" data-i18n="warlord-impulsion-de-force">Impulsion de Force</option>
			<option value="3" data-i18n="warlord-impulsion-de-guerre">Impulsion de Guerre</option>
			<option value="4" data-i18n="warlord-impulsion-d'energie">Impulsion d'Energie</option>
		</select>
		<button type="action" name="act_selectionMALWarmasterWarlord" data-i18n="selectionner">Sélectionner</button>
	</div>
</div>
  <input class="ficheType" type="hidden" name="attr_fichePNJ" value="0"/>
  <input class="tabMenu" type="hidden" name="attr_tab" value="dossier"/><div class="topLeft">
    <div class="affichage fichePJ fichePNJ ficheCreature ficheBande">
        <div class="defense">
            <div class="base">
                <label class="bOptions">
                    <input type="checkbox" name="attr_expandDefense" value="1" />
                    <span></span>
                </label>
                
                <h1 data-i18n="defense">Défense</h1>
            </div>
            
            <span name="attr_defenseTotal" class="score"></span>
            
            <input type="hidden" name="attr_expandDefense" value="0" />
            <div class="Options">
                <div>
                    <span data-i18n="base" class="titleSimple">Base</span>
                    <span data-i18n="modif" class="titleDouble">Modif</span>
                    <span data-i18n="total" class="titleSimple">Total</span>
                </div>
                <div>
                    <div class="fichePJ fichePNJ ficheCreature ficheBande">
                        <input type="number" class="fichePNJ ficheCreature ficheBande" name="attr_defensePNJ" value="0" />
                        <input type="number" class="fichePJ" name="attr_defense" value="0" readonly />
                        <span class="signe">+</span>
                        <input type="number" name="attr_defenseModif" value="0" readonly />
                        <span class="signe">+</span>
                        <input type="number" name="attr_defenseModifPerso" value="0" />
                        <span class="signe">=</span>
                        <input type="number" name="attr_defenseTotal" value="0" readonly />
                    </div>
                </div>
            </div>
        </div>
        
        <div class="reaction">
            <div class="base">
                <label class="bOptions">
                    <input type="checkbox" name="attr_expandReaction" value="1" />
                    <span></span>
                </label>
                
                <h1 data-i18n="reaction">Réaction</h1>
            </div>
            
            <span name="attr_reactionTotal" class="score"></span>
            
            <input type="hidden" name="attr_expandReaction" value="0" />
            <div class="Options">
                <div>
                    <span data-i18n="base" class="titleSimple">Base</span>
                    <span data-i18n="modif" class="titleDouble">Modif</span>
                    <span data-i18n="total" class="titleSimple">Total</span>
                </div>
                <div>
                    <div class="fichePJ fichePNJ ficheCreature ficheBande">
                        <input type="number" class="fichePNJ ficheCreature ficheBande" name="attr_reactionPNJ" value="0" />
                        <input type="number" class="fichePJ" name="attr_reaction" value="0" readonly />
                        <span class="signe">+</span>
                        <input type="number" name="attr_reactionModif" value="0" readonly />
                        <span class="signe">+</span>
                        <input type="number" name="attr_reactionModifPerso" value="0" />
                        <span class="signe">=</span>
                        <input type="number" name="attr_reactionTotal" value="0" readonly />
                    </div>
                </div>
            </div>
        </div>
        
        <div class="initiative">
            <div class="base">
                <label class="bOptions">
                    <input type="checkbox" name="attr_expandInitiative" value="1" />
                    <span></span>
                </label>
                
                <h1 data-i18n="initiative">Initiative</h1>
            </div>
            
            <button type="action" name="act_initiative" class="fichePJ rollDice" value="@{jetGM} &{template:simple} {{Nom=@{name}}}" ></button>
            <button type="roll" name="roll_initiativePNJ" class="fichePNJ ficheCreature ficheBande rollDice" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{initiative}}} {{jDivers=^{resultat}}} {{jDiversV=[[ @{diceInitiative}D6+@{bonusInitiativeP}-@{malusInitiative} &{tracker}]]}}" ></button>
            
            <input type="hidden" name="attr_expandInitiative" value="0" />
            <div class="Options">
                <div class="fichePJ">
                    <input type="number" name="attr_diceInitiative" value="3" />
                    <span class="dice">D6+</span>
                    <input type="number" name="attr_bonusInitiative" value="0" readonly />
                    <span class="signe">+</span>
                    <input type="number" name="attr_bonusInitiativeP" value="0" />
                    <span class="signe">-</span>
                    <input type="number" name="attr_malusInitiative" value="0" />
                </div>
                <div class="fichePNJ ficheCreature ficheBande">
                    <input type="number" name="attr_diceInitiative" value="3" />
                    <span class="dice">D6+</span>
                    <input type="number" name="attr_bonusInitiativeP" value="0" />
                    <span class="signe">-</span>
                    <input type="number" name="attr_malusInitiative" value="0" />
                </div>
            </div>
        </div>
    </div>
</div><div class="topRight">
    <div class="topLine">
        <label class="selector">
            <input type="hidden" name="attr_fichePNJ" value="0" />
            <input type="radio" name="attr_fichePNJ" value="0" data-i18n-title="fiche-vehicule" title="Fiche Véhicule"class="ficheVehicule"  checked />
            <input type="radio" name="attr_fichePNJ" value="1" data-i18n-title="fiche-pj" title="Fiche PJ" class="fichePJ" />
            <input type="radio" name="attr_fichePNJ" value="2"  data-i18n-title="fiche-pnj" title="Fiche PNJ" class="fichePNJ" />
            <input type="radio" name="attr_fichePNJ" value="3" data-i18n-title="fiche-creature" title="Fiche Créature" class="ficheCreature" />
            <input type="radio" name="attr_fichePNJ" value="4" data-i18n-title="fiche-bande" title="Fiche Bande" class="ficheBande" />
            <span data-i18n-title="fiche-pj" title="Fiche PJ" class="fichePJ" ></span>
            <span data-i18n-title="fiche-pnj" title="Fiche PNJ" class="fichePNJ" ></span>
            <span data-i18n-title="fiche-creature" title="Fiche Créature" class="ficheCreature" ></span>
            <span data-i18n-title="fiche-bande" title="Fiche Bande" class="ficheBande" ></span>
            <span data-i18n-title="fiche-vehicule" title="Fiche Véhicule" class="ficheVehicule" ></span>
        </label>
        <div class="settings">
            <label class="config">
                <input name="attr_show_settings" value="1" type="checkbox">
                <span></span>
            </label>
            <input type="hidden" name="attr_show_settings" value="0" />
            <div class="config">
                <div class="half">
                    <label>
                        <span data-i18n="fiche-a-afficher">Fiche à afficher :</span> 
                        <select name="attr_fichePNJ">
                            <option value="0" data-i18n="pj" selected>PJ</option>
                            <option value="1" data-i18n="pnj">PNJ</option>
                            <option value="2" data-i18n="creature">Créature</option>
                            <option value="3" data-i18n="bande">Bande</option>
                            <option value="4" data-i18n="vehicule">Véhicule</option>
                        </select>
                    </label>
                </div>
                <div class="half">
                    <label>
                        <span data-i18n="jets-sont">Les jets sont :</span> 
                        <select name="attr_jetGM">
                            <option value="" data-i18n="public" selected>Public</option>
                            <option value="/w gm" data-i18n="prive">Privé</option>
                        </select>
                    </label>
                </div>
                <div class="full fichePJ fichePNJ ficheBande ficheCreature">
                    <label>
                        <span data-i18n="afficher-lors-d'un-jet">Afficher lors d'un jet :</span> 
                        <select name="attr_name">
                            <option value="@{character_name}" data-i18n="nom" selected>Nom</option>
                            <option value="@{surnom}" data-i18n="surnom">Surnom</option>
                        </select>
                    </label>
                </div>
                <div class="full fichePJ">
                    <label>
                        <span data-i18n="changer-armure">Changer de Méta-Armure : </span> 
                        <select name="attr_choixArmure">
                            <option value="barbarian" data-i18n="barbarian">Barbarian</option>
                            <option value="bard" data-i18n="bard">Bard</option>
                            <option value="berserk" data-i18n="berserk">Berserk</option>
                            <option value="druid" data-i18n="druid">Druid</option>
                            <option value="monk" data-i18n="monk">Monk</option>
                            <option value="necromancer" data-i18n="necromancer">Necromancer</option>
                            <option value="paladin" data-i18n="paladin">Paladin</option>
                            <option value="priest" data-i18n="priest">Priest</option>
                            <option value="psion" data-i18n="psion">Psion</option>
                            <option value="ranger" data-i18n="ranger">Ranger</option>
                            <option value="rogue" data-i18n="rogue">Rogue</option>
                            <option value="shaman" data-i18n="shaman">Shaman</option>
                            <option value="sorcerer" data-i18n="sorcerer">Sorcerer</option>
                            <option value="warlock" data-i18n="warlock">Warlock</option>
                            <option value="warmaster" data-i18n="warmaster">Warmaster</option>
                            <option value="warrior" data-i18n="warrior">Warrior</option>
                            <option value="wizard" data-i18n="wizard">Wizard</option>
                        </select>
                    </label>
                </div>
                <div class="full fichePJ">
                    <label>
                        <input type="checkbox" name="attr_armeCoupPoing" value="1" checked>
                        <span data-i18n="ajouter-coup-poing">Ajouter le coup de poing aux armes de contacts</span> 
                    </label>
                </div>
                <div class="full fichePJ fichePNJ">
                    <label>
                        <input type="checkbox" name="attr_armeSPS" value="1">
                        <span data-i18n="ajouter-pistolet-service">Ajouter l'arme de section (Pistolet de Service)</span> 
                    </label>
                </div>
                <div class="full fichePJ fichePNJ">
                    <label>
                        <input type="checkbox" name="attr_armeSME" value="1">
                        <span data-i18n="ajouter-marteau-epieu">Ajouter l'arme de section (Marteau-Épieu)</span> 
                    </label>
                </div>
                <div class="full fichePJ">
                    <label>
                        <input type="checkbox" name="attr_tabIA" value="1">
                        <span data-i18n="utiliser-regles-ia">Utiliser les règles des IA.</span> 
                    </label>
                </div>
                <div class="full fichePJ">
                    <label>
                        <input type="checkbox" name="attr_tabIAI" value="1">
                        <span data-i18n="inclure-onglet-incarner-ia">Inclure un onglet pour incarner l'IA d'un autre joueur.</span> 
                    </label>
                </div>
                <div class="half fichePJ">
                    <label>
                        <input type="checkbox" name="attr_tabCarteDestin" value="1">
                        <span data-i18n="utiliser-cartes-destin">Utiliser les cartes du destin.</span> 
                    </label>
                </div>
                <div class="half fichePJ">
                    <label>
                        <input type="checkbox" name="attr_tabCapaciteHeroique" value="2">
                        <span data-i18n="utiliser-capacites-heroiques">Utiliser les capacités héroïques.</span> 
                    </label>
                </div>
                <div class="full fichePJ">
                    <label>
                        <input type="checkbox" name="attr_tabArt" value="1">
                        <span data-i18n="afficher-onglet-gestion-art">Afficher un onglet pour la gestion de l'Art.</span> 
                    </label>
                </div>
                <div class="full fichePJ">
                    <label>
                        <input type="checkbox" name="attr_tabVehicule" value="1">
                        <span data-i18n="inclure-onglet-gerer-vehicule">Inclure un onglet pour gérer le véhicule.</span> 
                    </label>
                </div>
                <div class="full fichePJ">
                    <label>
                        <input type="checkbox" name="attr_chevaliersHerauts" value="1">
                        <span data-i18n="rendre-disponible-avantages-speciaux">Rendre disponible les avantages spéciaux de La Geste (M15).</span> 
                    </label>
                </div>
                <div class="half fichePJ fichePNJ ficheCreature">
                    <label>
                        <input type="checkbox" name="attr_tabEgide" value="1">
                        <span data-i18n="utiliser-regles-egide">Utiliser les règles de l'égide.</span> 
                    </label>
                </div>
                <div class="half fichePNJ">
                    <label>
                        <input type="checkbox" name="attr_tabModule" value="1">
                        <span data-i18n="afficher-onglet-modules">Afficher l'onglet des Modules.</span> 
                    </label>
                </div>
                <div class="full fichePNJ ficheCreature ficheBande">
                    <label>
                        <input type="checkbox" name="attr_capaciteFanMade" value="1">
                        <span data-i18n="inclure-capacites-fan-made">Inclure les capacités du Codex Fan Made.</span> 
                    </label>
                </div>
                <div class="half fichePNJ ficheCreature">
                    <label>
                        <input type="checkbox" name="attr_tabResilience" value="1">
                        <span data-i18n="utiliser-regles-resilience">Utiliser les règles de la Résilience.</span> 
                    </label>
                </div>
                <div class="half fichePJ">
                    <label>
                        <input type="checkbox" name="attr_tabArmureLegende" value="1">
                        <span data-i18n="acces-armures-legende">Accès aux méta-armures de légende.</span> 
                    </label>
                </div>
                <div class="half fichePJ">
                    <label>
                        <input type="checkbox" name="attr_tabMechaArmure" value="1">
                        <span data-i18n="acces-mecha-armures">Accès aux mécha-armures.</span> 
                    </label>
                </div>
                <div class="textarea fichePNJ ficheCreature ficheBande">
                    <label class="plainText">
                        <span>Import depuis Knight NPC Generator</span>
                        <span>http://kng.magusgeek.com/</span>
                        <textarea name="attr_importKNPCG"></textarea>
                    </label>
                    <button type="action" name="act_importKNPCG">Import</button>
                </div>
            </div>
        </div>
    </div>

    <div class="menu">
        <input type="hidden" name="attr_tabCarteDestin" class="heroisme" value="0" />
        <input type="hidden" name="attr_tabCapaciteHeroique" class="heroisme" value="0" />
        <input type="hidden" name="attr_tabIA" class="ia" value="0" />
        <input type="hidden" name="attr_tabIAI" class="ia-incarnee" value="0" />
        <input type="hidden" name="attr_tabVehicule" class="vehicule" value="0" />
        <input type="hidden" name="attr_tabArt" class="art" value="0" />
        <input type="hidden" name="attr_tabModule" class="modulePNJ" value="0">
        <input type="hidden" name="attr_tabMechaArmure" class="mechaArmures" value="0">

        <div class="fichePJ">
            <button type="action" class="dossier" name="act_dossier" data-i18n="dossier">Dossier</button>
            <button type="action" class="armure" name="act_armure" data-i18n="armure">Armure</button>
            <button type="action" class="combat" name="act_combat" data-i18n="combat">Combat</button>
            <button type="action" class="module" name="act_module" data-i18n="module">Module</button>
            <button type="action" class="overdrive" name="act_overdrive" data-i18n="overdrive">Overdrive</button>
            <button type="action" class="ia" name="act_ia" data-i18n="ia">IA</button>
            <button type="action" class="ia-incarnee" name="act_ia-incarnee" data-i18n="ia-incarnee">IA Incarnée</button>
            <button type="action" class="historique" name="act_historique" data-i18n="historique">Historique</button>
            <button type="action" class="art" name="act_art" data-i18n="art">Art</button>
            <button type="action" class="heroisme" name="act_heroisme" data-i18n="heroisme">Héroïsme</button>
            <button type="action" class="vehicule" name="act_vehicule" data-i18n="vehicule">Véhicule</button>
            <button type="action" class="mechaArmures" name="act_mecha-armure" data-i18n="mecha-armure">Mécha-armures</button>
        </div>

        <div class="fichePNJ">
            <button type="action" class="dossier" name="act_dossier" data-i18n="dossier">Dossier</button>
            <button type="action" class="armure" name="act_capacites" data-i18n="capacites">Capacités</button>
            <button type="action" class="combat" name="act_combat" data-i18n="combat">Combat</button>
            <button type="action" class="module modulePNJ" name="act_module" data-i18n="module">Module</button>
        </div>
        
        <div class="ficheCreature">
            <button type="action" class="dossier" name="act_dossier" data-i18n="dossier">Dossier</button>
            <button type="action" class="armure" name="act_capacites" data-i18n="capacites">Capacités</button>
            <button type="action" class="combat" name="act_combat" data-i18n="combat">Combat</button>
        </div>

        <div class="ficheBande">
            <button type="action" class="dossier" name="act_dossier" data-i18n="dossier">Dossier</button>
            <button type="action" class="armure" name="act_capacites" data-i18n="capacites">Capacités</button>
        </div>

        <div class="ficheVehicule">
            <button type="action" class="ficheVehicule" name="act_vehicule" data-i18n="vehicule">Véhicule</button>
            <button type="action" class="equipage" name="act_equipage" data-i18n="equipage">Equipage</button>
        </div>        
    </div>
</div>
  <input type="hidden" name="attr_atkDefensif" value="0" readonly="readonly"/>
  <input type="hidden" name="attr_atkCouvert" value="0" readonly="readonly"/>
  <input type="hidden" name="attr_atkAgressif" value="0" readonly="readonly"/>
  <input type="hidden" name="attr_atkAkimbo" value="0" readonly="readonly"/>
  <input type="hidden" name="attr_atkAmbidextre" value="0" readonly="readonly"/>
  <input type="hidden" name="attr_atkPilonnage" value="0" readonly="readonly"/>
  <input type="hidden" name="attr_atkPuissant" value="0" readonly="readonly"/>
  <input type="hidden" name="attr_rctBM" readonly="readonly"/>
  <input type="hidden" name="attr_defBM" readonly="readonly"/>
  <input type="hidden" name="attr_bonusReaction" value="0" readonly="readonly"/>
  <input type="hidden" name="attr_bonusDefense" value="0" readonly="readonly"/>
  <input type="hidden" name="attr_styleSimple" value="[[@{atkAkimbo}]]+[[@{atkAmbidextre}]]+[[@{atkCouvert}]]+[[@{atkDefensif}]]+[[@{atkAgressif}]]"/>
  <input class="armureListe" type="hidden" name="attr_armure" value="sans"/>
  <input class="armureLegendeListe" type="hidden" name="attr_armureLegende" value="sans"/>
  <input class="tabEgide" type="hidden" name="attr_tabEgide" value="0"/>
  <input class="tabResilience" type="hidden" name="attr_tabResilience" value="0"/>
  <input class="tabArmureLegende" type="hidden" name="attr_tabArmureLegende" value="0"/>
  <input class="capacitesFanMade" type="hidden" name="attr_capaciteFanMade" value="0"/>
  <input class="phase2" type="hidden" name="attr_phase2" value="0"/>
  <input class="herauts" type="hidden" name="attr_chevaliersHerauts" value="0"/><div class="tabDossier tab">
    <div class="col">
        <div class="identite">
            <h1 class="fichePJ fichePNJ ficheCreature ficheBande titre" data-i18n="carte-d'identite">Carte d'identité</h1>
            <label class="fichePJ fichePNJ ficheCreature ficheBande">
                <span data-i18n="nom">Nom</span>
                <input type="text" name="attr_character_name" />
            </label>
            <label class="fichePJ fichePNJ">
                <span data-i18n="surnom">Surnom</span>
                <input type="text" name="attr_surnom" />
            </label>
            <label class="fichePJ fichePNJ">
                <span data-i18n="age">Âge</span>
                <input type="text" name="attr_age" />
            </label>
            <label class="fichePJ">
                <span data-i18n="archetype">Archetype</span>
                <input type="text" name="attr_archetype" />
            </label>
            <label class="fichePNJ">
                <span data-i18n="archetype/metier">Archetype/Métier</span>
                <input type="text" name="attr_archetype" />
            </label>
            <label  class="fichePJ fichePNJ">
                <span data-i18n="haut-fait">Haut-Fait</span>
                <input type="text" name="attr_hautFait" />
            </label>
            <div class="fichePJ armurePorte">
                <input class="porte" type="hidden" name="attr_armure" value="sans" />
                <input class="choixArmure" type="hidden" name="attr_choixArmure" value="choix" />

                <button class="principalA choix" type="action" name="act_choixArmure" data-i18n="choisir-meta-armure">Choisir ma Méta-Armure</button>

                <button class="principalB barbarian" type="action" name="act_barbarian" data-i18n="barbarian">Barbarian</button>
                <button class="principalB bard" type="action" name="act_bard" data-i18n="bard">Bard</button>
                <button class="principalB berserk" type="action" name="act_berserk" data-i18n="berserk">Berserk</button>
                <button class="principalB druid" type="action" name="act_druid" data-i18n="druid">Druid</button>
                <button class="principalB monk" type="action" name="act_monk" data-i18n="monk">Monk</button>
                <button class="principalB necromancer" type="action" name="act_necromancer" data-i18n="necromancer">Necromancer</button>
                <button class="principalB paladin" type="action" name="act_paladin" data-i18n="paladin">Paladin</button>
                <button class="principalB priest" type="action" name="act_priest" data-i18n="priest">Priest</button>
                <button class="principalB psion" type="action" name="act_psion" data-i18n="psion">Psion</button>
                <button class="principalB ranger" type="action" name="act_ranger" data-i18n="ranger">Ranger</button>
                <button class="principalB rogue" type="action" name="act_rogue" data-i18n="rogue">Rogue</button>
                <button class="principalB shaman" type="action" name="act_shaman" data-i18n="shaman">Shaman</button>
                <button class="principalB sorcerer" type="action" name="act_sorcerer" data-i18n="sorcerer">Sorcerer</button>
                <button class="principalB warlock" type="action" name="act_warlock" data-i18n="warlock">Warlock</button>
                <button class="principalB warmaster" type="action" name="act_warmaster" data-i18n="warmaster">Warmaster</button>
                <button class="principalB warrior" type="action" name="act_warrior" data-i18n="warrior">Warrior</button>
                <button class="principalB wizard" type="action" name="act_wizard" data-i18n="wizard">Wizard</button>

                <button class="secondaire guardian" type="action" name="act_guardian" data-i18n="guardian">Guardian</button>
                <button class="secondaire sans" type="action" name="act_sans" data-i18n="tenue-civile">Tenue Civil</button>
            </div>
            <label class="fichePJ armureLegende">
                <span data-i18n="meta-armure-legende">Méta-armure de légende</span>
                <select name="attr_armureLegende">
                    <option value="sans" selected></option>
                    <option value="barbarian" data-i18n="barbarian">Barbarian</option>
                    <option value="bard" data-i18n="bard">Bard</option>
                    <option value="druid" data-i18n="druid">Druid</option>
                    <option value="paladin" data-i18n="paladin">Paladin</option>
                    <option value="priest" data-i18n="priest">Priest</option>
                    <option value="psion" data-i18n="psion">Psion</option>
                    <option value="ranger" data-i18n="ranger">Ranger</option>
                    <option value="rogue" data-i18n="rogue">Rogue</option>
                    <option value="shaman" data-i18n="shaman">Shaman</option>
                    <option value="warlock" data-i18n="warlock">Warlock</option>
                    <option value="warmaster" data-i18n="warmaster">Warmaster</option>
                    <option value="warrior" data-i18n="warrior">Warrior</option>
                    <option value="wizard" data-i18n="wizard">Wizard</option>
                </select>
            </label>
            <label class="fichePNJ">
                <span data-i18n="armure">Armure</span>
                <input type="text" name="attr_nomArmurePNJ" />
            </label>
            <label class="fichePJ">
                <span data-i18n="section-d'origine">Section d'origine</span>
                <input type="text" name="attr_blasonVoeux" />
            </label>
            <label class="fichePJ">
                <span data-i18n="blason">Blason</span>
                <input type="text" name="attr_blason" />
            </label>
            <h1 class="fichePJ titre" data-i18n="motivation-majeure">Motivation Majeure</h1>
            <div class="fichePJ autoex autoex40">
                <span name="attr_motivationMajeure"></span>
                <textarea name="attr_motivationMajeure"></textarea>
            </div>
            <div class="fichePJ titre">
                <h1 class="fichePJ titre" data-i18n="motivations-mineures">Motivations Mineures</h1>
                <button type="action" class="fichePJ rollSpecial" name="act_recuperation" value="@{jetGM} &{template:base} {{Nom=@{name}}} {{type=Motivation mineure}} {{jet=[[1d6]]}} @{bonusGainEspoir}" data-i18n="recuperation">Récupération</button>
            </div>
            <div class="fichePJ button">
                <div>
                    <span data-i18n="bonus-gain-espoir">Bonus au gain d'espoir</span>
                    <label class="fakeButton">
                        <input type="checkbox" name="attr_bonusGainEspoir" value="{{gainBonus=[[@{gainEBonus}]]}}" />
                        <span data-i18n-title="appliquer-bonus" title="Appliquer le bonus"></span>
                        <span data-i18n-title="bonus-applique" title="Bonus appliqué"></span>
                    </label>
                </div>
                <input type="number" name="attr_gainEBonus" value="0" />
            </div>
            
            <div class="fichePJ repeating">
                <fieldset class="repeating_motMineure">
                    <div class="autoex autoex40">
                        <span name="attr_motivationMineure"></span>
                        <textarea name="attr_motivationMineure"></textarea>
                    </div>
                </fieldset>
            </div>
            <label class="fichePNJ ficheCreature ficheBande">
                <span data-i18n="type">Type</span>
                <input type="text" name="attr_typePNJ" />
            </label>
            <h1 class="fichePNJ ficheCreature ficheBande titre" data-i18n="tactique">Tactique</h1>
            <div class="fichePNJ ficheCreature ficheBande autoex autoex100">
                <span name="attr_tactiquePNJ"></span>
                <textarea name="attr_tactiquePNJ"></textarea>
            </div>
        </div>
        
        <div class="jet">
            <input type="hidden" name="attr_bonusCarac" class="bonusCarac" value="0" />
            <div class="fichePJ fichePNJ ficheCreature ficheBande titre">
                <button type="action" class="fichePJ bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                <button type="action" class="fichePJ bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>

                <h1 class="fichePJ fichePNJ ficheCreature ficheBande titre" data-i18n="jet">Jet</h1>
                <button type="action" name="act_simple" class="fichePJ rollDice" value="@{jetGM} &{template:simple} {{Nom=@{name}}}"></button>
                
                <button type="action" name="act_simplePNJ" class="fichePNJ ficheCreature ficheBande rollDice" value="@{jetGM} &{template:simple} {{Nom=@{name}}}"></button>
            </div>
            <label>
                <span data-i18n="bonus/malus-jets">Bonus/Malus aux Jets</span>
                <input type="number" name="attr_jetModifDes" value="0" />
            </label>
            <div class="fichePJ rollPJ">
                <select name="attr_caracteristique1">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
                <select name="attr_caracteristique2">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
            </div>
            
            <div class="bonusCarac">
                <select name="attr_caracteristique3">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
                <select name="attr_caracteristique4">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
            </div>
            <div class="fichePNJ ficheCreature ficheBande rollPNJ">
                <select name="attr_aspectPNJ">
                    <option value="0" selected></option>
                    <option value="@{Chair}" data-i18n="chair">Chair</option>
                    <option value="@{Bete}" data-i18n="bête">Bête</option>
                    <option value="@{Machine}" data-i18n="machine">Machine</option>
                    <option value="@{Dame}" data-i18n="dame">Dame</option>
                    <option value="@{Masque}" data-i18n="masque">Masque</option>
                </select>
            </div>
        </div>

        <div class="fichePJ armure dataArmure">
            <div class="fichePJ titre">
                <h1 class="fichePJ titre"><span name="attr_armure" data-i18n-dynamic></span></h1>
                <button class="actionSpecial" type="action" name="act_resetArmure" data-i18n="tout-restaurer">Tout Restaurer</button>
            </div>
            <div class="ligneTitre">
                <span></span>
                <span data-i18n="actuel">Actuel</span>
                <span data-i18n="maximum">Maximum</span>
                <span data-i18n="modif">Modif</span>
            </div>
            <div class="ligne3 armure">
                <span data-i18n="armure">Armure</span>
                <div><input type="number" name="attr_armurePJ" value="0" /></div>
                <div><input type="number" name="attr_armurePJ_max" value="0" readonly /></div>
                <div><input type="number" name="attr_armurePJModif" value="0" /></div>
            </div>
            <div class="barbarian bard druid monk necromancer paladin priest psion ranger rogue shaman sorcerer warlock warmaster warrior wizard ligne3">
                <span data-i18n="energie">Energie</span>
                <div><input type="number" name="attr_energiePJ" value="0" /></div>
                <div><input type="number" name="attr_energiePJ_max" value="0" readonly /></div>
                <div><input type="number" name="attr_energiePJModif" value="0" /></div>
            </div>
            <div class="ligne3 armure">
                <span data-i18n="champ-de-force">Champ de force</span>
                <div><input type="number" name="attr_cdfPJ" value="0" readonly /></div>
                <div><input type="number" name="attr_cdfPJ_max" value="0" readonly /></div>
                <div><input type="number" name="attr_cdfPJModif"  value="0" /></div>
            </div>
            <div class="psion flux ligne1">
                <span data-i18n="flux">Flux</span>
                <div><input type="number" class="center" min="0" name="attr_fluxPsion" value="0" /></div>
                <div></div>
                <div></div>
            </div>
        </div>
        
        <div class="fichePJ physiqueMental">
            <h1 class="fichePJ titre" data-i18n="physique-et-mental">Physique et Mental</h1>
            <div class="ligneTitre">
                <span></span>
                <span data-i18n="actuel">Actuel</span>
                <span data-i18n="maximum">Maximum</span>
                <span data-i18n="modif">Modif</span>
            </div>
            <div class="ligne3">
                <span data-i18n="sante">Santé</span>
                <div><input type="number" name="attr_santepj" min="0" value="0" /></div>
                <div><input type="number" name="attr_santepj_max" min="0" value="0" readonly /></div>
                <div><input type="number" name="attr_santeModif" min="0" value="0" /></div>
            </div>
            <div class="ligne3">
                <span data-i18n="espoir">Espoir</span>
                <div><input type="number" name="attr_espoir" min="0" value="50" /></div>
                <div><input type="number" name="attr_espoir_max" min="0" value="50" readonly /></div>
                <div><input type="number" name="attr_espoirModif" value="0" /></div>
            </div>
            <div class="ligne3">
                <span data-i18n="heroisme">Héroïsme</span>
                <div><input type="number" name="attr_heroisme" min="0" max="6" value="0" /></div>
                <div><input type="number" name="attr_heroisme_max" min="0" value="6+@{heroismeModif}" disabled /></div>
                <div><input type="number" name="attr_heroismeModif" min="0" value="0" /></div>
            </div>
        </div>
        
        <div class="fichePNJ ficheCreature ficheBande PES">
            <h1 class="fichePNJ titre" data-i18n="protection-energie-sante">Protections, Énergie et Santé</h1>
            <h1 class="ficheCreature titre" data-i18n="protection-sante">Protections et Santé</h1>
            <h1 class="ficheBande titre" data-i18n="protection-cohension">Protections et Cohésion</h1>
            <div class="ligneTitre">
                <span></span>
                <span data-i18n="actuel">Actuel</span>
                <span data-i18n="maximum">Maximum</span>
            </div>
            <div class="ligne2">
                <span class="fichePNJ ficheCreature ficheBande" data-i18n="armure">Armure</span>
                <div><input type="number" name="attr_armurePNJ" min="0" value="0" /></div>
                <div><input type="number" name="attr_armurePNJ_max" min="0" value="0" /></div>
            </div>
            <div class="fichePNJ ligne2">
                <span class="fichePNJ" data-i18n="energie">Energie</span>
                <div><input type="number" name="attr_energiePNJ" min="0" value="0" /></div>
                <div><input type="number" name="attr_energiePNJ_max" min="0" value="0" /></div>
            </div>
            <div class="fichePNJ ligne2">
                <span class="fichePNJ" data-i18n="champ-de-force">Champ de force</span>
                <div><input type="number" name="attr_cdfPNJ" min="0" value="0" /></div>
                <div><input type="number" name="attr_cdfPNJ_max" min="0" value="0" /></div>
            </div>
            <div class="ligne2">
                <span class="fichePNJ ficheCreature ficheBande" data-i18n="bouclier">Bouclier</span>
                <div><input type="number" name="attr_bouclierPNJ" min="0" value="0" /></div>
                <div><input type="number" name="attr_bouclierPNJ_max" min="0" value="0" /></div>
            </div>
            <div class="ligne2">
                <span class="fichePNJ ficheCreature" data-i18n="sante">Santé</span>
                <span class="ficheBande" data-i18n="cohesion">Cohésion</span>
                <div><input type="number" name="attr_santePNJ" min="0" value="0" /></div>
                <div><input type="number" name="attr_santePNJ_max" min="0" value="0" /></div>
            </div>
            <div class="fichePNJ ficheCreature resilience">
                <div>
                    <span data-i18n="resilience">Résilience</span>
                    <button type="action" name="act_calculerResilience" data-i18n="calculer">Calculer</button>
                </div>
                <div><input type="number" name="attr_resilience" min="0" value="0" /></div>
                <div><input type="number" name="attr_resilience_max" min="0" value="0" /></div>
            </div>
        </div>

        <div class="fichePJ fichePNJ ficheCreature egide">
            <div class="fichePJ fichePNJ ficheCreature titre">
                <h1 class="fichePJ fichePNJ ficheCreature titre" data-i18n="egide">Égide</h1>
                <button type="roll" class="rollDice" name="roll_egide" value="@{jetGM} &{template:base} {{Nom=@{name}}} {{type=^{egide}}} {{jet=[[{[[@{egideTotal}]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}"></button>
            </div>
            <div class="ligneTitre">
                <span data-i18n="base">Base</span>
                <span data-i18n="bonus">Bonus</span>
                <span data-i18n="total">Total</span>
            </div>
            <div class="ligne3">
                <div><input type="number" name="attr_egide" value="0" /></div>
                <div><input type="number" name="attr_egideBonus" value="0" readonly /></div>
                <div><input type="number" name="attr_egideTotal" value="@{egide}+@{egideBonus}" disabled /></div>
            </div>
        </div>
                    
        <div class="ficheBande debordement">
            <div class="ficheBande titre">
                <h1 class="ficheBande titre" data-i18n="debordement">Débordement</h1>
                <button class="rollDice" type="roll" name="roll_debordement" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{jDivers=^{debordement}}} {{jDiversV=[[@{bandeDebordement}*@{bandeDebordementTActuel}]]}}" ></button>
            </div>
            <div class="ligneTitre">
                <span data-i18n="score">Score</span>
                <span data-i18n="tour-actuel">Tour Actuel</span>
            </div>
            <div class="ligne2">
                <div><input type="number" name="attr_bandeDebordement" min="0" value="0" /></div>
                <div><input type="number" name="attr_bandeDebordementTActuel" min="0" value="0" /></div>
            </div>
        </div>
    </div>
    
    <div class="col">
        <div class="stats">
            <h1 class="titre" data-i18n="chair">Chair</h1>
            <div class="ligne">
                <div class="fichePJ">
                    <div>
                        <label>
                            <span data-i18n="deplacement">Déplacement</span>
                            <input type="number" name="attr_deplacement" value="1" min="1" />
                        </label>
                        <label>
                            <span data-i18n="od">OD</span>
                            <input type="number" name="attr_deplOD" value="0" min="0" max="5" />
                        </label>
                    </div>
                    <div>
                        <label>
                            <span data-i18n="force">Force</span>
                            <input type="number" name="attr_force" value="1" min="1" />
                        </label>
                        <label>
                            <span data-i18n="od">OD</span>
                            <input type="number" name="attr_forOD" value="0" min="0" max="5" />
                        </label>
                    </div>
                    <div>
                        <label>
                            <span data-i18n="endurance">Endurance</span>
                            <input type="number" name="attr_endurance" value="1" min="1" />
                        </label>
                        <label>
                            <span data-i18n="od">OD</span>
                            <input type="number" name="attr_endOD" value="0" min="0" max="5" />
                        </label>
                    </div>
                </div>
                <div class="fichePNJ ficheCreature ficheBande">
                    <span data-i18n="aspects-exceptionnels">Aspects exceptionnels</span>
                    <select name="attr_ChairPNJAE">
                        <option value="0" data-i18n="mineur-(0)">Mineur (0)</option>
                        <option value="1" data-i18n="mineur-(1)">Mineur (1)</option>
                        <option value="2" data-i18n="mineur-(2)">Mineur (2)</option>
                        <option value="3" data-i18n="mineur-(3)">Mineur (3)</option>
                        <option value="4" data-i18n="mineur-(4)">Mineur (4)</option>
                        <option value="5" data-i18n="mineur-(5)">Mineur (5)</option>
                        <option value="6" data-i18n="mineur-(6)">Mineur (6)</option>
                        <option value="7" data-i18n="mineur-(7)">Mineur (7)</option>
                        <option value="8" data-i18n="mineur-(8)">Mineur (8)</option>
                        <option value="9" data-i18n="mineur-(9)">Mineur (9)</option>
                        <option value="10" data-i18n="mineur-(10)">Mineur (10)</option>
                        <option value="11" data-i18n="mineur-(11)">Mineur (11)</option>
                        <option value="12" data-i18n="mineur-(12)">Mineur (12)</option>
                        <option value="13" data-i18n="mineur-(13)">Mineur (13)</option>
                        <option value="14" data-i18n="mineur-(14)">Mineur (14)</option>
                        <option value="15" data-i18n="mineur-(15)">Mineur (15)</option>
                        <option value="16" data-i18n="mineur-(16)">Mineur (16)</option>
                        <option value="17" data-i18n="mineur-(17)">Mineur (17)</option>
                        <option value="18" data-i18n="mineur-(18)">Mineur (18)</option>
                        <option value="19" data-i18n="mineur-(19)">Mineur (19)</option>
                        <option value="20" data-i18n="mineur-(20)">Mineur (20)</option>
                    </select>
                    <select name="attr_ChairPNJAEMaj">
                        <option value="0" data-i18n="majeur-(0)">Majeur (0)</option>
                        <option value="1" data-i18n="majeur-(1)">Majeur (1)</option>
                        <option value="2" data-i18n="majeur-(2)">Majeur (2)</option>
                        <option value="3" data-i18n="majeur-(3)">Majeur (3)</option>
                        <option value="4" data-i18n="majeur-(4)">Majeur (4)</option>
                        <option value="5" data-i18n="majeur-(5)">Majeur (5)</option>
                        <option value="6" data-i18n="majeur-(6)">Majeur (6)</option>
                        <option value="7" data-i18n="majeur-(7)">Majeur (7)</option>
                        <option value="8" data-i18n="majeur-(8)">Majeur (8)</option>
                        <option value="9" data-i18n="majeur-(9)">Majeur (9)</option>
                        <option value="10" data-i18n="majeur-(10)">Majeur (10)</option>
                        <option value="11" data-i18n="majeur-(11)">Majeur (11)</option>
                        <option value="12" data-i18n="majeur-(12)">Majeur (12)</option>
                        <option value="13" data-i18n="majeur-(13)">Majeur (13)</option>
                        <option value="14" data-i18n="majeur-(14)">Majeur (14)</option>
                        <option value="15" data-i18n="majeur-(15)">Majeur (15)</option>
                        <option value="16" data-i18n="majeur-(16)">Majeur (16)</option>
                        <option value="17" data-i18n="majeur-(17)">Majeur (17)</option>
                        <option value="18" data-i18n="majeur-(18)">Majeur (18)</option>
                        <option value="19" data-i18n="majeur-(19)">Majeur (19)</option>
                        <option value="20" data-i18n="majeur-(20)">Majeur (20)</option>
                    </select>
                </div>
                <input class="aspect" type="number" name="attr_Chair" value="2" min="0" />
            </div>
            <div class="fichePJ autoex autoex40">
                <span name="attr_chairOD"></span>
                <textarea name="attr_chairOD"></textarea>
            </div>
        </div>
        
        <div class="stats">
            <h1 class="titre" data-i18n="bete">Bête</h1>
            <div class="ligne">
                <div class="fichePJ">
                    <div>
                        <label>
                            <span data-i18n="hargne">Hargne</span>
                            <input type="number" name="attr_hargne" value="1" min="1" />
                        </label>
                        <label>
                            <span data-i18n="od">OD</span>
                            <input type="number" name="attr_hargneOD" value="0" min="0" max="5" />
                        </label>
                    </div>
                    <div>
                        <label>
                            <span data-i18n="combat">Combat</span>
                            <input type="number" name="attr_combat" value="1" min="1" />
                        </label>
                        <label>
                            <span data-i18n="od">OD</span>
                            <input type="number" name="attr_combOD" value="0" min="0" max="5" />
                        </label>
                    </div>
                    <div>
                        <label>
                            <span data-i18n="instinct">Instinct</span>
                            <input type="number" name="attr_instinct" value="1" min="1" />
                        </label>
                        <label>
                            <span data-i18n="od">OD</span>
                            <input type="number" name="attr_instOD" value="0" min="0" max="5" />
                        </label>
                    </div>
                </div>
                <div class="fichePNJ ficheCreature ficheBande">
                    <span data-i18n="aspects-exceptionnels">Aspects exceptionnels</span>
                    <select name="attr_BetePNJAE">
                        <option value="0" data-i18n="mineur-(0)">Mineur (0)</option>
                        <option value="1" data-i18n="mineur-(1)">Mineur (1)</option>
                        <option value="2" data-i18n="mineur-(2)">Mineur (2)</option>
                        <option value="3" data-i18n="mineur-(3)">Mineur (3)</option>
                        <option value="4" data-i18n="mineur-(4)">Mineur (4)</option>
                        <option value="5" data-i18n="mineur-(5)">Mineur (5)</option>
                        <option value="6" data-i18n="mineur-(6)">Mineur (6)</option>
                        <option value="7" data-i18n="mineur-(7)">Mineur (7)</option>
                        <option value="8" data-i18n="mineur-(8)">Mineur (8)</option>
                        <option value="9" data-i18n="mineur-(9)">Mineur (9)</option>
                        <option value="10" data-i18n="mineur-(10)">Mineur (10)</option>
                        <option value="11" data-i18n="mineur-(11)">Mineur (11)</option>
                        <option value="12" data-i18n="mineur-(12)">Mineur (12)</option>
                        <option value="13" data-i18n="mineur-(13)">Mineur (13)</option>
                        <option value="14" data-i18n="mineur-(14)">Mineur (14)</option>
                        <option value="15" data-i18n="mineur-(15)">Mineur (15)</option>
                        <option value="16" data-i18n="mineur-(16)">Mineur (16)</option>
                        <option value="17" data-i18n="mineur-(17)">Mineur (17)</option>
                        <option value="18" data-i18n="mineur-(18)">Mineur (18)</option>
                        <option value="19" data-i18n="mineur-(19)">Mineur (19)</option>
                        <option value="20" data-i18n="mineur-(20)">Mineur (20)</option>
                    </select>
                    <select name="attr_BetePNJAEMaj">
                        <option value="0" data-i18n="majeur-(0)">Majeur (0)</option>
                        <option value="1" data-i18n="majeur-(1)">Majeur (1)</option>
                        <option value="2" data-i18n="majeur-(2)">Majeur (2)</option>
                        <option value="3" data-i18n="majeur-(3)">Majeur (3)</option>
                        <option value="4" data-i18n="majeur-(4)">Majeur (4)</option>
                        <option value="5" data-i18n="majeur-(5)">Majeur (5)</option>
                        <option value="6" data-i18n="majeur-(6)">Majeur (6)</option>
                        <option value="7" data-i18n="majeur-(7)">Majeur (7)</option>
                        <option value="8" data-i18n="majeur-(8)">Majeur (8)</option>
                        <option value="9" data-i18n="majeur-(9)">Majeur (9)</option>
                        <option value="10" data-i18n="majeur-(10)">Majeur (10)</option>
                        <option value="11" data-i18n="majeur-(11)">Majeur (11)</option>
                        <option value="12" data-i18n="majeur-(12)">Majeur (12)</option>
                        <option value="13" data-i18n="majeur-(13)">Majeur (13)</option>
                        <option value="14" data-i18n="majeur-(14)">Majeur (14)</option>
                        <option value="15" data-i18n="majeur-(15)">Majeur (15)</option>
                        <option value="16" data-i18n="majeur-(16)">Majeur (16)</option>
                        <option value="17" data-i18n="majeur-(17)">Majeur (17)</option>
                        <option value="18" data-i18n="majeur-(18)">Majeur (18)</option>
                        <option value="19" data-i18n="majeur-(19)">Majeur (19)</option>
                        <option value="20" data-i18n="majeur-(20)">Majeur (20)</option>
                    </select>
                </div>
                <input class="aspect" type="number" name="attr_bete" value="2" min="0" />
            </div>
            <div class="fichePJ autoex autoex40">
                <span name="attr_beteOD"></span>
                <textarea name="attr_beteOD"></textarea>
            </div>
        </div>
        
        <div class="stats">
            <h1 class="titre" data-i18n="machine">Machine</h1>
            <div class="ligne">
                <div class="fichePJ">
                    <div>
                        <label>
                            <span data-i18n="tir">Tir</span>
                            <input type="number" name="attr_tir" value="1" min="1" />
                        </label>
                        <label>
                            <span data-i18n="od">OD</span>
                            <input type="number" name="attr_tirOD" value="0" min="0" max="5" />
                        </label>
                    </div>
                    <div>
                        <label>
                            <span data-i18n="savoir">Savoir</span>
                            <input type="number" name="attr_savoir" value="1" min="1" />
                        </label>
                        <label>
                            <span data-i18n="od">OD</span>
                            <input type="number" name="attr_savoirOD" value="0" min="0" max="5" />
                        </label>
                    </div>
                    <div>
                        <label>
                            <span data-i18n="technique">Technique</span>
                            <input type="number" name="attr_technique" value="1" min="1" />
                        </label>
                        <label>
                            <span data-i18n="od">OD</span>
                            <input type="number" name="attr_technOD" value="0" min="0" max="5" />
                        </label>
                    </div>
                </div>
                <div class="fichePNJ ficheCreature ficheBande">
                    <span data-i18n="aspects-exceptionnels">Aspects exceptionnels</span>
                    <select name="attr_MachinePNJAE">
                        <option value="0" data-i18n="mineur-(0)">Mineur (0)</option>
                        <option value="1" data-i18n="mineur-(1)">Mineur (1)</option>
                        <option value="2" data-i18n="mineur-(2)">Mineur (2)</option>
                        <option value="3" data-i18n="mineur-(3)">Mineur (3)</option>
                        <option value="4" data-i18n="mineur-(4)">Mineur (4)</option>
                        <option value="5" data-i18n="mineur-(5)">Mineur (5)</option>
                        <option value="6" data-i18n="mineur-(6)">Mineur (6)</option>
                        <option value="7" data-i18n="mineur-(7)">Mineur (7)</option>
                        <option value="8" data-i18n="mineur-(8)">Mineur (8)</option>
                        <option value="9" data-i18n="mineur-(9)">Mineur (9)</option>
                        <option value="10" data-i18n="mineur-(10)">Mineur (10)</option>
                        <option value="11" data-i18n="mineur-(11)">Mineur (11)</option>
                        <option value="12" data-i18n="mineur-(12)">Mineur (12)</option>
                        <option value="13" data-i18n="mineur-(13)">Mineur (13)</option>
                        <option value="14" data-i18n="mineur-(14)">Mineur (14)</option>
                        <option value="15" data-i18n="mineur-(15)">Mineur (15)</option>
                        <option value="16" data-i18n="mineur-(16)">Mineur (16)</option>
                        <option value="17" data-i18n="mineur-(17)">Mineur (17)</option>
                        <option value="18" data-i18n="mineur-(18)">Mineur (18)</option>
                        <option value="19" data-i18n="mineur-(19)">Mineur (19)</option>
                        <option value="20" data-i18n="mineur-(20)">Mineur (20)</option>
                    </select>
                    <select name="attr_MachinePNJAEMaj">
                        <option value="0" data-i18n="majeur-(0)">Majeur (0)</option>
                        <option value="1" data-i18n="majeur-(1)">Majeur (1)</option>
                        <option value="2" data-i18n="majeur-(2)">Majeur (2)</option>
                        <option value="3" data-i18n="majeur-(3)">Majeur (3)</option>
                        <option value="4" data-i18n="majeur-(4)">Majeur (4)</option>
                        <option value="5" data-i18n="majeur-(5)">Majeur (5)</option>
                        <option value="6" data-i18n="majeur-(6)">Majeur (6)</option>
                        <option value="7" data-i18n="majeur-(7)">Majeur (7)</option>
                        <option value="8" data-i18n="majeur-(8)">Majeur (8)</option>
                        <option value="9" data-i18n="majeur-(9)">Majeur (9)</option>
                        <option value="10" data-i18n="majeur-(10)">Majeur (10)</option>
                        <option value="11" data-i18n="majeur-(11)">Majeur (11)</option>
                        <option value="12" data-i18n="majeur-(12)">Majeur (12)</option>
                        <option value="13" data-i18n="majeur-(13)">Majeur (13)</option>
                        <option value="14" data-i18n="majeur-(14)">Majeur (14)</option>
                        <option value="15" data-i18n="majeur-(15)">Majeur (15)</option>
                        <option value="16" data-i18n="majeur-(16)">Majeur (16)</option>
                        <option value="17" data-i18n="majeur-(17)">Majeur (17)</option>
                        <option value="18" data-i18n="majeur-(18)">Majeur (18)</option>
                        <option value="19" data-i18n="majeur-(19)">Majeur (19)</option>
                        <option value="20" data-i18n="majeur-(20)">Majeur (20)</option>
                    </select>
                </div>
                <input class="aspect" type="number" name="attr_machine" value="2" min="0" />
            </div>
            <div class="fichePJ autoex autoex40">
                <span name="attr_machineOD"></span>
                <textarea name="attr_machineOD"></textarea>
            </div>
        </div>
        
        <div class="stats">
            <h1 class="titre" data-i18n="dame">Dame</h1>
            <div class="ligne">
                <div class="fichePJ">
                    <div>
                        <label>
                            <span data-i18n="aura">Aura</span>
                            <input type="number" name="attr_aura" value="1" min="1" />
                        </label>
                        <label>
                            <span data-i18n="od">OD</span>
                            <input type="number" name="attr_auraOD" value="0" min="0" max="5" />
                        </label>
                    </div>
                    <div>
                        <label>
                            <span data-i18n="parole">Parole</span>
                            <input type="number" name="attr_parole" value="1" min="1" />
                        </label>
                        <label>
                            <span data-i18n="od">OD</span>
                            <input type="number" name="attr_paroleOD" value="0" min="0" max="5" />
                        </label>
                    </div>
                    <div>
                        <label>
                            <span data-i18n="sang-froid">Sang-Froid</span>
                            <input type="number" name="attr_sf" value="1" min="1" />
                        </label>
                        <label>
                            <span data-i18n="od">OD</span>
                            <input type="number" name="attr_sfOD" value="0" min="0" max="5" />
                        </label>
                    </div>
                </div>
                <div class="fichePNJ ficheCreature ficheBande">
                    <span data-i18n="aspects-exceptionnels">Aspects exceptionnels</span>
                    <select name="attr_DamePNJAE">
                        <option value="0" data-i18n="mineur-(0)">Mineur (0)</option>
                        <option value="1" data-i18n="mineur-(1)">Mineur (1)</option>
                        <option value="2" data-i18n="mineur-(2)">Mineur (2)</option>
                        <option value="3" data-i18n="mineur-(3)">Mineur (3)</option>
                        <option value="4" data-i18n="mineur-(4)">Mineur (4)</option>
                        <option value="5" data-i18n="mineur-(5)">Mineur (5)</option>
                        <option value="6" data-i18n="mineur-(6)">Mineur (6)</option>
                        <option value="7" data-i18n="mineur-(7)">Mineur (7)</option>
                        <option value="8" data-i18n="mineur-(8)">Mineur (8)</option>
                        <option value="9" data-i18n="mineur-(9)">Mineur (9)</option>
                        <option value="10" data-i18n="mineur-(10)">Mineur (10)</option>
                        <option value="11" data-i18n="mineur-(11)">Mineur (11)</option>
                        <option value="12" data-i18n="mineur-(12)">Mineur (12)</option>
                        <option value="13" data-i18n="mineur-(13)">Mineur (13)</option>
                        <option value="14" data-i18n="mineur-(14)">Mineur (14)</option>
                        <option value="15" data-i18n="mineur-(15)">Mineur (15)</option>
                        <option value="16" data-i18n="mineur-(16)">Mineur (16)</option>
                        <option value="17" data-i18n="mineur-(17)">Mineur (17)</option>
                        <option value="18" data-i18n="mineur-(18)">Mineur (18)</option>
                        <option value="19" data-i18n="mineur-(19)">Mineur (19)</option>
                        <option value="20" data-i18n="mineur-(20)">Mineur (20)</option>
                    </select>
                    <select name="attr_DamePNJAEMaj">
                        <option value="0" data-i18n="majeur-(0)">Majeur (0)</option>
                        <option value="1" data-i18n="majeur-(1)">Majeur (1)</option>
                        <option value="2" data-i18n="majeur-(2)">Majeur (2)</option>
                        <option value="3" data-i18n="majeur-(3)">Majeur (3)</option>
                        <option value="4" data-i18n="majeur-(4)">Majeur (4)</option>
                        <option value="5" data-i18n="majeur-(5)">Majeur (5)</option>
                        <option value="6" data-i18n="majeur-(6)">Majeur (6)</option>
                        <option value="7" data-i18n="majeur-(7)">Majeur (7)</option>
                        <option value="8" data-i18n="majeur-(8)">Majeur (8)</option>
                        <option value="9" data-i18n="majeur-(9)">Majeur (9)</option>
                        <option value="10" data-i18n="majeur-(10)">Majeur (10)</option>
                        <option value="11" data-i18n="majeur-(11)">Majeur (11)</option>
                        <option value="12" data-i18n="majeur-(12)">Majeur (12)</option>
                        <option value="13" data-i18n="majeur-(13)">Majeur (13)</option>
                        <option value="14" data-i18n="majeur-(14)">Majeur (14)</option>
                        <option value="15" data-i18n="majeur-(15)">Majeur (15)</option>
                        <option value="16" data-i18n="majeur-(16)">Majeur (16)</option>
                        <option value="17" data-i18n="majeur-(17)">Majeur (17)</option>
                        <option value="18" data-i18n="majeur-(18)">Majeur (18)</option>
                        <option value="19" data-i18n="majeur-(19)">Majeur (19)</option>
                        <option value="20" data-i18n="majeur-(20)">Majeur (20)</option>
                    </select>
                </div>
                <input class="aspect" type="number" name="attr_dame" value="2" min="0" />
            </div>
            <div class="fichePJ autoex autoex40">
                <span name="attr_dameOD"></span>
                <textarea name="attr_dameOD"></textarea>
            </div>
        </div>
        
        <div class="stats">
            <h1 class="titre" data-i18n="masque">Masque</h1>
            <div class="ligne">
                <div class="fichePJ">
                    <div>
                        <label>
                            <span data-i18n="discretion">Discrétion</span>
                            <input type="number" name="attr_discretion" value="1" min="1" />
                        </label>
                        <label>
                            <span data-i18n="od">OD</span>
                            <input type="number" name="attr_discrOD" value="0" min="0" max="5" />
                        </label>
                    </div>
                    <div>
                        <label>
                            <span data-i18n="dexterite">Dextérité</span>
                            <input type="number" name="attr_dexterite" value="1" min="1" />
                        </label>
                        <label>
                            <span data-i18n="od">OD</span>
                            <input type="number" name="attr_dextOD" value="0" min="0" max="5" />
                        </label>
                    </div>
                    <div>
                        <label>
                            <span data-i18n="perception">Perception</span>
                            <input type="number" name="attr_perception" value="1" min="1" />
                        </label>
                        <label>
                            <span data-i18n="od">OD</span>
                            <input type="number" name="attr_percOD" value="0" min="0" max="5" />
                        </label>
                    </div>
                </div>
                <div class="fichePNJ ficheCreature ficheBande">
                    <span data-i18n="aspects-exceptionnels">Aspects exceptionnels</span>
                    <select name="attr_MasquePNJAE">
                        <option value="0" data-i18n="mineur-(0)">Mineur (0)</option>
                        <option value="1" data-i18n="mineur-(1)">Mineur (1)</option>
                        <option value="2" data-i18n="mineur-(2)">Mineur (2)</option>
                        <option value="3" data-i18n="mineur-(3)">Mineur (3)</option>
                        <option value="4" data-i18n="mineur-(4)">Mineur (4)</option>
                        <option value="5" data-i18n="mineur-(5)">Mineur (5)</option>
                        <option value="6" data-i18n="mineur-(6)">Mineur (6)</option>
                        <option value="7" data-i18n="mineur-(7)">Mineur (7)</option>
                        <option value="8" data-i18n="mineur-(8)">Mineur (8)</option>
                        <option value="9" data-i18n="mineur-(9)">Mineur (9)</option>
                        <option value="10" data-i18n="mineur-(10)">Mineur (10)</option>
                        <option value="11" data-i18n="mineur-(11)">Mineur (11)</option>
                        <option value="12" data-i18n="mineur-(12)">Mineur (12)</option>
                        <option value="13" data-i18n="mineur-(13)">Mineur (13)</option>
                        <option value="14" data-i18n="mineur-(14)">Mineur (14)</option>
                        <option value="15" data-i18n="mineur-(15)">Mineur (15)</option>
                        <option value="16" data-i18n="mineur-(16)">Mineur (16)</option>
                        <option value="17" data-i18n="mineur-(17)">Mineur (17)</option>
                        <option value="18" data-i18n="mineur-(18)">Mineur (18)</option>
                        <option value="19" data-i18n="mineur-(19)">Mineur (19)</option>
                        <option value="20" data-i18n="mineur-(20)">Mineur (20)</option>
                    </select>
                    <select name="attr_MasquePNJAEMaj">
                        <option value="0" data-i18n="majeur-(0)">Majeur (0)</option>
                        <option value="1" data-i18n="majeur-(1)">Majeur (1)</option>
                        <option value="2" data-i18n="majeur-(2)">Majeur (2)</option>
                        <option value="3" data-i18n="majeur-(3)">Majeur (3)</option>
                        <option value="4" data-i18n="majeur-(4)">Majeur (4)</option>
                        <option value="5" data-i18n="majeur-(5)">Majeur (5)</option>
                        <option value="6" data-i18n="majeur-(6)">Majeur (6)</option>
                        <option value="7" data-i18n="majeur-(7)">Majeur (7)</option>
                        <option value="8" data-i18n="majeur-(8)">Majeur (8)</option>
                        <option value="9" data-i18n="majeur-(9)">Majeur (9)</option>
                        <option value="10" data-i18n="majeur-(10)">Majeur (10)</option>
                        <option value="11" data-i18n="majeur-(11)">Majeur (11)</option>
                        <option value="12" data-i18n="majeur-(12)">Majeur (12)</option>
                        <option value="13" data-i18n="majeur-(13)">Majeur (13)</option>
                        <option value="14" data-i18n="majeur-(14)">Majeur (14)</option>
                        <option value="15" data-i18n="majeur-(15)">Majeur (15)</option>
                        <option value="16" data-i18n="majeur-(16)">Majeur (16)</option>
                        <option value="17" data-i18n="majeur-(17)">Majeur (17)</option>
                        <option value="18" data-i18n="majeur-(18)">Majeur (18)</option>
                        <option value="19" data-i18n="majeur-(19)">Majeur (19)</option>
                        <option value="20" data-i18n="majeur-(20)">Majeur (20)</option>
                    </select>
                </div>
                <input class="aspect" type="number" name="attr_masque" value="2" min="0" />
            </div>
            <div class="fichePJ autoex autoex40">
                <span name="attr_masqueOD"></span>
                <textarea name="attr_masqueOD"></textarea>
            </div>
        </div>
        
        <div class="fichePNJ ficheCreature ptsFaibles">
            <h1 class="fichePNJ ficheCreature titre" data-i18n="points-faibles">Points Faibles</h1>
            <div class="autoex autoex22">
                <span name="attr_ptsFaibles"></span>
                <textarea name="attr_ptsFaibles"></textarea>
            </div>
        </div>
    </div>
</div><div class="tabArmure tab">
    <div class="col">
        <div class="fichePJ armure dataArmure">
            <div class="titre">
                <h1 class="titre"><span name="attr_armure" data-i18n-dynamic></span></h1>
                <button class="actionSpecial" type="action" name="act_resetArmure" data-i18n="tout-restaurer">Tout Restaurer</button>
            </div>
            <div class="ligneTitre">
                <span></span>
                <span data-i18n="actuel">Actuel</span>
                <span data-i18n="maximum">Maximum</span>
                <span data-i18n="modif">Modif</span>
            </div>
            <div class="ligne3 armure">
                <span data-i18n="armure">Armure</span>
                <div><input type="number" name="attr_armurePJ" value="0" /></div>
                <div><input type="number" name="attr_armurePJ_max" value="0" readonly /></div>
                <div><input type="number" name="attr_armurePJModif" value="0" /></div>
            </div>
            <div class="barbarian bard druid monk necromancer paladin priest psion ranger rogue shaman sorcerer warlock warmaster warrior wizard ligne3">
                <span data-i18n="energie">Energie</span>
                <div><input type="number" name="attr_energiePJ" value="0" /></div>
                <div><input type="number" name="attr_energiePJ_max" value="0" readonly /></div>
                <div><input type="number" name="attr_energiePJModif" value="0" /></div>
            </div>
            <div class="ligne3 armure">
                <span data-i18n="champ-de-force">Champ de force</span>
                <div><input type="number" name="attr_cdfPJ" value="0" readonly /></div>
                <div><input type="number" name="attr_cdfPJ_max" value="0" readonly /></div>
                <div><input type="number" name="attr_cdfPJModif"  value="0" /></div>
            </div>
            <div class="psion flux ligne1">
                <span data-i18n="flux">Flux</span>
                <div><input type="number" class="center" min="0" name="attr_fluxPsion" value="0" /></div>
                <div></div>
                <div></div>
            </div>
        </div>

        <div class="fichePJ sorcerer sorcererPE">
            <h1 data-i18n="sorcerer-ponctionner-l'energie">Ponctionner l'énergie</h1>
            <select name="attr_sorcererPEnergie">
                <option value="1" selected>1D6</option>
                <option value="2">2D6</option>
                <option value="3">3D6</option>
            </select>
            <button class="rollDice" type="roll" name="roll_PEnergieSorc" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special2=^{sorcerer-ponctionner-l'energie}}} {{jDivers=^{energie-ponctionnee}}} {{jDiversV=[[(@{sorcererPEnergie})D6]]}}"></button>
        </div>

        <div class="fichePJ physiqueMental">
            <h1 class="titre" data-i18n="physique-et-mental">Physique et Mental</h1>
            <div class="ligneTitre">
                <span></span>
                <span data-i18n="actuel">Actuel</span>
                <span data-i18n="maximum">Maximum</span>
                <span data-i18n="modif">Modif</span>
            </div>
            <div class="ligne3">
                <span data-i18n="sante">Santé</span>
                <div><input type="number" name="attr_santepj" min="0" value="0" /></div>
                <div><input type="number" name="attr_santepj_max" min="0" value="0" readonly /></div>
                <div><input type="number" name="attr_santeModif" min="0" value="0" /></div>
            </div>
            <div class="ligne3">
                <span data-i18n="espoir">Espoir</span>
                <div><input type="number" name="attr_espoir" min="0" value="50" /></div>
                <div><input type="number" name="attr_espoir_max" min="0" value="50" readonly /></div>
                <div><input type="number" name="attr_espoirModif" value="0" /></div>
            </div>
            <div class="ligne3">
                <span data-i18n="heroisme">Héroïsme</span>
                <div><input type="number" name="attr_heroisme" min="0" max="6" value="0" /></div>
                <div><input type="number" name="attr_heroisme_max" min="0" value="6+@{heroismeModif}" disabled /></div>
                <div><input type="number" name="attr_heroismeModif" min="0" value="0" /></div>
            </div>
        </div>

        <div class="fichePJ egide">
            <div class="titre">
                <h1 class="titre" data-i18n="egide">Égide</h1>
                <button type="roll" class="rollDice" name="roll_egide" value="@{jetGM} &{template:base} {{Nom=@{name}}} {{type=^{egide}}} {{jet=[[{[[@{egideTotal}]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}"></button>
            </div>
            <div class="ligneTitre">
                <span data-i18n="base">Base</span>
                <span data-i18n="bonus">Bonus</span>
                <span data-i18n="total">Total</span>
            </div>
            <div class="ligne3">
                <div><input type="number" name="attr_egide" value="0" /></div>
                <div><input type="number" name="attr_egideBonus" value="0" readonly /></div>
                <div><input type="number" name="attr_egideTotal" value="@{egide}+@{egideBonus}" disabled /></div>
            </div>
        </div>

        <div class="fichePJ barbarian bard berserk druid monk paladin priest psion ranger rogue shaman sorcerer warlock warmaster warrior wizard evolution">
            <h1 class="titre" data-i18n="evolution">Évolution</h1>
            <div class="barbarian ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_barbarian150PG" title="150PG" value="on" />
                    <span data-i18n-title="150-PG" title="150 PG"></span>
                </label>
                <div><span data-i18n="barbariane-150PG-description">Limite de taille à 8 mètres.</span></div>
            </div>
            <div class="barbarian ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_barbarianNoMDefense" title="200PG" value="@{barbarianGoliath}" />
                    <span data-i18n-title="200-PG" title="200 PG"></span>
                </label>
                <div><span data-i18n="barbariane-200PG-description">Pas de malus de défense.</span></div>
            </div>
            <div class="barbarian ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_barbarian250PG" value="on" />
                    <span data-i18n-title="250-PG" title="250 PG"></span>
                </label>
                <div><span data-i18n="barbariane-250PG-description">Limite de taille à 10 mètres.</span></div>
            </div>
            
            <div class="bard ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_bard150PG" value="on" />
                    <span data-i18n-title="150-PG" title="150 PG"></span>
                </label>
                <div><span data-i18n="bard-150PG-description">Portée Moyenne / Peut affecter jusqu'à 4 alliés.</span></div>
            </div>
            <div class="bard ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_bard200PG" value="on" />
                    <span data-i18n-title="200-PG" title="200 PG"></span>
                </label>
                <div><span data-i18n="bard-200PG-description">Le mode changeling coûte 2PE de moins.</span></div>
            </div>
            <div class="bard ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_bard250PG" value="on" />
                    <span data-i18n-title="250-PG" title="250 PG"></span>
                </label>
                <div><span data-i18n="bard-250PG-description">Peut faire exploser son apparence ou ses faux-êtres lors de la désactivation.</span></div>
            </div>
            
            <div class="berserk ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_berserk250PG" value="on" />
                    <span data-i18n-title="250-PG" title="250 PG"></span>
                </label>
                <div><span data-i18n="berserk-250PG-description">Tant qu’il porte la méta-armure, le personnage augmente désormais son total de points d’espoir de 25.<br/>Il reçoit un effet supplémentaire de son choix du mode Illumination.</span></div>
            </div>
            <div class="berserk ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_berserk350PG" value="on" />
                    <span data-i18n-title="350-PG" title="350 PG"></span>
                </label>
                <div><span data-i18n="berserk-350PG-description-1">Les effets Beacon, Blaze et Torch augmentent en efficacité :</span><b data-i18n="berserk-350PG-titre-blaze">Blaze :</b> <span data-i18n="berserk-350PG-description-blaze">Provoque désormais 4D6 (12) points de dégâts et de violence.</span><b data-i18n="berserk-350PG-titre-beacon">Beacon :</b> <span data-i18n="berserk-350PG-description-beacon">Cctroie désormais un bonus de 4 réussites automatiques.</span><b data-i18n="berserk-350PG-titre-torch">Torch :</b> <span data-i18n="berserk-350PG-description-torch">Offre désormais une égide de 4 ou un bonus d’égide de 4.</span><br/><br/><span data-i18n="berserk-350PG-description-2">Le chevalier reçoit un effet supplémentaire de son choix du mode Illumination.</span></div>
            </div>
            <div class="berserk ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_berserk500PG" value="on" />
                    <span data-i18n-title="500-PG" title="500 PG"></span>
                </label>
                <div><span data-i18n="berserk-500PG-description">Désormais, toutes les pertes d’espoir du personnage (en dehors des pertes causées par les capacités de la métaarmure) sont réduites de 3 (minimum 1). L’effet est cumulable avec d’autres avantages ou effets.<br/>Le chevalier reçoit un effet supplémentaire de son choix du mode Illumination.</span></div>
            </div>

            
            <div class="druid ligneSpc">
                <label class="ligne1">
                    <span data-i18n="gloire-totale">Gloire Totale</span>
                    <input type="number" value="@{gloAct}+@{gloUti}" name="attr_gloTot" disabled />
                </label>
                <div class="ligne3">
                    <label>
                        <span data-i18n="niveau-du-lion">Niveau du Lion</span>
                        <input type="number" name="attr_druidNiveauLion" value="1" min="1" />
                    </label>
                    <label>
                        <span data-i18n="niveau-du-wolf">Niveau du Wolf</span>
                        <input type="number" name="attr_druidNiveauWolf" value="1" min="1" />
                    </label>
                    <label>
                        <span data-i18n="niveau-du-crow">Niveau du Crow</span>
                        <input type="number" name="attr_druidNiveauCrow" value="1" min="1" />
                    </label>
                </div>
            </div>

            <div class="monk ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_monk150PG" title="150PG" value="2" />
                    <span data-i18n-title="150-PG" title="150 PG"></span>
                </label>
                <div><span data-i18n="monk-150PG-description">+2D6 en dégâts et violence pour le mode Céa.</span></div>
            </div>
            <div class="monk ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_monk200PG" title="200PG" value="on" />
                    <span data-i18n-title="200-PG" title="200 PG"></span>
                </label>
                <div><span data-i18n="monk-200PG-description">Le mode Zen peut être activé pour récupérer les points d'espoirs perdus lors de n'importe quel combat ayant eu lieu durant la mission en cours.</span></div>
            </div>
            <div class="monk ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_monk250PG" title="250PG" value="1" />
                    <span data-i18n-title="250-PG" title="250 PG"></span>
                </label>
                <div><b data-i18n="Vague-d'énergie-:">Vague d'énergie :</b><span data-i18n="monk-vague-d'energie-250PG-description">+2 en Parasitage / Salve d'énergie : +3 en Dispersion</span><br/><b data-i18n="Rayon-d'énergie-:">Rayon d'énergie :</b><span data-i18n="monk-rayon-d'energie-250PG-description">Perce Armure devient Ignore Armure</span></div>
            </div>
            
            <div class="paladin ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_paladin150PG" title="150PG" value="on" />
                    <span data-i18n-title="150-PG" title="150 PG"></span>
                </label>
                <div><span data-i18n="paladin-150PG-description">Peut sloter une arme de tir à une main, ou à deux mains (sans l'attribut lourd) sur chacun de ses bras (une par bras maximum), et continuer à porter des armes dans ses mains. Les armes slotées sont considérées être en main. Le chevalier peut donc passer d'une arme à l'autre lors de ses différents tours.</span></div>
            </div>
            <div class="paladin ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_paladin200PG" value="2" />
                    <span data-i18n-title="200-PG" title="200 PG"></span>
                </label>
                <div><span data-i18n="paladin-200PG-description">+2 pour le CdF du Shrine. Peut l'activer durant 6 tour / une minute pour 5PE et à portée moyenne pour 10PE.</span></div>
            </div>
            <div class="paladin ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_paladin250PG" value="on" />
                    <span data-i18n-title="250-PG" title="250 PG"></span>
                </label>
                <div><span data-i18n="paladin-250PG-description">L'effet "lente et lourde" est annulé.</span></div>
            </div>
            
            <div class="priest ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_priest150PG" value="on" />
                    <span data-i18n-title="150-PG" title="150 PG"></span>
                </label>
                <div><span data-i18n="priest-150PG-description">Les créations du mode NanoC durent 1h. 2PE/heure supplémentaire.</span></div>
            </div>
            <div class="priest ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_priest200PG" value="on" />
                    <span data-i18n-title="200-PG" title="200 PG"></span>
                </label>
                <div><span data-i18n="priest-200PG-description">1D6+6 supplémentaire à toutes les réparations (mode Mechanic).</span></div>
            </div>
            <div class="priest ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_priest250PG" value="on" />
                    <span data-i18n-title="250-PG" title="250 PG"></span>
                </label>
                <div><span data-i18n="priest-250PG-description">Permet la création au choix : moto steed, stalion, maraudeur II, ou vector léger, pour 9PE et une durée de 1h (mode NanoC, au contact).</span></div>
            </div>
            
            <div class="psion ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_psion150PG" value="on" />
                    <span data-i18n-title="150-PG" title="150 PG"></span>
                </label>
                <div><span data-i18n="psion-150PG-description">Le Mode Puppet Master fonctionne contre les salopards sur un test base <b>Aura</b> et pour 2 de flux. Chaque cible supplémentaire coûte 2 de flux et prolonger l'ordre coûte 1 de flux. Flux non dépensés en cas d'échec. Un type d'ennemi par utilisation.</span></div>
            </div>
            <div class="psion ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_psion200PG" value="on" />
                    <span data-i18n-title="200-PG" title="200 PG"></span>
                </label>
                <div><span data-i18n="psion-200PG-description">Le Mode Discord fonctionne contre les salopards sur un test base <b>Aura</b>. Flux non dépensés en cas d'échec. Malus passe à 3 Dès pour les actions / 2 pour la réaction / 2 pour la défense.</span></div>
            </div>
            <div class="psion ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_psion250PG" value="on" />
                    <span data-i18n-title="250-PG" title="250 PG"></span>
                </label>
                <div><span data-i18n="psion-250PG-description">Le Mode Puppet Master fonctionne contre les bandes sur un test base <b>Aura</b>. Flux non dépensés en cas d'échec. Le score de débordement actuel est infligé à tous les autres ennemis présents dans la scène. Un type d'ennemi par utilisation.</span></div>
            </div>
            
            <div class="ranger ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_ranger50PG" value="on" />
                    <span data-i18n-title="50-PG" title="50 PG"></span>
                </label>
                <div><span data-i18n="ranger-50PG-1-description">Peut ajouter un ou plusieurs effets pour 6PE : anti-Anathème / Démoralisant / Pénétrant 10 / Ignore Armure / En Chaîne / Fureur</span></div>
            </div>
            <div class="ranger ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_ranger50PG2" value="on" />
                    <span data-i18n-title="50-PG" title="50 PG"></span>
                </label>
                <div><span data-i18n="ranger-50PG-2-description">Augmentation des dégâts à 5D / Augmentation de la violence à 3D / Maximum de dégâts et violence à 9D</span></div>
            </div>
            <div class="ranger ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_ranger50PG3" value="1" />
                    <span data-i18n-title="50-PG" title="50 PG"></span>
                </label>
                <div><span data-i18n="ranger-50PG-3-description">Le longbow perd l'effet <b>lourd</b> et gagne l'effet <b>deux mains</b>.</span></div>
            </div>
            <div class="ranger ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_ranger100PG" value="on" />
                    <span data-i18n-title="100-PG" title="100 PG"></span>
                </label>
                <div><span data-i18n="ranger-100PG-description">Les effets coûtent 2PE de moins (sauf augmentation dégât / violence), minimum 1.</span></div>
            </div>
            
            <div class="rogue ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_rogue150PG" value="on" />
                    <span data-i18n-title="150-PG" title="150 PG"></span>
                </label>
                <div><span data-i18n="rogue-150PG-description">Possibilité de dépenser 2PE pour que le mode Ghost dure 6 tours en phase de conflit et 6PE pour qu'il dure 15 minutes en dehors des conflits.</span></div>
            </div>
            <div class="rogue ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_rogue200PG" value="on" />
                    <span data-i18n-title="200-PG" title="200 PG"></span>
                </label>
                <div><span data-i18n="rogue-200PG-description">Seul les ennemis possédant un aspect Machine exceptionnelle majeure peuvent détecteur la présence du chevalier en mode Ghost. Il bénéficie, comme précédemment, de 3 réussites automatiques pour passer inaperçu.</span></div>
            </div>
            <div class="rogue ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_rogue250PG" value="on" />
                    <span data-i18n-title="250-PG" title="250 PG"></span>
                </label>
                <div><span data-i18n="rogue-250PG-description">Le mode Ghost ne se désactive pas lors des attaques du chevalier en cas de dépense de 3PE.</span></div>
            </div>
            
            <div class="shaman ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_shaman150PG" value="1" />
                    <span data-i18n-title="150-PG" title="150 PG"></span>
                </label>
                <div><span data-i18n="shaman-150PG-description">Trois totems maximum peuvent maintenant être matérialisés en même temps.</span></div>
            </div>
            <div class="shaman ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_shaman200PG" value="1" />
                    <span data-i18n-title="200-PG" title="200 PG"></span>
                </label>
                <div><span data-i18n="shaman-200PG-description">Désormais, le mode Ascension peut être activé même quand le chevalier est hors de sa méta-armure. Dans ce cas, l’IA de la méta-armure prend l’apparence du chevalier en combinaison Guardian ou en métaarmure, au choix du chevalier.</span></div>
            </div>
            <div class="shaman ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_shaman250PG" value="1" />
                    <span data-i18n-title="250-PG" title="250 PG"></span>
                </label>
                <div><span data-i18n="shaman-250PG-description">Les totems peuvent maintenant agir de manière indépendante (toujours en suivant les ordres du chevalier) et sans limite de portée. Ils sont bien plus finement matérialisés et ressemblent trait pour trait à la méta-armure du chevalier. Ils peuvent aussi être matérialisés pour une scène entière ou une phase de conflit entière pour un coût total de 10 PE.</span></div>
            </div>
            
            <div class="sorcerer ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_sorcerer150PG" value="1" />
                    <span data-i18n-title="150-PG" title="150 PG"></span>
                </label>
                <div><b data-i18n="sorcerer-vol-en-nuee">Vol en nuée :</b><span data-i18n="sorcerer-150PG-vol-en-nuee-description"> Module de vol passe niveau 2.</span><b data-i18n="sorcerer-phase">Phase :</b><span data-i18n="sorcerer-150PG-phase-description">Module de phase passe niveau 2.</span><b data-i18n="sorcerer-etirement">Étirement :</b><span data-i18n="sorcerer-150PG-etirement-description">La portée passe à moyenne.</span><b data-i18n="sorcerer-corps-de-métal">Corps de métal :</b><span data-i18n="sorcerer-150PG-corps-de-metal-description">Bonus de CdF passe à 4.</span><b data-i18n="sorcerer-corps-fluide">Corps fluide :</b><span data-i18n="sorcerer-150PG-corps-fluide-description">Bonus de défense / réaction passe à 3.</span><b data-i18n="sorcerer-polymorphie-de-guerre">Polymorphie de guerre :</b><span data-i18n="sorcerer-150PG-polymorphie-de-guerre-description">Les modules passent au niveau 2. Effets et bonus à choisir.</span></div>
            </div>
            <div class="sorcerer ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_sorcerer250PG" value="on" />
                    <span data-i18n-title="250-PG" title="250 PG"></span>
                </label>
                <div><span data-i18n="sorcerer-250PG-description">En activant le mode Morph, le chevalier obtient les effets des 6 capacités en même temps.</span></div>
            </div>
            
            <div class="warlock ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_warlock150PG" value="1" />
                    <span data-i18n-title="150-PG" title="150 PG"></span>
                </label>
                <div><span data-i18n="warlock-150PG-description">Désormais, les coûts en PE des modes Rewind et Record sont diminués de 3.</span></div>
            </div>
            <div class="warlock ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_warlock200PG" value="1" />
                    <span data-i18n-title="200-PG" title="200 PG"></span>
                </label>
                <div><span data-i18n="warlock-200PG-description">Désormais, le mode Rewind peut être activé juste après (pas avant, ni pendant) une action d’un autre PJ ou d’un PNJ, même si le chevalier devrait être incapable d’effectuer une action ou s’il a par exemple été tué. Les effets infligés par des PNJ et qui devraient persister, comme domination, contrôle et isolement, sont ignorés par le PJ.\nAttention : Le chevalier doit toujours attendre 6 secondes avant de réactiver le mode Rewind et ne pourra le réactiver qu’une fois le tour de jeu complet passé.</span></div>
            </div>
            <div class="warlock ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_warlock250PG" value="1" />
                    <span data-i18n-title="250-PG" title="250 PG"></span>
                </label>
                <div><span data-i18n="warlock-250PG-description">L’armure est mieux stabilisée en termes temporels. Dé- sormais, le personnage peut relancer son jet sur le tableau des paradoxes temporels et choisir entre les deux résultats.</span></div>
            </div>
            
            <div class="warmaster ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_warmaster150PG" value="10" />
                    <span data-i18n-title="150-PG" title="150 PG"></span>
                </label>
                <div><span data-i18n="warmaster-150PG-description">+10 PE sur le total.</span></div>
            </div>
            <div class="warmaster ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_warmaster200PG" value="on" />
                    <span data-i18n-title="200-PG" title="200 PG"></span>
                </label>
                <div><span data-i18n="warmaster-200PG-description">Le personnage peut bénéficier dorénavant de toutes les impulsions.</span></div>
            </div>
            <div class="warmaster ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_warmaster250PG" value="10" />
                    <span data-i18n-title="250-PG" title="250 PG"></span>
                </label>
                <div><span data-i18n="warmaster-250PG-description">Le mode Falcon ne coûte que 3PE et ne nécessite aucune action. +10 PE sur le total.</span></div>
            </div>
            
            <div class="warrior ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_warrior150PG" value="10" />
                    <span data-i18n-title="150-PG" title="150 PG"></span>
                </label>
                <div><span data-i18n="warrior-150PG-description">Activer un type ne coûte plus d'action.</span></div>
            </div>
            <div class="warrior ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_warrior200PG" value="on" />
                    <span data-i18n-title="200-PG" title="200 PG"></span>
                </label>
                <div><span data-i18n="warrior-200PG-description">Le chevalier possède tous les types.</span></div>
            </div>
            <div class="warrior ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_warrior250PG" value="1" />
                    <span data-i18n-title="250-PG" title="250 PG"></span>
                </label>
                <div><span data-i18n="warrior-250PG-description">Les types offrent désormais 2 OD au lieu d'1.</span></div>
            </div>
            
            <div class="wizard ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_wizard150PG" value="on" />
                    <span data-i18n-title="150-PG" title="150 PG"></span>
                </label>
                <div><span data-i18n="wizard-150PG-description">Le mode Boréalis fonctionne maintenant à portée moyenne.</span></div>
            </div>
            <div class="wizard ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_wizard200PG" value="on" />
                    <span data-i18n-title="200-PG" title="200 PG"></span>
                </label>
                <div><span data-i18n="wizard-200PG-description">Les dépenses en PE des modes Boréalis et Oriflamme sont réduit de 3 (min. 1).</span></div>
            </div>
            <div class="wizard ligneStd">
                <label class="fakeButton">
                    <input type="checkbox" name="attr_wizard250PG" value="on" />
                    <span data-i18n-title="250-PG" title="250 PG"></span>
                </label>
                <div><span data-i18n="wizard-250PG-description">Le mode Oriflamme fonctionne maintenant à portée moyenne.</span></div>
            </div>
        </div>

        <div class="fichePJ MAL MALegende">
            <h1 class="titre" data-i18n="meta-armure-legende">Méta-armure de légende</h1>
            <div class="info">
                <h1 class="titre" data-i18n="panneau-d'information">Panneau d'Information</h1>
                <div class="autoex autoex28">	
                    <span name="attr_panneauInformation"></span>
                    <textarea name="attr_panneauInformation" readonly ></textarea>
                </div>
            </div>
            <div class="capaciteUltime">
                <h1 class="titre" data-i18n="capacite-ultime">Capacités ultime</h1>
                <div class="button">
                    <input type="hidden" name="attr_capaciteUltimeType" value="0" />
                    <button class="passive" type="action" name="act_capaciteUltimeType_1" data-i18n-title="capacite-passive" title="Passive" data-i18n="capacite-passive">Passive</button>
                    <button class="active" type="action" name="act_capaciteUltimeType_2" data-i18n-title="capacite-active" title="Active" data-i18n="capacite-active">Active</button>
                    <div>
                        <button type="action" name="act_capaciteUltime" data-i18n-title="depenser-pe-capacite" title="Dépenser les PE de la capacité" data-i18n="point-energie-short">PE</button>
                        <input type="number" name="attr_coutCapaciteUltime" value="0" />
                    </div>
                </div>
                <div class="autoex autoex28">
                    <textarea name="attr_capaciteUltimeDescription"></textarea>
                    <span name="attr_capaciteUltimeDescription"></span>
                </div>
            </div>
        </div>

        <div class="fichePNJ ficheCreature ficheBande AEBlock">
            <input type="hidden" name="attr_ChairPNJAE" value="0" class="AEChairMineur" />
            <input type="hidden" name="attr_ChairPNJAEMaj" value="0" class="AEChairMajeur" />
            <input type="hidden" name="attr_BetePNJAE" value="0" class="AEBeteMineur" />
            <input type="hidden" name="attr_BetePNJAEMaj" value="0" class="AEBeteMajeur" />
            <input type="hidden" name="attr_MachinePNJAE" value="0" class="AEMachineMineur" />
            <input type="hidden" name="attr_MachinePNJAEMaj" value="0" class="AEMachineMajeur" />
            <input type="hidden" name="attr_DamePNJAE" value="0" class="AEDameMineur" />
            <input type="hidden" name="attr_DamePNJAEMaj" value="0" class="AEDameMajeur" />
            <input type="hidden" name="attr_MasquePNJAE" value="0" class="AEMasqueMineur" />
            <input type="hidden" name="attr_MasquePNJAEMaj" value="0" class="AEMasqueMajeur" />

            <div class="AEChair AE">
                <h1 class="titre" data-i18n="chair">Chair</h1>
                <div class="Mineur">
                    <span data-i18n="mineur">Mineur</span>
                    <span data-i18n="aspect-exceptionnel-chair-mineur">
                        Le PNJ soustrait toujours son score de l’aspect exceptionnel Chair aux dégâts qu’il reçoit.
                    </span>
                </div>
    
                <div class="Majeur">
                    <span data-i18n="majeur">Majeur</span>
                    <span data-i18n="aspect-exceptionnel-chair-majeur">
                        Le PNJ ignore purement les effets barrage X, choc X et meurtrier des armes.
                    </span>
                </div>
            </div>
    
            <div class="AEBete AE">
                <h1 class="titre" data-i18n="bete">Bête</h1>
                <div class="Mineur">
                    <span data-i18n="mineur">Mineur</span>
                    <span data-i18n="aspect-exceptionnel-bete-mineur">
                        (Déjà inclus) Le PNJ ajoute à ses dégâts au contact son score de l’aspect exceptionnel Bête.
                    </span>
                </div>
                <div class="Majeur">
                    <span data-i18n="majeur">Majeur</span>
                    <span data-i18n="aspect-exceptionnel-bete-majeur">
                        (Déjà inclus)  Le PNJ ajoute à ses dégâts au contact son score de l’aspect Bête (en plus du score de l’aspect exceptionnel).
                    </span>
                </div>
            </div>
    
            <div class="AEMachine AE">
                <h1 class="titre" data-i18n="machine">Machine</h1>
                <div class="Mineur">
                    <span data-i18n="mineur">Mineur</span>
                    <span data-i18n="aspect-exceptionnel-machine-mineur">
                        (Déjà inclus) Le PNJ ajoute son score de Machine exceptionnelle à son score de réaction.
                    </span>
                </div>
    
                <div class="Majeur">
                    <span data-i18n="majeur">Majeur</span>
                    <span data-i18n="aspect-exceptionnel-machine-majeur">
                        Le PNJ est insensible aux capacités d’armure qui jouent sur les sens telles que le mode Ghost ou le mode Changeling. L’invisibilité comme les illusions ou les leurres n’ont pas d’effet sur lui.
                    </span>
                </div>
            </div>
    
            <div class="AEDame AE">
                <h1 class="titre" data-i18n="dame">Dame</h1>
                <div class="Mineur">
                    <span data-i18n="mineur">Mineur</span>
                    <span data-i18n="aspect-exceptionnel-dame-mineur">Le PNJ, s’il est accompagné d’autres PNJ de la même faction que lui, peut toujours décider de reporter les dégâts qu’il subit sur des alliés proches, à portée courte. Cela représente le fait que des PNJ alliés s’interposent pour sauvegarder sa vie.</span>
                </div>
    
                <div class="Majeur">
                    <span data-i18n="majeur">Majeur</span>
                    <span data-i18n="aspect-exceptionnel-dame-majeur">Un PJ qui souhaite attaquer ce PNJ doit réussir un test base Hargne dont la difficulté est égale au score de la Dame exceptionnelle du PNJ. S’il ne réussit pas ce test, il est subjugué par le PNJ et ne se résout pas à l’attaquer.</span>
                </div>
            </div>
    
            <div class="AEMasque AE">
                <h1 class="titre" data-i18n="masque">Masque</h1>
                <div class="Mineur">
                    <span data-i18n="mineur">Mineur</span>
                    <span data-i18n="aspect-exceptionnel-masque-mineur">
                        (Déjà inclus) Le PNJ ajoute son score de Masque exceptionnel à son score de défense.
                    </span>
                </div>
    
                <div class="Majeur">
                    <span data-i18n="majeur">Majeur</span>
                    <span data-i18n="aspect-exceptionnel-masque-majeur">
                        (Déjà inclus) Le PNJ agit toujours, peu importe son nombre d’actions, comme s’il avait un score d’initiative de 30. Le MJ ne lance pas les dés.
                    </span>
                </div>
            </div>
        </div>
    </div>

    <div class="col">
        <div class="fichePJ barbarian barbarianGoliath">
            <h1 class="titre" data-i18n="barbarian-mode-goliath">Mode Goliath</h1>

            <label class="ligne">
                <span data-i18n="taille-bonus">Taille Bonus</span>
                <input type="number" name="attr_barbarianGoliath" min="0" value="0" />
            </label>

            <h1 class="titre" data-i18n="bonus">Bonus</h1>

            <label class="col">
                <span data-i18n="force">Force</span>
                <input type="text" name="attr_barbarianGoliath" readonly />
            </label>
            <label class="col">
                <span data-i18n="endurance">Endurance</span>
                <input type="text" name="attr_barbarianGoliath" readonly />
            </label>
            <label class="col borderTop">
                <span data-i18n="degats-violence-contact">Dégâts (contact)</span>
                <input type="text" name="attr_barbarianDegat" readonly />
            </label>
            <label class="col borderTop">
                <span data-i18n="champ-de-force">Champs de Force</span>
                <input type="text" name="attr_barbarianGoliath" readonly />
            </label>

            <h1 class="titre" data-i18n="malus">Malus</h1>

            <label class="col">
                <span data-i18n="defense">Défense</span>
                <input type="text" name="attr_barbarianDef" readonly />
            </label>
            <label class="col">
                <span data-i18n="reaction">Réaction</span>
                <input type="text" name="attr_barbarianRea" readonly />
            </label>
        </div>

        <div class="fichePJ bard bardChangeling">
            <input class="bard250" type="hidden" name="attr_bard250PG" 
            value="0" />
            <input class="active" type="hidden" name="attr_bardChangeling" value=""/>
            <div class="titre firstTitre">               
                <h1 class="titre" data-i18n="mode-changeling">Mode Changeling</h1>
                <button class="active" type="action" name="act_bardChangeling" data-i18n="activer">Activer</button>
            </div>
            <h1 class="titre" data-i18n="bard-apparence">Apparence</h1>
            <div class="autoex autoex28">
                <span name="attr_apparenceBard"></span>
                <textarea name="attr_apparenceBard"></textarea>
            </div>

            <h1 class="titre" data-i18n="bard-faux-êtres">Faux-Êtres</h1>
            <div class="autoex autoex28">
                <span name="attr_fauxEtresBard"></span>
                <textarea name="attr_fauxEtresBard"></textarea>
            </div>

            <div class="titre bard250">
                <h1 class="titre" data-i18n="bard-desactivation-explosive">Désactivation explosive</h1>
                <button class="rollDice" type="action" name="act_distanceBard" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=^{bard-desactivation-explosive}}}" ></button>
            </div>

            <label class="bard250 ligne">
                <span data-i18n="degats/violence">Dégâts / Violence</span>
                <input type="text" name="attr_bardAttSpe" value="3D6+6" readonly />
            </label>
            <input class="bard250" type="text" name="attr_bardEffetAttSpe" value="Ignore Armure / Ignore Champs de Force / Dispersion 6 / Choc 1" readonly />
        </div>

        <div class="fichePJ berserk berserkIllumination">
            <h1 class="titre" data-i18n="berserk-mode-illumination">Mode Illumination</h1>
            <h2 class="titreBis" data-i18n="berserk-selection-effets">Sélection des Effets</h2>

            <input class="blaze" type="hidden" name="attr_berserkBlaze" />
            <input class="candle" type="hidden" name="attr_berserkCandle" />
            <input class="beacon" type="hidden" name="attr_berserkBeacon" />
            <input class="torch" type="hidden" name="attr_berserkTorch" />
            <input class="projector" type="hidden" name="attr_berserkProjector" />
            <input class="lighthouse" type="hidden" name="attr_berserkLighthouse" />
            <input class="lantern" type="hidden" name="attr_berserkLantern" />

            <div class="button">
                <button class="blaze" type="action" name="act_berserkBlaze" data-i18n-title="berserk-illumination-blaze" >Blaze</button>
                <button class="candle" type="action" name="act_berserkCandle" data-i18n-title="berserk-illumination-candle" >Candle</button>
                <button class="beacon" type="action" name="act_berserkBeacon" data-i18n-title="berserk-illumination-beacon" >Beacon</button>
                <button class="torch" type="action" name="act_berserkTorch" data-i18n-title="berserk-illumination-torch" >Torch</button>
                <button class="projector" type="action" name="act_berserkProjector" data-i18n-title="berserk-illumination-projector" >Projector</button>
                <button class="lighthouse" type="action" name="act_berserkLighthouse" data-i18n-title="berserk-illumination-lighthouse" >Lighthouse</button>
                <button class="lantern" type="action" name="act_berserkLantern" data-i18n-title="berserk-illumination-lantern" >Lantern</button>
            </div>
            
            <div class="blaze titre">
                <h1 class="titre" data-i18n="berserk-illumination-blaze">Blaze</h1>
                <button class="rollDice" type="action" name="act_berserkIlluminationBlaze" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=^{berserk-illumination-blaze}}}"></button>
            </div>
            <label class="blaze col3">
                <span data-i18n="degats">Dégâts</span>
                <input type="text" name="attr_berserkIlluminationBlazeDgts" value="2D6" readonly />
            </label>
            <label class="blaze col3BL">
                <span data-i18n="violence">Violence</span>
                <input type="text" name="attr_berserkIlluminationBlazeViolence" value="2D6" readonly />
            </label>
            <label class="blaze col3BL">
                <span data-i18n="portee">Portée</span>
                <input type="text" name="attr_berserkIlluminationBlazePortee" value="Contact" readonly />
            </label>
            
            <div class="candle titre">
                <h1 class="titre" data-i18n="berserk-illumination-candle">Candle</h1>
                <button class="rollDice" type="action" name="act_berserkIlluminationCandle" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{berserk-illumination-candle}}} {{jDivers=^{espoir-sacrifie-donne}}} {{jDiversV=[[@{berserkIlluminationCandleEspoir}]]}}"></button>
            </div>
            <label class="candle col1">
                <span data-i18n="espoir-sacrifie-donne">Espoir sacrifié/donné</span>
                <input type="text" name="attr_berserkIlluminationCandleEspoir" value="1D3" readonly />
            </label>
            
            <div class="beacon titre">
                <input type="hidden" name="attr_berserkIlluminationBeaconA" />

                <h1 class="titre" data-i18n="berserk-illumination-beacon">Beacon</h1>
                <button class="active" type="action" name="act_berserkIlluminationBeaconA" data-i18n="activer">Activer</button>
            </div>
            <label class="beacon col2">
                <span data-i18n="bonus-jets-allies">Bonus aux jets alliés</span>
                <input type="text" name="attr_berserkIlluminationBeaconBonus" value="2 réussites automatiques" readonly  />
            </label>
            <label class="beacon col2BL">
                <span data-i18n="portee">Portée</span>
                <input type="text" name="attr_berserkIlluminationBeaconPortee" value="Courte" readonly  />
            </label>
            
            <div class="torch titre">
                <input type="hidden" name="attr_berserkIlluminationTorchA" />

                <h1 class="titre" data-i18n="berserk-illumination-torch">Torch</h1>
                <button class="active" type="action" name="act_berserkIlluminationTorchA" data-i18n="activer">Activer</button>
            </div>
            <label class="torch col2">
                <span data-i18n="bonus-egide">Bonus à l'égide</span>
                <input type="text" name="attr_berserkIlluminationTorchEgide" value="2" readonly />
            </label>
            <label class="torch col2BL">
                <span data-i18n="portee">Portée</span>
                <input type="text" name="attr_berserkIlluminationTorchPortee" value="Courte" readonly />
            </label>

            <div class="projector titre">
                <input type="hidden" name="attr_berserkIlluminationProjectorA" />

                <h1 class="titre" data-i18n="berserk-illumination-projector">Projector</h1>
                <button class="active" type="action" name="act_berserkIlluminationProjectorA" data-i18n="activer">Activer</button>
            </div>
            <label class="projector col2">
                <span data-i18n="capacite">Capacité</span>
                <input type="text" name="attr_berserkIlluminationProjectorCapacite" value="" />
            </label>
            <label class="projector col2BL">
                <span data-i18n="portee">Portée</span>
                <input type="text" name="attr_berserkIlluminationProjectorPortee" value="Courte" readonly  />
            </label>

            <div class="lighthouse titre">
                <input type="hidden" name="attr_berserkIlluminationLighthouseA" />

                <h1 class="titre" data-i18n="berserk-illumination-lighthouse">Lighthouse</h1>
                <button class="active" type="action" name="act_berserkIlluminationLighthouseA" data-i18n="activer">Activer</button>
            </div>
            <label class="lighthouse col1">
                <span data-i18n="portee">Portée</span>
                <input type="text" name="attr_berserkIlluminationLighthousePortee" value="Courte" readonly  />
            </label>
            
            <div class="lantern titreInverse">
                <input type="hidden" name="attr_berserkIlluminationLanternA" />

                <button class="active" type="action" name="act_berserkIlluminationLanternA" data-i18n="activer">Activer</button>
                <h1 class="titre" data-i18n="berserk-illumination-lantern">Lantern</h1>
                <button class="rollDice" type="action" name="act_berserkIlluminationLantern" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=^{berserk-illumination-lantern}}}"></button>
            </div>
            <label class="lantern col2">
                <span data-i18n="degats">Dégâts</span>
                <input type="text" name="attr_berserkIlluminationLanternDgts" value="1D6" readonly />
            </label>    
            <label class="lantern col2BL">
                <span data-i18n="portee">Portée</span>
                <input type="text" name="attr_berserkIlluminationLanternPortee" value="Courte" readonly />
            </label>
            <input class="lantern ligne" type="text" name="attr_berserkIlluminationLanternEffets" value="Espérance" readonly  />
        </div>
        <div class="fichePJ berserk berserkRage">
            <input class="active" type="hidden" name="attr_berserkRageA" />
            <input class="niveau" type="hidden" name="attr_berserkNiveaux" />
            <div class="titre">
                <h1 class="titre" data-i18n="berserk-mode-rage">Mode Rage</h1>
                <button class="active rageActive" type="action" name="act_berserkRageA" data-i18n="activer">Activer</button>
            </div>
            
            <div class="button">
                <button class="N1" type="action" name="act_berserkNiveaux_1" data-i18n="berserk-rage-niveau-1">Niveau 1</button>
                <button class="N2" type="action" name="act_berserkNiveaux_2" data-i18n="berserk-rage-niveau-2">Niveau 2</button>
                <button class="N3" type="action" name="act_berserkNiveaux_3" data-i18n="berserk-rage-niveau-3">Niveau 3</button>
            </div>
            <div class="passif">
                <div class="espoir">
                    <span data-i18n="sacrifice-points-espoir">Sacrifice de points d'espoir</span>
                    <button class="rollDice" type="action" name="act_berserkRageSacrificeEspoir" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{sacrifice-points-espoir}}} {{jDivers=^{espoir-sacrifie}}} {{jDiversV=[[1D6]]}}"></button>
                </div>

                <h1 class="titre" data-i18n="berserk-nourri-rage">Nourri par la rage</h1>
                <h2 class="titreBis" data-i18n="points-espoir-vs-humain">Points d'espoir récupérés contre les humains</h2>

                <div class="col4">
                    <span data-i18n="hostile">Hostile</span>
                    <div>
                        <input type="text" name="attr_berserkRageHostileHumain" value="1" readonly />
                        <button class="rollDice" type="action" name="act_berserkRageHostileHumain" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{espoir-recupere}}} {{jDivers=^{humain-hostile}}} {{jDiversV=[[@{berserkRageHostileHumain}]]}}" ></button>
                    </div>
                </div>
                <div class="col4BL">
                    <span data-i18n="salopard">Salopard</span>
                    <div>
                        <input type="text" name="attr_berserkRageSalopardHumain" value="1D3" readonly />
                        <button class="rollDice" type="action" name="act_berserkRageSalopardHumain" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{espoir-recupere}}} {{jDivers=^{humain-salopard}}} {{jDiversV=[[@{berserkRageSalopardHumain}]]}}" ></button>
                    </div>
                </div>
                <div class="col4BL">
                    <span data-i18n="patron">Patron</span>
                    <div>
                        <input type="text" name="attr_berserkRagePatronHumain" value="1D6+3" readonly />
                        <button class="rollDice" type="action" name="act_berserkRagePatronHumain" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{espoir-recupere}}} {{jDivers=^{humain-patron}}} {{jDiversV=[[@{berserkRagePatronHumain}]]}}" ></button>
                    </div>
                </div>
                <div class="col4BL">
                    <span data-i18n="bande">Bande</span>
                    <div>
                        <input type="text" name="attr_berserkRageBandeHumain" value="1D6" readonly />
                        <button class="rollDice" type="action" name="act_berserkRageBandeHumain" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{espoir-recupere}}} {{jDivers=^{humain-bande}}} {{jDiversV=[[@{berserkRageBandeHumain}]]}}" ></button>
                    </div>
                </div>
                
                <h2 class="titreBis" data-i18n="points-espoir-vs-anatheme">Points d'espoir récupérés contre l'anathème</h2>

                <div class="col4">
                    <span data-i18n="hostile">Hostile</span>
                    <div>
                        <input type="text" name="attr_berserkRageHostileAnathème" value="1D6" readonly />
                        <button class="rollDice" type="action" name="act_berserkRageHostileAnathème" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{espoir-recupere}}} {{jDivers=^{anatheme-hostile}}} {{jDiversV=[[@{berserkRageHostileAnathème}]]}}" ></button>
                    </div>
                </div>
                <div class="col4BL">
                    <span data-i18n="salopard">Salopard</span>
                    <div>
                        <input type="text" name="attr_berserkRageSalopardAnathème" value="1D6+3" readonly />
                        <button class="rollDice" type="action" name="act_berserkRageSalopardAnathème" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{espoir-recupere}}} {{jDivers=^{anatheme-salopard}}} {{jDiversV=[[@{berserkRageSalopardAnathème}]]}}" ></button>
                    </div>
                </div>
                <div class="col4BL">
                    <span data-i18n="patron">Patron</span>
                    <div>
                        <input type="text" name="attr_berserkRagePatronAnathème" value="1D6+6" readonly />
                        <button class="rollDice" type="action" name="act_berserkRagePatronAnathème" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{espoir-recupere}}} {{jDivers=^{anatheme-patron}}} {{jDiversV=[[@{berserkRagePatronAnathème}]]}}" ></button>
                    </div>
                </div>
                <div class="col4BL">
                    <span data-i18n="bande">Bande</span>
                    <div>
                        <input type="text" name="attr_berserkRageBandeAnathème" value="2D6" readonly />
                        <button class="rollDice" type="action" name="act_berserkRageBandeAnathème" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{espoir-recupere}}} {{jDivers=^{anatheme-bande}}} {{jDiversV=[[@{berserkRageBandeAnathème}]]}}" ></button>
                    </div>
                </div>
            </div>

            <div class="niveaux">
                <div class="N1">
                    <h1 class="titre" data-i18n="berserk-rage-colere">Colère - Niveau 1</h1>
                    <label class="col3">
                        <span data-i18n="bonus-degats">Bonus Dégâts</span>
                        <input type="text" name="attr_bete" value="" readonly />
                    </label>
                    <label class="col3BL">
                        <span data-i18n="bonus-violence">Bonus Violence</span>
                        <input type="text" name="attr_bete" value="" readonly />
                    </label>
                    <label class="col3BL">
                        <span data-i18n="bonus-egide">Bonus Égide</span>
                        <input type="text" name="attr_berserkRageN1Egide" value="3" readonly />
                    </label>
    
                    <label class="col2">
                        <span data-i18n="malus-defense">Malus Défense</span>
                        <input type="text" name="attr_berserkRageN1DR" value="3" readonly />
                    </label>
                    <label class="col2BL">
                        <span data-i18n="malus-reaction">Malus Réaction</span>
                        <input type="text" name="attr_berserkRageN1DR" value="3" readonly />
                    </label>
                </div>
    
                <div class="N2">
                    <h1 class="titre" data-i18n="berserk-rage-rage">Rage - Niveau 2</h1>
                    <label class="col3">
                        <span data-i18n="bonus-degats">Bonus Dégâts</span>
                        <input type="text" name="attr_bete" value="" readonly />
                    </label>
                    <label class="col3BL">
                        <span data-i18n="bonus-violence">Bonus Violence</span>
                        <input type="text" name="attr_bete" value="" readonly />
                    </label>
                    <label class="col3BL">
                        <span data-i18n="bonus-egide">Bonus Égide</span>
                        <input type="text" name="attr_berserkRageN2Egide" value="6" readonly />
                    </label>
    
                    <label class="col2">
                        <span data-i18n="malus-defense">Malus Défense</span>
                        <input type="text" name="attr_berserkRageN2DR" value="9" readonly />
                    </label>
                    <label class="col2BL">
                        <span data-i18n="malus-reaction">Malus Réaction</span>
                        <input type="text" name="attr_berserkRageN2DR" value="9" readonly />
                    </label>
                </div>
    
                <div class="N3">
                    <h1 class="titre" data-i18n="berserk-rage-fureur">Fureur - Niveau 3</h1>
    
                    <label class="col3">
                        <span data-i18n="bonus-degats">Bonus Dégâts</span>
                        <input type="text" name="attr_bete" value="" readonly />
                    </label>
                    <label class="col3BL">
                        <span data-i18n="bonus-violence">Bonus Violence</span>
                        <input type="text" name="attr_bete" value="" readonly />
                    </label>
                    <label class="col3BL">
                        <span data-i18n="bonus-egide">Bonus Égide</span>
                        <input type="text" name="attr_berserkRageN3Egide" value="6" readonly />
                    </label>
    
                    <label class="col3 borderTop">
                        <span data-i18n="malus-defense">Malus Défense</span>
                        <input type="text" name="attr_berserkRageN3DR" value="9" readonly />
                    </label>
                    <label class="col3BL borderTop">
                        <span data-i18n="malus-reaction">Malus Réaction</span>
                        <input type="text" name="attr_berserkRageN3DR" value="9" readonly />
                    </label>
                    <label class="col3SBL borderTop">
                        <span data-i18n="degats-subis-par-tour">Dégâts subis/tour</span>
                        <div>
                            <input type="text" name="attr_berserkRageN3Dgts" value="1D6" readonly />
                            <button class="rollDice" type="action" name="act_berserkRageN3Dgts" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{degats-subis-par-tour}}} {{jDivers=^{degats}}} {{jDiversV=[[@{berserkRageN3Dgts}]]}}" ></button>
                        </div>
                    </label>
    
                    <div class="titre borderTop">
                        <h1 class="titre" data-i18n="berserk-illumination-blaze">Blaze</h1>
                        <button class="rollDice" type="action" name="act_berserkIlluminationBlaze" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=^{berserk-illumination-blaze}}}"></button>
                    </div>
    
                    <label class="col3">
                        <span data-i18n="degats">Dégâts</span>
                        <input type="text" name="attr_berserkIlluminationBlazeDgts" value="2D6" readonly />
                    </label>
                    <label class="col3BL">
                        <span data-i18n="violence">Violence</span>
                        <input type="text" name="attr_berserkIlluminationBlazeViolence" value="2D6" readonly />
                    </label>
                    <label class="col3BL">
                        <span data-i18n="portee">Portée</span>
                        <input type="text" name="attr_berserkIlluminationBlazePortee" value="Contact" readonly />
                    </label>
                </div>
            </div>
            
        </div>

        <div class="fichePJ druid effetsArmes">
            <h1 class="titre" data-i18n="effet-des-armes">Effet des armes</h1>
            <select name="attr_effetArmes">
                <option value="" selected></option>
                <option value="anti-anatheme-description" data-i18n="anti-anatheme">Anti-Anathème</option>
                <option value="anti-vehicule-description" data-i18n="anti-vehicule">Anti-Véhicule</option>
                <option value="artillerie-description" data-i18n="artillerie">Artillerie</option>
                <option value="assassin-description" data-i18n="assassin-x">Assassin X</option>
                <option value="assistance-attaque-description" data-i18n="assistance-attaque">Assistance à l'attaque</option>
                <option value="barrage-description" data-i18n="barrage-x">Barrage X</option>
                <option value="cadence-description" data-i18n="cadence-x">Cadence X</option>
                <option value="chargeur-description" data-i18n="chargeur">Chargeur X</option>
                <option value="choc-description" data-i18n="choc">Choc X</option>
                <option value="defense-reaction-description" data-i18n="defense-reaction">Défense X / Réaction X</option>
                <option value="degats-continus-description" data-i18n="degats-continus-x">Dégâts Continus X</option>
                <option value="demoralisant-description" data-i18n="demoralisant">Démoralisant</option>
                <option value="designation-description" data-i18n="designation">Désignation</option>
                <option value="destructeur-description" data-i18n="destructeur">Destructeur</option>
                <option value="deux-mains-description" data-i18n="deux-mains">Deux Mains</option>
                <option value="dispersion-description" data-i18n="dispersion-x">Dispersion X</option>
                <option value="en-chaine-description" data-i18n="en-chaine">En Chaîne</option>
                <option value="esperance-description" data-i18n="esperance">Espérance</option>
                <option value="fureur-description" data-i18n="fureur">Fureur</option>
                <option value="ignore-armure-description" data-i18n="ignore-armure">Ignore Armure</option>
                <option value="ignore-champ-de-force-description" data-i18n="ignore-champ-de-force">Ignore Champ de Force</option>
                <option value="jumele-akimbo-description" data-i18n="jumele-akimbo">Jumelé (Akimbo)</option>
                <option value="jumele-ambidextrie-description" data-i18n="jumele-ambidextrie">Jumelé (Ambidextrie)</option>
                <option value="leste-description" data-i18n="leste">Lesté</option>
                <option value="lourd-description" data-i18n="lourd">Lourd</option>
                <option value="lumiere-description" data-i18n="lumiere-x">Lumière X</option>
                <option value="meurtrier-description" data-i18n="meurtrier">Meurtrier</option>
                <option value="obliteration-description" data-i18n="obliteration">Oblitération</option>
                <option value="orfevrerie-description" data-i18n="orfevrerie">Orfèvrerie</option>
                <option value="parasitage-description" data-i18n="parasitage-x">Parasitage X</option>
                <option value="penetrant-description" data-i18n="penetrant-x">Pénétrant X</option>
                <option value="perce-armure-description" data-i18n="perce-armure-x">Perce Armure X</option>
                <option value="precision-description" data-i18n="precision">Précision</option>
                <option value="silencieux-description" data-i18n="silencieux">Silencieux</option>
                <option value="soumission-description" data-i18n="soumission">Soumission</option>
                <option value="tenebricide-description" data-i18n="tenebricide">Ténébricide</option>
                <option value="tir-rafale-description" data-i18n="tir-rafale">Tir en rafale</option>
                <option value="tir-securite-description" data-i18n="tir-securite">Tir en sécurité</option>
                <option value="ultraviolence-description" data-i18n="ultraviolence">Ultraviolence</option>
            </select>
            <span name="attr_effetArmes-description"></span>
        </div>
        <div class="fichePJ druid effetsArmes">
            <h1 class="titre" data-i18n="amelioration-structurelle-des-armes">Amélioration (structurelle) des armes</h1>
            <select name="attr_ameliorationArmes">
                <option value="" selected></option>
                <option value="agressive-description" data-i18n="agressive">Agressive</option>
                <option value="assassine-description" data-i18n="assassine">Assassine</option>
                <option value="allegee-description" data-i18n="allegee">Allégée</option>
                <option value="meutrier-description" data-i18n="meutrier">Barbelée</option>
                <option value="canon-raccourci-description" data-i18n="canon-raccourci">Canon raccourci</option>
                <option value="chambre-double-description" data-i18n="chambre-double">Chambre double</option>
                <option value="chargeur-balles-grappes-description" data-i18n="chargeur-balles-grappes">Chargeur et balles grappes</option>
                <option value="chargeur-munitions-explosives-description" data-i18n="chargeur-munitions-explosives">Chargeur et munitions explosives</option>
                <option value="connectee-description" data-i18n="connectee">Connectée</option>
                <option value="electrifiee-description" data-i18n="electrifiee">Électrifiée</option>
                <option value="grenades-intelligentes-avancees-description" data-i18n="grenades-intelligentes-avancees">Grenades intelligentes avancées</option>
                <option value="indestructible-description" data-i18n="indestructible">Indestructible</option>
                <option value="interface-guidage-description" data-i18n="interface-guidage">Interface de guidage</option>
                <option value="jumelage-description" data-i18n="jumelage">Jumelage</option>
                <option value="jumelle-description" data-i18n="jumelle">Jumelle</option>
                <option value="lumineuse-description" data-i18n="lumineuse">Lumineuse</option>
                <option value="lunette-intelligente-description" data-i18n="lunette-intelligente">Lunette intelligente</option>
                <option value="munitions-hyper-velocite-description" data-i18n="munitions-hyper-velocite">Munitions à Hyper Vélocité</option>
                <option value="massive-description" data-i18n="massive">Massive</option>
                <option value="munitions-drones-description" data-i18n="munitions-drones">Munitions drones</option>
                <option value="munitions-iem-description" data-i18n="munitions-iem">Munitions IEM</option>
                <option value="munitions-non-letales-description" data-i18n="munitions-non-letales">Munitions non létales</option>
                <option value="munitions-subsoniques-description" data-i18n="munitions-subsoniques">Munitions subsoniques</option>
                <option value="pointeur-laser-description" data-i18n="pointeur-laser">Pointeur laser</option>
                <option value="protection-d'arme-description" data-i18n="protection-d'arme">Protection d'arme</option>
                <option value="protectrice-description" data-i18n="protectrice">Protectrice</option>
                <option value="revetement-omega-description" data-i18n="revetement-omega">Revêtement Omega</option>
                <option value="sournoise-description" data-i18n="sournoise">Sournoise</option>
                <option value="structure-element-alpha-description" data-i18n="structure-element-alpha">Structure en Element Alpha</option>
                <option value="sur-mesure-description" data-i18n="sur-mesure">Sur Mesure</option>
                <option value="systeme-refroidissement-description" data-i18n="systeme-refroidissement">Système de refroidissement</option>
            </select>
            <span name="attr_ameliorationArmes-description"></span>
        </div>
        <div class="fichePJ druid herauts">
            <h1 class="titre">Chevalier de la lumière / Hérauts de l'équilibre</h1>
            <div>
                <input type="hidden" name="attr_devasterAnatheme" class="devasterAnatheme" value="0" />
                <input type="hidden" name="attr_bourreauTenebres" class="bourreauTenebres" value="0" />
                <input type="hidden" name="attr_equilibreBalance" class="equilibreBalance" value="0" />

                <button type="action" name="act_devasterAnatheme" class="devasterAnatheme" >Dévaster l'Anathème actif</button>
                <button type="action" name="act_bourreauTenebres" class="bourreauTenebres" >Bourreau des ténèbres actif</button>
                <button type="action" name="act_equilibreBalance" class="equilibreBalance" >Équilibrer la balance actif</button>
            </div>
        </div>
        <div class="fichePJ druid druidModJetCompagnons">
            <h1 class="titre" data-i18n="bonus/malus-aux-jets-des-compagnons">Bonus/Malus aux Jets des Compagnons</h1>
            <input type="number" name="attr_jetModifDesComp" value="0" />
        </div>
        <div class="fichePJ druid information">
            <h1 class="titre" data-i18n="panneau-d'information">Panneau d'Information</h1>
            <div class="autoex autoex28">	
                <span name="attr_panneauInformation"></span>
                <textarea name="attr_panneauInformation" readonly ></textarea>
            </div>
        </div>
        <div class="fichePJ druid druidModCompanions">
            <input class="choix" type="hidden" name="attr_choixCompanons" value="aucun" />

            <div class="titre">
                <h1 class="titre" data-i18n="druid-mod-companions">Mod Companions</h1>
                <select class="liste" name="attr_druidEnergieCompanon">
                    <option value="10" data-i18n="10-PE" selected>10 PE</option>
                    <option value="20" data-i18n="20-PE">20 PE</option>
                    <option value="30" data-i18n="30-PE">30 PE</option>
                    <option value="40" data-i18n="40-PE">40 PE</option>
                    <option value="50" data-i18n="50-PE">50 PE</option>
                </select>
            </div>
            <div class="button">
                <button class="aucun" type="action" name="act_choixCompanons_aucun" data-i18n="aucun" >Aucun</button>
                <button class="lion" type="action" name="act_choixCompanons_lion" data-i18n="druid-companion-lion">Lion</button>
                <button class="wolf" type="action" name="act_choixCompanons_wolf" data-i18n="druid-companion-wolf">Wolf</button>
                <button class="crow" type="action" name="act_choixCompanons_crow" data-i18n="druid-companion-crow">Crow</button>
            </div>
        </div>

        <div class="fichePJ monk monkModeZen">
            <div class="titre">
                <h1 class="titre" data-i18n="mode-zen">Mode Zen</h1>
                <button class="rollDice" type="action" name="act_jetModeZen" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{mode-zen}}}"></button>
            </div>
            <div class="ligne">
                <span data-i18n="espoir-potentiellement-recuperable">Espoir potentiellement récupérable :</span>
                <input type="number" name="attr_monkEspoirPerdu" value="0" min="0" />
            </div>
            <input class="col2" type="number" name="attr_monkModeZen" data-i18n-title="total-hargne-sang-froid" title="Total Hargne + Sang-Froid" value="@{hargne}+@{sf}" disabled />
            <input class="col2" type="number" name="attr_monkModeZenOD" data-i18n-title="total-od-hargne-sang-froid" title="Total OD Hargne + Sang-Froid" value="@{calODHar}+@{calODSFR}" disabled />
        </div>
        <div class="fichePJ monk styleCombat">					
            <h1 class="titre" data-i18n="style-de-combat">Style de Combat</h1>
            <select name="attr_styleCombat">
                <option value="standard" data-i18n="standard" selected>Standard</option>
                <option value="couvert" data-i18n="couvert">À Couvert</option>
                <option value="agressif" data-i18n="agressif">Agressif</option>
                <option value="akimbo" data-i18n="akimbo">Akimbo</option>
                <option value="ambidextre" data-i18n="ambidextre">Ambidextre</option>
                <option value="defensif" data-i18n="defensif">Défensif</option>
                <option value="precis" data-i18n="precis">Précis</option>
                <option value="pilonnage" data-i18n="pilonnage">Pilonnage</option>
                <option value="puissant" data-i18n="puissant">Puissant</option>
                <option value="suppression" data-i18n="suppression">Suppression</option>
            </select>
            <input type="hidden" name="attr_styleCombat" value="standard" />
            <div class="puissant">
                <span data-i18n="bonus-en">Bonus en</span>
                <select name="attr_stylePuissantType">
                    <option value="{{stylePuissantD=[[@{stylePuissantBonus}D6]]}}" data-i18n="degats" selected>Dégâts</option>
                    <option value="{{stylePuissantV=[[@{stylePuissantBonus}D6]]}}" data-i18n="violence">Violence</option>
                </select>
                <input type="number" name="attr_stylePuissantBonus" value="0" min="0" max="6" />
            </div>
            <div class="suppression">
                <label>
                    <span>Malus aux dégâts</span>
                    <input type="number" name="attr_styleSuppressionD" value="0" min="0" max="6" />
                </label>

                <label>
                    <span>Malus à la violence</span>
                    <input type="number" name="attr_styleSuppressionV" value="0" min="0" max="4" />
                </label>
            </div>
            <div class="autoex autoex40">
                <span name="attr_styleCombatDescr"></span>
                <textarea name="attr_styleCombatDescr" readonly></textarea>
            </div>
        </div>
        <div class="fichePJ monk herauts">
            <h1 class="titre">Chevalier de la lumière / Hérauts de l'équilibre</h1>
            <div>
                <input type="hidden" name="attr_devasterAnatheme" class="devasterAnatheme" value="0" />
                <input type="hidden" name="attr_bourreauTenebres" class="bourreauTenebres" value="0" />
                <input type="hidden" name="attr_equilibreBalance" class="equilibreBalance" value="0" />

                <button type="action" name="act_devasterAnatheme" class="devasterAnatheme" >Dévaster l'Anathème actif</button>
                <button type="action" name="act_bourreauTenebres" class="bourreauTenebres" >Bourreau des ténèbres actif</button>
                <button type="action" name="act_equilibreBalance" class="equilibreBalance" >Équilibrer la balance actif</button>
            </div>
        </div>
        <div class="fichePJ monk monkModeCea">
            <input type="hidden" name="attr_bonusCarac" class="bonusCarac" value="0" />

            <div class="titre">
                <button type="action" class="fichePJ bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                <button type="action" class="fichePJ bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>
                <h1 class="titre" data-i18n="monk-mode-cea">Mode Céa</h1>
            </div>
            <label class="ligne2">
                <span data-i18n="bonus/malus-jets">Bonus/Malus aux Jets</span>
                <input type="number" name="attr_jetModifDes" value="0" />
            </label>
            <div class="rollPJ">
                <select name="attr_caracteristique1Monk">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
                <select name="attr_caracteristique2Monk">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
            </div>

            <div class="bonusCarac">
                <select name="attr_caracteristique3">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
                <select name="attr_caracteristique4">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
            </div>

            <div class="titre">
                <h1 class="titre" data-i18n="monk-vague-d'energie">Vague d'énergie</h1>
                <button class="rollDice" type="action" name="act_monkJetVague" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=^{monk-vague-d'energie}}}"></button>
            </div>
            <label class="col4">
                <span data-i18n="degats">Dégâts</span>
                <input type="text" name="attr_monkVagueDegat" value="3D6" readonly />
            </label>
            <label class="col4BL">
                <span data-i18n="violence">Violence</span>
                <input type="text" name="attr_monkVagueDegat" value="3D6" readonly />
            </label>
            <label class="col4BL">
                <span data-i18n="energie">Énergie</span>
                <input type="text" name="attr_monkVagueEnergie" value="3" disabled />
            </label>
            <label class="col4BL">
                <span data-i18n="portee">Portée</span>
                <input type="text" name="attr_monkVaguePortee" value="Contact / Courte" readonly />
            </label>
            <input class="ligne" type="text" name="attr_monkVagueEffets" value="Parasitage 2 / Dispersion 3 / Destructeur / Choc 2" readonly />

            <div class="titre">
                <h1 class="titre" data-i18n="monk-salve-d'energie">Salve d'énergie</h1>
                <button class="rollDice" type="action" name="act_monkJetSalve" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=^{monk-salve-d'energie}}}"></button>
            </div>
            <label class="col4">
                <span data-i18n="degats">Dégâts</span>
                <input type="text" name="attr_monkSalveDegat" value="3D6" readonly />
            </label>
            <label class="col4BL">
                <span data-i18n="violence">Violence</span>
                <input type="text" name="attr_monkSalveDegat" value="3D6"  readonly />
            </label>
            <label class="col4BL">
                <span data-i18n="energie">Énergie</span>
                <input type="text" name="attr_monkSalveEnergie" value="3" disabled />
            </label>
            <label class="col4BL">
                <span data-i18n="portee">Portée</span>
                <input type="text" name="attr_monkSalvePortee" value="Moyenne" readonly />
            </label>
            <input class="ligne" type="text" name="attr_monkSalveEffets" value="Parasitage 1 / Dispersion 3 / Ultraviolence / Meurtrier" readonly />

            <div class="titre">
                <h1 class="titre" data-i18n="monk-rayon-d'energie">Rayon d'énergie</h1>
                <button class="rollDice" type="action" name="act_monkJetRayonSpe" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=^{monk-rayon-d'energie}}}"></button>
            </div>
            <label class="col4">
                <span data-i18n="degats">Dégâts</span>
                <input type="text" name="attr_monkRayonDegat" value="4D6" readonly />
            </label>
            <label class="col4BL">
                <span data-i18n="violence">Violence</span>
                <input type="text" name="attr_monkRayonViolence" value="2D6" readonly />
            </label>
            <label class="col4BL">
                <span data-i18n="energie">Énergie</span>
                <input type="text" name="attr_monkRayonEnergie" value="3" disabled />
            </label>
            <label class="col4BL">
                <span data-i18n="portee">Portée</span>
                <input type="text" name="attr_monkRayonPortee" value="Moyenne" readonly />
            </label>
            <input class="ligne" type="text" name="attr_monkRayonEffets" value="Parasitage 1 / Perce Armure 40" readonly />
            <label class="ligne2Special">
                <span data-i18n="maintenu-sur-un-ennemi-pendant-tour">Maintenu sur un ennemi pendant (en tour) :</span>
                <input type="number" name="attr_monkRayonTour" class="textCenter" value="0" min="0" />
            </label>
        </div>

        <div class="fichePJ paladin paladinShrine">
            <input class="active" type="hidden" name="attr_paladinCdFShrine" />

            <div class="titre">
                <h1 class="titre" data-i18n="paladin-champ-de-force-shrine">Champ de Force Shrine</h1>
                <button class="active" type="action" name="act_paladinCdFShrine" data-i18n="activer">Activer</button>
            </div>
            <label class="col3">
                <span data-i18n="bonus-cdf">Bonus de CdF</span>
                <input type="number" name="attr_paladinCdFShrineValue" value="6+@{paladin200PG}" disabled />
            </label>
            <label class="col3BL">
                <span data-i18n="force-requise">Force Requise</span>
                <input type="number" name="attr_paladinCdFShrineForceValue" value="5" disabled />
            </label>
            <label class="col3BL">
                <span data-i18n="chair-requise">Chair Requise</span>
                <input type="number" name="attr_paladinCdFShrineChairValue" value="10" disabled />
            </label>
        </div>
        <div class="fichePJ paladin paladinWatchtower">
            <input class="active" type="hidden" name="attr_paladinWatchtower" />

            <div class="titre">
                <h1 class="titre" data-i18n="paladin-mode-watchtower">Mode Watchtower</h1>
                <button class="active" type="action" name="act_paladinWatchtower" data-i18n="activer">Activer</button>
            </div>
            <label class="ligne">
                <span data-i18n="reaction-actuelle">Réaction actuelle</span>
                <input type="number" name="attr_reactionTotal" value="0" readonly />
            </label>
        </div>
        
        <input class="paladinLeL" type="hidden" name="attr_paladin250PG" value="" />

        <div class="fichePJ paladin paladinLenteEtLourde">
            <h1 class="titre" data-i18n="paladin-lente-et-lourde">Lente et Lourde</h1>
            <span data-i18n="paladin-lente-et-lourde-description">La méta-armure ne peut pas utiliser de module de course, de déplacement ou de saut. En outre, il peut être risqué de passer sur 	certains types de sols, trop fragiles. La difficulté des tests base Discrétion et Déplacement avec la méta-armure Paladin est toujours augmentée d'un niveau.</span>
        </div>

        <div class="fichePJ priest priestMechanic">
            <h1 class="titre" data-i18n="priest-mode-mechanic">Mode Mechanic</h1>
            <div>
                <span data-i18n="portee-contact">Contact</span>
                <input type="text" name="attr_priestMechanicContact" value="3D6+6" readonly />
                <button class="rollDice" type="action" name="act_priestJetMechanicContact" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{priest-mode-mechanic-contact}}} {{jDivers=^{reparation}}} {{jDiversV=[[@{priestMechanicContact}]]}}"></button>
            </div>
            <div>
                <span data-i18n="distance-portee-longue">Distance (Portée Longue)</span>
                <input type="text" name="attr_priestMechanicDistance" value="2D6+6" readonly />
                <button class="rollDice" type="action" name="act_priestJetMechanicDistance" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{priest-mode-mechanic-distance}}} {{jDivers=^{reparation}}} {{jDiversV=[[@{priestMechanicDistance}]]}}"></button>
            </div>
        </div>
        <div class="fichePJ priest priestNanoC">
            <input type="hidden" name="attr_bonusCarac" class="bonusCarac" value="0" />

            <div class="titre">
                <button type="action" class="fichePJ bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                <button type="action" class="fichePJ bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>
                
                <h1 class="titre" data-i18n="priest-mode-nanoc">Mode NanoC</h1>
                <button class="rollDice" type="action" name="act_simplePriest" value="@{jetGM} &{template:simple} {{Nom=@{name}}}"></button>
            </div>
            <label class="ligne2">
                <span>Bonus/Malus aux Jets</span>
                <input type="number" name="attr_jetModifDes" value="0" />
            </label>
            <div class="rollPJ">
                <select name="attr_caracteristique1Priest">
                    <option value="@{technique}" data-i18n="technique" selected>Technique</option>
                </select>
                <select name="attr_caracteristique2">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
            </div>
            <div class="bonusCarac">
                <select name="attr_caracteristique3">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
                <select name="attr_caracteristique4">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
            </div>
            <h1 class="titre" data-i18n="priest-creations">Créations</h1>
            <div class="autoex autoex28">
                <span name="attr_priestNanoc"></span>
                <textarea name="attr_priestNanoc" class="largeTextarea"></textarea>
            </div>
        </div>

        <input class="psion150PG" type="hidden" name="attr_psion150PG" value="0" />
        <input class="psion200PG" type="hidden" name="attr_psion200PG" value="0" />

        <div class="fichePJ psion psionPuppetMaster">
            <input class="bonusCarac" type="hidden" name="attr_bonusCarac" class="bonusCarac" value="0" />

            <div class="titre">
                <button type="action" class="bonusCaracL1 psion150" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                <button type="action" class="bonusCaracL2 psion150" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>
                
                <h1 class="titre" data-i18n="mode-puppet-master">Mode Puppet Master</h1>
                <button class="psion150 rollDice" type="action" name="act_simplePsionPuppet" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{mode-puppet-master}}}"></button>
            </div>
            <div class="psion150 rollPJ">
                <select name="attr_caracteristique1Psion">
                    <option value="@{aura}" data-i18n="aura" selected>Aura</option>
                </select>
                <select name="attr_caracteristique2">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
            </div>

            <div class="psion150 bonusCarac">
                <select name="attr_caracteristique3">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
                <select name="attr_caracteristique4">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
            </div>
            <h2 class="titreBis" data-i18n="ordre-donne">Ordre Donné</h2>
            <div class="autoex autoex28">
                <span name="attr_psionPuppetOrdre"></span>
                <textarea name="attr_psionPuppetOrdre"></textarea>
            </div>
        </div>
        <div class="fichePJ psion psionDiscord">
            <input class="active" type="hidden" name="attr_psionDiscord" />
            <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0" />

            <div class="titre">
                <button type="action" class="bonusCaracL1 psion200" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                <button type="action" class="bonusCaracL2 psion200" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>

                <h1 class="titre" data-i18n="psion-mode-discord">Mode Discord</h1>
                <button class="active" type="action" name="act_psionDiscord" data-i18n="activer">Activer</button>
            </div>
            <label class="psion200 ligne2">
                <span data-i18n="bonus/malus-jets">Bonus/Malus aux Jets</span>
                <input type="number" name="attr_jetModifDes" value="0" />
            </label>
            <div class="psion200 rollPJ">
                <select name="attr_caracteristique1Psion">
                    <option value="@{aura}" data-i18n="aura" selected>Aura</option>
                </select>
                <select name="attr_caracteristique2">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
                <button class="rollDice" type="action" name="act_simplePsionDiscord" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{psion-mode-discord}}}"></button>
            </div>
            
            <div class="psion200 bonusCarac">
                <select name="attr_caracteristique3">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
                <select name="attr_caracteristique4">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
            </div>
            <label class="col3">
                <span data-i18n="malus-action">Malus Actions</span>
                <input type="text" name="attr_psionMalusA" value="2D" readonly />
            </label>
            <label class="col3BL">
                <span data-i18n="malus-reaction">Malus Réaction</span>
                <input type="text" name="attr_psionMalus" value="2" readonly />
            </label>
            <label class="col3BL">
                <span data-i18n="malus-defense">Malus Défense</span>
                <input type="text" name="attr_psionMalus" value="2" readonly />
            </label>
        </div>
        <div class="fichePJ psion psionWindtalker">
            <h1 class="titre" data-i18n="psion-mode-windtalker">Mode Windtalker</h1>
            <h2 class="titreBis" data-i18n="actions-creatures">Actions des Créatures</h2>
            <div class="autoex autoex28">
                <span name="attr_psionWindtalkerActions"></span>
                <textarea name="attr_psionWindtalkerActions"></textarea>
            </div>
        </div>

        <div class="fichePJ ranger effetsArmes">
            <h1 class="titre" data-i18n="effet-des-armes">Effet des armes</h1>
            <select name="attr_effetArmes">
                <option value="" selected=""></option>
                <option value="anti-anatheme-description" data-i18n="anti-anatheme">Anti-Anathème</option>
                <option value="anti-vehicule-description" data-i18n="anti-vehicule">Anti-Véhicule</option>
                <option value="artillerie-description" data-i18n="artillerie">Artillerie</option>
                <option value="assistance-attaque-description" data-i18n="assistance-attaque">Assistance à l'attaque</option>
                <option value="choc-description" data-i18n="choc-x">Choc X</option>
                <option value="degats-continus-description" data-i18n="degats-continus-x">Dégâts Continus X</option>
                <option value="demoralisant-description" data-i18n="demoralisant">Démoralisant</option>
                <option value="designation-description" data-i18n="designation">Désignation</option>
                <option value="deux-mains-description" data-i18n="deux-mains">Deux Mains</option>
                <option value="dispersion-description" data-i18n="dispersion-x">Dispersion X</option>
                <option value="en-chaine-description" data-i18n="en-chaine">En Chaîne</option>
                <option value="fureur-description" data-i18n="fureur">Fureur</option>
                <option value="ignore-armure-description" data-i18n="ignore-armure">Ignore Armure</option>
                <option value="lourd-description" data-i18n="lourd">Lourd</option>
                <option value="lumiere-description" data-i18n="lumiere-x">Lumière X</option>
                <option value="penetrant-description" data-i18n="penetrant-x">Pénétrant X</option>
                <option value="perce-armure-description" data-i18n="perce-armure-x">Perce Armure X</option>
                <option value="silencieux-description" data-i18n="silencieux">Silencieux</option>
                <option value="ultraviolence-description" data-i18n="ultraviolence">Ultraviolence</option>
            </select>
            <span name="attr_effetArmes-description"></span>
        </div>
        <div class="fichePJ ranger rangerVision">
            <input type="hidden" name="attr_bonusCarac" class="bonusCarac" value="0" />

            <div class="titre">
                <button type="action" class="fichePJ bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                <button type="action" class="fichePJ bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>

                <h1 class="titre" data-i18n="ranger-vision">Vision</h1>
                <button class="rollDice" type="action" name="act_simpleRangerVision" value="@{jetGM} &{template:simple} {{Nom=@{name}}}"></button>
            </div>
            <div class="rollPJ">
                <select name="attr_caracteristique1Ranger">
                    <option value="@{perception}"  data-i18n="perception" selected>Perception</option>
                </select>
                <select name="attr_caracteristique2">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
            </div>
            <div class="bonusCarac">
                <select name="attr_caracteristique3">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
                <select name="attr_caracteristique4">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
            </div>
        </div>
        <div class="fichePJ ranger herauts">
            <h1 class="titre">Chevalier de la lumière / Hérauts de l'équilibre</h1>
            <div>
                <input type="hidden" name="attr_devasterAnatheme" class="devasterAnatheme" value="0" />
                <input type="hidden" name="attr_bourreauTenebres" class="bourreauTenebres" value="0" />
                <input type="hidden" name="attr_equilibreBalance" class="equilibreBalance" value="0" />

                <button type="action" name="act_devasterAnatheme" class="devasterAnatheme" >Dévaster l'Anathème actif</button>
                <button type="action" name="act_bourreauTenebres" class="bourreauTenebres" >Bourreau des ténèbres actif</button>
                <button type="action" name="act_equilibreBalance" class="equilibreBalance" >Équilibrer la balance actif</button>
            </div>
        </div>
        <div class="fichePJ ranger portee">
            <h1 class="titre" data-i18n="portee">Portée</h1>
            <div class="col5">
                <span data-i18n="portee-contact">Contact</span>
                <span data-i18n="portee-0-2">0 à 2m</span>
            </div>
            <div class="col5BL">
                <span data-i18n="portee-courte">Courte</span>
                <span data-i18n="portee-2-15">2 à 15m</span>
            </div>
            <div class="col5BL">
                <span data-i18n="portee-moyenne">Moyenne</span>
                <span data-i18n="portee-15-50">15 à 50m</span>
            </div>
            <div class="col5BL">
                <span data-i18n="portee-longue">Longue</span>
                <span data-i18n="portee-50-300">50 à 300m</span>
            </div>
            <div class="col5BL">
                <span data-i18n="portee-lointaine">Lointaine</span>
                <span data-i18n="portee-+300">+ de 300m</span>
            </div>
        </div>
        <label class="fichePJ ranger BMJets">
            <span data-i18n="bonus/malus-jets">Bonus/Malus aux Jets</span>
            <input type="number" name="attr_jetModifDes" value="0" />
        </label>
        <div class="fichePJ ranger styleCombat">					
            <h1 class="titre" data-i18n="style-de-combat">Style de Combat</h1>
            <select name="attr_styleCombat">
                <option value="standard" data-i18n="standard" selected>Standard</option>
                <option value="couvert" data-i18n="couvert">À Couvert</option>
                <option value="agressif" data-i18n="agressif">Agressif</option>
                <option value="akimbo" data-i18n="akimbo">Akimbo</option>
                <option value="ambidextre" data-i18n="ambidextre">Ambidextre</option>
                <option value="defensif" data-i18n="defensif">Défensif</option>
                <option value="precis" data-i18n="precis">Précis</option>
                <option value="pilonnage" data-i18n="pilonnage">Pilonnage</option>
                <option value="puissant" data-i18n="puissant">Puissant</option>
                <option value="suppression" data-i18n="suppression">Suppression</option>
            </select>
            <input type="hidden" name="attr_styleCombat" value="standard" />
            <div class="puissant">
                <span data-i18n="bonus-en">Bonus en</span>
                <select name="attr_stylePuissantType">
                    <option value="{{stylePuissantD=[[@{stylePuissantBonus}D6]]}}" data-i18n="degats" selected>Dégâts</option>
                    <option value="{{stylePuissantV=[[@{stylePuissantBonus}D6]]}}" data-i18n="violence">Violence</option>
                </select>
                <input type="number" name="attr_stylePuissantBonus" value="0" min="0" max="6" />
            </div>
            <div class="suppression">
                <label>
                    <span>Malus aux dégâts</span>
                    <input type="number" name="attr_styleSuppressionD" value="0" min="0" max="6" />
                </label>

                <label>
                    <span>Malus à la violence</span>
                    <input type="number" name="attr_styleSuppressionV" value="0" min="0" max="8" />
                </label>
            </div>
            <div class="autoex autoex40">
                <span name="attr_styleCombatDescr"></span>
                <textarea name="attr_styleCombatDescr" readonly></textarea>
            </div>
        </div>

        <div class="fichePJ rogue rogueGhost">
            <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0" />
            <input class="active" type="hidden" name="attr_rogueGhost" value=""/>

            <div class="titre">
                <button type="action" class="bonusCaracL1 psion200" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                <button type="action" class="bonusCaracL2 psion200" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>
                
                <h1 class="titre" data-i18n="mode-ghost">Mode Ghost</h1>
                <button class="active" type="action" name="act_rogueGhost" data-i18n="activer">Activer</button>
            </div>
            <label class="ligne2">
                <span data-i18n="bonus/malus-jets">Bonus/Malus aux Jets</span>
                <input type="number" name="attr_jetModifDes" value="0" />
            </label>
            <div class="rollPJ">
                <select name="attr_caracteristique1">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
                <select name="attr_caracteristique2">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
                <button class="rollDice" type="action" name="act_simpleRogue" value="@{jetGM} &{template:simple} {{Nom=@{name}}}"></button>
            </div>
            <div class="bonusCarac">
                <select name="attr_caracteristique3">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
                <select name="attr_caracteristique4">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
            </div>
        </div>

        <input class="choixShaman" type="hidden" name="attr_choixArmure" value="choix" />
        <div class="fichePJ shaman choixShaman">
            <input class="PG200" type="hidden" name="attr_shaman200PG" value="0">

            <div class="shaman">
                <div class="PG200 shamanImpregnation">
                    <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0" />
        
                    <div class="titre">
                        <button type="action" class="bonusCaracL1 psion200" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                        <button type="action" class="bonusCaracL2 psion200" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>
        
                        <h1 class="titre" data-i18n="shaman-impregnation">Imprégnation</h1>
                        <button class="rollDice" type="action" name="act_simpleShamanImpregnation" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{shaman-impregnation} (@{shamanImpregnation})}}"></button>
                    </div>
                    <label class="ligne2">
                        <span data-i18n="total-actuel">Total actuel</span>
                        <input type="number" name="attr_shamanImpregnation" value="0" min="0" />
                    </label>
                    <div class="rollPJ">
                        <select name="attr_caracteristique1ShamanImpregnation">
                            <option value="0" selected></option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        </select>
                        <select name="attr_caracteristique2ShamanImpregnation">
                            <option value="0" selected></option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                        </select>
                    </div>
        
                    <div class="bonusCarac">
                        <select name="attr_caracteristique3">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <select name="attr_caracteristique4">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="fichePJ shaman shamanTotem">
            <input class="nbreTotem" type="hidden" name="attr_shamanNbreTotem" value="0" />

            <h1 class="titre" data-i18n="shaman-mode-totem">Mode Totem</h1>
            <label class="ligne2">
                <span data-i18n="shaman-nombre-totem">Nombre de totems</span>
                <input type="number" name="attr_shamanNbreTotem" value="0" min="0" max="3" />
            </label>
            
            <label class="ligne2 totem1">
                <span data-i18n="shaman-caracteristique-totem-1">Caractéristique du Totem 1</span>
                <select name="attr_caracteristiqueTotem1">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
            </label>
            <label class="ligne2 totem2">
                <span data-i18n="shaman-caracteristique-totem-2">Caractéristique du Totem 2</span>
                <select name="attr_caracteristiqueTotem2">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
            </label>
            <label class="ligne2 totem3">
                <span data-i18n="shaman-caracteristique-totem-3">Caractéristique du Totem 3</span>
                <select name="attr_caracteristiqueTotem3">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
            </label>
        </div>
        <div class="fichePJ shaman jet">
            <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0" />

            <div class="titre">
                <button type="action" class="bonusCaracL1 psion200" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                <button type="action" class="bonusCaracL2 psion200" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>

                <h1 class="titre" data-i18n="jet">Jet</h1>
                <button class="rollDice" type="action" name="act_simple" value="@{jetGM} &{template:simple} {{Nom=@{name}}}"></button>
           </div>
            <label class="ligne2">
                <span data-i18n="bonus/malus-jets">Bonus/Malus aux Jets</span>
                <input type="number" name="attr_jetModifDes" value="0" />
            </label>
            <div class="rollPJ">
                <select name="attr_caracteristique1">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
                <select name="attr_caracteristique2">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
            </div>

            <div class="bonusCarac">
                <select name="attr_caracteristique3">
                    <option value="" selected></option>
                    <option value="{{carac3=^{deplacement}}} {{bonusMALWarrOD3=[[@{MALWarriorSoldierA}]]}} {{bonusWarrOD3=[[@{warriorSoldierA}]]}} {{MALBonusBarb3=[[0]]}} {{bonusBarb3=[[0]]}} {{OD3=[[@{deplOD}]]}} {{jCarac3=[[ {@{deplacement}d6cs2cs4cs6cf1cf3cf5s%2}=0 ]]}}" data-i18n="deplacement">Déplacement</option>
                    <option value="{{carac3=^{force}}} {{bonusMALWarrOD3=[[@{MALWarriorSoldierA}]]}} {{bonusWarrOD3=[[@{warriorSoldierA}]]}} {{MALBonusBarb3=[[@{MALBarbarianGoliath}]]}} {{bonusBarb3=[[@{barbarianGoliath}]]}} {{OD3=[[@{forOD}]]}} {{jCarac3=[[ {@{force}d6cs2cs4cs6cf1cf3cf5s%2}=0 ]]}}" data-i18n="force">Force</option>
                    <option value="{{carac3=^{endurance}}} {{bonusMALWarrOD3=[[@{MALWarriorSoldierA}]]}} {{bonusWarrOD3=[[@{warriorSoldierA}]]}} {{MALBonusBarb3=[[@{MALBarbarianGoliath}]]}} {{bonusBarb3=[[@{barbarianGoliath}]]}} {{OD3=[[@{endOD}]]}} {{jCarac3=[[ {@{endurance}d6cs2cs4cs6cf1cf3cf5s%2}=0 ]]}}" data-i18n="endurance">Endurance</option>
                    <option value="{{carac3=^{hargne}}} {{bonusMALWarrOD3=[[@{MALWarriorHunterA}]]}} {{bonusWarrOD3=[[@{warriorHunterA}]]}} {{MALBonusBarb3=[[0]]}} {{bonusBarb3=[[0]]}} {{OD3=[[@{hargneOD}]]}} {{jCarac3=[[ {@{hargne}d6cs2cs4cs6cf1cf3cf5s%2}=0 ]]}}" data-i18n="hargne">Hargne</option>
                    <option value="{{carac3=^{combat}}} {{bonusMALWarrOD3=[[@{MALWarriorHunterA}]]}} {{bonusWarrOD3=[[@{warriorHunterA}]]}} {{MALBonusBarb3=[[0]]}} {{bonusBarb3=[[0]]}} {{OD3=[[@{combOD}]]}} {{jCarac3=[[ {@{combat}d6cs2cs4cs6cf1cf3cf5s%2}=0 ]]}}" data-i18n="combat">Combat</option>
                    <option value="{{carac3=^{instinct}}} {{bonusMALWarrOD3=[[@{MALWarriorHunterA}]]}} {{bonusWarrOD3=[[@{warriorHunterA}]]}} {{MALBonusBarb3=[[0]]}} {{bonusBarb3=[[0]]}} {{OD3=[[@{instOD}]]}} {{jCarac3=[[ {@{instinct}d6cs2cs4cs6cf1cf3cf5s%2}=0 ]]}}" data-i18n="instinct">Instinct</option>
                    <option value="{{carac3=^{tir}}} {{bonusMALWarrOD3=[[@{MALWarriorScholarA}]]}} {{bonusWarrOD3=[[@{warriorScholarA}]]}} {{MALBonusBarb3=[[0]]}} {{bonusBarb3=[[0]]}} {{OD3=[[@{tirOD}]]}} {{jCarac3=[[ {@{tir}d6cs2cs4cs6cf1cf3cf5s%2}=0 ]]}}" data-i18n="tir">Tir</option>
                    <option value="{{carac3=^{savoir}}} {{bonusMALWarrOD3=[[@{MALWarriorScholarA}]]}} {{bonusWarrOD3=[[@{warriorScholarA}]]}} {{MALBonusBarb3=[[0]]}} {{bonusBarb3=[[0]]}} {{OD3=[[@{savoirOD}]]}} {{jCarac3=[[ {@{savoir}d6cs2cs4cs6cf1cf3cf5s%2}=0 ]]}}" data-i18n="savoir">Savoir</option>
                    <option value="{{carac3=^{technique}}} {{bonusMALWarrOD3=[[@{MALWarriorScholarA}]]}} {{bonusWarrOD3=[[@{warriorScholarA}]]}} {{MALBonusBarb3=[[0]]}} {{bonusBarb3=[[0]]}} {{OD3=[[@{technOD}]]}} {{jCarac3=[[ {@{technique}d6cs2cs4cs6cf1cf3cf5s%2}=0 ]]}}" data-i18n="technique">Technique</option>
                    <option value="{{carac3=^{aura}}}{{bonusMALWarrOD3=[[@{MALWarriorHeraldA}]]}} {{bonusWarrOD3=[[@{warriorHeraldA}]]}} {{MALBonusBarb3=[[0]]}} {{bonusBarb3=[[0]]}} {{OD3=[[@{auraOD}]]}} {{jCarac3=[[ {@{aura}d6cs2cs4cs6cf1cf3cf5s%2}=0 ]]}}" data-i18n="aura">Aura</option>
                    <option value="{{carac3=^{parole}}}{{bonusMALWarrOD3=[[@{MALWarriorHeraldA}]]}} {{bonusWarrOD3=[[@{warriorHeraldA}]]}} {{MALBonusBarb3=[[0]]}} {{bonusBarb3=[[0]]}} {{OD3=[[@{paroleOD}]]}} {{jCarac3=[[ {@{parole}d6cs2cs4cs6cf1cf3cf5s%2}=0 ]]}}" data-i18n="parole">Parole</option>
                    <option value="{{carac3=^{sang-froid}}}{{bonusMALWarrOD3=[[@{MALWarriorHeraldA}]]}} {{bonusWarrOD3=[[@{warriorHeraldA}]]}} {{MALBonusBarb3=[[0]]}} {{bonusBarb3=[[0]]}} {{OD3=[[@{sfOD}]]}} {{jCarac3=[[ {@{sf}d6cs2cs4cs6cf1cf3cf5s%2}=0 ]]}}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="{{carac3=^{discretion}}} {{bonusMALWarrOD3=[[@{MALWarriorScoutA}]]}} {{bonusWarrOD3=[[@{warriorScoutA}]]}} {{MALBonusBarb3=[[0]]}} {{bonusBarb3=[[0]]}} {{OD3=[[@{discrOD}]]}} {{jCarac3=[[ {@{discretion}d6cs2cs4cs6cf1cf3cf5s%2}=0 ]]}}" data-i18n="discretion">Discrétion</option>
                    <option value="{{carac3=^{perception}}} {{bonusMALWarrOD3=[[@{MALWarriorScoutA}]]}} {{bonusWarrOD3=[[@{warriorScoutA}]]}} {{MALBonusBarb3=[[0]]}} {{bonusBarb3=[[0]]}} {{OD3=[[@{percOD}]]}} {{jCarac3=[[ {@{perception}d6cs2cs4cs6cf1cf3cf5s%2}=0 ]]}}" data-i18n="perception">Perception</option>
                    <option value="{{carac3=^{dexterite}}} {{bonusMALWarrOD3=[[@{MALWarriorScoutA}]]}} {{bonusWarrOD3=[[@{warriorScoutA}]]}} {{MALBonusBarb3=[[0]]}} {{bonusBarb3=[[0]]}} {{OD3=[[@{dextOD}]]}} {{jCarac3=[[ {@{dexterite}d6cs2cs4cs6cf1cf3cf5s%2}=0 ]]}}" data-i18n="dexterite">Dextérité</option>
                </select>
                <select name="attr_caracteristique4">
                    <option value="" selected></option>
                    <option value="{{jCarac4=[[ {@{deplacement}d6cs2cs4cs6cf1cf3cf5s%2}=0 ]]}} {{OD4=[[@{deplOD}]]}} {{bonusMALWarrOD4=[[@{MALWarriorSoldierA}]]}} {{bonusWarrOD4=[[@{warriorSoldierA}]]}} {{MALBonusBarb4=[[0]]}} {{bonusBarb4=[[0]]}} {{carac4=^{deplacement}}}" data-i18n="deplacement">Déplacement</option>
                    <option value="{{jCarac4=[[ {@{force}d6cs2cs4cs6cf1cf3cf5s%2}=0 ]]}} {{OD4=[[@{forOD}]]}} {{bonusMALWarrOD4=[[@{MALWarriorSoldierA}]]}} {{bonusWarrOD4=[[@{warriorSoldierA}]]}} {{MALBonusBarb4=[[@{MALBarbarianGoliath}]]}} {{bonusBarb4=[[@{barbarianGoliath}]]}} {{carac4=^{force}}}" data-i18n="force">Force</option>
                    <option value="{{jCarac4=[[ {@{endurance}d6cs2cs4cs6cf1cf3cf5s%2}=0 ]]}} {{OD4=[[@{endOD}]]}} {{bonusMALWarrOD4=[[@{MALWarriorSoldierA}]]}} {{bonusWarrOD4=[[@{warriorSoldierA}]]}} {{MALBonusBarb4=[[@{MALBarbarianGoliath}]]}} {{bonusBarb4=[[@{barbarianGoliath}]]}} {{carac4=^{endurance}}}" data-i18n="endurance">Endurance</option>
                    <option value="{{jCarac4=[[ {@{hargne}d6cs2cs4cs6cf1cf3cf5s%2}=0 ]]}} {{OD4=[[@{hargneOD}]]}} {{bonusMALWarrOD4=[[@{MALWarriorHunterA}]]}} {{bonusWarrOD4=[[@{warriorHunterA}]]}} {{MALBonusBarb4=[[0]]}} {{bonusBarb4=[[0]]}} {{carac4=^{hargne}}}" data-i18n="hargne">Hargne</option>
                    <option value="{{jCarac4=[[ {@{combat}d6cs2cs4cs6cf1cf3cf5s%2}=0 ]]}} {{OD4=[[@{combOD}]]}} {{bonusMALWarrOD4=[[@{MALWarriorHunterA}]]}} {{bonusWarrOD4=[[@{warriorHunterA}]]}} {{MALBonusBarb4=[[0]]}} {{bonusBarb4=[[0]]}} {{carac4=^{combat}}}" data-i18n="combat">Combat</option>
                    <option value="{{jCarac4=[[ {@{instinct}d6cs2cs4cs6cf1cf3cf5s%2}=0 ]]}} {{OD4=[[@{instOD}]]}} {{bonusMALWarrOD4=[[@{MALWarriorHunterA}]]}} {{bonusWarrOD4=[[@{warriorHunterA}]]}} {{MALBonusBarb4=[[0]]}} {{bonusBarb4=[[0]]}} {{carac4=^{instinct}}}" data-i18n="instinct">Instinct</option>
                    <option value="{{jCarac4=[[ {@{tir}d6cs2cs4cs6cf1cf3cf5s%2}=0 ]]}} {{OD4=[[@{tirOD}]]}} {{bonusMALWarrOD4=[[@{MALWarriorScholarA}]]}}  {{bonusWarrOD4=[[@{warriorScholarA}]]}} {{MALBonusBarb4=[[0]]}} {{bonusBarb4=[[0]]}} {{carac4=^{tir}}}" data-i18n="tir">Tir</option>
                    <option value="{{jCarac4=[[ {@{savoir}d6cs2cs4cs6cf1cf3cf5s%2}=0 ]]}} {{OD4=[[@{savoirOD}]]}} {{bonusMALWarrOD4=[[@{MALWarriorScholarA}]]}}  {{bonusWarrOD4=[[@{warriorScholarA}]]}} {{MALBonusBarb4=[[0]]}} {{bonusBarb4=[[0]]}} {{carac4=^{savoir}}}" data-i18n="savoir">Savoir</option>
                    <option value="{{jCarac4=[[ {@{technique}d6cs2cs4cs6cf1cf3cf5s%2}=0 ]]}} {{OD4=[[@{technOD}]]}} {{bonusMALWarrOD4=[[@{MALWarriorScholarA}]]}}  {{bonusWarrOD4=[[@{warriorScholarA}]]}} {{MALBonusBarb4=[[0]]}} {{bonusBarb4=[[0]]}} {{carac4=^{technique}}}" data-i18n="technique">Technique</option>
                    <option value="{{jCarac4=[[ {@{aura}d6cs2cs4cs6cf1cf3cf5s%2}=0 ]]}} {{OD4=[[@{auraOD}]]}} {{bonusMALWarrOD4=[[@{MALWarriorHeraldA}]]}} {{bonusWarrOD4=[[@{warriorHeraldA}]]}} {{MALBonusBarb4=[[0]]}} {{bonusBarb4=[[0]]}} {{carac4=^{aura}}}" data-i18n="aura">Aura</option>
                    <option value="{{jCarac4=[[ {@{parole}d6cs2cs4cs6cf1cf3cf5s%2}=0 ]]}} {{OD4=[[@{paroleOD}]]}} {{bonusMALWarrOD4=[[@{MALWarriorHeraldA}]]}} {{bonusWarrOD4=[[@{warriorHeraldA}]]}} {{MALBonusBarb4=[[0]]}} {{bonusBarb4=[[0]]}} {{carac4=^{parole}}}" data-i18n="parole">Parole</option>
                    <option value="{{jCarac4=[[ {@{sf}d6cs2cs4cs6cf1cf3cf5s%2}=0 ]]}} {{OD4=[[@{sfOD}]]}} {{bonusMALWarrOD4=[[@{MALWarriorHeraldA}]]}} {{bonusWarrOD4=[[@{warriorHeraldA}]]}} {{MALBonusBarb4=[[0]]}} {{bonusBarb4=[[0]]}} {{carac4=^{sang-froid}}}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="{{jCarac4=[[ {@{discretion}d6cs2cs4cs6cf1cf3cf5s%2}=0 ]]}} {{OD4=[[@{discrOD}]]}} {{bonusMALWarrOD4=[[@{MALWarriorScoutA}]]}} {{bonusWarrOD4=[[@{warriorScoutA}]]}} {{MALBonusBarb4=[[0]]}} {{bonusBarb4=[[0]]}} {{carac4=^{discretion}}}" data-i18n="discretion">Discrétion</option>
                    <option value="{{jCarac4=[[ {@{perception}d6cs2cs4cs6cf1cf3cf5s%2}=0 ]]}} {{OD4=[[@{percOD}]]}} {{bonusMALWarrOD4=[[@{MALWarriorScoutA}]]}} {{bonusWarrOD4=[[@{warriorScoutA}]]}} {{MALBonusBarb4=[[0]]}} {{bonusBarb4=[[0]]}} {{carac4=^{perception}}}" data-i18n="perception">Perception</option>
                    <option value="{{jCarac4=[[ {@{dexterite}d6cs2cs4cs6cf1cf3cf5s%2}=0 ]]}} {{OD4=[[@{dextOD}]]}} {{bonusMALWarrOD4=[[@{MALWarriorScoutA}]]}} {{bonusWarrOD4=[[@{warriorScoutA}]]}} {{MALBonusBarb4=[[0]]}} {{bonusBarb4=[[0]]}} {{carac4=^{dexterite}}}" data-i18n="dexterite">Dextérité</option>
                </select>
            </div>
        </div>

        <div class="fichePJ shaman choixShaman">
            <input class="PG200" type="hidden" name="attr_shaman200PG" value="0">

            <div class="shaman">               
                <div class="PG200 shamanAscension">
                    <input class="active" type="hidden" name="attr_shamanAscension" value="0"/>
        
                    <div class="titre">
                        <h1 class="titre" data-i18n="shaman-mode-ascension">Mode Ascension</h1>
        
                        <button class="active" type="action" name="act_shamanAscension" data-i18n="activer">Activer</button>
                    </div>
                    <label class="ligne2">
                        <span data-i18n="depense-d'energie">Dépense d'énergie</span>
                        <input type="number" name="attr_shamanAscensionEnergie" min="10" max="50" value="10" />
                    </label>
                    <input type="hidden" name="attr_shamanAscension" value="0" />
                    <div class="ligneTitre">
                        <span></span>
                        <span data-i18n="actuel">Actuel</span>
                        <span data-i18n="maximum">Maximum</span>
                        <span data-i18n="modif">Modif</span>
                    </div>
                    <div class="ligne3">
                        <span data-i18n="armure">Armure</span>
                        <div><input type="number" name="attr_armureAscension" value="60" /></div>
                        <div><input type="number" name="attr_armureAscension_max" value="60" readonly /></div>
                        <div><input type="number" name="attr_armurePJModif" value="0" /></div>
                    </div>
                    <div class="ligne3">
                        <span data-i18n="energie">Energie</span>
                        <div><input type="number" name="attr_energieAscension" value="0" /></div>
                        <div><input type="number" name="attr_energieAscension_max" value="0" readonly /></div>
                        <div><input type="number" name="attr_energieAscensionModif" value="0" readonly /></div>
                    </div>
                    <div class="ligne3">
                        <span data-i18n="champ-de-force">Champ de force</span>
                        <div><input type="number" name="attr_cdfAscension" value="10" readonly /></div>
                        <div><input type="number" name="attr_cdfAscension_max" value="10" readonly /></div>
                        <div><input type="number" name="attr_cdfPJAscensionModif"  value="0" /></div>
                    </div>
                </div>
            </div>
        
        </div>
    
        <div class="fichePJ sorcerer sorcererMorph">
            <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0" />
            <input class="sorcerer250" type="hidden" name="attr_sorcerer250PG" value="" />
            <input class="activateModeMorph250" type="hidden" name="attr_sorcererMM250PG" value="" />

            <div class="titre">
                <h1 class="titre" data-i18n="mode-morph">Mode Morph</h1>

                <button class="active PG250" type="action" name="act_sorcererMM250PG" data-i18n="activer">Activer</button>
            </div>
            <div class="titre borderCTop">
                <h1 class="titre" data-i18n="mode-morph-etirement">Étirement</h1>

                <label class="fakeButton not250PG">
                    <input type="checkbox" name="attr_sorcererMMEtirement" value="on" />
                    <span data-i18n-title="activer" title="Activer"></span>
                </label>
            </div>
            <div class="titreBis">
                <button type="action" class="bonusCaracL1 psion200" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                <button type="action" class="bonusCaracL2 psion200" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>
                
                <h2 class="titreBis" data-i18n="mode-morph-etirement-immobilisation">Immobilisation</h2>
                <button class="rollDice" type="action" name="act_simpleSorcererEtirement" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{mode-morph-etirement-immobilisation}}}"></button>
            </div>
            <label class="ligne2">
                <span data-i18n="bonus/malus-jets">Bonus/Malus aux Jets</span>
                <input type="number" name="attr_jetModifDes" value="0" />
            </label>
            <div class="rollPJ">
                <select name="attr_caracteristique1">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
                <select name="attr_caracteristique2">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
            </div>
            <div class="bonusCarac">
                <select name="attr_caracteristique3">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
                <select name="attr_caracteristique4">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
            </div>
            <div class="titre">
                <h1 class="titre" data-i18n="mode-morph-vol-en-nuee">Vol en Nuée</h1>

                <label class="fakeButton not250PG">
                    <input type="checkbox" name="attr_sorcererMMVolNuee" value="on" />
                    <span data-i18n-title="activer" title="Activer"></span>
                </label>
            </div>
            <div class="titre borderCTop">
                <h1 class="titre" data-i18n="mode-morph-phase">Phase</h1>

                <label class="fakeButton not250PG">
                    <input type="checkbox" name="attr_sorcererMMPhase" value="on" />
                    <span data-i18n-title="active" title="Activé"></span>
                </label>
            </div>
            <div class="titre borderCTop">
                <h1 class="titre" data-i18n="mode-morph-corps-en-metal">Corps de Métal</h1>

                <label class="fakeButton not250PG">
                    <input type="checkbox" name="attr_sorcererMMCorpMetal" value="2+(@{sorcerer150PG}*2)" />
                    <span data-i18n-title="activer" title="Activer"></span>
                </label>
            </div>
            <div class="titre borderCTop">
                <h1 class="titre" data-i18n="mode-morph-corps-fluide">Corps Fluide</h1>
                
                <label class="fakeButton not250PG">
                    <input type="checkbox" name="attr_sorcererMMCorpFluide" value="2+(@{sorcerer150PG}*1)" />
                    <span data-i18n-title="activer" title="Activer"></span>
                </label>
            </div>
            <label class="col2">
                <span data-i18n="defense">Défense</span>
                <input type="text" name="attr_defenseTotal" value="0" readonly />
            </label>
            <label class="col2BL">
                <span data-i18n="reaction">Réaction</span>
                <input type="text" name="attr_reactionTotal" value="0" readonly />
            </label>

            <div class="titre">
                <h1 class="titre" data-i18n="mode-morph-polymorphie-de-guerre">Polymorphie de Guerre</h1>
                <label class="fakeButton not250PG">
                    <input type="checkbox" name="attr_sorcererMMPMGuerre" value="on" />
                    <span data-i18n-title="activer" title="Activer"></span>
                </label>
            </div>
            <h2 class="titreBis borderSBottom" data-i18n="mode-morph-polymorphie-de-guerre-module-genere">Module Généré</h2>
            <div class="autoex autoex28">
                <span name="attr_sorcererMMPMGuerreModules"></span>
                <textarea name="attr_sorcererMMPMGuerreModules"></textarea>
            </div>
            <h2 class="titreBis borderS" data-i18n="mode-morph-polymorphie-de-guerre-module-genere-effets-choisis">Effets Choisis</h2>
            <div class="autoex autoex28">
                <span name="attr_sorcererEffetsBonus15OG"></span>
                <textarea name="attr_sorcererEffetsBonus15OG"></textarea>
            </div>
        </div>

        <div class="fichePJ warlock warlockForward">
            <input class="active" type="hidden" name="attr_warlockForward" />

            <div class="titre">
                <h1 class="titre" data-i18n="warlock-mode-forward">Mode Forward</h1>

                <button class="active" type="action" name="act_warlockForward" data-i18n="activer">Activer</button>
            </div>
        </div>
        <div class="fichePJ warlock warlockRecord">
            <input class="active" type="hidden" name="attr_warlockRecord" />

            <div class="titre">
                <h1 class="titre" data-i18n="warlock-mode-record">Mode Record</h1>

                <button class="active" type="action" name="act_warlockRecord" data-i18n="activer">Activer</button>
            </div>
            <label class="ligne2">
                <span data-i18n="warlock-mode-record-success">Succès enregistrés</span>
                <input type="number" name="attr_warlockRecordSuccess" value="0" />
            </label>
            <label class="ligne2">
                <span data-i18n="warlock-mode-record-dmg">Dégâts enregistrés</span>
                <input type="number" name="attr_warlockRecordDmg" value="0" />
            </label>
            <label class="ligne2">
                <span data-i18n="warlock-mode-record-violence">Violence enregistrée</span>
                <input type="number" name="attr_warlockRecordViolence" value="0" />
            </label>
            <h1 class="titre" data-i18n="notes">Notes</h1>
            <div class="autoex autoex22">
                <textarea name="attr_warlockRecordNotes"></textarea>
                <span name="attr_warlockRecordNotes"></span>
            </div>
        </div>
        <div class="fichePJ warlock warlockRewind">
            <input class="active" type="hidden" name="attr_warlockRewind" />

            <div class="titre">
                <h1 class="titre" data-i18n="warlock-mode-rewind">Mode Rewind</h1>

                <button class="active" type="action" name="act_warlockRewind" data-i18n="activer">Activer</button>
            </div>
            <div class="autoex autoex22">
                <textarea name="attr_warlockRewindNotes"></textarea>
                <span name="attr_warlockRewindNotes"></span>
            </div>
        </div>
        <div class="fichePJ warlock warlockContrecoups">
            <div class="titre">
                <h1 class="titre" data-i18n="warlock-contrecoups">Contrecoups</h1>

                <button class="rollDice" type="action" name="act_rollWarlockContrecoups" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{warlock-contrecoups}}}"></button>
            </div>
        </div>

        <div class="fichePJ warmaster warmasterFalcon">
            <h1 class="titre" data-i18n="mode-falcon">Mode Falcon</h1>
            <h2 class="titreBis" data-i18n="mode-falcon-faiblesses-detectees">Faiblesses détectées</h2>
            <div class="autoex autoex28">
                <span name="attr_warmasterModeFalcon"></span>
                <textarea name="attr_warmasterModeFalcon" class="largeTextarea"></textarea>
            </div>
        </div>
        <div class="fichePJ warmaster warmasterWarlord">
            <input class="action" type="hidden" name="attr_warmasterImpActionC" value="" />
            <input class="esquive" type="hidden" name="attr_warmasterImpEsquiveC" value="" />
            <input class="force" type="hidden" name="attr_warmasterImpForceC" value="" />
            <input class="guerre" type="hidden" name="attr_warmasterImpGuerreC" value="" />
            <input class="energie" type="hidden" name="attr_warmasterImpEnergieC" value="" />
            <input class="PG200" type="hidden" name="attr_warmaster200PG" value="" />
            
            <h1 class="fichePJ titre" data-i18n="warlord">Warlord</h1>
            <h2 class="fichePJ titreBis" data-i18n="warlord-choix-impulsion">Choix des Impulsions</h2>
            <div class="button">
                <button class="action" type="action" name="act_warmasterImpActionC" data-i18n="warlord-action">Action</button>
                <button class="esquive" type="action" name="act_warmasterImpEsquiveC" data-i18n="warlord-esquive">Esquive</button>
                <button class="force" type="action" name="act_warmasterImpForceC" data-i18n="warlord-force">Force</button>
                <button class="guerre" type="action" name="act_warmasterImpGuerreC" data-i18n="warlord-guerre">Force</button>
                <button class="energie" type="action" name="act_warmasterImpEnergieC" data-i18n="warlord-energie">Energie</button>
            </div>
            <div class="action titre">
                <input class="personnel" type="hidden" name="attr_warmasterImpAPersonnel" />
                <input class="active" type="hidden" name="attr_warmasterImpAction" />

                <button class="personnel" type="action" name="act_warmasterImpAPersonnel" data-i18n="personnel">Personnel</button>

                <h1 class="titre" data-i18n="warlord-impulsion-d'action">Impulsion d'Action</h1>

                <button class="active" type="action" name="act_warmasterImpAction" data-i18n="activer">Activer</button>
            </div>
            
            <div class="esquive titre">
                <input class="active" type="hidden" name="attr_warmasterImpEsquive" />

                <label class="fakeButton">
                    <input type="checkbox" name="attr_warmasterImpEPersonnel" value="2" />
                    <span data-i18n-title="personnel" title="Personnel"></span>
                </label>

                <h1 class="titre" data-i18n="warlord-impulsion-d'esquive">Impulsion d'Esquive</h1>

                <button class="active" type="action" name="act_warmasterImpEsquive" data-i18n="activer">Activer</button>
            </div>
            <label class="esquive col2">
                <span data-i18n="defense">Défense</span>
                <input type="number" name="attr_defenseTotal" value="0" readonly />
            </label>
            <label class="esquive col2BL">
                <span data-i18n="reaction">Réaction</span>
                <input type="number" name="attr_reactionTotal" value="0" readonly />
            </label>
            
            <div class="force titre">
                <input class="active" type="hidden" name="attr_warmasterImpForce" />
                
                <label class="fakeButton">
                    <input type="checkbox" name="attr_warmasterImpFPersonnel" value="2" />
                    <span data-i18n-title="personnel" title="Personnel"></span>
                </label>

                <h1 class="titre" data-i18n="warlord-impulsion-de-force">Impulsion de Force</h1>

                <button class="active" type="action" name="act_warmasterImpForce" data-i18n="activer">Activer</button>
            </div>
            <label class="force ligne2">
                <span data-i18n="champ-de-force">Champ de Force</span>
                <input type="number" name="attr_cdfPJ_max" value="8" readonly />
            </label>

            <div class="guerre titre">
                <input class="active" type="hidden" name="attr_warmasterImpGuerre" />

                <label class="fakeButton">
                    <input type="checkbox" name="attr_warmasterImpGPersonnel" value="{{ImpulsionGuerreD=[[1D6]]}} {{ImpulsionGuerreV=[[1D6]]}}" />
                    <span data-i18n-title="personnel" title="Personnel"></span>
                </label>

                <h1 class="titre" data-i18n="warlord-impulsion-de-guerre">Impulsion de Guerre</h1>

                <button class="active" type="action" name="act_warmasterImpGuerre" data-i18n="activer">Activer</button>
            </div>
            <label class="guerre col2">
                <span data-i18n="degats">Dégâts</span>
                <input type="text" name="attr_warmImpGDegats" value="1D6" readonly />
            </label>
            <label class=" guerre col2BL">
                <span data-i18n="violence">Violence</span>
                <input type="text" name="attr_warmImpGViolence" value="1D6" readonly />
            </label>
           
            <div class="energie titre">
                <input class="active" type="hidden" name="attr_warmasterImpEnergie" />

                <h1 class="titre" data-i18n="warlord-impulsion-d'energie">Impulsion d'Energie</h1>

                <button class="active" type="action" name="act_warmasterImpEnergie" data-i18n="activer">Activer</button>
            </div>
        </div>

        <div class="fichePJ warrior warriorTypes">
            <input type="hidden" name="attr_warriorSoldierBonus" value="1+@{warrior250PG}"/>
            <input type="hidden" name="attr_warriorHunterBonus" value="1+@{warrior250PG}" />
            <input type="hidden" name="attr_warriorScholarBonus" value="1+@{warrior250PG}" />
            <input type="hidden" name="attr_warriorHeraldBonus" value="1+@{warrior250PG}" />
            <input type="hidden" name="attr_warriorScoutBonus" value="1+@{warrior250PG}" />

            <input class="soldier" type="hidden" name="attr_warriorSoldier" value="" />
            <input class="hunter" type="hidden" name="attr_warriorHunter" value="" />
            <input class="scholar" type="hidden" name="attr_warriorScholar" value="" />
            <input class="herald" type="hidden" name="attr_warriorHerald" value="" />
            <input class="scout" type="hidden" name="attr_warriorScout" value="" />
            <input class="PG200" type="hidden" name="attr_warrior200PG" value="" />
        
            <h1 class="titre" data-i18n="warrior-types">Les «Types»</h1>
            <h2 class="titreBis" data-i18n="warrior-selection-types">Sélection des Types</h2>
            <div class="button">
                <button class="soldier" type="action" name="act_warriorSoldier" data-i18n="warrior-bouton-type-soldier">Soldier</button>
                <button class="hunter" type="action" name="act_warriorHunter" data-i18n="warrior-bouton-type-hunter">Hunter</button>
                <button class="scholar" type="action" name="act_warriorScholar" data-i18n="warrior-bouton-type-scholar">Scholar</button>
                <button class="herald" type="action" name="act_warriorHerald" data-i18n="warrior-bouton-type-herald">Herald</button>
                <button class="scout" type="action" name="act_warriorScout" data-i18n="warrior-bouton-type-scout">Scout</button>
            </div>
            
            <div class="soldier titre">
                <h1 class="titre" data-i18n="warrior-type-soldier">Soldier</h1>
                <label class="fakeButton">
                    <input type="checkbox" name="attr_warriorSoldierA" value="@{warriorSoldierBonus}" />
                    <span data-i18n-title="active" title="Activé"></span>
                </label>
            </div>
            <label class="soldier col3">
                <span data-i18n="deplacement">Déplacement</span>
                <input type="number" name="attr_warriorSoldierBD" value="@{warriorSoldierBonus}" disabled />
            </label>
            <label class="soldier col3BL">
                <span data-i18n="force">Force</span>
                <input type="number" name="attr_warriorSoldierBF" value="@{warriorSoldierBonus}" disabled />
            </label>
            <label class="soldier col3BL">
                <span data-i18n="endurance">Endurance</span>
                <input type="number" name="attr_warriorSoldierBE" value="@{warriorSoldierBonus}" disabled />
            </label>

            <div class="hunter titre">
                <h1 class="titre" data-i18n="warrior-type-hunter">Hunter</h1>
                <label class="fakeButton">
                    <input type="checkbox" name="attr_warriorHunterA" value="@{warriorHunterBonus}" />
                    <span data-i18n-title="active" title="Activé"></span>
                </label>
            </div>
            <label class="hunter col3">
                <span data-i18n="hargne">Hargne</span>
                <input type="number" name="attr_warriorHunterBH" value="@{warriorHunterBonus}" disabled />
            </label>
            <label class="hunter col3BL">
                <span data-i18n="combat">Combat</span>
                <input type="number" name="attr_warriorHunterBC" value="@{warriorHunterBonus}" disabled />
            </label>
            <label class="hunter col3BL">
                <span data-i18n="instinct">Instinct</span>
                <input type="number" name="attr_warriorHunterBI" value="@{warriorHunterBonus}" disabled />
            </label>

            <div class="scholar titre">
                <h1 class="titre" data-i18n="warrior-type-scholar">Scholar</h1>
                <label class="fakeButton">
                    <input type="checkbox" name="attr_warriorScholarA" value="@{warriorScholarBonus}" />
                    <span data-i18n-title="active" title="Activé"></span>
                </label>
            </div>
            <label class="scholar col3">
                <span data-i18n="tir">Tir</span>
                <input type="number" name="attr_warriorScholarBT" value="@{warriorScholarBonus}" disabled />
            </label>
            <label class="scholar col3BL">
                <span data-i18n="savoir">Savoir</span>
                <input type="number" name="attr_warriorScholarBS" value="@{warriorScholarBonus}" disabled />
            </label>
            <label class="scholar col3BL">
                <span data-i18n="technique">Technique</span>
                <input type="number" name="attr_warriorScholarBTech" value="@{warriorScholarBonus}" disabled />
            </label>

            <div class="herald titre">
                <h1 class="titre" data-i18n="warrior-type-herald">Herald</h1>
                <label class="fakeButton">
                    <input type="checkbox" name="attr_warriorHeraldA" value="@{warriorHeraldBonus}" />
                    <span  data-i18n-title="active" title="Activé"></span>
                </label>
            </div>
            <label class="herald col3">
                <span data-i18n="aura">Aura</span>
                <input type="number" name="attr_warriorHeraldBA" value="@{warriorHeraldBonus}" disabled />
            </label>
            <label class="herald col3BL">
                <span data-i18n="parole">Parole</span>
                <input type="number" name="attr_warriorHeraldBP" value="@{warriorHeraldBonus}" disabled />
            </label>
            <label class="herald col3BL">
                <span data-i18n="sang-froid">Sang-Froid</span>
                <input type="number" name="attr_warriorHeraldBSF" value="@{warriorHeraldBonus}" disabled />
            </label>

            <div class="scout titre">
                <h1 class="titre" data-i18n="warrior-type-scout">Scout</h1>
                <label class="fakeButton">
                    <input type="checkbox" name="attr_warriorScoutA" value="@{warriorScoutBonus}" />
                    <span data-i18n-title="active" title="Activé"></span>
                </label>
            </div>
            <label class="scout col3">
                <span data-i18n="discretion">Discrétion</span>
                <input type="number" name="attr_warriorScoutBD" value="@{warriorScoutBonus}" disabled />
            </label>
            <label class="scout col3BL">
                <span data-i18n="dexterite">Dextérité</span>
                <input type="number" name="attr_warriorScoutBDext" value="@{warriorScoutBonus}" disabled />
            </label>
            <label class="scout col3BL">
                <span data-i18n="perception">Perception</span>
                <input type="number" name="attr_warriorScoutBP" value="@{warriorScoutBonus}" disabled />
            </label>
        </div>

        <div class="fichePJ wizard wizardBorealis">
            <input class="active" type="hidden" name="attr_wizardBorealis" />
            <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0" />

            <div class="titre">
                <button type="action" class="bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                <button type="action" class="bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>

                <h1 class="titre" data-i18n="mode-borealis">Mode Boréalis</h1>

                <button type="action" class="active" name="act_wizardBorealis" data-i18n="activer">Activer</button>
           </div>
           <div class="titreBis">
               <h2 class="titreBis" data-i18n="attaque">Attaque</h2>

               <button class="rollDice" type="action" name="act_distanceWizardBorealis" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=^{mode-borealis}}}"></button>
           </div>
            <label class="ligne2">
                <span data-i18n="type-attaque">Type d'attaque</span>
                <select name="attr_wizardBTypeAttaque">
                    <option value="distance" data-i18n="a-distance" selected>A distance</option>
                    <option value="contact" data-i18n="au-contact">Au contact</option>
                </select>
            </label>
            <label class="ligne2 borderTop">
                <span data-i18n="bonus/malus-jets">Bonus/Malus aux Jets</span>
                <input type="number" name="attr_jetModifDes" value="0" />
            </label>
            <div class="rollPJ">
                <select name="attr_caracteristique1">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
                <select name="attr_caracteristique2">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
            </div>

            <div class="bonusCarac">
                <select name="attr_caracteristique3">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
                <select name="attr_caracteristique4">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
            </div>

            <label class="col3">
                <span data-i18n="degats">Dégâts</span>
                <input type="text" name="attr_wizardBDmg" value="4D6" readonly />
            </label>
            <label class="col3BL">
                <span data-i18n="violence">Violence</span>
                <input type="text" name="attr_wizardBViolence" value="4D6" readonly />
            </label>
            <label class="col3BL">
                <span data-i18n="portee">Portée</span>
                <input type="text" name="attr_wizardBPortee" value="Courte" readonly />
            </label>
            <input type="text" name="attr_wizardBEffets" value="Anti-Anathème / Dègâts Continus 3" readonly />
        </div>
        <div class="fichePJ wizard wizardOriflamme">
            <input class="PG250" type="hidden" name="attr_wizard250PG" value="0" />

            <div class="titre">
                <h1 class="titre" data-i18n="wizard-mode-oriflamme">Mode Oriflamme</h1>
                <button class="rollDice" type="action" name="act_distanceWizardOriflamme" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=^{wizard-mode-oriflamme}}}"></button>
            </div>
            <label class="col3">
                <span data-i18n="degats">Dégâts</span>
                <input type="text" name="attr_wizardODmg" value="6D6+6" readonly />
            </label>
            <label class="col3BL">
                <span data-i18n="violence">Violence</span>
                <input type="text" name="attr_wizardOViolence" value="6D6+12" readonly />
            </label>
            <label class="col3BL">
                <span data-i18n="portee">Portée</span>
                <input type="text" name="attr_wizardOPortee" value="Courte" readonly />
            </label>
            <div class="autoex autoex22">
                <textarea name="attr_wizardOEffets" readonly>Anti-Anathème / Lumière 2 / Affecte uniquement les créatures de l'Anathème</textarea>
                <span name="attr_wizardOEffets">Anti-Anathème / Lumière 2 / Affecte uniquement les créatures de l'Anathème</textarea>
            </div>
        </div>
        <div class="fichePJ wizard styleCombat">					
            <h1 class="titre" data-i18n="style-de-combat">Style de Combat</h1>
            <select name="attr_styleCombat">
                <option value="standard" data-i18n="standard" selected>Standard</option>
                <option value="couvert" data-i18n="couvert">À Couvert</option>
                <option value="agressif" data-i18n="agressif">Agressif</option>
                <option value="akimbo" data-i18n="akimbo">Akimbo</option>
                <option value="ambidextre" data-i18n="ambidextre">Ambidextre</option>
                <option value="defensif" data-i18n="defensif">Défensif</option>
                <option value="precis" data-i18n="precis">Précis</option>
                <option value="puissant" data-i18n="puissant">Puissant</option>
                <option value="suppression" data-i18n="suppression">Suppression</option>
            </select>
            <input type="hidden" name="attr_styleCombat" value="standard" />
            <div class="puissant">
                <span data-i18n="bonus-en">Bonus en</span>
                <select name="attr_stylePuissantType">
                    <option value="{{stylePuissantD=[[@{stylePuissantBonus}D6]]}}" data-i18n="degats" selected>Dégâts</option>
                    <option value="{{stylePuissantV=[[@{stylePuissantBonus}D6]]}}" data-i18n="violence">Violence</option>
                </select>
                <input type="number" name="attr_stylePuissantBonus" value="0" min="0" max="6" />
            </div>
            <div class="suppression">
                <label>
                    <span>Malus aux dégâts</span>
                    <input type="number" name="attr_styleSuppressionD" value="0" min="0" max="6" />
                </label>

                <label>
                    <span>Malus à la violence</span>
                    <input type="number" name="attr_styleSuppressionV" value="0" min="0" max="4" />
                </label>
            </div>
            <div class="autoex autoex40">
                <span name="attr_styleCombatDescr"></span>
                <textarea name="attr_styleCombatDescr" readonly></textarea>
            </div>
        </div>
        <div class="fichePJ wizard herauts">
            <h1 class="titre">Chevalier de la lumière / Hérauts de l'équilibre</h1>
            <div>
                <input type="hidden" name="attr_devasterAnatheme" class="devasterAnatheme" value="0" />
                <input type="hidden" name="attr_bourreauTenebres" class="bourreauTenebres" value="0" />
                <input type="hidden" name="attr_equilibreBalance" class="equilibreBalance" value="0" />

                <button type="action" name="act_devasterAnatheme" class="devasterAnatheme" >Dévaster l'Anathème actif</button>
                <button type="action" name="act_bourreauTenebres" class="bourreauTenebres" >Bourreau des ténèbres actif</button>
                <button type="action" name="act_equilibreBalance" class="equilibreBalance" >Équilibrer la balance actif</button>
            </div>
        </div>

        <div class="MAL">
            <h1 class="titre" data-i18n="meta-armure-legende">Méta-armure de légende</h1>
            
            <div class="MALBarbarian barbarianGoliath">
                <h1 class="titre" data-i18n="barbarian-mode-goliath">Mode Goliath</h1>
                <label class="ligne">
                    <span data-i18n="taille-bonus">Taille Bonus</span>
                    <input type="number" name="attr_MALBarbarianGoliath" min="0" max="4" value="0" />
                </label>

                <h1 class="titre" data-i18n="bonus">Bonus</h1>
                <label class="col">
                    <span data-i18n="force">Force</span>
                    <input type="text" name="attr_MALBarbarianGoliath" readonly />
                </label>
                <label class="col">
                    <span data-i18n="endurance">Endurance</span>
                    <input type="text" name="attr_MALBarbarianGoliath" readonly />
                </label>
                <label class="col borderTop">
                    <span data-i18n="degats-violence-contact">Dégâts (contact)</span>
                    <input type="text" name="attr_MALBarbarianDegat" readonly />
                </label>
                <label class="col borderTop">
                    <span data-i18n="champ-de-force">Champs de Force</span>
                    <input type="text" name="attr_MALBarbarianGoliath" readonly />
                </label>

                <h1 class="titre" data-i18n="malus">Malus</h1>
                <label class="col">
                    <span data-i18n="defense">Défense</span>
                    <input type="text" name="attr_MALBarbarianDef" readonly />
                </label>
                <label class="col">
                    <span data-i18n="reaction">Réaction</span>
                    <input type="text" name="attr_MALBarbarianRea" readonly />
                </label>
            </div>
            
            <div class="MALBard bardChangeling">
                <input class="active" type="hidden" name="attr_MALBardChangeling" value=""/>
                <div class="titre firstTitre">               
                    <h1 class="titre" data-i18n="mode-changeling">Mode Changeling</h1>
                    <button class="active" type="action" name="act_MALBardChangeling" data-i18n="activer">Activer</button>
                </div>
                <h1 class="titre" data-i18n="bard-apparence">Apparence</h1>
                <div class="autoex autoex28">
                    <span name="attr_MALApparenceBard"></span>
                    <textarea name="attr_MALApparenceBard"></textarea>
                </div>
                
                <h1 class="titre" data-i18n="bard-faux-êtres">Faux-Êtres</h1>
                <div class="autoex autoex28">
                    <span name="attr_MALFauxEtresBard"></span>
                    <textarea name="attr_MALFauxEtresBard"></textarea>
                </div>
            </div>

            <div class="MALDruid effetsArmes">
                <h1 class="titre" data-i18n="effet-des-armes">Effet des armes</h1>
                <select name="attr_effetArmes">
                    <option value="" selected></option>
                    <option value="anti-anatheme-description" data-i18n="anti-anatheme">Anti-Anathème</option>
                    <option value="anti-vehicule-description" data-i18n="anti-vehicule">Anti-Véhicule</option>
                    <option value="artillerie-description" data-i18n="artillerie">Artillerie</option>
                    <option value="assassin-description" data-i18n="assassin-x">Assassin X</option>
                    <option value="assistance-attaque-description" data-i18n="assistance-attaque">Assistance à l'attaque</option>
                    <option value="barrage-description" data-i18n="barrage-x">Barrage X</option>
                    <option value="cadence-description" data-i18n="cadence-x">Cadence X</option>
                    <option value="chargeur-description" data-i18n="chargeur">Chargeur X</option>
                    <option value="choc-description" data-i18n="choc">Choc X</option>
                    <option value="defense-reaction-description" data-i18n="defense-reaction">Défense X / Réaction X</option>
                    <option value="degats-continus-description" data-i18n="degats-continus-x">Dégâts Continus X</option>
                    <option value="demoralisant-description" data-i18n="demoralisant">Démoralisant</option>
                    <option value="designation-description" data-i18n="designation">Désignation</option>
                    <option value="destructeur-description" data-i18n="destructeur">Destructeur</option>
                    <option value="deux-mains-description" data-i18n="deux-mains">Deux Mains</option>
                    <option value="dispersion-description" data-i18n="dispersion-x">Dispersion X</option>
                    <option value="en-chaine-description" data-i18n="en-chaine">En Chaîne</option>
                    <option value="esperance-description" data-i18n="esperance">Espérance</option>
                    <option value="fureur-description" data-i18n="fureur">Fureur</option>
                    <option value="ignore-armure-description" data-i18n="ignore-armure">Ignore Armure</option>
                    <option value="ignore-champ-de-force-description" data-i18n="ignore-champ-de-force">Ignore Champ de Force</option>
                    <option value="jumele-akimbo-description" data-i18n="jumele-akimbo">Jumelé (Akimbo)</option>
                    <option value="jumele-ambidextrie-description" data-i18n="jumele-ambidextrie">Jumelé (Ambidextrie)</option>
                    <option value="leste-description" data-i18n="leste">Lesté</option>
                    <option value="lourd-description" data-i18n="lourd">Lourd</option>
                    <option value="lumiere-description" data-i18n="lumiere-x">Lumière X</option>
                    <option value="meurtrier-description" data-i18n="meurtrier">Meurtrier</option>
                    <option value="obliteration-description" data-i18n="obliteration">Oblitération</option>
                    <option value="orfevrerie-description" data-i18n="orfevrerie">Orfèvrerie</option>
                    <option value="parasitage-description" data-i18n="parasitage-x">Parasitage X</option>
                    <option value="penetrant-description" data-i18n="penetrant-x">Pénétrant X</option>
                    <option value="perce-armure-description" data-i18n="perce-armure-x">Perce Armure X</option>
                    <option value="precision-description" data-i18n="precision">Précision</option>
                    <option value="silencieux-description" data-i18n="silencieux">Silencieux</option>
                    <option value="soumission-description" data-i18n="soumission">Soumission</option>
                    <option value="tenebricide-description" data-i18n="tenebricide">Ténébricide</option>
                    <option value="tir-rafale-description" data-i18n="tir-rafale">Tir en rafale</option>
                    <option value="tir-securite-description" data-i18n="tir-securite">Tir en sécurité</option>
                    <option value="ultraviolence-description" data-i18n="ultraviolence">Ultraviolence</option>
                </select>
                <span name="attr_effetArmes-description"></span>
            </div>
            <div class="MALDruid effetsArmes">
                <h1 class="titre" data-i18n="amelioration-structurelle-des-armes">Amélioration (structurelle) des armes</h1>
                <select name="attr_ameliorationArmes">
                    <option value="" selected></option>
                    <option value="agressive-description" data-i18n="agressive">Agressive</option>
                    <option value="assassine-description" data-i18n="assassine">Assassine</option>
                    <option value="allegee-description" data-i18n="allegee">Allégée</option>
                    <option value="meutrier-description" data-i18n="meutrier">Barbelée</option>
                    <option value="canon-raccourci-description" data-i18n="canon-raccourci">Canon raccourci</option>
                    <option value="chambre-double-description" data-i18n="chambre-double">Chambre double</option>
                    <option value="chargeur-balles-grappes-description" data-i18n="chargeur-balles-grappes">Chargeur et balles grappes</option>
                    <option value="chargeur-munitions-explosives-description" data-i18n="chargeur-munitions-explosives">Chargeur et munitions explosives</option>
                    <option value="connectee-description" data-i18n="connectee">Connectée</option>
                    <option value="electrifiee-description" data-i18n="electrifiee">Électrifiée</option>
                    <option value="grenades-intelligentes-avancees-description" data-i18n="grenades-intelligentes-avancees">Grenades intelligentes avancées</option>
                    <option value="indestructible-description" data-i18n="indestructible">Indestructible</option>
                    <option value="interface-guidage-description" data-i18n="interface-guidage">Interface de guidage</option>
                    <option value="jumelage-description" data-i18n="jumelage">Jumelage</option>
                    <option value="jumelle-description" data-i18n="jumelle">Jumelle</option>
                    <option value="lumineuse-description" data-i18n="lumineuse">Lumineuse</option>
                    <option value="lunette-intelligente-description" data-i18n="lunette-intelligente">Lunette intelligente</option>
                    <option value="munitions-hyper-velocite-description" data-i18n="munitions-hyper-velocite">Munitions à Hyper Vélocité</option>
                    <option value="massive-description" data-i18n="massive">Massive</option>
                    <option value="munitions-drones-description" data-i18n="munitions-drones">Munitions drones</option>
                    <option value="munitions-iem-description" data-i18n="munitions-iem">Munitions IEM</option>
                    <option value="munitions-non-letales-description" data-i18n="munitions-non-letales">Munitions non létales</option>
                    <option value="munitions-subsoniques-description" data-i18n="munitions-subsoniques">Munitions subsoniques</option>
                    <option value="pointeur-laser-description" data-i18n="pointeur-laser">Pointeur laser</option>
                    <option value="protection-d'arme-description" data-i18n="protection-d'arme">Protection d'arme</option>
                    <option value="protectrice-description" data-i18n="protectrice">Protectrice</option>
                    <option value="revetement-omega-description" data-i18n="revetement-omega">Revêtement Omega</option>
                    <option value="sournoise-description" data-i18n="sournoise">Sournoise</option>
                    <option value="structure-element-alpha-description" data-i18n="structure-element-alpha">Structure en Element Alpha</option>
                    <option value="sur-mesure-description" data-i18n="sur-mesure">Sur Mesure</option>
                    <option value="systeme-refroidissement-description" data-i18n="systeme-refroidissement">Système de refroidissement</option>
                </select>
                <span name="attr_ameliorationArmes-description"></span>
            </div>
            <div class="MALDruid herauts">
                <h1 class="titre">Chevalier de la lumière / Hérauts de l'équilibre</h1>
                <div>
                    <input type="hidden" name="attr_devasterAnatheme" class="devasterAnatheme" value="0" />
                    <input type="hidden" name="attr_bourreauTenebres" class="bourreauTenebres" value="0" />
                    <input type="hidden" name="attr_equilibreBalance" class="equilibreBalance" value="0" />
    
                    <button type="action" name="act_devasterAnatheme" class="devasterAnatheme" >Dévaster l'Anathème actif</button>
                    <button type="action" name="act_bourreauTenebres" class="bourreauTenebres" >Bourreau des ténèbres actif</button>
                    <button type="action" name="act_equilibreBalance" class="equilibreBalance" >Équilibrer la balance actif</button>
                </div>
            </div>
            <div class="MALDruid information">
                <h1 class="titre" data-i18n="panneau-d'information">Panneau d'Information</h1>
                <div class="autoex autoex28">	
                    <span name="attr_panneauInformation"></span>
                    <textarea name="attr_panneauInformation" readonly ></textarea>
                </div>
            </div>
            <div class="MALDruid druidModJetCompagnons">
                <h1 class="titre" data-i18n="bonus/malus-aux-jets-des-compagnons">Bonus/Malus aux Jets des Compagnons</h1>
                <input type="number" name="attr_MALJetModifDesComp" value="0" />
            </div>
            <div class="MALDruid MALDCompagnon druidModCompanions">
                <input class="legendeChoisie" type="hidden" name="attr_maldruidmod" value="0" />
                <input class="choix" type="hidden" name="attr_MALChoixCompanons" value="aucun" />

                <div class="titre">
                    <h1 class="titre" data-i18n="druid-mod-companions">Mod Companions</h1>
                    <select class="liste" name="attr_MALDruidEnergieCompanon">
                        <option value="10" data-i18n="10-PE" selected>10 PE</option>
                        <option value="20" data-i18n="20-PE">20 PE</option>
                        <option value="30" data-i18n="30-PE">30 PE</option>
                        <option value="40" data-i18n="40-PE">40 PE</option>
                        <option value="50" data-i18n="50-PE">50 PE</option>
                    </select>
                </div>
                <div class="button">
                    <button class="aucun" type="action" name="act_MALChoixCompanons_aucun" data-i18n="aucun" >Aucun</button>
                    <button class="lion" type="action" name="act_MALChoixCompanons_lion" data-i18n="druid-companion-lion">Lion</button>
                    <button class="wolf" type="action" name="act_MALChoixCompanons_wolf" data-i18n="druid-companion-wolf">Wolf</button>
                    <button class="crow" type="action" name="act_MALChoixCompanons_crow" data-i18n="druid-companion-crow">Crow</button>
                </div>
            </div>
            
            <div class="MALPaladin paladinShrine">
                <input class="active" type="hidden" name="attr_MALPaladinCdFShrine" />

                <div class="titre">
                    <h1 class="titre" data-i18n="paladin-champ-de-force-shrine">Champ de Force Shrine</h1>

                    <button class="active" type="action" name="act_MALPaladinCdFShrine" data-i18n="activer">Activer</button>
                </div>
                <label class="col3">
                    <span data-i18n="bonus-cdf">Bonus de CdF</span>
                    <input type="number" name="attr_MALPaladinCdFShrineValue" value="6" disabled />
                </label>
                <label class="col3BL">
                    <span data-i18n="force-requise">Force Requise</span>
                    <input type="number" name="attr_MALPaladinCdFShrineForceValue" value="5" disabled />
                </label>
                <label class="col3BL">
                    <span data-i18n="chair-requise">Chair Requise</span>
                    <input type="number" name="attr_MALPaladinCdFShrineChairValue" value="10" disabled />
                </label>
            </div>
            
            <div class="MALPriest">
                <input class="legendeChoisie" type="hidden" name="attr_malpriestmode" value="0" />
                
                <div class="priestMechanic">
                    <h1 class="titre" data-i18n="priest-mode-mechanic">Mode Mechanic</h1>
                    <div>
                        <span data-i18n="portee-contact">Contact</span>
                        <input type="text" name="attr_MALPriestMechanicContact" value="4D6+12" readonly />
                        <button class="rollDice" type="action" name="act_rollMALPriestJetMechanicContact" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{priest-mode-mechanic-contact}}} {{jDivers=^{reparation}}} {{jDiversV=[[@{MALPriestMechanicContact}]]}}"></button>
                    </div>
                    <div>
                        <span data-i18n="distance-portee-longue">Distance (Portée Longue)</span>
                        <input type="text" name="attr_MALPriestMechanicDistance" value="3D6+12" readonly />
                        <button class="rollDice" type="action" name="act_rollMALPriestJetMechanicDistance" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{priest-mode-mechanic-distance}}} {{jDivers=^{reparation}}} {{jDiversV=[[@{MALPriestMechanicDistance}]]}}"></button>
                    </div>
                </div>
                
                <div class="priestNanoC">
                    <input type="hidden" name="attr_bonusCarac" class="bonusCarac" value="0" />
                    
                    <div class="titre">
                        <button type="action" class="fichePJ bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                        <button type="action" class="fichePJ bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>
                        
                        <h1 class="titre" data-i18n="priest-mode-nanoc">Mode NanoC</h1>
                        <button class="rollDice" type="action" name="act_simpleMALPriest" value="@{jetGM} &{template:simple} {{Nom=@{name}}}"></button>
                    </div>
                    <label class="ligne2">
                        <span>Bonus/Malus aux Jets</span>
                        <input type="number" name="attr_MALJetModifDes" value="0" />
                    </label>
                    <div class="rollPJ">
                        <select name="attr_caracteristique1Priest">
                            <option value="@{technique}" selected>Technique</option>
                        </select>
                        <select name="attr_caracteristique2">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                    </div>
                    <input type="hidden" name="attr_bonusCarac" value="0" />
                    <div class="bonusCarac">
                        <select name="attr_MALCaracteristique3">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <select name="attr_MALCaracteristique4">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                    </div>
                    <h1 class="titre" data-i18n="priest-creations">Créations</h1>
                    <div class="autoex autoex28">
                        <span name="attr_MALPriestNanoc"></span>
                        <textarea name="attr_MALPriestNanoc" class="largeTextarea"></textarea>
                    </div>
                </div>
            </div>
            
            <div class="MALPsion">
                <input class="legendeChoisie" type="hidden" name="attr_malpsionmode" value="0" />
                <input class="legendeChoisie2" type="hidden" name="attr_malpsionmode2" value="0" />

                <div class="psionPuppetMaster">
                    <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0" />

                    <div class="titre">
                        <button type="action" class="fichePJ bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                        <button type="action" class="fichePJ bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>
                        
                        <h1 class="titre" data-i18n="mode-puppet-master">Mode Puppet Master</h1>
                        <button class="rollDice" type="action" name="act_simplePsionPuppet" value="@{jetGM} &{template:simple} {{Nom=@{name}}}"></button>
                    </div>
                    <div class="rollPJ">
                        <select name="attr_caracteristique1Psion">
                            <option value="@{aura}" data-i18n="aura" selected>Aura</option>
                        </select>
                        <select name="attr_caracteristique2">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                    </div>
                    <div class="bonusCarac">
                        <select name="attr_caracteristique3">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <select name="attr_caracteristique4">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                    </div>
                    <h1 class="titre" data-i18n="ordre-donne">Ordre Donné</h1>
                    <div class="autoex autoex28">
                        <span name="attr_psionPuppetOrdre"></span>
                        <textarea name="attr_psionPuppetOrdre"></textarea>
                    </div>
                </div>
                <div class="psionDiscord">
                    <input class="active" type="hidden" name="attr_MALPsionDiscord" />
                    <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0" />

                    <div class="titre">
                        <button type="action" class="fichePJ bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                        <button type="action" class="fichePJ bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>

                        <h1 class="titre" data-i18n="psion-mode-discord">Mode Discord</h1>

                        <button class="active" type="action" name="act_MALPsionDiscord" data-i18n="activer">Activer</button>
                    </div>
                    <label class="ligne2">
                        <span data-i18n="bonus/malus-jets">Bonus/Malus aux Jets</span>
                        <input type="number" name="attr_jetModifDes" value="0" />
                    </label>
                    <div class="rollPJ">
                        <select name="attr_caracteristique1Psion">
                            <option value="@{aura}" data-i18n="aura" selected>Aura</option>
                        </select>
                        <select name="attr_caracteristique2">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <button class="rollDice" type="action" name="act_simplePsionDiscord" value="@{jetGM} &{template:simple} {{Nom=@{name}}}"></button>
                    </div>

                    <div class="bonusCarac">
                        <select name="attr_caracteristique3">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <select name="attr_caracteristique4">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                    </div>
                    <label class="col3">
                        <span data-i18n="malus-action">Malus Actions</span>
                        <input type="text" name="attr_psionMalusA" value="2D" readonly />
                    </label>
                    <label class="col3BL">
                        <span data-i18n="malus-reaction">Malus Réaction</span>
                        <input type="text" name="attr_psionMalus" value="2" readonly />
                    </label>
                    <label class="col3BL">
                        <span data-i18n="malus-defense">Malus Défense</span>
                        <input type="text" name="attr_psionMalus" value="2" readonly />
                    </label>
                </div>
                <div class="psionWindtalker">
                    <h1 class="titre" data-i18n="psion-mode-windtalker">Mode Windtalker</h1>
                    <h2 class="titreBis" data-i18n="actions-creatures">Actions des Créatures</h2>
                    <div class="autoex autoex28">
                        <span name="attr_psionWindtalkerActions"></span>
                        <textarea name="attr_psionWindtalkerActions"></textarea>
                    </div>
                </div>
            </div>
            
            <div class="MALRanger rangerVision">
                <input type="hidden" name="attr_bonusCarac" class="bonusCarac" value="0" />

                <div class="titre">
                    <button type="action" class="fichePJ bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                    <button type="action" class="fichePJ bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>

                    <h1 class="titre" data-i18n="ranger-vision">Vision</h1>
                    <button class="rollDice" type="action" name="act_simpleRangerVision" value="@{jetGM} &{template:simple} {{Nom=@{name}}}"></button>
                </div>
                <div class="rollPJ">
                    <select name="attr_caracteristique1Ranger">
                        <option value="@{perception}"  data-i18n="perception" selected>Perception</option>
                    </select>
                    <select name="attr_caracteristique2">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                </div>
                <div class="bonusCarac">
                    <select name="attr_caracteristique3">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                    <select name="attr_caracteristique4">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                </div>
            </div>
            
            <div class="MALRogue rogueGhost">
                <input type="hidden" name="attr_bonusCarac" class="bonusCarac" value="0" />
                <input class="active" type="hidden" name="attr_MALRogueGhost" value=""/>

                <div class="titre">
                    <button type="action" class="fichePJ bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                    <button type="action" class="fichePJ bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>
                    
                    <h1 class="titre" data-i18n="mode-ghost">Mode Ghost</h1>

                    <button class="active" type="action" name="act_MALRogueGhost" data-i18n="activer">Activer</button>
                </div>
                <label class="ligne2">
                    <span data-i18n="bonus/malus-jets">Bonus/Malus aux Jets</span>
                    <input type="number" name="attr_jetModifDes" value="0" />
                </label>
                <div class="rollPJ">
                    <select name="attr_caracteristique1">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                    <select name="attr_caracteristique2">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                    <button class="rollDice" type="action" name="act_simpleRogue" value="@{jetGM} &{template:simple} {{Nom=@{name}}}"></button>
                </div>
                <div class="bonusCarac">
                    <select name="attr_caracteristique3">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                    <select name="attr_caracteristique4">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                </div>
            </div>
            
            <div class="MALShaman">
                <div class="shamanImpregnation">
                    <input type="hidden" name="attr_bonusCarac" class="bonusCarac" value="0" />

                    <div class="titre">
                        <button type="action" class="fichePJ bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                        <button type="action" class="fichePJ bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>

                        <h1 class="titre" data-i18n="shaman-impregnation">Imprégnation</h1>
                        <button class="rollDice" type="action" name="act_simpleMALShamanImpregnation" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{shaman-impregnation} (@{MALShamanImpregnation})}}"></button>
                    </div>
                    <label class="ligne2">
                        <span data-i18n="total-actuel">Total actuel</span>
                        <input type="number" name="attr_MALShamanImpregnation" value="0" min="0" />
                    </label>
                    <div class="rollPJ">
                        <select name="attr_caracteristique1MALShamanImpregnation">
                            <option value="0" selected></option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        </select>
                        <select name="attr_caracteristique2MALShamanImpregnation">
                            <option value="0" selected></option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                        </select>
                    </div>
                    <div class="bonusCarac">
                        <select name="attr_caracteristique3">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <select name="attr_caracteristique4">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                    </div>
                </div>
                <div class="shamanTotem">
                    <input class="nbreTotem" type="hidden" name="attr_MALShamanNbreTotem" value="0" />

                    <h1 class="titre" data-i18n="shaman-mode-totem">Mode Totem</h1>
                    <label class="ligne2">
                        <span data-i18n="shaman-nombre-totem">Nombre de totems</span>
                        <input type="number" name="attr_MALShamanNbreTotem" value="0" min="0" max="2" />
                    </label>
                    <input type="hidden" name="attr_MALShamanNbreTotem" value="0" />
                    <label class="ligne2 totem1">
                        <span data-i18n="shaman-caracteristique-totem-1">Caractéristique du Totem 1</span>
                        <select name="attr_MALCaracteristiqueTotem1">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                    </label>
                    <label class="ligne2 totem2">
                        <span data-i18n="shaman-caracteristique-totem-2">Caractéristique du Totem 2</span>
                        <select name="attr_MALCaracteristiqueTotem2">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                    </label>
                </div>
                <div class="jet">
                    <input type="hidden" name="attr_bonusCarac" class="bonusCarac" value="0" />

                    <div class="titre">
                        <button type="action" class="fichePJ bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                        <button type="action" class="fichePJ bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>

                        <h1 class="titre" data-i18n="jet">Jet</h1>
                        <button class="rollDice" type="action" name="act_simple" value="@{jetGM} &{template:simple} {{Nom=@{name}}}"></button>
                    </div>
                    <label class="ligne2">
                        <span data-i18n="bonus/malus-jets">Bonus/Malus aux Jets</span>
                        <input type="number" name="attr_jetModifDes" value="0" />
                    </label>
                    <div class="rollPJ">
                        <select name="attr_caracteristique1">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <select name="attr_caracteristique2">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                    </div>
                    <div class="bonusCarac">
                        <select name="attr_caracteristique3">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <select name="attr_caracteristique4">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="MALWarlock">
                <input class="legendeChoisie" type="hidden" name="attr_malwarlockmode" value="0" />

                <div class="warlockContrecoups">
                    <div class="titre">
                        <h1 class="titre" data-i18n="warlock-contrecoups">Contrecoups</h1>

                        <button class="rollDice" type="action" name="act_rollMALWarlockContrecoups" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{warlock-contrecoups}}}"></button>
                    </div>
                </div>
                <div class="warlockRecord">
                    <input class="active" type="hidden" name="attr_MALWarlockRecord" />

                    <div class="titre">
                        <h1 class="titre" data-i18n="warlock-mode-record">Mode Record</h1>

                        <button class="active" type="action" name="act_MALWarlockRecord" data-i18n="activer">Activer</button>
                    </div>
                    <label class="ligne2">
                        <span data-i18n="warlock-mode-record-success">Succès enregistrés</span>
                        <input type="number" name="attr_MALWarlockRecordSuccess" value="0" />
                    </label>
                    <label class="ligne2">
                        <span data-i18n="warlock-mode-record-dmg">Dégâts enregistrés</span>
                        <input type="number" name="attr_MALWarlockRecordDmg" value="0" />
                    </label>
                    <label class="ligne2">
                        <span data-i18n="warlock-mode-record-violence">Violence enregistrée</span>
                        <input type="number" name="attr_MALWarlockRecordViolence" value="0" />
                    </label>
                    <h1 class="titre" data-i18n="notes">Notes</h1>
                    <div class="autoex autoex22">
                        <textarea name="attr_MALWarlockRecordNotes"></textarea>
                        <span name="attr_MALWarlockRecordNotes"></span>
                    </div>
                </div>
                <div class="warlockRewind">
                    <input class="active" type="hidden" name="attr_MALWarlockRewind" />

                    <div class="titre">
                        <h1 class="titre" data-i18n="warlock-mode-rewind">Mode Rewind</h1>

                        <button class="active" type="action" name="act_MALWarlockRewind" data-i18n="activer">Activer</button>
                    </div>
                    <div class="autoex autoex22">
                        <textarea name="attr_MALWarlockRewindNotes"></textarea>
                        <span name="attr_warlockRewindNotes"></span>
                    </div>
                </div>
            </div>
            
            <div class="MALWarmaster">
                <input class="legendeChoisie" type="hidden" name="attr_malwarmastermode" value="0" />
            
                <div class="warmasterWarlord">
                    <input class="warlordChoisie" type="hidden" name="attr_malwarmasterwarlord" value="0" />
                    
                    <div class="action titre">
                        <input class="active" type="hidden" name="attr_MALWarmasterImpAction" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_MALWarmasterImpAPersonnel" value="on" />
                            <span data-i18n-title="personnel" title="Personnel"></span>
                        </label>

                        <h1 class="titre" data-i18n="warlord-impulsion-d'action">Impulsion d'Action</h1>

                        <button class="active" type="action" name="act_MALWarmasterImpAction" data-i18n="activer">Activer</button>
                    </div>
                    
                    <div class="esquive titre">
                        <input class="active" type="hidden" name="attr_MALWarmasterImpEsquive" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_MALWarmasterImpEPersonnel" value="2" />
                            <span data-i18n-title="personnel" title="Personnel"></span>
                        </label>

                        <h1 class="titre" data-i18n="warlord-impulsion-d'esquive">Impulsion d'Esquive</h1>

                        <button class="active" type="action" name="act_MALWarmasterImpEsquive" data-i18n="activer">Activer</button>
                    </div>
                    <label class="esquive col2">
                        <span data-i18n="defense">Défense</span>
                        <input type="number" name="attr_defenseTotal" value="0" readonly />
                    </label>
                    <label class="esquive col2BL">
                        <span data-i18n="reaction">Réaction</span>
                        <input type="number" name="attr_reactionTotal" value="0" readonly />
                    </label>
                                        
                    <div class="force titre">
                        <input class="active" type="hidden" name="attr_MALWarmasterImpForce" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_MALWarmasterImpFPersonnel" value="2" />
                            <span data-i18n-title="personnel" title="Personnel"></span>
                        </label>

                        <h1 class="titre" data-i18n="warlord-impulsion-de-force">Impulsion de Force</h1>

                        <button class="active" type="action" name="act_MALWarmasterImpForce" data-i18n="activer">Activer</button>
                    </div>
                    <label class="force ligne2">
                        <span data-i18n="champ-de-force">Champ de Force</span>
                        <input type="number" name="attr_cdfPJ_max" value="8" readonly />
                    </label>
                    
                    <div class="guerre titre">
                        <input class="active" type="hidden" name="attr_MALWarmasterImpGuerre" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_MALWarmasterImpGPersonnel" value="{{MALImpulsionGuerreD=[[1D6]]}} {{MALImpulsionGuerreV=[[1D6]]}}" />
                            <span data-i18n-title="personnel" title="Personnel"></span>
                        </label>

                        <h1 class="titre" data-i18n="warlord-impulsion-de-guerre">Impulsion de Guerre</h1>

                        <button class="active" type="action" name="act_MALWarmasterImpGuerre" data-i18n="activer">Activer</button>
                    </div>
                    <label class="guerre col2">
                        <span data-i18n="degats">Dégâts</span>
                        <input type="text" name="attr_MALWarmImpGDegats" value="1D6" readonly />
                    </label>
                    <label class="guerre col2BL">
                        <span data-i18n="violence">Violence</span>
                        <input type="text" name="attr_MALWarmImpGViolence" value="1D6" readonly />
                    </label>
                    
                    <div class="energie titre">
                        <input class="active" type="hidden" name="attr_MALWarmasterImpEnergie" />

                        <h1 class="titre" data-i18n="warlord-impulsion-d'energie">Impulsion d'Energie</h1>

                        <button class="active" type="action" name="act_MALWarmasterImpEnergie" data-i18n="activer">Activer</button>
                    </div>
                </div>
                
                <div class="warmasterFalcon">
                    <h1 class="titre" data-i18n="mode-falcon">Mode Falcon</h1>
                    <h2 class="titreBis" data-i18n="mode-falcon-faiblesses-detectees">Faiblesses détectées</h2>
                    <div class="autoex autoex28">
                        <span name="attr_MALWarmasterModeFalcon"></span>
                        <textarea name="attr_MALWarmasterModeFalcon" class="largeTextarea"></textarea>
                    </div>
                </div>
            </div>
            
            <div class="MALWarrior warriorTypes">
                <input type="hidden" name="attr_MALWarriorSoldierBonus" value="1"/>
                <input type="hidden" name="attr_MALWarriorHunterBonus" value="1" />
                <input type="hidden" name="attr_MALWarriorScholarBonus" value="1" />
                <input type="hidden" name="attr_MALWarriorHeraldBonus" value="1" />
                <input type="hidden" name="attr_MALWarriorScoutBonus" value="1" />

                <input class="legendeChoisie" type="hidden" name="attr_malwarriortype" value="0" />
                
                <div class="soldier titre">
                    <h1 class="titre" data-i18n="warrior-type-soldier">Soldier</h1>

                    <label class="fakeButton">
                        <input type="checkbox" name="attr_MALWarriorSoldierA" value="@{MALWarriorSoldierBonus}" />
                        <span data-i18n-title="active" title="Activé"></span>
                    </label>
                </div>
                <label class="soldier col3">
                    <span data-i18n="deplacement">Déplacement</span>
                    <input type="number" name="attr_MALWarriorSoldierBD" value="@{MALWarriorSoldierBonus}" disabled />
                </label>
                <label class="soldier col3BL">
                    <span data-i18n="force">Force</span>
                    <input type="number" name="attr_MALWarriorSoldierBF" value="@{MALWarriorSoldierBonus}" disabled />
                </label>
                <label class="soldier col3BL">
                    <span data-i18n="endurance">Endurance</span>
                    <input type="number" name="attr_MALWarriorSoldierBE" value="@{MALWarriorSoldierBonus}" disabled />
                </label>

                <div class="hunter titre">
                    <h1 class="titre" data-i18n="warrior-type-hunter">Hunter</h1>

                    <label class="fakeButton">
                        <input type="checkbox" name="attr_MALWarriorHunterA" value="@{MALWarriorHunterBonus}" />
                        <span data-i18n-title="active" title="Activé"></span>
                    </label>
                </div>
                <label class="hunter col3">
                    <span data-i18n="hargne">Hargne</span>
                    <input type="number" name="attr_MALWarriorHunterBH" value="@{MALWarriorHunterBonus}" disabled />
                </label>
                <label class="hunter col3BL">
                    <span data-i18n="combat">Combat</span>
                    <input type="number" name="attr_MALWarriorHunterBC" value="@{MALWarriorHunterBonus}" disabled />
                </label>
                <label class="hunter col3BL">
                    <span data-i18n="instinct">Instinct</span>
                    <input type="number" name="attr_MALWarriorHunterBI" value="@{MALWarriorHunterBonus}" disabled />
                </label>

                <div class="scholar titre">
                    <h1 class="titre" data-i18n="warrior-type-scholar">Scholar</h1>

                    <label class="fakeButton">
                        <input type="checkbox" name="attr_MALWarriorScholarA" value="@{MALWarriorScholarBonus}" />
                        <span data-i18n-title="active" title="Activé"></span>
                    </label>
                </div>
                <label class="scholar col3">
                    <span data-i18n="tir">Tir</span>
                    <input type="number" name="attr_MALWarriorScholarBT" value="@{MALWarriorScholarBonus}" disabled />
                </label>
                <label class="scholar col3BL">
                    <span data-i18n="savoir">Savoir</span>
                    <input type="number" name="attr_MALWarriorScholarBS" value="@{MALWarriorScholarBonus}" disabled />
                </label>
                <label class="scholar col3BL">
                    <span data-i18n="technique">Technique</span>
                    <input type="number" name="attr_MALWarriorScholarBTech" value="@{MALWarriorScholarBonus}" disabled />
                </label>

                <div class="herald titre">
                    <h1 class="titre" data-i18n="warrior-type-herald">Herald</h1>

                    <label class="fakeButton">
                        <input type="checkbox" name="attr_MALWarriorHeraldA" value="@{MALWarriorHeraldBonus}" />
                        <span  data-i18n-title="active" title="Activé"></span>
                    </label>
                </div>
                <label class="herald col3">
                    <span data-i18n="aura">Aura</span>
                    <input type="number" name="attr_MALWarriorHeraldBA" value="@{MALWarriorHeraldBonus}" disabled />
                </label>
                <label class="herald col3BL">
                    <span data-i18n="parole">Parole</span>
                    <input type="number" name="attr_MALWarriorHeraldBP" value="@{MALWarriorHeraldBonus}" disabled />
                </label>
                <label class="herald col3BL">
                    <span data-i18n="sang-froid">Sang-Froid</span>
                    <input type="number" name="attr_MALWarriorHeraldBSF" value="@{MALWarriorHeraldBonus}" disabled />
                </label>

                <div class="scout titre">
                    <h1 class="titre" data-i18n="warrior-type-scout">Scout</h1>

                    <label class="fakeButton">
                        <input type="checkbox" name="attr_MALWarriorScoutA" value="@{MALWarriorScoutBonus}" />
                        <span data-i18n-title="active" title="Activé"></span>
                    </label>
                </div>
                <label class="scout col3">
                    <span data-i18n="discretion">Discrétion</span>
                    <input type="number" name="attr_MALWarriorScoutBD" value="@{MALWarriorScoutBonus}" disabled />
                </label>
                <label class="scout col3BL">
                    <span data-i18n="dexterite">Dextérité</span>
                    <input type="number" name="attr_MALWarriorScoutBDext" value="@{MALWarriorScoutBonus}" disabled />
                </label>
                <label class="scout col3BL">
                    <span data-i18n="perception">Perception</span>
                    <input type="number" name="attr_MALWarriorScoutBP" value="@{MALWarriorScoutBonus}" disabled />
                </label>
            </div>
            
            <div class="MALWizard herauts">
                <h1 class="titre">Chevalier de la lumière / Hérauts de l'équilibre</h1>
                <div>
                    <input type="hidden" name="attr_devasterAnatheme" class="devasterAnatheme" value="0" />
                    <input type="hidden" name="attr_bourreauTenebres" class="bourreauTenebres" value="0" />
                    <input type="hidden" name="attr_equilibreBalance" class="equilibreBalance" value="0" />
    
                    <button type="action" name="act_devasterAnatheme" class="devasterAnatheme" >Dévaster l'Anathème actif</button>
                    <button type="action" name="act_bourreauTenebres" class="bourreauTenebres" >Bourreau des ténèbres actif</button>
                    <button type="action" name="act_equilibreBalance" class="equilibreBalance" >Équilibrer la balance actif</button>
                </div>
            </div>
            <div class="MALWizard wizardOriflamme">
                <div class="titre">
                    <h1 class="titre" data-i18n="wizard-mode-oriflamme">Mode Oriflamme</h1>
                    <button class="rollDice" type="action" name="act_distanceMALWizardOriflamme" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=^{wizard-mode-oriflamme}}}"></button>
                </div>
                <label class="col3">
                    <span data-i18n="degats">Dégâts</span>
                    <input type="text" name="attr_MALWizardODmg" value="6D6+6" readonly />
                </label>
                <label class="col3BL">
                    <span data-i18n="violence">Violence</span>
                    <input type="text" name="attr_MALWizardOViolence" value="6D6+12" readonly />
                </label>
                <label class="col3BL">
                    <span data-i18n="portee">Portée</span>
                    <input type="text" name="attr_MALWizardOPortee" value="Moyenne" readonly />
                </label>
                <div class="autoex autoex22">
                    <textarea name="attr_MALWizardOEffets" readonly>Anti-Anathème / Lumière 2 / Affecte uniquement les créatures de l'Anathème</textarea>
                    <span name="attr_MALWizardOEffets">Anti-Anathème / Lumière 2 / Affecte uniquement les créatures de l'Anathème</span>
                </div>
            </div>
        </div>

        <div class="fichePNJ ficheCreature capacitesFanMade">
            <h1 class="titre" data-i18n="capacites-fan-made">Capacités Fan Made</h1>
            <div>
                <label class="fakeButton">
                    <input type="checkbox" name="attr_attaqueOmbre" value="{{AttaqueOmbre=[[@{masque}]]}}" />
                    <span data-i18n-title="capacite-fan-made-Attaque-dans-les-ombres" title="Attaque dans les Ombres"></span>
                </label>
            </div>
        </div>

        <div class="fichePNJ ficheCreature capacitesSpeciales">
            <h1 class="titre" data-i18n="capacites-speciales">Capacités spéciales</h1>
            <div>
                <button class="phase2" type="action" name="act_phase2" data-i18n="capacites-speciales-phase-2">Phase 2</button>
            </div>
        </div>

        <div class="fichePNJ ficheCreature ficheBande capacites">
            <h1 class="titre" data-i18n="capacites">Capacités</h1>
            <fieldset class="repeating_capacites">
                <details>
                    <summary>
                        <input type="text" name="attr_nomCapacite" />
                    </summary>
                    <div class="autoex autoex24">
                        <span name="attr_descCapacite"></span>
                        <textarea name="attr_descCapacite"></textarea>
                    </div>
                </details>                
            </fieldset>
        </div>

        <div class="fichePNJ ficheCreature phase2 capacitePhase2">
            <h1 class="titre" data-i18n="capacites-speciales-phase-2">Phase 2</h1>
            <div class="autoex autoex24">
                <span name="attr_descPhase2"></span>
                <textarea name="attr_descPhase2"></textarea>
            </div>
            <fieldset class="repeating_capacitesPhase2">
                <details>
                    <summary>
                        <input type="text" name="attr_nomCapacitePhase2" />
                    </summary>
                    <div class="autoex autoex24">
                        <span name="attr_descCapacitePhase2"></span>
                        <textarea name="attr_descCapacitePhase2"></textarea>
                    </div>
                </details>                
            </fieldset>
        </div>

        <div class="fichePNJ ficheCreature ficheBande notes">
            <h1 class="titre" data-i18n="notes">Notes</h1>
            <div class="autoex autoex22">
                <span name="attr_pnjCapaciteNotes"></span>
                <textarea name="attr_pnjCapaciteNotes" class="largeTextarea"></textarea>
            </div>
            <fieldset class="repeating_notesJoueur">
                <div class="autoex autoex24">
                    <span name="attr_notesJoueur"></span>
                    <textarea name="attr_notesJoueur" class="largeTextarea"></textarea>
                </div>
            </fieldset>
        </div>
    </div>

    <input class="druidCompanions" type="hidden" name="attr_choixCompanons" value="aucun" />

    <div class="fichePJ druid DCLion">
        <input class="subMenu" type="hidden" name="attr_tabDruidLion" value="0" />

        <h1 class="titre" data-i18n="druid-companion-lion">Lion</h1>
        <div class="col4">
            <h1 class="titre" data-i18n="aspects">Aspects</h1>
            <div class="ligne aspect">
                <span data-i18n="chair">Chair</span>

                <div class="blockR">
                    <input type="number" name="attr_druidLionChairTot" value="@{druidLionChairBase}+@{druidLionChairEvol}" disabled />
                    <button class="rollDice" name="act_druidLionChairRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}}"></button>
                </div>
            </div>

            <div class="ligne aspect">
                <span data-i18n="bete">Bête</span>

                <div class="blockR">
                    <input type="number" name="attr_druidLionBeteTot" value="@{druidLionBeteBase}+@{druidLionBeteEvol}" disabled />
                    <button class="rollDice" name="act_druidLionBeteRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}}"></button>
                </div>
            </div>

            <div class="ligne aspect">
                <span data-i18n="machine">Machine</span>

                <div class="blockR">
                    <input type="number" name="attr_druidLionMachineTot" value="@{druidLionMachineBase}+@{druidLionMachineEvol}" disabled />
                    <button class="rollDice" name="act_druidLionMachineRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}}"></button>
                </div>
            </div>

            <div class="ligne aspect">
                <span data-i18n="dame">Dame</span>

                <div class="blockR">
                    <input type="number" name="attr_druidLionDameTot" value="@{druidLionDameBase}+@{druidLionDameEvol}" disabled />
                    <button class="rollDice" name="act_druidLionDameRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}}"></button>
                </div>
            </div>

            <div class="ligne aspect">
                <span data-i18n="masque">Masque</span>

                <div class="blockR">
                    <input type="number" name="attr_druidLionMasqueTot" value="@{druidLionMasqueBase}+@{druidLionMasqueEvol}" disabled />
                    <button class="rollDice" name="act_druidLionMasqueRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}}"></button>
                </div>
            </div>
        </div>
        
        <div class="col4BL">
            <h1 class="titre" data-i18n="aspects-exceptionnels">Aspects Exceptionnels</h1>
            <div class="ligne AE">
                <input type="hidden" name="attr_druidLionChairAE" value="1"/>
                <span class="mineur" data-i18n="mineur">Mineur</span>
                <span class="majeur" data-i18n="majeur">Majeur</span>
                <span class="value" name="attr_druidLionChairAE">1</span>
            </div>
            <div class="ligne AE">
                <input type="hidden" name="attr_druidLionBeteAE" value="1"/>
                <span class="mineur" data-i18n="mineur">Mineur</span>
                <span class="majeur" data-i18n="majeur">Majeur</span>
                <span class="value" name="attr_druidLionBeteAE">1</span>
            </div>
            <div class="ligne AE">
                <input type="hidden" name="attr_druidLionMachineAE" value="1"/>
                <span class="mineur" data-i18n="mineur">Mineur</span>
                <span class="majeur" data-i18n="majeur">Majeur</span>
                <span class="value" name="attr_druidLionMachineAE" >1</span>
            </div>
            <div class="ligne AE">
                <input type="hidden" name="attr_druidLionDameAE" value="0"/>
                <span class="mineur" data-i18n="mineur">Mineur</span>
                <span class="majeur" data-i18n="majeur">Majeur</span>
                <span class="value" name="attr_druidLionDameAE" >0</span>
            </div>
            <div class="ligne AE">
                <input type="hidden" name="attr_druidLionMasqueAE" value="0"/>
                <span class="mineur" data-i18n="mineur">Mineur</span>
                <span class="majeur" data-i18n="majeur">Majeur</span>
                <span class="value" name="attr_druidLionMasqueAE">0</span>
            </div>
        </div>

        <div class="col4BL">
            <h1 class="titre" data-i18n="valeurs-derivees">Valeurs Dérivées</h1>
            <div class="ligne defense">
                <span data-i18n="defense">Défense</span>

                <div class="blockR">
                    <input type="number" name="attr_druidLionDefenseTot" value="@{druidLionDefenseBase}+@{druidLionDefenseEvol}+@{druidLionMasqueAE}" disabled />
                </div>
            </div>

            <div class="ligne reaction">
                <span data-i18n="reaction">Réaction</span>

                <div class="blockR">
                    <input type="number" name="attr_druidLionReactionTot" value="@{druidLionReactionBase}+@{druidLionReactionEvol}+@{druidLionMachineAE}" disabled />
                </div>
            </div>

            <div class="ligne initiative">
                <span data-i18n="initiative">Initiative</span>

                <div class="blockR">
                    <input type="number" name="attr_druidLionInitiativeTot" value="@{druidLionInitiativeBase}+@{druidLionInitiativeEvol}" disabled />
                    <button class="rollDice" type="action" name="act_druidLionInitiativeRoll" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}}"></button>
                </div>
            </div>

            <div class="ligne armure">
                <span data-i18n="armure">Armure</span>

                <div class="blockR">
                    <input type="number" name="attr_druidLionPAAct" value="60" />
                    <b>/</b>
                    <input type="number" name="attr_druidLionPAAct_max" value="@{druidLionPABase}+@{druidLionPAEvol}" disabled />
                </div>
            </div>

            <div class="ligne energie">
                <span data-i18n="energie">Energie</span>

                <div class="blockR">
                    <input type="number" name="attr_druidLionPEAct" value="0" />
                    <b>/</b>
                    <input type="number" name="attr_druidLionPEAct_max" value="@{druidEnergieCompanon}" disabled />
                </div>
            </div>
        </div>

        <div class="col4BL">
            <h1 class="titre" data-i18n="champ-de-force">Champ de Force</h1>
            <div class="ligne CDF">
                <input type="number" name="attr_druidLionCDFTot" value="@{druidLionCDFBase}+@{druidLionCDFEvol}" disabled />
            </div>
        </div>

        <div class="subMenu">
            <button class="armes" type="action" name="act_tabDruidLion_1" data-i18n="armes">Armes</button>
            <button class="BL modules" type="action" name="act_tabDruidLion_2" data-i18n="modules">Modules</button>
            <button class="BL evolutions" type="action" name="act_tabDruidLion_3" data-i18n="evolutions">Evolutions</button>
        </div>
        
        <div class="armes">
            <div class="ligneTitre">
                <div class="firstCol">
                    <span data-i18n="arme">Arme</span>
                </div>
    
                <div class="midCol">
                    <span data-i18n="degats">Dégâts</span>
                </div>
                <div class="midCol">
                    <span data-i18n="violence">Violence</span>
                </div>
                <div class="midCol">
                    <span data-i18n="portee">Portée</span>
                </div>
    
                <div class="lastCol">
                    <span data-i18n="aspect">Aspect</span>
                </div>
            </div>

            <div class="coups">
                <input class="subMenu" type="hidden" name="attr_tabDCoups" value="0" />

                <div class="ligne">
                    <div class="firstCol aB1Nom">
                        <input type="text" name="attr_druidLionBaseNom" value="Coups" readonly />
                    </div>
    
                    <div class="midCol aB1Degats">
                        <input class="nbre" type="number" name="attr_druidLionBaseDegats" class="right" value="1" disabled />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_druidLionBaseDegatsBonus" class="left" value="0" disabled />
                    </div>
    
                    <div class="midCol aB1Violence">
                        <input class="nbre" type="number" name="attr_druidLionBaseViolence" class="right" value="1" disabled />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_druidLionBaseViolenceBonus" class="left" value="0" disabled />
                    </div>
                    
                    <div class="midCol aB1Portee">
                        <select name="attr_druidLionBasePortee">
                            <option data-i18n="portee-contact" value="^{portee-contact}" selected>Contact</option>
                        </select>
                    </div>
    
                    <div class="lastCol aB1Aspect">
                        <select name="attr_aspectDruidLionBase">
                            <option value="druidLionChair" data-i18n="chair">Chair</option>
                            <option value="druidLionBete" data-i18n="bete">Bete</option>
                            <option value="druidLionMachine" data-i18n="machine">Machine</option>
                            <option value="druidLionDame" data-i18n="dame">Dame</option>
                            <option value="druidLionMasque" data-i18n="masque">Masque</option>
                        </select>							
                        <button class="rollDice" type="action" name="act_druidLionArmeBase" value="@{jetGM} &{template:combat} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}} {{special1B=^{coups}}}"></button>
                    </div>
                </div>
                <div class="subMenu">
                    <button class="special" type="action" name="act_tabDCoups-3" data-i18n="special">Spécial</button>
                </div>
                <div class="special">
                    <div class="triple">
                        <input type="hidden" name="attr_coupBDDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_coupBDDiversTotal" value="{{BDDivers=[[@{bDDiversD6}D6+@{bDDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-degats" title="Bonus aux dégâts"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_bDDiversD6" class="center" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_bDDiversFixe" class="center" value="0" />
                        </div>
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_coupBVDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_coupBVDiversTotal" value="{{BVDivers=[[@{bVDiversD6}D6+@{bVDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-violence" title="Bonus à la violence"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_bVDiversD6" class="center" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_bVDiversFixe" class="center" value="0" />
                        </div>
                    </div>
                </div>
            </div>

            <fieldset class="repeating_armeDruidLion">
                <input class="subMenu" type="hidden" name="attr_tab" value="0" />

                <div class="data">
                    <input type="hidden" name="attr_druidLionDegats" value="{{Degats=[[ [[{[[@{degatDruidLion}+@{chargeurExplosives}-@{chargeurGrappes}-@{munitionsIEM}+@{revetementOmega}]], 0}kh1]]D6+@{degatBonusDruidLion}]]}}" />
                            
                    <input type="hidden" name="attr_druidLionViolence" value="{{Violence=[[ [[{[[@{violenceDruidLion}-@{chargeurExplosives}-@{munitionsIEM}]], 0}kh1]]D6+@{violenceBonusDruidLion}]]}}" />
                    
                    <input type="hidden" name="attr_druidLionEffets" value="@{destructeur} @{fureur} @{leste} @{meurtrier} @{orfevrerie} @{precision} {{tirSecurite=[[@{tirSecurite}]]}} @{ultraViolence} @{antiAnatheme} @{antiVehicule} @{artillerie} @{assistanceAttaque} @{barrage} @{chargeur} @{choc} @{defense} @{deuxMains} @{dispersion} @{degatContinue} @{demoralisant} @{designation} @{enChaine} @{esperance} @{ignoreArmure} @{ignoreCdF} {{lourd=[[@{lourd}]]}} @{lumiere} @{obliteration} @{parasitage} @{penetrant} @{perceArmure} @{reaction} @{silencieux} {{silencieuxD=[[floor((@{druidLionMasqueTot})/2)+@{druidLionMasqueAE}]]}} @{tenebricite} {{jumelageAkimbo=[[@{akimbo}]]}} {{jumelageAmbidextrie=[[@{ambidextrie}]]}} @{tirRafale} @{assassin} {{cadence=[[ceil(@{cadence})]]}} {{scoreCadence=@{cadenceValue}}} @{soumission}" />
                    
                    <input type="hidden" name="attr_druidLionAmeliorations" value="{{chargeurGrappes=[[1D6]]}} {{ballesGrappes=[[@{chargeurGrappes}]]}} {{chargeurExplosives=[[1D6]]}} {{ballesExplosives=[[@{chargeurExplosives}]]}} @{pointeurLaser} @{lunetteIntelligente} @{canonLong} @{munitionsSubsoniques} @{protectionArme} @{structureElement} @{munitionsHyperVelocite} @{munitionsDrone} {{munitionsNonLetales=[[@{munitionsNonLetales}]]}} {{munitionsIEM=[[@{munitionsIEM}]]}} {{interfaceGuidage=[[@{interfaceGuidage}]]}} @{jumelage} {{chambreDouble=[[ceil(@{chambreDouble})]]}} @{systemeRefroidissement} {{revetementOmega=[[@{revetementOmega}D6]]}}" />

                    <input type="hidden" name="attr_druidLionSpecial" value="@{energie} @{bDDiversTotal} @{bVDiversTotal}" />
                </div>
                <div class="ligne">
                    <div class="firstCol aNom">
                        <input type="text" name="attr_armeDruidLion" />
                    </div>
                    <div class="midCol aDegats">
                        <input class="nbre" type="number" name="attr_degatDruidLion" value="0" />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_degatBonusDruidLion" value="0" />
                    </div>
                    <div class="midCol aViolence">
                        <input class="nbre" type="number" name="attr_violenceDruidLion" value="0" />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_violenceBonusDruidLion" value="0" />
                    </div>
                    <div class="midCol aPortee">
                        <select name="attr_porteeDruidLion">
                            <option data-i18n="portee-contact" value="^{portee-contact}" selected>Contact</option>
                            <option data-i18n="portee-courte" value="^{portee-courte}">Courte</option>
                            <option data-i18n="portee-moyenne" value="^{portee-moyenne}">Moyenne</option>
                            <option data-i18n="portee-longue" value="^{portee-longue}">Longue</option>
                            <option data-i18n="portee-lointaine" value="^{portee-lointaine}">Lointaine</option>
                        </select>
                    </div>
                    <div class="lastCol aAspect">
                        <select name="attr_aspectDruidLion">
                            <option value="druidLionChair" data-i18n="chair">Chair</option>
                            <option value="druidLionBete" data-i18n="bete">Bete</option>
                            <option value="druidLionMachine" data-i18n="machine">Machine</option>
                            <option value="druidLionDame" data-i18n="dame">Dame</option>
                            <option value="druidLionMasque" data-i18n="masque">Masque</option>
                        </select>
                        <button class="rollDice" type="action" name="act_combatdruidroll" value="@{jetGM} &{template:combat} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}}"></button>
                    </div>
                </div>
                <div class="subMenu">
                    <button class="effets" type="action" name="act_tab-1" data-i18n="effets">Effets</button>
                    <button class="ameliorationsArmes BL" type="action" name="act_tab-2" data-i18n="ameliorations-d'armes">Améliorations d'armes</button>
                    <button class="special BL" type="action" name="act_tab-3" data-i18n="special">Spécial</button>
                </div>
                
                <div class="effets">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_antiAnatheme" value="{{antiAnathème=Anti Anathème}}" />
                        <span data-i18n-title="anti-anatheme" title="Anti Anathème"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_antiVehicule" value="{{antiVehicule=Anti Véhicule}} " />
                        <span data-i18n-title="anti-vehicule" title="Anti Véhicule"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_artillerie" value="{{artillerie=Artillerie}}" />
                        <span data-i18n-title="artillerie" title="Artillerie"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_assassin" value="{{assassin=[[@{assassinValue}d6]]}} " />
                            <span data-i18n-title="assassin" title="Assassin"></span>
                        </label>
                        
                        <input type="number" name="attr_assassinValue" class="center" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_assistanceAttaque" value="{{assistanceAttaque=Assistance à l'attaque}}" />
                        <span data-i18n-title="assistance-attaque" title="Assistance à l'attaque"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_barrage" value="{{barrage=^{barrage} @{barrageValue}}} " />
                            <span data-i18n-title="barrage" title="Barrage"></span>
                        </label>
                        
                        <input type="number" name="attr_barrageValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_cadence" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                            <span data-i18n-title="cadence" title="Cadence"></span>
                        </label>
                    
                        <input type="number" name="attr_cadenceValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_chargeur" value="{{chargeur=^{chargeur} @{chargeurValue}}} " />
                            <span data-i18n-title="chargeur" title="Chargeur"></span>
                        </label>
                    
                        <input type="number" name="attr_chargeurValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_choc" value="{{choc=^{choc} @{chocValue}}}" />
                            <span data-i18n-title="choc" title="Choc"></span>
                        </label>
                    
                        <input type="number" name="attr_chocValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_defense" value="{{defense=^{defense} @{defenseValue}}}" />
                            <span data-i18n-title="defense" title="Défense"></span>
                        </label>
                    
                        <input type="number" name="attr_defenseValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_degatContinue" value="{{degatContinus=^{degats-continus} @{degatContinueValue} ([[1D6]] ^{tours})}}" />
                            <span data-i18n-title="degats-continus" title="Dégâts Continus"></span>
                        </label>
                    
                        <input type="number" name="attr_degatContinueValue" class="center" size="2" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_deuxMains" value="{{deuxMains=Deux Mains}}" />
                        <span data-i18n-title="deux-mains" title="Deux Mains"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_demoralisant" value="{{demoralisant=Démoralisant}}" />
                        <span data-i18n-title="demoralisant" title="Démoralisant"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_designation" value="{{designation=Désignation}}" />
                        <span data-i18n-title="designation" title="Désignation"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_destructeur" value="{{destructeur=[[2D6]]}}" />
                        <span data-i18n-title="destructeur" title="Destructeur"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_dispersion" value="{{dispersion=^{dispersion} @{dispersionValue}}} " />
                            <span data-i18n-title="dispersion" title="Dispersion"></span>
                        </label>
                    
                        <input type="number" name="attr_dispersionValue" class="center" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_enChaine" value="{{enChaine=En Chaîne}}" />
                        <span data-i18n-title="en-chaine" title="En Chaîne"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_esperance" value="{{esperance=Espérance}}" />
                        <span data-i18n-title="esperance" title="Espérance"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_fureur" value="{{fureur=[[4D6]]}}" />
                        <span data-i18n-title="fureur" title="Fureur"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ignoreArmure" value="{{ignoreArmure=Ignore Armure}}" />
                        <span data-i18n-title="ignore-armure" title="Ignore Armure"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ignoreCdF" value="{{ignoreCdF=Ignore Champs de Force}}" />
                        <span data-i18n-title="ignore-champ-de-force" title="Ignore CdF"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_akimbo" value="2" />
                        <span data-i18n-title="jumele-akimbo" title="Jumelé (Akimbo)"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ambidextrie" value="2" />
                        <span data-i18n-title="jumele-ambidextrie" title="Jumelé (Ambidextrie)"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_leste" value="{{leste=[[@{druidLionChairTot}]]}}" />
                        <span data-i18n-title="leste" title="Lesté"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_lourd" value="1" />
                        <span data-i18n-title="lourd" title="Lourd"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_lumiere" value="{{lumiere=^{lumiere} @{lumiereValue}}}" />
                            <span data-i18n-title="lumiere" title="Lumière"></span>
                        </label>

                        <input type="number" name="attr_lumiereValue" class="center" size="2" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_meurtrier" value="{{meurtrier=[[2D6]]}}" />
                        <span data-i18n-title="meurtrier" title="Meurtrier"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_obliteration" value="{{obliteration=Oblitération}}" />
                        <span data-i18n-title="obliteration" title="Oblitération"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_orfevrerie" value="{{orfevrerie=[[@{dexterite}+@{dextOD}]]}} {{orfevrerieWarrior=[[@{dexterite}+@{dextOD}+@{warriorScoutA}]]}}" />
                        <span data-i18n-title="orfevrerie" title="Orfèvrerie"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_parasitage" value="{{parasitage=^{parasitage} @{parasitageValue}}}" />
                            <span data-i18n-title="parasitage" title="Parasitage"></span>
                        </label>
                    
                        <input type="number" name="attr_parasitageValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_penetrant" value="{{penetrant=^{penetrant} @{penetrantValue}}}" />
                            <span data-i18n-title="penetrant" title="Pénétrant"></span>
                        </label>
                    
                        <input type="number" name="attr_penetrantValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_perceArmure" value="{{perceArmure=^{perce-armure} @{perceArmureValue}}}" />
                            <span data-i18n-title="perce-armure" title="Perce Armure"></span>
                        </label>
                    
                        <input type="number" name="attr_perceArmureValue" class="center" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_precision" value="{{precision=[[@{tir}+@{tirOD}]]}} {{precisionWarrior=[[@{tir}+@{tirOD}+@{warriorScholarA}]]}}" />
                        <span data-i18n-title="precision" title="Précision"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_reaction" value="{{reaction=^{reaction} @{reactionValue}}}" />
                            <span data-i18n-title="reaction" title="Réaction"></span>
                        </label>
                    
                        <input type="number" name="attr_reactionValue" class="center" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_silencieux" value="{{silencieux=Silencieux}}" />
                        <span data-i18n-title="silencieux" title="Silencieux"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_soumission" value="{{soumission=Soumission}}" />
                        <span data-i18n-title="soumission" title="Soumission"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_tenebricite" value="{{tenebricite=Ténébricité}}" />
                        <span data-i18n-title="tenebricite" title="Ténébricité"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_tirRafale" value="{{tirRafale=Tir en Rafale}}" />
                        <span data-i18n-title="tir-rafale" title="Tir en Rafale"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_tirSecurite" value="3" />
                        <span data-i18n-title="tir-securite" title="Tir en Sécurité"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ultraViolence" value="{{ultraviolence=[[2D6]]}}" />
                        <span data-i18n-title="ultraviolence" title="Ultraviolence"></span>
                    </label>
                </div>
                <div class="ameliorationsArmes">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_chargeurGrappes" value="1" />
                        <span data-i18n-title="balles-grappes" title="Balles grappes"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_canonLong" value="{{canonLongM=1}} {{canonLongC=Canon Long (Portée Courte : +3 Difficulté)}}" />
                        <span data-i18n-title="canon-long" title="Canon Long"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_canonRaccourci" value="{{canonRaccourci=Canon Raccourci (Portée Courte : Dispersion 3 / Sinon : +3 Difficulté)}}" />
                        <span data-i18n-title="canon-raccourci" title="Canon Raccourci"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_chambreDouble" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                        <span data-i18n-title="chambre-double" title="Chambre Double"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_interfaceGuidage" value="3" />
                        <span data-i18n-title="interface-guidage" title="Interface de guidage"></span>
                    </label>
                    <div class="doubleTexte">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_jumelage" value="{{jumelage=^{jumelage} (@{jumelageValue})}}" />
                            <span data-i18n-title="jumelage" title="Jumelage :"></span>
                        </label>
                        <input type="text" name="attr_jumelageValue" class="borderBottom" />
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_jumelageType" value="ambidextrie" />
                            <span data-i18n-title="ambidextrie" title="Ambidextrie"></span>
                        </label>
                        <label class="fakeButton borderTop">
                            <input type="checkbox" name="attr_jumelageType" value="akimbo" />
                            <span data-i18n-title="akimbo" title="Akimbo"></span>
                        </label>
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_lunetteIntelligente" value="{{lunetteIntelligente=Lunette Intelligente (+1 Portée)}}" />
                        <span data-i18n-title="lunette-intelligente" title="Lunette Intelligente"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsHyperVelocite" value="{{munitionsHyperVelocite=Munitions à Hyper Velocite (Assistance à l'Attaque)}}" />
                        <span data-i18n-title="munitions-h-velocite" title="Munitions à H. Vélocité"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsDrone" value="{{munitionsDrone=3}}" />
                        <span data-i18n-title="munitions-drones" title="Munitions Drones"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_chargeurExplosives" value="1" />
                        <span data-i18n-title="munitions-explosives" title="Munitions Explosives"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsIEM" value="1" />
                        <span data-i18n-title="munitions-iem" title="Munitions IEM"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsNonLetales" value="2" />
                        <span  data-i18n-title="munitions-n-letales"title="Munitions N. Létales"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsSubsoniques" value="{{munitionsSubsoniques=Munitions Subsoniques (Silencieux)}}" />
                        <span data-i18n-title="munitions-subsoniques" title="Munitions Subsoniques"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pointeurLaser" value="{{pointeurLaser=1}} " />
                        <span data-i18n-title="pointeur-laser" title="Pointeur Laser"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_protectionArme" value="{{protectionArme=Protection d'Arme (Reaction +2)}}" />
                        <span data-i18n-title="protection-d'arme" title="Protection d'Arme"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_revetementOmega" value="2" />
                        <span data-i18n-title="revetement-omega" title="Revêtement Omega"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_structureElement" value="{{structureElement=Structure en Élément}}" />
                        <span data-i18n-title="structure-alpha" title="Structure Alpha"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_systemeRefroidissement" value="{{systemeRefroidissement=Système de Refroidissement (Tir en Rafale + Barrage 1)}}" />
                        <span data-i18n-title="systeme-refroid" title="Système de Refroid."></span>
                    </label>
                </div>
                <div class="special">
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_energie" value="{{energie=@{energieValue}}} " />
                            <span data-i18n-title="energie" title="Énergie"></span>
                        </label>
                    
                        <input type="number" name="attr_energieValue" class="center" value="0" />
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_bDDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_bDDiversTotal" value="{{BDDivers=[[@{bDDiversD6}D6+@{bDDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-degats" title="Bonus aux dégâts"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_bDDiversD6" class="center" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_bDDiversFixe" class="center" value="0" />
                        </div>
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_bVDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_bVDiversTotal" value="{{BVDivers=[[@{bVDiversD6}D6+@{bVDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-violence" title="Bonus à la violence"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_bVDiversD6" class="center" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_bVDiversFixe" class="center" value="0" />
                        </div>
                    </div>
                </div>
            </fieldset>
        </div>

        <div class="modules">
            <input type="hidden" name="attr_slotsDCLTeteMax" value="8" readonly />
            <input type="hidden" name="attr_slotsUDCLTeteTot" value="0" />
            
            <input type="hidden" name="attr_slotsDCLTorseMax" value="8" readonly />
            <input type="hidden" name="attr_slotsUDCLTorseTot" value="0" />
        
            <input type="hidden" name="attr_slotsDCLBGMax" value="8" readonly />
            <input type="hidden" name="attr_slotsUDCLBGTot" value="0" />
        
            <input type="hidden" name="attr_slotsDCLBDMax" value="8" readonly />
            <input type="hidden" name="attr_slotsUDCLBDTot" value="0" />
        
            <input type="hidden" name="attr_slotsDCLJGMax" value="8" readonly />
            <input type="hidden" name="attr_slotsUDCLJGTot" value="0" />
        
            <input type="hidden" name="attr_slotsDCLJDMax" value="8" readonly />
            <input type="hidden" name="attr_slotsUDCLJDTot" value="0" />

            <h1 class="titre" data-i18n="slots-du-lion">Slots du Lion</h1>
            <div class="ligne slots">
                <div class="col6">
                    <span data-i18n="tete">Tête</span>
                    <div data-i18n-title="slots-restants/slots-maximum" title="Slots restants / Slots maximum">
                        <input type="number" name="attr_slotsDCLTeteAct" value="@{slotsDCLTeteMax}-@{slotsUDCLTeteTot}" disabled />	
                        <b>/</b>
                        <span name="attr_slotsDCLTeteMax">8</span>
                    </div>
                </div>

                <div class="col6BL">
                    <span data-i18n="torse">Torse</span>
                    <div data-i18n-title="slots-restants/slots-maximum" title="Slots restants / Slots maximum">
                        <input type="number" name="attr_slotsDCLTorseAct" value="@{slotsDCLTorseMax}-@{slotsUDCLTorseTot}" disabled />
                        <b>/</b>
                        <span name="attr_slotsDCLTorseMax">8</span>
                    </div>
                </div>

                <div class="col6BL">
                    <span data-i18n="bras-gauche">Bras Gauche</span>
                    <div data-i18n-title="slots-restants/slots-maximum" title="Slots restants / Slots maximum">
                        <input type="number" name="attr_slotsDCLBGAct" value="@{slotsDCLBGMax}-@{slotsUDCLBGTot}" disabled />
                        <b>/</b>
                        <span name="attr_slotsDCLBGMax">8</span>
                    </div>
                </div>

                <div class="col6BL">
                    <span data-i18n="bras-droit">Bras Droit</span>
                    <div data-i18n-title="slots-restants/slots-maximum" title="Slots restants / Slots maximum">
                        <input type="number" name="attr_slotsDCLBDAct" value="@{slotsDCLBDMax}-@{slotsUDCLBDTot}" disabled />
                        <b>/</b>
                        <span name="attr_slotsDCLBDMax">8</span>
                    </div>
                </div>

                <div class="col6BL">
                    <span data-i18n="jambe-gauche">Jambe Gauche</span>
                    <div data-i18n-title="slots-restants/slots-maximum" title="Slots restants / Slots maximum">
                        <input type="number" name="attr_slotsDCLJGAct" value="@{slotsDCLJGMax}-@{slotsUDCLJGTot}" disabled />
                        <b>/</b>
                        <span name="attr_slotsDCLJGMax">8</span>
                    </div>
                </div>

                <div class="col6BL">
                    <span data-i18n="jambe-droite">Jambe Droite</span>
                    <div data-i18n-title="slots-restants/slots-maximum" title="Slots restants / Slots maximum">
                        <input type="number" name="attr_slotsDCLJDAct" value="@{slotsDCLJDMax}-@{slotsUDCLJDTot}" disabled />
                        <b>/</b>
                        <span name="attr_slotsDCLJDMax">8</span>
                    </div>
                </div>
            </div>
            <fieldset class="repeating_modulesDCLion">
                <input class="expandModule" type="hidden" name="attr_affichageDCLion" value="0" />
                <input class="expandSlots" type="hidden" name="attr_slotsDCLPlus" value="0" />

                <div class="ligne titreModule">
                    <button class="buttonPlus" type="action" name="act_affichagedclion-1">
                       <span class="plus">+</span>
                       <span class="moins">-</span>
                    </button>
                    <input type="text" name="attr_moduleNomDCLion" placeholder="Nom du Module"/>
                </div>
                
                <div class="ligne hModule">
                    <label class="activation">
                        <span data-i18n="activation">Activation</span>
                        <input type="text" name="attr_moduleActivationDCLion" />
                    </label>
                    <div class="PE">
                        <button type="action" name="act_pemdlion" title="Dépenser les PE du module" data-i18n-title="depenser-pe-module" data-i18n="point-d'energie-short">PE</button>
                        <input type="number" name="attr_moduleEnergieDCLion" value="0" />
                    </div>
                </div>

                <label class="ligne hModule duree">
                    <span data-i18n="duree">Durée</span>
                    <input type="text" name="attr_moduleDureeDCLion" />
                </label>

                <div class="autoex hModule autoex28">
                    <span name="attr_moduleDescriptionDCLion"></span>
                    <textarea name="attr_moduleDescriptionDCLion"></textarea>
                </div>

                <div class="ligne hModule titre titreSlots">
                    <input type="number" name="attr_slotsTotalDCLion" value="@{moduleSlotDCLTete}+@{moduleSlotDCLTorse}+@{moduleSlotDCLBG}+@{moduleSlotDCLBD}+@{moduleSlotDCLJG}+@{moduleSlotDCLJD}" title="Slots occupés" disabled />
                    <h1 class="titre" data-i18n="slots">Slots</h1>
                    <button class="buttonArrow" type="action" name="act_slotsdclplus-1">]</button>
                </div>
                
                <div class="ligne hSlots">
                    <label class="slot">
                        <span data-i18n="tete">Tête</span>
                        <input type="number" name="attr_moduleSlotDCLTete" value="0" />
                    </label>
                    
                    <label class="slotBL">
                        <span data-i18n="torse">Torse</span>
                        <input type="number" name="attr_moduleSlotDCLTorse" value="0" />
                    </label>
                </div>
                
                <div class="ligne hSlots bTop">
                    <label class="slot">
                        <span data-i18n="bras-gauche">Bras Gauche</span>
                        <input type="number" name="attr_moduleSlotDCLBG" value="0" />
                    </label>
                    
                    <label class="slotBL">
                        <span data-i18n="bras-droit">Bras Droit</span>
                        <input type="number" name="attr_moduleSlotDCLBD" value="0" />
                    </label>
                </div>
                
                <div class="ligne hSlots bTop">
                    <label class="slot">
                        <span data-i18n="jambe-gauche">Jambe Gauche</span>
                        <input type="number" name="attr_moduleSlotDCLJG" value="0" />
                    </label>
                    
                    <label class="slotBL">
                        <span data-i18n="jambe-droite">Jambe Droite</span>
                        <input type="number" name="attr_moduleSlotDCLJD" value="0" />
                    </label>
                </div>
            </fieldset>
        </div>

        <div class="evolutions">
            <input type="hidden" name="attr_druidLionChairBase" value="7" />
            <input type="hidden" name="attr_druidLionBeteBase" value="6" />
            <input type="hidden" name="attr_druidLionMachineBase" value="7" />
            <input type="hidden" name="attr_druidLionDameBase" value="4" />
            <input type="hidden" name="attr_druidLionMasqueBase" value="3" />
                                        
            <input type="hidden" name="attr_druidLionPABase" value="60" />
            <input type="hidden" name="attr_druidLionDefenseBase" value="4" />
            <input type="hidden" name="attr_druidLionReactionBase" value="4" />
            <input type="hidden" name="attr_druidLionInitiativeBase" value="2" />
            <input type="hidden" name="attr_druidLionCDFBase" value="10" />

            <div class="aspects">
                <div class="ligneTitre">
                    <span></span>
                    <span data-i18n="aspects">Aspects</span>
                    <span data-i18n="aspects-exceptionnels">Aspects Exceptionnels</span>
                </div>
                <div class="ligne2">
                    <span data-i18n="chair">Chair</span>
                    <div>
                        <input type="number" name="attr_druidLionChairEvol" value="0" min="0" />
                    </div>
                    <div>
                        <select name="attr_druidLionChairAE">
                            <option value="1" selected>1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                        </select>
                    </div>
                    
                </div>
                <div class="ligne2">
                    <span data-i18n="bete">Bête</span>
                    <div>
                        <input type="number" name="attr_druidLionBeteEvol" value="0" min="0" />
                    </div>
                    <div>
                        <select name="attr_druidLionBeteAE">
                            <option value="1" selected>1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                        </select>
                    </div>
                </div>
                <div class="ligne2">
                    <span data-i18n="machine">Machine</span>
                    <div>
                        <input type="number" name="attr_druidLionMachineEvol" value="0" min="0" />
                    </div>
                    <div>
                        <select name="attr_druidLionMachineAE">
                            <option value="1" selected>1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                        </select>
                    </div>
                </div>
                <div class="ligne2">
                    <span data-i18n="dame">Dame</span>
                    <div>
                        <input type="number" name="attr_druidLionDameEvol" value="0" min="0" />
                    </div>
                    <div>
                        <select name="attr_druidLionDameAE">
                            <option value="0" selected>0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                        </select>
                    </div>
                </div>
                <div class="ligne2">
                    <span data-i18n="masque">Masque</span>
                    <div>
                        <input type="number" name="attr_druidLionMasqueEvol" value="0" min="0" />
                    </div>
                    <div>
                        <select name="attr_druidLionMasqueAE">
                            <option value="0" selected>0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="VD">
                <div class="ligneTitre">
                    <span></span>
                    <span data-i18n="valeurs-derivees">Valeurs Dérivées</span>
                </div>
                <label class="ligne1">
                    <span data-i18n="champ-de-force">Champs de Force</span>
                    <input type="number" name="attr_druidLionCDFEvol" value="0" min="0" />
                </label>
                <label class="ligne1">
                    <span data-i18n="armure">Armure</span>
                    <input type="number" name="attr_druidLionPAEvol" value="0" min="0" />
                </label>
                <label class="ligne1">
                    <span data-i18n="defense">Défense</span>
                    <input type="number" name="attr_druidLionDefenseEvol" value="0" min="0" />
                </label>
                <label class="ligne1">
                    <span data-i18n="reaction">Réaction</span>
                    <input type="number" name="attr_druidLionReactionEvol" value="0" min="0" />
                </label>
                <label class="ligne1">
                    <span data-i18n="initiative">Initiative</span>
                    <input type="number" name="attr_druidLionInitiativeEvol" value="0" min="0" />
                </label>
            </div>
        </div>
    </div>

    <div class="fichePJ druid DCWolf">
        <input class="subMenu" type="hidden" name="attr_tabDruidWolf" value="0" />
        <input class="choixConfiguration" type="hidden" name="attr_druidWolfConfiguration" />
        <input class="laborNiveau" type="hidden" name="attr_DWolfLaborNiveau" value="1" />
        <input class="medikNiveau" type="hidden" name="attr_DWolfMedicNiveau" value="1" />
        <input class="techNiveau" type="hidden" name="attr_DWolfTechNiveau" value="1" />
        <input class="fighterNiveau" type="hidden" name="attr_DWolfFighterNiveau" value="1" />
        <input class="reconNiveau" type="hidden" name="attr_DWolfReconNiveau" value="1" />

        <h1 class="titre" data-i18n="druid-companion-wolf">Wolf</h1>
        <div class="col4">
            <h1 class="titre" data-i18n="aspects">Aspects</h1>

            <div class="ligne aspect">
                <span data-i18n="chair">Chair</span>

                <div class="blockR">
                    <input type="number" name="attr_druidWolfChairTot" value="@{druidWolfChairBase}+@{druidWolfChairEvol}" disabled />
                    <button class="rollDice" name="act_druidWolfChairRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-wolf}}} {{special1=@{name}}}"></button>
                </div>
            </div>
            <div class="ligne aspect">
                <span data-i18n="bete">Bête</span>

                <div class="blockR">
                    <input type="number" name="attr_druidWolfBeteTot" value="@{druidWolfBeteBase}+@{druidWolfBeteEvol}" disabled />
                    <button class="rollDice" name="act_druidWolfBeteRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-wolf}}} {{special1=@{name}}}"></button>    
                </div>
            </div>
            <div class="ligne aspect">
                <span data-i18n="machine">Machine</span>

                <div class="blockR">
                    <input type="number" name="attr_druidWolfMachineTot" value="@{druidWolfMachineBase}+@{druidWolfMachineEvol}" disabled />
                    <button class="rollDice" name="act_druidWolfMachineRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-wolf}}} {{special1=@{name}}}"></button>
                </div>
            </div>
            <div class="ligne aspect">
                <span data-i18n="dame">Dame</span>

                <div class="blockR">
                    <input type="number" name="attr_druidWolfDameTot" value="@{druidWolfDameBase}+@{druidWolfDameEvol}" disabled />
                    <button class="rollDice" name="act_druidWolfDameRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-wolf}}} {{special1=@{name}}}"></button>
                </div>
            </div>
            <div class="ligne aspect">
                <span data-i18n="masque">Masque</span>

                <div class="blockR">
                    <input type="number" name="attr_druidWolfMasqueTot" value="@{druidWolfMasqueBase}+@{druidWolfMasqueEvol}" disabled />
                    <button class="rollDice" name="act_druidWolfMasqueRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-wolf}}} {{special1=@{name}}}"></button>
                </div>
            </div>
        </div>

        <div class="col4BL">
            <h1 class="titre" data-i18n="aspects-exceptionnels">Aspects Exceptionnels</h1>

            <div class="ligne AE">
                <input type="hidden" name="attr_druidWolfChairAE" value="0"/>
                <span class="mineur" data-i18n="mineur">Mineur</span>
                <span class="majeur" data-i18n="majeur">Majeur</span>
                <span class="value" name="attr_druidWolfChairAE">0</span>
            </div>
            <div class="ligne AE">
                <input type="hidden" name="attr_druidWolfBeteAE" value="0"/>
                <span class="mineur" data-i18n="mineur">Mineur</span>
                <span class="majeur" data-i18n="majeur">Majeur</span>
                <span class="value" name="attr_druidWolfBeteAE">0</span>
            </div>
            <div class="ligne AE">
                <input type="hidden" name="attr_druidWolfMachineAE" value="0"/>
                <span class="mineur" data-i18n="mineur">Mineur</span>
                <span class="majeur" data-i18n="majeur">Majeur</span>
                <span class="value" name="attr_druidWolfMachineAE">0</span>
            </div>
            <div class="ligne AE">
                <input type="hidden" name="attr_druidWolfDameAE" value="0"/>
                <span class="mineur" data-i18n="mineur">Mineur</span>
                <span class="majeur" data-i18n="majeur">Majeur</span>
                <span class="value" name="attr_druidWolfDameAE">0</span>
            </div>
            <div class="ligne AE">
                <input type="hidden" name="attr_druidWolfMasqueAE" value="0"/>
                <span class="mineur" data-i18n="mineur">Mineur</span>
                <span class="majeur" data-i18n="majeur">Majeur</span>
                <span class="value" name="attr_druidWolfMasqueAE">0</span>
            </div>
        </div>

        <div class="col4BL">
            <h1 class="titre" data-i18n="valeurs-derivees">Valeurs Dérivées</h1>

            <div class="ligne defense">
                <span data-i18n="defense">Défense</span>

                <div class="blockR">
                    <input type="number" name="attr_druidWolfDefenseTot" value="4+@{druidWolfMasqueAE}" disabled />
                </div>
            </div>

            <div class="ligne reaction">
                <span data-i18n="reaction">Réaction</span>

                <div class="blockR">
                    <input type="number" name="attr_druidWolfReactionTot" value="4+@{druidWolfMachineAE}" disabled />
                </div>
            </div>

            <div class="ligne initiative">
                <span data-i18n="initiative">Initiative</span>

                <div class="blockR">
                    <input type="number" name="attr_druidWolfInitiativeTot" value="2" disabled />
                    <button class="rollDice" type="action" name="act_druidWolfInitiativeRoll" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-wolf}}} {{special1=@{name}}}"></button>
                </div>
            </div>

            <div class="ligne armure">
                <span data-i18n="armure">Armure</span>

                <div class="blockR">
                    <input type="number" name="attr_druidWolfPAAct" value="20" />
                    <b>/</b>
                    <input type="number" name="attr_druidWolfPAAct_max" value="20" disabled />
                </div>
            </div>

            <div class="ligne energie">
                <span data-i18n="energie">Energie</span>

                <div class="blockR">
                    <input type="number" name="attr_druidWolfPEAct" value="0" />
                    <b>/</b>
                    <input type="number" name="attr_druidWolfPEAct_max" value="@{druidEnergieCompanon}" disabled />
                </div>
            </div>
        </div>

        <div class="col4BL">
            <h1 class="titre" data-i18n="champ-de-force">Champ de Force</h1>

            <div class="ligne CDF">
                <input type="number" name="attr_druidWolfCDFT" value="4" disabled />
            </div>

            <h1 class="titre" data-i18n="configuration">Configuration</h1>
            <div class="ligne configuration">
                <select name="attr_druidWolfConfiguration">
                    <option value="" selected></option>
                    <option value="Labor" data-i18n="druid-wolf-labor">Labor</option>
                    <option value="Medic" data-i18n="druid-wolf-medik">Medik</option>
                    <option value="Tech" data-i18n="druid-wolf-tech">Tech</option>
                    <option value="Fighter" data-i18n="druid-wolf-fighter">Fighter</option>
                    <option value="Recon" data-i18n="druid-wolf-recon">Recon</option>
                </select>
                <button type="action" name="act_druidWolfConfiguration" data-i18n="point-energie-short">PE</button>
                <input type="number" name="attr_druidWolfConfigurationPE" value="0" readonly />
            </div>
            <div class="ligne nbreCompanions">
                <select name="attr_druidNombreCompagnon">
                    <option value="3" data-i18n="druid-3-companions-restants" selected>3 Companions Restants</option>
                    <option value="2"data-i18n="druid-2-companions-restants" >2 Companions Restants</option>
                    <option value="1"data-i18n="druid-1-companions-restants" >1 Companions Restant</option>
                </select>
            </div>
            <div class="ligne fighter">
                <span data-i18n="degats">Dégâts</span>
                <button class="rollDice" type="action" name="act_DWolfFighterRoll" value="@{jetGM} &{template:combat} {{portee=^{portee-contact}}} {{Nom=^{druid-companion-wolf}}} {{special1=@{name}}}"></button>
            </div>
        </div>

        <h1 class="titre" data-i18n="configuration">Configuration</h1>
        <div class="labor description">
            <span class="N1" data-i18n="druid-companion-labor-description-niveau-1">
                Les actions du chevalier visant à porter de lourdes charges, à déplacer ou lever des poids reçoivent 1 dé par compagnon effectuant l’action de support. Chaque compagnon peut porter à lui seul 150 kg et peut donc transporter des choses pour le chevalier.
            </span>
            <span class="N2" data-i18n="druid-companion-labor-description-niveau-2">
                Les actions du chevalier visant à porter de lourdes charges, à déplacer ou lever des poids reçoivent 2 dé par compagnon effectuant l’action de support. Chaque compagnon peut porter à lui seul 150 kg et peut donc transporter des choses pour le chevalier.
            </span>
            <span class="N3" data-i18n="druid-companion-labor-description-niveau-3">
                Les actions du chevalier visant à porter de lourdes charges, à déplacer ou lever des poids reçoivent 3 dé par compagnon effectuant l’action de support. Chaque compagnon peut porter à lui seul 150 kg et peut donc transporter des choses pour le chevalier.
            </span>
        </div>

        <div class="medik description">
            <span class="N1" data-i18n="druid-companion-medik-description-niveau-1">
                Les actions du chevalier visant à soigner, à faire des recherches biologiques ou à reconnaitre un élément médical ou biologique reçoivent 1 dé supplémentaire par compagnon effectuant un support. Si le chevalier soigne un allié, celui-ci récupère 2 PS supplémentaires par compagnon effectuant un support.
            </span>
            <span class="N2" data-i18n="druid-companion-medik-description-niveau-2">
                Les actions du chevalier visant à soigner, à faire des recherches biologiques ou à reconnaitre un élément médical ou biologique reçoivent 2 dé supplémentaire par compagnon effectuant un support. Si le chevalier soigne un allié, celui-ci récupère 2 PS supplémentaires par compagnon effectuant un support.
            </span>
            <span class="N3" data-i18n="druid-companion-medik-description-niveau-3">
                Les actions du chevalier visant à soigner, à faire des recherches biologiques ou à reconnaitre un élément médical ou biologique reçoivent 3 dé supplémentaire par compagnon effectuant un support. Si le chevalier soigne un allié, celui-ci récupère 2 PS supplémentaires par compagnon effectuant un support.
            </span>
        </div>

        <div class="tech description">
            <span class="N1" data-i18n="druid-companion-tech-description-niveau-1">
                Les actions du chevalier visant à réparer un objet, un véhicule, un compagnon ou une méta-armure, à analyser un élément informatique ou électronique reçoivent 1 dé supplémentaire par compagnon effectuant un support. Le chevalier peut effectuer les réparations ou les analyses directement depuis un compagnon. Si le chevalier tente de réparer quelque chose (méta-armure, compagnon, véhicule) à l’aide de ses Companions, les PA que la cible récupère sont augmentés de 3 par compagnon effectuant l’action de support.
            </span>
            <span class="N2" data-i18n="druid-companion-tech-description-niveau-2">
                Les actions du chevalier visant à réparer un objet, un véhicule, un compagnon ou une méta-armure, à analyser un élément informatique ou électronique reçoivent 2 dé supplémentaire par compagnon effectuant un support. Le chevalier peut effectuer les réparations ou les analyses directement depuis un compagnon. Si le chevalier tente de réparer quelque chose (méta-armure, compagnon, véhicule) à l’aide de ses Companions, les PA que la cible récupère sont augmentés de 3 par compagnon effectuant l’action de support.
            </span>
            <span class="N3" data-i18n="druid-companion-tech-description-niveau-3">
                Les actions du chevalier visant à réparer un objet, un véhicule, un compagnon ou une méta-armure, à analyser un élément informatique ou électronique reçoivent 3 dé supplémentaire par compagnon effectuant un support. Le chevalier peut effectuer les réparations ou les analyses directement depuis un compagnon. Si le chevalier tente de réparer quelque chose (méta-armure, compagnon, véhicule) à l’aide de ses Companions, les PA que la cible récupère sont augmentés de 3 par compagnon effectuant l’action de support.
            </span>
        </div>

        <div class="fighter description">
            <span class="N1" data-i18n="druid-companion-fighter-description-niveau-1">
                Les actions de combat du chevalier contre un ennemi désigné aux Companions reçoivent 1 dé supplémentaire par compagnon effectuant un support. La cible du chevalier doit être à portée courte et doit pouvoir être attaquée au contact. Si ces deux conditions sont respectées, la cible reçoit automatiquement l’effet barrage 1 par compagnon (3 Companions supportant le chevalier infligent ainsi l’effet barrage 3). De plus, les Companions infligent à la cible 1D6 points de dégâts ou de violence chacun (sans bonus) sans devoir effectuer de jet de dés pour toucher. On considère cependant que lorsqu’ils effectuent cette action de support, leur défense tombe à 0. Une seule cible à la fois peut subir cette action de support.
            </span>
            <span class="N2" data-i18n="druid-companion-fighter-description-niveau-2">
                Les actions de combat du chevalier contre un ennemi désigné aux Companions reçoivent 2 dé supplémentaire par compagnon effectuant un support. La cible du chevalier doit être à portée courte et doit pouvoir être attaquée au contact. Si ces deux conditions sont respectées, la cible reçoit automatiquement l’effet barrage 1 par compagnon (3 Companions supportant le chevalier infligent ainsi l’effet barrage 3). De plus, les Companions infligent à la cible 1D6 points de dégâts ou de violence chacun (sans bonus) sans devoir effectuer de jet de dés pour toucher. On considère cependant que lorsqu’ils effectuent cette action de support, leur défense tombe à 0. Une seule cible à la fois peut subir cette action de support.
            </span>
            <span class="N3" data-i18n="druid-companion-fighter-description-niveau-3">
                Les actions de combat du chevalier contre un ennemi désigné aux Companions reçoivent 3 dé supplémentaire par compagnon effectuant un support. La cible du chevalier doit être à portée courte et doit pouvoir être attaquée au contact. Si ces deux conditions sont respectées, la cible reçoit automatiquement l’effet barrage 1 par compagnon (3 Companions supportant le chevalier infligent ainsi l’effet barrage 3). De plus, les Companions infligent à la cible 1D6 points de dégâts ou de violence chacun (sans bonus) sans devoir effectuer de jet de dés pour toucher. On considère cependant que lorsqu’ils effectuent cette action de support, leur défense tombe à 0. Une seule cible à la fois peut subir cette action de support.
            </span>
        </div>

        <div class="recon description">
            <span class="N1" data-i18n="druid-companion-recon-description-niveau-1">
                Toutes les actions d’observation, de vigilance ou de fouille menées par le chevalier reçoivent 1 dé supplémentaire par compagnon effectuant le support. Le chevalier peut observer, entendre, sentir et toucher directement depuis un des compagnons (au choix).
            </span>
            <span class="N2" data-i18n="druid-companion-recon-description-niveau-2">
                Toutes les actions d’observation, de vigilance ou de fouille menées par le chevalier reçoivent 2 dé supplémentaire par compagnon effectuant le support. Le chevalier peut observer, entendre, sentir et toucher directement depuis un des compagnons (au choix).
            </span>
            <span class="N3" data-i18n="druid-companion-recon-description-niveau-3">
                Toutes les actions d’observation, de vigilance ou de fouille menées par le chevalier reçoivent 3 dé supplémentaire par compagnon effectuant le support. Le chevalier peut observer, entendre, sentir et toucher directement depuis un des compagnons (au choix).
            </span>
        </div>

        <div class="subMenu">
            <button class="evolutions" type="action" name="act_tabDruidWolf_3" data-i18n="evolutions">Evolutions</button>
        </div>

        <div class="evolutions">
            <input type="hidden" name="attr_druidWolfChairBase" value="2" disabled />
            <input type="hidden" name="attr_druidWolfBeteBase" value="4" disabled />
            <input type="hidden" name="attr_druidWolfMachineBase" value="4" disabled />
            <input type="hidden" name="attr_druidWolfDameBase" value="2" disabled />
            <input type="hidden" name="attr_druidWolfMasqueBase" value="4" disabled />
            
            <div class="aspects">
                <div class="ligneTitre">
                    <span data-i18n="aspects">Aspects</span>
                    <span data-i18n="aspects-exceptionnels">Aspects Exceptionnels</span>
                </div>
                <div class="ligne2">
                    <span data-i18n="chair">Chair</span>

                    <div>
                        <input type="number" name="attr_druidWolfChairEvol" value="0" min="0" />
                    </div>
                    <div>
                        <select name="attr_druidWolfChairAE">
                            <option value="0" selected>0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                        </select>
                    </div>
                </div>
                <div class="ligne2">
                    <span data-i18n="bete">Bête</span>
                    <div>
                        <input type="number" name="attr_druidWolfBeteEvol" value="0" min="0" />
                    </div>
                    <div>
                        <select name="attr_druidWolfBeteAE">
                            <option value="0" selected>0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                        </select>
                    </div>
                </div>
                <div class="ligne2">
                    <span data-i18n="machine">Machine</span>

                    <div>
                        <input type="number" name="attr_druidWolfMachineEvol" value="0" min="0" />
                    </div>
                    <div>
                        <select name="attr_druidWolfMachineAE">
                            <option value="0" selected>0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                        </select>
                    </div>
                </div>
                <div class="ligne2">
                    <span data-i18n="dame">Dame</span>

                    <div>
                        <input type="number" name="attr_druidWolfDameEvol" value="0" min="0" />
                    </div>
                    <div>
                        <select name="attr_druidWolfDameAE">
                            <option value="0" selected>0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                        </select>
                    </div>
                </div>
                <div class="ligne2">
                    <span data-i18n="masque">Masque</span>

                    <div>
                        <input type="number" name="attr_druidWolfMasqueEvol" value="0" min="0" />
                    </div>
                    <div>
                        <select name="attr_druidWolfMasqueAE">
                            <option value="0" selected>0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="companions cLabor">
                <div class="tCompanions">
                    <h2 data-i18n="druid-companion-labor">Labor</h2>
                    <select name="attr_DWolfLaborNiveau">
                        <option value="1" data-i18n="druid-companion-niveau-1" selected>Niveau 1</option>
                        <option value="2" data-i18n="druid-companion-niveau-2">Niveau 2</option>
                        <option value="3" data-i18n="druid-companion-niveau-3">Niveau 3</option>
                    </select>
                </div>

                <span class="N1" data-i18n="druid-companion-labor-description-niveau-1">
                    Les actions du chevalier visant à porter de lourdes charges, à déplacer ou lever des poids reçoivent 1 dé par compagnon effectuant l’action de support. Chaque compagnon peut porter à lui seul 150 kg et peut donc transporter des choses pour le chevalier.
                </span>
                <span class="N2" data-i18n="druid-companion-labor-description-niveau-2">
                    Les actions du chevalier visant à porter de lourdes charges, à déplacer ou lever des poids reçoivent 2 dé par compagnon effectuant l’action de support. Chaque compagnon peut porter à lui seul 150 kg et peut donc transporter des choses pour le chevalier.
                </span>
                <span class="N3" data-i18n="druid-companion-labor-description-niveau-3">
                    Les actions du chevalier visant à porter de lourdes charges, à déplacer ou lever des poids reçoivent 3 dés par compagnon effectuant l’action de support. Chaque compagnon peut porter à lui seul 150 kg et peut donc transporter des choses pour le chevalier.
                </span>
            </div>
            
            <div class="companions cMedik mT">
                <div class="tCompanions">
                    <h2 data-i18n="druid-companion-medik">Medik</h2>
                    <select name="attr_DWolfMedicNiveau">
                        <option value="1" data-i18n="druid-companion-niveau-1" selected>Niveau 1</option>
                        <option value="2" data-i18n="druid-companion-niveau-2">Niveau 2</option>
                        <option value="3" data-i18n="druid-companion-niveau-3">Niveau 3</option>
                    </select>
                </div>

                <span class="N1" data-i18n="druid-companion-medik-description-niveau-1">
                    Les actions du chevalier visant à soigner, à faire des recherches biologiques ou à reconnaitre un élément médical ou biologique reçoivent 1 dé supplémentaire par compagnon effectuant un support. Si le chevalier soigne un allié, celui-ci récupère 2 PS supplémentaires par compagnon effectuant un support.
                </span>
                <span class="N2" data-i18n="druid-companion-medik-description-niveau-2">
                    Les actions du chevalier visant à soigner, à faire des recherches biologiques ou à reconnaitre un élément médical ou biologique reçoivent 2 dés supplémentaire par compagnon effectuant un support. Si le chevalier soigne un allié, celui-ci récupère 2 PS supplémentaires par compagnon effectuant un support.
                </span>
                <span class="N3" data-i18n="druid-companion-medik-description-niveau-3">
                    Les actions du chevalier visant à soigner, à faire des recherches biologiques ou à reconnaitre un élément médical ou biologique reçoivent 3 dés supplémentaire par compagnon effectuant un support. Si le chevalier soigne un allié, celui-ci récupère 2 PS supplémentaires par compagnon effectuant un support.
                </span>
            </div>
            
            <div class="companions cTech mT">
                <div class="tCompanions">
                    <h2 data-i18n="druid-companion-tech">Tech</h2>
                    <select name="attr_DWolfTechNiveau">
                        <option value="1" data-i18n="druid-companion-niveau-1" selected>Niveau 1</option>
                        <option value="2" data-i18n="druid-companion-niveau-2">Niveau 2</option>
                        <option value="3" data-i18n="druid-companion-niveau-3">Niveau 3</option>
                    </select>
                </div>

                <span class="N1" data-i18n="druid-companion-tech-description-niveau-1">
                    Les actions du chevalier visant à réparer un objet, un véhicule, un compagnon ou une méta-armure, à analyser un élément informatique ou électronique reçoivent 1 dé supplémentaire par compagnon effectuant un support. Le chevalier peut effectuer les réparations ou les analyses directement depuis un compagnon. Si le chevalier tente de réparer quelque chose (méta-armure, compagnon, véhicule) à l’aide de ses compagnons, les PA que la cible récupère sont augmentés de 3 par compagnon effectuant l’action de support.
                </span>
                <span class="N2" data-i18n="druid-companion-tech-description-niveau-2">
                    Les actions du chevalier visant à réparer un objet, un véhicule, un compagnon ou une méta-armure, à analyser un élément informatique ou électronique reçoivent 2 dés supplémentaire par compagnon effectuant un support. Le chevalier peut effectuer les réparations ou les analyses directement depuis un compagnon. Si le chevalier tente de réparer quelque chose (méta-armure, compagnon, véhicule) à l’aide de ses compagnons, les PA que la cible récupère sont augmentés de 3 par compagnon effectuant l’action de support.
                </span>
                <span class="N3" data-i18n="druid-companion-tech-description-niveau-3">
                    Les actions du chevalier visant à réparer un objet, un véhicule, un compagnon ou une méta-armure, à analyser un élément informatique ou électronique reçoivent 3 dés supplémentaire par compagnon effectuant un support. Le chevalier peut effectuer les réparations ou les analyses directement depuis un compagnon. Si le chevalier tente de réparer quelque chose (méta-armure, compagnon, véhicule) à l’aide de ses compagnons, les PA que la cible récupère sont augmentés de 3 par compagnon effectuant l’action de support.
                </span>
            </div>
            
            <div class="companions cFighter mT">
                <div class="tCompanions">
                    <h2 data-i18n="druid-companion-fighter">Fighter</h2>
                    <select name="attr_DWolfFighterNiveau">
                        <option value="1" data-i18n="druid-companion-niveau-1" selected>Niveau 1</option>
                        <option value="2" data-i18n="druid-companion-niveau-2">Niveau 2</option>
                        <option value="3" data-i18n="druid-companion-niveau-3">Niveau 3</option>
                    </select>
                </div>

                <span class="N1" data-i18n="druid-companion-fighter-description-niveau-1">
                    Les actions de combat du chevalier contre un ennemi désigné aux compagnons reçoivent 1 dé supplémentaire par compagnon effectuant un support. La cible du chevalier doit être à portée courte et doit pouvoir être attaquée au contact. Si ces deux conditions sont respectées, la cible reçoit automatiquement l’effet barrage 1 par compagnon (3 compagnons supportant le chevalier infligent ainsi l’effet barrage 3). De plus, les compagnons infligent à la cible 1D6 points de dégâts ou de violence chacun (sans bonus) sans devoir effectuer de jet de dés pour toucher. On considère cependant que lorsqu’ils effectuent cette action de support, leur défense tombe à 0. Une seule cible à la fois peut subir cette action de support.
                </span>
                <span class="N2" data-i18n="druid-companion-fighter-description-niveau-2">
                    Les actions de combat du chevalier contre un ennemi désigné aux compagnons reçoivent 2 dés supplémentaire par compagnon effectuant un support. La cible du chevalier doit être à portée courte et doit pouvoir être attaquée au contact. Si ces deux conditions sont respectées, la cible reçoit automatiquement l’effet barrage 1 par compagnon (3 compagnons supportant le chevalier infligent ainsi l’effet barrage 3). De plus, les compagnons infligent à la cible 1D6 points de dégâts ou de violence chacun (sans bonus) sans devoir effectuer de jet de dés pour toucher. On considère cependant que lorsqu’ils effectuent cette action de support, leur défense tombe à 0. Une seule cible à la fois peut subir cette action de support.
                </span>
                <span class="N3" data-i18n="druid-companion-fighter-description-niveau-3">
                    Les actions de combat du chevalier contre un ennemi désigné aux compagnons reçoivent 3 dés supplémentaire par compagnon effectuant un support. La cible du chevalier doit être à portée courte et doit pouvoir être attaquée au contact. Si ces deux conditions sont respectées, la cible reçoit automatiquement l’effet barrage 1 par compagnon (3 compagnons supportant le chevalier infligent ainsi l’effet barrage 3). De plus, les compagnons infligent à la cible 1D6 points de dégâts ou de violence chacun (sans bonus) sans devoir effectuer de jet de dés pour toucher. On considère cependant que lorsqu’ils effectuent cette action de support, leur défense tombe à 0. Une seule cible à la fois peut subir cette action de support.
                </span>
            </div>
            
            <div class="companions cRecon mT">
                <div class="tCompanions">
                    <h2 data-i18n="druid-companion-recon">Recon</h2>
                    <select name="attr_DWolfReconNiveau">
                        <option value="1" data-i18n="druid-companion-niveau-1" selected>Niveau 1</option>
                        <option value="2" data-i18n="druid-companion-niveau-2">Niveau 2</option>
                        <option value="3" data-i18n="druid-companion-niveau-3">Niveau 3</option>
                    </select>
                </div>

                <span class="N1" data-i18n="druid-companion-recon-description-niveau-1">
                    Toutes les actions d’observation, de vigilance ou de fouille menées par le chevalier reçoivent 1 dé supplémentaire par compagnon effectuant le support. Le chevalier peut observer, entendre, sentir et toucher directement depuis un des compagnons (au choix).
                </span>
                <span class="N2" data-i18n="druid-companion-recon-description-niveau-2">
                    Toutes les actions d’observation, de vigilance ou de fouille menées par le chevalier reçoivent 2 dés supplémentaire par compagnon effectuant le support. Le chevalier peut observer, entendre, sentir et toucher directement depuis un des compagnons (au choix).
                </span>
                <span class="N3" data-i18n="druid-companion-recon-description-niveau-3">
                    Toutes les actions d’observation, de vigilance ou de fouille menées par le chevalier reçoivent 3 dés supplémentaire par compagnon effectuant le support. Le chevalier peut observer, entendre, sentir et toucher directement depuis un des compagnons (au choix).
                </span>
            </div>
        </div>
    </div>

    <div class="fichePJ druid DCCrow">
        <input class="subMenu" type="hidden" name="attr_tabDruidCrow" value="0" />

        <h1 class="titre" data-i18n="druid-companion-crow">Crow</h1>
        <div class="col4">
            <h1 class="titre" data-i18n="aspects">Aspects</h1>
            <div class="ligne aspect">
                <span data-i18n="chair">Chair</span>

                <div class="blockR">
                    <input type="number" name="attr_druidCrowChairTot" value="@{druidCrowChairBase}+@{druidCrowChairEvol}" disabled />
                    <button class="rollDice" name="act_druidCrowChairRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-crow}}} {{special1=@{name}}}"></button>
                </div>			
            </div>
            <div class="ligne aspect">
                <span data-i18n="bete">Bête</span>

                <div class="blockR">
                    <input type="number" name="attr_druidCrowBeteTot" value="@{druidCrowBeteBase}+@{druidCrowBeteEvol}" disabled />
                    <button class="rollDice" name="act_druidCrowBeteRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-crow}}} {{special1=@{name}}}"></button>		
                </div>		
            </div>
            <div class="ligne aspect">
                <span data-i18n="machine">Machine</span>

                <div class="blockR">
                    <input type="number" name="attr_druidCrowMachineTot" value="@{druidCrowMachineBase}+@{druidCrowMachineEvol}" disabled />
                    <button class="rollDice" name="act_druidCrowMachineRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-crow}}} {{special1=@{name}}}"></button>
                </div>
            </div>
            <div class="ligne aspect">
                <span data-i18n="dame">Dame</span>

                <div class="blockR">
                    <input type="number" name="attr_druidCrowDameTot" value="@{druidCrowDameBase}+@{druidCrowDameEvol}" disabled />
                    <button class="rollDice" name="act_druidCrowDameRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-crow}}} {{special1=@{name}}}"></button>
                </div>
            </div>
            <div class="ligne aspect">
                <span data-i18n="masque">Masque</span>

                <div class="blockR">
                    <input type="number" name="attr_druidCrowMasqueTot" value="@{druidCrowMasqueBase}+@{druidCrowMasqueEvol}" disabled />
                    <button class="rollDice" name="act_druidCrowMasqueRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-crow}}} {{special1=@{name}}}"></button>
                </div>
            </div>
        </div>

        <div class="col4BL">
            <h1 class="titre" data-i18n="valeurs-derivees">Valeurs Dérivées</h1>
            
            <div class="ligne defense">
                <span data-i18n="defense">Défense</span>
                
                <div class="blockR">
                    <input type="number" name="attr_druidCrowDefenseTot" value="2" disabled />
                </div>
            </div>
            <div class="ligne reaction">
                <span data-i18n="reaction">Réaction</span>

                <div class="blockR">
                    <input type="number" name="attr_druidCrowReactionTot" value="2" disabled />
                </div>
            </div>
            <div class="ligne initiative">
                <span data-i18n="initiative">Initiative</span>

                <div class="blockR">
                    <input type="number" name="attr_druidCrowInitiativeTot" value="1" disabled />
                    <button class="rollDice" type="action" name="act_druidCrowInitiativeRoll" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-crow}}} {{special1=@{name}}}"></button>
                </div>
            </div>
            <div class="ligne cohesion">
                <span data-i18n="cohesion">Cohésion</span>

                <div class="blockR">
                    <input type="number" name="attr_druidCrowCoAct" value="50" /> 
                    <b>/</b>
                    <input type="number" name="attr_druidCrowCoTot" value="50*@{druidNiveauCrow}" disabled />
                </div>
            </div>
            <div class="ligne debordement">
                <span data-i18n="debordement">Débordement</span>

                <div class="blockR">
                    <input type="number" name="attr_druidCrowDebordementTot" value="2*@{druidNiveauCrow}" disabled />
                </div>
            </div>
        </div>

        <div class="col4BL">
            <h1 class="titre" data-i18n="champ-de-force">Champ de Force</h1>
            <div class="ligne CDF">
                <input type="number" name="attr_druidCrowCDFTot" value="2*@{druidNiveauCrow}" disabled />
            </div>

            <h1 class="titre" data-i18n="debordement">Débordement</h1>
            <div class="ligne tourCombat">
                <span data-i18n="tours-de-combat">Tours de combat</span>
                
                <div class="blockR">
                    <input type="number" name="attr_druidCrowTAttaque" value="1" min="1" />
                    <button class="rollDice" type="action" name="act_druidCrowAttaque" value="@{jetGM} &{template:combat} {{Nom=^{druid-companion-crow}}} {{special1=@{name}}}"></button>
                </div>
            </div>
        </div>

        <h1 class="titre" data-i18n="specificites">Spécificités</h1>
        <span class="specificites" data-i18n="druid-companion-crow-specificite">La bande est équipée d'un module de vol niveau 3 constamment activé qui ne coûte aucune énergie.
            <br/>
            Les points de dégâts qui lui sont infligés lui font perdre de la cohésion.
        </span>

        <div class="subMenu">
            <button class="evolutions" type="action" name="act_tabDruidCrow_3" data-i18n="evolutions">Evolutions</button>
        </div>

        <div class="evolutions">
            <input type="hidden" name="attr_druidCrowChairBase" value="6" disabled />
            <input type="hidden" name="attr_druidCrowBeteBase" value="4" disabled />
            <input type="hidden" name="attr_druidCrowMachineBase" value="4" disabled />
            <input type="hidden" name="attr_druidCrowDameBase" value="0" disabled />
            <input type="hidden" name="attr_druidCrowMasqueBase" value="6" disabled />

            <div class="aspects">
                <div class="ligneTitre">
                    <span></span>
                    <span data-i18n="aspects">Aspects</span>
                </div>
                <label class="ligne1">
                    <span data-i18n="chair">Chair</span>

                    <div>
                        <input type="number" name="attr_druidCrowChairEvol" value="0" min="0" />
                    </div>
                </label>
                <label class="ligne1">
                    <span data-i18n="bete">Bête</span>

                    <div>
                        <input type="number" name="attr_druidCrowBeteEvol" value="0" min="0" />
                    </div>
                </label>
                <label class="ligne1">
                    <span data-i18n="machine">Machine</span>

                    <div>
                        <input type="number" name="attr_druidCrowMachineEvol" value="0" min="0" />
                    </div>
                </label>
                <label class="ligne1">
                    <span data-i18n="dame">Dame</span>

                    <div>
                        <input type="number" name="attr_druidCrowDameEvol" value="0" min="0" />
                    </div>
                </label>
                <label class="ligne1">
                    <span data-i18n="masque">Masque</span>

                    <div>
                        <input type="number" name="attr_druidCrowMasqueEvol" value="0" min="0" />
                    </div>
                </label>
            </div>
        </div>
    </div>

    <div class="fichePJ ranger rangerLongbow">
        <input class="styleCombat" type="hidden" name="attr_styleCombat" value="standard" />
        <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0" />
        <input class="PG50" type="hidden" name="attr_ranger50PG" value="0" />
        <input class="PG50_2" type="hidden" name="attr_ranger50PG2" value="0" />
        <input class="PG100" type="hidden" name="attr_ranger100PG" value="0" />
        <input class="subMenu" type="hidden" name="attr_armeDistOptionsRanger" value="0" />

        <div class="titre">
            <button type="action" class="bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
            <button type="action" class="bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>

            <h1 class="titre">
                <span data-i18n="ranger-fusil-longbow">Fusil Longbow</span>
                <span name="attr_longbowEnergie" class="depense"></span>
            </h1>

            <button class="rollDice" type="action" name="act_distanceRangerLongbow" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=^{ranger-fusil-longbow}}}"></button>
        </div>
        <div class="col5 rangerDegats">
            <span data-i18n="degats">Dégâts</span>
            <select class="notPG50_2" name="attr_rangerArmeDegat">
                <option value="3" selected>3D6</option>
                <option value="4">4D6</option>
                <option value="5">5D6</option>
                <option value="6">6D6</option>
                <option value="7">7D6</option>
                <option value="8">8D6</option>
                <option value="9">9D6</option>
            </select>
            <select class="PG50_2" name="attr_rangerArmeDegatEvol">
                <option value="5" selected>5D6</option>
                <option value="6">6D6</option>
                <option value="7">7D6</option>
                <option value="8">8D6</option>
                <option value="9">9D6</option>
                <option value="10">10D6</option>
                <option value="11">11D6</option>
                <option value="12">12D6</option>
                <option value="13">13D6</option>
                <option value="14">14D6</option>
            </select>
        </div>
        <div class="col5BL rangerViolence">
            <span class="titreBis" data-i18n="violence">Violence</span>
            <select class="notPG50_2" name="attr_rangerArmeViolence">
                <option value="1" selected>1D6</option>
                <option value="2">2D6</option>
                <option value="3">3D6</option>
                <option value="4">4D6</option>
                <option value="5">5D6</option>
                <option value="6">6D6</option>
                <option value="7">7D6</option>
            </select>
            <select class="PG50_2" name="attr_rangerArmeViolenceEvol">
                <option value="3" selected>3D6</option>
                <option value="4">4D6</option>
                <option value="5">5D6</option>
                <option value="6">6D6</option>
                <option value="7">7D6</option>
                <option value="8">8D6</option>
                <option value="9">9D6</option>
                <option value="10">10D6</option>
                <option value="11">11D6</option>
                <option value="12">12D6</option>
            </select>
        </div>
        <div class="col5BL rangerPortee">
            <span class="titreBis" data-i18n="portee">Portée</span>
            <select name="attr_rangerArmePortee">
                <option value="^{portee-moyenne}" data-i18n="portee-moyenne">Moyenne</option>
                <option value="^{portee-longue}" data-i18n="portee-longue">Longue</option>
                <option value="^{portee-lointaine}" data-i18n="portee-lointaine">Lointaine</option>
            </select>
        </div>
        <div class="col5LargeBL rangerJet">            
            <span data-i18n="jet">Jet</span>
            <select name="attr_caracteristique1">
                <option value="0" selected></option>
                <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                <option value="@{force}" data-i18n="force">Force</option>
                <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                <option value="@{combat}" data-i18n="combat">Combat</option>
                <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                <option value="@{tir}" data-i18n="tir">Tir</option>
                <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                <option value="@{technique}" data-i18n="technique">Technique</option>
                <option value="@{aura}" data-i18n="aura">Aura</option>
                <option value="@{parole}" data-i18n="parole">Parole</option>
                <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                <option value="@{perception}" data-i18n="perception">Perception</option>
            </select>
            <select name="attr_caracteristique2">
                <option value="0" selected></option>
                <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                <option value="@{force}" data-i18n="force">Force</option>
                <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                <option value="@{combat}" data-i18n="combat">Combat</option>
                <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                <option value="@{tir}" data-i18n="tir">Tir</option>
                <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                <option value="@{technique}" data-i18n="technique">Technique</option>
                <option value="@{aura}" data-i18n="aura">Aura</option>
                <option value="@{parole}" data-i18n="parole">Parole</option>
                <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                <option value="@{perception}" data-i18n="perception">Perception</option>
            </select>
        </div>        
        
        <div class="bonus">
            <label class="pilonnage">
                <span>Pilonnage, tir n°</span>
                <input type="number" name="attr_pilonnageRanger" value="1" min="1" max="7" />
            </label>
            <label class="pilonnage">
                <span data-i18n="pilonnageDegatsOuViolence">Pilonnage, dégâts ou violence ?</span>
                <select name="attr_pilonnageRangerType">
                    <option value="degats" selected>Dégâts</option>
                    <option value="violence">Violence</option>
                </select>
            </label>
            <div class="bonusCarac">
                <select name="attr_caracteristique3">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
                <select name="attr_caracteristique4">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
            </div>
        </div>
        <div class="eCol3">
            <h1 class="titre notPG100" data-i18n="ranger-effets-2PE">Effets à 2PE</h1>
            <h1 class="titre PG100" data-i18n="ranger-effets-1PE">Effets à 1PE</h1>

            <div class="rangerBEffet">
                <div class="double">
                    <label class="fakeButton">
                        <input type="checkbox" name="attr_rangerChoc" value="{{choc=^{choc} @{rangerChocValue}}}" />
                        <span data-i18n-title="choc" title="Choc"></span>
                    </label>
                    
                    <input type="number" name="attr_rangerChocValue" class="center" value="1" disabled />
                </div>
                
                <div class="double">
                    <label class="fakeButton">
                        <input type="checkbox" name="attr_rangerDegatContinue" value="{{degatContinus=^{degats-continus} @{rangerDegatContinueValue} ([[1D6]] ^{tours})}}" />
                        <span data-i18n-title="degats-continus" title="Dégâts Continus"></span>
                    </label>
                
                    <input type="number" name="attr_rangerDegatContinueValue" class="center" value="3" disabled />
                </div>
                
                <label class="simple fakeButton">
                    <input type="checkbox" name="attr_rangerDesignation" value="{{designation=Désignation}}" />
                    <span data-i18n-title="designation" title="Désignation"></span>
                </label>
                
                <label class="simple fakeButton">
                    <input type="checkbox" name="attr_rangerSilencieux" value="{{silencieux=Silencieux}} {{silencieuxD=[[@{discretion}+@{discrOD}]]}}" />
                    <span data-i18n-title="silencieux" title="Silencieux"></span>
                </label>
                
                <div class="double">
                    <label class="fakeButton">
                        <input type="checkbox" name="attr_rangerPerceArmure" value="{{perceArmure=^{perce-armure} @{rangerPerceArmureValue}}}" />
                        <span data-i18n-title="perce-armure" title="Perce Armure"></span>
                    </label>
                
                    <input type="number" name="attr_rangerPerceArmureValue" value="40" disabled />
                </div>
                
                <label class="simple fakeButton">
                    <input type="checkbox" name="attr_rangerUltraViolence" value="{{ultraviolence=[[2D6]]}}" />
                    <span data-i18n-title="ultraviolence" title="Ultraviolence"></span>
                </label>    
            </div> 
        </div>
            
        <div class="eCol3BL">
            <h1 class="titre notPG100" data-i18n="ranger-effets-3PE">Effets à 3PE</h1>
            <h1 class="titre PG100" data-i18n="ranger-effets-1PE">Effets à 1PE</h1>
            
            <div class="rangerBEffet">
                <label class="simple fakeButton">
                    <input type="checkbox" name="attr_rangerAntiVehicule" value="{{antiVehicule=Anti Véhicule}}" />
                    <span data-i18n-title="anti-vehicule" title="Anti Véhicule"></span>
                </label>
                
                <label class="simple fakeButton">
                    <input type="checkbox" name="attr_rangerArtillerie" value="{{artillerie=Artillerie}}" />
                    <span data-i18n-title="artillerie" title="Artillerie"></span>
                </label>
                
                <div class="double">
                    <label class="fakeButton">
                        <input type="checkbox" name="attr_rangerDispersion" value="{{dispersion=^{dispersion} @{rangerDispersionValue}}}"  />
                        <span data-i18n-title="dispersion" title="Dispersion"></span>
                    </label>
                
                    <input type="number" name="attr_rangerDispersionValue" value="3" disabled />
                </div>
                
                <div class="double">
                    <label class="fakeButton">
                        <input type="checkbox" name="attr_rangerLumiere" value="{{lumiere=^{lumiere} @{rangerLumiereValue}}}" />
                        <span data-i18n-title="lumiere" title="Lumière"></span>
                    </label>
                
                    <input type="number" name="attr_rangerLumiereValue" value="4" disabled />
                </div>
                
                <div class="double">
                    <label class="fakeButton">
                        <input type="checkbox" name="attr_rangerPenetrant" value="{{penetrant=^{penetrant} @{rangerPenetrantValue}}}" />
                        <span data-i18n-title="penetrant" title="Pénétrant"></span>
                    </label>
                
                    <input type="number" name="attr_rangerPenetrantValue" value="6" disabled />
                </div>
                
                <div class="double">
                    <label class="fakeButton">
                        <input type="checkbox" name="attr_rangerPerceArmure60" value="{{perceArmure=^{perce-armure} @{rangerPerceArmure60Value}}}" />
                        <span data-i18n-title="perce-armure" title="Perce Armure"></span>
                    </label>
                
                    <input type="number" name="attr_rangerPerceArmure60Value" value="60" disabled />
                </div>
            </div>
        </div>
            
        <div class="eCol3BL PG50">
            <h1 class="titre notPG100" data-i18n="ranger-effets-6PE">Effets à 6PE</h1>
            <h1 class="titre PG100" data-i18n="ranger-effets-4PE">Effets à 4PE</h1>

            <div class="rangerBEffet">
                <label class="simple fakeButton">
                    <input type="checkbox" name="attr_rangerAntiAnatheme" value="{{antiAnathème=Anti Anathème}}" />
                    <span data-i18n-title="anti-anatheme" title="Anti Anathème"></span>
                </label>
                
                <label class="simple fakeButton">
                    <input type="checkbox" name="attr_rangerDemoralisant" value="{{demoralisant=Démoralisant}}" />
                    <span  data-i18n-title="demoralisant"title="Démoralisant"></span>
                </label>
                
                <label class="simple fakeButton">
                    <input type="checkbox" name="attr_rangerEnChaine" value="{{enChaine=En Chaîne}}" />
                    <span data-i18n-title="en-chaine" title="En Chaîne"></span>
                </label>
                
                <label class="simple fakeButton">
                    <input type="checkbox" name="attr_rangerFureur" value="{{fureur=[[4D6]]}}" />
                    <span data-i18n-title="fureur" title="Fureur"></span>
                </label>
                
                <label class="simple fakeButton">
                    <input type="checkbox" name="attr_rangerIgnoreArmure" value="{{ignoreArmure=Ignore Armure}}" />
                    <span data-i18n-title="ignore-armure" title="Ignore Armure"></span>
                </label>
                
                <div class="double">
                    <label class="fakeButton">
                        <input type="checkbox" name="attr_rangerPenetrant10" value="{{penetrant=^{penetrant} @{rangerPenetrant10Value}}}" />
                        <span data-i18n-title="penetrant" title="Pénétrant"></span>
                    </label>
                
                    <input type="number" name="attr_rangerPenetrant10Value" value="10" disabled />
                </div>
            </div>
        </div>
        <div class="subMenu">
            <button class="ameliorationsArmes" type="action" name="act_armeDistOptionsRanger-1" data-i18n="ameliorations-d'armes">Améliorations d'armes</button>
            <button class="special BL" type="action" name="act_armeDistOptionsRanger-2" data-i18n="special">Spécial</button>
        </div>
        
        <div class="ameliorationsArmes">
            <label class="simple fakeButton">
                <input type="checkbox" name="attr_chargeurGrappesRanger" value="1" />
                <span data-i18n-title="balles-grappes" title="Balles grappes"></span>
            </label>
            <label class="simple fakeButton">
                <input type="checkbox" name="attr_canonLongRanger" value="{{canonLongM=1}} {{canonLongC=Canon Long (Portée Courte : +3 Difficulté)}}" />
                <span data-i18n-title="canon-long" title="Canon Long"></span>
            </label>
            <label class="simple fakeButton">
                <input type="checkbox" name="attr_canonRaccourciRanger" value="{{canonRaccourci=Canon Raccourci (Portée Courte : Dispersion 3 / Sinon : +3 Difficulté)}}" />
                <span data-i18n-title="canon-raccourci" title="Canon Raccourci"></span>
            </label>
            <label class="simple fakeButton">
                <input type="checkbox" name="attr_chambreDoubleRanger" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                <span data-i18n-title="chambre-double" title="Chambre Double"></span>
            </label>
            <label class="simple fakeButton">
                <input type="checkbox" name="attr_interfaceGuidageRanger" value="3" />
                <span data-i18n-title="interface-guidage" title="Interface de guidage"></span>
            </label>
            <label class="simple fakeButton">
                <input type="checkbox" name="attr_lunetteIntelligenteRanger" value="{{lunetteIntelligente=Lunette Intelligente (+1 Portée)}}" />
                <span data-i18n-title="lunette-intelligente" title="Lunette Intelligente"></span>
            </label>
            <label class="simple fakeButton">
                <input type="checkbox" name="attr_munitionsDroneRanger" value="{{munitionsDrone=3}}" />
                <span data-i18n-title="munitions-drones" title="Munitions Drones"></span>
            </label>
            <label class="simple fakeButton">
                <input type="checkbox" name="attr_chargeurExplosivesRanger" value="1" />
                <span data-i18n-title="munitions-explosives" title="Munitions Explosives"></span>
            </label>
            <label class="simple fakeButton">
                <input type="checkbox" name="attr_munitionsIEMRanger" value="1" />
                <span data-i18n-title="munitions-iem" title="Munitions IEM"></span>
            </label>
            <label class="simple fakeButton">
                <input type="checkbox" name="attr_munitionsNonLetalesRanger" value="2" />
                <span data-i18n-title="munitions-n-letales" title="Munitions N. Létales"></span>
            </label>
            <label class="simple fakeButton">
                <input type="checkbox" name="attr_munitionsSubsoniquesRanger" value="{{munitionsSubsoniques=Munitions Subsoniques (Silencieux)}} {{silencieuxD=[[@{discretion}+@{discrOD}]]}}" />
                <span data-i18n-title="munitions-subsoniques" title="Munitions Subsoniques"></span>
            </label>
            <label class="simple fakeButton">
                <input type="checkbox" name="attr_pointeurLaserRanger" value="{{pointeurLaser=1}}" />
                <span data-i18n-title="pointeur-laser" title="Pointeur Laser"></span>
            </label>
            <label class="simple fakeButton">
                <input type="checkbox" name="attr_protectionArmeRanger" value="{{protectionArme=Protection d'Arme (Reaction +2)}}" />
                <span data-i18n-title="protection-d'arme" title="Protection d'Arme"></span>
            </label>
            <label class="simple fakeButton">
                <input type="checkbox" name="attr_revetementOmegaRanger" value="2" />
                <span data-i18n-title="revetement-omega" title="Revêtement Omega"></span>
            </label>
            <label class="simple fakeButton">
                <input type="checkbox" name="attr_structureElementRanger" value="{{structureElement=Structure Alpha}}" />
                <span data-i18n-title="structure-alpha" title="Structure Alpha"></span>
            </label>
        </div>

        <div class="special">
            <div class="triple">
                <input type="hidden" name="attr_bDDiversTotalRanger" value="0" />

                <label class="fakeButton">
                    <input type="checkbox" name="attr_bDDiversTotalRanger" value="{{BDDivers=[[@{bDDiversD6}D6+@{bDDiversFixe}]]}} " />
                    <span data-i18n-title="bonus-degats" title="Bonus aux dégâts"></span>
                </label>
                <div>
                    <input class="L" type="number" name="attr_bDDiversD6" class="center" value="0" />
                    <span>D6+</span>
                    <input class="R" type="number" name="attr_bDDiversFixe" class="center" value="0" />
                </div>
            </div>
            <div class="triple">
                <input type="hidden" name="attr_bVDiversTotalRanger" value="0" />

                <label class="fakeButton">
                    <input type="checkbox" name="attr_bVDiversTotalRanger" value="{{BVDivers=[[@{bVDiversD6}D6+@{bVDiversFixe}]]}} " />
                    <span data-i18n-title="bonus-violence" title="Bonus à la violence"></span>
                </label>
                <div>
                    <input class="L" type="number" name="attr_bVDiversD6" class="center" value="0" />
                    <span>D6+</span>
                    <input class="R" type="number" name="attr_bVDiversFixe" class="center" value="0" />
                </div>
            </div>
        </div>
    </div>

    <div class="MAL">
        <div class="MALDruidCompanions">
            <input class="druidCompanions" type="hidden" name="attr_MALChoixCompanons" value="aucun" />

            <h1 class="titre" data-i18n="meta-armure-legende">Méta-armure de légende</h1>
            <div class="fichePJ DCLion">
                <input class="subMenu" type="hidden" name="attr_MALTabDruidLion" value="0" />

                <h1 class="titre" data-i18n="druid-companion-lion">Lion</h1>
                
                <div class="col4">
                    <h1 class="titre" data-i18n="aspects">Aspects</h1>
                    
                    <div class="ligne aspect">
                        <span data-i18n="chair">Chair</span>

                        <div class="blockR">
                            <input type="number" name="attr_MALDruidLionChairTot" value="@{MALDruidLionChairBase}+@{MALDruidLionChairEvol}" disabled />
                            <button class="rollDice" name="act_MALDruidLionChairRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}}}"></button>
                        </div>
                    </div>

                    <div class="ligne aspect">
                        <span data-i18n="bete">Bête</span>

                        <div class="blockR">
                            <input type="number" name="attr_MALDruidLionBeteTot" value="@{MALDruidLionBeteBase}+@{MALDruidLionBeteEvol}" disabled />
                            <button class="rollDice" name="act_MALDruidLionBeteRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}}"></button>
                        </div>
                    </div>

                    <div class="ligne aspect">
                        <span data-i18n="machine">Machine</span>

                        <div class="blockR">
                            <input type="number" name="attr_MALDruidLionMachineTot" value="@{MALDruidLionMachineBase}+@{MALDruidLionMachineEvol}" disabled />
                            <button class="rollDice" name="act_MALDruidLionMachineRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}}"></button>
                        </div>
                    </div>

                    <div class="ligne aspect">
                        <span data-i18n="dame">Dame</span>

                        <div class="blockR">
                            <input type="number" name="attr_MALDruidLionDameTot" value="@{MALDruidLionDameBase}+@{MALDruidLionDameEvol}" disabled />
                            <button class="rollDice" name="act_MALDruidLionDameRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}}"></button>
                        </div>
                    </div>

                    <div class="ligne aspect">
                        <span data-i18n="masque">Masque</span>

                        <div class="blockR">
                            <input type="number" name="attr_MALDruidLionMasqueTot" value="@{MALDruidLionMasqueBase}+@{MALDruidLionMasqueEvol}" disabled />
                            <button class="rollDice" name="act_MALDruidLionMasqueRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}}"></button>
                        </div>
                    </div>
                </div>

                <div class="col4BL">
                    <h1 class="titre" data-i18n="aspects-exceptionnels">Aspects Exceptionnels</h1>

                    <div class="ligne AE">
                        <input type="hidden" name="attr_MALDruidLionChairAE" value="1"/>

                        <span class="mineur" data-i18n="mineur">Mineur</span>
                        <span class="majeur" data-i18n="majeur">Majeur</span>
                        <span class="value" name="attr_MALDruidLionChairAE">1</span>
                    </div>

                    <div class="ligne AE">
                        <input type="hidden" name="attr_MALDruidLionBeteAE" value="1"/>

                        <span class="mineur" data-i18n="mineur">Mineur</span>
                        <span class="majeur" data-i18n="majeur">Majeur</span>
                        <span class="value" name="attr_MALDuidLionBeteAE">1</span>
                    </div>

                    <div class="ligne AE">
                        <input type="hidden" name="attr_MALDruidLionMachineAE" value="1"/>

                        <span class="mineur" data-i18n="mineur">Mineur</span>
                        <span class="majeur" data-i18n="majeur">Majeur</span>
                        <span class="value" name="attr_MALDruidLionMachineAE" >1</span>
                    </div>

                    <div class="ligne AE">
                        <input type="hidden" name="attr_MALDruidLionDameAE" value="0"/>

                        <span class="mineur" data-i18n="mineur">Mineur</span>
                        <span class="majeur" data-i18n="majeur">Majeur</span>
                        <span class="value" name="attr_MALDruidLionDameAE" >0</span>
                    </div>

                    <div class="ligne AE">
                        <input type="hidden" name="attr_MALDruidLionMasqueAE" value="0"/>

                        <span class="mineur" data-i18n="mineur">Mineur</span>
                        <span class="majeur" data-i18n="majeur">Majeur</span>
                        <span class="value" name="attr_MALDruidLionMasqueAE">0</span>
                    </div>
                </div>

                <div class="col4BL">
                    <h1 class="titre" data-i18n="valeurs-derivees">Valeurs Dérivées</h1>

                    <div class="ligne defense">
                        <span data-i18n="defense">Défense</span>

                        <div class="blockR">
                            <input type="number" name="attr_MALDruidLionDefenseTot" value="@{MALDruidLionDefenseBase}+@{MALDruidLionDefenseEvol}+@{MALDruidLionMasqueAE}" disabled />
                        </div>
                    </div>

                    <div class="ligne reaction">
                        <span data-i18n="reaction">Réaction</span>

                        <div class="blockR">
                            <input type="number" name="attr_MALDruidLionReactionTot" value="@{MALDruidLionReactionBase}+@{MALDruidLionReactionEvol}+@{MALDruidLionMachineAE}" disabled />
                        </div>
                    </div>

                    <div class="ligne initiative">
                        <span data-i18n="initiative">Initiative</span>

                        <div class="blockR">
                            <input type="number" name="attr_MALDruidLionInitiativeTot" value="@{MALDruidLionInitiativeBase}+@{MALDruidLionInitiativeEvol}" disabled />
                            <button class="rollDice" type="action" name="act_MALDruidLionInitiativeRoll" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}}"></button>
                        </div>
                    </div>

                    <div class="ligne armure">
                        <span data-i18n="armure">Armure</span>

                        <div class="blockR">
                            <input type="number" name="attr_MALDruidLionPAAct" value="60" />
                            <b>/</b>
                            <input type="number" name="attr_MALDruidLionPAAct_max" value="@{MALDruidLionPABase}+@{MALDruidLionPAEvol}" disabled />
                        </div>
                    </div>

                    <div class="ligne energie">
                        <span data-i18n="energie">Energie</span>

                        <div class="blockR">
                            <input type="number" name="attr_MALDruidLionPEAct" value="0" />
                            <b>/</b>
                            <input type="number" name="attr_MALDruidLionPEAct_max" value="@{MALDruidEnergieCompanon}" disabled />
                        </div>
                    </div>
                </div>

                <div class="col4BL">
                    <h1 class="titre" data-i18n="champ-de-force">Champ de Force</h1>

                    <div class="ligne CDF">
                        <input type="number" name="attr_MALDruidLionCDFTot" value="@{MALDruidLionCDFBase}+@{MALDruidLionCDFEvol}" disabled />
                    </div>
                </div>

                <div class="subMenu">
                    <button class="armes" type="action" name="act_MALTabDruidLion_1" data-i18n="armes">Armes</button>
                    <button class="BL modules" type="action" name="act_MALTabDruidLion_2" data-i18n="modules">Modules</button>
                    <button class="BL evolutions" type="action" name="act_MALTabDruidLion_3" data-i18n="evolutions">Evolutions</button>
                </div>

                <div class="armes">
                    <div class="ligneTitre">
                        <div class="firstCol">
                            <span data-i18n="arme">Arme</span>
                        </div>
                        
                        <div class="midCol">
                            <span data-i18n="degats">Dégâts</span>
                        </div>
                        <div class="midCol">
                            <span data-i18n="violence">Violence</span>
                        </div>
                        <div class="midCol">
                            <span data-i18n="portee">Portée</span>
                        </div>

                        <div class="lastCol">
                            <span data-i18n="aspect">Aspect</span>
                        </div>
                    </div>

                    <div class="coups">
                        <input class="subMenu" type="hidden" name="attr_MALTabDCoups" value="0" />

                        <div class="ligne">
                            <div class="firstCol aB1Nom">
                                <input type="text" name="attr_MALDruidLionBaseNom" value="Coups" readonly />
                            </div>
    
                            <div class="midCol aB1Degats">
                                <input type="number" name="attr_MALDruidLionBaseDegats" class="nbre" value="1" disabled />
                                <b>D6+</b>
                                <input type="number" name="attr_MALDruidLionBaseDegatsBonus" class="bonus" value="0" disabled />
                            </div>

                            <div class="midCol aB1Violence">
                                <input type="number" name="attr_MALDruidLionBaseViolence" class="nbre" value="1" disabled />
                                <b>D6+</b>
                                <input type="number" name="attr_MALDruidLionBaseViolenceBonus" class="bonus" value="0" disabled />
                            </div>

                            <div class="midCol aB1Portee">
                                <select name="attr_MALDruidLionBasePortee">
                                    <option data-i18n="portee-contact" value="^{portee-contact}" selected>Contact</option>
                                </select>
                            </div>

                            <div class="lastCol aB1Aspect">
                                <select name="attr_MALAspectDruidLionBase">
                                    <option value="druidLionChair" data-i18n="chair">Chair</option>
                                    <option value="druidLionBete" data-i18n="bete">Bête</option>
                                    <option value="druidLionMachine" data-i18n="machine">Machine</option>
                                    <option value="druidLionDame" data-i18n="dame">Dame</option>
                                    <option value="druidLionMasque" data-i18n="masque">Masque</option>
                               </select>
                                <button class="rollDice" type="action" name="act_MALDruidLionArmeBase" value="@{jetGM} &{template:combat} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}} {{special1B=^{coups}}}"></button>
                            </div>
                        </div>
                        <div class="subMenu">
                            <button class="special" type="action" name="act_MALTabDCoups-3" data-i18n="special">Spécial</button>
                        </div>
                        <div class="special">
                            <div class="triple">
                                <input type="hidden" name="attr_MALCoupBDDiversTotal" value="0" />
        
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_MALCoupBDDiversTotal" value="{{BDDivers=[[@{MALBDDiversD6}D6+@{MALBDDiversFixe}]]}} " />
                                    <span data-i18n-title="bonus-degats" title="Bonus aux dégâts"></span>
                                </label>
                                <div>
                                    <input class="L" type="number" name="attr_MALBDDiversD6" class="center" value="0" />
                                    <span>D6+</span>
                                    <input class="R" type="number" name="attr_MALBDDiversFixe" class="center" value="0" />
                                </div>
                            </div>
                            <div class="triple">
                                <input type="hidden" name="attr_MALCoupBVDiversTotal" value="0" />
        
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_MALCoupBVDiversTotal" value="{{BVDivers=[[@{MALBVDiversD6}D6+@{MALBVDiversFixe}]]}} " />
                                    <span data-i18n-title="bonus-violence" title="Bonus à la violence"></span>
                                </label>
                                <div>
                                    <input class="L" type="number" name="attr_MALBVDiversD6" class="center" value="0" />
                                    <span>D6+</span>
                                    <input class="R" type="number" name="attr_MALBVDiversFixe" class="center" value="0" />
                                </div>
                            </div>
                        </div>
                    </div>
                    <fieldset class="repeating_armeMALDruidLion">
                        <input class="subMenu" type="hidden" name="attr_tab" value="0" />

                        <div class="data">
                            <input type="hidden" name="attr_druidLionDegats" value="{{Degats=[[ [[{[[@{degatDruidLion}+@{chargeurExplosives}-@{chargeurGrappes}-@{munitionsIEM}+@{revetementOmega}]], 0}kh1]]D6+@{degatBonusDruidLion}]]}}" />
                                    
                            <input type="hidden" name="attr_druidLionViolence" value="{{Violence=[[ [[{[[@{violenceDruidLion}-@{chargeurExplosives}-@{munitionsIEM}]], 0}kh1]]D6+@{violenceBonusDruidLion}]]}}" />
                            
                            <input type="hidden" name="attr_druidLionEffets" value="@{destructeur} @{fureur} @{leste} @{meurtrier} @{orfevrerie} @{precision} {{tirSecurite=[[@{tirSecurite}]]}} @{ultraViolence} @{antiAnatheme} @{antiVehicule} @{artillerie} @{assistanceAttaque} @{barrage} @{chargeur} @{choc} @{defense} @{deuxMains} @{dispersion} @{degatContinue} @{demoralisant} @{designation} @{enChaine} @{esperance} @{ignoreArmure} @{ignoreCdF} {{lourd=[[@{lourd}]]}} @{lumiere} @{obliteration} @{parasitage} @{penetrant} @{perceArmure} @{reaction} @{silencieux} {{silencieuxD=[[floor((@{druidLionMasqueTot})/2)+@{druidLionMasqueAE}]]}} @{tenebricite} {{jumelageAkimbo=[[@{akimbo}]]}} {{jumelageAmbidextrie=[[@{ambidextrie}]]}} @{tirRafale} @{assassin} {{cadence=[[ceil(@{cadence})]]}} {{scoreCadence=@{cadenceValue}}} @{soumission}" />
                            
                            <input type="hidden" name="attr_druidLionAmeliorations" value="{{chargeurGrappes=[[1D6]]}} {{ballesGrappes=[[@{chargeurGrappes}]]}} {{chargeurExplosives=[[1D6]]}} {{ballesExplosives=[[@{chargeurExplosives}]]}} @{pointeurLaser} @{lunetteIntelligente} @{canonLong} @{munitionsSubsoniques} @{protectionArme} @{structureElement} @{munitionsHyperVelocite} @{munitionsDrone} {{munitionsNonLetales=[[@{munitionsNonLetales}]]}} {{munitionsIEM=[[@{munitionsIEM}]]}} {{interfaceGuidage=[[@{interfaceGuidage}]]}} @{jumelage} {{chambreDouble=[[ceil(@{chambreDouble})]]}} @{systemeRefroidissement} {{revetementOmega=[[@{revetementOmega}D6]]}}" />

                            <input type="hidden" name="attr_druidLionSpecial" value="@{energie} @{bDDiversTotal} @{bVDiversTotal}" />
                        </div>
                        <div class="ligne">
                            <div class="firstCol aNom">
                                <input type="text" name="attr_armeDruidLion" />
                            </div>

                            <div class="midCol aDegats">
                                <input class="nbre" type="number" name="attr_degatDruidLion" value="0" />
                                <b>D6+</b>
                                <input class="bonus" type="number" name="attr_degatBonusDruidLion" value="0" />
                            </div>
                            <div class="midCol aViolence">
                                <input class="nbre" type="number" name="attr_violenceDruidLion" value="0" />
                                <b>D6+</b>
                                <input class="bonus" type="number" name="attr_violenceBonusDruidLion" value="0" />
                            </div>
                            <div class="midCol aPortee">
                                <select name="attr_porteeDruidLion">
                                    <option data-i18n="portee-contact" value="^{portee-contact}" selected>Contact</option>
                                    <option data-i18n="portee-courte" value="^{portee-courte}">Courte</option>
                                    <option data-i18n="portee-moyenne" value="^{portee-moyenne}">Moyenne</option>
                                    <option data-i18n="portee-longue" value="^{portee-longue}">Longue</option>
                                    <option data-i18n="portee-lointaine" value="^{portee-lointaine}">Lointaine</option>
                                </select>
                            </div>
                            <div class="lastCol aAspect">
                                <select name="attr_aspectDruidLion">
                                    <option value="druidLionChair" data-i18n="chair">Chair</option>
                                    <option value="druidLionBete" data-i18n="bete">Bête</option>
                                    <option value="druidLionMachine" data-i18n="machine">Machine</option>
                                    <option value="druidLionDame" data-i18n="dame">Dame</option>
                                    <option value="druidLionMasque" data-i18n="masque">Masque</option>
                                </select>
                                <button class="rollDice" type="action" name="act_combatdruidroll" value="@{jetGM} &{template:combat} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}}"></button>
                            </div>
                        </div>
                        <div class="subMenu">
                            <button class="effets" type="action" name="act_tab-1" data-i18n="effets">Effets</button>
                            <button class="ameliorationsArmes BL" type="action" name="act_tab-2" data-i18n="ameliorations-d'armes">Améliorations d'armes</button>
                            <button class="special BL" type="action" name="act_tab-3" data-i18n="special">Spécial</button>
                        </div>

                        <div class="effets">
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_antiAnatheme" value="{{antiAnathème=Anti Anathème}}" />
                                <span data-i18n-title="anti-anatheme" title="Anti Anathème"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_antiVehicule" value="{{antiVehicule=Anti Véhicule}} " />
                                <span data-i18n-title="anti-vehicule" title="Anti Véhicule"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_artillerie" value="{{artillerie=Artillerie}}" />
                                <span data-i18n-title="artillerie" title="Artillerie"></span>
                            </label>
                            <div class="double">
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_assassin" value="{{assassin=[[@{assassinValue}d6]]}} " />
                                    <span data-i18n-title="assassin" title="Assassin"></span>
                                </label>
                                
                                <input type="number" name="attr_assassinValue" class="center" value="0" />
                            </div>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_assistanceAttaque" value="{{assistanceAttaque=Assistance à l'attaque}}" />
                                <span data-i18n-title="assistance-attaque" title="Assistance à l'attaque"></span>
                            </label>
                            <div class="double">
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_barrage" value="{{barrage=^{barrage} @{barrageValue}}} " />
                                    <span data-i18n-title="barrage" title="Barrage"></span>
                                </label>
                                
                                <input type="number" name="attr_barrageValue" class="center" value="0" />
                            </div>
                            <div class="double">
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_cadence" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                                    <span data-i18n-title="cadence" title="Cadence"></span>
                                </label>
                            
                                <input type="number" name="attr_cadenceValue" class="center" value="0" />
                            </div>
                            <div class="double">
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_chargeur" value="{{chargeur=^{chargeur} @{chargeurValue}}} " />
                                    <span data-i18n-title="chargeur" title="Chargeur"></span>
                                </label>
                            
                                <input type="number" name="attr_chargeurValue" class="center" value="0" />
                            </div>
                            <div class="double">
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_choc" value="{{choc=^{choc} @{chocValue}}}" />
                                    <span data-i18n-title="choc" title="Choc"></span>
                                </label>
                            
                                <input type="number" name="attr_chocValue" class="center" value="0" />
                            </div>
                            <div class="double">
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_defense" value="{{defense=^{defense} @{defenseValue}}}" />
                                    <span data-i18n-title="defense" title="Défense"></span>
                                </label>
                            
                                <input type="number" name="attr_defenseValue" class="center" value="0" />
                            </div>
                            <div class="double">
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_degatContinue" value="{{degatContinus=^{degats-continus} @{degatContinueValue} ([[1D6]] ^{tours})}}" />
                                    <span data-i18n-title="degats-continus" title="Dégâts Continus"></span>
                                </label>
                            
                                <input type="number" name="attr_degatContinueValue" class="center" size="2" value="0" />
                            </div>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_deuxMains" value="{{deuxMains=Deux Mains}}" />
                                <span data-i18n-title="deux-mains" title="Deux Mains"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_demoralisant" value="{{demoralisant=Démoralisant}}" />
                                <span data-i18n-title="demoralisant" title="Démoralisant"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_designation" value="{{designation=Désignation}}" />
                                <span data-i18n-title="designation" title="Désignation"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_destructeur" value="{{destructeur=[[2D6]]}}" />
                                <span data-i18n-title="destructeur" title="Destructeur"></span>
                            </label>
                            <div class="double">
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_dispersion" value="{{dispersion=^{dispersion} @{dispersionValue}}} " />
                                    <span data-i18n-title="dispersion" title="Dispersion"></span>
                                </label>
                            
                                <input type="number" name="attr_dispersionValue" class="center" value="0" />
                            </div>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_enChaine" value="{{enChaine=En Chaîne}}" />
                                <span data-i18n-title="en-chaine" title="En Chaîne"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_esperance" value="{{esperance=Espérance}}" />
                                <span data-i18n-title="esperance" title="Espérance"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_fureur" value="{{fureur=[[4D6]]}}" />
                                <span data-i18n-title="fureur" title="Fureur"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_ignoreArmure" value="{{ignoreArmure=Ignore Armure}}" />
                                <span data-i18n-title="ignore-armure" title="Ignore Armure"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_ignoreCdF" value="{{ignoreCdF=Ignore Champs de Force}}" />
                                <span data-i18n-title="ignore-champ-de-force" title="Ignore CdF"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_akimbo" value="2" />
                                <span data-i18n-title="jumele-akimbo" title="Jumelé (Akimbo)"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_ambidextrie" value="2" />
                                <span data-i18n-title="jumele-ambidextrie" title="Jumelé (Ambidextrie)"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_leste" value="{{leste=[[@{druidLionChairTot}]]}}" />
                                <span data-i18n-title="leste" title="Lesté"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_lourd" value="1" />
                                <span data-i18n-title="lourd" title="Lourd"></span>
                            </label>
                            <div class="double">
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_lumiere" value="{{lumiere=^{lumiere} @{lumiereValue}}}" />
                                    <span data-i18n-title="lumiere" title="Lumière"></span>
                                </label>

                                <input type="number" name="attr_lumiereValue" class="center" size="2" value="0" />
                            </div>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_meurtrier" value="{{meurtrier=[[2D6]]}}" />
                                <span data-i18n-title="meurtrier" title="Meurtrier"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_obliteration" value="{{obliteration=Oblitération}}" />
                                <span data-i18n-title="obliteration" title="Oblitération"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_orfevrerie" value="{{orfevrerie=[[@{dexterite}+@{dextOD}]]}} {{orfevrerieWarrior=[[@{dexterite}+@{dextOD}+@{warriorScoutA}]]}}" />
                                <span data-i18n-title="orfevrerie" title="Orfèvrerie"></span>
                            </label>
                            <div class="double">
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_parasitage" value="{{parasitage=^{parasitage} @{parasitageValue}}}" />
                                    <span data-i18n-title="parasitage" title="Parasitage"></span>
                                </label>
                            
                                <input type="number" name="attr_parasitageValue" class="center" value="0" />
                            </div>
                            <div class="double">
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_penetrant" value="{{penetrant=^{penetrant} @{penetrantValue}}}" />
                                    <span data-i18n-title="penetrant" title="Pénétrant"></span>
                                </label>
                            
                                <input type="number" name="attr_penetrantValue" class="center" value="0" />
                            </div>
                            <div class="double">
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_perceArmure" value="{{perceArmure=^{perce-armure} @{perceArmureValue}}}" />
                                    <span data-i18n-title="perce-armure" title="Perce Armure"></span>
                                </label>
                            
                                <input type="number" name="attr_perceArmureValue" class="center" value="0" />
                            </div>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_precision" value="{{precision=[[@{tir}+@{tirOD}]]}} {{precisionWarrior=[[@{tir}+@{tirOD}+@{warriorScholarA}]]}}" />
                                <span data-i18n-title="precision" title="Précision"></span>
                            </label>
                            <div class="double">
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_reaction" value="{{reaction=^{reaction} @{reactionValue}}}" />
                                    <span data-i18n-title="reaction" title="Réaction"></span>
                                </label>
                            
                                <input type="number" name="attr_reactionValue" class="center" value="0" />
                            </div>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_silencieux" value="{{silencieux=Silencieux}}" />
                                <span data-i18n-title="silencieux" title="Silencieux"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_soumission" value="{{soumission=Soumission}}" />
                                <span data-i18n-title="soumission" title="Soumission"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_tenebricite" value="{{tenebricite=Ténébricité}}" />
                                <span data-i18n-title="tenebricite" title="Ténébricité"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_tirRafale" value="{{tirRafale=Tir en Rafale}}" />
                                <span data-i18n-title="tir-rafale" title="Tir en Rafale"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_tirSecurite" value="3" />
                                <span data-i18n-title="tir-securite" title="Tir en Sécurité"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_ultraViolence" value="{{ultraviolence=[[2D6]]}}" />
                                <span data-i18n-title="ultraviolence" title="Ultraviolence"></span>
                            </label>
                        </div>
                        <div class="ameliorationsArmes">
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_chargeurGrappes" value="1" />
                                <span data-i18n-title="balles-grappes" title="Balles grappes"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_canonLong" value="{{canonLongM=1}} {{canonLongC=Canon Long (Portée Courte : +3 Difficulté)}}" />
                                <span data-i18n-title="canon-long" title="Canon Long"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_canonRaccourci" value="{{canonRaccourci=Canon Raccourci (Portée Courte : Dispersion 3 / Sinon : +3 Difficulté)}}" />
                                <span data-i18n-title="canon-raccourci" title="Canon Raccourci"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_chambreDouble" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                                <span data-i18n-title="chambre-double" title="Chambre Double"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_interfaceGuidage" value="3" />
                                <span data-i18n-title="interface-guidage" title="Interface de guidage"></span>
                            </label>
                            <div class="doubleTexte">
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_jumelage" value="{{jumelage=^{jumelage} (@{jumelageValue})}}" />
                                    <span data-i18n-title="jumelage" title="Jumelage :"></span>
                                </label>
                                <input type="text" name="attr_jumelageValue" class="borderBottom" />
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_jumelageType" value="ambidextrie" />
                                    <span data-i18n-title="ambidextrie" title="Ambidextrie"></span>
                                </label>
                                <label class="fakeButton borderTop">
                                    <input type="checkbox" name="attr_jumelageType" value="akimbo" />
                                    <span data-i18n-title="akimbo" title="Akimbo"></span>
                                </label>
                            </div>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_lunetteIntelligente" value="{{lunetteIntelligente=Lunette Intelligente (+1 Portée)}}" />
                                <span data-i18n-title="lunette-intelligente" title="Lunette Intelligente"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_munitionsHyperVelocite" value="{{munitionsHyperVelocite=Munitions à Hyper Velocite (Assistance à l'Attaque)}}" />
                                <span data-i18n-title="munitions-h-velocite" title="Munitions à H. Vélocité"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_munitionsDrone" value="{{munitionsDrone=3}}" />
                                <span data-i18n-title="munitions-drones" title="Munitions Drones"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_chargeurExplosives" value="1" />
                                <span data-i18n-title="munitions-explosives" title="Munitions Explosives"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_munitionsIEM" value="1" />
                                <span data-i18n-title="munitions-iem" title="Munitions IEM"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_munitionsNonLetales" value="2" />
                                <span  data-i18n-title="munitions-n-letales"title="Munitions N. Létales"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_munitionsSubsoniques" value="{{munitionsSubsoniques=Munitions Subsoniques (Silencieux)}}" />
                                <span data-i18n-title="munitions-subsoniques" title="Munitions Subsoniques"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_pointeurLaser" value="{{pointeurLaser=1}} " />
                                <span data-i18n-title="pointeur-laser" title="Pointeur Laser"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_protectionArme" value="{{protectionArme=Protection d'Arme (Reaction +2)}}" />
                                <span data-i18n-title="protection-d'arme" title="Protection d'Arme"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_revetementOmega" value="2" />
                                <span data-i18n-title="revetement-omega" title="Revêtement Omega"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_structureElement" value="{{structureElement=Structure en Élément}}" />
                                <span data-i18n-title="structure-alpha" title="Structure Alpha"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_systemeRefroidissement" value="{{systemeRefroidissement=Système de Refroidissement (Tir en Rafale + Barrage 1)}}" />
                                <span data-i18n-title="systeme-refroid" title="Système de Refroid."></span>
                            </label>
                        </div>
                        <div class="special">
                            <div class="double">
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_energie" value="{{energie=@{energieValue}}} " />
                                    <span data-i18n-title="energie" title="Énergie"></span>
                                </label>
                            
                                <input type="number" name="attr_energieValue" class="center" value="0" />
                            </div>
                            <div class="triple">
                                <input type="hidden" name="attr_bDDiversTotal" value="0" />

                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_bDDiversTotal" value="{{BDDivers=[[@{bDDiversD6}D6+@{bDDiversFixe}]]}} " />
                                    <span data-i18n-title="bonus-degats" title="Bonus aux dégâts"></span>
                                </label>
                                <div>
                                    <input class="L" type="number" name="attr_bDDiversD6" class="center" value="0" />
                                    <span>D6+</span>
                                    <input class="R" type="number" name="attr_bDDiversFixe" class="center" value="0" />
                                </div>
                            </div>
                            <div class="triple">
                                <input type="hidden" name="attr_bVDiversTotal" value="0" />

                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_bVDiversTotal" value="{{BVDivers=[[@{bVDiversD6}D6+@{bVDiversFixe}]]}} " />
                                    <span data-i18n-title="bonus-violence" title="Bonus à la violence"></span>
                                </label>
                                <div>
                                    <input class="L" type="number" name="attr_bVDiversD6" class="center" value="0" />
                                    <span>D6+</span>
                                    <input class="R" type="number" name="attr_bVDiversFixe" class="center" value="0" />
                                </div>
                            </div>
                        </div>
                    </fieldset>
                </div>

                <div class="modules">
                    <input type="hidden" name="attr_slotsMALDCLTeteMax" value="8" readonly />
                    <input type="hidden" name="attr_slotsMALUDCLTeteTot" value="0" />
                    
                    <input type="hidden" name="attr_slotsMALDCLTorseMax" value="8" readonly />
                    <input type="hidden" name="attr_slotsMALUDCLTorseTot" value="0" />
                
                    <input type="hidden" name="attr_slotsMALDCLBGMax" value="8" readonly />
                    <input type="hidden" name="attr_slotsMALUDCLBGTot" value="0" />
                
                    <input type="hidden" name="attr_slotsMALDCLBDMax" value="8" readonly />
                    <input type="hidden" name="attr_slotsMALUDCLBDTot" value="0" />
                
                    <input type="hidden" name="attr_slotsMALDCLJGMax" value="8" readonly />
                    <input type="hidden" name="attr_slotsMALUDCLJGTot" value="0" />
                
                    <input type="hidden" name="attr_slotsMALDCLJDMax" value="8" readonly />
                    <input type="hidden" name="attr_slotsMALUDCLJDTot" value="0" />

                    <h1 class="titre" data-i18n="slots-du-lion">Slots du Lion</h1>

                    <div class="ligne slots">
                        <div class="col6">
                            <span data-i18n="tete">Tête</span>

                            <div data-i18n-title="slots-restants/slots-maximum" title="Slots restants / Slots maximum">
                                <input type="number" name="attr_slotsMALDCLTeteAct" value="@{slotsMALDCLTeteMax}-@{slotsMALUDCLTeteTot}" disabled />	
                                <b>/</b>
                                <span name="attr_slotsMALDCLTeteMax">8</span>
                            </div>
                        </div>

                        <div class="col6BL">
                            <span data-i18n="torse">Torse</span>
                            <div data-i18n-title="slots-restants/slots-maximum" title="Slots restants / Slots maximum">
                                <input type="number" name="attr_slotsMALDCLTorseAct" value="@{slotsMALDCLTorseMax}-@{slotsMALUDCLTorseTot}" disabled />	
                                <b>/</b>
                                <span name="attr_slotsMALDCLTorseMax">8</span>
                            </div>
                        </div>

                        <div class="col6BL">
                            <span data-i18n="bras-gauche">Bras Gauche</span>
                            <div data-i18n-title="slots-restants/slots-maximum" title="Slots restants / Slots maximum">
                                <input type="number" name="attr_slotsMALDCLBGAct" value="@{slotsMALDCLBGMax}-@{slotsMALUDCLBGTot}" disabled />	<b>/</b><span name="attr_slotsMALDCLBGMax">8</span>
                            </div>
                        </div>

                        <div class="col6BL">
                            <span data-i18n="bras-droit">Bras Droit</span>
                            <div data-i18n-title="slots-restants/slots-maximum" title="Slots restants / Slots maximum">
                                <input type="number" name="attr_slotsDCLBDAct" value="@{slotsMALDCLBDMax}-@{slotsMALUDCLBDTot}" disabled />	<b>/</b><span name="attr_slotsMALDCLBDMax">8</span>
                            </div>
                        </div>

                        <div class="col6BL">
                            <span data-i18n="jambe-gauche">Jambe Gauche</span>
                            <div data-i18n-title="slots-restants/slots-maximum" title="Slots restants / Slots maximum">
                                <input type="number" name="attr_slotsDCLJGAct" value="@{slotsMALDCLJGMax}-@{slotsMALUDCLJGTot}" disabled />	<b>/</b><span name="attr_slotsMALDCLJGMax">8</span>
                            </div>
                        </div>

                        <div class="col6BL">
                            <span data-i18n="jambe-droite">Jambe Droite</span>
                            <div data-i18n-title="slots-restants/slots-maximum" title="Slots restants / Slots maximum">
                                <input type="number" name="attr_slotsDCLJDAct" value="@{slotsMALDCLJDMax}-@{slotsMALUDCLJDTot}" disabled />	<b>/</b><span name="attr_slotsMALDCLJDMax">8</span>
                            </div>
                        </div>
                    </div>

                    <fieldset class="repeating_modulesMALDCLion">
                        <input class="expandModule" type="hidden" name="attr_affichageMALDCLion" value="0" />
                        <input class="expandSlots" type="hidden" name="attr_slotsMALDCLPlus" value="0" />

                        <div class="ligne titreModule">
                            <button class="buttonPlus" type="action" name="act_affichagemaldclion-1">
                               <span class="plus">+</span>
                               <span class="moins">-</span>
                            </button>
                            <input type="text" name="attr_moduleNomMALDCLion" placeholder="Nom du Module"/>
                        </div>

                        <div class="ligne hModule">
                            <label class="activation">
                                <span data-i18n="activation">Activation</span>
                                <input type="text" name="attr_moduleActivationMALDCLion" />
                            </label>
                            <div class="PE">
                                <button type="action" name="act_pemdlion" title="Dépenser les PE du module" data-i18n-title="depenser-pe-module" data-i18n="point-d'energie-short">PE</button>
                                <input type="number" name="attr_moduleEnergieMALDCLion" value="0" />
                            </div>
                        </div>
                        
                        <label class="ligne hModule duree">
                            <span data-i18n="duree">Durée</span>
                            <input type="text" name="attr_moduleDureeMALDCLion" />
                        </label>
        
                        <div class="autoex hModule autoex28">
                            <span name="attr_moduleDescriptionMALDCLion"></span>
                            <textarea name="attr_moduleDescriptionMALDCLion"></textarea>
                        </div>

                        <div class="ligne hModule titre titreSlots">
                            <input type="number" name="attr_slotsTotalMALDCLion" value="@{moduleSlotMALDCLTete}+@{moduleSlotMALDCLTorse}+@{moduleSlotMALDCLBG}+@{moduleSlotMALDCLBD}+@{moduleSlotMALDCLJG}+@{moduleSlotMALDCLJD}" title="Slots occupés" disabled />
                            <h1 class="titre" data-i18n="slots">Slots</h1>
                            <button class="buttonArrow" type="action" name="act_slotsmaldclplus-1">]</button>
                        </div>

                        <div class="ligne hSlots">
                            <label class="slot">
                                <span data-i18n="tete">Tête</span>
                                <input type="number" name="attr_moduleSlotMALDCLTete" value="0" />
                            </label>
                            
                            <label class="slotBL">
                                <span data-i18n="torse">Torse</span>
                                <input type="number" name="attr_moduleSlotMALDCLTorse" value="0" />
                            </label>
                        </div>
                        
                        <div class="ligne hSlots bTop">
                            <label class="slot">
                                <span data-i18n="bras-gauche">Bras Gauche</span>
                                <input type="number" name="attr_moduleSlotMALDCLBG" value="0" />
                            </label>
                            
                            <label class="slotBL">
                                <span data-i18n="bras-droit">Bras Droit</span>
                                <input type="number" name="attr_moduleSlotMALDCLBD" value="0" />
                            </label>
                        </div>
                        
                        <div class="ligne hSlots bTop">
                            <label class="slot">
                                <span data-i18n="jambe-gauche">Jambe Gauche</span>
                                <input type="number" name="attr_moduleSlotMALDCLJG" value="0" />
                            </label>
                            
                            <label class="slotBL">
                                <span data-i18n="jambe-droite">Jambe Droite</span>
                                <input type="number" name="attr_moduleSlotMALDCLJD" value="0" />
                            </label>
                        </div>
                    </fieldset>
                </div>

                <div class="evolutions">
                    <input type="hidden" name="attr_MALDruidLionChairBase" value="7" />
                    <input type="hidden" name="attr_MALDruidLionBeteBase" value="6" />
                    <input type="hidden" name="attr_MALDruidLionMachineBase" value="7" />
                    <input type="hidden" name="attr_MALDruidLionDameBase" value="4" />
                    <input type="hidden" name="attr_MALDruidLionMasqueBase" value="3" />
                                                
                    <input type="hidden" name="attr_MALDruidLionPABase" value="60" />
                    <input type="hidden" name="attr_MALDruidLionDefenseBase" value="4" />
                    <input type="hidden" name="attr_MALDruidLionReactionBase" value="4" />
                    <input type="hidden" name="attr_MALDruidLionInitiativeBase" value="2" />
                    <input type="hidden" name="attr_MALDruidLionCDFBase" value="10" />
        
                    <div class="aspects">
                        <div class="ligneTitre">
                            <span></span>
                            <span data-i18n="aspects">Aspects</span>
                            <span data-i18n="aspects-exceptionnels">Aspects Exceptionnels</span>
                        </div>
                        <div class="ligne2">
                            <span data-i18n="chair">Chair</span>
                            <div>
                                <input type="number" name="attr_MALDruidLionChairEvol" value="0" min="0" />
                            </div>
                            <div>
                                <select name="attr_MALDruidLionChairAE">
                                    <option value="1" selected>1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                </select>
                            </div>
                            
                        </div>
                        <div class="ligne2">
                            <span data-i18n="bete">Bête</span>
                            <div>
                                <input type="number" name="attr_MALDruidLionBeteEvol" value="0" min="0" />
                            </div>
                            <div>
                                <select name="attr_MALDruidLionBeteAE">
                                    <option value="1" selected>1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                </select>
                            </div>
                        </div>
                        <div class="ligne2">
                            <span data-i18n="machine">Machine</span>
                            <div>
                                <input type="number" name="attr_MALDruidLionMachineEvol" value="0" min="0" />
                            </div>
                            <div>
                                <select name="attr_MALDruidLionMachineAE">
                                    <option value="1" selected>1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                </select>
                            </div>
                        </div>
                        <div class="ligne2">
                            <span data-i18n="dame">Dame</span>
                            <div>
                                <input type="number" name="attr_MALDruidLionDameEvol" value="0" min="0" />
                            </div>
                            <div>
                                <select name="attr_MALDruidLionDameAE">
                                    <option value="0" selected>0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                </select>
                            </div>
                        </div>
                        <div class="ligne2">
                            <span data-i18n="masque">Masque</span>
                            <div>
                                <input type="number" name="attr_MALDruidLionMasqueEvol" value="0" min="0" />
                            </div>
                            <div>
                                <select name="attr_MALDruidLionMasqueAE">
                                    <option value="0" selected>0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="VD">
                        <div class="ligneTitre">
                            <span></span>
                            <span data-i18n="valeurs-derivees">Valeurs Dérivées</span>
                        </div>
                        <label class="ligne1">
                            <span data-i18n="champ-de-force">Champs de Force</span>
                            <input type="number" name="attr_MALDruidLionCDFEvol" value="0" min="0" />
                        </label>
                        <label class="ligne1">
                            <span data-i18n="armure">Armure</span>
                            <input type="number" name="attr_MALDruidLionPAEvol" value="0" min="0" />
                        </label>
                        <label class="ligne1">
                            <span data-i18n="defense">Défense</span>
                            <input type="number" name="attr_MALDruidLionDefenseEvol" value="0" min="0" />
                        </label>
                        <label class="ligne1">
                            <span data-i18n="reaction">Réaction</span>
                            <input type="number" name="attr_MALDruidLionReactionEvol" value="0" min="0" />
                        </label>
                        <label class="ligne1">
                            <span data-i18n="initiative">Initiative</span>
                            <input type="number" name="attr_MALDruidLionInitiativeEvol" value="0" min="0" />
                        </label>
                    </div>
                </div>
            </div>

            <div class="fichePJ DCWolf">
                <input class="subMenu" type="hidden" name="attr_MALTabDruidWolf" value="0" />
                <input class="choixConfiguration" type="hidden" name="attr_MALDruidWolfConfiguration" />
                <input class="laborNiveau" type="hidden" name="attr_MALDWolfLaborNiveau" value="1" />
                <input class="medikNiveau" type="hidden" name="attr_MALDWolfMedicNiveau" value="1" />
                <input class="techNiveau" type="hidden" name="attr_MALDWolfTechNiveau" value="1" />
                <input class="fighterNiveau" type="hidden" name="attr_MALDWolfFighterNiveau" value="1" />
                <input class="reconNiveau" type="hidden" name="attr_MALDWolfReconNiveau" value="1" />

                <h1 class="titre" data-i18n="druid-companion-wolf">Wolf</h1>

                <div class="col4">
                    <h1 class="titre" data-i18n="aspects">Aspects</h1>
                    <div class="ligne aspect">
                        <span data-i18n="chair">Chair</span>

                        <div class="blockR">
                            <input type="number" name="attr_MALDruidWolfChairTot" value="@{MALDruidWolfChairBase}+@{MALDruidWolfChairEvol}" disabled />
                            <button class="rollDice" name="act_druidWolfChairRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-wolf}}} {{special1=@{name}}}"></button>
                        </div>
                    </div>
                    <div class="ligne aspect">
                        <span data-i18n="bete">Bête</span>

                        <div class="blockR">
                            <input type="number" name="attr_MALDruidWolfBeteTot" value="@{MALDruidWolfBeteBase}+@{MALDruidWolfBeteEvol}" disabled />
                            <button class="rollDice" name="act_MALDruidWolfBeteRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-wolf}}} {{special1=@{name}}}"></button>
                        </div>
                    </div>
                    <div class="ligne aspect">
                        <span data-i18n="machine">Machine</span>

                        <div class="blockR">
                            <input type="number" name="attr_MALDruidWolfMachineTot" value="@{druidWolfMachineBase}+@{druidWolfMachineEvol}" disabled />
                            <button class="rollDice" name="act_MALDruidWolfMachineRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-wolf}}} {{special1=@{name}}}"></button>
                        </div>
                    </div>
                    <div class="ligne aspect">
                        <span data-i18n="dame">Dame</span>

                        <div class="blockR">
                            <input type="number" name="attr_MALDruidWolfDameTot" value="@{druidWolfDameBase}+@{druidWolfDameEvol}" disabled />
                            <button class="rollDice" name="act_MALDruidWolfDameRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-wolf}}} {{special1=@{name}}}"></button>
                        </div>
                    </div>
                    <div class="ligne aspect">
                        <span data-i18n="masque">Masque</span>

                        <div class="blockR">
                            <input type="number" name="attr_MALDruidWolfMasqueTot" value="@{druidWolfMasqueBase}+@{druidWolfMasqueEvol}" disabled />
                            <button class="rollDice" name="act_MALDruidWolfMasqueRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-wolf}}} {{special1=@{name}}}"></button>
                        </div>
                    </div>
                </div>

                <div class="col4BL">
                    <h1 class="titre" data-i18n="aspects-exceptionnels">Aspects Exceptionnels</h1>

                    <div class="ligne AE">
                        <input type="hidden" name="attr_MALDruidWolfChairAE" value="0"/>
                        <span class="mineur" data-i18n="mineur">Mineur</span>
                        <span class="majeur" data-i18n="majeur">Majeur</span>
                        <span class="value" name="attr_MALDruidWolfChairAE">0</span>
                    </div>
                    <div class="ligne AE">
                        <input type="hidden" name="attr_MALDruidWolfBeteAE" value="0"/>
                        <span class="mineur" data-i18n="mineur">Mineur</span>
                        <span class="majeur" data-i18n="majeur">Majeur</span>
                        <span class="value" name="attr_MALDruidWolfBeteAE">0</span>
                    </div>
                    <div class="ligne AE">
                        <input type="hidden" name="attr_MALDruidWolfMachineAE" value="0"/>
                        <span class="mineur" data-i18n="mineur">Mineur</span>
                        <span class="majeur" data-i18n="majeur">Majeur</span>
                        <span class="value" name="attr_MALDruidWolfMachineAE">0</span>
                    </div>
                    <div class="ligne AE">
                        <input type="hidden" name="attr_MALDruidWolfDameAE" value="0"/>
                        <span class="mineur" data-i18n="mineur">Mineur</span>
                        <span class="majeur" data-i18n="majeur">Majeur</span>
                        <span class="value" name="attr_MALDruidWolfDameAE">0</span>
                    </div>
                    <div class="ligne AE">
                        <input type="hidden" name="attr_MALDruidWolfMasqueAE" value="0"/>
                        <span class="mineur" data-i18n="mineur">Mineur</span>
                        <span class="majeur" data-i18n="majeur">Majeur</span>
                        <span class="value" name="attr_MALDruidWolfMasqueAE">0</span>
                    </div>
                </div>

                <div class="col4BL">
                    <h1 class="titre" data-i18n="valeurs-derivees">Valeurs Dérivées</h1>

                    <div class="ligne defense">
                        <span data-i18n="defense">Défense</span>

                        <div class="blockR">
                            <input type="number" name="attr_MALDruidWolfDefenseTot" value="4+@{MALDruidWolfMasqueAE}" disabled />
                        </div>
                    </div>
                    <div class="ligne reaction">
                        <span data-i18n="reaction">Réaction</span>

                        <div class="blockR">
                            <input type="number" name="attr_druidWolfReactionTot" value="4+@{MALDruidWolfMachineAE}" disabled />
                        </div>
                    </div>
                    <div class="ligne initiative">
                        <span data-i18n="initiative">Initiative</span>

                        <div class="blockR">
                            <input type="number" name="attr_MALDruidWolfInitiativeTot" value="2" disabled />
                            <button class="rollDice" type="action" name="act_MALDruidWolfInitiativeRoll" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-wolf}}} {{special1=@{name}}}"></button>
                        </div>
                    </div>
                    <div class="ligne armure">
                        <span data-i18n="armure">Armure</span>

                        <div class="blockR">
                            <input type="number" name="attr_MALDruidWolfPAAct" value="20" />
                            <b>/</b>
                            <input type="number" name="attr_MALDruidWolfPAAct_max" value="20" disabled />
                        </div>
                    </div>
                    <div class="ligne energie">
                        <span data-i18n="energie">Energie</span>

                        <div class="blockR">
                            <input type="number" name="attr_MALDruidWolfPEAct" value="0" />
                            <b>/</b>
                            <input type="number" name="attr_MALDruidWolfPEAct_max" value="@{MALDruidEnergieCompanon}" disabled />
                        </div>
                    </div>
                </div>

                <div class="col4BL">
                    <h1 class="titre" data-i18n="champ-de-force">Champ de Force</h1>
                    <div class="ligne CDF">
                        <input type="number" name="attr_MALDruidWolfCDFT" value="4" disabled />
                    </div>

                    <h1 class="titre" data-i18n="configuration">Configuration</h1>
                    <div class="ligne configuration">
                        <select name="attr_MALDruidWolfConfiguration">
                            <option value="" selected></option>
                            <option value="Labor" data-i18n="druid-wolf-labor">Labor</option>
                            <option value="Medic" data-i18n="druid-wolf-medik">Medik</option>
                            <option value="Tech" data-i18n="druid-wolf-tech">Tech</option>
                            <option value="Fighter" data-i18n="druid-wolf-fighter">Fighter</option>
                            <option value="Recon" data-i18n="druid-wolf-recon">Recon</option>
                        </select>
                        <button type="action" name="act_MALDruidWolfConfiguration" data-i18n="point-energie-short">PE</button>
                        <input type="number" name="attr_MALDruidWolfConfigurationPE" value="0" readonly />
                    </div>

                    <div class="ligne nbreCompanions">
                        <select name="attr_MALDruidNombreCompagnon">
                            <option value="3" data-i18n="druid-3-companions-restants" selected>3 Companions Restants</option>
                            <option value="2"data-i18n="druid-2-companions-restants" >2 Companions Restants</option>
                            <option value="1"data-i18n="druid-1-companions-restants" >1 Companions Restant</option>
                        </select>
                    </div>

                    <div class="ligne fighter">
                        <span data-i18n="degats">Dégâts</span>
                        <button class="rollDice" type="action" name="act_MALDWolfFighterN1Roll" value="@{jetGM} &{template:combat} {{portee=^{portee-contact}}} {{Nom=^{druid-companion-wolf}}} {{special1=@{name}}}"></button>
                    </div>
                </div>

                <h1 class="titre" data-i18n="configuration">Configuration</h1>
                <div class="labor description">	
                    <span class="N1" data-i18n="druid-companion-labor-description-niveau-1">
                        Les actions du chevalier visant à porter de lourdes charges, à déplacer ou lever des poids reçoivent 1 dé par compagnon effectuant l’action de support. Chaque compagnon peut porter à lui seul 150 kg et peut donc transporter des choses pour le chevalier.
                    </span>
                    <span class="N2" data-i18n="druid-companion-labor-description-niveau-2">
                        Les actions du chevalier visant à porter de lourdes charges, à déplacer ou lever des poids reçoivent 2 dé par compagnon effectuant l’action de support. Chaque compagnon peut porter à lui seul 150 kg et peut donc transporter des choses pour le chevalier.
                    </span>
                    <span class="N3" data-i18n="druid-companion-labor-description-niveau-3">
                        Les actions du chevalier visant à porter de lourdes charges, à déplacer ou lever des poids reçoivent 3 dé par compagnon effectuant l’action de support. Chaque compagnon peut porter à lui seul 150 kg et peut donc transporter des choses pour le chevalier.
                    </span>
                </div>

                <div class="medik description">
                    <span class="N1" data-i18n="druid-companion-medik-description-niveau-1">
                        Les actions du chevalier visant à soigner, à faire des recherches biologiques ou à reconnaitre un élément médical ou biologique reçoivent 1 dé supplémentaire par compagnon effectuant un support. Si le chevalier soigne un allié, celui-ci récupère 2 PS supplémentaires par compagnon effectuant un support.
                    </span>
                    <span class="N2" data-i18n="druid-companion-medik-description-niveau-2">
                        Les actions du chevalier visant à soigner, à faire des recherches biologiques ou à reconnaitre un élément médical ou biologique reçoivent 2 dé supplémentaire par compagnon effectuant un support. Si le chevalier soigne un allié, celui-ci récupère 2 PS supplémentaires par compagnon effectuant un support.
                    </span>
                    <span class="N3" data-i18n="druid-companion-medik-description-niveau-3">
                        Les actions du chevalier visant à soigner, à faire des recherches biologiques ou à reconnaitre un élément médical ou biologique reçoivent 3 dé supplémentaire par compagnon effectuant un support. Si le chevalier soigne un allié, celui-ci récupère 2 PS supplémentaires par compagnon effectuant un support.
                    </span>
                </div>

                <div class="tech description">
                    <span class="N1" data-i18n="druid-companion-tech-description-niveau-1">
                        Les actions du chevalier visant à réparer un objet, un véhicule, un compagnon ou une méta-armure, à analyser un élément informatique ou électronique reçoivent 1 dé supplémentaire par compagnon effectuant un support. Le chevalier peut effectuer les réparations ou les analyses directement depuis un compagnon. Si le chevalier tente de réparer quelque chose (méta-armure, compagnon, véhicule) à l’aide de ses Companions, les PA que la cible récupère sont augmentés de 3 par compagnon effectuant l’action de support.
                    </span>
                    <span class="N2" data-i18n="druid-companion-tech-description-niveau-2">
                        Les actions du chevalier visant à réparer un objet, un véhicule, un compagnon ou une méta-armure, à analyser un élément informatique ou électronique reçoivent 2 dé supplémentaire par compagnon effectuant un support. Le chevalier peut effectuer les réparations ou les analyses directement depuis un compagnon. Si le chevalier tente de réparer quelque chose (méta-armure, compagnon, véhicule) à l’aide de ses Companions, les PA que la cible récupère sont augmentés de 3 par compagnon effectuant l’action de support.
                    </span>
                    <span class="N3" data-i18n="druid-companion-tech-description-niveau-3">
                        Les actions du chevalier visant à réparer un objet, un véhicule, un compagnon ou une méta-armure, à analyser un élément informatique ou électronique reçoivent 3 dé supplémentaire par compagnon effectuant un support. Le chevalier peut effectuer les réparations ou les analyses directement depuis un compagnon. Si le chevalier tente de réparer quelque chose (méta-armure, compagnon, véhicule) à l’aide de ses Companions, les PA que la cible récupère sont augmentés de 3 par compagnon effectuant l’action de support.
                    </span>
                </div>

                <div class="fighter description">
                    <span class="N1" data-i18n="druid-companion-fighter-description-niveau-1">
                        Les actions de combat du chevalier contre un ennemi désigné aux Companions reçoivent 1 dé supplémentaire par compagnon effectuant un support. La cible du chevalier doit être à portée courte et doit pouvoir être attaquée au contact. Si ces deux conditions sont respectées, la cible reçoit automatiquement l’effet barrage 1 par compagnon (3 Companions supportant le chevalier infligent ainsi l’effet barrage 3). De plus, les Companions infligent à la cible 1D6 points de dégâts ou de violence chacun (sans bonus) sans devoir effectuer de jet de dés pour toucher. On considère cependant que lorsqu’ils effectuent cette action de support, leur défense tombe à 0. Une seule cible à la fois peut subir cette action de support.
                    </span>
                    <span class="N2" data-i18n="druid-companion-fighter-description-niveau-2">
                        Les actions de combat du chevalier contre un ennemi désigné aux Companions reçoivent 2 dé supplémentaire par compagnon effectuant un support. La cible du chevalier doit être à portée courte et doit pouvoir être attaquée au contact. Si ces deux conditions sont respectées, la cible reçoit automatiquement l’effet barrage 1 par compagnon (3 Companions supportant le chevalier infligent ainsi l’effet barrage 3). De plus, les Companions infligent à la cible 1D6 points de dégâts ou de violence chacun (sans bonus) sans devoir effectuer de jet de dés pour toucher. On considère cependant que lorsqu’ils effectuent cette action de support, leur défense tombe à 0. Une seule cible à la fois peut subir cette action de support.
                    </span>
                    <span class="N3" data-i18n="druid-companion-fighter-description-niveau-3">
                        Les actions de combat du chevalier contre un ennemi désigné aux Companions reçoivent 3 dé supplémentaire par compagnon effectuant un support. La cible du chevalier doit être à portée courte et doit pouvoir être attaquée au contact. Si ces deux conditions sont respectées, la cible reçoit automatiquement l’effet barrage 1 par compagnon (3 Companions supportant le chevalier infligent ainsi l’effet barrage 3). De plus, les Companions infligent à la cible 1D6 points de dégâts ou de violence chacun (sans bonus) sans devoir effectuer de jet de dés pour toucher. On considère cependant que lorsqu’ils effectuent cette action de support, leur défense tombe à 0. Une seule cible à la fois peut subir cette action de support.
                    </span>
                </div>

                <div class="recon description">
                    <span class="N1" data-i18n="druid-companion-recon-description-niveau-1">
                        Toutes les actions d’observation, de vigilance ou de fouille menées par le chevalier reçoivent 1 dé supplémentaire par compagnon effectuant le support. Le chevalier peut observer, entendre, sentir et toucher directement depuis un des compagnons (au choix).
                    </span>
                    <span class="N2" data-i18n="druid-companion-recon-description-niveau-2">
                        Toutes les actions d’observation, de vigilance ou de fouille menées par le chevalier reçoivent 2 dé supplémentaire par compagnon effectuant le support. Le chevalier peut observer, entendre, sentir et toucher directement depuis un des compagnons (au choix).
                    </span>
                    <span class="N3" data-i18n="druid-companion-recon-description-niveau-3">
                        Toutes les actions d’observation, de vigilance ou de fouille menées par le chevalier reçoivent 3 dé supplémentaire par compagnon effectuant le support. Le chevalier peut observer, entendre, sentir et toucher directement depuis un des compagnons (au choix).
                    </span>
                </div>

                <div class="subMenu">
                    <button class="evolutions" type="action" name="act_MALTabDruidWolf_3" data-i18n="evolutions">Evolutions</button>
                </div>

                <div class="evolutions">
                    <input type="hidden" name="attr_MALDruidWolfChairBase" value="2" disabled />
                    <input type="hidden" name="attr_MALDruidWolfBeteBase" value="4" disabled />
                    <input type="hidden" name="attr_MALDruidWolfMachineBase" value="4" disabled />
                    <input type="hidden" name="attr_MALDruidWolfDameBase" value="2" disabled />
                    <input type="hidden" name="attr_MALDruidWolfMasqueBase" value="4" disabled />
                    
                    <div class="aspects">
                        <div class="ligneTitre">
                            <span data-i18n="aspects">Aspects</span>
                            <span data-i18n="aspects-exceptionnels">Aspects Exceptionnels</span>
                        </div>
                        <div class="ligne2">
                            <span data-i18n="chair">Chair</span>
        
                            <div>
                                <input type="number" name="attr_MALDruidWolfChairEvol" value="0" min="0" />
                            </div>
                            <div>
                                <select name="attr_MALDruidWolfChairAE">
                                    <option value="0" selected>0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                </select>
                            </div>
                        </div>
                        <div class="ligne2">
                            <span data-i18n="bete">Bête</span>
                            <div>
                                <input type="number" name="attr_MALDruidWolfBeteEvol" value="0" min="0" />
                            </div>
                            <div>
                                <select name="attr_MALDruidWolfBeteAE">
                                    <option value="0" selected>0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                </select>
                            </div>
                        </div>
                        <div class="ligne2">
                            <span data-i18n="machine">Machine</span>
        
                            <div>
                                <input type="number" name="attr_MALDruidWolfMachineEvol" value="0" min="0" />
                            </div>
                            <div>
                                <select name="attr_MALDruidWolfMachineAE">
                                    <option value="0" selected>0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                </select>
                            </div>
                        </div>
                        <div class="ligne2">
                            <span data-i18n="dame">Dame</span>
        
                            <div>
                                <input type="number" name="attr_MALDruidWolfDameEvol" value="0" min="0" />
                            </div>
                            <div>
                                <select name="attr_MALDruidWolfDameAE">
                                    <option value="0" selected>0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                </select>
                            </div>
                        </div>
                        <div class="ligne2">
                            <span data-i18n="masque">Masque</span>
        
                            <div>
                                <input type="number" name="attr_MALDruidWolfMasqueEvol" value="0" min="0" />
                            </div>
                            <div>
                                <select name="attr_MALDruidWolfMasqueAE">
                                    <option value="0" selected>0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="companions cLabor">
                        <div class="tCompanions">
                            <h2 data-i18n="druid-companion-labor">Labor</h2>
                            <select name="attr_MALDWolfLaborNiveau">
                                <option value="1" data-i18n="druid-companion-niveau-1" selected>Niveau 1</option>
                                <option value="2" data-i18n="druid-companion-niveau-2">Niveau 2</option>
                                <option value="3" data-i18n="druid-companion-niveau-3">Niveau 3</option>
                            </select>
                        </div>
        
                        <span class="N1" data-i18n="druid-companion-labor-description-niveau-1">
                            Les actions du chevalier visant à porter de lourdes charges, à déplacer ou lever des poids reçoivent 1 dé par compagnon effectuant l’action de support. Chaque compagnon peut porter à lui seul 150 kg et peut donc transporter des choses pour le chevalier.
                        </span>
                        <span class="N2" data-i18n="druid-companion-labor-description-niveau-2">
                            Les actions du chevalier visant à porter de lourdes charges, à déplacer ou lever des poids reçoivent 2 dé par compagnon effectuant l’action de support. Chaque compagnon peut porter à lui seul 150 kg et peut donc transporter des choses pour le chevalier.
                        </span>
                        <span class="N3" data-i18n="druid-companion-labor-description-niveau-3">
                            Les actions du chevalier visant à porter de lourdes charges, à déplacer ou lever des poids reçoivent 3 dés par compagnon effectuant l’action de support. Chaque compagnon peut porter à lui seul 150 kg et peut donc transporter des choses pour le chevalier.
                        </span>
                    </div>
                    
                    <div class="companions cMedik mT">
                        <div class="tCompanions">
                            <h2 data-i18n="druid-companion-medik">Medik</h2>
                            <select name="attr_MALDWolfMedicNiveau">
                                <option value="1" data-i18n="druid-companion-niveau-1" selected>Niveau 1</option>
                                <option value="2" data-i18n="druid-companion-niveau-2">Niveau 2</option>
                                <option value="3" data-i18n="druid-companion-niveau-3">Niveau 3</option>
                            </select>
                        </div>
        
                        <span class="N1" data-i18n="druid-companion-medik-description-niveau-1">
                            Les actions du chevalier visant à soigner, à faire des recherches biologiques ou à reconnaitre un élément médical ou biologique reçoivent 1 dé supplémentaire par compagnon effectuant un support. Si le chevalier soigne un allié, celui-ci récupère 2 PS supplémentaires par compagnon effectuant un support.
                        </span>
                        <span class="N2" data-i18n="druid-companion-medik-description-niveau-2">
                            Les actions du chevalier visant à soigner, à faire des recherches biologiques ou à reconnaitre un élément médical ou biologique reçoivent 2 dés supplémentaire par compagnon effectuant un support. Si le chevalier soigne un allié, celui-ci récupère 2 PS supplémentaires par compagnon effectuant un support.
                        </span>
                        <span class="N3" data-i18n="druid-companion-medik-description-niveau-3">
                            Les actions du chevalier visant à soigner, à faire des recherches biologiques ou à reconnaitre un élément médical ou biologique reçoivent 3 dés supplémentaire par compagnon effectuant un support. Si le chevalier soigne un allié, celui-ci récupère 2 PS supplémentaires par compagnon effectuant un support.
                        </span>
                    </div>
                    
                    <div class="companions cTech mT">
                        <div class="tCompanions">
                            <h2 data-i18n="druid-companion-tech">Tech</h2>
                            <select name="attr_MALDWolfTechNiveau">
                                <option value="1" data-i18n="druid-companion-niveau-1" selected>Niveau 1</option>
                                <option value="2" data-i18n="druid-companion-niveau-2">Niveau 2</option>
                                <option value="3" data-i18n="druid-companion-niveau-3">Niveau 3</option>
                            </select>
                        </div>
        
                        <span class="N1" data-i18n="druid-companion-tech-description-niveau-1">
                            Les actions du chevalier visant à réparer un objet, un véhicule, un compagnon ou une méta-armure, à analyser un élément informatique ou électronique reçoivent 1 dé supplémentaire par compagnon effectuant un support. Le chevalier peut effectuer les réparations ou les analyses directement depuis un compagnon. Si le chevalier tente de réparer quelque chose (méta-armure, compagnon, véhicule) à l’aide de ses compagnons, les PA que la cible récupère sont augmentés de 3 par compagnon effectuant l’action de support.
                        </span>
                        <span class="N2" data-i18n="druid-companion-tech-description-niveau-2">
                            Les actions du chevalier visant à réparer un objet, un véhicule, un compagnon ou une méta-armure, à analyser un élément informatique ou électronique reçoivent 2 dés supplémentaire par compagnon effectuant un support. Le chevalier peut effectuer les réparations ou les analyses directement depuis un compagnon. Si le chevalier tente de réparer quelque chose (méta-armure, compagnon, véhicule) à l’aide de ses compagnons, les PA que la cible récupère sont augmentés de 3 par compagnon effectuant l’action de support.
                        </span>
                        <span class="N3" data-i18n="druid-companion-tech-description-niveau-3">
                            Les actions du chevalier visant à réparer un objet, un véhicule, un compagnon ou une méta-armure, à analyser un élément informatique ou électronique reçoivent 3 dés supplémentaire par compagnon effectuant un support. Le chevalier peut effectuer les réparations ou les analyses directement depuis un compagnon. Si le chevalier tente de réparer quelque chose (méta-armure, compagnon, véhicule) à l’aide de ses compagnons, les PA que la cible récupère sont augmentés de 3 par compagnon effectuant l’action de support.
                        </span>
                    </div>
                    
                    <div class="companions cFighter mT">
                        <div class="tCompanions">
                            <h2 data-i18n="druid-companion-fighter">Fighter</h2>
                            <select name="attr_MALDWolfFighterNiveau">
                                <option value="1" data-i18n="druid-companion-niveau-1" selected>Niveau 1</option>
                                <option value="2" data-i18n="druid-companion-niveau-2">Niveau 2</option>
                                <option value="3" data-i18n="druid-companion-niveau-3">Niveau 3</option>
                            </select>
                        </div>
        
                        <span class="N1" data-i18n="druid-companion-fighter-description-niveau-1">
                            Les actions de combat du chevalier contre un ennemi désigné aux compagnons reçoivent 1 dé supplémentaire par compagnon effectuant un support. La cible du chevalier doit être à portée courte et doit pouvoir être attaquée au contact. Si ces deux conditions sont respectées, la cible reçoit automatiquement l’effet barrage 1 par compagnon (3 compagnons supportant le chevalier infligent ainsi l’effet barrage 3). De plus, les compagnons infligent à la cible 1D6 points de dégâts ou de violence chacun (sans bonus) sans devoir effectuer de jet de dés pour toucher. On considère cependant que lorsqu’ils effectuent cette action de support, leur défense tombe à 0. Une seule cible à la fois peut subir cette action de support.
                        </span>
                        <span class="N2" data-i18n="druid-companion-fighter-description-niveau-2">
                            Les actions de combat du chevalier contre un ennemi désigné aux compagnons reçoivent 2 dés supplémentaire par compagnon effectuant un support. La cible du chevalier doit être à portée courte et doit pouvoir être attaquée au contact. Si ces deux conditions sont respectées, la cible reçoit automatiquement l’effet barrage 1 par compagnon (3 compagnons supportant le chevalier infligent ainsi l’effet barrage 3). De plus, les compagnons infligent à la cible 1D6 points de dégâts ou de violence chacun (sans bonus) sans devoir effectuer de jet de dés pour toucher. On considère cependant que lorsqu’ils effectuent cette action de support, leur défense tombe à 0. Une seule cible à la fois peut subir cette action de support.
                        </span>
                        <span class="N3" data-i18n="druid-companion-fighter-description-niveau-3">
                            Les actions de combat du chevalier contre un ennemi désigné aux compagnons reçoivent 3 dés supplémentaire par compagnon effectuant un support. La cible du chevalier doit être à portée courte et doit pouvoir être attaquée au contact. Si ces deux conditions sont respectées, la cible reçoit automatiquement l’effet barrage 1 par compagnon (3 compagnons supportant le chevalier infligent ainsi l’effet barrage 3). De plus, les compagnons infligent à la cible 1D6 points de dégâts ou de violence chacun (sans bonus) sans devoir effectuer de jet de dés pour toucher. On considère cependant que lorsqu’ils effectuent cette action de support, leur défense tombe à 0. Une seule cible à la fois peut subir cette action de support.
                        </span>
                    </div>
                    
                    <div class="companions cRecon mT">
                        <div class="tCompanions">
                            <h2 data-i18n="druid-companion-recon">Recon</h2>
                            <select name="attr_MALDWolfReconNiveau">
                                <option value="1" data-i18n="druid-companion-niveau-1" selected>Niveau 1</option>
                                <option value="2" data-i18n="druid-companion-niveau-2">Niveau 2</option>
                                <option value="3" data-i18n="druid-companion-niveau-3">Niveau 3</option>
                            </select>
                        </div>
        
                        <span class="N1" data-i18n="druid-companion-recon-description-niveau-1">
                            Toutes les actions d’observation, de vigilance ou de fouille menées par le chevalier reçoivent 1 dé supplémentaire par compagnon effectuant le support. Le chevalier peut observer, entendre, sentir et toucher directement depuis un des compagnons (au choix).
                        </span>
                        <span class="N2" data-i18n="druid-companion-recon-description-niveau-2">
                            Toutes les actions d’observation, de vigilance ou de fouille menées par le chevalier reçoivent 2 dés supplémentaire par compagnon effectuant le support. Le chevalier peut observer, entendre, sentir et toucher directement depuis un des compagnons (au choix).
                        </span>
                        <span class="N3" data-i18n="druid-companion-recon-description-niveau-3">
                            Toutes les actions d’observation, de vigilance ou de fouille menées par le chevalier reçoivent 3 dés supplémentaire par compagnon effectuant le support. Le chevalier peut observer, entendre, sentir et toucher directement depuis un des compagnons (au choix).
                        </span>
                    </div>
                </div>
            </div>

            <div class="fichePJ DCCrow">
                <input class="subMenu" type="hidden" name="attr_MALTabDruidCrow" value="0" />

                <h1 class="titre" data-i18n="druid-companion-crow">Crow</h1>

                <div class="col4">
                    <h1 class="titre" data-i18n="aspects">Aspects</h1>

                    <div class="ligne aspect">
                        <span data-i18n="chair">Chair</span>

                        <div class="blockR">
                            <input type="number" name="attr_MALDruidCrowChairTot" value="@{MALDruidCrowChairBase}+@{MALDruidCrowChairEvol}" disabled />
                            <button class="rollDice" name="act_MALDruidCrowChairRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-crow}}} {{special1=@{name}}}"></button>
                        </div>
                    </div>
                    <div class="ligne aspect">
                        <span data-i18n="bete">Bête</span>

                        <div class="blockR">
                            <input type="number" name="attr_MALDruidCrowBeteTot" value="@{MALDruidCrowBeteBase}+@{MALDruidCrowBeteEvol}" disabled />
                            <button class="rollDice" name="act_MALDruidCrowBeteRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-crow}}} {{special1=@{name}}}"></button>
                        </div>
                    </div>
                    <div class="ligne aspect">
                        <span data-i18n="machine">Machine</span>

                        <div class="blockR">
                            <input type="number" name="attr_MALDruidCrowMachineTot" value="@{MALDruidCrowMachineBase}+@{MALDruidCrowMachineEvol}" disabled />
                            <button class="rollDice" name="act_MALDruidCrowMachineRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-crow}}} {{special1=@{name}}}"></button>
                        </div>
                    </div>
                    <div class="ligne aspect">
                        <span data-i18n="dame">Dame</span>

                        <div class="blockR">
                            <input type="number" name="attr_MALDruidCrowDameTot" value="@{MALDruidCrowDameBase}+@{MALDruidCrowDameEvol}" disabled />
                            <button class="rollDice" name="act_MALDruidCrowDameRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-crow}}} {{special1=@{name}}}"></button>
                        </div>
                    </div>
                    <div class="ligne aspect">
                        <span data-i18n="masque">Masque</span>
                        
                        <div class="blockR">
                            <input type="number" name="attr_MALDruidCrowMasqueTot" value="@{MALDruidCrowMasqueBase}+@{MALDruidCrowMasqueEvol}" disabled />
                            <button class="rollDice" name="act_MALDruidCrowMasqueRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-crow}}} {{special1=@{name}}}"></button>
                        </div>
                    </div>
                </div>

                <div class="col4BL">
                    <h1 class="titre" data-i18n="valeurs-derivees">Valeurs Dérivées</h1>

                    <div class="ligne defense">
                        <span data-i18n="defense">Défense</span>

                        <div class="blockR">
                            <input type="number" name="attr_MALDruidCrowDefenseTot" value="2" disabled />
                        </div>
                    </div>
                    <div class="ligne reaction">
                        <span data-i18n="reaction">Réaction</span>

                        <div class="blockR">
                            <input type="number" name="attr_MALDruidCrowReactionTot" value="2" disabled />
                        </div>
                    </div>
                    <div class="ligne initiative">
                        <span data-i18n="initiative">Initiative</span>

                        <div class="blockR">
                            <input type="number" name="attr_MALDruidCrowInitiativeTot" value="1" disabled />
                            <button class="rollDice" type="action" name="act_MALDruidCrowInitiativeRoll" value="@{jetGM} &{template:simple} {{Nom=Crow}} {{special1=@{name}}}"></button>
                        </div>
                    </div>
                    <div class="ligne cohesion">
                        <span data-i18n="cohesion">Cohésion</span>

                        <div class="blockR">
                            <input type="number" name="attr_MALDruidCrowCoAct" value="50" /> 
                            <b>/</b>
                            <input type="number" name="attr_MALDruidCrowCoTot" value="50*2" disabled />
                        </div>
                    </div>
                    <div class="ligne debordement">
                        <span data-i18n="debordement">Débordement</span>

                        <div class="blockR">
                            <input type="number" name="attr_MALDruidCrowDebordementTot" value="2*2" disabled />
                        </div>
                    </div>
                </div>

                <div class="col4BL">
                    <h1 class="titre" data-i18n="champ-de-force">Champ de Force</h1>
                    <div class="ligne CDF">
                        <input type="number" name="attr_MALDruidCrowCDFTot" value="2*2" disabled />
                    </div>

                    <h1 class="titre" data-i18n="debordement">Débordement</h1>
                    <div class="ligne tourCombat">
                        <span data-i18n="tours-de-combat">Tours de combat</span>

                        <div class="blockR">
                            <input type="number" name="attr_MALDruidCrowTAttaque" value="1" min="1" />
                            <button class="rollDice" type="action" name="act_MALDruidCrowAttaque" value="@{jetGM} &{template:combat} {{Nom=^{druid-companion-crow}}} {{special1=@{name}}}"></button>
                        </div>
                    </div>
                </div>

                <h1 class="titre" data-i18n="specificites">Spécificités</h1>
                <span class="specificites" data-i18n="druid-companion-crow-specificite">La bande est équipée d'un module de vol niveau 3 constamment activé qui ne coûte aucune énergie.
                    <br/>
                    Les points de dégâts qui lui sont infligés lui font perdre de la cohésion.
                </span>

                <div class="subMenu">
                    <button class="evolutions" type="action" name="act_MALTabDruidCrow_3" data-i18n="evolutions">Evolutions</button>
                </div>

                <div class="evolutions">
                    <input type="hidden" name="attr_MALDruidCrowChairBase" value="6" disabled />
                    <input type="hidden" name="attr_MALDruidCrowBeteBase" value="4" disabled />
                    <input type="hidden" name="attr_MALDruidCrowMachineBase" value="4" disabled />
                    <input type="hidden" name="attr_MALDruidCrowDameBase" value="0" disabled />
                    <input type="hidden" name="attr_MALDruidCrowMasqueBase" value="6" disabled />
        
                    <div class="aspects">
                        <div class="ligneTitre">
                            <span></span>
                            <span data-i18n="aspects">Aspects</span>
                        </div>
                        <label class="ligne1">
                            <span data-i18n="chair">Chair</span>
        
                            <div>
                                <input type="number" name="attr_MALDruidCrowChairEvol" value="0" min="0" />
                            </div>
                        </label>
                        <label class="ligne1">
                            <span data-i18n="bete">Bête</span>
        
                            <div>
                                <input type="number" name="attr_MALDruidCrowBeteEvol" value="0" min="0" />
                            </div>
                        </label>
                        <label class="ligne1">
                            <span data-i18n="machine">Machine</span>
        
                            <div>
                                <input type="number" name="attr_MALDruidCrowMachineEvol" value="0" min="0" />
                            </div>
                        </label>
                        <label class="ligne1">
                            <span data-i18n="dame">Dame</span>
        
                            <div>
                                <input type="number" name="attr_MALDruidCrowDameEvol" value="0" min="0" />
                            </div>
                        </label>
                        <label class="ligne1">
                            <span data-i18n="masque">Masque</span>
        
                            <div>
                                <input type="number" name="attr_MALDruidCrowMasqueEvol" value="0" min="0" />
                            </div>
                        </label>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
  <div class="tabCombat tab"><div class="col">
    <div class="fichePJ armure dataArmure">
        <div class="fichePJ titre">
            <h1 class="fichePJ titre"><span name="attr_armure" data-i18n-dynamic></span></h1>
            <button class="actionSpecial" type="action" name="act_resetArmure" data-i18n="tout-restaurer">Tout Restaurer</button>
        </div>
        <div class="ligneTitre">
            <span></span>
            <span data-i18n="actuel">Actuel</span>
            <span data-i18n="maximum">Maximum</span>
            <span data-i18n="modif">Modif</span>
        </div>
        <div class="ligne3 armure">
            <span data-i18n="armure">Armure</span>
            <div><input type="number" name="attr_armurePJ" value="0" /></div>
            <div><input type="number" name="attr_armurePJ_max" value="0" readonly /></div>
            <div><input type="number" name="attr_armurePJModif" value="0" /></div>
        </div>
        <div class="barbarian bard druid monk necromancer paladin priest psion ranger rogue shaman sorcerer warlock warmaster warrior wizard ligne3">
            <span data-i18n="energie">Energie</span>
            <div><input type="number" name="attr_energiePJ" value="0" /></div>
            <div><input type="number" name="attr_energiePJ_max" value="0" readonly /></div>
            <div><input type="number" name="attr_energiePJModif" value="0" /></div>
        </div>
        <div class="ligne3 armure">
            <span data-i18n="champ-de-force">Champ de force</span>
            <div><input type="number" name="attr_cdfPJ" value="0" readonly /></div>
            <div><input type="number" name="attr_cdfPJ_max" value="0" readonly /></div>
            <div><input type="number" name="attr_cdfPJModif"  value="0" /></div>
        </div>
        <div class="psion flux ligne1">
            <span data-i18n="flux">Flux</span>
            <div><input type="number" class="center" min="0" name="attr_fluxPsion" value="0" /></div>
            <div></div>
            <div></div>
        </div>
    </div>

    <div class="fichePJ sorcerer sorcererPE">
        <h1 data-i18n="sorcerer-ponctionner-l'energie">Ponctionner l'énergie</h1>
        <select name="attr_sorcererPEnergie">
            <option value="1" selected>1D6</option>
            <option value="2">2D6</option>
            <option value="3">3D6</option>
        </select>
        <button class="rollDice" type="roll" name="roll_PEnergieSorc" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special2=^{sorcerer-ponctionner-l'energie}}} {{jDivers=^{energie-ponctionnee}}} {{jDiversV=[[(@{sorcererPEnergie})D6]]}}"></button>
    </div>
    
    <div class="fichePJ physiqueMental">
        <h1 class="fichePJ titre" data-i18n="physique-et-mental">Physique et Mental</h1>
        <div class="ligneTitre">
            <span></span>
            <span data-i18n="actuel">Actuel</span>
            <span data-i18n="maximum">Maximum</span>
            <span data-i18n="modif">Modif</span>
        </div>
        <div class="ligne3">
            <span data-i18n="sante">Santé</span>
            <div><input type="number" name="attr_santepj" min="0" value="0" /></div>
            <div><input type="number" name="attr_santepj_max" min="0" value="0" readonly /></div>
            <div><input type="number" name="attr_santeModif" min="0" value="0" /></div>
        </div>
        <div class="ligne3">
            <span data-i18n="espoir">Espoir</span>
            <div><input type="number" name="attr_espoir" min="0" value="50" /></div>
            <div><input type="number" name="attr_espoir_max" min="0" value="50" readonly /></div>
            <div><input type="number" name="attr_espoirModif" value="0" /></div>
        </div>
        <div class="ligne3">
            <span data-i18n="heroisme">Héroïsme</span>
            <div><input type="number" name="attr_heroisme" min="0" max="6" value="0" /></div>
            <div><input type="number" name="attr_heroisme_max" min="0" value="6+@{heroismeModif}" disabled /></div>
            <div><input type="number" name="attr_heroismeModif" min="0" value="0" /></div>
        </div>
    </div>

    <div class="fichePNJ ficheCreature ficheBande PES">
        <h1 class="fichePNJ titre" data-i18n="protection-energie-sante">Protections, Énergie et Santé</h1>
        <h1 class="ficheCreature titre" data-i18n="protection-sante">Protections et Santé</h1>
        <h1 class="ficheBande titre" data-i18n="protection-cohension">Protections et Cohésion</h1>
        <div class="ligneTitre">
            <span></span>
            <span data-i18n="actuel">Actuel</span>
            <span data-i18n="maximum">Maximum</span>
        </div>
        <div class="ligne2">
            <span class="fichePNJ ficheCreature ficheBande" data-i18n="armure">Armure</span>
            <div><input type="number" name="attr_armurePNJ" min="0" value="0" /></div>
            <div><input type="number" name="attr_armurePNJ_max" min="0" value="0" /></div>
        </div>
        <div class="fichePNJ ligne2">
            <span class="fichePNJ" data-i18n="energie">Energie</span>
            <div><input type="number" name="attr_energiePNJ" min="0" value="0" /></div>
            <div><input type="number" name="attr_energiePNJ_max" min="0" value="0" /></div>
        </div>
        <div class="fichePNJ ligne2">
            <span class="fichePNJ" data-i18n="champ-de-force">Champ de force</span>
            <div><input type="number" name="attr_cdfPNJ" min="0" value="0" /></div>
            <div><input type="number" name="attr_cdfPNJ_max" min="0" value="0" /></div>
        </div>
        <div class="ligne2">
            <span class="fichePNJ ficheCreature ficheBande" data-i18n="bouclier">Bouclier</span>
            <div><input type="number" name="attr_bouclierPNJ" min="0" value="0" /></div>
            <div><input type="number" name="attr_bouclierPNJ_max" min="0" value="0" /></div>
        </div>
        <div class="ligne2">
            <span class="fichePNJ ficheCreature" data-i18n="sante">Santé</span>
            <span class="ficheBande" data-i18n="cohesion">Cohésion</span>
            <div><input type="number" name="attr_santePNJ" min="0" value="0" /></div>
            <div><input type="number" name="attr_santePNJ_max" min="0" value="0" /></div>
        </div>
        <div class="fichePNJ ficheCreature resilience">
            <div>
                <span data-i18n="resilience">Résilience</span>
                <button type="action" name="act_calculerResilience" data-i18n="calculer">Calculer</button>
            </div>
            <div><input type="number" name="attr_resilience" min="0" value="0" /></div>
            <div><input type="number" name="attr_resilience_max" min="0" value="0" /></div>
        </div>
    </div>

    <div class="fichePJ egide">
        <div class="fichePJ titre">
            <h1 class="fichePJ titre" data-i18n="egide">Égide</h1>
            <button type="roll" class="rollDice" name="roll_egide" value="@{jetGM} &{template:base} {{Nom=@{name}}} {{type=^{egide}}} {{jet=[[{[[@{egideTotal}]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}"></button>
        </div>
        <div class="ligneTitre">
            <span data-i18n="base">Base</span>
            <span data-i18n="bonus">Bonus</span>
            <span data-i18n="total">Total</span>
        </div>
        <div class="ligne3">
            <div><input type="number" name="attr_egide" value="0" /></div>
            <div><input type="number" name="attr_egideBonus" value="0" readonly /></div>
            <div><input type="number" name="attr_egideTotal" value="@{egide}+@{egideBonus}" disabled /></div>
        </div>
    </div>
                
    <div class="ficheBande bandeDebordement">
        <div class="ficheBande titre">
            <h1 class="ficheBande titre" data-i18n="debordement">Débordement</h1>
            <button class="rollDice" type="roll" name="attr_jetBande"" value="@{jetGM} &{template:bande} {{Nom=@{name}}} {{Debordement=[[@{bandeDebordement}*@{bandeDebordementTActuel}]]}}" ></button>
        </div>
        <div class="ligneTitre">
            <span data-i18n="score">Score</span>
            <span data-i18n="tour-actuel">Tour Actuel</span>
        </div>
        <div class="ligne2">
            <div><input type="number" name="attr_bandeDebordement" min="0" value="0" /></div>
            <div><input type="number" name="attr_bandeDebordementTActuel" min="0" value="0" /></div>
        </div>
    </div>
</div>

<div class="col">
        <div class="fichePJ nods">
            <h1 class="titre" data-i18n="nods">Nods</h1>
            <div class="ligne">
                <span data-i18n="nods-soin">Soin</span>
                <div class="blockM">
                    <input type="number" value="3" name="attr_nodsSoin" />
                    <b>/</b>
                    <input type="number" value="3" name="attr_nodsSoin_max" />
                </div>
                <button class="rollDice" type="action" name="act_nodsSoin" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special2=^{nod-soin}}}"></button>
            </div>
            <div class="ligne">
                <span data-i18n="nods-armure">Armure</span>
                <div class="blockM">
                    <input type="number" value="3" name="attr_nodsArmure" />
                    <b>/</b>
                    <input type="number" value="3" name="attr_nodsArmure_max" />
                </div>
                <button class="rollDice" type="action" name="act_nodsArmure" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special2=^{nod-d'armure}}}"></button>
            </div>
            <div class="ligne">
                <span data-i18n="nods-energie">Energie</span>
                <div class="blockM">
                    <input type="number" value="3" name="attr_nodsEnergie" />
                    <b>/</b>
                    <input type="number" value="3" name="attr_nodsEnergie_max" />
                </div>
                <button class="rollDice" type="action" name="act_nodsEnergie" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special2=^{nod-d'energie}}}"></button>
            </div>
        </div>

        <div class="fichePJ styleCombat">		
            <h1 class="titre" data-i18n="style-de-combat">Style de Combat</h1>
            <select name="attr_styleCombat">
                <option value="standard" data-i18n="standard" selected>Standard</option>
                <option value="couvert" data-i18n="couvert">À Couvert</option>
                <option value="agressif" data-i18n="agressif">Agressif</option>
                <option value="akimbo" data-i18n="akimbo">Akimbo</option>
                <option value="ambidextre" data-i18n="ambidextre">Ambidextre</option>
                <option value="defensif" data-i18n="defensif">Défensif</option>
                <option value="precis" data-i18n="precis">Précis</option>
                <option value="pilonnage" data-i18n="pilonnage">Pilonnage</option>
                <option value="puissant" data-i18n="puissant">Puissant</option>
                <option value="suppression" data-i18n="suppression">Suppression</option>
            </select>
            <input type="hidden" name="attr_styleCombat" value="standard" />
            <div class="puissant">
                <span data-i18n="bonus-en">Bonus en</span>
                <select name="attr_stylePuissantType">
                    <option value="{{stylePuissantD=[[@{stylePuissantBonus}D6]]}}" data-i18n="degats" selected>Dégâts</option>
                    <option value="{{stylePuissantV=[[@{stylePuissantBonus}D6]]}}" data-i18n="violence">Violence</option>
                </select>
                <input type="number" name="attr_stylePuissantBonus" value="0" min="0" max="6" />
            </div>
            <div class="suppression">
                <label>
                    <span>Malus aux dégâts</span>
                    <input type="number" name="attr_styleSuppressionD" value="0" min="0" max="6" />
                </label>

                <label>
                    <span>Malus à la violence</span>
                    <input type="number" name="attr_styleSuppressionV" value="0" min="0" max="8" />
                </label>
            </div>
            <div class="autoex autoex40">
                <span name="attr_styleCombatDescr"></span>
                <textarea name="attr_styleCombatDescr" readonly></textarea>
            </div>
        </div>

        <div class="ficheCreature portee">
            <h1 class="titre" data-i18n="portee">Portée</h1>
            <div class="col5">
                <span data-i18n="portee-contact">Contact</span>
                <span data-i18n="portee-0-2">0 à 2m</span>
            </div>
            <div class="col5BL">
                <span data-i18n="portee-courte">Courte</span>
                <span data-i18n="portee-2-15">2 à 15m</span>
            </div>
            <div class="col5BL">
                <span data-i18n="portee-moyenne">Moyenne</span>
                <span data-i18n="portee-15-50">15 à 50m</span>
            </div>
            <div class="col5BL">
                <span data-i18n="portee-longue">Longue</span>
                <span data-i18n="portee-50-300">50 à 300m</span>
            </div>
            <div class="col5BL">
                <span data-i18n="portee-lointaine">Lointaine</span>
                <span data-i18n="portee-+300">+ de 300m</span>
            </div>
        </div>

        <div class="fichePNJ ficheCreature egide">
            <div class="fichePNJ ficheCreature titre">
                <h1 class="fichePNJ ficheCreature titre" data-i18n="egide">Égide</h1>
                <button type="roll" class="rollDice" name="roll_egide" value="@{jetGM} &{template:base} {{Nom=@{name}}} {{type=^{egide}}} {{jet=[[{[[@{egideTotal}]]d6cs2cs4cs6cf1cf3cf5s%2}=0]]}}"></button>
            </div>
            <div class="ligneTitre">
                <span data-i18n="base">Base</span>
                <span data-i18n="bonus">Bonus</span>
                <span data-i18n="total">Total</span>
            </div>
            <div class="ligne3">
                <div><input type="number" name="attr_egide" value="0" /></div>
                <div><input type="number" name="attr_egideBonus" value="0" readonly /></div>
                <div><input type="number" name="attr_egideTotal" value="@{egide}+@{egideBonus}" disabled /></div>
            </div>
        </div>

        <label class="fichePJ fichePNJ ficheCreature BMJets">
            <span data-i18n="bonus/malus-jets">Bonus/Malus aux Jets</span>
            <input type="number" name="attr_jetModifDes" value="0" />
        </label>

        <div class="fichePJ herauts">
            <h1 class="titre">Chevalier de la lumière / Hérauts de l'équilibre</h1>
            <div>
                <input type="hidden" name="attr_devasterAnatheme" class="devasterAnatheme" value="0" />
                <input type="hidden" name="attr_bourreauTenebres" class="bourreauTenebres" value="0" />
                <input type="hidden" name="attr_equilibreBalance" class="equilibreBalance" value="0" />

                <button type="action" name="act_devasterAnatheme" class="devasterAnatheme" >Dévaster l'Anathème actif</button>
                <button type="action" name="act_bourreauTenebres" class="bourreauTenebres" >Bourreau des ténèbres actif</button>
                <button type="action" name="act_equilibreBalance" class="equilibreBalance" >Équilibrer la balance actif</button>
            </div>
        </div>
    </div>
    <input class="subTabDistance" type="hidden" name="attr_tabDistance" value="1"/>
    <input class="subTabMelee" type="hidden" name="attr_tabMelee" value="2"/>
    <input class="subTabAutre" type="hidden" name="attr_tabAutre" value="3"/>
    <input class="subTabDefensif" type="hidden" name="attr_tabEquipementDefensif" value="4"/>
    <input class="subTabArmure" type="hidden" name="attr_tabCapaciteArmure" value="0"/>
    <input class="subTabImprovisee" type="hidden" name="attr_tabArmesImprovisees" value="6"/><div class="subTab">
    <button class="subTabArmure BLR" type="action" name="act_tabCapaciteArmure_5">
        <span class="barbarian" data-i18n="barbarian">Barbarian</span>
        <span class="bard" data-i18n="bard">Bard</span>
        <span class="berserk" data-i18n="berserk">Berserk</span>
        <span class="druid" data-i18n="druid">Druid</span>
        <span class="monk" data-i18n="monk">Monk</span>
        <span class="necromancer" data-i18n="necromancer">Necromancer</span>
        <span class="paladin" data-i18n="paladin">Paladin</span>
        <span class="priest" data-i18n="priest">Priest</span>
        <span class="psion" data-i18n="psion">Psion</span>
        <span class="ranger" data-i18n="ranger">Ranger</span>
        <span class="rogue" data-i18n="rogue">Rogue</span>
        <span class="shaman" data-i18n="shaman">Shaman</span>
        <span class="sorcerer" data-i18n="sorcerer">Sorcerer</span>
        <span class="warlock" data-i18n="warlock">Warlock</span>
        <span class="warmaster" data-i18n="warmaster">Warmaster</span>
        <span class="warrior" data-i18n="warrior">Warrior</span>
        <span class="wizard" data-i18n="wizard">Wizard</span>
        <span class="fichePNJ ficheCreature ficheBande" data-i18n="capacites">Capacités</span>
    </button>

    <button class="subTabMelee" type="action" name="act_tabMelee_2" data-i18n="armes-contact">Armes de Contact</button>
    <button class="subTabDistance BL" type="action" name="act_tabDistance_1" data-i18n="armes-distance">Armes à Distance</button>
    <button class="subTabImprovisee BL" type="action" name="act_tabArmesImprovisees_6" data-i18n="armes-improvisees">Armes Improvisées</button>
    <button class="subTabAutre BLR" type="action" name="act_tabAutre_3" data-i18n="autres-armes">Autres Armes</button>
    <button class="subTabDefensif BLRWLL NBT" type="action" name="act_tabEquipementDefensif_4" data-i18n="protections">Protections</button>
</div><div class="fichePJ subTabArmure">
        <div class="col">
            <div class="fichePJ barbarian barbarianGoliath marginTop">
                <h1 class="titre" data-i18n="barbarian-mode-goliath">Mode Goliath</h1>
    
                <label class="ligne">
                    <span data-i18n="taille-bonus">Taille Bonus</span>
                    <input type="number" name="attr_barbarianGoliath" min="0" value="0" />
                </label>
    
                <h1 class="titre" data-i18n="malus">Malus</h1>
    
                <label class="col">
                    <span data-i18n="defense">Défense</span>
                    <input type="text" name="attr_barbarianDef" readonly />
                </label>
                <label class="colBL">
                    <span data-i18n="reaction">Réaction</span>
                    <input type="text" name="attr_barbarianRea" readonly />
                </label>
            </div>

            <div class="fichePJ bard bardChangeling marginTop">
                <input class="bard250" type="hidden" name="attr_bard250PG" value="0" />
                
                <input class="active" type="hidden" name="attr_bardChangeling" value=""/>
                <div class="titre firstTitre">               
                    <h1 class="titre" data-i18n="mode-changeling">Mode Changeling</h1>
                    <button class="active" type="action" name="act_bardChangeling" data-i18n="activer">Activer</button>
                </div>

                <h1 class="titre" data-i18n="bard-apparence">Apparence</h1>
                <div class="autoex autoex28">
                    <span name="attr_apparenceBard"></span>
                    <textarea name="attr_apparenceBard"></textarea>
                </div>
            </div>

            <div class="fichePJ berserk berserkIllumination marginTop">
                <h1 class="titre" data-i18n="berserk-mode-illumination">Mode Illumination</h1>
                <h2 class="titreBis" data-i18n="berserk-selection-effets">Sélection des Effets</h2>
    
                <input class="blaze" type="hidden" name="attr_berserkBlaze" />
                <input class="candle" type="hidden" name="attr_berserkCandle" />
                <input class="beacon" type="hidden" name="attr_berserkBeacon" />
                <input class="torch" type="hidden" name="attr_berserkTorch" />
                <input class="projector" type="hidden" name="attr_berserkProjector" />
                <input class="lighthouse" type="hidden" name="attr_berserkLighthouse" />
                <input class="lantern" type="hidden" name="attr_berserkLantern" />
    
                <div class="button">
                    <button class="blaze" type="action" name="act_berserkBlaze" data-i18n-title="berserk-illumination-blaze" >Blaze</button>
                    <button class="candle" type="action" name="act_berserkCandle" data-i18n-title="berserk-illumination-candle" >Candle</button>
                    <button class="beacon" type="action" name="act_berserkBeacon" data-i18n-title="berserk-illumination-beacon" >Beacon</button>
                    <button class="torch" type="action" name="act_berserkTorch" data-i18n-title="berserk-illumination-torch" >Torch</button>
                    <button class="projector" type="action" name="act_berserkProjector" data-i18n-title="berserk-illumination-projector" >Projector</button>
                    <button class="lighthouse" type="action" name="act_berserkLighthouse" data-i18n-title="berserk-illumination-lighthouse" >Lighthouse</button>
                    <button class="lantern" type="action" name="act_berserkLantern" data-i18n-title="berserk-illumination-lantern" >Lantern</button>
                </div>
                
                <div class="blaze titre">
                    <h1 class="titre" data-i18n="berserk-illumination-blaze">Blaze</h1>
                    <button class="rollDice" type="action" name="act_berserkIlluminationBlaze" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=^{berserk-illumination-blaze}}}"></button>
                </div>
                <label class="blaze col3">
                    <span data-i18n="degats">Dégâts</span>
                    <input type="text" name="attr_berserkIlluminationBlazeDgts" value="2D6" readonly />
                </label>
                <label class="blaze col3BL">
                    <span data-i18n="violence">Violence</span>
                    <input type="text" name="attr_berserkIlluminationBlazeViolence" value="2D6" readonly />
                </label>
                <label class="blaze col3BL">
                    <span data-i18n="portee">Portée</span>
                    <input type="text" name="attr_berserkIlluminationBlazePortee" value="Contact" readonly />
                </label>
                
                <div class="candle titre">
                    <h1 class="titre" data-i18n="berserk-illumination-candle">Candle</h1>
                    <button class="rollDice" type="action" name="act_berserkIlluminationCandle" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{berserk-illumination-candle}}} {{jDivers=^{espoir-sacrifie-donne}}} {{jDiversV=[[@{berserkIlluminationCandleEspoir}]]}}"></button>
                </div>
                <label class="candle col1">
                    <span data-i18n="espoir-sacrifie-donne">Espoir sacrifié/donné</span>
                    <input type="text" name="attr_berserkIlluminationCandleEspoir" value="1D3" readonly />
                </label>
                
                <div class="beacon titre">
                    <input type="hidden" name="attr_berserkIlluminationBeaconA" />
    
                    <h1 class="titre" data-i18n="berserk-illumination-beacon">Beacon</h1>
                    <button class="active" type="action" name="act_berserkIlluminationBeaconA" data-i18n="activer">Activer</button>
                </div>
                <label class="beacon col2">
                    <span data-i18n="bonus-jets-allies">Bonus aux jets alliés</span>
                    <input type="text" name="attr_berserkIlluminationBeaconBonus" value="2 réussites automatiques" readonly  />
                </label>
                <label class="beacon col2BL">
                    <span data-i18n="portee">Portée</span>
                    <input type="text" name="attr_berserkIlluminationBeaconPortee" value="Courte" readonly  />
                </label>
                
                <div class="torch titre">
                    <input type="hidden" name="attr_berserkIlluminationTorchA" />
    
                    <h1 class="titre" data-i18n="berserk-illumination-torch">Torch</h1>
                    <button class="active" type="action" name="act_berserkIlluminationTorchA" data-i18n="activer">Activer</button>
                </div>
                <label class="torch col2">
                    <span data-i18n="bonus-egide">Bonus à l'égide</span>
                    <input type="text" name="attr_berserkIlluminationTorchEgide" value="2" readonly />
                </label>
                <label class="torch col2BL">
                    <span data-i18n="portee">Portée</span>
                    <input type="text" name="attr_berserkIlluminationTorchPortee" value="Courte" readonly />
                </label>
    
                <div class="projector titre">
                    <input type="hidden" name="attr_berserkIlluminationProjectorA" />
    
                    <h1 class="titre" data-i18n="berserk-illumination-projector">Projector</h1>
                    <button class="active" type="action" name="act_berserkIlluminationProjectorA" data-i18n="activer">Activer</button>
                </div>
                <label class="projector col2">
                    <span data-i18n="capacite">Capacité</span>
                    <input type="text" name="attr_berserkIlluminationProjectorCapacite" value="" />
                </label>
                <label class="projector col2BL">
                    <span data-i18n="portee">Portée</span>
                    <input type="text" name="attr_berserkIlluminationProjectorPortee" value="Courte" readonly  />
                </label>
    
                <div class="lighthouse titre">
                    <input type="hidden" name="attr_berserkIlluminationLighthouseA" />
    
                    <h1 class="titre" data-i18n="berserk-illumination-lighthouse">Lighthouse</h1>
                    <button class="active" type="action" name="act_berserkIlluminationLighthouseA" data-i18n="activer">Activer</button>
                </div>
                <label class="lighthouse col1">
                    <span data-i18n="portee">Portée</span>
                    <input type="text" name="attr_berserkIlluminationLighthousePortee" value="Courte" readonly  />
                </label>
                
                <div class="lantern titreInverse">
                    <input type="hidden" name="attr_berserkIlluminationLanternA" />
    
                    <button class="active" type="action" name="act_berserkIlluminationLanternA" data-i18n="activer">Activer</button>
                    <h1 class="titre" data-i18n="berserk-illumination-lantern">Lantern</h1>
                    <button class="rollDice" type="action" name="act_berserkIlluminationLantern" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=^{berserk-illumination-lantern}}}"></button>
                </div>
                <label class="lantern col2">
                    <span data-i18n="degats">Dégâts</span>
                    <input type="text" name="attr_berserkIlluminationLanternDgts" value="1D6" readonly />
                </label>    
                <label class="lantern col2BL">
                    <span data-i18n="portee">Portée</span>
                    <input type="text" name="attr_berserkIlluminationLanternPortee" value="Courte" readonly />
                </label>
                <input class="lantern ligne" type="text" name="attr_berserkIlluminationLanternEffets" value="Espérance" readonly  />
            </div>

            <div class="fichePJ druid druidModJetCompagnons marginTop">
                <h1 class="titre" data-i18n="bonus/malus-aux-jets-des-compagnons">Bonus/Malus aux Jets des Compagnons</h1>
                <input type="number" name="attr_jetModifDesComp" value="0" />
            </div>

            <div class="fichePJ monk monkModeZen marginTop">
                <div class="titre">
                    <h1 class="titre" data-i18n="mode-zen">Mode Zen</h1>
                    <button class="rollDice" type="action" name="act_jetModeZen" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{mode-zen}}}"></button>
                </div>
                <div class="ligne">
                    <span data-i18n="espoir-potentiellement-recuperable">Espoir potentiellement récupérable :</span>
                    <input type="number" name="attr_monkEspoirPerdu" value="0" min="0" />
                </div>
                <input class="col2" type="number" name="attr_monkModeZen" data-i18n-title="total-hargne-sang-froid" title="Total Hargne + Sang-Froid" value="@{hargne}+@{sf}" disabled />
                <input class="col2" type="number" name="attr_monkModeZenOD" data-i18n-title="total-od-hargne-sang-froid" title="Total OD Hargne + Sang-Froid" value="@{hargneOD}+@{sfOD}" disabled />
            </div>

            <div class="fichePJ monk monkModeCea marginTop">    
                <input type="hidden" name="attr_bonusCarac" class="bonusCarac" value="0" />
    
                <div class="titre borderBottom">
                    <h1 class="titre" data-i18n="monk-mode-cea">Mode Céa</h1>
                </div>

                <div class="titre">
                    <h1 class="titre" data-i18n="monk-rayon-d'energie">Rayon d'énergie</h1>
                    <button class="rollDice" type="action" name="act_monkJetRayonSpe" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=^{monk-rayon-d'energie}}}"></button>
                </div>
                <label class="col4">
                    <span data-i18n="degats">Dégâts</span>
                    <input type="text" name="attr_monkRayonDegat" value="4D6" readonly />
                </label>
                <label class="col4BL">
                    <span data-i18n="violence">Violence</span>
                    <input type="text" name="attr_monkRayonViolence" value="2D6" readonly />
                </label>
                <label class="col4BL">
                    <span data-i18n="energie">Énergie</span>
                    <input type="text" name="attr_monkRayonEnergie" value="3" disabled />
                </label>
                <label class="col4BL">
                    <span data-i18n="portee">Portée</span>
                    <input type="text" name="attr_monkRayonPortee" value="Moyenne" readonly />
                </label>
                <input class="ligne" type="text" name="attr_monkRayonEffets" value="Parasitage 1 / Perce Armure 40" readonly />
                <label class="ligne2Special">
                    <span data-i18n="maintenu-sur-un-ennemi-pendant-tour">Maintenu sur un ennemi pendant (en tour) :</span>
                    <input type="number" name="attr_monkRayonTour" class="textCenter" value="0" min="0" />
                </label>
            </div>

            <div class="fichePJ paladin paladinShrine marginTop">
                <input class="active" type="hidden" name="attr_paladinCdFShrine" />
    
                <div class="titre">
                    <h1 class="titre" data-i18n="paladin-champ-de-force-shrine">Champ de Force Shrine</h1>
                    <button class="active" type="action" name="act_paladinCdFShrine" data-i18n="activer">Activer</button>
                </div>
                <label class="col3">
                    <span data-i18n="bonus-cdf">Bonus de CdF</span>
                    <input type="number" name="attr_paladinCdFShrineValue" value="6+@{paladin200PG}" disabled />
                </label>
                <label class="col3BL">
                    <span data-i18n="force-requise">Force Requise</span>
                    <input type="number" name="attr_paladinCdFShrineForceValue" value="5" disabled />
                </label>
                <label class="col3BL">
                    <span data-i18n="chair-requise">Chair Requise</span>
                    <input type="number" name="attr_paladinCdFShrineChairValue" value="10" disabled />
                </label>
            </div>

            <div class="fichePJ priest priestMechanic marginTop">
                <h1 class="titre" data-i18n="priest-mode-mechanic">Mode Mechanic</h1>
                <div>
                    <span data-i18n="portee-contact">Contact</span>
                    <input type="text" name="attr_priestMechanicContact" value="3D6+6" readonly />
                    <button class="rollDice" type="action" name="act_priestJetMechanicContact" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{priest-mode-mechanic-contact}}} {{jDivers=^{reparation}}} {{jDiversV=[[@{priestMechanicContact}]]}}"></button>
                </div>
                <div>
                    <span data-i18n="distance-portee-longue">Distance (Portée Longue)</span>
                    <input type="text" name="attr_priestMechanicDistance" value="2D6+6" readonly />
                    <button class="rollDice" type="action" name="act_priestJetMechanicDistance" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{priest-mode-mechanic-distance}}} {{jDivers=^{reparation}}} {{jDiversV=[[@{priestMechanicDistance}]]}}"></button>
                </div>
            </div>

            <input class="psion150PG" type="hidden" name="attr_psion150PG" value="0" />
            <input class="psion200PG" type="hidden" name="attr_psion200PG" value="0" />

            <div class="fichePJ psion psionPuppetMaster marginTop">
                <input class="bonusCarac" type="hidden" name="attr_bonusCarac" class="bonusCarac" value="0" />

                <div class="titre">
                    <button type="action" class="bonusCaracL1 psion150" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                    <button type="action" class="bonusCaracL2 psion150" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>
                    
                    <h1 class="titre" data-i18n="mode-puppet-master">Mode Puppet Master</h1>
                    <button class="psion150 rollDice" name="act_simplePsionPuppet" type="action" value="@{jetGM} &{template:simple} {{Nom=@{name}}}"></button>
                </div>
                <div class="psion150 rollPJ">
                    <select name="attr_caracteristique1Psion">
                        <option value="@{aura}" data-i18n="aura" selected>Aura</option>
                    </select>
                    <select name="attr_caracteristique2">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                </div>

                <div class="psion150 bonusCarac">
                    <select name="attr_caracteristique3">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                    <select name="attr_caracteristique4">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                </div>
                <h2 class="titreBis" data-i18n="ordre-donne">Ordre Donné</h2>
                <div class="autoex autoex28">
                    <span name="attr_psionPuppetOrdre"></span>
                    <textarea name="attr_psionPuppetOrdre"></textarea>
                </div>
            </div>
            
            <div class="fichePJ psion psionWindtalker marginTop">
                <h1 class="titre" data-i18n="psion-mode-windtalker">Mode Windtalker</h1>
                <h2 class="titreBis" data-i18n="actions-creatures">Actions des Créatures</h2>
                <div class="autoex autoex28">
                    <span name="attr_psionWindtalkerActions"></span>
                    <textarea name="attr_psionWindtalkerActions"></textarea>
                </div>
            </div>

            <div class="fichePJ ranger rangerVision marginTop">
                <input type="hidden" name="attr_bonusCarac" class="bonusCarac" value="0" />
    
                <div class="titre">
                    <button type="action" class="fichePJ bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                    <button type="action" class="fichePJ bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>
    
                    <h1 class="titre" data-i18n="ranger-vision">Vision</h1>
                    <button class="rollDice" type="action" name="act_simpleRanger" value="@{jetGM} &{template:simple} {{Nom=@{name}}}"></button>
                </div>
                <div class="rollPJ">
                    <select name="attr_caracteristique1Ranger">
                        <option value="@{perception}"  data-i18n="perception" selected>Perception</option>
                    </select>
                    <select name="attr_caracteristique2">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                </div>
                <div class="bonusCarac">
                    <select name="attr_caracteristique3">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                    <select name="attr_caracteristique4">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                </div>
            </div>

            <div class="fichePJ rogue rogueGhost marginTop">
                <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0" />
                <input class="active" type="hidden" name="attr_rogueGhost" value=""/>
    
                <div class="titre">
                    <button type="action" class="bonusCaracL1 psion200" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                    <button type="action" class="bonusCaracL2 psion200" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>
                    
                    <h1 class="titre" data-i18n="mode-ghost">Mode Ghost</h1>
                    <button class="active" type="action" name="act_rogueGhost" data-i18n="activer">Activer</button>
                </div>
                <label class="ligne2">
                    <span data-i18n="bonus/malus-jets">Bonus/Malus aux Jets</span>
                    <input type="number" name="attr_jetModifDes" value="0" />
                </label>
                <div class="rollPJ">
                    <select name="attr_caracteristique1">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                    <select name="attr_caracteristique2">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                    <button class="rollDice" type="action" name="act_simpleRogue" value="@{jetGM} &{template:simple} {{Nom=@{name}}}"></button>
                </div>
                <div class="bonusCarac">
                    <select name="attr_caracteristique3">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                    <select name="attr_caracteristique4">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                </div>
            </div>

            <div class="fichePJ shaman shamanImpregnation marginTop">
                <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0" />
    
                <div class="titre">
                    <button type="action" class="bonusCaracL1 psion200" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                    <button type="action" class="bonusCaracL2 psion200" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>
    
                    <h1 class="titre" data-i18n="shaman-impregnation">Imprégnation</h1>
                    <button class="rollDice" type="action" name="act_simpleShamanImpregnation" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{shaman-impregnation} (@{shamanImpregnation})}}"></button>
                </div>
                <label class="ligne2">
                    <span data-i18n="total-actuel">Total actuel</span>
                    <input type="number" name="attr_shamanImpregnation" value="0" min="0" />
                </label>
                <div class="rollPJ">
                    <select name="attr_caracteristique1ShamanImpregnation">
                        <option value="0" selected></option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    </select>
                    <select name="attr_caracteristique2ShamanImpregnation">
                        <option value="0" selected></option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                    </select>
                </div>
    
                <div class="bonusCarac">
                    <select name="attr_caracteristique3">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                    <select name="attr_caracteristique4">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                </div>
            </div>

            <div class="fichePJ shaman shamanAscension marginTop">
                <input class="active" type="hidden" name="attr_shamanAscension" value="0"/>
    
                <div class="titre">
                    <h1 class="titre" data-i18n="shaman-mode-ascension">Mode Ascension</h1>
    
                    <button class="active" type="action" name="act_shamanAscension" data-i18n="activer">Activer</button>
                </div>
                <label class="ligne2">
                    <span data-i18n="depense-d'energie">Dépense d'énergie</span>
                    <input type="number" name="attr_shamanAscensionEnergie" min="10" max="50" value="10" />
                </label>
                <input type="hidden" name="attr_shamanAscension" value="0" />
                <div class="ligneTitre">
                    <span></span>
                    <span data-i18n="actuel">Actuel</span>
                    <span data-i18n="maximum">Maximum</span>
                    <span data-i18n="modif">Modif</span>
                </div>
                <div class="ligne3">
                    <span data-i18n="armure">Armure</span>
                    <div><input type="number" name="attr_armureAscension" value="60" /></div>
                    <div><input type="number" name="attr_armureAscension_max" value="60" readonly /></div>
                    <div><input type="number" name="attr_armurePJModif" value="0" /></div>
                </div>
                <div class="ligne3">
                    <span data-i18n="energie">Energie</span>
                    <div><input type="number" name="attr_energieAscension" value="0" /></div>
                    <div><input type="number" name="attr_energieAscension_max" value="0" readonly /></div>
                    <div><input type="number" name="attr_energieAscensionModif" value="0" readonly /></div>
                </div>
                <div class="ligne3">
                    <span data-i18n="champ-de-force">Champ de force</span>
                    <div><input type="number" name="attr_cdfAscension" value="10" readonly /></div>
                    <div><input type="number" name="attr_cdfAscension_max" value="10" readonly /></div>
                    <div><input type="number" name="attr_cdfPJAschensionModif"  value="0" /></div>
                </div>
            </div>

            <div class="fichePJ sorcerer sorcererMorph marginTop">
                <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0" />
                <input class="sorcerer250" type="hidden" name="attr_sorcerer250PG" value="" />
                <input class="activateModeMorph250" type="hidden" name="attr_sorcererMM250PG" value="" />
    
                <div class="titre">
                    <h1 class="titre" data-i18n="mode-morph">Mode Morph</h1>
    
                    <button class="active PG250" type="action" name="act_sorcererMM250PG" data-i18n="activer">Activer</button>
                </div>
                <div class="titre borderCTop">
                    <h1 class="titre" data-i18n="mode-morph-etirement">Étirement</h1>
    
                    <label class="fakeButton not250PG">
                        <input type="checkbox" name="attr_sorcererMMEtirement" value="on" />
                        <span data-i18n-title="activer" title="Activer"></span>
                    </label>
                </div>
                <div class="titreBis">
                    <button type="action" class="bonusCaracL1 psion200" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                    <button type="action" class="bonusCaracL2 psion200" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>
                    
                    <h2 class="titreBis" data-i18n="mode-morph-etirement-immobilisation">Immobilisation</h2>
                    <button class="rollDice" type="action" name="act_simpleSorcererEtirement" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{mode-morph-etirement-immobilisation}}}"></button>
                </div>
                <label class="ligne2">
                    <span data-i18n="bonus/malus-jets">Bonus/Malus aux Jets</span>
                    <input type="number" name="attr_jetModifDes" value="0" />
                </label>
                <div class="rollPJ">
                    <select name="attr_caracteristique1">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                    <select name="attr_caracteristique2">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                </div>
                <div class="bonusCarac">
                    <select name="attr_caracteristique3">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                    <select name="attr_caracteristique4">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                </div>
                <div class="titre">
                    <h1 class="titre" data-i18n="mode-morph-vol-en-nuee">Vol en Nuée</h1>
    
                    <label class="fakeButton not250PG">
                        <input type="checkbox" name="attr_sorcererMMVolNuee" value="on" />
                        <span data-i18n-title="activer" title="Activer"></span>
                    </label>
                </div>
                <div class="titre borderCTop">
                    <h1 class="titre" data-i18n="mode-morph-phase">Phase</h1>
    
                    <label class="fakeButton not250PG">
                        <input type="checkbox" name="attr_sorcererMMPhase" value="on" />
                        <span data-i18n-title="active" title="Activé"></span>
                    </label>
                </div>
                <div class="titre borderCTop">
                    <h1 class="titre" data-i18n="mode-morph-corps-en-metal">Corps de Métal</h1>
    
                    <label class="fakeButton not250PG">
                        <input type="checkbox" name="attr_sorcererMMCorpMetal" value="2+(@{sorcerer150PG}*2)" />
                        <span data-i18n-title="activer" title="Activer"></span>
                    </label>
                </div>
            </div>

            <div class="fichePJ warlock warlockRecord marginTop">
                <input class="active" type="hidden" name="attr_warlockRecord" />
    
                <div class="titre">
                    <h1 class="titre" data-i18n="warlock-mode-record">Mode Record</h1>
    
                    <button class="active" type="action" name="act_warlockRecord" data-i18n="activer">Activer</button>
                </div>
                <label class="ligne2">
                    <span data-i18n="warlock-mode-record-success">Succès enregistrés</span>
                    <input type="number" name="attr_warlockRecordSuccess" value="0" />
                </label>
                <label class="ligne2">
                    <span data-i18n="warlock-mode-record-dmg">Dégâts enregistrés</span>
                    <input type="number" name="attr_warlockRecordDmg" value="0" />
                </label>
                <label class="ligne2">
                    <span data-i18n="warlock-mode-record-violence">Violence enregistrée</span>
                    <input type="number" name="attr_warlockRecordViolence" value="0" />
                </label>
                <h1 class="titre" data-i18n="notes">Notes</h1>
                <div class="autoex autoex22">
                    <textarea name="attr_warlockRecordNotes"></textarea>
                    <span name="attr_warlockRecordNotes"></span>
                </div>
            </div>

            <div class="fichePJ warmaster warmasterFalcon marginTop">
                <h1 class="titre" data-i18n="mode-falcon">Mode Falcon</h1>
                <h2 class="titreBis" data-i18n="mode-falcon-faiblesses-detectees">Faiblesses détectées</h2>
                <div class="autoex autoex28">
                    <span name="attr_warmasterModeFalcon"></span>
                    <textarea name="attr_warmasterModeFalcon" class="largeTextarea"></textarea>
                </div>
            </div>
            <div class="fichePJ warmaster warmasterWarlord marginTop">
                <input class="action" type="hidden" name="attr_warmasterImpActionC" value="" />
                <input class="esquive" type="hidden" name="attr_warmasterImpEsquiveC" value="" />
                <input class="force" type="hidden" name="attr_warmasterImpForceC" value="" />
                <input class="guerre" type="hidden" name="attr_warmasterImpGuerreC" value="" />
                <input class="energie" type="hidden" name="attr_warmasterImpEnergieC" value="" />
                <input class="PG200" type="hidden" name="attr_warmaster200PG" value="" />
                
                <h1 class="fichePJ titre" data-i18n="warlord">Warlord</h1>
                <h2 class="fichePJ titreBis" data-i18n="warlord-choix-impulsion">Choix des Impulsions</h2>
                <div class="button">
                    <button class="action" type="action" name="act_warmasterImpActionC" data-i18n="warlord-action">Action</button>
                    <button class="esquive" type="action" name="act_warmasterImpEsquiveC" data-i18n="warlord-esquive">Esquive</button>
                    <button class="force" type="action" name="act_warmasterImpForceC" data-i18n="warlord-force">Force</button>
                    <button class="guerre" type="action" name="act_warmasterImpGuerreC" data-i18n="warlord-guerre">Force</button>
                    <button class="energie" type="action" name="act_warmasterImpEnergieC" data-i18n="warlord-energie">Energie</button>
                </div>
            </div>

            <div class="fichePJ warrior warriorTypes marginTop">
                <input type="hidden" name="attr_warriorSoldierBonus" value="1+@{warrior250PG}"/>
                <input type="hidden" name="attr_warriorHunterBonus" value="1+@{warrior250PG}" />
                <input type="hidden" name="attr_warriorScholarBonus" value="1+@{warrior250PG}" />
                <input type="hidden" name="attr_warriorHeraldBonus" value="1+@{warrior250PG}" />
                <input type="hidden" name="attr_warriorScoutBonus" value="1+@{warrior250PG}" />
    
                <input class="soldier" type="hidden" name="attr_warriorSoldier" value="" />
                <input class="hunter" type="hidden" name="attr_warriorHunter" value="" />
                <input class="scholar" type="hidden" name="attr_warriorScholar" value="" />
                <input class="herald" type="hidden" name="attr_warriorHerald" value="" />
                <input class="scout" type="hidden" name="attr_warriorScout" value="" />
                <input class="PG200" type="hidden" name="attr_warrior200PG" value="" />
            
                <h1 class="titre" data-i18n="warrior-types">Les «Types»</h1>
                <h2 class="titreBis" data-i18n="warrior-selection-types">Sélection des Types</h2>
                <div class="button">
                    <button class="soldier" type="action" name="act_warriorSoldier" data-i18n="warrior-bouton-type-soldier">Soldier</button>
                    <button class="hunter" type="action" name="act_warriorHunter" data-i18n="warrior-bouton-type-hunter">Hunter</button>
                    <button class="scholar" type="action" name="act_warriorScholar" data-i18n="warrior-bouton-type-scholar">Scholar</button>
                    <button class="herald" type="action" name="act_warriorHerald" data-i18n="warrior-bouton-type-herald">Herald</button>
                    <button class="scout" type="action" name="act_warriorScout" data-i18n="warrior-bouton-type-scout">Scout</button>
                </div>
                
                <div class="soldier titre">
                    <h1 class="titre" data-i18n="warrior-type-soldier">Soldier</h1>
                    <label class="fakeButton">
                        <input type="checkbox" name="attr_warriorSoldierA" value="@{warriorSoldierBonus}" />
                        <span data-i18n-title="active" title="Activé"></span>
                    </label>
                </div>
                <label class="soldier col3">
                    <span data-i18n="deplacement">Déplacement</span>
                    <input type="number" name="attr_warriorSoldierBD" value="@{warriorSoldierBonus}" disabled />
                </label>
                <label class="soldier col3BL">
                    <span data-i18n="force">Force</span>
                    <input type="number" name="attr_warriorSoldierBF" value="@{warriorSoldierBonus}" disabled />
                </label>
                <label class="soldier col3BL">
                    <span data-i18n="endurance">Endurance</span>
                    <input type="number" name="attr_warriorSoldierBE" value="@{warriorSoldierBonus}" disabled />
                </label>
    
                <div class="hunter titre">
                    <h1 class="titre" data-i18n="warrior-type-hunter">Hunter</h1>
                    <label class="fakeButton">
                        <input type="checkbox" name="attr_warriorHunterA" value="@{warriorHunterBonus}" />
                        <span data-i18n-title="active" title="Activé"></span>
                    </label>
                </div>
                <label class="hunter col3">
                    <span data-i18n="hargne">Hargne</span>
                    <input type="number" name="attr_warriorHunterBH" value="@{warriorHunterBonus}" disabled />
                </label>
                <label class="hunter col3BL">
                    <span data-i18n="combat">Combat</span>
                    <input type="number" name="attr_warriorHunterBC" value="@{warriorHunterBonus}" disabled />
                </label>
                <label class="hunter col3BL">
                    <span data-i18n="instinct">Instinct</span>
                    <input type="number" name="attr_warriorHunterBI" value="@{warriorHunterBonus}" disabled />
                </label>
            </div>

            <div class="fichePJ wizard wizardBorealis marginTop">
                <input class="PG150" type="hidden" name="attr_wizard150PG" />
                <input class="active" type="hidden" name="attr_wizardBorealis" />
                <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0" />
    
                <div class="titre">
                    <button type="action" class="bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                    <button type="action" class="bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>
    
                    <h1 class="titre" data-i18n="mode-borealis">Mode Boréalis</h1>
    
                    <button type="action" class="active" name="act_wizardBorealis" data-i18n="activer">Activer</button>
               </div>
               <div class="titreBis">
                   <h2 class="titreBis" data-i18n="attaque">Attaque</h2>
    
                   <button class="rollDice" type="action" name="act_distanceWizardBorealis" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=^{mode-borealis}}}"></button>
               </div>
               <label class="ligne2">
                    <span data-i18n="type-attaque">Type d'attaque</span>
                    <select name="attr_wizardBTypeAttaque">
                        <option value="distance" data-i18n="a-distance" selected>A distance</option>
                        <option value="contact" data-i18n="au-contact">Au contact</option>
                    </select>
                </label>
                <label class="ligne2 borderTop">
                    <span data-i18n="bonus/malus-jets">Bonus/Malus aux Jets</span>
                    <input type="number" name="attr_jetModifDes" value="0" />
                </label>                
                <div class="rollPJ">
                    <select name="attr_caracteristique1">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                    <select name="attr_caracteristique2">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                </div>
    
                <div class="bonusCarac">
                    <select name="attr_caracteristique3">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                    <select name="attr_caracteristique4">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                </div>
    
                <label class="col3">
                    <span data-i18n="degats">Dégâts</span>
                    <input type="text" name="attr_wizardBDmg" value="4D6" readonly />
                </label>
                <label class="col3BL">
                    <span data-i18n="violence">Violence</span>
                    <input type="text" name="attr_wizardBViolence" value="4D6" readonly />
                </label>
                <label class="col3BL">
                    <span data-i18n="portee">Portée</span>
                    <input type="text" name="attr_wizardBPortee" value="Courte" readonly />
                </label>
                <input type="text" name="attr_wizardBEffets" value="Anti-Anathème / Dègâts Continus 3" readonly />
            </div>
        </div>

        <div class="col">
            <div class="fichePJ barbarian barbarianGoliath marginTop">
                <h1 class="titre borderBottom" data-i18n="barbarian-mode-goliath">Mode Goliath</h1>
                <h1 class="titre" data-i18n="bonus">Bonus</h1>
    
                <label class="col">
                    <span data-i18n="force">Force</span>
                    <input type="text" name="attr_barbarianGoliath" readonly />
                </label>
                <label class="colBL">
                    <span data-i18n="endurance">Endurance</span>
                    <input type="text" name="attr_barbarianGoliath" readonly />
                </label>
                <label class="col borderTop">
                    <span data-i18n="degats-violence-contact">Dégâts (contact)</span>
                    <input type="text" name="attr_barbarianDegat" readonly />
                </label>
                <label class="colBL borderTop">
                    <span data-i18n="champ-de-force">Champs de Force</span>
                    <input type="text" name="attr_barbarianGoliath" readonly />
                </label>
            </div>

            <div class="fichePJ bard bardChangeling marginTop">
                <input class="bard250" type="hidden" name="attr_bard250PG" 
                value="0" />
    
                <h1 class="titre" data-i18n="bard-faux-êtres">Faux-Êtres</h1>
                <div class="autoex autoex28">
                    <span name="attr_fauxEtresBard"></span>
                    <textarea name="attr_fauxEtresBard"></textarea>
                </div>
    
                <div class="titre bard250">
                    <h1 class="titre" data-i18n="bard-desactivation-explosive">Désactivation explosive</h1>
                    <button class="rollDice" type="action" name="act_distanceBard" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=^{bard-desactivation-explosive}}}" ></button>
                </div>
    
                <label class="bard250 ligne">
                    <span data-i18n="degats/violence">Dégâts / Violence</span>
                    <input type="text" name="attr_bardAttSpe" value="3D6+6" readonly />
                </label>
                <input class="bard250" type="text" name="attr_bardEffetAttSpe" value="Ignore Armure / Ignore Champs de Force / Dispersion 6 / Choc 1" readonly />
            </div>

            <div class="fichePJ berserk berserkRage marginTop">
                <input class="active" type="hidden" name="attr_berserkRageA" />
                <input class="niveau" type="hidden" name="attr_berserkNiveaux" />
                <div class="titre">
                    <h1 class="titre" data-i18n="berserk-mode-rage">Mode Rage</h1>
                    <button class="active rageActive" type="action" name="act_berserkRageA" data-i18n="activer">Activer</button>
                </div>
                
                <div class="button">
                    <button class="N1" type="action" name="act_berserkNiveaux_1" data-i18n="berserk-rage-niveau-1">Niveau 1</button>
                    <button class="N2" type="action" name="act_berserkNiveaux_2" data-i18n="berserk-rage-niveau-2">Niveau 2</button>
                    <button class="N3" type="action" name="act_berserkNiveaux_3" data-i18n="berserk-rage-niveau-3">Niveau 3</button>
                </div>
                <div class="passif">
                    <div class="espoir">
                        <span data-i18n="sacrifice-points-espoir">Sacrifice de points d'espoir</span>
                        <button class="rollDice" type="action" name="act_berserkRageSacrificeEspoir" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{sacrifice-points-espoir}}} {{jDivers=^{espoir-sacrifie}}} {{jDiversV=[[1D6]]}}"></button>
                    </div>
    
                    <h1 class="titre" data-i18n="berserk-nourri-rage">Nourri par la rage</h1>
                    <h2 class="titreBis" data-i18n="points-espoir-vs-humain">Points d'espoir récupérés contre les humains</h2>
    
                    <div class="col4">
                        <span data-i18n="hostile">Hostile</span>
                        <div>
                            <input type="text" name="attr_berserkRageHostileHumain" value="1" readonly />
                            <button class="rollDice" type="action" name="act_berserkRageHostileHumain" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{espoir-recupere}}} {{jDivers=^{humain-hostile}}} {{jDiversV=[[@{berserkRageHostileHumain}]]}}" ></button>
                        </div>
                    </div>
                    <div class="col4BL">
                        <span data-i18n="salopard">Salopard</span>
                        <div>
                            <input type="text" name="attr_berserkRageSalopardHumain" value="1D3" readonly />
                            <button class="rollDice" type="action" name="act_berserkRageSalopardHumain" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{espoir-recupere}}} {{jDivers=^{humain-salopard}}} {{jDiversV=[[@{berserkRageSalopardHumain}]]}}" ></button>
                        </div>
                    </div>
                    <div class="col4BL">
                        <span data-i18n="patron">Patron</span>
                        <div>
                            <input type="text" name="attr_berserkRagePatronHumain" value="1D6+3" readonly />
                            <button class="rollDice" type="action" name="act_berserkRagePatronHumain" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{espoir-recupere}}} {{jDivers=^{humain-patron}}} {{jDiversV=[[@{berserkRagePatronHumain}]]}}" ></button>
                        </div>
                    </div>
                    <div class="col4BL">
                        <span data-i18n="bande">Bande</span>
                        <div>
                            <input type="text" name="attr_berserkRageBandeHumain" value="1D6" readonly />
                            <button class="rollDice" type="action" name="act_berserkRageBandeHumain" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{espoir-recupere}}} {{jDivers=^{humain-bande}}} {{jDiversV=[[@{berserkRageBandeHumain}]]}}" ></button>
                        </div>
                    </div>
                    
                    <h2 class="titreBis" data-i18n="points-espoir-vs-anatheme">Points d'espoir récupérés contre l'anathème</h2>
    
                    <div class="col4">
                        <span data-i18n="hostile">Hostile</span>
                        <div>
                            <input type="text" name="attr_berserkRageHostileAnathème" value="1D6" readonly />
                            <button class="rollDice" type="action" name="act_berserkRageHostileAnathème" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{espoir-recupere}}} {{jDivers=^{anatheme-hostile}}} {{jDiversV=[[@{berserkRageHostileAnathème}]]}}" ></button>
                        </div>
                    </div>
                    <div class="col4BL">
                        <span data-i18n="salopard">Salopard</span>
                        <div>
                            <input type="text" name="attr_berserkRageSalopardAnathème" value="1D6+3" readonly />
                            <button class="rollDice" type="action" name="act_berserkRageSalopardAnathème" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{espoir-recupere}}} {{jDivers=^{anatheme-salopard}}} {{jDiversV=[[@{berserkRageSalopardAnathème}]]}}" ></button>
                        </div>
                    </div>
                    <div class="col4BL">
                        <span data-i18n="patron">Patron</span>
                        <div>
                            <input type="text" name="attr_berserkRagePatronAnathème" value="1D6+6" readonly />
                            <button class="rollDice" type="action" name="act_berserkRagePatronAnathème" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{espoir-recupere}}} {{jDivers=^{anatheme-patron}}} {{jDiversV=[[@{berserkRagePatronAnathème}]]}}" ></button>
                        </div>
                    </div>
                    <div class="col4BL">
                        <span data-i18n="bande">Bande</span>
                        <div>
                            <input type="text" name="attr_berserkRageBandeAnathème" value="2D6" readonly />
                            <button class="rollDice" type="action" name="act_berserkRageBandeAnathème" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{espoir-recupere}}} {{jDivers=^{anatheme-bande}}} {{jDiversV=[[@{berserkRageBandeAnathème}]]}}" ></button>
                        </div>
                    </div>
                </div>
    
                <div class="niveaux">
                    <div class="N1">
                        <h1 class="titre" data-i18n="berserk-rage-colere">Colère - Niveau 1</h1>
                        <label class="col3">
                            <span data-i18n="bonus-degats">Bonus Dégâts</span>
                            <input type="text" name="attr_bete" value="" readonly />
                        </label>
                        <label class="col3BL">
                            <span data-i18n="bonus-violence">Bonus Violence</span>
                            <input type="text" name="attr_bete" value="" readonly />
                        </label>
                        <label class="col3BL">
                            <span data-i18n="bonus-egide">Bonus Égide</span>
                            <input type="text" name="attr_berserkRageN1Egide" value="3" readonly />
                        </label>
        
                        <label class="col2">
                            <span data-i18n="malus-defense">Malus Défense</span>
                            <input type="text" name="attr_berserkRageN1DR" value="3" readonly />
                        </label>
                        <label class="col2BL">
                            <span data-i18n="malus-reaction">Malus Réaction</span>
                            <input type="text" name="attr_berserkRageN1DR" value="3" readonly />
                        </label>
                    </div>
        
                    <div class="N2">
                        <h1 class="titre" data-i18n="berserk-rage-rage">Rage - Niveau 2</h1>
                        <label class="col3">
                            <span data-i18n="bonus-degats">Bonus Dégâts</span>
                            <input type="text" name="attr_bete" value="" readonly />
                        </label>
                        <label class="col3BL">
                            <span data-i18n="bonus-violence">Bonus Violence</span>
                            <input type="text" name="attr_bete" value="" readonly />
                        </label>
                        <label class="col3BL">
                            <span data-i18n="bonus-egide">Bonus Égide</span>
                            <input type="text" name="attr_berserkRageN2Egide" value="6" readonly />
                        </label>
        
                        <label class="col2">
                            <span data-i18n="malus-defense">Malus Défense</span>
                            <input type="text" name="attr_berserkRageN2DR" value="9" readonly />
                        </label>
                        <label class="col2BL">
                            <span data-i18n="malus-reaction">Malus Réaction</span>
                            <input type="text" name="attr_berserkRageN2DR" value="9" readonly />
                        </label>
                    </div>
        
                    <div class="N3">
                        <h1 class="titre" data-i18n="berserk-rage-fureur">Fureur - Niveau 3</h1>
        
                        <label class="col3">
                            <span data-i18n="bonus-degats">Bonus Dégâts</span>
                            <input type="text" name="attr_bete" value="" readonly />
                        </label>
                        <label class="col3BL">
                            <span data-i18n="bonus-violence">Bonus Violence</span>
                            <input type="text" name="attr_bete" value="" readonly />
                        </label>
                        <label class="col3BL">
                            <span data-i18n="bonus-egide">Bonus Égide</span>
                            <input type="text" name="attr_berserkRageN3Egide" value="6" readonly />
                        </label>
        
                        <label class="col3 borderTop">
                            <span data-i18n="malus-defense">Malus Défense</span>
                            <input type="text" name="attr_berserkRageN3DR" value="9" readonly />
                        </label>
                        <label class="col3BL borderTop">
                            <span data-i18n="malus-reaction">Malus Réaction</span>
                            <input type="text" name="attr_berserkRageN3DR" value="9" readonly />
                        </label>
                        <label class="col3SBL borderTop">
                            <span data-i18n="degats-subis-par-tour">Dégâts subis/tour</span>
                            <div>
                                <input type="text" name="attr_berserkRageN3Dgts" value="1D6" readonly />
                                <button class="rollDice" type="action" name="act_berserkRageN3Dgts" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{degats-subis-par-tour}}} {{jDivers=^{degats}}} {{jDiversV=[[@{berserkRageN3Dgts}]]}}" ></button>
                            </div>
                        </label>
        
                        <div class="titre borderTop">
                            <h1 class="titre" data-i18n="berserk-illumination-blaze">Blaze</h1>
                            <button class="rollDice" type="action" name="act_berserkIlluminationBlaze" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=^{berserk-illumination-blaze}}}"></button>
                        </div>
        
                        <label class="col3">
                            <span data-i18n="degats">Dégâts</span>
                            <input type="text" name="attr_berserkIlluminationBlazeDgts" value="2D6" readonly />
                        </label>
                        <label class="col3BL">
                            <span data-i18n="violence">Violence</span>
                            <input type="text" name="attr_berserkIlluminationBlazeViolence" value="2D6" readonly />
                        </label>
                        <label class="col3BL">
                            <span data-i18n="portee">Portée</span>
                            <input type="text" name="attr_berserkIlluminationBlazePortee" value="Contact" readonly />
                        </label>
                    </div>
                </div>
                
            </div>

            <div class="fichePJ druid druidModCompanions marginTop">
                <input class="choix" type="hidden" name="attr_choixCompanons" value="aucun" />
    
                <div class="titre">
                    <h1 class="titre" data-i18n="druid-mod-companions">Mod Companions</h1>
                    <select class="liste" name="attr_druidEnergieCompanon">
                        <option value="10" data-i18n="10-PE" selected>10 PE</option>
                        <option value="20" data-i18n="20-PE">20 PE</option>
                        <option value="30" data-i18n="30-PE">30 PE</option>
                        <option value="40" data-i18n="40-PE">40 PE</option>
                        <option value="50" data-i18n="50-PE">50 PE</option>
                    </select>
                </div>
                <div class="button">
                    <button class="aucun" type="action" name="act_choixCompanons_aucun" data-i18n="aucun" >Aucun</button>
                    <button class="lion" type="action" name="act_choixCompanons_lion" data-i18n="druid-companion-lion">Lion</button>
                    <button class="wolf" type="action" name="act_choixCompanons_wolf" data-i18n="druid-companion-wolf">Wolf</button>
                    <button class="crow" type="action" name="act_choixCompanons_crow" data-i18n="druid-companion-crow">Crow</button>
                </div>
            </div>

            <div class="fichePJ monk monkModeCea marginTop">    
                <input type="hidden" name="attr_bonusCarac" class="bonusCarac" value="0" />
    
                <div class="titre">
                    <button type="action" class="fichePJ bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                    <button type="action" class="fichePJ bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>
                    <h1 class="titre" data-i18n="monk-mode-cea">Mode Céa</h1>
                </div>
                <label class="ligne2">
                    <span data-i18n="bonus/malus-jets">Bonus/Malus aux Jets</span>
                    <input type="number" name="attr_jetModifDes" value="0" />
                </label>
                <div class="rollPJ">
                    <select name="attr_caracteristique1Monk">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                    <select name="attr_caracteristique2Monk">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                </div>
    
                <div class="bonusCarac">
                    <select name="attr_caracteristique3">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                    <select name="attr_caracteristique4">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                </div>
    
                <div class="titre">
                    <h1 class="titre" data-i18n="monk-vague-d'energie">Vague d'énergie</h1>
                    <button class="rollDice" type="action" name="act_monkJetVague" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=^{monk-vague-d'energie}}}"></button>
                </div>
                <label class="col4">
                    <span data-i18n="degats">Dégâts</span>
                    <input type="text" name="attr_monkVagueDegat" value="3D6" readonly />
                </label>
                <label class="col4BL">
                    <span data-i18n="violence">Violence</span>
                    <input type="text" name="attr_monkVagueDegat" value="3D6" readonly />
                </label>
                <label class="col4BL">
                    <span data-i18n="energie">Énergie</span>
                    <input type="text" name="attr_monkVagueEnergie" value="3" disabled />
                </label>
                <label class="col4BL">
                    <span data-i18n="portee">Portée</span>
                    <input type="text" name="attr_monkVaguePortee" value="Contact / Courte" readonly />
                </label>
                <input class="ligne" type="text" name="attr_monkVagueEffets" value="Parasitage 2 / Dispersion 3 / Destructeur / Choc 2" readonly />
    
                <div class="titre">
                    <h1 class="titre" data-i18n="monk-salve-d'energie">Salve d'énergie</h1>
                    <button class="rollDice" type="action" name="act_monkJetSalve" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=^{monk-salve-d'energie}}}"></button>
                </div>
                <label class="col4">
                    <span data-i18n="degats">Dégâts</span>
                    <input type="text" name="attr_monkSalveDegat" value="3D6" readonly />
                </label>
                <label class="col4BL">
                    <span data-i18n="violence">Violence</span>
                    <input type="text" name="attr_monkSalveDegat" value="3D6"  readonly />
                </label>
                <label class="col4BL">
                    <span data-i18n="energie">Énergie</span>
                    <input type="text" name="attr_monkSalveEnergie" value="3" disabled />
                </label>
                <label class="col4BL">
                    <span data-i18n="portee">Portée</span>
                    <input type="text" name="attr_monkSalvePortee" value="Moyenne" readonly />
                </label>
                <input class="ligne" type="text" name="attr_monkSalveEffets" value="Parasitage 1 / Dispersion 3 / Ultraviolence / Meurtrier" readonly />
            </div>

            <div class="fichePJ paladin paladinWatchtower marginTop">
                <input class="active" type="hidden" name="attr_paladinWatchtower" />
    
                <div class="titre">
                    <h1 class="titre" data-i18n="paladin-mode-watchtower">Mode Watchtower</h1>
                    <button class="active" type="action" name="act_paladinWatchtower" data-i18n="activer">Activer</button>
                </div>
                <label class="ligne">
                    <span data-i18n="reaction-actuelle">Réaction actuelle</span>
                    <input type="number" name="attr_reactionTotal" value="0" readonly />
                </label>
            </div>

            <div class="fichePJ priest priestNanoC marginTop">
                <input type="hidden" name="attr_bonusCarac" class="bonusCarac" value="0" />
    
                <div class="titre">
                    <button type="action" class="fichePJ bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                    <button type="action" class="fichePJ bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>
                    
                    <h1 class="titre" data-i18n="priest-mode-nanoc">Mode NanoC</h1>
                    <button class="rollDice" type="action" name="act_simplePriest" value="@{jetGM} &{template:simple} {{Nom=@{name}}}"></button>
                </div>
                <label class="ligne2">
                    <span>Bonus/Malus aux Jets</span>
                    <input type="number" name="attr_jetModifDes" value="0" />
                </label>
                <div class="rollPJ">
                    <select name="attr_caracteristique1Priest">
                        <option value="@{technique}" selected>Technique</option>
                    </select>
                    <select name="attr_caracteristique2">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                </div>
                <div class="bonusCarac">
                    <select name="attr_caracteristique3">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                    <select name="attr_caracteristique4">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                </div>
                <h1 class="titre" data-i18n="priest-creations">Créations</h1>
                <div class="autoex autoex28">
                    <span name="attr_priestNanoc"></span>
                    <textarea name="attr_priestNanoc" class="largeTextarea"></textarea>
                </div>
            </div>

            <input class="psion150PG" type="hidden" name="attr_psion150PG" value="0" />
            <input class="psion200PG" type="hidden" name="attr_psion200PG" value="0" />

            <div class="fichePJ psion psionDiscord marginTop">
                <input class="active" type="hidden" name="attr_psionDiscord" />
                <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0" />

                <div class="titre">
                    <button type="action" class="bonusCaracL1 psion200" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                    <button type="action" class="bonusCaracL2 psion200" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>

                    <h1 class="titre" data-i18n="psion-mode-discord">Mode Discord</h1>
                    <button class="active" type="action" name="act_psionDiscord" data-i18n="activer">Activer</button>
                </div>
                <label class="psion200 ligne2">
                    <span data-i18n="bonus/malus-jets">Bonus/Malus aux Jets</span>
                    <input type="number" name="attr_jetModifDes" value="0" />
                </label>
                <div class="psion200 rollPJ">
                    <select name="attr_caracteristique1Psion">
                        <option value="@{aura}" data-i18n="aura" selected>Aura</option>
                    </select>
                    <select name="attr_caracteristique2">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                    <button class="rollDice" type="action" name="act_simplePsionDiscord" value="@{jetGM} &{template:simple} {{Nom=@{name}}}}"></button>
                </div>
                
                <div class="psion200 bonusCarac">
                    <select name="attr_caracteristique3">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                    <select name="attr_caracteristique4">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                </div>
                <label class="col3">
                    <span data-i18n="malus-action">Malus Actions</span>
                    <input type="text" name="attr_psionMalusA" value="2D" readonly />
                </label>
                <label class="col3BL">
                    <span data-i18n="malus-reaction">Malus Réaction</span>
                    <input type="text" name="attr_psionMalus" value="2" readonly />
                </label>
                <label class="col3BL">
                    <span data-i18n="malus-defense">Malus Défense</span>
                    <input type="text" name="attr_psionMalus" value="2" readonly />
                </label>
            </div>

            <div class="fichePJ shaman shamanTotem marginTop">
                <input class="nbreTotem" type="hidden" name="attr_shamanNbreTotem" value="0" />
    
                <h1 class="titre" data-i18n="shaman-mode-totem">Mode Totem</h1>
                <label class="ligne2">
                    <span data-i18n="shaman-nombre-totem">Nombre de totems</span>
                    <input type="number" name="attr_shamanNbreTotem" value="0" min="0" max="3" />
                </label>
                
                <label class="ligne2 totem1">
                    <span data-i18n="shaman-caracteristique-totem-1">Caractéristique du Totem 1</span>
                    <select name="attr_caracteristiqueTotem1">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                </label>
                <label class="ligne2 totem2">
                    <span data-i18n="shaman-caracteristique-totem-2">Caractéristique du Totem 2</span>
                    <select name="attr_caracteristiqueTotem2">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                </label>
                <label class="ligne2 totem3">
                    <span data-i18n="shaman-caracteristique-totem-3">Caractéristique du Totem 3</span>
                    <select name="attr_caracteristiqueTotem3">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                </label>
            </div>
            <div class="fichePJ shaman jet">
                <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0" />
    
                <div class="titre">
                    <button type="action" class="bonusCaracL1 psion200" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                    <button type="action" class="bonusCaracL2 psion200" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>
    
                    <h1 class="titre" data-i18n="jet">Jet</h1>
                    <button class="rollDice" type="action" name="act_simple" value="@{jetGM} &{template:simple} {{Nom=@{name}}}"></button>
               </div>
                <label class="ligne2">
                    <span data-i18n="bonus/malus-jets">Bonus/Malus aux Jets</span>
                    <input type="number" name="attr_jetModifDes" value="0" />
                </label>
                <div class="rollPJ">
                    <select name="attr_caracteristique1">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                    <select name="attr_caracteristique2">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                </div>
    
                <div class="bonusCarac">
                    <select name="attr_caracteristique3">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                    <select name="attr_caracteristique4">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                </div>
            </div>

            <div class="fichePJ sorcerer sorcererMorph marginTop">
                <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0" />
                <input class="sorcerer250" type="hidden" name="attr_sorcerer250PG" value="" />
                <input class="activateModeMorph250" type="hidden" name="attr_sorcererMM250PG" value="" />
    
                <div class="titre">
                    <h1 class="titre" data-i18n="mode-morph">Mode Morph</h1>
    
                    <button class="active PG250" type="action" name="act_sorcererMM250PG" data-i18n="activer">Activer</button>
                </div>
                <div class="titre borderCTop">
                    <h1 class="titre" data-i18n="mode-morph-corps-fluide">Corps Fluide</h1>
                    
                    <label class="fakeButton not250PG">
                        <input type="checkbox" name="attr_sorcererMMCorpFluide" value="2+(@{sorcerer150PG}*1)" />
                        <span data-i18n-title="activer" title="Activer"></span>
                    </label>
                </div>
                <label class="col2">
                    <span data-i18n="defense">Défense</span>
                    <input type="text" name="attr_defenseTotal" value="0" readonly />
                </label>
                <label class="col2BL">
                    <span data-i18n="reaction">Réaction</span>
                    <input type="text" name="attr_reactionTotal" value="0" readonly />
                </label>
    
                <div class="titre">
                    <h1 class="titre" data-i18n="mode-morph-polymorphie-de-guerre">Polymorphie de Guerre</h1>
                    <label class="fakeButton not250PG">
                        <input type="checkbox" name="attr_sorcererMMPMGuerre" value="on" />
                        <span data-i18n-title="activer" title="Activer"></span>
                    </label>
                </div>
                <h2 class="titreBis borderSBottom" data-i18n="mode-morph-polymorphie-de-guerre-module-genere">Module Généré</h2>
                <div class="autoex autoex28">
                    <span name="attr_sorcererMMPMGuerreModules"></span>
                    <textarea name="attr_sorcererMMPMGuerreModules"></textarea>
                </div>
                <h2 class="titreBis borderS" data-i18n="mode-morph-polymorphie-de-guerre-module-genere-effets-choisis">Effets Choisis</h2>
                <div class="autoex autoex28">
                    <span name="attr_sorcererEffetsBonus15OG"></span>
                    <textarea name="attr_sorcererEffetsBonus15OG"></textarea>
                </div>
            </div>

            <div class="fichePJ warlock warlockForward marginTop">
                <input class="active" type="hidden" name="attr_warlockForward" />
    
                <div class="titre">
                    <h1 class="titre" data-i18n="warlock-mode-forward">Mode Forward</h1>
    
                    <button class="active" type="action" name="act_warlockForward" data-i18n="activer">Activer</button>
                </div>
            </div>
            <div class="fichePJ warlock warlockRewind marginTop">
                <input class="active" type="hidden" name="attr_warlockRewind" />
    
                <div class="titre">
                    <h1 class="titre" data-i18n="warlock-mode-rewind">Mode Rewind</h1>
    
                    <button class="active" type="action" name="act_warlockRewind" data-i18n="activer">Activer</button>
                </div>
                <div class="autoex autoex22">
                    <textarea name="attr_warlockRewindNotes"></textarea>
                    <span name="attr_warlockRewindNotes"></span>
                </div>
            </div>
            <div class="fichePJ warlock warlockContrecoups marginTop">
                <div class="titre">
                    <h1 class="titre" data-i18n="warlock-contrecoups">Contrecoups</h1>
    
                    <button class="rollDice" type="action" name="act_rollWarlockContrecoups" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{warlock-contrecoups}}}"></button>
                </div>
            </div>

            <div class="fichePJ warmaster warmasterWarlord marginTop">
                <input class="action" type="hidden" name="attr_warmasterImpActionC" value="" />
                <input class="esquive" type="hidden" name="attr_warmasterImpEsquiveC" value="" />
                <input class="force" type="hidden" name="attr_warmasterImpForceC" value="" />
                <input class="guerre" type="hidden" name="attr_warmasterImpGuerreC" value="" />
                <input class="energie" type="hidden" name="attr_warmasterImpEnergieC" value="" />
                <input class="PG200" type="hidden" name="attr_warmaster200PG" value="" />
                
                <h1 class="fichePJ titre" data-i18n="warlord">Warlord</h1>
                <div class="action titre">
                    <input class="personnel" type="hidden" name="attr_warmasterImpAPersonnel" />
                    <input class="active" type="hidden" name="attr_warmasterImpAction" />
    
                    <button class="personnel" type="action" name="act_warmasterImpAPersonnel" data-i18n="personnel">Personnel</button>
    
                    <h1 class="titre" data-i18n="warlord-impulsion-d'action">Impulsion d'Action</h1>
    
                    <button class="active" type="action" name="act_warmasterImpAction" data-i18n="activer">Activer</button>
                </div>
                
                <div class="esquive titre">
                    <input class="active" type="hidden" name="attr_warmasterImpEsquive" />
    
                    <label class="fakeButton">
                        <input type="checkbox" name="attr_warmasterImpEPersonnel" value="2" />
                        <span data-i18n-title="personnel" title="Personnel"></span>
                    </label>
    
                    <h1 class="titre" data-i18n="warlord-impulsion-d'esquive">Impulsion d'Esquive</h1>
    
                    <button class="active" type="action" name="act_warmasterImpEsquive" data-i18n="activer">Activer</button>
                </div>
                <label class="esquive col2">
                    <span data-i18n="defense">Défense</span>
                    <input type="number" name="attr_defenseTotal" value="0" readonly />
                </label>
                <label class="esquive col2BL">
                    <span data-i18n="reaction">Réaction</span>
                    <input type="number" name="attr_reactionTotal" value="0" readonly />
                </label>
                
                <div class="force titre">
                    <input class="active" type="hidden" name="attr_warmasterImpForce" />
                    
                    <label class="fakeButton">
                        <input type="checkbox" name="attr_warmasterImpFPersonnel" value="2" />
                        <span data-i18n-title="personnel" title="Personnel"></span>
                    </label>
    
                    <h1 class="titre" data-i18n="warlord-impulsion-de-force">Impulsion de Force</h1>
    
                    <button class="active" type="action" name="act_warmasterImpForce" data-i18n="activer">Activer</button>
                </div>
                <label class="force ligne2">
                    <span data-i18n="champ-de-force">Champ de Force</span>
                    <input type="number" name="attr_cdfPJ_max" value="8" readonly />
                </label>
    
                <div class="guerre titre">
                    <input class="active" type="hidden" name="attr_warmasterImpGuerre" />
    
                    <label class="fakeButton">
                        <input type="checkbox" name="attr_warmasterImpGPersonnel" value="{{ImpulsionGuerreD=[[1D6]]}} {{ImpulsionGuerreV=[[1D6]]}}" />
                        <span data-i18n-title="personnel" title="Personnel"></span>
                    </label>
    
                    <h1 class="titre" data-i18n="warlord-impulsion-de-guerre">Impulsion de Guerre</h1>
    
                    <button class="active" type="action" name="act_warmasterImpGuerre" data-i18n="activer">Activer</button>
                </div>
                <label class="guerre col2">
                    <span data-i18n="degats">Dégâts</span>
                    <input type="text" name="attr_warmImpGDegats" value="1D6" readonly />
                </label>
                <label class=" guerre col2BL">
                    <span data-i18n="violence">Violence</span>
                    <input type="text" name="attr_warmImpGViolence" value="1D6" readonly />
                </label>
               
                <div class="energie titre">
                    <input class="active" type="hidden" name="attr_warmasterImpEnergie" />
    
                    <h1 class="titre" data-i18n="warlord-impulsion-d'energie">Impulsion d'Energie</h1>
    
                    <button class="active" type="action" name="act_warmasterImpEnergie" data-i18n="activer">Activer</button>
                </div>
            </div>

            <div class="fichePJ warrior warriorTypes marginTop">
                <input type="hidden" name="attr_warriorSoldierBonus" value="1+@{warrior250PG}"/>
                <input type="hidden" name="attr_warriorHunterBonus" value="1+@{warrior250PG}" />
                <input type="hidden" name="attr_warriorScholarBonus" value="1+@{warrior250PG}" />
                <input type="hidden" name="attr_warriorHeraldBonus" value="1+@{warrior250PG}" />
                <input type="hidden" name="attr_warriorScoutBonus" value="1+@{warrior250PG}" />
    
                <input class="soldier" type="hidden" name="attr_warriorSoldier" value="" />
                <input class="hunter" type="hidden" name="attr_warriorHunter" value="" />
                <input class="scholar" type="hidden" name="attr_warriorScholar" value="" />
                <input class="herald" type="hidden" name="attr_warriorHerald" value="" />
                <input class="scout" type="hidden" name="attr_warriorScout" value="" />
                <input class="PG200" type="hidden" name="attr_warrior200PG" value="" />
            
                <h1 class="titre borderBottom" data-i18n="warrior-types">Les «Types»</h1>    
                <div class="scholar titre">
                    <h1 class="titre" data-i18n="warrior-type-scholar">Scholar</h1>
                    <label class="fakeButton">
                        <input type="checkbox" name="attr_warriorScholarA" value="@{warriorScholarBonus}" />
                        <span data-i18n-title="active" title="Activé"></span>
                    </label>
                </div>
                <label class="scholar col3">
                    <span data-i18n="tir">Tir</span>
                    <input type="number" name="attr_warriorScholarBT" value="@{warriorScholarBonus}" disabled />
                </label>
                <label class="scholar col3BL">
                    <span data-i18n="savoir">Savoir</span>
                    <input type="number" name="attr_warriorScholarBS" value="@{warriorScholarBonus}" disabled />
                </label>
                <label class="scholar col3BL">
                    <span data-i18n="technique">Technique</span>
                    <input type="number" name="attr_warriorScholarBTech" value="@{warriorScholarBonus}" disabled />
                </label>
    
                <div class="herald titre">
                    <h1 class="titre" data-i18n="warrior-type-herald">Herald</h1>
                    <label class="fakeButton">
                        <input type="checkbox" name="attr_warriorHeraldA" value="@{warriorHeraldBonus}" />
                        <span  data-i18n-title="active" title="Activé"></span>
                    </label>
                </div>
                <label class="herald col3">
                    <span data-i18n="aura">Aura</span>
                    <input type="number" name="attr_warriorHeraldBA" value="@{warriorHeraldBonus}" disabled />
                </label>
                <label class="herald col3BL">
                    <span data-i18n="parole">Parole</span>
                    <input type="number" name="attr_warriorHeraldBP" value="@{warriorHeraldBonus}" disabled />
                </label>
                <label class="herald col3BL">
                    <span data-i18n="sang-froid">Sang-Froid</span>
                    <input type="number" name="attr_warriorHeraldBSF" value="@{warriorHeraldBonus}" disabled />
                </label>
    
                <div class="scout titre">
                    <h1 class="titre" data-i18n="warrior-type-scout">Scout</h1>
                    <label class="fakeButton">
                        <input type="checkbox" name="attr_warriorScoutA" value="@{warriorScoutBonus}" />
                        <span data-i18n-title="active" title="Activé"></span>
                    </label>
                </div>
                <label class="scout col3">
                    <span data-i18n="discretion">Discrétion</span>
                    <input type="number" name="attr_warriorScoutBD" value="@{warriorScoutBonus}" disabled />
                </label>
                <label class="scout col3BL">
                    <span data-i18n="dexterite">Dextérité</span>
                    <input type="number" name="attr_warriorScoutBDext" value="@{warriorScoutBonus}" disabled />
                </label>
                <label class="scout col3BL">
                    <span data-i18n="perception">Perception</span>
                    <input type="number" name="attr_warriorScoutBP" value="@{warriorScoutBonus}" disabled />
                </label>
            </div>

            <div class="fichePJ wizard wizardOriflamme marginTop">
                <input class="PG250" type="hidden" name="attr_wizard250PG" value="0" />
    
                <div class="titre">
                    <h1 class="titre" data-i18n="wizard-mode-oriflamme">Mode Oriflamme</h1>
                    <button class="rollDice" type="action" name="act_distanceWizardOriflamme" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=^{wizard-mode-oriflamme}}}"></button>
                </div>
                <label class="col3">
                    <span data-i18n="degats">Dégâts</span>
                    <input type="text" name="attr_wizardODmg" value="6D6+6" readonly />
                </label>
                <label class="col3BL">
                    <span data-i18n="violence">Violence</span>
                    <input type="text" name="attr_wizardOViolence" value="6D6+12" readonly />
                </label>
                <label class="col3BL">
                    <span data-i18n="portee">Portée</span>
                    <input type="text" name="attr_wizardOPortee" value="Courte" readonly />
                </label>
                <div class="autoex autoex22">
                    <textarea name="attr_wizardOEffets" readonly>Anti-Anathème / Lumière 2 / Affecte uniquement les créatures de l'Anathème</textarea>
                    <span name="attr_wizardOEffets">Anti-Anathème / Lumière 2 / Affecte uniquement les créatures de l'Anathème</textarea>
                </div>
            </div>
        </div>

        <div class="complet">
            <input class="druidCompanions" type="hidden" name="attr_choixCompanons" value="aucun" />

            <div class="fichePJ druid DCLion marginTop">
                <input class="subMenu" type="hidden" name="attr_tabDruidLion" value="0" />
        
                <h1 class="titre" data-i18n="druid-companion-lion">Lion</h1>
                <div class="col4">
                    <h1 class="titre" data-i18n="aspects">Aspects</h1>
                    <div class="ligne aspect">
                        <span data-i18n="chair">Chair</span>
        
                        <div class="blockR">
                            <input type="number" name="attr_druidLionChairTot" value="@{druidLionChairBase}+@{druidLionChairEvol}" disabled />
                            <button class="rollDice" name="act_druidLionChairRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}}"></button>
                        </div>
                    </div>
        
                    <div class="ligne aspect">
                        <span data-i18n="bete">Bête</span>
        
                        <div class="blockR">
                            <input type="number" name="attr_druidLionBeteTot" value="@{druidLionBeteBase}+@{druidLionBeteEvol}" disabled />
                            <button class="rollDice" name="act_druidLionBeteRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}}"></button>
                        </div>
                    </div>
        
                    <div class="ligne aspect">
                        <span data-i18n="machine">Machine</span>
        
                        <div class="blockR">
                            <input type="number" name="attr_druidLionMachineTot" value="@{druidLionMachineBase}+@{druidLionMachineEvol}" disabled />
                            <button class="rollDice" name="act_druidLionMachineRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}}"></button>
                        </div>
                    </div>
        
                    <div class="ligne aspect">
                        <span data-i18n="dame">Dame</span>
        
                        <div class="blockR">
                            <input type="number" name="attr_druidLionDameTot" value="@{druidLionDameBase}+@{druidLionDameEvol}" disabled />
                            <button class="rollDice" name="act_druidLionDameRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}}"></button>
                        </div>
                    </div>
        
                    <div class="ligne aspect">
                        <span data-i18n="masque">Masque</span>
        
                        <div class="blockR">
                            <input type="number" name="attr_druidLionMasqueTot" value="@{druidLionMasqueBase}+@{druidLionMasqueEvol}" disabled />
                            <button class="rollDice" name="act_druidLionMasqueRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}}"></button>
                        </div>
                    </div>
                </div>
                
                <div class="col4BL">
                    <h1 class="titre" data-i18n="aspects-exceptionnels">Aspects Exceptionnels</h1>
                    <div class="ligne AE">
                        <input type="hidden" name="attr_druidLionChairAE" value="1"/>
                        <span class="mineur" data-i18n="mineur">Mineur</span>
                        <span class="majeur" data-i18n="majeur">Majeur</span>
                        <span class="value" name="attr_druidLionChairAE">1</span>
                    </div>
                    <div class="ligne AE">
                        <input type="hidden" name="attr_druidLionBeteAE" value="1"/>
                        <span class="mineur" data-i18n="mineur">Mineur</span>
                        <span class="majeur" data-i18n="majeur">Majeur</span>
                        <span class="value" name="attr_druidLionBeteAE">1</span>
                    </div>
                    <div class="ligne AE">
                        <input type="hidden" name="attr_druidLionMachineAE" value="1"/>
                        <span class="mineur" data-i18n="mineur">Mineur</span>
                        <span class="majeur" data-i18n="majeur">Majeur</span>
                        <span class="value" name="attr_druidLionMachineAE" >1</span>
                    </div>
                    <div class="ligne AE">
                        <input type="hidden" name="attr_druidLionDameAE" value="0"/>
                        <span class="mineur" data-i18n="mineur">Mineur</span>
                        <span class="majeur" data-i18n="majeur">Majeur</span>
                        <span class="value" name="attr_druidLionDameAE" >0</span>
                    </div>
                    <div class="ligne AE">
                        <input type="hidden" name="attr_druidLionMasqueAE" value="0"/>
                        <span class="mineur" data-i18n="mineur">Mineur</span>
                        <span class="majeur" data-i18n="majeur">Majeur</span>
                        <span class="value" name="attr_druidLionMasqueAE">0</span>
                    </div>
                </div>
        
                <div class="col4BL">
                    <h1 class="titre" data-i18n="valeurs-derivees">Valeurs Dérivées</h1>
                    <div class="ligne defense">
                        <span data-i18n="defense">Défense</span>
        
                        <div class="blockR">
                            <input type="number" name="attr_druidLionDefenseTot" value="@{druidLionDefenseBase}+@{druidLionDefenseEvol}+@{druidLionMasqueAE}" disabled />
                        </div>
                    </div>
        
                    <div class="ligne reaction">
                        <span data-i18n="reaction">Réaction</span>
        
                        <div class="blockR">
                            <input type="number" name="attr_druidLionReactionTot" value="@{druidLionReactionBase}+@{druidLionReactionEvol}+@{druidLionMachineAE}" disabled />
                        </div>
                    </div>
        
                    <div class="ligne initiative">
                        <span data-i18n="initiative">Initiative</span>
        
                        <div class="blockR">
                            <input type="number" name="attr_druidLionInitiativeTot" value="@{druidLionInitiativeBase}+@{druidLionInitiativeEvol}" disabled />
                            <button class="rollDice" type="action" name="act_druidLionInitiativeRoll" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}}"></button>
                        </div>
                    </div>
        
                    <div class="ligne armure">
                        <span data-i18n="armure">Armure</span>
        
                        <div class="blockR">
                            <input type="number" name="attr_druidLionPAAct" value="60" />
                            <b>/</b>
                            <input type="number" name="attr_druidLionPAAct_max" value="@{druidLionPABase}+@{druidLionPAEvol}" disabled />
                        </div>
                    </div>
        
                    <div class="ligne energie">
                        <span data-i18n="energie">Energie</span>
        
                        <div class="blockR">
                            <input type="number" name="attr_druidLionPEAct" value="0" />
                            <b>/</b>
                            <input type="number" name="attr_druidLionPEAct_max" value="@{druidEnergieCompanon}" disabled />
                        </div>
                    </div>
                </div>
        
                <div class="col4BL">
                    <h1 class="titre" data-i18n="champ-de-force">Champ de Force</h1>
                    <div class="ligne CDF">
                        <input type="number" name="attr_druidLionCDFTot" value="@{druidLionCDFBase}+@{druidLionCDFEvol}" disabled />
                    </div>
                </div>
        
                <div class="subMenu">
                    <button class="armes" type="action" name="act_tabDruidLion_1" data-i18n="armes">Armes</button>
                    <button class="BL modules" type="action" name="act_tabDruidLion_2" data-i18n="modules">Modules</button>
                    <button class="BL evolutions" type="action" name="act_tabDruidLion_3" data-i18n="evolutions">Evolutions</button>
                </div>
                
                <div class="armes">
                    <div class="ligneTitre">
                        <div class="firstCol">
                            <span data-i18n="arme">Arme</span>
                        </div>
            
                        <div class="midCol">
                            <span data-i18n="degats">Dégâts</span>
                        </div>
                        <div class="midCol">
                            <span data-i18n="violence">Violence</span>
                        </div>
                        <div class="midCol">
                            <span data-i18n="portee">Portée</span>
                        </div>
            
                        <div class="lastCol">
                            <span data-i18n="aspect">Aspect</span>
                        </div>
                    </div>
        
                    <div class="coups">
                        <input class="subMenu" type="hidden" name="attr_tabDCoups" value="0" />
        
                        <div class="ligne">
                            <div class="firstCol aB1Nom">
                                <input type="text" name="attr_druidLionBaseNom" value="Coups" readonly />
                            </div>
            
                            <div class="midCol aB1Degats">
                                <input class="nbre" type="number" name="attr_druidLionBaseDegats" class="right" value="1" disabled />
                                <b>D6+</b>
                                <input class="bonus" type="number" name="attr_druidLionBaseDegatsBonus" class="left" value="0" disabled />
                            </div>
            
                            <div class="midCol aB1Violence">
                                <input class="nbre" type="number" name="attr_druidLionBaseViolence" class="right" value="1" disabled />
                                <b>D6+</b>
                                <input class="bonus" type="number" name="attr_druidLionBaseViolenceBonus" class="left" value="0" disabled />
                            </div>
                            
                            <div class="midCol aB1Portee">
                                <select name="attr_druidLionBasePortee">
                                    <option data-i18n="portee-contact" value="^{portee-contact}" selected>Contact</option>
                                </select>
                            </div>
            
                            <div class="lastCol aB1Aspect">
                                <select name="attr_aspectDruidLionBase">
                                    <option value="druidLionChair" data-i18n="chair">Chair</option>
                                    <option value="druidLionBete" data-i18n="bete">Bete</option>
                                    <option value="druidLionMachine" data-i18n="machine">Machine</option>
                                    <option value="druidLionDame" data-i18n="dame">Dame</option>
                                    <option value="druidLionMasque" data-i18n="masque">Masque</option>
                                </select>							
                                <button class="rollDice" type="action" name="act_druidLionArmeBase" value="@{jetGM} &{template:combat} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}} {{special1B=^{coups}}}"></button>
                            </div>
                        </div>
                        <div class="subMenu">
                            <button class="special" type="action" name="act_tabDCoups-3" data-i18n="special">Spécial</button>
                        </div>
                        <div class="special">
                            <div class="triple">
                                <input type="hidden" name="attr_coupBDDiversTotal" value="0" />
        
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_coupBDDiversTotal" value="{{BDDivers=[[@{bDDiversD6}D6+@{bDDiversFixe}]]}} " />
                                    <span data-i18n-title="bonus-degats" title="Bonus aux dégâts"></span>
                                </label>
                                <div>
                                    <input class="L" type="number" name="attr_bDDiversD6" class="center" value="0" />
                                    <span>D6+</span>
                                    <input class="R" type="number" name="attr_bDDiversFixe" class="center" value="0" />
                                </div>
                            </div>
                            <div class="triple">
                                <input type="hidden" name="attr_coupBVDiversTotal" value="0" />
        
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_coupBVDiversTotal" value="{{BVDivers=[[@{bVDiversD6}D6+@{bVDiversFixe}]]}} " />
                                    <span data-i18n-title="bonus-violence" title="Bonus à la violence"></span>
                                </label>
                                <div>
                                    <input class="L" type="number" name="attr_bVDiversD6" class="center" value="0" />
                                    <span>D6+</span>
                                    <input class="R" type="number" name="attr_bVDiversFixe" class="center" value="0" />
                                </div>
                            </div>
                        </div>
                    </div>
        
                    <fieldset class="repeating_armeDruidLion">
                        <input class="subMenu" type="hidden" name="attr_tab" value="0" />
        
                        <div class="data">
                            <input type="hidden" name="attr_druidLionDegats" value="{{Degats=[[ [[{[[@{degatDruidLion}+@{chargeurExplosives}-@{chargeurGrappes}-@{munitionsIEM}+@{revetementOmega}]], 0}kh1]]D6+@{degatBonusDruidLion}]]}}" />
                                    
                            <input type="hidden" name="attr_druidLionViolence" value="{{Violence=[[ [[{[[@{violenceDruidLion}-@{chargeurExplosives}-@{munitionsIEM}]], 0}kh1]]D6+@{violenceBonusDruidLion}]]}}" />
                            
                            <input type="hidden" name="attr_druidLionEffets" value="@{destructeur} @{fureur} @{leste} @{meurtrier} @{orfevrerie} @{precision} {{tirSecurite=[[@{tirSecurite}]]}} @{ultraViolence} @{antiAnatheme} @{antiVehicule} @{artillerie} @{assistanceAttaque} @{barrage} @{chargeur} @{choc} @{defense} @{deuxMains} @{dispersion} @{degatContinue} @{demoralisant} @{designation} @{enChaine} @{esperance} @{ignoreArmure} @{ignoreCdF} {{lourd=[[@{lourd}]]}} @{lumiere} @{obliteration} @{parasitage} @{penetrant} @{perceArmure} @{reaction} @{silencieux} {{silencieuxD=[[floor((@{druidLionMasqueTot})/2)+@{druidLionMasqueAE}]]}} @{tenebricite} {{jumelageAkimbo=[[@{akimbo}]]}} {{jumelageAmbidextrie=[[@{ambidextrie}]]}} @{tirRafale} @{assassin} {{cadence=[[ceil(@{cadence})]]}} {{scoreCadence=@{cadenceValue}}} @{soumission}" />
                            
                            <input type="hidden" name="attr_druidLionAmeliorations" value="{{chargeurGrappes=[[1D6]]}} {{ballesGrappes=[[@{chargeurGrappes}]]}} {{chargeurExplosives=[[1D6]]}} {{ballesExplosives=[[@{chargeurExplosives}]]}} @{pointeurLaser} @{lunetteIntelligente} @{canonLong} @{munitionsSubsoniques} @{protectionArme} @{structureElement} @{munitionsHyperVelocite} @{munitionsDrone} {{munitionsNonLetales=[[@{munitionsNonLetales}]]}} {{munitionsIEM=[[@{munitionsIEM}]]}} {{interfaceGuidage=[[@{interfaceGuidage}]]}} @{jumelage} {{chambreDouble=[[ceil(@{chambreDouble})]]}} @{systemeRefroidissement} {{revetementOmega=[[@{revetementOmega}D6]]}}" />
        
                            <input type="hidden" name="attr_druidLionSpecial" value="@{energie} @{bDDiversTotal} @{bVDiversTotal}" />
                        </div>
                        <div class="ligne">
                            <div class="firstCol aNom">
                                <input type="text" name="attr_armeDruidLion" />
                            </div>
                            <div class="midCol aDegats">
                                <input class="nbre" type="number" name="attr_degatDruidLion" value="0" />
                                <b>D6+</b>
                                <input class="bonus" type="number" name="attr_degatBonusDruidLion" value="0" />
                            </div>
                            <div class="midCol aViolence">
                                <input class="nbre" type="number" name="attr_violenceDruidLion" value="0" />
                                <b>D6+</b>
                                <input class="bonus" type="number" name="attr_violenceBonusDruidLion" value="0" />
                            </div>
                            <div class="midCol aPortee">
                                <select name="attr_porteeDruidLion">
                                    <option data-i18n="portee-contact" value="^{portee-contact}" selected>Contact</option>
                                    <option data-i18n="portee-courte" value="^{portee-courte}">Courte</option>
                                    <option data-i18n="portee-moyenne" value="^{portee-moyenne}">Moyenne</option>
                                    <option data-i18n="portee-longue" value="^{portee-longue}">Longue</option>
                                    <option data-i18n="portee-lointaine" value="^{portee-lointaine}">Lointaine</option>
                                </select>
                            </div>
                            <div class="lastCol aAspect">
                                <select name="attr_aspectDruidLion">
                                    <option value="druidLionChair" data-i18n="chair">Chair</option>
                                    <option value="druidLionBete" data-i18n="bete">Bete</option>
                                    <option value="druidLionMachine" data-i18n="machine">Machine</option>
                                    <option value="druidLionDame" data-i18n="dame">Dame</option>
                                    <option value="druidLionMasque" data-i18n="masque">Masque</option>
                                </select>
                                <button class="rollDice" type="action" name="act_combatdruidroll" value="@{jetGM} &{template:combat} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}}"></button>
                            </div>
                        </div>
                        <div class="subMenu">
                            <button class="effets" type="action" name="act_tab-1" data-i18n="effets">Effets</button>
                            <button class="ameliorationsArmes BL" type="action" name="act_tab-2" data-i18n="ameliorations-d'armes">Améliorations d'armes</button>
                            <button class="special BL" type="action" name="act_tab-3" data-i18n="special">Spécial</button>
                        </div>
                        
                        <div class="effets">
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_antiAnatheme" value="{{antiAnathème=Anti Anathème}}" />
                                <span data-i18n-title="anti-anatheme" title="Anti Anathème"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_antiVehicule" value="{{antiVehicule=Anti Véhicule}} " />
                                <span data-i18n-title="anti-vehicule" title="Anti Véhicule"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_artillerie" value="{{artillerie=Artillerie}}" />
                                <span data-i18n-title="artillerie" title="Artillerie"></span>
                            </label>
                            <div class="double">
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_assassin" value="{{assassin=[[@{assassinValue}d6]]}} " />
                                    <span data-i18n-title="assassin" title="Assassin"></span>
                                </label>
                                
                                <input type="number" name="attr_assassinValue" class="center" value="0" />
                            </div>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_assistanceAttaque" value="{{assistanceAttaque=Assistance à l'attaque}}" />
                                <span data-i18n-title="assistance-attaque" title="Assistance à l'attaque"></span>
                            </label>
                            <div class="double">
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_barrage" value="{{barrage=^{barrage} @{barrageValue}}} " />
                                    <span data-i18n-title="barrage" title="Barrage"></span>
                                </label>
                                
                                <input type="number" name="attr_barrageValue" class="center" value="0" />
                            </div>
                            <div class="double">
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_cadence" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                                    <span data-i18n-title="cadence" title="Cadence"></span>
                                </label>
                            
                                <input type="number" name="attr_cadenceValue" class="center" value="0" />
                            </div>
                            <div class="double">
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_chargeur" value="{{chargeur=^{chargeur} @{chargeurValue}}} " />
                                    <span data-i18n-title="chargeur" title="Chargeur"></span>
                                </label>
                            
                                <input type="number" name="attr_chargeurValue" class="center" value="0" />
                            </div>
                            <div class="double">
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_choc" value="{{choc=^{choc} @{chocValue}}}" />
                                    <span data-i18n-title="choc" title="Choc"></span>
                                </label>
                            
                                <input type="number" name="attr_chocValue" class="center" value="0" />
                            </div>
                            <div class="double">
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_defense" value="{{defense=^{defense} @{defenseValue}}}" />
                                    <span data-i18n-title="defense" title="Défense"></span>
                                </label>
                            
                                <input type="number" name="attr_defenseValue" class="center" value="0" />
                            </div>
                            <div class="double">
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_degatContinue" value="{{degatContinus=^{degats-continus} @{degatContinueValue} ([[1D6]] ^{tours})}}" />
                                    <span data-i18n-title="degats-continus" title="Dégâts Continus"></span>
                                </label>
                            
                                <input type="number" name="attr_degatContinueValue" class="center" size="2" value="0" />
                            </div>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_deuxMains" value="{{deuxMains=Deux Mains}}" />
                                <span data-i18n-title="deux-mains" title="Deux Mains"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_demoralisant" value="{{demoralisant=Démoralisant}}" />
                                <span data-i18n-title="demoralisant" title="Démoralisant"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_designation" value="{{designation=Désignation}}" />
                                <span data-i18n-title="designation" title="Désignation"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_destructeur" value="{{destructeur=[[2D6]]}}" />
                                <span data-i18n-title="destructeur" title="Destructeur"></span>
                            </label>
                            <div class="double">
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_dispersion" value="{{dispersion=^{dispersion} @{dispersionValue}}} " />
                                    <span data-i18n-title="dispersion" title="Dispersion"></span>
                                </label>
                            
                                <input type="number" name="attr_dispersionValue" class="center" value="0" />
                            </div>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_enChaine" value="{{enChaine=En Chaîne}}" />
                                <span data-i18n-title="en-chaine" title="En Chaîne"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_esperance" value="{{esperance=Espérance}}" />
                                <span data-i18n-title="esperance" title="Espérance"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_fureur" value="{{fureur=[[4D6]]}}" />
                                <span data-i18n-title="fureur" title="Fureur"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_ignoreArmure" value="{{ignoreArmure=Ignore Armure}}" />
                                <span data-i18n-title="ignore-armure" title="Ignore Armure"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_ignoreCdF" value="{{ignoreCdF=Ignore Champs de Force}}" />
                                <span data-i18n-title="ignore-champ-de-force" title="Ignore CdF"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_akimbo" value="2" />
                                <span data-i18n-title="jumele-akimbo" title="Jumelé (Akimbo)"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_ambidextrie" value="2" />
                                <span data-i18n-title="jumele-ambidextrie" title="Jumelé (Ambidextrie)"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_leste" value="{{leste=[[@{druidLionChairTot}]]}}" />
                                <span data-i18n-title="leste" title="Lesté"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_lourd" value="1" />
                                <span data-i18n-title="lourd" title="Lourd"></span>
                            </label>
                            <div class="double">
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_lumiere" value="{{lumiere=^{lumiere} @{lumiereValue}}}" />
                                    <span data-i18n-title="lumiere" title="Lumière"></span>
                                </label>
        
                                <input type="number" name="attr_lumiereValue" class="center" size="2" value="0" />
                            </div>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_meurtrier" value="{{meurtrier=[[2D6]]}}" />
                                <span data-i18n-title="meurtrier" title="Meurtrier"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_obliteration" value="{{obliteration=Oblitération}}" />
                                <span data-i18n-title="obliteration" title="Oblitération"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_orfevrerie" value="{{orfevrerie=[[@{dexterite}+@{dextOD}]]}} {{orfevrerieWarrior=[[@{dexterite}+@{dextOD}+@{warriorScoutA}]]}}" />
                                <span data-i18n-title="orfevrerie" title="Orfèvrerie"></span>
                            </label>
                            <div class="double">
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_parasitage" value="{{parasitage=^{parasitage} @{parasitageValue}}}" />
                                    <span data-i18n-title="parasitage" title="Parasitage"></span>
                                </label>
                            
                                <input type="number" name="attr_parasitageValue" class="center" value="0" />
                            </div>
                            <div class="double">
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_penetrant" value="{{penetrant=^{penetrant} @{penetrantValue}}}" />
                                    <span data-i18n-title="penetrant" title="Pénétrant"></span>
                                </label>
                            
                                <input type="number" name="attr_penetrantValue" class="center" value="0" />
                            </div>
                            <div class="double">
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_perceArmure" value="{{perceArmure=^{perce-armure} @{perceArmureValue}}}" />
                                    <span data-i18n-title="perce-armure" title="Perce Armure"></span>
                                </label>
                            
                                <input type="number" name="attr_perceArmureValue" class="center" value="0" />
                            </div>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_precision" value="{{precision=[[@{tir}+@{tirOD}]]}} {{precisionWarrior=[[@{tir}+@{tirOD}+@{warriorScholarA}]]}}" />
                                <span data-i18n-title="precision" title="Précision"></span>
                            </label>
                            <div class="double">
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_reaction" value="{{reaction=^{reaction} @{reactionValue}}}" />
                                    <span data-i18n-title="reaction" title="Réaction"></span>
                                </label>
                            
                                <input type="number" name="attr_reactionValue" class="center" value="0" />
                            </div>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_silencieux" value="{{silencieux=Silencieux}}" />
                                <span data-i18n-title="silencieux" title="Silencieux"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_soumission" value="{{soumission=Soumission}}" />
                                <span data-i18n-title="soumission" title="Soumission"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_tenebricite" value="{{tenebricite=Ténébricité}}" />
                                <span data-i18n-title="tenebricite" title="Ténébricité"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_tirRafale" value="{{tirRafale=Tir en Rafale}}" />
                                <span data-i18n-title="tir-rafale" title="Tir en Rafale"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_tirSecurite" value="3" />
                                <span data-i18n-title="tir-securite" title="Tir en Sécurité"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_ultraViolence" value="{{ultraviolence=[[2D6]]}}" />
                                <span data-i18n-title="ultraviolence" title="Ultraviolence"></span>
                            </label>
                        </div>
                        <div class="ameliorationsArmes">
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_chargeurGrappes" value="1" />
                                <span data-i18n-title="balles-grappes" title="Balles grappes"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_canonLong" value="{{canonLongM=1}} {{canonLongC=Canon Long (Portée Courte : +3 Difficulté)}}" />
                                <span data-i18n-title="canon-long" title="Canon Long"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_canonRaccourci" value="{{canonRaccourci=Canon Raccourci (Portée Courte : Dispersion 3 / Sinon : +3 Difficulté)}}" />
                                <span data-i18n-title="canon-raccourci" title="Canon Raccourci"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_chambreDouble" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                                <span data-i18n-title="chambre-double" title="Chambre Double"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_interfaceGuidage" value="3" />
                                <span data-i18n-title="interface-guidage" title="Interface de guidage"></span>
                            </label>
                            <div class="doubleTexte">
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_jumelage" value="{{jumelage=^{jumelage} (@{jumelageValue})}}" />
                                    <span data-i18n-title="jumelage" title="Jumelage :"></span>
                                </label>
                                <input type="text" name="attr_jumelageValue" class="borderBottom" />
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_jumelageType" value="ambidextrie" />
                                    <span data-i18n-title="ambidextrie" title="Ambidextrie"></span>
                                </label>
                                <label class="fakeButton borderTop">
                                    <input type="checkbox" name="attr_jumelageType" value="akimbo" />
                                    <span data-i18n-title="akimbo" title="Akimbo"></span>
                                </label>
                            </div>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_lunetteIntelligente" value="{{lunetteIntelligente=Lunette Intelligente (+1 Portée)}}" />
                                <span data-i18n-title="lunette-intelligente" title="Lunette Intelligente"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_munitionsHyperVelocite" value="{{munitionsHyperVelocite=Munitions à Hyper Velocite (Assistance à l'Attaque)}}" />
                                <span data-i18n-title="munitions-h-velocite" title="Munitions à H. Vélocité"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_munitionsDrone" value="{{munitionsDrone=3}}" />
                                <span data-i18n-title="munitions-drones" title="Munitions Drones"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_chargeurExplosives" value="1" />
                                <span data-i18n-title="munitions-explosives" title="Munitions Explosives"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_munitionsIEM" value="1" />
                                <span data-i18n-title="munitions-iem" title="Munitions IEM"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_munitionsNonLetales" value="2" />
                                <span  data-i18n-title="munitions-n-letales"title="Munitions N. Létales"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_munitionsSubsoniques" value="{{munitionsSubsoniques=Munitions Subsoniques (Silencieux)}}" />
                                <span data-i18n-title="munitions-subsoniques" title="Munitions Subsoniques"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_pointeurLaser" value="{{pointeurLaser=1}} " />
                                <span data-i18n-title="pointeur-laser" title="Pointeur Laser"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_protectionArme" value="{{protectionArme=Protection d'Arme (Reaction +2)}}" />
                                <span data-i18n-title="protection-d'arme" title="Protection d'Arme"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_revetementOmega" value="2" />
                                <span data-i18n-title="revetement-omega" title="Revêtement Omega"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_structureElement" value="{{structureElement=Structure en Élément}}" />
                                <span data-i18n-title="structure-alpha" title="Structure Alpha"></span>
                            </label>
                            <label class="simple fakeButton">
                                <input type="checkbox" name="attr_systemeRefroidissement" value="{{systemeRefroidissement=Système de Refroidissement (Tir en Rafale + Barrage 1)}}" />
                                <span data-i18n-title="systeme-refroid" title="Système de Refroid."></span>
                            </label>
                        </div>
                        <div class="special">
                            <div class="double">
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_energie" value="{{energie=@{energieValue}}} " />
                                    <span data-i18n-title="energie" title="Énergie"></span>
                                </label>
                            
                                <input type="number" name="attr_energieValue" class="center" value="0" />
                            </div>
                            <div class="triple">
                                <input type="hidden" name="attr_bDDiversTotal" value="0" />
        
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_bDDiversTotal" value="{{BDDivers=[[@{bDDiversD6}D6+@{bDDiversFixe}]]}} " />
                                    <span data-i18n-title="bonus-degats" title="Bonus aux dégâts"></span>
                                </label>
                                <div>
                                    <input class="L" type="number" name="attr_bDDiversD6" class="center" value="0" />
                                    <span>D6+</span>
                                    <input class="R" type="number" name="attr_bDDiversFixe" class="center" value="0" />
                                </div>
                            </div>
                            <div class="triple">
                                <input type="hidden" name="attr_bVDiversTotal" value="0" />
        
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_bVDiversTotal" value="{{BVDivers=[[@{bVDiversD6}D6+@{bVDiversFixe}]]}} " />
                                    <span data-i18n-title="bonus-violence" title="Bonus à la violence"></span>
                                </label>
                                <div>
                                    <input class="L" type="number" name="attr_bVDiversD6" class="center" value="0" />
                                    <span>D6+</span>
                                    <input class="R" type="number" name="attr_bVDiversFixe" class="center" value="0" />
                                </div>
                            </div>
                        </div>
                    </fieldset>
                </div>
        
                <div class="modules">
                    <input type="hidden" name="attr_slotsDCLTeteMax" value="8" readonly />
                    <input type="hidden" name="attr_slotsUDCLTeteTot" value="0" />
                    
                    <input type="hidden" name="attr_slotsDCLTorseMax" value="8" readonly />
                    <input type="hidden" name="attr_slotsUDCLTorseTot" value="0" />
                
                    <input type="hidden" name="attr_slotsDCLBGMax" value="8" readonly />
                    <input type="hidden" name="attr_slotsUDCLBGTot" value="0" />
                
                    <input type="hidden" name="attr_slotsDCLBDMax" value="8" readonly />
                    <input type="hidden" name="attr_slotsUDCLBDTot" value="0" />
                
                    <input type="hidden" name="attr_slotsDCLJGMax" value="8" readonly />
                    <input type="hidden" name="attr_slotsUDCLJGTot" value="0" />
                
                    <input type="hidden" name="attr_slotsDCLJDMax" value="8" readonly />
                    <input type="hidden" name="attr_slotsUDCLJDTot" value="0" />
        
                    <h1 class="titre" data-i18n="slots-du-lion">Slots du Lion</h1>
                    <div class="ligne slots">
                        <div class="col6">
                            <span data-i18n="tete">Tête</span>
                            <div data-i18n-title="slots-restants/slots-maximum" title="Slots restants / Slots maximum">
                                <input type="number" name="attr_slotsDCLTeteAct" value="@{slotsDCLTeteMax}-@{slotsUDCLTeteTot}" disabled />	
                                <b>/</b>
                                <span name="attr_slotsDCLTeteMax">8</span>
                            </div>
                        </div>
        
                        <div class="col6BL">
                            <span data-i18n="torse">Torse</span>
                            <div data-i18n-title="slots-restants/slots-maximum" title="Slots restants / Slots maximum">
                                <input type="number" name="attr_slotsDCLTorseAct" value="@{slotsDCLTorseMax}-@{slotsUDCLTorseTot}" disabled />
                                <b>/</b>
                                <span name="attr_slotsDCLTorseMax">8</span>
                            </div>
                        </div>
        
                        <div class="col6BL">
                            <span data-i18n="bras-gauche">Bras Gauche</span>
                            <div data-i18n-title="slots-restants/slots-maximum" title="Slots restants / Slots maximum">
                                <input type="number" name="attr_slotsDCLBGAct" value="@{slotsDCLBGMax}-@{slotsUDCLBGTot}" disabled />
                                <b>/</b>
                                <span name="attr_slotsDCLBGMax">8</span>
                            </div>
                        </div>
        
                        <div class="col6BL">
                            <span data-i18n="bras-droit">Bras Droit</span>
                            <div data-i18n-title="slots-restants/slots-maximum" title="Slots restants / Slots maximum">
                                <input type="number" name="attr_slotsDCLBDAct" value="@{slotsDCLBDMax}-@{slotsUDCLBDTot}" disabled />
                                <b>/</b>
                                <span name="attr_slotsDCLBDMax">8</span>
                            </div>
                        </div>
        
                        <div class="col6BL">
                            <span data-i18n="jambe-gauche">Jambe Gauche</span>
                            <div data-i18n-title="slots-restants/slots-maximum" title="Slots restants / Slots maximum">
                                <input type="number" name="attr_slotsDCLJGAct" value="@{slotsDCLJGMax}-@{slotsUDCLJGTot}" disabled />
                                <b>/</b>
                                <span name="attr_slotsDCLJGMax">8</span>
                            </div>
                        </div>
        
                        <div class="col6BL">
                            <span data-i18n="jambe-droite">Jambe Droite</span>
                            <div data-i18n-title="slots-restants/slots-maximum" title="Slots restants / Slots maximum">
                                <input type="number" name="attr_slotsDCLJDAct" value="@{slotsDCLJDMax}-@{slotsUDCLJDTot}" disabled />
                                <b>/</b>
                                <span name="attr_slotsDCLJDMax">8</span>
                            </div>
                        </div>
                    </div>
                    <fieldset class="repeating_modulesDCLion">
                        <input class="expandModule" type="hidden" name="attr_affichageDCLion" value="0" />
                        <input class="expandSlots" type="hidden" name="attr_slotsDCLPlus" value="0" />
        
                        <div class="ligne titreModule">
                            <button class="buttonPlus" type="action" name="act_affichagedclion-1">
                               <span class="plus">+</span>
                               <span class="moins">-</span>
                            </button>
                            <input type="text" name="attr_moduleNomDCLion" placeholder="Nom du Module"/>
                        </div>
                        
                        <div class="ligne hModule">
                            <label class="activation">
                                <span data-i18n="activation">Activation</span>
                                <input type="text" name="attr_moduleActivationDCLion" />
                            </label>
                            <div class="PE">
                                <button type="action" name="act_pemdlion" title="Dépenser les PE du module" data-i18n-title="depenser-pe-module" data-i18n="point-d'energie-short">PE</button>
                                <input type="number" name="attr_moduleEnergieDCLion" value="0" />
                            </div>
                        </div>
        
                        <label class="ligne hModule duree">
                            <span data-i18n="duree">Durée</span>
                            <input type="text" name="attr_moduleDureeDCLion" />
                        </label>
        
                        <div class="autoex hModule autoex28">
                            <span name="attr_moduleDescriptionDCLion"></span>
                            <textarea name="attr_moduleDescriptionDCLion"></textarea>
                        </div>
        
                        <div class="ligne hModule titre titreSlots">
                            <input type="number" name="attr_slotsTotalDCLion" value="@{moduleSlotDCLTete}+@{moduleSlotDCLTorse}+@{moduleSlotDCLBG}+@{moduleSlotDCLBD}+@{moduleSlotDCLJG}+@{moduleSlotDCLJD}" title="Slots occupés" disabled />
                            <h1 class="titre" data-i18n="slots">Slots</h1>
                            <button class="buttonArrow" type="action" name="act_slotsdclplus-1">]</button>
                        </div>
                        
                        <div class="ligne hSlots">
                            <label class="slot">
                                <span data-i18n="tete">Tête</span>
                                <input type="number" name="attr_moduleSlotDCLTete" value="0" />
                            </label>
                            
                            <label class="slotBL">
                                <span data-i18n="torse">Torse</span>
                                <input type="number" name="attr_moduleSlotDCLTorse" value="0" />
                            </label>
                        </div>
                        
                        <div class="ligne hSlots bTop">
                            <label class="slot">
                                <span data-i18n="bras-gauche">Bras Gauche</span>
                                <input type="number" name="attr_moduleSlotDCLBG" value="0" />
                            </label>
                            
                            <label class="slotBL">
                                <span data-i18n="bras-droit">Bras Droit</span>
                                <input type="number" name="attr_moduleSlotDCLBD" value="0" />
                            </label>
                        </div>
                        
                        <div class="ligne hSlots bTop">
                            <label class="slot">
                                <span data-i18n="jambe-gauche">Jambe Gauche</span>
                                <input type="number" name="attr_moduleSlotDCLJG" value="0" />
                            </label>
                            
                            <label class="slotBL">
                                <span data-i18n="jambe-droite">Jambe Droite</span>
                                <input type="number" name="attr_moduleSlotDCLJD" value="0" />
                            </label>
                        </div>
                    </fieldset>
                </div>
        
                <div class="evolutions">
                    <input type="hidden" name="attr_druidLionChairBase" value="7" />
                    <input type="hidden" name="attr_druidLionBeteBase" value="6" />
                    <input type="hidden" name="attr_druidLionMachineBase" value="7" />
                    <input type="hidden" name="attr_druidLionDameBase" value="4" />
                    <input type="hidden" name="attr_druidLionMasqueBase" value="3" />
                                                
                    <input type="hidden" name="attr_druidLionPABase" value="60" />
                    <input type="hidden" name="attr_druidLionDefenseBase" value="4" />
                    <input type="hidden" name="attr_druidLionReactionBase" value="4" />
                    <input type="hidden" name="attr_druidLionInitiativeBase" value="2" />
                    <input type="hidden" name="attr_druidLionCDFBase" value="10" />
        
                    <div class="aspects">
                        <div class="ligneTitre">
                            <span></span>
                            <span data-i18n="aspects">Aspects</span>
                            <span data-i18n="aspects-exceptionnels">Aspects Exceptionnels</span>
                        </div>
                        <div class="ligne2">
                            <span data-i18n="chair">Chair</span>
                            <div>
                                <input type="number" name="attr_druidLionChairEvol" value="0" min="0" />
                            </div>
                            <div>
                                <select name="attr_druidLionChairAE">
                                    <option value="1" selected>1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                </select>
                            </div>
                            
                        </div>
                        <div class="ligne2">
                            <span data-i18n="bete">Bête</span>
                            <div>
                                <input type="number" name="attr_druidLionBeteEvol" value="0" min="0" />
                            </div>
                            <div>
                                <select name="attr_druidLionBeteAE">
                                    <option value="1" selected>1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                </select>
                            </div>
                        </div>
                        <div class="ligne2">
                            <span data-i18n="machine">Machine</span>
                            <div>
                                <input type="number" name="attr_druidLionMachineEvol" value="0" min="0" />
                            </div>
                            <div>
                                <select name="attr_druidLionMachineAE">
                                    <option value="1" selected>1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                </select>
                            </div>
                        </div>
                        <div class="ligne2">
                            <span data-i18n="dame">Dame</span>
                            <div>
                                <input type="number" name="attr_druidLionDameEvol" value="0" min="0" />
                            </div>
                            <div>
                                <select name="attr_druidLionDameAE">
                                    <option value="0" selected>0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                </select>
                            </div>
                        </div>
                        <div class="ligne2">
                            <span data-i18n="masque">Masque</span>
                            <div>
                                <input type="number" name="attr_druidLionMasqueEvol" value="0" min="0" />
                            </div>
                            <div>
                                <select name="attr_druidLionMasqueAE">
                                    <option value="0" selected>0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="VD">
                        <div class="ligneTitre">
                            <span></span>
                            <span data-i18n="valeurs-derivees">Valeurs Dérivées</span>
                        </div>
                        <label class="ligne1">
                            <span data-i18n="champ-de-force">Champs de Force</span>
                            <input type="number" name="attr_druidLionCDFEvol" value="0" min="0" />
                        </label>
                        <label class="ligne1">
                            <span data-i18n="armure">Armure</span>
                            <input type="number" name="attr_druidLionPAEvol" value="0" min="0" />
                        </label>
                        <label class="ligne1">
                            <span data-i18n="defense">Défense</span>
                            <input type="number" name="attr_druidLionDefenseEvol" value="0" min="0" />
                        </label>
                        <label class="ligne1">
                            <span data-i18n="reaction">Réaction</span>
                            <input type="number" name="attr_druidLionReactionEvol" value="0" min="0" />
                        </label>
                        <label class="ligne1">
                            <span data-i18n="initiative">Initiative</span>
                            <input type="number" name="attr_druidLionInitiativeEvol" value="0" min="0" />
                        </label>
                    </div>
                </div>
            </div>
        
            <div class="fichePJ druid DCWolf marginTop">
                <input class="subMenu" type="hidden" name="attr_tabDruidWolf" value="0" />
                <input class="choixConfiguration" type="hidden" name="attr_druidWolfConfiguration" />
                <input class="laborNiveau" type="hidden" name="attr_DWolfLaborNiveau" value="1" />
                <input class="medikNiveau" type="hidden" name="attr_DWolfMedicNiveau" value="1" />
                <input class="techNiveau" type="hidden" name="attr_DWolfTechNiveau" value="1" />
                <input class="fighterNiveau" type="hidden" name="attr_DWolfFighterNiveau" value="1" />
                <input class="reconNiveau" type="hidden" name="attr_DWolfReconNiveau" value="1" />
        
                <h1 class="titre" data-i18n="druid-companion-wolf">Wolf</h1>
                <div class="col4">
                    <h1 class="titre" data-i18n="aspects">Aspects</h1>
        
                    <div class="ligne aspect">
                        <span data-i18n="chair">Chair</span>
        
                        <div class="blockR">
                            <input type="number" name="attr_druidWolfChairTot" value="@{druidWolfChairBase}+@{druidWolfChairEvol}" disabled />
                            <button class="rollDice" name="act_druidWolfChairRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-wolf}}} {{special1=@{name}}}"></button>
                        </div>
                    </div>
                    <div class="ligne aspect">
                        <span data-i18n="bete">Bête</span>
        
                        <div class="blockR">
                            <input type="number" name="attr_druidWolfBeteTot" value="@{druidWolfBeteBase}+@{druidWolfBeteEvol}" disabled />
                            <button class="rollDice" name="act_druidWolfBeteRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-wolf}}} {{special1=@{name}}}"></button>    
                        </div>
                    </div>
                    <div class="ligne aspect">
                        <span data-i18n="machine">Machine</span>
        
                        <div class="blockR">
                            <input type="number" name="attr_druidWolfMachineTot" value="@{druidWolfMachineBase}+@{druidWolfMachineEvol}" disabled />
                            <button class="rollDice" name="act_druidWolfMachineRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-wolf}}} {{special1=@{name}}}"></button>
                        </div>
                    </div>
                    <div class="ligne aspect">
                        <span data-i18n="dame">Dame</span>
        
                        <div class="blockR">
                            <input type="number" name="attr_druidWolfDameTot" value="@{druidWolfDameBase}+@{druidWolfDameEvol}" disabled />
                            <button class="rollDice" name="act_druidWolfDameRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-wolf}}} {{special1=@{name}}}"></button>
                        </div>
                    </div>
                    <div class="ligne aspect">
                        <span data-i18n="masque">Masque</span>
        
                        <div class="blockR">
                            <input type="number" name="attr_druidWolfMasqueTot" value="@{druidWolfMasqueBase}+@{druidWolfMasqueEvol}" disabled />
                            <button class="rollDice" name="act_druidWolfMasqueRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-wolf}}} {{special1=@{name}}}"></button>
                        </div>
                    </div>
                </div>
        
                <div class="col4BL">
                    <h1 class="titre" data-i18n="aspects-exceptionnels">Aspects Exceptionnels</h1>
        
                    <div class="ligne AE">
                        <input type="hidden" name="attr_druidWolfChairAE" value="0"/>
                        <span class="mineur" data-i18n="mineur">Mineur</span>
                        <span class="majeur" data-i18n="majeur">Majeur</span>
                        <span class="value" name="attr_druidWolfChairAE">0</span>
                    </div>
                    <div class="ligne AE">
                        <input type="hidden" name="attr_druidWolfBeteAE" value="0"/>
                        <span class="mineur" data-i18n="mineur">Mineur</span>
                        <span class="majeur" data-i18n="majeur">Majeur</span>
                        <span class="value" name="attr_druidWolfBeteAE">0</span>
                    </div>
                    <div class="ligne AE">
                        <input type="hidden" name="attr_druidWolfMachineAE" value="0"/>
                        <span class="mineur" data-i18n="mineur">Mineur</span>
                        <span class="majeur" data-i18n="majeur">Majeur</span>
                        <span class="value" name="attr_druidWolfMachineAE">0</span>
                    </div>
                    <div class="ligne AE">
                        <input type="hidden" name="attr_druidWolfDameAE" value="0"/>
                        <span class="mineur" data-i18n="mineur">Mineur</span>
                        <span class="majeur" data-i18n="majeur">Majeur</span>
                        <span class="value" name="attr_druidWolfDameAE">0</span>
                    </div>
                    <div class="ligne AE">
                        <input type="hidden" name="attr_druidWolfMasqueAE" value="0"/>
                        <span class="mineur" data-i18n="mineur">Mineur</span>
                        <span class="majeur" data-i18n="majeur">Majeur</span>
                        <span class="value" name="attr_druidWolfMasqueAE">0</span>
                    </div>
                </div>
        
                <div class="col4BL">
                    <h1 class="titre" data-i18n="valeurs-derivees">Valeurs Dérivées</h1>
        
                    <div class="ligne defense">
                        <span data-i18n="defense">Défense</span>
        
                        <div class="blockR">
                            <input type="number" name="attr_druidWolfDefenseTot" value="4+@{druidWolfMasqueAE}" disabled />
                        </div>
                    </div>
        
                    <div class="ligne reaction">
                        <span data-i18n="reaction">Réaction</span>
        
                        <div class="blockR">
                            <input type="number" name="attr_druidWolfReactionTot" value="4+@{druidWolfMachineAE}" disabled />
                        </div>
                    </div>
        
                    <div class="ligne initiative">
                        <span data-i18n="initiative">Initiative</span>
        
                        <div class="blockR">
                            <input type="number" name="attr_druidWolfInitiativeTot" value="2" disabled />
                            <button class="rollDice" type="action" name="act_druidWolfInitiativeRoll" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-wolf}}} {{special1=@{name}}}"></button>
                        </div>
                    </div>
        
                    <div class="ligne armure">
                        <span data-i18n="armure">Armure</span>
        
                        <div class="blockR">
                            <input type="number" name="attr_druidWolfPAAct" value="20" />
                            <b>/</b>
                            <input type="number" name="attr_druidWolfPAAct_max" value="20" disabled />
                        </div>
                    </div>
        
                    <div class="ligne energie">
                        <span data-i18n="energie">Energie</span>
        
                        <div class="blockR">
                            <input type="number" name="attr_druidWolfPEAct" value="0" />
                            <b>/</b>
                            <input type="number" name="attr_druidWolfPEAct_max" value="@{druidEnergieCompanon}" disabled />
                        </div>
                    </div>
                </div>
        
                <div class="col4BL">
                    <h1 class="titre" data-i18n="champ-de-force">Champ de Force</h1>
        
                    <div class="ligne CDF">
                        <input type="number" name="attr_druidWolfCDFT" value="4" disabled />
                    </div>
        
                    <h1 class="titre" data-i18n="configuration">Configuration</h1>
                    <div class="ligne configuration">
                        <select name="attr_druidWolfConfiguration">
                            <option value="" selected></option>
                            <option value="Labor" data-i18n="druid-wolf-labor">Labor</option>
                            <option value="Medic" data-i18n="druid-wolf-medik">Medik</option>
                            <option value="Tech" data-i18n="druid-wolf-tech">Tech</option>
                            <option value="Fighter" data-i18n="druid-wolf-fighter">Fighter</option>
                            <option value="Recon" data-i18n="druid-wolf-recon">Recon</option>
                        </select>
                        <button type="action" name="act_druidWolfConfiguration" data-i18n="point-energie-short">PE</button>
                        <input type="number" name="attr_druidWolfConfigurationPE" value="0" readonly />
                    </div>
                    <div class="ligne nbreCompanions">
                        <select name="attr_druidNombreCompagnon">
                            <option value="3" data-i18n="druid-3-companions-restants" selected>3 Companions Restants</option>
                            <option value="2"data-i18n="druid-2-companions-restants" >2 Companions Restants</option>
                            <option value="1"data-i18n="druid-1-companions-restants" >1 Companions Restant</option>
                        </select>
                    </div>
                    <div class="ligne fighter">
                        <span data-i18n="degats">Dégâts</span>
                        <button class="rollDice" type="action" name="act_DWolfFighterRoll" value="@{jetGM} &{template:combat} {{portee=^{portee-contact}}} {{Nom=^{druid-companion-wolf}}} {{special1=@{name}}}"></button>
                    </div>
                </div>
        
                <h1 class="titre" data-i18n="configuration">Configuration</h1>
                <div class="labor description">
                    <span class="N1" data-i18n="druid-companion-labor-description-niveau-1">
                        Les actions du chevalier visant à porter de lourdes charges, à déplacer ou lever des poids reçoivent 1 dé par compagnon effectuant l’action de support. Chaque compagnon peut porter à lui seul 150 kg et peut donc transporter des choses pour le chevalier.
                    </span>
                    <span class="N2" data-i18n="druid-companion-labor-description-niveau-2">
                        Les actions du chevalier visant à porter de lourdes charges, à déplacer ou lever des poids reçoivent 2 dé par compagnon effectuant l’action de support. Chaque compagnon peut porter à lui seul 150 kg et peut donc transporter des choses pour le chevalier.
                    </span>
                    <span class="N3" data-i18n="druid-companion-labor-description-niveau-3">
                        Les actions du chevalier visant à porter de lourdes charges, à déplacer ou lever des poids reçoivent 3 dé par compagnon effectuant l’action de support. Chaque compagnon peut porter à lui seul 150 kg et peut donc transporter des choses pour le chevalier.
                    </span>
                </div>
        
                <div class="medik description">
                    <span class="N1" data-i18n="druid-companion-medik-description-niveau-1">
                        Les actions du chevalier visant à soigner, à faire des recherches biologiques ou à reconnaitre un élément médical ou biologique reçoivent 1 dé supplémentaire par compagnon effectuant un support. Si le chevalier soigne un allié, celui-ci récupère 2 PS supplémentaires par compagnon effectuant un support.
                    </span>
                    <span class="N2" data-i18n="druid-companion-medik-description-niveau-2">
                        Les actions du chevalier visant à soigner, à faire des recherches biologiques ou à reconnaitre un élément médical ou biologique reçoivent 2 dé supplémentaire par compagnon effectuant un support. Si le chevalier soigne un allié, celui-ci récupère 2 PS supplémentaires par compagnon effectuant un support.
                    </span>
                    <span class="N3" data-i18n="druid-companion-medik-description-niveau-3">
                        Les actions du chevalier visant à soigner, à faire des recherches biologiques ou à reconnaitre un élément médical ou biologique reçoivent 3 dé supplémentaire par compagnon effectuant un support. Si le chevalier soigne un allié, celui-ci récupère 2 PS supplémentaires par compagnon effectuant un support.
                    </span>
                </div>
        
                <div class="tech description">
                    <span class="N1" data-i18n="druid-companion-tech-description-niveau-1">
                        Les actions du chevalier visant à réparer un objet, un véhicule, un compagnon ou une méta-armure, à analyser un élément informatique ou électronique reçoivent 1 dé supplémentaire par compagnon effectuant un support. Le chevalier peut effectuer les réparations ou les analyses directement depuis un compagnon. Si le chevalier tente de réparer quelque chose (méta-armure, compagnon, véhicule) à l’aide de ses Companions, les PA que la cible récupère sont augmentés de 3 par compagnon effectuant l’action de support.
                    </span>
                    <span class="N2" data-i18n="druid-companion-tech-description-niveau-2">
                        Les actions du chevalier visant à réparer un objet, un véhicule, un compagnon ou une méta-armure, à analyser un élément informatique ou électronique reçoivent 2 dé supplémentaire par compagnon effectuant un support. Le chevalier peut effectuer les réparations ou les analyses directement depuis un compagnon. Si le chevalier tente de réparer quelque chose (méta-armure, compagnon, véhicule) à l’aide de ses Companions, les PA que la cible récupère sont augmentés de 3 par compagnon effectuant l’action de support.
                    </span>
                    <span class="N3" data-i18n="druid-companion-tech-description-niveau-3">
                        Les actions du chevalier visant à réparer un objet, un véhicule, un compagnon ou une méta-armure, à analyser un élément informatique ou électronique reçoivent 3 dé supplémentaire par compagnon effectuant un support. Le chevalier peut effectuer les réparations ou les analyses directement depuis un compagnon. Si le chevalier tente de réparer quelque chose (méta-armure, compagnon, véhicule) à l’aide de ses Companions, les PA que la cible récupère sont augmentés de 3 par compagnon effectuant l’action de support.
                    </span>
                </div>
        
                <div class="fighter description">
                    <span class="N1" data-i18n="druid-companion-fighter-description-niveau-1">
                        Les actions de combat du chevalier contre un ennemi désigné aux Companions reçoivent 1 dé supplémentaire par compagnon effectuant un support. La cible du chevalier doit être à portée courte et doit pouvoir être attaquée au contact. Si ces deux conditions sont respectées, la cible reçoit automatiquement l’effet barrage 1 par compagnon (3 Companions supportant le chevalier infligent ainsi l’effet barrage 3). De plus, les Companions infligent à la cible 1D6 points de dégâts ou de violence chacun (sans bonus) sans devoir effectuer de jet de dés pour toucher. On considère cependant que lorsqu’ils effectuent cette action de support, leur défense tombe à 0. Une seule cible à la fois peut subir cette action de support.
                    </span>
                    <span class="N2" data-i18n="druid-companion-fighter-description-niveau-2">
                        Les actions de combat du chevalier contre un ennemi désigné aux Companions reçoivent 2 dé supplémentaire par compagnon effectuant un support. La cible du chevalier doit être à portée courte et doit pouvoir être attaquée au contact. Si ces deux conditions sont respectées, la cible reçoit automatiquement l’effet barrage 1 par compagnon (3 Companions supportant le chevalier infligent ainsi l’effet barrage 3). De plus, les Companions infligent à la cible 1D6 points de dégâts ou de violence chacun (sans bonus) sans devoir effectuer de jet de dés pour toucher. On considère cependant que lorsqu’ils effectuent cette action de support, leur défense tombe à 0. Une seule cible à la fois peut subir cette action de support.
                    </span>
                    <span class="N3" data-i18n="druid-companion-fighter-description-niveau-3">
                        Les actions de combat du chevalier contre un ennemi désigné aux Companions reçoivent 3 dé supplémentaire par compagnon effectuant un support. La cible du chevalier doit être à portée courte et doit pouvoir être attaquée au contact. Si ces deux conditions sont respectées, la cible reçoit automatiquement l’effet barrage 1 par compagnon (3 Companions supportant le chevalier infligent ainsi l’effet barrage 3). De plus, les Companions infligent à la cible 1D6 points de dégâts ou de violence chacun (sans bonus) sans devoir effectuer de jet de dés pour toucher. On considère cependant que lorsqu’ils effectuent cette action de support, leur défense tombe à 0. Une seule cible à la fois peut subir cette action de support.
                    </span>
                </div>
        
                <div class="recon description">
                    <span class="N1" data-i18n="druid-companion-recon-description-niveau-1">
                        Toutes les actions d’observation, de vigilance ou de fouille menées par le chevalier reçoivent 1 dé supplémentaire par compagnon effectuant le support. Le chevalier peut observer, entendre, sentir et toucher directement depuis un des compagnons (au choix).
                    </span>
                    <span class="N2" data-i18n="druid-companion-recon-description-niveau-2">
                        Toutes les actions d’observation, de vigilance ou de fouille menées par le chevalier reçoivent 2 dé supplémentaire par compagnon effectuant le support. Le chevalier peut observer, entendre, sentir et toucher directement depuis un des compagnons (au choix).
                    </span>
                    <span class="N3" data-i18n="druid-companion-recon-description-niveau-3">
                        Toutes les actions d’observation, de vigilance ou de fouille menées par le chevalier reçoivent 3 dé supplémentaire par compagnon effectuant le support. Le chevalier peut observer, entendre, sentir et toucher directement depuis un des compagnons (au choix).
                    </span>
                </div>
        
                <div class="subMenu">
                    <button class="evolutions" type="action" name="act_tabDruidWolf_3" data-i18n="evolutions">Evolutions</button>
                </div>
        
                <div class="evolutions">
                    <input type="hidden" name="attr_druidWolfChairBase" value="2" disabled />
                    <input type="hidden" name="attr_druidWolfBeteBase" value="4" disabled />
                    <input type="hidden" name="attr_druidWolfMachineBase" value="4" disabled />
                    <input type="hidden" name="attr_druidWolfDameBase" value="2" disabled />
                    <input type="hidden" name="attr_druidWolfMasqueBase" value="4" disabled />
                    
                    <div class="aspects">
                        <div class="ligneTitre">
                            <span data-i18n="aspects">Aspects</span>
                            <span data-i18n="aspects-exceptionnels">Aspects Exceptionnels</span>
                        </div>
                        <div class="ligne2">
                            <span data-i18n="chair">Chair</span>
        
                            <div>
                                <input type="number" name="attr_druidWolfChairEvol" value="0" min="0" />
                            </div>
                            <div>
                                <select name="attr_druidWolfChairAE">
                                    <option value="0" selected>0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                </select>
                            </div>
                        </div>
                        <div class="ligne2">
                            <span data-i18n="bete">Bête</span>
                            <div>
                                <input type="number" name="attr_druidWolfBeteEvol" value="0" min="0" />
                            </div>
                            <div>
                                <select name="attr_druidWolfBeteAE">
                                    <option value="0" selected>0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                </select>
                            </div>
                        </div>
                        <div class="ligne2">
                            <span data-i18n="machine">Machine</span>
        
                            <div>
                                <input type="number" name="attr_druidWolfMachineEvol" value="0" min="0" />
                            </div>
                            <div>
                                <select name="attr_druidWolfMachineAE">
                                    <option value="0" selected>0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                </select>
                            </div>
                        </div>
                        <div class="ligne2">
                            <span data-i18n="dame">Dame</span>
        
                            <div>
                                <input type="number" name="attr_druidWolfDameEvol" value="0" min="0" />
                            </div>
                            <div>
                                <select name="attr_druidWolfDameAE">
                                    <option value="0" selected>0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                </select>
                            </div>
                        </div>
                        <div class="ligne2">
                            <span data-i18n="masque">Masque</span>
        
                            <div>
                                <input type="number" name="attr_druidWolfMasqueEvol" value="0" min="0" />
                            </div>
                            <div>
                                <select name="attr_druidWolfMasqueAE">
                                    <option value="0" selected>0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="companions cLabor">
                        <div class="tCompanions">
                            <h2 data-i18n="druid-companion-labor">Labor</h2>
                            <select name="attr_DWolfLaborNiveau">
                                <option value="1" data-i18n="druid-companion-niveau-1" selected>Niveau 1</option>
                                <option value="2" data-i18n="druid-companion-niveau-2">Niveau 2</option>
                                <option value="3" data-i18n="druid-companion-niveau-3">Niveau 3</option>
                            </select>
                        </div>
        
                        <span class="N1" data-i18n="druid-companion-labor-description-niveau-1">
                            Les actions du chevalier visant à porter de lourdes charges, à déplacer ou lever des poids reçoivent 1 dé par compagnon effectuant l’action de support. Chaque compagnon peut porter à lui seul 150 kg et peut donc transporter des choses pour le chevalier.
                        </span>
                        <span class="N2" data-i18n="druid-companion-labor-description-niveau-2">
                            Les actions du chevalier visant à porter de lourdes charges, à déplacer ou lever des poids reçoivent 2 dé par compagnon effectuant l’action de support. Chaque compagnon peut porter à lui seul 150 kg et peut donc transporter des choses pour le chevalier.
                        </span>
                        <span class="N3" data-i18n="druid-companion-labor-description-niveau-3">
                            Les actions du chevalier visant à porter de lourdes charges, à déplacer ou lever des poids reçoivent 3 dés par compagnon effectuant l’action de support. Chaque compagnon peut porter à lui seul 150 kg et peut donc transporter des choses pour le chevalier.
                        </span>
                    </div>
                    
                    <div class="companions cMedik mT">
                        <div class="tCompanions">
                            <h2 data-i18n="druid-companion-medik">Medik</h2>
                            <select name="attr_DWolfMedicNiveau">
                                <option value="1" data-i18n="druid-companion-niveau-1" selected>Niveau 1</option>
                                <option value="2" data-i18n="druid-companion-niveau-2">Niveau 2</option>
                                <option value="3" data-i18n="druid-companion-niveau-3">Niveau 3</option>
                            </select>
                        </div>
        
                        <span class="N1" data-i18n="druid-companion-medik-description-niveau-1">
                            Les actions du chevalier visant à soigner, à faire des recherches biologiques ou à reconnaitre un élément médical ou biologique reçoivent 1 dé supplémentaire par compagnon effectuant un support. Si le chevalier soigne un allié, celui-ci récupère 2 PS supplémentaires par compagnon effectuant un support.
                        </span>
                        <span class="N2" data-i18n="druid-companion-medik-description-niveau-2">
                            Les actions du chevalier visant à soigner, à faire des recherches biologiques ou à reconnaitre un élément médical ou biologique reçoivent 2 dés supplémentaire par compagnon effectuant un support. Si le chevalier soigne un allié, celui-ci récupère 2 PS supplémentaires par compagnon effectuant un support.
                        </span>
                        <span class="N3" data-i18n="druid-companion-medik-description-niveau-3">
                            Les actions du chevalier visant à soigner, à faire des recherches biologiques ou à reconnaitre un élément médical ou biologique reçoivent 3 dés supplémentaire par compagnon effectuant un support. Si le chevalier soigne un allié, celui-ci récupère 2 PS supplémentaires par compagnon effectuant un support.
                        </span>
                    </div>
                    
                    <div class="companions cTech mT">
                        <div class="tCompanions">
                            <h2 data-i18n="druid-companion-tech">Tech</h2>
                            <select name="attr_DWolfTechNiveau">
                                <option value="1" data-i18n="druid-companion-niveau-1" selected>Niveau 1</option>
                                <option value="2" data-i18n="druid-companion-niveau-2">Niveau 2</option>
                                <option value="3" data-i18n="druid-companion-niveau-3">Niveau 3</option>
                            </select>
                        </div>
        
                        <span class="N1" data-i18n="druid-companion-tech-description-niveau-1">
                            Les actions du chevalier visant à réparer un objet, un véhicule, un compagnon ou une méta-armure, à analyser un élément informatique ou électronique reçoivent 1 dé supplémentaire par compagnon effectuant un support. Le chevalier peut effectuer les réparations ou les analyses directement depuis un compagnon. Si le chevalier tente de réparer quelque chose (méta-armure, compagnon, véhicule) à l’aide de ses compagnons, les PA que la cible récupère sont augmentés de 3 par compagnon effectuant l’action de support.
                        </span>
                        <span class="N2" data-i18n="druid-companion-tech-description-niveau-2">
                            Les actions du chevalier visant à réparer un objet, un véhicule, un compagnon ou une méta-armure, à analyser un élément informatique ou électronique reçoivent 2 dés supplémentaire par compagnon effectuant un support. Le chevalier peut effectuer les réparations ou les analyses directement depuis un compagnon. Si le chevalier tente de réparer quelque chose (méta-armure, compagnon, véhicule) à l’aide de ses compagnons, les PA que la cible récupère sont augmentés de 3 par compagnon effectuant l’action de support.
                        </span>
                        <span class="N3" data-i18n="druid-companion-tech-description-niveau-3">
                            Les actions du chevalier visant à réparer un objet, un véhicule, un compagnon ou une méta-armure, à analyser un élément informatique ou électronique reçoivent 3 dés supplémentaire par compagnon effectuant un support. Le chevalier peut effectuer les réparations ou les analyses directement depuis un compagnon. Si le chevalier tente de réparer quelque chose (méta-armure, compagnon, véhicule) à l’aide de ses compagnons, les PA que la cible récupère sont augmentés de 3 par compagnon effectuant l’action de support.
                        </span>
                    </div>
                    
                    <div class="companions cFighter mT">
                        <div class="tCompanions">
                            <h2 data-i18n="druid-companion-fighter">Fighter</h2>
                            <select name="attr_DWolfFighterNiveau">
                                <option value="1" data-i18n="druid-companion-niveau-1" selected>Niveau 1</option>
                                <option value="2" data-i18n="druid-companion-niveau-2">Niveau 2</option>
                                <option value="3" data-i18n="druid-companion-niveau-3">Niveau 3</option>
                            </select>
                        </div>
        
                        <span class="N1" data-i18n="druid-companion-fighter-description-niveau-1">
                            Les actions de combat du chevalier contre un ennemi désigné aux compagnons reçoivent 1 dé supplémentaire par compagnon effectuant un support. La cible du chevalier doit être à portée courte et doit pouvoir être attaquée au contact. Si ces deux conditions sont respectées, la cible reçoit automatiquement l’effet barrage 1 par compagnon (3 compagnons supportant le chevalier infligent ainsi l’effet barrage 3). De plus, les compagnons infligent à la cible 1D6 points de dégâts ou de violence chacun (sans bonus) sans devoir effectuer de jet de dés pour toucher. On considère cependant que lorsqu’ils effectuent cette action de support, leur défense tombe à 0. Une seule cible à la fois peut subir cette action de support.
                        </span>
                        <span class="N2" data-i18n="druid-companion-fighter-description-niveau-2">
                            Les actions de combat du chevalier contre un ennemi désigné aux compagnons reçoivent 2 dés supplémentaire par compagnon effectuant un support. La cible du chevalier doit être à portée courte et doit pouvoir être attaquée au contact. Si ces deux conditions sont respectées, la cible reçoit automatiquement l’effet barrage 1 par compagnon (3 compagnons supportant le chevalier infligent ainsi l’effet barrage 3). De plus, les compagnons infligent à la cible 1D6 points de dégâts ou de violence chacun (sans bonus) sans devoir effectuer de jet de dés pour toucher. On considère cependant que lorsqu’ils effectuent cette action de support, leur défense tombe à 0. Une seule cible à la fois peut subir cette action de support.
                        </span>
                        <span class="N3" data-i18n="druid-companion-fighter-description-niveau-3">
                            Les actions de combat du chevalier contre un ennemi désigné aux compagnons reçoivent 3 dés supplémentaire par compagnon effectuant un support. La cible du chevalier doit être à portée courte et doit pouvoir être attaquée au contact. Si ces deux conditions sont respectées, la cible reçoit automatiquement l’effet barrage 1 par compagnon (3 compagnons supportant le chevalier infligent ainsi l’effet barrage 3). De plus, les compagnons infligent à la cible 1D6 points de dégâts ou de violence chacun (sans bonus) sans devoir effectuer de jet de dés pour toucher. On considère cependant que lorsqu’ils effectuent cette action de support, leur défense tombe à 0. Une seule cible à la fois peut subir cette action de support.
                        </span>
                    </div>
                    
                    <div class="companions cRecon mT">
                        <div class="tCompanions">
                            <h2 data-i18n="druid-companion-recon">Recon</h2>
                            <select name="attr_DWolfReconNiveau">
                                <option value="1" data-i18n="druid-companion-niveau-1" selected>Niveau 1</option>
                                <option value="2" data-i18n="druid-companion-niveau-2">Niveau 2</option>
                                <option value="3" data-i18n="druid-companion-niveau-3">Niveau 3</option>
                            </select>
                        </div>
        
                        <span class="N1" data-i18n="druid-companion-recon-description-niveau-1">
                            Toutes les actions d’observation, de vigilance ou de fouille menées par le chevalier reçoivent 1 dé supplémentaire par compagnon effectuant le support. Le chevalier peut observer, entendre, sentir et toucher directement depuis un des compagnons (au choix).
                        </span>
                        <span class="N2" data-i18n="druid-companion-recon-description-niveau-2">
                            Toutes les actions d’observation, de vigilance ou de fouille menées par le chevalier reçoivent 2 dés supplémentaire par compagnon effectuant le support. Le chevalier peut observer, entendre, sentir et toucher directement depuis un des compagnons (au choix).
                        </span>
                        <span class="N3" data-i18n="druid-companion-recon-description-niveau-3">
                            Toutes les actions d’observation, de vigilance ou de fouille menées par le chevalier reçoivent 3 dés supplémentaire par compagnon effectuant le support. Le chevalier peut observer, entendre, sentir et toucher directement depuis un des compagnons (au choix).
                        </span>
                    </div>
                </div>
            </div>
        
            <div class="fichePJ druid DCCrow marginTop">
                <input class="subMenu" type="hidden" name="attr_tabDruidCrow" value="0" />
        
                <h1 class="titre" data-i18n="druid-companion-crow">Crow</h1>
                <div class="col4">
                    <h1 class="titre" data-i18n="aspects">Aspects</h1>
                    <div class="ligne aspect">
                        <span data-i18n="chair">Chair</span>
        
                        <div class="blockR">
                            <input type="number" name="attr_druidCrowChairTot" value="@{druidCrowChairBase}+@{druidCrowChairEvol}" disabled />
                            <button class="rollDice" name="act_druidCrowChairRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-crow}}} {{special1=@{name}}}"></button>
                        </div>			
                    </div>
                    <div class="ligne aspect">
                        <span data-i18n="bete">Bête</span>
        
                        <div class="blockR">
                            <input type="number" name="attr_druidCrowBeteTot" value="@{druidCrowBeteBase}+@{druidCrowBeteEvol}" disabled />
                            <button class="rollDice" name="act_druidCrowBeteRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-crow}}} {{special1=@{name}}}"></button>		
                        </div>		
                    </div>
                    <div class="ligne aspect">
                        <span data-i18n="machine">Machine</span>
        
                        <div class="blockR">
                            <input type="number" name="attr_druidCrowMachineTot" value="@{druidCrowMachineBase}+@{druidCrowMachineEvol}" disabled />
                            <button class="rollDice" name="act_druidCrowMachineRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-crow}}} {{special1=@{name}}}"></button>
                        </div>
                    </div>
                    <div class="ligne aspect">
                        <span data-i18n="dame">Dame</span>
        
                        <div class="blockR">
                            <input type="number" name="attr_druidCrowDameTot" value="@{druidCrowDameBase}+@{druidCrowDameEvol}" disabled />
                            <button class="rollDice" name="act_druidCrowDameRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-crow}}} {{special1=@{name}}}"></button>
                        </div>
                    </div>
                    <div class="ligne aspect">
                        <span data-i18n="masque">Masque</span>
        
                        <div class="blockR">
                            <input type="number" name="attr_druidCrowMasqueTot" value="@{druidCrowMasqueBase}+@{druidCrowMasqueEvol}" disabled />
                            <button class="rollDice" name="act_druidCrowMasqueRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-crow}}} {{special1=@{name}}}"></button>
                        </div>
                    </div>
                </div>
        
                <div class="col4BL">
                    <h1 class="titre" data-i18n="valeurs-derivees">Valeurs Dérivées</h1>
                    
                    <div class="ligne defense">
                        <span data-i18n="defense">Défense</span>
                        
                        <div class="blockR">
                            <input type="number" name="attr_druidCrowDefenseTot" value="2" disabled />
                        </div>
                    </div>
                    <div class="ligne reaction">
                        <span data-i18n="reaction">Réaction</span>
        
                        <div class="blockR">
                            <input type="number" name="attr_druidCrowReactionTot" value="2" disabled />
                        </div>
                    </div>
                    <div class="ligne initiative">
                        <span data-i18n="initiative">Initiative</span>
        
                        <div class="blockR">
                            <input type="number" name="attr_druidCrowInitiativeTot" value="1" disabled />
                            <button class="rollDice" type="action" name="act_druidCrowInitiativeRoll" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-crow}}} {{special1=@{name}}}"></button>
                        </div>
                    </div>
                    <div class="ligne cohesion">
                        <span data-i18n="cohesion">Cohésion</span>
        
                        <div class="blockR">
                            <input type="number" name="attr_druidCrowCoAct" value="50" /> 
                            <b>/</b>
                            <input type="number" name="attr_druidCrowCoTot" value="50*@{druidNiveauCrow}" disabled />
                        </div>
                    </div>
                    <div class="ligne debordement">
                        <span data-i18n="debordement">Débordement</span>
        
                        <div class="blockR">
                            <input type="number" name="attr_druidCrowDebordementTot" value="2*@{druidNiveauCrow}" disabled />
                        </div>
                    </div>
                </div>
        
                <div class="col4BL">
                    <h1 class="titre" data-i18n="champ-de-force">Champ de Force</h1>
                    <div class="ligne CDF">
                        <input type="number" name="attr_druidCrowCDFTot" value="2*@{druidNiveauCrow}" disabled />
                    </div>
        
                    <h1 class="titre" data-i18n="debordement">Débordement</h1>
                    <div class="ligne tourCombat">
                        <span data-i18n="tours-de-combat">Tours de combat</span>
                        
                        <div class="blockR">
                            <input type="number" name="attr_druidCrowTAttaque" value="1" min="1" />
                            <button class="rollDice" type="action" name="act_druidCrowAttaque" value="@{jetGM} &{template:combat} {{Nom=^{druid-companion-crow}}} {{special1=@{name}}}"></button>
                        </div>
                    </div>
                </div>
        
                <h1 class="titre" data-i18n="specificites">Spécificités</h1>
                <span class="specificites" data-i18n="druid-companion-crow-specificite">La bande est équipée d'un module de vol niveau 3 constamment activé qui ne coûte aucune énergie.
                    <br/>
                    Les points de dégâts qui lui sont infligés lui font perdre de la cohésion.
                </span>
        
                <div class="subMenu">
                    <button class="evolutions" type="action" name="act_tabDruidCrow_3" data-i18n="evolutions">Evolutions</button>
                </div>
        
                <div class="evolutions">
                    <input type="hidden" name="attr_druidCrowChairBase" value="6" disabled />
                    <input type="hidden" name="attr_druidCrowBeteBase" value="4" disabled />
                    <input type="hidden" name="attr_druidCrowMachineBase" value="4" disabled />
                    <input type="hidden" name="attr_druidCrowDameBase" value="0" disabled />
                    <input type="hidden" name="attr_druidCrowMasqueBase" value="6" disabled />
        
                    <div class="aspects">
                        <div class="ligneTitre">
                            <span></span>
                            <span data-i18n="aspects">Aspects</span>
                        </div>
                        <label class="ligne1">
                            <span data-i18n="chair">Chair</span>
        
                            <div>
                                <input type="number" name="attr_druidCrowChairEvol" value="0" min="0" />
                            </div>
                        </label>
                        <label class="ligne1">
                            <span data-i18n="bete">Bête</span>
        
                            <div>
                                <input type="number" name="attr_druidCrowBeteEvol" value="0" min="0" />
                            </div>
                        </label>
                        <label class="ligne1">
                            <span data-i18n="machine">Machine</span>
        
                            <div>
                                <input type="number" name="attr_druidCrowMachineEvol" value="0" min="0" />
                            </div>
                        </label>
                        <label class="ligne1">
                            <span data-i18n="dame">Dame</span>
        
                            <div>
                                <input type="number" name="attr_druidCrowDameEvol" value="0" min="0" />
                            </div>
                        </label>
                        <label class="ligne1">
                            <span data-i18n="masque">Masque</span>
        
                            <div>
                                <input type="number" name="attr_druidCrowMasqueEvol" value="0" min="0" />
                            </div>
                        </label>
                    </div>
                </div>
            </div>

            <div class="fichePJ ranger rangerLongbow marginTop">
                <input class="styleCombat" type="hidden" name="attr_styleCombat" value="standard" />
                <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0" />
                <input class="PG50" type="hidden" name="attr_ranger50PG" value="0" />
                <input class="PG50_2" type="hidden" name="attr_ranger50PG2" value="0" />
                <input class="PG100" type="hidden" name="attr_ranger100PG" value="0" />
                <input class="subMenu" type="hidden" name="attr_armeDistOptionsRanger" value="0" />
        
                <div class="titre">
                    <button type="action" class="bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                    <button type="action" class="bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>
        
                    <h1 class="titre" data-i18n="ranger-fusil-longbow">Fusil Longbow</h1>
        
                    <button class="rollDice" type="action" name="act_distanceRangerLongbow" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=^{ranger-fusil-longbow}}}"></button>
                </div>
                <div class="col5 rangerDegats">
                    <span data-i18n="degats">Dégâts</span>
                    <select class="notPG50_2" name="attr_rangerArmeDegat">
                        <option value="3" selected>3D6</option>
                        <option value="4">4D6</option>
                        <option value="5">5D6</option>
                        <option value="6">6D6</option>
                        <option value="7">7D6</option>
                        <option value="8">8D6</option>
                        <option value="9">9D6</option>
                    </select>
                    <select class="PG50_2" name="attr_rangerArmeDegatEvol">
                        <option value="5" selected>5D6</option>
                        <option value="6">6D6</option>
                        <option value="7">7D6</option>
                        <option value="8">8D6</option>
                        <option value="9">9D6</option>
                        <option value="10">10D6</option>
                        <option value="11">11D6</option>
                        <option value="12">12D6</option>
                        <option value="13">13D6</option>
                        <option value="14">14D6</option>
                    </select>
                </div>
                <div class="col5BL rangerViolence">
                    <span class="titreBis" data-i18n="violence">Violence</span>
                    <select class="notPG50_2" name="attr_rangerArmeViolence">
                        <option value="1" selected>1D6</option>
                        <option value="2">2D6</option>
                        <option value="3">3D6</option>
                        <option value="4">4D6</option>
                        <option value="5">5D6</option>
                        <option value="6">6D6</option>
                        <option value="7">7D6</option>
                    </select>
                    <select class="PG50_2" name="attr_rangerArmeViolenceEvol">
                        <option value="3" selected>3D6</option>
                        <option value="4">4D6</option>
                        <option value="5">5D6</option>
                        <option value="6">6D6</option>
                        <option value="7">7D6</option>
                        <option value="8">8D6</option>
                        <option value="9">9D6</option>
                        <option value="10">10D6</option>
                        <option value="11">11D6</option>
                        <option value="12">12D6</option>
                    </select>
                </div>
                <div class="col5BL rangerPortee">
                    <span class="titreBis" data-i18n="portee">Portée</span>
                    <select name="attr_rangerArmePortee">
                        <option value="^{portee-moyenne}" data-i18n="portee-moyenne">Moyenne</option>
                        <option value="^{portee-longue}" data-i18n="portee-longue">Longue</option>
                        <option value="^{portee-lointaine}" data-i18n="portee-lointaine">Lointaine</option>
                    </select>
                </div>
                <div class="col5LargeBL rangerJet">            
                    <span data-i18n="jet">Jet</span>
                    <select name="attr_caracteristique1">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                    <select name="attr_caracteristique2">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                </div>        
                
                <div class="bonus">
                    <label class="pilonnage">
                        <span>Pilonnage, tir n°</span>
                        <input type="number" name="attr_pilonnageRanger" value="1" min="1" max="7" />
                    </label>
                    <div class="bonusCarac">
                        <select name="attr_caracteristique3">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <select name="attr_caracteristique4">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                    </div>
                </div>
                <div class="eCol3">
                    <h1 class="titre notPG100" data-i18n="ranger-effets-2PE">Effets à 2PE</h1>
                    <h1 class="titre PG100" data-i18n="ranger-effets-1PE">Effets à 1PE</h1>
        
                    <div class="rangerBEffet">
                        <div class="double">
                            <label class="fakeButton">
                                <input type="checkbox" name="attr_rangerChoc" value="{{choc=^{choc} @{rangerChocValue}}}" />
                                <span data-i18n-title="choc" title="Choc"></span>
                            </label>
                            
                            <input type="number" name="attr_rangerChocValue" class="center" value="1" disabled />
                        </div>
                        
                        <div class="double">
                            <label class="fakeButton">
                                <input type="checkbox" name="attr_rangerDegatContinue" value="{{degatContinus=^{degats-continus} @{rangerDegatContinueValue} ([[1D6]] ^{tours})}}" />
                                <span data-i18n-title="degats-continus" title="Dégâts Continus"></span>
                            </label>
                        
                            <input type="number" name="attr_rangerDegatContinueValue" class="center" value="3" disabled />
                        </div>
                        
                        <label class="simple fakeButton">
                            <input type="checkbox" name="attr_rangerDesignation" value="{{designation=Désignation}}" />
                            <span data-i18n-title="designation" title="Désignation"></span>
                        </label>
                        
                        <label class="simple fakeButton">
                            <input type="checkbox" name="attr_rangerSilencieux" value="{{silencieux=Silencieux}} {{silencieuxD=[[@{discretion}+@{discrOD}]]}}" />
                            <span data-i18n-title="silencieux" title="Silencieux"></span>
                        </label>
                        
                        <div class="double">
                            <label class="fakeButton">
                                <input type="checkbox" name="attr_rangerPerceArmure" value="{{perceArmure=^{perce-armure} @{rangerPerceArmureValue}}}" />
                                <span data-i18n-title="perce-armure" title="Perce Armure"></span>
                            </label>
                        
                            <input type="number" name="attr_rangerPerceArmureValue" value="40" disabled />
                        </div>
                        
                        <label class="simple fakeButton">
                            <input type="checkbox" name="attr_rangerUltraViolence" value="{{ultraviolence=[[2D6]]}}" />
                            <span data-i18n-title="ultraviolence" title="Ultraviolence"></span>
                        </label>    
                    </div> 
                </div>
                    
                <div class="eCol3BL">
                    <h1 class="titre notPG100" data-i18n="ranger-effets-3PE">Effets à 3PE</h1>
                    <h1 class="titre PG100" data-i18n="ranger-effets-1PE">Effets à 1PE</h1>
                    
                    <div class="rangerBEffet">
                        <label class="simple fakeButton">
                            <input type="checkbox" name="attr_rangerAntiVehicule" value="{{antiVehicule=Anti Véhicule}}" />
                            <span data-i18n-title="anti-vehicule" title="Anti Véhicule"></span>
                        </label>
                        
                        <label class="simple fakeButton">
                            <input type="checkbox" name="attr_rangerArtillerie" value="{{artillerie=Artillerie}}" />
                            <span data-i18n-title="artillerie" title="Artillerie"></span>
                        </label>
                        
                        <div class="double">
                            <label class="fakeButton">
                                <input type="checkbox" name="attr_rangerDispersion" value="{{dispersion=^{dispersion} @{rangerDispersionValue}}}"  />
                                <span data-i18n-title="dispersion" title="Dispersion"></span>
                            </label>
                        
                            <input type="number" name="attr_rangerDispersionValue" value="3" disabled />
                        </div>
                        
                        <div class="double">
                            <label class="fakeButton">
                                <input type="checkbox" name="attr_rangerLumiere" value="{{lumiere=^{lumiere} @{rangerLumiereValue}}}" />
                                <span data-i18n-title="lumiere" title="Lumière"></span>
                            </label>
                        
                            <input type="number" name="attr_rangerLumiereValue" value="4" disabled />
                        </div>
                        
                        <div class="double">
                            <label class="fakeButton">
                                <input type="checkbox" name="attr_rangerPenetrant" value="{{penetrant=^{penetrant} @{rangerPenetrantValue}}}" />
                                <span data-i18n-title="penetrant" title="Pénétrant"></span>
                            </label>
                        
                            <input type="number" name="attr_rangerPenetrantValue" value="6" disabled />
                        </div>
                        
                        <div class="double">
                            <label class="fakeButton">
                                <input type="checkbox" name="attr_rangerPerceArmure60" value="{{perceArmure=^{perce-armure} @{rangerPerceArmure60Value}}}" />
                                <span data-i18n-title="perce-armure" title="Perce Armure"></span>
                            </label>
                        
                            <input type="number" name="attr_rangerPerceArmure60Value" value="60" disabled />
                        </div>
                    </div>
                </div>
                    
                <div class="eCol3BL PG50">
                    <h1 class="titre notPG100" data-i18n="ranger-effets-6PE">Effets à 6PE</h1>
                    <h1 class="titre PG100" data-i18n="ranger-effets-4PE">Effets à 4PE</h1>
        
                    <div class="rangerBEffet">
                        <label class="simple fakeButton">
                            <input type="checkbox" name="attr_rangerAntiAnatheme" value="{{antiAnathème=Anti Anathème}}" />
                            <span data-i18n-title="anti-anatheme" title="Anti Anathème"></span>
                        </label>
                        
                        <label class="simple fakeButton">
                            <input type="checkbox" name="attr_rangerDemoralisant" value="{{demoralisant=Démoralisant}}" />
                            <span  data-i18n-title="demoralisant"title="Démoralisant"></span>
                        </label>
                        
                        <label class="simple fakeButton">
                            <input type="checkbox" name="attr_rangerEnChaine" value="{{enChaine=En Chaîne}}" />
                            <span data-i18n-title="en-chaine" title="En Chaîne"></span>
                        </label>
                        
                        <label class="simple fakeButton">
                            <input type="checkbox" name="attr_rangerFureur" value="{{fureur=[[4D6]]}}" />
                            <span data-i18n-title="fureur" title="Fureur"></span>
                        </label>
                        
                        <label class="simple fakeButton">
                            <input type="checkbox" name="attr_rangerIgnoreArmure" value="{{ignoreArmure=Ignore Armure}}" />
                            <span data-i18n-title="ignore-armure" title="Ignore Armure"></span>
                        </label>
                        
                        <div class="double">
                            <label class="fakeButton">
                                <input type="checkbox" name="attr_rangerPenetrant10" value="{{penetrant=^{penetrant} @{rangerPenetrant10Value}}}" />
                                <span data-i18n-title="penetrant" title="Pénétrant"></span>
                            </label>
                        
                            <input type="number" name="attr_rangerPenetrant10Value" value="10" disabled />
                        </div>
                    </div>
                </div>
                <div class="subMenu">
                    <button class="ameliorationsArmes" type="action" name="act_armeDistOptionsRanger-1" data-i18n="ameliorations-d'armes">Améliorations d'armes</button>
                    <button class="special BL" type="action" name="act_armeDistOptionsRanger-2" data-i18n="special">Spécial</button>
                </div>
                
                <div class="ameliorationsArmes">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_chargeurGrappesRanger" value="1" />
                        <span data-i18n-title="balles-grappes" title="Balles grappes"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_canonLongRanger" value="{{canonLongM=1}} {{canonLongC=Canon Long (Portée Courte : +3 Difficulté)}}" />
                        <span data-i18n-title="canon-long" title="Canon Long"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_canonRaccourciRanger" value="{{canonRaccourci=Canon Raccourci (Portée Courte : Dispersion 3 / Sinon : +3 Difficulté)}}" />
                        <span data-i18n-title="canon-raccourci" title="Canon Raccourci"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_chambreDoubleRanger" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                        <span data-i18n-title="chambre-double" title="Chambre Double"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_interfaceGuidageRanger" value="3" />
                        <span data-i18n-title="interface-guidage" title="Interface de guidage"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_lunetteIntelligenteRanger" value="{{lunetteIntelligente=Lunette Intelligente (+1 Portée)}}" />
                        <span data-i18n-title="lunette-intelligente" title="Lunette Intelligente"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsDroneRanger" value="{{munitionsDrone=3}}" />
                        <span data-i18n-title="munitions-drones" title="Munitions Drones"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_chargeurExplosivesRanger" value="1" />
                        <span data-i18n-title="munitions-explosives" title="Munitions Explosives"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsIEMRanger" value="1" />
                        <span data-i18n-title="munitions-iem" title="Munitions IEM"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsNonLetalesRanger" value="2" />
                        <span data-i18n-title="munitions-n-letales" title="Munitions N. Létales"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsSubsoniquesRanger" value="{{munitionsSubsoniques=Munitions Subsoniques (Silencieux)}} {{silencieuxD=[[@{discretion}+@{discrOD}]]}}" />
                        <span data-i18n-title="munitions-subsoniques" title="Munitions Subsoniques"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pointeurLaserRanger" value="{{pointeurLaser=1}}" />
                        <span data-i18n-title="pointeur-laser" title="Pointeur Laser"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_protectionArmeRanger" value="{{protectionArme=Protection d'Arme (Reaction +2)}}" />
                        <span data-i18n-title="protection-d'arme" title="Protection d'Arme"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_revetementOmegaRanger" value="2" />
                        <span data-i18n-title="revetement-omega" title="Revêtement Omega"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_structureElementRanger" value="{{structureElement=Structure Alpha}}" />
                        <span data-i18n-title="structure-alpha" title="Structure Alpha"></span>
                    </label>
                </div>
        
                <div class="special">
                    <div class="triple">
                        <input type="hidden" name="attr_bDDiversTotalRanger" value="0" />
        
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_bDDiversTotalRanger" value="{{BDDivers=[[@{bDDiversD6}D6+@{bDDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-degats" title="Bonus aux dégâts"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_bDDiversD6" class="center" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_bDDiversFixe" class="center" value="0" />
                        </div>
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_bVDiversTotalRanger" value="0" />
        
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_bVDiversTotalRanger" value="{{BVDivers=[[@{bVDiversD6}D6+@{bVDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-violence" title="Bonus à la violence"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_bVDiversD6" class="center" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_bVDiversFixe" class="center" value="0" />
                        </div>
                    </div>
                </div>
            </div>

            <div class="MAL marginTop">
                <h1 class="titre" data-i18n="meta-armure-legende">Méta-armure de légende</h1>

                <div class="col">
                    <div class="MALBarbarian barbarianGoliath">
                        <h1 class="titre" data-i18n="barbarian-mode-goliath">Mode Goliath</h1>
                        <label class="ligne">
                            <span data-i18n="taille-bonus">Taille Bonus</span>
                            <input type="number" name="attr_MALBarbarianGoliath" min="0" max="4" value="0" />
                        </label>
        
                        <h1 class="titre" data-i18n="malus">Malus</h1>
                        <label class="col">
                            <span data-i18n="defense">Défense</span>
                            <input type="text" name="attr_MALBarbarianDef" readonly />
                        </label>
                        <label class="colBL">
                            <span data-i18n="reaction">Réaction</span>
                            <input type="text" name="attr_MALBarbarianRea" readonly />
                        </label>
                    </div>

                    <div class="MALBard bardChangeling">
                        <input class="active" type="hidden" name="attr_MALBardChangeling" value=""/>
                        <div class="titre firstTitre">               
                            <h1 class="titre" data-i18n="mode-changeling">Mode Changeling</h1>
                            <button class="active" type="action" name="act_MALBardChangeling" data-i18n="activer">Activer</button>
                        </div>
                        <h1 class="titre" data-i18n="bard-apparence">Apparence</h1>
                        <div class="autoex autoex28">
                            <span name="attr_MALApparenceBard"></span>
                            <textarea name="attr_MALApparenceBard"></textarea>
                        </div>
                    </div>

                    <div class="MALDruid information">
                        <h1 class="titre" data-i18n="panneau-d'information">Panneau d'Information</h1>
                        <div class="autoex autoex28">	
                            <span name="attr_panneauInformation"></span>
                            <textarea name="attr_panneauInformation" readonly ></textarea>
                        </div>
                    </div>

                    <div class="MALPaladin paladinShrine">
                        <input class="active" type="hidden" name="attr_MALPaladinCdFShrine" />
        
                        <div class="titre">
                            <h1 class="titre" data-i18n="paladin-champ-de-force-shrine">Champ de Force Shrine</h1>
        
                            <button class="active" type="action" name="act_MALPaladinCdFShrine" data-i18n="activer">Activer</button>
                        </div>
                        <label class="col3">
                            <span data-i18n="bonus-cdf">Bonus de CdF</span>
                            <input type="number" name="attr_MALPaladinCdFShrineValue" value="6" disabled />
                        </label>
                        <label class="col3BL">
                            <span data-i18n="force-requise">Force Requise</span>
                            <input type="number" name="attr_MALPaladinCdFShrineForceValue" value="5" disabled />
                        </label>
                        <label class="col3BL">
                            <span data-i18n="chair-requise">Chair Requise</span>
                            <input type="number" name="attr_MALPaladinCdFShrineChairValue" value="10" disabled />
                        </label>
                    </div>

                    <div class="MALPriest">
                        <input class="legendeChoisie" type="hidden" name="attr_malpriestmode" value="0" />
                        
                        <div class="priestMechanic">
                            <h1 class="titre" data-i18n="priest-mode-mechanic">Mode Mechanic</h1>
                            <div>
                                <span data-i18n="portee-contact">Contact</span>
                                <input type="text" name="attr_MALPriestMechanicContact" value="4D6+12" readonly />
                                <button class="rollDice" type="action" name="act_rollMALPriestJetMechanicContact" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{priest-mode-mechanic-contact}}} {{jDivers=^{reparation}}} {{jDiversV=[[@{MALPriestMechanicContact}]]}}"></button>
                            </div>
                            <div>
                                <span data-i18n="distance-portee-longue">Distance (Portée Longue)</span>
                                <input type="text" name="attr_MALPriestMechanicDistance" value="3D6+12" readonly />
                                <button class="rollDice" type="action" name="act_rollMALPriestJetMechanicDistance" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{priest-mode-mechanic-distance}}} {{jDivers=^{reparation}}} {{jDiversV=[[@{MALPriestMechanicDistance}]]}}"></button>
                            </div>
                        </div>
                        
                        <div class="priestNanoC">
                            <input type="hidden" name="attr_bonusCarac" class="bonusCarac" value="0" />
                            
                            <div class="titre">
                                <button type="action" class="fichePJ bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                                <button type="action" class="fichePJ bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>
                                
                                <h1 class="titre" data-i18n="priest-mode-nanoc">Mode NanoC</h1>
                                <button class="rollDice" type="action" name="act_simplePriest" value="@{jetGM} &{template:simple} {{Nom=@{name}}}"></button>
                            </div>
                            <label class="ligne2">
                                <span>Bonus/Malus aux Jets</span>
                                <input type="number" name="attr_MALJetModifDes" value="0" />
                            </label>
                            <div class="rollPJ">
                                <select name="attr_caracteristique1Priest">
                                    <option value="@{technique}" selected>Technique</option>
                                </select>
                                <select name="attr_caracteristique2">
                                    <option value="0" selected></option>
                                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                    <option value="@{force}" data-i18n="force">Force</option>
                                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                    <option value="@{combat}" data-i18n="combat">Combat</option>
                                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                    <option value="@{tir}" data-i18n="tir">Tir</option>
                                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                    <option value="@{technique}" data-i18n="technique">Technique</option>
                                    <option value="@{aura}" data-i18n="aura">Aura</option>
                                    <option value="@{parole}" data-i18n="parole">Parole</option>
                                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                    <option value="@{perception}" data-i18n="perception">Perception</option>
                                </select>
                            </div>
                            <input type="hidden" name="attr_bonusCarac" value="0" />
                            <div class="bonusCarac">
                                <select name="attr_MALCaracteristique3">
                                    <option value="0" selected></option>
                                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                    <option value="@{force}" data-i18n="force">Force</option>
                                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                    <option value="@{combat}" data-i18n="combat">Combat</option>
                                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                    <option value="@{tir}" data-i18n="tir">Tir</option>
                                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                    <option value="@{technique}" data-i18n="technique">Technique</option>
                                    <option value="@{aura}" data-i18n="aura">Aura</option>
                                    <option value="@{parole}" data-i18n="parole">Parole</option>
                                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                    <option value="@{perception}" data-i18n="perception">Perception</option>
                                </select>
                                <select name="attr_MALCaracteristique4">
                                    <option value="0" selected></option>
                                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                    <option value="@{force}" data-i18n="force">Force</option>
                                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                    <option value="@{combat}" data-i18n="combat">Combat</option>
                                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                    <option value="@{tir}" data-i18n="tir">Tir</option>
                                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                    <option value="@{technique}" data-i18n="technique">Technique</option>
                                    <option value="@{aura}" data-i18n="aura">Aura</option>
                                    <option value="@{parole}" data-i18n="parole">Parole</option>
                                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                    <option value="@{perception}" data-i18n="perception">Perception</option>
                                </select>
                            </div>
                            <h1 class="titre" data-i18n="priest-creations">Créations</h1>
                            <div class="autoex autoex28">
                                <span name="attr_MALPriestNanoc"></span>
                                <textarea name="attr_MALPriestNanoc" class="largeTextarea"></textarea>
                            </div>
                        </div>
                    </div>

                    <div class="MALPsion">
                        <input class="legendeChoisie" type="hidden" name="attr_malpsionmode" value="0" />
        
                        <div class="psionPuppetMaster">
                            <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0" />
        
                            <div class="titre">
                                <button type="action" class="fichePJ bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                                <button type="action" class="fichePJ bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>
                                
                                <h1 class="titre" data-i18n="mode-puppet-master">Mode Puppet Master</h1>
                                <button class="rollDice" type="action" name="act_simplePsionPuppet" value="@{jetGM} &{template:simple} {{Nom=@{name}}}"></button>
                            </div>
                            <div class="rollPJ">
                                <select name="attr_caracteristique1Psion">
                                    <option value="@{aura}" data-i18n="aura" selected>Aura</option>
                                </select>
                                <select name="attr_caracteristique2">
                                    <option value="0" selected></option>
                                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                    <option value="@{force}" data-i18n="force">Force</option>
                                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                    <option value="@{combat}" data-i18n="combat">Combat</option>
                                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                    <option value="@{tir}" data-i18n="tir">Tir</option>
                                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                    <option value="@{technique}" data-i18n="technique">Technique</option>
                                    <option value="@{aura}" data-i18n="aura">Aura</option>
                                    <option value="@{parole}" data-i18n="parole">Parole</option>
                                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                    <option value="@{perception}" data-i18n="perception">Perception</option>
                                </select>
                            </div>
                            <div class="bonusCarac">
                                <select name="attr_caracteristique3">
                                    <option value="0" selected></option>
                                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                    <option value="@{force}" data-i18n="force">Force</option>
                                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                    <option value="@{combat}" data-i18n="combat">Combat</option>
                                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                    <option value="@{tir}" data-i18n="tir">Tir</option>
                                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                    <option value="@{technique}" data-i18n="technique">Technique</option>
                                    <option value="@{aura}" data-i18n="aura">Aura</option>
                                    <option value="@{parole}" data-i18n="parole">Parole</option>
                                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                    <option value="@{perception}" data-i18n="perception">Perception</option>
                                </select>
                                <select name="attr_caracteristique4">
                                    <option value="0" selected></option>
                                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                    <option value="@{force}" data-i18n="force">Force</option>
                                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                    <option value="@{combat}" data-i18n="combat">Combat</option>
                                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                    <option value="@{tir}" data-i18n="tir">Tir</option>
                                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                    <option value="@{technique}" data-i18n="technique">Technique</option>
                                    <option value="@{aura}" data-i18n="aura">Aura</option>
                                    <option value="@{parole}" data-i18n="parole">Parole</option>
                                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                    <option value="@{perception}" data-i18n="perception">Perception</option>
                                </select>
                            </div>
                            <h1 class="titre" data-i18n="ordre-donne">Ordre Donné</h1>
                            <div class="autoex autoex28">
                                <span name="attr_psionPuppetOrdre"></span>
                                <textarea name="attr_psionPuppetOrdre"></textarea>
                            </div>
                        </div>
                        <div class="psionDiscord">
                            <input class="active" type="hidden" name="attr_MALPsionDiscord" />
                            <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0" />
        
                            <div class="titre">
                                <button type="action" class="fichePJ bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                                <button type="action" class="fichePJ bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>
        
                                <h1 class="titre" data-i18n="psion-mode-discord">Mode Discord</h1>
        
                                <button class="active" type="action" name="act_MALPsionDiscord" data-i18n="activer">Activer</button>
                            </div>
                            <label class="ligne2">
                                <span data-i18n="bonus/malus-jets">Bonus/Malus aux Jets</span>
                                <input type="number" name="attr_jetModifDes" value="0" />
                            </label>
                            <div class="rollPJ">
                                <select name="attr_caracteristique1Psion">
                                    <option value="@{aura}" data-i18n="aura" selected>Aura</option>
                                </select>
                                <select name="attr_caracteristique2">
                                    <option value="0" selected></option>
                                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                    <option value="@{force}" data-i18n="force">Force</option>
                                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                    <option value="@{combat}" data-i18n="combat">Combat</option>
                                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                    <option value="@{tir}" data-i18n="tir">Tir</option>
                                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                    <option value="@{technique}" data-i18n="technique">Technique</option>
                                    <option value="@{aura}" data-i18n="aura">Aura</option>
                                    <option value="@{parole}" data-i18n="parole">Parole</option>
                                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                    <option value="@{perception}" data-i18n="perception">Perception</option>
                                </select>
                                <button class="rollDice" type="action" name="act_simplePsionDiscord" value="@{jetGM} &{template:simple} {{Nom=@{name}}}"></button>
                            </div>
        
                            <div class="bonusCarac">
                                <select name="attr_caracteristique3">
                                    <option value="0" selected></option>
                                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                    <option value="@{force}" data-i18n="force">Force</option>
                                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                    <option value="@{combat}" data-i18n="combat">Combat</option>
                                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                    <option value="@{tir}" data-i18n="tir">Tir</option>
                                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                    <option value="@{technique}" data-i18n="technique">Technique</option>
                                    <option value="@{aura}" data-i18n="aura">Aura</option>
                                    <option value="@{parole}" data-i18n="parole">Parole</option>
                                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                    <option value="@{perception}" data-i18n="perception">Perception</option>
                                </select>
                                <select name="attr_caracteristique4">
                                    <option value="0" selected></option>
                                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                    <option value="@{force}" data-i18n="force">Force</option>
                                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                    <option value="@{combat}" data-i18n="combat">Combat</option>
                                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                    <option value="@{tir}" data-i18n="tir">Tir</option>
                                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                    <option value="@{technique}" data-i18n="technique">Technique</option>
                                    <option value="@{aura}" data-i18n="aura">Aura</option>
                                    <option value="@{parole}" data-i18n="parole">Parole</option>
                                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                    <option value="@{perception}" data-i18n="perception">Perception</option>
                                </select>
                            </div>
                            <label class="col3">
                                <span data-i18n="malus-action">Malus Actions</span>
                                <input type="text" name="attr_psionMalusA" value="2D" readonly />
                            </label>
                            <label class="col3BL">
                                <span data-i18n="malus-reaction">Malus Réaction</span>
                                <input type="text" name="attr_psionMalus" value="2" readonly />
                            </label>
                            <label class="col3BL">
                                <span data-i18n="malus-defense">Malus Défense</span>
                                <input type="text" name="attr_psionMalus" value="2" readonly />
                            </label>
                        </div>
                        <div class="psionWindtalker">
                            <h1 class="titre" data-i18n="psion-mode-windtalker">Mode Windtalker</h1>
                            <h2 class="titreBis" data-i18n="actions-creatures">Actions des Créatures</h2>
                            <div class="autoex autoex28">
                                <span name="attr_psionWindtalkerActions"></span>
                                <textarea name="attr_psionWindtalkerActions"></textarea>
                            </div>
                        </div>
                    </div>

                    <div class="MALRanger rangerVision">
                        <input type="hidden" name="attr_bonusCarac" class="bonusCarac" value="0" />
        
                        <div class="titre">
                            <button type="action" class="fichePJ bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                            <button type="action" class="fichePJ bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>
        
                            <h1 class="titre" data-i18n="ranger-vision">Vision</h1>
                            <button class="rollDice" type="action" name="act_simpleRangerVision" value="@{jetGM} &{template:simple} {{Nom=@{name}}}"></button>
                        </div>
                        <div class="rollPJ">
                            <select name="attr_caracteristique1Ranger">
                                <option value="@{perception}"  data-i18n="perception" selected>Perception</option>
                            </select>
                            <select name="attr_caracteristique2">
                                <option value="0" selected></option>
                                <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                <option value="@{force}" data-i18n="force">Force</option>
                                <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                <option value="@{combat}" data-i18n="combat">Combat</option>
                                <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                <option value="@{tir}" data-i18n="tir">Tir</option>
                                <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                <option value="@{technique}" data-i18n="technique">Technique</option>
                                <option value="@{aura}" data-i18n="aura">Aura</option>
                                <option value="@{parole}" data-i18n="parole">Parole</option>
                                <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                <option value="@{perception}" data-i18n="perception">Perception</option>
                            </select>
                        </div>
                        <div class="bonusCarac">
                            <select name="attr_caracteristique3Monk">
                                <option value="0" selected></option>
                                <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                <option value="@{force}" data-i18n="force">Force</option>
                                <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                <option value="@{combat}" data-i18n="combat">Combat</option>
                                <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                <option value="@{tir}" data-i18n="tir">Tir</option>
                                <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                <option value="@{technique}" data-i18n="technique">Technique</option>
                                <option value="@{aura}" data-i18n="aura">Aura</option>
                                <option value="@{parole}" data-i18n="parole">Parole</option>
                                <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                <option value="@{perception}" data-i18n="perception">Perception</option>
                            </select>
                            <select name="attr_caracteristique4Monk">
                                <option value="0" selected></option>
                                <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                <option value="@{force}" data-i18n="force">Force</option>
                                <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                <option value="@{combat}" data-i18n="combat">Combat</option>
                                <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                <option value="@{tir}" data-i18n="tir">Tir</option>
                                <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                <option value="@{technique}" data-i18n="technique">Technique</option>
                                <option value="@{aura}" data-i18n="aura">Aura</option>
                                <option value="@{parole}" data-i18n="parole">Parole</option>
                                <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                <option value="@{perception}" data-i18n="perception">Perception</option>
                            </select>
                        </div>
                    </div>

                    <div class="MALShaman">
                        <div class="shamanImpregnation">
                            <input type="hidden" name="attr_bonusCarac" class="bonusCarac" value="0" />
        
                            <div class="titre">
                                <button type="action" class="fichePJ bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                                <button type="action" class="fichePJ bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>
        
                                <h1 class="titre" data-i18n="shaman-impregnation">Imprégnation</h1>
                                <button class="rollDice" type="roll" name="act_simpleMALShamanImpregnation" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{shaman-impregnation} (@{MALShamanImpregnation})}}"></button>
                            </div>
                            <label class="ligne2">
                                <span data-i18n="total-actuel">Total actuel</span>
                                <input type="number" name="attr_MALShamanImpregnation" value="0" min="0" />
                            </label>
                            <div class="rollPJ">
                                <select name="attr_caracteristique1MALShamanImpregnation">
                                    <option value="0" selected></option>
                                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                </select>
                                <select name="attr_caracteristique2MALShamanImpregnation">
                                    <option value="0" selected></option>
                                    <option value="@{technique}" data-i18n="technique">Technique</option>
                                </select>
                            </div>
                            <div class="bonusCarac">
                                <select name="attr_caracteristique3">
                                    <option value="0" selected></option>
                                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                    <option value="@{force}" data-i18n="force">Force</option>
                                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                    <option value="@{combat}" data-i18n="combat">Combat</option>
                                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                    <option value="@{tir}" data-i18n="tir">Tir</option>
                                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                    <option value="@{technique}" data-i18n="technique">Technique</option>
                                    <option value="@{aura}" data-i18n="aura">Aura</option>
                                    <option value="@{parole}" data-i18n="parole">Parole</option>
                                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                    <option value="@{perception}" data-i18n="perception">Perception</option>
                                </select>
                                <select name="attr_caracteristique4">
                                    <option value="0" selected></option>
                                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                    <option value="@{force}" data-i18n="force">Force</option>
                                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                    <option value="@{combat}" data-i18n="combat">Combat</option>
                                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                    <option value="@{tir}" data-i18n="tir">Tir</option>
                                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                    <option value="@{technique}" data-i18n="technique">Technique</option>
                                    <option value="@{aura}" data-i18n="aura">Aura</option>
                                    <option value="@{parole}" data-i18n="parole">Parole</option>
                                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                    <option value="@{perception}" data-i18n="perception">Perception</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="MALRogue rogueGhost">
                        <input type="hidden" name="attr_bonusCarac" class="bonusCarac" value="0" />
                        <input class="active" type="hidden" name="attr_MALRogueGhost" value=""/>
        
                        <div class="titre">
                            <button type="action" class="fichePJ bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                            <button type="action" class="fichePJ bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>
                            
                            <h1 class="titre" data-i18n="mode-ghost">Mode Ghost</h1>
        
                            <button class="active" type="action" name="act_MALRogueGhost" data-i18n="activer">Activer</button>
                        </div>
                        <label class="ligne2">
                            <span data-i18n="bonus/malus-jets">Bonus/Malus aux Jets</span>
                            <input type="number" name="attr_jetModifDes" value="0" />
                        </label>
                        <div class="rollPJ">
                            <select name="attr_caracteristique1">
                                <option value="0" selected></option>
                                <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                <option value="@{force}" data-i18n="force">Force</option>
                                <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                <option value="@{combat}" data-i18n="combat">Combat</option>
                                <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                <option value="@{tir}" data-i18n="tir">Tir</option>
                                <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                <option value="@{technique}" data-i18n="technique">Technique</option>
                                <option value="@{aura}" data-i18n="aura">Aura</option>
                                <option value="@{parole}" data-i18n="parole">Parole</option>
                                <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                <option value="@{perception}" data-i18n="perception">Perception</option>
                            </select>
                            <select name="attr_caracteristique2">
                                <option value="0" selected></option>
                                <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                <option value="@{force}" data-i18n="force">Force</option>
                                <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                <option value="@{combat}" data-i18n="combat">Combat</option>
                                <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                <option value="@{tir}" data-i18n="tir">Tir</option>
                                <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                <option value="@{technique}" data-i18n="technique">Technique</option>
                                <option value="@{aura}" data-i18n="aura">Aura</option>
                                <option value="@{parole}" data-i18n="parole">Parole</option>
                                <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                <option value="@{perception}" data-i18n="perception">Perception</option>
                            </select>
                            <button class="rollDice" type="action" name="act_simpleRogue" value="@{jetGM} &{template:simple} {{Nom=@{name}}}"></button>
                        </div>
                        <div class="bonusCarac">
                            <select name="attr_caracteristique3Rogue">
                                <option value="0" selected></option>
                                <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                <option value="@{force}" data-i18n="force">Force</option>
                                <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                <option value="@{combat}" data-i18n="combat">Combat</option>
                                <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                <option value="@{tir}" data-i18n="tir">Tir</option>
                                <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                <option value="@{technique}" data-i18n="technique">Technique</option>
                                <option value="@{aura}" data-i18n="aura">Aura</option>
                                <option value="@{parole}" data-i18n="parole">Parole</option>
                                <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                <option value="@{perception}" data-i18n="perception">Perception</option>
                            </select>
                            <select name="attr_caracteristique4Rogue">
                                <option value="0" selected></option>
                                <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                <option value="@{force}" data-i18n="force">Force</option>
                                <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                <option value="@{combat}" data-i18n="combat">Combat</option>
                                <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                <option value="@{tir}" data-i18n="tir">Tir</option>
                                <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                <option value="@{technique}" data-i18n="technique">Technique</option>
                                <option value="@{aura}" data-i18n="aura">Aura</option>
                                <option value="@{parole}" data-i18n="parole">Parole</option>
                                <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                <option value="@{perception}" data-i18n="perception">Perception</option>
                            </select>
                        </div>
                    </div>

                    <div class="MALWarlock">
                        <input class="legendeChoisie" type="hidden" name="attr_malwarlockmode" value="0" />
        
                        <div class="warlockContrecoups">
                            <div class="titre">
                                <h1 class="titre" data-i18n="warlock-contrecoups">Contrecoups</h1>
        
                                <button class="rollDice" type="action" name="act_rollMALWarlockContrecoups" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{warlock-contrecoups}}}"></button>
                            </div>
                        </div>
                    </div>

                    <div class="MALWarmaster">
                        <input class="legendeChoisie" type="hidden" name="attr_malwarmastermode" value="0" />
                    
                        <div class="warmasterWarlord">
                            <input class="warlordChoisie" type="hidden" name="attr_malwarmasterwarlord" value="0" />
                            
                            <div class="action titre">
                                <input class="active" type="hidden" name="attr_MALWarmasterImpAction" />
        
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_MALWarmasterImpAPersonnel" value="on" />
                                    <span data-i18n-title="personnel" title="Personnel"></span>
                                </label>
        
                                <h1 class="titre" data-i18n="warlord-impulsion-d'action">Impulsion d'Action</h1>
        
                                <button class="active" type="action" name="act_MALWarmasterImpAction" data-i18n="activer">Activer</button>
                            </div>
                        </div>
                        
                        <div class="warmasterFalcon">
                            <h1 class="titre" data-i18n="mode-falcon">Mode Falcon</h1>
                            <h2 class="titreBis" data-i18n="mode-falcon-faiblesses-detectees">Faiblesses détectées</h2>
                            <div class="autoex autoex28">
                                <span name="attr_MALWarmasterModeFalcon"></span>
                                <textarea name="attr_MALWarmasterModeFalcon" class="largeTextarea"></textarea>
                            </div>
                        </div>
                    </div>

                    <div class="MALWarrior warriorTypes">
                        <input type="hidden" name="attr_MALWarriorSoldierBonus" value="1"/>
                        <input type="hidden" name="attr_MALWarriorHunterBonus" value="1" />
                        <input type="hidden" name="attr_MALWarriorScholarBonus" value="1" />
                        <input type="hidden" name="attr_MALWarriorHeraldBonus" value="1" />
                        <input type="hidden" name="attr_MALWarriorScoutBonus" value="1" />
        
                        <input class="legendeChoisie" type="hidden" name="attr_malwarriortype" value="0" />
                        
                        <div class="soldier titre">
                            <h1 class="titre" data-i18n="warrior-type-soldier">Soldier</h1>
        
                            <label class="fakeButton">
                                <input type="checkbox" name="attr_MALWarriorSoldierA" value="@{MALWarriorSoldierBonus}" />
                                <span data-i18n-title="active" title="Activé"></span>
                            </label>
                        </div>
                        <label class="soldier col3">
                            <span data-i18n="deplacement">Déplacement</span>
                            <input type="number" name="attr_MALWarriorSoldierBD" value="@{MALWarriorSoldierBonus}" disabled />
                        </label>
                        <label class="soldier col3BL">
                            <span data-i18n="force">Force</span>
                            <input type="number" name="attr_MALWarriorSoldierBF" value="@{MALWarriorSoldierBonus}" disabled />
                        </label>
                        <label class="soldier col3BL">
                            <span data-i18n="endurance">Endurance</span>
                            <input type="number" name="attr_MALWarriorSoldierBE" value="@{MALWarriorSoldierBonus}" disabled />
                        </label>
        
                        <div class="hunter titre">
                            <h1 class="titre" data-i18n="warrior-type-hunter">Hunter</h1>
        
                            <label class="fakeButton">
                                <input type="checkbox" name="attr_MALWarriorHunterA" value="@{MALWarriorHunterBonus}" />
                                <span data-i18n-title="active" title="Activé"></span>
                            </label>
                        </div>
                        <label class="hunter col3">
                            <span data-i18n="hargne">Hargne</span>
                            <input type="number" name="attr_MALWarriorHunterBH" value="@{MALWarriorHunterBonus}" disabled />
                        </label>
                        <label class="hunter col3BL">
                            <span data-i18n="combat">Combat</span>
                            <input type="number" name="attr_MALWarriorHunterBC" value="@{MALWarriorHunterBonus}" disabled />
                        </label>
                        <label class="hunter col3BL">
                            <span data-i18n="instinct">Instinct</span>
                            <input type="number" name="attr_MALWarriorHunterBI" value="@{MALWarriorHunterBonus}" disabled />
                        </label>
        
                        <div class="scholar titre">
                            <h1 class="titre" data-i18n="warrior-type-scholar">Scholar</h1>
        
                            <label class="fakeButton">
                                <input type="checkbox" name="attr_MALWarriorScholarA" value="@{MALWarriorScholarBonus}" />
                                <span data-i18n-title="active" title="Activé"></span>
                            </label>
                        </div>
                        <label class="scholar col3">
                            <span data-i18n="tir">Tir</span>
                            <input type="number" name="attr_MALWarriorScholarBT" value="@{MALWarriorScholarBonus}" disabled />
                        </label>
                        <label class="scholar col3BL">
                            <span data-i18n="savoir">Savoir</span>
                            <input type="number" name="attr_MALWarriorScholarBS" value="@{MALWarriorScholarBonus}" disabled />
                        </label>
                        <label class="scholar col3BL">
                            <span data-i18n="technique">Technique</span>
                            <input type="number" name="attr_MALWarriorScholarBTech" value="@{MALWarriorScholarBonus}" disabled />
                        </label>
        
                        <div class="herald titre">
                            <h1 class="titre" data-i18n="warrior-type-herald">Herald</h1>
        
                            <label class="fakeButton">
                                <input type="checkbox" name="attr_MALWarriorHeraldA" value="@{MALWarriorHeraldBonus}" />
                                <span  data-i18n-title="active" title="Activé"></span>
                            </label>
                        </div>
                        <label class="herald col3">
                            <span data-i18n="aura">Aura</span>
                            <input type="number" name="attr_MALWarriorHeraldBA" value="@{MALWarriorHeraldBonus}" disabled />
                        </label>
                        <label class="herald col3BL">
                            <span data-i18n="parole">Parole</span>
                            <input type="number" name="attr_MALWarriorHeraldBP" value="@{MALWarriorHeraldBonus}" disabled />
                        </label>
                        <label class="herald col3BL">
                            <span data-i18n="sang-froid">Sang-Froid</span>
                            <input type="number" name="attr_MALWarriorHeraldBSF" value="@{MALWarriorHeraldBonus}" disabled />
                        </label>
        
                        <div class="scout titre">
                            <h1 class="titre" data-i18n="warrior-type-scout">Scout</h1>
        
                            <label class="fakeButton">
                                <input type="checkbox" name="attr_MALWarriorScoutA" value="@{MALWarriorScoutBonus}" />
                                <span data-i18n-title="active" title="Activé"></span>
                            </label>
                        </div>
                        <label class="scout col3">
                            <span data-i18n="discretion">Discrétion</span>
                            <input type="number" name="attr_MALWarriorScoutBD" value="@{MALWarriorScoutBonus}" disabled />
                        </label>
                        <label class="scout col3BL">
                            <span data-i18n="dexterite">Dextérité</span>
                            <input type="number" name="attr_MALWarriorScoutBDext" value="@{MALWarriorScoutBonus}" disabled />
                        </label>
                        <label class="scout col3BL">
                            <span data-i18n="perception">Perception</span>
                            <input type="number" name="attr_MALWarriorScoutBP" value="@{MALWarriorScoutBonus}" disabled />
                        </label>
                    </div>

                    <div class="MALWizard wizardOriflamme">
                        <div class="titre">
                            <h1 class="titre" data-i18n="wizard-mode-oriflamme">Mode Oriflamme</h1>
                            <button class="rollDice" type="action" name="act_distanceMALWizardOriflamme" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=^{wizard-mode-oriflamme}}}"></button>
                        </div>
                        <label class="col3">
                            <span data-i18n="degats">Dégâts</span>
                            <input type="text" name="attr_MALWizardODmg" value="6D6+6" readonly />
                        </label>
                        <label class="col3BL">
                            <span data-i18n="violence">Violence</span>
                            <input type="text" name="attr_MALWizardOViolence" value="6D6+12" readonly />
                        </label>
                        <label class="col3BL">
                            <span data-i18n="portee">Portée</span>
                            <input type="text" name="attr_MALWizardOPortee" value="Moyenne" readonly />
                        </label>
                        <div class="autoex autoex22">
                            <textarea name="attr_MALWizardOEffets" readonly>Anti-Anathème / Lumière 2 / Affecte uniquement les créatures de l'Anathème</textarea>
                            <span name="attr_MALWizardOEffets">Anti-Anathème / Lumière 2 / Affecte uniquement les créatures de l'Anathème</span>
                        </div>
                    </div>
                </div>

                <div class="col">
                    <div class="MALBarbarian barbarianGoliath">
                        <h1 class="titre borderBottom" data-i18n="barbarian-mode-goliath">Mode Goliath</h1>
        
                        <h1 class="titre" data-i18n="bonus">Bonus</h1>
                        <label class="col">
                            <span data-i18n="force">Force</span>
                            <input type="text" name="attr_MALBarbarianGoliath" readonly />
                        </label>
                        <label class="colBL">
                            <span data-i18n="endurance">Endurance</span>
                            <input type="text" name="attr_MALBarbarianGoliath" readonly />
                        </label>
                        <label class="col borderTop">
                            <span data-i18n="degats-violence-contact">Dégâts (contact)</span>
                            <input type="text" name="attr_MALBarbarianDegat" readonly />
                        </label>
                        <label class="colBL borderTop">
                            <span data-i18n="champ-de-force">Champs de Force</span>
                            <input type="text" name="attr_MALBarbarianGoliath" readonly />
                        </label>
                    </div>

                    <div class="MALBard bardChangeling">                        
                        <h1 class="titre" data-i18n="bard-faux-êtres">Faux-Êtres</h1>
                        <div class="autoex autoex28">
                            <span name="attr_MALFauxEtresBard"></span>
                            <textarea name="attr_MALFauxEtresBard"></textarea>
                        </div>
                    </div>

                    <div class="MALDruid druidModJetCompagnons">
                        <h1 class="titre" data-i18n="bonus/malus-aux-jets-des-compagnons">Bonus/Malus aux Jets des Compagnons</h1>
                        <input type="number" name="attr_MALJetModifDesComp" value="0" />
                    </div>
                    <div class="MALDruid MALDCompagnon druidModCompanions">
                        <input class="legendeChoisie" type="hidden" name="attr_maldruidmod" value="0" />
                        <input class="choix" type="hidden" name="attr_MALChoixCompanons" value="aucun" />
        
                        <div class="titre">
                            <h1 class="titre" data-i18n="druid-mod-companions">Mod Companions</h1>
                            <select class="liste" name="attr_MALDruidEnergieCompanon">
                                <option value="10" data-i18n="10-PE" selected>10 PE</option>
                                <option value="20" data-i18n="20-PE">20 PE</option>
                                <option value="30" data-i18n="30-PE">30 PE</option>
                                <option value="40" data-i18n="40-PE">40 PE</option>
                                <option value="50" data-i18n="50-PE">50 PE</option>
                            </select>
                        </div>
                        <div class="button">
                            <button class="aucun" type="action" name="act_MALChoixCompanons_aucun" data-i18n="aucun" >Aucun</button>
                            <button class="lion" type="action" name="act_MALChoixCompanons_lion" data-i18n="druid-companion-lion">Lion</button>
                            <button class="wolf" type="action" name="act_MALChoixCompanons_wolf" data-i18n="druid-companion-wolf">Wolf</button>
                            <button class="crow" type="action" name="act_MALChoixCompanons_crow" data-i18n="druid-companion-crow">Crow</button>
                        </div>
                    </div>

                    <div class="MALPsion">
                        <input class="legendeChoisie2" type="hidden" name="attr_malpsionmode2" value="0" />
        
                        <div class="psionPuppetMaster">
                            <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0" />
        
                            <div class="titre">
                                <button type="action" class="fichePJ bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                                <button type="action" class="fichePJ bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>
                                
                                <h1 class="titre" data-i18n="mode-puppet-master">Mode Puppet Master</h1>
                                <button class="rollDice" type="action" name="act_simplePsionPuppet" value="@{jetGM} &{template:simple} {{Nom=@{name}}}"></button>
                            </div>
                            <div class="rollPJ">
                                <select name="attr_caracteristique1Psion">
                                    <option value="@{aura}" data-i18n="aura" selected>Aura</option>
                                </select>
                                <select name="attr_caracteristique2">
                                    <option value="0" selected></option>
                                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                    <option value="@{force}" data-i18n="force">Force</option>
                                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                    <option value="@{combat}" data-i18n="combat">Combat</option>
                                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                    <option value="@{tir}" data-i18n="tir">Tir</option>
                                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                    <option value="@{technique}" data-i18n="technique">Technique</option>
                                    <option value="@{aura}" data-i18n="aura">Aura</option>
                                    <option value="@{parole}" data-i18n="parole">Parole</option>
                                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                    <option value="@{perception}" data-i18n="perception">Perception</option>
                                </select>
                            </div>
                            <div class="bonusCarac">
                                <select name="attr_caracteristique3">
                                    <option value="0" selected></option>
                                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                    <option value="@{force}" data-i18n="force">Force</option>
                                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                    <option value="@{combat}" data-i18n="combat">Combat</option>
                                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                    <option value="@{tir}" data-i18n="tir">Tir</option>
                                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                    <option value="@{technique}" data-i18n="technique">Technique</option>
                                    <option value="@{aura}" data-i18n="aura">Aura</option>
                                    <option value="@{parole}" data-i18n="parole">Parole</option>
                                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                    <option value="@{perception}" data-i18n="perception">Perception</option>
                                </select>
                                <select name="attr_caracteristique4">
                                    <option value="0" selected></option>
                                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                    <option value="@{force}" data-i18n="force">Force</option>
                                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                    <option value="@{combat}" data-i18n="combat">Combat</option>
                                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                    <option value="@{tir}" data-i18n="tir">Tir</option>
                                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                    <option value="@{technique}" data-i18n="technique">Technique</option>
                                    <option value="@{aura}" data-i18n="aura">Aura</option>
                                    <option value="@{parole}" data-i18n="parole">Parole</option>
                                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                    <option value="@{perception}" data-i18n="perception">Perception</option>
                                </select>
                            </div>
                            <h1 class="titre" data-i18n="ordre-donne">Ordre Donné</h1>
                            <div class="autoex autoex28">
                                <span name="attr_psionPuppetOrdre"></span>
                                <textarea name="attr_psionPuppetOrdre"></textarea>
                            </div>
                        </div>
                        <div class="psionDiscord">
                            <input class="active" type="hidden" name="attr_MALPsionDiscord" />
                            <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0" />
        
                            <div class="titre">
                                <button type="action" class="fichePJ bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                                <button type="action" class="fichePJ bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>
        
                                <h1 class="titre" data-i18n="psion-mode-discord">Mode Discord</h1>
        
                                <button class="active" type="action" name="act_MALPsionDiscord" data-i18n="activer">Activer</button>
                            </div>
                            <label class="ligne2">
                                <span data-i18n="bonus/malus-jets">Bonus/Malus aux Jets</span>
                                <input type="number" name="attr_jetModifDes" value="0" />
                            </label>
                            <div class="rollPJ">
                                <select name="attr_caracteristique1Psion">
                                    <option value="@{aura}" data-i18n="aura" selected>Aura</option>
                                </select>
                                <select name="attr_caracteristique2">
                                    <option value="0" selected></option>
                                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                    <option value="@{force}" data-i18n="force">Force</option>
                                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                    <option value="@{combat}" data-i18n="combat">Combat</option>
                                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                    <option value="@{tir}" data-i18n="tir">Tir</option>
                                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                    <option value="@{technique}" data-i18n="technique">Technique</option>
                                    <option value="@{aura}" data-i18n="aura">Aura</option>
                                    <option value="@{parole}" data-i18n="parole">Parole</option>
                                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                    <option value="@{perception}" data-i18n="perception">Perception</option>
                                </select>
                                <button class="rollDice" type="action" name="act_simplePsionDiscord" value="@{jetGM} &{template:simple} {{Nom=@{name}}}"></button>
                            </div>
        
                            <div class="bonusCarac">
                                <select name="attr_caracteristique3">
                                    <option value="0" selected></option>
                                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                    <option value="@{force}" data-i18n="force">Force</option>
                                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                    <option value="@{combat}" data-i18n="combat">Combat</option>
                                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                    <option value="@{tir}" data-i18n="tir">Tir</option>
                                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                    <option value="@{technique}" data-i18n="technique">Technique</option>
                                    <option value="@{aura}" data-i18n="aura">Aura</option>
                                    <option value="@{parole}" data-i18n="parole">Parole</option>
                                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                    <option value="@{perception}" data-i18n="perception">Perception</option>
                                </select>
                                <select name="attr_caracteristique4">
                                    <option value="0" selected></option>
                                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                    <option value="@{force}" data-i18n="force">Force</option>
                                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                    <option value="@{combat}" data-i18n="combat">Combat</option>
                                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                    <option value="@{tir}" data-i18n="tir">Tir</option>
                                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                    <option value="@{technique}" data-i18n="technique">Technique</option>
                                    <option value="@{aura}" data-i18n="aura">Aura</option>
                                    <option value="@{parole}" data-i18n="parole">Parole</option>
                                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                    <option value="@{perception}" data-i18n="perception">Perception</option>
                                </select>
                            </div>
                            <label class="col3">
                                <span data-i18n="malus-action">Malus Actions</span>
                                <input type="text" name="attr_psionMalusA" value="2D" readonly />
                            </label>
                            <label class="col3BL">
                                <span data-i18n="malus-reaction">Malus Réaction</span>
                                <input type="text" name="attr_psionMalus" value="2" readonly />
                            </label>
                            <label class="col3BL">
                                <span data-i18n="malus-defense">Malus Défense</span>
                                <input type="text" name="attr_psionMalus" value="2" readonly />
                            </label>
                        </div>
                        <div class="psionWindtalker">
                            <h1 class="titre" data-i18n="psion-mode-windtalker">Mode Windtalker</h1>
                            <h2 class="titreBis" data-i18n="actions-creatures">Actions des Créatures</h2>
                            <div class="autoex autoex28">
                                <span name="attr_psionWindtalkerActions"></span>
                                <textarea name="attr_psionWindtalkerActions"></textarea>
                            </div>
                        </div>
                    </div>

                    <div class="MALShaman">
                        <div class="shamanTotem">
                            <input class="nbreTotem" type="hidden" name="attr_MALShamanNbreTotem" value="0" />
        
                            <h1 class="titre" data-i18n="shaman-mode-totem">Mode Totem</h1>
                            <label class="ligne2">
                                <span data-i18n="shaman-nombre-totem">Nombre de totems</span>
                                <input type="number" name="attr_MALShamanNbreTotem" value="0" min="0" max="2" />
                            </label>
                            <input type="hidden" name="attr_MALShamanNbreTotem" value="0" />
                            <label class="ligne2 totem1">
                                <span data-i18n="shaman-caracteristique-totem-1">Caractéristique du Totem 1</span>
                                <select name="attr_MALCaracteristiqueTotem1">
                                    <option value="0" selected></option>
                                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                    <option value="@{force}" data-i18n="force">Force</option>
                                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                    <option value="@{combat}" data-i18n="combat">Combat</option>
                                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                    <option value="@{tir}" data-i18n="tir">Tir</option>
                                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                    <option value="@{technique}" data-i18n="technique">Technique</option>
                                    <option value="@{aura}" data-i18n="aura">Aura</option>
                                    <option value="@{parole}" data-i18n="parole">Parole</option>
                                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                    <option value="@{perception}" data-i18n="perception">Perception</option>
                                </select>
                            </label>
                            <label class="ligne2 totem2">
                                <span data-i18n="shaman-caracteristique-totem-2">Caractéristique du Totem 2</span>
                                <select name="attr_MALCaracteristiqueTotem2">
                                    <option value="0" selected></option>
                                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                    <option value="@{force}" data-i18n="force">Force</option>
                                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                    <option value="@{combat}" data-i18n="combat">Combat</option>
                                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                    <option value="@{tir}" data-i18n="tir">Tir</option>
                                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                    <option value="@{technique}" data-i18n="technique">Technique</option>
                                    <option value="@{aura}" data-i18n="aura">Aura</option>
                                    <option value="@{parole}" data-i18n="parole">Parole</option>
                                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                    <option value="@{perception}" data-i18n="perception">Perception</option>
                                </select>
                            </label>
                        </div>
                        <div class="jet">
                            <input type="hidden" name="attr_bonusCarac" class="bonusCarac" value="0" />
        
                            <div class="titre">
                                <button type="action" class="fichePJ bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                                <button type="action" class="fichePJ bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>
        
                                <h1 class="titre" data-i18n="jet">Jet</h1>
                                <button class="rollDice" type="action" name="act_simple" value="@{jetGM} &{template:simple} {{Nom=@{name}}}"></button>
                            </div>
                            <label class="ligne2">
                                <span data-i18n="bonus/malus-jets">Bonus/Malus aux Jets</span>
                                <input type="number" name="attr_jetModifDes" value="0" />
                            </label>
                            <div class="rollPJ">
                                <select name="attr_caracteristique1">
                                    <option value="0" selected></option>
                                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                    <option value="@{force}" data-i18n="force">Force</option>
                                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                    <option value="@{combat}" data-i18n="combat">Combat</option>
                                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                    <option value="@{tir}" data-i18n="tir">Tir</option>
                                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                    <option value="@{technique}" data-i18n="technique">Technique</option>
                                    <option value="@{aura}" data-i18n="aura">Aura</option>
                                    <option value="@{parole}" data-i18n="parole">Parole</option>
                                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                    <option value="@{perception}" data-i18n="perception">Perception</option>
                                </select>
                                <select name="attr_caracteristique2">
                                    <option value="0" selected></option>
                                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                    <option value="@{force}" data-i18n="force">Force</option>
                                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                    <option value="@{combat}" data-i18n="combat">Combat</option>
                                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                    <option value="@{tir}" data-i18n="tir">Tir</option>
                                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                    <option value="@{technique}" data-i18n="technique">Technique</option>
                                    <option value="@{aura}" data-i18n="aura">Aura</option>
                                    <option value="@{parole}" data-i18n="parole">Parole</option>
                                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                    <option value="@{perception}" data-i18n="perception">Perception</option>
                                </select>
                            </div>
                            <div class="bonusCarac">
                                <select name="attr_caracteristique3">
                                    <option value="0" selected></option>
                                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                    <option value="@{force}" data-i18n="force">Force</option>
                                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                    <option value="@{combat}" data-i18n="combat">Combat</option>
                                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                    <option value="@{tir}" data-i18n="tir">Tir</option>
                                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                    <option value="@{technique}" data-i18n="technique">Technique</option>
                                    <option value="@{aura}" data-i18n="aura">Aura</option>
                                    <option value="@{parole}" data-i18n="parole">Parole</option>
                                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                    <option value="@{perception}" data-i18n="perception">Perception</option>
                                </select>
                                <select name="attr_caracteristique4">
                                    <option value="0" selected></option>
                                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                    <option value="@{force}" data-i18n="force">Force</option>
                                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                    <option value="@{combat}" data-i18n="combat">Combat</option>
                                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                    <option value="@{tir}" data-i18n="tir">Tir</option>
                                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                    <option value="@{technique}" data-i18n="technique">Technique</option>
                                    <option value="@{aura}" data-i18n="aura">Aura</option>
                                    <option value="@{parole}" data-i18n="parole">Parole</option>
                                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                    <option value="@{perception}" data-i18n="perception">Perception</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="MALWarlock">
                        <input class="legendeChoisie" type="hidden" name="attr_malwarlockmode" value="0" />
        
                        <div class="warlockRecord">
                            <input class="active" type="hidden" name="attr_MALWarlockRecord" />
        
                            <div class="titre">
                                <h1 class="titre" data-i18n="warlock-mode-record">Mode Record</h1>
        
                                <button class="active" type="action" name="act_MALWarlockRecord" data-i18n="activer">Activer</button>
                            </div>
                            <label class="ligne2">
                                <span data-i18n="warlock-mode-record-success">Succès enregistrés</span>
                                <input type="number" name="attr_MALWarlockRecordSuccess" value="0" />
                            </label>
                            <label class="ligne2">
                                <span data-i18n="warlock-mode-record-dmg">Dégâts enregistrés</span>
                                <input type="number" name="attr_MALWarlockRecordDmg" value="0" />
                            </label>
                            <label class="ligne2">
                                <span data-i18n="warlock-mode-record-violence">Violence enregistrée</span>
                                <input type="number" name="attr_MALWarlockRecordViolence" value="0" />
                            </label>
                            <h1 class="titre" data-i18n="notes">Notes</h1>
                            <div class="autoex autoex22">
                                <textarea name="attr_MALWarlockRecordNotes"></textarea>
                                <span name="attr_MALWarlockRecordNotes"></span>
                            </div>
                        </div>
                        <div class="warlockRewind">
                            <input class="active" type="hidden" name="attr_MALWarlockRewind" />
        
                            <div class="titre">
                                <h1 class="titre" data-i18n="warlock-mode-rewind">Mode Rewind</h1>
        
                                <button class="active" type="action" name="act_MALWarlockRewind" data-i18n="activer">Activer</button>
                            </div>
                            <div class="autoex autoex22">
                                <textarea name="attr_MALWarlockRewindNotes"></textarea>
                                <span name="attr_warlockRewindNotes"></span>
                            </div>
                        </div>
                    </div>

                    <div class="MALWarmaster">
                        <input class="legendeChoisie" type="hidden" name="attr_malwarmastermode" value="0" />
                    
                        <div class="warmasterWarlord">
                            <input class="warlordChoisie" type="hidden" name="attr_malwarmasterwarlord" value="0" />
                            
                            <div class="esquive titre">
                                <input class="active" type="hidden" name="attr_MALWarmasterImpEsquive" />
        
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_MALWarmasterImpEPersonnel" value="2" />
                                    <span data-i18n-title="personnel" title="Personnel"></span>
                                </label>
        
                                <h1 class="titre" data-i18n="warlord-impulsion-d'esquive">Impulsion d'Esquive</h1>
        
                                <button class="active" type="action" name="act_MALWarmasterImpEsquive" data-i18n="activer">Activer</button>
                            </div>
                            <label class="esquive col2">
                                <span data-i18n="defense">Défense</span>
                                <input type="number" name="attr_defenseTotal" value="0" readonly />
                            </label>
                            <label class="esquive col2BL">
                                <span data-i18n="reaction">Réaction</span>
                                <input type="number" name="attr_reactionTotal" value="0" readonly />
                            </label>
                                                
                            <div class="force titre">
                                <input class="active" type="hidden" name="attr_MALWarmasterImpForce" />
        
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_MALWarmasterImpFPersonnel" value="2" />
                                    <span data-i18n-title="personnel" title="Personnel"></span>
                                </label>
        
                                <h1 class="titre" data-i18n="warlord-impulsion-de-force">Impulsion de Force</h1>
        
                                <button class="active" type="action" name="act_MALWarmasterImpForce" data-i18n="activer">Activer</button>
                            </div>
                            <label class="force ligne2">
                                <span data-i18n="champ-de-force">Champ de Force</span>
                                <input type="number" name="attr_cdfPJ_max" value="8" readonly />
                            </label>
                            
                            <div class="guerre titre">
                                <input class="active" type="hidden" name="attr_MALWarmasterImpGuerre" />
        
                                <label class="fakeButton">
                                    <input type="checkbox" name="attr_MALWarmasterImpGPersonnel" value="{{MALImpulsionGuerreD=[[1D6]]}} {{MALImpulsionGuerreV=[[1D6]]}}" />
                                    <span data-i18n-title="personnel" title="Personnel"></span>
                                </label>
        
                                <h1 class="titre" data-i18n="warlord-impulsion-de-guerre">Impulsion de Guerre</h1>
        
                                <button class="active" type="action" name="act_MALWarmasterImpGuerre" data-i18n="activer">Activer</button>
                            </div>
                            <label class="guerre col2">
                                <span data-i18n="degats">Dégâts</span>
                                <input type="text" name="attr_MALWarmImpGDegats" value="1D6" readonly />
                            </label>
                            <label class="guerre col2BL">
                                <span data-i18n="violence">Violence</span>
                                <input type="text" name="attr_MALWarmImpGViolence" value="1D6" readonly />
                            </label>
                            
                            <div class="energie titre">
                                <input class="active" type="hidden" name="attr_MALWarmasterImpEnergie" />
        
                                <h1 class="titre" data-i18n="warlord-impulsion-d'energie">Impulsion d'Energie</h1>
        
                                <button class="active" type="action" name="act_MALWarmasterImpEnergie" data-i18n="activer">Activer</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="MALDruidCompanions marginTop">
                    <input class="druidCompanions" type="hidden" name="attr_MALChoixCompanons" value="aucun" />

                    <div class="fichePJ DCLion">
                        <input class="subMenu" type="hidden" name="attr_MALTabDruidLion" value="0" />
        
                        <h1 class="titre" data-i18n="druid-companion-lion">Lion</h1>
                        
                        <div class="col4">
                            <h1 class="titre" data-i18n="aspects">Aspects</h1>
                            
                            <div class="ligne aspect">
                                <span data-i18n="chair">Chair</span>
        
                                <div class="blockR">
                                    <input type="number" name="attr_MALDruidLionChairTot" value="@{MALDruidLionChairBase}+@{MALDruidLionChairEvol}" disabled />
                                    <button class="rollDice" name="act_MALDruidLionChairRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}}}"></button>
                                </div>
                            </div>
        
                            <div class="ligne aspect">
                                <span data-i18n="bete">Bête</span>
        
                                <div class="blockR">
                                    <input type="number" name="attr_MALDruidLionBeteTot" value="@{MALDruidLionBeteBase}+@{MALDruidLionBeteEvol}" disabled />
                                    <button class="rollDice" name="act_MALDruidLionBeteRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}}"></button>
                                </div>
                            </div>
        
                            <div class="ligne aspect">
                                <span data-i18n="machine">Machine</span>
        
                                <div class="blockR">
                                    <input type="number" name="attr_MALDruidLionMachineTot" value="@{MALDruidLionMachineBase}+@{MALDruidLionMachineEvol}" disabled />
                                    <button class="rollDice" name="act_MALDruidLionMachineRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}}"></button>
                                </div>
                            </div>
        
                            <div class="ligne aspect">
                                <span data-i18n="dame">Dame</span>
        
                                <div class="blockR">
                                    <input type="number" name="attr_MALDruidLionDameTot" value="@{MALDruidLionDameBase}+@{MALDruidLionDameEvol}" disabled />
                                    <button class="rollDice" name="act_MALDruidLionDameRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}}"></button>
                                </div>
                            </div>
        
                            <div class="ligne aspect">
                                <span data-i18n="masque">Masque</span>
        
                                <div class="blockR">
                                    <input type="number" name="attr_MALDruidLionMasqueTot" value="@{MALDruidLionMasqueBase}+@{MALDruidLionMasqueEvol}" disabled />
                                    <button class="rollDice" name="act_MALDruidLionMasqueRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}}"></button>
                                </div>
                            </div>
                        </div>
        
                        <div class="col4BL">
                            <h1 class="titre" data-i18n="aspects-exceptionnels">Aspects Exceptionnels</h1>
        
                            <div class="ligne AE">
                                <input type="hidden" name="attr_MALDruidLionChairAE" value="1"/>
        
                                <span class="mineur" data-i18n="mineur">Mineur</span>
                                <span class="majeur" data-i18n="majeur">Majeur</span>
                                <span class="value" name="attr_MALDruidLionChairAE">1</span>
                            </div>
        
                            <div class="ligne AE">
                                <input type="hidden" name="attr_MALDruidLionBeteAE" value="1"/>
        
                                <span class="mineur" data-i18n="mineur">Mineur</span>
                                <span class="majeur" data-i18n="majeur">Majeur</span>
                                <span class="value" name="attr_MALDuidLionBeteAE">1</span>
                            </div>
        
                            <div class="ligne AE">
                                <input type="hidden" name="attr_MALDruidLionMachineAE" value="1"/>
        
                                <span class="mineur" data-i18n="mineur">Mineur</span>
                                <span class="majeur" data-i18n="majeur">Majeur</span>
                                <span class="value" name="attr_MALDruidLionMachineAE" >1</span>
                            </div>
        
                            <div class="ligne AE">
                                <input type="hidden" name="attr_MALDruidLionDameAE" value="0"/>
        
                                <span class="mineur" data-i18n="mineur">Mineur</span>
                                <span class="majeur" data-i18n="majeur">Majeur</span>
                                <span class="value" name="attr_MALDruidLionDameAE" >0</span>
                            </div>
        
                            <div class="ligne AE">
                                <input type="hidden" name="attr_MALDruidLionMasqueAE" value="0"/>
        
                                <span class="mineur" data-i18n="mineur">Mineur</span>
                                <span class="majeur" data-i18n="majeur">Majeur</span>
                                <span class="value" name="attr_MALDruidLionMasqueAE">0</span>
                            </div>
                        </div>
        
                        <div class="col4BL">
                            <h1 class="titre" data-i18n="valeurs-derivees">Valeurs Dérivées</h1>
        
                            <div class="ligne defense">
                                <span data-i18n="defense">Défense</span>
        
                                <div class="blockR">
                                    <input type="number" name="attr_MALDruidLionDefenseTot" value="@{MALDruidLionDefenseBase}+@{MALDruidLionDefenseEvol}+@{MALDruidLionMasqueAE}" disabled />
                                </div>
                            </div>
        
                            <div class="ligne reaction">
                                <span data-i18n="reaction">Réaction</span>
        
                                <div class="blockR">
                                    <input type="number" name="attr_MALDruidLionReactionTot" value="@{MALDruidLionReactionBase}+@{MALDruidLionReactionEvol}+@{MALDruidLionMachineAE}" disabled />
                                </div>
                            </div>
        
                            <div class="ligne initiative">
                                <span data-i18n="initiative">Initiative</span>
        
                                <div class="blockR">
                                    <input type="number" name="attr_MALDruidLionInitiativeTot" value="@{MALDruidLionInitiativeBase}+@{MALDruidLionInitiativeEvol}" disabled />
                                    <button class="rollDice" type="action" name="act_MALDruidLionInitiativeRoll" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}}"></button>
                                </div>
                            </div>
        
                            <div class="ligne armure">
                                <span data-i18n="armure">Armure</span>
        
                                <div class="blockR">
                                    <input type="number" name="attr_MALDruidLionPAAct" value="60" />
                                    <b>/</b>
                                    <input type="number" name="attr_MALDruidLionPAAct_max" value="@{MALDruidLionPABase}+@{MALDruidLionPAEvol}" disabled />
                                </div>
                            </div>
        
                            <div class="ligne energie">
                                <span data-i18n="energie">Energie</span>
        
                                <div class="blockR">
                                    <input type="number" name="attr_MALDruidLionPEAct" value="0" />
                                    <b>/</b>
                                    <input type="number" name="attr_MALDruidLionPEAct_max" value="@{MALDruidEnergieCompanon}" disabled />
                                </div>
                            </div>
                        </div>
        
                        <div class="col4BL">
                            <h1 class="titre" data-i18n="champ-de-force">Champ de Force</h1>
        
                            <div class="ligne CDF">
                                <input type="number" name="attr_MALDruidLionCDFTot" value="@{MALDruidLionCDFBase}+@{MALDruidLionCDFEvol}" disabled />
                            </div>
                        </div>
        
                        <div class="subMenu">
                            <button class="armes" type="action" name="act_MALTabDruidLion_1" data-i18n="armes">Armes</button>
                            <button class="BL modules" type="action" name="act_MALTabDruidLion_2" data-i18n="modules">Modules</button>
                            <button class="BL evolutions" type="action" name="act_MALTabDruidLion_3" data-i18n="evolutions">Evolutions</button>
                        </div>
        
                        <div class="armes">
                            <div class="ligneTitre">
                                <div class="firstCol">
                                    <span data-i18n="arme">Arme</span>
                                </div>
                                
                                <div class="midCol">
                                    <span data-i18n="degats">Dégâts</span>
                                </div>
                                <div class="midCol">
                                    <span data-i18n="violence">Violence</span>
                                </div>
                                <div class="midCol">
                                    <span data-i18n="portee">Portée</span>
                                </div>
        
                                <div class="lastCol">
                                    <span data-i18n="aspect">Aspect</span>
                                </div>
                            </div>
        
                            <div class="coups">
                                <input class="subMenu" type="hidden" name="attr_MALTabDCoups" value="0" />
        
                                <div class="ligne">
                                    <div class="firstCol aB1Nom">
                                        <input type="text" name="attr_MALDruidLionBaseNom" value="Coups" readonly />
                                    </div>
            
                                    <div class="midCol aB1Degats">
                                        <input type="number" name="attr_MALDruidLionBaseDegats" class="nbre" value="1" disabled />
                                        <b>D6+</b>
                                        <input type="number" name="attr_MALDruidLionBaseDegatsBonus" class="bonus" value="0" disabled />
                                    </div>
        
                                    <div class="midCol aB1Violence">
                                        <input type="number" name="attr_MALDruidLionBaseViolence" class="nbre" value="1" disabled />
                                        <b>D6+</b>
                                        <input type="number" name="attr_MALDruidLionBaseViolenceBonus" class="bonus" value="0" disabled />
                                    </div>
        
                                    <div class="midCol aB1Portee">
                                        <select name="attr_MALDruidLionBasePortee">
                                            <option data-i18n="portee-contact" value="^{portee-contact}" selected>Contact</option>
                                        </select>
                                    </div>
        
                                    <div class="lastCol aB1Aspect">
                                        <select name="attr_MALAspectDruidLionBase">
                                            <option value="druidLionChair" data-i18n="chair">Chair</option>
                                            <option value="druidLionBete" data-i18n="bete">Bête</option>
                                            <option value="druidLionMachine" data-i18n="machine">Machine</option>
                                            <option value="druidLionDame" data-i18n="dame">Dame</option>
                                            <option value="druidLionMasque" data-i18n="masque">Masque</option>
                                       </select>
                                        <button class="rollDice" type="action" name="act_MALDruidLionArmeBase" value="@{jetGM} &{template:combat} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}} {{special1B=^{coups}}}"></button>
                                    </div>
                                </div>
                                <div class="subMenu">
                                    <button class="special" type="action" name="act_MALTabDCoups-3" data-i18n="special">Spécial</button>
                                </div>
                                <div class="special">
                                    <div class="triple">
                                        <input type="hidden" name="attr_MALCoupBDDiversTotal" value="0" />
                
                                        <label class="fakeButton">
                                            <input type="checkbox" name="attr_MALCoupBDDiversTotal" value="{{BDDivers=[[@{MALBDDiversD6}D6+@{MALBDDiversFixe}]]}} " />
                                            <span data-i18n-title="bonus-degats" title="Bonus aux dégâts"></span>
                                        </label>
                                        <div>
                                            <input class="L" type="number" name="attr_MALBDDiversD6" class="center" value="0" />
                                            <span>D6+</span>
                                            <input class="R" type="number" name="attr_MALBDDiversFixe" class="center" value="0" />
                                        </div>
                                    </div>
                                    <div class="triple">
                                        <input type="hidden" name="attr_MALCoupBVDiversTotal" value="0" />
                
                                        <label class="fakeButton">
                                            <input type="checkbox" name="attr_MALCoupBVDiversTotal" value="{{BVDivers=[[@{MALBVDiversD6}D6+@{MALBVDiversFixe}]]}} " />
                                            <span data-i18n-title="bonus-violence" title="Bonus à la violence"></span>
                                        </label>
                                        <div>
                                            <input class="L" type="number" name="attr_MALBVDiversD6" class="center" value="0" />
                                            <span>D6+</span>
                                            <input class="R" type="number" name="attr_MALBVDiversFixe" class="center" value="0" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <fieldset class="repeating_armeMALDruidLion">
                                <input class="subMenu" type="hidden" name="attr_tab" value="0" />
        
                                <div class="data">
                                    <input type="hidden" name="attr_druidLionDegats" value="{{Degats=[[ [[{[[@{degatDruidLion}+@{chargeurExplosives}-@{chargeurGrappes}-@{munitionsIEM}+@{revetementOmega}]], 0}kh1]]D6+@{degatBonusDruidLion}]]}}" />
                                            
                                    <input type="hidden" name="attr_druidLionViolence" value="{{Violence=[[ [[{[[@{violenceDruidLion}-@{chargeurExplosives}-@{munitionsIEM}]], 0}kh1]]D6+@{violenceBonusDruidLion}]]}}" />
                                    
                                    <input type="hidden" name="attr_druidLionEffets" value="@{destructeur} @{fureur} @{leste} @{meurtrier} @{orfevrerie} @{precision} {{tirSecurite=[[@{tirSecurite}]]}} @{ultraViolence} @{antiAnatheme} @{antiVehicule} @{artillerie} @{assistanceAttaque} @{barrage} @{chargeur} @{choc} @{defense} @{deuxMains} @{dispersion} @{degatContinue} @{demoralisant} @{designation} @{enChaine} @{esperance} @{ignoreArmure} @{ignoreCdF} {{lourd=[[@{lourd}]]}} @{lumiere} @{obliteration} @{parasitage} @{penetrant} @{perceArmure} @{reaction} @{silencieux} {{silencieuxD=[[floor((@{druidLionMasqueTot})/2)+@{druidLionMasqueAE}]]}} @{tenebricite} {{jumelageAkimbo=[[@{akimbo}]]}} {{jumelageAmbidextrie=[[@{ambidextrie}]]}} @{tirRafale} @{assassin} {{cadence=[[ceil(@{cadence})]]}} {{scoreCadence=@{cadenceValue}}} @{soumission}" />
                                    
                                    <input type="hidden" name="attr_druidLionAmeliorations" value="{{chargeurGrappes=[[1D6]]}} {{ballesGrappes=[[@{chargeurGrappes}]]}} {{chargeurExplosives=[[1D6]]}} {{ballesExplosives=[[@{chargeurExplosives}]]}} @{pointeurLaser} @{lunetteIntelligente} @{canonLong} @{munitionsSubsoniques} @{protectionArme} @{structureElement} @{munitionsHyperVelocite} @{munitionsDrone} {{munitionsNonLetales=[[@{munitionsNonLetales}]]}} {{munitionsIEM=[[@{munitionsIEM}]]}} {{interfaceGuidage=[[@{interfaceGuidage}]]}} @{jumelage} {{chambreDouble=[[ceil(@{chambreDouble})]]}} @{systemeRefroidissement} {{revetementOmega=[[@{revetementOmega}D6]]}}" />
        
                                    <input type="hidden" name="attr_druidLionSpecial" value="@{energie} @{bDDiversTotal} @{bVDiversTotal}" />
                                </div>
                                <div class="ligne">
                                    <div class="firstCol aNom">
                                        <input type="text" name="attr_armeDruidLion" />
                                    </div>
        
                                    <div class="midCol aDegats">
                                        <input class="nbre" type="number" name="attr_degatDruidLion" value="0" />
                                        <b>D6+</b>
                                        <input class="bonus" type="number" name="attr_degatBonusDruidLion" value="0" />
                                    </div>
                                    <div class="midCol aViolence">
                                        <input class="nbre" type="number" name="attr_violenceDruidLion" value="0" />
                                        <b>D6+</b>
                                        <input class="bonus" type="number" name="attr_violenceBonusDruidLion" value="0" />
                                    </div>
                                    <div class="midCol aPortee">
                                        <select name="attr_porteeDruidLion">
                                            <option data-i18n="portee-contact" value="^{portee-contact}" selected>Contact</option>
                                            <option data-i18n="portee-courte" value="^{portee-courte}">Courte</option>
                                            <option data-i18n="portee-moyenne" value="^{portee-moyenne}">Moyenne</option>
                                            <option data-i18n="portee-longue" value="^{portee-longue}">Longue</option>
                                            <option data-i18n="portee-lointaine" value="^{portee-lointaine}">Lointaine</option>
                                        </select>
                                    </div>
                                    <div class="lastCol aAspect">
                                        <select name="attr_aspectDruidLion">
                                            <option value="druidLionChair" data-i18n="chair">Chair</option>
                                            <option value="druidLionBete" data-i18n="bete">Bête</option>
                                            <option value="druidLionMachine" data-i18n="machine">Machine</option>
                                            <option value="druidLionDame" data-i18n="dame">Dame</option>
                                            <option value="druidLionMasque" data-i18n="masque">Masque</option>
                                        </select>
                                        <button class="rollDice" type="action" name="act_combatdruidroll" value="@{jetGM} &{template:combat} {{Nom=^{druid-companion-lion}}} {{special1=@{name}}}"></button>
                                    </div>
                                </div>
                                <div class="subMenu">
                                    <button class="effets" type="action" name="act_tab-1" data-i18n="effets">Effets</button>
                                    <button class="ameliorationsArmes BL" type="action" name="act_tab-2" data-i18n="ameliorations-d'armes">Améliorations d'armes</button>
                                    <button class="special BL" type="action" name="act_tab-3" data-i18n="special">Spécial</button>
                                </div>
        
                                <div class="effets">
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_antiAnatheme" value="{{antiAnathème=Anti Anathème}}" />
                                        <span data-i18n-title="anti-anatheme" title="Anti Anathème"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_antiVehicule" value="{{antiVehicule=Anti Véhicule}} " />
                                        <span data-i18n-title="anti-vehicule" title="Anti Véhicule"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_artillerie" value="{{artillerie=Artillerie}}" />
                                        <span data-i18n-title="artillerie" title="Artillerie"></span>
                                    </label>
                                    <div class="double">
                                        <label class="fakeButton">
                                            <input type="checkbox" name="attr_assassin" value="{{assassin=[[@{assassinValue}d6]]}} " />
                                            <span data-i18n-title="assassin" title="Assassin"></span>
                                        </label>
                                        
                                        <input type="number" name="attr_assassinValue" class="center" value="0" />
                                    </div>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_assistanceAttaque" value="{{assistanceAttaque=Assistance à l'attaque}}" />
                                        <span data-i18n-title="assistance-attaque" title="Assistance à l'attaque"></span>
                                    </label>
                                    <div class="double">
                                        <label class="fakeButton">
                                            <input type="checkbox" name="attr_barrage" value="{{barrage=^{barrage} @{barrageValue}}} " />
                                            <span data-i18n-title="barrage" title="Barrage"></span>
                                        </label>
                                        
                                        <input type="number" name="attr_barrageValue" class="center" value="0" />
                                    </div>
                                    <div class="double">
                                        <label class="fakeButton">
                                            <input type="checkbox" name="attr_cadence" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                                            <span data-i18n-title="cadence" title="Cadence"></span>
                                        </label>
                                    
                                        <input type="number" name="attr_cadenceValue" class="center" value="0" />
                                    </div>
                                    <div class="double">
                                        <label class="fakeButton">
                                            <input type="checkbox" name="attr_chargeur" value="{{chargeur=^{chargeur} @{chargeurValue}}} " />
                                            <span data-i18n-title="chargeur" title="Chargeur"></span>
                                        </label>
                                    
                                        <input type="number" name="attr_chargeurValue" class="center" value="0" />
                                    </div>
                                    <div class="double">
                                        <label class="fakeButton">
                                            <input type="checkbox" name="attr_choc" value="{{choc=^{choc} @{chocValue}}}" />
                                            <span data-i18n-title="choc" title="Choc"></span>
                                        </label>
                                    
                                        <input type="number" name="attr_chocValue" class="center" value="0" />
                                    </div>
                                    <div class="double">
                                        <label class="fakeButton">
                                            <input type="checkbox" name="attr_defense" value="{{defense=^{defense} @{defenseValue}}}" />
                                            <span data-i18n-title="defense" title="Défense"></span>
                                        </label>
                                    
                                        <input type="number" name="attr_defenseValue" class="center" value="0" />
                                    </div>
                                    <div class="double">
                                        <label class="fakeButton">
                                            <input type="checkbox" name="attr_degatContinue" value="{{degatContinus=^{degats-continus} @{degatContinueValue} ([[1D6]] ^{tours})}}" />
                                            <span data-i18n-title="degats-continus" title="Dégâts Continus"></span>
                                        </label>
                                    
                                        <input type="number" name="attr_degatContinueValue" class="center" size="2" value="0" />
                                    </div>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_deuxMains" value="{{deuxMains=Deux Mains}}" />
                                        <span data-i18n-title="deux-mains" title="Deux Mains"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_demoralisant" value="{{demoralisant=Démoralisant}}" />
                                        <span data-i18n-title="demoralisant" title="Démoralisant"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_designation" value="{{designation=Désignation}}" />
                                        <span data-i18n-title="designation" title="Désignation"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_destructeur" value="{{destructeur=[[2D6]]}}" />
                                        <span data-i18n-title="destructeur" title="Destructeur"></span>
                                    </label>
                                    <div class="double">
                                        <label class="fakeButton">
                                            <input type="checkbox" name="attr_dispersion" value="{{dispersion=^{dispersion} @{dispersionValue}}} " />
                                            <span data-i18n-title="dispersion" title="Dispersion"></span>
                                        </label>
                                    
                                        <input type="number" name="attr_dispersionValue" class="center" value="0" />
                                    </div>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_enChaine" value="{{enChaine=En Chaîne}}" />
                                        <span data-i18n-title="en-chaine" title="En Chaîne"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_esperance" value="{{esperance=Espérance}}" />
                                        <span data-i18n-title="esperance" title="Espérance"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_fureur" value="{{fureur=[[4D6]]}}" />
                                        <span data-i18n-title="fureur" title="Fureur"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_ignoreArmure" value="{{ignoreArmure=Ignore Armure}}" />
                                        <span data-i18n-title="ignore-armure" title="Ignore Armure"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_ignoreCdF" value="{{ignoreCdF=Ignore Champs de Force}}" />
                                        <span data-i18n-title="ignore-champ-de-force" title="Ignore CdF"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_akimbo" value="2" />
                                        <span data-i18n-title="jumele-akimbo" title="Jumelé (Akimbo)"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_ambidextrie" value="2" />
                                        <span data-i18n-title="jumele-ambidextrie" title="Jumelé (Ambidextrie)"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_leste" value="{{leste=[[@{druidLionChairTot}]]}}" />
                                        <span data-i18n-title="leste" title="Lesté"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_lourd" value="1" />
                                        <span data-i18n-title="lourd" title="Lourd"></span>
                                    </label>
                                    <div class="double">
                                        <label class="fakeButton">
                                            <input type="checkbox" name="attr_lumiere" value="{{lumiere=^{lumiere} @{lumiereValue}}}" />
                                            <span data-i18n-title="lumiere" title="Lumière"></span>
                                        </label>
        
                                        <input type="number" name="attr_lumiereValue" class="center" size="2" value="0" />
                                    </div>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_meurtrier" value="{{meurtrier=[[2D6]]}}" />
                                        <span data-i18n-title="meurtrier" title="Meurtrier"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_obliteration" value="{{obliteration=Oblitération}}" />
                                        <span data-i18n-title="obliteration" title="Oblitération"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_orfevrerie" value="{{orfevrerie=[[@{dexterite}+@{dextOD}]]}} {{orfevrerieWarrior=[[@{dexterite}+@{dextOD}+@{warriorScoutA}]]}}" />
                                        <span data-i18n-title="orfevrerie" title="Orfèvrerie"></span>
                                    </label>
                                    <div class="double">
                                        <label class="fakeButton">
                                            <input type="checkbox" name="attr_parasitage" value="{{parasitage=^{parasitage} @{parasitageValue}}}" />
                                            <span data-i18n-title="parasitage" title="Parasitage"></span>
                                        </label>
                                    
                                        <input type="number" name="attr_parasitageValue" class="center" value="0" />
                                    </div>
                                    <div class="double">
                                        <label class="fakeButton">
                                            <input type="checkbox" name="attr_penetrant" value="{{penetrant=^{penetrant} @{penetrantValue}}}" />
                                            <span data-i18n-title="penetrant" title="Pénétrant"></span>
                                        </label>
                                    
                                        <input type="number" name="attr_penetrantValue" class="center" value="0" />
                                    </div>
                                    <div class="double">
                                        <label class="fakeButton">
                                            <input type="checkbox" name="attr_perceArmure" value="{{perceArmure=^{perce-armure} @{perceArmureValue}}}" />
                                            <span data-i18n-title="perce-armure" title="Perce Armure"></span>
                                        </label>
                                    
                                        <input type="number" name="attr_perceArmureValue" class="center" value="0" />
                                    </div>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_precision" value="{{precision=[[@{tir}+@{tirOD}]]}} {{precisionWarrior=[[@{tir}+@{tirOD}+@{warriorScholarA}]]}}" />
                                        <span data-i18n-title="precision" title="Précision"></span>
                                    </label>
                                    <div class="double">
                                        <label class="fakeButton">
                                            <input type="checkbox" name="attr_reaction" value="{{reaction=^{reaction} @{reactionValue}}}" />
                                            <span data-i18n-title="reaction" title="Réaction"></span>
                                        </label>
                                    
                                        <input type="number" name="attr_reactionValue" class="center" value="0" />
                                    </div>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_silencieux" value="{{silencieux=Silencieux}}" />
                                        <span data-i18n-title="silencieux" title="Silencieux"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_soumission" value="{{soumission=Soumission}}" />
                                        <span data-i18n-title="soumission" title="Soumission"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_tenebricite" value="{{tenebricite=Ténébricité}}" />
                                        <span data-i18n-title="tenebricite" title="Ténébricité"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_tirRafale" value="{{tirRafale=Tir en Rafale}}" />
                                        <span data-i18n-title="tir-rafale" title="Tir en Rafale"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_tirSecurite" value="3" />
                                        <span data-i18n-title="tir-securite" title="Tir en Sécurité"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_ultraViolence" value="{{ultraviolence=[[2D6]]}}" />
                                        <span data-i18n-title="ultraviolence" title="Ultraviolence"></span>
                                    </label>
                                </div>
                                <div class="ameliorationsArmes">
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_chargeurGrappes" value="1" />
                                        <span data-i18n-title="balles-grappes" title="Balles grappes"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_canonLong" value="{{canonLongM=1}} {{canonLongC=Canon Long (Portée Courte : +3 Difficulté)}}" />
                                        <span data-i18n-title="canon-long" title="Canon Long"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_canonRaccourci" value="{{canonRaccourci=Canon Raccourci (Portée Courte : Dispersion 3 / Sinon : +3 Difficulté)}}" />
                                        <span data-i18n-title="canon-raccourci" title="Canon Raccourci"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_chambreDouble" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                                        <span data-i18n-title="chambre-double" title="Chambre Double"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_interfaceGuidage" value="3" />
                                        <span data-i18n-title="interface-guidage" title="Interface de guidage"></span>
                                    </label>
                                    <div class="doubleTexte">
                                        <label class="fakeButton">
                                            <input type="checkbox" name="attr_jumelage" value="{{jumelage=^{jumelage} (@{jumelageValue})}}" />
                                            <span data-i18n-title="jumelage" title="Jumelage :"></span>
                                        </label>
                                        <input type="text" name="attr_jumelageValue" class="borderBottom" />
                                        <label class="fakeButton">
                                            <input type="checkbox" name="attr_jumelageType" value="ambidextrie" />
                                            <span data-i18n-title="ambidextrie" title="Ambidextrie"></span>
                                        </label>
                                        <label class="fakeButton borderTop">
                                            <input type="checkbox" name="attr_jumelageType" value="akimbo" />
                                            <span data-i18n-title="akimbo" title="Akimbo"></span>
                                        </label>
                                    </div>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_lunetteIntelligente" value="{{lunetteIntelligente=Lunette Intelligente (+1 Portée)}}" />
                                        <span data-i18n-title="lunette-intelligente" title="Lunette Intelligente"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_munitionsHyperVelocite" value="{{munitionsHyperVelocite=Munitions à Hyper Velocite (Assistance à l'Attaque)}}" />
                                        <span data-i18n-title="munitions-h-velocite" title="Munitions à H. Vélocité"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_munitionsDrone" value="{{munitionsDrone=3}}" />
                                        <span data-i18n-title="munitions-drones" title="Munitions Drones"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_chargeurExplosives" value="1" />
                                        <span data-i18n-title="munitions-explosives" title="Munitions Explosives"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_munitionsIEM" value="1" />
                                        <span data-i18n-title="munitions-iem" title="Munitions IEM"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_munitionsNonLetales" value="2" />
                                        <span  data-i18n-title="munitions-n-letales"title="Munitions N. Létales"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_munitionsSubsoniques" value="{{munitionsSubsoniques=Munitions Subsoniques (Silencieux)}}" />
                                        <span data-i18n-title="munitions-subsoniques" title="Munitions Subsoniques"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_pointeurLaser" value="{{pointeurLaser=1}} " />
                                        <span data-i18n-title="pointeur-laser" title="Pointeur Laser"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_protectionArme" value="{{protectionArme=Protection d'Arme (Reaction +2)}}" />
                                        <span data-i18n-title="protection-d'arme" title="Protection d'Arme"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_revetementOmega" value="2" />
                                        <span data-i18n-title="revetement-omega" title="Revêtement Omega"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_structureElement" value="{{structureElement=Structure en Élément}}" />
                                        <span data-i18n-title="structure-alpha" title="Structure Alpha"></span>
                                    </label>
                                    <label class="simple fakeButton">
                                        <input type="checkbox" name="attr_systemeRefroidissement" value="{{systemeRefroidissement=Système de Refroidissement (Tir en Rafale + Barrage 1)}}" />
                                        <span data-i18n-title="systeme-refroid" title="Système de Refroid."></span>
                                    </label>
                                </div>
                                <div class="special">
                                    <div class="double">
                                        <label class="fakeButton">
                                            <input type="checkbox" name="attr_energie" value="{{energie=@{energieValue}}} " />
                                            <span data-i18n-title="energie" title="Énergie"></span>
                                        </label>
                                    
                                        <input type="number" name="attr_energieValue" class="center" value="0" />
                                    </div>
                                    <div class="triple">
                                        <input type="hidden" name="attr_bDDiversTotal" value="0" />
        
                                        <label class="fakeButton">
                                            <input type="checkbox" name="attr_bDDiversTotal" value="{{BDDivers=[[@{bDDiversD6}D6+@{bDDiversFixe}]]}} " />
                                            <span data-i18n-title="bonus-degats" title="Bonus aux dégâts"></span>
                                        </label>
                                        <div>
                                            <input class="L" type="number" name="attr_bDDiversD6" class="center" value="0" />
                                            <span>D6+</span>
                                            <input class="R" type="number" name="attr_bDDiversFixe" class="center" value="0" />
                                        </div>
                                    </div>
                                    <div class="triple">
                                        <input type="hidden" name="attr_bVDiversTotal" value="0" />
        
                                        <label class="fakeButton">
                                            <input type="checkbox" name="attr_bVDiversTotal" value="{{BVDivers=[[@{bVDiversD6}D6+@{bVDiversFixe}]]}} " />
                                            <span data-i18n-title="bonus-violence" title="Bonus à la violence"></span>
                                        </label>
                                        <div>
                                            <input class="L" type="number" name="attr_bVDiversD6" class="center" value="0" />
                                            <span>D6+</span>
                                            <input class="R" type="number" name="attr_bVDiversFixe" class="center" value="0" />
                                        </div>
                                    </div>
                                </div>
                            </fieldset>
                        </div>
        
                        <div class="modules">
                            <input type="hidden" name="attr_slotsMALDCLTeteMax" value="8" readonly />
                            <input type="hidden" name="attr_slotsMALUDCLTeteTot" value="0" />
                            
                            <input type="hidden" name="attr_slotsMALDCLTorseMax" value="8" readonly />
                            <input type="hidden" name="attr_slotsMALUDCLTorseTot" value="0" />
                        
                            <input type="hidden" name="attr_slotsMALDCLBGMax" value="8" readonly />
                            <input type="hidden" name="attr_slotsMALUDCLBGTot" value="0" />
                        
                            <input type="hidden" name="attr_slotsMALDCLBDMax" value="8" readonly />
                            <input type="hidden" name="attr_slotsMALUDCLBDTot" value="0" />
                        
                            <input type="hidden" name="attr_slotsMALDCLJGMax" value="8" readonly />
                            <input type="hidden" name="attr_slotsMALUDCLJGTot" value="0" />
                        
                            <input type="hidden" name="attr_slotsMALDCLJDMax" value="8" readonly />
                            <input type="hidden" name="attr_slotsMALUDCLJDTot" value="0" />
        
                            <h1 class="titre" data-i18n="slots-du-lion">Slots du Lion</h1>
        
                            <div class="ligne slots">
                                <div class="col6">
                                    <span data-i18n="tete">Tête</span>
        
                                    <div data-i18n-title="slots-restants/slots-maximum" title="Slots restants / Slots maximum">
                                        <input type="number" name="attr_slotsMALDCLTeteAct" value="@{slotsMALDCLTeteMax}-@{slotsMALUDCLTeteTot}" disabled />	
                                        <b>/</b>
                                        <span name="attr_slotsMALDCLTeteMax">8</span>
                                    </div>
                                </div>
        
                                <div class="col6BL">
                                    <span data-i18n="torse">Torse</span>
                                    <div data-i18n-title="slots-restants/slots-maximum" title="Slots restants / Slots maximum">
                                        <input type="number" name="attr_slotsMALDCLTorseAct" value="@{slotsMALDCLTorseMax}-@{slotsMALUDCLTorseTot}" disabled />	
                                        <b>/</b>
                                        <span name="attr_slotsMALDCLTorseMax">8</span>
                                    </div>
                                </div>
        
                                <div class="col6BL">
                                    <span data-i18n="bras-gauche">Bras Gauche</span>
                                    <div data-i18n-title="slots-restants/slots-maximum" title="Slots restants / Slots maximum">
                                        <input type="number" name="attr_slotsMALDCLBGAct" value="@{slotsMALDCLBGMax}-@{slotsMALUDCLBGTot}" disabled />	<b>/</b><span name="attr_slotsMALDCLBGMax">8</span>
                                    </div>
                                </div>
        
                                <div class="col6BL">
                                    <span data-i18n="bras-droit">Bras Droit</span>
                                    <div data-i18n-title="slots-restants/slots-maximum" title="Slots restants / Slots maximum">
                                        <input type="number" name="attr_slotsDCLBDAct" value="@{slotsMALDCLBDMax}-@{slotsMALUDCLBDTot}" disabled />	<b>/</b><span name="attr_slotsMALDCLBDMax">8</span>
                                    </div>
                                </div>
        
                                <div class="col6BL">
                                    <span data-i18n="jambe-gauche">Jambe Gauche</span>
                                    <div data-i18n-title="slots-restants/slots-maximum" title="Slots restants / Slots maximum">
                                        <input type="number" name="attr_slotsDCLJGAct" value="@{slotsMALDCLJGMax}-@{slotsMALUDCLJGTot}" disabled />	<b>/</b><span name="attr_slotsMALDCLJGMax">8</span>
                                    </div>
                                </div>
        
                                <div class="col6BL">
                                    <span data-i18n="jambe-droite">Jambe Droite</span>
                                    <div data-i18n-title="slots-restants/slots-maximum" title="Slots restants / Slots maximum">
                                        <input type="number" name="attr_slotsDCLJDAct" value="@{slotsMALDCLJDMax}-@{slotsMALUDCLJDTot}" disabled />	<b>/</b><span name="attr_slotsMALDCLJDMax">8</span>
                                    </div>
                                </div>
                            </div>
        
                            <fieldset class="repeating_modulesMALDCLion">
                                <input class="expandModule" type="hidden" name="attr_affichageMALDCLion" value="0" />
                                <input class="expandSlots" type="hidden" name="attr_slotsMALDCLPlus" value="0" />
        
                                <div class="ligne titreModule">
                                    <button class="buttonPlus" type="action" name="act_affichagemaldclion-1">
                                       <span class="plus">+</span>
                                       <span class="moins">-</span>
                                    </button>
                                    <input type="text" name="attr_moduleNomMALDCLion" placeholder="Nom du Module"/>
                                </div>
        
                                <div class="ligne hModule">
                                    <label class="activation">
                                        <span data-i18n="activation">Activation</span>
                                        <input type="text" name="attr_moduleActivationMALDCLion" />
                                    </label>
                                    <div class="PE">
                                        <button type="action" name="act_pemdlion" title="Dépenser les PE du module" data-i18n-title="depenser-pe-module" data-i18n="point-d'energie-short">PE</button>
                                        <input type="number" name="attr_moduleEnergieMALDCLion" value="0" />
                                    </div>
                                </div>
                                
                                <label class="ligne hModule duree">
                                    <span data-i18n="duree">Durée</span>
                                    <input type="text" name="attr_moduleDureeMALDCLion" />
                                </label>
                
                                <div class="autoex hModule autoex28">
                                    <span name="attr_moduleDescriptionMALDCLion"></span>
                                    <textarea name="attr_moduleDescriptionMALDCLion"></textarea>
                                </div>
        
                                <div class="ligne hModule titre titreSlots">
                                    <input type="number" name="attr_slotsTotalMALDCLion" value="@{moduleSlotMALDCLTete}+@{moduleSlotMALDCLTorse}+@{moduleSlotMALDCLBG}+@{moduleSlotMALDCLBD}+@{moduleSlotMALDCLJG}+@{moduleSlotMALDCLJD}" title="Slots occupés" disabled />
                                    <h1 class="titre" data-i18n="slots">Slots</h1>
                                    <button class="buttonArrow" type="action" name="act_slotsmaldclplus-1">]</button>
                                </div>
        
                                <div class="ligne hSlots">
                                    <label class="slot">
                                        <span data-i18n="tete">Tête</span>
                                        <input type="number" name="attr_moduleSlotMALDCLTete" value="0" />
                                    </label>
                                    
                                    <label class="slotBL">
                                        <span data-i18n="torse">Torse</span>
                                        <input type="number" name="attr_moduleSlotMALDCLTorse" value="0" />
                                    </label>
                                </div>
                                
                                <div class="ligne hSlots bTop">
                                    <label class="slot">
                                        <span data-i18n="bras-gauche">Bras Gauche</span>
                                        <input type="number" name="attr_moduleSlotMALDCLBG" value="0" />
                                    </label>
                                    
                                    <label class="slotBL">
                                        <span data-i18n="bras-droit">Bras Droit</span>
                                        <input type="number" name="attr_moduleSlotMALDCLBD" value="0" />
                                    </label>
                                </div>
                                
                                <div class="ligne hSlots bTop">
                                    <label class="slot">
                                        <span data-i18n="jambe-gauche">Jambe Gauche</span>
                                        <input type="number" name="attr_moduleSlotMALDCLJG" value="0" />
                                    </label>
                                    
                                    <label class="slotBL">
                                        <span data-i18n="jambe-droite">Jambe Droite</span>
                                        <input type="number" name="attr_moduleSlotMALDCLJD" value="0" />
                                    </label>
                                </div>
                            </fieldset>
                        </div>
        
                        <div class="evolutions">
                            <input type="hidden" name="attr_MALDruidLionChairBase" value="7" />
                            <input type="hidden" name="attr_MALDruidLionBeteBase" value="6" />
                            <input type="hidden" name="attr_MALDruidLionMachineBase" value="7" />
                            <input type="hidden" name="attr_MALDruidLionDameBase" value="4" />
                            <input type="hidden" name="attr_MALDruidLionMasqueBase" value="3" />
                                                        
                            <input type="hidden" name="attr_MALDruidLionPABase" value="60" />
                            <input type="hidden" name="attr_MALDruidLionDefenseBase" value="4" />
                            <input type="hidden" name="attr_MALDruidLionReactionBase" value="4" />
                            <input type="hidden" name="attr_MALDruidLionInitiativeBase" value="2" />
                            <input type="hidden" name="attr_MALDruidLionCDFBase" value="10" />
                
                            <div class="aspects">
                                <div class="ligneTitre">
                                    <span></span>
                                    <span data-i18n="aspects">Aspects</span>
                                    <span data-i18n="aspects-exceptionnels">Aspects Exceptionnels</span>
                                </div>
                                <div class="ligne2">
                                    <span data-i18n="chair">Chair</span>
                                    <div>
                                        <input type="number" name="attr_MALDruidLionChairEvol" value="0" min="0" />
                                    </div>
                                    <div>
                                        <select name="attr_MALDruidLionChairAE">
                                            <option value="1" selected>1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                            <option value="6">6</option>
                                            <option value="7">7</option>
                                            <option value="8">8</option>
                                            <option value="9">9</option>
                                            <option value="10">10</option>
                                        </select>
                                    </div>
                                    
                                </div>
                                <div class="ligne2">
                                    <span data-i18n="bete">Bête</span>
                                    <div>
                                        <input type="number" name="attr_MALDruidLionBeteEvol" value="0" min="0" />
                                    </div>
                                    <div>
                                        <select name="attr_MALDruidLionBeteAE">
                                            <option value="1" selected>1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                            <option value="6">6</option>
                                            <option value="7">7</option>
                                            <option value="8">8</option>
                                            <option value="9">9</option>
                                            <option value="10">10</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="ligne2">
                                    <span data-i18n="machine">Machine</span>
                                    <div>
                                        <input type="number" name="attr_MALDruidLionMachineEvol" value="0" min="0" />
                                    </div>
                                    <div>
                                        <select name="attr_MALDruidLionMachineAE">
                                            <option value="1" selected>1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                            <option value="6">6</option>
                                            <option value="7">7</option>
                                            <option value="8">8</option>
                                            <option value="9">9</option>
                                            <option value="10">10</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="ligne2">
                                    <span data-i18n="dame">Dame</span>
                                    <div>
                                        <input type="number" name="attr_MALDruidLionDameEvol" value="0" min="0" />
                                    </div>
                                    <div>
                                        <select name="attr_MALDruidLionDameAE">
                                            <option value="0" selected>0</option>
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                            <option value="6">6</option>
                                            <option value="7">7</option>
                                            <option value="8">8</option>
                                            <option value="9">9</option>
                                            <option value="10">10</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="ligne2">
                                    <span data-i18n="masque">Masque</span>
                                    <div>
                                        <input type="number" name="attr_MALDruidLionMasqueEvol" value="0" min="0" />
                                    </div>
                                    <div>
                                        <select name="attr_MALDruidLionMasqueAE">
                                            <option value="0" selected>0</option>
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                            <option value="6">6</option>
                                            <option value="7">7</option>
                                            <option value="8">8</option>
                                            <option value="9">9</option>
                                            <option value="10">10</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="VD">
                                <div class="ligneTitre">
                                    <span></span>
                                    <span data-i18n="valeurs-derivees">Valeurs Dérivées</span>
                                </div>
                                <label class="ligne1">
                                    <span data-i18n="champ-de-force">Champs de Force</span>
                                    <input type="number" name="attr_MALDruidLionCDFEvol" value="0" min="0" />
                                </label>
                                <label class="ligne1">
                                    <span data-i18n="armure">Armure</span>
                                    <input type="number" name="attr_MALDruidLionPAEvol" value="0" min="0" />
                                </label>
                                <label class="ligne1">
                                    <span data-i18n="defense">Défense</span>
                                    <input type="number" name="attr_MALDruidLionDefenseEvol" value="0" min="0" />
                                </label>
                                <label class="ligne1">
                                    <span data-i18n="reaction">Réaction</span>
                                    <input type="number" name="attr_MALDruidLionReactionEvol" value="0" min="0" />
                                </label>
                                <label class="ligne1">
                                    <span data-i18n="initiative">Initiative</span>
                                    <input type="number" name="attr_MALDruidLionInitiativeEvol" value="0" min="0" />
                                </label>
                            </div>
                        </div>
                    </div>
        
                    <div class="fichePJ DCWolf">
                        <input class="subMenu" type="hidden" name="attr_MALTabDruidWolf" value="0" />
                        <input class="choixConfiguration" type="hidden" name="attr_MALDruidWolfConfiguration" />
                        <input class="laborNiveau" type="hidden" name="attr_MALDWolfLaborNiveau" value="1" />
                        <input class="medikNiveau" type="hidden" name="attr_MALDWolfMedicNiveau" value="1" />
                        <input class="techNiveau" type="hidden" name="attr_MALDWolfTechNiveau" value="1" />
                        <input class="fighterNiveau" type="hidden" name="attr_MALDWolfFighterNiveau" value="1" />
                        <input class="reconNiveau" type="hidden" name="attr_MALDWolfReconNiveau" value="1" />
        
                        <h1 class="titre" data-i18n="druid-companion-wolf">Wolf</h1>
        
                        <div class="col4">
                            <h1 class="titre" data-i18n="aspects">Aspects</h1>
                            <div class="ligne aspect">
                                <span data-i18n="chair">Chair</span>
        
                                <div class="blockR">
                                    <input type="number" name="attr_MALDruidWolfChairTot" value="@{MALDruidWolfChairBase}+@{MALDruidWolfChairEvol}" disabled />
                                    <button class="rollDice" name="act_druidWolfChairRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-wolf}}} {{special1=@{name}}}"></button>
                                </div>
                            </div>
                            <div class="ligne aspect">
                                <span data-i18n="bete">Bête</span>
        
                                <div class="blockR">
                                    <input type="number" name="attr_MALDruidWolfBeteTot" value="@{MALDruidWolfBeteBase}+@{MALDruidWolfBeteEvol}" disabled />
                                    <button class="rollDice" name="act_MALDruidWolfBeteRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-wolf}}} {{special1=@{name}}}"></button>
                                </div>
                            </div>
                            <div class="ligne aspect">
                                <span data-i18n="machine">Machine</span>
        
                                <div class="blockR">
                                    <input type="number" name="attr_MALDruidWolfMachineTot" value="@{druidWolfMachineBase}+@{druidWolfMachineEvol}" disabled />
                                    <button class="rollDice" name="act_MALDruidWolfMachineRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-wolf}}} {{special1=@{name}}}"></button>
                                </div>
                            </div>
                            <div class="ligne aspect">
                                <span data-i18n="dame">Dame</span>
        
                                <div class="blockR">
                                    <input type="number" name="attr_MALDruidWolfDameTot" value="@{druidWolfDameBase}+@{druidWolfDameEvol}" disabled />
                                    <button class="rollDice" name="act_MALDruidWolfDameRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-wolf}}} {{special1=@{name}}}"></button>
                                </div>
                            </div>
                            <div class="ligne aspect">
                                <span data-i18n="masque">Masque</span>
        
                                <div class="blockR">
                                    <input type="number" name="attr_MALDruidWolfMasqueTot" value="@{druidWolfMasqueBase}+@{druidWolfMasqueEvol}" disabled />
                                    <button class="rollDice" name="act_MALDruidWolfMasqueRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-wolf}}} {{special1=@{name}}}"></button>
                                </div>
                            </div>
                        </div>
        
                        <div class="col4BL">
                            <h1 class="titre" data-i18n="aspects-exceptionnels">Aspects Exceptionnels</h1>
        
                            <div class="ligne AE">
                                <input type="hidden" name="attr_MALDruidWolfChairAE" value="0"/>
                                <span class="mineur" data-i18n="mineur">Mineur</span>
                                <span class="majeur" data-i18n="majeur">Majeur</span>
                                <span class="value" name="attr_MALDruidWolfChairAE">0</span>
                            </div>
                            <div class="ligne AE">
                                <input type="hidden" name="attr_MALDruidWolfBeteAE" value="0"/>
                                <span class="mineur" data-i18n="mineur">Mineur</span>
                                <span class="majeur" data-i18n="majeur">Majeur</span>
                                <span class="value" name="attr_MALDruidWolfBeteAE">0</span>
                            </div>
                            <div class="ligne AE">
                                <input type="hidden" name="attr_MALDruidWolfMachineAE" value="0"/>
                                <span class="mineur" data-i18n="mineur">Mineur</span>
                                <span class="majeur" data-i18n="majeur">Majeur</span>
                                <span class="value" name="attr_MALDruidWolfMachineAE">0</span>
                            </div>
                            <div class="ligne AE">
                                <input type="hidden" name="attr_MALDruidWolfDameAE" value="0"/>
                                <span class="mineur" data-i18n="mineur">Mineur</span>
                                <span class="majeur" data-i18n="majeur">Majeur</span>
                                <span class="value" name="attr_MALDruidWolfDameAE">0</span>
                            </div>
                            <div class="ligne AE">
                                <input type="hidden" name="attr_MALDruidWolfMasqueAE" value="0"/>
                                <span class="mineur" data-i18n="mineur">Mineur</span>
                                <span class="majeur" data-i18n="majeur">Majeur</span>
                                <span class="value" name="attr_MALDruidWolfMasqueAE">0</span>
                            </div>
                        </div>
        
                        <div class="col4BL">
                            <h1 class="titre" data-i18n="valeurs-derivees">Valeurs Dérivées</h1>
        
                            <div class="ligne defense">
                                <span data-i18n="defense">Défense</span>
        
                                <div class="blockR">
                                    <input type="number" name="attr_MALDruidWolfDefenseTot" value="4+@{MALDruidWolfMasqueAE}" disabled />
                                </div>
                            </div>
                            <div class="ligne reaction">
                                <span data-i18n="reaction">Réaction</span>
        
                                <div class="blockR">
                                    <input type="number" name="attr_druidWolfReactionTot" value="4+@{MALDruidWolfMachineAE}" disabled />
                                </div>
                            </div>
                            <div class="ligne initiative">
                                <span data-i18n="initiative">Initiative</span>
        
                                <div class="blockR">
                                    <input type="number" name="attr_MALDruidWolfInitiativeTot" value="2" disabled />
                                    <button class="rollDice" type="action" name="act_MALDruidWolfInitiativeRoll" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-wolf}}} {{special1=@{name}}}"></button>
                                </div>
                            </div>
                            <div class="ligne armure">
                                <span data-i18n="armure">Armure</span>
        
                                <div class="blockR">
                                    <input type="number" name="attr_MALDruidWolfPAAct" value="20" />
                                    <b>/</b>
                                    <input type="number" name="attr_MALDruidWolfPAAct_max" value="20" disabled />
                                </div>
                            </div>
                            <div class="ligne energie">
                                <span data-i18n="energie">Energie</span>
        
                                <div class="blockR">
                                    <input type="number" name="attr_MALDruidWolfPEAct" value="0" />
                                    <b>/</b>
                                    <input type="number" name="attr_MALDruidWolfPEAct_max" value="@{MALDruidEnergieCompanon}" disabled />
                                </div>
                            </div>
                        </div>
        
                        <div class="col4BL">
                            <h1 class="titre" data-i18n="champ-de-force">Champ de Force</h1>
                            <div class="ligne CDF">
                                <input type="number" name="attr_MALDruidWolfCDFT" value="4" disabled />
                            </div>
        
                            <h1 class="titre" data-i18n="configuration">Configuration</h1>
                            <div class="ligne configuration">
                                <select name="attr_MALDruidWolfConfiguration">
                                    <option value="" selected></option>
                                    <option value="Labor" data-i18n="druid-wolf-labor">Labor</option>
                                    <option value="Medic" data-i18n="druid-wolf-medik">Medik</option>
                                    <option value="Tech" data-i18n="druid-wolf-tech">Tech</option>
                                    <option value="Fighter" data-i18n="druid-wolf-fighter">Fighter</option>
                                    <option value="Recon" data-i18n="druid-wolf-recon">Recon</option>
                                </select>
                                <button type="action" name="act_MALDruidWolfConfiguration" data-i18n="point-energie-short">PE</button>
                                <input type="number" name="attr_MALDruidWolfConfigurationPE" value="0" readonly />
                            </div>
        
                            <div class="ligne nbreCompanions">
                                <select name="attr_MALDruidNombreCompagnon">
                                    <option value="3" data-i18n="druid-3-companions-restants" selected>3 Companions Restants</option>
                                    <option value="2"data-i18n="druid-2-companions-restants" >2 Companions Restants</option>
                                    <option value="1"data-i18n="druid-1-companions-restants" >1 Companions Restant</option>
                                </select>
                            </div>
        
                            <div class="ligne fighter">
                                <span data-i18n="degats">Dégâts</span>
                                <button class="rollDice" type="action" name="act_MALDWolfFighterN1Roll" value="@{jetGM} &{template:combat} {{portee=^{portee-contact}}} {{Nom=^{druid-companion-wolf}}} {{special1=@{name}}}"></button>
                            </div>
                        </div>
        
                        <h1 class="titre" data-i18n="configuration">Configuration</h1>
                        <div class="labor description">	
                            <span class="N1" data-i18n="druid-companion-labor-description-niveau-1">
                                Les actions du chevalier visant à porter de lourdes charges, à déplacer ou lever des poids reçoivent 1 dé par compagnon effectuant l’action de support. Chaque compagnon peut porter à lui seul 150 kg et peut donc transporter des choses pour le chevalier.
                            </span>
                            <span class="N2" data-i18n="druid-companion-labor-description-niveau-2">
                                Les actions du chevalier visant à porter de lourdes charges, à déplacer ou lever des poids reçoivent 2 dé par compagnon effectuant l’action de support. Chaque compagnon peut porter à lui seul 150 kg et peut donc transporter des choses pour le chevalier.
                            </span>
                            <span class="N3" data-i18n="druid-companion-labor-description-niveau-3">
                                Les actions du chevalier visant à porter de lourdes charges, à déplacer ou lever des poids reçoivent 3 dé par compagnon effectuant l’action de support. Chaque compagnon peut porter à lui seul 150 kg et peut donc transporter des choses pour le chevalier.
                            </span>
                        </div>
        
                        <div class="medik description">
                            <span class="N1" data-i18n="druid-companion-medik-description-niveau-1">
                                Les actions du chevalier visant à soigner, à faire des recherches biologiques ou à reconnaitre un élément médical ou biologique reçoivent 1 dé supplémentaire par compagnon effectuant un support. Si le chevalier soigne un allié, celui-ci récupère 2 PS supplémentaires par compagnon effectuant un support.
                            </span>
                            <span class="N2" data-i18n="druid-companion-medik-description-niveau-2">
                                Les actions du chevalier visant à soigner, à faire des recherches biologiques ou à reconnaitre un élément médical ou biologique reçoivent 2 dé supplémentaire par compagnon effectuant un support. Si le chevalier soigne un allié, celui-ci récupère 2 PS supplémentaires par compagnon effectuant un support.
                            </span>
                            <span class="N3" data-i18n="druid-companion-medik-description-niveau-3">
                                Les actions du chevalier visant à soigner, à faire des recherches biologiques ou à reconnaitre un élément médical ou biologique reçoivent 3 dé supplémentaire par compagnon effectuant un support. Si le chevalier soigne un allié, celui-ci récupère 2 PS supplémentaires par compagnon effectuant un support.
                            </span>
                        </div>
        
                        <div class="tech description">
                            <span class="N1" data-i18n="druid-companion-tech-description-niveau-1">
                                Les actions du chevalier visant à réparer un objet, un véhicule, un compagnon ou une méta-armure, à analyser un élément informatique ou électronique reçoivent 1 dé supplémentaire par compagnon effectuant un support. Le chevalier peut effectuer les réparations ou les analyses directement depuis un compagnon. Si le chevalier tente de réparer quelque chose (méta-armure, compagnon, véhicule) à l’aide de ses Companions, les PA que la cible récupère sont augmentés de 3 par compagnon effectuant l’action de support.
                            </span>
                            <span class="N2" data-i18n="druid-companion-tech-description-niveau-2">
                                Les actions du chevalier visant à réparer un objet, un véhicule, un compagnon ou une méta-armure, à analyser un élément informatique ou électronique reçoivent 2 dé supplémentaire par compagnon effectuant un support. Le chevalier peut effectuer les réparations ou les analyses directement depuis un compagnon. Si le chevalier tente de réparer quelque chose (méta-armure, compagnon, véhicule) à l’aide de ses Companions, les PA que la cible récupère sont augmentés de 3 par compagnon effectuant l’action de support.
                            </span>
                            <span class="N3" data-i18n="druid-companion-tech-description-niveau-3">
                                Les actions du chevalier visant à réparer un objet, un véhicule, un compagnon ou une méta-armure, à analyser un élément informatique ou électronique reçoivent 3 dé supplémentaire par compagnon effectuant un support. Le chevalier peut effectuer les réparations ou les analyses directement depuis un compagnon. Si le chevalier tente de réparer quelque chose (méta-armure, compagnon, véhicule) à l’aide de ses Companions, les PA que la cible récupère sont augmentés de 3 par compagnon effectuant l’action de support.
                            </span>
                        </div>
        
                        <div class="fighter description">
                            <span class="N1" data-i18n="druid-companion-fighter-description-niveau-1">
                                Les actions de combat du chevalier contre un ennemi désigné aux Companions reçoivent 1 dé supplémentaire par compagnon effectuant un support. La cible du chevalier doit être à portée courte et doit pouvoir être attaquée au contact. Si ces deux conditions sont respectées, la cible reçoit automatiquement l’effet barrage 1 par compagnon (3 Companions supportant le chevalier infligent ainsi l’effet barrage 3). De plus, les Companions infligent à la cible 1D6 points de dégâts ou de violence chacun (sans bonus) sans devoir effectuer de jet de dés pour toucher. On considère cependant que lorsqu’ils effectuent cette action de support, leur défense tombe à 0. Une seule cible à la fois peut subir cette action de support.
                            </span>
                            <span class="N2" data-i18n="druid-companion-fighter-description-niveau-2">
                                Les actions de combat du chevalier contre un ennemi désigné aux Companions reçoivent 2 dé supplémentaire par compagnon effectuant un support. La cible du chevalier doit être à portée courte et doit pouvoir être attaquée au contact. Si ces deux conditions sont respectées, la cible reçoit automatiquement l’effet barrage 1 par compagnon (3 Companions supportant le chevalier infligent ainsi l’effet barrage 3). De plus, les Companions infligent à la cible 1D6 points de dégâts ou de violence chacun (sans bonus) sans devoir effectuer de jet de dés pour toucher. On considère cependant que lorsqu’ils effectuent cette action de support, leur défense tombe à 0. Une seule cible à la fois peut subir cette action de support.
                            </span>
                            <span class="N3" data-i18n="druid-companion-fighter-description-niveau-3">
                                Les actions de combat du chevalier contre un ennemi désigné aux Companions reçoivent 3 dé supplémentaire par compagnon effectuant un support. La cible du chevalier doit être à portée courte et doit pouvoir être attaquée au contact. Si ces deux conditions sont respectées, la cible reçoit automatiquement l’effet barrage 1 par compagnon (3 Companions supportant le chevalier infligent ainsi l’effet barrage 3). De plus, les Companions infligent à la cible 1D6 points de dégâts ou de violence chacun (sans bonus) sans devoir effectuer de jet de dés pour toucher. On considère cependant que lorsqu’ils effectuent cette action de support, leur défense tombe à 0. Une seule cible à la fois peut subir cette action de support.
                            </span>
                        </div>
        
                        <div class="recon description">
                            <span class="N1" data-i18n="druid-companion-recon-description-niveau-1">
                                Toutes les actions d’observation, de vigilance ou de fouille menées par le chevalier reçoivent 1 dé supplémentaire par compagnon effectuant le support. Le chevalier peut observer, entendre, sentir et toucher directement depuis un des compagnons (au choix).
                            </span>
                            <span class="N2" data-i18n="druid-companion-recon-description-niveau-2">
                                Toutes les actions d’observation, de vigilance ou de fouille menées par le chevalier reçoivent 2 dé supplémentaire par compagnon effectuant le support. Le chevalier peut observer, entendre, sentir et toucher directement depuis un des compagnons (au choix).
                            </span>
                            <span class="N3" data-i18n="druid-companion-recon-description-niveau-3">
                                Toutes les actions d’observation, de vigilance ou de fouille menées par le chevalier reçoivent 3 dé supplémentaire par compagnon effectuant le support. Le chevalier peut observer, entendre, sentir et toucher directement depuis un des compagnons (au choix).
                            </span>
                        </div>
        
                        <div class="subMenu">
                            <button class="evolutions" type="action" name="act_MALTabDruidWolf_3" data-i18n="evolutions">Evolutions</button>
                        </div>
        
                        <div class="evolutions">
                            <input type="hidden" name="attr_MALDruidWolfChairBase" value="2" disabled />
                            <input type="hidden" name="attr_MALDruidWolfBeteBase" value="4" disabled />
                            <input type="hidden" name="attr_MALDruidWolfMachineBase" value="4" disabled />
                            <input type="hidden" name="attr_MALDruidWolfDameBase" value="2" disabled />
                            <input type="hidden" name="attr_MALDruidWolfMasqueBase" value="4" disabled />
                            
                            <div class="aspects">
                                <div class="ligneTitre">
                                    <span data-i18n="aspects">Aspects</span>
                                    <span data-i18n="aspects-exceptionnels">Aspects Exceptionnels</span>
                                </div>
                                <div class="ligne2">
                                    <span data-i18n="chair">Chair</span>
                
                                    <div>
                                        <input type="number" name="attr_MALDruidWolfChairEvol" value="0" min="0" />
                                    </div>
                                    <div>
                                        <select name="attr_MALDruidWolfChairAE">
                                            <option value="0" selected>0</option>
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                            <option value="6">6</option>
                                            <option value="7">7</option>
                                            <option value="8">8</option>
                                            <option value="9">9</option>
                                            <option value="10">10</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="ligne2">
                                    <span data-i18n="bete">Bête</span>
                                    <div>
                                        <input type="number" name="attr_MALDruidWolfBeteEvol" value="0" min="0" />
                                    </div>
                                    <div>
                                        <select name="attr_MALDruidWolfBeteAE">
                                            <option value="0" selected>0</option>
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                            <option value="6">6</option>
                                            <option value="7">7</option>
                                            <option value="8">8</option>
                                            <option value="9">9</option>
                                            <option value="10">10</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="ligne2">
                                    <span data-i18n="machine">Machine</span>
                
                                    <div>
                                        <input type="number" name="attr_MALDruidWolfMachineEvol" value="0" min="0" />
                                    </div>
                                    <div>
                                        <select name="attr_MALDruidWolfMachineAE">
                                            <option value="0" selected>0</option>
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                            <option value="6">6</option>
                                            <option value="7">7</option>
                                            <option value="8">8</option>
                                            <option value="9">9</option>
                                            <option value="10">10</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="ligne2">
                                    <span data-i18n="dame">Dame</span>
                
                                    <div>
                                        <input type="number" name="attr_MALDruidWolfDameEvol" value="0" min="0" />
                                    </div>
                                    <div>
                                        <select name="attr_MALDruidWolfDameAE">
                                            <option value="0" selected>0</option>
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                            <option value="6">6</option>
                                            <option value="7">7</option>
                                            <option value="8">8</option>
                                            <option value="9">9</option>
                                            <option value="10">10</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="ligne2">
                                    <span data-i18n="masque">Masque</span>
                
                                    <div>
                                        <input type="number" name="attr_MALDruidWolfMasqueEvol" value="0" min="0" />
                                    </div>
                                    <div>
                                        <select name="attr_MALDruidWolfMasqueAE">
                                            <option value="0" selected>0</option>
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                            <option value="6">6</option>
                                            <option value="7">7</option>
                                            <option value="8">8</option>
                                            <option value="9">9</option>
                                            <option value="10">10</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="companions cLabor">
                                <div class="tCompanions">
                                    <h2 data-i18n="druid-companion-labor">Labor</h2>
                                    <select name="attr_MALDWolfLaborNiveau">
                                        <option value="1" data-i18n="druid-companion-niveau-1" selected>Niveau 1</option>
                                        <option value="2" data-i18n="druid-companion-niveau-2">Niveau 2</option>
                                        <option value="3" data-i18n="druid-companion-niveau-3">Niveau 3</option>
                                    </select>
                                </div>
                
                                <span class="N1" data-i18n="druid-companion-labor-description-niveau-1">
                                    Les actions du chevalier visant à porter de lourdes charges, à déplacer ou lever des poids reçoivent 1 dé par compagnon effectuant l’action de support. Chaque compagnon peut porter à lui seul 150 kg et peut donc transporter des choses pour le chevalier.
                                </span>
                                <span class="N2" data-i18n="druid-companion-labor-description-niveau-2">
                                    Les actions du chevalier visant à porter de lourdes charges, à déplacer ou lever des poids reçoivent 2 dé par compagnon effectuant l’action de support. Chaque compagnon peut porter à lui seul 150 kg et peut donc transporter des choses pour le chevalier.
                                </span>
                                <span class="N3" data-i18n="druid-companion-labor-description-niveau-3">
                                    Les actions du chevalier visant à porter de lourdes charges, à déplacer ou lever des poids reçoivent 3 dés par compagnon effectuant l’action de support. Chaque compagnon peut porter à lui seul 150 kg et peut donc transporter des choses pour le chevalier.
                                </span>
                            </div>
                            
                            <div class="companions cMedik mT">
                                <div class="tCompanions">
                                    <h2 data-i18n="druid-companion-medik">Medik</h2>
                                    <select name="attr_MALDWolfMedicNiveau">
                                        <option value="1" data-i18n="druid-companion-niveau-1" selected>Niveau 1</option>
                                        <option value="2" data-i18n="druid-companion-niveau-2">Niveau 2</option>
                                        <option value="3" data-i18n="druid-companion-niveau-3">Niveau 3</option>
                                    </select>
                                </div>
                
                                <span class="N1" data-i18n="druid-companion-medik-description-niveau-1">
                                    Les actions du chevalier visant à soigner, à faire des recherches biologiques ou à reconnaitre un élément médical ou biologique reçoivent 1 dé supplémentaire par compagnon effectuant un support. Si le chevalier soigne un allié, celui-ci récupère 2 PS supplémentaires par compagnon effectuant un support.
                                </span>
                                <span class="N2" data-i18n="druid-companion-medik-description-niveau-2">
                                    Les actions du chevalier visant à soigner, à faire des recherches biologiques ou à reconnaitre un élément médical ou biologique reçoivent 2 dés supplémentaire par compagnon effectuant un support. Si le chevalier soigne un allié, celui-ci récupère 2 PS supplémentaires par compagnon effectuant un support.
                                </span>
                                <span class="N3" data-i18n="druid-companion-medik-description-niveau-3">
                                    Les actions du chevalier visant à soigner, à faire des recherches biologiques ou à reconnaitre un élément médical ou biologique reçoivent 3 dés supplémentaire par compagnon effectuant un support. Si le chevalier soigne un allié, celui-ci récupère 2 PS supplémentaires par compagnon effectuant un support.
                                </span>
                            </div>
                            
                            <div class="companions cTech mT">
                                <div class="tCompanions">
                                    <h2 data-i18n="druid-companion-tech">Tech</h2>
                                    <select name="attr_MALDWolfTechNiveau">
                                        <option value="1" data-i18n="druid-companion-niveau-1" selected>Niveau 1</option>
                                        <option value="2" data-i18n="druid-companion-niveau-2">Niveau 2</option>
                                        <option value="3" data-i18n="druid-companion-niveau-3">Niveau 3</option>
                                    </select>
                                </div>
                
                                <span class="N1" data-i18n="druid-companion-tech-description-niveau-1">
                                    Les actions du chevalier visant à réparer un objet, un véhicule, un compagnon ou une méta-armure, à analyser un élément informatique ou électronique reçoivent 1 dé supplémentaire par compagnon effectuant un support. Le chevalier peut effectuer les réparations ou les analyses directement depuis un compagnon. Si le chevalier tente de réparer quelque chose (méta-armure, compagnon, véhicule) à l’aide de ses compagnons, les PA que la cible récupère sont augmentés de 3 par compagnon effectuant l’action de support.
                                </span>
                                <span class="N2" data-i18n="druid-companion-tech-description-niveau-2">
                                    Les actions du chevalier visant à réparer un objet, un véhicule, un compagnon ou une méta-armure, à analyser un élément informatique ou électronique reçoivent 2 dés supplémentaire par compagnon effectuant un support. Le chevalier peut effectuer les réparations ou les analyses directement depuis un compagnon. Si le chevalier tente de réparer quelque chose (méta-armure, compagnon, véhicule) à l’aide de ses compagnons, les PA que la cible récupère sont augmentés de 3 par compagnon effectuant l’action de support.
                                </span>
                                <span class="N3" data-i18n="druid-companion-tech-description-niveau-3">
                                    Les actions du chevalier visant à réparer un objet, un véhicule, un compagnon ou une méta-armure, à analyser un élément informatique ou électronique reçoivent 3 dés supplémentaire par compagnon effectuant un support. Le chevalier peut effectuer les réparations ou les analyses directement depuis un compagnon. Si le chevalier tente de réparer quelque chose (méta-armure, compagnon, véhicule) à l’aide de ses compagnons, les PA que la cible récupère sont augmentés de 3 par compagnon effectuant l’action de support.
                                </span>
                            </div>
                            
                            <div class="companions cFighter mT">
                                <div class="tCompanions">
                                    <h2 data-i18n="druid-companion-fighter">Fighter</h2>
                                    <select name="attr_MALDWolfFighterNiveau">
                                        <option value="1" data-i18n="druid-companion-niveau-1" selected>Niveau 1</option>
                                        <option value="2" data-i18n="druid-companion-niveau-2">Niveau 2</option>
                                        <option value="3" data-i18n="druid-companion-niveau-3">Niveau 3</option>
                                    </select>
                                </div>
                
                                <span class="N1" data-i18n="druid-companion-fighter-description-niveau-1">
                                    Les actions de combat du chevalier contre un ennemi désigné aux compagnons reçoivent 1 dé supplémentaire par compagnon effectuant un support. La cible du chevalier doit être à portée courte et doit pouvoir être attaquée au contact. Si ces deux conditions sont respectées, la cible reçoit automatiquement l’effet barrage 1 par compagnon (3 compagnons supportant le chevalier infligent ainsi l’effet barrage 3). De plus, les compagnons infligent à la cible 1D6 points de dégâts ou de violence chacun (sans bonus) sans devoir effectuer de jet de dés pour toucher. On considère cependant que lorsqu’ils effectuent cette action de support, leur défense tombe à 0. Une seule cible à la fois peut subir cette action de support.
                                </span>
                                <span class="N2" data-i18n="druid-companion-fighter-description-niveau-2">
                                    Les actions de combat du chevalier contre un ennemi désigné aux compagnons reçoivent 2 dés supplémentaire par compagnon effectuant un support. La cible du chevalier doit être à portée courte et doit pouvoir être attaquée au contact. Si ces deux conditions sont respectées, la cible reçoit automatiquement l’effet barrage 1 par compagnon (3 compagnons supportant le chevalier infligent ainsi l’effet barrage 3). De plus, les compagnons infligent à la cible 1D6 points de dégâts ou de violence chacun (sans bonus) sans devoir effectuer de jet de dés pour toucher. On considère cependant que lorsqu’ils effectuent cette action de support, leur défense tombe à 0. Une seule cible à la fois peut subir cette action de support.
                                </span>
                                <span class="N3" data-i18n="druid-companion-fighter-description-niveau-3">
                                    Les actions de combat du chevalier contre un ennemi désigné aux compagnons reçoivent 3 dés supplémentaire par compagnon effectuant un support. La cible du chevalier doit être à portée courte et doit pouvoir être attaquée au contact. Si ces deux conditions sont respectées, la cible reçoit automatiquement l’effet barrage 1 par compagnon (3 compagnons supportant le chevalier infligent ainsi l’effet barrage 3). De plus, les compagnons infligent à la cible 1D6 points de dégâts ou de violence chacun (sans bonus) sans devoir effectuer de jet de dés pour toucher. On considère cependant que lorsqu’ils effectuent cette action de support, leur défense tombe à 0. Une seule cible à la fois peut subir cette action de support.
                                </span>
                            </div>
                            
                            <div class="companions cRecon mT">
                                <div class="tCompanions">
                                    <h2 data-i18n="druid-companion-recon">Recon</h2>
                                    <select name="attr_MALDWolfReconNiveau">
                                        <option value="1" data-i18n="druid-companion-niveau-1" selected>Niveau 1</option>
                                        <option value="2" data-i18n="druid-companion-niveau-2">Niveau 2</option>
                                        <option value="3" data-i18n="druid-companion-niveau-3">Niveau 3</option>
                                    </select>
                                </div>
                
                                <span class="N1" data-i18n="druid-companion-recon-description-niveau-1">
                                    Toutes les actions d’observation, de vigilance ou de fouille menées par le chevalier reçoivent 1 dé supplémentaire par compagnon effectuant le support. Le chevalier peut observer, entendre, sentir et toucher directement depuis un des compagnons (au choix).
                                </span>
                                <span class="N2" data-i18n="druid-companion-recon-description-niveau-2">
                                    Toutes les actions d’observation, de vigilance ou de fouille menées par le chevalier reçoivent 2 dés supplémentaire par compagnon effectuant le support. Le chevalier peut observer, entendre, sentir et toucher directement depuis un des compagnons (au choix).
                                </span>
                                <span class="N3" data-i18n="druid-companion-recon-description-niveau-3">
                                    Toutes les actions d’observation, de vigilance ou de fouille menées par le chevalier reçoivent 3 dés supplémentaire par compagnon effectuant le support. Le chevalier peut observer, entendre, sentir et toucher directement depuis un des compagnons (au choix).
                                </span>
                            </div>
                        </div>
                    </div>
        
                    <div class="fichePJ DCCrow">
                        <input class="subMenu" type="hidden" name="attr_MALTabDruidCrow" value="0" />
        
                        <h1 class="titre" data-i18n="druid-companion-crow">Crow</h1>
        
                        <div class="col4">
                            <h1 class="titre" data-i18n="aspects">Aspects</h1>
        
                            <div class="ligne aspect">
                                <span data-i18n="chair">Chair</span>
        
                                <div class="blockR">
                                    <input type="number" name="attr_MALDruidCrowChairTot" value="@{MALDruidCrowChairBase}+@{MALDruidCrowChairEvol}" disabled />
                                    <button class="rollDice" name="act_MALDruidCrowChairRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-crow}}} {{special1=@{name}}}"></button>
                                </div>
                            </div>
                            <div class="ligne aspect">
                                <span data-i18n="bete">Bête</span>
        
                                <div class="blockR">
                                    <input type="number" name="attr_MALDruidCrowBeteTot" value="@{MALDruidCrowBeteBase}+@{MALDruidCrowBeteEvol}" disabled />
                                    <button class="rollDice" name="act_MALDruidCrowBeteRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-crow}}} {{special1=@{name}}}"></button>
                                </div>
                            </div>
                            <div class="ligne aspect">
                                <span data-i18n="machine">Machine</span>
        
                                <div class="blockR">
                                    <input type="number" name="attr_MALDruidCrowMachineTot" value="@{MALDruidCrowMachineBase}+@{MALDruidCrowMachineEvol}" disabled />
                                    <button class="rollDice" name="act_MALDruidCrowMachineRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-crow}}} {{special1=@{name}}}"></button>
                                </div>
                            </div>
                            <div class="ligne aspect">
                                <span data-i18n="dame">Dame</span>
        
                                <div class="blockR">
                                    <input type="number" name="attr_MALDruidCrowDameTot" value="@{MALDruidCrowDameBase}+@{MALDruidCrowDameEvol}" disabled />
                                    <button class="rollDice" name="act_MALDruidCrowDameRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-crow}}} {{special1=@{name}}}"></button>
                                </div>
                            </div>
                            <div class="ligne aspect">
                                <span data-i18n="masque">Masque</span>
                                
                                <div class="blockR">
                                    <input type="number" name="attr_MALDruidCrowMasqueTot" value="@{MALDruidCrowMasqueBase}+@{MALDruidCrowMasqueEvol}" disabled />
                                    <button class="rollDice" name="act_MALDruidCrowMasqueRoll" type="action" value="@{jetGM} &{template:simple} {{Nom=^{druid-companion-crow}}} {{special1=@{name}}}"></button>
                                </div>
                            </div>
                        </div>
        
                        <div class="col4BL">
                            <h1 class="titre" data-i18n="valeurs-derivees">Valeurs Dérivées</h1>
        
                            <div class="ligne defense">
                                <span data-i18n="defense">Défense</span>
        
                                <div class="blockR">
                                    <input type="number" name="attr_MALDruidCrowDefenseTot" value="2" disabled />
                                </div>
                            </div>
                            <div class="ligne reaction">
                                <span data-i18n="reaction">Réaction</span>
        
                                <div class="blockR">
                                    <input type="number" name="attr_MALDruidCrowReactionTot" value="2" disabled />
                                </div>
                            </div>
                            <div class="ligne initiative">
                                <span data-i18n="initiative">Initiative</span>
        
                                <div class="blockR">
                                    <input type="number" name="attr_MALDruidCrowInitiativeTot" value="1" disabled />
                                    <button class="rollDice" type="action" name="act_MALDruidCrowInitiativeRoll" value="@{jetGM} &{template:simple} {{Nom=Crow}} {{special1=@{name}}}"></button>
                                </div>
                            </div>
                            <div class="ligne cohesion">
                                <span data-i18n="cohesion">Cohésion</span>
        
                                <div class="blockR">
                                    <input type="number" name="attr_MALDruidCrowCoAct" value="50" /> 
                                    <b>/</b>
                                    <input type="number" name="attr_MALDruidCrowCoTot" value="50*2" disabled />
                                </div>
                            </div>
                            <div class="ligne debordement">
                                <span data-i18n="debordement">Débordement</span>
        
                                <div class="blockR">
                                    <input type="number" name="attr_MALDruidCrowDebordementTot" value="2*2" disabled />
                                </div>
                            </div>
                        </div>
        
                        <div class="col4BL">
                            <h1 class="titre" data-i18n="champ-de-force">Champ de Force</h1>
                            <div class="ligne CDF">
                                <input type="number" name="attr_MALDruidCrowCDFTot" value="2*2" disabled />
                            </div>
        
                            <h1 class="titre" data-i18n="debordement">Débordement</h1>
                            <div class="ligne tourCombat">
                                <span data-i18n="tours-de-combat">Tours de combat</span>
        
                                <div class="blockR">
                                    <input type="number" name="attr_MALDruidCrowTAttaque" value="1" min="1" />
                                    <button class="rollDice" type="action" name="act_MALDruidCrowAttaque" value="@{jetGM} &{template:combat} {{Nom=^{druid-companion-crow}}} {{special1=@{name}}}"></button>
                                </div>
                            </div>
                        </div>
        
                        <h1 class="titre" data-i18n="specificites">Spécificités</h1>
                        <span class="specificites" data-i18n="druid-companion-crow-specificite">La bande est équipée d'un module de vol niveau 3 constamment activé qui ne coûte aucune énergie.
                            <br/>
                            Les points de dégâts qui lui sont infligés lui font perdre de la cohésion.
                        </span>
        
                        <div class="subMenu">
                            <button class="evolutions" type="action" name="act_MALTabDruidCrow_3" data-i18n="evolutions">Evolutions</button>
                        </div>
        
                        <div class="evolutions">
                            <input type="hidden" name="attr_MALDruidCrowChairBase" value="6" disabled />
                            <input type="hidden" name="attr_MALDruidCrowBeteBase" value="4" disabled />
                            <input type="hidden" name="attr_MALDruidCrowMachineBase" value="4" disabled />
                            <input type="hidden" name="attr_MALDruidCrowDameBase" value="0" disabled />
                            <input type="hidden" name="attr_MALDruidCrowMasqueBase" value="6" disabled />
                
                            <div class="aspects">
                                <div class="ligneTitre">
                                    <span></span>
                                    <span data-i18n="aspects">Aspects</span>
                                </div>
                                <label class="ligne1">
                                    <span data-i18n="chair">Chair</span>
                
                                    <div>
                                        <input type="number" name="attr_MALDruidCrowChairEvol" value="0" min="0" />
                                    </div>
                                </label>
                                <label class="ligne1">
                                    <span data-i18n="bete">Bête</span>
                
                                    <div>
                                        <input type="number" name="attr_MALDruidCrowBeteEvol" value="0" min="0" />
                                    </div>
                                </label>
                                <label class="ligne1">
                                    <span data-i18n="machine">Machine</span>
                
                                    <div>
                                        <input type="number" name="attr_MALDruidCrowMachineEvol" value="0" min="0" />
                                    </div>
                                </label>
                                <label class="ligne1">
                                    <span data-i18n="dame">Dame</span>
                
                                    <div>
                                        <input type="number" name="attr_MALDruidCrowDameEvol" value="0" min="0" />
                                    </div>
                                </label>
                                <label class="ligne1">
                                    <span data-i18n="masque">Masque</span>
                
                                    <div>
                                        <input type="number" name="attr_MALDruidCrowMasqueEvol" value="0" min="0" />
                                    </div>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div><div class="fichePJ armesPJ">
    <div class="subTabMelee">
        <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0" />
        <input class="styleCombat" type="hidden" name="attr_styleCombat" value="0" />
        <input class="armePoing" type="hidden" name="attr_armeCoupPoing" value="1" />
        <input class="armeSection1" type="hidden" name="attr_armeSPS" value="0" />
        <input class="armeSection2" type="hidden" name="attr_armeSME" value="0"/>

        <div class="titre">
            <button type="action" class="bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
            <button type="action" class="bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>

            <h1 class="titre" data-i18n="armes-contact">Armes de Contact</h1>
        </div>
        <div class="ligneTitre">
            <div class="firstCol">
                <span data-i18n="arme">Arme</span>
            </div>
            
            <div class="midCol">
                <span data-i18n="degats">Dégâts</span>
            </div>
            <div class="midCol">
                <span data-i18n="violence">Violence</span>
            </div>
            <div class="midCol">
                <span data-i18n="portee">Portée</span>
            </div>
            
            <div class="lastCol">
                <span data-i18n="jet">Jet</span>
            </div>
        </div>
        <div class="armesListe sans guardian">
            <div class="poing">
                <div class="ligne">
                    <div class="firstCol armeNom">
                        <input type="text" name="attr_poingCaC" value="Coup de poing/pied" readonly />
                    </div>
    
                    <div class="midCol armeDegats">
                        <input class="nbre" type="number" name="attr_poingCaCDegat" value="0" readonly />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_poingCaCBDegat" value="0" readonly />
                    </div>
                    <div class="midCol armeViolence">
                        <input class="nbre" type="number" name="attr_poingCaCViolence" value="0" readonly />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_poingCaCBViolence" value="1" readonly />
                    </div>
                    <div class="midCol armePortee">
                        <select name="attr_poingCaCPortee">
                            <option value="^{portee-contact}" data-i18n="portee-contact" selected>Contact</option>
                        </select>
                    </div>
    
                    <div class="lastCol armeCaracs">
                        <select name="attr_poingCcaracteristique1Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <select name="attr_poingCcaracteristique2Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <button class="rollDice" type="action" name="act_poingContact" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=@{poingCaC}}} {{portee=^{portee} @{poingCaCPortee}}}"></button>
                    </div>
                </div>
                <div class="bonus">
                    <div class="bonusCarac">
                        <select name="attr_poingCcaracteristique3Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <select name="attr_poingCcaracteristique4Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="armesListe barbarian bard berserk druid monk necromancer paladin priest psion ranger rogue shaman sorcerer warlock warmaster warrior wizard">
            <div class="poing">
                <input class="subMenu" type="hidden" name="attr_poingMACOptions" />

                <div class="ligne">
                    <div class="firstCol armeNom">
                        <input type="text" name="attr_poingMACaC" value="Coup de poing/pied" readonly />
                    </div>

                    <div class="midCol armeDegats">
                        <input class="nbre" type="number" name="attr_poingMACaCDegat" value="1" readonly />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_poingMACaCBDegat" value="0" readonly />
                    </div>
                    <div class="midCol armeViolence">
                        <input class="nbre" type="number" name="attr_poingMACaCViolence" value="0" readonly />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_poingMACaCBViolence" value="1" readonly />
                    </div>
                    <div class="midCol armePortee">
                        <select name="attr_poingMACaCPortee">
                            <option value="Contact" data-i18n="portee-contact" selected>Contact</option>
                        </select>
                    </div>

                    <div class="lastCol armeCaracs">
                        <select name="attr_poingMACcaracteristique1Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <select name="attr_poingMACcaracteristique2Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <button class="rollDice" type="action" name="act_poingMAContact" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=@{poingMACaC}}} {{portee=^{portee} @{poingMACaCPortee}}}"></button>
                    </div>
                </div>
                <div class="bonus">
                    <div class="bonusCarac">
                        <select name="attr_poingMACcaracteristique3Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <select name="attr_poingMACcaracteristique4Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                    </div>
                </div>

                <div class="subMenu">
                    <button class="special" type="action" name="act_poingMACOptions_4" data-i18n="special">Spécial</button>
                </div>
                <div class="special">
                    <div class="triple">
                        <input type="hidden" name="attr_poingMACBDDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_poingMACBDDiversTotal" value="{{BDDivers=[[@{poingMACBDDiversD6}D6+@{poingMACBDDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-degats" title="Bonus aux dégâts"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_poingMACBDDiversD6" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_poingMACBDDiversFixe" value="0" />
                        </div>
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_poingMACBVDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_poingMACBVDiversTotal" value="{{BVDivers=[[@{poingMACBVDiversD6}D6+@{poingMACBVDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-violence" title="Bonus à la violence"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_poingMACBVDiversD6" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_poingMACBVDiversFixe" value="0" />
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="armesListe">
            <div class="armeSection1">
                <input class="subMenu" type="hidden" name="attr_pSContactOptions" value="0" />
                
                <div class="ligne">
                    <div class="firstCol armeNom">
                        <input type="text" name="attr_pSCaC" value="Couteau de Service" readonly />
                    </div>
                    <div class="midCol armeDegats">
                        <input class="nbre" type="number" name="attr_pSCaCDegat" value="1" readonly />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_pSCaCBDegat" value="0" readonly />
                    </div>
                    <div class="midCol armeViolence">
                        <input class="nbre" type="number" name="attr_pSCaCViolence" value="0" readonly />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_pSCaCBViolence" value="1" readonly />
                    </div>
                    <div class="midCol armePortee">
                        <select name="attr_pSCaCPortee">
                            <option value="^{portee-contact}" data-i18n="portee-contact" selected>Contact</option>
                        </select>
                    </div>
                    <div class="lastCol armeCaracs">
                        <select name="attr_pSCcaracteristique1Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <select name="attr_pSCcaracteristique2Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>

                        <button class="rollDice" type="action" name="act_pSContact" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=@{pSCaC}}} {{portee=^{portee} @{pSCaCPortee}}}"></button>
                    </div>
                </div>

                <div class="bonus">
                    <input class="deuxMains" type="hidden" name="attr_pSCdeuxMains" value="0" />
                    <input class="allegee" type="hidden" name="attr_pSCallegee" value="0" />

                    <label class="precis">
                        <span data-i18n="style-precis">Style Précis :</span>
                        <select name="attr_pSCcaracteristiqueSPrecis">
                            <option value="0" selected></option>
                            <option value="@{instinct}" data-i18n="instinct" >Instinct</option>
                            <option value="@{savoir}" data-i18n="savoir" >Savoir</option>
                            <option value="@{sf}" data-i18n="sang-froid" >Sang-Froid</option>
                            <option value="@{dexterite}" data-i18n="dexterite" >Dextérité</option>
                        </select>
                    </label>

                    <div class="bonusCarac">
                        <select name="attr_pSCcaracteristique3Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <select name="attr_pSCcaracteristique4Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                    </div>
                </div>

                <div class="subMenu">
                    <button class="effets" type="action" name="act_pSContactOptions_1" data-i18n="effets">Effets</button>
                    <button class="ameliorationsStructurelles BL" type="action" name="act_pSContactOptions_2" data-i18n="ameliorations-structurelles">Améliorations Structurelles</button>
                    <button class="ameliorationsArmes BL" type="action" name="act_pSContactOptions_3" data-i18n="ameliorations-d'ornement">Améliorations d'Ornement</button>
                    <button class="special BL" type="action" name="act_pSContactOptions_4" data-i18n="special">Spécial</button>
                </div>
                
                <div class="effets">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCantiAnatheme" value="{{antiAnathème=Anti Anathème}}" />
                        <span data-i18n-title="anti-anatheme" title="Anti Anathème"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCantiVehicule" value="{{antiVehicule=Anti Véhicule}} " />
                        <span data-i18n-title="anti-vehicule" title="Anti Véhicule"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCartillerie" value="{{artillerie=Artillerie}}" />
                        <span data-i18n-title="artillerie" title="Artillerie"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSCassassin" value="{{assassin=[[@{pSCassassinValue}d6]]}} " />
                            <span data-i18n-title="assassin" title="Assassin"></span>
                        </label>
                        
                        <input type="number" name="attr_pSCassassinValue" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCassistanceAttaque" value="{{assistanceAttaque=Assistance à l'attaque}}" />
                        <span data-i18n-title="assistance-attaque" title="Assistance à l'attaque"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSCbarrage" value="{{barrage=^{barrage} @{pSCbarrageValue}}} " />
                            <span data-i18n-title="barrage" title="Barrage"></span>
                        </label>
                    
                        <input type="number" name="attr_pSCbarrageValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSCcadence" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                            <span data-i18n-title="cadence" title="Cadence"></span>
                        </label>
                    
                        <input type="number" name="attr_pSCcadenceValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSCchargeur" value="{{chargeur=^{chargeur} @{pSCchargeurValue}}} " />
                            <span data-i18n-title="chargeur" title="Chargeur"></span>
                        </label>
                    
                        <input type="number" name="attr_pSCchargeurValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSCchoc" value="{{choc=^{choc} @{pSCchocValue}}}" />
                            <span data-i18n-title="choc" title="Choc"></span>
                        </label>
                    
                        <input type="number" name="attr_pSCchocValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSCdefense" value="{{defense=^{defense} @{pSCdefenseValue}}}" />
                            <span data-i18n-title="defense" title="Défense"></span>
                        </label>
                    
                        <input type="number" name="attr_pSCdefenseValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSCdegatContinue" value="{{degatContinus=^{degats-continus} @{pSCdegatContinueValue} ([[1D6]] ^{tours})}}" />
                            <span data-i18n-title="degats-continus" title="Dégâts Continus"></span>
                        </label>
                    
                        <input type="number" name="attr_pSCdegatContinueValue" size="2" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCdeuxMains" value="{{deuxMains=Deux Mains}}" />
                        <span data-i18n-title="deux-mains" title="Deux Mains"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCdemoralisant" value="{{demoralisant=Démoralisant}}" />
                        <span data-i18n-title="demoralisant" title="Démoralisant"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCdesignation" value="{{designation=Désignation}}" />
                        <span data-i18n-title="designation" title="Désignation"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCdestructeur" value="{{destructeur=[[2D6]]}}" />
                        <span data-i18n-title="destructeur" title="Destructeur"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSCdispersion" value="{{dispersion=^{dispersion} @{pSCdispersionValue}}} " />
                            <span data-i18n-title="dispersion" title="Dispersion"></span>
                        </label>
                    
                        <input type="number" name="attr_pSCdispersionValue" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCenChaine" value="{{enChaine=En Chaîne}}" />
                        <span data-i18n-title="en-chaine" title="En Chaîne"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCesperance" value="{{esperance=Espérance}}" />
                        <span data-i18n-title="esperance" title="Espérance"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCfureur" value="{{fureur=[[4D6]]}}" />
                        <span data-i18n-title="fureur" title="Fureur"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCignoreArmure" value="{{ignoreArmure=Ignore Armure}}" />
                        <span data-i18n-title="ignore-armure" title="Ignore Armure"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCignoreCdF" value="{{ignoreCdF=Ignore Champs de Force}}" />
                        <span data-i18n-title="ignore-champ-de-force" title="Ignore CdF"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCakimbo" value="2" />
                        <span data-i18n-title="jumele-akimbo" title="Jumelé (Akimbo)"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCambidextrie" value="2" />
                        <span data-i18n-title="jumele-ambidextrie" title="Jumelé (Ambidextrie)"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCleste" value="{{leste=[[@{force}]]}}" />
                        <span data-i18n-title="leste" title="Lesté"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSClourd" value="1" />
                        <span data-i18n-title="lourd" title="Lourd"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSClumiere" value="{{lumiere=^{lumiere} @{pSClumiereValue}}}" />
                            <span data-i18n-title="lumiere" title="Lumière"></span>
                        </label>
                    
                        <input type="number" name="attr_pSClumiereValue" size="2" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCmeurtrier" value="{{meurtrier=[[2D6]]}}" />
                        <span data-i18n-title="meurtrier" title="Meurtrier"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCobliteration" value="{{obliteration=Oblitération}}" />
                        <span data-i18n-title="obliteration" title="Oblitération"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCorfevrerie" value="{{orfevrerie=[[@{dexterite}+@{dextOD}]]}} {{orfevrerieWarrior=[[@{dexterite}+@{dextOD}+@{warriorScoutA}]]}}" />
                        <span data-i18n-title="orfevrerie" title="Orfèvrerie"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSCparasitage" value="{{parasitage=^{parasitage} @{pSCparasitageValue}}}" />
                            <span data-i18n-title="parasitage" title="Parasitage"></span>
                        </label>
                    
                        <input type="number" name="attr_pSCparasitageValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSCpenetrant" value="{{penetrant=^{penetrant} @{pSCpenetrantValue}}}" />
                            <span data-i18n-title="penetrant" title="Pénétrant"></span>
                        </label>
                    
                        <input type="number" name="attr_pSCpenetrantValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSCperceArmure" value="{{perceArmure=^{perce-armure} @{pSCperceArmureValue}}}" />
                            <span data-i18n-title="perce-armure" title="Perce Armure"></span>
                        </label>
                    
                        <input type="number" name="attr_pSCperceArmureValue" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCprecision" value="{{precision=[[@{tir}+@{tirOD}]]}} {{precisionWarrior=[[@{tir}+@{tirOD}+@{warriorScholarA}]]}}" />
                        <span data-i18n-title="precision" title="Précision"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSCreaction" value="{{reaction=^{reaction} @{pSCreactionValue}}}" />
                            <span data-i18n-title="reaction" title="Réaction"></span>
                        </label>
                    
                        <input type="number" name="attr_pSCreactionValue" value="0" />
                    </div>
                    <label class="simple fakeButton checked">
                        <span data-i18n-title="silencieux" title="Silencieux"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCsoumission" value="{{soumission=Soumission}}" />
                        <span data-i18n-title="soumission" title="Soumission"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCtenebricite" value="{{tenebricide=Ténébricide}}" />
                        <span data-i18n-title="tenebricide" title="Ténébricide"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCtirRafale" value="{{tirRafale=Tir en Rafale}}" />
                        <span data-i18n-title="tir-rafale" title="Tir en Rafale"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCtirSecurite" value="3" />
                        <span data-i18n-title="tir-securite" title="Tir en Sécurité"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCultraViolence" value="{{ultraviolence=[[2D6]]}}" />
                        <span data-i18n-title="ultraviolence" title="Ultraviolence"></span>
                    </label>
                </div>
                <div class="ameliorationsStructurelles">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCagressive" value="{{ASAgressive=[[1d6]]}} {{ASAgressiveL=Agressive}}" />
                        <span data-i18n-title="agressive" title="Agressive"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCallegee" value="1" />
                        <span data-i18n-title="allegee" title="Allégée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCassassine" value="{{silencieux=Silencieux}} {{ASAssassineL=Assassine (Silencieux)}}" />
                        <span data-i18n-title="assassine" title="Assassine"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCbarbelee" value="{{meurtrier=[[2D6]]}} {{ASBarbeleeL=Barbelée (Meurtrier)}}" />
                        <span data-i18n-title="barbelee" title="Barbelée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCconnectee" value="{{ASConnecteeL=Connectée (Assistance à l'attaque)}}" />
                        <span data-i18n-title="connectee" title="Connectée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCelectrifiee" value="{{ASElectrifieeL=Électrifiée (Choc 1)}}" />
                        <span data-i18n-title="electrifiee" title="Électrifiée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCindestructible" value="{{ASIndestructibleL=Indestructible}}" />
                        <span data-i18n-title="indestructible" title="Indestructible"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCjumelle" value="2" />
                        <span data-i18n-title="jumelle" title="Jumelle"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSClumineuse" value="{{ASLumineuseL=Lumineuse (Lumière 2)}}" />
                        <span data-i18n-title="lumineuse" title="Lumineuse"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCmassive" value="{{ASMassiveL=Massive (Défense -1)}} {{ASMassiveD=[[@{force}]]}}" />
                        <span data-i18n-title="massive" title="Massive"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCprotectrice" value="2" />
                        <span data-i18n-title="protectrice" title="Protectrice"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCsoeur" value="2" />
                        <span data-i18n-title="soeur" title="Soeur"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCsournoise" value="{{orfevrerie=[[@{dexterite}+@{dextOD}]]}} {{orfevrerieWarrior=[[@{dexterite}+@{dextOD}+@{warriorScoutA}]]}} {{ASSournoiseL=Sournoise (Orfevrerie)}}" />
                        <span data-i18n-title="sournoise" title="Sournoise"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCsurmesure" value="{{ASSurMesureD=[[@{combat}+@{combOD}]]}} {{ASSurMesureDWarrior=[[@{combat}+@{combOD}+@{warriorHunterA}]]}} {{ASSurMesureWOD=[[@{combat}]]}} {{ASSurMesureL=Sur Mesure}}" />
                        <span data-i18n-title="sur-mesure" title="Sur Mesure"></span>
                    </label>
                </div>
                <div class="ameliorationsArmes">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCarabesquesIridescentes" value="{{AOArabesquesIridescentesL=Arabesques Iridescentes (Lumière +1)}}" />
                        <span data-i18n-title="arabesques-iridescentes" title="Arabesques iridescentes"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCarmeAzurine" value="{{AOArmeAzurineD=[[1D6]]}} {{AOArmeAzurineV=[[1D6]]}}" />
                        <span data-i18n-title="arme-azurine" title="Arme azurine"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCarmeRougeSang" value="{{AOArmeRougeSangD=[[1D6]]}} {{AOArmeRougeSangV=[[1D6]]}}" />
                        <span data-i18n-title="arme-rouge-sang" title="Arme rouge sang"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCarmureGravee" value="{{AOArmureGraveeL=Armure Gravée (CdF +2)}}" />
                        <span data-i18n-title="armure-gravee" title="Armure gravée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCblasonChevalier" value="{{AOBlasonChevalier=Blason du Chevalier}}" />
                        <span data-i18n-title="blason-chevalier" title="Blason du chevalier"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCbouclierGrave" value="{{AOBouclierGraveL=Bouclier Gravé (Défense +1)}}" />
                        <span data-i18n-title="bouclier-grave" title="Bouclier gravé"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCcheneSculpte" value="{{AOCheneSculpteD=[[2D6]]}}" />
                        <span data-i18n-title="chene-sculpte" title="Chêne sculpté"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCchromeeLignesLC" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                        <span data-i18n-title="chromee" title="Chromée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCcodeKnightGrave" value="{{AOCodeKnightGraveL=Code du Knight Gravé (-1 Perte d'Espoir)}}" />
                        <span data-i18n-title="code-knight-grave" title="Code du knight gravé"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCcraneRieurGrave" value="{{AOCraneRieurGraveL=Crâne Rieur Gravé (Oblitération)}}" />
                        <span data-i18n-title="crane-rieur-grave" title="Crâne rieur gravé"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCfaucheuseGravee" value="{{AOFaucheuseGraveeD=[[1D6]]}}" />
                        <span data-i18n-title="faucheuse-gravee" title="Faucheuse gravée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCfauconsPlumesL" value="{{AOFauconPL=Faucon et Plumes Luminescentes (Anti-Anathème)}}" />
                        <span data-i18n-title="faucon-plumes" title="Faucon et plumes"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCflammesStylisees" value="{{AOFlammesStyliseesV=[[1D6]]}}" />
                        <span data-i18n-title="flammes-stylisees" title="Flammes stylisées"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCgriffuresGravees" value="{{AOGriffuresGraveesD=[[1D6]]}} {{AOGriffuresGraveesV=[[1D6]]}}" />
                        <span data-i18n-title="griffures-gravees" title="Griffures gravées"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCmasqueBriseSculpte" value="{{AOMasqueBriseSculpteD=[[1D6]]}} {{AOMasqueBriseSculpteV=[[1D6]]}}" />
                        <span data-i18n-title="masque-brise-sculpte" title="Masque brisé sculpté"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCrouagesCassesGraves" value="{{AORouagesCassesGravesD=[[1D6]]}} {{AORouagesCassesGravesV=[[1D6]]}}" />
                        <span data-i18n-title="rouages-casses" title="Rouages cassés"></span>
                    </label>						
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCsillonsFLF" value="{{AOSillonsFLFD=[[3]]}}" />
                        <span data-i18n-title="sillons" title="Sillons"></span>
                    </label>
                </div>
                <div class="special">
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSCenergie" value="{{energie=@{pSCEnergieValue}}} " />
                            <span data-i18n-title="energie" title="Énergie"></span>
                        </label>
                    
                        <input type="number" name="attr_pSCEnergieValue" value="0" />
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_pSCBDDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSCBDDiversTotal" value="{{BDDivers=[[@{pSCBDDiversD6}D6+@{pSCBDDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-degats" title="Bonus aux dégâts"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_pSCBDDiversD6" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_pSCBDDiversFixe" value="0" />
                        </div>
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_pSCBVDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSCBVDiversTotal" value="{{BVDivers=[[@{pSCBVDiversD6}D6+@{pSCBVDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-violence" title="Bonus à la violence"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_pSCBVDiversD6" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_pSCBVDiversFixe" value="0" />
                        </div>
                    </div>
                </div>
            </div>

            <div class="armeSection2">
                <input class="subMenu" type="hidden" name="attr_mEContactOptions"value="0" />
                <div class="ligne">
                    <div class="firstCol armeNom">
                        <input type="text" name="attr_mECaC" value="Marteau-Épieu (Contact)" readonly />
                    </div>
                    <div class="midCol armeDegats">
                        <input class="nbre" type="number" name="attr_mECaCDegat" class="textCenter" value="3" readonly />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_mECaCBDegat" class="textCenter" value="0" readonly />
                    </div>
                    <div class="midCol armeViolence">
                        <input class="nbre" type="number" name="attr_mECaCViolence" class="textCenter" value="1" readonly />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_mECaCBViolence" class="textCenter" value="0" readonly />
                    </div>
                    <div class="midCol armePortee">
                        <select name="attr_mECaCPortee">
                            <option value="{^portee-contact}" data-i18n="portee-contact" selected>Contact</option>
                        </select>
                    </div>
                    <div class="lastCol armeCaracs">
                        <select name="attr_mECcaracteristique1Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <select name="attr_mECcaracteristique2Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                    
                        <!-- Le bouton du jet -->
                        <button class="rollDice" type="action" name="act_mEContact" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=@{mECaC}}} {{portee=^{portee} @{mECaCPortee}}}"></button>
                    </div>
                </div>

                <div class="bonus">
                    <input class="deuxMains" type="hidden" name="attr_mECdeuxMains" value="0" />
                    <input class="allegee" type="hidden" name="attr_mECallegee" value="0" />

                    <label class="precis">
                        <span>Style Précis :</span>
                        <select name="attr_mECcaracteristiqueSPrecis">
                            <option value="0" selected></option>
                            <option value="@{instinct}" data-i18n="instinct" >Instinct</option>
                            <option value="@{savoir}" data-i18n="savoir" >Savoir</option>
                            <option value="@{sf}" data-i18n="sang-froid" >Sang-Froid</option>
                            <option value="@{dexterite}" data-i18n="dexterite" >Dextérité</option>
                        </select>
                    </label>
                    
                    <div class="bonusCarac">
                        <select name="attr_mECcaracteristique3Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <select name="attr_mECcaracteristique4Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                    </div>
                </div>

                <div class="subMenu">
                    <button class="effets" type="action" name="act_mEContactOptions_1" data-i18n="effets">Effets</button>
                    <button class="ameliorationsStructurelles BL" type="action" name="act_mEContactOptions_2" data-i18n="ameliorations-structurelles">Améliorations Structurelles</button>
                    <button class="ameliorationsArmes BL" type="action" name="act_mEContactOptions_3" data-i18n="ameliorations-d'ornement">Améliorations d'Ornement</button>
                    <button class="special BL" type="action" name="act_mEContactOptions_4" data-i18n="special">Spécial</button>
                </div>
                
                <div class="effets">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECantiAnatheme" value="{{antiAnathème=Anti Anathème}}" />
                        <span data-i18n-title="anti-anatheme" title="Anti Anathème"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECantiVehicule" value="{{antiVehicule=Anti Véhicule}} " />
                        <span data-i18n-title="anti-vehicule" title="Anti Véhicule"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECartillerie" value="{{artillerie=Artillerie}}" />
                        <span data-i18n-title="artillerie" title="Artillerie"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mECassassin" value="{{assassin=[[@{mECassassinValue}d6]]}} " />
                            <span data-i18n-title="assassin" title="Assassin"></span>
                        </label>
                    
                        <input type="number" name="attr_mECassassinValue" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECassistanceAttaque" value="{{assistanceAttaque=Assistance à l'attaque}}" />
                        <span data-i18n-title="assistance-attaque" title="Assistance à l'attaque"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mECbarrage" value="{{barrage=^{barrage} @{mECbarrageValue}}} " />
                            <span data-i18n-title="barrage" title="Barrage"></span>
                        </label>
                    
                        <input type="number" name="attr_mECbarrageValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mECcadence" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                            <span data-i18n-title="cadence" title="Cadence"></span>
                        </label>
                    
                        <input type="number" name="attr_mECcadenceValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mECchargeur" value="{{chargeur=^{chargeur} @{mECchargeurValue}}} " />
                            <span data-i18n-title="chargeur" title="Chargeur"></span>
                        </label>
                    
                        <input type="number" name="attr_mECchargeurValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mECchoc" value="{{choc=^{choc} @{mECchocValue}}}" />
                            <span data-i18n-title="choc" title="Choc"></span>
                        </label>
                    
                        <input type="number" name="attr_mECchocValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mECdefense" value="{{defense=^{defense} @{mECdefenseValue}}}" />
                            <span data-i18n-title="defense" title="Défense"></span>
                        </label>
                    
                        <input type="number" name="attr_mECdefenseValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mECdegatContinue" value="{{degatContinus=^{degats-continus} @{mECdegatContinueValue} ([[1D6]] ^{tours})}}" />
                            <span data-i18n-title="degats-continus" title="Dégâts Continus"></span>
                        </label>
                    
                        <input type="number" name="attr_mECdegatContinueValue" size="2" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECdeuxMains" value="{{deuxMains=Deux Mains}}" />
                        <span data-i18n-title="deux-mains" title="Deux Mains"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECdemoralisant" value="{{demoralisant=Démoralisant}}" />
                        <span data-i18n-title="demoralisant" title="Démoralisant"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECdesignation" value="{{designation=Désignation}}" />
                        <span data-i18n-title="designation" title="Désignation"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECdestructeur" value="{{destructeur=[[2D6]]}}" />
                        <span data-i18n-title="destructeur" title="Destructeur"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mECdispersion" value="{{dispersion=^{dispersion} @{mECdispersionValue}}} " />
                            <span data-i18n-title="dispersion" title="Dispersion"></span>
                        </label>
                    
                        <input type="number" name="attr_mECdispersionValue" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECenChaine" value="{{enChaine=En Chaîne}}" />
                        <span data-i18n-title="en-chaine" title="En Chaîne"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECesperance" value="{{esperance=Espérance}}" />
                        <span data-i18n-title="esperance" title="Espérance"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECfureur" value="{{fureur=[[4D6]]}}" />
                        <span data-i18n-title="fureur" title="Fureur"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECignoreArmure" value="{{ignoreArmure=Ignore Armure}}" />
                        <span data-i18n-title="ignore-armure" title="Ignore Armure"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECignoreCdF" value="{{ignoreCdF=Ignore Champs de Force}}" />
                        <span data-i18n-title="ignore-champ-de-force" title="Ignore CdF"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECakimbo" value="2" />
                        <span data-i18n-title="jumele-akimbo" title="Jumelé (Akimbo)"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECambidextrie" value="2" />
                        <span data-i18n-title="jumele-ambidextrie" title="Jumelé (Ambidextrie)"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECleste" value="{{leste=[[@{force}]]}}" />
                        <span data-i18n-title="leste" title="Lesté"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEClourd" value="1" />
                        <span data-i18n-title="lourd" title="Lourd"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mEClumiere" value="{{lumiere=^{lumiere} @{mEClumiereValue}}}" />
                            <span data-i18n-title="lumiere" title="Lumière"></span>
                        </label>
                    
                        <input type="number" name="attr_mEClumiereValue" size="2" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECmeurtrier" value="{{meurtrier=[[2D6]]}}" />
                        <span data-i18n-title="meutrier" title="Meurtrier"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECobliteration" value="{{obliteration=Oblitération}}" />
                        <span data-i18n-title="obliteration" title="Oblitération"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECorfevrerie" value="{{orfevrerie=[[@{dexterite}+@{dextOD}]]}} {{orfevrerieWarrior=[[@{dexterite}+@{dextOD}+@{warriorScoutA}]]}}" />
                        <span data-i18n-title="orfevrerie" title="Orfèvrerie"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mECparasitage" value="{{parasitage=^{parasitage} @{mECparasitageValue}}}" />
                            <span data-i18n-title="parasitage" title="Parasitage"></span>
                        </label>
                    
                        <input type="number" name="attr_mECparasitageValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mECpenetrant" value="{{penetrant=^{penetrant} @{mECpenetrantValue}}}" />
                            <span data-i18n-title="penetrant" title="Pénétrant"></span>
                        </label>
                    
                        <input type="number" name="attr_mECpenetrantValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton checked">
                            <span data-i18n-title="perce-armure" title="Perce Armure"></span>
                        </label>
                    
                        <input type="number" name="attr_mECperceArmureValue" value="40" disabled />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECprecision" value="{{precision=[[@{tir}+@{tirOD}]]}} {{precisionWarrior=[[@{tir}+@{tirOD}+@{warriorScholarA}]]}}" />
                        <span data-i18n-title="precision" title="Précision"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mECreaction" value="{{reaction=^{reaction} @{mECreactionValue}}}" />
                            <span data-i18n-title="reaction" title="Réaction"></span>
                        </label>
                    
                        <input type="number" name="attr_mECreactionValue" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECsilencieux" value="{{silencieux=Silencieux}}" />
                        <span data-i18n-title="silencieux" title="Silencieux"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECsoumission" value="{{soumission=Soumission}}" />
                        <span data-i18n-title="soumission" title="Soumission"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECtenebricite" value="{{tenebricide=Ténébricide}}" />
                        <span data-i18n-title="tenebricide" title="Ténébricide"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECtirRafale" value="{{tirRafale=Tir en Rafale}}" />
                        <span data-i18n-title="tir-rafale" title="Tir en Rafale"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECtirSecurite" value="3" />
                        <span data-i18n-title="tir-securite" title="Tir en Sécurité"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECultraViolence" value="{{ultraviolence=[[2D6]]}}" />
                        <span data-i18n-title="ultraviolence" title="Ultraviolence"></span>
                    </label>
                </div>
                <div class="ameliorationsStructurelles">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECagressive" value="{{ASAgressive=[[1d6]]}} {{ASAgressiveL=Agressive}}" />
                        <span data-i18n-title="agressive" title="Agressive"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECallegee" value="1" />
                        <span data-i18n-title="allegee" title="Allégée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECassassine" value="{{silencieux=Silencieux}} {{ASAssassineL=Assassine (Silencieux)}}" />
                        <span data-i18n-title="assassine" title="Assassine"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECbarbelee" value="{{meurtrier=[[2D6]]}} {{ASBarbeleeL=Barbelée (Meurtrier)}}" />
                        <span data-i18n-title="barbelee" title="Barbelée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECconnectee" value="{{ASConnecteeL=Connectée (Assistance à l'attaque)}}" />
                        <span data-i18n-title="connectee" title="Connectée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECelectrifiee" value="{{ASElectrifieeL=Électrifiée (Choc 1)}}" />
                        <span data-i18n-title="electrifiee" title="Électrifiée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECindestructible" value="{{ASIndestructibleL=Indestructible}}" />
                        <span data-i18n-title="indestructible" title="Indestructible"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECjumelle" value="2" />
                        <span data-i18n-title="jumelle" title="Jumelle"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEClumineuse" value="{{ASLumineuseL=Lumineuse (Lumière 2)}}" />
                        <span data-i18n-title="lumineuse" title="Lumineuse"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECmassive" value="{{ASMassiveL=Massive (Défense -1)}} {{ASMassiveD=[[@{force}]]}}" />
                        <span data-i18n-title="massive" title="Massive"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECprotectrice" value="2" />
                        <span data-i18n-title="protectrice" title="Protectrice"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECsoeur" value="2" />
                        <span data-i18n-title="soeur" title="Soeur"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECsournoise" value="{{orfevrerie=[[@{dexterite}+@{dextOD}]]}} {{orfevrerieWarrior=[[@{dexterite}+@{dextOD}+@{warriorScoutA}]]}} {{ASSournoiseL=Sournoise (Orfevrerie)}}" />
                        <span data-i18n-title="sournoise" title="Sournoise"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECsurmesure" value="{{ASSurMesureD=[[@{combat}+@{combOD}]]}} {{ASSurMesureDWarrior=[[@{combat}+@{combOD}+@{warriorHunterA}]]}} {{ASSurMesureWOD=[[@{combat}]]}} {{ASSurMesureL=Sur Mesure}}" />
                        <span data-i18n-title="sur-mesure" title="Sur Mesure"></span>
                    </label>
                </div>
                <div class="ameliorationsArmes">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECarabesquesIridescentes" value="{{AOArabesquesIridescentesL=Arabesques Iridescentes (Lumière +1)}}" />
                        <span data-i18n-title="arabesques-iridescentes" title="Arabesques iridescentes"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECarmeAzurine" value="{{AOArmeAzurineD=[[1D6]]}} {{AOArmeAzurineV=[[1D6]]}}" />
                        <span data-i18n-title="arme-azurine" title="Arme azurine"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECarmeRougeSang" value="{{AOArmeRougeSangD=[[1D6]]}} {{AOArmeRougeSangV=[[1D6]]}}" />
                        <span data-i18n-title="arme-rouge-sang" title="Arme rouge sang"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECarmureGravee" value="{{AOArmureGraveeL=Armure Gravée (CdF +2)}}" />
                        <span data-i18n-title="armure-gravee" title="Armure gravée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECblasonChevalier" value="{{AOBlasonChevalier=Blason du Chevalier}}" />
                        <span data-i18n-title="blason-chevalier" title="Blason du chevalier"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECbouclierGrave" value="{{AOBouclierGraveL=Bouclier Gravé (Défense +1)}}" />
                        <span data-i18n-title="bouclier-grave" title="Bouclier gravé"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECcheneSculpte" value="{{AOCheneSculpteD=[[2D6]]}}" />
                        <span data-i18n-title="chene-sculpte" title="Chêne sculpté"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECchromeeLignesLC" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                        <span data-i18n-title="chromee" title="Chromée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECcodeKnightGrave" value="{{AOCodeKnightGraveL=Code du Knight Gravé (-1 Perte d'Espoir)}}" />
                        <span data-i18n-title="code-knight-grave" title="Code du knight gravé"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECcraneRieurGrave" value="{{AOCraneRieurGraveL=Crâne Rieur Gravé (Oblitération)}}" />
                        <span data-i18n-title="crane-rieur-grave" title="Crâne rieur gravé"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECfaucheuseGravee" value="{{AOFaucheuseGraveeD=[[1D6]]}}" />
                        <span data-i18n-title="faucheuse-gravee" title="Faucheuse gravée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECfauconsPlumesL" value="{{AOFauconPL=Faucon et Plumes Luminescentes (Anti-Anathème)}}" />
                        <span data-i18n-title="faucon-plumes" title="Faucon et plumes"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECflammesStylisees" value="{{AOFlammesStyliseesV=[[1D6]]}}" />
                        <span data-i18n-title="flammes-stylisees" title="Flammes stylisées"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECgriffuresGravees" value="{{AOGriffuresGraveesD=[[1D6]]}} {{AOGriffuresGraveesV=[[1D6]]}}" />
                        <span data-i18n-title="griffures-gravees" title="Griffures gravées"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECmasqueBriseSculpte" value="{{AOMasqueBriseSculpteD=[[1D6]]}} {{AOMasqueBriseSculpteV=[[1D6]]}}" />
                        <span data-i18n-title="masque-brise-sculpte" title="Masque brisé sculpté"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECrouagesCassesGraves" value="{{AORouagesCassesGravesD=[[1D6]]}} {{AORouagesCassesGravesV=[[1D6]]}}" />
                        <span data-i18n-title="rouages-casses" title="Rouages cassés"></span>
                    </label>						
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECsillonsFLF" value="{{AOSillonsFLFD=[[3]]}}" />
                        <span data-i18n-title="sillons" title="Sillons"></span>
                    </label>
                </div>
                <div class="special">
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mECenergie" value="{{energie=@{mECEnergieValue}}} " />
                            <span data-i18n-title="energie" title="Énergie"></span>
                        </label>
                    
                        <input type="number" name="attr_mECEnergieValue" value="0" />
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_mECBDDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mECBDDiversTotal" value="{{BDDivers=[[@{mECBDDiversD6}D6+@{mECBDDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-degats" title="Bonus aux dégâts"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_mECBDDiversD6" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_mECBDDiversFixe" value="0" />
                        </div>
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_mECBVDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mECBVDiversTotal" value="{{BVDivers=[[@{mECBVDiversD6}D6+@{mECBVDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-violence" title="Bonus à la violence"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_mECBVDiversD6" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_mECBVDiversFixe" value="0" />
                        </div>
                    </div>
                </div>
            </div>

            <fieldset class="repeating_armeCaC">
                <input class="subMenu" type="hidden" name="attr_armeContactOptions" value="0">

                <div class="ligne">
                    <div class="firstCol armeNom">
                        <input type="text" name="attr_ArmeCaC" />
                    </div>

                    <div class="midCol armeDegats">
                        <input class="nbre" type="number" name="attr_armeCaCDegat" value="0" />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_armeCaCBDegat" value="0" />
                    </div>
                    <div class="midCol armeViolence">
                        <input class="nbre" type="number" name="attr_armeCaCViolence" value="0" />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_armeCaCBViolence" value="0" />
                    </div>
                    <div class="midCol armePortee">
                        <select name="attr_armeCaCPortee">
                            <option value="^{portee-contact}" data-i18n="portee-contact" selected>Contact</option>
                            <option value="^{portee-courte}" data-i18n="portee-courte">Courte</option>
                            <option value="^{portee-moyenne}" data-i18n="portee-moyenne">Moyenne</option>
                            <option value="^{portee-longue}" data-i18n="portee-longue">Longue</option>
                            <option value="^{portee-lointaine}" data-i18n="portee-lointaine">Lointaine</option>
                        </select>
                    </div>

                    <div class="lastCol armeCaracs">
                        <select name="attr_caracteristique1Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <select name="attr_caracteristique2Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <button class="rollDice" type="action" name="act_armecontact" value="@{jetGM} &{template:combat} {{Nom=@{name}}}"></button>
                    </div>
                </div>
                <div class="bonus">
                    <input class="deuxMains" type="hidden" name="attr_deuxMains" value="0" />
                    <input class="allegee" type="hidden" name="attr_allegee" value="0" />
                    <label class="precis">
                        <span>Style Précis :</span>
                        <select name="attr_caracteristiqueSPrecis">
                            <option value="0" selected></option>
                            <option value="@{instinct}" data-i18n="instinct" >Instinct</option>
                            <option value="@{savoir}" data-i18n="savoir" >Savoir</option>
                            <option value="@{sf}" data-i18n="sang-froid" >Sang-Froid</option>
                            <option value="@{dexterite}" data-i18n="dexterite" >Dextérité</option>
                        </select>
                    </label>
                
                    <div class="bonusCarac">
                        <select name="attr_caracteristique3Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <select name="attr_caracteristique4Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                    </div>
                </div>
                <div class="subMenu">
                    <button class="effets" type="action" name="act_armecontactoptions-1" data-i18n="effets">Effets</button>
                    <button class="ameliorationsStructurelles BL" type="action" name="act_armecontactoptions-2" data-i18n="ameliorations-structurelles">Améliorations Structurelles</button>
                    <button class="ameliorationsArmes BL" type="action" name="act_armecontactoptions-3" data-i18n="ameliorations-d'ornement">Améliorations d'Ornement</button>
                    <button class="special BL" type="action" name="act_armecontactoptions-4" data-i18n="special">Spécial</button>
                </div>

                <div class="effets">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_antiAnatheme" value="{{antiAnathème=Anti Anathème}}" />
                        <span data-i18n-title="anti-anatheme" title="Anti Anathème"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_antiVehicule" value="{{antiVehicule=Anti Véhicule}} " />
                        <span data-i18n-title="anti-vehicule" title="Anti Véhicule"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_artillerie" value="{{artillerie=Artillerie}}" />
                        <span data-i18n-title="artillerie" title="Artillerie"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_assassin" value="{{assassin=[[@{assassinValue}d6]]}} " />
                            <span data-i18n-title="assassin" title="Assassin"></span>
                        </label>
                    
                        <input type="number" name="attr_assassinValue" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_assistanceAttaque" value="{{assistanceAttaque=Assistance à l'attaque}}" />
                        <span data-i18n-title="assistance-attaque" title="Assistance à l'attaque"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_barrage" value="{{barrage=^{barrage} @{barrageValue}}} " />
                            <span data-i18n-title="barrage" title="Barrage"></span>
                        </label>
                    
                        <input type="number" name="attr_barrageValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_cadence" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                            <span data-i18n-title="cadence" title="Cadence"></span>
                        </label>
                    
                        <input type="number" name="attr_cadenceValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_chargeur" value="{{chargeur=^{chargeur} @{chargeurValue}}} " />
                            <span data-i18n-title="chargeur" title="Chargeur"></span>
                        </label>
                    
                        <input type="number" name="attr_chargeurValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_choc" value="{{choc=^{choc} @{chocValue}}}" />
                            <span data-i18n-title="choc" title="Choc"></span>
                        </label>
                    
                        <input type="number" name="attr_chocValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_defense" value="{{defense=^{defense} @{defenseValue}}}" />
                            <span data-i18n-title="defense" title="Défense"></span>
                        </label>
                    
                        <input type="number" name="attr_defenseValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_degatContinue" value="{{degatContinus=^{degats-continus} @{degatContinueValue} ([[1D6]] ^{tours})}}" />
                            <span data-i18n-title="degats-continus" title="Dégâts Continus"></span>
                        </label>
                    
                        <input type="number" name="attr_degatContinueValue" size="2" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_deuxMains" value="{{deuxMains=Deux Mains}}" />
                        <span data-i18n-title="deux-mains" title="Deux Mains"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_demoralisant" value="{{demoralisant=Démoralisant}}" />
                        <span data-i18n-title="demoralisant" title="Démoralisant"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_designation" value="{{designation=Désignation}}" />
                        <span data-i18n-title="designation" title="Désignation"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_destructeur" value="{{destructeur=[[2D6]]}}" />
                        <span data-i18n-title="destructeur" title="Destructeur"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_dispersion" value="{{dispersion=^{dispersion} @{dispersionValue}}} " />
                            <span data-i18n-title="dispersion" title="Dispersion"></span>
                        </label>
                    
                        <input type="number" name="attr_dispersionValue" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_enChaine" value="{{enChaine=En Chaîne}}" />
                        <span data-i18n-title="en-chaine" title="En Chaîne"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_esperance" value="{{esperance=Espérance}}" />
                        <span data-i18n-title="esperance" title="Espérance"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_fureur" value="{{fureur=[[4D6]]}}" />
                        <span data-i18n-title="fureur" title="Fureur"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ignoreArmure" value="{{ignoreArmure=Ignore Armure}}" />
                        <span data-i18n-title="ignore-armure" title="Ignore Armure"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ignoreCdF" value="{{ignoreCdF=Ignore Champs de Force}}" />
                        <span data-i18n-title="ignore-champ-de-force" title="Ignore CdF"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_akimbo" value="2" />
                        <span data-i18n-title="jumele-akimbo" title="Jumelé (Akimbo)"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ambidextrie" value="2" />
                        <span data-i18n-title="jumele-ambidextrie" title="Jumelé (Ambidextrie)"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_leste" value="{{leste=[[@{force}]]}}" />
                        <span data-i18n-title="leste" title="Lesté"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_lourd" value="1" />
                        <span data-i18n-title="lourd" title="Lourd"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_lumiere" value="{{lumiere=^{lumiere} @{lumiereValue}}}" />
                            <span data-i18n-title="lumiere" title="Lumière"></span>
                        </label>
                    
                        <input type="number" name="attr_lumiereValue" size="2" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_meurtrier" value="{{meurtrier=[[2D6]]}}" />
                        <span data-i18n-title="meutrier" title="Meurtrier"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_obliteration" value="{{obliteration=Oblitération}}" />
                        <span data-i18n-title="obliteration" title="Oblitération"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_orfevrerie" value="{{orfevrerie=[[@{dexterite}+@{dextOD}]]}} {{orfevrerieWarrior=[[@{dexterite}+@{dextOD}+@{warriorScoutA}]]}}" />
                        <span data-i18n-title="orfevrerie" title="Orfèvrerie"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_parasitage" value="{{parasitage=^{parasitage} @{parasitageValue}}}" />
                            <span data-i18n-title="parasitage" title="Parasitage"></span>
                        </label>
                    
                        <input type="number" name="attr_parasitageValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_penetrant" value="{{penetrant=^{penetrant} @{penetrantValue}}}" />
                            <span data-i18n-title="penetrant" title="Pénétrant"></span>
                        </label>
                    
                        <input type="number" name="attr_penetrantValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_perceArmure" value="{{perceArmure=^{perce-armure} @{perceArmureValue}}}" />
                            <span data-i18n-title="perce-armure" title="Perce Armure"></span>
                        </label>
                    
                        <input type="number" name="attr_perceArmureValue" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_precision" value="{{precision=[[@{tir}+@{tirOD}]]}} {{precisionWarrior=[[@{tir}+@{tirOD}+@{warriorScholarA}]]}}" />
                        <span data-i18n-title="precision" title="Précision"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_reaction" value="{{reaction=^{reaction} @{reactionValue}}}" />
                            <span data-i18n-title="reaction" title="Réaction"></span>
                        </label>
                    
                        <input type="number" name="attr_reactionValue" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_silencieux" value="{{silencieux=Silencieux}}" />
                        <span data-i18n-title="silencieux" title="Silencieux"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_soumission" value="{{soumission=Soumission}}" />
                        <span data-i18n-title="soumission" title="Soumission"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_tenebricite" value="{{tenebricide=Ténébricide}}" />
                        <span data-i18n-title="tenebricide" title="Ténébricide"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_tirRafale" value="{{tirRafale=Tir en Rafale}}" />
                        <span data-i18n-title="tir-rafale" title="Tir en Rafale"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_tirSecurite" value="3" />
                        <span data-i18n-title="tir-securite" title="Tir en Sécurité"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ultraViolence" value="{{ultraviolence=[[2D6]]}}" />
                        <span data-i18n-title="ultraviolence" title="Ultraviolence"></span>
                    </label>
                </div>
                <div class="ameliorationsStructurelles">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_agressive" value="{{ASAgressive=[[1d6]]}} {{ASAgressiveL=Agressive}}" />
                        <span data-i18n-title="agressive" title="Agressive"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_allegee" value="1" />
                        <span data-i18n-title="allegee" title="Allégée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_assassine" value="{{silencieux=Silencieux}} {{ASAssassineL=Assassine (Silencieux)}}" />
                        <span data-i18n-title="assassine" title="Assassine"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_barbelee" value="{{meurtrier=[[2D6]]}} {{ASBarbeleeL=Barbelée (Meurtrier)}}" />
                        <span data-i18n-title="barbelee" title="Barbelée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_connectee" value="{{ASConnecteeL=Connectée (Assistance à l'attaque)}}" />
                        <span data-i18n-title="connectee" title="Connectée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_electrifiee" value="{{ASElectrifieeL=Électrifiée (Choc 1)}}" />
                        <span data-i18n-title="electrifiee" title="Électrifiée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_indestructible" value="{{ASIndestructibleL=Indestructible}}" />
                        <span data-i18n-title="indestructible" title="Indestructible"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_jumelle" value="2" />
                        <span data-i18n-title="jumelle" title="Jumelle"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_lumineuse" value="{{ASLumineuseL=Lumineuse (Lumière 2)}}" />
                        <span data-i18n-title="lumineuse" title="Lumineuse"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_massive" value="{{ASMassiveL=Massive (Défense -1)}} {{ASMassiveD=[[@{force}]]}}" />
                        <span data-i18n-title="massive" title="Massive"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_protectrice" value="2" />
                        <span data-i18n-title="protectrice" title="Protectrice"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_soeur" value="2" />
                        <span data-i18n-title="soeur" title="Soeur"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_sournoise" value="{{orfevrerie=[[@{dexterite}+@{dextOD}]]}} {{orfevrerieWarrior=[[@{dexterite}+@{dextOD}+@{warriorScoutA}]]}} {{ASSournoiseL=Sournoise (Orfevrerie)}}" />
                        <span data-i18n-title="sournoise" title="Sournoise"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_surmesure" value="{{ASSurMesureD=[[@{combat}+@{combOD}]]}} {{ASSurMesureDWarrior=[[@{combat}+@{combOD}+@{warriorHunterA}]]}} {{ASSurMesureWOD=[[@{combat}]]}} {{ASSurMesureL=Sur Mesure}}" />
                        <span data-i18n-title="sur-mesure" title="Sur Mesure"></span>
                    </label>
                </div>
                <div class="ameliorationsArmes">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_arabesquesIridescentes" value="{{AOArabesquesIridescentesL=Arabesques Iridescentes (Lumière +1)}}" />
                        <span data-i18n-title="arabesques-iridescentes" title="Arabesques iridescentes"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_armeAzurine" value="{{AOArmeAzurineD=[[1D6]]}} {{AOArmeAzurineV=[[1D6]]}}" />
                        <span data-i18n-title="arme-azurine" title="Arme azurine"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_armeRougeSang" value="{{AOArmeRougeSangD=[[1D6]]}} {{AOArmeRougeSangV=[[1D6]]}}" />
                        <span data-i18n-title="arme-rouge-sang" title="Arme rouge sang"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_armureGravee" value="{{AOArmureGraveeL=Armure Gravée (CdF +2)}}" />
                        <span data-i18n-title="armure-gravee" title="Armure gravée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_blasonChevalier" value="{{AOBlasonChevalier=Blason du Chevalier}}" />
                        <span data-i18n-title="blason-chevalier" title="Blason du chevalier"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_bouclierGrave" value="{{AOBouclierGraveL=Bouclier Gravé (Défense +1)}}" />
                        <span data-i18n-title="bouclier-grave" title="Bouclier gravé"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_cheneSculpte" value="{{AOCheneSculpteD=[[2D6]]}}" />
                        <span data-i18n-title="chene-sculpte" title="Chêne sculpté"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_chromeeLignesLC" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                        <span data-i18n-title="chromee" title="Chromée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_codeKnightGrave" value="{{AOCodeKnightGraveL=Code du Knight Gravé (-1 Perte d'Espoir)}}" />
                        <span data-i18n-title="code-knight-grave" title="Code du knight gravé"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_craneRieurGrave" value="{{AOCraneRieurGraveL=Crâne Rieur Gravé (Oblitération)}}" />
                        <span data-i18n-title="crane-rieur-grave" title="Crâne rieur gravé"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_faucheuseGravee" value="{{AOFaucheuseGraveeD=[[1D6]]}}" />
                        <span data-i18n-title="faucheuse-gravee" title="Faucheuse gravée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_fauconsPlumesL" value="{{AOFauconPL=Faucon et Plumes Luminescentes (Anti-Anathème)}}" />
                        <span data-i18n-title="faucon-plumes" title="Faucon et plumes"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_flammesStylisees" value="{{AOFlammesStyliseesV=[[1D6]]}}" />
                        <span data-i18n-title="flammes-stylisees" title="Flammes stylisées"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_griffuresGravees" value="{{AOGriffuresGraveesD=[[1D6]]}} {{AOGriffuresGraveesV=[[1D6]]}}" />
                        <span data-i18n-title="griffures-gravees" title="Griffures gravées"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_masqueBriseSculpte" value="{{AOMasqueBriseSculpteD=[[1D6]]}} {{AOMasqueBriseSculpteV=[[1D6]]}}" />
                        <span data-i18n-title="masque-brise-sculpte" title="Masque brisé sculpté"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_rouagesCassesGraves" value="{{AORouagesCassesGravesD=[[1D6]]}} {{AORouagesCassesGravesV=[[1D6]]}}" />
                        <span data-i18n-title="rouages-casses" title="Rouages cassés"></span>
                    </label>						
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_sillonsFLF" value="{{AOSillonsFLFD=[[3]]}}" />
                        <span data-i18n-title="sillons" title="Sillons"></span>
                    </label>
                </div>
                <div class="special">
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_energie" value="{{energie=@{energieValue}}} " />
                            <span data-i18n-title="energie" title="Énergie"></span>
                        </label>
                    
                        <input type="number" name="attr_energieValue" value="0" />
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_bDDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_bDDiversTotal" value="{{BDDivers=[[@{bDDiversD6}D6+@{bDDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-degats" title="Bonus aux dégâts"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_bDDiversD6" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_bDDiversFixe" value="0" />
                        </div>
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_bVDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_bVDiversTotal" value="{{BVDivers=[[@{bVDiversD6}D6+@{bVDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-violence" title="Bonus à la violence"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_bVDiversD6" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_bVDiversFixe" value="0" />
                        </div>
                    </div>
                </div>
            </fieldset>
        </div>
    </div>

    <div class="subTabDistance">
        <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0" />
        <input class="styleCombat" type="hidden" name="attr_styleCombat" value="0" />
        <input class="armeSection1" type="hidden" name="attr_armeSPS" value="0" />
        <input class="armeSection2" type="hidden" name="attr_armeSME" value="0"/>

        <div class="titre">
            <button type="action" class="bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
            <button type="action" class="bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>

            <h1 class="titre" data-i18n="armes-distance">Armes à distance</h1>
        </div>
        <div class="ligneTitre">
            <div class="firstCol">
                <span data-i18n="arme">Arme</span>
            </div>
            
            <div class="midCol">
                <span data-i18n="degats">Dégâts</span>
            </div>
            <div class="midCol">
                <span data-i18n="violence">Violence</span>
            </div>
            <div class="midCol">
                <span data-i18n="portee">Portée</span>
            </div>
            
            <div class="lastCol">
                <span data-i18n="jet">Jet</span>
            </div>
        </div>

        <div class="armesListe">
            <div class="armeSection1">
                <input class="subMenu" type="hidden" name="attr_pSDistOptions" value="0" />
                
                <div class="ligne">				
                    <div class="firstCol armeNom">
                        <input type="text" name="attr_pSDist" value="Pistolet de Service" readonly />
                    </div>
                    
                    <div class="midCol armeDegats">
                        <input class="nbre" type="number" name="attr_pSDistDegat" value="2" readonly />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_pSDistBDegat" value="6" readonly />
                    </div>
                    <div class="midCol armeViolence">
                        <input class="nbre" type="number" name="attr_pSDistViolence" value="1" readonly />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_pSDistBViolence" value="0" readonly />
                    </div>
                    <div class="midCol armePortee">
                        <select name="attr_pSDistPortee">
                            <option value="^{portee-moyenne}" data-i18n="portee-moyenne" selected>Moyenne</option>
                        </select>
                    </div>

                    <div class="lastCol armeCaracs">
                        <select name="attr_pScaracteristique1Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <select name="attr_pScaracteristique2Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <button class="rollDice" type="action" name="act_pSDistance" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=@{pSDist}}} {{portee=^{portee} @{pSDistPortee}}}"></button>
                    </div>
                </div>

                <div class="bonus">
                    <input class="deuxMains" type="hidden" name="attr_pSdeuxMains" value="0" />
                    
                    <label class="pilonnage">
                        <span data-i18n="pilonnageTirNumero">Pilonnage, tir n°</span>
                        <input type="number" name="attr_pSpilonnage" value="1" min="1" max="7" />
                    </label>
                    <label class="pilonnage">
                        <span data-i18n="pilonnageDegatsOuViolence">Pilonnage, dégâts ou violence ?</span>
                        <select name="attr_pSpilonnageType">
                            <option value="degats" selected>Dégâts</option>
                            <option value="violence">Violence</option>
                        </select>
                    </label>

                    <div class="bonusCarac">
                        <select name="attr_pScaracteristique3Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <select name="attr_pScaracteristique4Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                    </div>
                </div>
                <div class="subMenu">
                    <button class="effets" type="action" name="act_pSDistOptions_1" data-i18n="effets">Effets</button>
                    <button class="ameliorationsArmes BL" type="action" name="act_pSDistOptions_3" data-i18n="ameliorations-d'armes">Améliorations d'armes</button>
                    <button class="special BL" type="action" name="act_pSDistOptions_4" data-i18n="special">Spécial</button>
                </div>
                
                <div class="effets">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSantiAnatheme" value="{{antiAnathème=Anti Anathème}}" />
                        <span data-i18n-title="anti-anatheme" title="Anti Anathème"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSantiVehicule" value="{{antiVehicule=Anti Véhicule}} " />
                        <span data-i18n-title="anti-vehicule" title="Anti Véhicule"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSartillerie" value="{{artillerie=Artillerie}}" />
                        <span data-i18n-title="artillerie" title="Artillerie"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSassassin" value="{{assassin=[[@{pSassassinValue}d6]]}} " />
                            <span data-i18n-title="assassin" title="Assassin"></span>
                        </label>
                    
                        <input type="number" name="attr_pSassassinValue" class="center" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSassistanceAttaque" value="{{assistanceAttaque=Assistance à l'attaque}}" />
                        <span data-i18n-title="assistance-attaque" title="Assistance à l'attaque"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSbarrage" value="{{barrage=^{barrage} @{pSbarrageValue}}} " />
                            <span data-i18n-title="barrage" title="Barrage"></span>
                        </label>
                    
                        <input type="number" name="attr_pSbarrageValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pScadence" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                            <span data-i18n-title="cadence" title="Cadence"></span>
                        </label>
                    
                        <input type="number" name="attr_pScadenceValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSchargeur" value="{{chargeur=^{chargeur} @{pSchargeurValue}}} " />
                            <span data-i18n-title="chargeur" title="Chargeur"></span>
                        </label>
                    
                        <input type="number" name="attr_pSchargeurValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSchoc" value="{{choc=^{choc} @{pSchocValue}}}" />
                            <span data-i18n-title="choc" title="Choc"></span>
                        </label>
                    
                        <input type="number" name="attr_pSchocValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSdefense" value="{{defense=^{defense} @{pSdefenseValue}}}" />
                            <span data-i18n-title="defense" title="Défense"></span>
                        </label>
                    
                        <input type="number" name="attr_pSdefenseValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSdegatContinue" value="{{degatContinus=^{degats-continus} @{pSdegatContinueValue} ([[1D6]] ^{tours})}}" />
                            <span data-i18n-title="degats-continus" title="Dégâts Continus"></span>
                        </label>
                    
                        <input type="number" name="attr_pSdegatContinueValue" class="center" size="2" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSdeuxMains" value="{{deuxMains=Deux Mains}}" />
                        <span data-i18n-title="deux-mains" title="Deux Mains"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSdemoralisant" value="{{demoralisant=Démoralisant}}" />
                        <span data-i18n-title="demoralisant" title="Démoralisant"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSdesignation" value="{{designation=Désignation}}" />
                        <span data-i18n-title="designation" title="Désignation"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSdestructeur" value="{{destructeur=[[2D6]]}}" />
                        <span data-i18n-title="destructeur" title="Destructeur"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSdispersion" value="{{dispersion=^{dispersion} @{pSdispersionValue}}} " />
                            <span data-i18n-title="dispersion" title="Dispersion"></span>
                        </label>
                    
                        <input type="number" name="attr_pSdispersionValue" class="center" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSenChaine" value="{{enChaine=En Chaîne}}" />
                        <span data-i18n-title="en-chaine" title="En Chaîne"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSesperance" value="{{esperance=Espérance}}" />
                        <span data-i18n-title="esperance" title="Espérance"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSfureur" value="{{fureur=[[4D6]]}}" />
                        <span data-i18n-title="fureur" title="Fureur"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSignoreArmure" value="{{ignoreArmure=Ignore Armure}}" />
                        <span data-i18n-title="ignore-armure" title="Ignore Armure"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSignoreCdF" value="{{ignoreCdF=Ignore Champs de Force}}" />
                        <span data-i18n-title="ignore-champ-de-force" title="Ignore CdF"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSakimbo" value="2" />
                        <span data-i18n-title="jumele-akimbo" title="Jumelé (Akimbo)"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSambidextrie" value="2" />
                        <span data-i18n-title="jumele-ambidextrie" title="Jumelé (Ambidextrie)"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSleste" value="{{leste=[[@{force}]]}}" />
                        <span data-i18n-title="leste" title="Lesté"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSlourd" value="1" />
                        <span data-i18n-title="lourd" title="Lourd"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSlumiere" value="{{lumiere=^{lumiere} @{pSlumiereValue}}}" />
                            <span data-i18n-title="lumiere" title="Lumière"></span>
                        </label>
                    
                        <input type="number" name="attr_pSlumiereValue" class="center" size="2" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSmeurtrier" value="{{meurtrier=[[2D6]]}}" />
                        <span data-i18n-title="meutrier" title="Meurtrier"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSobliteration" value="{{obliteration=Oblitération}}" />
                        <span data-i18n-title="obliteration" title="Oblitération"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSorfevrerie" value="{{orfevrerie=[[@{dexterite}+@{dextOD}]]}} {{orfevrerieWarrior=[[@{dexterite}+@{dextOD}+@{warriorScoutA}]]}}" />
                        <span data-i18n-title="orfevrerie" title="Orfèvrerie"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSparasitage" value="{{parasitage=^{parasitage} @{pSparasitageValue}}}" />
                            <span data-i18n-title="parasitage" title="Parasitage"></span>
                        </label>
                    
                        <input type="number" name="attr_pSparasitageValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSpenetrant" value="{{penetrant=^{penetrant} @{pSpenetrantValue}}}" />
                            <span data-i18n-title="penetrant" title="Pénétrant"></span>
                        </label>
                    
                        <input type="number" name="attr_pSpenetrantValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSperceArmure" value="{{perceArmure=^{perce-armure} @{pSperceArmureValue}}}" />
                            <span data-i18n-title="perce-armure" title="Perce Armure"></span>
                        </label>
                    
                        <input type="number" name="attr_pSperceArmureValue" class="center" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSprecision" value="{{precision=[[@{tir}+@{tirOD}]]}} {{precisionWarrior=[[@{tir}+@{tirOD}+@{warriorScholarA}]]}}" />
                        <span data-i18n-title="precision" title="Précision"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSreaction" value="{{reaction=^{reaction} @{pSreactionValue}}}" />
                            <span data-i18n-title="reaction" title="Réaction"></span>
                        </label>
                    
                        <input type="number" name="attr_pSreactionValue" class="center" value="0" />
                    </div>
                    <label class="simple fakeButton checked">
                        <span data-i18n-title="silencieux" title="Silencieux"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSsoumission" value="{{soumission=Soumission}}" />
                        <span data-i18n-title="soumission" title="Soumission"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pStenebricite" value="{{tenebricide=Ténébricide}}" />
                        <span data-i18n-title="tenebricide" title="Ténébricide"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pStirRafale" value="{{tirRafale=Tir en Rafale}}" />
                        <span data-i18n-title="tir-rafale" title="Tir en Rafale"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pStirSecurite" value="3" />
                        <span data-i18n-title="tir-securite" title="Tir en Sécurité"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSultraViolence" value="{{ultraviolence=[[2D6]]}}" />
                        <span data-i18n-title="ultraviolence" title="Ultraviolence"></span>
                    </label>
                </div>
                <div class="ameliorationsArmes">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSchargeurGrappes" value="1" />
                        <span data-i18n-title="balles-grappes" title="Balles grappes"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pScanonLong" value="{{canonLongM=1}} {{canonLongC=Canon Long (Portée Courte : +3 Difficulté)}}" />
                        <span data-i18n-title="canon-long" title="Canon Long"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pScanonRaccourci" value="{{canonRaccourci=Canon Raccourci (Portée Courte : Dispersion 3 / Sinon : +3 Difficulté)}}" />
                        <span data-i18n-title="canon-raccourci" title="Canon Raccourci"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSchambreDouble" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                        <span data-i18n-title="chambre-double" title="Chambre Double"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSinterfaceGuidage" value="3" />
                        <span data-i18n-title="interface-guidage" title="Interface de guidage"></span>
                    </label>
                    <div class="doubleTexte">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSjumelage" value="{{jumelage=^{jumelage} (@{pSjumelageValue})}}" />
                            <span data-i18n-title="jumelage" title="Jumelage :"></span>
                        </label>
                        <input type="text" name="attr_pSjumelageValue" class="borderBottom" />
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSjumelageType" value="ambidextrie" />
                            <span data-i18n-title="ambidextrie" title="Ambidextrie"></span>
                        </label>
                        <label class="fakeButton borderTop">
                            <input type="checkbox" name="attr_pSjumelageType" value="akimbo" />
                            <span data-i18n-title="akimbo" title="Akimbo"></span>
                        </label>
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSlunetteIntelligente" value="{{lunetteIntelligente=Lunette Intelligente (+1 Portée)}}" />
                        <span data-i18n-title="lunette-intelligente" title="Lunette Intelligente"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSmunitionsHyperVelocite" value="{{munitionsHyperVelocite=Munitions à Hyper Velocite (Assistance à l'Attaque)}}" />
                        <span data-i18n-title="munitions-hyper-velocite-short" title="Munitions à H. Vélocité"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSmunitionsDrone" value="{{munitionsDrone=3}}" />
                        <span data-i18n-title="munitions-drones" title="Munitions Drones"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSchargeurExplosives" value="1" />
                        <span data-i18n-title="munitions-explosives" title="Munitions Explosives"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSmunitionsIEM" value="1" />
                        <span data-i18n-title="munitions-iem" title="Munitions IEM"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSmunitionsNonLetales" value="2" />
                        <span data-i18n-title="munitions-non-letales-short" title="Munitions N. Létales"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSmunitionsSubsoniques" value="{{munitionsSubsoniques=Munitions Subsoniques (Silencieux)}}" />
                        <span data-i18n-title="munitions-subsoniques" title="Munitions Subsoniques"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSpointeurLaser" value="{{pointeurLaser=1}} " />
                        <span data-i18n-title="pointeur-laser" title="Pointeur Laser"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSprotectionArme" value="{{protectionArme=Protection d'Arme (Reaction +2)}}" />
                        <span data-i18n-title="pointeur-d'arme" title="Protection d'Arme"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSrevetementOmega" value="2" />
                        <span data-i18n-title="revetement-omega" title="Revêtement Omega"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSstructureElement" value="{{structureElement=Structure en Élément}}" />
                        <span data-i18n-title="structure-element-alpha-short" title="Structure Alpha"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSsystemeRefroidissement" value="{{systemeRefroidissement=Système de Refroidissement (Tir en Rafale + Barrage 1)}}" />
                        <span data-i18n-title="systeme-refroidissement-short" title="Système de Refroid."></span>
                    </label>
                </div>
                <div class="special">
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSenergie" value="{{energie=@{pSenergieValue}}} " />
                            <span data-i18n-title="energie" title="Énergie"></span>
                        </label>
                    
                        <input type="number" name="attr_pSenergieValue" class="center" value="0" />
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_pSbDDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSbDDiversTotal" value="{{BDDivers=[[@{pSbDDiversD6}D6+@{pSbDDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-degats" title="Bonus aux dégâts"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_pSbDDiversD6" class="center" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_pSbDDiversFixe" class="center" value="0" />
                        </div>
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_pSbVDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSbVDiversTotal" value="{{BVDivers=[[@{pSbVDiversD6}D6+@{pSbVDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-violence" title="Bonus à la violence"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_pSbVDiversD6" class="center" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_pSbVDiversFixe" class="center" value="0" />
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="armeSection2">
                <input class="subMenu" type="hidden" name="attr_mEDistOptions" value="0">

                <div class="ligne">
                    <div class="firstCol armeNom">
                        <input type="text" name="attr_mEDist" value="Marteau-Épieu (Tir)" readonly />
                    </div>
                    <div class="midCol armeDegats">
                        <input class="nbre" type="number" name="attr_mEDistDegat" value="3" readonly />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_mEDistBDegat" value="12" readonly />
                    </div>
                    <div class="midCol armeViolence">
                        <input class="nbre" type="number" name="attr_mEDistViolence" value="3" readonly />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_mEDistBViolence" value="12" readonly />
                    </div>
                    <div class="midCol armePortee">
                        <select name="attr_mEDistPortee">
                            <option value="^{portee-courte}" data-i18n="portee-courte" selected>Courte</option>
                        </select>
                    </div>
                    <div class="lastCol armeCaracs">
                        <select name="attr_mEcaracteristique1Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <select name="attr_mEcaracteristique2Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <button class="rollDice" type="action" name="act_mEDistance" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=@{mEDist}}} {{portee=^{portee} @{mEDistPortee}}}"></button>
                    </div>
                </div>

                <div class="bonus">
                    <input class="deuxMains" type="hidden" name="attr_mEdeuxMains" value="0" />
                    <label class="pilonnage">
                        <span data-i18n="pilonnageTirNumero">Pilonnage, tir n°</span>
                        <input type="number" name="attr_mEpilonnage" value="1" min="1" max="7" />
                    </label>
                    <label class="pilonnage">
                        <span data-i18n="pilonnageDegatsOuViolence">Pilonnage, dégâts ou violence ?</span>
                        <select name="attr_mEpilonnageType">
                            <option value="degats" selected>Dégâts</option>
                            <option value="violence">Violence</option>
                        </select>
                    </label>

                    <div class="bonusCarac">
                        <select name="attr_mEcaracteristique3Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <select name="attr_mEcaracteristique4Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                    </div>
                </div>

                <div class="subMenu">
                    <button class="effets" type="action" name="act_mEDistOptions_1" data-i18n="effets">Effets</button>
                    <button class="ameliorationsArmes BL" type="action" name="act_mEDistOptions_3" data-i18n="ameliorations-d'armes">Améliorations d'armes</button>
                    <button class="special BL" type="action" name="act_mEDistOptions_4" data-i18n="special">Spécial</button>
                </div>
                <input type="hidden" name="attr_mEDistOptions" value="" />
                <div class="effets">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEantiAnatheme" value="{{antiAnathème=Anti Anathème}}" />
                        <span data-i18n-title="anti-anatheme" title="Anti Anathème"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEantiVehicule" value="{{antiVehicule=Anti Véhicule}} " />
                        <span data-i18n-title="anti-vehicule" title="Anti Véhicule"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEartillerie" value="{{artillerie=Artillerie}}" />
                        <span data-i18n-title="artillerie" title="Artillerie"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mEassassin" value="{{assassin=[[@{mEassassinValue}d6]]}} " />
                            <span data-i18n-title="assassin" title="Assassin"></span>
                        </label>
                    
                        <input type="number" name="attr_mEassassinValue" class="center" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEassistanceAttaque" value="{{assistanceAttaque=Assistance à l'attaque}}" />
                        <span data-i18n-title="assistance-attaque" title="Assistance à l'attaque"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mEbarrage" value="{{barrage=^{barrage} @{mEbarrageValue}}} " />
                            <span data-i18n-title="barrage" title="Barrage"></span>
                        </label>
                    
                        <input type="number" name="attr_mEbarrageValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mEcadence" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                            <span data-i18n-title="cadence" title="Cadence"></span>
                        </label>
                    
                        <input type="number" name="attr_mEcadenceValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton checked">
                            <span data-i18n-title="chargeur" title="Chargeur"></span>
                        </label>
                        
                        <input type="number" name="attr_mEchargeurValue" class="center" value="1" disabled />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mEchoc" value="{{choc=^{choc} @{mEchocValue}}}" />
                            <span data-i18n-title="choc" title="Choc"></span>
                        </label>
                    
                        <input type="number" name="attr_mEchocValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mEdefense" value="{{defense=^{defense} @{mEdefenseValue}}}" />
                            <span data-i18n-title="defense" title="Défense"></span>
                        </label>
                    
                        <input type="number" name="attr_mEdefenseValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton checked">
                            <span data-i18n-title="degats-continus" title="Dégâts Continus"></span>
                        </label>
                        
                        <input type="number" name="attr_mEdegatContinueValue" class="center" size="2" value="3" disabled />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEdeuxMains" value="{{deuxMains=Deux Mains}}" />
                        <span data-i18n-title="deux-mains" title="Deux Mains"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEdemoralisant" value="{{demoralisant=Démoralisant}}" />
                        <span data-i18n-title="demoralisant" title="Démoralisant"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEdesignation" value="{{designation=Désignation}}" />
                        <span data-i18n-title="designation" title="Désignation"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEdestructeur" value="{{destructeur=[[2D6]]}}" />
                        <span data-i18n-title="destructeur" title="Destructeur"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton checked">
                            <span data-i18n-title="dispersion" title="Dispersion"></span>
                        </label>
                        
                        <input type="number" name="attr_mEdispersionValue" class="center" value="3" disabled />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEenChaine" value="{{enChaine=En Chaîne}}" />
                        <span data-i18n-title="en-chaine" title="En Chaîne"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEesperance" value="{{esperance=Espérance}}" />
                        <span data-i18n-title="esperance" title="Espérance"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEfureur" value="{{fureur=[[4D6]]}}" />
                        <span data-i18n-title="fureur" title="Fureur"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEignoreArmure" value="{{ignoreArmure=Ignore Armure}}" />
                        <span data-i18n-title="ignore-armure" title="Ignore Armure"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEignoreCdF" value="{{ignoreCdF=Ignore Champs de Force}}" />
                        <span data-i18n-title="ignore-champ-de-force" title="Ignore CdF"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEakimbo" value="2" />
                        <span data-i18n-title="jumele-akimbo" title="Jumelé (Akimbo)"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEambidextrie" value="2" />
                        <span data-i18n-title="jumele-ambidextrie" title="Jumelé (Ambidextrie)"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEleste" value="{{leste=[[@{force}]]}}" />
                        <span data-i18n-title="leste" title="Lesté"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mElourd" value="1" />
                        <span data-i18n-title="lourd" title="Lourd"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton checked">
                            <span data-i18n-title="lumiere" title="Lumière"></span>
                        </label>
                        
                        <input type="number" name="attr_mElumiereValue" class="center" size="2" value="2" disabled />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEmeurtrier" value="{{meurtrier=[[2D6]]}}" />
                        <span data-i18n-title="meutrier" title="Meurtrier"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEobliteration" value="{{obliteration=Oblitération}}" />
                        <span data-i18n-title="obliteration" title="Oblitération"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEorfevrerie" value="{{orfevrerie=[[@{dexterite}+@{dextOD}]]}} {{orfevrerieWarrior=[[@{dexterite}+@{dextOD}+@{warriorScoutA}]]}}" />
                        <span data-i18n-title="orfevrerie" title="Orfèvrerie"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mEparasitage" value="{{parasitage=^{parasitage} @{mEparasitageValue}}}" />
                            <span data-i18n-title="parasitage" title="Parasitage"></span>
                        </label>
                    
                        <input type="number" name="attr_mEparasitageValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mEpenetrant" value="{{penetrant=^{penetrant} @{mEpenetrantValue}}}" />
                            <span data-i18n-title="penetrant" title="Pénétrant"></span>
                        </label>
                    
                        <input type="number" name="attr_mEpenetrantValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mEperceArmure" value="{{perceArmure=^{perce-armure} @{mEperceArmureValue}}}" />
                            <span data-i18n-title="perce-armure" title="Perce Armure"></span>
                        </label>
                    
                        <input type="number" name="attr_mEperceArmureValue" class="center" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEprecision" value="{{precision=[[@{tir}+@{tirOD}]]}} {{precisionWarrior=[[@{tir}+@{tirOD}+@{warriorScholarA}]]}}" />
                        <span data-i18n-title="precision" title="Précision"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mEreaction" value="{{reaction=^{reaction} @{mEreactionValue}}}" />
                            <span data-i18n-title="reaction" title="Réaction"></span>
                        </label>
                    
                        <input type="number" name="attr_mEreactionValue" class="center" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEsilencieux" value="{{silencieux=Silencieux}}" />
                        <span data-i18n-title="silencieux" title="Silencieux"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEsoumission" value="{{soumission=Soumission}}" />
                        <span data-i18n-title="soumission" title="Soumission"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEtenebricite" value="{{tenebricide=Ténébricide}}" />
                        <span data-i18n-title="tenebricide" title="Ténébricide"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEtirRafale" value="{{tirRafale=Tir en Rafale}}" />
                        <span data-i18n-title="tir-rafale" title="Tir en Rafale"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEtirSecurite" value="3" />
                        <span data-i18n-title="tir-securite" title="Tir en Sécurité"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEultraViolence" value="{{ultraviolence=[[2D6]]}}" />
                        <span data-i18n-title="ultraviolence" title="Ultraviolence"></span>
                    </label>
                </div>
                <div class="ameliorationsArmes">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEchargeurGrappes" value="1" />
                        <span data-i18n-title="balles-grappes" title="Balles grappes"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEcanonLong" value="{{canonLongM=1}} {{canonLongC=Canon Long (Portée Courte : +3 Difficulté)}}" />
                        <span data-i18n-title="canon-long" title="Canon Long"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEcanonRaccourci" value="{{canonRaccourci=Canon Raccourci (Portée Courte : Dispersion 3 / Sinon : +3 Difficulté)}}" />
                        <span data-i18n-title="canon-raccourci" title="Canon Raccourci"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEchambreDouble" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                        <span data-i18n-title="chambre-double" title="Chambre Double"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEinterfaceGuidage" value="3" />
                        <span data-i18n-title="interface-guidage" title="Interface de guidage"></span>
                    </label>
                    <div class="doubleTexte">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mEjumelage" value="{{jumelage=^{jumelage} (@{jumelageValue})}}" />
                            <span data-i18n-title="jumelage" title="Jumelage :"></span>
                        </label>
                        <input type="text" name="attr_mEjumelageValue" class="borderBottom" />
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mEjumelageType" value="ambidextrie" />
                            <span data-i18n-title="ambidextrie" title="Ambidextrie"></span>
                        </label>
                        <label class="fakeButton borderTop">
                            <input type="checkbox" name="attr_mEjumelageType" value="akimbo" />
                            <span data-i18n-title="akimbo" title="Akimbo"></span>
                        </label>
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mElunetteIntelligente" value="{{lunetteIntelligente=Lunette Intelligente (+1 Portée)}}" />
                        <span data-i18n-title="lunette-intelligente" title="Lunette Intelligente"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEmunitionsHyperVelocite" value="{{munitionsHyperVelocite=Munitions à Hyper Velocite (Assistance à l'Attaque)}}" />
                        <span data-i18n-title="munitions-hyper-velocite-short" title="Munitions à H. Vélocité"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEmunitionsDrone" value="{{munitionsDrone=3}}" />
                        <span data-i18n-title="munitions-drones" title="Munitions Drones"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEchargeurExplosives" value="1" />
                        <span data-i18n-title="munitions-explosives" title="Munitions Explosives"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEmunitionsIEM" value="1" />
                        <span data-i18n-title="munitions-iem" title="Munitions IEM"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEmunitionsNonLetales" value="2" />
                        <span data-i18n-title="munitions-non-letales-short" title="Munitions N. Létales"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEmunitionsSubsoniques" value="{{munitionsSubsoniques=Munitions Subsoniques (Silencieux)}}" />
                        <span data-i18n-title="munitions-subsoniques" title="Munitions Subsoniques"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEpointeurLaser" value="{{pointeurLaser=1}} " />
                        <span data-i18n-title="pointeur-laser" title="Pointeur Laser"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEprotectionArme" value="{{protectionArme=Protection d'Arme (Reaction +2)}}" />
                        <span data-i18n-title="pointeur-d'arme" title="Protection d'Arme"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mErevetementOmega" value="2" />
                        <span data-i18n-title="revetement-omega" title="Revêtement Omega"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEstructureElement" value="{{structureElement=Structure en Élément}}" />
                        <span data-i18n-title="structure-element-alpha-short" title="Structure Alpha"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEsystemeRefroidissement" value="{{systemeRefroidissement=Système de Refroidissement (Tir en Rafale + Barrage 1)}}" />
                        <span data-i18n-title="systeme-refroidissement-short" title="Système de Refroid."></span>
                    </label>
                </div>
                <div class="special">
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mEenergie" value="{{energie=@{mEenergieValue}}} " />
                            <span data-i18n-title="energie" title="Énergie"></span>
                        </label>
                    
                        <input type="number" name="attr_mEenergieValue" class="center" value="0" />
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_mEbDDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mEbDDiversTotal" value="{{BDDivers=[[@{bDDiversD6}D6+@{bDDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-degats" title="Bonus aux dégâts"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_mEbDDiversD6" class="center" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_mEbDDiversFixe" class="center" value="0" />
                        </div>
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_mEbVDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mEbVDiversTotal" value="{{BVDivers=[[@{bVDiversD6}D6+@{bVDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-violence" title="Bonus à la violence"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_mEbVDiversD6" class="center" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_mEbVDiversFixe" class="center" value="0" />
                        </div>
                    </div>
                </div>
            </div>
            
            <fieldset class="repeating_armeDist">
                <input class="subMenu" type="hidden" name="attr_armeDistOptions" value="0">
                
                <div class="ligne">
                    <div class="firstCol armeNom">
                        <input type="text" name="attr_ArmeDist" />
                    </div>

                    <div class="midCol armeDegats">
                        <input class="nbre" type="number" name="attr_armeDistDegat" value="0" />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_armeDistBDegat" value="0" />
                    </div>
                    <div class="midCol armeViolence">
                        <input class="nbre" type="number" name="attr_armeDistViolence" value="0" />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_armeDistBViolence" value="0" />
                    </div>
                    <div class="midCol armePortee">
                        <select name="attr_armeDistPortee">
                            <option value="^{portee-contact}" data-i18n="portee-contact" selected>Contact</option>
                            <option value="^{portee-courte}" data-i18n="portee-courte">Courte</option>
                            <option value="^{portee-moyenne}" data-i18n="portee-moyenne">Moyenne</option>
                            <option value="^{portee-longue}" data-i18n="portee-longue">Longue</option>
                            <option value="^{portee-lointaine}" data-i18n="portee-lointaine">Lointaine</option>
                        </select>
                    </div>

                    <div class="lastCol armeCaracs">
                        <select name="attr_caracteristique1Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <select name="attr_caracteristique2Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
    
                        <button class="rollDice" type="action" name="act_armedistance" value="@{jetGM} &{template:combat} {{Nom=@{name}}}" ></button>
                    </div>
                </div>

                <div class="bonus">
                    <input class="deuxMains" type="hidden" name="attr_deuxMains" value="0" />

                    <label class="pilonnage">
                        <span data-i18n="pilonnageTirNumero">Pilonnage, tir n°</span>
                        <input type="number" name="attr_pilonnage" value="1" min="1" max="7" />
                    </label>
                    <label class="pilonnage">
                        <span data-i18n="pilonnageDegatsOuViolence">Pilonnage, dégâts ou violence ?</span>
                        <select name="attr_pilonnageType">
                            <option value="degats" selected>Dégâts</option>
                            <option value="violence">Violence</option>
                        </select>
                    </label>

                    <div class="bonusCarac">
                        <select name="attr_caracteristique3Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <select name="attr_caracteristique4Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                    </div>
                </div>

                <div class="subMenu">
                    <button class="effets" type="action" name="act_armedistoptions-1" data-i18n="effets">Effets</button>
                    <button class="ameliorationsArmes BL" type="action" name="act_armedistoptions-3" data-i18n="ameliorations-d'armes">Améliorations d'armes</button>
                    <button class="special BL" type="action" name="act_armedistoptions-4" data-i18n="special">Spécial</button>
                </div>

                <div class="effets">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_antiAnatheme" value="{{antiAnathème=Anti Anathème}}" />
                        <span data-i18n-title="anti-anatheme" title="Anti Anathème"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_antiVehicule" value="{{antiVehicule=Anti Véhicule}} " />
                        <span data-i18n-title="anti-vehicule" title="Anti Véhicule"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_artillerie" value="{{artillerie=Artillerie}}" />
                        <span data-i18n-title="artillerie" title="Artillerie"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_assassin" value="{{assassin=[[@{assassinValue}d6]]}} " />
                            <span data-i18n-title="assassin" title="Assassin"></span>
                        </label>
                    
                        <input type="number" name="attr_assassinValue" class="center" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_assistanceAttaque" value="{{assistanceAttaque=Assistance à l'attaque}}" />
                        <span data-i18n-title="assistance-attaque" title="Assistance à l'attaque"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_barrage" value="{{barrage=^{barrage} @{barrageValue}}} " />
                            <span data-i18n-title="barrage" title="Barrage"></span>
                        </label>
                    
                        <input type="number" name="attr_barrageValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_cadence" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                            <span data-i18n-title="cadence" title="Cadence"></span>
                        </label>
                    
                        <input type="number" name="attr_cadenceValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_chargeur" value="{{chargeur=^{chargeur} @{chargeurValue}}} " />
                            <span data-i18n-title="chargeur" title="Chargeur"></span>
                        </label>
                    
                        <input type="number" name="attr_chargeurValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_choc" value="{{choc=^{choc} @{chocValue}}}" />
                            <span data-i18n-title="choc" title="Choc"></span>
                        </label>
                    
                        <input type="number" name="attr_chocValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_defense" value="{{defense=^{defense} @{defenseValue}}}" />
                            <span data-i18n-title="defense" title="Défense"></span>
                        </label>
                    
                        <input type="number" name="attr_defenseValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_degatContinue" value="{{degatContinus=^{degats-continus} @{degatContinueValue} ([[1D6]] ^{tours})}}" />
                            <span data-i18n-title="degats-continus" title="Dégâts Continus"></span>
                        </label>
                    
                        <input type="number" name="attr_degatContinueValue" class="center" size="2" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_deuxMains" value="{{deuxMains=Deux Mains}}" />
                        <span data-i18n-title="deux-mains" title="Deux Mains"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_demoralisant" value="{{demoralisant=Démoralisant}}" />
                        <span data-i18n-title="demoralisant" title="Démoralisant"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_designation" value="{{designation=Désignation}}" />
                        <span data-i18n-title="designation" title="Désignation"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_destructeur" value="{{destructeur=[[2D6]]}}" />
                        <span data-i18n-title="destructeur" title="Destructeur"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_dispersion" value="{{dispersion=^{dispersion} @{dispersionValue}}} " />
                            <span data-i18n-title="dispersion" title="Dispersion"></span>
                        </label>
                    
                        <input type="number" name="attr_dispersionValue" class="center" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_enChaine" value="{{enChaine=En Chaîne}}" />
                        <span data-i18n-title="en-chaine" title="En Chaîne"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_esperance" value="{{esperance=Espérance}}" />
                        <span data-i18n-title="esperance" title="Espérance"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_fureur" value="{{fureur=[[4D6]]}}" />
                        <span data-i18n-title="fureur" title="Fureur"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ignoreArmure" value="{{ignoreArmure=Ignore Armure}}" />
                        <span data-i18n-title="ignore-armure" title="Ignore Armure"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ignoreCdF" value="{{ignoreCdF=Ignore Champs de Force}}" />
                        <span data-i18n-title="ignore-champ-de-force" title="Ignore CdF"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_akimbo" value="2" />
                        <span data-i18n-title="jumele-akimbo" title="Jumelé (Akimbo)"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ambidextrie" value="2" />
                        <span data-i18n-title="jumele-ambidextrie" title="Jumelé (Ambidextrie)"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_leste" value="{{leste=[[@{force}]]}}" />
                        <span data-i18n-title="leste" title="Lesté"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_lourd" value="1" />
                        <span data-i18n-title="lourd" title="Lourd"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_lumiere" value="{{lumiere=^{lumiere} @{lumiereValue}}}" />
                            <span data-i18n-title="lumiere" title="Lumière"></span>
                        </label>
                    
                        <input type="number" name="attr_lumiereValue" class="center" size="2" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_meurtrier" value="{{meurtrier=[[2D6]]}}" />
                        <span data-i18n-title="meutrier" title="Meurtrier"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_obliteration" value="{{obliteration=Oblitération}}" />
                        <span data-i18n-title="obliteration" title="Oblitération"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_orfevrerie" value="{{orfevrerie=[[@{dexterite}+@{dextOD}]]}} {{orfevrerieWarrior=[[@{dexterite}+@{dextOD}+@{warriorScoutA}]]}}" />
                        <span data-i18n-title="orfevrerie" title="Orfèvrerie"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_parasitage" value="{{parasitage=^{parasitage} @{parasitageValue}}}" />
                            <span data-i18n-title="parasitage" title="Parasitage"></span>
                        </label>
                    
                        <input type="number" name="attr_parasitageValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_penetrant" value="{{penetrant=^{penetrant} @{penetrantValue}}}" />
                            <span data-i18n-title="penetrant" title="Pénétrant"></span>
                        </label>
                    
                        <input type="number" name="attr_penetrantValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_perceArmure" value="{{perceArmure=^{perce-armure} @{perceArmureValue}}}" />
                            <span data-i18n-title="perce-armure" title="Perce Armure"></span>
                        </label>
                    
                        <input type="number" name="attr_perceArmureValue" class="center" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_precision" value="{{precision=[[@{tir}+@{tirOD}]]}} {{precisionWarrior=[[@{tir}+@{tirOD}+@{warriorScholarA}]]}}" />
                        <span data-i18n-title="precision" title="Précision"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_reaction" value="{{reaction=^{reaction} @{reactionValue}}}" />
                            <span data-i18n-title="reaction" title="Réaction"></span>
                        </label>
                    
                        <input type="number" name="attr_reactionValue" class="center" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_silencieux" value="{{silencieux=Silencieux}}" />
                        <span data-i18n-title="silencieux" title="Silencieux"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_soumission" value="{{soumission=Soumission}}" />
                        <span data-i18n-title="soumission" title="Soumission"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_tenebricite" value="{{tenebricide=Ténébricide}}" />
                        <span data-i18n-title="tenebricide" title="Ténébricide"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_tirRafale" value="{{tirRafale=Tir en Rafale}}" />
                        <span data-i18n-title="tir-rafale" title="Tir en Rafale"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_tirSecurite" value="3" />
                        <span data-i18n-title="tir-securite" title="Tir en Sécurité"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ultraViolence" value="{{ultraviolence=[[2D6]]}}" />
                        <span data-i18n-title="ultraviolence" title="Ultraviolence"></span>
                    </label>
                </div>
                <div class="ameliorationsArmes">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_chargeurGrappes" value="1" />
                        <span data-i18n-title="balles-grappes" title="Balles grappes"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_canonLong" value="{{canonLongM=1}} {{canonLongC=Canon Long (Portée Courte : +3 Difficulté)}}" />
                        <span data-i18n-title="canon-long" title="Canon Long"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_canonRaccourci" value="{{canonRaccourci=Canon Raccourci (Portée Courte : Dispersion 3 / Sinon : +3 Difficulté)}}" />
                        <span data-i18n-title="canon-raccourci" title="Canon Raccourci"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_chambreDouble" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                        <span data-i18n-title="chambre-double" title="Chambre Double"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_interfaceGuidage" value="3" />
                        <span data-i18n-title="interface-guidage" title="Interface de guidage"></span>
                    </label>
                    
                    <div class="doubleTexte">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_jumelage" value="{{jumelage=^{jumelage} (@{jumelageValue})}}" />
                            <span data-i18n-title="jumelage" title="Jumelage :"></span>
                        </label>
                        <input type="text" name="attr_jumelageValue" class="borderBottom" />
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_jumelageType" value="ambidextrie" />
                            <span data-i18n-title="ambidextrie" title="Ambidextrie"></span>
                        </label>
                        <label class="fakeButton borderTop">
                            <input type="checkbox" name="attr_jumelageType" value="akimbo" />
                            <span data-i18n-title="akimbo" title="Akimbo"></span>
                        </label>
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_lunetteIntelligente" value="{{lunetteIntelligente=Lunette Intelligente (+1 Portée)}}" />
                        <span data-i18n-title="lunette-intelligente" title="Lunette Intelligente"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsHyperVelocite" value="{{munitionsHyperVelocite=Munitions à Hyper Velocite (Assistance à l'Attaque)}}" />
                        <span data-i18n-title="munitions-hyper-velocite-short" title="Munitions à H. Vélocité"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsDrone" value="{{munitionsDrone=3}}" />
                        <span data-i18n-title="munitions-drones" title="Munitions Drones"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_chargeurExplosives" value="1" />
                        <span data-i18n-title="munitions-explosives" title="Munitions Explosives"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsIEM" value="1" />
                        <span data-i18n-title="munitions-iem" title="Munitions IEM"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsNonLetales" value="2" />
                        <span data-i18n-title="munitions-non-letales-short" title="Munitions N. Létales"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsSubsoniques" value="{{munitionsSubsoniques=Munitions Subsoniques (Silencieux)}}" />
                        <span data-i18n-title="munitions-subsoniques" title="Munitions Subsoniques"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pointeurLaser" value="{{pointeurLaser=1}} " />
                        <span data-i18n-title="pointeur-laser" title="Pointeur Laser"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_protectionArme" value="{{protectionArme=Protection d'Arme (Reaction +2)}}" />
                        <span data-i18n-title="pointeur-d'arme" title="Protection d'Arme"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_revetementOmega" value="2" />
                        <span data-i18n-title="revetement-omega" title="Revêtement Omega"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_structureElement" value="{{structureElement=Structure en Élément}}" />
                        <span data-i18n-title="structure-element-alpha-short" title="Structure Alpha"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_systemeRefroidissement" value="{{systemeRefroidissement=Système de Refroidissement (Tir en Rafale + Barrage 1)}}" />
                        <span data-i18n-title="systeme-refroidissement-short" title="Système de Refroid."></span>
                    </label>
                </div>
                <div class="special">
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_energie" value="{{energie=@{energieValue}}} " />
                            <span data-i18n-title="energie" title="Énergie"></span>
                        </label>
                    
                        <input type="number" name="attr_energieValue" class="center" value="0" />
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_bDDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_bDDiversTotal" value="{{BDDivers=[[@{bDDiversD6}D6+@{bDDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-degats" title="Bonus aux dégâts"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_bDDiversD6" class="center" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_bDDiversFixe" class="center" value="0" />
                        </div>
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_bVDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_bVDiversTotal" value="{{BVDivers=[[@{bVDiversD6}D6+@{bVDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-violence" title="Bonus à la violence"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_bVDiversD6" class="center" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_bVDiversFixe" class="center" value="0" />
                        </div>
                    </div>
                </div>
            </fieldset>
        </div>
    </div>

    <div class="subTabImprovisee">
        <div class="utilisation">
            <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0" />

            <div class="titre">
                <button type="action" class="bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                <button type="action" class="bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>

                <h1 class="titre" data-i18n="utilisation-armes-improvisees">Utilisation de l'arme improvisée</h1>
            </div>
        

            <div class="buttons">
                <label class="fakeButton">
                    <input type="radio" name="attr_utilisationArmeAI" value="&{template:combat} {{portee=^{portee-contact}}}" checked />
                    <span data-i18n-title="contact" title="Contact"></span>
                </label>
                <label class="fakeButton">
                    <input type="radio" name="attr_utilisationArmeAI" value="&{template:combat} {{portee=^{distance}}}" />
                    <span data-i18n-title="lancer" title="Lancer"></span>
                </label>
            </div>

            <div class="bonus">
                <div class="bonusCarac">
                    <select name="attr_caracteristique3ArmeImprovisee">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                    <select name="attr_caracteristique4ArmeImprovisee">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="liste">
            <h1 class="titre" data-i18n="armes-improvisees">Armes Improvisées</h1>
            <div class="ligneTitre">
                <span class="OD" data-i18n="od-requis">OD Requis</span>
                <span class="type" data-i18n="type">Type</span>
                <span class="degats" data-i18n="degats">Dégâts</span>
                <span class="violence" data-i18n="violence">Violence</span>
                <span class="jet" data-i18n="utilisations">Utilisations</span>
            </div>
            <div class="ligne">
                <div class="OD"><input type="text" name="attr_ODAI1" value="1" readonly /></div>
                <span class="type" data-i18n="arme-improvisee-od1-exemple1">Lampadaire, panneau, petit arbre, cadavre, etc.</span>
                
                <input type="hidden" name="attr_nbDDgts1" value="4" readonly />
                <input type="hidden" name="attr_AIstylesDB1" value="{{styleDgtBM=[[@{dgts1}]]}}" />
                <input type="hidden" name="attr_AIstylesVB1" value="{{styleViolBM=[[ (floor([[@{nbDDgts1}]]/2))d6]]}}" />
    
                <div class="degats"><input type="text" name="attr_dgts1" value="4D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence1" value="4D6" readonly /></div>
                <div class="jet">
                    <input type="number" name="attr_utilisation1" value="3" readonly />
                    <button class="rollDice" type="action" name="act_AI1" value="@{jetGM} @{utilisationArmeAI} {{Nom=@{name}}} {{special1B=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne">
                <div class="OD"><input type="text" name="attr_ODAI2" value="1" readonly /></div>
                <span class="type" data-i18n="arme-improvisee-od1-exemple2">Citerne d'essence, transformateur électrique, etc.</span>
                
                <input type="hidden" name="attr_nbDDgts2" value="2" readonly />
                <input type="hidden" name="attr_AIstylesDB2" value="{{styleDgtBM=[[@{dgts2}]]}}" />
                <input type="hidden" name="attr_AIstylesVB2" value="{{styleViolBM=[[ (floor([[@{nbDDgts2}]]/2))d6]]}}" />
    
                <div class="degats"><input type="text" name="attr_dgts2" value="2D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence2" value="5D6" readonly /></div>
                <div class="jet">
                    <input type="number" name="attr_utilisation2" value="1" readonly />
                    <button class="rollDice" type="action" name="act_AI2" value="@{jetGM} @{utilisationArmeAI} {{Nom=@{name}}} {{special1B=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne">
                <div class="OD"><input type="text" name="attr_ODAI3" value="1" readonly /></div>
                <span class="type" data-i18n="arme-improvisee-od1-exemple3">Moto, petit véhicule, etc.</span>
                
                <input type="hidden" name="attr_nbDDgts3" value="4" readonly />
                <input type="hidden" name="attr_AIstylesDB3" value="{{styleDgtBM=[[@{dgts3}]]}}" />
                <input type="hidden" name="attr_AIstylesVB3" value="{{styleViolBM=[[ (floor([[@{nbDDgts3}]]/2))d6]]}}" />
    
                <div class="degats"><input type="text" name="attr_dgts3" value="4D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence3" value="4D6" readonly /></div>
                <div class="jet">
                    <input type="number" name="attr_utilisation3" value="2" readonly />
                    <button class="rollDice" type="action" name="act_AI3" value="@{jetGM} @{utilisationArmeAI} {{Nom=@{name}}} {{special1B=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne separationTop">
                <div class="OD"><input type="text" name="attr_ODAI4" value="2" readonly /></div>
                <span class="type" data-i18n="arme-improvisee-od2-exemple1">Arbre, poteau en béton, etc.</span>
                
                <input type="hidden" name="attr_nbDDgts4" value="6" readonly />
                <input type="hidden" name="attr_AIstylesDB4" value="{{styleDgtBM=[[@{dgts4}]]}}" />
                <input type="hidden" name="attr_AIstylesVB4" value="{{styleViolBM=[[ (floor([[@{nbDDgts4}]]/2))d6]]}}" />
    
                <div class="degats"><input type="text" name="attr_dgts4" value="6D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence4" value="4D6" readonly /></div>
                <div class="jet">
                    <input type="number" name="attr_utilisation4" value="3" readonly />
                    <button class="rollDice" type="action" name="act_AI4" value="@{jetGM} @{utilisationArmeAI} {{Nom=@{name}}} {{special1B=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne">
                <div class="OD"><input type="text" name="attr_ODAI5" value="2" readonly /></div>
                <span class="type" data-i18n="arme-improvisee-od2-exemple2">Petit château d'eau, cuve industrielle pleine, etc.</span>
                
                <input type="hidden" name="attr_nbDDgts5" value="4" readonly />
                <input type="hidden" name="attr_AIstylesDB5" value="{{styleDgtBM=[[@{dgts5}]]}}" />
                <input type="hidden" name="attr_AIstylesVB5" value="{{styleViolBM=[[ (floor([[@{nbDDgts5}]]/2))d6]]}}" />
    
                <div class="degats"><input type="text" name="attr_dgts5" value="4D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence5" value="6D6" readonly /></div>
                <div class="jet">
                    <input type="number" name="attr_utilisation5" value="1" readonly />
                    <button class="rollDice" type="action" name="act_AI5" value="@{jetGM} @{utilisationArmeAI} {{Nom=@{name}}} {{special1B=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne">
                <div class="OD"><input type="text" name="attr_ODAI6" value="2" readonly /></div>
                <span class="type" data-i18n="arme-improvisee-od2-exemple3">Voiture, véhicule de taille moyenne, etc.</span>
                
                <input type="hidden" name="attr_nbDDgts6" value="5" readonly />
                <input type="hidden" name="attr_AIstylesDB6" value="{{styleDgtBM=[[@{dgts6}]]}}" />
                <input type="hidden" name="attr_AIstylesVB6" value="{{styleViolBM=[[ (floor([[@{nbDDgts6}]]/2))d6]]}}" />
    
                <div class="degats"><input type="text" name="attr_dgts6" value="5D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence6" value="5D6" readonly /></div>
                <div class="jet">
                    <input type="number" name="attr_utilisation6" value="2" readonly />
                    <button class="rollDice" type="action" name="act_AI6" value="@{jetGM} @{utilisationArmeAI} {{Nom=@{name}}} {{special1B=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne separationTop">
                <div class="OD"><input type="text" name="attr_ODAI7" value="3" readonly /></div>
                <span class="type" data-i18n="arme-improvisee-od3-exemple1">Charpente métallique, gros arbre, etc.</span>
                
                <input type="hidden" name="attr_nbDDgts7" value="7" readonly />
                <input type="hidden" name="attr_AIstylesDB7" value="{{styleDgtBM=[[@{dgts7}]]}}" />
                <input type="hidden" name="attr_AIstylesVB7" value="{{styleViolBM=[[ (floor([[@{nbDDgts7}]]/2))d6]]}}" />
    
                <div class="degats"><input type="text" name="attr_dgts7" value="7D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence7" value="5D6" readonly /></div>
                <div class="jet">
                    <input type="number" name="attr_utilisation7" value="3" readonly />
                    <button class="rollDice" type="action" name="act_AI7" value="@{jetGM} @{utilisationArmeAI} {{Nom=@{name}}} {{special1B=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne">
                <div class="OD"><input type="text" name="attr_ODAI8" value="3" readonly /></div>
                <span class="type" data-i18n="arme-improvisee-od3-exemple2">Façade de maison, morceau de route, rails, etc.</span>
                
                <input type="hidden" name="attr_nbDDgts8" value="5" readonly />
                <input type="hidden" name="attr_AIstylesDB8" value="{{styleDgtBM=[[@{dgts8}]]}}" />
                <input type="hidden" name="attr_AIstylesVB8" value="{{styleViolBM=[[ (floor([[@{nbDDgts8}]]/2))d6]]}}" />
    
                <div class="degats"><input type="text" name="attr_dgts8" value="5D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence8" value="7D6" readonly /></div>
                <div class="jet">
                    <input type="number" name="attr_utilisation8" value="1" readonly />
                    <button class="rollDice" type="action" name="act_AI8" value="@{jetGM} @{utilisationArmeAI} {{Nom=@{name}}} {{special1B=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne">
                <div class="OD"><input type="text" name="attr_ODAI9" value="3" readonly /></div>
                <span class="type" data-i18n="arme-improvisee-od3-exemple3">Camionnette, gros 4x4, etc.</span>
                
                <input type="hidden" name="attr_nbDDgts9" value="6" readonly />
                <input type="hidden" name="attr_AIstylesDB9" value="{{styleDgtBM=[[@{dgts9}]]}}" />
                <input type="hidden" name="attr_AIstylesVB9" value="{{styleViolBM=[[ (floor([[@{nbDDgts9}]]/2))d6]]}}" />
    
                <div class="degats"><input type="text" name="attr_dgts9" value="6D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence9" value="6D6" readonly /></div>
                <div class="jet">
                    <input type="number" name="attr_utilisation9" value="2" readonly />
                    <button class="rollDice" type="action" name="act_AI9" value="@{jetGM} @{utilisationArmeAI} {{Nom=@{name}}} {{special1B=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne separationTop">
                <div class="OD"><input type="text" name="attr_ODAI10" value="4" readonly /></div>
                <span class="type" data-i18n="arme-improvisee-od4-exemple1">Façade de petit immeuble, remorque de camion, etc.</span>
                
                <input type="hidden" name="attr_nbDDgts10" value="7" readonly />
                <input type="hidden" name="attr_AIstylesDB10" value="{{styleDgtBM=[[@{dgts10}]]}}" />
                <input type="hidden" name="attr_AIstylesVB10" value="{{styleViolBM=[[ (floor([[@{nbDDgts10}]]/2))d6]]}}" />
    
                <div class="degats"><input type="text" name="attr_dgts10" value="7D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence10" value="9D6" readonly /></div>
                <div class="jet">
                    <input type="number" name="attr_utilisation10" value="1" readonly />
                    <button class="rollDice" type="action" name="act_AI10" value="@{jetGM} @{utilisationArmeAI} {{Nom=@{name}}} {{special1B=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne">
                <div class="OD"><input type="text" name="attr_ODAI11" value="4" readonly /></div>
                <span class="type" data-i18n="arme-improvisee-od4-exemple2">Camion, petit véhicule de chantier, etc.</span>
                
                <input type="hidden" name="attr_nbDDgts11" value="8" readonly />
                <input type="hidden" name="attr_AIstylesDB11" value="{{styleDgtBM=[[@{dgts11}]]}}" />
                <input type="hidden" name="attr_AIstylesVB11" value="{{styleViolBM=[[ (floor([[@{nbDDgts11}]]/2))d6]]}}" />
    
                <div class="degats"><input type="text" name="attr_dgts11" value="8D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence11" value="8D6" readonly /></div>
                <div class="jet">
                    <input type="number" name="attr_utilisation11" value="2" readonly />
                    <button class="rollDice" type="action" name="act_AI11" value="@{jetGM} @{utilisationArmeAI} {{Nom=@{name}}} {{special1B=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne separationTop">
                <div class="OD"><input type="text" name="attr_ODAI12" value="5" readonly /></div>
                <span class="type" data-i18n="arme-improvisee-od5-exemple1">Façade d'immeuble, grue, container plein, etc.</span>
                
                <input type="hidden" name="attr_nbDDgts12" value="10" readonly />
                <input type="hidden" name="attr_AIstylesDB12" value="{{styleDgtBM=[[@{dgts12}]]}}" />
                <input type="hidden" name="attr_AIstylesVB12" value="{{styleViolBM=[[ (floor([[@{nbDDgts12}]]/2))d6]]}}" />
    
                <div class="degats"><input type="text" name="attr_dgts12" value="10D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence12" value="12D6" readonly /></div>
                <div class="jet">
                    <input type="number" name="attr_utilisation12" value="1" readonly />
                    <button class="rollDice" type="action" name="act_AI12" value="@{jetGM} @{utilisationArmeAI} {{Nom=@{name}}} {{special1B=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne">
                <div class="OD"><input type="text" name="attr_ODAI13" value="5" readonly /></div>
                <span class="type" data-i18n="arme-improvisee-od5-exemple2">Yacht de 20 mètres, blindé, mécha-armure, etc.</span>
                
                <input type="hidden" name="attr_nbDDgts13" value="11" readonly />
                <input type="hidden" name="attr_AIstylesDB13" value="{{styleDgtBM=[[@{dgts13}]]}}" />
                <input type="hidden" name="attr_AIstylesVB13" value="{{styleViolBM=[[ (floor([[@{nbDDgts13}]]/2))d6]]}}" />
    
                <div class="degats"><input type="text" name="attr_dgts13" value="11D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence13" value="11D6" readonly /></div>
                <div class="jet">
                    <input type="number" name="attr_utilisation13" value="2" readonly />
                    <button class="rollDice" type="action" name="act_AI13" value="@{jetGM} @{utilisationArmeAI} {{Nom=@{name}}} {{special1B=^{armes-improvisees}}}"></button>
                </div>
            </div>
        </div>
    </div>

    <div class="subTabAutre">
        <h1 class="titre" data-i18n="autres-armes">Autres Armes</h1>
        <div class="ligneTitre">
            <div class="firstCol">
                <span data-i18n="arme">Arme</span>
            </div>
            <div class="midCol">
                <span data-i18n="degats">Dégâts</span>
            </div>
            <div class="midCol">
                <span data-i18n="violence">Violence</span>
            </div>
            <div class="midCol">
                <span data-i18n="portee">Portée</span>
            </div>
            <div class="midCol">
                <span data-i18n="attaque">Attaque</span>
            </div>
            <div class="lastCol">
                <span data-i18n="overdrives">Overdrives</span>
            </div>
        </div>
        <div class="armesListe">
            <fieldset class="repeating_armeAutre">
                <input class="subMenu" type="hidden" name="attr_armeAutreOptions" value="0" />

                <div class="ligne">
                    <div class="firstCol armeNom">
                        <input type="text" name="attr_ArmeAutre" />
                    </div>
                    <div class="midCol armeDegats">
                        <input class="nbre" type="number" name="attr_armeAutreDegat" class="textCenter" value="0" />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_armeAutreBDegat" class="textCenter" value="0" />
                    </div>
                    <div class="midCol armeViolence">
                        <input class="nbre" type="number" name="attr_armeAutreViolence" class="textCenter" value="0" />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_armeAutreBViolence" class="textCenter" value="0" />
                    </div>
                    <div class="midCol armePortee">
                        <select name="attr_armeAutrePortee">
                            <option value="^{portee-contact}" data-i18n="portee-contact" selected>Contact</option>
                            <option value="^{portee-courte}" data-i18n="portee-courte">Courte</option>
                            <option value="^{portee-moyenne}" data-i18n="portee-moyenne">Moyenne</option>
                            <option value="^{portee-longue}" data-i18n="portee-longue">Longue</option>
                            <option value="^{portee-lointaine}" data-i18n="portee-lointaine">Lointaine</option>
                        </select>
                    </div>
                    <div class="midCol armeAttaque">
                        <input class="nbre" type="number" name="attr_armeAttaqueAutre" value="0" />
                        <b>D6+</b>
                    </div>
                    <div class="lastCol armeJet">
                        <input class="bonus" type="number" name="attr_armeODAutre" value="0" />
                        <button class="rollDice" type="action" name="act_armeautrepj" value="@{jetGM} &{template:combat} {{Nom=@{name}}}"></button>
                    </div>
                </div>

                <div class="subMenu">
                    <button class="effets" type="action" name="act_armeautreoptions-1" data-i18n="effets">Effets</button>
                    <button class="ameliorationsArmes BL" type="action" name="act_armeautreoptions-3" data-i18n="ameliorations-d'armes">Améliorations d'armes</button>
                    <button class="special BL" type="action" name="act_armeautreoptions-4" data-i18n="special">Spécial</button>
                </div>

                <div class="effets">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_antiAnatheme" value="{{antiAnathème=Anti Anathème}}" />
                        <span data-i18n-title="anti-anatheme" title="Anti Anathème"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_antiVehicule" value="{{antiVehicule=Anti Véhicule}} " />
                        <span data-i18n-title="anti-vehicule" title="Anti Véhicule"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_artillerie" value="{{artillerie=Artillerie}}" />
                        <span data-i18n-title="artillerie" title="Artillerie"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_assassin" value="{{assassin=[[@{assassinValue}d6]]}} " />
                            <span data-i18n-title="assassin" title="Assassin"></span>
                        </label>
                    
                        <input type="number" name="attr_assassinValue" class="center" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_assistanceAttaque" value="{{assistanceAttaque=Assistance à l'attaque}}" />
                        <span data-i18n-title="assistance-attaque" title="Assistance à l'attaque"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_barrage" value="{{barrage=^{barrage} @{barrageValue}}} " />
                            <span data-i18n-title="barrage" title="Barrage"></span>
                        </label>
                    
                        <input type="number" name="attr_barrageValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_cadence" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                            <span data-i18n-title="cadence" title="Cadence"></span>
                        </label>
                    
                        <input type="number" name="attr_cadenceValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_chargeur" value="{{chargeur=^{chargeur} @{chargeurValue}}} " />
                            <span data-i18n-title="chargeur" title="Chargeur"></span>
                        </label>
                    
                        <input type="number" name="attr_chargeurValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_choc" value="{{choc=^{choc} @{chocValue}}}" />
                            <span data-i18n-title="choc" title="Choc"></span>
                        </label>
                    
                        <input type="number" name="attr_chocValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_defense" value="{{defense=^{defense} @{defenseValue}}}" />
                            <span data-i18n-title="defense" title="Défense"></span>
                        </label>
                    
                        <input type="number" name="attr_defenseValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_degatContinue" value="{{degatContinus=^{degats-continus} @{degatContinueValue} ([[1D6]] ^{tours})}}" />
                            <span data-i18n-title="degats-continus" title="Dégâts Continus"></span>
                        </label>
                    
                        <input type="number" name="attr_degatContinueValue" class="center" size="2" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_deuxMains" value="{{deuxMains=Deux Mains}}" />
                        <span data-i18n-title="deux-mains" title="Deux Mains"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_demoralisant" value="{{demoralisant=Démoralisant}}" />
                        <span data-i18n-title="demoralisant" title="Démoralisant"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_designation" value="{{designation=Désignation}}" />
                        <span data-i18n-title="designation" title="Désignation"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_destructeur" value="{{destructeur=[[2D6]]}}" />
                        <span data-i18n-title="destructeur" title="Destructeur"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_dispersion" value="{{dispersion=^{dispersion} @{dispersionValue}}} " />
                            <span data-i18n-title="dispersion" title="Dispersion"></span>
                        </label>
                    
                        <input type="number" name="attr_dispersionValue" class="center" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_enChaine" value="{{enChaine=En Chaîne}}" />
                        <span data-i18n-title="en-chaine" title="En Chaîne"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_esperance" value="{{esperance=Espérance}}" />
                        <span data-i18n-title="esperance" title="Espérance"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_fureur" value="{{fureur=[[4D6]]}}" />
                        <span data-i18n-title="fureur" title="Fureur"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ignoreArmure" value="{{ignoreArmure=Ignore Armure}}" />
                        <span data-i18n-title="ignore-armure" title="Ignore Armure"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ignoreCdF" value="{{ignoreCdF=Ignore Champs de Force}}" />
                        <span data-i18n-title="ignore-champ-de-force" title="Ignore CdF"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_akimbo" value="2" />
                        <span data-i18n-title="jumele-akimbo" title="Jumelé (Akimbo)"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ambidextrie" value="2" />
                        <span data-i18n-title="jumele-ambidextrie" title="Jumelé (Ambidextrie)"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_leste" value="{{leste=[[@{force}]]}}" />
                        <span data-i18n-title="leste" title="Lesté"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_lourd" value="1" />
                        <span data-i18n-title="lourd" title="Lourd"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_lumiere" value="{{lumiere=^{lumiere} @{lumiereValue}}}" />
                            <span data-i18n-title="lumiere" title="Lumière"></span>
                        </label>
                    
                        <input type="number" name="attr_lumiereValue" class="center" size="2" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_meurtrier" value="{{meurtrier=[[2D6]]}}" />
                        <span data-i18n-title="meutrier" title="Meurtrier"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_obliteration" value="{{obliteration=Oblitération}}" />
                        <span data-i18n-title="obliteration" title="Oblitération"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_orfevrerie" value="{{orfevrerie=[[@{dexterite}+@{dextOD}]]}} {{orfevrerieWarrior=[[@{dexterite}+@{dextOD}+@{warriorScoutA}]]}}" />
                        <span data-i18n-title="orfevrerie" title="Orfèvrerie"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_parasitage" value="{{parasitage=^{parasitage} @{parasitageValue}}}" />
                            <span data-i18n-title="parasitage" title="Parasitage"></span>
                        </label>
                    
                        <input type="number" name="attr_parasitageValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_penetrant" value="{{penetrant=^{penetrant} @{penetrantValue}}}" />
                            <span data-i18n-title="penetrant" title="Pénétrant"></span>
                        </label>
                    
                        <input type="number" name="attr_penetrantValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_perceArmure" value="{{perceArmure=^{perce-armure} @{perceArmureValue}}}" />
                            <span data-i18n-title="perce-armure" title="Perce Armure"></span>
                        </label>
                    
                        <input type="number" name="attr_perceArmureValue" class="center" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_precision" value="{{precision=[[@{tir}+@{tirOD}]]}} {{precisionWarrior=[[@{tir}+@{tirOD}+@{warriorScholarA}]]}}" />
                        <span data-i18n-title="precision" title="Précision"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_reaction" value="{{reaction=^{reaction} @{reactionValue}}}" />
                            <span data-i18n-title="reaction" title="Réaction"></span>
                        </label>
                    
                        <input type="number" name="attr_reactionValue" class="center" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_silencieux" value="{{silencieux=Silencieux}}" />
                        <span data-i18n-title="silencieux" title="Silencieux"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_soumission" value="{{soumission=Soumission}}" />
                        <span data-i18n-title="soumission" title="Soumission"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_tenebricite" value="{{tenebricide=Ténébricide}}" />
                        <span data-i18n-title="tenebricide" title="Ténébricide"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_tirRafale" value="{{tirRafale=Tir en Rafale}}" />
                        <span data-i18n-title="tir-rafale" title="Tir en Rafale"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_tirSecurite" value="3" />
                        <span data-i18n-title="tir-securite" title="Tir en Sécurité"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ultraViolence" value="{{ultraviolence=[[2D6]]}}" />
                        <span data-i18n-title="ultraviolence" title="Ultraviolence"></span>
                    </label>
                </div>
                <div class="ameliorationsArmes">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_chargeurGrappes" value="1" />
                        <span data-i18n-title="balles-grappes" title="Balles grappes"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_canonLong" value="{{canonLongM=1}} {{canonLongC=Canon Long (Portée Courte : +3 Difficulté)}}" />
                        <span data-i18n-title="canon-long" title="Canon Long"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_canonRaccourci" value="{{canonRaccourci=Canon Raccourci (Portée Courte : Dispersion 3 / Sinon : +3 Difficulté)}}" />
                        <span data-i18n-title="canon-raccourci" title="Canon Raccourci"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_chambreDouble" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                        <span data-i18n-title="chambre-double" title="Chambre Double"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_interfaceGuidage" value="3" />
                        <span data-i18n-title="interface-guidage" title="Interface de guidage"></span>
                    </label>
                    <div class="doubleTexte">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_jumelage" value="{{jumelage=^{jumelage} (@{jumelageValue})}}" />
                            <span data-i18n-title="jumelage" title="Jumelage :"></span>
                        </label>
                    
                        <input type="text" name="attr_jumelageValue" class="borderBottom" />
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_jumelageType" value="ambidextrie" />
                            <span data-i18n-title="ambidextrie" title="Ambidextrie"></span>
                        </label>
                        <label class="fakeButton borderTop">
                            <input type="checkbox" name="attr_jumelageType" value="akimbo" />
                            <span data-i18n-title="akimbo" title="Akimbo"></span>
                        </label>
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_lunetteIntelligente" value="{{lunetteIntelligente=Lunette Intelligente (+1 Portée)}}" />
                        <span data-i18n-title="lunette-intelligente" title="Lunette Intelligente"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsHyperVelocite" value="{{munitionsHyperVelocite=Munitions à Hyper Velocite (Assistance à l'Attaque)}}" />
                        <span data-i18n-title="munitions-hyper-velocite-short" title="Munitions à H. Vélocité"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsDrone" value="{{munitionsDrone=3}}" />
                        <span data-i18n-title="munitions-drones" title="Munitions Drones"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_chargeurExplosives" value="1" />
                        <span data-i18n-title="munitions-explosives" title="Munitions Explosives"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsIEM" value="1" />
                        <span data-i18n-title="munitions-iem" title="Munitions IEM"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsNonLetales" value="2" />
                        <span data-i18n-title="munitions-non-letales-short" title="Munitions N. Létales"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsSubsoniques" value="{{munitionsSubsoniques=Munitions Subsoniques (Silencieux)}}" />
                        <span data-i18n-title="munitions-subsoniques" title="Munitions Subsoniques"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pointeurLaser" value="{{pointeurLaser=1}} " />
                        <span data-i18n-title="pointeur-laser" title="Pointeur Laser"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_protectionArme" value="{{protectionArme=Protection d'Arme (Reaction +2)}}" />
                        <span data-i18n-title="pointeur-d'arme" title="Protection d'Arme"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_revetementOmega" value="2" />
                        <span data-i18n-title="revetement-omega" title="Revêtement Omega"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_structureElement" value="{{structureElement=Structure en Élément}}" />
                        <span data-i18n-title="structure-element-alpha-short" title="Structure Alpha"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_systemeRefroidissement" value="{{systemeRefroidissement=Système de Refroidissement (Tir en Rafale + Barrage 1)}}" />
                        <span data-i18n-title="systeme-refroidissement-short" title="Système de Refroid."></span>
                    </label>
                </div>
                <div class="special">
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_energie" value="{{energie=@{energieValue}}} " />
                            <span data-i18n-title="energie" title="Énergie"></span>
                        </label>
                    
                        <input type="number" name="attr_energieValue" class="center" value="0" />
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_bDDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_bDDiversTotal" value="{{BDDivers=[[@{bDDiversD6}D6+@{bDDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-degats" title="Bonus aux dégâts"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_bDDiversD6" class="center" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_bDDiversFixe" class="center" value="0" />
                        </div>
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_bVDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_bVDiversTotal" value="{{BVDivers=[[@{bVDiversD6}D6+@{bVDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-violence" title="Bonus à la violence"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_bVDiversD6" class="center" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_bVDiversFixe" class="center" value="0" />
                        </div>
                    </div>
                </div>
            </fieldset>
        </div>
    </div>
</div><div class="fichePNJ ficheCreature ficheBande subTabArmure">
    <div class="col">
        <div class="AEBlock marginTop">
            <input type="hidden" name="attr_ChairPNJAE" value="0" class="AEChairMineur" />
            <input type="hidden" name="attr_ChairPNJAEMaj" value="0" class="AEChairMajeur" />
            <input type="hidden" name="attr_BetePNJAE" value="0" class="AEBeteMineur" />
            <input type="hidden" name="attr_BetePNJAEMaj" value="0" class="AEBeteMajeur" />
            <input type="hidden" name="attr_MachinePNJAE" value="0" class="AEMachineMineur" />
            <input type="hidden" name="attr_MachinePNJAEMaj" value="0" class="AEMachineMajeur" />
            <input type="hidden" name="attr_DamePNJAE" value="0" class="AEDameMineur" />
            <input type="hidden" name="attr_DamePNJAEMaj" value="0" class="AEDameMajeur" />
            <input type="hidden" name="attr_MasquePNJAE" value="0" class="AEMasqueMineur" />
            <input type="hidden" name="attr_MasquePNJAEMaj" value="0" class="AEMasqueMajeur" />

            <div class="AEChair AE">
                <h1 class="titre" data-i18n="chair">Chair</h1>
                <div class="Mineur">
                    <span data-i18n="mineur">Mineur</span>
                    <span data-i18n="aspect-exceptionnel-chair-mineur">
                        Le PNJ soustrait toujours son score de l’aspect exceptionnel Chair aux dégâts qu’il reçoit.
                    </span>
                </div>
    
                <div class="Majeur">
                    <span data-i18n="majeur">Majeur</span>
                    <span data-i18n="aspect-exceptionnel-chair-majeur">
                        Le PNJ ignore purement les effets barrage X, choc X et meurtrier des armes.
                    </span>
                </div>
            </div>
    
            <div class="AEBete AE">
                <h1 class="titre" data-i18n="bete">Bête</h1>
                <div class="Mineur">
                    <span data-i18n="mineur">Mineur</span>
                    <span data-i18n="aspect-exceptionnel-bete-mineur">
                        (Déjà inclus) Le PNJ ajoute à ses dégâts au contact son score de l’aspect exceptionnel Bête.
                    </span>
                </div>
                <div class="Majeur">
                    <span data-i18n="majeur">Majeur</span>
                    <span data-i18n="aspect-exceptionnel-bete-majeur">
                        (Déjà inclus)  Le PNJ ajoute à ses dégâts au contact son score de l’aspect Bête (en plus du score de l’aspect exceptionnel).
                    </span>
                </div>
            </div>
    
            <div class="AEMachine AE">
                <h1 class="titre" data-i18n="machine">Machine</h1>
                <div class="Mineur">
                    <span data-i18n="mineur">Mineur</span>
                    <span data-i18n="aspect-exceptionnel-machine-mineur">
                        (Déjà inclus) Le PNJ ajoute son score de Machine exceptionnelle à son score de réaction.
                    </span>
                </div>
    
                <div class="Majeur">
                    <span data-i18n="majeur">Majeur</span>
                    <span data-i18n="aspect-exceptionnel-machine-majeur">
                        Le PNJ est insensible aux capacités d’armure qui jouent sur les sens telles que le mode Ghost ou le mode Changeling. L’invisibilité comme les illusions ou les leurres n’ont pas d’effet sur lui.
                    </span>
                </div>
            </div>
    
            <div class="AEDame AE">
                <h1 class="titre" data-i18n="dame">Dame</h1>
                <div class="Mineur">
                    <span data-i18n="mineur">Mineur</span>
                    <span data-i18n="aspect-exceptionnel-dame-mineur">Le PNJ, s’il est accompagné d’autres PNJ de la même faction que lui, peut toujours décider de reporter les dégâts qu’il subit sur des alliés proches, à portée courte. Cela représente le fait que des PNJ alliés s’interposent pour sauvegarder sa vie.</span>
                </div>
    
                <div class="Majeur">
                    <span data-i18n="majeur">Majeur</span>
                    <span data-i18n="aspect-exceptionnel-dame-majeur">Un PJ qui souhaite attaquer ce PNJ doit réussir un test base Hargne dont la difficulté est égale au score de la Dame exceptionnelle du PNJ. S’il ne réussit pas ce test, il est subjugué par le PNJ et ne se résout pas à l’attaquer.</span>
                </div>
            </div>
    
            <div class="AEMasque AE">
                <h1 class="titre" data-i18n="masque">Masque</h1>
                <div class="Mineur">
                    <span data-i18n="mineur">Mineur</span>
                    <span data-i18n="aspect-exceptionnel-masque-mineur">
                        (Déjà inclus) Le PNJ ajoute son score de Masque exceptionnel à son score de défense.
                    </span>
                </div>
    
                <div class="Majeur">
                    <span data-i18n="majeur">Majeur</span>
                    <span data-i18n="aspect-exceptionnel-masque-majeur">
                        (Déjà inclus) Le PNJ agit toujours, peu importe son nombre d’actions, comme s’il avait un score d’initiative de 30. Le MJ ne lance pas les dés.
                    </span>
                </div>
            </div>
        </div>
    </div>

    <div class="col">
        <div class="capacitesFanMade marginTop">
            <h1 class="titre" data-i18n="capacites-fan-made">Capacités Fan Made</h1>
            <div>
                <label class="fakeButton">
                    <input type="checkbox" name="attr_attaqueOmbre" value="{{AttaqueOmbre=[[@{masque}]]}}" />
                    <span data-i18n-title="capacite-fan-made-Attaque-dans-les-ombres" title="Attaque dans les Ombres"></span>
                </label>
            </div>
        </div>

        <div class="capacitesSpeciales marginTop">
            <h1 class="titre" data-i18n="capacites-speciales">Capacités spéciales</h1>
            <div>
                <button class="phase2" type="action" name="act_phase2" data-i18n="capacites-speciales-phase-2">Phase 2</button>
            </div>
        </div>

        <div class="capacites marginTop">
            <h1 class="titre" data-i18n="capacites">Capacités</h1>
            <fieldset class="repeating_capacites">
                <details>
                    <summary>
                        <input type="text" name="attr_nomCapacite" />
                    </summary>
                    <div class="autoex autoex24">
                        <span name="attr_descCapacite"></span>
                        <textarea name="attr_descCapacite"></textarea>
                    </div>
                </details>                
            </fieldset>
        </div>

        <div class="phase2 capacitePhase2 marginTop">
            <h1 class="titre" data-i18n="capacites-speciales-phase-2">Phase 2</h1>
            <div class="autoex autoex24">
                <span name="attr_descPhase2"></span>
                <textarea name="attr_descPhase2"></textarea>
            </div>
            <fieldset class="repeating_capacitesPhase2">
                <details>
                    <summary>
                        <input type="text" name="attr_nomCapacitePhase2" />
                    </summary>
                    <div class="autoex autoex24">
                        <span name="attr_descCapacitePhase2"></span>
                        <textarea name="attr_descCapacitePhase2"></textarea>
                    </div>
                </details>                
            </fieldset>
        </div>

        <div class="ficheBande notes marginTop">
            <h1 class="titre" data-i18n="notes">Notes</h1>
            <div class="autoex autoex22">
                <span name="attr_pnjCapaciteNotes"></span>
                <textarea name="attr_pnjCapaciteNotes" class="largeTextarea"></textarea>
            </div>
            <fieldset class="repeating_notesJoueur">
                <div class="autoex autoex24">
                    <span name="attr_notesJoueur"></span>
                    <textarea name="attr_notesJoueur" class="largeTextarea"></textarea>
                </div>
            </fieldset>
        </div>
    </div>
</div><div class="fichePNJ ficheCreature ficheBande armesPNJ">
    <div class="subTabMelee">
        <input class="armeSection1" type="hidden" name="attr_armeSPS" value="0" />
        <input class="armeSection2" type="hidden" name="attr_armeSME" value="0"/>

        <h1 class="titre" data-i18n="armes-contact">Armes de Contact</h1>
        <div class="ligneTitre">
            <div class="firstCol">
                <span data-i18n="arme">Arme</span>
            </div>
            
            <div class="midColL">
                <span data-i18n="degats">Dégâts</span>
            </div>
            <div class="midCol">
                <span data-i18n="violence">Violence</span>
            </div>
            <div class="midCol">
                <span data-i18n="portee">Portée</span>
            </div>
            
            <div class="lastCol">
                <span data-i18n="jet">Jet</span>
            </div>
        </div>
        <div class="armesListe">
            <div class="armeSection1">
                <input class="subMenu" type="hidden" name="attr_pSContactOptions" value="0" />
                
                <div class="ligne">
                    <div class="firstCol armeNom"><input type="text" name="attr_pSCaC" value="Couteau de Service" readonly /></div>
                    <div class="midColL armeDegats">
                        <div>
                            <input class="nbre" type="number" name="attr_pSCaCDegat" value="1" readonly  />
                            <b>D6+</b>
                            <input class="bonus" type="number" name="attr_pSCaCBDegat" value="0" readonly />
                        </div>
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSCAddChair" value="1" />
                            <span data-i18n-title="ajouter Chair / 2" title="+ Ajouter Chair/2"></span>
                        </label>
                    </div>
                    <div class="midCol armeViolence">
                        <input class="nbre" type="number" name="attr_pSCaCViolence" value="0" readonly />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_pSCaCBViolence" value="1" readonly />
                    </div>
                    <div class="midCol armePortee">
                        <select name="attr_pSCaCPortee">
                            <option value="^{portee-contact}" data-i18n="portee-contact" selected>Contact</option>
                        </select>
                    </div>
                    <div class="lastCol armeAspect">
                        <select name="attr_pSCAspectPNJ">
                            <option value="0" selected></option>
                            <option value="@{Chair}" data-i18n="chair">Chair</option>
                            <option value="@{Bete}" data-i18n="bete">Bête</option>
                            <option value="@{Machine}" data-i18n="machine">Machine</option>
                            <option value="@{Dame}" data-i18n="dame">Dame</option>
                            <option value="@{Masque}" data-i18n="masque">Masque</option>
                        </select>
                        <button class="rollDice" type="action" name="act_pSContactPNJ" value="@{jetGM} &{template:combat} {{Nom=@{name}}}"></button>
                    </div>
                </div>
                <div class="subMenu">
                    <button class="effets" type="action" name="act_pSContactOptions_1" data-i18n="effets">Effets</button>
                    <button class="ameliorationsStructurelles BL" type="action" name="act_pSContactOptions_2" data-i18n="ameliorations-structurelles">Améliorations Structurelles</button>
                    <button class="ameliorationsArmes BL" type="action" name="act_pSContactOptions_3" data-i18n="ameliorations-d'armes">Améliorations d'armes</button>
                    <button class="special BL" type="action" name="act_pSContactOptions_4" data-i18n="special">Spécial</button>
                </div>
                
                <div class="effets">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCanatheme" value="{{anatheme=Anathème}}" />
                        <span data-i18n-title="anatheme" title="Anathème"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCantiAnatheme" value="{{antiAnathème=Anti Anathème}}" />
                        <span data-i18n-title="anti-anatheme" title="Anti Anathème"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCantiVehicule" value="{{antiVehicule=Anti Véhicule}} " />
                        <span data-i18n-title="anti-vehicule" title="Anti Véhicule"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCartillerie" value="{{artillerie=Artillerie}}" />
                        <span data-i18n-title="artillerie" title="Artillerie"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSCassassin" value="{{assassin=[[@{pSCassassinValue}d6]]}} " />
                            <span data-i18n-title="assassin" title="Assassin"></span>
                        </label>
                    
                        <input type="number" name="attr_pSCassassinValue" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCassistanceAttaque" value="{{assistanceAttaque=Assistance à l'attaque}}" />
                        <span data-i18n-title="assistance-attaque" title="Assistance à l'attaque"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSCbarrage" value="{{barrage=^{barrage} @{pSCbarrageValue}}} " />
                            <span data-i18n-title="barrage" title="Barrage"></span>
                        </label>
                    
                        <input type="number" name="attr_pSCbarrageValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSCcadence" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                            <span data-i18n-title="cadence" title="Cadence"></span>
                        </label>
                    
                        <input type="number" name="attr_pSCcadenceValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSCchargeur" value="{{chargeur=^{chargeur} @{pSCchargeurValue}}} " />
                            <span data-i18n-title="chargeur" title="Chargeur"></span>
                        </label>
                    
                        <input type="number" name="attr_pSCchargeurValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSCchoc" value="{{choc=^{choc} @{pSCchocValue}}}" />
                            <span data-i18n-title="choc" title="Choc"></span>
                        </label>
                    
                        <input type="number" name="attr_pSCchocValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSCdefense" value="{{defense=^{defense} @{pSCdefenseValue}}}" />
                            <span data-i18n-title="defense" title="Défense"></span>
                        </label>
                    
                        <input type="number" name="attr_pSCdefenseValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSCdegatContinue" value="{{degatContinus=^{degats-continus} @{pSCdegatContinueValue} ([[1D6]] ^{tours})}}" />
                            <span data-i18n-title="degats-continus" title="Dégâts Continus"></span>
                        </label>
                    
                        <input type="number" name="attr_pSCdegatContinueValue" size="2" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCdeuxMains" value="{{deuxMains=Deux Mains}}" />
                        <span data-i18n-title="deux-mains" title="Deux Mains"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCdemoralisant" value="{{demoralisant=Démoralisant}}" />
                        <span data-i18n-title="demoralisant" title="Démoralisant"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCdesignation" value="{{designation=Désignation}}" />
                        <span data-i18n-title="designation" title="Désignation"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCdestructeur" value="{{destructeur=[[2D6]]}}" />
                        <span data-i18n-title="destructeur" title="Destructeur"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSCdispersion" value="{{dispersion=^{dispersion} @{pSCdispersionValue}}} " />
                            <span data-i18n-title="dispersion" title="Dispersion"></span>
                        </label>
                    
                        <input type="number" name="attr_pSCdispersionValue" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCenChaine" value="{{enChaine=En Chaîne}}" />
                        <span data-i18n-title="en-chaine" title="En Chaîne"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCesperance" value="{{esperance=Espérance}}" />
                        <span data-i18n-title="esperance" title="Espérance"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCfureur" value="{{fureur=[[4D6]]}}" />
                        <span data-i18n-title="fureur" title="Fureur"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCignoreArmure" value="{{ignoreArmure=Ignore Armure}}" />
                        <span data-i18n-title="ignore-armure" title="Ignore Armure"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCignoreCdF" value="{{ignoreCdF=Ignore Champs de Force}}" />
                        <span data-i18n-title="ignore-champ-de-force" title="Ignore CdF"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCakimbo" value="2" />
                        <span data-i18n-title="jumele-akimbo" title="Jumelé (Akimbo)"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCambidextrie" value="2" />
                        <span data-i18n-title="jumele-ambidextrie" title="Jumelé (Ambidextrie)"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSClestePNJ" value="{{leste=[[@{Chair}]]}}" />
                        <span data-i18n-title="leste" title="Lesté"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSClourd" value="1" />
                        <span data-i18n-title="lourd" title="Lourd"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSClumiere" value="{{lumiere=^{lumiere} @{pSClumiereValue}}}" />
                            <span data-i18n-title="lumiere" title="Lumière"></span>
                        </label>
                    
                        <input type="number" name="attr_pSClumiereValue" size="2" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCmeurtrier" value="{{meurtrier=[[2D6]]}}" />
                        <span data-i18n-title="meutrier" title="Meurtrier"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCobliteration" value="{{obliteration=Oblitération}}" />
                        <span data-i18n-title="obliteration" title="Oblitération"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCorfevreriePNJ" value="{{orfevrerie=[[ceil(@{masque}/2)]]}}" />
                        <span data-i18n-title="orfevrerie" title="Orfèvrerie"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSCparasitage" value="{{parasitage=^{parasitage} @{pSCparasitageValue}}}" />
                            <span data-i18n-title="parasitage" title="Parasitage"></span>
                        </label>
                    
                        <input type="number" name="attr_pSCparasitageValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSCpenetrant" value="{{penetrant=^{penetrant} @{pSCpenetrantValue}}}" />
                            <span data-i18n-title="penetrant" title="Pénétrant"></span>
                        </label>
                    
                        <input type="number" name="attr_pSCpenetrantValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSCperceArmure" value="{{perceArmure=^{perce-armure} @{pSCperceArmureValue}}}" />
                            <span data-i18n-title="perce-armure" title="Perce Armure"></span>
                        </label>
                    
                        <input type="number" name="attr_pSCperceArmureValue" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCprecisionPNJ" value="{{precision=[[(ceil((@{machine})/2))]]}}" />
                        <span data-i18n-title="precision" title="Précision"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSCreaction" value="{{reaction=^{reaction} @{pSCreactionValue}}}" />
                            <span data-i18n-title="reaction" title="Réaction"></span>
                        </label>
                    
                        <input type="number" name="attr_pSCreactionValue" value="0" />
                    </div>
                    <label class="simple fakeButton checked">
                        <span data-i18n-title="silencieux" title="Silencieux"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCsoumission" value="{{soumission=Soumission}}" />
                        <span data-i18n-title="soumission" title="Soumission"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCtenebricite" value="{{tenebricide=Ténébricide}}" />
                        <span data-i18n-title="tenebricide" title="Ténébricide"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCtirRafale" value="{{tirRafale=Tir en Rafale}}" />
                        <span data-i18n-title="tir-rafale" title="Tir en Rafale"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCtirSecurite" value="3" />
                        <span data-i18n-title="tir-securite" title="Tir en Sécurité"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCultraViolence" value="{{ultraviolence=[[2D6]]}}" />
                        <span data-i18n-title="ultraviolence" title="Ultraviolence"></span>
                    </label>
                </div>
                <div class="ameliorationsStructurelles">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCagressive" value="{{ASAgressive=[[1d6]]}} {{ASAgressiveL=Agressive}}" />
                        <span data-i18n-title="agressive" title="Agressive"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCallegee" value="1" />
                        <span data-i18n-title="allegee" title="Allégée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCassassine" value="{{silencieux=Silencieux}} {{ASAssassineL=Assassine (Silencieux)}}" />
                        <span data-i18n-title="assassine" title="Assassine"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCbarbelee" value="{{meurtrier=[[2D6]]}} {{ASBarbeleeL=Barbelée (Meurtrier)}}" />
                        <span data-i18n-title="barbelee" title="Barbelée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCconnectee" value="{{ASConnecteeL=Connectée (Assistance à l'attaque)}}" />
                        <span data-i18n-title="connectee" title="Connectée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCelectrifiee" value="{{ASElectrifieeL=Électrifiée (Choc 1)}}" />
                        <span data-i18n-title="electrifiee" title="Électrifiée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCindestructible" value="{{ASIndestructibleL=Indestructible}}" />
                        <span data-i18n-title="indestructible" title="Indestructible"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCjumelle" value="2" />
                        <span data-i18n-title="jumelle" title="Jumelle"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSClumineuse" value="{{ASLumineuseL=Lumineuse (Lumière 2)}}" />
                        <span data-i18n-title="lumineuse" title="Lumineuse"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCmassive" value="{{ASMassiveL=Massive (Défense -1)}} {{ASMassiveD=[[@{force}]]}}" />
                        <span data-i18n-title="massive" title="Massive"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCprotectrice" value="2" />
                        <span data-i18n-title="protectrice" title="Protectrice"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCsoeur" value="2" />
                        <span data-i18n-title="soeur" title="Soeur"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCsournoisePNJ" value="{{orfevrerie=[[ceil(@{Masque}/2)]]}} {{ASSournoiseL=Sournoise (Orfevrerie)}}" />
                        <span data-i18n-title="sournoise" title="Sournoise"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCsurmesurePNJ" value="{{ASSurMesureD=[[ceil(@{bete}/2)]]}}" />
                        <span data-i18n-title="sur-mesure" title="Sur Mesure"></span>
                    </label>
                </div>
                <div class="ameliorationsArmes">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCarabesquesIridescentes" value="{{AOArabesquesIridescentesL=Arabesques Iridescentes (Lumière +1)}}" />
                        <span data-i18n-title="arabesques-iridescentes" title="Arabesques iridescentes"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCarmeAzurine" value="{{AOArmeAzurineD=[[1D6]]}} {{AOArmeAzurineV=[[1D6]]}}" />
                        <span data-i18n-title="arme-azurine" title="Arme azurine"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCarmeRougeSang" value="{{AOArmeRougeSangD=[[1D6]]}} {{AOArmeRougeSangV=[[1D6]]}}" />
                        <span data-i18n-title="arme-rouge-sang" title="Arme rouge sang"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCarmureGravee" value="{{AOArmureGraveeL=Armure Gravée (CdF +2)}}" />
                        <span data-i18n-title="armure-gravee" title="Armure gravée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCblasonChevalier" value="{{AOBlasonChevalier=Blason du Chevalier}}" />
                        <span data-i18n-title="blason-chevalier" title="Blason du chevalier"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCbouclierGrave" value="{{AOBouclierGraveL=Bouclier Gravé (Défense +1)}}" />
                        <span data-i18n-title="bouclier-grave" title="Bouclier gravé"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCcheneSculpte" value="{{AOCheneSculpteD=[[2D6]]}}" />
                        <span data-i18n-title="chene-sculpte" title="Chêne sculpté"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCchromeeLignesLC" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                        <span data-i18n-title="chromee" title="Chromée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCcodeKnightGrave" value="{{AOCodeKnightGraveL=Code du Knight Gravé (-1 Perte d'Espoir)}}" />
                        <span data-i18n-title="code-knight-grave" title="Code du knight gravé"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCcraneRieurGrave" value="{{AOCraneRieurGraveL=Crâne Rieur Gravé (Oblitération)}}" />
                        <span data-i18n-title="crane-rieur-grave" title="Crâne rieur gravé"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCfaucheuseGravee" value="{{AOFaucheuseGraveeD=[[1D6]]}}" />
                        <span data-i18n-title="faucheuse-gravee" title="Faucheuse gravée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCfauconsPlumesL" value="{{AOFauconPL=Faucon et Plumes Luminescentes (Anti-Anathème)}}" />
                        <span data-i18n-title="faucon-plumes" title="Faucon et plumes"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCflammesStylisees" value="{{AOFlammesStyliseesV=[[1D6]]}}" />
                        <span data-i18n-title="flammes-stylisees" title="Flammes stylisées"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCgriffuresGravees" value="{{AOGriffuresGraveesD=[[1D6]]}} {{AOGriffuresGraveesV=[[1D6]]}}" />
                        <span data-i18n-title="griffures-gravees" title="Griffures gravées"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCmasqueBriseSculpte" value="{{AOMasqueBriseSculpteD=[[1D6]]}} {{AOMasqueBriseSculpteV=[[1D6]]}}" />
                        <span data-i18n-title="masque-brise-sculpte" title="Masque brisé sculpté"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCrouagesCassesGraves" value="{{AORouagesCassesGravesD=[[1D6]]}} {{AORouagesCassesGravesV=[[1D6]]}}" />
                        <span data-i18n-title="rouages-casses" title="Rouages cassés"></span>
                    </label>						
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSCsillonsFLF" value="{{AOSillonsFLFD=[[3]]}}" />
                        <span data-i18n-title="sillons" title="Sillons"></span>
                    </label>
                </div>
                <div class="special">
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSCenergie" value="{{energie=@{pSCEnergieValue}}} " />
                            <span data-i18n-title="energie" title="Énergie"></span>
                        </label>
                    
                        <input type="number" name="attr_pSCEnergieValue" class="center" value="0" />
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_pSCBDDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSCBDDiversTotal" value="{{BDDivers=[[@{pSCBDDiversD6}D6+@{pSCBDDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-degats" title="Bonus aux dégâts"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_pSCBDDiversD6" class="center" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_pSCBDDiversFixe" class="center" value="0" />
                        </div>
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_pSCBVDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSCBVDiversTotal" value="{{BVDivers=[[@{pSCBVDiversD6}D6+@{pSCBVDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-violence" title="Bonus à la violence"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_pSCBVDiversD6" class="center" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_pSCBVDiversFixe" class="center" value="0" />
                        </div>
                    </div>
                </div>
            </div>

            <div class="armeSection2">
                <input class="subMenu" type="hidden" name="attr_mEContactOptions" value="0" />

                <div class="ligne">
                    <div class="firstCol armeNom"><input type="text" name="attr_mECaC" value="Marteau-Épieu (Contact)" readonly /></div>
                    <div class="midColL armeDegats">
                        <div>
                            <input class="nbre" type="number" name="attr_mECaCDegat" value="3" readonly  />
                            <b>D6+</b>
                            <input class="bonus" type="number" name="attr_mECaCBDegat" value="0" readonly />
                        </div>
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mECaddChair" value="1" />
                            <span data-i18n-title="ajouter Chair / 2" title="+ Ajouter Chair/2"></span>
                        </label>
                    </div>
                    <div class="midCol armeViolence">
                        <input class="nbre" type="number" name="attr_mECaCViolence" value="1" readonly />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_mECaCBViolence" value="0" readonly />
                    </div>
                    <div class="midCol armePortee">
                        <select name="attr_mECaCPortee">
                            <option value="^{portee-contact}" data-i18n="portee-contact" selected>Contact</option>
                        </select>
                    </div>
                    <div class="lastCol armeAspect">
                        <select name="attr_mECAspectPNJ">
                            <option value="0" selected></option>
                            <option value="@{Chair}" data-i18n="chair">Chair</option>
                            <option value="@{Bete}" data-i18n="bete">Bête</option>
                            <option value="@{Machine}" data-i18n="machine">Machine</option>
                            <option value="@{Dame}" data-i18n="dame">Dame</option>
                            <option value="@{Masque}" data-i18n="masque">Masque</option>
                        </select>
                        
                        <button class="rollDice" type="action" name="act_mEContactPNJ" value="@{jetGM} &{template:combat} {{Nom=@{name}}}"></button>
                    </div>
                </div>
                <div class="subMenu">
                    <button class="effets" type="action" name="act_mEContactOptions_1" data-i18n="effets">Effets</button>
                    <button class="ameliorationsStructurelles BL" type="action" name="act_mEContactOptions_2" data-i18n="ameliorations-structurelles">Améliorations Structurelles</button>
                    <button class="ameliorationsArmes BL" type="action" name="act_mEContactOptions_3" data-i18n="ameliorations-d'armes">Améliorations d'armes</button>
                    <button class="special BL" type="action" name="act_mEContactOptions_4" data-i18n="special">Spécial</button>
                </div>
                
                <div class="effets">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECanatheme" value="{{anatheme=Anathème}}" />
                        <span data-i18n-title="anatheme" title="Anathème"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECantiAnatheme" value="{{antiAnathème=Anti Anathème}}" />
                        <span data-i18n-title="anti-anatheme" title="Anti Anathème"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECantiVehicule" value="{{antiVehicule=Anti Véhicule}} " />
                        <span data-i18n-title="anti-vehicule" title="Anti Véhicule"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECartillerie" value="{{artillerie=Artillerie}}" />
                        <span data-i18n-title="artillerie" title="Artillerie"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mECassassin" value="{{assassin=[[@{mECassassinValue}d6]]}} " />
                            <span data-i18n-title="assassin" title="Assassin"></span>
                        </label>
                    
                        <input type="number" name="attr_mECassassinValue" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECassistanceAttaque" value="{{assistanceAttaque=Assistance à l'attaque}}" />
                        <span data-i18n-title="assistance-attaque" title="Assistance à l'attaque"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mECbarrage" value="{{barrage=^{barrage} @{mECbarrageValue}}} " />
                            <span data-i18n-title="barrage" title="Barrage"></span>
                        </label>
                    
                        <input type="number" name="attr_mECbarrageValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mECcadence" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                            <span data-i18n-title="cadence" title="Cadence"></span>
                        </label>
                    
                        <input type="number" name="attr_mECcadenceValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mECchargeur" value="{{chargeur=^{chargeur} @{mECchargeurValue}}} " />
                            <span data-i18n-title="chargeur" title="Chargeur"></span>
                        </label>
                    
                        <input type="number" name="attr_mECchargeurValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mECchoc" value="{{choc=^{choc} @{mECchocValue}}}" />
                            <span data-i18n-title="choc" title="Choc"></span>
                        </label>
                    
                        <input type="number" name="attr_mECchocValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mECdefense" value="{{defense=^{defense} @{mECdefenseValue}}}" />
                            <span data-i18n-title="defense" title="Défense"></span>
                        </label>
                    
                        <input type="number" name="attr_mECdefenseValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mECdegatContinue" value="{{degatContinus=^{degats-continus} @{mECdegatContinueValue} ([[1D6]] ^{tours})}}" />
                            <span data-i18n-title="degats-continus" title="Dégâts Continus"></span>
                        </label>
                    
                        <input type="number" name="attr_mECdegatContinueValue" size="2" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECdeuxMains" value="{{deuxMains=Deux Mains}}" />
                        <span data-i18n-title="deux-mains" title="Deux Mains"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECdemoralisant" value="{{demoralisant=Démoralisant}}" />
                        <span data-i18n-title="demoralisant" title="Démoralisant"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECdesignation" value="{{designation=Désignation}}" />
                        <span data-i18n-title="designation" title="Désignation"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECdestructeur" value="{{destructeur=[[2D6]]}}" />
                        <span data-i18n-title="destructeur" title="Destructeur"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mECdispersion" value="{{dispersion=^{dispersion} @{mECdispersionValue}}} " />
                            <span data-i18n-title="dispersion" title="Dispersion"></span>
                        </label>
                    
                        <input type="number" name="attr_mECdispersionValue" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECenChaine" value="{{enChaine=En Chaîne}}" />
                        <span data-i18n-title="en-chaine" title="En Chaîne"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECesperance" value="{{esperance=Espérance}}" />
                        <span data-i18n-title="esperance" title="Espérance"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECfureur" value="{{fureur=[[4D6]]}}" />
                        <span data-i18n-title="fureur" title="Fureur"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECignoreArmure" value="{{ignoreArmure=Ignore Armure}}" />
                        <span data-i18n-title="ignore-armure" title="Ignore Armure"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECignoreCdF" value="{{ignoreCdF=Ignore Champs de Force}}" />
                        <span data-i18n-title="ignore-champ-de-force" title="Ignore CdF"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECakimbo" value="2" />
                        <span data-i18n-title="jumele-akimbo" title="Jumelé (Akimbo)"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECambidextrie" value="2" />
                        <span data-i18n-title="jumele-ambidextrie" title="Jumelé (Ambidextrie)"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEClestePNJ" value="{{leste=[[@{Chair}]]}}" />
                        <span data-i18n-title="leste" title="Lesté"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEClourd" value="1" />
                        <span data-i18n-title="lourd" title="Lourd"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mEClumiere" value="{{lumiere=^{lumiere} @{mEClumiereValue}}}" />
                            <span data-i18n-title="lumiere" title="Lumière"></span>
                        </label>
                    
                        <input type="number" name="attr_mEClumiereValue" size="2" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECmeurtrier" value="{{meurtrier=[[2D6]]}}" />
                        <span data-i18n-title="meutrier" title="Meurtrier"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECobliteration" value="{{obliteration=Oblitération}}" />
                        <span data-i18n-title="obliteration" title="Oblitération"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECorfevreriePNJ" value="{{orfevrerie=[[ceil(@{masque}/2)]]}}" />
                        <span data-i18n-title="orfevrerie" title="Orfèvrerie"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mECparasitage" value="{{parasitage=^{parasitage} @{mECparasitageValue}}}" />
                            <span data-i18n-title="parasitage" title="Parasitage"></span>
                        </label>
                    
                        <input type="number" name="attr_mECparasitageValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mECpenetrant" value="{{penetrant=^{penetrant} @{mECpenetrantValue}}}" />
                            <span data-i18n-title="penetrant" title="Pénétrant"></span>
                        </label>
                    
                        <input type="number" name="attr_mECpenetrantValue" value="0" />
                    </div>
                    <div class="double checked">
                        <label class="fakeButton">
                            <span data-i18n-title="perce-armure" title="Perce Armure"></span>
                        </label>
                        
                        <input type="number" name="attr_mECperceArmureValue" value="40" disabled />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECprecisionPNJ" value="{{precision=[[(ceil((@{machine})/2))]]}}" />
                        <span data-i18n-title="precision" title="Précision"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mECreaction" value="{{reaction=^{reaction} @{mECreactionValue}}}" />
                            <span data-i18n-title="reaction" title="Réaction"></span>
                        </label>
                    
                        <input type="number" name="attr_mECreactionValue" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECsilencieux" value="{{silencieux=Silencieux}}" />
                        <span data-i18n-title="silencieux" title="Silencieux"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECsoumission" value="{{soumission=Soumission}}" />
                        <span data-i18n-title="soumission" title="Soumission"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECtenebricite" value="{{tenebricide=Ténébricide}}" />
                        <span data-i18n-title="tenebricide" title="Ténébricide"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECtirRafale" value="{{tirRafale=Tir en Rafale}}" />
                        <span data-i18n-title="tir-rafale" title="Tir en Rafale"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECtirSecurite" value="3" />
                        <span data-i18n-title="tir-securite" title="Tir en Sécurité"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECultraViolence" value="{{ultraviolence=[[2D6]]}}" />
                        <span data-i18n-title="ultraviolence" title="Ultraviolence"></span>
                    </label>
                </div>
                <div class="ameliorationsStructurelles">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECagressive" value="{{ASAgressive=[[1d6]]}} {{ASAgressiveL=Agressive}}" />
                        <span data-i18n-title="agressive" title="Agressive"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECallegee" value="1" />
                        <span data-i18n-title="allegee" title="Allégée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECassassine" value="{{silencieux=Silencieux}} {{ASAssassineL=Assassine (Silencieux)}}" />
                        <span data-i18n-title="assassine" title="Assassine"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECbarbelee" value="{{meurtrier=[[2D6]]}} {{ASBarbeleeL=Barbelée (Meurtrier)}}" />
                        <span data-i18n-title="barbelee" title="Barbelée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECconnectee" value="{{ASConnecteeL=Connectée (Assistance à l'attaque)}}" />
                        <span data-i18n-title="connectee" title="Connectée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECelectrifiee" value="{{ASElectrifieeL=Électrifiée (Choc 1)}}" />
                        <span data-i18n-title="electrifiee" title="Électrifiée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECindestructible" value="{{ASIndestructibleL=Indestructible}}" />
                        <span data-i18n-title="indestructible" title="Indestructible"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECjumelle" value="2" />
                        <span data-i18n-title="jumelle" title="Jumelle"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEClumineuse" value="{{ASLumineuseL=Lumineuse (Lumière 2)}}" />
                        <span data-i18n-title="lumineuse" title="Lumineuse"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECmassive" value="{{ASMassiveL=Massive (Défense -1)}} {{ASMassiveD=[[@{force}]]}}" />
                        <span data-i18n-title="massive" title="Massive"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECprotectrice" value="2" />
                        <span data-i18n-title="protectrice" title="Protectrice"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECsoeur" value="2" />
                        <span data-i18n-title="soeur" title="Soeur"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECsournoisePNJ" value="{{orfevrerie=[[ceil(@{Masque}/2)]]}} {{ASSournoiseL=Sournoise (Orfevrerie)}}" />
                        <span data-i18n-title="sournoise" title="Sournoise"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECsurmesurePNJ" value="{{ASSurMesureD=[[ceil(@{bete}/2)]]}}" />
                        <span data-i18n-title="sur-mesure" title="Sur Mesure"></span>
                    </label>
                </div>
                <div class="ameliorationsArmes">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECarabesquesIridescentes" value="{{AOArabesquesIridescentesL=Arabesques Iridescentes (Lumière +1)}}" />
                        <span data-i18n-title="arabesques-iridescentes" title="Arabesques iridescentes"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECarmeAzurine" value="{{AOArmeAzurineD=[[1D6]]}} {{AOArmeAzurineV=[[1D6]]}}" />
                        <span data-i18n-title="arme-azurine" title="Arme azurine"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECarmeRougeSang" value="{{AOArmeRougeSangD=[[1D6]]}} {{AOArmeRougeSangV=[[1D6]]}}" />
                        <span data-i18n-title="arme-rouge-sang" title="Arme rouge sang"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECarmureGravee" value="{{AOArmureGraveeL=Armure Gravée (CdF +2)}}" />
                        <span data-i18n-title="armure-gravee" title="Armure gravée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECblasonChevalier" value="{{AOBlasonChevalier=Blason du Chevalier}}" />
                        <span data-i18n-title="blason-chevalier" title="Blason du chevalier"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECbouclierGrave" value="{{AOBouclierGraveL=Bouclier Gravé (Défense +1)}}" />
                        <span data-i18n-title="bouclier-grave" title="Bouclier gravé"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECcheneSculpte" value="{{AOCheneSculpteD=[[2D6]]}}" />
                        <span data-i18n-title="chene-sculpte" title="Chêne sculpté"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECchromeeLignesLC" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                        <span data-i18n-title="chromee" title="Chromée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECcodeKnightGrave" value="{{AOCodeKnightGraveL=Code du Knight Gravé (-1 Perte d'Espoir)}}" />
                        <span data-i18n-title="code-knight-grave" title="Code du knight gravé"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECcraneRieurGrave" value="{{AOCraneRieurGraveL=Crâne Rieur Gravé (Oblitération)}}" />
                        <span data-i18n-title="crane-rieur-grave" title="Crâne rieur gravé"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECfaucheuseGravee" value="{{AOFaucheuseGraveeD=[[1D6]]}}" />
                        <span data-i18n-title="faucheuse-gravee" title="Faucheuse gravée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECfauconsPlumesL" value="{{AOFauconPL=Faucon et Plumes Luminescentes (Anti-Anathème)}}" />
                        <span data-i18n-title="faucon-plumes" title="Faucon et plumes"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECflammesStylisees" value="{{AOFlammesStyliseesV=[[1D6]]}}" />
                        <span data-i18n-title="flammes-stylisees" title="Flammes stylisées"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECgriffuresGravees" value="{{AOGriffuresGraveesD=[[1D6]]}} {{AOGriffuresGraveesV=[[1D6]]}}" />
                        <span data-i18n-title="griffures-gravees" title="Griffures gravées"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECmasqueBriseSculpte" value="{{AOMasqueBriseSculpteD=[[1D6]]}} {{AOMasqueBriseSculpteV=[[1D6]]}}" />
                        <span data-i18n-title="masque-brise-sculpte" title="Masque brisé sculpté"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECrouagesCassesGraves" value="{{AORouagesCassesGravesD=[[1D6]]}} {{AORouagesCassesGravesV=[[1D6]]}}" />
                        <span data-i18n-title="rouages-casses" title="Rouages cassés"></span>
                    </label>						
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mECsillonsFLF" value="{{AOSillonsFLFD=[[3]]}}" />
                        <span data-i18n-title="sillons" title="Sillons"></span>
                    </label>
                </div>
                <div class="special">
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mECenergie" value="{{energie=@{mECEnergieValue}}} " />
                            <span data-i18n-title="energie" title="Énergie"></span>
                        </label>
                    
                        <input type="number" name="attr_mECEnergieValue" value="0" />
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_mECBDDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mECBDDiversTotal" value="{{BDDivers=[[@{mECBDDiversD6}D6+@{mECBDDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-degats" title="Bonus aux dégâts"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_mECBDDiversD6" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_mECBDDiversFixe" value="0" />
                        </div>
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_mECBVDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mECBVDiversTotal" value="{{BVDivers=[[@{mECBVDiversD6}D6+@{mECBVDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-violence" title="Bonus à la violence"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_mECBVDiversD6" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_mECBVDiversFixe" value="0" />
                        </div>
                    </div>
                </div>
            </div>
            
            <fieldset class="repeating_armeCaC">
                <input class="subMenu" type="hidden" name="attr_armeContactOptions" value="0" />

                <div class="ligne">
                    <div class="firstCol armeNom"><input type="text" name="attr_ArmeCaC" /></div>
                    <div class="midColL armeDegats">
                        <div>
                            <input class="nbre" type="number" name="attr_armeCaCDegat" class="textCenter" value="0" />
                            <b>D6+</b>
                            <input class="bonus" type="number" name="attr_armeCaCBDegat" class="textCenter" value="0" />
                        </div>
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_addChair" value="1" />
                            <span data-i18n-title="ajouter Chair / 2" title="+ Ajouter Chair/2"></span>
                        </label>
                    </div>
                    <div class="midCol armeViolence">
                        <input class="nbre" type="number" name="attr_armeCaCViolence" value="0" />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_armeCaCBViolence" value="0" />
                    </div>
                    <div class="midCol armePortee">
                        <select name="attr_armeCaCPortee">
                            <option value="^{portee-contact}" data-i18n="portee-contact" selected>Contact</option>
                            <option value="^{portee-courte}" data-i18n="portee-courte">Courte</option>
                            <option value="^{portee-moyenne}" data-i18n="portee-moyenne">Moyenne</option>
                            <option value="^{portee-longue}" data-i18n="portee-longue">Longue</option>
                            <option value="^{portee-lointaine}" data-i18n="portee-lointaine">Lointaine</option>
                        </select>
                    </div>
                    <div class="lastCol armeAspect">
                        <select name="attr_aspectPNJ">
                            <option value="0" selected></option>
                            <option value="@{Chair}" data-i18n="chair">Chair</option>
                            <option value="@{Bete}" data-i18n="bete">Bête</option>
                            <option value="@{Machine}" data-i18n="machine">Machine</option>
                            <option value="@{Dame}" data-i18n="dame">Dame</option>
                            <option value="@{Masque}" data-i18n="masque">Masque</option>
                        </select>
    
                        <button class="rollDice" type="action" name="act_armecontactpnj" value="@{jetGM} &{template:combat} {{Nom=@{name}}}"></button>
                    </div>
                </div>
                <div class="subMenu">
                    <button class="effets" type="action" name="act_armecontactoptions-1" data-i18n="effets">Effets</button>
                    <button class="ameliorationsStructurelles BL" type="action" name="act_armecontactoptions-2" data-i18n="ameliorations-structurelles">Améliorations Structurelles</button>
                    <button class="ameliorationsArmes BL" type="action" name="act_armecontactoptions-3" data-i18n="ameliorations-d'armes">Améliorations d'armes</button>
                    <button class="special BL" type="action" name="act_armecontactoptions-4" data-i18n="special">Spécial</button>
                </div>
                
                <div class="effets">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_anatheme" value="{{anatheme=Anathème}}" />
                        <span data-i18n-title="anatheme" title="Anathème"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_antiAnatheme" value="{{antiAnathème=Anti Anathème}}" />
                        <span data-i18n-title="anti-anatheme" title="Anti Anathème"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_antiVehicule" value="{{antiVehicule=Anti Véhicule}} " />
                        <span data-i18n-title="anti-vehicule" title="Anti Véhicule"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_artillerie" value="{{artillerie=Artillerie}}" />
                        <span data-i18n-title="artillerie" title="Artillerie"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_assassin" value="{{assassin=[[@{assassinValue}d6]]}} " />
                            <span data-i18n-title="assassin" title="Assassin"></span>
                        </label>
                    
                        <input type="number" name="attr_assassinValue" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_assistanceAttaque" value="{{assistanceAttaque=Assistance à l'attaque}}" />
                        <span data-i18n-title="assistance-attaque" title="Assistance à l'attaque"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_barrage" value="{{barrage=^{barrage} @{barrageValue}}} " />
                            <span data-i18n-title="barrage" title="Barrage"></span>
                        </label>
                    
                        <input type="number" name="attr_barrageValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_cadence" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                            <span data-i18n-title="cadence" title="Cadence"></span>
                        </label>
                    
                        <input type="number" name="attr_cadenceValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_chargeur" value="{{chargeur=^{chargeur} @{chargeurValue}}} " />
                            <span data-i18n-title="chargeur" title="Chargeur"></span>
                        </label>
                    
                        <input type="number" name="attr_chargeurValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_choc" value="{{choc=^{choc} @{chocValue}}}" />
                            <span data-i18n-title="choc" title="Choc"></span>
                        </label>
                    
                        <input type="number" name="attr_chocValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_defense" value="{{defense=^{defense} @{defenseValue}}}" />
                            <span data-i18n-title="defense" title="Défense"></span>
                        </label>
                    
                        <input type="number" name="attr_defenseValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_degatContinue" value="{{degatContinus=^{degats-continus} @{degatContinueValue} ([[1D6]] ^{tours})}}" />
                            <span data-i18n-title="degats-continus" title="Dégâts Continus"></span>
                        </label>
                    
                        <input type="number" name="attr_degatContinueValue" size="2" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_deuxMains" value="{{deuxMains=Deux Mains}}" />
                        <span data-i18n-title="deux-mains" title="Deux Mains"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_demoralisant" value="{{demoralisant=Démoralisant}}" />
                        <span data-i18n-title="demoralisant" title="Démoralisant"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_designation" value="{{designation=Désignation}}" />
                        <span data-i18n-title="designation" title="Désignation"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_destructeur" value="{{destructeur=[[2D6]]}}" />
                        <span data-i18n-title="destructeur" title="Destructeur"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_dispersion" value="{{dispersion=^{dispersion} @{dispersionValue}}} " />
                            <span data-i18n-title="dispersion" title="Dispersion"></span>
                        </label>
                    
                        <input type="number" name="attr_dispersionValue" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_enChaine" value="{{enChaine=En Chaîne}}" />
                        <span data-i18n-title="en-chaine" title="En Chaîne"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_esperance" value="{{esperance=Espérance}}" />
                        <span data-i18n-title="esperance" title="Espérance"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_fureur" value="{{fureur=[[4D6]]}}" />
                        <span data-i18n-title="fureur" title="Fureur"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ignoreArmure" value="{{ignoreArmure=Ignore Armure}}" />
                        <span data-i18n-title="ignore-armure" title="Ignore Armure"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ignoreCdF" value="{{ignoreCdF=Ignore Champs de Force}}" />
                        <span data-i18n-title="ignore-champ-de-force" title="Ignore CdF"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_akimbo" value="2" />
                        <span data-i18n-title="jumele-akimbo" title="Jumelé (Akimbo)"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ambidextrie" value="2" />
                        <span data-i18n-title="jumele-ambidextrie" title="Jumelé (Ambidextrie)"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_lestePNJ" value="{{leste=[[@{Chair}]]}}" />
                        <span data-i18n-title="leste" title="Lesté"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_lourd" value="1" />
                        <span data-i18n-title="lourd" title="Lourd"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_lumiere" value="{{lumiere=^{lumiere} @{lumiereValue}}}" />
                            <span data-i18n-title="lumiere" title="Lumière"></span>
                        </label>
                    
                        <input type="number" name="attr_lumiereValue" size="2" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_meurtrier" value="{{meurtrier=[[2D6]]}}" />
                        <span data-i18n-title="meutrier" title="Meurtrier"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_obliteration" value="{{obliteration=Oblitération}}" />
                        <span data-i18n-title="obliteration" title="Oblitération"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_orfevreriePNJ" value="{{orfevrerie=[[ceil(@{masque}/2)]]}}" />
                        <span data-i18n-title="orfevrerie" title="Orfèvrerie"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_parasitage" value="{{parasitage=^{parasitage} @{parasitageValue}}}" />
                            <span data-i18n-title="parasitage" title="Parasitage"></span>
                        </label>
                    
                        <input type="number" name="attr_parasitageValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_penetrant" value="{{penetrant=^{penetrant} @{penetrantValue}}}" />
                            <span data-i18n-title="penetrant" title="Pénétrant"></span>
                        </label>
                    
                        <input type="number" name="attr_penetrantValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_perceArmure" value="{{perceArmure=^{perce-armure} @{perceArmureValue}}}" />
                            <span data-i18n-title="perce-armure" title="Perce Armure"></span>
                        </label>
                    
                        <input type="number" name="attr_perceArmureValue" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_precisionPNJ" value="{{precision=[[(ceil((@{machine})/2))]]}}" />
                        <span data-i18n-title="precision" title="Précision"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_reaction" value="{{reaction=^{reaction} @{reactionValue}}}" />
                            <span data-i18n-title="reaction" title="Réaction"></span>
                        </label>
                    
                        <input type="number" name="attr_reactionValue" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_silencieux" value="{{silencieux=Silencieux}}" />
                        <span data-i18n-title="silencieux" title="Silencieux"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_soumission" value="{{soumission=Soumission}}" />
                        <span data-i18n-title="soumission" title="Soumission"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_tenebricite" value="{{tenebricide=Ténébricide}}" />
                        <span data-i18n-title="tenebricide" title="Ténébricide"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_tirRafale" value="{{tirRafale=Tir en Rafale}}" />
                        <span data-i18n-title="tir-rafale" title="Tir en Rafale"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_tirSecurite" value="3" />
                        <span data-i18n-title="tir-securite" title="Tir en Sécurité"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ultraViolence" value="{{ultraviolence=[[2D6]]}}" />
                        <span data-i18n-title="ultraviolence" title="Ultraviolence"></span>
                    </label>
                </div>
                <div class="ameliorationsStructurelles">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_agressive" value="{{ASAgressive=[[1d6]]}} {{ASAgressiveL=Agressive}}" />
                        <span data-i18n-title="agressive" title="Agressive"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_allegee" value="1" />
                        <span data-i18n-title="allegee" title="Allégée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_assassine" value="{{silencieux=Silencieux}} {{ASAssassineL=Assassine (Silencieux)}}" />
                        <span data-i18n-title="assassine" title="Assassine"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_barbelee" value="{{meurtrier=[[2D6]]}} {{ASBarbeleeL=Barbelée (Meurtrier)}}" />
                        <span data-i18n-title="barbelee" title="Barbelée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_connectee" value="{{ASConnecteeL=Connectée (Assistance à l'attaque)}}" />
                        <span data-i18n-title="connectee" title="Connectée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_electrifiee" value="{{ASElectrifieeL=Électrifiée (Choc 1)}}" />
                        <span data-i18n-title="electrifiee" title="Électrifiée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_indestructible" value="{{ASIndestructibleL=Indestructible}}" />
                        <span data-i18n-title="indestructible" title="Indestructible"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_jumelle" value="2" />
                        <span data-i18n-title="jumelle" title="Jumelle"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_lumineuse" value="{{ASLumineuseL=Lumineuse (Lumière 2)}}" />
                        <span data-i18n-title="lumineuse" title="Lumineuse"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_massive" value="{{ASMassiveL=Massive (Défense -1)}} {{ASMassiveD=[[@{force}]]}}" />
                        <span data-i18n-title="massive" title="Massive"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_protectrice" value="2" />
                        <span data-i18n-title="protectrice" title="Protectrice"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_soeur" value="2" />
                        <span data-i18n-title="soeur" title="Soeur"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_sournoisePNJ" value="{{orfevrerie=[[ceil(@{Masque}/2)]]}} {{ASSournoiseL=Sournoise (Orfevrerie)}}" />
                        <span data-i18n-title="sournoise" title="Sournoise"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_surmesurePNJ" value="{{ASSurMesureD=[[ceil(@{bete}/2)]]}}" />
                        <span data-i18n-title="sur-mesure" title="Sur Mesure"></span>
                    </label>
                </div>
                <div class="ameliorationsArmes">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_arabesquesIridescentes" value="{{AOArabesquesIridescentesL=Arabesques Iridescentes (Lumière +1)}}" />
                        <span data-i18n-title="arabesques-iridescentes" title="Arabesques iridescentes"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_armeAzurine" value="{{AOArmeAzurineD=[[1D6]]}} {{AOArmeAzurineV=[[1D6]]}}" />
                        <span data-i18n-title="arme-azurine" title="Arme azurine"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_armeRougeSang" value="{{AOArmeRougeSangD=[[1D6]]}} {{AOArmeRougeSangV=[[1D6]]}}" />
                        <span data-i18n-title="arme-rouge-sang" title="Arme rouge sang"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_armureGravee" value="{{AOArmureGraveeL=Armure Gravée (CdF +2)}}" />
                        <span data-i18n-title="armure-gravee" title="Armure gravée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_blasonChevalier" value="{{AOBlasonChevalier=Blason du Chevalier}}" />
                        <span data-i18n-title="blason-chevalier" title="Blason du chevalier"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_bouclierGrave" value="{{AOBouclierGraveL=Bouclier Gravé (Défense +1)}}" />
                        <span data-i18n-title="bouclier-grave" title="Bouclier gravé"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_cheneSculpte" value="{{AOCheneSculpteD=[[2D6]]}}" />
                        <span data-i18n-title="chene-sculpte" title="Chêne sculpté"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_chromeeLignesLC" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                        <span data-i18n-title="chromee" title="Chromée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_codeKnightGrave" value="{{AOCodeKnightGraveL=Code du Knight Gravé (-1 Perte d'Espoir)}}" />
                        <span data-i18n-title="code-knight-grave" title="Code du knight gravé"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_craneRieurGrave" value="{{AOCraneRieurGraveL=Crâne Rieur Gravé (Oblitération)}}" />
                        <span data-i18n-title="crane-rieur-grave" title="Crâne rieur gravé"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_faucheuseGravee" value="{{AOFaucheuseGraveeD=[[1D6]]}}" />
                        <span data-i18n-title="faucheuse-gravee" title="Faucheuse gravée"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_fauconsPlumesL" value="{{AOFauconPL=Faucon et Plumes Luminescentes (Anti-Anathème)}}" />
                        <span data-i18n-title="faucon-plumes" title="Faucon et plumes"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_flammesStylisees" value="{{AOFlammesStyliseesV=[[1D6]]}}" />
                        <span data-i18n-title="flammes-stylisees" title="Flammes stylisées"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_griffuresGravees" value="{{AOGriffuresGraveesD=[[1D6]]}} {{AOGriffuresGraveesV=[[1D6]]}}" />
                        <span data-i18n-title="griffures-gravees" title="Griffures gravées"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_masqueBriseSculpte" value="{{AOMasqueBriseSculpteD=[[1D6]]}} {{AOMasqueBriseSculpteV=[[1D6]]}}" />
                        <span data-i18n-title="masque-brise-sculpte" title="Masque brisé sculpté"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_rouagesCassesGraves" value="{{AORouagesCassesGravesD=[[1D6]]}} {{AORouagesCassesGravesV=[[1D6]]}}" />
                        <span data-i18n-title="rouages-casses" title="Rouages cassés"></span>
                    </label>						
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_sillonsFLF" value="{{AOSillonsFLFD=[[3]]}}" />
                        <span data-i18n-title="sillons" title="Sillons"></span>
                    </label>
                </div>
                <div class="special">
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_energie" value="{{energie=@{energieValue}}} " />
                            <span data-i18n-title="energie" title="Énergie"></span>
                        </label>
                    
                        <input type="number" name="attr_energieValue" class="center" value="0" />
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_bDDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_bDDiversTotal" value="{{BDDivers=[[@{bDDiversD6}D6+@{bDDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-degats" title="Bonus aux dégâts"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_bDDiversD6" class="center" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_bDDiversFixe" class="center" value="0" />
                        </div>
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_bVDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_bVDiversTotal" value="{{BVDivers=[[@{bVDiversD6}D6+@{bVDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-violence" title="Bonus à la violence"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_bVDiversD6" class="center" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_bVDiversFixe" class="center" value="0" />
                        </div>
                    </div>
                </div>
            </fieldset>
        </div>
        
    </div>

    <div class="subTabDistance">
        <input class="armeSection1" type="hidden" name="attr_armeSPS" value="0" />
        <input class="armeSection2" type="hidden" name="attr_armeSME" value="0"/>

        <h1 class="titre" data-i18n="armes-distance">Armes à distance</h1>
        <div class="ligneTitre">
            <div class="firstCol">
                <span data-i18n="arme">Arme</span>
            </div>
            
            <div class="midCol">
                <span data-i18n="degats">Dégâts</span>
            </div>
            <div class="midCol">
                <span data-i18n="violence">Violence</span>
            </div>
            <div class="midCol">
                <span data-i18n="portee">Portée</span>
            </div>
            
            <div class="lastCol">
                <span data-i18n="jet">Jet</span>
            </div>
        </div>

        <div class="armesListe">
            <div class="armeSection1">
                <input class="subMenu" type="hidden" name="attr_pSDistOptions" value="0" />

                <div class="ligne">
                    <div class="firstCol armeNom"><input type="text" name="attr_pSDist" class="left width25" value="Pistolet de Service" readonly /></div>
                    <div class="midCol armeDegats">
                        <input class="nbre" type="number" name="attr_pSDistDegat" value="2" readonly />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_pSDistBDegat" value="6" readonly />
                    </div>
                    <div class="midCol armeViolence">
                        <input class="nbre" type="number" name="attr_pSDistViolence" value="1" readonly />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_pSDistBViolence" value="0" readonly />
                    </div>
                    <div class="midCol armePortee">
                        <select name="attr_pSDistPortee">
                            <option value="^{portee-moyenne}" selected>Moyenne</option>
                        </select>
                    </div>
                    <div class="lastCol armeAspect">
                        <select name="attr_pSAspectPNJ">
                            <option value="0" selected></option>
                            <option value="@{Chair}" data-i18n="chair">Chair</option>
                            <option value="@{Bete}" data-i18n="bete">Bête</option>
                            <option value="@{Machine}" data-i18n="machine">Machine</option>
                            <option value="@{Dame}" data-i18n="dame">Dame</option>
                            <option value="@{Masque}" data-i18n="masque">Masque</option>
                        </select>
                        <button class="rollDice" type="action" name="act_pSDistancePNJ" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=@{pSDist}}} {{portee=^{portee} @{pSDistPortee}}}"></button>
                    </div>
                </div>

                <div class="subMenu">
                    <button class="effets" type="action" name="act_pSDistOptions_1" data-i18n="effets">Effets</button>
                    <button class="ameliorationsArmes BL" type="action" name="act_pSDistOptions_3" data-i18n="ameliorations-d'armes">Améliorations d'armes</button>
                    <button class="special BL" type="action" name="act_pSDistOptions_4" data-i18n="special">Spécial</button>
                </div>
                
                <div class="effets">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSanatheme" value="{{anatheme=Anathème}}" />
                        <span data-i18n-title="anatheme" title="Anathème"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSantiAnatheme" value="{{antiAnathème=Anti Anathème}}" />
                        <span data-i18n-title="anti-anatheme" title="Anti Anathème"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSantiVehicule" value="{{antiVehicule=Anti Véhicule}} " />
                        <span data-i18n-title="anti-vehicule" title="Anti Véhicule"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSartillerie" value="{{artillerie=Artillerie}}" />
                        <span data-i18n-title="artillerie" title="Artillerie"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSassassin" value="{{assassin=[[@{pSassassinValue}d6]]}} " />
                            <span data-i18n-title="assassin" title="Assassin"></span>
                        </label>
                    
                        <input type="number" name="attr_pSassassinValue" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSassistanceAttaque" value="{{assistanceAttaque=Assistance à l'attaque}}" />
                        <span data-i18n-title="assistance-attaque" title="Assistance à l'attaque"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSbarrage" value="{{barrage=^{barrage} @{pSbarrageValue}}} " />
                            <span data-i18n-title="barrage" title="Barrage"></span>
                        </label>
                    
                        <input type="number" name="attr_pSbarrageValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pScadence" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                            <span data-i18n-title="cadence" title="Cadence"></span>
                        </label>
                    
                        <input type="number" name="attr_pScadenceValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSchargeur" value="{{chargeur=^{chargeur} @{pSchargeurValue}}} " />
                            <span data-i18n-title="chargeur" title="Chargeur"></span>
                        </label>
                    
                        <input type="number" name="attr_pSchargeurValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSchoc" value="{{choc=^{choc} @{pSchocValue}}}" />
                            <span data-i18n-title="choc" title="Choc"></span>
                        </label>
                    
                        <input type="number" name="attr_pSchocValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSdefense" value="{{defense=^{defense} @{pSdefenseValue}}}" />
                            <span data-i18n-title="defense" title="Défense"></span>
                        </label>
                    
                        <input type="number" name="attr_pSdefenseValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSdegatContinue" value="{{degatContinus=^{degats-continus} @{pSdegatContinueValue} ([[1D6]] ^{tours})}}" />
                            <span data-i18n-title="degats-continus" title="Dégâts Continus"></span>
                        </label>
                    
                        <input type="number" name="attr_pSdegatContinueValue" size="2" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSdeuxMains" value="{{deuxMains=Deux Mains}}" />
                        <span data-i18n-title="deux-mains" title="Deux Mains"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSdemoralisant" value="{{demoralisant=Démoralisant}}" />
                        <span data-i18n-title="demoralisant" title="Démoralisant"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSdesignation" value="{{designation=Désignation}}" />
                        <span data-i18n-title="designation" title="Désignation"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSdestructeur" value="{{destructeur=[[2D6]]}}" />
                        <span data-i18n-title="destructeur" title="Destructeur"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSdispersion" value="{{dispersion=^{dispersion} @{pSdispersionValue}}} " />
                            <span data-i18n-title="dispersion" title="Dispersion"></span>
                        </label>
                    
                        <input type="number" name="attr_pSdispersionValue" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSenChaine" value="{{enChaine=En Chaîne}}" />
                        <span data-i18n-title="en-chaine" title="En Chaîne"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSesperance" value="{{esperance=Espérance}}" />
                        <span data-i18n-title="esperance" title="Espérance"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSfureur" value="{{fureur=[[4D6]]}}" />
                        <span data-i18n-title="fureur" title="Fureur"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSignoreArmure" value="{{ignoreArmure=Ignore Armure}}" />
                        <span data-i18n-title="ignore-armure" title="Ignore Armure"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSignoreCdF" value="{{ignoreCdF=Ignore Champs de Force}}" />
                        <span data-i18n-title="ignore-champ-de-force" title="Ignore CdF"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSakimbo" value="2" />
                        <span data-i18n-title="jumele-akimbo" title="Jumelé (Akimbo)"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSambidextrie" value="2" />
                        <span data-i18n-title="jumele-ambidextrie" title="Jumelé (Ambidextrie)"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSlestePNJ" value="{{leste=[[@{Chair}]]}}" />
                        <span data-i18n-title="leste" title="Lesté"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSlourd" value="1" />
                        <span data-i18n-title="lourd" title="Lourd"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSlumiere" value="{{lumiere=^{lumiere} @{pSlumiereValue}}}" />
                            <span data-i18n-title="lumiere" title="Lumière"></span>
                        </label>
                    
                        <input type="number" name="attr_pSlumiereValue" size="2" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSmeurtrier" value="{{meurtrier=[[2D6]]}}" />
                        <span data-i18n-title="meutrier" title="Meurtrier"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSobliteration" value="{{obliteration=Oblitération}}" />
                        <span data-i18n-title="obliteration" title="Oblitération"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSorfevreriePNJ" value="{{orfevrerie=[[ceil(@{masque}/2)]]}}" />
                        <span data-i18n-title="orfevrerie" title="Orfèvrerie"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSparasitage" value="{{parasitage=^{parasitage} @{pSparasitageValue}}}" />
                            <span data-i18n-title="parasitage" title="Parasitage"></span>
                        </label>
                    
                        <input type="number" name="attr_pSparasitageValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSpenetrant" value="{{penetrant=^{penetrant} @{pSpenetrantValue}}}" />
                            <span data-i18n-title="penetrant" title="Pénétrant"></span>
                        </label>
                    
                        <input type="number" name="attr_pSpenetrantValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSperceArmure" value="{{perceArmure=^{perce-armure} @{pSperceArmureValue}}}" />
                            <span data-i18n-title="perce-armure" title="Perce Armure"></span>
                        </label>
                    
                        <input type="number" name="attr_pSperceArmureValue" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSprecisionPNJ" value="{{precision=[[(ceil((@{machine})/2))]]}}" />
                        <span data-i18n-title="precision" title="Précision"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSreaction" value="{{reaction=^{reaction} @{pSreactionValue}}}" />
                            <span data-i18n-title="reaction" title="Réaction"></span>
                        </label>
                    
                        <input type="number" name="attr_pSreactionValue" value="0" />
                    </div>
                    <label class="simple fakeButton checked">
                        <span data-i18n-title="silencieux" title="Silencieux"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSsoumission" value="{{soumission=Soumission}}" />
                        <span data-i18n-title="soumission" title="Soumission"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pStenebricite" value="{{tenebricide=Ténébricide}}" />
                        <span data-i18n-title="tenebricide" title="Ténébricide"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pStirRafale" value="{{tirRafale=Tir en Rafale}}" />
                        <span data-i18n-title="tir-rafale" title="Tir en Rafale"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pStirSecurite" value="3" />
                        <span data-i18n-title="tir-securite" title="Tir en Sécurité"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSultraViolence" value="{{ultraviolence=[[2D6]]}}" />
                        <span data-i18n-title="ultraviolence" title="Ultraviolence"></span>
                    </label>
                </div>
                <div class="ameliorationsArmes">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSchargeurGrappes" value="1" />
                        <span data-i18n-title="balles-grappes" title="Balles grappes"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pScanonLong" value="{{canonLongM=1}} {{canonLongC=Canon Long (Portée Courte : +3 Difficulté)}}" />
                        <span data-i18n-title="canon-long" title="Canon Long"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pScanonRaccourci" value="{{canonRaccourci=Canon Raccourci (Portée Courte : Dispersion 3 / Sinon : +3 Difficulté)}}" />
                        <span data-i18n-title="canon-raccourci" title="Canon Raccourci"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSchambreDouble" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                        <span data-i18n-title="chambre-double" title="Chambre Double"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSinterfaceGuidage" value="3" />
                        <span data-i18n-title="interface-guidage" title="Interface de guidage"></span>
                    </label>
                    <div class="doubleTexte">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSjumelage" value="{{jumelage=^{jumelage} (@{pSjumelageValue})}}" />
                            <span data-i18n-title="jumelage" title="Jumelage :"></span>
                        </label>
                    
                        <input type="text" name="attr_pSjumelageValue" class="center" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSlunetteIntelligente" value="{{lunetteIntelligente=Lunette Intelligente (+1 Portée)}}" />
                        <span data-i18n-title="lunette-intelligente" title="Lunette Intelligente"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSmunitionsHyperVelocite" value="{{munitionsHyperVelocite=Munitions à Hyper Velocite (Assistance à l'Attaque)}}" />
                        <span data-i18n-title="munitions-hyper-velocite-short" title="Munitions à H. Vélocité"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSmunitionsDrone" value="{{munitionsDrone=3}}" />
                        <span data-i18n-title="munitions-drones" title="Munitions Drones"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSchargeurExplosives" value="1" />
                        <span data-i18n-title="munitions-explosives" title="Munitions Explosives"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSmunitionsIEM" value="1" />
                        <span data-i18n-title="munitions-iem" title="Munitions IEM"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSmunitionsNonLetales" value="2" />
                        <span data-i18n-title="munitions-non-letales-short" title="Munitions N. Létales"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSmunitionsSubsoniques" value="{{munitionsSubsoniques=Munitions Subsoniques (Silencieux)}}" />
                        <span data-i18n-title="munitions-subsoniques" title="Munitions Subsoniques"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSpointeurLaser" value="{{pointeurLaser=1}} " />
                        <span data-i18n-title="pointeur-laser" title="Pointeur Laser"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSprotectionArme" value="{{protectionArme=Protection d'Arme (Reaction +2)}}" />
                        <span data-i18n-title="pointeur-d'arme" title="Protection d'Arme"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSrevetementOmega" value="2" />
                        <span data-i18n-title="revetement-omega" title="Revêtement Omega"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSstructureElement" value="{{structureElement=Structure en Élément}}" />
                        <span data-i18n-title="structure-element-alpha-short" title="Structure Alpha"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pSsystemeRefroidissement" value="{{systemeRefroidissement=Système de Refroidissement (Tir en Rafale + Barrage 1)}}" />
                        <span data-i18n-title="systeme-refroidissement-short" title="Système de Refroid."></span>
                    </label>
                </div>
                <div class="special">
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSenergie" value="{{energie=@{pSenergieValue}}} " />
                            <span data-i18n-title="energie" title="Énergie"></span>
                        </label>
                    
                        <input type="number" name="attr_pSenergieValue" class="center" value="0" />
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_pSbDDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSbDDiversTotal" value="{{BDDivers=[[@{pSbDDiversD6}D6+@{pSbDDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-degats" title="Bonus aux dégâts"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_pSbDDiversD6" class="center" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_pSbDDiversFixe" class="center" value="0" />
                        </div>
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_pSbVDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_pSbVDiversTotal" value="{{BVDivers=[[@{pSbVDiversD6}D6+@{pSbVDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-violence" title="Bonus à la violence"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_pSbVDiversD6" class="center" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_pSbVDiversFixe" class="center" value="0" />
                        </div>
                    </div>
                </div>
            </div>

            <div class="armeSection2">
                <input class="subMenu" type="hidden" name="attr_mEDistOptions" value="0" />

                <div class="ligne">
                    <div class="firstCol armeNom"><input type="text" name="attr_mEDist" value="Marteau-Épieu (Tir)" readonly /></div>
                    <div class="midCol armeDegats">
                        <input class="nbre" type="number" name="attr_mEDistDegat" value="3" readonly />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_mEDistBDegat" value="12" readonly />
                    </div>
                    <div class="midCol armeViolence">
                        <input class="nbre" type="number" name="attr_mEDistViolence" value="3" readonly />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_mEDistBViolence" value="12" readonly />
                    </div>
                    <div class="midCol armePortee">
                        <select name="attr_mEDistPortee">
                            <option value="^{portee-courte}" selected>Courte</option>
                        </select>
                    </div>
                    <div class="lastCol armeAspect">
                        <select name="attr_mEAspectPNJ">
                            <option value="0" selected></option>
                            <option value="@{Chair}" data-i18n="chair">Chair</option>
                            <option value="@{Bete}" data-i18n="bete">Bête</option>
                            <option value="@{Machine}" data-i18n="machine">Machine</option>
                            <option value="@{Dame}" data-i18n="dame">Dame</option>
                            <option value="@{Masque}" data-i18n="masque">Masque</option>
                        </select>
                        
                        <button class="rollDice" type="action" name="act_mEDistancePNJ" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=@{mEDist}}} {{portee=^{portee} @{mEDistPortee}}}"></button>
                    </div>
                </div>
                <div class="subMenu">
                    <button class="effets" type="action" name="act_mEDistOptions_1" data-i18n="effets">Effets</button>
                    <button class="ameliorationsArmes BL" type="action" name="act_mEDistOptions_3" data-i18n="ameliorations-d'armes">Améliorations d'armes</button>
                    <button class="special BL" type="action" name="act_mEDistOptions_4" data-i18n="special">Spécial</button>
                </div>
                
                <div class="effets">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEanatheme" value="{{anatheme=Anathème}}" />
                        <span data-i18n-title="anatheme" title="Anathème"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEantiAnatheme" value="{{antiAnathème=Anti Anathème}}" />
                        <span data-i18n-title="anti-anatheme" title="Anti Anathème"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEantiVehicule" value="{{antiVehicule=Anti Véhicule}} " />
                        <span data-i18n-title="anti-vehicule" title="Anti Véhicule"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEartillerie" value="{{artillerie=Artillerie}}" />
                        <span data-i18n-title="artillerie" title="Artillerie"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mEassassin" value="{{assassin=[[@{mEassassinValue}d6]]}} " />
                            <span data-i18n-title="assassin" title="Assassin"></span>
                        </label>
                    
                        <input type="number" name="attr_mEassassinValue" class="center" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEassistanceAttaque" value="{{assistanceAttaque=Assistance à l'attaque}}" />
                        <span data-i18n-title="assistance-attaque" title="Assistance à l'attaque"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mEbarrage" value="{{barrage=^{barrage} @{mEbarrageValue}}} " />
                            <span data-i18n-title="barrage" title="Barrage"></span>
                        </label>
                    
                        <input type="number" name="attr_mEbarrageValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mEcadence" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                            <span data-i18n-title="cadence" title="Cadence"></span>
                        </label>
                    
                        <input type="number" name="attr_mEcadenceValue" class="center" value="0" />
                    </div>
                    <div class="double checked">
                        <label class="fakeButton">
                            <span data-i18n-title="chargeur" title="Chargeur"></span>
                        </label>
                        
                        <input type="number" name="attr_mEchargeurValue" class="center" value="1" disabled />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mEchoc" value="{{choc=^{choc} @{mEchocValue}}}" />
                            <span data-i18n-title="choc" title="Choc"></span>
                        </label>
                    
                        <input type="number" name="attr_mEchocValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mEdefense" value="{{defense=^{defense} @{mEdefenseValue}}}" />
                            <span data-i18n-title="defense" title="Défense"></span>
                        </label>
                    
                        <input type="number" name="attr_mEdefenseValue" class="center" value="0" />
                    </div>
                    <div class="double checked">
                        <label class="fakeButton">
                            <span data-i18n-title="degats-continus" title="Dégâts Continus"></span>
                        </label>
                        
                        <input type="number" name="attr_mEdegatContinueValue" class="center" size="2" value="3" disabled />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEdeuxMains" value="{{deuxMains=Deux Mains}}" />
                        <span data-i18n-title="deux-mains" title="Deux Mains"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEdemoralisant" value="{{demoralisant=Démoralisant}}" />
                        <span data-i18n-title="demoralisant" title="Démoralisant"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEdesignation" value="{{designation=Désignation}}" />
                        <span data-i18n-title="designation" title="Désignation"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEdestructeur" value="{{destructeur=[[2D6]]}}" />
                        <span data-i18n-title="destructeur" title="Destructeur"></span>
                    </label>
                    <div class="double checked">
                        <label class="fakeButton">
                            <span data-i18n-title="dispersion" title="Dispersion"></span>
                        </label>
                        
                        <input type="number" name="attr_mEdispersionValue" class="center" value="3" disabled />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEenChaine" value="{{enChaine=En Chaîne}}" />
                        <span data-i18n-title="en-chaine" title="En Chaîne"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEesperance" value="{{esperance=Espérance}}" />
                        <span data-i18n-title="esperance" title="Espérance"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEfureur" value="{{fureur=[[4D6]]}}" />
                        <span data-i18n-title="fureur" title="Fureur"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEignoreArmure" value="{{ignoreArmure=Ignore Armure}}" />
                        <span data-i18n-title="ignore-armure" title="Ignore Armure"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEignoreCdF" value="{{ignoreCdF=Ignore Champs de Force}}" />
                        <span data-i18n-title="ignore-champ-de-force" title="Ignore CdF"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEakimbo" value="2" />
                        <span data-i18n-title="jumele-akimbo" title="Jumelé (Akimbo)"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEambidextrie" value="2" />
                        <span data-i18n-title="jumele-ambidextrie" title="Jumelé (Ambidextrie)"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mElestePNJ" value="{{leste=[[@{Chair}]]}}" />
                        <span data-i18n-title="leste" title="Lesté"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mElourd" value="1" />
                        <span data-i18n-title="lourd" title="Lourd"></span>
                    </label>
                    <div class="double checked">
                        <label class="fakeButton">
                            <span data-i18n-title="lumiere" title="Lumière"></span>
                        </label>
                        
                        <input type="number" name="attr_mElumiereValue" class="center" size="2" value="2" disabled />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEmeurtrier" value="{{meurtrier=[[2D6]]}}" />
                        <span data-i18n-title="meutrier" title="Meurtrier"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEobliteration" value="{{obliteration=Oblitération}}" />
                        <span data-i18n-title="obliteration" title="Oblitération"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEorfevreriePNJ" value="{{orfevrerie=[[ceil(@{masque}/2)]]}}" />
                        <span data-i18n-title="orfevrerie" title="Orfèvrerie"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mEparasitage" value="{{parasitage=^{parasitage} @{mEparasitageValue}}}" />
                            <span data-i18n-title="parasitage" title="Parasitage"></span>
                        </label>
                    
                        <input type="number" name="attr_mEparasitageValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mEpenetrant" value="{{penetrant=^{penetrant} @{mEpenetrantValue}}}" />
                            <span data-i18n-title="penetrant" title="Pénétrant"></span>
                        </label>
                    
                        <input type="number" name="attr_mEpenetrantValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mEperceArmure" value="{{perceArmure=^{perce-armure} @{mEperceArmureValue}}}" />
                            <span data-i18n-title="perce-armure" title="Perce Armure"></span>
                        </label>
                    
                        <input type="number" name="attr_mEperceArmureValue" class="center" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEprecisionPNJ" value="{{precision=[[(ceil((@{machine})/2))]]}}" />
                        <span data-i18n-title="precision" title="Précision"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mEreaction" value="{{reaction=^{reaction} @{mEreactionValue}}}" />
                            <span data-i18n-title="reaction" title="Réaction"></span>
                        </label>
                    
                        <input type="number" name="attr_mEreactionValue" class="center" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEsilencieux" value="{{silencieux=Silencieux}}" />
                        <span data-i18n-title="silencieux" title="Silencieux"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEsoumission" value="{{soumission=Soumission}}" />
                        <span data-i18n-title="soumission" title="Soumission"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEtenebricite" value="{{tenebricide=Ténébricide}}" />
                        <span data-i18n-title="tenebricide" title="Ténébricide"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEtirRafale" value="{{tirRafale=Tir en Rafale}}" />
                        <span data-i18n-title="tir-rafale" title="Tir en Rafale"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEtirSecurite" value="3" />
                        <span data-i18n-title="tir-securite" title="Tir en Sécurité"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEultraViolence" value="{{ultraviolence=[[2D6]]}}" />
                        <span data-i18n-title="ultraviolence" title="Ultraviolence"></span>
                    </label>
                </div>
                <div class="ameliorationsArmes">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEchargeurGrappes" value="1" />
                        <span data-i18n-title="balles-grappes" title="Balles grappes"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEcanonLong" value="{{canonLongM=1}} {{canonLongC=Canon Long (Portée Courte : +3 Difficulté)}}" />
                        <span data-i18n-title="canon-long" title="Canon Long"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEcanonRaccourci" value="{{canonRaccourci=Canon Raccourci (Portée Courte : Dispersion 3 / Sinon : +3 Difficulté)}}" />
                        <span data-i18n-title="canon-raccourci" title="Canon Raccourci"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEchambreDouble" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                        <span data-i18n-title="chambre-double" title="Chambre Double"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEinterfaceGuidage" value="3" />
                        <span data-i18n-title="interface-guidage" title="Interface de guidage"></span>
                    </label>
                    <div class="doubleTexte">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mEjumelage" value="{{jumelage=^{jumelage} (@{mEjumelageValue})}}" />
                            <span data-i18n-title="jumelage" title="Jumelage :"></span>
                        </label>
                    
                        <input type="text" name="attr_mEjumelageValue" class="center" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mElunetteIntelligente" value="{{lunetteIntelligente=Lunette Intelligente (+1 Portée)}}" />
                        <span data-i18n-title="lunette-intelligente" title="Lunette Intelligente"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEmunitionsHyperVelocite" value="{{munitionsHyperVelocite=Munitions à Hyper Velocite (Assistance à l'Attaque)}}" />
                        <span data-i18n-title="munitions-hyper-velocite-short" title="Munitions à H. Vélocité"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEmunitionsDrone" value="{{munitionsDrone=3}}" />
                        <span data-i18n-title="munitions-drones" title="Munitions Drones"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEchargeurExplosives" value="1" />
                        <span data-i18n-title="munitions-explosives" title="Munitions Explosives"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEmunitionsIEM" value="1" />
                        <span data-i18n-title="munitions-iem" title="Munitions IEM"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEmunitionsNonLetales" value="2" />
                        <span data-i18n-title="munitions-non-letales-short" title="Munitions N. Létales"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEmunitionsSubsoniques" value="{{munitionsSubsoniques=Munitions Subsoniques (Silencieux)}}" />
                        <span data-i18n-title="munitions-subsoniques" title="Munitions Subsoniques"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEpointeurLaser" value="{{pointeurLaser=1}} " />
                        <span data-i18n-title="pointeur-laser" title="Pointeur Laser"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEprotectionArme" value="{{protectionArme=Protection d'Arme (Reaction +2)}}" />
                        <span data-i18n-title="pointeur-d'arme" title="Protection d'Arme"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mErevetementOmega" value="2" />
                        <span data-i18n-title="revetement-omega" title="Revêtement Omega"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEstructureElement" value="{{structureElement=Structure en Élément}}" />
                        <span data-i18n-title="structure-element-alpha-short" title="Structure Alpha"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_mEsystemeRefroidissement" value="{{systemeRefroidissement=Système de Refroidissement (Tir en Rafale + Barrage 1)}}" />
                        <span data-i18n-title="systeme-refroidissement-short" title="Système de Refroid."></span>
                    </label>
                </div>
                <div class="special">
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mEenergie" value="{{energie=@{mEenergieValue}}} " />
                            <span data-i18n-title="energie" title="Énergie"></span>
                        </label>
                    
                        <input type="number" name="attr_mEenergieValue" class="center" value="0" />
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_mEbDDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mEbDDiversTotal" value="{{BDDivers=[[@{mEbDDiversD6}D6+@{mEbDDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-degats" title="Bonus aux dégâts"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_mEbDDiversD6" class="center" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_mEbDDiversFixe" class="center" value="0" />
                        </div>
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_mEbVDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_mEbVDiversTotal" value="{{BVDivers=[[@{mEbVDiversD6}D6+@{mEbVDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-violence" title="Bonus à la violence"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_mEbVDiversD6" class="center" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_mEbVDiversFixe" class="center" value="0" />
                        </div>
                    </div>
                </div>
            </div>
            
            <fieldset class="repeating_armeDist">
                <input class="subMenu" type="hidden" name="attr_armeDistOptions" value="0">

                <div class="ligne">
                    <div class="firstCol armeNom"><input type="text" name="attr_ArmeDist" /></div>
                    <div class="midCol armeDegats">
                        <input class="nbre" type="number" name="attr_armeDistDegat" class="textCenter" value="0" />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_armeDistBDegat" class="textCenter" value="0" />
                    </div>
                    <div class="midCol armeViolence">
                        <input class="nbre" type="number" name="attr_armeDistViolence" class="textCenter" value="0" />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_armeDistBViolence" class="textCenter" value="0" />
                    </div>
                    <div class="midCol armePortee">
                        <select name="attr_armeDistPortee">
                            <option value="^{portee-contact}" data-i18n="portee-contact" selected>Contact</option>
                            <option value="^{portee-courte}" data-i18n="portee-courte">Courte</option>
                            <option value="^{portee-moyenne}" data-i18n="portee-moyenne">Moyenne</option>
                            <option value="^{portee-longue}" data-i18n="portee-longue">Longue</option>
                            <option value="^{portee-lointaine}" data-i18n="portee-lointaine">Lointaine</option>
                        </select>
                    </div>
                    <div class="lastCol armeAspect">
                        <select name="attr_aspectPNJ">
                            <option value="0" selected></option>
                            <option value="@{Chair}" data-i18n="chair">Chair</option>
                            <option value="@{Bete}" data-i18n="bete">Bête</option>
                            <option value="@{Machine}" data-i18n="machine">Machine</option>
                            <option value="@{Dame}" data-i18n="dame">Dame</option>
                            <option value="@{Masque}" data-i18n="masque">Masque</option>
                        </select>

                        <button class="rollDice" type="action" name="act_armedistancepnj" value="@{jetGM} &{template:combat} {{Nom=@{name}}}"></button>
                    </div>
                </div>

                <div class="subMenu">
                    <button class="effets" type="action" name="act_armedistoptions-1" data-i18n="effets">Effets</button>
                    <button class="ameliorationsArmes BL" type="action" name="act_armedistoptions-3" data-i18n="ameliorations-d'armes">Améliorations d'armes</button>
                    <button class="special BL" type="action" name="act_armedistoptions-4" data-i18n="special">Spécial</button>
                </div>
                
                <div class="effets">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_anatheme" value="{{anatheme=Anathème}}" />
                        <span data-i18n-title="anatheme" title="Anathème"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_antiAnatheme" value="{{antiAnathème=Anti Anathème}}" />
                        <span data-i18n-title="anti-anatheme" title="Anti Anathème"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_antiVehicule" value="{{antiVehicule=Anti Véhicule}} " />
                        <span data-i18n-title="anti-vehicule" title="Anti Véhicule"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_artillerie" value="{{artillerie=Artillerie}}" />
                        <span data-i18n-title="artillerie" title="Artillerie"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_assassin" value="{{assassin=[[@{assassinValue}d6]]}} " />
                            <span data-i18n-title="assassin" title="Assassin"></span>
                        </label>
                    
                        <input type="number" name="attr_assassinValue" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_assistanceAttaque" value="{{assistanceAttaque=Assistance à l'attaque}}" />
                        <span data-i18n-title="assistance-attaque" title="Assistance à l'attaque"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_barrage" value="{{barrage=^{barrage} @{barrageValue}}} " />
                            <span data-i18n-title="barrage" title="Barrage"></span>
                        </label>
                    
                        <input type="number" name="attr_barrageValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_cadence" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                            <span data-i18n-title="cadence" title="Cadence"></span>
                        </label>
                    
                        <input type="number" name="attr_cadenceValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_chargeur" value="{{chargeur=^{chargeur} @{chargeurValue}}} " />
                            <span data-i18n-title="chargeur" title="Chargeur"></span>
                        </label>
                    
                        <input type="number" name="attr_chargeurValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_choc" value="{{choc=^{choc} @{chocValue}}}" />
                            <span data-i18n-title="choc" title="Choc"></span>
                        </label>
                    
                        <input type="number" name="attr_chocValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_defense" value="{{defense=^{defense} @{defenseValue}}}" />
                            <span data-i18n-title="defense" title="Défense"></span>
                        </label>
                    
                        <input type="number" name="attr_defenseValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_degatContinue" value="{{degatContinus=^{degats-continus} @{degatContinueValue} ([[1D6]] ^{tours})}}" />
                            <span data-i18n-title="degats-continus" title="Dégâts Continus"></span>
                        </label>
                    
                        <input type="number" name="attr_degatContinueValue" size="2" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_deuxMains" value="{{deuxMains=Deux Mains}}" />
                        <span data-i18n-title="deux-mains" title="Deux Mains"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_demoralisant" value="{{demoralisant=Démoralisant}}" />
                        <span data-i18n-title="demoralisant" title="Démoralisant"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_designation" value="{{designation=Désignation}}" />
                        <span data-i18n-title="designation" title="Désignation"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_destructeur" value="{{destructeur=[[2D6]]}}" />
                        <span data-i18n-title="destructeur" title="Destructeur"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_dispersion" value="{{dispersion=^{dispersion} @{dispersionValue}}} " />
                            <span data-i18n-title="dispersion" title="Dispersion"></span>
                        </label>
                    
                        <input type="number" name="attr_dispersionValue" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_enChaine" value="{{enChaine=En Chaîne}}" />
                        <span data-i18n-title="en-chaine" title="En Chaîne"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_esperance" value="{{esperance=Espérance}}" />
                        <span data-i18n-title="esperance" title="Espérance"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_fureur" value="{{fureur=[[4D6]]}}" />
                        <span data-i18n-title="fureur" title="Fureur"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ignoreArmure" value="{{ignoreArmure=Ignore Armure}}" />
                        <span data-i18n-title="ignore-armure" title="Ignore Armure"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ignoreCdF" value="{{ignoreCdF=Ignore Champs de Force}}" />
                        <span data-i18n-title="ignore-champ-de-force" title="Ignore CdF"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_akimbo" value="2" />
                        <span data-i18n-title="jumele-akimbo" title="Jumelé (Akimbo)"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ambidextrie" value="2" />
                        <span data-i18n-title="jumele-ambidextrie" title="Jumelé (Ambidextrie)"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_lestePNJ" value="{{leste=[[@{Chair}]]}}" />
                        <span data-i18n-title="leste" title="Lesté"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_lourd" value="1" />
                        <span data-i18n-title="lourd" title="Lourd"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_lumiere" value="{{lumiere=^{lumiere} @{lumiereValue}}}" />
                            <span data-i18n-title="lumiere" title="Lumière"></span>
                        </label>
                    
                        <input type="number" name="attr_lumiereValue" size="2" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_meurtrier" value="{{meurtrier=[[2D6]]}}" />
                        <span data-i18n-title="meutrier" title="Meurtrier"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_obliteration" value="{{obliteration=Oblitération}}" />
                        <span data-i18n-title="obliteration" title="Oblitération"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_orfevreriePNJ" value="{{orfevrerie=[[ceil(@{masque}/2)]]}}" />
                        <span data-i18n-title="orfevrerie" title="Orfèvrerie"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_parasitage" value="{{parasitage=^{parasitage} @{parasitageValue}}}" />
                            <span data-i18n-title="parasitage" title="Parasitage"></span>
                        </label>
                    
                        <input type="number" name="attr_parasitageValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_penetrant" value="{{penetrant=^{penetrant} @{penetrantValue}}}" />
                            <span data-i18n-title="penetrant" title="Pénétrant"></span>
                        </label>
                    
                        <input type="number" name="attr_penetrantValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_perceArmure" value="{{perceArmure=^{perce-armure} @{perceArmureValue}}}" />
                            <span data-i18n-title="perce-armure" title="Perce Armure"></span>
                        </label>
                    
                        <input type="number" name="attr_perceArmureValue" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_precisionPNJ" value="{{precision=[[(ceil((@{machine})/2))]]}}" />
                        <span data-i18n-title="precision" title="Précision"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_reaction" value="{{reaction=^{reaction} @{reactionValue}}}" />
                            <span data-i18n-title="reaction" title="Réaction"></span>
                        </label>
                    
                        <input type="number" name="attr_reactionValue" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_silencieux" value="{{silencieux=Silencieux}}" />
                        <span data-i18n-title="silencieux" title="Silencieux"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_soumission" value="{{soumission=Soumission}}" />
                        <span data-i18n-title="soumission" title="Soumission"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_tenebricite" value="{{tenebricide=Ténébricide}}" />
                        <span data-i18n-title="tenebricide" title="Ténébricide"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_tirRafale" value="{{tirRafale=Tir en Rafale}}" />
                        <span data-i18n-title="tir-rafale" title="Tir en Rafale"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_tirSecurite" value="3" />
                        <span data-i18n-title="tir-securite" title="Tir en Sécurité"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ultraViolence" value="{{ultraviolence=[[2D6]]}}" />
                        <span data-i18n-title="ultraviolence" title="Ultraviolence"></span>
                    </label>
                </div>
                <div class="ameliorationsArmes">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_chargeurGrappes" value="1" />
                        <span data-i18n-title="balles-grappes" title="Balles grappes"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_canonLong" value="{{canonLongM=1}} {{canonLongC=Canon Long (Portée Courte : +3 Difficulté)}}" />
                        <span data-i18n-title="canon-long" title="Canon Long"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_canonRaccourci" value="{{canonRaccourci=Canon Raccourci (Portée Courte : Dispersion 3 / Sinon : +3 Difficulté)}}" />
                        <span data-i18n-title="canon-raccourci" title="Canon Raccourci"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_chambreDouble" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                        <span data-i18n-title="chambre-double" title="Chambre Double"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_interfaceGuidage" value="3" />
                        <span data-i18n-title="interface-guidage" title="Interface de guidage"></span>
                    </label>
                    <div class="doubleTexte">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_jumelage" value="{{jumelage=^{jumelage} (@{jumelageValue})}}" />
                            <span data-i18n-title="jumelage" title="Jumelage :"></span>
                        </label>
                    
                        <input type="text" name="attr_jumelageValue" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_lunetteIntelligente" value="{{lunetteIntelligente=Lunette Intelligente (+1 Portée)}}" />
                        <span data-i18n-title="lunette-intelligente" title="Lunette Intelligente"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsHyperVelocite" value="{{munitionsHyperVelocite=Munitions à Hyper Velocite (Assistance à l'Attaque)}}" />
                        <span data-i18n-title="munitions-hyper-velocite-short" title="Munitions à H. Vélocité"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsDrone" value="{{munitionsDrone=3}}" />
                        <span data-i18n-title="munitions-drones" title="Munitions Drones"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_chargeurExplosives" value="1" />
                        <span data-i18n-title="munitions-explosives" title="Munitions Explosives"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsIEM" value="1" />
                        <span data-i18n-title="munitions-iem" title="Munitions IEM"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsNonLetales" value="2" />
                        <span data-i18n-title="munitions-non-letales-short" title="Munitions N. Létales"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsSubsoniques" value="{{munitionsSubsoniques=Munitions Subsoniques (Silencieux)}}" />
                        <span data-i18n-title="munitions-subsoniques" title="Munitions Subsoniques"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pointeurLaser" value="{{pointeurLaser=1}} " />
                        <span data-i18n-title="pointeur-laser" title="Pointeur Laser"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_protectionArme" value="{{protectionArme=Protection d'Arme (Reaction +2)}}" />
                        <span data-i18n-title="pointeur-d'arme" title="Protection d'Arme"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_revetementOmega" value="2" />
                        <span data-i18n-title="revetement-omega" title="Revêtement Omega"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_structureElement" value="{{structureElement=Structure en Élément}}" />
                        <span data-i18n-title="structure-element-alpha-short" title="Structure Alpha"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_systemeRefroidissement" value="{{systemeRefroidissement=Système de Refroidissement (Tir en Rafale + Barrage 1)}}" />
                        <span data-i18n-title="systeme-refroidissement-short" title="Système de Refroid."></span>
                    </label>
                </div>
                <div class="special">
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_energie" value="{{energie=@{energieValue}}} " />
                            <span data-i18n-title="energie" title="Énergie"></span>
                        </label>
                    
                        <input type="number" name="attr_energieValue" value="0" />
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_bDDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_bDDiversTotal" value="{{BDDivers=[[@{bDDiversD6}D6+@{bDDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-degats" title="Bonus aux dégâts"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_bDDiversD6" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_bDDiversFixe" value="0" />
                        </div>
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_bVDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_bVDiversTotal" value="{{BVDivers=[[@{bVDiversD6}D6+@{bVDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-violence" title="Bonus à la violence"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_bVDiversD6" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_bVDiversFixe" value="0" />
                        </div>
                    </div>
                </div>
            </fieldset>
        </div>
    </div>

    <div class="subTabImprovisee">
        <div class="utilisation">
            <h1 class="titre" data-i18n="utilisation-armes-improvisees">Utilisation de l'arme improvisée</h1>

            <div class="buttons">	
                <label class="fakeButton">
                    <input type="radio" name="attr_utilisationArmeAIPNJ" value="&{template:combat} {{portee=^{portee-contact}}}" checked />
                    <span data-i18n-title="contact" title="Contact"></span>
                </label>
                <label class="fakeButton">
                    <input type="radio" name="attr_utilisationArmeAIPNJ" value="&{template:combat} {{portee=^{distance}}}" />
                    <span data-i18n-title="lancer" title="Lancer"></span>
                </label>
            </div>
        </div>

        <div class="liste">
            <h1 class="titre" data-i18n="armes-improvisees">Armes Improvisées</h1>
            <div class="ligneTitre">
                <span class="OD" data-i18n="chair-requise">Chair Requise</span>
                <span class="type" data-i18n="type">Type</span>
                <span class="degats" data-i18n="degats">Dégâts</span>
                <span class="violence" data-i18n="violence">Violence</span>
                <span class="jet" data-i18n="utilisations">Utilisations</span>
            </div>
            <div class="ligne">
                <div class="OD"><input type="text" name="attr_ChairAI1" value="1/2" readonly /></div>
                <span class="type" data-i18n="arme-improvisee-od1-exemple1">Lampadaire, panneau, petit arbre, cadavre, etc.</span>
                <div class="degats"><input type="text" name="attr_dgts1" value="4D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence1" value="4D6" readonly /></div>
                <div class="jet">
                    <input type="number" name="attr_utilisation1" value="3" readonly />
                    <button class="rollDice" type="action" name="act_AIPNJ1" value="@{jetGM} @{utilisationArmeAIPNJ} {{Nom=@{name}}} {{special1=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne">
                <div class="OD"><input type="text" name="attr_ChairAI2" value="1/2" readonly /></div>
                <span class="type" data-i18n="arme-improvisee-od1-exemple2">Citerne d'essence, transformateur électrique, etc.</span>
                <div class="degats"><input type="text" name="attr_dgts2" value="2D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence2" value="5D6" readonly /></div>
                <div class="jet">
                    <input type="number" name="attr_utilisation2" value="1" readonly />
                    <button class="rollDice" type="action" name="act_AIPNJ2" value="@{jetGM} @{utilisationArmeAIPNJ} {{Nom=@{name}}} {{special1=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne">
                <div class="OD"><input type="text" name="attr_ChairAI3" value="1/2" readonly /></div>
                <span class="type" data-i18n="arme-improvisee-od1-exemple3">Moto, petit véhicule, etc.</span>
                <div class="degats"><input type="text" name="attr_dgts3" value="4D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence3" value="4D6" readonly /></div>
                <div class="jet">
                    <input type="number" name="attr_utilisation3" value="2" readonly />
                    <button class="rollDice" type="action" name="act_AIPNJ3" value="@{jetGM} @{utilisationArmeAIPNJ} {{Nom=@{name}}} {{special1=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne separationTop">
                <div class="OD"><input type="text" name="attr_ChairAI4" value="3/4" readonly /></div>
                <span class="type" data-i18n="arme-improvisee-od2-exemple1">Arbre, poteau en béton, etc.</span>
                <div class="degats"><input type="text" name="attr_dgts4" value="6D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence4" value="4D6" readonly /></div>
                <div class="jet">
                    <input type="number" name="attr_utilisation4" value="3" readonly />
                    <button class="rollDice" type="action" name="act_AIPNJ4" value="@{jetGM} @{utilisationArmeAIPNJ} {{Nom=@{name}}} {{special1=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne">
                <div class="OD"><input type="text" name="attr_ChairAI5" value="3/4" readonly /></div>
                <span class="type" data-i18n="arme-improvisee-od2-exemple2">Petit château d'eau, cuve industrielle pleine, etc.</span>
                <div class="degats"><input type="text" name="attr_dgts5" value="4D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence5" value="6D6" readonly /></div>
                <div class="jet">
                    <input type="number" name="attr_utilisation5" value="1" readonly />
                    <button class="rollDice" type="action" name="act_AIPNJ5" value="@{jetGM} @{utilisationArmeAIPNJ} {{Nom=@{name}}} {{special1=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne">
                <div class="OD"><input type="text" name="attr_ChairAI6" value="3/4" readonly /></div>
                <span class="type" data-i18n="arme-improvisee-od2-exemple3">Voiture, véhicule de taille moyenne, etc.</span>
                <div class="degats"><input type="text" name="attr_dgts6" value="5D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence6" value="5D6" readonly /></div>
                <div class="jet">
                    <input type="number" name="attr_utilisation5" value="2" readonly />
                    <button class="rollDice" type="action" name="act_AIPNJ6" value="@{jetGM} @{utilisationArmeAIPNJ} {{Nom=@{name}}} {{special1=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne separationTop">
                <div class="OD"><input type="text" name="attr_ChairAI7" value="5/6" readonly /></div>
                <span class="type" data-i18n="arme-improvisee-od3-exemple1">Charpente métallique, gros arbre, etc.</span>
                <div class="degats"><input type="text" name="attr_dgts7" value="7D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence7" value="5D6" readonly /></div>
                <div class="jet">
                    <input type="number" name="attr_utilisation6" value="3" readonly />
                    <button class="rollDice" type="action" name="act_AIPNJ7" value="@{jetGM} @{utilisationArmeAIPNJ} {{Nom=@{name}}} {{special1=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne">
                <div class="OD"><input type="text" name="attr_ChairAI8" value="5/6" readonly /></div>
                <span class="type" data-i18n="arme-improvisee-od3-exemple2">Façade de maison, morceau de route, rails, etc.</span>
                <div class="degats"><input type="text" name="attr_dgts8" value="5D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence8" value="7D6" readonly /></div>
                <div class="jet">
                    <input type="number" name="attr_utilisation8" value="1" readonly />
                    <button class="rollDice" type="action" name="act_AIPNJ8" value="@{jetGM} @{utilisationArmeAIPNJ} {{Nom=@{name}}} {{special1=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne">
                <div class="OD"><input type="text" name="attr_ChairAI9" value="5/6" readonly /></div>
                <span class="type" data-i18n="arme-improvisee-od3-exemple3">Camionnette, gros 4x4, etc.</span>
                <div class="degats"><input type="text" name="attr_dgts9" value="6D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence9" value="6D6" readonly /></div>
                <div class="jet">
                    <input type="number" name="attr_utilisation9" value="2" readonly />
                    <button class="rollDice" type="action" name="act_AIPNJ9" value="@{jetGM} @{utilisationArmeAIPNJ} {{Nom=@{name}}} {{special1=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne separationTop">
                <div class="OD"><input type="text" name="attr_ChairAI10" value="7/8" readonly /></div>
                <span class="type" data-i18n="arme-improvisee-od4-exemple1">Façade de petit immeuble, remorque de camion, etc.</span>
                <div class="degats"><input type="text" name="attr_dgts10" value="7D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence10" value="9D6" readonly /></div>
                <div class="jet">
                    <input type="number" name="attr_utilisation10" value="1" readonly />
                    <button class="rollDice" type="action" name="act_AIPNJ10" value="@{jetGM} @{utilisationArmeAIPNJ} {{Nom=@{name}}} {{special1=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne">
                <div class="OD"><input type="text" name="attr_ChairAI11" value="7/8" readonly /></div>
                <span class="type" data-i18n="arme-improvisee-od4-exemple2">Camion, petit véhicule de chantier, etc.</span>
                <div class="degats"><input type="text" name="attr_dgts11" value="8D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence11" value="8D6" readonly /></div>
                <div class="jet">
                    <input type="number" name="attr_utilisation11" value="2" readonly />
                    <button class="rollDice" type="action" name="act_AIPNJ11" value="@{jetGM} @{utilisationArmeAIPNJ} {{Nom=@{name}}} {{special1=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne separationTop">
                <div class="OD"><input type="text" name="attr_ChairAI12" value="9/10" readonly /></div>
                <span class="type" data-i18n="arme-improvisee-od5-exemple1">Façade d'immeuble, grue, container plein, etc.</span>
                <div class="degats"><input type="text" name="attr_dgts12" value="10D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence12" value="12D6" readonly /></div>
                <div class="jet">
                    <input type="number" name="attr_utilisation12" value="1" readonly />
                    <button class="rollDice" type="action" name="act_AIPNJ12" value="@{jetGM} @{utilisationArmeAIPNJ} {{Nom=@{name}}} {{special1=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne">
                <div class="OD"><input type="text" name="attr_ChairAI13" value="9/10" readonly /></div>
                <span class="type" data-i18n="arme-improvisee-od5-exemple2">Yacht de 20 mètres, blindé, mécha-armure, etc.</span>
                <div class="degats"><input type="text" name="attr_dgts13" value="11D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence13" value="11D6" readonly /></div>
                <div class="jet">
                    <input type="number" name="attr_utilisation13" value="2" readonly />
                    <button class="rollDice" type="action" name="act_AIPNJ13" value="@{jetGM} @{utilisationArmeAIPNJ} {{Nom=@{name}}} {{special1=^{armes-improvisees}}}"></button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="subTabAutre">
        <h1 class="titre" data-i18n="autres-armes">Autres Armes</h1>
        <div class="ligneTitre">
            <div class="firstCol">
                <span data-i18n="arme">Arme</span>
            </div>
            <div class="midCol">
                <span data-i18n="degats">Dégâts</span>
            </div>
            <div class="midCol">
                <span data-i18n="violence">Violence</span>
            </div>
            <div class="midCol">
                <span data-i18n="portee">Portée</span>
            </div>
            <div class="midCol">
                <span data-i18n="attaque">Attaque</span>
            </div>
            <div class="lastCol">
                <span data-i18n="aspects-exceptionnels">Aspects Exceptionnels</span>
            </div>
        </div>
        <div class="armesListe">
            <fieldset class="repeating_armeAutre">
                <input class="subMenu" type="hidden" name="attr_armeAutreOptions" value="0" />

                <div class="ligne">
                    <div class="firstCol armeNom">
                        <input type="text" name="attr_ArmeAutre" />
                    </div>
                    <div class="midCol armeDegats">
                        <input class="nbre" type="number" name="attr_armeAutreDegat" value="0" />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_armeAutreBDegat" value="0" />
                    </div>
                    <div class="midCol armeViolence">
                        <input class="nbre" type="number" name="attr_armeAutreViolence" value="0" />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_armeAutreBViolence" value="0" />
                    </div>
                    <div class="midCol armePortee">
                        <select name="attr_armeAutrePortee">
                            <option value="Contact" data-i18n="portee-contact" selected>Contact</option>
                            <option value="Courte" data-i18n="portee-courte">Courte</option>
                            <option value="Moyenne" data-i18n="portee-moyenne">Moyenne</option>
                            <option value="Longue" data-i18n="portee-longue">Longue</option>
                            <option value="Lointaine" data-i18n="portee-lointaine">Lointaine</option>
                        </select>
                    </div>
                    <div class="midCol armeAttaque">
                        <input class="nbre" type="number" name="attr_armeAttaqueAutre" value="0" />
                        <b>D6+</b>
                    </div>
                    <div class="lastCol armeJet">
                        <input class="bonus" type="number" name="attr_armeODAutre" value="0" />
                        <button class="rollDice" type="action" name="act_armeautrepnj" value="@{jetGM} &{template:combat} {{Nom=@{name}}}"></button>
                    </div>
                </div>

                <div class="subMenu">
                    <button class="effets" type="action" name="act_armeautreoptions-1" data-i18n="effets">Effets</button>
                    <button class="ameliorationsArmes BL" type="action" name="act_armeautreoptions-3" data-i18n="ameliorations-d'armes">Améliorations d'armes</button>
                    <button class="special BL" type="action" name="act_armeautreoptions-4" data-i18n="special">Spécial</button>
                </div>

                <div class="effets">	
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_anatheme" value="{{anatheme=Anathème}}" />
                        <span data-i18n-title="anatheme" title="Anathème"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_antiAnatheme" value="{{antiAnathème=Anti Anathème}}" />
                        <span data-i18n-title="anti-anatheme" title="Anti Anathème"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_antiVehicule" value="{{antiVehicule=Anti Véhicule}} " />
                        <span data-i18n-title="anti-vehicule" title="Anti Véhicule"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_artillerie" value="{{artillerie=Artillerie}}" />
                        <span data-i18n-title="artillerie" title="Artillerie"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_assassin" value="{{assassin=[[@{assassinValue}d6]]}} " />
                            <span data-i18n-title="assassin" title="Assassin"></span>
                        </label>
                    
                        <input type="number" name="attr_assassinValue" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_assistanceAttaque" value="{{assistanceAttaque=Assistance à l'attaque}}" />
                        <span data-i18n-title="assistance-attaque" title="Assistance à l'attaque"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_barrage" value="{{barrage=^{barrage} @{barrageValue}}} " />
                            <span data-i18n-title="barrage" title="Barrage"></span>
                        </label>
                    
                        <input type="number" name="attr_barrageValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_cadence" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                            <span data-i18n-title="cadence" title="Cadence"></span>
                        </label>
                    
                        <input type="number" name="attr_cadenceValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_chargeur" value="{{chargeur=^{chargeur} @{chargeurValue}}} " />
                            <span data-i18n-title="chargeur" title="Chargeur"></span>
                        </label>
                    
                        <input type="number" name="attr_chargeurValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_choc" value="{{choc=^{choc} @{chocValue}}}" />
                            <span data-i18n-title="choc" title="Choc"></span>
                        </label>
                    
                        <input type="number" name="attr_chocValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_defense" value="{{defense=^{defense} @{defenseValue}}}" />
                            <span data-i18n-title="defense" title="Défense"></span>
                        </label>
                    
                        <input type="number" name="attr_defenseValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_degatContinue" value="{{degatContinus=^{degats-continus} @{degatContinueValue} ([[1D6]] ^{tours})}}" />
                            <span data-i18n-title="degats-continus" title="Dégâts Continus"></span>
                        </label>
                    
                        <input type="number" name="attr_degatContinueValue" size="2" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_deuxMains" value="{{deuxMains=Deux Mains}}" />
                        <span data-i18n-title="deux-mains" title="Deux Mains"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_demoralisant" value="{{demoralisant=Démoralisant}}" />
                        <span data-i18n-title="demoralisant" title="Démoralisant"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_designation" value="{{designation=Désignation}}" />
                        <span data-i18n-title="designation" title="Désignation"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_destructeur" value="{{destructeur=[[2D6]]}}" />
                        <span data-i18n-title="destructeur" title="Destructeur"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_dispersion" value="{{dispersion=^{dispersion} @{dispersionValue}}} " />
                            <span data-i18n-title="dispersion" title="Dispersion"></span>
                        </label>
                    
                        <input type="number" name="attr_dispersionValue" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_enChaine" value="{{enChaine=En Chaîne}}" />
                        <span data-i18n-title="en-chaine" title="En Chaîne"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_esperance" value="{{esperance=Espérance}}" />
                        <span data-i18n-title="esperance" title="Espérance"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_fureur" value="{{fureur=[[4D6]]}}" />
                        <span data-i18n-title="fureur" title="Fureur"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ignoreArmure" value="{{ignoreArmure=Ignore Armure}}" />
                        <span data-i18n-title="ignore-armure" title="Ignore Armure"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ignoreCdF" value="{{ignoreCdF=Ignore Champs de Force}}" />
                        <span data-i18n-title="ignore-champ-de-force" title="Ignore CdF"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_akimbo" value="2" />
                        <span data-i18n-title="jumele-akimbo" title="Jumelé (Akimbo)"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ambidextrie" value="2" />
                        <span data-i18n-title="jumele-ambidextrie" title="Jumelé (Ambidextrie)"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_leste" value="{{leste=[[@{force}]]}}" />
                        <span data-i18n-title="leste" title="Lesté"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_lourd" value="1" />
                        <span data-i18n-title="lourd" title="Lourd"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_lumiere" value="{{lumiere=^{lumiere} @{lumiereValue}}}" />
                            <span data-i18n-title="lumiere" title="Lumière"></span>
                        </label>
                    
                        <input type="number" name="attr_lumiereValue" size="2" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_meurtrier" value="{{meurtrier=[[2D6]]}}" />
                        <span data-i18n-title="meutrier" title="Meurtrier"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_obliteration" value="{{obliteration=Oblitération}}" />
                        <span data-i18n-title="obliteration" title="Oblitération"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_orfevrerie" value="{{orfevrerie=[[@{dexterite}+@{dextOD}]]}} {{orfevrerieWarrior=[[@{dexterite}+@{dextOD}+@{warriorScoutA}]]}}" />
                        <span data-i18n-title="orfevrerie" title="Orfèvrerie"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_parasitage" value="{{parasitage=^{parasitage} @{parasitageValue}}}" />
                            <span data-i18n-title="parasitage" title="Parasitage"></span>
                        </label>
                    
                        <input type="number" name="attr_parasitageValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_penetrant" value="{{penetrant=^{penetrant} @{penetrantValue}}}" />
                            <span data-i18n-title="penetrant" title="Pénétrant"></span>
                        </label>
                    
                        <input type="number" name="attr_penetrantValue" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_perceArmure" value="{{perceArmure=^{perce-armure} @{perceArmureValue}}}" />
                            <span data-i18n-title="perce-armure" title="Perce Armure"></span>
                        </label>
                    
                        <input type="number" name="attr_perceArmureValue" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_precision" value="{{precision=[[@{tir}+@{tirOD}]]}} {{precisionWarrior=[[@{tir}+@{tirOD}+@{warriorScholarA}]]}}" />
                        <span data-i18n-title="precision" title="Précision"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_reaction" value="{{reaction=^{reaction} @{reactionValue}}}" />
                            <span data-i18n-title="reaction" title="Réaction"></span>
                        </label>
                    
                        <input type="number" name="attr_reactionValue" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_silencieux" value="{{silencieux=Silencieux}}" />
                        <span data-i18n-title="silencieux" title="Silencieux"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_soumission" value="{{soumission=Soumission}}" />
                        <span data-i18n-title="soumission" title="Soumission"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_tenebricite" value="{{tenebricide=Ténébricide}}" />
                        <span data-i18n-title="tenebricide" title="Ténébricide"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_tirRafale" value="{{tirRafale=Tir en Rafale}}" />
                        <span data-i18n-title="tir-rafale" title="Tir en Rafale"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_tirSecurite" value="3" />
                        <span data-i18n-title="tir-securite" title="Tir en Sécurité"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ultraViolence" value="{{ultraviolence=[[2D6]]}}" />
                        <span data-i18n-title="ultraviolence" title="Ultraviolence"></span>
                    </label>
                </div>
                <div class="ameliorationsArmes">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_chargeurGrappes" value="1" />
                        <span data-i18n-title="balles-grappes" title="Balles grappes"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_canonLong" value="{{canonLongM=1}} {{canonLongC=Canon Long (Portée Courte : +3 Difficulté)}}" />
                        <span data-i18n-title="canon-long" title="Canon Long"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_canonRaccourci" value="{{canonRaccourci=Canon Raccourci (Portée Courte : Dispersion 3 / Sinon : +3 Difficulté)}}" />
                        <span data-i18n-title="canon-raccourci" title="Canon Raccourci"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_chambreDouble" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                        <span data-i18n-title="chambre-double" title="Chambre Double"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_interfaceGuidage" value="3" />
                        <span data-i18n-title="interface-guidage" title="Interface de guidage"></span>
                    </label>
                    <div class="doubleTexte">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_jumelage" value="{{jumelage=^{jumelage} (@{jumelageValue})}}" />
                            <span data-i18n-title="jumelage" title="Jumelage :"></span>
                        </label>
                    
                        <input type="text" name="attr_jumelageValue" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_lunetteIntelligente" value="{{lunetteIntelligente=Lunette Intelligente (+1 Portée)}}" />
                        <span data-i18n-title="lunette-intelligente" title="Lunette Intelligente"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsHyperVelocite" value="{{munitionsHyperVelocite=Munitions à Hyper Velocite (Assistance à l'Attaque)}}" />
                        <span data-i18n-title="munitions-hyper-velocite-short" title="Munitions à H. Vélocité"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsDrone" value="{{munitionsDrone=3}}" />
                        <span data-i18n-title="munitions-drones" title="Munitions Drones"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_chargeurExplosives" value="1" />
                        <span data-i18n-title="munitions-explosives" title="Munitions Explosives"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsIEM" value="1" />
                        <span data-i18n-title="munitions-iem" title="Munitions IEM"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsNonLetales" value="2" />
                        <span data-i18n-title="munitions-non-letales-short" title="Munitions N. Létales"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsSubsoniques" value="{{munitionsSubsoniques=Munitions Subsoniques (Silencieux)}}" />
                        <span data-i18n-title="munitions-subsoniques" title="Munitions Subsoniques"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pointeurLaser" value="{{pointeurLaser=1}} " />
                        <span data-i18n-title="pointeur-laser" title="Pointeur Laser"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_protectionArme" value="{{protectionArme=Protection d'Arme (Reaction +2)}}" />
                        <span data-i18n-title="pointeur-d'arme" title="Protection d'Arme"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_revetementOmega" value="2" />
                        <span data-i18n-title="revetement-omega" title="Revêtement Omega"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_structureElement" value="{{structureElement=Structure en Élément}}" />
                        <span data-i18n-title="structure-element-alpha-short" title="Structure Alpha"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_systemeRefroidissement" value="{{systemeRefroidissement=Système de Refroidissement (Tir en Rafale + Barrage 1)}}" />
                        <span data-i18n-title="systeme-refroidissement-short" title="Système de Refroid."></span>
                    </label>
                </div>
                <div class="special">
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_energie" value="{{energie=@{energieValue}}} " />
                            <span data-i18n-title="energie" title="Énergie"></span>
                        </label>
                    
                        <input type="number" name="attr_energieValue" value="0" />
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_bDDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_bDDiversTotal" value="{{BDDivers=[[@{bDDiversD6}D6+@{bDDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-degats" title="Bonus aux dégâts"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_bDDiversD6" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_bDDiversFixe" value="0" />
                        </div>
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_bVDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_bVDiversTotal" value="{{BVDivers=[[@{bVDiversD6}D6+@{bVDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-violence" title="Bonus à la violence"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_bVDiversD6" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_bVDiversFixe" value="0" />
                        </div>
                    </div>
                </div>
            </fieldset>
        </div>
    </div>
</div><div class="col marginTop">
    <div class="fichePJ grenade">
        <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0" />
        <input class="effets" type="hidden" name="attr_grenadeOptions" value="0" />

        <div class="titre">
            <button type="action" class="bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
            <button type="action" class="bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>
            <h1 class="titre" data-i18n="grenades">Grenades</h1>
            <div>
                <input type="number" name="attr_grenade" value="5" />
                <b>/</b>
                <input type="number" name="attr_grenade_max" value="5" />
            </div>
        </div>

        <div class="roll">
            <select name="attr_caracteristique1Grenade">
                <option value="0" selected></option>
                <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                <option value="@{force}" data-i18n="force">Force</option>
                <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                <option value="@{combat}" data-i18n="combat">Combat</option>
                <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                <option value="@{tir}" data-i18n="tir">Tir</option>
                <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                <option value="@{technique}" data-i18n="technique">Technique</option>
                <option value="@{aura}" data-i18n="aura">Aura</option>
                <option value="@{parole}" data-i18n="parole">Parole</option>
                <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                <option value="@{perception}" data-i18n="perception">Perception</option>
            </select>
            <select name="attr_caracteristique2Grenade">
                <option value="0" selected></option>
                <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                <option value="@{force}" data-i18n="force">Force</option>
                <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                <option value="@{combat}" data-i18n="combat">Combat</option>
                <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                <option value="@{tir}" data-i18n="tir">Tir</option>
                <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                <option value="@{technique}" data-i18n="technique">Technique</option>
                <option value="@{aura}" data-i18n="aura">Aura</option>
                <option value="@{parole}" data-i18n="parole">Parole</option>
                <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                <option value="@{perception}" data-i18n="perception">Perception</option>
            </select>
        </div>
        <div class="bonusCarac">
            <select name="attr_caracteristique3Grenade">
                <option value="0" selected></option>
                <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                <option value="@{force}" data-i18n="force">Force</option>
                <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                <option value="@{combat}" data-i18n="combat">Combat</option>
                <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                <option value="@{tir}" data-i18n="tir">Tir</option>
                <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                <option value="@{technique}" data-i18n="technique">Technique</option>
                <option value="@{aura}" data-i18n="aura">Aura</option>
                <option value="@{parole}" data-i18n="parole">Parole</option>
                <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                <option value="@{perception}" data-i18n="perception">Perception</option>
            </select>
            <select name="attr_caracteristique4Grenade">
                <option value="0" selected></option>
                <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                <option value="@{force}" data-i18n="force">Force</option>
                <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                <option value="@{combat}" data-i18n="combat">Combat</option>
                <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                <option value="@{tir}" data-i18n="tir">Tir</option>
                <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                <option value="@{technique}" data-i18n="technique">Technique</option>
                <option value="@{aura}" data-i18n="aura">Aura</option>
                <option value="@{parole}" data-i18n="parole">Parole</option>
                <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                <option value="@{perception}" data-i18n="perception">Perception</option>
            </select>
        </div>

        <div class="ligne">
            <span class="nom" data-i18n="grenade-shrapnel">Shrapnel</span>
            <span class="description" data-i18n="grenade-shrapnel-description">Ultraviolence / Meurtrier / Dispersion 6</span>
            <button class="rollDice" type="action" name="act_grenade1" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=^{grenade-shrapnel}}}"></button>
        </div>
        <div class="ligne">
            <span class="nom" data-i18n="grenade-flashbang">Flashbang</span>
            <span class="description" data-i18n="grenade-flashbang-description">Choc 1 / Barrage 2 / Lumière 2 / Dispersion 6 / Aucun dégâts-violence</span>
            <button class="rollDice" type="action" name="act_grenade2" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=^{grenade-flashbang}}}"></button>
        </div>
        <div class="ligne">
            <span class="nom" data-i18n="grenade-anti-blindage">Anti-Blindage</span>
            <span class="description" data-i18n="grenade-anti-blindage-description">Destructeur / Perce Armure 20 / Pénétrant 6 / Dispersion 6</span>
            <button class="rollDice" type="action" name="act_grenade3" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=^{grenade-anti-blindage}}}"></button>
        </div>
        <div class="ligne">
            <span class="nom" data-i18n="grenade-iem">IEM</span>
            <span class="description" data-i18n="grenade-iem-description">Parasitage 2 / Dispersion 6 / Aucun dégâts-violence</span>
            <button class="rollDice" type="action" name="act_grenade4" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=^{grenade-iem}}}"></button>
        </div>
        <div class="ligne">
            <span class="nom" data-i18n="grenade-explosive">Explosive</span>
            <span class="description" data-i18n="grenade-explosive-description">Anti-véhicule / Dispersion 3 / Choc 1</span>
            <button class="rollDice" type="action" name="act_grenade5" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=^{grenade-explosive}}}"></button>
        </div>

        <div class="subMenu">
            <button class="effets" type="action" name="act_grenadeOptions_1" data-i18n="effets">Effets</button>
        </div>

        <div class="effets">
            <label class="simple fakeButton">
                <input type="checkbox" name="attr_grenadeAvancee" value="{{grenadeAvanceeD=[[2D6]]}} {{grenadeAvanceeV=[[2D6]]}}" />
                <span data-i18n-title="grenades-intelligentes-avancees" title="Grenades Intelligentes Avancées"></span>
            </label>
        </div>
    </div>

    <div class="fichePNJ grenadePNJ">
        <input type="hidden" name="attr_styleBMGrenade" value="[[@{atkAkimbo}]]+[[@{atkAmbidextre}]]+[[@{atkCouvert}]]+[[@{atkDefensif}]]+[[@{atkAgressif}]]" />
        <input class="effets" type="hidden" name="attr_grenadeOptions" value="0" />

        <div class="titre">
            <h1 class="titre" data-i18n="grenades">Grenades</h1>
            <div>
                <input type="number" name="attr_grenade" value="5" />
                <b>/</b>
                <input type="number" name="attr_grenade_max" value="5" />
            </div>
        </div>
        <div class="roll">
            <select name="attr_aspectPNJGrenade">
                <option value="0" selected></option>
                <option value="@{Chair}" data-i18n="chair">Chair</option>
                <option value="@{Bete}" data-i18n="bete">Bête</option>
                <option value="@{Machine}" data-i18n="machine">Machine</option>
                <option value="@{Dame}" data-i18n="dame">Dame</option>
                <option value="@{Masque}" data-i18n="masque">Masque</option>
            </select>
        </div>
        
        <div class="ligne">
            <span class="nom" data-i18n="grenade-shrapnel">Shrapnel</span>
            <span class="description" data-i18n="grenade-shrapnel-description">Ultraviolence / Meurtrier / Dispersion 6</span>
            <button class="rollDice" type="action" name="act_grenade1PNJ" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=^{grenade-shrapnel}}}" ></button>
        </div>
        <div class="ligne">
            <span class="nom" data-i18n="grenade-flashbang">Flashbang</span>
            <span class="description" data-i18n="grenade-flashbang-description">Choc 1 / Barrage 2 / Lumière 2 / Dispersion 6 / Aucun dégâts-violence</span>
            <button class="rollDice" type="action" name="act_grenade2PNJ" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=^{grenade-flashbang}}}" ></button>
        </div>
        <div class="ligne">
            <span class="nom" data-i18n="grenade-anti-blindage">Anti-Blindage</span>
            <span class="description" data-i18n="grenade-anti-blindage-description">Destructeur / Perce Armure 20 / Pénétrant 6 / Dispersion 6</span>
            <button class="rollDice" type="action" name="act_grenade3PNJ" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=^{grenade-anti-blindage}}}" ></button>
        </div>
        <div class="ligne">
            <span class="nom" data-i18n="grenade-iem">IEM</span>
            <span class="description" data-i18n="grenade-iem-description">Parasitage 2 / Dispersion 6 / Aucun dégâts-violence</span>
            <button class="rollDice" type="action" name="act_grenade4PNJ" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=^{grenade-iem}}}" ></button>
        </div>
        <div class="ligne">
            <span class="nom" data-i18n="grenade-explosive">Explosive</span>
            <span class="description" data-i18n="grenade-explosive-description">Anti-véhicule / Dispersion 3 / Choc 1</span>
            <button class="rollDice" type="action" name="act_grenade5PNJ" value="@{jetGM} &{template:combat} {{Nom=@{name}}} {{special1=^{grenade-explosive}}}" ></button>
        </div>
        <div class="subMenu">
            <button class="effets" type="action" name="act_grenadeOptions_1" data-i18n="effets">Effets</button>
        </div>            
        <div class="effets">
            <label class="simple fakeButton">
                <input type="checkbox" name="attr_grenadeAvancee" value="{{grenadeAvanceeD=[[2D6]]}} {{grenadeAvanceeV=[[2D6]]}}" />
                <span data-i18n-title="grenades-intelligentes-avancees" title="Grenades Intelligentes Avancées"></span>
            </label>
        </div>
    </div>
</div>

<div class="col marginTop">
    <div class="portee">
        <h1 class="titre" data-i18n="portee">Portée</h1>
        <div class="col5">
            <span data-i18n="portee-contact">Contact</span>
            <span data-i18n="portee-0-2">0 à 2m</span>
        </div>
        <div class="col5BL">
            <span data-i18n="portee-courte">Courte</span>
            <span data-i18n="portee-2-15">2 à 15m</span>
        </div>
        <div class="col5BL">
            <span data-i18n="portee-moyenne">Moyenne</span>
            <span data-i18n="portee-15-50">15 à 50m</span>
        </div>
        <div class="col5BL">
            <span data-i18n="portee-longue">Longue</span>
            <span data-i18n="portee-50-300">50 à 300m</span>
        </div>
        <div class="col5BL">
            <span data-i18n="portee-lointaine">Lointaine</span>
            <span data-i18n="portee-+300">+ de 300m</span>
        </div>
    </div>

    <div class="protections">
        <h1 class="titre" data-i18n="protections">Protections</h1>
        <div class="ligneTitre">
            <span class="col4"></span>
            <span class="col4BL" data-i18n="nom">Nom</span>
            <span class="col4BL" data-i18n="defense">Défense</span>
            <span class="col4BL" data-i18n="reaction">Réaction</span>
        </div>
        <fieldset class="repeating_equipDefensif">
            <input type="hidden" name="attr_defLigne" value="0" readonly />
            <input type="hidden" name="attr_reaLigne" value="0" readonly />
            <input class="porte" type="hidden" name="attr_porte" value="1"/>

            <div class="col4 subMenu">
                <button class="porte" type="action" name="act_porte-1" data-i18n="equipe">Equipé</button>
            </div>

            <div class="col4BL">
                <input type="text" name="attr_nom" />
            </div>
            <div class="col4BL">
                <input type="number" name="attr_defenseBonus" value="0" />
            </div>
            <div class="col4BL">
                <input type="number" name="attr_reactionBonus" value="0" />
            </div>
        </fieldset>
    </div>
</div>

<div class="col3">
    <div class="fichePJ effetsArmes">
        <h1 class="titre" data-i18n="effet-des-armes">Effet des armes</h1>
        <select name="attr_effetArmes">
            <option value="" selected></option>
            <option value="anti-anatheme-description" data-i18n="anti-anatheme">Anti-Anathème</option>
            <option value="anti-vehicule-description" data-i18n="anti-vehicule">Anti-Véhicule</option>
            <option value="artillerie-description" data-i18n="artillerie">Artillerie</option>
            <option value="assassin-description" data-i18n="assassin-x">Assassin X</option>
            <option value="assistance-attaque-description" data-i18n="assistance-attaque">Assistance à l'attaque</option>
            <option value="barrage-description" data-i18n="barrage-x">Barrage X</option>
            <option value="cadence-description" data-i18n="cadence-x">Cadence X</option>
            <option value="chargeur-description" data-i18n="chargeur-x">Chargeur X</option>
            <option value="choc-description" data-i18n="choc-x">Choc X</option>
            <option value="defense-reaction-description" data-i18n="defense-x-reaction-x">Défense X / Réaction X</option>
            <option value="degats-continus-description" data-i18n="degats-continus-x">Dégâts Continus X</option>
            <option value="demoralisant-description" data-i18n="demoralisant">Démoralisant</option>
            <option value="designation-description" data-i18n="designation">Désignation</option>
            <option value="destructeur-description" data-i18n="destructeur">Destructeur</option>
            <option value="deux-mains-description" data-i18n="deux-mains">Deux Mains</option>
            <option value="dispersion-description" data-i18n="dispersion-x">Dispersion X</option>
            <option value="en-chaine-description" data-i18n="en-chaine">En Chaîne</option>
            <option value="esperance-description" data-i18n="esperance">Espérance</option>
            <option value="fureur-description" data-i18n="fureur">Fureur</option>
            <option value="ignore-armure-description" data-i18n="ignore-armure">Ignore Armure</option>
            <option value="ignore-champ-de-force-description" data-i18n="ignore-champ-de-force">Ignore Champ de Force</option>
            <option value="jumele-akimbo-description" data-i18n="jumele-akimbo">Jumelé (Akimbo)</option>
            <option value="jumele-ambidextrie-description" data-i18n="jumele-ambidextrie">Jumelé (Ambidextrie)</option>
            <option value="leste-description" data-i18n="leste">Lesté</option>
            <option value="lourd-description" data-i18n="lourd">Lourd</option>
            <option value="lumiere-description" data-i18n="lumiere-x">Lumière X</option>
            <option value="meurtrier-description" data-i18n="meurtrier">Meurtrier</option>
            <option value="obliteration-description" data-i18n="obliteration">Oblitération</option>
            <option value="orfevrerie-description" data-i18n="orfevrerie">Orfèvrerie</option>
            <option value="parasitage-description" data-i18n="parasitage-x">Parasitage X</option>
            <option value="penetrant-description" data-i18n="penetrant-x">Pénétrant X</option>
            <option value="perce-armure-description" data-i18n="perce-armure-x">Perce Armure X</option>
            <option value="precision-description" data-i18n="precision">Précision</option>
            <option value="silencieux-description" data-i18n="silencieux">Silencieux</option>
            <option value="soumission-description" data-i18n="soumission">Soumission</option>
            <option value="tenebricide-description" data-i18n="tenebricide">Ténébricide</option>
            <option value="tir-rafale-description" data-i18n="tir-rafale">Tir en rafale</option>
            <option value="tir-securite-description" data-i18n="tir-securite">Tir en sécurité</option>
            <option value="ultraviolence-description" data-i18n="ultraviolence">Ultraviolence</option>
        </select>
        <span name="attr_effetArmes-description"></span>
    </div>

    <div class="fichePNJ ficheCreature ficheBande effetsArmes">
        <h1 class="titre" data-i18n="effet-des-armes">Effet des armes</h1>
        <select name="attr_effetArmes">
            <option value="" selected></option>
            <option value="anatheme-description" data-i18n="anatheme">Anathème</option>
            <option value="anti-anatheme-description" data-i18n="anti-anatheme">Anti-Anathème</option>
            <option value="anti-vehicule-description" data-i18n="anti-vehicule">Anti-Véhicule</option>
            <option value="artillerie-description" data-i18n="artillerie">Artillerie</option>
            <option value="assassin-description" data-i18n="assassin-x">Assassin X</option>
            <option value="assistance-attaque-description" data-i18n="assistance-attaque">Assistance à l'attaque</option>
            <option value="barrage-description" data-i18n="barrage-x">Barrage X</option>
            <option value="cadence-description" data-i18n="cadence-x">Cadence X</option>
            <option value="chargeur-description" data-i18n="chargeur-x">Chargeur X</option>
            <option value="choc-description" data-i18n="choc-x">Choc X</option>
            <option value="defense-reaction-description" data-i18n="defense-x-reaction-x">Défense X / Réaction X</option>
            <option value="degats-continus-description" data-i18n="degats-continus-x">Dégâts Continus X</option>
            <option value="demoralisant-description" data-i18n="demoralisant">Démoralisant</option>
            <option value="designation-description" data-i18n="designation">Désignation</option>
            <option value="destructeur-description" data-i18n="destructeur">Destructeur</option>
            <option value="deux-mains-description" data-i18n="deux-mains">Deux Mains</option>
            <option value="dispersion-description" data-i18n="dispersion-x">Dispersion X</option>
            <option value="en-chaine-description" data-i18n="en-chaine">En Chaîne</option>
            <option value="esperance-description" data-i18n="esperance">Espérance</option>
            <option value="fureur-description" data-i18n="fureur">Fureur</option>
            <option value="ignore-armure-description" data-i18n="ignore-armure">Ignore Armure</option>
            <option value="ignore-champ-de-force-description" data-i18n="ignore-champ-de-force">Ignore Champ de Force</option>
            <option value="jumele-akimbo-description" data-i18n="jumele-akimbo">Jumelé (Akimbo)</option>
            <option value="jumele-ambidextrie-description" data-i18n="jumele-ambidextrie">Jumelé (Ambidextrie)</option>
            <option value="leste-description" data-i18n="leste">Lesté</option>
            <option value="lourd-description" data-i18n="lourd">Lourd</option>
            <option value="lumiere-description" data-i18n="lumiere-x">Lumière X</option>
            <option value="meurtrier-description" data-i18n="meurtrier">Meurtrier</option>
            <option value="obliteration-description" data-i18n="obliteration">Oblitération</option>
            <option value="orfevrerie-description" data-i18n="orfevrerie">Orfèvrerie</option>
            <option value="parasitage-description" data-i18n="parasitage-x">Parasitage X</option>
            <option value="penetrant-description" data-i18n="penetrant-x">Pénétrant X</option>
            <option value="perce-armure-description" data-i18n="perce-armure-x">Perce Armure X</option>
            <option value="precision-description" data-i18n="precision">Précision</option>
            <option value="silencieux-description" data-i18n="silencieux">Silencieux</option>
            <option value="soumission-description" data-i18n="soumission">Soumission</option>
            <option value="tenebricide-description" data-i18n="tenebricide">Ténébricide</option>
            <option value="tir-rafale-description" data-i18n="tir-rafale">Tir en rafale</option>
            <option value="tir-securite-description" data-i18n="tir-securite">Tir en sécurité</option>
            <option value="ultraviolence-description" data-i18n="ultraviolence">Ultraviolence</option>
        </select>
        <span name="attr_effetArmes-description"></span>
    </div>
</div>

<div class="col3">
    <div class="fichePJ effetsArmes">
        <h1 class="titre" data-i18n="amelioration-structurelle-des-armes">Amélioration (structurelle) des armes</h1>
        <select name="attr_ameliorationArmes">
            <option value="" selected></option>
            <option value="agressive-description" data-i18n="agressive">Agressive</option>
            <option value="assassine-description" data-i18n="assassine">Assassine</option>
            <option value="allegee-description" data-i18n="allegee">Allégée</option>
            <option value="meutrier-description" data-i18n="meutrier">Barbelée</option>
            <option value="canon-raccourci-description" data-i18n="canon-raccourci">Canon raccourci</option>
            <option value="chambre-double-description" data-i18n="chambre-double">Chambre double</option>
            <option value="chargeur-balles-grappes-description" data-i18n="chargeur-balles-grappes">Chargeur et balles grappes</option>
            <option value="chargeur-munitions-explosives-description" data-i18n="chargeur-munitions-explosives">Chargeur et munitions explosives</option>
            <option value="connectee-description" data-i18n="connectee">Connectée</option>
            <option value="electrifiee-description" data-i18n="electrifiee">Électrifiée</option>
            <option value="grenades-intelligentes-avancees-description" data-i18n="grenades-intelligentes-avancees">Grenades intelligentes avancées</option>
            <option value="indestructible-description" data-i18n="indestructible">Indestructible</option>
            <option value="interface-guidage-description" data-i18n="interface-guidage">Interface de guidage</option>
            <option value="jumelage-description" data-i18n="jumelage">Jumelage</option>
            <option value="jumelle-description" data-i18n="jumelle">Jumelle</option>
            <option value="lumineuse-description" data-i18n="lumineuse">Lumineuse</option>
            <option value="lunette-intelligente-description" data-i18n="lunette-intelligente">Lunette intelligente</option>
            <option value="munitions-hyper-velocite-description" data-i18n="munitions-hyper-velocite">Munitions à Hyper Vélocité</option>
            <option value="massive-description" data-i18n="massive">Massive</option>
            <option value="munitions-drones-description" data-i18n="munitions-drones">Munitions drones</option>
            <option value="munitions-iem-description" data-i18n="munitions-iem">Munitions IEM</option>
            <option value="munitions-non-letales-description" data-i18n="munitions-non-letales">Munitions non létales</option>
            <option value="munitions-subsoniques-description" data-i18n="munitions-subsoniques">Munitions subsoniques</option>
            <option value="pointeur-laser-description" data-i18n="pointeur-laser">Pointeur laser</option>
            <option value="protection-d'arme-description" data-i18n="protection-d'arme">Protection d'arme</option>
            <option value="protectrice-description" data-i18n="protectrice">Protectrice</option>
            <option value="revetement-omega-description" data-i18n="revetement-omega">Revêtement Omega</option>
            <option value="sournoise-description" data-i18n="sournoise">Sournoise</option>
            <option value="structure-element-alpha-description" data-i18n="structure-element-alpha">Structure en Element Alpha</option>
            <option value="sur-mesure-description" data-i18n="sur-mesure">Sur Mesure</option>
            <option value="systeme-refroidissement-description" data-i18n="systeme-refroidissement">Système de refroidissement</option>
        </select>
        <span name="attr_ameliorationArmes-description"></span>
    </div>

    <div class="fichePNJ ficheCreature ficheBande effetsArmes">
        <h1 class="titre" data-i18n="amelioration-structurelle-des-armes">Amélioration (structurelle) des armes</h1>
        <select name="attr_ameliorationArmes">
            <option value="" selected></option>
            <option value="agressive-description" data-i18n="agressive">Agressive</option>
            <option value="assassine-description" data-i18n="assassine">Assassine</option>
            <option value="allegee-description" data-i18n="allegee">Allégée</option>
            <option value="meutrier-description" data-i18n="meutrier">Barbelée</option>
            <option value="canon-raccourci-description" data-i18n="canon-raccourci">Canon raccourci</option>
            <option value="chambre-double-description" data-i18n="chambre-double">Chambre double</option>
            <option value="chargeur-balles-grappes-description" data-i18n="chargeur-balles-grappes">Chargeur et balles grappes</option>
            <option value="chargeur-munitions-explosives-description" data-i18n="chargeur-munitions-explosives">Chargeur et munitions explosives</option>
            <option value="connectee-description" data-i18n="connectee">Connectée</option>
            <option value="electrifiee-description" data-i18n="electrifiee">Électrifiée</option>
            <option value="grenades-intelligentes-avancees-description" data-i18n="grenades-intelligentes-avancees">Grenades intelligentes avancées</option>
            <option value="indestructible-description" data-i18n="indestructible">Indestructible</option>
            <option value="interface-guidage-description" data-i18n="interface-guidage">Interface de guidage</option>
            <option value="jumelage-description" data-i18n="jumelage">Jumelage</option>
            <option value="jumelle-description" data-i18n="jumelle">Jumelle</option>
            <option value="lumineuse-description" data-i18n="lumineuse">Lumineuse</option>
            <option value="lunette-intelligente-description" data-i18n="lunette-intelligente">Lunette intelligente</option>
            <option value="munitions-hyper-velocite-description" data-i18n="munitions-hyper-velocite">Munitions à Hyper Vélocité</option>
            <option value="massive-description" data-i18n="massive">Massive</option>
            <option value="munitions-drones-description" data-i18n="munitions-drones">Munitions drones</option>
            <option value="munitions-iem-description" data-i18n="munitions-iem">Munitions IEM</option>
            <option value="munitions-non-letales-description" data-i18n="munitions-non-letales">Munitions non létales</option>
            <option value="munitions-subsoniques-description" data-i18n="munitions-subsoniques">Munitions subsoniques</option>
            <option value="pointeur-laser-description" data-i18n="pointeur-laser">Pointeur laser</option>
            <option value="protection-d'arme-description" data-i18n="protection-d'arme">Protection d'arme</option>
            <option value="protectrice-description" data-i18n="protectrice">Protectrice</option>
            <option value="revetement-omega-description" data-i18n="revetement-omega">Revêtement Omega</option>
            <option value="sournoise-description" data-i18n="sournoise">Sournoise</option>
            <option value="structure-element-alpha-description" data-i18n="structure-element-alpha">Structure en Element Alpha</option>
            <option value="sur-mesure-description" data-i18n="sur-mesure">Sur Mesure</option>
            <option value="systeme-refroidissement-description" data-i18n="systeme-refroidissement">Système de refroidissement</option>
        </select>
        <span name="attr_ameliorationArmes-description"></span>
    </div>
</div>

<div class="col3">
    <div class="fichePJ effetsArmes">
        <h1 class="titre" data-i18n="amelioration-d'ornement-des-armes">Amélioration d'ornement des armes</h1>
        <select name="attr_ameliorationOArmes">
            <option value="" selected></option>
            <option value="arme-azurine-description">Arme Azurine</option>
            <option value="armure-gravee-description">Armure Gravée</option>
            <option value="arabesques-iridescentes-description">Arabesques Iridescentes</option>
            <option value="arme-rouge-sang-description">Arme Rouge Sang</option>
            <option value="blason-chevalier-description">Blason du Chevalier</option>
            <option value="bouclier-grave-description">Bouclier Gravé</option>
            <option value="chene-sculpte-description">Chêne Sculpté</option>
            <option value="chromee-lignes-lumineuses-colorees-description">Chromée avec Lignes Lumineuses et Colorées</option>
            <option value="code-knight-grave-description">Code du Knight Gravé</option>
            <option value="crane-rieur-grave-description">Crâne Rieur Gravé</option>
            <option value="faucheuse-gravee-description">Faucheuse Gravée</option>
            <option value="faucon-plumes-luminescentes-description">Faucon et Plumes Luminescentes</option>
            <option value="flammes-stylisees-description">Flammes Stylisées</option>
            <option value="griffures-gravees-description">Griffures Gravées</option>
            <option value="masque-brise-sculpte-description">Masque Brisé Sculpté</option>
            <option value="rouages-casses-graves-description">Rouages Cassés Gravés</option>
            <option value="sillons-formant-lignes-fleches-description">Sillons Formant des Lignes et des Flèches</option>
        </select>
        <span name="attr_ameliorationOArmes-description" ></span>
    </div>

    <div class="fichePNJ ficheCreature ficheBande effetsArmes">
        <h1 class="titre" data-i18n="amelioration-d'ornement-des-armes">Amélioration d'ornement des armes</h1>
        <select name="attr_ameliorationOArmes">
            <option value="" selected></option>
            <option value="arme-azurine-description">Arme Azurine</option>
            <option value="armure-gravee-description">Armure Gravée</option>
            <option value="arabesques-iridescentes-description">Arabesques Iridescentes</option>
            <option value="arme-rouge-sang-description">Arme Rouge Sang</option>
            <option value="blason-chevalier-description">Blason du Chevalier</option>
            <option value="bouclier-grave-description">Bouclier Gravé</option>
            <option value="chene-sculpte-description">Chêne Sculpté</option>
            <option value="chromee-lignes-lumineuses-colorees-description">Chromée avec Lignes Lumineuses et Colorées</option>
            <option value="code-knight-grave-description">Code du Knight Gravé</option>
            <option value="crane-rieur-grave-description">Crâne Rieur Gravé</option>
            <option value="faucheuse-gravee-description">Faucheuse Gravée</option>
            <option value="faucon-plumes-luminescentes-description">Faucon et Plumes Luminescentes</option>
            <option value="flammes-stylisees-description">Flammes Stylisées</option>
            <option value="griffures-gravees-description">Griffures Gravées</option>
            <option value="masque-brise-sculpte-description">Masque Brisé Sculpté</option>
            <option value="rouages-casses-graves-description">Rouages Cassés Gravés</option>
            <option value="sillons-formant-lignes-fleches-description">Sillons Formant des Lignes et des Flèches</option>
        </select>
        <span name="attr_ameliorationOArmes-description" ></span>
    </div>
</div>
  </div><div class="tabModules tab">
    <div class="col">
        <div class="fichePJ barbarian bard berserk druid monk necromancer paladin priest psion ranger rogue shaman sorcerer warlock warmaster warrior wizard dataArmure">
            <h1 class="titre"><span name="attr_armure" data-i18n-dynamic></span></h1>
            <div class="ligneTitre">
                <span></span>
                <span data-i18n="actuel">Actuel</span>
                <span data-i18n="maximum">Maximum</span>
                <span data-i18n="modif">Modif</span>
            </div>
            <div class="barbarian bard druid monk necromancer paladin priest psion ranger rogue shaman sorcerer warlock warmaster warrior wizard ligne3">
                <span data-i18n="energie">Energie</span>
                <div><input type="number" name="attr_energiePJ" value="0" /></div>
                <div><input type="number" name="attr_energiePJ_max" value="0" readonly /></div>
                <div><input type="number" name="attr_energiePJModif" value="0" /></div>
            </div>
            <div class="berserk ligne3">
                <span data-i18n="espoir">Espoir</span>
                <div><input type="number" name="attr_espoir" min="0" value="50" /></div>
                <div><input type="number" name="attr_espoir_max" min="0" value="50" readonly /></div>
                <div><input type="number" name="attr_espoirModif" value="0" /></div>
            </div>
        </div>

        <div class="fichePNJ ficheCreature ficheBande PES">
            <h1 class="titre" data-i18n="protection-energie-sante">Protections, Énergie et Santé</h1>
            <div class="ligneTitre">
                <span></span>
                <span data-i18n="actuel">Actuel</span>
                <span data-i18n="maximum">Maximum</span>
            </div>
            <div class="ligne2">
                <span class="fichePNJ" data-i18n="energie">Energie</span>
                <div><input type="number" name="attr_energiePNJ" min="0" value="0" /></div>
                <div><input type="number" name="attr_energiePNJ_max" min="0" value="0" /></div>
            </div>
        </div>
    </div>

    <div class="col">
        <div class="fichePJ fichePNJ information">
            <h1 class="titre" data-i18n="panneau-d'information">Panneau d'Information</h1>
            <div class="autoex autoex28">	
                <span name="attr_panneauInformation"></span>
                <textarea name="attr_panneauInformation" readonly ></textarea>
            </div>
        </div>
    </div>

    <div class="fichePJ slots">
        <div class="data">
            <input type="hidden" name="attr_slotTeteMax" value="0" readonly />
            <input type="hidden" name="attr_slotsOccupeTete" value="0" />
            
            <input type="hidden" name="attr_slotTorseMax" value="0" readonly />
            <input type="hidden" name="attr_slotsOccupeTorse" value="0" />
        
            <input type="hidden" name="attr_slotBGMax" value="0" readonly />
            <input type="hidden" name="attr_slotsOccupeBG" value="0" />
        
            <input type="hidden" name="attr_slotBDMax" value="0" readonly />
            <input type="hidden" name="attr_slotsOccupeBD" value="0" />
        
            <input type="hidden" name="attr_slotJGMax" value="0" readonly />
            <input type="hidden" name="attr_slotsOccupeJG" value="0" />
        
            <input type="hidden" name="attr_slotJDMax" value="0" readonly />
            <input type="hidden" name="attr_slotsOccupeJD" value="0" />
        </div>
        <h1 class="titre" data-i18n="slots-de-l'armure">Slots de l'Armure</h1>
        
        <div class="col6">
            <span data-i18n="tete">Tête</span>
            <div data-i18n-title="slots-restants/maximum" title="Slots restants / Slots maximum">
                <input type="number" name="attr_slotTete" value="@{slotTeteMax}-@{slotsOccupeTete}" disabled /><b>/</b><span name="attr_slotTeteMax">0</span>
            </div>
        </div>

        <div class="col6BL">
            <span data-i18n="torse">Torse</span>
            <div data-i18n-title="slots-restants/maximum" title="Slots restants / Slots maximum">
                <input type="number" name="attr_slotTorse" value="@{slotTorseMax}-@{slotsOccupeTorse}" disabled /><b>/</b><span name="attr_slotTorseMax">0</span>
            </div>
        </div>

        <div class="col6BL">
            <span data-i18n="bras-gauche">Bras Gauche</span>
            <div data-i18n-title="slots-restants/maximum" title="Slots restants / Slots maximum">
                <input type="number" name="attr_slotBG" value="@{slotBGMax}-@{slotsOccupeBG}" disabled /><b>/</b><span name="attr_slotBGMax">0</span>
            </div>
        </div>

        <div class="col6BL">
            <span data-i18n="bras-droit">Bras Droit</span>
            <div data-i18n-title="slots-restants/maximum" title="Slots restants / Slots maximum">
                <input type="number" name="attr_slotBD" value="@{slotBDMax}-@{slotsOccupeBD}" disabled /><b>/</b><span name="attr_slotBDMax">0</span>
            </div>
        </div>

        <div class="col6BL">
            <span data-i18n="jambe-gauche">Jambe Gauche</span>
            <div data-i18n-title="slots-restants/maximum" title="Slots restants / Slots maximum">
                <input type="number" name="attr_slotJG" value="@{slotJGMax}-@{slotsOccupeJG}" disabled /><b>/</b><span name="attr_slotJGMax">0</span>
            </div>
        </div>

        <div class="col6BL">
            <span data-i18n="jambe-droite">Jambe Droite</span>
            <div data-i18n-title="slots-restants/maximum" title="Slots restants / Slots maximum">
                <input type="number" name="attr_slotJD" value="@{slotJDMax}-@{slotsOccupeJD}" disabled /><b>/</b><span name="attr_slotJDMax">0</span>
            </div>
        </div>
    </div>

    <div class="fichePJ fichePNJ modulesListe">
        <fieldset class="repeating_modules">
            <input class="expandModule" type="hidden" name="attr_affichage" value="0" />
            <input class="expandSlots" type="hidden" name="attr_slotsPlus" value="0" />

            <input type="hidden" name="attr_affichage" value="0" />

            <div class="ligne titreModule">
                <button class="buttonPlus" type="action" name="act_affichage-1">
                    <span class="plus">+</span>
                    <span class="moins">-</span>
                 </button>
                <input type="text" name="attr_moduleNom" placeholder="Nom du Module"/>
            </div>
            <div class="ligne hModule">
                <label class="activation">
                    <span data-i18n="activation">Activation</span>
                    <input type="text" name="attr_moduleActivation" />
                </label>
                <div class="PE">
                    <button type="action" name="act_pem" data-i18n-title="depenser-pe-module" title="Dépenser les PE du module" data-i18n="point-energie-short">PE</button>
                    <input type="number" name="attr_moduleEnergie" value="0" />
                </div>
            </div>
            <label class="ligne hModule duree">
                <span data-i18n="duree">Durée</span>
                <input type="text" name="attr_moduleDuree" />
            </label>
            <div class="autoex hModule autoex28">
                <span name="attr_moduleDescription"></span>
                <textarea name="attr_moduleDescription"></textarea>
            </div>
            <div class="ligne hModule titre titreSlots">
                <input type="number" name="attr_slotsTotal" value="@{moduleSlotTete}+@{moduleSlotTorse}+@{moduleSlotBG}+@{moduleSlotBD}+@{moduleSlotJG}+@{moduleSlotJD}" title="Slots occupés" disabled />
                <h1 class="titre" data-i18n="slots">Slots</h1>
                <button class="buttonArrow" type="action" name="act_slotsplus-1">]</button>
            </div>

            <div class="ligne hSlots">
                <label class="slot">
                    <span data-i18n="tete">Tête</span>
                    <input type="number" name="attr_moduleSlotTete" value="0" />
                </label>
                
                <label class="slotBL">
                    <span data-i18n="torse">Torse</span>
                    <input type="number" name="attr_moduleSlotTorse" value="0" />
                </label>
            </div>
            <div class="ligne hSlots bTop">
                <label class="slot">
                    <span data-i18n="bras-gauche">Bras Gauche</span>
                    <input type="number" name="attr_moduleSlotBG" value="0" />
                </label>
                
                <label class="slotBL">
                    <span data-i18n="bras-droit">Bras Droit</span>
                    <input type="number" name="attr_moduleSlotBD" value="0" />
                </label>
            </div>
            <div class="ligne hSlots bTop">
                <label class="slot">
                    <span data-i18n="jambe-gauche">Jambe Gauche</span>
                    <input type="number" name="attr_moduleSlotJG" value="0" />
                </label>
                
                <label class="slotBL">
                    <span data-i18n="jambe-droite">Jambe Droite</span>
                    <input type="number" name="attr_moduleSlotJD" value="0" />
                </label>
            </div>
        </fieldset>
    </div>   
</div><div class="tabIA tab">
    <div class="col">
        <div class="donnees">
            <h1 class="titre" data-i18n="identite">Identité</h1>
            <label>
                <span data-i18n="ia-code-fabrication">Code de Fabrication</span>
                <input type="text" name="attr_codeIA" />
            </label>
            <label>
                <span data-i18n="surnom">Surnom</span>
                <input type="text" name="attr_nomIA" />
            </label>
        </div>

        <div class="atoutHandicap">
            <h1 class="titre" data-i18n="ia-atout">Atout</h1>
            <fieldset class="repeating_atoutIA">
                <input type="text" name="attr_nomAtoutIA" />
                <div class="autoex autoex28">
                    <span name="attr_descAtoutIA"></span>
                    <textarea name="attr_descAtoutIA"></textarea>
                </div>
            </fieldset>
        </div>

        <div class="atoutHandicap">
            <h1 class="titre" data-i18n="ia-handicap">Handicap</h1>
            <fieldset class="repeating_handicapIA">
                <input type="text" name="attr_nomHandicapIA" />
                <div class="autoex autoex28">
                    <span name="attr_descHandicapIA"></span>
                    <textarea name="attr_descHandicapIA"></textarea>
                </div>
            </fieldset>
        </div>
    </div>

    <div class="col">
        <div class="caractere">
            <h1 class="titre" data-i18n="ia-caractere">Caractère</h1>
            <div class="autoex autoex24">
                <span name="attr_caractereIA"></span>
                <textarea name="attr_caractereIA" class="largeTextarea"></textarea>
            </div>
        </div>
        <div class="notes">
            <h1 class="titre" data-i18n="notes">Notes</h1>
            <fieldset class="repeating_notesIA">
                <div class="autoex autoex24">
                    <span name="attr_notesIA"></span>
                    <textarea name="attr_notesIA"></textarea>
                </div>
            </fieldset>
        </div>
    </div>
</div><div class="tabIAIncarnee tab">
    <div class="col">
        <div class="donnees">
            <h1 class="titre" data-i18n="identite">Identité</h1>
            <label>
                <span data-i18n="ia-code-fabrication">Code de Fabrication</span>
                <input type="text" name="attr_codeIAI" />
            </label>
            <label>
                <span data-i18n="surnom">Surnom</span>
                <input type="text" name="attr_nomIAI" />
            </label>
            <label>
                <span data-i18n="ia-proprietaire">Propriétaire</span>
                <input type="text" name="attr_nomProprietaireIAI" />
            </label>
        </div>
        
        <div class="atoutHandicap">
            <h1 class="titre" data-i18n="ia-atout">Atout</h1>
            <fieldset class="repeating_atoutIAI">
                <input type="text" name="attr_nomAtoutIAI" />
                <div class="autoex autoex28">
                    <span name="attr_descAtoutIAI"></span>
                    <textarea name="attr_descAtoutIAI" ></textarea>
                </div>
            </fieldset>
        </div>
        
        <div class="atoutHandicap">
            <h1 class="titre" data-i18n="ia-handicap">Handicap</h1>
            <fieldset class="repeating_handicapIAI">
                <input type="text" name="attr_nomHandicapIAI" />
                <div class="autoex autoex28">
                    <span name="attr_descHandicapIAI"></span>
                    <textarea name="attr_descHandicapIAI"></textarea>
                </div>
            </fieldset>
        </div>
    </div>
    <div class="col">
        <div class="caractere">
            <h1 class="titre" data-i18n="ia-caractere">Caractère</h1>
            <div class="autoex autoex24">
                <span name="attr_caractereIAI"></span>
                <textarea name="attr_caractereIAI" class="largeTextarea"></textarea>
            </div>
        </div>
        <div class="notes">
            <h1 class="titre" data-i18n="notes">Notes</h1>
            <fieldset class="repeating_notesIA">
                <div class="autoex autoex24">
                    <span name="attr_notesIAI"></span>
                    <textarea name="attr_notesIAI"></textarea>
                </div>
            </fieldset>
        </div>
    </div>
    <div class="left">
        
    </div>
    
    <div class="right">
        
    </div>
</div><div class="tabOverdrive tab">
    <div class="data">
        <!-- Bonus des OD -->
        <input type="hidden" name="attr_santeODBonus" value="0" readonly />
        <input type="hidden" name="attr_reactionODBonus" value="0" readonly />
        <input type="hidden" name="attr_defenseODBonus" value="0" readonly />
        <input type="hidden" name="attr_akimboContactODBonus" value="" readonly />
        <input type="hidden" name="attr_ambidextrieContactODBonus" value="" readonly />
        <input type="hidden" name="attr_akimboDistanceODBonus" value="" readonly />
        <input type="hidden" name="attr_ambidextrieDistanceODBonus" value="" readonly />
        <input type="hidden" name="attr_initiativeODBonus" value="0" readonly />
        <input type="hidden" name="attr_discretionDegatsBonus" value="" readonly />
    </div>

    <input class="deplacement" type="hidden" name="attr_calODDep" value="0"  />
    <input class="force" type="hidden" name="attr_calODFor" value="0"  />
    <input class="endurance" type="hidden" name="attr_calODEnd" value="0"  />
    <input class="hargne" type="hidden" name="attr_calODHar" value="0"  />
    <input class="combat" type="hidden" name="attr_calODCom" value="0"  />
    <input class="instinct" type="hidden" name="attr_calODIns" value="0"  />
    <input class="tir" type="hidden" name="attr_calODTir" value="0"  />
    <input class="savoir" type="hidden" name="attr_calODSav" value="0"  />
    <input class="technique" type="hidden" name="attr_calODTec" value="0"  />
    <input class="aura" type="hidden" name="attr_calODAur" value="0"  />
    <input class="parole" type="hidden" name="attr_calODPar" value="0"  />
    <input class="sangFroid" type="hidden" name="attr_calODSFR" value="0"  />
    <input class="discretion" type="hidden" name="attr_calODDis" value="0"  />
    <input class="dexterite" type="hidden" name="attr_calODDex" value="0"  />
    <input class="perception" type="hidden" name="attr_calODPer" value="0"  />

    <div class="overdrive deplacement">
        <input class="afficher" type="hidden" name="attr_showDepl" value="0" />

        <div class="titre">
            <h1 class="titre" data-i18n="deplacement">Déplacement</h1>
            <button class="active" type="action" name="act_showDepl" data-i18n="afficher">Afficher</button>
        </div>
        <h2 class="titreBis" data-i18n="od-deplacement-titre">Calculateur de trajectoire et servomoteurs améliorés</h2>

        <div class="OD OD1">
            <span class="score">1</span>
            <span class="description" data-i18n="od1-deplacement-description">Le héros peut parcourir en une action de déplacement une distance égale ou inférieure à portée courte. En cas d’utilisation du module de course avec cet overdrive, l’action de déplacement citée plus haut est gratuite et ne compte pas comme une action de déplacement. Une seule peut être effectuée par tour.</span>
        </div>

        <div class="OD OD2">
            <span class="score">2</span>
            <span class="description" data-i18n="od2-deplacement-description">Le personnage devient extrêmement agile, même si son armure semble ne pas pouvoir le permettre. Lorsqu’il effectue une action de déplacement, les obstacles de sa taille ne le gênent pas (muret, couvert, camionnette, portail, etc.). Il peut les passer sans effectuer de test. Attention, cela ne veut pas dire qu’il est silencieux.</span>
        </div>
        
        <div class="OD OD3">
            <span class="score">3</span>
            <span class="description" data-i18n="od3-deplacement-description">Le héros peut parcourir en une action de déplacement une distance égale ou inférieure à portée moyenne. En cas d’utilisation du module de course avec cet overdrive, cette action est gratuite et ne compte pas comme une action de déplacement. Une seule peut être effectuée par tour.</span>
        </div>

        <div class="OD OD4">
            <span class="score">4</span>
            <span class="description" data-i18n="od4-deplacement-description">Le personnage devient aussi agile qu’un félin, même si son armure semble ne pas pouvoir le permettre. Lorsqu’il effectue une action de déplacement, les obstacles dont la taille est égale ou inférieure à 5 mètres ne le gênent pas (mur, fenêtre du premier étage, remorque de camion, etc.). Il peut les passer sans effectuer de test.</span>
        </div>

        <div class="OD OD5">
            <span class="score">5</span>
            <span class="description" data-i18n="od5-deplacement-description">En méta-armure, le personnage est si agile qu’il ne subit les dégâts et malus de chute que depuis des hauteurs égales à 50 mètres et plus. En dessous, il sait se réceptionner sans dégâts.</span>
        </div>
    </div>

    <div class="overdrive force">
        
        <input class="afficher" type="hidden" name="attr_showFor" value="0" />

        <div class="titre">
            <h1 class="titre" data-i18n="force">Force</h1>

            <button class="active" type="action" name="act_showFor" data-i18n="afficher">Afficher</button>
        </div>
        <h2 class="titreBis" data-i18n="od-force-titre">Fibres musculaires et endosquelette augmenté</h2>

        <div class="OD OD1">
            <span class="score">1</span>
            <span class="description" data-i18n="od1-force-description">Le personnage peut soulever 500 kg, il ajoute 3 points à ses dégâts au contact.</span>
        </div>
        <div class="OD OD2">
            <span class="score">2</span>
            <span class="description" data-i18n="od2-force-description">Le personnage peut soulever 2 tonnes, il ajoute désormais 6 points à ses dégâts au contact.</span>
        </div>
        <div class="OD OD3">
            <span class="score">3</span>
            <span class="description" data-i18n="od3-force-description">Le personnage peut soulever 10 tonnes, il ajoute désormais 9 points à ses dégâts au contact.</span>
        </div>
        <div class="OD OD4">
            <span class="score">4</span>
            <span class="description" data-i18n="od4-force-description">Le personnage peut soulever 30 tonnes, il ajoute désormais 12 points à ses dégâts au contact.</span>
        </div>
        <div class="OD OD5">
            <span class="score">5</span>
            <span class="description" data-i18n="od5-force-description">Le personnage peut soulever 80 tonnes, il ajoute désormais 15 points à ses dégâts au contact.</span>
        </div>
    </div>

    <div class="overdrive endurance">
        
        <input class="afficher" type="hidden" name="attr_showEnd" value="0" />

        <div class="titre">
            <h1 class="titre" data-i18n="endurance">Endurance</h1>

            <button class="active" type="action" name="act_showEnd" data-i18n="afficher">Afficher</button>
        </div>
        <h2 class="titreBis" data-i18n="od-endurance-titre">Compensateur de dégâts</h2>
            
        <div class="OD OD1">
            <span class="score">1</span>
            <span class="description"></span>
        </div>
        <div class="OD OD2">
            <span class="score">2</span>
            <span class="description" data-i18n="od2-endurance-description">Le personnage ne subit plus l’effet choc 1.</span>
        </div>
        <div class="OD OD3">
            <span class="score">3</span>
            <span class="description" data-i18n="od3-endurance-description">Tant qu’il porte sa méta-armure, le personnage gagne 6 points de santé.</span>
        </div>
        <div class="OD OD4">
            <span class="score">4</span>
            <span class="description" data-i18n="od4-endurance-description">Le personnage ne subit plus les effets choc 2 et inférieurs.</span>
        </div>
        <div class="OD OD5">
            <span class="score">5</span>
            <span class="description" data-i18n="od5-endurance-description">Le personnage soustrait toujours son score d’Endurance (sans les overdrives) au score de débordement des bandes. Ainsi, si une bande provoque un malus de débordement de 8 et que le héros a un score d’Endurance de 4, il ne se voit infliger que 4 points de dégâts (8 – 4 = 4). Lorsque le malus s’accumule, le personnage soustrait son Endurance à chaque addition du malus. Ainsi, si la bande doit infliger 16 points de dégâts après 2 tours de phase de conflit (8 au premier tour plus 8 au second), le héros soustrait son Endurance à chaque fois, c’est-à-dire 4 dans l’exemple, et ne se voit infliger ainsi que 8 points de dégâts.</span>
        </div>
    </div>

    <div class="overdrive hargne">
        
        <input class="afficher" type="hidden" name="attr_showHar" value="0" />

        <div class="titre">
            <h1 class="titre" data-i18n="hargne">Hargne</h1>

            <button class="active" type="action" name="act_showHar" data-i18n="afficher">Afficher</button>
        </div>
        <h2 class="titreBis" data-i18n="od-hargne-titre">Booster d’adrénaline</h2>
        
        <div class="OD OD1">
            <span class="score">1</span>
            <span class="description"></span>
        </div>
        <div class="OD OD2">
            <span class="score">2</span>
            <span class="description"></span>
        </div>
        <div class="OD OD3">
            <span class="score">3</span>
            <span class="description" data-i18n="od3-hargne-description">Le personnage ne meurt pas lorsqu’il tombe à 0 point de santé. En lieu et place, il combat la mort et reste vivant, mais subit tout de même une blessure grave. Si un ennemi réussit de nouveau une attaque sur le personnage ou si le personnage subit de nouveau des dégâts sur sa santé (peu importe les dégâts subis), il tombe à l’agonie et subit les effets habituels.</span>
        </div>
        <div class="OD OD4">
            <span class="score">4</span>
            <span class="description" data-i18n="od4-hargne-description">Le personnage est un roc. Lorsqu’il tombe à 0 point de santé, il peut agir normalement. Il ne subit pas de blessure grave. À chaque nouveau dégât sur sa santé, au début de son tour de jeu, le héros doit réussir un test base Harne dont la difficulté est la somme des dégâts qu’il a subis sur sa santé lors du dernier tour multipliée par deux. S’il rate, il tombe à l’agonie et subit les effets habituels. S’il réussit, il continue à combattre malgré les blessures. Quoi qu’il arrive, pour chaque tranche de 5 points de santé perdus après avoir atteint 0 point de santé, le personnage subit une blessure grave.</span>
        </div>
        <div class="OD OD5">
            <span class="score">5</span>
            <span class="description" data-i18n="od5-hargne-description">Le personnage ignore purement et simplement la capacité Anathème.</span>
        </div>
    </div>

    <div class="overdrive combat"> 
        <input class="afficher" type="hidden" name="attr_showCom" value="0" />

        <div class="titre">
            <h1 class="titre" data-i18n="combat">Combat</h1>

            <button class="active" type="action" name="act_showCom" data-i18n="afficher">Afficher</button>
        </div>
        <h2 class="titreBis" data-i18n="od-combat-titre">IA de close combat</h2>
        
        <div class="OD OD1">
            <span class="score">1</span>
            <span class="description"></span>
        </div>
        <div class="OD OD2">
            <span class="score">2</span>
            <span class="description" data-i18n="od2-combat-description">Lorsqu’il entre dans une phase de conflit dans laquelle il combat et tant qu’il se bat au corps à corps, le personnage gagne un bonus de 2 en réaction. Cela représente le fait qu’il se sert de son ou ses ennemis pour se protéger des tirs.</span>
        </div>
        <div class="OD OD3">
            <span class="score">3</span>
            <span class="description" data-i18n="od3-combat-description">Le personnage peut utiliser le style akimbo avec les armes de contact, en ayant seulement un malus de 1 dé à ses jets d’attaque.</span>
        </div>
        <div class="OD OD4">
            <span class="score">4</span>
            <span class="description" data-i18n="od4-combat-description">Le personnage peut utiliser le style ambidextre avec les armes de contact, en ayant seulement un malus de 1 dé à ses jets d’attaque.</span>
        </div>
        <div class="OD OD5">
            <span class="score">5</span>
            <span class="description" data-i18n="od5-combat-description">Lorsqu’une bande est présente dans un combat contre un hostile, un salopard, un patron ou un colosse, le personnage peut décider, avec une seule et même attaque de combat par tour, d’infliger la violence de ses armes à la bande et les dégâts de son attaque à l’ennemi visé. L’attaque doit toucher l’ennemi ciblé, la violence sur la bande n’étant qu’un effet bonus.</span>
        </div>
    </div>

    <div class="overdrive instinct">
        <input class="afficher" type="hidden" name="attr_showIns" value="0" />

        <div class="titre">
            <h1 class="titre" data-i18n="instinct">Instinct</h1>

            <button class="active" type="action" name="act_showIns" data-i18n="afficher">Afficher</button>
        </div>
        <h2 class="titreBis" data-i18n="od-instinct-titre">Activateur cérébral</h2>
        
        <div class="OD OD1">
            <span class="score">1</span>
            <span class="description"></span>
        </div>
        <div class="OD OD2">
            <span class="score">2</span>
            <span class="description" data-i18n="od2-instinct-description">Au début d’une phase de conflit, le personnage teste toujours deux fois son initiative et choisit le meilleur score.</span>
        </div>
        <div class="OD OD3">
            <span class="score">3</span>
            <span class="description" data-i18n="od3-instinct-description">Pour chaque overdrive d’Instinct, le personnage ajoute désormais 3 points à son score d’initiative.</span>
        </div>
        <div class="OD OD4">
            <span class="score">4</span>
            <span class="description" data-i18n="od4-instinct-description">Lorsqu’il est attaqué par surprise, le personnage conserve toujours ses scores de défense et de réaction normaux ainsi que son CdF.</span>
        </div>
        <div class="OD OD5">
            <span class="score">5</span>
            <span class="description" data-i18n="od5-instinct-description">Le personnage ressent lorsque des ennemis invisibles sont présents dans le lieu où il se trouve. Il ne peut jamais être pris en embuscade. Ses alliés profitent de cette capacité.</span>
        </div>
    </div>

    <div class="overdrive tir">
        
        <input class="afficher" type="hidden" name="attr_showTir" value="0" />

        <div class="titre">
            <h1 class="titre" data-i18n="tir">Tir</h1>

            <button class="active" type="action" name="act_showTir" data-i18n="afficher">Afficher</button>
        </div>

        <h2 class="titreBis" data-i18n="od-tir-titre">Assistance au tir</h2>
        
        <div class="OD OD1">
            <span class="score">1</span>
            <span></span>
        </div>
        <div class="OD OD2">
            <span class="score">2</span>
            <span class="description" data-i18n="od2-tir-description">Le personnage ignore le premier malus de portée. S’il veut tirer à portée moyenne avec une arme à portée courte, il ne reçoit pas de malus. Cependant, s’il veut tirer à portée longue avec une arme à portée courte, il reçoit le malus précisé par les règles, et aTiri de suite. Seul le premier malus est annulé.</span>
        </div>
        <div class="OD OD3">
            <span class="score">3</span>
            <span class="description" data-i18n="od3-tir-description">Le personnage peut utiliser le style akimbo avec les armes à distance en ayant seulement un malus de 1 dé à ses jets d’attaque.</span>
        </div>
        <div class="OD OD4">
            <span class="score">4</span>
            <span class="description" data-i18n="od4-tir-description">Le personnage peut utiliser le style ambidextre avec les armes à distance en ayant seulement un malus de 1 dé à ses jets d’attaque.</span>
        </div>
        <div class="OD OD5">
            <span class="score">5</span>
            <span class="description" data-i18n="od5-tir-description">Lorsqu’une bande est présente dans une phase de conflit contre un hostile, un salopard, un patron ou un colosse, le personnage peut décider, avec une seule et même attaque de Tir par tour, d’infliger la violence de ses armes à la bande et les dégâts de son attaque à l’ennemi visé. L’attaque doit toucher l’ennemi ciblé, la violence sur la bande n’étant qu’un effet bonus.</span>
        </div>
    </div>

    <div class="overdrive savoir">
        
        <input class="afficher" type="hidden" name="attr_showSav" value="0" />

        <div class="titre">
            <h1 class="titre" data-i18n="savoir">Savoir</h1>

            <button class="active" type="action" name="act_showSav" data-i18n="afficher">Afficher</button>
        </div>
        <h2 class="titreBis" data-i18n="od-savoir-titre">IA évoluée</h2>
        
        <div class="OD OD1">
            <span class="score">1</span>
            <span class="description" data-i18n="od1-savoir-description">Le personnage a instantanément accès aux banques d’information standard et aux encyclopédies sur la RA. Les informations lui sont transmises via son IA.</span>
        </div>
        <div class="OD OD2">
            <span class="score">2</span>
            <span class="description" data-i18n="od2-savoir-description">Grâce à l’IA, le personnage peut obtenir des informations en temps réel sur une situation proche (à moins de 2 kilomètres). L’IA se connecte aux flux d’informations, aux caméras locales, aux satellites, etc. Pour que ce bonus fonctionne, il faut que le personnage interroge l’IA. Le MJ doit répondre aux questions de manière honnête, mais n’est pas obligé de tout révéler.</span>
        </div>
        <div class="OD OD3">
            <span class="score">3</span>
            <span class="description" data-i18n="od3-savoir-description">Désormais, lorsque le personnage soigne un être vivant, il lui rend 1D6 points de santé supplémentaire (maximum une fois par scène). L’IA l’assiste et le guide lors des soins qu’il procure, même lors des opérations de chirurgie.</span>
        </div>
        <div class="OD OD4">
            <span class="score">4</span>
            <span class="description" data-i18n="od4-savoir-description">Le personnage a maintenant accès à toutes les bases de données du Knight et des immortels grâce à son IA. Il connaît la fiche d’identité et l’histoire de chaque personne répertoriée en quelques secondes seulement. Pour que ce bonus fonctionne, il faut que le personnage interroge l’IA. Au MJ d’improviser et de donner ces informations de manière honnête.</span>
        </div>
        <div class="OD OD5">
            <span class="score">5</span>
            <span class="description" data-i18n="od5-savoir-description">L’IA, très évoluée, empêche le personnage de s’enfoncer dans des situations dangereuses ou grotesques. Par des conseils ou un léger pilotage automatique de quelques millièmes de seconde, elle permet au héros d’éviter les catastrophes. Dès à présent, le personnage ignore purement et simplement les échecs critiques sur n’importe quel test.</span>
        </div>
    </div>

    <div class="overdrive technique">
        
        <input class="afficher" type="hidden" name="attr_showTec" value="0" />

        <div class="titre">
            <h1 class="titre" data-i18n="technique">Technique</h1>

            <button class="active" type="action" name="act_showTec" data-i18n="afficher">Afficher</button>
        </div>
        <h2 class="titreBis" data-i18n="od-technique-titre">Système d’ingénierie intégré (gant outil, bras articulé, etc.)</h2>
        
        <div class="OD OD1">
            <span class="score">1</span>
            <span class="description" data-i18n="od1-technique-description">Le personnage peut se connecter, s’il est à portée de contact, à n’importe quel appareil technologique, n’importe quelle machine, etc., pour peu qu’il n’y ait pas de pare-feu. En se connectant, le personnage peut récupérer des données, mais aussi voir l’état de la machine, etc.</span>
        </div>
        <div class="OD OD2">
            <span class="score">2</span>
            <span class="description" data-i18n="od2-technique-description">Le héros peut effectuer un test base Technique pour connaître le fonctionnement, réparer, hacker, modifier, bricoler ou démonter n’importe quel objet technologique ou machine, même ceux qu’il ne connaît pas et dont il n’a jamais entendu parler. La difficulté du test dépend de la complexité de l’objet, elle est donc à la discrétion du MJ.</span>
        </div>
        <div class="OD OD3">
            <span class="score">3</span>
            <span class="description" data-i18n="od3-technique-description">Le personnage peut se connecter à n’importe quel objet technologique ou machine à portée lointaine grâce au wifi. Il peut en outre passer directement les pare-feu les plus simples, sans effectuer de test, toujours à la discrétion du MJ.</span>
        </div>
        <div class="OD OD4">
            <span class="score">4</span>
            <span class="description" data-i18n="od4-technique-description">Lorsqu’il répare un objet, une machine ou une armure, plutôt que de lancer des dés pour connaître les points que l’objet récupère, le héros peut décider de lui rendre directement 12 PA.</span>
        </div>
        <div class="OD OD5">
            <span class="score">5</span>
            <span class="description" data-i18n="od5-technique-description">Le personnage peut bidouiller instinctivement des virus, des programmes de contrôle ou encore des routines qu’il peut inclure à distance dans une machine ou un objet technologique. La puissance du programme est égale à un test base Technique lors de sa création. Cette puissance doit être opposée à une difficulté pouvant représenter un pare-feu ou encore la distance entre le héros et la machine. Le personnage peut faire fonctionner en simultanée un nombre de programmes égal à son score de Technique sans les overdrives. Il ne peut lancer qu’un programme par tour de jeu et, en phase de conflit, cela lui coûte son action de déplacement. Enfin, lors de la création d’un programme, le héros doit discuter de ses effets avec le MJ. Les effets doivent rester simples (activer et commander un véhicule à distance, récupérer des données après un compte à rebours, détruire des données via un virus, etc.).</span>
        </div>
    </div>

    <div class="overdrive aura">
        
        <input class="afficher" type="hidden" name="attr_showAur" value="0" />
        
        <div class="titre">
            <h1 class="titre" data-i18n="aura">Aura</h1>

            <button class="active" type="action" name="act_showAur" data-i18n="afficher">Afficher</button>
        </div>
        <h2 class="titreBis" data-i18n="od-aura-titre">Régulateur de phéromone</h2>
        
        <div class="OD OD1">
            <span class="score">1</span>
            <span class="description"></span>
        </div>
        <div class="OD OD2">
            <span class="score">2</span>
            <span class="description" data-i18n="od2-aura-description">Le personnage, lorsqu’il Combat des humains, est toujours attaqué en dernier par les hostiles ou les salopards.</span>
        </div>
        <div class="OD OD3">
            <span class="score">3</span>
            <span class="description" data-i18n="od3-aura-description">Lorsqu’il rencontre des humains, qu’il aide ou non, le personnage peut décider de s’en faire des contacts qui deviendront ses amis ou ses amants. Par scénario, le héros peut ainsi se créer deux contacts qu’il pourra joindre via le RA, qui pourront l’aider et même l’assister dans des situations variées, voire l’acAurpagner Aurme des pages. Attention, seuls les PNJ avec un score de Dame ou de Machine divisé par 2 inférieur au score d’Aur du héros peuvent devenir des contacts.</span>
        </div>
        <div class="OD OD4">
            <span class="score">4</span>
            <span class="description" data-i18n="od4-aura-description">Le personnage, par un simple test base Aur opposé au score de Machine divisé par 2 le plus haut parmi les PNJ, peut attirer toute l’attention sur lui, permettant ainsi de créer des diversions, de préparer un discours, etc. Il attire généralement l’attention pendant un tour de jeu Aurplet (10 secondes). En Aurbat, cette capacité peut fonctionner, mais est soumise à un test base Aur dont la difficulté est à la discrétion du MJ.</span>
        </div>
        <div class="OD OD5">
            <span class="score">5</span>
            <span class="description" data-i18n="od5-aura-description">Le personnage en impose tellement qu’il peut ajouter son score d’Aur à son total de défense.</span>
        </div>
    </div>

    <div class="overdrive parole">
        
        <input class="afficher" type="hidden" name="attr_showPar" value="0" />
        
        <div class="titre">
            <h1 class="titre" data-i18n="parole">Parole</h1>

            <button class="active" type="action" name="act_showPar" data-i18n="afficher">Afficher</button>
        </div>
        <h2 class="titreBis" data-i18n="od-parole-titre">Modulateur de voix</h2>
        
        <div class="OD OD1">
            <span class="score">1</span>
            <span class="description" data-i18n="od1-parole-description">Lorsqu’un allié vient de tomber à 0 point de vie (il y a moins d’une minute), le héros peut décider de lui parler et de l’encourager à rester en vie. Tant que le héros lui parle, l’allié conserve un dernier souffle de vie et ne mourra pas, même s’il a subi la mort sur son tirage de blessure grave (dans ce cas, il doit effectuer un nouveau jet jusqu’à ce qu’il obtienne autre chose que la mort). Le héros ne peut rien faire d’autre qu’être au chevet de l’allié (un seul allié). Ce bonus ne modifie pas les autres effets des blessures et ceux des soins prodigués par les autorités Parpétentes.</span>
        </div>
        <div class="OD OD2">
            <span class="score">2</span>
            <span class="description" data-i18n="od2-parole-description">Par ses paroles, le personnage peut faire regagner 1D6 points d’espoir à un autre héros. Il doit déclamer un discours plein d’espoir. Il ne peut utiliser ce bonus qu’une fois par héros lors d’un scénario.</span>
        </div>
        <div class="OD OD3">
            <span class="score">3</span>
            <span class="description" data-i18n="od3-parole-description">Le personnage est capable d’imiter la voix de n’importe quelle personne qu’il a déjà entendue parler sans effectuer de jet base Parole ou Discrétion.</span>
        </div>
        <div class="OD OD4">
            <span class="score">4</span>
            <span class="description" data-i18n="od4-parole-description">En modulant sa voix et en se concentrant sur un être humain (pas une créature ou un robot), le personnage est capable de l’hypnotiser tant qu’il parle, sur un jet base Parole opposé à son score de Machine divisé par 2. Si le test réussit, tant que le héros parle (au prix d’une action de Parbat lors d’une phase de conflit), la personne visée ne peut plus agir et est en pleine hypnose. Avec un test réussi base Parole contre le score de Machine divisé par 2 de la personne visée, le héros peut lui faire acParplir des actions simples (qui n’attentent à la vie de personne) tant qu’il reste concentré et tant qu’il parle. Les PNJ disposant d’un aspect Bête exceptionnelle, Machine exceptionnelle, Dame exceptionnelle ou Masque exceptionnel sont immunisés à cet effet.</span>
        </div>
        <div class="OD OD5">
            <span class="score">5</span>
            <span class="description" data-i18n="od5-parole-description">Par ses paroles, le personnage peut faire regagner 2D6 points d’espoir à un allié. Il doit déclamer un discours plein d’espoir. Il ne peut utiliser ce bonus qu’une fois par allié lors d’un scénario. Cette capacité remplace celle du niveau 3.</span>
        </div>
    </div>

    <div class="overdrive sangFroid">
        
        <input class="afficher" type="hidden" name="attr_showSF" value="0" />
        
        <div class="titre">
            <h1 class="titre" data-i18n="sang-froid">Sang-Froid</h1>

            <button class="active" type="action" name="act_showSF" data-i18n="afficher">Afficher</button>
        </div>
        <h2 class="titreBis" data-i18n="od-sang-froid-titre">Diffuseur d’endorphine</h2>
        
        <div class="OD OD1">
            <span class="score">1</span>
            <span class="description"></span>
        </div>
        <div class="OD OD2">
            <span class="score">2</span>
            <span class="description" data-i18n="od2-sang-froid-description">Très calme grâce à sa méta-armure, le personnage ignore toujours les malus de difficulté dus à une situation stressante que le MJ pourrait lui infliger.</span>
        </div>
        <div class="OD OD3">
            <span class="score">3</span>
            <span class="description" data-i18n="od3-sang-froid-description">Le personnage peut relancer (une seule fois par test) un jet d’espoir raté (Hargne combo SangFroid). Il doit conserver le second résultat s’il choisi de relancer son jet.</span>
        </div>
        <div class="OD OD4">
            <span class="score">4</span>
            <span class="description" data-i18n="od4-sang-froid-description">Le personnage ignore la capacité peur.</span>
        </div>
        <div class="OD OD5">
            <span class="score">5</span>
            <span class="description" data-i18n="od5-sang-froid-description">Le personnage est immunisé à la capacité domination.</span>
        </div>
    </div>

    <div class="overdrive discretion">
        
        <input class="afficher" type="hidden" name="attr_showDis" value="0" />
        
        <div class="titre">
            <h1 class="titre" data-i18n="discretion">Discrétion</h1>

            <button class="active" type="action" name="act_showDis" data-i18n="afficher">Afficher</button>
        </div>
        <h2 class="titreBis" data-i18n="od-discretion-titre">Atténuateur de bruit et camouflage intelligent</h2>
        
        <div class="OD OD1">
            <span class="score">1</span>
            <span class="description"></span>
        </div>
        <div class="OD OD2">
            <span class="score">2</span>
            <span class="description" data-i18n="od2-discretion-description">Désormais, lorsqu’il attaque un ennemi qui ne le voit pas, le personnage ajoute son score de Discrétion (sans les overdrives) aux dégâts infligés. Ce bonus peut être cumulé avec d’autres modules ou effets.</span>
        </div>
        <div class="OD OD3">
            <span class="score">3</span>
            <span class="description" data-i18n="od3-discretion-description">Le personnage ne peut jamais être repéré à cause de ses bruits de pas. S’il doit parcourir une distance courte ou moyenne alors qu’il a peu de chance d’être repéré, il ne fait pas de test et réussit automatiquement.</span>
        </div>
        <div class="OD OD4">
            <span class="score">4</span>
            <span class="description" data-i18n="od4-discretion-description">Lorsqu’il reste immobile pour se cacher, le personnage se fond dans le décor. Les ennemis ayant un score de Machine inférieur à 10 ne le voient simplement pas. Pour les autres, il doit tout de même effectuer un test.</span>
        </div>
        <div class="OD OD5">
            <span class="score">5</span>
            <span class="description" data-i18n="od5-discretion-description">Désormais, lorsqu’il attaque un ennemi qui ne le voit pas, le personnage ajoute son score de Discrétion (avec les overdrives) aux dégâts infligés. Ce bonus peut être cumulé avec d’autres modules ou effets. En outre, il peut toujours décider de Dismencer une phase de conflit en embuscade.</span>
        </div>
    </div>

    <div class="overdrive dexterite">
        
        <input class="afficher" type="hidden" name="attr_showDex" value="0" />
        
        <div class="titre">
            <h1 class="titre" data-i18n="dexterite">Dextérité</h1>

            <button class="active" type="action" name="act_showDex" data-i18n="afficher">Afficher</button>
        </div>
        <h2 class="titreBis" data-i18n="od-dexterite-titre">Système d’aide à la coordination</h2>
        
        <div class="OD OD1">
            <span class="score">1</span>
            <span class="description"></span>
        </div>
        <div class="OD OD2">
            <span class="score">2</span>
            <span class="description"></span>
        </div>
        <div class="OD OD3">
            <span class="score">3</span>
            <span class="description" data-i18n="od3-dexterite-description">Le personnage ne peut jamais être désarmé à cause d’une attaque ou d’une défense ratée en phase de conflit, même en cas d’échec critique. En outre, il ne peut pas tomber ou être renversé à cause d’un malus d’environnement (pluie, boue, givre, etc.).</span>
        </div>
        <div class="OD OD4">
            <span class="score">4</span>
            <span class="description" data-i18n="od4-dexterite-description">Le personnage ignore l’effet lourd des armes. En outre, lors d’un test base Dexbat ou Tir, il peut toujours décider de remplacer ces caractéristiques par la Dextérité.</span>
        </div>
        <div class="OD OD5">
            <span class="score">5</span>
            <span class="description" data-i18n="od5-dexterite-description">Le personnage peut parer les projectiles et les tirs avec ses armes. Dès à présent, il peut utiliser son score de défense au lieu de son score de réaction pour éviter (parer dans ce cas) les tirs et les choses qui lui sont lancées.</span>
        </div>
    </div>

    <div class="overdrive perception">
        
        <input class="afficher" type="hidden" name="attr_showPer" value="0" />
        
        <div class="titre">
            <h1 class="titre" data-i18n="perception">Perception</h1>

            <button class="active" type="action" name="act_showPer" data-i18n="afficher">Afficher</button>
        </div>
        <h2 class="titreBis" data-i18n="od-perception-titre">Afficheur tête haute et sens augmentés</h2>
        
        <div class="OD OD1">
            <span class="score">1</span>
            <span class="description" data-i18n="od1-perception-description">Le personnage dispose d’un zoom x400. Il peut ainsi zoomer sur des détails situés à portée lointaine.</span>
        </div>
        <div class="OD OD2">
            <span class="score">2</span>
            <span class="description" data-i18n="od2-perception-description">Le personnage dispose maintenant d’un zoom audio lui permettant d’entendre des conversations situées à portée lointaine.</span>
        </div>
        <div class="OD OD3">
            <span class="score">3</span>
            <span class="description" data-i18n="od3-perception-description">Désormais, le personnage possède un zoom olfactif, lui permettant de sentir des odeurs à portée lointaine, mais aussi de les identifier via la base de données. De plus, le héros dispose d’un « zoom » pour son sens du toucher. Il peut ainsi repérer des aspérités minuscules en touchant une surface ou encore ressentir les vibrations. Ces zooms nécessitent d’être activés volontairement via une pensée.</span>
        </div>
        <div class="OD OD4">
            <span class="score">4</span>
            <span class="description" data-i18n="od4-perception-description">L’afficheur tête haute affiche maintenant une série d’informations sur tout objet, personne ou bâtiment sur lequel le personnage se concentre. Voici la liste des informations disponibles pour les objets, machines : nom, poids, taille, diamètre, dangerosité, carburant ou munitions utilisés, concepteur, date de fabrication, détails supplémentaires si répertoriés.<br/>Pour les bâtiments : nom, date de création, créateur, taille, nombre de pièces, état du bâtiment, appartenance actuelle, détails supplémentaires si répertoriés.<br/>Pour les personnes : poids, taille, âge, nom, niveau de menace si répertoriés, origines, détails supplémentaires si répertoriés. Si le personnage appartient à une arche, ses relations, sa profession et son casier judiciaire sont disponibles.</span>
        </div>
        <div class="OD OD5">
            <span class="score">5</span>
            <span class="description" data-i18n="od5-perception-description">Désormais, le personnage dispose d’un sonar constamment actif. Il repère les êtres vivants situés à portée moyenne autour de lui (qu’ils soient situés plus haut ou plus bas) malgré les obstacles (murs, sol, plafond…). Lorsqu’il est attaqué par surprise, dans le dos ou par un ennemi invisible, le personnage conserve toujours ses scores de défense et de réaction normaux.</span>
        </div>
    </div>
</div><div class="tabHistorique tab">
    <div class="col">
        <div class="experience">
            <h1 class="titre" data-i18n="experience">Expérience</h1>
            <label class="col3">
                <span data-i18n="actuel">Actuel</span>
                <input type="number" value="0" name="attr_expAct" />
            </label>
            <label class="col3BL">
                <span data-i18n="utilise">Utilisé</span>
                <input type="number" value="0" name="attr_expUti" />
            </label>
            <label class="col3BL">
                <span data-i18n="total">Total</span>
                <input type="number" value="@{expAct}+@{expUti}" name="attr_expTot" disabled />
            </label>
        </div>

        <div class="avantageInconvenient">
            <h1 class="titre" data-i18n="avantages">Avantages</h1>
            <fieldset class="repeating_avantages">
                <input type="hidden" name="attr_expand" value="1" />

                <div class="ligneTitre">
                    <button class="buttonPlus" type="action" name="act_expand-1">
                        <span class="plus">+</span>
                        <span class="moins">-</span>
                     </button>

                    <input type="text" name="attr_nomAvantages" />
                </div>
                
                <div class="autoex autoex28">
                    <span name="attr_descAvantages"></span>
                    <textarea name="attr_descAvantages"></textarea>
                </div>
            </fieldset>
        </div>

        <div class="langues">
            <h1 class="titre" data-i18n="langues">Langues</h1>
            <fieldset class="repeating_langue">
                <input type="text" name="attr_langue" />
            </fieldset>
        </div>

        <div class="notes">
            <h1 class="titre" data-i18n="notes">Notes</h1>
            <fieldset class="repeating_notesJoueur">
                <div class="autoex autoex24">
                    <span name="attr_notesJoueur"></span>
                    <textarea name="attr_notesJoueur"></textarea>
                </div>
            </fieldset>
        </div>
    </div>

    <div class="col">
        <div class="gloire">
            <h1 class="titre" data-i18n="gloire">Gloire</h1>
            <label class="col3">
                <span data-i18n="actuel">Actuel</span>
                <input type="number" name="attr_gloAct" value="0" />
            </label>
            <label class="col3BL">
                <span data-i18n="utilise">Utilisé</span>
                <input type="number" name="attr_gloUti" value="0" />
            </label>
            <label class="col3BL">
                <span data-i18n="total">Total</span>
                <input type="number" name="attr_gloTot" value="@{gloAct}+@{gloUti}" disabled />
            </label>
        </div>

        <div class="avantageInconvenient">
            <h1 class="titre" data-i18n="inconvenient">Inconvénients</h1>
            <fieldset class="repeating_inconvénient">
                <input type="hidden" name="attr_expand" value="1" />
                <div class="ligneTitre">
                    <button class="buttonPlus" type="action" name="act_expand-1">
                        <span class="plus">+</span>
                        <span class="moins">-</span>
                     </button>

                    <input type="text" name="attr_nomInconvenient" />
                </div>

                <div class="autoex autoex28">
                    <span name="attr_descInconvenient"></span>
                    <textarea name="attr_descInconvenient"></textarea>
                </div>
            </fieldset>
        </div>

        <div class="contact">
            <div class="titre">
                <h1 class="titre" data-i18n="contact">Contact</h1>		

                <input type="number" name="attr_numContact" value="(((@{aura} + (((@{parole}+@{sf}) + abs(@{parole}-@{sf})) / 2) ) + abs(@{aura} - (((@{parole}+@{sf}) + abs(@{parole}-@{sf})) / 2) )) / 2)" disabled />
            </div>
            <fieldset class="repeating_contact">
                <div class="autoex autoex28">
                    <span name="attr_contact"></span>
                    <textarea name="attr_contact"></textarea>
                </div>
            </fieldset>
        </div>

        <div class="blessuresGraves">
            <div class="titre">
                <h1 class="titre" data-i18n="blessures-graves">Blessures Graves</h1>
                <button class="rollDice" type="action" name="act_blessuresGraves" value="@{jetGM} &{template:simple} {{Nom=@{name}}}"></button>
            </div>
            <fieldset class="repeating_blessuresGraves">
                <input type="hidden" name="attr_expand" value="1" />

                <div class="ligneTitre">
                    <button class="buttonPlus" type="action" name="act_expand-1">
                        <span class="plus">+</span>
                        <span class="moins">-</span>
                     </button>

                    <input type="text" name="attr_nom" />
                </div>
                
                <div class="autoex autoex24">
                    <span name="attr_description"></span>
                    <textarea name="attr_description"></textarea>
                </div>
            </fieldset>
        </div>

        <div class="traumas">
            <div class="data">
                <input type="hidden" name="attr_traumasInsignifiants" value="Traumas insignifiants" />
                <input type="hidden" name="attr_traumasLegers" value="Traumas légers" />
                <input type="hidden" name="attr_traumasGraves" value="Traumas graves" />
                <input type="hidden" name="attr_traumasLourds" value="Traumas lourds" />
            </div>

            <div class="titre">
                <h1 class="titre" data-i18n="traumas">Traumas</h1>
                <button class="rollDice" type="action" name="act_traumas" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{rollTitre=[[?{type ?|@{traumasInsignifiants}, 0|@{traumasLegers}, 1|@{traumasGraves}, 2|@{traumasLourds}, 3}]]}} {{rollText=[[1D6]]}}"></button>
            </div>
            <fieldset class="repeating_traumas">
                <input type="hidden" name="attr_expand" value="1" />

                <div class="ligneTitre">
                    <button class="buttonPlus" type="action" name="act_expand-1">
                        <span class="plus">+</span>
                        <span class="moins">-</span>
                     </button>

                    <input type="text" name="attr_nom" />
                </div>
                
                <div class="autoex autoex24">
                    <span name="attr_description"></span>
                    <textarea name="attr_description"></textarea>
                </div>
            </fieldset>
        </div>
    </div>
</div><div class="tabArt tab">
    <div class="col">
        <div class="domaineArtistique">
            <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0" />

            <div class="data">
                <button type="roll" name="roll_1d6" value="@{jetGM} &{template:base} {{Nom=@{name}}} {{type=1D6}} {{jet=[[1d6]]}}" ></button>
                <button type="roll" name="roll_2d6" value="@{jetGM} &{template:base} {{Nom=@{name}}} {{type=2D6}} {{jet=[[2d6]]}}" ></button>
                <button type="roll" name="roll_3d6" value="@{jetGM} &{template:base} {{Nom=@{name}}} {{type=3D6}} {{jet=[[3d6]]}}" ></button>
                <button type="roll" name="roll_4d6" value="@{jetGM} &{template:base} {{Nom=@{name}}} {{type=4D6}} {{jet=[[4d6]]}}" ></button>
            </div>
            <div class="titre">
                <button type="action" class="fichePJ bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                <button type="action" class="fichePJ bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>

                <input type="text" name="attr_domaineArtistique" data-i18n-placeholder="domaine-artistique" placeholder="Domaine Artistique" value="" />
               
                <button class="rollDice" type="action" name="act_domaineArtistique" value="@{jetGM} &{template:simple} {{Nom=@{name}}}  {{special1=@{domaineArtistique}}} {{text1=@{effetPratique}}} {{qualiteApprenti=@{dAApprenti}}} {{qualiteInitie=@{dAInitie}}} {{qualiteMaitre=@{dAMaître}}} {{button=true}} {{1d6=[1D6](~1d6)}} {{2d6=[2D6](~2d6)}} {{3d6=[3D6](~3d6)}} {{4d6=[4D6](~4d6)}}"></button>
            </div>
            <div class="rollPJ">
                <select name="attr_caracteristique1Art">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
                <select name="attr_caracteristique2Art">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
            </div>
            <div class="bonusCarac">
                <select name="attr_caracteristique3Art">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
                <select name="attr_caracteristique4Art">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
            </div>
            <label class="rollBonus">
                <span data-i18n="bonus/malus-jets">Bonus/Malus aux Jets</span>
                <input type="number" name="attr_jetModifDes" value="0" />
            </label>
            <h2 class="titreBis" data-i18n="art-effet-pratique">Effet de pratique</h2>
            <div class="autoex autoex28">
                <span name="attr_effetPratique"></span>
                <textarea name="attr_effetPratique"></textarea>
            </div>
            <div class="ligneTitre">
                <span class="firstCol" data-i18n="art-qualite">Qualité</span>
                <span class="lastCol" data-i18n="art-bonus">Bonus</span>
            </div>
            <label class="ligne">
                <div class="firstCol">
                    <span data-i18n="art-qualite-apprenti">Apprenti</span>
                    <span data-i18n="art-qualite-apprenti-score">(3 à 5)</span>
                </div>
                
                <div class="lastCol autoex autoex28">
                    <span name="attr_dAApprenti"></span>
                    <textarea name="attr_dAApprenti"></textarea>
                </div>
            </label>
            <label class="ligne">
                <div class="firstCol">
                    <span data-i18n="art-qualite-initie">Initié</span>
                    <span data-i18n="art-qualite-initie-score">(6 à 8)</span>
                </div>
            
                <div class="lastCol autoex autoex28">
                    <span name="attr_dAInitie"></span>
                    <textarea name="attr_dAInitie"></textarea>
                </div>
            </label>
            <label class="ligne">
                <div class="firstCol">
                    <span data-i18n="art-qualite-maitre">Maître</span>
                    <span data-i18n="art-qualite-maitre-score">(9+)</span>
                </div>
            
                <div class="lastCol autoex autoex28">
                    <span name="attr_dAMaître"></span>
                    <textarea name="attr_dAMaître"></textarea>
                </div>
            </label>
            <h2 class="titreBis" data-i18n="art-effet-d'oeuvre">Effet d'Oeuvre</h2>
            <div class="autoex autoex28">
                <span name="attr_effetOeuvre"></span>
                <textarea name="attr_effetOeuvre"></textarea>
            </div>
        </div>
    </div>
    <div class="col">
        <div class="oeuvreArt">
            <h1 class="titre" data-i18n="oeuvres-arts-en-creation">Oeuvres d'arts en créations</h1>
            <div class="ligneTitre">
                <span class="firstCol" data-i18n="art-duree">Durée</span>
                <span class="lastCol" data-i18n="art-oeuvre">Oeuvre</span>
            </div>
            <fieldset class="repeating_oeuvreArtCreation">
                <div class="firstCol">
                    <input type="text" name="attr_OADuree" value="" />
                </div>
                <div class="lastCol">
                    <input type="text" name="attr_OAType" value="" />
                </div>
            </fieldset>
        </div>

        <div class="oeuvreArtCree">
            <h1 class="titre" data-i18n="oeuvres-d'arts-crees">Oeuvres d'arts créées</h1>
            <fieldset class="repeating_oeuvreArtCree">
                <label class="portee">
                    <span data-i18n="portee">Portée</span>
                    <input type="text" name="attr_OACPortee" value=""/>
                </label>
                <div class="autoex autoex28">
                    <span name="attr_OACree"></span>
                    <textarea name="attr_OACree"></textarea>
                </div>
            </fieldset>
        </div>
    </div>
</div><div class="tabHeroisme tab">
    <input class="cartes" type="hidden" name="attr_tabCarteDestin" value="0" />
    <input class="capacites" type="hidden" name="attr_tabCapaciteHeroique" value="0" />

    <div class="col">
        <div class="cartes">
            <h1 class="titre" data-i18n="cartes-destins">Cartes du Destin</h1>
            <fieldset class="repeating_carteDestinG">
                <input type="text" name="attr_nomCarteDestinG" />
                <div class="autoex autoex28">
                    <span name="attr_descriptionCarteDestinG"></span>
                    <textarea name="attr_descriptionCarteDestinG" class="largeTextarea"></textarea>
                </div>
            </fieldset>
        </div>
    </div>

    <div class="col">
        <div class="cartes">
            <h1 class="titre" data-i18n="cartes-destins">Cartes du Destin</h1>
            <fieldset class="repeating_carteDestinD">
                <input type="text" name="attr_nomCarteDestinD" />
                <div class="autoex autoex28">
                    <span name="attr_descriptionCarteDestinD"></span>
                    <textarea name="attr_descriptionCarteDestinD" class="largeTextarea"></textarea>
                </div>
            </fieldset>
        </div>
    </div>

    <div class="col3">
        <div class="capacites">
            <h1 class="titre" data-i18n="capacites-heroiques">Capacités héroïques</h1>
            <fieldset class="repeating_capacitesHeroiquesG">
                <input type="text" name="attr_nomCapaciteG" />
                <label>
                    <span data-i18n="activation">Activation</span>
                    <select name="attr_activationCapaciteG">
                        <option value="aucune"  data-i18n="aucune" selected>Aucune</option>
                        <option value="actionDeplacement" data-i18n="action-deplacement">Action de déplacement</option>
                        <option value="actionCombat" data-i18n="action-combat">Action de combat</option>
                    </select>
                </label>
                <label>
                    <span data-i18n="duree">Durée</span>
                    <input type="text" name="attr_dureeCapaciteG" />
                </label>
                <label>
                    <span data-i18n="heroisme">Héroïsme</span>
                    <select name="attr_heroismeCapaciteG">
                        <option value="1" selected>1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                    </select>
                </label>
                <div class="autoex autoex28">
                    <span name="attr_descriptionCapaciteG"></span>
                    <textarea name="attr_descriptionCapaciteG"></textarea>
                </div>
            </fieldset>
        </div>
    </div>

    <div class="col3">
        <div class="capacites">
            <h1 class="titre" data-i18n="capacites-heroiques">Capacités héroïques</h1>
            <fieldset class="repeating_capacitesHeroiquesC">
                <input type="text" name="attr_nomCapaciteC" />
                <label>
                    <span data-i18n="activation">Activation</span>
                    <select name="attr_activationCapaciteC" class="textCenter">
                        <option value="aucune" data-i18n="aucune" selected>Aucune</option>
                        <option value="actionDeplacement" data-i18n="action-deplacement">Action de déplacement</option>
                        <option value="actionCombat" data-i18n="action-combat">Action de combat</option>
                    </select>
                </label>
                <label>
                    <span data-i18n="duree">Durée</span>
                    <input type="text" name="attr_dureeCapaciteC"/>
                </label>
                <label>
                    <span data-i18n="heroisme">Héroïsme</span>
                    <select name="attr_heroismeCapaciteC">
                        <option value="1" selected>1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                    </select>
                </label>
                <div class="autoex autoex28">
                    <span name="attr_descriptionCapaciteC"></span>
                    <textarea name="attr_descriptionCapaciteC"></textarea>
                </div>
            </fieldset>
        </div>
    </div>

    <div class="col3">
        <div class="capacites">
            <h1 class="titre" data-i18n="capacites-heroiques">Capacités héroïques</h1>
            <fieldset class="repeating_capacitesHeroiquesD">
                <input type="text" name="attr_nomCapaciteD"/>
                <label>
                    <span data-i18n="activation">Activation</span>
                    <select name="attr_activationCapaciteD">
                        <option value="aucune" data-i18n="aucune" selected>Aucune</option>
                        <option value="actionDeplacement" data-i18n="action-deplacement">Action de déplacement</option>
                        <option value="actionCombat" data-i18n="action-combat">Action de combat</option>
                    </select>
                </label>
                <label>
                    <span data-i18n="duree">Durée</span>
                    <input type="text" name="attr_dureeCapaciteD"/>
                </label>
                <label>
                    <span data-i18n="heroisme">Héroïsme</span>
                    <select name="attr_heroismeCapaciteD">
                        <option value="1" selected>1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                    </select>
                </label>
                <div class="autoex autoex28">
                    <span name="attr_descriptionCapaciteD"></span>
                    <textarea name="attr_descriptionCapaciteD"></textarea>
                </div>
            </fieldset>
        </div>
    </div>
</div><div class="tabVehicule tab">
    <div class="col">
        <div class="donnees">
            <h1 class="titre" data-i18n="vehicule">Véhicule</h1>
            <label>
                <span data-i18n="vehicule">Véhicule</span>
                <input type="text" class="fichePJ" name="attr_vehicule_name" value="Moto Steed" />
                <input type="text" class="ficheVehicule" name="attr_character_name" value="Moto Steed" />
            </label>
            <label>
                <span data-i18n="vehicule-manoeuvrabilite">Manoeuvrabilité</span>
                <input type="number" name="attr_vehicule_manoeuvrabilite" value="3" />
            </label>
            <label>
                <span data-i18n="vehicule-vitesse">Vitesse</span>
                <input type="number" name="attr_vehicule_vitesse" value="3" />
            </label>
            <label>
                <span data-i18n="vehicule-equipage">Équipage</span>
                <input type="number" name="attr_vehicule_equipage" value="1" />
            </label>
        </div>

        <div class="jet">
            <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0" />

            <div class="fichePJ ficheVehicule titre">
                <button type="action" class="fichePJ bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                <button type="action" class="fichePJ bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>
                
                <h1 class="titre" data-i18n="pilotage">Pilotage</h1>
                <button class="rollDice fichePJ" type="action" name="act_pilotage" value="@{jetGM} &{template:simple} {{Nom=@{name}}} {{special1=^{pilotage-de} @{vehicule_name}}}"></button>
                <button class="rollDice ficheVehicule" type="action" name="act_rollVehicule" value="@{jetGM} &{template:simple} {{Nom=@{character_name}}} {{special1=^{pilotage}}}"></button>
            </div>
            <label class="bonus">
                <span data-i18n="bonus/malus-jets">Bonus/Malus aux Jets</span>
                <input type="number" name="attr_jetModifDes" value="0" />
            </label>
            <div class="fichePJ rollPJ">
                <select name="attr_caracteristique1">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
                <select name="attr_caracteristique2">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
            </div>   
            <div class="bonusCarac">
                <select name="attr_caracteristique3">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
                <select name="attr_caracteristique4">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
            </div>

            <label class="ficheVehicule col2">
                <span data-i18n="des">Dés</span>
                <input type="number" name="attr_desVehicule" value="0" />
            </label>
            <label class="ficheVehicule col2BL">
                <span data-i18n="od">OD</span>
                <input type="number" name="attr_ODVehicule" value="0" />
            </label>
        </div>

        <div class="herauts">
            <h1 class="titre">Chevalier de la lumière / Hérauts de l'équilibre</h1>
            <div>
                <input type="hidden" name="attr_devasterAnatheme" class="devasterAnatheme" value="0" />
                <input type="hidden" name="attr_bourreauTenebres" class="bourreauTenebres" value="0" />
                <input type="hidden" name="attr_equilibreBalance" class="equilibreBalance" value="0" />

                <button type="action" name="act_devasterAnatheme" class="devasterAnatheme" >Dévaster l'Anathème actif</button>
                <button type="action" name="act_bourreauTenebres" class="bourreauTenebres" >Bourreau des ténèbres actif</button>
                <button type="action" name="act_equilibreBalance" class="equilibreBalance" >Équilibrer la balance actif</button>
            </div>
        </div>
    </div>

    <div class="col">
        <div class="PE">
            <h1 class="titre" data-i18n="protection-energie">Protections et Énergie</h1>
            <div class="ligneTitre">
                <span></span>
                <span data-i18n="actuel">Actuel</span>
                <span data-i18n="maximum">Maximum</span>
            </div>
            <div class="ligne2">
                <span data-i18n="armure">Armure</span>
                <div>
                    <input type="number" name="attr_armureVehicule" min="0" value="30" />
                </div>
                <div>
                    <input type="number" name="attr_armureVehicule_max" min="0" value="30" />
                </div>
            </div>
            <div class="ligne2">
                <span data-i18n="energie">Energie</span>
                <div>
                    <input type="number" name="attr_energieVehicule" min="0" value="30" />
                </div>
                <div>
                    <input type="number" name="attr_energieVehicule_max" min="0" value="30" />
                </div>
            </div>
            <div class="ligne2">
                <span data-i18n="champ-de-force">Champ de force</span>
                <div>
                    <input type="number" class="textCenter" name="attr_cdfVehicule" min="0" value="0" />
                </div>
                <div>
                    <input type="number" class="textCenter" name="attr_cdfVehicule_max" min="0" value="0" />
                </div>
            </div>
        </div>

        <div class="fichePJ styleCombat">		
            <h1 class="titre" data-i18n="style-de-combat">Style de Combat</h1>
            <select name="attr_styleCombat">
                <option value="standard" data-i18n="standard" selected>Standard</option>
                <option value="couvert" data-i18n="couvert">À Couvert</option>
                <option value="agressif" data-i18n="agressif">Agressif</option>
                <option value="akimbo" data-i18n="akimbo">Akimbo</option>
                <option value="ambidextre" data-i18n="ambidextre">Ambidextre</option>
                <option value="defensif" data-i18n="defensif">Défensif</option>
                <option value="precis" data-i18n="precis">Précis</option>
                <option value="pilonnage" data-i18n="pilonnage">Pilonnage</option>
                <option value="puissant" data-i18n="puissant">Puissant</option>
                <option value="suppression" data-i18n="suppression">Suppression</option>
            </select>
            <input type="hidden" name="attr_styleCombat" value="standard" />
            <div class="puissant">
                <span data-i18n="bonus-en">Bonus en</span>
                <select name="attr_stylePuissantType">
                    <option value="{{stylePuissantD=[[@{stylePuissantBonus}D6]]}}" data-i18n="degats" selected>Dégâts</option>
                    <option value="{{stylePuissantV=[[@{stylePuissantBonus}D6]]}}" data-i18n="violence">Violence</option>
                </select>
                <input type="number" name="attr_stylePuissantBonus" value="0" min="0" max="6" />
            </div>
            <div class="suppression">
                <label>
                    <span>Malus aux dégâts</span>
                    <input type="number" name="attr_styleSuppressionD" value="0" min="0" max="6" />
                </label>

                <label>
                    <span>Malus à la violence</span>
                    <input type="number" name="attr_styleSuppressionV" value="0" min="0" max="4" />
                </label>
            </div>
            <div class="autoex autoex40">
                <span name="attr_styleCombatDescr"></span>
                <textarea name="attr_styleCombatDescr" readonly></textarea>
            </div>
        </div>

        <div class="ficheVehicule DRVehicule">
            <label class="col2">
                <span data-i18n="defense">Défense</span>
                <input type="number" name="attr_defenseTotalVehicule" value="0" />
            </label>

            <label class="col2BL">
                <span data-i18n="reaction">Réaction</span>
                <input type="number" name="attr_reactionTotalVehicule" value="0" />
            </label>
        </div>
    </div>    

    <div class="armesVehicule">
        <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0" />
        <input class="styleCombat" type="hidden" name="attr_styleCombat" value="0" />

        <div class="titre">
            <button type="action" class="fichePJ bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
            <button type="action" class="fichePJ bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>

            <h1 class="fichePJ titre" data-i18n="armes-distance">Armes à Distance</h1>
            <h1 class="ficheVehicule titre" data-i18n="armes">Armes</h1>
        </div>
        
        <div class="fichePJ ligneTitrePJ">
            <div class="firstCol">
                <span data-i18n="arme">Arme</span>
            </div>
            <div class="midCol">
                <span data-i18n="degats">Dégâts</span>
            </div>
            <div class="midCol">
                <span data-i18n="violence">Violence</span>
            </div>
            <div class="midCol">
                <span data-i18n="portee">Portée</span>
            </div>
            <div class="lastCol">
                <span data-i18n="jet">Jet</span>
            </div>
        </div>

        <div class="ficheVehicule ligneTitreV">
            <div class="firstCol armeNom">
                <span data-i18n="arme">Arme</span>
            </div>
            
            <div class="midCol">
                <span data-i18n="degats">Dégâts</span>
            </div>
            <div class="midCol">
                <span data-i18n="violence">Violence</span>
            </div>
            <div class="midCol">
                <span data-i18n="portee">Portée</span>
            </div>
            <div class="midCol">
                <span data-i18n="attaque">Attaque</span>
            </div>

            <div class="lastCol">
                <span data-i18n="overdrives">Overdrives</span>
            </div>
        </div>

        <div class="fichePJ armesListePJ">
            <fieldset class="repeating_armeDistVehicule">
                <input class="subMenu" type="hidden" name="attr_armeDistOptions" value="0">
                
                <div class="ligne">
                    <div class="firstCol armeNom">
                        <input type="text" name="attr_ArmeDist" />
                    </div>
                    <div class="midCol armeDegats">
                        <input class="nbre" type="number" name="attr_armeDistDegat" value="0" />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_armeDistBDegat" value="0" />
                    </div>
                    <div class="midCol armeViolence">
                        <input class="nbre" type="number" name="attr_armeDistViolence" value="0" />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_armeDistBViolence" value="0" />
                    </div>
                    <div class="midCol armePortee">
                        <select name="attr_armeDistPortee">
                            <option value="^{portee-contact}" data-i18n="portee-contact" selected>Contact</option>
                            <option value="^{portee-courte}" data-i18n="portee-courte">Courte</option>
                            <option value="^{portee-moyenne}" data-i18n="portee-moyenne">Moyenne</option>
                            <option value="^{portee-longue}" data-i18n="portee-longue">Longue</option>
                            <option value="^{portee-lointaine}" data-i18n="portee-lointaine">Lointaine</option>
                        </select>
                    </div>
                    <div class="lastCol armeCaracs">
                        <select name="attr_caracteristique1Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <select name="attr_caracteristique2Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>

                        <button class="rollDice" type="action" name="act_armedistance" value="@{jetGM} &{template:combat} {{Nom=@{name}}}" ></button>
                    </div>
                </div>

                <div class="bonus">
                    <input class="deuxMains" type="hidden" name="attr_deuxMains" value="0" />
                    
                    <label class="pilonnage">
                        <span>Pilonnage, tir n°</span>
                        <input type="number" name="attr_pilonnage" value="1" min="1" max="7" />
                    </label>

                    <label class="pilonnage">
                        <span data-i18n="pilonnageDegatsOuViolence">Pilonnage, dégâts ou violence ?</span>
                        <select name="attr_pilonnageType">
                            <option value="degats" selected>Dégâts</option>
                            <option value="violence">Violence</option>
                        </select>
                    </label>

                    <div class="bonusCarac">
                        <select name="attr_caracteristique3Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <select name="attr_caracteristique4Equipement">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                    </div>
                </div>

                <div class="subMenu">
                    <button class="effets" type="action" name="act_armedistoptions-1" data-i18n="effets">Effets</button>
                    <button class="ameliorationsArmes BL" type="action" name="act_armedistoptions-3" data-i18n="ameliorations-d'armes">Améliorations d'armes</button>
                    <button class="special BL" type="action" name="act_armedistoptions-4" data-i18n="special">Spécial</button>
                </div>

                <div class="effets">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_antiAnatheme" value="{{antiAnathème=Anti Anathème}}" />
                        <span data-i18n-title="anti-anatheme" title="Anti Anathème"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_antiVehicule" value="{{antiVehicule=Anti Véhicule}} " />
                        <span data-i18n-title="anti-vehicule" title="Anti Véhicule"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_artillerie" value="{{artillerie=Artillerie}}" />
                        <span data-i18n-title="artillerie" title="Artillerie"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_assassin" value="{{assassin=[[@{assassinValue}d6]]}} " />
                            <span data-i18n-title="assassin" title="Assassin"></span>
                        </label>
                    
                        <input type="number" name="attr_assassinValue" class="center" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_assistanceAttaque" value="{{assistanceAttaque=Assistance à l'attaque}}" />
                        <span data-i18n-title="assistance-attaque" title="Assistance à l'attaque"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_barrage" value="{{barrage=^{barrage} @{barrageValue}}} " />
                            <span data-i18n-title="barrage" title="Barrage"></span>
                        </label>
                    
                        <input type="number" name="attr_barrageValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_cadence" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                            <span data-i18n-title="cadence" title="Cadence"></span>
                        </label>
                    
                        <input type="number" name="attr_cadenceValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_chargeur" value="{{chargeur=^{chargeur} @{chargeurValue}}} " />
                            <span data-i18n-title="chargeur" title="Chargeur"></span>
                        </label>
                    
                        <input type="number" name="attr_chargeurValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_choc" value="{{choc=^{choc} @{chocValue}}}" />
                            <span data-i18n-title="choc" title="Choc"></span>
                        </label>
                    
                        <input type="number" name="attr_chocValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_defense" value="{{defense=^{defense} @{defenseValue}}}" />
                            <span data-i18n-title="defense" title="Défense"></span>
                        </label>
                    
                        <input type="number" name="attr_defenseValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_degatContinue" value="{{degatContinus=^{degats-continus} @{degatContinueValue} ([[1D6]] ^{tours})}}" />
                            <span data-i18n-title="degats-continus" title="Dégâts Continus"></span>
                        </label>
                    
                        <input type="number" name="attr_degatContinueValue" class="center" size="2" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_deuxMains" value="{{deuxMains=Deux Mains}}" />
                        <span data-i18n-title="deux-mains" title="Deux Mains"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_demoralisant" value="{{demoralisant=Démoralisant}}" />
                        <span data-i18n-title="demoralisant" title="Démoralisant"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_designation" value="{{designation=Désignation}}" />
                        <span data-i18n-title="designation" title="Désignation"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_destructeur" value="{{destructeur=[[2D6]]}}" />
                        <span data-i18n-title="destructeur" title="Destructeur"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_dispersion" value="{{dispersion=^{dispersion} @{dispersionValue}}} " />
                            <span data-i18n-title="dispersion" title="Dispersion"></span>
                        </label>
                    
                        <input type="number" name="attr_dispersionValue" class="center" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_enChaine" value="{{enChaine=En Chaîne}}" />
                        <span data-i18n-title="en-chaine" title="En Chaîne"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_esperance" value="{{esperance=Espérance}}" />
                        <span data-i18n-title="esperance" title="Espérance"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_fureur" value="{{fureur=[[4D6]]}}" />
                        <span data-i18n-title="fureur" title="Fureur"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ignoreArmure" value="{{ignoreArmure=Ignore Armure}}" />
                        <span data-i18n-title="ignore-armure" title="Ignore Armure"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ignoreCdF" value="{{ignoreCdF=Ignore Champs de Force}}" />
                        <span data-i18n-title="ignore-champ-de-force" title="Ignore CdF"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_akimbo" value="2" />
                        <span data-i18n-title="jumele-akimbo" title="Jumelé (Akimbo)"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ambidextrie" value="2" />
                        <span data-i18n-title="jumele-ambidextrie" title="Jumelé (Ambidextrie)"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_leste" value="{{leste=[[@{force}]]}}" />
                        <span data-i18n-title="leste" title="Lesté"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_lourd" value="1" />
                        <span data-i18n-title="lourd" title="Lourd"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_lumiere" value="{{lumiere=^{lumiere} @{lumiereValue}}}" />
                            <span data-i18n-title="lumiere" title="Lumière"></span>
                        </label>
                    
                        <input type="number" name="attr_lumiereValue" class="center" size="2" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_meurtrier" value="{{meurtrier=[[2D6]]}}" />
                        <span data-i18n-title="meutrier" title="Meurtrier"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_obliteration" value="{{obliteration=Oblitération}}" />
                        <span data-i18n-title="obliteration" title="Oblitération"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_orfevrerie" value="{{orfevrerie=[[@{dexterite}+@{dextOD}]]}} {{orfevrerieWarrior=[[@{dexterite}+@{dextOD}+@{warriorScoutA}]]}}" />
                        <span data-i18n-title="orfevrerie" title="Orfèvrerie"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_parasitage" value="{{parasitage=^{parasitage} @{parasitageValue}}}" />
                            <span data-i18n-title="parasitage" title="Parasitage"></span>
                        </label>
                    
                        <input type="number" name="attr_parasitageValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_penetrant" value="{{penetrant=^{penetrant} @{penetrantValue}}}" />
                            <span data-i18n-title="penetrant" title="Pénétrant"></span>
                        </label>
                    
                        <input type="number" name="attr_penetrantValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_perceArmure" value="{{perceArmure=^{perce-armure} @{perceArmureValue}}}" />
                            <span data-i18n-title="perce-armure" title="Perce Armure"></span>
                        </label>
                    
                        <input type="number" name="attr_perceArmureValue" class="center" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_precision" value="{{precision=[[@{tir}+@{tirOD}]]}} {{precisionWarrior=[[@{tir}+@{tirOD}+@{warriorScholarA}]]}}" />
                        <span data-i18n-title="precision" title="Précision"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_reaction" value="{{reaction=^{reaction} @{reactionValue}}}" />
                            <span data-i18n-title="reaction" title="Réaction"></span>
                        </label>
                    
                        <input type="number" name="attr_reactionValue" class="center" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_silencieux" value="{{silencieux=Silencieux}}" />
                        <span data-i18n-title="silencieux" title="Silencieux"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_soumission" value="{{soumission=Soumission}}" />
                        <span data-i18n-title="soumission" title="Soumission"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_tenebricite" value="{{tenebricide=Ténébricide}}" />
                        <span data-i18n-title="tenebricide" title="Ténébricide"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_tirRafale" value="{{tirRafale=Tir en Rafale}}" />
                        <span data-i18n-title="tir-rafale" title="Tir en Rafale"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_tirSecurite" value="3" />
                        <span data-i18n-title="tir-securite" title="Tir en Sécurité"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ultraViolence" value="{{ultraviolence=[[2D6]]}}" />
                        <span data-i18n-title="ultraviolence" title="Ultraviolence"></span>
                    </label>
                </div>
                <div class="ameliorationsArmes">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_chargeurGrappes" value="1" />
                        <span data-i18n-title="balles-grappes" title="Balles grappes"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_canonLong" value="{{canonLongM=1}} {{canonLongC=Canon Long (Portée Courte : +3 Difficulté)}}" />
                        <span data-i18n-title="canon-long" title="Canon Long"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_canonRaccourci" value="{{canonRaccourci=Canon Raccourci (Portée Courte : Dispersion 3 / Sinon : +3 Difficulté)}}" />
                        <span data-i18n-title="canon-raccourci" title="Canon Raccourci"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_chambreDouble" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                        <span data-i18n-title="chambre-double" title="Chambre Double"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_interfaceGuidage" value="3" />
                        <span data-i18n-title="interface-guidage" title="Interface de guidage"></span>
                    </label>
                    <div class="doubleTexte">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_jumelage" value="{{jumelage=^{jumelage} (@{jumelageValue})}}" />
                            <span data-i18n-title="jumelage" title="Jumelage :"></span>
                        </label>
                    
                        <input type="text" name="attr_jumelageValue" class="center" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_lunetteIntelligente" value="{{lunetteIntelligente=Lunette Intelligente (+1 Portée)}}" />
                        <span data-i18n-title="lunette-intelligente" title="Lunette Intelligente"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsHyperVelocite" value="{{munitionsHyperVelocite=Munitions à Hyper Velocite (Assistance à l'Attaque)}}" />
                        <span data-i18n-title="munitions-hyper-velocite-short" title="Munitions à H. Vélocité"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsDrone" value="{{munitionsDrone=3}}" />
                        <span data-i18n-title="munitions-drones" title="Munitions Drones"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_chargeurExplosives" value="1" />
                        <span data-i18n-title="munitions-explosives" title="Munitions Explosives"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsIEM" value="1" />
                        <span data-i18n-title="munitions-iem" title="Munitions IEM"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsNonLetales" value="2" />
                        <span data-i18n-title="munitions-non-letales-short" title="Munitions N. Létales"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsSubsoniques" value="{{munitionsSubsoniques=Munitions Subsoniques (Silencieux)}}" />
                        <span data-i18n-title="munitions-subsoniques" title="Munitions Subsoniques"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pointeurLaser" value="{{pointeurLaser=1}} " />
                        <span data-i18n-title="pointeur-laser" title="Pointeur Laser"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_protectionArme" value="{{protectionArme=Protection d'Arme (Reaction +2)}}" />
                        <span data-i18n-title="pointeur-d'arme" title="Protection d'Arme"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_revetementOmega" value="2" />
                        <span data-i18n-title="revetement-omega" title="Revêtement Omega"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_structureElement" value="{{structureElement=Structure en Élément}}" />
                        <span data-i18n-title="structure-element-alpha-short" title="Structure Alpha"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_systemeRefroidissement" value="{{systemeRefroidissement=Système de Refroidissement (Tir en Rafale + Barrage 1)}}" />
                        <span data-i18n-title="systeme-refroidissement-short" title="Système de Refroid."></span>
                    </label>
                </div>
                <div class="special">
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_energie" value="{{energie=@{energieValue}}} " />
                            <span data-i18n-title="energie" title="Énergie"></span>
                        </label>
                    
                        <input type="number" name="attr_energieValue" class="center" value="0" />
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_bDDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_bDDiversTotal" value="{{BDDivers=[[@{bDDiversD6}D6+@{bDDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-degats" title="Bonus aux dégâts"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_bDDiversD6" class="center" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_bDDiversFixe" class="center" value="0" />
                        </div>
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_bVDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_bVDiversTotal" value="{{BVDivers=[[@{bVDiversD6}D6+@{bVDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-violence" title="Bonus à la violence"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_bVDiversD6" class="center" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_bVDiversFixe" class="center" value="0" />
                        </div>
                    </div>
                </div>
            </fieldset>
        </div>
        
        <div class="ficheVehicule armesListeV">
            <fieldset class="repeating_armeAutre">
                <input class="subMenu" type="hidden" name="attr_armeAutreOptions" value="0" />

                <div class="ligne">
                    <div class="firstCol armeNom">
                        <input type="text" name="attr_ArmeAutre" />
                    </div>
                    <div class="midCol armeDegats">
                        <input class="nbre" type="number" name="attr_armeAutreDegat" class="textCenter" value="0" />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_armeAutreBDegat" class="textCenter" value="0" />
                    </div>
                    <div class="midCol armeViolence">
                        <input class="nbre" type="number" name="attr_armeAutreViolence" class="textCenter" value="0" />
                        <b>D6+</b>
                        <input class="bonus" type="number" name="attr_armeAutreBViolence" class="textCenter" value="0" />
                    </div>
                    <div class="midCol armePortee">
                        <select name="attr_armeAutrePortee">
                            <option value="^{portee-contact}" data-i18n="portee-contact" selected>Contact</option>
                            <option value="^{portee-courte}" data-i18n="portee-courte">Courte</option>
                            <option value="^{portee-moyenne}" data-i18n="portee-moyenne">Moyenne</option>
                            <option value="^{portee-longue}" data-i18n="portee-longue">Longue</option>
                            <option value="^{portee-lointaine}" data-i18n="portee-lointaine">Lointaine</option>
                        </select>
                    </div>
                    <div class="midCol armeAttaque">
                        <input class="nbre" type="number" name="attr_armeAttaqueAutre" value="0" />
                        <b>D6+</b>
                    </div>
                    <div class="lastCol armeJet">
                        <input class="bonus" type="number" name="attr_armeODAutre" value="0" />
                        <button class="rollDice" type="action" name="act_armeautrepjvehicule" value="@{jetGM} &{template:combat} {{Nom=@{name}}}"></button>
                    </div>
                </div>

                <div class="subMenu">
                    <button class="effets" type="action" name="act_armeautreoptions-1" data-i18n="effets">Effets</button>
                    <button class="ameliorationsArmes BL" type="action" name="act_armeautreoptions-3" data-i18n="ameliorations-d'armes">Améliorations d'armes</button>
                    <button class="special BL" type="action" name="act_armeautreoptions-4" data-i18n="special">Spécial</button>
                </div>

                <div class="effets">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_antiAnatheme" value="{{antiAnathème=Anti Anathème}}" />
                        <span data-i18n-title="anti-anatheme" title="Anti Anathème"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_antiVehicule" value="{{antiVehicule=Anti Véhicule}} " />
                        <span data-i18n-title="anti-vehicule" title="Anti Véhicule"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_artillerie" value="{{artillerie=Artillerie}}" />
                        <span data-i18n-title="artillerie" title="Artillerie"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_assassin" value="{{assassin=[[@{assassinValue}d6]]}} " />
                            <span data-i18n-title="assassin" title="Assassin"></span>
                        </label>
                    
                        <input type="number" name="attr_assassinValue" class="center" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_assistanceAttaque" value="{{assistanceAttaque=Assistance à l'attaque}}" />
                        <span data-i18n-title="assistance-attaque" title="Assistance à l'attaque"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_barrage" value="{{barrage=^{barrage} @{barrageValue}}} " />
                            <span data-i18n-title="barrage" title="Barrage"></span>
                        </label>
                    
                        <input type="number" name="attr_barrageValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_cadence" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                            <span data-i18n-title="cadence" title="Cadence"></span>
                        </label>
                    
                        <input type="number" name="attr_cadenceValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_chargeur" value="{{chargeur=^{chargeur} @{chargeurValue}}} " />
                            <span data-i18n-title="chargeur" title="Chargeur"></span>
                        </label>
                    
                        <input type="number" name="attr_chargeurValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_choc" value="{{choc=^{choc} @{chocValue}}}" />
                            <span data-i18n-title="choc" title="Choc"></span>
                        </label>
                    
                        <input type="number" name="attr_chocValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_defense" value="{{defense=^{defense} @{defenseValue}}}" />
                            <span data-i18n-title="defense" title="Défense"></span>
                        </label>
                    
                        <input type="number" name="attr_defenseValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_degatContinue" value="{{degatContinus=^{degats-continus} @{degatContinueValue} ([[1D6]] ^{tours})}}" />
                            <span data-i18n-title="degats-continus" title="Dégâts Continus"></span>
                        </label>
                    
                        <input type="number" name="attr_degatContinueValue" class="center" size="2" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_deuxMains" value="{{deuxMains=Deux Mains}}" />
                        <span data-i18n-title="deux-mains" title="Deux Mains"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_demoralisant" value="{{demoralisant=Démoralisant}}" />
                        <span data-i18n-title="demoralisant" title="Démoralisant"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_designation" value="{{designation=Désignation}}" />
                        <span data-i18n-title="designation" title="Désignation"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_destructeur" value="{{destructeur=[[2D6]]}}" />
                        <span data-i18n-title="destructeur" title="Destructeur"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_dispersion" value="{{dispersion=^{dispersion} @{dispersionValue}}} " />
                            <span data-i18n-title="dispersion" title="Dispersion"></span>
                        </label>
                    
                        <input type="number" name="attr_dispersionValue" class="center" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_enChaine" value="{{enChaine=En Chaîne}}" />
                        <span data-i18n-title="en-chaine" title="En Chaîne"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_esperance" value="{{esperance=Espérance}}" />
                        <span data-i18n-title="esperance" title="Espérance"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_fureur" value="{{fureur=[[4D6]]}}" />
                        <span data-i18n-title="fureur" title="Fureur"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ignoreArmure" value="{{ignoreArmure=Ignore Armure}}" />
                        <span data-i18n-title="ignore-armure" title="Ignore Armure"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ignoreCdF" value="{{ignoreCdF=Ignore Champs de Force}}" />
                        <span data-i18n-title="ignore-champ-de-force" title="Ignore CdF"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_akimbo" value="2" />
                        <span data-i18n-title="jumele-akimbo" title="Jumelé (Akimbo)"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ambidextrie" value="2" />
                        <span data-i18n-title="jumele-ambidextrie" title="Jumelé (Ambidextrie)"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_leste" value="{{leste=[[@{force}]]}}" />
                        <span data-i18n-title="leste" title="Lesté"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_lourd" value="1" />
                        <span data-i18n-title="lourd" title="Lourd"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_lumiere" value="{{lumiere=^{lumiere} @{lumiereValue}}}" />
                            <span data-i18n-title="lumiere" title="Lumière"></span>
                        </label>
                    
                        <input type="number" name="attr_lumiereValue" class="center" size="2" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_meurtrier" value="{{meurtrier=[[2D6]]}}" />
                        <span data-i18n-title="meutrier" title="Meurtrier"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_obliteration" value="{{obliteration=Oblitération}}" />
                        <span data-i18n-title="obliteration" title="Oblitération"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_orfevrerie" value="{{orfevrerie=[[@{dexterite}+@{dextOD}]]}} {{orfevrerieWarrior=[[@{dexterite}+@{dextOD}+@{warriorScoutA}]]}}" />
                        <span data-i18n-title="orfevrerie" title="Orfèvrerie"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_parasitage" value="{{parasitage=^{parasitage} @{parasitageValue}}}" />
                            <span data-i18n-title="parasitage" title="Parasitage"></span>
                        </label>
                    
                        <input type="number" name="attr_parasitageValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_penetrant" value="{{penetrant=^{penetrant} @{penetrantValue}}}" />
                            <span data-i18n-title="penetrant" title="Pénétrant"></span>
                        </label>
                    
                        <input type="number" name="attr_penetrantValue" class="center" value="0" />
                    </div>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_perceArmure" value="{{perceArmure=^{perce-armure} @{perceArmureValue}}}" />
                            <span data-i18n-title="perce-armure" title="Perce Armure"></span>
                        </label>
                    
                        <input type="number" name="attr_perceArmureValue" class="center" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_precision" value="{{precision=[[@{tir}+@{tirOD}]]}} {{precisionWarrior=[[@{tir}+@{tirOD}+@{warriorScholarA}]]}}" />
                        <span data-i18n-title="precision" title="Précision"></span>
                    </label>
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_reaction" value="{{reaction=^{reaction} @{reactionValue}}}" />
                            <span data-i18n-title="reaction" title="Réaction"></span>
                        </label>
                    
                        <input type="number" name="attr_reactionValue" class="center" value="0" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_silencieux" value="{{silencieux=Silencieux}}" />
                        <span data-i18n-title="silencieux" title="Silencieux"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_soumission" value="{{soumission=Soumission}}" />
                        <span data-i18n-title="soumission" title="Soumission"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_tenebricite" value="{{tenebricide=Ténébricide}}" />
                        <span data-i18n-title="tenebricide" title="Ténébricide"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_tirRafale" value="{{tirRafale=Tir en Rafale}}" />
                        <span data-i18n-title="tir-rafale" title="Tir en Rafale"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_tirSecurite" value="3" />
                        <span data-i18n-title="tir-securite" title="Tir en Sécurité"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_ultraViolence" value="{{ultraviolence=[[2D6]]}}" />
                        <span data-i18n-title="ultraviolence" title="Ultraviolence"></span>
                    </label>
                </div>
                <div class="ameliorationsArmes">
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_chargeurGrappes" value="1" />
                        <span data-i18n-title="balles-grappes" title="Balles grappes"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_canonLong" value="{{canonLongM=1}} {{canonLongC=Canon Long (Portée Courte : +3 Difficulté)}}" />
                        <span data-i18n-title="canon-long" title="Canon Long"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_canonRaccourci" value="{{canonRaccourci=Canon Raccourci (Portée Courte : Dispersion 3 / Sinon : +3 Difficulté)}}" />
                        <span data-i18n-title="canon-raccourci" title="Canon Raccourci"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_chambreDouble" value="[[?{Plusieurs cibles ?|Oui, 3.5|Non, 0.5}]]" />
                        <span data-i18n-title="chambre-double" title="Chambre Double"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_interfaceGuidage" value="3" />
                        <span data-i18n-title="interface-guidage" title="Interface de guidage"></span>
                    </label>
                    <div class="doubleTexte">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_jumelage" value="{{jumelage=^{jumelage} (@{jumelageValue})}}" />
                            <span data-i18n-title="jumelage" title="Jumelage :"></span>
                        </label>
                    
                        <input type="text" name="attr_jumelageValue" class="center" />
                    </div>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_lunetteIntelligente" value="{{lunetteIntelligente=Lunette Intelligente (+1 Portée)}}" />
                        <span data-i18n-title="lunette-intelligente" title="Lunette Intelligente"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsHyperVelocite" value="{{munitionsHyperVelocite=Munitions à Hyper Velocite (Assistance à l'Attaque)}}" />
                        <span data-i18n-title="munitions-hyper-velocite-short" title="Munitions à H. Vélocité"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsDrone" value="{{munitionsDrone=3}}" />
                        <span data-i18n-title="munitions-drones" title="Munitions Drones"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_chargeurExplosives" value="1" />
                        <span data-i18n-title="munitions-explosives" title="Munitions Explosives"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsIEM" value="1" />
                        <span data-i18n-title="munitions-iem" title="Munitions IEM"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsNonLetales" value="2" />
                        <span data-i18n-title="munitions-non-letales-short" title="Munitions N. Létales"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_munitionsSubsoniques" value="{{munitionsSubsoniques=Munitions Subsoniques (Silencieux)}}" />
                        <span data-i18n-title="munitions-subsoniques" title="Munitions Subsoniques"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_pointeurLaser" value="{{pointeurLaser=1}} " />
                        <span data-i18n-title="pointeur-laser" title="Pointeur Laser"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_protectionArme" value="{{protectionArme=Protection d'Arme (Reaction +2)}}" />
                        <span data-i18n-title="pointeur-d'arme" title="Protection d'Arme"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_revetementOmega" value="2" />
                        <span data-i18n-title="revetement-omega" title="Revêtement Omega"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_structureElement" value="{{structureElement=Structure en Élément}}" />
                        <span data-i18n-title="structure-element-alpha-short" title="Structure Alpha"></span>
                    </label>
                    <label class="simple fakeButton">
                        <input type="checkbox" name="attr_systemeRefroidissement" value="{{systemeRefroidissement=Système de Refroidissement (Tir en Rafale + Barrage 1)}}" />
                        <span data-i18n-title="systeme-refroidissement-short" title="Système de Refroid."></span>
                    </label>
                </div>
                <div class="special">
                    <div class="double">
                        <label class="fakeButton">
                            <input type="checkbox" name="attr_energie" value="{{energie=@{energieValue}}} " />
                            <span data-i18n-title="energie" title="Énergie"></span>
                        </label>
                    
                        <input type="number" name="attr_energieValue" class="center" value="0" />
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_bDDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_bDDiversTotal" value="{{BDDivers=[[@{bDDiversD6}D6+@{bDDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-degats" title="Bonus aux dégâts"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_bDDiversD6" class="center" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_bDDiversFixe" class="center" value="0" />
                        </div>
                    </div>
                    <div class="triple">
                        <input type="hidden" name="attr_bVDiversTotal" value="0" />

                        <label class="fakeButton">
                            <input type="checkbox" name="attr_bVDiversTotal" value="{{BVDivers=[[@{bVDiversD6}D6+@{bVDiversFixe}]]}} " />
                            <span data-i18n-title="bonus-violence" title="Bonus à la violence"></span>
                        </label>
                        <div>
                            <input class="L" type="number" name="attr_bVDiversD6" class="center" value="0" />
                            <span>D6+</span>
                            <input class="R" type="number" name="attr_bVDiversFixe" class="center" value="0" />
                        </div>
                    </div>
                </div>
            </fieldset>
        </div>
    </div>

    <div class="col3">
        <div class="notes">
            <h1 class="titre" data-i18n="notes">Notes</h1>
            <fieldset class="repeating_notesJoueurVehicule">
                <div class="autoex autoex28">
                    <span name="attr_notesJoueurVehicule"></span>
                    <textarea name="attr_notesJoueurVehicule" ></textarea>
                </div>
            </fieldset>
        </div>
    </div>
    
    <div class="col3">
        <div class="effetsArmes">
            <h1 class="titre" data-i18n="effet-des-armes">Effet des armes</h1>
            <select name="attr_effetArmes">
                <option value="" selected></option>
                <option value="anti-anatheme-description" data-i18n="anti-anatheme">Anti-Anathème</option>
                <option value="anti-vehicule-description" data-i18n="anti-vehicule">Anti-Véhicule</option>
                <option value="artillerie-description" data-i18n="artillerie">Artillerie</option>
                <option value="assassin-description" data-i18n="assassin">Assassin X</option>
                <option value="assistance-attaque-description" data-i18n="assistance-attaque">Assistance à l'attaque</option>
                <option value="barrage-description" data-i18n="barrage">Barrage X</option>
                <option value="cadence-description" data-i18n="cadence">Cadence X</option>
                <option value="chargeur-description" data-i18n="chargeur">Chargeur X</option>
                <option value="choc-description" data-i18n="choc">Choc X</option>
                <option value="defense-reaction-description" data-i18n="defense-reaction">Défense X / Réaction X</option>
                <option value="degats-continus-description" data-i18n="degats-continus">Dégâts Continus X</option>
                <option value="demoralisant-description" data-i18n="demoralisant">Démoralisant</option>
                <option value="designation-description" data-i18n="designation">Désignation</option>
                <option value="destructeur-description" data-i18n="destructeur">Destructeur</option>
                <option value="deux-mains-description" data-i18n="deux-mains">Deux Mains</option>
                <option value="dispersion-description" data-i18n="dispersion">Dispersion X</option>
                <option value="en-chaine-description" data-i18n="en-chaine">En Chaîne</option>
                <option value="esperance-description" data-i18n="esperance">Espérance</option>
                <option value="fureur-description" data-i18n="fureur">Fureur</option>
                <option value="ignore-armure-description" data-i18n="ignore-armure">Ignore Armure</option>
                <option value="ignore-champ-de-force-description" data-i18n="ignore-champ-de-force">Ignore Champ de Force</option>
                <option value="jumele-akimbo-description" data-i18n="jumele-akimbo">Jumelé (Akimbo)</option>
                <option value="jumele-ambidextrie-description" data-i18n="jumele-ambidextrie">Jumelé (Ambidextrie)</option>
                <option value="leste-description" data-i18n="leste">Lesté</option>
                <option value="lourd-description" data-i18n="lourd">Lourd</option>
                <option value="lumiere-description" data-i18n="lumiere">Lumière X</option>
                <option value="meurtrier-description" data-i18n="meurtrier">Meurtrier</option>
                <option value="obliteration-description" data-i18n="obliteration">Oblitération</option>
                <option value="orfevrerie-description" data-i18n="orfevrerie">Orfèvrerie</option>
                <option value="parasitage-description" data-i18n="parasitage">Parasitage X</option>
                <option value="penetrant-description" data-i18n="penetrant">Pénétrant X</option>
                <option value="perce-armure-description" data-i18n="perce-armure">Perce Armure X</option>
                <option value="precision-description" data-i18n="precision">Précision</option>
                <option value="silencieux-description" data-i18n="silencieux">Silencieux</option>
                <option value="soumission-description" data-i18n="soumission">Soumission</option>
                <option value="tenebricide-description" data-i18n="tenebricide">Ténébricide</option>
                <option value="tir-rafale-description" data-i18n="tir-rafale">Tir en rafale</option>
                <option value="tir-securite-description" data-i18n="tir-securite">Tir en sécurité</option>
                <option value="ultraviolence-description" data-i18n="ultraviolence">Ultraviolence</option>
            </select>
            <span name="attr_effetArmes-description"></span>
        </div>
    </div>
    
    <div class="col3">
        <div class="effetsArmes">
            <h1 class="titre" data-i18n="amelioration-structurelle-des-armes">Amélioration (structurelle) des armes</h1>
            <select name="attr_ameliorationArmes">
                <option value="" selected></option>
                <option value="agressive-description" data-i18n="agressive">Agressive</option>
                <option value="assassine-description" data-i18n="assassine">Assassine</option>
                <option value="allegee-description" data-i18n="allegee">Allégée</option>
                <option value="meutrier-description" data-i18n="meutrier">Barbelée</option>
                <option value="canon-raccourci-description" data-i18n="canon-raccourci">Canon raccourci</option>
                <option value="chambre-double-description" data-i18n="chambre-double">Chambre double</option>
                <option value="chargeur-balles-grappes-description" data-i18n="chargeur-balles-grappes">Chargeur et balles grappes</option>
                <option value="chargeur-munitions-explosives-description" data-i18n="chargeur-munitions-explosives">Chargeur et munitions explosives</option>
                <option value="connectee-description" data-i18n="connectee">Connectée</option>
                <option value="electrifiee-description" data-i18n="electrifiee">Électrifiée</option>
                <option value="grenades-intelligentes-avancees-description" data-i18n="grenades-intelligentes-avancees">Grenades intelligentes avancées</option>
                <option value="indestructible-description" data-i18n="indestructible">Indestructible</option>
                <option value="interface-guidage-description" data-i18n="interface-guidage">Interface de guidage</option>
                <option value="jumelage-description" data-i18n="jumelage">Jumelage</option>
                <option value="jumelle-description" data-i18n="jumelle">Jumelle</option>
                <option value="lumineuse-description" data-i18n="lumineuse">Lumineuse</option>
                <option value="lunette-intelligente-description" data-i18n="lunette-intelligente">Lunette intelligente</option>
                <option value="munitions-hyper-velocite-description" data-i18n="munitions-hyper-velocite">Munitions à Hyper Vélocité</option>
                <option value="massive-description" data-i18n="massive">Massive</option>
                <option value="munitions-drones-description" data-i18n="munitions-drones">Munitions drones</option>
                <option value="munitions-iem-description" data-i18n="munitions-iem">Munitions IEM</option>
                <option value="munitions-non-letales-description" data-i18n="munitions-non-letales">Munitions non létales</option>
                <option value="munitions-subsoniques-description" data-i18n="munitions-subsoniques">Munitions subsoniques</option>
                <option value="pointeur-laser-description" data-i18n="pointeur-laser">Pointeur laser</option>
                <option value="protection-d'arme-description" data-i18n="protection-d'arme">Protection d'arme</option>
                <option value="protectrice-description" data-i18n="protectrice">Protectrice</option>
                <option value="revetement-omega-description" data-i18n="revetement-omega">Revêtement Omega</option>
                <option value="sournoise-description" data-i18n="sournoise">Sournoise</option>
                <option value="structure-element-alpha-description" data-i18n="structure-element-alpha">Structure en Element Alpha</option>
                <option value="sur-mesure-description" data-i18n="sur-mesure">Sur Mesure</option>
                <option value="systeme-refroidissement-description" data-i18n="systeme-refroidissement">Système de refroidissement</option>
            </select>
            <span name="attr_ameliorationArmes-description"></span>
        </div>
    </div>
</div><div class="tabEquipage tab">
    <div class="col">
        <div class="equipage">
            <h1 class="titre" data-i18n="vehicule-equipage">Equipage</h1>
            <fieldset class="repeating_equipage1">
                <label>
                    <span data-i18n="nom">Nom</span>
                    <input type="text" name="attr_nomEquipage" />
                </label>
                <label class="borderTop">
                    <span data-i18n="vehicule-poste">Poste</span>
                    <input type="text" name="attr_posteEquipage" />
                </label>
                <div class="autoex autoex28">
                    <span name="attr_notesEquipage"></span>
                    <textarea name="attr_notesEquipage"></textarea>
                </div>
            </fieldset>
        </div>
    </div>

    <div class="col">
        <div class="equipage">
            <h1 class="titre" data-i18n="vehicule-equipage">Equipage</h1>
            <fieldset class="repeating_equipage2">
                <label>
                    <span data-i18n="nom">Nom</span>
                    <input type="text" name="attr_nomEquipage" />
                </label>
                <label class="borderTop">
                    <span data-i18n="vehicule-poste">Poste</span>
                    <input type="text" name="attr_posteEquipage" />
                </label>
                <div class="autoex autoex28">
                    <span name="attr_notesEquipage"></span>
                    <textarea name="attr_notesEquipage"></textarea>
                </div>
            </fieldset>
        </div>
    </div>

    <div class="col">
        <div class="equipage">
            <h1 class="titre" data-i18n="vehicule-equipage">Equipage</h1>
            <fieldset class="repeating_equipage3">
                <label>
                    <span data-i18n="nom">Nom</span>
                    <input type="text" name="attr_nomEquipage" />
                </label>
                <label class="borderTop">
                    <span data-i18n="vehicule-poste">Poste</span>
                    <input type="text" name="attr_posteEquipage" />
                </label>
                <div class="autoex autoex28">
                    <span name="attr_notesEquipage"></span>
                    <textarea name="attr_notesEquipage"></textarea>
                </div>
            </fieldset>
        </div>
    </div>   
</div><div class="tabMechaArmure tab">
    <input type="hidden" name="mechaArmureJetBonus" value="0" />
    <input type="hidden" name="mechaArmureJetBonusType" value="" />
    <input type="hidden" name="attr_mechaArmureStyles" value="{{@{styleCombat}=@{styleCombat}}} {{style=^{@{styleCombat}}}}" />

    <input class="selectionMA" type="hidden" name="attr_mechaArmure" value="" />

    <div class="selectionMA">
        <h1 class="titre" data-i18n="mecha-armure">Mécha-Armure</h1>
        <div class="button">
            <button class="archangel" type="action" name="act_mechaArmure_archangel" data-i18n="archangel">Archangel</button>
            <button class="nephilim" type="action" name="act_mechaArmure_nephilim" data-i18n="nephilim">Nephilim</button>
            <button class="demon" type="action" name="act_mechaArmure_demon" data-i18n="demon">Demon</button>
        </div>
    </div>
    
    <div class="col">
        <div class="donnees">
            <h1 class="titre"><span class="MANom" name="attr_mechaArmure" data-i18n-dynamic></span></h1>
            <div class="ligneTitre">
                <span></span>
                <span data-i18n="total">Total</span>
                <span data-i18n="modif">Modif</span>
            </div>
            <div class="ligne2">
                <span data-i18n="vehicule-vitesse">Vitesse</span>
                <div><input type="number" name="attr_mechaArmureVitesse" value="0" readonly /></div>
                <div><input type="number" name="attr_mechaArmureVitesseModif" value="0" /></div>
            </div>
            <div class="ligne2">
                <span data-i18n="vehicule-manoeuvrabilite">Manoeuvrabilité</span>
                <div><input type="number" name="attr_mechaArmureManoeuvrabilite" value="0" readonly /></div>
                <div><input type="number" name="attr_mechaArmureManoeuvrabiliteModif" value="0" /></div>
            </div>
            <div class="ligne2">
                <span data-i18n="puissance">Puissance</span>
                <div><input type="number" name="attr_mechaArmurePuissance" value="0" readonly /></div>
                <div><input type="number" name="attr_mechaArmurePuissanceModif" value="0" /></div>
            </div>
            <div class="ligne2">
                <span data-i18n="senseurs">Senseurs</span>
                <div><input type="number" name="attr_mechaArmureSenseurs" value="0" readonly /></div>
                <div><input type="number" name="attr_mechaArmureSenseursModif" value="0" /></div>
            </div>
            <div class="ligne2">
                <span data-i18n="systemes">Systèmes</span>
                <div><input type="number" name="attr_mechaArmureSystemes" value="0" readonly /></div>
                <div><input type="number" name="attr_mechaArmureSystemesModif" value="0" /></div>
            </div>
        </div>

        <div class="autoReparation">
            <h1 class="titre" data-i18n="autoreparation">Autoréparation</h1>
            <div class="col2">
                <span data-i18n="blindage">Blindage</span>
                <button class="rollDice" type="action" name="act_mechaArmureARBlindage" value="@{jetGM} &{template:mechaArmure} {{Nom=@{name}}} {{special1=@{mechaArmureNom}}} {{special2=^{blindage}}}"></button>
            </div>
            <div class="col2BL">
                <span data-i18n="resilience">Résilience</span>
                <button class="rollDice" type="action" name="act_mechaArmureARResilience" value="@{jetGM} &{template:mechaArmure} {{Nom=@{name}}} {{special1=@{mechaArmureNom}}} {{special2=^{resilience}}}"></button>
            </div>
        </div>

        <div class="styleCombat">		
            <h1 class="titre" data-i18n="style-de-combat">Style de Combat</h1>
            <select name="attr_styleCombat">
                <option value="standard" data-i18n="standard" selected>Standard</option>
                <option value="couvert" data-i18n="couvert">À Couvert</option>
                <option value="agressif" data-i18n="agressif">Agressif</option>
                <option value="akimbo" data-i18n="akimbo">Akimbo</option>
                <option value="ambidextre" data-i18n="ambidextre">Ambidextre</option>
                <option value="defensif" data-i18n="defensif">Défensif</option>
                <option value="precis" data-i18n="precis">Précis</option>
                <option value="pilonnage" data-i18n="pilonnage">Pilonnage</option>
                <option value="puissant" data-i18n="puissant">Puissant</option>
                <option value="suppression" data-i18n="suppression">Suppression</option>
            </select>
            <input type="hidden" name="attr_styleCombat" value="standard" />
            <div class="puissant">
                <span data-i18n="bonus-en">Bonus en</span>
                <select name="attr_stylePuissantType">
                    <option value="{{stylePuissantD=[[@{stylePuissantBonus}D6]]}}" data-i18n="degats" selected>Dégâts</option>
                    <option value="{{stylePuissantV=[[@{stylePuissantBonus}D6]]}}" data-i18n="violence">Violence</option>
                </select>
                <input type="number" name="attr_stylePuissantBonus" value="0" min="0" max="6" />
            </div>
            <div class="suppression">
                <label>
                    <span>Malus aux dégâts</span>
                    <input type="number" name="attr_styleSuppressionD" value="0" min="0" max="6" />
                </label>

                <label>
                    <span>Malus à la violence</span>
                    <input type="number" name="attr_styleSuppressionV" value="0" min="0" max="4" />
                </label>
            </div>
            <div class="autoex autoex40">
                <span name="attr_styleCombatDescr"></span>
                <textarea name="attr_styleCombatDescr" readonly></textarea>
            </div>
        </div>

        <div class="jet">
            <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0" />

            <div class="titre">
                <button type="action" class="fichePJ bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                <button type="action" class="fichePJ bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>

                <h1 class="titre" data-i18n="jet">Jet</h1>
                <button class="rollDice" type="action" name="act_manoeuvrabilite" value="@{jetGM} &{template:mechaArmure} {{Nom=@{name}}} {{special1=@{mechaArmureNom}}} "></button>
            </div>
            <label class="bonus">
                <span>Type de jet</span>
                <select name="attr_mechaArmureTypeJets">
                    <option value="1" data-i18n="vehicule-manoeuvrabilite">Manoeuvrabilité</option>
                    <option value="2" data-i18n="puissance">Puissance</option>
                    <option value="3" data-i18n="senseurs">Senseurs</option>
                    <option value="4" data-i18n="systemes">Systèmes</option>
                    <option value="5" data-i18n="autre" selected>Autre</option>
                </select>
            </label>
            <label class="bonus">
                <span data-i18n="bonus/malus-jets">Bonus/Malus aux Jets</span>
                <input type="number" name="attr_jetModifDes" value="0" />
            </label>
            <div class="rollPJ">
                <select name="attr_caracteristique1MA">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
                <select name="attr_caracteristique2MA">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
            </div>
            <div class="bonusCarac">
                <select name="attr_caracteristique3MA">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
                <select name="attr_caracteristique4MA">
                    <option value="0" selected></option>
                    <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                    <option value="@{force}" data-i18n="force">Force</option>
                    <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                    <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                    <option value="@{combat}" data-i18n="combat">Combat</option>
                    <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                    <option value="@{tir}" data-i18n="tir">Tir</option>
                    <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                    <option value="@{technique}" data-i18n="technique">Technique</option>
                    <option value="@{aura}" data-i18n="aura">Aura</option>
                    <option value="@{parole}" data-i18n="parole">Parole</option>
                    <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                    <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                    <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                    <option value="@{perception}" data-i18n="perception">Perception</option>
                </select>
            </div>
        </div>
    </div>
    
    <div class="col">
        <div class="PE">
            <h1 class="titre" data-i18n="protection-energie">Protections et Énergies</h1>
            <div class="ligneTitre">
                <span></span>
                <span data-i18n="actuel">Actuel</span>
                <span data-i18n="maximum">Maximum</span>
                <span data-i18n="modif">Modif</span>
            </div>
            <div class="ligne3">
                <span data-i18n="resilience">Résilience</span>
                <div><input type="number" name="attr_mechaArmureResilience" value="0" min="0" /></div>
                <div><input type="number" name="attr_mechaArmureResilience_max" readonly /></div>
                <div><input type="number" name="attr_mechaArmureResilienceModif" value="0" /></div>
            </div>
            <div class="ligne3">
                <span data-i18n="blindage">Blindage</span>
                <div><input type="number" name="attr_mechaArmureBlindage" value="0" min="0" /></div>
                <div><input type="number" name="attr_mechaArmureBlindage_max" readonly /></div>
                <div><input type="number" name="attr_mechaArmureBlindageModif" value="0" /></div>
            </div>
            <div class="ligne3">
                <span data-i18n="champ-de-force">Champ de force</span>
                <div><input type="number" name="attr_mechaArmureCdf" value="0" min="0" /></div>
                <div><input type="number" name="attr_mechaArmureCdf_max" readonly /></div>
                <div><input type="number" name="attr_mechaArmureCdfModif" value="0" /></div>
            </div>
            <div class="ligne3">
                <span data-i18n="noyaux-d-energie">Noyaux d'énergie</span>
                <div><input type="number" name="attr_mechaArmureNoyauxEnergie" value="0" min="0" /></div>
                <div><input type="number" name="attr_mechaArmureNoyauxEnergie_max" readonly /></div>
                <div><input type="number" name="attr_mechaArmureNoyauxEnergieModif" value="0" /></div>
            </div>
        </div>

        <div class="DRMechaArmure">
            <label class="col2">
                <span data-i18n="defense">Défense</span>
                <input type="number" name="attr_mechaArmureDefense" value="0" readonly />
            </label>
            <label class="col2BL">
                <span data-i18n="reaction">Maximum</span>
                <input type="number" name="attr_mechaArmureReaction" value="0" readonly />
            </label>
        </div>

        <div class="fichePJ physiqueMental">
            <h1 class="fichePJ titre" data-i18n="physique-et-mental">Physique et Mental</h1>
            <div class="ligneTitre">
                <span></span>
                <span data-i18n="actuel">Actuel</span>
                <span data-i18n="maximum">Maximum</span>
                <span data-i18n="modif">Modif</span>
            </div>
            <div class="ligne3">
                <span data-i18n="sante">Santé</span>
                <div><input type="number" name="attr_santepj" min="0" value="0" /></div>
                <div><input type="number" name="attr_santepj_max" min="0" value="0" readonly /></div>
                <div><input type="number" name="attr_santeModif" min="0" value="0" /></div>
            </div>
            <div class="ligne3">
                <span data-i18n="espoir">Espoir</span>
                <div><input type="number" name="attr_espoir" min="0" value="50" /></div>
                <div><input type="number" name="attr_espoir_max" min="0" value="50" readonly /></div>
                <div><input type="number" name="attr_espoirModif" value="0" /></div>
            </div>
            <div class="ligne3">
                <span data-i18n="heroisme">Héroïsme</span>
                <div><input type="number" name="attr_heroisme" min="0" max="6" value="0" /></div>
                <div><input type="number" name="attr_heroisme_max" min="0" value="6+@{heroismeModif}" disabled /></div>
                <div><input type="number" name="attr_heroismeModif" min="0" value="0" /></div>
            </div>
        </div>

        <div class="portee">
            <h1 class="titre" data-i18n="portee">Portée</h1>
            <div class="col5">
                <span data-i18n="portee-contact">Contact</span>
                <span data-i18n="portee-0-50">0 à 50m</span>
            </div>
            <div class="col5BL">
                <span data-i18n="portee-courte">Courte</span>
                <span data-i18n="portee-51-300">51 à 300m</span>
            </div>
            <div class="col5BL">
                <span data-i18n="portee-moyenne">Moyenne</span>
                <span data-i18n="portee-301-1000">301m à 1km</span>
            </div>
            <div class="col5BL">
                <span data-i18n="portee-longue">Longue</span>
                <span data-i18n="portee-1100-3000">1,1 à 3km</span>
            </div>
            <div class="col5BL">
                <span data-i18n="portee-lointaine">Lointaine</span>
                <span data-i18n="portee-3100-6000">3,1 à 6km</span>
            </div>
        </div>
    </div>

    <input class="subTabSpecial" type="hidden" name="attr_tabMechaArmureSpecial" class="tabMechaArmureSpecial" value="1" />
    <input class="subTabModules" type="hidden" name="attr_tabMechaArmureModules" class="tabMechaArmureModules" value="1" />
    <input class="subTabArmes" type="hidden" name="attr_tabMechaArmureArmes" class="tabMechaArmureArmes" value="1" />
    <input class="subTabImprovisee" type="hidden" name="attr_tabMechaArmureArmesImprovisees" class="tabMechaArmureArmesImprovisees" value="1" />

    <div class="subTab">
        <button class="subTabSpecial" type="action" name="act_tabMechaArmureSpecial_1" data-i18n="special">Spécial</button>
        <button class="subTabModules BL" type="action" name="act_tabMechaArmureModules_1" data-i18n="modules">Modules</button>
        <button class="subTabArmes BL" type="action" name="act_tabMechaArmureArmes_1" data-i18n="armes">Armes</button>
        <button class="subTabImprovisee BL" type="action" name="act_tabMechaArmureArmesImprovisees_1" data-i18n="armes-improvisees">Armes Improvisées</button>
    </div>

    <input class="archangelConfiguration" type="hidden" name="attr_mechaArmureArchangelConfiguration" value="1" />
    <input class="nephilimConfiguration" type="hidden" name="attr_mechaArmureNephilimConfiguration" value="1" />
    <input class="demonConfiguration" type="hidden" name="attr_mechaArmureDemonConfiguration" value="1" />

    
    <div class="col">
        <div class="subTabSpecial">
            <div class="archangel">
                <div class="configuration">
                    <h1 class="titre" data-i18n-title="configuration">Configuration</h1>
                    <div class="button">
                        <button class="gabriel" type="action" name="act_mechaArmureArchangelConfiguration_1" data-i18n="gabriel">Gabriel</button>
                        <button class="raphael" type="action" name="act_mechaArmureArchangelConfiguration_2" data-i18n="raphael">Raphaël</button>
                    </div>
                </div>
            </div>

            <div class="nephilim">
                <div class="configuration">
                    <h1 class="titre" data-i18n-title="configuration">Configuration</h1>
    
                    <div class="button">
                        <button class="og" type="action" name="act_mechaArmureNephilimConfiguration_1" data-i18n="og">OG</button>
                        <button class="anak" type="action" name="act_mechaArmureNephilimConfiguration_2" data-i18n="anak">Anak</button>
                    </div>
                </div>

                <div class="og stationDefense">
                    <input class="active" type="hidden" name="attr_MANOGStationActive" value="0" />

                    <div class="titre">
                        <h1 class="titre" data-i18n="station-defense-automatisee">Station de défense automatisée</h1>

                        <button class="active" type="action" name="act_MANOGStationActive_1" data-i18n="activer">Activer</button>
                    </div>

                    <label class="col3">
                        <span data-i18n="duree">Durée</span>
                        <input type="text" name="attr_MANOGStationDuree" value="Sans limite" readonly />
                    </label>
                    <label class="col3BL">
                        <span data-i18n="portee">Portée</span>
                        <input type="text" name="attr_MANOGStationPortee" value="Moyenne" readonly />
                    </label>
                    <label class="col3BL">
                        <span data-i18n="noyaux">Noyaux</span>
                        <input type="text" name="attr_MANOGStationNoyaux" value="3" readonly />
                    </label>

                    <label class="col3 borderTop">
                        <span data-i18n="blindage">Blindage</span>
                        <input type="text" name="attr_MANOGStationBlindage" value="80" readonly />
                    </label>
                    <label class="col3BL borderTop">
                        <span data-i18n="resilience">Résilience</span>
                        <input type="text" name="attr_MANOGStationResilience" value="1" readonly />
                    </label>
                    <label class="col3BL borderTop">
                        <span data-i18n="champ-de-force">Champ de force</span>
                        <input type="text" name="attr_MANOGStationCdf" value="10" readonly />
                    </label>

                    <label class="col2 borderTop">
                        <span data-i18n="force-requise">Force requise</span>
                        <input type="text" name="attr_MANOGStationForceRequise" value="5" readonly />
                    </label>
                    <label class="col2BL borderTop">
                        <span data-i18n="chair-requise">Chair requise</span>
                        <input type="text" name="attr_MANOGStationChairRequise" value="10" readonly />
                    </label>

                    <div class="col3 borderTop">
                        <span data-i18n="debordement">Débordement</span>
                        <button class="rollDice" type="action" name="act_MANOGStationDebordement" value="@{jetGM} &{template:mechaArmure} {{Nom=@{name}}} {{special1=@{mechaArmureNom}}} {{special2=^{station-defense-automatisee}}};MANOGStationTourDebordement"></button>
                    </div>
                    <div class="col3BL borderTop">
                        <span data-i18n="pod-missile">Pod Missile</span>
                        <button class="rollDice" type="action" name="act_MANOGStationMissile" value="@{jetGM} &{template:mechaArmure} {{Nom=@{name}}} {{special1=@{mechaArmureNom}}} {{special2=^{station-defense-automatisee}}} {{special2B=^{pod-missile}}} {{portee=^{portee} ^{portee-longue}}};6D6+3;1D6+6"></button>
                    </div>
                    <div class="col3BL borderTop">
                        <span data-i18n="pod-roquette">Pod Roquette</span>
                        <button class="rollDice" type="action" name="act_MANOGStationRoquette" value="@{jetGM} &{template:mechaArmure} {{Nom=@{name}}} {{special1=@{mechaArmureNom}}} {{special2=^{station-defense-automatisee}}} {{special2B=^{pod-roquette}}} {{portee=^{portee} ^{portee-longue}}};1D6+3;8D6+12"></button>
                    </div>

                    <label class="col3L borderTop">
                        <span data-i18n="tour-actuel">Tour Actuel</span>
                        <input type="number" name="attr_MANOGStationTourDebordement" value="1" />
                    </label>
                </div>

                <div class="anak siegeTower">
                    <input class="active" type="hidden" name="attr_MANOGSTActive" value="0" />

                    <div class="titre">
                        <h1 class="titre" data-i18n="mode-siege-tower">Mode Siège Tower</h1>

                        <button class="active" type="action" name="act_MANOGSTActive_1" data-i18n="activer">Activer</button>
                    </div>

                    <label class="col2">
                        <span data-i18n="resilience">Résilience</span>
                        <input type="text" name="attr_MANMSTResilience" value="10" readonly />
                    </label>
                    <label class="col2BL">
                        <span data-i18n="noyaux">Noyaux</span>
                        <input type="number" name="attr_MANMSTNoyau" value="4" readonly />
                    </label>
                </div>
            </div>

            <div class="demon">
                <div class="configuration">
                    <h1 class="titre" data-i18n-title="configuration">Configuration</h1>

                    <div class="button">
                        <button class="djinn" type="action" name="act_mechaArmureDemonConfiguration_1" data-i18n="djinn">Djinn</button>
                        <button class="asura" type="action" name="act_mechaArmureDemonConfiguration_2" data-i18n="asura">Asura</button>
                    </div>
                </div>

                <div class="djinn">
                    <div class="souffleDemoniaque">
                        <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0">

                        <div class="titre">
                            <button type="action" class="fichePJ bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                            <button type="action" class="fichePJ bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>

                            <h1 class="titre" data-i18n="souffle-demoniaque">Souffle démoniaque</h1>

                            <button class="rollDice" type="action" name="act_MADSouffle" value="@{jetGM} &{template:mechaArmure} {{Nom=@{name}}} {{special1=@{mechaArmureNom}}} {{special2=^{souffle-demoniaque}}} {{special2B=^{puissance}}} {{portee=^{portee} @{MADSDPortee}}};MADSDDgts;MADSDViol"></button>
                        </div>

                        <label class="bonus">
                            <span data-i18n="bonus/malus-jets">Bonus/Malus aux Jets</span>
                            <input type="number" name="attr_jetModifDes" value="0" />
                        </label>

                        <div class="rollPJ">
                            <select name="attr_DSouffleCaracteristique1">
                                <option value="0" selected></option>
                                <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                <option value="@{force}" data-i18n="force">Force</option>
                                <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                <option value="@{combat}" data-i18n="combat">Combat</option>
                                <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                <option value="@{tir}" data-i18n="tir">Tir</option>
                                <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                <option value="@{technique}" data-i18n="technique">Technique</option>
                                <option value="@{aura}" data-i18n="aura">Aura</option>
                                <option value="@{parole}" data-i18n="parole">Parole</option>
                                <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                <option value="@{perception}" data-i18n="perception">Perception</option>
                            </select>
                            <select name="attr_DSouffleCaracteristique2">
                                <option value="0" selected></option>
                                <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                <option value="@{force}" data-i18n="force">Force</option>
                                <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                <option value="@{combat}" data-i18n="combat">Combat</option>
                                <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                <option value="@{tir}" data-i18n="tir">Tir</option>
                                <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                <option value="@{technique}" data-i18n="technique">Technique</option>
                                <option value="@{aura}" data-i18n="aura">Aura</option>
                                <option value="@{parole}" data-i18n="parole">Parole</option>
                                <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                <option value="@{perception}" data-i18n="perception">Perception</option>
                            </select>
                        </div>
                        
                        <div class="bonusCarac">
                            <select name="attr_DSouffleCaracteristique3">
                                <option value="0" selected></option>
                                <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                <option value="@{force}" data-i18n="force">Force</option>
                                <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                <option value="@{combat}" data-i18n="combat">Combat</option>
                                <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                <option value="@{tir}" data-i18n="tir">Tir</option>
                                <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                <option value="@{technique}" data-i18n="technique">Technique</option>
                                <option value="@{aura}" data-i18n="aura">Aura</option>
                                <option value="@{parole}" data-i18n="parole">Parole</option>
                                <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                <option value="@{perception}" data-i18n="perception">Perception</option>
                            </select>
                            <select name="attr_DSouffleCaracteristique4">
                                <option value="0" selected></option>
                                <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                <option value="@{force}" data-i18n="force">Force</option>
                                <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                <option value="@{combat}" data-i18n="combat">Combat</option>
                                <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                <option value="@{tir}" data-i18n="tir">Tir</option>
                                <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                <option value="@{technique}" data-i18n="technique">Technique</option>
                                <option value="@{aura}" data-i18n="aura">Aura</option>
                                <option value="@{parole}" data-i18n="parole">Parole</option>
                                <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                <option value="@{perception}" data-i18n="perception">Perception</option>
                            </select>
                        </div>
                        
                        <label class="col4">
                            <span data-i18n="degats">Dégâts</span>
                            <input type="text" name="attr_MADSDDgts" value="8D6+30" readonly />
                        </label>
                        <label class="col4BL">
                            <span data-i18n="violence">Violence</span>
                            <input type="text" name="attr_MADSDViol" value="1" readonly />
                        </label>
                        <label class="col4BL">
                            <span data-i18n="portee">Portée</span>
                            <input type="text" name="attr_MADSDPortee" value="Contact" readonly />
                        </label>
                        <label class="col4BL">
                            <span data-i18n="noyaux">Noyaux</span>
                            <input type="text" name="attr_MADSDNoyau" value="2" readonly />
                        </label>

                        <div class="autoex autoex28">
                            <textarea name="attr_MADSDEffets" readonly>Briser la résilience / Parasitage 2</textarea>
                            <span name="attr_MADSDEffets"></span>
                        </div>
                    </div>
                </div>

                <div class="asura">
                    <div class="bouclierAmrita">
                        <input class="active" type="hidden" name="attr_MADABAmritaActive" value="0"/>

                        <div class="titre">
                            <h1 class="titre" data-i18n="boucliers-amrita">Boucliers Amrita</h1>

                            <button class="active" type="action" name="act_MADABAmritaActive_1" data-i18n="activer">Activer</button>
                        </div>
                        
                        <label class="col2">
                            <span data-i18n="noyaux">Noyaux</span>
                            <input type="text" name="attr_MADABANoyaux" value="4" readonly />
                        </label>
                        <label class="col2BL">
                            <span data-i18n="resilience">Résilience</span>
                            <input type="text" name="attr_MADABAResilience" value="4" readonly />
                        </label>

                        <label class="col3">
                            <span data-i18n="defense">Défense</span>
                            <input type="text" name="attr_MADABADefense" value="4" readonly />
                        </label>
                        <label class="col3BL">
                            <span data-i18n="reaction">Réaction</span>
                            <input type="text" name="attr_MADABAReaction" value="4" readonly />
                        </label>
                        <label class="col3BL">
                            <span data-i18n="champ-de-force">Champ de force</span>
                            <input type="text" name="attr_MADABACdf" value="4" readonly />
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <div class="subTabModules">
            <div class="archangel">
                <div class="vol">
                    <input class="active" type="hidden" name="attr_MAArchangelVolActive" value="0" />

                    <div class="titre">
                        <h1 class="titre" data-i18n="vol-mark-iv">Vol Mark IV</h1>

                        <button class="active" type="action" name="act_MAArchangelVolActive_1" data-i18n="activer">Activer</button>
                    </div>

                    <label class="col3">
                        <span data-i18n="vehicule-manoeuvrabilite">Manoeuvrabilité</span>
                        <input type="number" name="attr_MAAVolManoeuvrabilite" value="3" readonly />
                    </label>
                    <label class="col3BL">
                        <span data-i18n="vehicule-vitesse">Vitesse</span>
                        <input type="number" name="attr_MAAVolVitesse" value="3" readonly />
                    </label>
                    <label class="col3BL">
                        <span data-i18n="hauteur">Hauteur</span>
                        <input type="number" name="attr_MAAVolHauteur" value="3000" readonly />
                    </label>
                </div>
            </div>

            <div class="nephilim">
                <div class="saut">
                    <input class="active" type="hidden" name="attr_MANephilimSautActive" value="0" />

                    <div class="titre">
                        <h1 class="titre" data-i18n="saut-mark-iv">Saut Mark IV</h1>

                        <button class="active" type="action" name="act_MANephilimSautActive_1" data-i18n="activer">Activer</button>
                    </div>

                    <label class="col4">
                        <span data-i18n="resilience">Résilience</span>
                        <input type="text" name="attr_MANSautResilience" value="1" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="portee">Portée</span>
                        <input type="text" name="attr_MANSautPortee" value="Longue" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="hauteur">Hauteur</span>
                        <input type="text" name="attr_MANSautHauteur" value="Longue" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="duree">Durée</span>
                        <input type="text" name="attr_MANSautDuree" value="1 tour" readonly />
                    </label>
                </div>

                <div class="emblem">
                    <input class="active" type="hidden" name="attr_MANephilimEmblemActive" value="0" />

                    <div class="titre">
                        <h1 class="titre" data-i18n="module-emblem">Module Emblem</h1>

                        <button class="active" type="action" name="act_MANephilimEmblemActive_1" data-i18n="activer">Activer</button>
                    </div>

                    <label class="col4">
                        <span data-i18n="machine">Machine</span>
                        <input type="text" name="attr_MANEmblemMachine" value="14" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="masque">Masque</span>
                        <input type="text" name="attr_MANEmblemMasque" value="14" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="portee">Portée</span>
                        <input type="text" name="attr_MANEmblemPortee" value="Longue" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="noyaux">Noyaux</span>
                        <input type="text" name="attr_MANEmblemNoyaux" value="3" readonly />
                    </label>
                </div>
            </div>

            <div class="demon">
                <div class="saut">
                    <input class="active" type="hidden" name="attr_MADemonSautActive" value="0" />

                    <div class="titre">
                        <h1 class="titre" data-i18n="saut-mark-iv">Saut Mark IV</h1>

                        <button class="active" type="action" name="act_MADemonSautActive_1" data-i18n="activer">Activer</button>
                    </div>

                    <label class="col4">
                        <span data-i18n="resilience">Résilience</span>
                        <input type="text" name="attr_MADSautResilience" value="1" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="portee">Portée</span>
                        <input type="text" name="attr_MADSautPortee" value="Longue" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="hauteur">Hauteur</span>
                        <input type="text" name="attr_MADSautHauteur" value="Longue" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="duree">Durée</span>
                        <input type="text" name="attr_MADSautDuree" value="1 tour" readonly />
                    </label>
                </div>
            </div>
        </div>

        <div class="subTabArmes">
            <div class="archangel">
                <div class="canonMetatron">
                    <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0" />

                    <div class="titre">
                        <button type="action" class="fichePJ bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                        <button type="action" class="fichePJ bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>
                        
                        <h1 class="titre" data-i18n="canon-metatron">Canon Métatron</h1>

                        <button class="rollDice" type="action" name="act_MAACanonMetatron" value="@{jetGM} &{template:mechaArmure} {{Nom=@{name}}} {{special1=@{mechaArmureNom}}} {{special2=^{canon-metatron}}} {{portee=^{portee} @{MAACanonMetatronPortee}}} {{special2B=^{puissance}}};MAACanonMetatronDgts;MAACanonMetatronViolence"></button>
                    </div>

                    <label class="bonus">
                        <span data-i18n="bonus/malus-jets">Bonus/Malus aux Jets</span>
                        <input type="number" name="attr_jetModifDes" value="0" />
                    </label>

                    <div class="rollPJ">
                        <select name="attr_canonMetatronCaracteristique1">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <select name="attr_canonMetatronCaracteristique2">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                    </div>

                    <div class="bonusCarac">
                        <select name="attr_canonMetatronCaracteristique3">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <select name="attr_canonMetatronCaracteristique4">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                    </div>

                    <label class="col4">
                        <span data-i18n="degats">Dégâts</span>
                        <input type="text" name="attr_MAACanonMetatronDgts" value="6D6+12" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="violence">Violence</span>
                        <input type="text" name="attr_MAACanonMetatronViolence" value="6D6" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="portee">Portée</span>
                        <input type="text" name="attr_MAACanonMetatronPortee" value="Moyenne" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="noyau">Noyau</span>
                        <input type="number" name="attr_MAACanonMetatronNoyau" value="1" readonly />
                    </label>

                    <div class="autoex autoex28">
                        <textarea name="attr_MAACanonMetatronEffets" readonly>Anti-véhicule / Parasitage 2 / Dégâts continus 10 / Briser la résilience</textarea>
                        <span name="attr_MAACanonMetatronEffets"></span>
                    </div>
                </div>
            </div>

            <div class="nephilim">
                <div class="canonMagma">
                    <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0" />
                    
                    <div class="titre">
                        <button type="action" class="fichePJ bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                        <button type="action" class="fichePJ bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>

                        <h1 class="titre" data-i18n="canon-magma">Canon Magma</h1>
                        <button class="rollDice" type="action" name="act_MANCanonMagma" value="@{jetGM} &{template:mechaArmure} {{Nom=@{name}}} {{special1=@{mechaArmureNom}}} {{special2=^{canon-magma}}} {{special2B=^{puissance}}} {{portee=^{portee} @{MANCanonMagmaPortee}}};MANCanonMagmaDgts;MANCanonMagmaViolence"></button>
                    </div>
                    <label class="bonus">
                        <span data-i18n="bonus/malus-jets">Bonus/Malus aux Jets</span>
                        <input type="number" name="attr_jetModifDes" value="0" />
                    </label>
                    <div class="rollPJ">
                        <select name="attr_canonMagmaCaracteristique1">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <select name="attr_canonMagmaCaracteristique2">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                    </div>

                    <div class="bonusCarac">
                        <select name="attr_canonMagmaCaracteristique3">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <select name="attr_canonMagmaCaracteristique4">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                    </div>

                    <label class="col4">
                        <span data-i18n="degats">Dégâts</span>
                        <input type="text" name="attr_MANCanonMagmaDgts" value="8D6+12" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="violence">Violence</span>
                        <input type="text" name="attr_MANCanonMagmaViolence" value="12D6+20" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="portee">Portée</span>
                        <input type="text" name="attr_MANCanonMagmaPortee" value="Moyenne" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="noyaux">Noyaux</span>
                        <input type="text" name="attr_MANCanonMagmaNoyau" value="1 / 4" readonly />
                    </label>

                    <div class="autoex autoex28">
                        <textarea name="attr_MANCanonMagmaEffets" readonly>Anti-véhicule / Anti-Anathème / Dispersion 12 / Briser la résilience / Fureur</textarea>
                        <span name="attr_MANCanonMagmaEffets"></span>
                    </div>
                </div>
            </div>

            <div class="demon">
                <div class="lamesCinetiques">
                    <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0">

                    <div class="titre">
                        <button type="action" class="fichePJ bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                        <button type="action" class="fichePJ bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>

                        <h1 class="titre" data-i18n="lames-cinetiques-geantes">Lames cinétiques géantes</h1>
                        <button class="rollDice" type="action" name="act_MADLCG" value="@{jetGM} &{template:mechaArmure} {{Nom=@{name}}} {{special1=@{mechaArmureNom}}} {{special2=^{lames-cinetiques-geantes}}} {{special2B=^{puissance}}} {{portee=^{portee} @{MADLCGPortee}}};MADLCGDgts;MADLCGViol"></button>
                    </div>
                    <label class="bonus">
                        <span data-i18n="bonus/malus-jets">Bonus/Malus aux Jets</span>
                        <input type="number" name="attr_jetModifDes" value="0" />
                    </label>
                    <div class="rollPJ">
                        <select name="attr_LCGCaracteristique1">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <select name="attr_LCGCaracteristique2">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                    </div>
                    
                    <div class="bonusCarac">
                        <select name="attr_LCGCaracteristique3">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <select name="attr_LCGCaracteristique4">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                    </div>

                    <label class="col4">
                        <span data-i18n="degats">Dégâts</span>
                        <input type="text" name="attr_MADLCGDgts" value="10D6+30" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="violence">Violence</span>
                        <input type="text" name="attr_MADLCGViol" value="4D6" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="portee">Portée</span>
                        <input type="text" name="attr_MADLCGPortee" value="Contact" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="noyau">Noyau</span>
                        <input type="text" name="attr_MADLCGNoyau" value="1" readonly />
                    </label>

                    <div class="autoex autoex28">
                        <textarea name="attr_MADLCGEffets" readonly>Spécial – Le Demon peut dépenser 1 noyau d’énergie pour obtenir l’effet pénétrant 10. Il peut aussi en dépenser 2 pour obtenir l’effet ignore CdF.</textarea>
                        <span name="attr_MADLCGEffets"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col">
        <div class="subTabSpecial">
            <div class="archangel">
                <div class="gabriel offering">
                    <div class="titre">
                        <h1 class="titre" data-i18n="offering">Offering</h1>
                        <button class="rollDice" type="action" name="act_MAAGOffering" value="@{jetGM} &{template:mechaArmure} {{Nom=@{name}}} {{special1=@{mechaArmureNom}}} {{special2=^{offering}}} {{portee=^{portee} @{MAAGOfferingPortee}}};MAAGOfferingNE;4D6;1D3"></button>
                    </div>
                    <label class="ligne">
                        <span data-i18n="depense-noyaux-energie">Dépense de noyaux d'énergie</span>
                        <input type="number" name="attr_MAAGOfferingNE" value="0" min="0" max="5" />
                    </label>
                    <label class="col2">
                        <span data-i18n="duree">Durée</span>
                        <input type="text" name="attr_MAAGOfferingDuree" value="1D3 tours" readonly />
                    </label>
                    <label class="col2BL">
                        <span data-i18n="portee">Portée</span>
                        <input type="text" name="attr_MAAGOfferingPortee" value="Moyenne" readonly />
                    </label>
                </div>

                <div class="gabriel curse">
                    <div class="titre">
                        <h1 class="titre" data-i18n="curse">Curse</h1>
                        <button class="rollDice" type="action" name="act_MAAGCurse" value="@{jetGM} &{template:mechaArmure} {{Nom=@{name}}} {{special1=@{mechaArmureNom}}} {{special2=Curse}} {{portee=^{portee} @{MAAGCursePortee}}} {{jDivers=^{duree-en-tours}}} {{jDiversV=1}};MAAGCurseNE;4D6;1D6;1D3+1"></button>
                    </div>
                    <label class="ligne">
                        <span data-i18n="depense-noyaux-energie">Dépense de noyaux d'énergie</span>
                        <input type="number" name="attr_MAAGCurseNE" value="0" min="0" max="5" />
                    </label>
                    <label class="col2">
                        <span data-i18n="duree">Durée</span>
                        <input type="text" name="attr_MAAGCurseDuree" value="1 tour" readonly />
                    </label>
                    <label class="col2BL">
                        <span data-i18n="portee">Portée</span>
                        <input type="text" name="attr_MAAGCursePortee" value="Moyenne" readonly />
                    </label>
                </div>

                <div class="raphael podMiracle">
                    <div class="titre">
                        <h1 class="titre" data-i18n="pod-miracle">Pod Miracle</h1>
                        <button class="rollDice" type="action" name="act_MAARMiracle" value="@{jetGM} &{template:mechaArmure} {{Nom=@{name}}} {{special1=@{mechaArmureNom}}} {{special2=Pod Miracle}} {{portee=^{portee} @{MAAGMiraclePortee}}};MAAGMiracleSante;MAAGMiracleArmure;MAAGMiracleBlindage;MAAGMiracleRésilience;2D6"></button>
                    </div>
                    <label class="col2">
                        <span data-i18n="duree">Durée</span>
                        <input type="text" name="attr_MAAGMiracleDuree" value="2D6 tours" readonly />
                    </label>
                    <label class="col2BL">
                        <span data-i18n="portee">Portée</span>
                        <input type="text" name="attr_MAAGMiraclePortee" value="Contact" readonly />
                    </label>

                    <h1 class="titre" data-i18n="recuperation">Récupération</h1>
                    <div class="col2">
                        <label class="ligne">
                            <span data-i18n="sante">Santé</span>
                            <input type="text" name="attr_MAAGMiracleSante" value="3D6" readonly />
                        </label>

                        <label class="ligne">
                            <span data-i18n="armure">Armure</span>
                            <input type="text" name="attr_MAAGMiracleArmure" value="3D6" readonly />
                        </label>
                    </div>
                    <div class="col2BL">
                        <label class="ligne">
                            <span data-i18n="blindage">Blindage</span>
                            <input type="text" name="attr_MAAGMiracleBlindage" value="1D6" readonly />
                        </label>

                        <label class="ligne">
                            <span data-i18n="resilience">Résilience</span>
                            <input type="text" name="attr_MAAGMiracleRésilience" value="1" readonly />
                        </label>
                    </div>

                    <h1 class="titre" data-i18n="resistance-pod">Résistance du Pod</h1>
                    <div class="col2">
                        <div class="ligneDouble">
                            <span data-i18n="blindage">Blindage</span>
                            <div>
                                <input type="number" name="attr_MAAGMiraclePodBlindage" value="60" />
                                <span>/</span>
                                <input type="number" name="attr_MAAGMiraclePodBlindage_max" value="60" readonly />
                            </div>
                        </div>

                        <div class="ligneDouble">
                            <span data-i18n="resilience">Résilience</span>
                            <div>
                                <input type="number" name="attr_MAAGMiraclePodResilience" value="1" />
                                <span>/</span>
                                <input type="number" name="attr_MAAGMiraclePodResilience_max" value="1" readonly />
                            </div>
                        </div>
                    </div>
                    <div class="col2BL">
                        <label class="ligne">
                            <span data-i18n="champ-de-force">Champ de force</span>
                            <input type="number" name="attr_MAAGMiraclePodCdf" value="10" readonly />
                        </label>
                    </div>
                </div>

                <div class="raphael droneEvacuation">
                    <input class="active" type="hidden" name="attr_MAAEvacuationActive" value="0" />

                    <div class="titre">
                        <h1 class="titre" data-i18n="drones-evacuation">Drones d'évacuation</h1>
                        <button class="active" type="action" name="act_MAAEvacuationActive_1" data-i18n="activer">Activer</button>
                    </div>
                    <label class="col2">
                        <span data-i18n="duree">Durée</span>
                        <input type="text" name="attr_MAAGEvacuationDuree" value="1 tour" readonly />
                    </label>
                    <label class="col2BL">
                        <span data-i18n="portee">Portée</span>
                        <input type="text" name="attr_MAAGEvacuationPortee" value="Zone entière" readonly />
                    </label>
                </div>
            </div>

            <div class="nephilim">
                <div class="og invulnerabilite">
                    <input class="active" type="hidden" name="attr_MANOGInvulnerabiliteActive" value="0" />

                    <div class="titreInverse">
                        <button class="active" type="action" name="act_MANOGInvulnerabiliteActive_1" data-i18n="activer">Activer</button>

                        <h1 class="titre" data-i18n="pod-invulnerabilite">Pod d'Invulnérabilité</h1>

                        <button class="rollDice" type="action" name="act_MANOGInvulnerabilite" value="@{jetGM} &{template:mechaArmure} {{Nom=@{name}}} {{special1=@{mechaArmureNom}}} {{special2=^{pod-invulnerabilite}}} {{portee=^{portee} @{MANOGInvulnerabilitePortee}}};MANOGInvulnerabiliteDuree"></button>
                    </div>

                    <label class="col2">
                        <span data-i18n="degats-violence-requis">Dégâts/Violence requis</span>
                        <input type="text" name="attr_MANOGInvulnerabiliteDgtsViol" value="12D6" readonly />
                    </label>
                    <label class="col2BL">
                        <span data-i18n="chair-bete-requis">Chair/Bête requis</span>
                        <input type="text" name="attr_MANOGInvulnerabiliteChair" value="14" readonly />
                    </label>

                    <label class="col4">
                        <span data-i18n="duree">Durée</span>
                        <input type="text" name="attr_MANOGInvulnerabiliteDuree" value="2D6 Tours" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="portee">Portée</span>
                        <input type="text" name="attr_MANOGInvulnerabilitePortee" value="Courte" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="resilience">Résilience</span>
                        <input type="text" name="attr_MANOGInvulnerabiliteResilience" value="10" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="noyaux">Noyaux</span>
                        <input type="text" name="attr_MANOGInvulnerabiliteNoyaux" value="3" readonly />
                    </label>

                    <div class="autoex autoex28">
                        <textarea name="attr_MANOGInvulnerabiliteEffets" readonly>Invulnérabilité</textarea>
                        <span name="attr_MANOGInvulnerabiliteEffets"></span>
                    </div>
                </div>

                <div class="anak jericho">
                    <div class="titre">
                        <h1 class="titre" data-i18n="missile-jericho">Missile Jericho</h1>
                        <button class="rollDice" type="action" name="act_MANMJ" value="@{jetGM} &{template:mechaArmure} {{Nom=@{name}}} {{special1=@{mechaArmureNom}}} {{special2=^{missile-jericho}}} {{portee=^{portee} @{MANMJPortee}}};MANMJDgts;MANMJViolence"></button>
                    </div>

                    <label class="col4">
                        <span data-i18n="degats">Dégâts</span>
                        <input type="text" name="attr_MANMJDgts" value="12D6+40" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="violence">Violence</span>
                        <input type="text" name="attr_MANMJViolence" value="12D6+40" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="portee">Portée</span>
                        <input type="text" name="attr_MANMJPortee" value="Lointaine" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="noyaux">Noyaux</span>
                        <input type="number" name="attr_MANMJNoyau" value="6" readonly />
                    </label>

                    <div class="autoex autoex28">
                        <textarea name="attr_MANMJEffetsL" readonly>Anti-Anathème / Fureur / Meutrier / Démoralisant / Brilser la résilience</textarea>
                        <span name="attr_MANMJEffetsL"></span>
                    </div>
                </div>
            </div>

            <div class="demon">
                <div class="djinn">
                    <div class="wraith">
                        <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0" />

                        <div class="titre">
                            <button type="action" class="fichePJ bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                            <button type="action" class="fichePJ bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>
                            
                            <h1 class="titre" data-i18n="module-wraith">Module Wraith</h1>

                            <label class="fakeButton">
                                <input type="checkbox" name="attr_MADDjinnWraithActive" value="{{mode=Module Wraith : Activé}} {{moduleWraith=[[3]]}}"/>
                                <span data-i18n-title="active" title="Activé"></span>
                            </label>
                        </div>
                        <label class="bonus">
                            <span data-i18n="type-jet">Type de jet</span>
                            <select name="attr_mechaArmureTypeJetsWraith">
                                <option value="1" selected data-i18n="vehicule-manoeuvrabilite">Manoeuvrabilité</option>
                            </select>
                        </label>
                        <label class="bonus">
                            <span data-i18n="bonus/malus-jets">Bonus/Malus aux Jets</span>
                            <input type="number" name="attr_jetModifDes" value="0" />
                        </label>
                        <div class="rollPJ">
                            <select name="attr_caracteristiqueWraith1">
                                <option value="@{discretion}" data-i18n="discretion" selected>Discrétion</option>
                            </select>
                            <select name="attr_caracteristiqueWraith2">
                                <option value="0" selected></option>
                                <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                <option value="@{force}" data-i18n="force">Force</option>
                                <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                <option value="@{combat}" data-i18n="combat">Combat</option>
                                <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                <option value="@{tir}" data-i18n="tir">Tir</option>
                                <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                <option value="@{technique}" data-i18n="technique">Technique</option>
                                <option value="@{aura}" data-i18n="aura">Aura</option>
                                <option value="@{parole}" data-i18n="parole">Parole</option>
                                <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                <option value="@{perception}" data-i18n="perception">Perception</option>
                            </select>
                            <button class="rollDice" type="action" name="act_MADjinnWraith" value="@{jetGM} &{template:mechaArmure} {{Nom=@{name}}} {{special1=@{mechaArmureNom}}};MADDjinnWraithActive;"></button>
                        </div>
                        
                        <div class="bonusCarac">
                            <select name="attr_caracteristique3Wraith">
                                <option value="0" selected></option>
                                <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                <option value="@{force}" data-i18n="force">Force</option>
                                <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                <option value="@{combat}" data-i18n="combat">Combat</option>
                                <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                <option value="@{tir}" data-i18n="tir">Tir</option>
                                <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                <option value="@{technique}" data-i18n="technique">Technique</option>
                                <option value="@{aura}" data-i18n="aura">Aura</option>
                                <option value="@{parole}" data-i18n="parole">Parole</option>
                                <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                <option value="@{perception}" data-i18n="perception">Perception</option>
                            </select>
                            <select name="attr_caracteristique4Wraith">
                                <option value="0" selected></option>
                                <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                <option value="@{force}" data-i18n="force">Force</option>
                                <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                <option value="@{combat}" data-i18n="combat">Combat</option>
                                <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                <option value="@{tir}" data-i18n="tir">Tir</option>
                                <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                <option value="@{technique}" data-i18n="technique">Technique</option>
                                <option value="@{aura}" data-i18n="aura">Aura</option>
                                <option value="@{parole}" data-i18n="parole">Parole</option>
                                <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                <option value="@{perception}" data-i18n="perception">Perception</option>
                            </select>
                        </div>
                    </div>
                
                    <div class="nanobrume">
                        <input class="active" type="hidden" name="attr_MADDjinnNanobrumeActive" value="0"/>

                        <div class="titre">
                            <h1 class="titre" data-i18n="nanobrume">Nanobrume</h1>

                            <button class="active" type="action" name="act_MADDjinnNanobrumeActive_1" data-i18n="activer">Activer</button>
                        </div>

                        <label class="col3">
                            <span data-i18n="reaction">Réaction</span>
                            <input type="number" name="attr_MADDNReaction" value="3" readonly />
                        </label>
                        <label class="col3BL">
                            <span data-i18n="defense">Défense</span>
                            <input type="number" name="attr_MADDNDefense" value="3" readonly />
                        </label>
                        <label class="col3BL">
                            <span data-i18n="noyau">Noyau</span>
                            <input type="number" name="attr_MADDNNoyau" value="1" readonly />
                        </label>
                    </div>
                </div>

                <div class="asura">
                    <div class="poingsSoniques">
                        <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0">

                        <div class="titre">
                            <button type="action" class="fichePJ bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                            <button type="action" class="fichePJ bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>

                            <h1 class="titre" data-i18n="poings-soniques">Poings soniques</h1>

                            <button class="rollDice" type="action" name="act_MADPSoniques" value="@{jetGM} &{template:mechaArmure} {{Nom=@{name}}} {{special1=@{mechaArmureNom}}} {{special2=^{poings-soniques}}} {{special2B=^{puissance}}} {{portee=^{portee} @{MADAPSPortee}}};MADAPSDgts;MADAPSViol"></button>
                        </div>
                        <label class="bonus">
                            <span data-i18n="bonus/malus-jets">Bonus/Malus aux Jets</span>
                            <input type="number" name="attr_jetModifDes" value="0" />
                        </label>
                        <div class="rollPJ">
                            <select name="attr_APoingsCaracteristique1">
                                <option value="0" selected></option>
                                <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                <option value="@{force}" data-i18n="force">Force</option>
                                <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                <option value="@{combat}" data-i18n="combat">Combat</option>
                                <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                <option value="@{tir}" data-i18n="tir">Tir</option>
                                <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                <option value="@{technique}" data-i18n="technique">Technique</option>
                                <option value="@{aura}" data-i18n="aura">Aura</option>
                                <option value="@{parole}" data-i18n="parole">Parole</option>
                                <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                <option value="@{perception}" data-i18n="perception">Perception</option>
                            </select>
                            <select name="attr_APoingsCaracteristique2">
                                <option value="0" selected></option>
                                <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                <option value="@{force}" data-i18n="force">Force</option>
                                <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                <option value="@{combat}" data-i18n="combat">Combat</option>
                                <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                <option value="@{tir}" data-i18n="tir">Tir</option>
                                <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                <option value="@{technique}" data-i18n="technique">Technique</option>
                                <option value="@{aura}" data-i18n="aura">Aura</option>
                                <option value="@{parole}" data-i18n="parole">Parole</option>
                                <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                <option value="@{perception}" data-i18n="perception">Perception</option>
                            </select>
                        </div>
                        
                        <div class="bonusCarac">
                            <select name="attr_APoingsCaracteristique3">
                                <option value="0" selected></option>
                                <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                <option value="@{force}" data-i18n="force">Force</option>
                                <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                <option value="@{combat}" data-i18n="combat">Combat</option>
                                <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                <option value="@{tir}" data-i18n="tir">Tir</option>
                                <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                <option value="@{technique}" data-i18n="technique">Technique</option>
                                <option value="@{aura}" data-i18n="aura">Aura</option>
                                <option value="@{parole}" data-i18n="parole">Parole</option>
                                <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                <option value="@{perception}" data-i18n="perception">Perception</option>
                            </select>
                            <select name="attr_APoingsCaracteristique4">
                                <option value="0" selected></option>
                                <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                                <option value="@{force}" data-i18n="force">Force</option>
                                <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                                <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                                <option value="@{combat}" data-i18n="combat">Combat</option>
                                <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                                <option value="@{tir}" data-i18n="tir">Tir</option>
                                <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                                <option value="@{technique}" data-i18n="technique">Technique</option>
                                <option value="@{aura}" data-i18n="aura">Aura</option>
                                <option value="@{parole}" data-i18n="parole">Parole</option>
                                <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                                <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                                <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                                <option value="@{perception}" data-i18n="perception">Perception</option>
                            </select>
                        </div>

                        <label class="col4">
                            <span data-i18n="degats">Dégâts</span>
                            <input type="text" name="attr_MADAPSDgts" value="6D6+30" readonly />
                        </label>
                        <label class="col4BL">
                            <span data-i18n="violence">Violence</span>
                            <input type="text" name="attr_MADAPSViol" value="8D6+20" readonly />
                        </label>
                        <label class="col4BL">
                            <span data-i18n="portee">Portée</span>
                            <input type="text" name="attr_MADAPSPortee" value="Contact" readonly />
                        </label>
                        <label class="col4BL">
                            <span data-i18n="noyaux">Noyaux</span>
                            <input type="text" name="attr_MADAPSNoyau" value="1" readonly />
                        </label>

                        <div class="autoex autoex28">
                            <textarea name="attr_MADAPSEffets" readonly>Après une attaque contre une cible unique (et après avoir appliqué les dégâts), le Demon peut toujours appliquer la violence des poings soniques à une bande située à portée contact ou courte courte.</textarea>
                            <span name="attr_MADAPSEffets"></span>
                        </div>
                    </div>

                    <div class="chocSonique">
                        <input class="active" type="hidden" name="attr_MADACSoniqueActive" value="1"/>

                        <div class="titre">
                            <h1 class="titre" data-i18n="choc-soniques">Choc sonique</h1>

                            <button class="active" type="action" name="act_MADACSoniqueActive_1" data-i18n="activer">Activer</button>
                        </div>
                        
                        <label class="col2">
                            <span data-i18n="noyaux">Noyaux</span>
                            <input type="text" name="attr_MADACSNoyaux" value="6" readonly />
                        </label>
                        <label class="col2BL">
                            <span data-i18n="portee">Portée</span>
                            <input type="text" name="attr_MADACSPortee" value="Courte" readonly />
                        </label>

                        <div class="autoex autoex28">
                            <textarea name="attr_MADACSEffets" readonly>Choc 6 / Choc 4 / Choc 2</textarea>
                            <span name="attr_MADACSEffets"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="subTabModules">
            <div class="archangel">
                <div class="vagueSoin">
                    <h1 class="titre" data-i18n="vague-soin">Vague de soin</h1>
                    
                    <label class="col3">
                        <span data-i18n="sante">Santé</span>
                        <input type="number" name="attr_MAAVagueSoinSante" value="40" readonly />
                    </label>
                    <label class="col3BL">
                        <span data-i18n="cohesion">Cohésion</span>
                        <input type="number" name="attr_MAAVagueSoinCohesion" value="150" readonly />
                    </label>
                    <label class="col3BL">
                        <span data-i18n="portee">Portée</span>
                        <input type="text" name="attr_MAAVagueSoinPortee" value="Moyenne" readonly />
                    </label>
                </div>
            </div>

            <div class="nephilim">
                <div class="droneAirain">
                    <input class="active" type="hidden" name="attr_MANephilimDronesAirainActive" value="0" />

                    <div class="titre">
                        <h1 class="titre" data-i18n="drones-airain">Drones d'Airain</h1>

                        <button class="active" type="action" name="act_MANephilimDronesAirainActive_1" data-i18n="activer">Activer</button>
                    </div>

                    <label class="col4">
                        <span data-i18n="reaction">Réaction</span>
                        <input type="text" name="attr_MANDronesAirainReaction" value="4" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="defense">Défense</span>
                        <input type="text" name="attr_MANDronesAirainDefense" value="4" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="resilience">Résilience</span>
                        <input type="text" name="attr_MANDronesAirainResilience" value="4" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="cohesion">Cohésion</span>
                        <input type="text" name="attr_MANDronesAirainCohesion" value="100" readonly />
                    </label>

                    <label class="col4 borderTop">
                        <span data-i18n="debordement">Débordement</span>
                        <input type="text" name="attr_MANDronesAirainDebordement" value="4" readonly />
                    </label>
                    <label class="col4BL borderTop">
                        <span data-i18n="noyaux">Noyaux</span>
                        <input type="text" name="attr_MANDronesAirainNoyaux" value="5" readonly />
                    </label>
                    <label class="col4BL borderTop">
                        <span data-i18n="duree">Durée</span>
                        <input type="text" name="attr_MANDronesAirainDuree" value="Sans limite" readonly />
                    </label>
                    <label class="col4BL borderTop">
                        <span data-i18n="portee">Portée</span>
                        <input type="text" name="attr_MANDronesAirainPortee" value="Longue" readonly />
                    </label>
                </div>
            </div>

            <div class="demon">
                <div class="inferno">
                    <div class="titre">
                        <h1 class="titre" data-i18n="module-inferno">Module Inferno</h1>

                        <button class="rollDice" type="action" name="act_MAAMI" value="@{jetGM} &{template:mechaArmure} {{Nom=@{name}}} {{special1=@{mechaArmureNom}}} {{special2=^{module-inferno}}} {{portee=^{portee} @{MAAMIPortee}}};MAAMIDgts;MAAMIViol"></button>
                    </div>

                    <label class="col4">
                        <span data-i18n="degats">Dégâts</span>
                        <input type="text" name="attr_MAAMIDgts" value="10D6+20" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="violence">Violence</span>
                        <input type="text" name="attr_MAAMIViol" value="10D6+20" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="portee">Portée</span>
                        <input type="text" name="attr_MAAMIPortee" value="Courte" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="noyaux">Noyaux</span>
                        <input type="text" name="attr_MAAMINoyau" value="5" readonly />
                    </label>
                </div>
            </div>
        </div>

        <div class="subTabArmes">
            <div class="archangel">
                <div class="canonNoe">
                    <div class="titre">
                        <h1 class="titre" data-i18n="canon-noe">Canon Noé</h1>
                        <button class="rollDice" type="action" name="act_MAACanonNoe" value="@{jetGM} &{template:mechaArmure} {{Nom=@{name}}} {{special1=@{mechaArmureNom}}} {{special2=^{canon-noe}}} {{portee=^{portee} @{MAACanonNoePortée}}};MAACanonNoeArmure;MAACanonNoeBlindage;MAACanonNoeResilience"></button>
                    </div>

                    <label class="col3">
                        <span data-i18n="armure">Armure</span>
                        <input type="number" name="attr_MAACanonNoeArmure" value="30" readonly />
                    </label>
                    <label class="col3BL">
                        <span data-i18n="blindage">Blindage</span>
                        <input type="number" name="attr_MAACanonNoeBlindage" value="20" readonly />
                    </label>
                    <label class="col3BL">
                        <span data-i18n="resilience">Résilience</span>
                        <input type="text" name="attr_MAACanonNoeResilience" value="1D6" readonly />
                    </label>

                    <label class="col2">
                        <span data-i18n="noyaux">Noyaux</span>
                        <input type="number" name="attr_MAACanonNoeNoyaux" value="3" readonly />
                    </label>
                    <label class="col2BL">
                        <span data-i18n="portee">Portée</span>
                        <input type="text" name="attr_MAACanonNoePortée" value="Longue" readonly />
                    </label>
                </div>
            </div>

            <div class="nephilim">
                
                <div class="surtur">
                    <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0">

                    <div class="titre">
                        <button type="action" class="fichePJ bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                        <button type="action" class="fichePJ bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>
                        
                        <h1 class="titre" data-i18n="mitrailleuse-surtur">Mitrailleuse Surtur</h1>
                        <button class="rollDice" type="action" name="act_MANMSurtur" value="@{jetGM} &{template:mechaArmure} {{Nom=@{name}}} {{special1=@{mechaArmureNom}}} {{special2=^{mitrailleuse-surtur}}} {{special2B=^{puissance}}} {{portee=^{portee} @{MANMSurturPortee}}};MANMSurturDgts;MANMSurturViolence"></button>
                    </div>
                    <label class="bonus">
                        <span data-i18n="bonus/malus-jets">Bonus/Malus aux Jets</span>
                        <input type="number" name="attr_jetModifDes" value="0" />
                    </label>
                    <div class="rollPJ">
                        <select name="attr_MSurturCaracteristique1">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <select name="attr_MSurturCaracteristique2">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                    </div>
                    
                    <div class="bonusCarac">
                        <select name="attr_MSurturCaracteristique3">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                        <select name="attr_MSurturCaracteristique4">
                            <option value="0" selected></option>
                            <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                            <option value="@{force}" data-i18n="force">Force</option>
                            <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                            <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                            <option value="@{combat}" data-i18n="combat">Combat</option>
                            <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                            <option value="@{tir}" data-i18n="tir">Tir</option>
                            <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                            <option value="@{technique}" data-i18n="technique">Technique</option>
                            <option value="@{aura}" data-i18n="aura">Aura</option>
                            <option value="@{parole}" data-i18n="parole">Parole</option>
                            <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                            <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                            <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                            <option value="@{perception}" data-i18n="perception">Perception</option>
                        </select>
                    </div>

                    <label class="col4">
                        <span data-i18n="degats">Dégâts</span>
                        <input type="text" name="attr_MANMSurturDgts" value="2D6+6" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="violence">Violence</span>
                        <input type="text" name="attr_MANMSurturViolence" value="6D6+20" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="portee">Portée</span>
                        <input type="text" name="attr_MANMSurturPortee" value="Moyenne" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="noyau">Noyau</span>
                        <input type="text" name="attr_MANMSurturNoyau" value="1" readonly />
                    </label>
                    
                    <div class="autoex autoex28">
                        <textarea name="attr_MANMSurturEffets" readonly>Ultraviolence / Démoralisant</textarea>
                        <span name="attr_MANMSurturEffets"></span>
                    </div>
                </div>
            </div>

            <div class="demon">
                <div class="tourelles">
                    <div class="titre">
                        <h1 class="titre" data-i18n="tourelles-lasers-automatisees">Tourelles lasers automatisées</h1>
                       
                        <button class="rollDice" type="action" name="act_MAATLA" value="@{jetGM} &{template:mechaArmure} {{Nom=@{name}}} {{special1=@{mechaArmureNom}}} {{special2=^{tourelles-lasers-automatisees}}} {{portee=^{portee} @{MAATLAPortee}}};MAATLADgts;MAATLAViol"></button>
                    </div>

                    <label class="col4">
                        <span data-i18n="degats">Dégâts</span>
                        <input type="text" name="attr_MAATLADgts" value="6D6" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="violence">Violence</span>
                        <input type="text" name="attr_MAATLAViol" value="10D6" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="portee">Portée</span>
                        <input type="text" name="attr_MAATLAPortee" value="Courte" readonly />
                    </label>
                    <label class="col4BL">
                        <span data-i18n="noyaux">Noyaux</span>
                        <input type="text" name="attr_MAATLANoyau" value="2" readonly />
                    </label>

                    <div class="autoex autoex28">
                        <textarea name="attr_MAATLAEffets" readonly>Anti-Anathème</textarea>
                        <span name="attr_MAATLAEffets"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="subTabImprovisee">
        <div class="utilisation">
            <input class="bonusCarac" type="hidden" name="attr_bonusCarac" value="0" />
            
            <div class="titre">
                <button type="action" class="bonusCaracL1" name="act_bonusCarac_1" data-i18n-title="+1 Caractéristique" title="+1 Caractéristique" >+1</button>
                <button type="action" class="bonusCaracL2" name="act_bonusCarac_2" data-i18n-title="+2 Caractéristique" title="+2 Caractéristique" >+2</button>

                <h1 class="titre" data-i18n="utilisation-armes-improvisees">Utilisation de l'arme improvisée</h1>
            </div>
           

            <div class="buttons">
                <label class="fakeButton">
                    <input type="radio" name="attr_MAUtilisationArmeAI" value="&{template:mechaArmure} {{special1=@{mechaArmureNom}}} {{portee=^{portee-contact}}}" checked />
                    <span data-i18n-title="contact" title="Contact"></span>
                </label>
                <label class="fakeButton">
                    <input type="radio" name="attr_MAUtilisationArmeAI" value="&{template:mechaArmure} {{special1=@{mechaArmureNom}}} {{portee=^{distance}}}" />
                    <span data-i18n-title="lancer" title="Lancer"></span>
                </label>
            </div>

            <div class="bonus">
                <div class="bonusCarac">
                    <select name="attr_caracteristique3ArmeImprovisee">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                    <select name="attr_caracteristique4ArmeImprovisee">
                        <option value="0" selected></option>
                        <option value="@{deplacement}" data-i18n="deplacement">Déplacement</option>
                        <option value="@{force}" data-i18n="force">Force</option>
                        <option value="@{endurance}" data-i18n="endurance">Endurance</option>
                        <option value="@{hargne}" data-i18n="hargne">Hargne</option>
                        <option value="@{combat}" data-i18n="combat">Combat</option>
                        <option value="@{instinct}" data-i18n="instinct">Instinct</option>
                        <option value="@{tir}" data-i18n="tir">Tir</option>
                        <option value="@{savoir}" data-i18n="savoir">Savoir</option>
                        <option value="@{technique}" data-i18n="technique">Technique</option>
                        <option value="@{aura}" data-i18n="aura">Aura</option>
                        <option value="@{parole}" data-i18n="parole">Parole</option>
                        <option value="@{sf}" data-i18n="sang-froid">Sang-Froid</option>
                        <option value="@{discretion}" data-i18n="discretion">Discrétion</option>
                        <option value="@{dexterite}" data-i18n="dexterite">Dextérité</option>
                        <option value="@{perception}" data-i18n="perception">Perception</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="liste">
            <h1 class="titre" data-i18n="armes-improvisees">Armes Improvisées</h1>
            <div class="ligneTitre">
                <span class="type" data-i18n="type">Type</span>
                <span class="degats" data-i18n="degats">Dégâts</span>
                <span class="violence" data-i18n="violence">Violence</span>
                <span class="jetArme" data-i18n="utilisations">Utilisations</span>
            </div>
            <div class="ligne">
                <span class="type" data-i18n="arme-improvisee-od1-exemple1">Lampadaire, panneau, petit arbre, cadavre, etc.</span>
                
                <div class="degats"><input type="text" name="attr_dgts1" value="4D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence1" value="4D6" readonly /></div>
                <div class="jetArme">
                    <input type="number" name="attr_utilisation1" value="3" readonly />
                    <button class="rollDice" type="action" name="act_MAAI1" value="@{jetGM} @{MAUtilisationArmeAI} {{Nom=@{name}}} {{special1B=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne">
                <span class="type" data-i18n="arme-improvisee-od1-exemple2">Citerne d'essence, transformateur électrique, etc.</span>
                
                <div class="degats"><input type="text" name="attr_dgts2" value="2D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence2" value="5D6" readonly /></div>
                <div class="jetArme">
                    <input type="number" name="attr_utilisation2" value="1" readonly />
                    <button class="rollDice" type="action" name="act_MAAI2" value="@{jetGM} @{MAUtilisationArmeAI} {{Nom=@{name}}} {{special1B=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne">
                <span class="type" data-i18n="arme-improvisee-od1-exemple3">Moto, petit véhicule, etc.</span>
                
                <div class="degats"><input type="text" name="attr_dgts3" value="4D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence3" value="4D6" readonly /></div>
                <div class="jetArme">
                    <input type="number" name="attr_utilisation3" value="2" readonly />
                    <button class="rollDice" type="action" name="act_MAAI3" value="@{jetGM} @{MAUtilisationArmeAI} {{Nom=@{name}}} {{special1B=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne separationTop">
                <span class="type" data-i18n="arme-improvisee-od2-exemple1">Arbre, poteau en béton, etc.</span>
                
                <div class="degats"><input type="text" name="attr_dgts4" value="6D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence4" value="4D6" readonly /></div>
                <div class="jetArme">
                    <input type="number" name="attr_utilisation4" value="3" readonly />
                    <button class="rollDice" type="action" name="act_MAAI4" value="@{jetGM} @{MAUtilisationArmeAI} {{Nom=@{name}}} {{special1B=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne">
                <span class="type" data-i18n="arme-improvisee-od2-exemple2">Petit château d'eau, cuve industrielle pleine, etc.</span>
                
                <div class="degats"><input type="text" name="attr_dgts5" value="4D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence5" value="6D6" readonly /></div>
                <div class="jetArme">
                    <input type="number" name="attr_utilisation5" value="1" readonly />
                    <button class="rollDice" type="action" name="act_MAAI5" value="@{jetGM} @{MAUtilisationArmeAI} {{Nom=@{name}}} {{special1B=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne">
                <span class="type" data-i18n="arme-improvisee-od2-exemple3">Voiture, véhicule de taille moyenne, etc.</span>
                
                <div class="degats"><input type="text" name="attr_dgts6" value="5D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence6" value="5D6" readonly /></div>
                <div class="jetArme">
                    <input type="number" name="attr_utilisation6" value="2" readonly />
                    <button class="rollDice" type="action" name="act_MAAI6" value="@{jetGM} @{MAUtilisationArmeAI} {{Nom=@{name}}} {{special1B=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne separationTop">
                <span class="type" data-i18n="arme-improvisee-od3-exemple1">Charpente métallique, gros arbre, etc.</span>
                
                <div class="degats"><input type="text" name="attr_dgts7" value="7D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence7" value="5D6" readonly /></div>
                <div class="jetArme">
                    <input type="number" name="attr_utilisation7" value="3" readonly />
                    <button class="rollDice" type="action" name="act_MAAI7" value="@{jetGM} @{MAUtilisationArmeAI} {{Nom=@{name}}} {{special1B=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne">
                <span class="type" data-i18n="arme-improvisee-od3-exemple2">Façade de maison, morceau de route, rails, etc.</span>
                
                <div class="degats"><input type="text" name="attr_dgts8" value="5D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence8" value="7D6" readonly /></div>
                <div class="jetArme">
                    <input type="number" name="attr_utilisation8" value="1" readonly />
                    <button class="rollDice" type="action" name="act_MAAI8" value="@{jetGM} @{MAUtilisationArmeAI} {{Nom=@{name}}} {{special1B=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne">
                <span class="type" data-i18n="arme-improvisee-od3-exemple3">Camionnette, gros 4x4, etc.</span>
                
                <div class="degats"><input type="text" name="attr_dgts9" value="6D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence9" value="6D6" readonly /></div>
                <div class="jetArme">
                    <input type="number" name="attr_utilisation8" value="2" readonly />
                    <button class="rollDice" type="action" name="act_MAAI9" value="@{jetGM} @{MAUtilisationArmeAI} {{Nom=@{name}}} {{special1B=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne separationTop">
                <span class="type" data-i18n="arme-improvisee-od4-exemple1">Façade de petit immeuble, remorque de camion, etc.</span>
                
                <div class="degats"><input type="text" name="attr_dgts10" value="7D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence10" value="9D6" readonly /></div>
                <div class="jetArme">
                    <input type="number" name="attr_utilisation10" value="1" readonly />
                    <button class="rollDice" type="action" name="act_MAAI10" value="@{jetGM} @{MAUtilisationArmeAI} {{Nom=@{name}}} {{special1B=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne">
                <span class="type" data-i18n="arme-improvisee-od4-exemple2">Camion, petit véhicule de chantier, etc.</span>
                
                <div class="degats"><input type="text" name="attr_dgts11" value="8D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence11" value="8D6" readonly /></div>
                <div class="jetArme">
                    <input type="number" name="attr_utilisation11" value="2" readonly />
                    <button class="rollDice" type="action" name="act_MAAI11" value="@{jetGM} @{MAUtilisationArmeAI} {{Nom=@{name}}} {{special1B=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne separationTop">
                <span class="type" data-i18n="arme-improvisee-od5-exemple1">Façade d'immeuble, grue, container plein, etc.</span>
                
                <div class="degats"><input type="text" name="attr_dgts12" value="10D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence12" value="12D6" readonly /></div>
                <div class="jetArme">
                    <input type="number" name="attr_utilisation12" value="1" readonly />
                    <button class="rollDice" type="action" name="act_MAAI12" value="@{jetGM} @{MAUtilisationArmeAI} {{Nom=@{name}}} {{special1B=^{armes-improvisees}}}"></button>
                </div>
            </div>
            <div class="ligne">
                <span class="type" data-i18n="arme-improvisee-od5-exemple2">Yacht de 20 mètres, blindé, mécha-armure, etc.</span>

                <div class="degats"><input type="text" name="attr_dgts13" value="11D6" readonly /></div>
                <div class="violence"><input type="text" name="attr_violence13" value="11D6" readonly /></div>
                <div class="jetArme">
                    <input type="number" name="attr_utilisation13" value="2" readonly />
                    <button class="rollDice" type="action" name="act_MAAI13" value="@{jetGM} @{MAUtilisationArmeAI} {{Nom=@{name}}} {{special1B=^{armes-improvisees}}}"></button>
                </div>
            </div>
        </div>
    </div>
</div><div class="MAJV15">
	<span>Suite à une mise à jour de la fiche et de par les limitations de Roll20, veuillez cliquez sur le bouton ci-dessous.</span>
	<span>En faisant cela, vous accéderez à nouveau à la fiche. La mise à jour concerne principalement l'<b>onglet Module</b>, aussi veuillez simplement vérifier l'<b>onglet Module</b> une fois la mise à jour faite, car il y aura <b>quelques ajustements à faire</b>.</span>
	<button type="action" name="act_majV15" >Mettre à Jour</button>
</div>
</div>
<rolltemplate class="sheet-rolltemplate-base">
	<h1 class="titre">{{Nom}}</h1>
	<h2 class="titre2">
		{{type}}
	</h2>
	<div class="ligne f14">
		<span data-i18n="resultat">Résultat</span>
		<span>{{jet}}</span>
	</div>
	{{#oldE}}
		{{#gainBonus}}
			<div class="ligne f12">
				<span data-i18n="bonus-gain-espoir">Bonus au gain d'espoir</span>
				<span>{{gainBonus}}</span>
			</div>
		{{/gainBonus}}
		<div class="ligne f12">
			<span data-i18n="espoir-precedent">Espoir précédent</span>
			<span>{{oldE}}</span>
		</div>
		<div class="ligne f12">
			<span data-i18n="espoir-actuel">Espoir actuel</span>
			<span>{{computed::oldE}}</span>
		</div>
	{{/oldE}}
</rolltemplate><rolltemplate class="sheet-rolltemplate-simple">
	<h1 class="titre">{{Nom}}</h1>
	{{#special1}}
		<h2 class="titre2">{{special1}}</h2>
	{{/special1}}
	{{#special1B}}
		<h2 class="titre2">{{special1B}}</h2>
	{{/special1B}}
	{{#special2}}
		<h3 class="titre3">{{special2}}</h3>
	{{/special2}}

	{{#MALspecial2}}
		<h3 class="titre3">{{MALspecial2}}</h3>
	{{/MALspecial2}}

	{{#goliath}}
	<div class="ligne f12">
		<span data-i18n="taille-mode-goliath">Taille du mode goliath</span>
		<span>{{goliath}}</span>
	</div>
	{{/goliath}}

	{{#MALGoliath}}
	<div class="ligne f12">
		<span data-i18n="taille-mode-goliath">Taille du mode goliath</span>
		<span>{{MALGoliath}}</span>
	</div>
	{{/MALGoliath}}

	{{#mod}}
		<div class="ligne f12">
			<span data-i18n="malus/bonus">Malus / Bonus</span>
			<span>{{mod}}</span>
		</div>
	{{/mod}}

	{{#cBase}}
		<h2 class="titre2">{{cBase}}</h2>
	{{/cBase}}

	{{#cBonus}}
		<h2 class="titre2">{{cBonus}}</h2>
	{{/cBonus}}

	{{#totem1}}
		<h2 class="titre2">{{totem1}}</h2>
	{{/totem1}}
	{{#totem2}}
		<h2 class="titre2">{{totem2}}</h2>
	{{/totem2}}
	{{#totem3}}
		<h2 class="titre2">{{totem3}}</h2>
	{{/totem3}}

	{{#MALTotem1}}
		<h2 class="titre2">{{MALTotem1}}</h2>
	{{/MALTotem1}}
	{{#MALTotem2}}
		<h2 class="titre2">{{MALTotem2}}</h2>
	{{/MALTotem2}}
	{{#MALTotem3}}
		<h2 class="titre2">{{MALTotem3}}</h2>
	{{/MALTotem3}}
	
	{{#jet}}
		<div class="ligneM f14">
			<span class="nom" data-i18n="succes">Succès</span>
			<span class="value">{{computed::jet}}</span>
			{{#OD}}
				<span class="full"><span data-i18n="od-inclus">OD inclus</span> ({{vOD}})</span>
			{{/OD}}
			{{#vAE}}
				<span class="full"><span data-i18n="ae-inclus">AE inclus</span> ({{vAE}})</span>
			{{/vAE}}
			{{#vManoeuvrabilite}}
				<span class="full"><span data-i18n="vehicule-manoeuvrabilite-inclus">Manoeuvrabilité inclus</span> ({{vManoeuvrabilite}})</span>
			{{/vManoeuvrabilite}}

			{{#vODBarbarian}}
				<span class="full"><span data-i18n="goliath-inclus">Bonus du mode goliath inclus</span> ({{vODBarbarian}})</span>
			{{/vODBarbarian}}
			{{#vODShaman}}
				<span class="full"><span data-i18n="totem-inclus">Bonus du mode totem inclus</span> ({{vODShaman}})</span>
			{{/vODShaman}}
			{{#vODWarrior}}
				<span class="full"><span data-i18n="warrior-inclus">Bonus du type de la warrior inclus</span> ({{vODWarrior}})</span>
			{{/vODWarrior}}
			{{#vODSorcerer}}
				<span class="full"><span data-i18n="sorcerer-immobilisation-inclus">Bonus du sorcerer pour immobiliser inclus</span> ({{vODSorcerer}})</span>
			{{/vODSorcerer}}

			{{#vODMALBarbarian}}
				<span class="full"><span data-i18n="goliath-inclus">Bonus du mode goliath inclus</span> ({{vODMALBarbarian}})</span>
			{{/vODMALBarbarian}}
			{{#vODMALShaman}}
				<span class="full"><span data-i18n="totem-inclus">Bonus du mode totem inclus</span> ({{vODMALShaman}})</span>
			{{/vODMALShaman}}
			{{#vODMALWarrior}}
				<span class="full"><span data-i18n="warrior-inclus">Bonus du type de la warrior inclus</span> ({{vODMALWarrior}})</span>
			{{/vODMALWarrior}}
		</div>
	{{/jet}}
	
	{{#initiative}}
		<div class="ligneM f14">
			<span class="nom" data-i18n="initiative">Initiative</span>
			<span class="value">{{initiative}}</span>
			{{#OD}}
				<span class="full"><span data-i18n="od-inclus">OD inclus</span> ({{vOD}})</span>
			{{/OD}}
			{{#vAE}}
				<span class="full"><span data-i18n="ae-inclus">AE inclus</span> ({{vAE}})</span>
			{{/vAE}}
		</div>
	{{/initiative}}

	{{#jDivers}}
		<div class="ligneM f14">
			<span class="nom">{{jDivers}}</span>
			<span class="value">{{jDiversV}}</span>
		</div>
	{{/jDivers}}

	{{#conditionnel}}
		<h4 class="sousTitre" data-i18n="effets-conditionnels">Effets Conditionnels</h4>
		{{#vODGhostA}}
			<div class="ligneM f12">
				<span class="nom">+{{vODGhostA}}</span>
				<span class="value">{{vODGhostAValue}}</span>
				<span class="full" data-i18n="mode-ghost-deplacement-condition">
					S'applique pour passer inaperçu.
				</span>
			</div>
		{{/vODGhostA}}
		{{#vODMALGhostA}}
			<div class="ligneM f12">
				<span class="nom">+{{vODMALGhostA}}</span>
				<span class="value">{{vODMALGhostAValue}}</span>
				<span class="full" data-i18n="mode-ghost-deplacement-condition">
					S'applique pour passer inaperçu.
				</span>
			</div>
		{{/vODMALGhostA}}
	{{/conditionnel}}

	{{#text}}
		<div class="ligneF f12">
			<span class="fullText">{{text}}</span>
		</div>
	{{/text}}
	{{#rollTitre}}
		<h2 class="titre2">{{computed::rollTitre}}</h2>
	{{/rollTitre}}
	{{#rollText}}		
		<div class="ligneF f12">
			<span class="fullText">{{computed::rollText}}</span>
		</div>
	{{/rollText}}

	{{#qualiteApprenti}}
		<h2 class="titre2 borderTop borderBottom space">
			<span data-i18n="art-qualite-apprenti">Apprenti</span> <span data-i18n="art-qualite-apprenti-score">(3 à 5)</span>
		</h2>
		<div class="ligneF">
			<span class="fullText">
				{{qualiteApprenti}}
			</span>
		</div>
	{{/qualiteApprenti}}

	{{#qualiteInitie}}
		<h2 class="titre2 borderTop borderBottom space">
			<span data-i18n="art-qualite-initie">Initié</span> <span data-i18n="art-qualite-initie-score">(6 à 8)</span>
		</h2>
		<div class="ligneF">
			<span class="fullText">
				{{qualiteInitie}}
			</span>
		</div>
	{{/qualiteInitie}}

	{{#qualiteMaitre}}
		<h2 class="titre2 borderTop borderBottom space">
			<span data-i18n="art-qualite-maitre">Maître</span> <span data-i18n="art-qualite-maitre-score">(9+)</span>
		</h2>
		<div class="ligneF">
			<span class="fullText">
				{{qualiteMaitre}}
			</span>
		</div>
	{{/qualiteMaitre}}

	{{#effetsArt}}
		<h2 class="titre2 borderTop borderBottom" data-i18n="effet">Effet</h2>
		<div class="ligneF">
			<span class="fullText">
				{{effetsArt}}
			</span>
		</div>
	{{/effetsArt}}

	{{#button}}
		<h2 class="titre2 borderTop borderBottom">
			<span data-i18n="degats">Dégâts</span> / <span data-i18n="violence">Violence</span> / <span data-i18n="espoir">Espoir</span>
		</h2>
		<div class="button">
			{{1d6}} {{2d6}} {{3d6}} {{4d6}}
		</div>
	{{/button}}

	{{#Exploit}}
		{{#^rollTotal() Exploit 0}}
			{{#rollTotal() Exploit jet}}
				<h1 class="exploit" data-i18n="exploit">Exploit</h1>
			{{/rollTotal() Exploit jet}}
		{{/^rollTotal() Exploit 0}}
		{{#rollTotal() jet 0}}
			<h1 class="echecCritique" data-i18n="echec-critique">Échec Critique</h1>
		{{/rollTotal() jet 0}}
	{{/Exploit}}
</rolltemplate><rolltemplate class="sheet-rolltemplate-combat">
	<h1 class="titre">{{Nom}}</h1>
	{{#special1}}
		<h2 class="titre2">{{special1}}</h2>
	{{/special1}}
	{{#special1B}}
		<h2 class="titre2">{{special1B}}</h2>
	{{/special1B}}
	
	{{#special2}}
		<h3 class="titre3">{{special2}}</h3>
	{{/special2}}

	{{#MALspecial2}}
		<h3 class="titre3">{{MALspecial2}}</h3>
	{{/MALspecial2}}

	{{#herauts}}
		<div class="ligneFullHerauts">
			<span>{{herauts}}</span>
		</div>
	{{/herauts}}

	{{#portee}}
		<h3 class="titre3">{{portee}}</h3>
	{{/portee}}

	{{#style}}
		<h3 class="titre3">{{style}}</h3>
	{{/style}}

	{{#goliath}}
	<div class="ligne f12">
		<span data-i18n="taille-mode-goliath">Taille du mode goliath</span>
		<span>{{goliath}}</span>
	</div>
	{{/goliath}}

	{{#MALGoliath}}
	<div class="ligne f12">
		<span data-i18n="taille-mode-goliath">Taille du mode goliath</span>
		<span>{{MALGoliath}}</span>
	</div>
	{{/MALGoliath}}

	{{#mod}}
		<div class="ligne f12">
			<span data-i18n="malus/bonus">Malus / Bonus</span>
			<span>{{mod}}</span>
		</div>
	{{/mod}}

	{{#cBase}}
		<h2 class="titre2">{{cBase}}</h2>
	{{/cBase}}

	{{#cBonus}}
		<h2 class="titre2">{{cBonus}}</h2>
	{{/cBonus}}

	{{#cPrecis}}
		<h2 class="titre2">{{cPrecis}}</h2>
	{{/cPrecis}}

	{{#totem1}}
		<h2 class="titre2">{{totem1}}</h2>
	{{/totem1}}
	{{#totem2}}
		<h2 class="titre2">{{totem2}}</h2>
	{{/totem2}}
	{{#totem3}}
		<h2 class="titre2">{{totem3}}</h2>
	{{/totem3}}

	{{#MALTotem1}}
		<h2 class="titre2">{{MALTotem1}}</h2>
	{{/MALTotem1}}
	{{#MALTotem2}}
		<h2 class="titre2">{{MALTotem2}}</h2>
	{{/MALTotem2}}
	{{#MALTotem3}}
		<h2 class="titre2">{{MALTotem3}}</h2>
	{{/MALTotem3}}
	
	{{#jet}}
		<div class="ligneM f14">
			<span class="nom" data-i18n="succes">Succès</span>
			<span class="value">{{computed::jet}}</span>
			{{#OD}}
				<span class="full"><span data-i18n="od-inclus">OD inclus</span> ({{vOD}})</span>
			{{/OD}}
			{{#vAE}}
				<span class="full"><span data-i18n="ae-inclus">AE inclus</span> ({{vAE}})</span>
			{{/vAE}}
			
			{{#vMStyleA}}
				<span class="full"><span data-i18n="style-inclus">Style inclus</span> ({{vMStyleA}})</span>
			{{/vMStyleA}}

			{{#vODBarbarian}}
				<span class="full"><span data-i18n="goliath-inclus">Bonus du mode goliath inclus</span> ({{vODBarbarian}})</span>
			{{/vODBarbarian}}
			{{#vGhostA}}
				<span class="full"><span data-i18n="ghost-inclus">Bonus du mode ghost inclus</span> ({{vGhostA}})</span>
			{{/vGhostA}}
			{{#vODShaman}}
				<span class="full"><span data-i18n="totem-inclus">Bonus du mode totem inclus</span> ({{vODShaman}})</span>
			{{/vODShaman}}
			{{#vODWarrior}}
				<span class="full"><span data-i18n="warrior-inclus">Bonus du type de la warrior inclus</span> ({{vODWarrior}})</span>
			{{/vODWarrior}}
			{{#vODSorcerer}}
				<span class="full"><span data-i18n="sorcerer-immobilisation-inclus">Bonus du sorcerer pour immobiliser inclus</span> ({{vODSorcerer}})</span>
			{{/vODSorcerer}}

			{{#vODMALBarbarian}}
				<span class="full"><span data-i18n="goliath-inclus">Bonus du mode goliath inclus</span> ({{vODMALBarbarian}})</span>
			{{/vODMALBarbarian}}
			{{#vMALGhostA}}
				<span class="full"><span data-i18n="ghost-inclus">Bonus du mode ghost inclus</span> ({{vMALGhostA}})</span>
			{{/vMALGhostA}}
			{{#vODMALShaman}}
				<span class="full"><span data-i18n="totem-inclus">Bonus du mode totem inclus</span> ({{vODMALShaman}})</span>
			{{/vODMALShaman}}
			{{#vODMALWarrior}}
				<span class="full"><span data-i18n="warrior-inclus">Bonus du type de la warrior inclus</span> ({{vODMALWarrior}})</span>
			{{/vODMALWarrior}}

			{{#vMDrone}}
				<span class="full"><span data-i18n="munitions-drones-inclus">Munitions drones inclus</span> ({{vMDrone}})</span>
			{{/vMDrone}}

			{{#vMPLaser}}
				<span class="full"><span data-i18n="pointeur-laser-inclus">Pointeur laser inclus</span> ({{vMPLaser}})</span>
			{{/vMPLaser}}

			{{#vCadence}}
				<span class="full">{{rCadence}} (-{{vCadence}})</span>
			{{/vCadence}}

			{{#vChambreDouble}}
				<span class="full"><span data-i18n="chambre-double-inclus">Chambre double inclus</span> (-{{vChambreDouble}})</span>
			{{/vChambreDouble}}
		</div>
	{{/jet}}
	
	{{#initiative}}
		<div class="ligneM f14">
			<span class="nom" data-i18n="initiative">Succès</span>
			<span class="value">{{computed::jet}}</span>
			{{#OD}}
				<span class="full"><span data-i18n="od-inclus">OD inclus</span> ({{vOD}})</span>
			{{/OD}}
			{{#vAE}}
				<span class="full"><span data-i18n="ae-inclus">AE inclus</span> ({{vAE}})</span>
			{{/vAE}}
		</div>
	{{/initiative}}

	{{#succesConditionnel}}
		<h4 class="sousTitre" data-i18n="effets-conditionnels">Effets Conditionnels</h4>
		{{#chocAutomatique}}
			<div class="ligneF f12">
				<span class="nom">{{chocAutomatique}}</span>
				<span class="full">
					{{chocAutomatiqueCondition}}
				</span>
			</div>
		{{/chocAutomatique}}
		{{#vODMALGhostA}}
			<div class="ligneM f12">
				<span class="nom">+{{vODMALGhostA}}</span>
				<span class="value">{{vODMALGhostAValue}}</span>
				<span class="full">
					{{vODMALGhostACondition}}
				</span>
			</div>
		{{/vODMALGhostA}}
		{{#artillerie}}
			<div class="ligneF f12">
				<span class="nom">{{artillerie}}</span>
				<span class="full">
					{{artillerieCondition}}
				</span>
			</div>
		{{/artillerie}}
		{{#choc}}
			<div class="ligneF f12">
				<span class="nom">{{choc}}</span>
				<span class="full">
					{{chocCondition}}
				</span>
			</div>
		{{/choc}}
		{{#demoralisant}}
			<div class="ligneF f12">
				<span class="nom">{{demoralisant}}</span>
				<span class="full">
					{{demoralisantCondition}}
				</span>
			</div>
		{{/demoralisant}}
		{{#parasitage}}
			<div class="ligneF f12">
				<span class="nom">{{parasitage}}</span>
				<span class="full">
					{{parasitageCondition}}
				</span>
			</div>
		{{/parasitage}}
		{{#soumission}}
			<div class="ligneF f12">
				<span class="nom">{{soumission}}</span>
				<span class="full">
					{{soumissionCondition}}
				</span>
			</div>
		{{/soumission}}

		{{#canonLong}}
			<div class="ligneF f12">
				<span class="nom">{{canonLong}}</span>
				<span class="full">
					{{canonLongCondition}}
				</span>
			</div>
		{{/canonLong}}
		{{#canonRaccourci}}
			<div class="ligneF f12">
				<span class="nom">{{canonRaccourci}}</span>
				<span class="full">
					{{canonRaccourciCondition}}
				</span>
			</div>
		{{/canonRaccourci}}
		{{#lunetteIntelligente}}
			<div class="ligneF f12">
				<span class="nom">{{lunetteIntelligente}}</span>
				<span class="full">
					{{lunetteIntelligenteCondition}}
				</span>
			</div>
		{{/lunetteIntelligente}}
	{{/succesConditionnel}}

	{{#degats}}
		<div class="ligneM f14 doubleBordureTop">
			<span class="nom" data-i18n="degats">Dégâts</span>
			<span class="value">{{computed::degats}}</span>
			{{#vForce}}
				<span class="full"><span data-i18n="bonus-force-inclus">Bonus force inclus</span> ({{vForce}})</span>
			{{/vForce}}
			{{#vChair}}
				<span class="full"><span data-i18n="bonus-chair-inclus">Bonus chair inclus</span> ({{vChair}})</span>
			{{/vChair}}

			{{#vBeteD}}
				<span class="full"><span data-i18n="bonus-bete-inclus">Bonus bête inclus</span> ({{vBeteD}})</span>
			{{/vBeteD}}
			{{#vBarbarianD}}
				<span class="full"><span data-i18n="goliath-inclus">Bonus du Mode Goliath inclus</span> ({{vBarbarianD}})</span>
			{{/vBarbarianD}}
			{{#vMALBarbarianD}}
				<span class="full"><span data-i18n="goliath-inclus">Bonus du Mode Goliath inclus</span> ({{vMALBarbarianD}})</span>
			{{/vMALBarbarianD}}
			{{#vGhostD}}
				<span class="full"><span data-i18n="ghost-inclus">Bonus du Mode Ghost inclus</span> ({{vGhostD}})</span>
			{{/vGhostD}}
			{{#vMALGhostD}}
				<span class="full"><span data-i18n="ghost-inclus">Bonus du Mode Ghost inclus</span> ({{vMALGhostD}})</span>
			{{/vMALGhostD}}

			{{#vMStyleD}}
				<span class="full"><span data-i18n="style-inclus">Style inclus</span> ({{vMStyleD}})</span>
			{{/vMStyleD}}

			{{#vSilencieuxD}}
				<span class="full"><span data-i18n="silencieux-inclus">Silencieux inclus</span> ({{vSilencieuxD}})</span>
			{{/vSilencieuxD}}

			{{#vRayonDegats}}
				<span class="full"><span data-i18n="monk-bonus-maintien-inclus">Bonus de maintien inclus</span> (+{{vRayonDegats}})</span>
			{{/vRayonDegats}}
						
			{{#vAgressive}}
				<span class="full"><span data-i18n="agressive-inclus">Bonus agressive inclus</span> ({{vAgressive}})</span>
			{{/vAgressive}}
			{{#vAllegee}}
				<span class="full"><span data-i18n="allegee-inclus">Allégée inclus</span> ({{vAllegee}})</span>
			{{/vAllegee}}
			{{#vAssassineD}}
				<span class="full"><span data-i18n="assassine-inclus">Assassine inclus</span> ({{vAssassineD}})</span>
			{{/vAssassineD}}
			{{#vLeste}}
				<span class="full"><span data-i18n="leste-inclus">Bonus lesté inclus</span> ({{vLeste}})</span>
			{{/vLeste}}			
			{{#vMassive}}
				<span class="full"><span data-i18n="massive-inclus">Bonus massive inclus</span> ({{vMassive}})</span>
			{{/vMassive}}			
			{{#vOrfevrerie}}
				<span class="full"><span data-i18n="orfevrerie-inclus">Bonus orfévrerie inclus</span> ({{vOrfevrerie}})</span>
			{{/vOrfevrerie}}
			{{#vSournoise}}
				<span class="full"><span data-i18n="sournoise-inclus">Bonus sournoise inclus</span> ({{vSournoise}})</span>
			{{/vSournoise}}
			{{#vSubsoniqueD}}
				<span class="full"><span data-i18n="munitions-subsoniques-inclus">Subsonique inclus</span> ({{vSubsoniqueD}})</span>
			{{/vSubsoniqueD}}
			{{#vSurMesure}}
				<span class="full"><span data-i18n="sur-mesure-inclus">Sur mesure inclus</span> ({{vSurMesure}})</span>
			{{/vSurMesure}}
			{{#vPrecision}}
				<span class="full"><span data-i18n="precision-inclus">Bonus precision inclus</span> ({{vPrecision}})</span>
			{{/vPrecision}}

			{{#vMGrappeD}}
				<span class="full"><span data-i18n="chargeur-balles-grappes-inclus">Chargeur et balles grappes inclus</span> ({{vMGrappeD}})</span>
			{{/vMGrappeD}}
			{{#vMExplosiveD}}
				<span class="full"><span data-i18n="chargeur-munitions-explosives-inclus">Chargeur et munitions explosives inclus</span> ({{vMExplosiveD}})</span>
			{{/vMExplosiveD}}
			{{#vMIEMD}}
				<span class="full"><span data-i18n="munitions-iem-inclus">Munitions IEM inclus</span> ({{vMIEMD}})</span>
			{{/vMIEMD}}
			{{#vMSpecialD}}
				<span class="full"><span data-i18n="bonus-special-inclus">Bonus spécial inclus</span> ({{vMSpecialD}})</span>
			{{/vMSpecialD}}
			{{#vFaucheuse}}
				<span class="full"><span data-i18n="faucheuse-gravee-inclus">Faucheuse Gravée inclus</span> ({{vFaucheuse}})</span>
			{{/vFaucheuse}}
			{{#vSillonsFLF}}
				<span class="full"><span data-i18n="sillons-inclus">Sillons inclus</span> ({{vSillonsFLF}})</span>
			{{/vSillonsFLF}}

			{{#vGrenadesAmeliorees}}
				<span class="full"><span data-i18n="grenades-intelligentes-avancees-inclus">Grenades intelligentes avancées inclus</span> ({{vGrenadesAmeliorees}})</span>
			{{/vGrenadesAmeliorees}}
		</div>
	{{/degats}}
	{{#degatsConditionnel}}
		<h4 class="sousTitre" data-i18n="effets-conditionnels">Effets Conditionnels</h4>
		{{#assistanceAttaque}}
			<div class="ligneF f12">
				<span class="nom">+{{assistanceAttaque}}</span>
				<span class="full">
					{{assistanceAttaqueCondition}}
				</span>
			</div>
		{{/assistanceAttaque}}
		{{#attaqueSurprise}}
			<div class="ligneM f12">
				<span class="nom">+{{attaqueSurprise}}</span>
				<span class="value">{{computed::attaqueSurpriseValue}}</span>
				<span class="full">
					{{attaqueSurpriseCondition}}
				</span>
			</div>
		{{/attaqueSurprise}}
		{{#destructeur}}
			<div class="ligneM f12">
				<span class="nom">+{{destructeur}}</span>
				<span class="value">{{computed::destructeurValue}}</span>
				<span class="full">
					{{destructeurCondition}}
				</span>
			</div>
		{{/destructeur}}
		{{#meurtrier}}
			<div class="ligneM f12">
				<span class="nom">+{{meurtrier}}</span>
				<span class="value">{{computed::meurtrierValue}}</span>
				<span class="full">
					{{meurtrierCondition}}
				</span>
			</div>
		{{/meurtrier}}
		{{#armeAzurine}}
			<div class="ligneM f12">
				<span class="nom">+{{armeAzurine}}</span>
				<span class="value">{{computed::armeAzurineValueD}}</span>
				<span class="full">
					{{armeAzurineCondition}}
				</span>
			</div>
		{{/armeAzurine}}
		{{#armeRougeSang}}
			<div class="ligneM f12">
				<span class="nom">+{{armeRougeSang}}</span>
				<span class="value">{{computed::armeRougeSangValueD}}</span>
				<span class="full">
					{{armeRougeSangCondition}}
				</span>
			</div>
		{{/armeRougeSang}}
		{{#cheneSculpte}}
			<div class="ligneM f12">
				<span class="nom">+{{cheneSculpte}}</span>
				<span class="value">{{computed::cheneSculpteValue}}</span>
				<span class="full">
					{{cheneSculpteCondition}}
				</span>
			</div>
		{{/cheneSculpte}}
		{{#griffuresGravees}}
			<div class="ligneM f12">
				<span class="nom">+{{griffuresGravees}}</span>
				<span class="value">{{computed::griffuresGraveesValueD}}</span>
				<span class="full">
					{{griffuresGraveesCondition}}
				</span>
			</div>
		{{/griffuresGravees}}
		{{#masqueBrise}}
			<div class="ligneM f12">
				<span class="nom">+{{masqueBrise}}</span>
				<span class="value">{{computed::masqueBriseValueD}}</span>
				<span class="full">
					{{masqueBriseCondition}}
				</span>
			</div>
		{{/masqueBrise}}
		{{#rouagesCasses}}
			<div class="ligneM f12">
				<span class="nom">+{{rouagesCasses}}</span>
				<span class="value">{{computed::rouagesCassesValueD}}</span>
				<span class="full">
					{{rouagesCassesCondition}}
				</span>
			</div>
		{{/rouagesCasses}}
		{{#affecteAnathemeD}}
			<div class="ligneF f12">
				<span class="nom">{{affecteAnathemeD}}</span>
			</div>
		{{/affecteAnathemeD}}
		{{#antiAnatheme}}
			<div class="ligneF f12">
				<span class="nom">{{antiAnatheme}}</span>
				<span class="full">
					{{antiAnathemeCondition}}
				</span>
			</div>
		{{/antiAnatheme}}
		{{#enChaine}}
			<div class="ligneF f12">
				<span class="nom">{{enChaine}}</span>
				<span class="full">
					{{enChaineCondition}}
				</span>
			</div>
		{{/enChaine}}
		{{#esperance}}
			<div class="ligneF f12">
				<span class="nom">{{esperance}}</span>
				<span class="full">
					{{esperanceConditionD}}
				</span>
			</div>
		{{/esperance}}
		{{#obliteration}}
			<div class="ligneM f12">
				<span class="nom">{{obliteration}}</span>
				<span class="value">{{obliterationValue}}</span>
				{{#tenebricideAS}}
					<div class="subValue">
						<span>+{{obliterationAS}}</span>
						<span>{{obliterationASValue}}</span>
					</div>
				
				{{/tenebricideAS}}
				{{#destructeur}}
					<div class="subValue">
						<span>+{{destructeur}}</span>
						<span>{{obliterationDestructeurValue}}</span>
					</div>				
				{{/destructeur}}
				{{#meurtrier}}
					<div class="subValue">
						<span>+{{meurtrier}}</span>
						<span>{{obliterationMeurtrierValue}}</span>
					</div>				
				{{/meurtrier}}
				{{#armeAzurine}}
					<div class="subValue">
						<span>+{{armeAzurine}}</span>
						<span>{{obliterationArmeAzurineValue}}</span>
					</div>				
				{{/armeAzurine}}
				{{#armeRougeSang}}
					<div class="subValue">
						<span>+{{armeRougeSang}}</span>
						<span>{{obliterationArmeRougeSangValue}}</span>
					</div>				
				{{/armeRougeSang}}
				{{#cheneSculpte}}
					<div class="subValue">
						<span>+{{cheneSculpte}}</span>
						<span>{{obliterationCheneSculpteValue}}</span>
					</div>				
				{{/cheneSculpte}}
				{{#griffuresGravees}}
					<div class="subValue">
						<span>+{{griffuresGravees}}</span>
						<span>{{obliterationGriffureGraveeValue}}</span>
					</div>				
				{{/griffuresGravees}}
				{{#masqueBrise}}
					<div class="subValue">
						<span>+{{masqueBrise}}</span>
						<span>{{obliterationMasqueBriseValue}}</span>
					</div>				
				{{/masqueBrise}}
				{{#rouagesCasses}}
					<div class="subValue">
						<span>+{{rouagesCasses}}</span>
						<span>{{obliterationRouagesCassesValue}}</span>
					</div>				
				{{/rouagesCasses}}
				<span class="full">
					{{obliterationCondition}}
				</span>
			</div>
		{{/obliteration}}
		{{#tenebricide}}
			<div class="ligneM f12">
				<span class="nom">{{tenebricide}}</span>
				<span class="value">{{computed::tenebricideValueD}}</span>
				{{#tenebricideAS}}
					<div class="subValue">
						<span>+{{tenebricideAS}}</span>
						<span>{{computed::tenebricideASValue}}</span>
					</div>
				{{/tenebricideAS}}
				{{#destructeur}}
					<div class="subValue">
						<span>+{{destructeur}}</span>
						<span>{{computed::tDestructeurValue}}</span>
					</div>				
				{{/destructeur}}
				{{#meurtrier}}
					<div class="subValue">
						<span>+{{meurtrier}}</span>
						<span>{{computed::tMeurtrierValue}}</span>
					</div>				
				{{/meurtrier}}
				{{#cheneSculpte}}
					<div class="subValue">
						<span class="nom">+{{cheneSculpte}}</span>
						<span class="value">{{computed::tCheneSculpteValue}}</span>
					</div>
				{{/cheneSculpte}}
				<span class="full">
					{{tenebricideConditionD}}
				</span>
			</div>
		{{/tenebricide}}
		{{#tirRafale}}
			<div class="ligneF f12">
				<span class="nom">{{tirRafale}}</span>
				<span class="full">
					{{tirRafaleCondition}}
				</span>
			</div>
		{{/tirRafale}}

		{{#grenadeExplosive}}
			<div class="ligneM f12">
				<span class="nom">{{grenadeExplosive}}</span>
				<span class="value">{{grenadeExplosiveD}}</span>
			</div>
		{{/grenadeExplosive}}

		{{#subsonique}}
			<div class="ligneM f12">
				<span class="nom">+{{subsonique}}</span>
				<span class="value">{{subsoniqueValue}}</span>
				<span class="full">
					{{subsoniqueCondition}}
				</span>
			</div>
		{{/subsonique}}
	{{/degatsConditionnel}}

	{{#violence}}
		<div class="ligneM f14 doubleBordureTop">
			<span class="nom" data-i18n="violence">Violence</span>
			<span class="value">{{computed::violence}}</span>
			{{#vBarbarianV}}
				<span class="full"><span data-i18n="goliath-inclus">Bonus du Mode Goliath inclus</span> ({{vBarbarianV}})</span>
			{{/vBarbarianV}}
			{{#vMALBarbarianV}}
				<span class="full"><span data-i18n="goliath-inclus">Bonus du Mode Goliath inclus</span> ({{vMALBarbarianV}})</span>
			{{/vMALBarbarianV}}
			{{#vMStyleV}}
				<span class="full"><span data-i18n="style-inclus">Style inclus</span> ({{vMStyleV}})</span>
			{{/vMStyleV}}
			{{#vMGrappeV}}
				<span class="full"><span data-i18n="chargeur-balles-grappes-inclus">Chargeur et balles grappes inclus</span> ({{vMGrappeV}})</span>
			{{/vMGrappeV}}
			{{#vMExplosiveV}}
				<span class="full"><span data-i18n="chargeur-munitions-explosives-inclus">Chargeur et munitions explosives inclus</span> ({{vMExplosiveV}})</span>
			{{/vMExplosiveV}}
			{{#vMIEMV}}
				<span class="full"><span data-i18n="munitions-iem-inclus">Munitions IEM inclus</span> ({{vMIEMV}})</span>
			{{/vMIEMV}}
			{{#vMSpecialV}}
				<span class="full"><span data-i18n="bonus-special-inclus">Bonus spécial inclus</span> ({{vMSpecialV}})</span>
			{{/vMSpecialV}}
			{{#vFlammesStylisees}}
				<span class="full"><span data-i18n="flammes-stylisées-inclus">Flammes Stylisées inclus</span> ({{vFlammesStylisees}})</span>
			{{/vFlammesStylisees}}

			{{#vGrenadesAmeliorees}}
				<span class="full"><span data-i18n="grenades-intelligentes-avancees-inclus">Grenades intelligentes avancées inclus</span> ({{vGrenadesAmeliorees}})</span>
			{{/vGrenadesAmeliorees}}
		</div>
	{{/violence}}
	{{#violenceConditionnel}}
		<h4 class="sousTitre" data-i18n="effets-conditionnels">Effets Conditionnels</h4>
		{{#assistanceAttaque}}
			<div class="ligneF f12">
				<span class="nom">+{{assistanceAttaque}}</span>
				<span class="full">
					{{assistanceAttaqueCondition}}
				</span>
			</div>
		{{/assistanceAttaque}}
		{{#fureur}}
			<div class="ligneM f12">
				<span class="nom">+{{fureur}}</span>
				<span class="value">{{computed::fureurValue}}</span>
				<span class="full">
					{{fureurCondition}}
				</span>
			</div>
		{{/fureur}}
		{{#ultraviolence}}
			<div class="ligneM f12">
				<span class="nom">+{{ultraviolence}}</span>
				<span class="value">{{computed::ultraviolenceValue}}</span>
				<span class="full">
					{{ultraviolenceCondition}}
				</span>
			</div>
		{{/ultraviolence}}
		{{#armeAzurine}}
			<div class="ligneM f12">
				<span class="nom">+{{armeAzurine}}</span>
				<span class="value">{{computed::armeAzurineValueV}}</span>
				<span class="full">
					{{armeAzurineCondition}}
				</span>
			</div>
		{{/armeAzurine}}
		{{#armeRougeSang}}
			<div class="ligneM f12">
				<span class="nom">+{{armeRougeSang}}</span>
				<span class="value">{{computed::armeRougeSangValueV}}</span>
				<span class="full">
					{{armeRougeSangCondition}}
				</span>
			</div>
		{{/armeRougeSang}}
		{{#griffuresGravees}}
			<div class="ligneM f12">
				<span class="nom">+{{griffuresGravees}}</span>
				<span class="value">{{computed::griffuresGraveesValueV}}</span>
				<span class="full">
					{{griffuresGraveesCondition}}
				</span>
			</div>
		{{/griffuresGravees}}
		{{#masqueBrise}}
			<div class="ligneM f12">
				<span class="nom">+{{masqueBrise}}</span>
				<span class="value">{{computed::masqueBriseValueV}}</span>
				<span class="full">
					{{masqueBriseCondition}}
				</span>
			</div>
		{{/masqueBrise}}
		{{#rouagesCasses}}
			<div class="ligneM f12">
				<span class="nom">+{{rouagesCasses}}</span>
				<span class="value">{{computed::rouagesCassesValueV}}</span>
				<span class="full">
					{{rouagesCassesCondition}}
				</span>
			</div>
		{{/rouagesCasses}}
		{{#affecteAnathemeV}}
			<div class="ligneF f12">
				<span class="nom">{{affecteAnathemeV}}</span>
			</div>
		{{/affecteAnathemeV}}
		{{#antiAnatheme}}
			<div class="ligneF f12">
				<span class="nom">{{antiAnatheme}}</span>
				<span class="full">
					{{antiAnathemeCondition}}
				</span>
			</div>
		{{/antiAnatheme}}
		{{#esperance}}
			<div class="ligneF f12">
				<span class="nom">{{esperance}}</span>
				<span class="full">
					{{esperanceConditionV}}
				</span>
			</div>
		{{/esperance}}
		{{#tenebricide}}
			<div class="ligneM f12">
				<span class="nom">{{tenebricide}}</span>
				<span class="value">{{computed::tenebricideValueV}}</span>
				{{#fureur}}
					<div class="subValue">
						<span>+{{fureur}}</span>
						<span>{{computed::tFureurValue}}</span>
					</div>				
				{{/fureur}}
				{{#ultraviolence}}
					<div class="subValue">
						<span>+{{ultraviolence}}</span>
						<span>{{computed::tUltraviolenceValue}}</span>
					</div>				
				{{/ultraviolence}}
				<span class="full">
					{{tenebricideConditionV}}
				</span>
			</div>
		{{/tenebricide}}
	{{/violenceConditionnel}}

	{{#effets}}
		<h2 class="titre2 doubleBordureTop" data-i18n="effets-de-l'arme">Autres effets de l'Arme</h2>
		<div class="ligneFull">
			<span>{{effets}}</span>
		</div>
	{{/effets}}

	{{#ameliorationsS}}
		<h2 class="titre2 doubleBordureTop" data-i18n="autres-ameliorations-structurelles">Autres améliorations structurelles</h2>
		<div class="ligneFull">
			<span>{{ameliorationsS}}</span>
		</div>
	{{/ameliorationsS}}

	{{#ameliorationsO}}
		<h2 class="titre2 doubleBordureTop" data-i18n="autres-ameliorations-d'ornement">Autres améliorations d'Ornement</h2>
		<div class="ligneFull">
			<span>{{ameliorationsO}}</span>
		</div>
	{{/ameliorationsO}}

	{{#ameliorations}}
		<h2 class="titre2 doubleBordureTop" data-i18n="ameliorations-de-l'arme">Autres améliorations de l'Arme</h2>
		<div class="ligneFull">
			<span>{{ameliorations}}</span>
		</div>
	{{/ameliorations}}

	{{#special}}
		<h2 class="titre2 doubleBordureTop" data-i18n="special">Spécial</h2>
		<div class="ligneFull">
			<span>{{special}}</span>
		</div>
	{{/special}}

	{{#Exploit}}
		{{#^rollTotal() Exploit 0}}
			{{#rollTotal() Exploit jet}}
				<h1 class="exploit" data-i18n="exploit">Exploit</h1>
			{{/rollTotal() Exploit jet}}
		{{/^rollTotal() Exploit 0}}
		{{#rollTotal() jet 0}}
			<h1 class="echecCritique" data-i18n="echec-critique">Échec Critique</h1>
		{{/rollTotal() jet 0}}
	{{/Exploit}}

	{{#debordement}}
		<div class="ligneM f14">
			<span class="nom" data-i18n="debordement">Débordement</span>
			<span class="value">{{debordement}}</span>
		</div>
	{{/debordement}}
</rolltemplate><rolltemplate class="sheet-rolltemplate-mechaArmure">
	<h1 class="titre">{{Nom}}</h1>
	{{#special1}}
		<h2 class="titre2">{{special1}}</h2>
	{{/special1}}
	{{#special1B}}
		<h2 class="titre2">{{special1B}}</h2>
	{{/special1B}}
	{{#special2}}
		<h3 class="titre3">{{special2}}</h3>
	{{/special2}}
	{{#special2B}}
		<h3 class="titre3">{{special2B}}</h3>
	{{/special2B}}

	{{#herauts}}
		<div class="ligneFullHerauts">
			<span>{{herauts}}</span>
		</div>
	{{/herauts}}

	{{#portee}}
		<h3 class="titre3">{{portee}}</h3>
	{{/portee}}

	{{#style}}
		<h3 class="titre3">{{style}}</h3>
	{{/style}}

	{{#mod}}
		<div class="ligne f12">
			<span data-i18n="malus/bonus">Malus / Bonus</span>
			<span>{{mod}}</span>
		</div>
	{{/mod}}

	{{#cBase}}
		<h2 class="titre2">{{cBase}}</h2>
	{{/cBase}}

	{{#cBonus}}
		<h2 class="titre2">{{cBonus}}</h2>
	{{/cBonus}}

	{{#jet}}
		<div class="ligneM f14">
			<span class="nom" data-i18n="succes">Succès</span>
			<span class="value">{{computed::jet}}</span>
			{{#vOD}}
				<span class="full"><span data-i18n="od-inclus">OD inclus</span> ({{vOD}})</span>
			{{/vOD}}
			{{#vManoeuvrabilite}}
				<span class="full"><span data-i18n="vehicule-manoeuvrabilite-inclus">Manoeuvrabilité inclus</span> ({{vManoeuvrabilite}})</span>
			{{/vManoeuvrabilite}}
			{{#vPuissance}}
				<span class="full"><span data-i18n="puissance-inclus">Puissance inclus</span> ({{vPuissance}})</span>
			{{/vPuissance}}
			{{#vSenseurs}}
				<span class="full"><span data-i18n="senseurs-inclus">Senseurs inclus</span> ({{vSenseurs}})</span>
			{{/vSenseurs}}
			{{#vSystemes}}
				<span class="full"><span data-i18n="systemes-inclus">Systemes inclus</span> ({{vSystemes}})</span>
			{{/vSystemes}}
			{{#vWraithA}}
				<span class="full"><span data-i18n="wraith-inclus">Bonus du mode wraith inclus</span> ({{vWraithA}})</span>
			{{/vWraithA}}
		</div>
	{{/jet}}

	{{#succesConditionnel}}
		<h4 class="sousTitre" data-i18n="effets-conditionnels">Effets Conditionnels</h4>
		{{#parasitage}}
			<div class="ligneF f12">
				<span class="nom">{{parasitage}}</span>
				<span class="full">
					{{parasitageCondition}}
				</span>
			</div>
		{{/parasitage}}
	{{/succesConditionnel}}

	{{#degats}}
		<div class="ligneM f14 doubleBordureTop">
			<span class="nom" data-i18n="degats">Dégâts</span>
			<span class="value">{{computed::degats}}</span>
			{{#vForce}}
				<span class="full"><span data-i18n="bonus-force-inclus">Bonus force inclus</span> ({{vForce}})</span>
			{{/vForce}}

			{{#vBeteD}}
				<span class="full"><span data-i18n="bonus-bete-inclus">Bonus bête inclus</span> ({{vBeteD}})</span>
			{{/vBeteD}}

			{{#vMStyleD}}
				<span class="full"><span data-i18n="style-inclus">Style inclus</span> ({{vMStyleD}})</span>
			{{/vMStyleD}}

			{{#vWraithD}}
				<span class="full"><span data-i18n="wraith-inclus">Bonus du mode wraith inclus</span> ({{vWraithD}})</span>
			{{/vWraithD}}
		</div>
	{{/degats}}
	{{#degatsConditionnel}}
		<h4 class="sousTitre" data-i18n="effets-conditionnels">Effets Conditionnels</h4>
		{{#attaqueSurprise}}
			<div class="ligneM f12">
				<span class="nom">+{{attaqueSurprise}}</span>
				<span class="value">{{computed::attaqueSurpriseValue}}</span>
				<span class="full">
					{{attaqueSurpriseCondition}}
				</span>
			</div>
		{{/attaqueSurprise}}
		{{#antiAnatheme}}
			<div class="ligneF f12">
				<span class="nom">{{antiAnatheme}}</span>
				<span class="full">
					{{antiAnathemeCondition}}
				</span>
			</div>
		{{/antiAnatheme}}
		{{#meurtrier}}
			<div class="ligneM f12">
				<span class="nom">+{{meurtrier}}</span>
				<span class="value">{{computed::meurtrierValue}}</span>
				<span class="full">
					{{meurtrierCondition}}
				</span>
			</div>
		{{/meurtrier}}
	{{/degatsConditionnel}}

	{{#violence}}
		<div class="ligneM f14 doubleBordureTop">
			<span class="nom" data-i18n="violence">Violence</span>
			<span class="value">{{computed::violence}}</span>

			{{#vMStyleV}}
				<span class="full"><span data-i18n="style-inclus">Style inclus</span> ({{vMStyleV}})</span>
			{{/vMStyleV}}
		</div>
	{{/violence}}
	{{#violenceConditionnel}}
		<h4 class="sousTitre" data-i18n="effets-conditionnels">Effets Conditionnels</h4>
		{{#antiAnatheme}}
			<div class="ligneF f12">
				<span class="nom">{{antiAnatheme}}</span>
				<span class="full">
					{{antiAnathemeCondition}}
				</span>
			</div>
		{{/antiAnatheme}}
		{{#fureur}}
			<div class="ligneM f12">
				<span class="nom">+{{fureur}}</span>
				<span class="value">{{computed::fureurValue}}</span>
				<span class="full">
					{{fureurCondition}}
				</span>
			</div>
		{{/fureur}}
	{{/violenceConditionnel}}

	{{#jDivers}}
		<div class="ligneM f14">
			<span class="nom">{{jDivers}}</span>
			<span class="value">{{jDiversV}}</span>
		</div>
	{{/jDivers}}

	{{#jDivers2}}
		<div class="ligneM f14">
			<span class="nom">{{jDivers2}}</span>
			<span class="value">{{jDivers2V}}</span>
		</div>
	{{/jDivers2}}

	{{#jDivers3}}
		<div class="ligneM f14">
			<span class="nom">{{jDivers3}}</span>
			<span class="value">{{jDivers3V}}</span>
		</div>
	{{/jDivers3}}

	{{#jDivers2F12}}
		<div class="ligneM f12">
			<span class="nom">{{jDivers2F12}}</span>
			<span class="value">{{jDivers2F12V}}</span>
		</div>
	{{/jDivers2F12}}

	{{#jDivers3F12}}
		<div class="ligneM f12">
			<span class="nom">{{jDivers3F12}}</span>
			<span class="value">{{jDiver3F12V}}</span>
		</div>
	{{/jDivers3F12}}

	{{#jDivers4F12}}
		<div class="ligneM f12">
			<span class="nom">{{jDivers4F12}}</span>
			<span class="value">{{jDiver4F12V}}</span>
		</div>
	{{/jDivers4F12}}

	{{#jDivers5F12}}
		<div class="ligneM f12">
			<span class="nom">{{jDivers5F12}}</span>
			<span class="value">{{jDiver5F12V}}</span>
		</div>
	{{/jDivers5F12}}

	{{#text}}
		<div class="ligneF f12">
			<span class="fullText">{{text}}</span>
		</div>
	{{/text}}

	{{#rollText}}		
		<div class="ligneF f12">
			<span class="fullText">{{computed::rollText}}</span>
		</div>
	{{/rollText}}

	{{#effets}}
		<h2 class="titre2 doubleBordureTop" data-i18n="effets-de-l'arme">Autres effets de l'Arme</h2>
		<div class="ligneFull">
			<span>{{effets}}</span>
		</div>
	{{/effets}}

	{{#Exploit}}
		{{#^rollTotal() Exploit 0}}
			{{#rollTotal() Exploit jet}}
				<h1 class="exploit" data-i18n="exploit">Exploit</h1>
			{{/rollTotal() Exploit jet}}
		{{/^rollTotal() Exploit 0}}
		{{#rollTotal() jet 0}}
			<h1 class="echecCritique" data-i18n="echec-critique">Échec Critique</h1>
		{{/rollTotal() jet 0}}
	{{/Exploit}}
</rolltemplate>