<div class="main">
    <div class="left-container">
        <div class="header-info">
            <div class="input-with-text-bellow char-name">
                <!-- <input name="attr_charname" type="text" spellcheck="false" value=""/> -->
                <input name="attr_character_name" type="text"  spellcheck="false"  value="">
                <span>Nome</span>
            </div>
            <div class="input-with-text-bellow char-player">
                <input name="attr_playername" type="text" spellcheck="false" value=""/>
                <span>Raiz</span>
            </div>
            <div class="input-with-text-bellow">
                <input name="attr_trace" type="text" spellcheck="false" value=""/>
                <span>Legado</span>
            </div>
            <div class="input-with-text-bellow">
                <input name="attr_torigin" type="text" spellcheck="false" value=""/>
                <span>Arquétipo</span>
            </div>
            <div class="input-with-text-bellow">
                <input name="attr_tlevel" type="text" spellcheck="false" value=""/>
                <span>Trilha</span>
            </div>
            <div class="input-with-text-bellow">
                <input name="attr_tsize" type="text" spellcheck="false" value=""/>
                <span>Tamanho</span>
            </div>
            <div class="input-with-text-bellow">
                <input name="attr_tdisplacement" type="text" spellcheck="false" value=""/>
                <span>Deslocamento</span>
            </div>
            <div class="input-with-text-bellow">
                <input name="attr_torigem" type="text" spellcheck="false" value=""/>
                <span>Origem</span>
            </div>
        </div>

        <div class="character-attributes">
            <!-- Força -->
            <div class="outer-container-negative-corner">
                <div class="container-negative-corner">
                    <div class="inside-negative-corner">
                        <!-- Conteudo aqui -->
                        <button type="roll" name="roll_for" value="&{template:t20}{{character=@{character_name}}}{{rollname=Força}}{{theroll=[[1d20+@{for_mod}]]}}" class="button-title-attribute">FOR</button>
                        <input name="attr_for_mod_fake" type="text" spellcheck="false" maxlength="2" class="fake-mod" title="@{for_mod}" value="@{for_mod}" disabled="true" />
                        <input type="hidden" name="attr_for_mod" />
    
                        <div class="corner top-left"></div>
                        <div class="corner top-right"></div>
                        <div class="corner bottom-left"></div>
                        <div class="corner bottom-right"></div>
                    </div>
                </div>
                <div class="oval">
                    <input name="attr_for" maxlength="2" type="text" spellcheck="false" value="10"/>
                </div>
            </div>
            <!-- Destreza -->
            <div class="outer-container-negative-corner">
                <div class="container-negative-corner">
                    <div class="inside-negative-corner">
                        <button type="roll" name="roll_des" value="&{template:t20}{{character=@{character_name}}}{{rollname=Destreza}}{{theroll=[[1d20+@{des_mod}]]}}" class="button-title-attribute">DES</button>
                        <input name="attr_des_mod_fake" type="text" spellcheck="false" maxlength="2" class="fake-mod" title="@{des_mod}" value="@{des_mod}" disabled="true" />
                        <input type="hidden" name="attr_des_mod" />
    
                        <div class="corner top-left"></div>
                        <div class="corner top-right"></div>
                        <div class="corner bottom-left"></div>
                        <div class="corner bottom-right"></div>
                    </div>
                </div>
                <div class="oval">
                    <input name="attr_des" maxlength="2" type="text" spellcheck="false" value="10"/>
                </div>
            </div>
            <!-- Constituição -->
            <div class="outer-container-negative-corner">
                <div class="container-negative-corner">
                    <div class="inside-negative-corner">
                        <button type="roll" name="roll_con" value="&{template:t20}{{character=@{character_name}}}{{rollname=Constituição}}{{theroll=[[1d20+@{con_mod}]]}}" class="button-title-attribute">CON</button>
                        <input name="attr_con_mod_fake" type="text" spellcheck="false" maxlength="2" class="fake-mod" title="@{con_mod}" value="@{con_mod}" disabled="true" />
                        <input type="hidden" name="attr_con_mod" />
    
                        <div class="corner top-left"></div>
                        <div class="corner top-right"></div>
                        <div class="corner bottom-left"></div>
                        <div class="corner bottom-right"></div>
                    </div>
                </div>
                <div class="oval">
                    <input name="attr_con" maxlength="2" type="text" spellcheck="false" value="10"/>
                </div>
            </div>
            <!-- Inteligência -->
            <div class="outer-container-negative-corner">
                <div class="container-negative-corner">
                    <div class="inside-negative-corner">
                        <button type="roll" name="roll_int" value="&{template:t20}{{character=@{character_name}}}{{rollname=Inteligência}}{{theroll=[[1d20+@{int_mod}]]}}" class="button-title-attribute">INT</button>
                        <input name="attr_int_mod_fake" type="text" spellcheck="false" maxlength="2" class="fake-mod" title="@{int_mod}" value="@{int_mod}" disabled="true" />
                        <input type="hidden" name="attr_int_mod" />
    
                        <div class="corner top-left"></div>
                        <div class="corner top-right"></div>
                        <div class="corner bottom-left"></div>
                        <div class="corner bottom-right"></div>
                    </div>
                </div>
                <div class="oval">
                    <input name="attr_int" maxlength="2" type="text" spellcheck="false" value="10"/>
                </div>
            </div>
            <!-- Sabedoria -->
            <div class="outer-container-negative-corner">
                <div class="container-negative-corner">
                    <div class="inside-negative-corner">
                        <button type="roll" name="roll_sab" value="&{template:t20}{{character=@{character_name}}}{{rollname=Sabedoria}}{{theroll=[[1d20+@{sab_mod}]]}}" class="button-title-attribute">SAB</button>
                        <input name="attr_sab_mod_fake" type="text" spellcheck="false" maxlength="2" class="fake-mod" title="@{sab_mod}" value="@{sab_mod}" disabled="true" />
                        <input type="hidden" name="attr_sab_mod" />
    
                        <div class="corner top-left"></div>
                        <div class="corner top-right"></div>
                        <div class="corner bottom-left"></div>
                        <div class="corner bottom-right"></div>
                    </div>
                </div>
                <div class="oval">
                    <input name="attr_sab" maxlength="2" type="text" spellcheck="false" value="10"/>
                </div>
            </div>
            <!-- Carisma -->
            <div class="outer-container-negative-corner">
                <div class="container-negative-corner">
                    <div class="inside-negative-corner">
                        <button type="roll" name="roll_car" value="&{template:t20}{{character=@{character_name}}}{{rollname=Carisma}}{{theroll=[[1d20+@{car_mod}]]}}" class="button-title-attribute">CAR</button>
                        <input name="attr_car_mod_fake" type="text" spellcheck="false" maxlength="2" class="fake-mod" title="@{car_mod}" value="@{car_mod}" disabled="true" />
                        <input type="hidden" name="attr_car_mod" />
    
                        <div class="corner top-left"></div>
                        <div class="corner top-right"></div>
                        <div class="corner bottom-left"></div>
                        <div class="corner bottom-right"></div>
                    </div>
                </div>
                <div class="oval">
                    <input name="attr_car" maxlength="2" type="text" spellcheck="false" value="10"/>
                </div>
            </div>
        </div> 

        <div class="pseudo-attributes">
            <!-- Pontos de Vida -->
            <div class="container-negative-corner container-pvs-mps">
                <div class="inside-negative-corner">
                    <div class="box-title">
                        Pontos de Vida
                    </div>
                    <div class="content-centered border-right">
                        <input name="attr_vidatotal" type="text" spellcheck="false" maxlength="3" class="" value="0">
                    </div>
                    <div class="content-centered">
                        <input name="attr_vida" type="text" spellcheck="false" maxlength="3" class="" value="0">
                    </div>
                    <div class="content-centered border-left">
                        <input name="attr_vidatemp" type="text" spellcheck="false" maxlength="3" class="" value="0">
                    </div>
                    <div class="content-centered smaller-text">Máximos</div>
                    <div class="content-centered smaller-text">Atuais</div>
                    <div class="content-centered smaller-text">Temporários</div>
                    <div class="corner top-left"></div>
                    <div class="corner top-right"></div>
                    <div class="corner bottom-left"></div>
                    <div class="corner bottom-right"></div>
                </div>
            </div>
            <!-- Pontos de Mana -->
            <div class="container-negative-corner container-pvs-mps">
                <div class="inside-negative-corner">
                    <div class="box-title">
                        Pontos de Mana
                    </div>
                    <div class="content-centered border-right">
                        <input name="attr_manatotal" type="text" spellcheck="false" maxlength="3" class="" value="0">
                    </div>
                    <div class="content-centered">
                        <input name="attr_mana" type="text" spellcheck="false" maxlength="3" class="" value="0">
                    </div>
                    <div class="content-centered border-left">
                        <input name="attr_manatemp" type="text" spellcheck="false" maxlength="3" class="" value="0">
                    </div>
                    <div class="content-centered smaller-text">Máximos</div>
                    <div class="content-centered smaller-text">Atuais</div>
                    <div class="content-centered smaller-text">Temporários</div>
                    <div class="corner top-left"></div>
                    <div class="corner top-right"></div>
                    <div class="corner bottom-left"></div>
                    <div class="corner bottom-right"></div>
                </div>
            </div>
            
            <!-- Pontos de Sombra -->
            <div class="container-negative-corner container-pvs-mps sombra-catarse">
                <div class="inside-negative-corner">
                    <div class="box-title">
                        Pontos de Sombra
                    </div>
                    <div class="content-centered border-right">
                    </div>
                    <div class="content-centered">
                        <input name="attr_sombra" type="text" spellcheck="false" maxlength="3" class="" value="0">
                    </div>
                    <div class="content-centered border-left">
                    </div>
                    <div class="corner top-left"></div>
                    <div class="corner top-right"></div>
                    <div class="corner bottom-left"></div>
                    <div class="corner bottom-right"></div>
                </div>
            </div>
            <!-- Pontos de Catarse -->
            <div class="container-negative-corner container-pvs-mps sombra-catarse">
                <div class="inside-negative-corner">
                    <div class="box-title">
                        Pontos de Catarse
                    </div>
                    <div class="content-centered border-right">
                    </div>
                    <div class="content-centered">
                        <input name="attr_catarse" type="text" spellcheck="false" maxlength="3" class="" value="0">
                    </div>
                    <div class="content-centered border-left">
                    </div>
                    <div class="corner top-left"></div>
                    <div class="corner top-right"></div>
                    <div class="corner bottom-left"></div>
                    <div class="corner bottom-right"></div>
                </div>
            </div>
        </div>

        <div class="attacks-container">
            <div class="inside">
                <div class="container-negative-corner">
                    <div class="inside-negative-corner">
                        <!-- <div class="default-title">Ataques</div> -->
                        <div class="attacksgrid">
                            <div></div>
                            <div class="grid-title">Nome do Ataque</div>
                            <div class="small-title">Bônus de Ataque</div>
                            <div class="small-title">Dano</div>
                            <div class="small-title">Dano Extra</div>
                            <div class="small-title">Crítico</div>
                        </div>
                            <!-- Ataques -->
                            <fieldset class="repeating_attacks"> 
                                <div class="attacksgrid">
                                    <button type="roll" name="roll_attack" class="buttonrollataque" value="&{template:t20-attack}{{character=@{character_name}}}{{attackname=@{nomeataque}}}{{attackroll=[[1d20cs>@{margemcriticoataque}+[[@{ataquepericia}]]+@{bonusataque}]]}} {{damageroll=[[@{danoataque}+@{modatributodano}+@{danoextraataque}]]}} {{criticaldamageroll=[[@{danocriticoataque}+@{modatributodano}+@{danoextraataque}]]}}{{typeofdamage=@{ataquetipodedano}}}{{description=@{ataquedescricao}}}">T</button>
                                    <input name="attr_nomeataque" type="text" spellcheck="false" class="" value="">
                                    <input name="attr_bonusataque" type="text" spellcheck="false" class="" value="0">
                                    <input name="attr_danoataque" type="text" spellcheck="false" class="" value="0">
                                    <input name="attr_danoextraataque" type="text" spellcheck="false" class="" value="0">
                                    <div class="containercritico">
                                        <input name="attr_margemcriticoataque" type="text" spellcheck="false" class="margem" value="20">
                                        <span class="divisor"><b>/</b>x</span>
                                        <input name="attr_multiplicadorcriticoataque" type="text" spellcheck="false" class="multiplicador" value="2">
                                    </div>
                                    <input type="hidden" name="attr_danocriticoataque" value="0" readonly="1">

                                    <div class="moreinfo">
                                        <input type="checkbox" class="hiddencheckbox">
                                        <span class="hiddencheckboxcover"></span>
                                        <div class="containermoreinfo">
                                            <!-- <div class="containerdescrataque">
                                                <div class="title">Descrição</div>
                                                <textarea name="attr_proficiencias"></textarea>
                                            </div> -->
                                            <div class="inputtextbellow descricao">
                                                <input name="attr_ataquedescricao" type="text" spellcheck="false" value=""/>
                                                <span class="title">Descrição / Macros</span>
                                            </div>
                                            <div class="inputtextbellow">
                                                <select name="attr_ataquepericia">
                                                    <option value="@{atuacaototal}">Atuação</option>
                                                    <option value="@{lutatotal}" selected="">Luta</option>
                                                    <option value="@{pontariatotal}">Pontaria</option>
                                                </select>
                                                <span class="title">Perícia utilizada</span>
                                            </div>
                                            <div class="inputtextbellow">
                                                <input name="attr_ataquetipodedano" type="text" spellcheck="false" value=""/>
                                                <span class="title">Tipo de Dano</span>
                                            </div>
                                            <div class="inputtextbellow">
                                                <input name="attr_ataquealcance" type="text" spellcheck="false" value=""/>
                                                <span class="title">Alcance</span>
                                            </div>
                                            
                                            <div class="inputtextbellow">
                                                <select name="attr_modatributodano">
                                                    <option value="0" selected="">Nenhum</option>
                                                    <option value="@{for_mod}">Força</option>
                                                    <option value="@{des_mod}">Destreza</option>
                                                    <option value="@{con_mod}">Constituição</option>
                                                    <option value="@{int_mod}">Inteligência</option>
                                                    <option value="@{sab_mod}">Sabedoria</option>
                                                    <option value="@{sab_mod}">Carisma</option>
                                                </select>
                                                <span class="title">Atributo no Dano</span>
                                            </div>

                                            
                                        </div>
                                        <!-- <div class="bottomline"></div> -->
                                    </div>
                                </div> 
                                
                                
                            </fieldset>

                            <!-- Ataques -->


                        <div class="corner top-left"></div>
                        <div class="corner top-right"></div>
                        <div class="corner bottom-left"></div>
                        <div class="corner bottom-right"></div>
                    </div>
                </div>
            </div>
            
        </div>
        <div class="defense-and-proeficience-container">
            <div class="container-defense-armor-shield">
                <div class="container-negative-corner container-defense">
                    <div class="inside-negative-corner">
                        <div class="grid-title">Defesa</div>
                        <div></div>
                        <div></div>
                        <div></div>
                        <div class="small-title">Mod. Destreza</div>
                        <div></div>
                        <div class="small-title">Bônus de Armadura</div>
                        <div></div>
                        <div class="small-title">Bônus de Escudo</div>
                        <div></div>
                        <div class="small-title">Outros</div>
                        
                        <div>
                            <input class="defesa-total" name="attr_defesafake" disabled="true" value="@{defesatotal}" maxlength="3" type="text" spellcheck="false" title="@{defesatotal}">
                        </div>
                        <div class="signal">=</div>
                        <div class="big-signal">10</div>
                        <div class="signal">+</div>
                        <select name="attr_defesadestreza">
                            <option value="0">Não</option>
                            <option value="1" selected>Sim</option>
                        </select>
                        <div class="signal">+</div>
                        <div>
                            <input name="attr_defesaarmadura" type="text" spellcheck="false" value="@{armaduradefesa1}" disabled="true">
                        </div>
                        <div class="signal">+</div>
                        <div>
                            <input name="attr_defesaescudo" type="text" spellcheck="false" value="@{armaduradefesa2}" disabled="true">
                        </div>
                        <div class="signal">+</div>
                        <div>
                            <input name="attr_defesaoutros" type="text" spellcheck="false" value="@{armaduradefesa3}" disabled="true">
                        </div>

                        <div class="corner top-left"></div>
                        <div class="corner top-right"></div>
                        <div class="corner bottom-left"></div>
                        <div class="corner bottom-right"></div>
                    </div>
                </div>
            </div>
            <div class="container-defense-armor-shield">
                <div class="container-negative-corner container-armor-shield">
                    <div class="inside-negative-corner">
                        <div class="grid-title">Armadura & Escudo</div>
                        <div class="small-title">Defesa</div>
                        <div class="small-title">Penalidade</div>
                        <div class="small-title">Tipo</div>
                        <div>
                            <input name="attr_armadura1" type="text" spellcheck="false" value="Armadura">
                        </div>
                        <div>
                            <input name="attr_armaduradefesa1" type="text" spellcheck="false" value="0">
                        </div>
                        <div>
                            <input name="attr_armadurapenalidade1" type="text" spellcheck="false" value="0">
                        </div>
                        <div>
                            <select name="attr_tipoarmadura">
                                <option value="0" selected>Leve</option>
                                <option value="-1">Pesada</option>
                            </select>
                        </div>
                        <div>
                            <input name="attr_armadura2" type="text" spellcheck="false" value="Escudo">
                        </div>
                        <div>
                            <input name="attr_armaduradefesa2" type="text" spellcheck="false" value="0">
                        </div>
                        <div>
                            <input name="attr_armadurapenalidade2" type="text" spellcheck="false" value="0">
                        </div>
                        <div>
                        </div>
                        <div>
                            <input name="attr_armadura3" type="text" spellcheck="false" value="Outros">
                        </div>
                        <div>
                            <input name="attr_armaduradefesa3" type="text" spellcheck="false" value="0">
                        </div>
                        <div>
                            <input name="attr_armadurapenalidade3" type="text" spellcheck="false" value="0">
                        </div>
                        <div>
                        </div>
                        <div class="corner top-left"></div>
                        <div class="corner top-right"></div>
                        <div class="corner bottom-left"></div>
                        <div class="corner bottom-right"></div>
                    </div>
                </div>
            </div>
            <div class="box-proficiencies">
                <div class="container-negative-corner">
                    <div class="inside-negative-corner">
                        <div class="default-title">
                            Proficiências e outras características
                        </div>
                        <div class="content-centered">
                            <textarea name="attr_proficiencias"></textarea>
                        </div>
                        <div class="corner top-left"></div>
                        <div class="corner top-right"></div>
                        <div class="corner bottom-left"></div>
                        <div class="corner bottom-right"></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="powers-and-abilities">
            <div class="container-negative-corner">
                <div class="inside-negative-corner">
                    <div class="default-title">
                        Habilidades e Poderes Gerais
                    </div>
                    <div class="content-grid">
                        <div class="container-reapeater">
                            <fieldset class="repeating_abilities">
                                <div class="container-ability-power">
                                    <button type="roll" name="roll_ability" class="buttonshowinfo" value="&{template:t20-info}{{infoname=@{nameability}}}{{description=@{abilitydescription}}}">q</button>
                                    <input name="attr_nameability" type="text" spellcheck="false" value=""/>
                                    <input type="checkbox" class="hiddencheckbox">
                                    <span class="hiddencheckboxcover">W</span>
                                    <div class="extra">
                                        <textarea name="attr_abilitydescription"></textarea>
                                    </div>
                                </div>
                            </fieldset>
                        </div>
    
                        <div class="container-reapeater">
                            <fieldset class="repeating_powers">
                                <div class="container-ability-power">
                                    <button type="roll" name="roll_power" class="buttonshowinfo" value="&{template:t20-info}{{infoname=@{namepower}}}{{description=@{powerdescription}}}">q</button>
                                    <input name="attr_namepower" type="text" spellcheck="false" value=""/>
                                    <input type="checkbox" class="hiddencheckbox">
                                    <span class="hiddencheckboxcover">W</span>
                                    <div class="extra">
                                        <textarea name="attr_powerdescription"></textarea>
                                    </div>
                                </div>
                            </fieldset>
                        </div>
                    </div>
                    <div class="corner top-left"></div>
                    <div class="corner top-right"></div>
                    <div class="corner bottom-left"></div>
                    <div class="corner bottom-right"></div>
                </div>
            </div>
        </div>
        <div class="spells">
            <div class="container-negative-corner">
                <div class="inside-negative-corner">
                    <div class="default-title">
                        Magias
                    </div>
                    <div class="content-grid">
                        <div class="spellcolumn">
                            <div class="cicloheader">
                                <div class="ciclo-title">1º Círculo</div>
                                <div class="ciclo-cost">1 PM</div>
                            </div>
                            <div class="sheet-containerspelllist">
                                <fieldset class="repeating_spells1">
                                    
                                    <div class="container-single-spell">
                                        <button type="roll" name="roll_spell1" class="buttonspell" value="&{template:spell}{{character=@{character_name}}}{{spellname=@{namespell}}}{{type=@{spelltipo}}}{{execution=@{spellexecucao}}}{{duration=@{spellduracao}}}{{range=@{spellalcance}}}{{targetarea=@{spellalvoarea}}}{{resistance=@{spellresistencia}}}{{description=@{spelldescription}}}{{cd=@{spellcd}}}">T</button>
                                        <input name="attr_namespell" type="text" spellcheck="false" value=""/>
                                        <input type="checkbox" class="hiddencheckbox">
                                        <span class="hiddencheckboxcover">W</span>
                                        <div class="extra">
                                            <span>Tipo</span>
                                            <input name="attr_spelltipo" type="text" spellcheck="false" value=""/>
                                            <span class="cd" >CD</span>
                                            <input class="cd" name="attr_spellcd" type="text" spellcheck="false" value=""/>

                                            <span>Execução</span>
                                            <input  class="singleline" name="attr_spellexecucao" type="text" spellcheck="false" value=""/>
                                            <span>Alcance</span>
                                            <input class="singleline" name="attr_spellalcance" type="text" spellcheck="false" value=""/>
                                            <span>Duração</span>
                                            <input class="singleline" name="attr_spellduracao" type="text" spellcheck="false" value=""/>
                                            <span>Alvo/Área</span>
                                            <input class="singleline" name="attr_spellalvoarea" type="text" spellcheck="false" value=""/>
                                            <span>Resistência</span>
                                            <input class="singleline"  name="attr_spellresistencia" type="text" spellcheck="false" value=""/>

                                            <span class="fullline">Descrição</span>
                                            <textarea class="fullline" name="attr_spelldescription"></textarea>
                                        </div>
                                    </div>



                                </fieldset>
                            </div>
                            

                            <div class="cicloheader">
                                <div class="ciclo-title">3º Círculo</div>
                                <div class="ciclo-cost">6 PM</div>
                            </div>
                            <div class="sheet-containerspelllist">
                                <fieldset class="repeating_spells3">
                                    <div class="container-single-spell">
                                        <button type="roll" name="roll_spell3" class="buttonspell" value="&{template:spell}{{character=@{character_name}}}{{spellname=@{namespell}}}{{type=@{spelltipo}}}{{execution=@{spellexecucao}}}{{duration=@{spellduracao}}}{{range=@{spellalcance}}}{{targetarea=@{spellalvoarea}}}{{resistance=@{spellresistencia}}}{{description=@{spelldescription}}}{{cd=@{spellcd}}}">T</button>
                                        <input name="attr_namespell" type="text" spellcheck="false" value=""/>
                                        <input type="checkbox" class="hiddencheckbox">
                                        <span class="hiddencheckboxcover">W</span>
                                        <div class="extra">
                                            <span>Tipo</span>
                                            <input name="attr_spelltipo" type="text" spellcheck="false" value=""/>
                                            <span class="cd" >CD</span>
                                            <input class="cd" name="attr_spellcd" type="text" spellcheck="false" value=""/>

                                            <span>Execução</span>
                                            <input  class="singleline" name="attr_spellexecucao" type="text" spellcheck="false" value=""/>
                                            <span>Alcance</span>
                                            <input class="singleline" name="attr_spellalcance" type="text" spellcheck="false" value=""/>
                                            <span>Duração</span>
                                            <input class="singleline" name="attr_spellduracao" type="text" spellcheck="false" value=""/>
                                            <span>Alvo/Área</span>
                                            <input class="singleline" name="attr_spellalvoarea" type="text" spellcheck="false" value=""/>
                                            <span>Resistência</span>
                                            <input class="singleline"  name="attr_spellresistencia" type="text" spellcheck="false" value=""/>

                                            <span class="fullline">Descrição</span>
                                            <textarea class="fullline" name="attr_spelldescription"></textarea>
                                        </div>
                                    </div>
                                </fieldset>
                            </div>
                            <div class="cicloheader">
                                <div class="ciclo-title">5º Círculo</div>
                                <div class="ciclo-cost">15 PM</div>
                            </div>
                            <div class="sheet-containerspelllist">
                                <fieldset class="repeating_spells5">
                                    <div class="container-single-spell">
                                        <button type="roll" name="roll_spell5" class="buttonspell" value="&{template:spell}{{character=@{character_name}}}{{spellname=@{namespell}}}{{type=@{spelltipo}}}{{execution=@{spellexecucao}}}{{duration=@{spellduracao}}}{{range=@{spellalcance}}}{{targetarea=@{spellalvoarea}}}{{resistance=@{spellresistencia}}}{{description=@{spelldescription}}}{{cd=@{spellcd}}}">T</button>
                                        <input name="attr_namespell" type="text" spellcheck="false" value=""/>
                                        <input type="checkbox" class="hiddencheckbox">
                                        <span class="hiddencheckboxcover">W</span>
                                        <div class="extra">
                                            <span>Tipo</span>
                                            <input name="attr_spelltipo" type="text" spellcheck="false" value=""/>
                                            <span class="cd" >CD</span>
                                            <input class="cd" name="attr_spellcd" type="text" spellcheck="false" value=""/>

                                            <span>Execução</span>
                                            <input  class="singleline" name="attr_spellexecucao" type="text" spellcheck="false" value=""/>
                                            <span>Alcance</span>
                                            <input class="singleline" name="attr_spellalcance" type="text" spellcheck="false" value=""/>
                                            <span>Duração</span>
                                            <input class="singleline" name="attr_spellduracao" type="text" spellcheck="false" value=""/>
                                            <span>Alvo/Área</span>
                                            <input class="singleline" name="attr_spellalvoarea" type="text" spellcheck="false" value=""/>
                                            <span>Resistência</span>
                                            <input class="singleline"  name="attr_spellresistencia" type="text" spellcheck="false" value=""/>

                                            <span class="fullline">Descrição</span>
                                            <textarea class="fullline" name="attr_spelldescription"></textarea>
                                        </div>
                                    </div>
                                </fieldset>
                            </div>
                        </div>
                        <div class="spellcolumn">
                            <div class="cicloheader">
                                <div class="ciclo-title">2º Círculo</div>
                                <div class="ciclo-cost">3 PM</div>
                            </div>
                            <div class="sheet-containerspelllist">
                                <fieldset class="repeating_spells2">
                                    <div class="container-single-spell">
                                        <button type="roll" name="roll_spell2" class="buttonspell" value="&{template:spell}{{character=@{character_name}}}{{spellname=@{namespell}}}{{type=@{spelltipo}}}{{execution=@{spellexecucao}}}{{duration=@{spellduracao}}}{{range=@{spellalcance}}}{{targetarea=@{spellalvoarea}}}{{resistance=@{spellresistencia}}}{{description=@{spelldescription}}}{{cd=@{spellcd}}}">T</button>
                                        <input name="attr_namespell" type="text" spellcheck="false" value=""/>
                                        <input type="checkbox" class="hiddencheckbox">
                                        <span class="hiddencheckboxcover">W</span>
                                        <div class="extra">
                                            <span>Tipo</span>
                                            <input name="attr_spelltipo" type="text" spellcheck="false" value=""/>
                                            <span class="cd" >CD</span>
                                            <input class="cd" name="attr_spellcd" type="text" spellcheck="false" value=""/>

                                            <span>Execução</span>
                                            <input  class="singleline" name="attr_spellexecucao" type="text" spellcheck="false" value=""/>
                                            <span>Alcance</span>
                                            <input class="singleline" name="attr_spellalcance" type="text" spellcheck="false" value=""/>
                                            <span>Duração</span>
                                            <input class="singleline" name="attr_spellduracao" type="text" spellcheck="false" value=""/>
                                            <span>Alvo/Área</span>
                                            <input class="singleline" name="attr_spellalvoarea" type="text" spellcheck="false" value=""/>
                                            <span>Resistência</span>
                                            <input class="singleline"  name="attr_spellresistencia" type="text" spellcheck="false" value=""/>

                                            <span class="fullline">Descrição</span>
                                            <textarea class="fullline" name="attr_spelldescription"></textarea>
                                        </div>
                                    </div>
                                </fieldset>
                            </div>
                            <div class="cicloheader">
                                <div class="ciclo-title">4º Círculo</div>
                                <div class="ciclo-cost">10 PM</div>
                            </div>
                            <div class="sheet-containerspelllist">
                                <fieldset class="repeating_spells4">
                                    <div class="container-single-spell">
                                        <button type="roll" name="roll_spell4" class="buttonspell" value="&{template:spell}{{character=@{character_name}}}{{spellname=@{namespell}}}{{type=@{spelltipo}}}{{execution=@{spellexecucao}}}{{duration=@{spellduracao}}}{{range=@{spellalcance}}}{{targetarea=@{spellalvoarea}}}{{resistance=@{spellresistencia}}}{{description=@{spelldescription}}}{{cd=@{spellcd}}}">T</button>
                                        <input name="attr_namespell" type="text" spellcheck="false" value=""/>
                                        <input type="checkbox" class="hiddencheckbox">
                                        <span class="hiddencheckboxcover">W</span>
                                        <div class="extra">
                                            <span>Tipo</span>
                                            <input name="attr_spelltipo" type="text" spellcheck="false" value=""/>
                                            <span class="cd" >CD</span>
                                            <input class="cd" name="attr_spellcd" type="text" spellcheck="false" value=""/>

                                            <span>Execução</span>
                                            <input  class="singleline" name="attr_spellexecucao" type="text" spellcheck="false" value=""/>
                                            <span>Alcance</span>
                                            <input class="singleline" name="attr_spellalcance" type="text" spellcheck="false" value=""/>
                                            <span>Duração</span>
                                            <input class="singleline" name="attr_spellduracao" type="text" spellcheck="false" value=""/>
                                            <span>Alvo/Área</span>
                                            <input class="singleline" name="attr_spellalvoarea" type="text" spellcheck="false" value=""/>
                                            <span>Resistência</span>
                                            <input class="singleline"  name="attr_spellresistencia" type="text" spellcheck="false" value=""/>

                                            <span class="fullline">Descrição</span>
                                            <textarea class="fullline" name="attr_spelldescription"></textarea>
                                        </div>
                                    </div>
                                </fieldset>
                            </div>
                            
                        </div>
                    </div>
                    <div class="corner top-left"></div>
                    <div class="corner top-right"></div>
                    <div class="corner bottom-left"></div>
                    <div class="corner bottom-right"></div>
                </div>
            </div>
        </div>
        
    </div> 
    
    <div class="right-container">
        <div class="logo-level">
            <div class="container-logo">
                <img src="https://cdn-images-1.medium.com/max/1280/1*trf-Y3cCVwWeNVkXELUeSQ@2x.png" class="logo-tormenta"/>
            </div>
            <div class="char-level-container">
                <div class="total-level">
                    <span>Nível do Personagem</span>
                    <input name="attr_charnivel" maxlength="2" type="text" spellcheck="false" value="1"/>
                    
                </div>
            </div>
        </div>
        <div class="skills-container">
            <div class="container-negative-corner">
                <div class="inside-negative-corner">
                    <div class="skill-grid-template header">
                        <div class="grid-title pericias-titulo">Perícias</div>
                        <div></div>
                        <div class="grid-title">Total</div>
                        <div></div>
                        <!-- <div class="small-title">1/2 do Nível</div>
                        <div></div> -->
                        <div class="small-title">Mod. Atributo</div>
                        <div></div>
                        <div class="small-title">Treino</div>
                        <div></div>
                        <div class="small-title">Outros</div>
                    </div>
                    <div class="skill-grid-template skill-list">
                        <!-- Acrobacia -->
                        <div class="signal">
                            <label class="fake-checkbox">
                                <input type="checkbox" name="attr_acrobacia_treinada" title="@{acrobacia_treinada}" value="1">
                                <div class="fake-checkbox-status"></div>
                            </label>
                        </div>
                        <div class="skill-name">
                            <button type="roll" name="roll_acrobacia" value="&{template:t20}{{character=@{character_name}}}{{rollname=Acrobacia}}{{theroll=[[1d20+[[@{acrobaciatotal}]]]]}}" class="skill-button">
                                <span>Acrobacia</span>
                            </button>
                        </div>
                        <div class="signal"></div>
                        <input class="total first" name="attr_acrobaciatotal" maxlength="2" type="text" spellcheck="false" title="@{acrobaciatotal}" value="@{metade_do_nivel} + @{acrobaciaatributo2} + @{acrobaciatreino} + @{acrobaciaoutros} -1 * @{penalidades_armadura} -1 * @{penalidades_armadura_carga}" disabled="true">
                        <div class="signal">=</div>
                        <select name="attr_acrobaciaatributo2">
                            <option value="@{for_mod}">FOR</option>
                            <option value="@{des_mod}" selected>DES*</option>
                            <option value="@{con_mod}">CON</option>
                            <option value="@{int_mod}">INT</option>
                            <option value="@{sab_mod}">SAB</option>
                            <option value="@{car_mod}">CAR</option>
                        </select>
                        <div class="signal">+</div>
                        <input name="attr_acrobaciatreino" type="text" spellcheck="false" maxlength="3" title="@{acrobaciatreino}" value="@{bonus_treino}*@{acrobacia_treinada}" disabled="true">
                        <div class="signal">+</div>
                        <input name="attr_acrobaciaoutros" maxlength="3" type="text" spellcheck="false" title="@{acrobaciaoutros}" value="0">
                        
                        <!-- Adestramento -->
                        <div class="signal">
                            <label class="fake-checkbox">
                                <input type="checkbox" name="attr_adestramento_treinada" title="@{adestramento_treinada}" value="1">
                                <div class="fake-checkbox-status"></div>
                            </label>
                        </div>
                        <div class="skill-name">
                            <button type="roll"  name="roll_adestramento" value="&{template:t20}{{character=@{character_name}}}{{rollname=Adestramento}}{{theroll=[[1d20+[[@{adestramentototal}]]]]}}" class="skill-button">
                                <span class="sup-treinada">Adestramento</span>
                            </button>
                        </div>
                        <div class="signal"></div>
                        <input class="total last" name="attr_adestramentototal" maxlength="2" type="text" spellcheck="false" title="@{adestramentototal}" value="@{metade_do_nivel} + @{adestramentoatributo2} + @{adestramentotreino} + @{adestramentooutros}" disabled="true">
                        <div class="signal">=</div>
                        <select name="attr_adestramentoatributo2">
                            <option value="@{for_mod}">FOR</option>
                            <option value="@{des_mod}">DES</option>
                            <option value="@{con_mod}">CON</option>
                            <option value="@{int_mod}">INT</option>
                            <option value="@{sab_mod}">SAB</option>
                            <option value="@{car_mod}" selected>CAR*</option>
                        </select>
                        <div class="signal">+</div>
                        <input name="attr_adestramentotreino" type="text" spellcheck="false" maxlength="3" title="@{adestramentotreino}" value="@{bonus_treino}*@{adestramento_treinada}" disabled="true">
                        <div class="signal">+</div>
                        <input name="attr_adestramentooutros" maxlength="3" type="text" spellcheck="false" title="@{adestramentooutros}" value="0">
                      
                        <!-- Atletismo -->
                        <div class="signal">
                            <label class="fake-checkbox">
                                <input type="checkbox" name="attr_atletismo_treinada" title="@{atletismo_treinada}" value="1">
                                <div class="fake-checkbox-status"></div>
                            </label>
                        </div>
                        <div class="skill-name">
                            <button type="roll"  name="roll_atletismo" value="&{template:t20}{{character=@{character_name}}}{{rollname=Atletismo}}{{theroll=[[1d20+[[@{atletismototal}]]]]}}" class="skill-button">
                                <span>Atletismo</span>
                            </button>
                        </div>
                        <div class="signal"></div>
                        <input class="total last" name="attr_atletismototal" maxlength="2" type="text" spellcheck="false" title="@{atletismototal}" value="@{metade_do_nivel} + @{atletismoatributo2} + @{atletismotreino} + @{atletismooutros}" disabled="true">
                        <div class="signal">=</div>
                        <select name="attr_atletismoatributo2">
                            <option value="@{for_mod}" selected>FOR*</option>
                            <option value="@{des_mod}">DES</option>
                            <option value="@{con_mod}">CON</option>
                            <option value="@{int_mod}">INT</option>
                            <option value="@{sab_mod}">SAB</option>
                            <option value="@{car_mod}">CAR</option>
                        </select>
                        <div class="signal">+</div>
                        <input name="attr_atletismotreino" type="text" spellcheck="false" maxlength="3" title="@{atletismotreino}" value="@{bonus_treino}*@{atletismo_treinada}" disabled="true">
                        <div class="signal">+</div>
                        <input name="attr_atletismooutros" maxlength="3" type="text" spellcheck="false" title="@{atletismooutros}" value="0">

                        <!-- Atuação-->
                        <div class="signal">
                            <label class="fake-checkbox">
                                <input type="checkbox" name="attr_atuacao_treinada" title="@{atuacao_treinada}" value="1">
                                <div class="fake-checkbox-status"></div>
                            </label>
                        </div>
                        <div class="skill-name">
                            <button type="roll" name="roll_atuacao" value="&{template:t20}{{character=@{character_name}}}{{rollname=Atuação}}{{theroll=[[1d20+[[@{atuacaototal}]]]]}}" class="skill-button">
                                <span>Atuação</span>
                            </button>
                        </div>
                        <div class="signal"></div>
                        <input class="total last" name="attr_atuacaototal" maxlength="2" type="text" spellcheck="false" title="@{atuacaototal}" value="@{metade_do_nivel} + @{atuacaoatributo2} + @{atuacaotreino} + @{atuacaooutros}" disabled="true">
                        <div class="signal">=</div>
                        <select name="attr_atuacaoatributo2">
                            <option value="@{for_mod}">FOR</option>
                            <option value="@{des_mod}">DES</option>
                            <option value="@{con_mod}">CON</option>
                            <option value="@{int_mod}">INT</option>
                            <option value="@{sab_mod}">SAB</option>
                            <option value="@{car_mod}" selected>CAR*</option>
                        </select>
                        <div class="signal">+</div>
                        <input name="attr_atuacaotreino" type="text" spellcheck="false" maxlength="3" title="@{atuacaotreino}" value="@{bonus_treino}*@{atuacao_treinada}" disabled="true">
                        <div class="signal">+</div>
                        <input name="attr_atuacaooutros" maxlength="3" type="text" spellcheck="false" title="@{atuacaooutros}" value="0">

                        <!-- Cavalgar -->
                        <div class="signal">
                            <label class="fake-checkbox">
                                <input type="checkbox" name="attr_cavalgar_treinada" title="@{cavalgar_treinada}" value="1">
                                <div class="fake-checkbox-status"></div>
                            </label>
                        </div>
                        <div class="skill-name">
                            <button type="roll" name="roll_cavalgar" value="&{template:t20}{{character=@{character_name}}}{{rollname=Cavalgar}}{{theroll=[[1d20+[[@{cavalgartotal}]]]]}}" class="skill-button">
                                <span>Cavalgar</span>
                            </button>
                        </div>
                        <div class="signal"></div>
                        <input class="total last" name="attr_cavalgartotal" maxlength="2" type="text" spellcheck="false" title="@{cavalgartotal}" value="@{metade_do_nivel} + @{cavalgaratributo2} + @{cavalgartreino} + @{cavalgaroutros}" disabled="true">
                        <div class="signal">=</div>
                        <select name="attr_cavalgaratributo2">
                            <option value="@{for_mod}">FOR</option>
                            <option value="@{des_mod}" selected>DES*</option>
                            <option value="@{con_mod}">CON</option>
                            <option value="@{int_mod}">INT</option>
                            <option value="@{sab_mod}">SAB</option>
                            <option value="@{car_mod}">CAR</option>
                        </select>
                        <div class="signal">+</div>
                        <input name="attr_cavalgartreino" type="text" spellcheck="false" maxlength="3" title="@{cavalgartreino}" value="@{bonus_treino}*@{cavalgar_treinada}" disabled="true">
                        <div class="signal">+</div>
                        <input name="attr_cavalgaroutros" maxlength="3" type="text" spellcheck="false" title="@{cavalgaroutros}" value="0">

                        <!-- Conhecimento -->
                        <div class="signal">
                            <label class="fake-checkbox">
                                <input type="checkbox" name="attr_conhecimento_treinada" title="@{conhecimento_treinada}" value="1">
                                <div class="fake-checkbox-status"></div>
                            </label>
                        </div>
                        <div class="skill-name">
                            <button type="roll" name="roll_conhecimento" value="&{template:t20}{{character=@{character_name}}}{{rollname=Conhecimento}}{{theroll=[[1d20+[[@{conhecimentototal}]]]]}}" class="skill-button">
                                <span class="sup-treinada">Conhecimento</span>
                            </button>
                        </div>
                        <div class="signal"></div>
                        <input class="total last" name="attr_conhecimentototal" maxlength="2" type="text" spellcheck="false" title="@{conhecimentototal}" value="@{metade_do_nivel} + @{conhecimentoatributo2} + @{conhecimentotreino} + @{conhecimentooutros}" disabled="true">
                        <div class="signal">=</div>
                        <select name="attr_conhecimentoatributo2">
                            <option value="@{for_mod}">FOR</option>
                            <option value="@{des_mod}">DES</option>
                            <option value="@{con_mod}">CON</option>
                            <option value="@{int_mod}" selected>INT*</option>
                            <option value="@{sab_mod}">SAB</option>
                            <option value="@{car_mod}">CAR</option>
                        </select>
                        <div class="signal">+</div>
                        <input name="attr_conhecimentotreino" type="text" spellcheck="false" maxlength="3" title="@{conhecimentotreino}" value="@{bonus_treino}*@{conhecimento_treinada}" disabled="true">
                        <div class="signal">+</div>
                        <input name="attr_conhecimentooutros" maxlength="3" type="text" spellcheck="false" title="@{conhecimentooutros}" value="0">


                        <!-- Conjuração -->
                        <div class="signal">
                            <label class="fake-checkbox">
                                <input type="checkbox" name="attr_conjuracao_treinada" title="@{conjuracao_treinada}" value="1">
                                <div class="fake-checkbox-status"></div>
                            </label>
                        </div>
                        <div class="skill-name">
                            <button type="roll" name="roll_conjuracao" value="&{template:t20}{{character=@{character_name}}}{{rollname=Conjuração}}{{theroll=[[1d20+[[@{conjuracaototal}]]]]}}" class="skill-button">
                                <span>Conjuração</span>
                            </button>
                        </div>
                        <div class="signal"></div>
                        <input class="total last" name="attr_conjuracaototal" maxlength="2" type="text" spellcheck="false" title="@{conjuracaototal}" value="@{metade_do_nivel} + @{conjuracaoatributo2} + @{conjuracaotreino} + @{conjuracaooutros}" disabled="true">
                        <div class="signal">=</div>
                        <select name="attr_conjuracaoatributo2">
                            <option value="@{for_mod}">FOR</option>
                            <option value="@{des_mod}">DES</option>
                            <option value="@{con_mod}">CON</option>
                            <option value="@{int_mod}" selected>INT*</option>
                            <option value="@{sab_mod}">SAB</option>
                            <option value="@{car_mod}">CAR</option>
                        </select>
                        <div class="signal">+</div>
                        <input name="attr_conjuracaotreino" type="text" spellcheck="false" maxlength="3" title="@{conjuracaotreino}" value="@{bonus_treino}*@{conjuracao_treinada}" disabled="true">
                        <div class="signal">+</div>
                        <input name="attr_conjuracaooutros" maxlength="3" type="text" spellcheck="false" title="@{conjuracaooutros}" value="0">

                        <!-- Cura -->
                        <div class="signal">
                            <label class="fake-checkbox">
                                <input type="checkbox" name="attr_cura_treinada" title="@{cura_treinada}" value="1">
                                <div class="fake-checkbox-status"></div>
                            </label>
                        </div>
                        <div class="skill-name">
                            <button type="roll" name="roll_cura" value="&{template:t20}{{character=@{character_name}}}{{rollname=Cura}}{{theroll=[[1d20+[[@{curatotal}]]]]}}" class="skill-button">
                                <span>Cura</span>
                            </button>
                        </div>
                        <div class="signal"></div>
                        <input class="total last" name="attr_curatotal" maxlength="2" type="text" spellcheck="false" title="@{curatotal}" value="@{metade_do_nivel} + @{curaatributo2} + @{curatreino} + @{curaoutros}" disabled="true">
                        <div class="signal">=</div>
                        <select name="attr_curaatributo2">
                            <option value="@{for_mod}">FOR</option>
                            <option value="@{des_mod}">DES</option>
                            <option value="@{con_mod}">CON</option>
                            <option value="@{int_mod}">INT</option>
                            <option value="@{sab_mod}" selected>SAB*</option>
                            <option value="@{car_mod}">CAR</option>
                        </select>
                        <div class="signal">+</div>
                        <input name="attr_curatreino" type="text" spellcheck="false" maxlength="3" title="@{curatreino}" value="@{bonus_treino}*@{cura_treinada}" disabled="true">
                        <div class="signal">+</div>
                        <input name="attr_curaoutros" maxlength="3" type="text" spellcheck="false" title="@{curaoutros}" value="0">

                        <!-- Defesa -->
                        <div class="signal">
                            <label class="fake-checkbox">
                                <input type="checkbox" name="attr_defesa_treinada" title="@{defesa_treinada}" value="1">
                                <div class="fake-checkbox-status"></div>
                            </label>
                        </div>
                        <div class="skill-name">
                            <button type="roll" name="roll_defesa" value="&{template:t20}{{character=@{character_name}}}{{rollname=Defesa}}{{theroll=[[1d20+[[@{periciadefesatotal}]]]]}}" class="skill-button">
                                <span>Defesa</span>
                            </button>
                        </div>
                        <div class="signal"></div>
                        <input class="total last" name="attr_periciadefesatotal" maxlength="2" type="text" spellcheck="false" title="@{defesatotal}" value="@{metade_do_nivel} + @{defesaatributo2} + (@{defesaatributo2} * @{tipoarmadura}) + @{defesatreino} + @{defesaoutros}" disabled="true">
                        <div class="signal">=</div>
                        <select name="attr_defesaatributo2">
                            <option value="@{for_mod}">FOR</option>
                            <option value="@{des_mod}" selected>DES*</option>
                            <option value="@{con_mod}">CON</option>
                            <option value="@{int_mod}">INT</option>
                            <option value="@{sab_mod}">SAB</option>
                            <option value="@{car_mod}">CAR</option>
                        </select>
                        <div class="signal">+</div>
                        <input name="attr_defesatreino" type="text" spellcheck="false" maxlength="3" title="@{defesatreino}" value="@{bonus_treino}*@{defesa_treinada}" disabled="true">
                        <div class="signal">+</div>
                        <input name="attr_defesaoutros" maxlength="3" type="text" spellcheck="false" title="@{defesaoutros}" value="@{armaduradefesa1}+@{armaduradefesa2}+@{armaduradefesa3}" disabled="true">

                        <!-- Diplomacia -->
                        <div class="signal">
                            <label class="fake-checkbox">
                                <input type="checkbox" name="attr_diplomacia_treinada" title="@{diplomacia_treinada}" value="1">
                                <div class="fake-checkbox-status"></div>
                            </label>
                        </div>
                        <div class="skill-name">
                            <button type="roll" name="roll_diplomacia" value="&{template:t20}{{character=@{character_name}}}{{rollname=Diplomacia}}{{theroll=[[1d20+[[@{diplomaciatotal}]]]]}}" class="skill-button">
                                <span>Diplomacia</span>
                            </button>
                        </div>
                        <div class="signal"></div>
                        <input class="total last" name="attr_diplomaciatotal" maxlength="2" type="text" spellcheck="false" title="@{diplomaciatotal}" value="@{metade_do_nivel} + @{diplomaciaatributo2} + @{diplomaciatreino} + @{diplomaciaoutros}" disabled="true">
                        <div class="signal">=</div>
                        <select name="attr_diplomaciaatributo2">
                            <option value="@{for_mod}">FOR</option>
                            <option value="@{des_mod}">DES</option>
                            <option value="@{con_mod}">CON</option>
                            <option value="@{int_mod}">INT</option>
                            <option value="@{sab_mod}">SAB</option>
                            <option value="@{car_mod}" selected>CAR*</option>
                        </select>
                        <div class="signal">+</div>
                        <input name="attr_diplomaciatreino" type="text" spellcheck="false" maxlength="3" title="@{diplomaciatreino}" value="@{bonus_treino}*@{diplomacia_treinada}" disabled="true">
                        <div class="signal">+</div>
                        <input name="attr_diplomaciaoutros" maxlength="3" type="text" spellcheck="false" title="@{diplomaciaoutros}" value="0">

                        <!-- Enganação -->
                        <div class="signal">
                            <label class="fake-checkbox">
                                <input type="checkbox" name="attr_enganacao_treinada" title="@{enganacao_treinada}" value="1">
                                <div class="fake-checkbox-status"></div>
                            </label>
                        </div>
                        <div class="skill-name">
                            <button type="roll" name="roll_enganacao" value="&{template:t20}{{character=@{character_name}}}{{rollname=Enganação}}{{theroll=[[1d20+[[@{enganacaototal}]]]]}}" class="skill-button">
                                <span>Enganação</span>
                            </button>
                        </div>
                        <div class="signal"></div>
                        <input class="total last" name="attr_enganacaototal" maxlength="2" type="text" spellcheck="false" title="@{enganacaototal}" value="@{metade_do_nivel} + @{enganacaoatributo2} + @{enganacaotreino} + @{enganacaooutros}" disabled="true">
                        <div class="signal">=</div>
                        <select name="attr_enganacaoatributo2">
                            <option value="@{for_mod}">FOR</option>
                            <option value="@{des_mod}">DES</option>
                            <option value="@{con_mod}">CON</option>
                            <option value="@{int_mod}">INT</option>
                            <option value="@{sab_mod}">SAB</option>
                            <option value="@{car_mod}" selected>CAR*</option>
                        </select>
                        <div class="signal">+</div>
                        <input name="attr_enganacaotreino" type="text" spellcheck="false" maxlength="3" title="@{enganacaotreino}" value="@{bonus_treino}*@{enganacao_treinada}" disabled="true">
                        <div class="signal">+</div>
                        <input name="attr_enganacaooutros" maxlength="3" type="text" spellcheck="false" title="@{enganacaooutros}" value="0">

                        <!-- Fortitude -->
                        <div class="signal">
                            <label class="fake-checkbox">
                                <input type="checkbox" name="attr_fortitude_treinada" title="@{fortitude_treinada}" value="1">
                                <div class="fake-checkbox-status"></div>
                            </label>
                        </div>
                        <div class="skill-name">
                            <button type="roll" name="roll_fortitude" value="&{template:t20}{{character=@{character_name}}}{{rollname=Fortitude}}{{theroll=[[1d20+[[@{fortitudetotal}]]]]}}" class="skill-button">
                                <span>Fortitude</span>
                            </button>
                        </div>
                        <div class="signal"></div>
                        <input class="total last" name="attr_fortitudetotal" maxlength="2" type="text" spellcheck="false" title="@{fortitudetotal}" value="@{metade_do_nivel} + @{fortitudeatributo2} + @{fortitudetreino} + @{fortitudeoutros}" disabled="true">
                        <div class="signal">=</div>
                        <select name="attr_fortitudeatributo2">
                            <option value="@{for_mod}">FOR</option>
                            <option value="@{des_mod}">DES</option>
                            <option value="@{con_mod}" selected>CON*</option>
                            <option value="@{int_mod}">INT</option>
                            <option value="@{sab_mod}">SAB</option>
                            <option value="@{car_mod}">CAR</option>
                        </select>
                        <div class="signal">+</div>
                        <input name="attr_fortitudetreino" type="text" spellcheck="false" maxlength="3" title="@{fortitudetreino}" value="@{bonus_treino}*@{fortitude_treinada}" disabled="true">
                        <div class="signal">+</div>
                        <input name="attr_fortitudeoutros" maxlength="3" type="text" spellcheck="false" title="@{fortitudeoutros}" value="0">

                        <!-- Furtividade -->
                        <div class="signal">
                            <label class="fake-checkbox">
                                <input type="checkbox" name="attr_furtividade_treinada" title="@{furtividade_treinada}" value="1">
                                <div class="fake-checkbox-status"></div>
                            </label>
                        </div>
                        <div class="skill-name">
                            <button type="roll" name="roll_furtividade" value="&{template:t20}{{character=@{character_name}}}{{rollname=Furtividade}}{{theroll=[[1d20+[[@{furtividadetotal}]]]]}}" class="skill-button">
                                <span class="sup-penalidade">Furtividade</span>
                            </button>
                        </div>
                        <div class="signal"></div>
                        <input class="total last" name="attr_furtividadetotal" maxlength="2" type="text" spellcheck="false" title="@{furtividadetotal}" value="@{metade_do_nivel} + @{furtividadeatributo2} + @{furtividadetreino} + @{furtividadeoutros} -1 * @{penalidades_armadura} -1 * @{penalidades_armadura_carga}" disabled="true">
                        <div class="signal">=</div>
                        <select name="attr_furtividadeatributo2">
                            <option value="@{for_mod}">FOR</option>
                            <option value="@{des_mod}" selected>DES*</option>
                            <option value="@{con_mod}">CON</option>
                            <option value="@{int_mod}">INT</option>
                            <option value="@{sab_mod}">SAB</option>
                            <option value="@{car_mod}">CAR</option>
                        </select>
                        <div class="signal">+</div>
                        <input name="attr_furtividadetreino" type="text" spellcheck="false" maxlength="3" title="@{furtividadetreino}" value="@{bonus_treino}*@{furtividade_treinada}" disabled="true">
                        <div class="signal">+</div>
                        <input name="attr_furtividadeoutros" maxlength="3" type="text" spellcheck="false" title="@{furtividadeoutros}" value="0">

                        <!-- Guerra -->
                        <div class="signal">
                            <label class="fake-checkbox">
                                <input type="checkbox" name="attr_guerra_treinada" title="@{guerra_treinada}" value="1">
                                <div class="fake-checkbox-status"></div>
                            </label>
                        </div>
                        <div class="skill-name">
                            <button type="roll" name="roll_guerra" value="&{template:t20}{{character=@{character_name}}}{{rollname=Guerra}}{{theroll=[[1d20+[[@{guerratotal}]]]]}}" class="skill-button">
                                <span class="sup-treinada">Guerra</span>
                            </button>
                        </div>
                        <div class="signal"></div>
                        <input class="total last" name="attr_guerratotal" maxlength="2" type="text" spellcheck="false" title="@{guerratotal}" value="@{metade_do_nivel} + @{guerraatributo2} + @{guerratreino} + @{guerraoutros}" disabled="true">
                        <div class="signal">=</div>
                        <select name="attr_guerraatributo2">
                            <option value="@{for_mod}">FOR</option>
                            <option value="@{des_mod}">DES</option>
                            <option value="@{con_mod}">CON</option>
                            <option value="@{int_mod}" selected>INT*</option>
                            <option value="@{sab_mod}">SAB</option>
                            <option value="@{car_mod}">CAR</option>
                        </select>
                        <div class="signal">+</div>
                        <input name="attr_guerratreino" type="text" spellcheck="false" maxlength="3" title="@{guerratreino}" value="@{bonus_treino}*@{guerra_treinada}" disabled="true">
                        <div class="signal">+</div>
                        <input name="attr_guerraoutros" maxlength="3" type="text" spellcheck="false" title="@{guerraoutros}" value="0">


                        <!-- Iniciativa -->
                        <div class="signal">
                            <label class="fake-checkbox">
                                <input type="checkbox" name="attr_iniciativa_treinada" title="@{iniciativa_treinada}" value="1">
                                <div class="fake-checkbox-status"></div>
                            </label>
                        </div>
                        <div class="skill-name">
                            <button type="roll" name="roll_iniciativa" value="&{template:t20}{{character=@{character_name}}}{{rollname=Iniciativa}}{{theroll=[[1d20+[[@{iniciativatotal}]] &{tracker}]]}}" class="skill-button">
                                <span>Iniciativa</span>
                            </button>
                        </div>
                        <div class="signal"></div>
                        <input class="total last" name="attr_iniciativatotal" maxlength="2" type="text" spellcheck="false" title="@{iniciativatotal}" value="@{metade_do_nivel} + @{iniciativaatributo2} + @{iniciativatreino} + @{iniciativaoutros}" disabled="true">
                        <div class="signal">=</div>
                        <select name="attr_iniciativaatributo2">
                            <option value="@{for_mod}">FOR</option>
                            <option value="@{des_mod}" selected>DES*</option>
                            <option value="@{con_mod}">CON</option>
                            <option value="@{int_mod}">INT</option>
                            <option value="@{sab_mod}">SAB</option>
                            <option value="@{car_mod}">CAR</option>
                        </select>
                        <div class="signal">+</div>
                        <input name="attr_iniciativatreino" type="text" spellcheck="false" maxlength="3" title="@{iniciativatreino}" value="@{bonus_treino}*@{iniciativa_treinada}" disabled="true">
                        <div class="signal">+</div>
                        <input name="attr_iniciativaoutros" maxlength="3" type="text" spellcheck="false" title="@{iniciativaoutros}" value="0">

                        <!-- Intimidação -->
                        <div class="signal">
                            <label class="fake-checkbox">
                                <input type="checkbox" name="attr_intimidacao_treinada" title="@{intimidacao_treinada}" value="1">
                                <div class="fake-checkbox-status"></div>
                            </label>
                        </div>
                        <div class="skill-name">
                            <button type="roll" name="roll_intimidacao" value="&{template:t20}{{character=@{character_name}}}{{rollname=Intimidação}}{{theroll=[[1d20+[[@{intimidacaototal}]]]]}}" class="skill-button">
                                <span>Intimidação</span>
                            </button>
                        </div>
                        <div class="signal"></div>
                        <input class="total last" name="attr_intimidacaototal" maxlength="2" type="text" spellcheck="false" title="@{intimidacaototal}" value="@{metade_do_nivel} + @{intimidacaoatributo2} + @{intimidacaotreino} + @{intimidacaooutros}" disabled="true">
                        <div class="signal">=</div>
                        <select name="attr_intimidacaoatributo2">
                            <option value="@{for_mod}">FOR</option>
                            <option value="@{des_mod}">DES</option>
                            <option value="@{con_mod}">CON</option>
                            <option value="@{int_mod}">INT</option>
                            <option value="@{sab_mod}">SAB</option>
                            <option value="@{car_mod}" selected>CAR*</option>
                        </select>
                        <div class="signal">+</div>
                        <input name="attr_intimidacaotreino" type="text" spellcheck="false" maxlength="3" title="@{intimidacaotreino}" value="@{bonus_treino}*@{intimidacao_treinada}" disabled="true">
                        <div class="signal">+</div>
                        <input name="attr_intimidacaooutros" maxlength="3" type="text" spellcheck="false" title="@{intimidacaooutros}" value="0">

                        <!-- Intuição -->
                        <div class="signal">
                            <label class="fake-checkbox">
                                <input type="checkbox" name="attr_intuicao_treinada" title="@{intuicao_treinada}" value="1">
                                <div class="fake-checkbox-status"></div>
                            </label>
                        </div>
                        <div class="skill-name">
                            <button type="roll" name="roll_intuicao" value="&{template:t20}{{character=@{character_name}}}{{rollname=Intuição}}{{theroll=[[1d20+[[@{intuicaototal}]]]]}}" class="skill-button">
                                <span>Intuição</span>
                            </button>
                        </div>
                        <div class="signal"></div>
                        <input class="total last" name="attr_intuicaototal" maxlength="2" type="text" spellcheck="false" title="@{intuicaototal}" value="@{metade_do_nivel} + @{intuicaoatributo2} + @{intuicaotreino} + @{intuicaooutros}" disabled="true">
                        <div class="signal">=</div>
                        <select name="attr_intuicaoatributo2">
                            <option value="@{for_mod}">FOR</option>
                            <option value="@{des_mod}">DES</option>
                            <option value="@{con_mod}">CON</option>
                            <option value="@{int_mod}">INT</option>
                            <option value="@{sab_mod}" selected>SAB*</option>
                            <option value="@{car_mod}">CAR</option>
                        </select>
                        <div class="signal">+</div>
                        <input name="attr_intuicaotreino" type="text" spellcheck="false" maxlength="3" title="@{intuicaotreino}" value="@{bonus_treino}*@{intuicao_treinada}" disabled="true">
                        <div class="signal">+</div>
                        <input name="attr_intuicaooutros" maxlength="3" type="text" spellcheck="false" title="@{intuicaooutros}" value="0">

                        <!-- Investigação -->
                        <div class="signal">
                            <label class="fake-checkbox">
                                <input type="checkbox" name="attr_investigacao_treinada" title="@{investigacao_treinada}" value="1">
                                <div class="fake-checkbox-status"></div>
                            </label>
                        </div>
                        <div class="skill-name">
                            <button type="roll" name="roll_investigacao" value="&{template:t20}{{character=@{character_name}}}{{rollname=Investigação}}{{theroll=[[1d20+[[@{investigacaototal}]]]]}}" class="skill-button">
                                <span>Investigação</span>
                            </button>
                        </div>
                        <div class="signal"></div>
                        <input class="total last" name="attr_investigacaototal" maxlength="2" type="text" spellcheck="false" title="@{investigacaototal}" value="@{metade_do_nivel} + @{investigacaoatributo2} + @{investigacaotreino} + @{investigacaooutros}" disabled="true">
                        <div class="signal">=</div>
                        <select name="attr_investigacaoatributo2">
                            <option value="@{for_mod}">FOR</option>
                            <option value="@{des_mod}">DES</option>
                            <option value="@{con_mod}">CON</option>
                            <option value="@{int_mod}" selected>INT*</option>
                            <option value="@{sab_mod}">SAB</option>
                            <option value="@{car_mod}">CAR</option>
                        </select>
                        <div class="signal">+</div>
                        <input name="attr_investigacaotreino" type="text" spellcheck="false" maxlength="3" title="@{investigacaotreino}" value="@{bonus_treino}*@{investigacao_treinada}" disabled="true">
                        <div class="signal">+</div>
                        <input name="attr_investigacaooutros" maxlength="3" type="text" spellcheck="false" title="@{investigacaooutros}" value="0">

                        <!-- Jogatina -->
                        <div class="signal">
                            <label class="fake-checkbox">
                                <input type="checkbox" name="attr_jogatina_treinada" title="@{jogatina_treinada}" value="1">
                                <div class="fake-checkbox-status"></div>
                            </label>
                        </div>
                        <div class="skill-name">
                            <button type="roll" name="roll_jogatina" value="&{template:t20}{{character=@{character_name}}}{{rollname=Jogatina}}{{theroll=[[1d20+[[@{jogatinatotal}]]]]}}" class="skill-button">
                                <span class="sup-treinada">Jogatina</span>
                            </button>
                        </div>
                        <div class="signal"></div>
                        <input class="total last" name="attr_jogatinatotal" maxlength="2" type="text" spellcheck="false" title="@{jogatinatotal}" value="@{metade_do_nivel} + @{jogatinaatributo2} + @{jogatinatreino} + @{jogatinaoutros}" disabled="true">
                        <div class="signal">=</div>
                        <select name="attr_jogatinaatributo2">
                            <option value="@{for_mod}">FOR</option>
                            <option value="@{des_mod}">DES</option>
                            <option value="@{con_mod}">CON</option>
                            <option value="@{int_mod}">INT</option>
                            <option value="@{sab_mod}">SAB</option>
                            <option value="@{car_mod}" selected>CAR*</option>
                        </select>
                        <div class="signal">+</div>
                        <input name="attr_jogatinatreino" type="text" spellcheck="false" maxlength="3" title="@{jogatinatreino}" value="@{bonus_treino}*@{jogatina_treinada}" disabled="true">
                        <div class="signal">+</div>
                        <input name="attr_jogatinaoutros" maxlength="3" type="text" spellcheck="false" title="@{jogatinaoutros}" value="0">

                        <!-- Ladinagem -->
                        <div class="signal">
                            <label class="fake-checkbox">
                                <input type="checkbox" name="attr_ladinagem_treinada" title="@{ladinagem_treinada}" value="1">
                                <div class="fake-checkbox-status"></div>
                            </label>
                        </div>
                        <div class="skill-name">
                            <button type="roll" name="roll_ladinagem" value="&{template:t20}{{character=@{character_name}}}{{rollname=Ladinagem}}{{theroll=[[1d20+[[@{ladinagemtotal}]]]]}}" class="skill-button">
                                <span class="sup-treinada-penalidade">Ladinagem</span>
                            </button>
                        </div>
                        <div class="signal"></div>
                        <input class="total last" name="attr_ladinagemtotal" maxlength="2" type="text" spellcheck="false" title="@{ladinagemtotal}" value="@{metade_do_nivel} + @{ladinagematributo2} + @{ladinagemtreino} + @{ladinagemoutros} -1 * @{penalidades_armadura} -1 * @{penalidades_armadura_carga}" disabled="true">
                        <div class="signal">=</div>
                        <select name="attr_ladinagematributo2">
                            <option value="@{for_mod}">FOR</option>
                            <option value="@{des_mod}" selected>DES*</option>
                            <option value="@{con_mod}">CON</option>
                            <option value="@{int_mod}">INT</option>
                            <option value="@{sab_mod}">SAB</option>
                            <option value="@{car_mod}">CAR</option>
                        </select>
                        <div class="signal">+</div>
                        <input name="attr_ladinagemtreino" type="text" spellcheck="false" maxlength="3" title="@{ladinagemtreino}" value="@{bonus_treino}*@{ladinagem_treinada}" disabled="true">
                        <div class="signal">+</div>
                        <input name="attr_ladinagemoutros" maxlength="3" type="text" spellcheck="false" title="@{ladinagemoutros}" value="0">

                        <!-- Luta -->
                        <div class="signal">
                            <label class="fake-checkbox">
                                <input type="checkbox" name="attr_luta_treinada" title="@{luta_treinada}" value="1">
                                <div class="fake-checkbox-status"></div>
                            </label>
                        </div>
                        <div class="skill-name">
                            <button type="roll" name="roll_luta" value="&{template:t20}{{character=@{character_name}}}{{rollname=Luta}}{{theroll=[[1d20+[[@{lutatotal}]]]]}}" class="skill-button">
                                <span>Luta</span>
                            </button>
                        </div>
                        <div class="signal"></div>
                        <input class="total last" name="attr_lutatotal" maxlength="2" type="text" spellcheck="false" title="@{lutatotal}" value="@{metade_do_nivel} + @{lutaatributo2} + @{lutatreino} + @{lutaoutros}" disabled="true">
                        <div class="signal">=</div>
                        <select name="attr_lutaatributo2">
                            <option value="@{for_mod}" selected>FOR*</option>
                            <option value="@{des_mod}">DES</option>
                            <option value="@{con_mod}">CON</option>
                            <option value="@{int_mod}">INT</option>
                            <option value="@{sab_mod}">SAB</option>
                            <option value="@{car_mod}">CAR</option>
                        </select>
                        <div class="signal">+</div>
                        <input name="attr_lutatreino" type="text" spellcheck="false" maxlength="3" title="@{lutatreino}" value="@{bonus_treino}*@{luta_treinada}" disabled="true">
                        <div class="signal">+</div>
                        <input name="attr_lutaoutros" maxlength="3" type="text" spellcheck="false" title="@{lutaoutros}" value="0">
						
                        <!-- Nobreza -->
                        <div class="signal">
                            <label class="fake-checkbox">
                                <input type="checkbox" name="attr_nobreza_treinada" title="@{nobreza_treinada}" value="1">
                                <div class="fake-checkbox-status"></div>
                            </label>
                        </div>
                        <div class="skill-name">
                            <button type="roll" name="roll_nobreza" value="&{template:t20}{{character=@{character_name}}}{{rollname=Nobreza}}{{theroll=[[1d20+[[@{nobrezatotal}]]]]}}" class="skill-button">
                                <span class="sup-treinada">Nobreza</span>
                            </button>
                        </div>
                        <div class="signal"></div>
                        <input class="total last" name="attr_nobrezatotal" maxlength="2" type="text" spellcheck="false" title="@{nobrezatotal}" value="@{metade_do_nivel} + @{nobrezaatributo2} + @{nobrezatreino} + @{nobrezaoutros}" disabled="true">
                        <div class="signal">=</div>
                        <select name="attr_nobrezaatributo2">
                            <option value="@{for_mod}">FOR</option>
                            <option value="@{des_mod}">DES</option>
                            <option value="@{con_mod}">CON</option>
                            <option value="@{int_mod}" selected>INT*</option>
                            <option value="@{sab_mod}">SAB</option>
                            <option value="@{car_mod}">CAR</option>
                        </select>
                        <div class="signal">+</div>
                        <input name="attr_nobrezatreino" type="text" spellcheck="false" maxlength="3" title="@{nobrezatreino}" value="@{bonus_treino}*@{nobreza_treinada}" disabled="true">
                        <div class="signal">+</div>
                        <input name="attr_nobrezaoutros" maxlength="3" type="text" spellcheck="false" title="@{nobrezaoutros}" value="0">

                        <!-- Ocultismo -->
                        <div class="signal">
                            <label class="fake-checkbox">
                                <input type="checkbox" name="attr_misticismo_treinada" title="@{misticismo_treinada}" value="1">
                                <div class="fake-checkbox-status"></div>
                            </label>
                        </div>
                        <div class="skill-name">
                            <button type="roll" name="roll_misticismo" value="&{template:t20}{{character=@{character_name}}}{{rollname=Ocultismo}}{{theroll=[[1d20+[[@{misticismototal}]]]]}}" class="skill-button">
                                <span class="sup-treinada">Ocultismo</span>
                            </button>
                        </div>
                        <div class="signal"></div>
                        <input class="total last" name="attr_misticismototal" maxlength="2" type="text" spellcheck="false" title="@{misticismototal}" value="@{metade_do_nivel} + @{misticismoatributo2} + @{misticismotreino} + @{misticismooutros}" disabled="true">
                        <div class="signal">=</div>
                        <select name="attr_misticismoatributo2">
                            <option value="@{for_mod}">FOR</option>
                            <option value="@{des_mod}">DES</option>
                            <option value="@{con_mod}">CON</option>
                            <option value="@{int_mod}" selected>INT*</option>
                            <option value="@{sab_mod}">SAB</option>
                            <option value="@{car_mod}">CAR</option>
                        </select>
                        <div class="signal">+</div>
                        <input name="attr_misticismotreino" type="text" spellcheck="false" maxlength="3" title="@{misticismotreino}" value="@{bonus_treino}*@{misticismo_treinada}" disabled="true">
                        <div class="signal">+</div>
                        <input name="attr_misticismooutros" maxlength="3" type="text" spellcheck="false" title="@{misticismooutros}" value="0">

                        <!-- Ofício -->
                        <div class="signal">
                            <label class="fake-checkbox">
                                <input type="checkbox" name="attr_oficio_treinada" title="@{oficio_treinada}" value="1">
                                <div class="fake-checkbox-status"></div>
                            </label>
                        </div>
                        <div class="oficio">
                            <button type="roll" name="roll_oficio1" name="roll_oficio1" value="&{template:t20}{{character=@{character_name}}}{{rollname=Ofício @{oficionome}}}{{theroll=[[1d20+[[@{oficiototal}]]]]}}" class="skill-button">
                                <span class="sup-treinada">Ofício</span>
                            </button>
                            <input class="nome-oficio" name="attr_oficionome" type="text" spellcheck="false">
                        </div>
                        <div class="signal"></div>
                        <input class="total last" name="attr_oficiototal" maxlength="2" type="text" spellcheck="false" title="@{oficiototal}" value="@{metade_do_nivel} + @{oficioatributo2} + @{oficiotreino} + @{oficiooutros}" disabled="true">
                        <div class="signal">=</div>
                        <select name="attr_oficioatributo2">
                            <option value="@{for_mod}">FOR</option>
                            <option value="@{des_mod}">DES</option>
                            <option value="@{con_mod}">CON</option>
                            <option value="@{int_mod}" selected>INT*</option>
                            <option value="@{sab_mod}">SAB</option>
                            <option value="@{car_mod}">CAR</option>
                        </select>
                        <div class="signal">+</div>
                        <input name="attr_oficiotreino" type="text" spellcheck="false" maxlength="3" title="@{oficiotreino}" value="@{bonus_treino}*@{oficio_treinada}" disabled="true">
                        <div class="signal">+</div>
                        <input name="attr_oficiooutros" maxlength="3" type="text" spellcheck="false" title="@{oficiooutros}" value="0">

                        <!-- Ofício 2 -->
                        <div class="signal">
                            <label class="fake-checkbox">
                                <input type="checkbox" name="attr_oficio2_treinada" title="@{oficio2_treinada}" value="1">
                                <div class="fake-checkbox-status"></div>
                            </label>
                        </div>
                        <div class="oficio">
                            <button type="roll" name="roll_oficio2" value="&{template:t20}{{character=@{character_name}}}{{rollname=Ofício @{oficio2nome}}}{{theroll=[[1d20+[[@{oficio2total}]]]]}}" class="skill-button">
                                <span class="sup-treinada">Ofício</span>
                            </button>
                            <input class="nome-oficio" name="attr_oficio2nome" type="text" spellcheck="false">
                        </div>
                        <div class="signal"></div>
                        <input class="total last" name="attr_oficio2total" maxlength="2" type="text" spellcheck="false" title="@{oficio2total}" value="@{metade_do_nivel} + @{oficio2atributo2} + @{oficio2treino} + @{oficio2outros}" disabled="true">
                        <div class="signal">=</div>
                        <select name="attr_oficio2atributo2">
                            <option value="@{for_mod}">FOR</option>
                            <option value="@{des_mod}">DES</option>
                            <option value="@{con_mod}">CON</option>
                            <option value="@{int_mod}" selected>INT*</option>
                            <option value="@{sab_mod}">SAB</option>
                            <option value="@{car_mod}">CAR</option>
                        </select>
                        <div class="signal">+</div>
                        <input name="attr_oficio2treino" type="text" spellcheck="false" maxlength="3" title="@{oficio2treino}" value="@{bonus_treino}*@{oficio2_treinada}" disabled="true">
                        <div class="signal">+</div>
                        <input name="attr_oficio2outros" maxlength="3" type="text" spellcheck="false" title="@{oficio2outros}" value="0">

                        <!-- Percepção -->
                        <div class="signal">
                            <label class="fake-checkbox">
                                <input type="checkbox" name="attr_percepcao_treinada" title="@{percepcao_treinada}" value="1">
                                <div class="fake-checkbox-status"></div>
                            </label>
                        </div>
                        <div class="skill-name">
                            <button type="roll" name="roll_percepcao" value="&{template:t20}{{character=@{character_name}}}{{rollname=Percepção}}{{theroll=[[1d20+[[@{percepcaototal}]]]]}}" class="skill-button">
                                <span>Percepção</span>
                            </button>
                        </div>
                        <div class="signal"></div>
                        <input class="total last" name="attr_percepcaototal" maxlength="2" type="text" spellcheck="false" title="@{percepcaototal}" value="@{metade_do_nivel} + @{percepcaoatributo2} + @{percepcaotreino} + @{percepcaooutros}" disabled="true">
                        <div class="signal">=</div>
                        <select name="attr_percepcaoatributo2">
                            <option value="@{for_mod}">FOR</option>
                            <option value="@{des_mod}">DES</option>
                            <option value="@{con_mod}">CON</option>
                            <option value="@{int_mod}">INT</option>
                            <option value="@{sab_mod}" selected>SAB*</option>
                            <option value="@{car_mod}">CAR</option>
                        </select>
                        <div class="signal">+</div>
                        <input name="attr_percepcaotreino" type="text" spellcheck="false" maxlength="3" title="@{percepcaotreino}" value="@{bonus_treino}*@{percepcao_treinada}" disabled="true">
                        <div class="signal">+</div>
                        <input name="attr_percepcaooutros" maxlength="3" type="text" spellcheck="false" title="@{percepcaooutros}" value="0">

                        <!-- Pilotagem -->
                        <div class="signal">
                            <label class="fake-checkbox">
                                <input type="checkbox" name="attr_pilotagem_treinada" title="@{pilotagem_treinada}" value="1">
                                <div class="fake-checkbox-status"></div>
                            </label>
                        </div>
                        <div class="skill-name">
                            <button type="roll" name="roll_pilotagem" value="&{template:t20}{{character=@{character_name}}}{{rollname=Pilotagem}}{{theroll=[[1d20+[[@{pilotagemtotal}]]]]}}" class="skill-button">
                                <span class="sup-treinada">Pilotagem</span>
                            </button>
                        </div>
                        <div class="signal"></div>
                        <input class="total last" name="attr_pilotagemtotal" maxlength="2" type="text" spellcheck="false" title="@{pilotagemtotal}" value="@{metade_do_nivel} + @{pilotagematributo2} + @{pilotagemtreino} + @{pilotagemoutros}" disabled="true">
                        <div class="signal">=</div>
                        <select name="attr_pilotagematributo2">
                            <option value="@{for_mod}">FOR</option>
                            <option value="@{des_mod}" selected>DES*</option>
                            <option value="@{con_mod}">CON</option>
                            <option value="@{int_mod}">INT</option>
                            <option value="@{sab_mod}">SAB</option>
                            <option value="@{car_mod}">CAR</option>
                        </select>
                        <div class="signal">+</div>
                        <input name="attr_pilotagemtreino" type="text" spellcheck="false" maxlength="3" title="@{pilotagemtreino}" value="@{bonus_treino}*@{pilotagem_treinada}" disabled="true">
                        <div class="signal">+</div>
                        <input name="attr_pilotagemoutros" maxlength="3" type="text" spellcheck="false" title="@{pilotagemoutros}" value="0">
                        
                        <!-- Pontaria -->
                        <div class="signal">
                            <label class="fake-checkbox">
                                <input type="checkbox" name="attr_pontaria_treinada" title="@{pontaria_treinada}" value="1">
                                <div class="fake-checkbox-status"></div>
                            </label>
                        </div>
                        <div class="skill-name">
                            <button type="roll" name="roll_pontaria" value="&{template:t20}{{character=@{character_name}}}{{rollname=Pontaria}}{{theroll=[[1d20+[[@{pontariatotal}]]]]}}" class="skill-button">
                                <span>Pontaria</span>
                            </button>
                        </div>
                        <div class="signal"></div>
                        <input class="total last" name="attr_pontariatotal" maxlength="2" type="text" spellcheck="false" title="@{pontariatotal}" value="@{metade_do_nivel} + @{pontariaatributo2} + @{pontariatreino} + @{pontariaoutros}" disabled="true">
                        <div class="signal">=</div>
                        <select name="attr_pontariaatributo2">
                            <option value="@{for_mod}">FOR</option>
                            <option value="@{des_mod}" selected>DES*</option>
                            <option value="@{con_mod}">CON</option>
                            <option value="@{int_mod}">INT</option>
                            <option value="@{sab_mod}">SAB</option>
                            <option value="@{car_mod}">CAR</option>
                        </select>
                        <div class="signal">+</div>
                        <input name="attr_pontariatreino" type="text" spellcheck="false" maxlength="3" title="@{pontariatreino}" value="@{bonus_treino}*@{pontaria_treinada}" disabled="true">
                        <div class="signal">+</div>
                        <input name="attr_pontariaoutros" maxlength="3" type="text" spellcheck="false" title="@{pontariaoutros}" value="0">

                        <!-- Reflexos -->
                        <div class="signal">
                            <label class="fake-checkbox">
                                <input type="checkbox" name="attr_reflexos_treinada" title="@{reflexos_treinada}" value="1">
                                <div class="fake-checkbox-status"></div>
                            </label>
                        </div>
                        <div class="skill-name">
                            <button type="roll" name="roll_reflexos" value="&{template:t20}{{character=@{character_name}}}{{rollname=Reflexos}}{{theroll=[[1d20+[[@{reflexostotal}]]]]}}" class="skill-button">
                                <span>Reflexos</span>
                            </button>
                        </div>
                        <div class="signal"></div>
                        <input class="total last" name="attr_reflexostotal" maxlength="2" type="text" spellcheck="false" title="@{reflexostotal}" value="@{metade_do_nivel} + @{reflexosatributo2} + @{reflexostreino} + @{reflexosoutros}" disabled="true">
                        <div class="signal">=</div>
                        <select name="attr_reflexosatributo2">
                            <option value="@{for_mod}">FOR</option>
                            <option value="@{des_mod}" selected>DES*</option>
                            <option value="@{con_mod}">CON</option>
                            <option value="@{int_mod}">INT</option>
                            <option value="@{sab_mod}">SAB</option>
                            <option value="@{car_mod}">CAR</option>
                        </select>
                        <div class="signal">+</div>
                        <input name="attr_reflexostreino" type="text" spellcheck="false" maxlength="3" title="@{reflexostreino}" value="@{bonus_treino}*@{reflexos_treinada}" disabled="true">
                        <div class="signal">+</div>
                        <input name="attr_reflexosoutros" maxlength="3" type="text" spellcheck="false" title="@{reflexosoutros}" value="0">

                        <!-- Religião -->
                        <div class="signal">
                            <label class="fake-checkbox">
                                <input type="checkbox" name="attr_religiao_treinada" title="@{religiao_treinada}" value="1">
                                <div class="fake-checkbox-status"></div>
                            </label>
                        </div>
                        <div class="skill-name">
                            <button type="roll" name="roll_religiao" value="&{template:t20}{{character=@{character_name}}}{{rollname=Religião}}{{theroll=[[1d20+[[@{religiaototal}]]]]}}" class="skill-button">
                                <span class="sup-treinada">Religião</span>
                            </button>
                        </div>
                        <div class="signal"></div>
                        <input class="total last" name="attr_religiaototal" maxlength="2" type="text" spellcheck="false" title="@{religiaototal}" value="@{metade_do_nivel} + @{religiaoatributo2} + @{religiaotreino} + @{religiaooutros}" disabled="true">
                        <div class="signal">=</div>
                        <select name="attr_religiaoatributo2">
                            <option value="@{for_mod}">FOR</option>
                            <option value="@{des_mod}">DES</option>
                            <option value="@{con_mod}">CON</option>
                            <option value="@{int_mod}">INT</option>
                            <option value="@{sab_mod}" selected>SAB*</option>
                            <option value="@{car_mod}">CAR</option>
                        </select>
                        <div class="signal">+</div>
                        <input name="attr_religiaotreino" type="text" spellcheck="false" maxlength="3" title="@{religiaotreino}" value="@{bonus_treino}*@{religiao_treinada}" disabled="true">
                        <div class="signal">+</div>
                        <input name="attr_religiaooutros" maxlength="3" type="text" spellcheck="false" title="@{religiaooutros}" value="0">

                        <!-- Sobrevivência -->
                        <div class="signal">
                            <label class="fake-checkbox">
                                <input type="checkbox" name="attr_sobrevivencia_treinada" title="@{sobrevivencia_treinada}" value="1">
                                <div class="fake-checkbox-status"></div>
                            </label>
                        </div>
                        <div class="skill-name">
                            <button type="roll" name="roll_sobrevivencia" value="&{template:t20}{{character=@{character_name}}}{{rollname=Sobrevivência}}{{theroll=[[1d20+[[@{sobrevivenciatotal}]]]]}}" class="skill-button">
                                <span>Sobrevivência</span>
                            </button>
                        </div>
                        <div class="signal"></div>
                        <input class="total last" name="attr_sobrevivenciatotal" maxlength="2" type="text" spellcheck="false" title="@{sobrevivenciatotal}" value="@{metade_do_nivel} + @{sobrevivenciaatributo2} + @{sobrevivenciatreino} + @{sobrevivenciaoutros}" disabled="true">
                        <div class="signal">=</div>
                        <select name="attr_sobrevivenciaatributo2">
                            <option value="@{for_mod}">FOR</option>
                            <option value="@{des_mod}">DES</option>
                            <option value="@{con_mod}">CON</option>
                            <option value="@{int_mod}">INT</option>
                            <option value="@{sab_mod}" selected>SAB*</option>
                            <option value="@{car_mod}">CAR</option>
                        </select>
                        <div class="signal">+</div>
                        <input name="attr_sobrevivenciatreino" type="text" spellcheck="false" maxlength="3" title="@{sobrevivenciatreino}" value="@{bonus_treino}*@{sobrevivencia_treinada}" disabled="true">
                        <div class="signal">+</div>
                        <input name="attr_sobrevivenciaoutros" maxlength="3" type="text" spellcheck="false" title="@{sobrevivenciaoutros}" value="0">

                        <!-- Vontade -->
                        <div class="signal">
                            <label class="fake-checkbox">
                                <input type="checkbox" name="attr_vontade_treinada" title="@{vontade_treinada}" value="1">
                                <div class="fake-checkbox-status"></div>
                            </label>
                        </div>
                        <div class="skill-name">
                            <button type="roll" name="roll_vontade" value="&{template:t20}{{character=@{character_name}}}{{rollname=Vontade}}{{theroll=[[1d20+[[@{vontadetotal}]]]]}}" class="skill-button">
                                <span>Vontade</span>
                            </button>
                        </div>
                        <div class="signal"></div>
                        <input class="total last" name="attr_vontadetotal" maxlength="2" type="text" spellcheck="false" title="@{vontadetotal}" value="@{metade_do_nivel} + @{vontadeatributo2} + @{vontadetreino} + @{vontadeoutros}" disabled="true">
                        <div class="signal">=</div>
                        <select name="attr_vontadeatributo2">
                            <option value="@{for_mod}">FOR</option>
                            <option value="@{des_mod}">DES</option>
                            <option value="@{con_mod}">CON</option>
                            <option value="@{int_mod}">INT</option>
                            <option value="@{sab_mod}" selected>SAB*</option>
                            <option value="@{car_mod}">CAR</option>
                        </select>
                        <div class="signal">+</div>
                        <input name="attr_vontadetreino" type="text" spellcheck="false" maxlength="3" title="@{vontadetreino}" value="@{bonus_treino}*@{vontade_treinada}" disabled="true">
                        <div class="signal">+</div>
                        <input name="attr_vontadeoutros" maxlength="3" type="text" spellcheck="false" title="@{vontadeoutros}" value="0">


                        <div class="legenda-pericias">
                            <i>+</i> Penalidade de Armadura 
                            <i>*</i> Somente Treinada
                        </div>


                    </div>
                    <div class="corner top-left"></div>
                    <div class="corner top-right"></div>
                    <div class="corner bottom-left"></div>
                    <div class="corner bottom-right"></div>
                </div>
            </div>
        </div>
        <div class="languages-container">
            <div class="container-negative-corner">
                <div class="inside-negative-corner">
                    <div class="default-title">
                        Idiomas
                    </div>
                    <div class="content-centered">
                        <textarea name="attr_languages"></textarea>
                    </div>
                    <div class="corner top-left"></div>
                    <div class="corner top-right"></div>
                    <div class="corner bottom-left"></div>
                    <div class="corner bottom-right"></div>
                </div>
            </div>
        </div>
        <div class="equipment-container">
            <div class="container-negative-corner">
                <div class="inside-negative-corner">
                    <div class="grid-equipment">
                        <div class="small-title">QTD.</div>
                        <div class="grid-title">Equipamentos</div>
                        <div class="small-title">Peso</div>
                    </div>

                    <fieldset class="repeating_equipment">
                        <div class="grid-equipment">
                            <input name="attr_equipquantity" type="text" spellcheck="false" value="1">
                            <input name="attr_equipname" type="text" spellcheck="false" value="">
                            <input name="attr_equipweight" type="text" spellcheck="false" value="0" >
                        </div>
                    </fieldset>
                    <div class="container-money">
                        <span class="cargaspan">Carga:</span>
                        <input class="cargainput" name="attr_carga" type="text" spellcheck="false" value="0" readonly="1">
                    </div>
                    <div class="container-money">
                        <span>T$:</span>
                        <input name="attr_ts" type="text" spellcheck="false" value="0">
                        <span>P$:</span>
                        <input name="attr_to" type="text" spellcheck="false" value="0">
                        <span>K$:</span>
                        <input name="attr_tk" type="text" spellcheck="false" value="0">
                    </div>
                    <div class="corner top-left"></div>
                    <div class="corner top-right"></div>
                    <div class="corner bottom-left"></div>
                    <div class="corner bottom-right"></div>
                </div>
            </div>
        </div>
    </div>
    <div class="charnotes-container">
        <div class="container-negative-corner">
            <div class="inside-negative-corner">
                <div class="default-title">
                    Anotações
                </div>
                <div class="content-centered">
                    <textarea name="attr_charnotes"></textarea>
                </div>
                <div class="corner top-left"></div>
                <div class="corner top-right"></div>
                <div class="corner bottom-left"></div>
                <div class="corner bottom-right"></div>
            </div>
        </div>
    </div>
</div>
<!-- Bonus de Treino -->
<input type="hidden" name="attr_bonus_treino" value="0" readonly="1">
<input type="hidden" name="attr_penalidades_armadura" value="0" readonly="1">
<input type="hidden" name="attr_penalidades_armadura_carga" value="0" readonly="1">
<input type="hidden" name="attr_metade_do_nivel" value="floor(@{charnivel}/2)">
<!-- <input name="attr_character_name" type="hidden" spellcheck="false"> -->
<input name="attr_charname" type="hidden" spellcheck="false" value=""/>
<input type="hidden" name="attr_vida_max" value="@{vidatotal} + @{vidatemp}" readonly/>
<input type="hidden" name="attr_mana_max" value="@{manatotal} + @{manatemp}" readonly/>
<input name="attr_defesatotal" maxlength="3" type="hidden" value="10" spellcheck="false">




<!-- ROLL TEMPLATES -->

<rolltemplate class="sheet-rolltemplate-t20">
    <div class="sheet-rollbox-container">
        <div class="rollbox">
            <div class="roll-title">
                {{character}}
            </div>
            <div class="roll-result">
                {{theroll}}
            </div>
            <div class="roll-name">
                <span>{{rollname}}</span>
            </div>
        </div>
    </div>
</rolltemplate>


<rolltemplate class="sheet-rolltemplate-t20-attack">
    <div class="sheet-rollbox-container">
        <div class="rollbox">
            {{#character}}
            <div class="roll-title">
                {{character}}
            </div>
            {{/character}}
            <div class="attack-title">
                {{attackname}}
            </div>

            <div>
                <div class="roll">
                    {{attackroll}}
                </div>
                <div class="roll-label">
                    Ataque
                </div>
            </div>
            <div class="divisor"><span></span></div>
            <div>
                {{#^rollWasCrit() attackroll}}
                    <div class="roll">
                        {{damageroll}}
                    </div>
                    <div class="roll-label">
                        Dano
                    </div>
                {{/^rollWasCrit() attackroll}}
                {{#rollWasCrit() attackroll}}
                    <div class="roll">
                        {{criticaldamageroll}}
                    </div>
                    <div class="roll-label">
                        Dano <span class="crit"> (Crítico)</span>
                    </div>
                {{/rollWasCrit() attackroll}}
            </div>

            {{#typeofdamage}}
            <div class="tipo-dano">
                {{typeofdamage}}
            </div>
            {{/typeofdamage}}

            {{#description}}
            <div class="descricao">
                {{description}}
            </div>
            {{/description}}
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-t20-info">
    <div class="sheet-rollbox-container">
        <div class="rollbox">
            <div class="roll-title">
                {{infoname}}
            </div>
            {{#description}}
            <div class="descricao">
                {{description}}
            </div>
            {{/description}}
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-spell">
    <div class="sheet-spell-container">
        <div class="spellbox">
            <div class="roll-title">
                {{character}}
            </div>
            <div class="spell-name">
                {{spellname}}
            </div>
            <div class="spell-grid">
                {{#type}}
                <div class="spell-atribute">
                    <span>Tipo: </span>{{type}}
                </div>
                {{/type}}

                {{#execution}}
                <div class="spell-atribute">
                    <span>Execução: </span>{{execution}}
                </div>
                {{/execution}}

                {{#duration}}
                <div class="spell-atribute">
                    <span>Duração: </span>{{duration}}
                </div>
                {{/duration}}

                {{#range}}
                <div class="spell-atribute">
                    <span>Alcance: </span>{{range}}
                </div>
                {{/range}}

                {{#targetarea}}
                <div class="spell-atribute">
                    <span>Alvo/Área: </span>{{targetarea}}
                </div>
                {{/targetarea}}

                {{#resistance}}
                <div class="spell-atribute">
                    <span>Resistência: </span>{{resistance}} {{#cd}}(CD{{cd}}){{/cd}}
                </div>
                {{/resistance}}

                {{#description}}
                <div class="descricao">
                    {{description}}
                </div>
                {{/description}}
            </div>
        </div>
    </div>
</rolltemplate>


<rolltemplate class="sheet-rolltemplate-custom">
    <div class="sheet-rollbox-container">
        <div class="rollbox">
            <div class="roll-title">
                {{name}}
            </div>
            {{#secondname}}
            <div class="secondname">
                {{secondname}}
            </div>
            {{/secondname}}
            {{#theroll}}
                <div class="props">
                    <div class="content"><b>{{rollname}}</b> {{theroll}}</div>
                </div>
            {{/theroll}}
            {{#rollWasCrit() theroll}}
                {{#ifcritical}}
                    <div class="props">
                        <div class="content"><b>{{criticalname}}</b> {{ifcritical}}</div>
                    </div>
                {{/ifcritical}}
            {{/rollWasCrit() theroll}}
            {{#^rollWasCrit() theroll}}
                {{#ifcriticalerror}}
                    {{#rollWasFumble() theroll}}
                        {{#ifcriticalerror}}
                            <div class="props">
                                <div class="content"><b>{{criticalname}}</b> {{ifcriticalerror}}</div>
                            </div>
                        {{/ifcriticalerror}}
                    {{/rollWasFumble() theroll}}

                    {{#^rollWasFumble() theroll}}
                        {{#notcritical}}
                            <div class="props">
                                <div class="content"><b>{{criticalname}}</b> {{notcritical}}</div>
                            </div>
                        {{/notcritical}}
                    {{/^rollWasFumble() theroll}}
                {{/ifcriticalerror}}

                {{#^ifcriticalerror}}
                    {{#notcritical}}
                        <div class="props">
                            <div class="content"><b>{{criticalname}}</b> {{notcritical}}</div>
                        </div>
                    {{/notcritical}}
                {{/^ifcriticalerror}}


            {{/^rollWasCrit() theroll}}
            <div class="props">
                {{#allprops() name criticalname ifcritical ifcriticalerror description notcritical theroll rollname secondname}}
                   <div class="content"><b>{{key}}</b> {{value}}</div>
                {{/allprops() name criticalname ifcritical ifcriticalerror description notcritical theroll rollname secondname}}
            </div>
            {{#description}}
                <div class="descricao">
                    {{description}}
                </div>
            {{/description}}
        </div>
    </div>
</rolltemplate>



<script type="text/worker">
    //Calculo de modificadores
    var calc_mod = function (valor){
        if(isNaN(valor)){
            return 0;
        }
        return Math.floor((valor - 10) / 2);
    };
    // Stat mods
    ['for', 'des', 'con', 'int', 'sab', 'car'].forEach(stat => {
        on(`sheet:opened change:${stat}`, function(){
            getAttrs([stat], function(v){
                let mod = calc_mod(v[stat] ||10);
                setAttrs({
                    [`${stat}_mod`]: mod 
                });
            }); 
        });
    });

    //Bonus em perícia por nível
    on("sheet:opened change:charnivel", function(e){
        getAttrs(["charnivel"], function(v){
            let nivel = parseInt(v.charnivel);
            let bonusnivel = 0;
            if(nivel >= 15){
                bonusnivel = 6;
            }else if(nivel >= 7){
                bonusnivel = 4;
            }else{
                bonusnivel = 2;
            }
            setAttrs({
                "bonus_treino": bonusnivel 
            });
        }); 
    });

    //Penalidades de Armadura:
    on("sheet:opened change:armadurapenalidade1 change:armadurapenalidade2", function(e){
        getAttrs(["armadurapenalidade1", "armadurapenalidade2"], function(v){
            let penalidade1 = isNaN(v.armadurapenalidade1) ? 0 : v.armadurapenalidade1;
            let penalidade2 = isNaN(v.armadurapenalidade2) ? 0 : v.armadurapenalidade2;

            let total = parseInt(penalidade1) + parseInt(penalidade2);            
            setAttrs({
                "penalidades_armadura": total
            });
        }); 
    });

    //Calculando o dano de um acerto critico
    // removed sheet:opened as its not valid for repeating section workers without a row ID.
    on("change:repeating_attacks:danoataque change:repeating_attacks:multiplicadorcriticoataque", function() {
        getAttrs([
           "repeating_attacks_danoataque",
           "repeating_attacks_multiplicadorcriticoataque"
         ], function(v) {
            let dano = '';
            
            if(typeof v.repeating_attacks_danoataque === 'string'){
                dano = v.repeating_attacks_danoataque;
            }else{
                dano = v.repeating_attacks_danoataque.toString();
            }

            let multiplicador = parseInt(v.repeating_attacks_multiplicadorcriticoataque);
            let resultado = dano;

            for(let i=0; i < multiplicador - 1; i++){
                resultado = resultado + " + " + dano;
            }
                         
            setAttrs({
            "repeating_attacks_danocriticoataque": resultado
            });
        });
     });
     
     //Importador:
     on("sheet:opened", function(e){
        setAttrs({
            "created_by_linki": ""
        });
    });
     on("change:created_by_linki", function(e){
        "use strict";
        getAttrs(["created_by_linki"], function(v){
            try{
                if(!!v.created_by_linki){
                    let data = JSON.parse(v.created_by_linki);
                    if(!!data){
                        let newrowid = generateRowID();
                        newrowid = newrowid.replace(/_/g, "Z");
                        let toadd = {};

                        Object.keys(data).forEach(function(objkey){
                            toadd["repeating_attacks_" + newrowid + "_" + objkey] = data[objkey];
                        });
                        console.log("TO ADD:", toadd);
                        setAttrs(toadd);
                    }
                }
            }catch(e){
                console.error("ops!", e);
            }finally {
                setAttrs({
                    "created_by_linki": ""
                });
            }
        }); 
    });

    //Repeating Sum [https://wiki.roll20.net/RepeatingSum]
    const repeatingSumModified = (destination,section, fields, appendText = '', multiplier = 1) => {
        if (!Array.isArray(fields)) fields = [fields];
        getSectionIDs(`repeating_${section}`, idArray => {
            const attrArray = idArray.reduce( (m,id) => [...m, ...(fields.map(field => `repeating_${section}_${id}_${field}`))],[]);
            getAttrs(["for", ...attrArray], v => {
                console.log("===== values of v: "+ JSON.stringify(v) +" =====");
                     // getValue: if not a number, returns 1 if it is 'on' (checkbox), otherwise returns 0..
                const getValue = (section, id,field) => parseFloat(v[`repeating_${section}_${id}_${field}`]) || (v[`repeating_${section}_${id}_${field}`] === 'on' ? 1 : 0); 
                const sumTotal = idArray.reduce((total, id) => total + fields.reduce((subtotal,field) => subtotal * getValue(section, id,field),1),0);
                
                let cargalimit = 3 * parseInt(v.for);
                let cargamax = 10 * parseInt(v.for);

                let setObj = {}

                let finalTotal = sumTotal * multiplier;

                finalTotal = finalTotal.toString() + appendText;

                setObj['penalidades_armadura_carga'] = 0;

                setObj[destination] = finalTotal;

                if(sumTotal * multiplier > cargalimit){
                    setObj['penalidades_armadura_carga'] = 2;

                    setObj[destination] = finalTotal + "!" ;
                }

                setAttrs(setObj);
            });
        });
    };

    //Calculando carga e seus efeitos:
    on('sheet:opened change:repeating_equipment remove:repeating_equipment', function() {
        repeatingSumModified("carga","equipment",["equipquantity","equipweight"], " kg");        
    });

    /* // Usar para adicionar uma arma ao criar a ficha
    getSectionIDs('repeating_foo', idArray => {
        log(idArray.length); // logs number of repeating rows within repeating_foo
      });
    */


    //Calculando Defesa Total:
    on("sheet:opened change:defesadestreza change:armaduradefesa1 change:armaduradefesa2 change:armaduradefesa3 change:des_mod", function(e){
        getAttrs(["defesadestreza", "armaduradefesa1", "armaduradefesa2", "armaduradefesa3", "des_mod"], function(v){
           
            let total = 10;

            console.error(v);

            //Armadura
            if(!isNaN(v.armaduradefesa1)){
                total = total + parseInt(v.armaduradefesa1);
            }
            //Escudo
            if(!isNaN(v.armaduradefesa2)){
                total = total + parseInt(v.armaduradefesa2);
            }
            //Outros
            if(!isNaN(v.armaduradefesa3)){
                total = total + parseInt(v.armaduradefesa3);
            }
            //Mod de Destreza
            if(!isNaN(v.des_mod) && v.defesadestreza == '1'){
                total = total + parseInt(v.des_mod);
            }

            console.error("total final", total);

            setAttrs({
                "defesatotal": total
            });
        }); 
    });

    //Compatibilidade para o nome (FAZ O BOTÃO DE EDITAR A FICHA SUMIR)
    /*on("sheet:opened", function(e){
        getAttrs(["charname"], function(v){
            
            if(v.charname != '' || v.charname.length < 1){
                let newname = v.charname;            
                setAttrs({
                    "character_name": newname
                });
            }
        }); 
    });*/
    
    ['vida', 'mana'].forEach(max => {
        on(`change:${max}total change:${max}temp`, () => {
            getAttrs([`${max}total`, `${max}temp`], v => {
                const temp = +v[`${max}temp`] || 0;
                const total = +v[`${max}total`] || 0;
                setAttrs({
                    [`${max}_max`]: temp + total
                });
            });
        });
    });
    


</script>




