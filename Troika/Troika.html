
<!-- === SHEET ===-->
<div class="grid-main">
  <!-- Name-->
  <div class="layout layout--stat name">
    <h3 class="u-font-medium u-font-heading" data-i18n="Name">Name</h3>
    <input class="o-input-text u-w100" name="attr_name" type="text"/>
  </div>
  <!-- Background-->
  <div class="layout layout--stat background">
    <h3 class="u-font-medium u-font-heading" data-i18n="Background">Background</h3>
    <input class="o-input-text u-w100" name="attr_background" type="text"/>
  </div>
  <!-- Special-->
  <div class="layout layout--stat special">
    <h3 class="u-font-medium u-font-heading" data-i18n="Special">Special</h3>
    <textarea class="o-input-textarea" name="attr_special" rows="4"></textarea>
  </div>
  <div class="layout stats">
    <div class="grid-stats">
      <!-- Stat - Skill-->
      <div class="layout layout--stat stat-skill">
        <div class="grid-stat">
          <h3 class="grid-stat-item-title u-font-large u-font-heading" data-i18n="Skill">Skill</h3><span class="grid-stat-item-icon u-font-icon u-success">L</span>
          <!-- skill-->
          <div class="grid-stat-item-input u-flex">
            <div class="column">
              <input class="o-input-number o-input-number--large" type="number" name="attr_skill" value="4"/>
            </div>
            <div class="u-flex u-flex-column u-flex-justify-end u-mr-small">
              <button class="button button--mod button--mod-add" type="action" name="act_addSkill"><span>+</span></button>
              <button class="button button--mod button--mod-sub" type="action" name="act_subSkill"><span>-</span></button>
            </div>
          </div>
        </div>
      </div>
      <!-- Stat - Stamina-->
      <div class="layout layout--stat stat-stamina">
        <div class="grid-stat">
          <h3 class="grid-stat-item-title u-font-large u-font-heading" data-i18n="Stamina">Stamina</h3><span class="grid-stat-item-icon u-font-icon u-fail-dark">k</span>
          <div class="grid-stat-item-input u-flex">
            <div class="column">
              <input class="o-input-number o-input-number--large" type="number" name="attr_staminaCurrent" value="14"/>
            </div>
            <div class="u-flex u-flex-column u-flex-justify-end u-mr-small">
              <button class="button button--mod button--mod-add" type="action" name="act_addStamina"><span>+</span></button>
              <button class="button button--mod button--mod-sub" type="action" name="act_subStamina"><span>-</span></button>
            </div>
            <div class="column u-text-center u-mr-small">
              <input class="o-input-number u-gray-dark" type="number" name="attr_stamina" value="14"/><span class="u-block u-font-tiny u-font-heading u-gray-dark">Max</span>
            </div>
          </div>
        </div>
      </div>
      <!-- luck-->
      <div class="layout layout--stat stat-luck">
        <div class="grid-stat">
          <h3 class="u-font-large u-font-heading">Luck</h3><span class="grid-stat-item-icon u-font-icon u-luck">S</span>
          <div class="grid-stat-item-input u-flex">
            <div class="column">
              <input class="o-input-number o-input-number--large" type="number" name="attr_luckCurrent" value="7"/>
            </div>
            <div class="u-flex u-flex-column u-flex-justify-end u-mr-small">
              <button class="button button--mod button--mod-add" type="action" name="act_addLuck"><span>+</span></button>
              <button class="button button--mod button--mod-sub" type="action" name="act_subLuck"><span>-</span></button>
            </div>
            <div class="column u-text-center">
              <input class="o-input-number u-gray-dark" type="number" name="attr_luck" value="7"/><span class="u-block u-font-tiny u-font-heading u-gray-dark" data-i18n="Max">Max</span>
            </div>
          </div>
          <div class="grid-stat-item-footer">
            <button class="button button--roll u-bg-luck" type="roll" name="roll_luckCurrent" value="&{template:troika} {{title=Roll Equal Or Under}} {{subTitle=Luck [@{luckCurrent}]}} {{attribute=[[@{luckCurrent}]]}} {{attributeBase=@{luckCurrent}}} {{luckRoll=[[ [[1d6]] + [[1d6]] ]]}} {{r1=$[[1]]}} {{r2=$[[2]]}}"><span class="button-title">Test Luck</span></button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Adv Skills & Spells-->
  <div class="layout layout--stat skills">
    <div class="layout-heading u-flex u-flex-justify-between">
      <h3 class="u-font-medium u-font-heading" data-i18n="Advanced Skills &amp; Spells">Advanced Skills & Spells</h3>
      <div class="layout-heading-modifier">
        <div class="grid-modifier u-flex u-flex-align-center">
          <h3 class="grid-modifier-title u-font-small u-font-heading u-mr-small" data-i18n="Roll Modifier">Roll Modifier</h3>
          <button class="grid-modifier-sub button button--grid-mod button--grid-mod-sub" type="action" name="act_subSkillRoll"><span>-</span></button>
          <div class="grid-modifier-input">
            <input class="o-input-modifier" type="number" name="attr_skillRollModifier" value="0"/>
          </div>
          <button class="grid-modifier-add button button--grid-mod button--grid-mod-add" type="action" name="act_addSkillRoll"><span>+</span></button>
        </div>
      </div>
    </div>
    <div class="grid-skills sheet-u-font-heading sheet-u-font-small"><span data-i18n="Roll">Roll</span><span data-i18n="Skill/Spell">Skill/Spell</span><span data-i18n="Rank">Rank</span><span data-i18n="Skill + Mod.">Skill + Mod.</span><span class="u-text-center" data-i18n="Total">Total</span><span data-i18n="Success">Success</span></div>
    <fieldset class="repeating_skills">
      <div class="grid-skills">
        <div class="grid-skills-item-buttons u-flex u-flex-align-center">
          <button class="button button--roll" type="roll" name="roll_Under" value="&{template:troika} {{title=Skill Roll: Equal Or Under}} {{subTitle=@{skillName} [@{skillTotal}]}} {{rollModifier=@{skillRollModifier}}} {{attribute=[[@{skillTotal}]]}} {{rollSkillUnder=true}} {{rollSkill=[[ [[1d6]] + [[1d6]] ]]}} {{r1=$[[1]]}} {{r2=$[[2]]}}"><span class="button-title">Under</span></button>
          <button class="button button--roll" type="roll" name="roll_Vs" value="&{template:troika} {{title=Skill Roll: Versus}} {{subTitle=@{skillName} [@{skillTotal}]}} {{rollModifier=@{skillRollModifier}}} {{attribute=[[@{skillTotal}]]}} {{rollSkillVersus=true}} {{rollSkill=[[ [[1d6]] + [[1d6]] + @{skillRank} + @{skillValue}]]}} {{r1=$[[1]]}} {{r2=$[[2]]}}"><span class="button-title">Vs</span></button>
        </div>
        <div class="grid-skills-item-title">
          <input class="skill-name o-input-line" type="text" name="attr_skillName"/>
        </div>
        <div class="grid-skills-item-rank u-flex u-flex-align-center u-flex-justify-between">
          <div class="skill-mod u-text-center">
            <input class="o-input-number" type="number" name="attr_skillRank"/>
          </div><span class="u-block u-font-heading u-font-large">+</span>
        </div>
        <div class="grid-skills-item-skill u-flex u-flex-align-center u-flex-justify-between">
          <div class="skill-mod u-text-center">
            <input class="o-input-number" type="number" name="attr_skillValue" readonly="readonly"/>
          </div><span class="u-block u-font-heading u-font-large">=</span>
        </div>
        <div class="grid-skills-item-total">
          <div class="skill-mod u-text-center">
            <input class="o-input-number" type="number" name="attr_skillTotal" readonly="readonly"/>
          </div>
        </div>
        <div class="grid-skills-success u-flex u-flex-align-center u-flex-justify-center">
          <input class="skill-success o-input-checkbox" type="checkbox" name="attr_skillSuccess"/>
        </div>
      </div>
    </fieldset>
  </div>
  <!-- Weapons-->
  <div class="layout layout--stat weapons">
    <div class="layout-heading u-flex u-flex-justify-between">
      <h3 class="u-font-medium u-font-heading" data-i18n="Weapons">Weapons</h3>
      <div class="layout-heading-modifier">
        <div class="grid-modifier u-flex u-flex-align-center">
          <h3 class="grid-modifier-title u-font-small u-font-heading u-mr-small" data-i18n="Roll Modifier">Roll Modifier</h3>
          <button class="grid-modifier-sub button button--grid-mod button--grid-mod-sub" type="action" name="act_subDamageRoll"><span>-</span></button>
          <div class="grid-modifier-input">
            <input class="o-input-modifier" type="number" name="attr_damageRollModifier" value="0"/>
          </div>
          <button class="grid-modifier-add button button--grid-mod button--grid-mod-add" type="action" name="act_addDamageRoll"><span>+</span></button>
        </div>
      </div>
    </div>
    <div class="grid-weapons sheet-u-font-heading sheet-u-font-small"><span class="grid-weapons-item" data-i18n="Roll">Roll</span><span class="grid-weapons-item" data-i18n="Weapon">Weapon</span><span class="grid-weapons-item u-text-center">1</span><span class="grid-weapons-item u-text-center">2</span><span class="grid-weapons-item u-text-center">3</span><span class="grid-weapons-item u-text-center">4</span><span class="grid-weapons-item u-text-center">5</span><span class="grid-weapons-item u-text-center">6</span><span class="grid-weapons-item u-text-center">7+</span>
    </div>
    <fieldset class="repeating_weapons">
      <div class="grid-weapons">
        <div class="grid-weapons-item u-flex u-flex-align-center">
          <button class="button button--roll" type="roll" name="roll_damage" value="&{template:troika} {{title=Damage}} {{subTitle=@{weapon}}} {{attribute=@{weapon}}} {{rollModifier=@{repDamageRollModifier}}} {{damageRoll=[[[[1d6]] + @{repDamageRollModifier}]]}} {{r1=$[[0]]}} {{wD1=@{weaponDamage1}}} {{wD2=@{weaponDamage2}}} {{wD3=@{weaponDamage3}}} {{wD4=@{weaponDamage4}}} {{wD5=@{weaponDamage5}}} {{wD6=@{weaponDamage6}}} {{wD7=@{weaponDamage7}}}"><span class="button-title">Damage</span></button>
        </div>
        <input class="o-input-line" type="text" name="attr_weapon"/>
        <input class="o-input-line" type="hidden" name="attr_repDamageRollModifier" value="@{damageRollModifier}"/>
        <input class="o-input-number" type="number" name="attr_weaponDamage1"/>
        <input class="o-input-number" type="number" name="attr_weaponDamage2"/>
        <input class="o-input-number" type="number" name="attr_weaponDamage3"/>
        <input class="o-input-number" type="number" name="attr_weaponDamage4"/>
        <input class="o-input-number" type="number" name="attr_weaponDamage5"/>
        <input class="o-input-number" type="number" name="attr_weaponDamage6"/>
        <input class="o-input-number" type="number" name="attr_weaponDamage7"/>
      </div>
    </fieldset>
  </div>
  <!-- Inventory-->
  <div class="layout layout--stat inventory">
    <h3 class="layout-heading u-font-medium u-font-heading" data-i18n="Inventory">Inventory</h3>
    <div class="u-flex">
      <div class="u-w50">
        <div class="u-flex u-flex-align-center"><span class="inventory-index">1</span>
          <input class="o-input-line" type="text" name="attr_inventory1"/>
          <button class="button button--inv" type="roll" name="roll_inventory" value="&{template:troika} {{title=Grabbing}} {{subTitle=@{inventory1}[1]}} {{inventoryIndex=[[1]]}} {{rollInventory=[[ [[1d6]] + [[1d6]] ]]}} {{r1=$[[1]]}} {{r2=$[[2]]}}"><span class="sheet-button-title">Grab</span></button><span class="button button--inv button--inv-move u-hidden"></span>
          <button class="button button--inv button--inv-move" type="action" name="act_inventoryDown1"><span class="u-font-icon">}</span></button>
        </div>
        <div class="u-flex u-flex-align-center"><span class="inventory-index">2</span>
          <input class="o-input-line" type="text" name="attr_inventory2"/>
          <button class="button button--inv" type="roll" name="roll_inventory" value="&{template:troika} {{title=Grabbing}} {{subTitle=@{inventory2}[2]}} {{inventoryIndex=[[2]]}} {{rollInventory=[[ [[1d6]] + [[1d6]] ]]}} {{r1=$[[1]]}} {{r2=$[[2]]}}"><span class="sheet-button-title">Grab</span></button>
          <button class="button button--inv button--inv-move" type="action" name="act_inventoryUp2"><span class="u-font-icon">{</span></button>
          <button class="button button--inv button--inv-move" type="action" name="act_inventoryDown2"><span class="u-font-icon">}</span></button>
        </div>
        <div class="u-flex u-flex-align-center"><span class="inventory-index">3</span>
          <input class="o-input-line" type="text" name="attr_inventory3"/>
          <button class="button button--inv" type="roll" name="roll_inventory" value="&{template:troika} {{title=Grabbing}} {{subTitle=@{inventory3}[3]}} {{inventoryIndex=[[3]]}} {{rollInventory=[[ [[1d6]] + [[1d6]] ]]}} {{r1=$[[1]]}} {{r2=$[[2]]}}"><span class="sheet-button-title">Grab</span></button>
          <button class="button button--inv button--inv-move" type="action" name="act_inventoryUp3"><span class="u-font-icon">{</span></button>
          <button class="button button--inv button--inv-move" type="action" name="act_inventoryDown3"><span class="u-font-icon">}</span></button>
        </div>
        <div class="u-flex u-flex-align-center"><span class="inventory-index">4</span>
          <input class="o-input-line" type="text" name="attr_inventory4"/>
          <button class="button button--inv" type="roll" name="roll_inventory" value="&{template:troika} {{title=Grabbing}} {{subTitle=@{inventory4}[4]}} {{inventoryIndex=[[4]]}} {{rollInventory=[[ [[1d6]] + [[1d6]] ]]}} {{r1=$[[1]]}} {{r2=$[[2]]}}"><span class="sheet-button-title">Grab</span></button>
          <button class="button button--inv button--inv-move" type="action" name="act_inventoryUp4"><span class="u-font-icon">{</span></button>
          <button class="button button--inv button--inv-move" type="action" name="act_inventoryDown4"><span class="u-font-icon">}</span></button>
        </div>
        <div class="u-flex u-flex-align-center"><span class="inventory-index">5</span>
          <input class="o-input-line" type="text" name="attr_inventory5"/>
          <button class="button button--inv" type="roll" name="roll_inventory" value="&{template:troika} {{title=Grabbing}} {{subTitle=@{inventory5}[5]}} {{inventoryIndex=[[5]]}} {{rollInventory=[[ [[1d6]] + [[1d6]] ]]}} {{r1=$[[1]]}} {{r2=$[[2]]}}"><span class="sheet-button-title">Grab</span></button>
          <button class="button button--inv button--inv-move" type="action" name="act_inventoryUp5"><span class="u-font-icon">{</span></button>
          <button class="button button--inv button--inv-move" type="action" name="act_inventoryDown5"><span class="u-font-icon">}</span></button>
        </div>
        <div class="u-flex u-flex-align-center"><span class="inventory-index">6</span>
          <input class="o-input-line" type="text" name="attr_inventory6"/>
          <button class="button button--inv" type="roll" name="roll_inventory" value="&{template:troika} {{title=Grabbing}} {{subTitle=@{inventory6}[6]}} {{inventoryIndex=[[6]]}} {{rollInventory=[[ [[1d6]] + [[1d6]] ]]}} {{r1=$[[1]]}} {{r2=$[[2]]}}"><span class="sheet-button-title">Grab</span></button>
          <button class="button button--inv button--inv-move" type="action" name="act_inventoryUp6"><span class="u-font-icon">{</span></button>
          <button class="button button--inv button--inv-move" type="action" name="act_inventoryDown6"><span class="u-font-icon">}</span></button>
        </div>
      </div>
      <div class="u-w50">
        <div class="u-flex u-flex-align-center"><span class="inventory-index u-inline-block">7</span>
          <input class="o-input-line" type="text" name="attr_inventory7"/>
          <button class="button button--inv" type="roll" name="roll_inventory" value="&{template:troika} {{title=Grabbing}} {{subTitle=@{inventory7}[7]}} {{inventoryIndex=[[7]]}} {{rollInventory=[[ [[1d6]] + [[1d6]] ]]}} {{r1=$[[1]]}} {{r2=$[[2]]}}"><span class="sheet-button-title">Grab</span></button>
          <button class="button button--inv button--inv-move" type="action" name="act_inventoryUp7"><span class="u-font-icon">{</span></button>
          <button class="button button--inv button--inv-move" type="action" name="act_inventoryDown7"><span class="u-font-icon">}</span></button>
        </div>
        <div class="u-flex u-flex-align-center"><span class="inventory-index u-inline-block">8</span>
          <input class="o-input-line" type="text" name="attr_inventory8"/>
          <button class="button button--inv" type="roll" name="roll_inventory" value="&{template:troika} {{title=Grabbing}} {{subTitle=@{inventory8}[8]}} {{inventoryIndex=[[8]]}} {{rollInventory=[[ [[1d6]] + [[1d6]] ]]}} {{r1=$[[1]]}} {{r2=$[[2]]}}"><span class="sheet-button-title">Grab</span></button>
          <button class="button button--inv button--inv-move" type="action" name="act_inventoryUp8"><span class="u-font-icon">{</span></button>
          <button class="button button--inv button--inv-move" type="action" name="act_inventoryDown8"><span class="u-font-icon">}</span></button>
        </div>
        <div class="u-flex u-flex-align-center"><span class="inventory-index u-inline-block">9</span>
          <input class="o-input-line" type="text" name="attr_inventory9"/>
          <button class="button button--inv" type="roll" name="roll_inventory" value="&{template:troika} {{title=Grabbing}} {{subTitle=@{inventory9}[9]}} {{inventoryIndex=[[9]]}} {{rollInventory=[[ [[1d6]] + [[1d6]] ]]}} {{r1=$[[1]]}} {{r2=$[[2]]}}"><span class="sheet-button-title">Grab</span></button>
          <button class="button button--inv button--inv-move" type="action" name="act_inventoryUp9"><span class="u-font-icon">{</span></button>
          <button class="button button--inv button--inv-move" type="action" name="act_inventoryDown9"><span class="u-font-icon">}</span></button>
        </div>
        <div class="u-flex u-flex-align-center"><span class="inventory-index u-inline-block">10</span>
          <input class="o-input-line" type="text" name="attr_inventory10"/>
          <button class="button button--inv" type="roll" name="roll_inventory" value="&{template:troika} {{title=Grabbing}} {{subTitle=@{inventory10}[10]}} {{inventoryIndex=[[10]]}} {{rollInventory=[[ [[1d6]] + [[1d6]] ]]}} {{r1=$[[1]]}} {{r2=$[[2]]}}"><span class="sheet-button-title">Grab</span></button>
          <button class="button button--inv button--inv-move" type="action" name="act_inventoryUp10"><span class="u-font-icon">{</span></button>
          <button class="button button--inv button--inv-move" type="action" name="act_inventoryDown10"><span class="u-font-icon">}</span></button>
        </div>
        <div class="u-flex u-flex-align-center"><span class="inventory-index u-inline-block">11</span>
          <input class="o-input-line" type="text" name="attr_inventory11"/>
          <button class="button button--inv" type="roll" name="roll_inventory" value="&{template:troika} {{title=Grabbing}} {{subTitle=@{inventory11}[11]}} {{inventoryIndex=[[11]]}} {{rollInventory=[[ [[1d6]] + [[1d6]] ]]}} {{r1=$[[1]]}} {{r2=$[[2]]}}"><span class="sheet-button-title">Grab</span></button>
          <button class="button button--inv button--inv-move" type="action" name="act_inventoryUp11"><span class="u-font-icon">{</span></button>
          <button class="button button--inv button--inv-move" type="action" name="act_inventoryDown11"><span class="u-font-icon">}</span></button>
        </div>
        <div class="u-flex u-flex-align-center"><span class="inventory-index u-inline-block">12</span>
          <input class="o-input-line" type="text" name="attr_inventory12"/>
          <button class="button button--inv" type="roll" name="roll_inventory" value="&{template:troika} {{title=Grabbing}} {{subTitle=@{inventory12}[12]}} {{inventoryIndex=[[12]]}} {{rollInventory=[[ [[1d6]] + [[1d6]] ]]}} {{r1=$[[1]]}} {{r2=$[[2]]}}"><span class="sheet-button-title">Grab</span></button>
          <button class="button button--inv button--inv-move" type="action" name="act_inventoryUp12"><span class="u-font-icon">{</span></button><span class="button button--inv button--inv-move u-hidden"></span>
        </div>
      </div>
    </div>
  </div>
  <!-- Wearing-->
  <div class="layout layout--stat wearing">
    <h4 class="layout-heading u-font-medium u-font-heading" data-i18n="Wearing">Wearing</h4>
    <textarea class="o-input-textarea" name="attr_inventory_wearing" rows="6"></textarea>
  </div>
  <!-- Monies-->
  <div class="layout layout--stat monies">
    <h4 class="layout-heading u-font-medium u-font-heading" data-i18n="Monies">Monies</h4>
    <textarea class="o-input-textarea" name="attr_inventory_monies" rows="6"></textarea>
  </div>
  <!-- Provisions-->
  <div class="layout layout--stat provisions">
    <h4 class="layout-heading u-font-medium u-font-heading" data-i18n="Provisions">Provisions</h4>
    <!-- provisions-->
    <div class="grid-provisions">
      <label class="provision">
        <input class="provision-input" type="checkbox" name="attr_provision1"/><span class="checked u-font-icon">3</span>
      </label>
      <label class="provision">
        <input class="provision-input" type="checkbox" name="attr_provision2"/><span class="checked u-font-icon">3</span>
      </label>
      <label class="provision">
        <input class="provision-input" type="checkbox" name="attr_provision3"/><span class="checked u-font-icon">3</span>
      </label>
      <label class="provision">
        <input class="provision-input" type="checkbox" name="attr_provision4"/><span class="checked u-font-icon">3</span>
      </label>
      <label class="provision">
        <input class="provision-input" type="checkbox" name="attr_provision5"/><span class="checked u-font-icon">3</span>
      </label>
      <label class="provision">
        <input class="provision-input" type="checkbox" name="attr_provision6"/><span class="checked u-font-icon">3</span>
      </label>
      <label class="provision">
        <input class="provision-input" type="checkbox" name="attr_provision7"/><span class="checked u-font-icon">3</span>
      </label>
      <label class="provision">
        <input class="provision-input" type="checkbox" name="attr_provision8"/><span class="checked u-font-icon">3</span>
      </label>
      <label class="provision">
        <input class="provision-input" type="checkbox" name="attr_provision9"/><span class="checked u-font-icon">3</span>
      </label>
      <label class="provision">
        <input class="provision-input" type="checkbox" name="attr_provision10"/><span class="checked u-font-icon">3</span>
      </label>
      <label class="provision">
        <input class="provision-input" type="checkbox" name="attr_provision11"/><span class="checked u-font-icon">3</span>
      </label>
      <label class="provision">
        <input class="provision-input" type="checkbox" name="attr_provision12"/><span class="checked u-font-icon">3</span>
      </label>
      <label class="provision">
        <input class="provision-input" type="checkbox" name="attr_provision13"/><span class="checked u-font-icon">3</span>
      </label>
      <label class="provision">
        <input class="provision-input" type="checkbox" name="attr_provision14"/><span class="checked u-font-icon">3</span>
      </label>
      <label class="provision">
        <input class="provision-input" type="checkbox" name="attr_provision15"/><span class="checked u-font-icon">3</span>
      </label>
      <label class="provision">
        <input class="provision-input" type="checkbox" name="attr_provision16"/><span class="checked u-font-icon">3</span>
      </label>
      <label class="provision">
        <input class="provision-input" type="checkbox" name="attr_provision17"/><span class="checked u-font-icon">3</span>
      </label>
      <label class="provision">
        <input class="provision-input" type="checkbox" name="attr_provision18"/><span class="checked u-font-icon">3</span>
      </label>
      <label class="provision">
        <input class="provision-input" type="checkbox" name="attr_provision19"/><span class="checked u-font-icon">3</span>
      </label>
      <label class="provision">
        <input class="provision-input" type="checkbox" name="attr_provision20"/><span class="checked u-font-icon">3</span>
      </label>
    </div>
  </div>
  <!-- Footer-->
  <div class="layout footer u-text-right">
    <input name="attr_version" value="v1.03" type="hidden"/><span class="u-font-tiny" name="attr_version"></span>
  </div>
</div>
<rolltemplate class="sheet-rolltemplate-troika">
  <div class="sheet-template-container">{{  #luckRoll  }}
    <!-- Header - Luck-->
    <div class="sheet-template-header sheet-template-header--luck">
      <div class="sheet-title">{{ title }}</div>
      <div class="sheet-subtitle">{{ subTitle }}</div>
    </div>{{  /luckRoll  }}
    {{  #damageRoll  }}
    <!-- Header - Damage-->
    <div class="sheet-template-header sheet-template-header--damage">
      <div class="sheet-title">{{ title }}</div>
      <div class="sheet-subtitle">{{ subTitle }}</div>
    </div>{{  /damageRoll  }}
    {{  #rollSkill  }}
    <!-- Header - Skill-->
    <div class="sheet-template-header sheet-template-header--skill">
      <div class="sheet-title">{{ title }}</div>
      <div class="sheet-subtitle">{{ subTitle }}</div>
    </div>{{  /rollSkill  }}
    {{  #rollModifier  }}
    <div class="sheet-title"><span data-i18n="Roll Modifier:">Roll Modifier:</span>{{ rollModifier }}</div>{{  /rollModifier  }}
    {{  #rollInventory  }}
    <!-- Header - Inventory-->
    <div class="sheet-template-header sheet-template-header--inventory">
      <div class="sheet-title">{{ title }}</div>
      <div class="sheet-subtitle">{{ subTitle }}</div>
    </div>{{  /rollInventory  }}
    <!-- Row (Body)-->
    <div class="sheet-template-row">
      <!-- Dice-->
      <div class="sheet-template-dice">
{{#rollTotal() r1 1}}a{{/rollTotal() r1 1}}
{{#rollTotal() r1 2}}b{{/rollTotal() r1 2}}
{{#rollTotal() r1 3}}c{{/rollTotal() r1 3}}
{{#rollTotal() r1 4}}d{{/rollTotal() r1 4}}
{{#rollTotal() r1 5}}e{{/rollTotal() r1 5}}
{{#rollTotal() r1 6}}f{{/rollTotal() r1 6}}
{{#rollTotal() r2 1}}a{{/rollTotal() r2 1}}
{{#rollTotal() r2 2}}b{{/rollTotal() r2 2}}
{{#rollTotal() r2 3}}c{{/rollTotal() r2 3}}
{{#rollTotal() r2 4}}d{{/rollTotal() r2 4}}
{{#rollTotal() r2 5}}e{{/rollTotal() r2 5}}
{{#rollTotal() r2 6}}f{{/rollTotal() r2 6}}{{  #luckRoll  }}<span class="sheet-template-dice-total"> = {{luckRoll}}</span>{{  /luckRoll  }}
        {{  #rollSkillUnder  }}<span class="sheet-template-dice-total"> = {{rollSkill}}</span>{{  /rollSkillUnder  }}
        {{  #rollInventory  }}<span class="sheet-template-dice-total"> = {{rollInventory}}</span>{{  /rollInventory  }}
      </div>
    </div>{{  #damageRoll  }}
    <!-- Footer Damage-->
    <div class="sheet-template-footer sheet-template-footer--fail">
      <div class="sheet-template-total">{{#rollLess() damageRoll 1}}Roll: 1 Damage: {{wD1}}{{/rollLess() damageRoll 1}}
{{#rollTotal() damageRoll 1}}Roll: 1 Damage: {{wD1}}{{/rollTotal() damageRoll 1}}
{{#rollTotal() damageRoll 2}}Roll: 2 Damage: {{wD2}}{{/rollTotal() damageRoll 2}}
{{#rollTotal() damageRoll 3}}Roll: 3 Damage: {{wD3}}{{/rollTotal() damageRoll 3}}
{{#rollTotal() damageRoll 4}}Roll: 4 Damage: {{wD4}}{{/rollTotal() damageRoll 4}}
{{#rollTotal() damageRoll 5}}Roll: 5 Damage: {{wD5}}{{/rollTotal() damageRoll 5}}
{{#rollTotal() damageRoll 6}}Roll: 6 Damage: {{wD6}}{{/rollTotal() damageRoll 6}}
{{#rollGreater() damageRoll 6}}Roll: 7+ Damage: {{wD7}}{{/rollGreater() damageRoll 6}}

      </div>
    </div>{{  /damageRoll  }}
    {{  #luckRoll  }}
    <!-- Footer Luck-->{{  #^rollGreater() luckRoll attribute  }}
    <div class="sheet-template-footer sheet-template-footer--success">
      <div class="sheet-template-total" data-i18n="Success">Success</div>
    </div>{{  /^rollGreater() luckRoll attribute  }}
    {{  #rollGreater() luckRoll attribute  }}
    <div class="sheet-template-footer sheet-template-footer--fail">
      <div class="sheet-template-total">Fail</div>
    </div>{{  /rollGreater() luckRoll attribute  }}
    <!-- Note-->
    <div class="sheet-template-note">
      <div class="sheet-title" data-i18n="Nt: Reduce Luck by 1">Nt: Reduce Luck by 1</div>
    </div>{{  /luckRoll  }}
    {{  #rollSkillUnder  }}
    <!-- Footer Skill Under-->{{  #^rollGreater() rollSkill attribute  }}
    <div class="sheet-template-footer sheet-template-footer--success">
      <div class="sheet-template-total" data-i18n="Success">Success</div>
    </div>{{  /^rollGreater() rollSkill attribute  }}
    {{  #rollGreater() rollSkill attribute  }}
    <div class="sheet-template-footer sheet-template-footer--fail">
      <div class="sheet-template-total" data-i18n="Fail">Fail</div>
    </div>{{  /rollGreater() rollSkill attribute  }}
    {{  /rollSkillUnder  }}
    {{  #rollSkillVersus  }}
    <div class="sheet-template-footer sheet-template-footer--success">
      <div class="sheet-template-row-head" data-i18n="Total">Total
        <div class="sheet-template-total"></div>
      </div>
      <div class="sheet-template-total">{{rollSkill}}</div>
      <!-- Skill Vs: Fumble-->{{  #rollTotal() r1 1  }}{{  #rollTotal() r2 1  }}
      <div class="sheet-template-row-head" data-i18n="Fumble!">Fumble!</div>{{  /rollTotal() r2 1  }}{{  /rollTotal() r1 1  }}
      <!-- Skill Vs: Mighty blow-->{{  #rollTotal() r1 6  }}{{  #rollTotal() r2 6  }}
      <div class="sheet-template-row-head" data-i18n="Mighty Blow!">Mighty Blow!</div>{{  /rollTotal() r2 6  }}{{  /rollTotal() r1 6  }}
    </div>{{  /rollSkillVersus  }}
    {{  #rollInventory  }}
    <!-- Footer - Inventory (Fumble on 2 otherwise roll higher or equal than inv slot)-->{{  #rollTotal() rollInventory 2  }}
    <div class="sheet-template-footer sheet-template-footer--fail">
      <div class="sheet-template-total" data-i18n="Oops: Critical Fumble">Oops: Critical Fumble</div>
    </div>{{  /rollTotal() rollInventory 2  }}
    {{  #rollGreater() rollInventory 2  }}
    {{  #^rollLess() rollInventory inventoryIndex  }}
    <div class="sheet-template-footer sheet-template-footer--success">
      <div class="sheet-template-total" data-i18n="Grabbed">Grabbed</div>
    </div>{{  /^rollLess() rollInventory inventoryIndex  }}
    {{  #rollLess() rollInventory inventoryIndex  }}
    <div class="sheet-template-footer sheet-template-footer--fail">
      <div class="sheet-template-total" data-i18n="Fumble">Fumble</div>
    </div>{{  /rollLess() rollInventory inventoryIndex  }}
    {{  /rollGreater() rollInventory 2  }}
    {{  /rollInventory  }}
  </div>
</rolltemplate>
<!-- === WORKERS ===-->
<script type="text/worker">// When the skill changes we need to update the SkillRollTotal
on('change:skill', (e) => {
    getAttrs(["skillRollModifier"], (v) => {
        const skillRollModifier = (v.skillRollModifier === undefined) ? 0 : v.skillRollModifier;
        const newValue = (e.newValue === undefined) ? 0 : e.newValue;
        setAttrs({ skillRollTotal: Number(skillRollModifier) + Number(newValue) });
    });
});

// When the skillRollModifier changes we need to update the SkillRollTotal
on('change:skillRollModifier', (e) => {
    getAttrs(["skill"], (v) => {
        const skill = (v.skill === undefined) ? 0 : v.skill;
        const newValue = (e.newValue === undefined) ? 0 : e.newValue;
        setAttrs({ skillRollTotal: Number(skill) + Number(newValue) });
    });
});

// When the skillRollTotal changes Update the Adv Skill Rows
on('change:skillRollTotal', (e) => {
    getSectionIDs('repeating_skills', rowids => {
        const newValue = (e.newValue === undefined) ? 0 : e.newValue;
        const output = {};
        rowids.forEach(id => output[`repeating_skills_${id}_skillValue`] = Number(newValue));
        setAttrs(output);
    });
});

// When skills repeating row skillRank changes update the Total
on("change:repeating_skills:skillRank", (e) => {
    getAttrs(["repeating_skills_skillValue", "skillRollTotal"], (v) => {
        const skillRollTotal = (v.skillRollTotal === undefined) ? 0 : v.skillRollTotal;
        const newValue = (e.newValue === undefined) ? 0 : e.newValue;
        const output = {};
        output["repeating_skills_skillValue"] = Number(skillRollTotal);
        output["repeating_skills_skillTotal"] = Number(skillRollTotal) + Number(newValue);
        setAttrs(output);
    })
});

// When skills repeating row skillValue changes update the Total
on("change:repeating_skills:skillValue", (e) => {
    getAttrs(["repeating_skills_skillRank"], (v) => {
        const skillRank = (v.repeating_skills_skillRank === undefined) ? 0 : v.repeating_skills_skillRank;
        const newValue = (e.newValue === undefined) ? 0 : e.newValue;
        const output = {};
        output["repeating_skills_skillTotal"] = Number(skillRank) + Number(newValue);
        setAttrs(output);
    })
});

// Button Click: Add/Remove Skill
on("clicked:addSkill", () => {
    getAttrs(["skill"], (v) => {
        setAttrs({ skill: Number(v.skill)+1 });
    });
});
on("clicked:subSkill", () => {
    getAttrs(["skill"], (v) => {
        setAttrs({ skill: Math.max(0, Number(v.skill)-1) });
    });
});
// Button Click: Add/Remove Skill Modifier
on("clicked:addSkillRoll", () => {
    getAttrs(["skillRollModifier"], (v) => {
        setAttrs({ skillRollModifier: Number(v.skillRollModifier)+1 });
    });
});
on("clicked:subSkillRoll", () => {
    getAttrs(["skillRollModifier"], (v) => {
        setAttrs({ skillRollModifier: Number(v.skillRollModifier)-1 });
    });
});
// Button Click: Add/Remove Damage Modifier
on("clicked:addDamageRoll", () => {
    getAttrs(["damageRollModifier"], (v) => {
        const damageRollModifier = (v.damageRollModifier === undefined) ? 0 : v.damageRollModifier;
        setAttrs({ damageRollModifier: Number(damageRollModifier)+1 });
    });
});
on("clicked:subDamageRoll", () => {
    getAttrs(["damageRollModifier"], (v) => {
        const damageRollModifier = (v.damageRollModifier === undefined) ? 0 : v.damageRollModifier;
        setAttrs({ damageRollModifier: Number(damageRollModifier)-1 });
    });
});
// Button Click: Add/Remove Stamina
on("clicked:addStamina", () => {
    getAttrs(["stamina", "staminaCurrent"], (v) => {
        setAttrs({ staminaCurrent: Math.min(Number(v.staminaCurrent)+1, Number(v.stamina)) });
    });
});
on("clicked:subStamina", () => {
    getAttrs(["stamina", "staminaCurrent"], (v) => {
        setAttrs({ staminaCurrent: Math.max(0, Number(v.staminaCurrent)-1) });
    });
});
// Button Click: Add/Remove Luck
on("clicked:addLuck", () => {
    getAttrs(["luck", "luckCurrent"], (v) => {
        setAttrs({ luckCurrent: Math.min(Number(v.luckCurrent)+1, Number(v.luck)) });
    });
});
on("clicked:subLuck", () => {
    getAttrs(["luck", "luckCurrent"], (v) => {
        setAttrs({ luckCurrent: Math.max(0, Number(v.luckCurrent)-1) });
    });
});

// Button Click: Inventory Move Up Down
let buttonList = [];
for (let idx = 1; idx <= 12; idx++) {
    buttonList.push(`inventory${idx}`);
    on(`clicked:inventoryDown${idx}`, () => {
        getAttrs(buttonList, (e) => {
            const currentIdx = idx;
            const copyToIdx = currentIdx+1;
            const invCurrent = "inventory"+currentIdx;
            const InvTo = "inventory"+copyToIdx;
            const objAttrs = {[invCurrent]: e[InvTo], [InvTo]: e[invCurrent]}
            setAttrs(objAttrs);
        });
    });
    on(`clicked:inventoryUp${idx}`, () => {
        getAttrs(buttonList, (e) => {
            const currentIdx = idx;
            const copyToIdx = currentIdx-1;
            const invCurrent = "inventory"+currentIdx;
            const InvTo = "inventory"+copyToIdx;
            const objAttrs = {[invCurrent]: e[InvTo], [InvTo]: e[invCurrent]}
            setAttrs(objAttrs);
        });
    });
}

</script>




