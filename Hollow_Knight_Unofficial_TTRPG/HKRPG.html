<input type="hidden" class="sheet-tabstoggle" name="attr_sheetTab"  value="character"  />
      
<div>
    <button type="action" name="act_page1">#1 Main Page</button>
    <button type="action" name="act_casting">#2 Spell Casting</button>
    <button type="action" name="act_page3">#3 Storage & Skills</button>
    <button type="action" name="act_page5">#4 Resting & Bio</button>
    <button type="action" name="act_modifiers">Mod: Base Character</button>
    <button type="action" name="act_page2">Mod: Paths & SEs</button>
    <button type="action" name="act_modifiersweapon">Mod: Weapons & Armor</button>
    <button type="action" name="act_traits">Mod: Traits</button>
</div>

    
<div class="sheet-page5">
<div class="container4">

  <div class="image4">
      <img src="https://i.imgur.com/xJ9ZvLS.png" alt="sheet"></div>

  <div class="name">
      <input type="text" name="attr_name" style="width: 211px;"></div>

  <div class="majadv">
      <input type="text" name="attr_majadv" min="0" value="1" style="width: 43px;"></div>
  <div class="minadv">
      <input type="text" name="attr_minadv" min="1" value="0" style="width: 34px;"></div>

  <div class="sizeradio1">
      <input type="radio" name="attr_sizeradio" value="1" style=""></div>
  <div class="sizeradio2">
      <input type="radio" name="attr_sizeradio" value="2" style="" checked></div>
  <div class="sizeradio3">
      <input type="radio" name="attr_sizeradio" value="3" style=""></div>

  <div class="bellymax2">
      <input type="text" name="attr_bellymax" min="0" style="width: 33px;"></div>
  <div class="belly2">
      <input type="number" name="attr_belly" min="-100" style="width: 71px; font-size:30px;"></div>

  <div class="geo">
      <input type="number" name="attr_geo" min="0" style="width: 65px;"></div>

  <div class="restingtype">
    <select name="attr_restingtype" id="wgtmsrrrbr">
      <option value="1" style="width: 33px;">Rest</option>
      <option value="2" style="width: 33px;">Break</option>
    </select>
  </div>
  <div class="sleep">
      <button type="action" name="act_sleep">Sleep</button></div>
  <div class="losebelly">
      <button type="action" name="act_losebelly">Lose Belly</button></div>

  <div class="traits">
      <textarea name="attr_traits" rows="30" cols="43" style="width: 288px; height: 328px;"></textarea></div>
  <div class="bio">
      <textarea name="attr_bio" rows="30" cols="43" style="width: 288px; height: 238px;"></textarea></div>
  <div class="notes">
      <textarea name="attr_notes" rows="30" cols="43" style="width: 288px; height: 293px;"></textarea></div>
  <div class="story">
      <textarea name="attr_story" rows="30" cols="43" style="width: 288px; height: 330px;"></textarea></div>

</div>
</div>



<div class="sheet-casting">
<div class="container2">

  <div class="image2">
      <img src="https://i.imgur.com/ph1WaLh.png" alt="sheet"></div>

  <div class="maxdiff">
      <input type="text" name="attr_maxdiff" style="width: 33px;" readonly></div>

  <div class="quickcost">
      <input type="text" name="attr_quickcost" style="width: 33px;" readonly></div>
  <p><div class="attuneradio">
      <input type="radio" name="attr_attuneradio" value="1" style="" checked>&nbsp;Attuned&nbsp;&nbsp;&nbsp;
      <input type="radio" name="attr_attuneradio" value="0" style="">&nbsp;Ritual</div></p>

  <div class="extrarng">
    <select name="attr_extrarng" id="wgtmsr">
      <option value="0" style="display:none; width: 33px;">Range</option>
      <option value="0" style="width: 33px;"></option>
      <option value="1" style="width: 33px;">Self</option>
      <option value="2" style="width: 33px;">Touch</option>
      <option value="3" style="width: 33px;">Close</option>
      <option value="4" style="width: 33px;">Far</option>
      <option value="5" style="width: 33px;">Sense</option>
    </select>
  </div>

  <div class="extradura">
    <select name="attr_extradura" id="wgtmsrr">
      <option value="0" style="display:none; width: 33px;">Duration</option>
      <option value="0" style="width: 33px;"></option>
      <option value="1" style="width: 33px;">Concentration</option>
      <option value="2" style="width: 33px;">Brief</option>
      <option value="3" style="width: 33px;">Scene</option>
      <option value="4" style="width: 33px;">Scenes</option>
      <option value="5" style="width: 33px;">Rests</option>
      <option value="6" style="width: 33px;">Lifetime</option>
      <option value="7" style="width: 33px;">Eternal</option>
    </select>
  </div>

  <div class="spelldmghealplus">
      <input type="number" name="attr_dmghealplus" min="0" style="width: 35px;"></div>
  <div class="spellsplit">
      <input type="checkbox" name="attr_spellsplit" value="1" style="width: 33px;"></div>
  <div class="spellexpand">
      <input type="checkbox" name="attr_spellexpand" value="1" style="width: 33px;"></div>
  <div class="spellconjur">
      <input type="checkbox" name="attr_spellconjur" value="1" style="width: 33px;"></div>

  <div class="spellgroup2">
  <div class="spellcover">
      <input type="number" name="attr_spellcover" min="0" max="0.75" step="0.25" style="width: 50px;"></div>
  <div class="spellgrapple">
      <input type="checkbox" name="attr_spellgrapple" value="1" style="width: 33px;"></div>
  <div class="spellsqueeze">
      <input type="checkbox" name="attr_spellsqueeze" value="1" style="width: 33px;"></div>
  <div class="spellunseen">
      <input type="checkbox" name="attr_spellunseen" value="1" style="width: 33px;"></div>
  </div>

  <div class="spelltype">
    <select name="attr_spelltype" id="wgtmsrrr">
      <option value="1" style="width: 33px;">Willing Target</option>
      <option value="2" style="width: 33px;">Attack Roll</option>
      <option value="3" style="width: 33px;">Spell Save</option>
    </select>
  </div>
  <div class="spellatt">
    <select name="attr_spellatt" id="wgtmsr">
      <option value="1" style="width: 33px;">Insight</option>
      <option value="2" style="width: 33px;">Might</option>
      <option value="3" style="width: 33px;">Grace</option>
    </select>
  </div>
  <div class="defspellsave">
      <button type="action" name="act_defspellsave">R</button></div>

  <div class="spellfinalattack">
      <input type="text" name="attr_spellfinalattack" style="width: 33px;" readonly></div>
  <div class="spellfinalrange">
      <input type="text" name="attr_spellfinalrange" style="width: 33px;" readonly></div>
  <div class="spellfinaldmgheal">
      <input type="text" name="attr_spellfinaldmgheal" style="width: 33px;" readonly></div>
  <div class="spellfinaldura">
      <input type="text" name="attr_spellfinaldura" style="width: 33px;" readonly></div>

  <div class="spellfinalcost">
      <input type="text" name="attr_spellfinalcost" style="width: 43px;" readonly></div>
  <div class="cast">
      <button type="action" name="act_cast">Cast!</button></div>
  <div class="currentspell">
    <select name="attr_spellradio" id="wgtmsrrrr">
      <option value="1" style="width: 33px;">Spell #1</option>
      <option value="2" style="width: 33px;">Spell #2</option>
      <option value="3" style="width: 33px;">Spell #3</option>
      <option value="4" style="width: 33px;">Spell #4</option>
      <option value="5" style="width: 33px;">Spell #5</option>
    </select>
  </div>

<div class="listspell1">

  <div class="spell1">
      <input type="text" name="attr_spell1"></div>
  <div class="diff1">
      <input type="text" name="attr_diff1" style="width: 33px;"></div>
  <div class="dmgheal1">
      <input type="text" name="attr_dmgheal1" style="width: 33px;"></div>

  <div class="splpath1">
    <select name="attr_splpath1" id="wgtmsrrrr">
      <option value="0" style="width: 33px;">Spell Path</option>
      <option value="9" style="width: 33px;">Spire</option>
      <option value="10" style="width: 33px;">Cloak</option>
      <option value="11" style="width: 33px;">Dream</option>
      <option value="12" style="width: 33px;">Nightmare</option>
      <option value="13" style="width: 33px;">Bloom</option>
      <option value="14" style="width: 33px;">Thorn</option>
      <option value="15" style="width: 33px;">Dust</option>
    </select>
  </div>
  <div class="splrng1">
    <select name="attr_splrng1" id="wgtmsr">
      <option value="0" style="width: 33px;">Range</option>
      <option value="9" style="width: 33px;"></option>
      <option value="1" style="width: 33px;">Self</option>
      <option value="2" style="width: 33px;">Touch</option>
      <option value="3" style="width: 33px;">Close</option>
      <option value="4" style="width: 33px;">Far</option>
      <option value="5" style="width: 33px;">Sense</option>
    </select>
  </div>
  <div class="spldura1">
    <select name="attr_spldura1" id="wgtmsrr">
      <option value="0" style="width: 33px;">Duration</option>
      <option value="9" style="width: 33px;"></option>
      <option value="1" style="width: 33px;">Concentration</option>
      <option value="2" style="width: 33px;">Brief</option>
      <option value="3" style="width: 33px;">Scene</option>
      <option value="4" style="width: 33px;">Scenes</option>
      <option value="5" style="width: 33px;">Rests</option>
      <option value="6" style="width: 33px;">Lifetime</option>
      <option value="7" style="width: 33px;">Eternal</option>
    </select>
  </div>

</div>

<div class="listspell2">

  <div class="spell2">
      <input type="text" name="attr_spell2"></div>
  <div class="diff2">
      <input type="text" name="attr_diff2" style="width: 33px;"></div>
  <div class="dmgheal2">
      <input type="text" name="attr_dmgheal2" style="width: 33px;"></div>

  <div class="splpath2">
    <select name="attr_splpath2" id="wgtmsrrrr">
      <option value="0" style="width: 33px;"></option>
      <option value="9" style="width: 33px;">Spire</option>
      <option value="10" style="width: 33px;">Cloak</option>
      <option value="11" style="width: 33px;">Dream</option>
      <option value="12" style="width: 33px;">Nightmare</option>
      <option value="13" style="width: 33px;">Bloom</option>
      <option value="14" style="width: 33px;">Thorn</option>
      <option value="15" style="width: 33px;">Dust</option>
    </select>
  </div>

  <div class="splrng2">
    <select name="attr_splrng2" id="wgtmsr">
      <option value="0" style="width: 33px;"></option>
      <option value="1" style="width: 33px;">Self</option>
      <option value="2" style="width: 33px;">Touch</option>
      <option value="3" style="width: 33px;">Close</option>
      <option value="4" style="width: 33px;">Far</option>
      <option value="5" style="width: 33px;">Sense</option>
    </select>
  </div>

  <div class="spldura2">
    <select name="attr_spldura2" id="wgtmsrr">
      <option value="0" style="width: 33px;"></option>
      <option value="1" style="width: 33px;">Concentration</option>
      <option value="2" style="width: 33px;">Brief</option>
      <option value="3" style="width: 33px;">Scene</option>
      <option value="4" style="width: 33px;">Scenes</option>
      <option value="5" style="width: 33px;">Rests</option>
      <option value="6" style="width: 33px;">Lifetime</option>
      <option value="7" style="width: 33px;">Eternal</option>
    </select>
  </div>

</div>

<div class="listspell3">

  <div class="spell3">
      <input type="text" name="attr_spell3"></div>
  <div class="diff3">
      <input type="text" name="attr_diff3" style="width: 33px;"></div>
  <div class="dmgheal3">
      <input type="text" name="attr_dmgheal3" style="width: 33px;"></div>

  <div class="splpath3">
    <select name="attr_splpath3" id="wgtmsrrrr">
      <option value="0" style="width: 33px;"></option>
      <option value="9" style="width: 33px;">Spire</option>
      <option value="10" style="width: 33px;">Cloak</option>
      <option value="11" style="width: 33px;">Dream</option>
      <option value="12" style="width: 33px;">Nightmare</option>
      <option value="13" style="width: 33px;">Bloom</option>
      <option value="14" style="width: 33px;">Thorn</option>
      <option value="15" style="width: 33px;">Dust</option>
    </select>
  </div>

  <div class="splrng3">
    <select name="attr_splrng3" id="wgtmsr">
      <option value="0" style="width: 33px;"></option>
      <option value="1" style="width: 33px;">Self</option>
      <option value="2" style="width: 33px;">Touch</option>
      <option value="3" style="width: 33px;">Close</option>
      <option value="4" style="width: 33px;">Far</option>
      <option value="5" style="width: 33px;">Sense</option>
    </select>
  </div>

  <div class="spldura3">
    <select name="attr_spldura3" id="wgtmsrr">
      <option value="0" style="width: 33px;"></option>
      <option value="1" style="width: 33px;">Concentration</option>
      <option value="2" style="width: 33px;">Brief</option>
      <option value="3" style="width: 33px;">Scene</option>
      <option value="4" style="width: 33px;">Scenes</option>
      <option value="5" style="width: 33px;">Rests</option>
      <option value="6" style="width: 33px;">Lifetime</option>
      <option value="7" style="width: 33px;">Eternal</option>
    </select>
  </div>

</div>

<div class="listspell4">

  <div class="spell4">
      <input type="text" name="attr_spell4"></div>
  <div class="diff4">
      <input type="text" name="attr_diff4" style="width: 33px;"></div>
  <div class="dmgheal4">
      <input type="text" name="attr_dmgheal4" style="width: 33px;"></div>

  <div class="splpath4">
    <select name="attr_splpath4" id="wgtmsrrrr">
      <option value="0" style="width: 33px;"></option>
      <option value="9" style="width: 33px;">Spire</option>
      <option value="10" style="width: 33px;">Cloak</option>
      <option value="11" style="width: 33px;">Dream</option>
      <option value="12" style="width: 33px;">Nightmare</option>
      <option value="13" style="width: 33px;">Bloom</option>
      <option value="14" style="width: 33px;">Thorn</option>
      <option value="15" style="width: 33px;">Dust</option>
    </select>
  </div>

  <div class="splrng4">
    <select name="attr_splrng4" id="wgtmsr">
      <option value="0" style="width: 33px;"></option>
      <option value="1" style="width: 33px;">Self</option>
      <option value="2" style="width: 33px;">Touch</option>
      <option value="3" style="width: 33px;">Close</option>
      <option value="4" style="width: 33px;">Far</option>
      <option value="5" style="width: 33px;">Sense</option>
    </select>
  </div>

  <div class="spldura4">
    <select name="attr_spldura4" id="wgtmsrr">
      <option value="0" style="width: 33px;"></option>
      <option value="1" style="width: 33px;">Concentration</option>
      <option value="2" style="width: 33px;">Brief</option>
      <option value="3" style="width: 33px;">Scene</option>
      <option value="4" style="width: 33px;">Scenes</option>
      <option value="5" style="width: 33px;">Rests</option>
      <option value="6" style="width: 33px;">Lifetime</option>
      <option value="7" style="width: 33px;">Eternal</option>
    </select>
  </div>

</div>

<div class="listspell5">

  <div class="spell5">
      <input type="text" name="attr_spell5"></div>
  <div class="diff5">
      <input type="text" name="attr_diff5" style="width: 33px;"></div>
  <div class="dmgheal5">
      <input type="text" name="attr_dmgheal5" style="width: 33px;"></div>

  <div class="splpath5">
    <select name="attr_splpath5" id="wgtmsrrrr">
      <option value="0" style="width: 33px;"></option>
      <option value="9" style="width: 33px;">Spire</option>
      <option value="10" style="width: 33px;">Cloak</option>
      <option value="11" style="width: 33px;">Dream</option>
      <option value="12" style="width: 33px;">Nightmare</option>
      <option value="13" style="width: 33px;">Bloom</option>
      <option value="14" style="width: 33px;">Thorn</option>
      <option value="15" style="width: 33px;">Dust</option>
    </select>
  </div>

  <div class="splrng5">
    <select name="attr_splrng5" id="wgtmsr">
      <option value="0" style="width: 33px;"></option>
      <option value="1" style="width: 33px;">Self</option>
      <option value="2" style="width: 33px;">Touch</option>
      <option value="3" style="width: 33px;">Close</option>
      <option value="4" style="width: 33px;">Far</option>
      <option value="5" style="width: 33px;">Sense</option>
    </select>
  </div>

  <div class="spldura5">
    <select name="attr_spldura5" id="wgtmsrr">
      <option value="0" style="width: 33px;"></option>
      <option value="1" style="width: 33px;">Concentration</option>
      <option value="2" style="width: 33px;">Brief</option>
      <option value="3" style="width: 33px;">Scene</option>
      <option value="4" style="width: 33px;">Scenes</option>
      <option value="5" style="width: 33px;">Rests</option>
      <option value="6" style="width: 33px;">Lifetime</option>
      <option value="7" style="width: 33px;">Eternal</option>
    </select>
  </div>

</div>

</div>
</div>


<div class="sheet-page2">

<div>
<h2>Paths List</h2>
<h4>Do not choose the same path twice! Might cause issues. (will make it look better later)</h4>
</div>

<div class="path1">
<select name="attr_path1" id="wgtmsrrrr">
    <option value="0" style="width: 33px;">[Empty]</option>
    <option value="1" style="width: 33px;">Nail</option>
    <option value="2" style="width: 33px;">Needle</option>
    <option value="3" style="width: 33px;">Tusk</option>
    <option value="4" style="width: 33px;">Hook</option>
    <option value="5" style="width: 33px;">Maw</option>
    <option value="6" style="width: 33px;">Shell</option>
    <option value="7" style="width: 33px;">Sling</option>
    <option value="8" style="width: 33px;">Flask</option>
    <option value="9" style="width: 33px;">Spire</option>
    <option value="10" style="width: 33px;">Cloak</option>
    <option value="11" style="width: 33px;">Dream</option>
    <option value="12" style="width: 33px;">Nightmare</option>
    <option value="13" style="width: 33px;">Bloom</option>
    <option value="14" style="width: 33px;">Thorn</option>
    <option value="15" style="width: 33px;">Dust</option>
</select>
&nbsp;
<input type="number" name="attr_pathbox1" min="0" max="3" style="width: 40px;"></div>


<div class="path2">
<select name="attr_path2" id="wgtmsrrrr">
    <option value="0" style="width: 33px;">[Empty]</option>
    <option value="1" style="width: 33px;">Nail</option>
    <option value="2" style="width: 33px;">Needle</option>
    <option value="3" style="width: 33px;">Tusk</option>
    <option value="4" style="width: 33px;">Hook</option>
    <option value="5" style="width: 33px;">Maw</option>
    <option value="6" style="width: 33px;">Shell</option>
    <option value="7" style="width: 33px;">Sling</option>
    <option value="8" style="width: 33px;">Flask</option>
    <option value="9" style="width: 33px;">Spire</option>
    <option value="10" style="width: 33px;">Cloak</option>
    <option value="11" style="width: 33px;">Dream</option>
    <option value="12" style="width: 33px;">Nightmare</option>
    <option value="13" style="width: 33px;">Bloom</option>
    <option value="14" style="width: 33px;">Thorn</option>
    <option value="15" style="width: 33px;">Dust</option>
</select>
&nbsp;
<input type="number" name="attr_pathbox2" min="0" max="3" style="width: 40px;"></div>

<div class="path3">
<select name="attr_path3" id="wgtmsrrrr">
    <option value="0" style="width: 33px;">[Empty]</option>
    <option value="1" style="width: 33px;">Nail</option>
    <option value="2" style="width: 33px;">Needle</option>
    <option value="3" style="width: 33px;">Tusk</option>
    <option value="4" style="width: 33px;">Hook</option>
    <option value="5" style="width: 33px;">Maw</option>
    <option value="6" style="width: 33px;">Shell</option>
    <option value="7" style="width: 33px;">Sling</option>
    <option value="8" style="width: 33px;">Flask</option>
    <option value="9" style="width: 33px;">Spire</option>
    <option value="10" style="width: 33px;">Cloak</option>
    <option value="11" style="width: 33px;">Dream</option>
    <option value="12" style="width: 33px;">Nightmare</option>
    <option value="13" style="width: 33px;">Bloom</option>
    <option value="14" style="width: 33px;">Thorn</option>
    <option value="15" style="width: 33px;">Dust</option>
</select>
&nbsp;
<input type="number" name="attr_pathbox3" min="0" max="3" style="width: 40px;"></div>

<div class="path4">
<select name="attr_path4" id="wgtmsrrrr">
    <option value="0" style="width: 33px;">[Empty]</option>
    <option value="1" style="width: 33px;">Nail</option>
    <option value="2" style="width: 33px;">Needle</option>
    <option value="3" style="width: 33px;">Tusk</option>
    <option value="4" style="width: 33px;">Hook</option>
    <option value="5" style="width: 33px;">Maw</option>
    <option value="6" style="width: 33px;">Shell</option>
    <option value="7" style="width: 33px;">Sling</option>
    <option value="8" style="width: 33px;">Flask</option>
    <option value="9" style="width: 33px;">Spire</option>
    <option value="10" style="width: 33px;">Cloak</option>
    <option value="11" style="width: 33px;">Dream</option>
    <option value="12" style="width: 33px;">Nightmare</option>
    <option value="13" style="width: 33px;">Bloom</option>
    <option value="14" style="width: 33px;">Thorn</option>
    <option value="15" style="width: 33px;">Dust</option>
</select>
&nbsp;
<input type="number" name="attr_pathbox4" min="0" max="3" style="width: 40px;"></div>

<div class="path5">
<select name="attr_path5" id="wgtmsrrrr">
    <option value="0" style="width: 33px;">[Empty]</option>
    <option value="1" style="width: 33px;">Nail</option>
    <option value="2" style="width: 33px;">Needle</option>
    <option value="3" style="width: 33px;">Tusk</option>
    <option value="4" style="width: 33px;">Hook</option>
    <option value="5" style="width: 33px;">Maw</option>
    <option value="6" style="width: 33px;">Shell</option>
    <option value="7" style="width: 33px;">Sling</option>
    <option value="8" style="width: 33px;">Flask</option>
    <option value="9" style="width: 33px;">Spire</option>
    <option value="10" style="width: 33px;">Cloak</option>
    <option value="11" style="width: 33px;">Dream</option>
    <option value="12" style="width: 33px;">Nightmare</option>
    <option value="13" style="width: 33px;">Bloom</option>
    <option value="14" style="width: 33px;">Thorn</option>
    <option value="15" style="width: 33px;">Dust</option>
</select>
&nbsp;
<input type="number" name="attr_pathbox5" min="0" max="3" style="width: 40px;"></div>

<div class="path6">
<select name="attr_path6" id="wgtmsrrrr">
    <option value="0" style="width: 33px;">[Empty]</option>
    <option value="1" style="width: 33px;">Nail</option>
    <option value="2" style="width: 33px;">Needle</option>
    <option value="3" style="width: 33px;">Tusk</option>
    <option value="4" style="width: 33px;">Hook</option>
    <option value="5" style="width: 33px;">Maw</option>
    <option value="6" style="width: 33px;">Shell</option>
    <option value="7" style="width: 33px;">Sling</option>
    <option value="8" style="width: 33px;">Flask</option>
    <option value="9" style="width: 33px;">Spire</option>
    <option value="10" style="width: 33px;">Cloak</option>
    <option value="11" style="width: 33px;">Dream</option>
    <option value="12" style="width: 33px;">Nightmare</option>
    <option value="13" style="width: 33px;">Bloom</option>
    <option value="14" style="width: 33px;">Thorn</option>
    <option value="15" style="width: 33px;">Dust</option>
</select>
&nbsp;
<input type="number" name="attr_pathbox6" min="0" max="3" style="width: 40px;"></div>


<br>

    <h2>Status Effect Automation</h2>
    <h3>SE #1</h3>

 <div class="se1auto">
<select name="attr_se1autodrop" id="wgtmsrr">
    <option value="0" style="width: 33px;">[Blank]</option>
    <option value="1" style="width: 33px;">Might</option>
    <option value="2" style="width: 33px;">Insight</option>
    <option value="3" style="width: 33px;">Shell</option>
    <option value="4" style="width: 33px;">Grace</option>
    <option value="5" style="width: 33px;">All Primary Attributes</option>
    <option value="6" style="width: 33px;">Heart</option>
    <option value="7" style="width: 33px;">Soul</option>
    <option value="8" style="width: 33px;">Stamina</option>
    <option value="9" style="width: 33px;">Speed</option>
    <option value="10" style="width: 33px;">DR</option>
    <option value="11" style="width: 33px;">Enviro. Damage</option>
</select>

&nbsp;<input type="checkbox" name="attr_se1attrcheck" value="1" style="">&nbsp;&nbsp;Click if applying just to rolls, not the Attribute number. (ex: +1 to shell rolls, or +1 to shell score)

</div>


      <p><input type="number" name="attr_se1autoenumber" value="1" style="width: 37px;">&nbsp;Base Amount for Effect <b>[default is 1]</b></p>
      <p><input type="number" name="attr_se1autorepeat" min="0" style="width: 37px;">&nbsp;Points per Effect being Multiplied (zero if not applicable)</p>
      <p><input type="checkbox" name="attr_se1lock" value="1" style="">&nbsp;&nbsp;Lock SE counter {WIP}</p>


<br>
    <h3>SE #2</h3>

 <div class="se2auto">
<select name="attr_se2autodrop" id="wgtmsrr">
    <option value="0" style="width: 33px;">[Blank]</option>
    <option value="1" style="width: 33px;">Might</option>
    <option value="2" style="width: 33px;">Insight</option>
    <option value="3" style="width: 33px;">Shell</option>
    <option value="4" style="width: 33px;">Grace</option>
    <option value="5" style="width: 33px;">All Primary Attributes</option>
    <option value="6" style="width: 33px;">Heart</option>
    <option value="7" style="width: 33px;">Soul</option>
    <option value="8" style="width: 33px;">Stamina</option>
    <option value="9" style="width: 33px;">Speed</option>
    <option value="10" style="width: 33px;">DR</option>
    <option value="11" style="width: 33px;">Enviro. Damage</option>
</select>

&nbsp;<input type="checkbox" name="attr_se2attrcheck" value="1" style="">&nbsp;&nbsp;Click if applying just to rolls, not the Attribute number. (ex: +1 to shell rolls, or +1 to shell score)



      <p><input type="number" name="attr_se2autoenumber" value="1" style="width: 37px;">&nbsp;Base Amount for Effect <b>[default is 1]</b></p>
      <p><input type="number" name="attr_se2autorepeat" min="0" style="width: 37px;">&nbsp;Points per Effect being Multiplied (zero if not applicable)</p>
      <p><input type="checkbox" name="attr_se2lock" value="1" style="">&nbsp;&nbsp;Lock SE counter {WIP}</p>
</div>


<br>
    <h3>SE #3</h3>

 <div class="se3auto">
<select name="attr_se3autodrop" id="wgtmsrr">
    <option value="0" style="width: 33px;">[Blank]</option>
    <option value="1" style="width: 33px;">Might</option>
    <option value="2" style="width: 33px;">Insight</option>
    <option value="3" style="width: 33px;">Shell</option>
    <option value="4" style="width: 33px;">Grace</option>
    <option value="5" style="width: 33px;">All Primary Attributes</option>
    <option value="6" style="width: 33px;">Heart</option>
    <option value="7" style="width: 33px;">Soul</option>
    <option value="8" style="width: 33px;">Stamina</option>
    <option value="9" style="width: 33px;">Speed</option>
    <option value="10" style="width: 33px;">DR</option>
    <option value="11" style="width: 33px;">Enviro. Damage</option>
</select>

&nbsp;<input type="checkbox" name="attr_se3attrcheck" value="1" style="">&nbsp;&nbsp;Click if applying just to rolls, not the Attribute number. (ex: +1 to shell rolls, or +1 to shell score)

</div>


      <p><input type="number" name="attr_se3autoenumber" value="1" style="width: 37px;">&nbsp;Base Amount for Effect <b>[default is 1]</b></p>
      <p><input type="number" name="attr_se3autorepeat" min="0" style="width: 37px;">&nbsp;Points per Effect being Multiplied (zero if not applicable)</p>
      <p><input type="checkbox" name="attr_se3lock" value="1" style="">&nbsp;&nbsp;Lock SE counter {WIP}</p>
</div>


<div class="sheet-page3">
<div class="container3">

<div class="image">
    <img src="https://i.imgur.com/FBu7iGW.png" alt="sheet"></div>

  <div class="techslot">
      <input type="text" name="attr_techslot" style="width: 27px;" readonly></div>

  <div class="artarc1">
      <input type="text" name="attr_artarc1" style="width: 273px;"></div>
  <div class="artarc1check">
      <input type="checkbox" name="attr_artarc1check" value="1" style=""></div>
  <div class="artarc2">
      <input type="text" name="attr_artarc2" style="width: 273px;"></div>
  <div class="artarc2check">
      <input type="checkbox" name="attr_artarc2check" value="1" style=""></div>   
  <div class="artarc3">
      <input type="text" name="attr_artarc3" style="width: 273px;"></div>
  <div class="artarc3check">
      <input type="checkbox" name="attr_artarc3check" value="1" style=""></div>
  <div class="artarc4">
      <input type="text" name="attr_artarc4" style="width: 273px;"></div>
  <div class="artarc4check">
      <input type="checkbox" name="attr_artarc4check" value="1" style=""></div>
  <div class="artarc5">
      <input type="text" name="attr_artarc5" style="width: 273px;"></div>
  <div class="artarc5check">
      <input type="checkbox" name="attr_artarc5check" value="1" style=""></div>
  <div class="artarc6">
      <input type="text" name="attr_artarc6" style="width: 273px;"></div>
  <div class="artarc6check">
      <input type="checkbox" name="attr_artarc6check" value="1" style=""></div>
  <div class="artarc7">
      <input type="text" name="attr_artarc7" style="width: 273px;"></div>
  <div class="artarc7check">
      <input type="checkbox" name="attr_artarc7check" value="1" style=""></div>
  <div class="artarc8">
      <input type="text" name="attr_artarc8" style="width: 273px;"></div>
  <div class="artarc8check">
      <input type="checkbox" name="attr_artarc8check" value="1" style=""></div>

  <div class="eqmnt1">
      <input type="text" name="attr_eqmnt1" style="width: 278px;"></div>
  <div class="eqmnt1load">
      <input type="text" name="attr_eqmnt1load" style="width: 27px;"></div>
  <div class="eqmnt2">
      <input type="text" name="attr_eqmnt2" style="width: 278px;"></div>
  <div class="eqmnt2load">
      <input type="text" name="attr_eqmnt2load" style="width: 27px;"></div>
  <div class="eqmnt3">
      <input type="text" name="attr_eqmnt3" style="width: 278px;"></div>
  <div class="eqmnt3load">
      <input type="text" name="attr_eqmnt3load" style="width: 27px;"></div>
  <div class="eqmnt4">
      <input type="text" name="attr_eqmnt4" style="width: 278px;"></div>
  <div class="eqmnt4load">
      <input type="text" name="attr_eqmnt4load" style="width: 27px;"></div>
  <div class="eqmnt5">
      <input type="text" name="attr_eqmnt5" style="width: 278px;"></div>
  <div class="eqmnt5load">
      <input type="text" name="attr_eqmnt5load" style="width: 27px;"></div>
  <div class="eqmnt6">
      <input type="text" name="attr_eqmnt6" style="width: 278px;"></div>
  <div class="eqmnt6load">
      <input type="text" name="attr_eqmnt6load" style="width: 27px;"></div>
  <div class="eqmnt7">
      <input type="text" name="attr_eqmnt7" style="width: 278px;"></div>
  <div class="eqmnt7load">
      <input type="text" name="attr_eqmnt7load" style="width: 27px;"></div>
  <div class="eqmnt8">
      <input type="text" name="attr_eqmnt8" style="width: 278px;"></div>
  <div class="eqmnt8load">
      <input type="text" name="attr_eqmnt8load" style="width: 27px;"></div>
  <div class="eqmnt9">
      <input type="text" name="attr_eqmnt9" style="width: 278px;"></div>
  <div class="eqmnt9load">
      <input type="text" name="attr_eqmnt9load" style="width: 27px;"></div>
  <div class="eqmnt10">
      <input type="text" name="attr_eqmnt10" style="width: 278px;"></div>
  <div class="eqmnt10load">
      <input type="text" name="attr_eqmnt10load" style="width: 27px;"></div>

  <div class="charmnotchmax">
      <input type="text" name="attr_charmnotchmax" style="width: 27px;"></div>

  <div class="charm1">
      <input type="text" name="attr_charm1" style="width: 240px;"></div>
  <div class="charm1notch">
      <input type="text" name="attr_charm1notch" style="width: 27px;"></div>
  <div class="charm2">
      <input type="text" name="attr_charm2" style="width: 240px;"></div>
  <div class="charm2notch">
      <input type="text" name="attr_charm2notch" style="width: 27px;"></div>
  <div class="charm3">
      <input type="text" name="attr_charm3" style="width: 240px;"></div>
  <div class="charm3notch">
      <input type="text" name="attr_charm3notch" style="width: 27px;"></div>
  <div class="charm4">
      <input type="text" name="attr_charm4" style="width: 240px;"></div>
  <div class="charm4notch">
      <input type="text" name="attr_charm4notch" style="width: 27px;"></div>
  <div class="charm5">
      <input type="text" name="attr_charm5" style="width: 240px;"></div>
  <div class="charm5notch">
      <input type="text" name="attr_charm5notch" style="width: 27px;"></div>
  <div class="charm6">
      <input type="text" name="attr_charm6" style="width: 240px;"></div>
  <div class="charm6notch">
      <input type="text" name="attr_charm6notch" style="width: 27px;"></div>
  <div class="charm7">
      <input type="text" name="attr_charm7" style="width: 240px;"></div>
  <div class="charm7notch">
      <input type="text" name="attr_charm7notch" style="width: 27px;"></div>
  <div class="charm8">
      <input type="text" name="attr_charm8" style="width: 240px;"></div>
  <div class="charm8notch">
      <input type="text" name="attr_charm8notch" style="width: 27px;"></div>

  <div class="bulktotal2">
      <input type="text" name="attr_bulktotal" min="0" style="width: 31px;"></div>
  <div class="load2">
      <input type="text" name="attr_load" min="0" style="width: 33px;" readonly></div>
  <div class="lightequip">
      <textarea name="attr_lightequip" rows="30" cols="43" style="width: 332px; height: 238px;"></textarea></div>

  <div class="profname1">
      <input type="text" name="attr_profname1" style="width: 160px;"></div>
  <div class="profname1num">
      <input type="text" name="attr_profname1num" style="width: 27px;"></div>
  <div class="prof11">
      <input type="text" name="attr_prof11" style="width: 130px;"></div>
  <div class="prof11check">
      <input type="checkbox" name="attr_prof11check" value="1" style=""></div>
  <div class="prof12">
      <input type="text" name="attr_prof12" style="width: 130px;"></div>
  <div class="prof12check">
      <input type="checkbox" name="attr_prof12check" value="1" style=""></div>
  <div class="prof13">
      <input type="text" name="attr_prof13" style="width: 130px;"></div>
  <div class="prof13check">
      <input type="checkbox" name="attr_prof13check" value="1" style=""></div>
  <div class="prof14">
      <input type="text" name="attr_prof14" style="width: 130px;"></div>
  <div class="prof14check">
      <input type="checkbox" name="attr_prof14check" value="1" style=""></div>

  <div class="profname2">
      <input type="text" name="attr_profname2" style="width: 160px;"></div>
  <div class="profname2num">
      <input type="text" name="attr_profname2num" style="width: 27px;"></div>
  <div class="prof21">
      <input type="text" name="attr_prof21" style="width: 130px;"></div>
  <div class="prof21check">
      <input type="checkbox" name="attr_prof21check" value="1" style=""></div>
  <div class="prof22">
      <input type="text" name="attr_prof22" style="width: 130px;"></div>
  <div class="prof22check">
      <input type="checkbox" name="attr_prof22check" value="1" style=""></div>
  <div class="prof23">
      <input type="text" name="attr_prof23" style="width: 130px;"></div>
  <div class="prof23check">
      <input type="checkbox" name="attr_prof23check" value="1" style=""></div>
  <div class="prof24">
      <input type="text" name="attr_prof24" style="width: 130px;"></div>
  <div class="prof24check">
      <input type="checkbox" name="attr_prof24check" value="1" style=""></div>

  <div class="profname3">
      <input type="text" name="attr_profname3" style="width: 160px;"></div>
  <div class="profname3num">
      <input type="text" name="attr_profname3num" style="width: 27px;"></div>
  <div class="prof31">
      <input type="text" name="attr_prof31" style="width: 130px;"></div>
  <div class="prof31check">
      <input type="checkbox" name="attr_prof31check" value="1" style=""></div>
  <div class="prof32">
      <input type="text" name="attr_prof32" style="width: 130px;"></div>
  <div class="prof32check">
      <input type="checkbox" name="attr_prof32check" value="1" style=""></div>
  <div class="prof33">
      <input type="text" name="attr_prof33" style="width: 130px;"></div>
  <div class="prof33check">
      <input type="checkbox" name="attr_prof33check" value="1" style=""></div>
  <div class="prof34">
      <input type="text" name="attr_prof34" style="width: 130px;"></div>
  <div class="prof34check">
      <input type="checkbox" name="attr_prof34check" value="1" style=""></div>

</div>
</div>

<div class="sheet-traits">
    <h2>Common Trait Modifiers</h2>
        <h4>This is NOT where you type in all your traits. This is a list of macros for commonly used traits.</h4>
        
        <p><h4>If a trait below has a description of its function next to it, assume that is the only action that trait takes when active (having the "Feral" trait, for example, means you'll have to manually change your Insight, Soul, and hunger loss). </h4></p>

  <p>
  <p>  <div class="civilized">
      <input type="checkbox" name="attr_civilized" value="1" style="">&nbsp;<b>Civilized</b></div>
<div>&nbsp;&nbsp;&nbsp; [-1 die to attack rolls and attribute checks when not at max hearts]</div>
<div>&nbsp;&nbsp;&nbsp; (note: this affects every attribute based roll execept parry/dodge)</div></p>
  <p>  <div class="dastardly">
      <input type="checkbox" name="attr_dastardly" value="1" style="">&nbsp;<b>Dastardly</b></div>
<div>&nbsp;&nbsp;&nbsp; [+2 dice to soak rolls when at 1 heart or below]</div>
<div>&nbsp;&nbsp;&nbsp; (note: temp hearts, or lifeblood masks, are not considered by Dastardly)</div></p>
  <p>  <div class="elytra">
      <input type="checkbox" name="attr_elytra" value="1" style="">&nbsp;<b>Elytra</b></div>
<div>&nbsp;&nbsp;&nbsp; [-1 Shell]</div></p>
  <p>  <div class="feral">
      <input type="checkbox" name="attr_feral" value="1" style="">&nbsp;<b>Feral</b></div>
<div>&nbsp;&nbsp;&nbsp; [-1 die to grace based melee attacks]</div></p>
  <p>  <div class="flight">
      <input type="checkbox" name="attr_flight" value="1" style="">&nbsp;<b>Flight</b></div>
<div>&nbsp;&nbsp;&nbsp; - [Stamina Tax is not cleared when clicking "End Turn"]</div></p>
  <p>  <div class="hivemind">
      <input type="checkbox" name="attr_hivemind" value="1" style="">&nbsp;<b>Hivemind</b></div>
<div>&nbsp;&nbsp;&nbsp; [+1 die to attack] {WIP +1 reroll to craft or profession check}</div></p>
  <p>  <div class="leapingdodge">
      <button type="action" name="act_leapingdodge" style=""><b>Leaping (Dodge)</b></div>
<div>&nbsp;&nbsp;&nbsp; [Costs 3 stamina to initiate, uses max speed as dodge score]</div></p>
  <p>  <div class="leapingpounce">
      <button type="action" name="act_leapingpounce" style=""><b>Leaping (Pounce)</b></div>
<div>&nbsp;&nbsp;&nbsp; [Costs 3 stamina to initiate, which is dedicated to the attack]</div></p>
  <p>  <div class="leapingdodgepounce">
      <button type="action" name="act_leapingdodgepounce" style=""><b>Leaping (Dodge into Pounce)</b></div>
<div>&nbsp;&nbsp;&nbsp; [Costs 3 stamina to initiate, both "Leaping (Dodge)" and "Leaping (Pounce)" effects occur]</div>
<div>&nbsp;&nbsp;&nbsp; (note: usually only doable if you trigger an opportunity attack on your turn)</div></p>
  <p>  <div class="legless">
      <input type="checkbox" name="attr_legless" value="1" style="">&nbsp;<b>Legless</b></div>
<div>&nbsp;&nbsp;&nbsp; - {WIP}</div></p>
  <p>  <div class="naturalsaddle">
      <input type="number" name="attr_naturalsaddle" min="0" max="4" style="">&nbsp;<b>Natural Saddle</b></div>
<div>&nbsp;&nbsp;&nbsp; [Input load of passangers, max of 4 bulk]</div></p>
  <p>  <div class="pheromones">
      <input type="checkbox" name="attr_Pheromones" value="1" style="">&nbsp;<b>Pheromones</b></div>
<div>&nbsp;&nbsp;&nbsp; - {WIP}</div></p>
  <p>  <div class="phobia">
      <input type="checkbox" name="attr_phobia" value="1" style="">&nbsp;<b>Phobia</b></div>
<div>&nbsp;&nbsp;&nbsp; [-1 die to all rolls other than soak]</div></p>
  <p>  <div class="scavenger">
      <input type="checkbox" name="attr_scavenger" value="1" style="">&nbsp;<b>Scavenger</b></div>
<div>&nbsp;&nbsp;&nbsp; - {WIP}</div></p>
  <p>  <div class="sharpproboscis">
      <input type="checkbox" name="attr_sharpproboscis" value="1" style="">&nbsp;<b>Sharp Proboscis</b></div>
<div>&nbsp;&nbsp;&nbsp; [-2 dice to soak rolls, DR is ignored]</div>
<div>&nbsp;&nbsp;&nbsp; (note: activate if you are resisting a Sharp Proboscis attack)</div></p>
  <p>  <div class="slam">
      <div>&nbsp;<b>Slam</b></div>
<div>&nbsp;&nbsp;&nbsp; [Check-off the "Ranged" button under the "Parry!" button on Page 1, gives -2 dice to parry]</div></p>
  <p>  <div class="softbody">
      <input type="checkbox" name="attr_softbody" value="1" style="">&nbsp;<b>Soft Body</b></div>
<div>&nbsp;&nbsp;&nbsp; [Shell is removed from Soak rolls] {WIP needs to consider healing rolls}</div></p>
  <p>  <div class="stenchcloud">
      <input type="checkbox" name="attr_stenchcloud" value="1" style="">&nbsp;<b>Stench Cloud</b></div>
<div>&nbsp;&nbsp;&nbsp; - {WIP}</div></p>
  <p>  <div class="stinger">
      <input type="checkbox" name="attr_stinger" value="1" style="">&nbsp;<b>Stinger</b></div>
<div>&nbsp;&nbsp;&nbsp; [-2 dice to hit]</div></p>


  </p>




</div>


<div class="sheet-modifiersweapon">
    <h2>Weapon & Armor Modifiers</h2>

    <p><h3>Armor</h3></p>
    <p><div class="xxx">
      <input type="number" name="attr_armsoak" style="width: 43px;">+Soak&nbsp;&nbsp;
      <input type="number" name="attr_armsoakreroll" style="width: 43px;">+Soak Reroll</div>
      <div class="xxxxxx">
      <input type="number" name="attr_dr" style="width: 43px;">+Damage Reduction</div></p>
    <p><div class="armorsoakcheck">
    Apply Normal Armor Soak against:
      <input type="checkbox" name="attr_armorsoakcheck1" value="1" style="width: 13px;" checked>Normal Damage&nbsp;&nbsp;
      <input type="checkbox" name="attr_armorsoakcheck2" value="1" style="width: 13px;">Magic&nbsp;&nbsp;
      <input type="checkbox" name="attr_armorsoakcheck3" value="1" style="width: 13px;">Enviro.</div></p>
    <p><div class="armordrcheck">
    Apply Normal Armor DR against:
      <input type="checkbox" name="attr_armordrcheck1" value="1" style="width: 13px;" checked>Normal Damage&nbsp;&nbsp;
      <input type="checkbox" name="attr_armordrcheck2" value="1" style="width: 13px;">Magic&nbsp;&nbsp;
      <input type="checkbox" name="attr_armordrcheck3" value="1" style="width: 13px;">Enviro.</div></p>
    <p><div class="xxxxxxx">
      <input type="number" name="attr_armsoakmagicextra" style="width: 43px;">+Soak Magic&nbsp;&nbsp;
      <input type="number" name="attr_armsoakrerollmagicextra" style="width: 43px;">+Soak Reroll Magic</div>
    <div class="xxxxxxx">
      <input type="number" name="attr_armsoakenviroextra" style="width: 43px;">+Soak Enviro.&nbsp;&nbsp;
      <input type="number" name="attr_armsoakrerollenviroextra" style="width: 43px;">+Soak Reroll Enviro.</div></p>





    <p><h3>Weapon Slot #1</h3></p>
    <p><div class="stamattackmod">
      <input type="number" name="attr_stamattackmod1" style="width: 43px;">Additional Minimum Stamina needed to Attack</div>
        <div class="stamtaxtax">
      <input type="number" name="attr_stamtaxtax1" style="width: 43px;">Additional Stamina Tax taken upon clicking "Attack"</div></p>
<p><div class="mtoggle">
    This Weapon's Melee Attack Uses:
      <input type="radio" name="attr_meleeradio1" value="1" style="width: 13px;" checked>Might&nbsp;&nbsp;
      <input type="radio" name="attr_meleeradio1" value="2" style="width: 13px;">Grace&nbsp;&nbsp;
      <input type="radio" name="attr_meleeradio1" value="3" style="width: 13px;">Insight</div></p>

<p><div class="rtoggle">
    This Weapon's Ranged Attack Uses:
      <input type="radio" name="attr_rangedradio1" value="1" style="width: 13px;">Might&nbsp;&nbsp;
      <input type="radio" name="attr_rangedradio1" value="2" style="width: 13px;" checked>Grace&nbsp;&nbsp;
      <input type="radio" name="attr_rangedradio1" value="3" style="width: 13px;">Insight</div></p>
  <p><div class="grapplerollmod">
      <input type="number" name="attr_grapplerollmod1" style="width: 43px;">+Grapple&nbsp;&nbsp;
      <input type="number" name="attr_grapplererollmod1" style="width: 43px;">+Grapple Reroll</div></p>
<p><div class="attackbuff">
      <input type="number" name="attr_attackbuff1" style="width: 43px;">+Attack Dice&nbsp;&nbsp;
      <input type="number" name="attr_attackrerollbuff1" style="width: 43px;">+Attack Reroll</div></p>
  <p><div class="parryweaponbuff">
      <input type="number" name="attr_parryweaponbuff1" style="width: 43px;">+Parry Dice (Weapon Specific)&nbsp;&nbsp;
      <input type="number" name="attr_parryweaponrerollbuff1" style="width: 43px;">+Parry Reroll (Weapon Specific)</div>
  <div class="parryshieldbuff">
      <input type="number" name="attr_parryshieldbuff1" style="width: 43px;">+Parry Dice (Shield Specific)&nbsp;&nbsp;
      <input type="number" name="attr_parryshieldrerollbuff1" style="width: 43px;">+Parry Reroll (Shield Specific)</div></p>
    <p><div class="attackoffbal">
      <input type="number" name="attr_attackoffbal1" style="width: 43px;">+Off-Balance from Attacking</div></p>

<p><div class="shieldbashradio">
      Apply "Balanced Modifier" to shield:
      <input type="checkbox" name="attr_shieldbashradio1" value="1" style="width: 10px;" unchecked></div>

  <div class="shieldqtybonus">
      Shield Quality Upgrades and modifiers (input the shield's base quality in page 1's "Weapons & Shields"):
      <input type="number" name="attr_shieldqtybonus1" style="width: 43px;"></div></p>

<div class="wpnclass1">
Weapon Class:&nbsp;&nbsp;<select name="attr_wpnclass1" id="wgtmsrr">
    <option value="0" style="width: 33px;">[Blank]</option>
    <option value="1" style="width: 33px;">Nail</option>
    <option value="2" style="width: 33px;">Needle</option>
    <option value="3" style="width: 33px;">Hook</option>
    <option value="4" style="width: 33px;">Tusk</option>
    <option value="5" style="width: 33px;">Sling</option>
    <option value="6" style="width: 33px;">Natural</option>
    <option value="7" style="width: 33px;">Other</option>
</select>
</div>


     
    <p><h3>Weapon Slot #2</h3></p>
    <p><div class="stamattackmod">
      <input type="number" name="attr_stamattackmod2" style="width: 43px;">Additional Minimum Stamina needed to Attack</div>
        <div class="stamtaxtax">
      <input type="number" name="attr_stamtaxtax2" style="width: 43px;">Additional Stamina Tax taken upon clicking "Attack"</div></p>
<p><div class="mtoggle">
    This Weapon's Melee Attack Uses:
      <input type="radio" name="attr_meleeradio2" value="1" style="width: 13px;" checked>Might&nbsp;&nbsp;
      <input type="radio" name="attr_meleeradio2" value="2" style="width: 13px;">Grace&nbsp;&nbsp;
      <input type="radio" name="attr_meleeradio2" value="3" style="width: 13px;">Insight</div></p>

<p><div class="rtoggle">
    This Weapon's Ranged Attack Uses:
      <input type="radio" name="attr_rangedradio2" value="1" style="width: 13px;">Might&nbsp;&nbsp;
      <input type="radio" name="attr_rangedradio2" value="2" style="width: 13px;" checked>Grace&nbsp;&nbsp;
      <input type="radio" name="attr_rangedradio2" value="3" style="width: 13px;">Insight</div></p>
  <p><div class="grapplerollmod">
      <input type="number" name="attr_grapplerollmod2" style="width: 43px;">+Grapple&nbsp;&nbsp;
      <input type="number" name="attr_grapplererollmod2" style="width: 43px;">+Grapple Reroll</div></p>
<p><div class="attackbuff">
      <input type="number" name="attr_attackbuff2" style="width: 43px;">+Attack Dice&nbsp;&nbsp;
      <input type="number" name="attr_attackrerollbuff2" style="width: 43px;">+Attack Reroll</div></p>
  <p><div class="parryweaponbuff">
      <input type="number" name="attr_parryweaponbuff2" style="width: 43px;">+Parry Dice (Weapon Specific)&nbsp;&nbsp;
      <input type="number" name="attr_parryweaponrerollbuff2" style="width: 43px;">+Parry Reroll (Weapon Specific)</div>
  <div class="parryshieldbuff">
      <input type="number" name="attr_parryshieldbuff2" style="width: 43px;">+Parry Dice (Shield Specific)&nbsp;&nbsp;
      <input type="number" name="attr_parryshieldrerollbuff2" style="width: 43px;">+Parry Reroll (Shield Specific)</div></p>
    <p><div class="attackoffbal">
      <input type="number" name="attr_attackoffbal2" style="width: 43px;">+Off-Balance from Attacking</div></p>

<p><div class="shieldbashradio">
      Apply "Balanced Modifier" to shield:
      <input type="checkbox" name="attr_shieldbashradio2" value="1" style="width: 10px;" unchecked></div>

  <div class="shieldqtybonus">
      Shield Quality Upgrades and modifiers (input the shield's base quality in page 1's "Weapons & Shields"):
      <input type="number" name="attr_shieldqtybonus2" style="width: 43px;"></div></p>

<div class="wpnclass2">
Weapon Class:&nbsp;&nbsp;<select name="attr_wpnclass2" id="wgtmsrr">
    <option value="0" style="width: 33px;">[Blank]</option>
    <option value="1" style="width: 33px;">Nail</option>
    <option value="2" style="width: 33px;">Needle</option>
    <option value="3" style="width: 33px;">Hook</option>
    <option value="4" style="width: 33px;">Tusk</option>
    <option value="5" style="width: 33px;">Sling</option>
    <option value="6" style="width: 33px;">Natural</option>
    <option value="7" style="width: 33px;">Other</option>
</select>
</div>


    <p><h3>Weapon Slot #3</h3></p>
    <p><div class="stamattackmod">
      <input type="number" name="attr_stamattackmod3" style="width: 43px;">Additional Minimum Stamina needed to Attack</div>
        <div class="stamtaxtax">
      <input type="number" name="attr_stamtaxtax3" style="width: 43px;">Additional Stamina Tax taken upon clicking "Attack"</div></p>
<p><div class="mtoggle">
    This Weapon's Melee Attack Uses:
      <input type="radio" name="attr_meleeradio3" value="1" style="width: 13px;" checked>Might&nbsp;&nbsp;
      <input type="radio" name="attr_meleeradio3" value="2" style="width: 13px;">Grace&nbsp;&nbsp;
      <input type="radio" name="attr_meleeradio3" value="3" style="width: 13px;">Insight</div></p>

<p><div class="rtoggle">
    This Weapon's Ranged Attack Uses:
      <input type="radio" name="attr_rangedradio3" value="1" style="width: 13px;">Might&nbsp;&nbsp;
      <input type="radio" name="attr_rangedradio3" value="2" style="width: 13px;" checked>Grace&nbsp;&nbsp;
      <input type="radio" name="attr_rangedradio3" value="3" style="width: 13px;">Insight</div></p>
  <p><div class="grapplerollmod">
      <input type="number" name="attr_grapplerollmod3" style="width: 43px;">+Grapple&nbsp;&nbsp;
      <input type="number" name="attr_grapplererollmod3" style="width: 43px;">+Grapple Reroll</div></p>
<p><div class="attackbuff">
      <input type="number" name="attr_attackbuff3" style="width: 43px;">+Attack Dice&nbsp;&nbsp;
      <input type="number" name="attr_attackrerollbuff3" style="width: 43px;">+Attack Reroll</div></p>
  <p><div class="parryweaponbuff">
      <input type="number" name="attr_parryweaponbuff3" style="width: 43px;">+Parry Dice (Weapon Specific)&nbsp;&nbsp;
      <input type="number" name="attr_parryweaponrerollbuff3" style="width: 43px;">+Parry Reroll (Weapon Specific)</div>
  <div class="parryshieldbuff">
      <input type="number" name="attr_parryshieldbuff3" style="width: 43px;">+Parry Dice (Shield Specific)&nbsp;&nbsp;
      <input type="number" name="attr_parryshieldrerollbuff3" style="width: 43px;">+Parry Reroll (Shield Specific)</div></p>
    <p><div class="attackoffbal">
      <input type="number" name="attr_attackoffbal3" style="width: 43px;">+Off-Balance from Attacking</div></p>

<p><div class="shieldbashradio">
      Apply "Balanced Modifier" to shield:
      <input type="checkbox" name="attr_shieldbashradio3" value="1" style="width: 10px;" unchecked></div>

  <div class="shieldqtybonus">
      Shield Quality Upgrades and modifiers (input the shield's base quality in page 1's "Weapons & Shields"):
      <input type="number" name="attr_shieldqtybonus3" style="width: 43px;"></div></p>

<div class="wpnclass3">
Weapon Class:&nbsp;&nbsp;<select name="attr_wpnclass3" id="wgtmsrr">
    <option value="0" style="width: 33px;">[Blank]</option>
    <option value="1" style="width: 33px;">Nail</option>
    <option value="2" style="width: 33px;">Needle</option>
    <option value="3" style="width: 33px;">Hook</option>
    <option value="4" style="width: 33px;">Tusk</option>
    <option value="5" style="width: 33px;">Sling</option>
    <option value="6" style="width: 33px;">Natural</option>
    <option value="7" style="width: 33px;">Other</option>
</select>
</div>



    <p><h3>Weapon Slot #4</h3></p>
    <p><div class="stamattackmod">
      <input type="number" name="attr_stamattackmod4" style="width: 43px;">Additional Minimum Stamina needed to Attack</div>
        <div class="stamtaxtax">
      <input type="number" name="attr_stamtaxtax4" style="width: 43px;">Additional Stamina Tax taken upon clicking "Attack"</div></p>
<p><div class="mtoggle">
    This Weapon's Melee Attack Uses:
      <input type="radio" name="attr_meleeradio4" value="1" style="width: 13px;" checked>Might&nbsp;&nbsp;
      <input type="radio" name="attr_meleeradio4" value="2" style="width: 13px;">Grace&nbsp;&nbsp;
      <input type="radio" name="attr_meleeradio4" value="3" style="width: 13px;">Insight</div></p>

<p><div class="rtoggle">
    This Weapon's Ranged Attack Uses:
      <input type="radio" name="attr_rangedradio4" value="1" style="width: 13px;">Might&nbsp;&nbsp;
      <input type="radio" name="attr_rangedradio4" value="2" style="width: 13px;" checked>Grace&nbsp;&nbsp;
      <input type="radio" name="attr_rangedradio4" value="3" style="width: 13px;">Insight</div></p>
  <p><div class="grapplerollmod">
      <input type="number" name="attr_grapplerollmod4" style="width: 43px;">+Grapple&nbsp;&nbsp;
      <input type="number" name="attr_grapplererollmod4" style="width: 43px;">+Grapple Reroll</div></p>
<p><div class="attackbuff">
      <input type="number" name="attr_attackbuff4" style="width: 43px;">+Attack Dice&nbsp;&nbsp;
      <input type="number" name="attr_attackrerollbuff4" style="width: 43px;">+Attack Reroll</div></p>
  <p><div class="parryweaponbuff">
      <input type="number" name="attr_parryweaponbuff4" style="width: 43px;">+Parry Dice (Weapon Specific)&nbsp;&nbsp;
      <input type="number" name="attr_parryweaponrerollbuff4" style="width: 43px;">+Parry Reroll (Weapon Specific)</div>
  <div class="parryshieldbuff">
      <input type="number" name="attr_parryshieldbuff4" style="width: 43px;">+Parry Dice (Shield Specific)&nbsp;&nbsp;
      <input type="number" name="attr_parryshieldrerollbuff4" style="width: 43px;">+Parry Reroll (Shield Specific)</div></p>
    <p><div class="attackoffbal">
      <input type="number" name="attr_attackoffbal4" style="width: 43px;">+Off-Balance from Attacking</div></p>

<p><div class="shieldbashradio">
      Apply "Balanced Modifier" to shield:
      <input type="checkbox" name="attr_shieldbashradio4" value="1" style="width: 10px;" unchecked></div>

  <div class="shieldqtybonus">
      Shield Quality Upgrades and modifiers (input the shield's base quality in page 1's "Weapons & Shields"):
      <input type="number" name="attr_shieldqtybonus4" style="width: 43px;"></div></p>

<div class="wpnclass4">
Weapon Class:&nbsp;&nbsp;<select name="attr_wpnclass4" id="wgtmsrr">Weapon Class
    <option value="0" style="width: 33px;">[Blank]</option>
    <option value="1" style="width: 33px;">Nail</option>
    <option value="2" style="width: 33px;">Needle</option>
    <option value="3" style="width: 33px;">Hook</option>
    <option value="4" style="width: 33px;">Tusk</option>
    <option value="5" style="width: 33px;">Sling</option>
    <option value="6" style="width: 33px;">Natural</option>
    <option value="7" style="width: 33px;">Other</option>
</select>
</div>





    <p><h3>Weapon Slot #5</h3></p>
    <p><div class="stamattackmod">
      <input type="number" name="attr_stamattackmod5" style="width: 43px;">Additional Minimum Stamina needed to Attack</div>
        <div class="stamtaxtax">
      <input type="number" name="attr_stamtaxtax5" style="width: 43px;">Additional Stamina Tax taken upon clicking "Attack"</div></p>
<p><div class="mtoggle">
    This Weapon's Melee Attack Uses:
      <input type="radio" name="attr_meleeradio5" value="1" style="width: 13px;" checked>Might&nbsp;&nbsp;
      <input type="radio" name="attr_meleeradio5" value="2" style="width: 13px;">Grace&nbsp;&nbsp;
      <input type="radio" name="attr_meleeradio5" value="3" style="width: 13px;">Insight</div></p>

<p><div class="rtoggle">
    This Weapon's Ranged Attack Uses:
      <input type="radio" name="attr_rangedradio5" value="1" style="width: 13px;">Might&nbsp;&nbsp;
      <input type="radio" name="attr_rangedradio5" value="2" style="width: 13px;" checked>Grace&nbsp;&nbsp;
      <input type="radio" name="attr_rangedradio5" value="3" style="width: 13px;">Insight</div></p>
  <p><div class="grapplerollmod">
      <input type="number" name="attr_grapplerollmod5" style="width: 43px;">+Grapple&nbsp;&nbsp;
      <input type="number" name="attr_grapplererollmod5" style="width: 43px;">+Grapple Reroll</div></p>
<p><div class="attackbuff">
      <input type="number" name="attr_attackbuff5" style="width: 43px;">+Attack Dice&nbsp;&nbsp;
      <input type="number" name="attr_attackrerollbuff5" style="width: 43px;">+Attack Reroll</div></p>
  <p><div class="parryweaponbuff">
      <input type="number" name="attr_parryweaponbuff5" style="width: 43px;">+Parry Dice (Weapon Specific)&nbsp;&nbsp;
      <input type="number" name="attr_parryweaponrerollbuff5" style="width: 43px;">+Parry Reroll (Weapon Specific)</div>
  <div class="parryshieldbuff">
      <input type="number" name="attr_parryshieldbuff5" style="width: 43px;">+Parry Dice (Shield Specific)&nbsp;&nbsp;
      <input type="number" name="attr_parryshieldrerollbuff5" style="width: 43px;">+Parry Reroll (Shield Specific)</div></p>
    <p><div class="attackoffbal">
      <input type="number" name="attr_attackoffbal5" style="width: 43px;">+Off-Balance from Attacking</div></p>

<p><div class="shieldbashradio">
      Apply "Balanced Modifier" to shield:
      <input type="checkbox" name="attr_shieldbashradio5" value="1" style="width: 10px;" unchecked></div>

  <div class="shieldqtybonus">
      Shield Quality Upgrades and modifiers (input the shield's base quality in page 1's "Weapons & Shields"):
      <input type="number" name="attr_shieldqtybonus5" style="width: 43px;"></div></p>

<div class="wpnclass5">
Weapon Class:&nbsp;&nbsp;<select name="attr_wpnclass5" id="wgtmsrr">
    <option value="0" style="width: 33px;">[Blank]</option>
    <option value="1" style="width: 33px;">Nail</option>
    <option value="2" style="width: 33px;">Needle</option>
    <option value="3" style="width: 33px;">Hook</option>
    <option value="4" style="width: 33px;">Tusk</option>
    <option value="5" style="width: 33px;">Sling</option>
    <option value="6" style="width: 33px;">Natural</option>
    <option value="7" style="width: 33px;">Other</option>
</select>
</div>



</div>



<div class="sheet-modifiers">

<br>
<h2>Resist! Modifiers</h2>
  <div class="soakmod">
      <p>Normal Resist:
      <input type="number" name="attr_soakmod" style="width: 43px;">+Soak&nbsp;&nbsp;
      <input type="number" name="attr_soakrerollmod" style="width: 43px;">+Soak Reroll</p></div>
  <p><div class="soakmagicmod">
      Magical Resist:
      <input type="number" name="attr_soakmagicmod" style="width: 43px;">+Soak&nbsp;&nbsp;
      <input type="number" name="attr_soakmagicrerollmod" style="width: 43px;">+Soak Reroll</div></p>
  <p><div class="soakmagicradio">
      <input type="checkbox" name="attr_soakmagicradio" value="1" style="width: 43px;">Add "Normal" Soak against Magic Damage</div></p>
  <p><div class="soakenviromod">
      Enviornmental Resist:
      <input type="number" name="attr_soakenviromod" style="width: 43px;">+Soak&nbsp;&nbsp;
      <input type="number" name="attr_soakenvirorerollmod" style="width: 43px;">+Soak Reroll</div></p>
  <p><div class="soakenviroradio">
      <input type="checkbox" name="attr_soakenviroradio" value="1" style="width: 43px;">Add "Normal" Soak against Enviornment Damage</div></p>

<br>
<h2>Generic Modifiers</h2>
  <p><div class="loadmod">
      <input type="number" name="attr_loadmod" style="width: 43px;">+Load</div>
  <div class="footworkmod">
      <input type="number" name="attr_footworkmod" style="width: 43px;">+Footwork</div>
  <div class="techmod">
      <input type="number" name="attr_techmod" style="width: 43px;">+Technique Slots</div>
  <div class="beltmod">
      <input type="number" name="attr_beltmod" style="width: 43px;">+Belt</div>
  <div class="initmod">
      <input type="number" name="attr_initmod" style="width: 43px;">+Initative&nbsp;&nbsp;
      <input type="number" name="attr_initrerollmod" style="width: 43px;">+Initative Reroll</div>
  <div class="bellylostmod">
      <input type="number" name="attr_bellylostmod" style="width: 43px;">+Belly Loss [note: Normal belly lost on Rest is "Max Belly", or 10, whichever's higher. This modifier increases belly lost on rest.]</div></p>

<br>
<h2>Social Roll Modifiers</h2>
  <p><div class="cutererolll">
      <input type="number" name="attr_cutererollmod" style="width: 43px;">+Cute Reroll
      <div class="spookrerolll">
      <input type="number" name="attr_spookrerollmod" style="width: 43px;">+Spook Reroll</div>
      <div class="endearrolls">
      <input type="number" name="attr_endearmod" style="width: 43px;">+Endear Check&nbsp;&nbsp;
      <input type="number" name="attr_endearrerollmod" style="width: 43px;">+Endear Reroll</div>
      <div class="bullyrolls">
      <input type="number" name="attr_bullymod" style="width: 43px;">+Bully Check&nbsp;&nbsp;
      <input type="number" name="attr_bullyrerollmod" style="width: 43px;">+Bully Reroll</div>
      <div class="deceiverolls">
      <input type="number" name="attr_deceivemod" style="width: 43px;">+Deceive Check&nbsp;&nbsp;
      <input type="number" name="attr_deceivererollmod" style="width: 43px;">+Deceive Reroll</div>
      <div class="convincerolls">
      <input type="number" name="attr_convincemod" style="width: 43px;">+Convince Check&nbsp;&nbsp;
      <input type="number" name="attr_convincererollmod" style="width: 43px;">+Convince Reroll</div></p>


<br>
<h2>Stamina/StamTax Modifiers</h2>
  <div class="stamtaxtaxgeneral">
      <input type="number" name="attr_stamtaxtaxgeneral" value="1" style="width: 43px;">Stamina Tax acquired from Attacking <b>[default at 1]</b></div></p>
  <p><div class="stamtaxmod">
      <input type="number" name="attr_stamtaxmod" value="0" style="width: 43px;">Stamina Tax acquired from Ending Turn</div>
    
  <p><div class="stamattackmodgeneral">
      <input type="number" name="attr_stamattackmodgeneral" value="1" style="width: 43px;">Minimum Stamina Cost (Attack) <b>[default at 1]</b></div>
  <div class="stamparrymod">
      <input type="number" name="attr_stamparrymod" value="1" style="width: 43px;">Minimum Stamina Cost (Parry) <b>[default at 1]</b></div>
  <div class="stamdodgemod">
      <input type="number" name="attr_stamdodgemod" value="1" style="width: 43px;">Minimum Stamina Cost (Dodge) <b>[default at 1]</b></div>
  <div class="stamgrapplemod">
      <input type="number" name="attr_stamgrapplemod" value="1" style="width: 43px;">Minimum Stamina Cost (Grapple) <b>[default at 1]</b></div></p>


<br>
<h2>Attack/Defense Roll Modifiers</h2>      
  <p><div class="grapplerollmod">
      <input type="number" name="attr_grapplerollmodgeneral" style="width: 43px;">+Grapple&nbsp;&nbsp;
      <input type="number" name="attr_grapplererollmodgeneral" style="width: 43px;">+Grapple Reroll</div></p>

<p><div class="attackbuff">
      <input type="number" name="attr_attackbuffgeneral" style="width: 43px;">+Attack Dice&nbsp;&nbsp;
      <input type="number" name="attr_attackrerollbuffgeneral" style="width: 43px;">+Attack Reroll</div>
  <div class="mightattackmod">
      <input type="number" name="attr_mightattackmod" style="width: 43px;">+Attack Dice (Might)&nbsp;&nbsp;
      <input type="number" name="attr_mightattackrerollmod" style="width: 43px;">+Attack Reroll (Might)</div>
  <div class="graceattackmod">
      <input type="number" name="attr_graceattackmod" style="width: 43px;">+Attack Dice (Grace)&nbsp;&nbsp;
      <input type="number" name="attr_graceattackrerollmod" style="width: 43px;">+Attack Reroll (Grace)</div>
  <div class="insightattackmod">
      <input type="number" name="attr_insightattackmod" style="width: 43px;">+Attack Dice (Insight)&nbsp;&nbsp;
      <input type="number" name="attr_insightattackrerollmod" style="width: 43px;">+Attack Reroll (Insight)</div>
  <div class="dodgebuff">
      <input type="number" name="attr_dodgebuff" style="width: 43px;">+Dodge Dice&nbsp;&nbsp;
      <input type="number" name="attr_dodgererollbuff" style="width: 43px;">+Dodge Reroll</div>
  <div class="parrybuff">
      <input type="number" name="attr_parrybuff" style="width: 43px;">+Parry Dice&nbsp;&nbsp;
      <input type="number" name="attr_parryrerollbuff" style="width: 43px;">+Parry Reroll</div>
  <div class="parryweaponbuffgeneral">
      <input type="number" name="attr_parryweaponbuffgeneral" style="width: 43px;">+Parry Dice (Weapon Specific)&nbsp;&nbsp;
      <input type="number" name="attr_parryweaponrerollbuffgeneral" style="width: 43px;">+Parry Reroll (Weapon Specific)</div>
  <div class="parryshieldbuffgeneral">
      <input type="number" name="attr_parryshieldbuffgeneral" style="width: 43px;">+Parry Dice (Shield Specific)&nbsp;&nbsp;
      <input type="number" name="attr_parryshieldrerollbuffgeneral" style="width: 43px;">+Parry Reroll (Shield Specific)</div></p>

<p><div class="parryradio">
    Parrying Uses:
      <input type="radio" name="attr_parryradio" value="1" style="width: 13px;" checked>Might&nbsp;&nbsp;
      <input type="radio" name="attr_parryradio" value="2" style="width: 13px;">Grace&nbsp;&nbsp;
      <input type="radio" name="attr_parryradio" value="3" style="width: 13px;">Insight</div></p>
      
<p><div class="dodgeradio">
    Dodging Uses:
      <input type="radio" name="attr_dodgeradio" value="1" style="width: 13px;">Might&nbsp;&nbsp;
      <input type="radio" name="attr_dodgeradio" value="2" style="width: 13px;" checked>Grace&nbsp;&nbsp;
      <input type="radio" name="attr_dodgeradio" value="3" style="width: 13px;">Insight</div></p>

<br>
<h2>Damage/Damage Reduction Modifiers</h2>
  <p><div class="damcalcadd">
      <input type="number" name="attr_damcalcadd" style="width: 43px;">+Calculated Damage</div>
      <div class="damredbuff">
      <input type="number" name="attr_damredbuffnostack" style="width: 43px;">+Damage Reduction (doesn't stack with other sources)</div>
    <div class="damredbuffstack">
      <input type="number" name="attr_damredbuff" style="width: 43px;">+Damage Reduction (can stack with other sources)</div>
    <div class="damredbuffdot">
      <input type="number" name="attr_damredbuffdot" style="width: 43px;">+DoT Damage Reduction</div>
  <div class="damriskbuff">
      <input type="number" name="attr_damriskbuff" style="width: 43px;">+Damage Risked</div></p>

<br>
<h2>Spellcasting Modifiers</h2>
<p><div class="splmeleeradio">
    "Touch" Magic Attacks use:
      <input type="radio" name="attr_splmeleeradio" value="1" style="width: 13px;" checked>Insight&nbsp;&nbsp;
      <input type="radio" name="attr_splmeleeradio" value="2" style="width: 13px;">Might</div></p>

<p><div class="splrangedradio">
    Ranged Magic Attacks use:
      <input type="radio" name="attr_splrangedradio" value="1" style="width: 13px;" checked>Insight&nbsp;&nbsp;
      <input type="radio" name="attr_splrangedradio" value="2" style="width: 13px;">Grace</div></p>

<p><div class="splattackbuff">
      <input type="number" name="attr_splattackbuff" style="width: 43px;">+Spellcast Attack Dice&nbsp;&nbsp;
      <input type="number" name="attr_splattackbuffreroll" style="width: 43px;">+Spellcast Attack Reroll</div>
<div class="splsaveoffbuff">
      <input type="number" name="attr_splsaveoffbuff" style="width: 43px;">+Offensive Spellsave Dice&nbsp;&nbsp;
      <input type="number" name="attr_splsaveoffbuffreroll" style="width: 43px;">+Off. Spellsave Reroll</div>
<div class="splsavedefbuff">
      <input type="number" name="attr_splsavedefbuff" style="width: 43px;">+Defensive Spellsave Dice&nbsp;&nbsp;
      <input type="number" name="attr_splsavedefbuffreroll" style="width: 43px;">+Def. Spellsave Reroll</div>
<div class="dmghealbuff">
      <input type="number" name="attr_dmghealbuff" style="width: 43px;">+Dmg/Heal (for spells)</div></p>

<br>
<h2>Primary Attribute Modifiers</h2>
  <p><div class="mightcheckbuff">
      <input type="number" name="attr_mightcheckbuff" style="width: 43px;">+Might Based Rolls&nbsp;&nbsp;
      <input type="number" name="attr_mightrerollmod" style="width: 43px;">+Might Reroll</div>
  <div class="shellcheckbuff">
      <input type="number" name="attr_shellcheckbuff" style="width: 43px;">+Shell Based Rolls&nbsp;&nbsp;
      <input type="number" name="attr_shellrerollmod" style="width: 43px;">+Shell Reroll</div>
  <div class="insightcheckbuff">
      <input type="number" name="attr_insightcheckbuff" style="width: 43px;">+Insight Based Rolls&nbsp;&nbsp;
      <input type="number" name="attr_insightrerollmod" style="width: 43px;">+Insight Reroll</div>
  <div class="gracecheckbuff">
      <input type="number" name="attr_gracecheckbuff" style="width: 43px;">+Grace Based Rolls&nbsp;&nbsp;
      <input type="number" name="attr_gracererollmod" style="width: 43px;">+Grace Reroll</div></p>

<br>
<h2>Success Modifiers</h2>
  <p><div class="setsuccessattack">
      <input type="number" name="attr_setsuccessattack" value="5" min="1" max="6" style="width: 43px;">Threshold for Success (Attack)</div>
  <div class="setsuccessparry">
      <input type="number" name="attr_setsuccessparry" value="5" min="1" max="6" style="width: 43px;">Threshold for Success (Parry)</div>
  <div class="setsuccessdodge">
      <input type="number" name="attr_setsuccessdodge" value="5" min="1" max="6" style="width: 43px;">Threshold for Success (Dodge)</div>
  <div class="setsuccesssoak">
      <input type="number" name="attr_setsuccesssoak" value="5" min="1" max="6" style="width: 43px;">Threshold for Success (Resist)</div></p>


</div>

<script type="text/worker">
    const buttonlist = ["page1","casting","page2","page3","page5","traits","modifiers","modifiersweapon","enemy"];
    buttonlist.forEach(button => {
        on(`clicked:${button}`, function() {
            setAttrs({
                sheetTab: button
            });
        });
    });
on("sheet:opened", function() {
    getAttrs(['page1'], function(values) {
            setAttrs({
                sheetTab: page1
            });
        });
    });




</script>

<div class="sheet-page1">
<div class="container">

<div class="image">
    <img src="https://i.imgur.com/WMRVXis.png" alt="sheet"></div>
  
  <div class="checkmight">
      <button type="action" name="act_checkmight">R</button></div>
  <div class="might">
      <input type="text" name="attr_might" value="3" min="0" step="0.5" style="width: 33px;"></div>
  <div class="grapplefinal">
      <input type="text" name="attr_grapplefinal" min="0" step="0.5" style="width: 34px;" readonly></div>
  <div class="grapple">
      <button type="action" name="act_grapple">Grapple!</button></div>
  <div class="might-mod">
      <input type="text" name="attr_mightmod" min="0" style="width: 33px;"></div> 
  <div class="grappletoggle">
      <input type="radio" name="attr_grappletoggle" value="1" checked/>Atk.&nbsp;&nbsp;
      <input type="radio" name="attr_grappletoggle" value="2"/>Retain</div>

  <div class="checkinsight">
      <button type="action" name="act_checkinsight">R</button></div>
  <div class="insight">
      <input type="text" name="attr_insight" value="3" min="0" step="0.5" style="width: 33px;"></div>  
  <div class="insight-mod">
      <input type="text" name="attr_insightmod" min="0" style="width: 33px;"></div> 
  
  <div class="checkshell">
      <button type="action" name="act_checkshell">R</button></div>
  <div class="shell">
      <input type="text" name="attr_shell" value="3" min="0" step="0.5" style="width: 33px;"></div>
  <div class="belt">
      <input type="text" name="attr_belt" min="0" style="width: 33px;" readonly></div>
  <div class="shell-mod">
      <input type="text" name="attr_shellmod" min="0" style="width: 33px;"></div>   
  
  <div class="checkgrace">
      <button type="action" name="act_checkgrace">R</button></div>
  <div class="grace">
      <input type="text" name="attr_grace" value="3" min="0" step="0.5" style="width: 33px;"></div>
  <div class="init">
      <button type="action" name="act_init">Initative</button></div>
  <div class="grace-mod">
      <input type="text" name="attr_gracemod" min="0" style="width: 33px;"></div> 

  <div class="turn">
      <button type="action" name="act_turn">Start Turn</button></div>
  <div class="endturn">
      <button type="action" name="act_endturn">End Turn</button></div>

  <div class="dot1">
      <input type="number" name="attr_dot1" min="0" style="width: 40px; font-size:18px;"></div> 
  <div class="dot2">
      <input type="number" name="attr_dot2" min="0" style="width: 40px; font-size:18px;"></div> 
  <div class="dot3">
      <input type="number" name="attr_dot3" min="0" style="width: 40px; font-size:18px;"></div>
  <div class="dot1tag">
      <input type="text" name="attr_dot1tag" value="Type" style="width: 40px; font-size:10px;"></div>
  <div class="dot2tag">
      <input type="text" name="attr_dot2tag" value="DoT's" style="width: 40px; font-size:10px;"></div> 
  <div class="dot3tag">
      <input type="text" name="attr_dot3tag" value="or" style="width: 40px; font-size:10px;"></div>

  <div class="se1">
      <input type="number" name="attr_se1" min="0" max="10" style="width: 40px; font-size:18px;"></div> 
  <div class="se2">
      <input type="number" name="attr_se2" min="0" max="10" style="width: 40px; font-size:18px;"></div> 
  <div class="se3">
      <input type="number" name="attr_se3" min="0" max="10" style="width: 40px; font-size:18px;"></div>
  <div class="se1tag">
      <input type="text" name="attr_se1tag" value="SE's" style="width: 40px; font-size:10px;"></div>
  <div class="se2tag">
      <input type="text" name="attr_se2tag" value="names" style="width: 40px; font-size:10px;"></div> 
  <div class="se3tag">
      <input type="text" name="attr_se3tag" value="here!" style="width: 40px; font-size:10px;"></div>

  <div class="paral">
      <input type="number" name="attr_paral" min="0" max="20" style="width: 43px;"></div>

  <div class="bulktotal">
      <input type="text" name="attr_bulktotal" min="0" style="width: 31px;"></div>
  <div class="load">
      <input type="text" name="attr_load" min="0" style="width: 33px;" readonly></div>

  <div class="heartmax">
      <input type="text" name="attr_heartmax" min="0" style="width: 33px;"></div>
  <div class="heart">
      <input type="number" name="attr_heart" min="0" style="width: 66px; font-size:30px;"></div>
  <div class="hearttemp">
      <input type="number" name="attr_hearttemp" min="0" style="width: 37px;"></div>

  <div class="soulmax">
      <input type="text" name="attr_soulmax" min="0" style="width: 33px;"></div>
  <div class="soul">
      <input type="number" name="attr_soul" min="0" style="width: 66px; font-size:30px;"></div> 
  <div class="soultemp">
      <input type="number" name="attr_soultemp" min="0" style="width: 37px;"></div>

  <div class="stammax">
      <input type="text" name="attr_stammax" min="0" style="width: 33px;"></div>
  <div class="stam">
      <input type="number" name="attr_stam" min="0" style="width: 66px; font-size:30px;"></div>
  <div class="stamtemp">
      <input type="number" name="attr_stamtemp" min="0" style="width: 37px;"></div>

  <div class="custtext1">
      <input type="text" name="attr_custtext1" style="width: 127px;"></div>
  <div class="cust1max">
      <input type="text" name="attr_cust1max" min="0" style="width: 33px;"></div>
  <div class="cust1">
      <input type="number" name="attr_cust1" min="0" style="width: 67px; font-size:30px;"></div>
  <div class="cust1temp">
      <input type="number" name="attr_cust1temp" min="0" style="width: 37px;"></div>

  <div class="custtext2">
      <input type="text" name="attr_custtext2" style="width: 127px;"></div>
  <div class="cust2max">
      <input type="text" name="attr_cust2max" min="0" style="width: 33px;"></div>
  <div class="cust2">
      <input type="number" name="attr_cust2" min="0" style="width: 67px; font-size:30px;"></div>
  <div class="cust2temp">
      <input type="number" name="attr_cust2temp" min="0" style="width: 37px;"></div>

  <div class="custtext3">
      <input type="text" name="attr_custtext3" style="width: 127px;"></div>
  <div class="cust3max">
      <input type="text" name="attr_cust3max" min="0" style="width: 33px;"></div>
  <div class="cust3">
      <input type="number" name="attr_cust3" min="0" style="width: 67px; font-size:30px;"></div>
  <div class="cust3temp">
      <input type="number" name="attr_cust3temp" min="0" style="width: 37px;"></div>

  <div class="footwork">
      <input type="text" name="attr_footwork" min="0" style="width: 33px;" readonly></div>
  <div class="speedmax">
      <input type="text" name="attr_speedmax" min="0" style="width: 33px;"></div>
  <div class="speed">
      <input type="number" name="attr_speed" min="0" style="width: 66px; font-size:30px;"></div>
  <div class="bellymax">
      <input type="text" name="attr_bellymax" min="0" style="width: 33px;"></div>
  <div class="belly">
      <input type="number" name="attr_belly" min="-100" style="width: 71px; font-size:30px;"></div>

  <div class="result1">
      <input type="text" name="attr_result1" step="0.5" style="width: 43px;" readonly></div>
  <div class="weapon1">
      <input type="text" name="attr_weapon1"></div>
  <div class="bulk1">
      <input type="text" name="attr_bulk1" min="0" style="width: 33px;"></div>
  <div class="dmg1">
      <input type="text" name="attr_dmg1" min="0" style="width: 33px;"></div>
  <div class="rng1">
      <input type="text" name="attr_rng1" min="0" style="width: 33px;"></div>
  <div class="qty1">
      <input type="text" name="attr_qty1" min="-1" style="width: 33px;"></div>

  <div class="equipped">
      <input type="radio" name="attr_atkequip" value="1" checked/>Atk.&nbsp;&nbsp;
      <input type="radio" name="attr_pryequip" value="1" checked/>Parry&nbsp;&nbsp;
      <input type="radio" name="attr_gplequip" value="1" checked/>Grapple</div>
  <div class="wpntypemove"><div class="wpntype1">
      <select name="attr_wpntype1" id="wgtmsrr">
      <option value="1" style="width: 33px;">Weapon</option>
      <option value="2" style="width: 33px;">Shield</option>
  </select></div></div>

  <div class="result2">
      <input type="text" name="attr_result2" step="0.5" style="width: 43px;" readonly></div>
  <div class="weapon2">
      <input type="text" name="attr_weapon2"></div>
  <div class="bulk2">
      <input type="text" name="attr_bulk2" min="0" style="width: 33px;"></div>
  <div class="dmg2">
      <input type="text" name="attr_dmg2" min="0" style="width: 33px;"></div>
  <div class="rng2">
      <input type="text" name="attr_rng2" min="0" style="width: 33px;"></div>
  <div class="qty2">
      <input type="text" name="attr_qty2" min="-1" style="width: 33px;"></div>

  <div class="equipped2">
      <input type="radio" name="attr_atkequip" value="2"/>Atk.&nbsp;&nbsp;
      <input type="radio" name="attr_pryequip" value="2"/>Parry&nbsp;&nbsp;
      <input type="radio" name="attr_gplequip" value="2"/>Grapple</div>
  <div class="wpntypemove"><div class="wpntype2">
      <select name="attr_wpntype2" id="wgtmsrr">
      <option value="1" style="width: 33px;">Weapon</option>
      <option value="2" style="width: 33px;">Shield</option>
  </select></div></div>

  <div class="result3">
      <input type="text" name="attr_result3" step="0.5" style="width: 43px;" readonly></div>
  <div class="weapon3">
      <input type="text" name="attr_weapon3"></div>
  <div class="bulk3">
      <input type="text" name="attr_bulk3" min="0" style="width: 33px;"></div>
  <div class="dmg3">
      <input type="text" name="attr_dmg3" min="0" style="width: 33px;"></div>
  <div class="rng3">
      <input type="text" name="attr_rng3" min="0" style="width: 33px;"></div>
  <div class="qty3">
      <input type="text" name="attr_qty3" min="-1" style="width: 33px;"></div>

  <div class="equipped3">
      <input type="radio" name="attr_atkequip" value="3"/>Atk.&nbsp;&nbsp;
      <input type="radio" name="attr_pryequip" value="3"/>Parry&nbsp;&nbsp;
      <input type="radio" name="attr_gplequip" value="3"/>Grapple</div>
  <div class="wpntypemove"><div class="wpntype3">
      <select name="attr_wpntype3" id="wgtmsrr">
      <option value="1" style="width: 33px;">Weapon</option>
      <option value="2" style="width: 33px;">Shield</option>
  </select></div></div>

  <div class="result4">
      <input type="text" name="attr_result4" step="0.5" style="width: 43px;" readonly></div>
  <div class="weapon4">
      <input type="text" name="attr_weapon4"></div>
  <div class="bulk4">
      <input type="text" name="attr_bulk4" min="0" style="width: 33px;"></div>
  <div class="dmg4">
      <input type="text" name="attr_dmg4" min="0" style="width: 33px;"></div>
  <div class="rng4">
      <input type="text" name="attr_rng4" min="0" style="width: 33px;"></div>
  <div class="qty4">
      <input type="text" name="attr_qty4" min="-1" style="width: 33px;"></div>

  <div class="equipped4">
      <input type="radio" name="attr_atkequip" value="4"/>Atk.&nbsp;&nbsp;
      <input type="radio" name="attr_pryequip" value="4"/>Parry&nbsp;&nbsp;
      <input type="radio" name="attr_gplequip" value="4"/>Grapple</div>
  <div class="wpntypemove"><div class="wpntype4">
      <select name="attr_wpntype4" id="wgtmsrr">
      <option value="1" style="width: 33px;">Weapon</option>
      <option value="2" style="width: 33px;">Shield</option>
  </select></div></div>

  <div class="result5">
      <input type="text" name="attr_result5" step="0.5" style="width: 43px;" readonly></div>
  <div class="weapon5">
      <input type="text" name="attr_weapon5"></div>
  <div class="bulk5">
      <input type="text" name="attr_bulk5" min="0" style="width: 33px;"></div>
  <div class="dmg5">
      <input type="text" name="attr_dmg5" min="0" style="width: 33px;"></div>
  <div class="rng5">
      <input type="text" name="attr_rng5" min="0" style="width: 33px;"></div>
  <div class="qty5">
      <input type="text" name="attr_qty5" min="-1" style="width: 33px;"></div>

  <div class="equipped5">
      <input type="radio" name="attr_atkequip" value="5"/>Atk.&nbsp;&nbsp;
      <input type="radio" name="attr_pryequip" value="5"/>Parry&nbsp;&nbsp;
      <input type="radio" name="attr_gplequip" value="5"/>Grapple</div>
  <div class="wpntypemove"><div class="wpntype5">
      <select name="attr_wpntype5" id="wgtmsrr">
      <option value="1" style="width: 33px;">Weapon</option>
      <option value="2" style="width: 33px;">Shield</option>
  </select></div></div>

  <div class="armname">
      <input type="text" name="attr_armname"></div>
  <div class="bulka">
      <input type="text" name="attr_bulka" style="width: 25px;"></div>
  <div class="armdur">
      <input type="number" name="attr_armdur" min="0" style="width: 35px;"></div>
  <div class="armoractive">
      <input type="checkbox" name="attr_armoractive1" value="1" style="width: 13px;" checked>&nbsp;Armor&nbsp;&nbsp;
      <input type="checkbox" name="attr_armoractive2" value="1" style="width: 13px;">&nbsp;Absorption</div>

  <div class="absorption">
      <input type="text" name="attr_absorption" min="0" style="width: 23px;"></div>
  <div class="absorptiondur">
      <input type="text" name="attr_absorptiondur" style="width: 23px;"></div>

  <div class="stamtax">
      <input type="text" name="attr_stamtax" min="0" style="width: 33px;"></div>
  <div class="offbal">
      <input type="text" name="attr_offbal" min="0" max="3" style="width: 33px;"></div>

  <div class="toggle">
      <input type="radio" name="attr_toggle" value="1" checked/>Melee&nbsp;&nbsp;
      <input type="radio" name="attr_toggle" value="2"/>Ranged</div>
  <div class="dedicatedstamina">
      <input type="number" name="attr_dedsta" min="0" style="width: 36px;"></div>

  <div class="atkboxcovered">
      <input type="number" name="attr_atkboxcovered" min="0" max="0.75" step="0.25" style="width: 50px;"></div>
  <div class="atkboxgrapple">
      <input type="checkbox" name="attr_atkboxgrapple" value="1" unchecked></div>
  <div class="atkboxopportunity">
      <input type="checkbox" name="attr_atkboxopportunity" value="1" unchecked></div>
  <div class="atkboxpaired">
      <input type="checkbox" name="attr_atkboxpaired" value="1" unchecked></div>
  <div class="atkboxsqueeze">
      <input type="checkbox" name="attr_atkboxsqueeze" value="1" unchecked></div>
  <div class="atkboxunseen">
      <input type="checkbox" name="attr_atkboxunseen" value="1" unchecked></div>
  <div class="attack">
      <button type="action" name="act_attack">Attack!</button></div>

  <div class="dmgboxhit">
      <input type="number" name="attr_dmgboxhit" min="0" style="width: 37px;"></div>
  <div class="calcdmg">
      <button type="action" name="act_calcdmg">Calculate Damage</button></div>

  <div class="defboxgrapple">
      <input type="checkbox" name="attr_defboxgrapple" value="1" unchecked></div>
  <div class="defboxsqueeze">
      <input type="checkbox" name="attr_defboxsqueeze" value="1" unchecked></div>
  <div class="defboxunseen">
      <input type="checkbox" name="attr_defboxunseen" value="1" unchecked></div>

  <div class="parrytotal">
      <input type="text" name="attr_parrytotal" min="0" style="width: 43px;" readonly></div>
  <div class="parry">
      <button type="action" name="act_parry">Parry!</button></div>
  <div class="defboxranged">
      <input type="checkbox" name="attr_defboxranged" value="1" unchecked></div>

  <div class="dodgetotal">
      <input type="text" name="attr_dodgetotal" min="0" style="width: 43px;" readonly></div>
  <div class="dodge">
      <button type="action" name="act_dodge">Dodge!</button></div>
  <div class="defboxbulk">
      <input type="number" name="attr_defboxbulk" min="0" style="width: 34px;"></div>
  <div class="defboxmove">
      <input type="checkbox" name="attr_defboxmove" value="1" unchecked></div>

  <div class="magicsoak">
      <input type="radio" name="attr_resistradio" value="0" checked/>Normal&nbsp;&nbsp;
      <input type="radio" name="attr_resistradio" value="1"/>Magic&nbsp;&nbsp;
      <input type="radio" name="attr_resistradio" value="2"/>Enviro.</div>
  <div class="resistnumber">
      <input type="text" name="attr_soaktotaltotal" min="0" style="width: 43px;" readonly></div>
  <div class="resist">
      <button type="action" name="act_resist">Resist!</button></div>
  <div class="drisk">
      <input type="number" name="attr_drisk" min="0" style="width: 40px;"></div>
  <div class="res">
      <input type="checkbox" name="attr_res" value="1" style="width: 13px;">&nbsp;Resistant</div>
  <div class="vul">
      <input type="checkbox" name="attr_vul" value="1" style="width: 13px;">&nbsp;Vulnerable</div>

  <div class="cute">
      <input type="text" name="attr_cute" min="0" style="width: 33px;"></div>
  <div class="checkcute">
    <button type="action" name="act_checkcute">R</button></div>
  <div class="spook">
      <input type="text" name="attr_spook" min="0" style="width: 33px;"></div>
  <div class="checkspook">
    <button type="action" name="act_checkspook">R</button></div>

  <div class="endear">
    <button type="action" name="act_endear">Endear</button></div>
  <div class="deceive">
    <button type="action" name="act_deceive">Deceive</button></div>
  <div class="bully">
    <button type="action" name="act_bully">Bully</button></div>
  <div class="convince">
    <button type="action" name="act_convince">Convince</button></div>

</div>
</div>

  <p><div class="unimod1">
      <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <input type="text" name="attr_hearttotal" style="width: 27px;" readonly>&nbsp;<b>Heart</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <input type="text" name="attr_soultotal" style="width: 27px;" readonly>&nbsp;<b>Soul</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <input type="text" name="attr_stamtotal" style="width: 27px;" readonly>&nbsp;<b>Stamina</b> <br>
      <input type="number" name="attr_unimod" style="width: 37px;">&nbsp;+Universal Rolls&nbsp;&nbsp;&nbsp;<input type="checkbox" name="attr_unilock" value="1" style="width: 33px;">Lock Bonus<br>
      <input type="number" name="attr_unirerollmod" style="width: 37px;">&nbsp;+Universal Rerolls&nbsp;&nbsp;&nbsp;<input type="checkbox" name="attr_unirerolllock" value="1" style="width: 33px;">Lock Bonus<br>
      <input type="number" name="attr_grapplearms" min="0" style="width: 37px;">&nbsp;+Grappling Arms (beyond the first)</div>
      
      </p>

<rolltemplate class="sheet-rolltemplate-attack">
    <div class="sheet-template-container">
        <h2>Attack Successes</h2>
        <div class="sheet-results">
            <h2>{{computed::rollattack}}</h2>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-attackplusreroll">
    <div class="sheet-template-container">
        <h2>Attack Successes</h2>
        <div class="sheet-results">
            <h2>{{computed::rollattackplusreroll}}</h2>
        </div>
        <div class="test2">
            <h3>Attack Reroll {{computed::rollattackr1}}</h3>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-grapple">
    <div class="sheet-template-container">
        <h2>Grapple Successes</h2>
        <div class="sheet-results">
            <h2>{{computed::rollgrapple}}</h2>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-grappleplusreroll">
    <div class="sheet-template-container">
        <h2>Grapple Successes</h2>
        <div class="sheet-results">
            <h2>{{computed::rollgrappleplusreroll}}</h2>
        </div>
        <div class="test2">
            <h3>Grapple Reroll {{computed::rollgrappler1}}</h3>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-dodge">
    <div class="sheet-template-container">
        <h2>Dodge Successes</h2>
        <div class="sheet-results">
            <h2>{{computed::rolldodge}}</h2>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-dodgeplusreroll">
    <div class="sheet-template-container">
        <h2>Dodge Successes</h2>
        <div class="sheet-results">
            <h2>{{computed::rolldodgeplusreroll}}</h2>
        </div>
        <div class="test2">
            <h3>Dodge Reroll {{computed::rolldodger1}}</h3>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-parry">
    <div class="sheet-template-container">
        <h2>Parry Successes</h2>
        <div class="sheet-results">
            <h2>{{computed::rollparry}}</h2>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-parryplusreroll">
    <div class="sheet-template-container">
        <h2>Parry Successes</h2>
        <div class="sheet-results">
            <h2>{{computed::rollparryplusreroll}}</h2>
        </div>
        <div class="test2">
            <h3>Parry Reroll {{computed::rollparryr1}}</h3>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-mightcheckplusreroll">
    <div class="sheet-template-container">
        <h2>Might Check Successes</h2>
        <div class="sheet-results">
            <h2>{{computed::rollmightcheckplusreroll}}</h2>
        </div>
        <div class="test2">
            <h3>Check Reroll {{rollmightcheckr1}}</h3>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-mightcheck">
    <div class="sheet-template-container">
        <h2>Might Check Successes</h2>
        <div class="sheet-results">
            <h2>{{rollmightcheck}}</h2>
        </div>
    </div>
</rolltemplate>



<rolltemplate class="sheet-rolltemplate-insightcheckplusreroll">
    <div class="sheet-template-container">
        <h2>Insight Check Successes</h2>
        <div class="sheet-results">
            <h2>{{computed::rollinsightcheckplusreroll}}</h2>
        </div>
        <div class="test2">
            <h3>Check Reroll {{rollinsightcheckr1}}</h3>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-insightcheck">
    <div class="sheet-template-container">
        <h2>Insight Check Successes</h2>
        <div class="sheet-results">
            <h2>{{rollinsightcheck}}</h2>
        </div>
    </div>
</rolltemplate>


<rolltemplate class="sheet-rolltemplate-shellcheckplusreroll">
    <div class="sheet-template-container">
        <h2>Shell Check Successes</h2>
        <div class="sheet-results">
            <h2>{{computed::rollshellcheckplusreroll}}</h2>
        </div>
        <div class="test2">
            <h3>Check Reroll {{rollshellcheckr1}}</h3>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-shellcheck">
    <div class="sheet-template-container">
        <h2>Shell Check Successes</h2>
        <div class="sheet-results">
            <h2>{{rollshellcheck}}</h2>
        </div>
    </div>
</rolltemplate>


<rolltemplate class="sheet-rolltemplate-gracecheckplusreroll">
    <div class="sheet-template-container">
        <h2>Grace Check Successes</h2>
        <div class="sheet-results">
            <h2>{{computed::rollgracecheckplusreroll}}</h2>
        </div>
        <div class="test2">
            <h3>Check Reroll {{rollgracecheckr1}}</h3>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-gracecheck">
    <div class="sheet-template-container">
        <h2>Grace Check Successes</h2>
        <div class="sheet-results">
            <h2>{{rollgracecheck}}</h2>
        </div>
    </div>
</rolltemplate>


<rolltemplate class="sheet-rolltemplate-cutecheckplusreroll">
    <div class="sheet-template-container">
        <h2>Cute Check Successes</h2>
        <div class="sheet-results">
            <h2>{{computed::rollcutecheckplusreroll}}</h2>
        </div>
        <div class="test2">
            <h3>Check Reroll {{rollcutecheckr1}}</h3>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-cutecheck">
    <div class="sheet-template-container">
        <h2>Cute Check Successes</h2>
        <div class="sheet-results">
            <h2>{{rollcutecheck}}</h2>
        </div>
    </div>
</rolltemplate>


<rolltemplate class="sheet-rolltemplate-spookcheckplusreroll">
    <div class="sheet-template-container">
        <h2>Spook Check Successes</h2>
        <div class="sheet-results">
            <h2>{{computed::rollspookcheckplusreroll}}</h2>
        </div>
        <div class="test2">
            <h3>Check Reroll {{rollspookcheckr1}}</h3>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-spookcheck">
    <div class="sheet-template-container">
        <h2>Spook Check Successes</h2>
        <div class="sheet-results">
            <h2>{{rollspookcheck}}</h2>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-defspellsaveplusreroll">
    <div class="sheet-template-container">
        <h2>Magic Defensive Save</h2>
        <div class="sheet-results">
            <h2>{{computed::rolldefspellsaveplusreroll}}</h2>
        </div>
        <div class="test2">
            <h3>Check Reroll {{rolldefspellsaver1}}</h3>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-defspellsave">
    <div class="sheet-template-container">
        <h2>Magic Defensive Save</h2>
        <div class="sheet-results">
            <h2>{{rolldefspellsave}}</h2>
        </div>
    </div>
</rolltemplate>


<rolltemplate class="sheet-rolltemplate-initnoreroll">
    <div class="sheet-template-container">
        <h2>Initiative</h2>
        <div class="sheet-results">
            <h2>{{rollinitnoreroll}}</h2>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-init">
    <div class="sheet-template-container">
        <h2>Initiative</h2>
        <div class="sheet-results">
            <h2>{{computed::rollinit}}</h2>
        <div class="test2">
            <h3>init. Reroll {{rollinitreroll}}</h3>
        </div>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-damage">
    <div class="sheet-template-container">
        <h2>Damage Risk</h2>
        <div class="sheet-results">
            <h2>{{rolldamage}}</h2>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-soak">
    <div class="sheet-template-container">
        <h2>Final Damage</h2>
        <div class="sheet-results">
            <h2>{{computed::rollsoak}}</h2>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-soakplusreroll">
    <div class="sheet-template-container">
        <h2>Final Damage</h2>
        <div class="sheet-results">
            <h2>{{computed::rollsoakplusreroll}}</h2>
        </div>
        <div class="test2">
            <h3>Soak Reroll {{computed::rollsoakr1}}</h3>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-magicattack">
    <div class="sheet-template-container">
        <p><h2>Magic Damage</h2>
        <div class="sheet-results">
            <h2>{{computed::rollmagicdamage}}</h2>
        </div></p>
        <p><h2>Magic Attack Roll</h2>
            <div class="sheet-results">
            <h2>{{computed::rollmagicattack}}</h2>
        </div></p>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-magicattackplusreroll">
    <div class="sheet-template-container">
        <p><h2>Magic Damage</h2>
        <div class="sheet-results">
            <h2>{{computed::rollmagicdamage}}</h2>
        </div></p>
        <h2>Magic Attack Roll</h2>
            <div class="sheet-results">
            <h2>{{computed::rollmagicattackplusreroll}}</h2>
        </div>
        <div class="test2">
            <h3>Magic Attack Reroll {{computed::rollspellfinalattackrerollr1}}</h3>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-magic">
    <div class="sheet-template-container">
        <h2>Magic Damage (or healing)</h2>
        <div class="sheet-results">
            <h2>{{computed::rollmagicdmgheal}}</h2>
        </div>
    </div>
</rolltemplate>


<rolltemplate class="sheet-rolltemplate-magicsaveplusreroll">
    <div class="sheet-template-container">
        <p><h2>Magic Damage</h2>
        <div class="sheet-results">
            <h2>{{computed::rollmagicdamage}}</h2>
        </div></p>
        <h2>Magic Offensive Save </h2>
            <div class="sheet-results">
            <h2>{{computed::rollmagicsaveplusreroll}}</h2>
        </div>
        <div class="test2">
            <h3>Save Reroll {{computed::rollmagicsavererollr1}}</h3>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-magicsave">
    <div class="sheet-template-container">
        <p><h2>Magic Damage</h2>
        <div class="sheet-results">
            <h2>{{computed::rollmagicdamage}}</h2>
        </div></p>
        <h2>Magic Offensive Save</h2>
            <div class="sheet-results">
            <h2>{{computed::rollmagicsave}}</h2>
        </div>
    </div>
</rolltemplate>


<rolltemplate class="sheet-rolltemplate-soakdot1">
    <div class="sheet-template-container">
        <h2>DoT #1 Damage</h2>
        <div class="sheet-results">
            <h2>{{computed::rollsoakdot1}}</h2>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-soakdot1plusreroll">
    <div class="sheet-template-container">
        <h2>DoT #1 Damage</h2>
        <div class="sheet-results">
            <h2>{{computed::rollsoakdot1plusreroll}}</h2>
        </div>
        <div class="test2">
            <h3>Soak DoT Reroll {{computed::rollsoakdot1r1}}</h3>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-soakdot2">
    <div class="sheet-template-container">
        <h2>DoT #2 Damage</h2>
        <div class="sheet-results">
            <h2>{{computed::rollsoakdot2}}</h2>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-soakdot2plusreroll">
    <div class="sheet-template-container">
        <h2>DoT #2 Damage</h2>
        <div class="sheet-results">
            <h2>{{computed::rollsoakdot2plusreroll}}</h2>
        </div>
        <div class="test2">
            <h3>Soak DoT Reroll {{computed::rollsoakdot2r1}}</h3>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-soakdot3">
    <div class="sheet-template-container">
        <h2>DoT #3 Damage</h2>
        <div class="sheet-results">
            <h2>{{computed::rollsoakdot3}}</h2>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-soakdot3plusreroll">
    <div class="sheet-template-container">
        <h2>DoT #3 Damage</h2>
        <div class="sheet-results">
            <h2>{{computed::rollsoakdot3plusreroll}}</h2>
        </div>
        <div class="test2">
            <h3>Soak DoT Reroll {{computed::rollsoakdot3r1}}</h3>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-endear">
    <div class="sheet-template-container">
        <h2>Endearing Check</h2>
        <div class="sheet-results">
            <h2>{{computed::rollendear}}</h2>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-endearplusreroll">
    <div class="sheet-template-container">
        <h2>Endearing Check</h2>
        <div class="sheet-results">
            <h2>{{computed::rollendearplusreroll}}</h2>
        </div>
        <div class="test2">
            <h3>Endear Reroll {{computed::rollendearr1}}</h3>
        </div>
    </div>
</rolltemplate>


<rolltemplate class="sheet-rolltemplate-bully">
    <div class="sheet-template-container">
        <h2>Bullying Check</h2>
        <div class="sheet-results">
            <h2>{{computed::rollbully}}</h2>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-bullyplusreroll">
    <div class="sheet-template-container">
        <h2>Bullying Check</h2>
        <div class="sheet-results">
            <h2>{{computed::rollbullyplusreroll}}</h2>
        </div>
        <div class="test2">
            <h3>Bully Reroll {{computed::rollbullyr1}}</h3>
        </div>
    </div>
</rolltemplate>


<rolltemplate class="sheet-rolltemplate-deceive">
    <div class="sheet-template-container">
        <h2>Deceiving Check</h2>
        <div class="sheet-results">
            <h2>{{computed::rolldeceive}}</h2>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-deceiveplusreroll">
    <div class="sheet-template-container">
        <h2>Deceiving Check</h2>
        <div class="sheet-results">
            <h2>{{computed::rolldeceiveplusreroll}}</h2>
        </div>
        <div class="test2">
            <h3>Deceive Reroll {{computed::rolldeceiver1}}</h3>
        </div>
    </div>
</rolltemplate>


<rolltemplate class="sheet-rolltemplate-convince">
    <div class="sheet-template-container">
        <h2>Convincing Check</h2>
        <div class="sheet-results">
            <h2>{{computed::rollconvince}}</h2>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-convinceplusreroll">
    <div class="sheet-template-container">
        <h2>Convincing Check</h2>
        <div class="sheet-results">
            <h2>{{computed::rollconvinceplusreroll}}</h2>
        </div>
        <div class="test2">
            <h3>Convince Reroll {{computed::rollconvincer1}}</h3>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-focusheal">
    <div class="sheet-template-container">
        <h2>Focus Heal</h2>
        <div class="sheet-results">
            <h2>{{computed::rollfocusheal}}</h2>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-focushealplusreroll">
    <div class="sheet-template-container">
        <h2>Focus Heal</h2>
        <div class="sheet-results">
            <h2>{{computed::rollfocusheal}}</h2>
        </div>
        <div class="test2">
            <h3>Convince Reroll {{computed::rollfocushealr1}}</h3>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-sleepheal">
    <div class="sheet-template-container">
        <h2>Sleep | Camp Action</h2>
        <div class="sheet-results">
            <h3>Hearts Healed: {{computed::rollsleepheal}}</h3>
            <h3>Soul Resplenished: {{computed::rollsleepsoul}}</h3>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-error">
    <div class="sheet-template-container">
        <h2>Error!</h2>
        <div class="sheet-results">
            <h2>Not enough stamina!</h2>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-errordrisk">
    <div class="sheet-template-container">
        <h2>Error!</h2>
        <div class="sheet-results">
            <h2>No damage risk!</h2>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-errorhit">
    <div class="sheet-template-container">
        <h2>Error!</h2>
        <div class="sheet-results">
            <h2>No final hits!</h2>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-errormagic">
    <div class="sheet-template-container">
        <h2>Error!</h2>
        <div class="sheet-results">
            <h2>Not enough Soul!</h2>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-errorquick">
    <div class="sheet-template-container">
        <h2>Error!</h2>
        <div class="sheet-results">
            <h2>Can't cast more than 4 spells a turn!</h2>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-errordiffmax">
    <div class="sheet-template-container">
        <h2>Error!</h2>
        <div class="sheet-results">
            <h2>Max Difficulty exceeded, cannot cast!</h2>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-errorload">
    <div class="sheet-template-container">
        <h2>This is a Public Shaming!</h2>
        <div class="sheet-results">
            <h3>You exceeded double your Load!!!</h3>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-overcharmed">
    <div class="sheet-template-container">
        <h2>Oh my!</h2>
        <div class="sheet-results">
            <h3>You are Overcharmed!</h3>
        </div>
    </div>
</rolltemplate>

<script type="text/worker">

    on('clicked:attack', (info) => {
          getAttrs(["result","resultreroll","dedsta","stam","stamtemp","atkboxpaired","atkboxopportunity","stamtax","stamtaxtax","stamattackmodgeneral","stamattackmod","setsuccessattack","wpntype","attackoffbal","bulkcurrent","offbal","bulkcheck","shellopp","shell1","unilock","unirerolllock"], function(values) {
        let atkboxopportunity = parseInt(values.atkboxopportunity)||0;
        let wpntype = parseInt(values.wpntype)||0;
        let dedsta = parseInt(values.dedsta)||0;
        let stamattackmod = parseInt(values.stamattackmod)||0;
        let stamattackmodgeneral = parseInt(values.stamattackmodgeneral)||0;
        let stam = parseInt(values.stam)||0;
        let stamtemp = parseInt(values.stamtemp)||0;
        let stamtax = parseInt(values.stamtax)||0;
        let stamtaxmod = parseInt(values.stamtaxtax)||0;
        let attackoffbal = parseInt(values.attackoffbal)||0;
        let offbal = parseInt(values.offbal)||0;
        let bulkcurrent = parseInt(values.bulkcurrent)||0;
        let bulkcheck = parseInt(values.bulkcheck)||0;
        let shellopp = parseInt(values.shellopp)||0;
        let shell1 = parseInt(values.shell1)||0;
        let unilock = parseInt(values.unilock)||0;
        let unirerolllock = parseInt(values.unirerolllock)||0;
        let offbalextra = (bulkcurrent >= 2) ? 1 : 0;
        let offbalfinal = offbalextra + offbal + attackoffbal;
        let stamtax1 = (atkboxopportunity == 0) ? stamtax : 0;
        let paired = parseInt(values.atkboxpaired)||0;
        let stamtotal = stam + stamtemp;
        let spentstam = ((shell1 == 1) && (shellopp == 1) && (atkboxopportunity == 1)) ? 0 : dedsta + stamtax1 + stamattackmod - paired;
        if(spentstam <= stamtotal) {
            if(values.resultreroll >= "1") {
            let rollString = "&{template:attackplusreroll} {{name=Attack}} {{rollattackplusreroll=[[[[floor(@{result})]]d6>@{setsuccessattack}]]}}";
                rollString += "{{rollattackr1=[[@{resultreroll}d6>@{setsuccessattack}]]}}";
            startRoll(rollString, results => {
                const result = parseInt(values.result)||0;
                const roll = results.results.rollattackplusreroll.result;
                const reroll_calculated = results.results.rollattackr1.result;
                const rerollmin = (result - roll <= 0) ? 0 : result - roll;
                const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
                const total = roll + reroll;
            finishRoll(results.rollId, {
                rollattackplusreroll: total
            });
            });
            }
            else {
            let rollString = "&{template:attack} {{name=Attack}} {{rollattack=[[[[floor(@{result})]]d6>@{setsuccessattack}]]}}";
                rollString += "{{rollattackr1=[[0]]}}";
            startRoll(rollString, results => {
                const result = parseInt(values.result)||0;
                const roll = results.results.rollattack.result;
                const reroll_calculated = results.results.rollattackr1.result;
                const rerollmin = (result - roll <= 0) ? 0 : result - roll;
                const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
                const total = roll + reroll;
            finishRoll(results.rollId, {
                rollattack: total
            });
            });
            }
        setAttrs({
            "atkboxpaired": 0
        });
        if((stamtemp > "0") && (spentstam > stam)){
            let stammath = spentstam - stam;
            setAttrs({                            
                "stam": 0
            });
            setAttrs({
                "stamtemp": stamtemp - stammath
            });    
        }
        else {
            setAttrs({                            
                "stam": stam - spentstam
            });  
        }
        setAttrs({
            "offbal": offbalfinal
        });
        setAttrs({
            "dedstafloating": dedsta + stamattackmod
        });
        setAttrs({
            "wpntypefloating": wpntype
        });
        setAttrs({
            "dedsta": 0
        });
        
        if (atkboxopportunity == "0") {
        setAttrs({
            "stamtax": stamtax + stamtaxmod
        });
        }
        else {
        setAttrs({
            "stamtax": stamtax
        });
        }
        
        setAttrs({
            "atkboxopportunity": 0
        });

        setAttrs({
            "stamtaxnebulous": stamtax + stamtaxmod
        });
        setAttrs({
            "bulkchecknebulous": bulkcheck
        });   
        setAttrs({
            "hivemind": 0
        });
        setAttrs({
            "shellopp": 0
        });
    if (unilock == 0) {
    setAttrs({
        "unimod": 0
    });
    }
    if (unirerolllock == 0) {
    setAttrs({
        "unirerollmod": 0
    });
    }
        }
    else {
        let rollString = "&{template:error} {{name=Error}} {{rollerror=[[0]]}}";
        startRoll(rollString, results => {
            finishRoll(results.rollId, {
                });
        });
    }
    });
});

    on('clicked:grapple', (info) => {
          getAttrs(["grapplefinal","resultrerollgrapple","dedsta","stam","stamtemp","atkboxpaired","atkboxopportunity","stamtax","stamtaxtax","grappletoggle","stamgrapplemod","setsuccessattack","unilock","unirerolllock"], function(values) {
        let atkboxopportunity = parseInt(values.atkboxopportunity)||0;
        let grappletoggle = parseInt(values.grappletoggle)||0;
        let stamgrapplemod = parseInt(values.stamgrapplemod)||0;
        let dedsta = parseInt(values.dedsta)||0;
        let stam = parseInt(values.stam)||0;
        let stamtemp = parseInt(values.stamtemp)||0;
        let stamtax = parseInt(values.stamtax)||0;
        let unilock = parseInt(values.unilock)||0;
        let unirerolllock = parseInt(values.unirerolllock)||0;
        let stamtaxmod = parseInt(values.stamtaxtax)||0;
        let stamtax1 = (atkboxopportunity == 0) ? stamtax : 0;
        let paired = parseInt(values.atkboxpaired)||0;
        let stamtotal = stam + stamtemp;
        let spentstam = (grappletoggle == 1) ? dedsta + stamtax1 + stamgrapplemod - paired : dedsta;
        if(spentstam <= stamtotal && grappletoggle == "1") {
            let rollString = "&{template:grapple} {{name=Grapple}} {{rollgrapple=[[[[floor(@{grapplefinal})]]d6>@{setsuccessattack}]]}}";
            if(values.resultrerollgrapple >= "1") {
                rollString += "{{rollgrappler1=[[@{resultrerollgrapple}d6>@{setsuccessattack}]]}}";
            } else {
            // this else branch is just to make the later code easier. In your roll temmplate you'd only display it if it has a value > 0
                rollString += "{{rollgrappler1=[[0]]}}";
            }
            startRoll(rollString, results => {
                const result = parseInt(values.grapplefinal)||0;
                const roll = results.results.rollgrapple.result;
                const reroll_calculated = results.results.rollgrappler1.result;
                const rerollmin = (result - roll <= 0) ? 0 : result - roll;
                const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
                const total = roll + reroll;
            finishRoll(results.rollId, {
                rollgrapple: total
            });
            });

        setAttrs({
            "atkboxpaired": 0
        });

        if((stamtemp > "0") && (spentstam > stam)){
            let stammath = spentstam - stam;
            setAttrs({                            
                "stam": 0
            });
            setAttrs({
                "stamtemp": stamtemp - stammath
            });    
        }
        else {
            setAttrs({                            
                "stam": stam - spentstam
            });  
        }
        setAttrs({
            "dedsta": 0
        });
        
        if (atkboxopportunity == "0") {
        setAttrs({
            "stamtax": stamtax + stamtaxmod
        });
        }
        else {
        setAttrs({
            "stamtax": stamtax
        });
        }
        
        setAttrs({
            "atkboxopportunity": 0
        });
        
        setAttrs({
            "stamtaxnebulous": stamtax + stamtaxmod
        });
        setAttrs({
            "bulkchecknebulous": bulkcheck
        });
    if (unilock == 0) {
    setAttrs({
        "unimod": 0
    });
    }
    if (unirerolllock == 0) {
    setAttrs({
        "unirerollmod": 0
    });
    }
        }
    if (spentstam <= stamtotal && grappletoggle == "2") {
            let rollString = "&{template:grapple} {{name=Grapple}} {{rollgrapple=[[[[floor(@{grapplefinal})]]d6>@{setsuccessattack}]]}}";
            if(values.resultrerollgrapple >= "1") {
                rollString += "{{rollgrappler1=[[@{resultrerollgrapple}d6>@{setsuccessattack}]]}}";
            } else {
            // this else branch is just to make the later code easier. In your roll temmplate you'd only display it if it has a value > 0
                rollString += "{{rollgrappler1=[[0]]}}";
            }
            startRoll(rollString, results => {
                const result = parseInt(values.grapplefinal)||0;
                const roll = results.results.rollgrapple.result;
                const reroll_calculated = results.results.rollgrappler1.result;
                const rerollmin = (result - roll <= 0) ? 0 : result - roll;
                const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
                const total = roll + reroll;
            finishRoll(results.rollId, {
                rollgrapple: total
            });
            });
        if((stamtemp > "0") && (spentstam > stam)){
            let stammath = spentstam - stam;
            setAttrs({                            
                "stam": 0
            });
            setAttrs({
                "stamtemp": stamtemp - stammath
            });    
        }
        else {
            setAttrs({                            
                "stam": stam - spentstam
            });  
        }
        setAttrs({
            "dedsta": 0
        });
    if (unilock == 0) {
    setAttrs({
        "unimod": 0
    });
    }
    if (unirerolllock == 0) {
    setAttrs({
        "unirerollmod": 0
    });
    }
    }
    if(spentstam > stamtotal) {
        let rollString = "&{template:error} {{name=Error}} {{rollerror=[[0]]}}";
        startRoll(rollString, results => {
            finishRoll(results.rollId, {
                });
        });
    }
    });
});

    on('clicked:dodge', (info) => {
          getAttrs(["dodgetotal","gracereroll","dedsta","stam","stamtemp","offbal","defboxmove","bulkcheck","stamdodgemod","setsuccessdodge","dodgereroll","unilock","unirerolllock"], function(values) {
        let dedsta = parseInt(values.dedsta)||0;
        let stamdodgemod = parseInt(values.stamdodgemod)||0;
        let stam = parseInt(values.stam)||0;
        let stamtemp = parseInt(values.stamtemp)||0;
        let offbal = parseInt(values.offbal)||0;
        let unilock = parseInt(values.unilock)||0;
        let unirerolllock = parseInt(values.unirerolllock)||0;
        let defboxmove = parseInt(values.defboxmove)||0;
        let bulkcheck = parseInt(values.bulkcheck)||0;
        let stamtotal = stam + stamtemp;
        let spentstam = dedsta + bulkcheck + stamdodgemod;
        if(spentstam <= stamtotal) {
            if(values.dodgereroll >= "1") {
            let rollString = "&{template:dodgeplusreroll} {{name=Dodge}} {{rolldodgeplusreroll=[[[[floor(@{dodgetotal})]]d6>@{setsuccessdodge}]]}}";
                rollString += "{{rolldodger1=[[@{dodgereroll}d6>@{setsuccessdodge}]]}}";
            startRoll(rollString, results => {
            const dodgetotal = parseInt(values.dodgetotal)||0;
            const roll = results.results.rolldodgeplusreroll.result;
            const reroll_calculated = results.results.rolldodger1.result;
            const rerollmin = (dodgetotal - roll <= 0) ? 0 : dodgetotal - roll;
            const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
            const total = roll + reroll;
            finishRoll(results.rollId, {
                rolldodgeplusreroll: total
                });
        });
            }
            else {
            let rollString = "&{template:dodge} {{name=Dodge}} {{rolldodge=[[[[floor(@{dodgetotal})]]d6>@{setsuccessdodge}]]}}";
                rollString += "{{rolldodger11=[[0]]}}";
            startRoll(rollString, results => {
            const dodgetotal = parseInt(values.dodgetotal)||0;
            const roll = results.results.rolldodge.result;
            const reroll_calculated = results.results.rolldodger11.result;
            const rerollmin = (dodgetotal - roll <= 0) ? 0 : dodgetotal - roll;
            const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
            const total = roll + reroll;
            finishRoll(results.rollId, {
                rolldodge: total
                });
        }); 
            }
        if(defboxmove == "1") {
            setAttrs({                            
                "offbal": offbal + 1
            });
        }
        setAttrs({
            "defboxmove": 0
        });
        setAttrs({
            "defboxbulk": 0
        });
        if((stamtemp > "0") && (spentstam > stam)){
            let stammath = spentstam - stam;
            setAttrs({                            
                "stam": 0
            });
            setAttrs({
                "stamtemp": stamtemp - stammath
            });    
        }
        else {
            setAttrs({                            
                "stam": stam - spentstam
            });  
        }
        setAttrs({
            "dedsta": 0
        });
    if (unilock == 0) {
    setAttrs({
        "unimod": 0
    });
    }
    if (unirerolllock == 0) {
    setAttrs({
        "unirerollmod": 0
    });
    }
        }
        else {
        let rollString = "&{template:error} {{name=Error}} {{rollerror=[[0]]}}";
        startRoll(rollString, results => {
            finishRoll(results.rollId, {
                });
            });
        }
    });
});

on("change:gracereroll change:dodgererollbuff sheet:opened", function() {  
  getAttrs(["gracereroll","dodgererollbuff"], function(values) {
    let gracereroll = parseFloat(values.gracereroll)||0;
    let dodgererollbuff = parseInt(values.dodgererollbuff)||0;
    setAttrs({
        "dodgereroll": gracereroll + dodgererollbuff
    });
  });
});

    on('clicked:parry', (info) => {
          getAttrs(["parrytotal","mightreroll","dedsta","stam","stamtemp","bulkcheck","stamparrymod","setsuccessparry","parryreroll","unilock","unirerolllock"], function(values) {
        let dedsta = parseInt(values.dedsta)||0;
        let stamparrymod = parseInt(values.stamparrymod)||0;
        let stam = parseInt(values.stam)||0;
        let stamtemp = parseInt(values.stamtemp)||0;
        let bulkcheck = parseInt(values.bulkcheck)||0;
        let unilock = parseInt(values.unilock)||0;
        let unirerolllock = parseInt(values.unirerolllock)||0;
        let stamtotal = stam + stamtemp;
        let spentstam = dedsta + bulkcheck + stamparrymod;
        if(spentstam <= stamtotal) {
            if(values.parryreroll >= "1") {
            let rollString = "&{template:parryplusreroll} {{name=Parry}} {{rollparryplusreroll=[[[[floor(@{parrytotal})]]d6>@{setsuccessparry}]]}}";
                rollString += "{{rollparryr1=[[@{parryreroll}d6>@{setsuccessparry}]]}}";
            startRoll(rollString, results => {
            const parrytotal = parseInt(values.parrytotal)||0;
            const roll = results.results.rollparryplusreroll.result;
            const reroll_calculated = results.results.rollparryr1.result;
            const rerollmin = (parrytotal - roll <= 0) ? 0 : parrytotal - roll;
            const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
            const total = roll + reroll;
            finishRoll(results.rollId, {
                rollparryplusreroll: total
                });
        });
            }
            else {
            let rollString = "&{template:parry} {{name=Parry}} {{rollparry=[[[[floor(@{parrytotal})]]d6>@{setsuccessparry}]]}}";
                rollString += "{{rollparryr1=[[0]]}}";
            startRoll(rollString, results => {
            const parrytotal = parseInt(values.parrytotal)||0;
            const roll = results.results.rollparry.result;
            const reroll_calculated = results.results.rollparryr1.result;
            const rerollmin = (parrytotal - roll <= 0) ? 0 : parrytotal - roll;
            const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
            const total = roll + reroll;
            finishRoll(results.rollId, {
                rollparry: total
                });
        });
            }
        setAttrs({
            "defboxranged": 0
        });
        if((stamtemp > "0") && (spentstam > stam)){
            let stammath = spentstam - stam;
            setAttrs({                            
                "stam": 0
            });
            setAttrs({
                "stamtemp": stamtemp - stammath
            });    
        }
        else {
            setAttrs({                            
                "stam": stam - spentstam
            });  
        }
        setAttrs({
            "dedsta": 0
        });
    if (unilock == 0) {
    setAttrs({
        "unimod": 0
    });
    }
    if (unirerolllock == 0) {
    setAttrs({
        "unirerollmod": 0
    });
    }
        }
        else {
        let rollString = "&{template:error} {{name=Error}} {{rollerror=[[0]]}}";
        startRoll(rollString, results => {
            finishRoll(results.rollId, {
                });
            });
        }
    });
});


    on('clicked:endear', (info) => {
          getAttrs(["endearneb","endearnebreroll","unilock","unirerolllock"], function(values) {
        let endearneb = parseInt(values.endearneb)||0;
        let endearnebreroll = parseInt(values.endearnebreroll)||0;
        let unilock = parseInt(values.unilock)||0;
        let unirerolllock = parseInt(values.unirerolllock)||0;
            if(endearnebreroll >= "1") {
            let rollString = "&{template:endearplusreroll} {{name=Endearplusreroll}} {{rollendearplusreroll=[[[[floor(@{endearneb})]]d6>5]]}}";
                rollString += "{{rollendearr1=[[@{endearnebreroll}d6>5]]}}";
            startRoll(rollString, results => {
            const endeartotal = parseInt(values.endearneb)||0;
            const roll = results.results.rollendearplusreroll.result;
            const reroll_calculated = results.results.rollendearr1.result;
            const rerollmin = (endeartotal - roll <= 0) ? 0 : endeartotal - roll;
            const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
            const total = roll + reroll;
            finishRoll(results.rollId, {
                rollendearplusreroll: total
                });
        });
            }
            else {
            let rollString = "&{template:endear} {{name=Endear}} {{rollendear=[[[[floor(@{endearneb})]]d6>5]]}}";
                rollString += "{{rollendearr1=[[0]]}}";
            startRoll(rollString, results => {
            const roll = results.results.rollendear.result;
            finishRoll(results.rollId, {
                rollendear: roll
                });
        });
            }
    if (unilock == 0) {
    setAttrs({
        "unimod": 0
    });
    }
    if (unirerolllock == 0) {
    setAttrs({
        "unirerollmod": 0
    });
    }
    });
});

    on('clicked:bully', (info) => {
          getAttrs(["bullyneb","bullynebreroll","unilock","unirerolllock"], function(values) {
        let bullyneb = parseInt(values.bullyneb)||0;
        let bullynebreroll = parseInt(values.bullynebreroll)||0;
        let unilock = parseInt(values.unilock)||0;
        let unirerolllock = parseInt(values.unirerolllock)||0;
            if(bullynebreroll >= "1") {
            let rollString = "&{template:bullyplusreroll} {{name=Bullyplusreroll}} {{rollbullyplusreroll=[[[[floor(@{bullyneb})]]d6>5]]}}";
                rollString += "{{rollbullyr1=[[@{bullynebreroll}d6>5]]}}";
            startRoll(rollString, results => {
            const bullytotal = parseInt(values.bullyneb)||0;
            const roll = results.results.rollbullyplusreroll.result;
            const reroll_calculated = results.results.rollbullyr1.result;
            const rerollmin = (bullytotal - roll <= 0) ? 0 : bullytotal - roll;
            const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
            const total = roll + reroll;
            finishRoll(results.rollId, {
                rollbullyplusreroll: total
                });
        });
            }
            else {
            let rollString = "&{template:bully} {{name=Bully}} {{rollbully=[[[[floor(@{bullyneb})]]d6>5]]}}";
                rollString += "{{rollbullyr1=[[0]]}}";
            startRoll(rollString, results => {
            const roll = results.results.rollbully.result;
            finishRoll(results.rollId, {
                rollbully: roll
                });
        });
            }
    if (unilock == 0) {
    setAttrs({
        "unimod": 0
    });
    }
    if (unirerolllock == 0) {
    setAttrs({
        "unirerollmod": 0
    });
    }
    });
});

    on('clicked:deceive', (info) => {
          getAttrs(["deceiveneb","deceivenebreroll","unilock","unirerolllock"], function(values) {
        let deceiveneb = parseInt(values.deceiveneb)||0;
        let deceivenebreroll = parseInt(values.deceivenebreroll)||0;
        let unilock = parseInt(values.unilock)||0;
        let unirerolllock = parseInt(values.unirerolllock)||0;
            if(deceivenebreroll >= "1") {
            let rollString = "&{template:deceiveplusreroll} {{name=Deceiveplusreroll}} {{rolldeceiveplusreroll=[[[[floor(@{deceiveneb})]]d6>5]]}}";
                rollString += "{{rolldeceiver1=[[@{deceivenebreroll}d6>5]]}}";
            startRoll(rollString, results => {
            const deceivetotal = parseInt(values.deceiveneb)||0;
            const roll = results.results.rolldeceiveplusreroll.result;
            const reroll_calculated = results.results.rolldeceiver1.result;
            const rerollmin = (deceivetotal - roll <= 0) ? 0 : deceivetotal - roll;
            const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
            const total = roll + reroll;
            finishRoll(results.rollId, {
                rolldeceiveplusreroll: total
                });
        });
            }
            else {
            let rollString = "&{template:deceive} {{name=Deceive}} {{rolldeceive=[[[[floor(@{deceiveneb})]]d6>5]]}}";
                rollString += "{{rolldeceiver1=[[0]]}}";
            startRoll(rollString, results => {
            const roll = results.results.rolldeceive.result;
            finishRoll(results.rollId, {
                rolldeceive: roll
                });
        });
            }
    if (unilock == 0) {
    setAttrs({
        "unimod": 0
    });
    }
    if (unirerolllock == 0) {
    setAttrs({
        "unirerollmod": 0
    });
    }
    });
});

    on('clicked:convince', (info) => {
          getAttrs(["convinceneb","convincenebreroll","unilock","unirerolllock"], function(values) {
        let convinceneb = parseInt(values.convinceneb)||0;
        let convincenebreroll = parseInt(values.convincenebreroll)||0;
        let unilock = parseInt(values.unilock)||0;
        let unirerolllock = parseInt(values.unirerolllock)||0;
            if(convincenebreroll >= "1") {
            let rollString = "&{template:convinceplusreroll} {{name=Convinceplusreroll}} {{rollconvinceplusreroll=[[[[floor(@{convinceneb})]]d6>5]]}}";
                rollString += "{{rollconvincer1=[[@{convincenebreroll}d6>5]]}}";
            startRoll(rollString, results => {
            const convincetotal = parseInt(values.convinceneb)||0;
            const roll = results.results.rollconvinceplusreroll.result;
            const reroll_calculated = results.results.rollconvincer1.result;
            const rerollmin = (convincetotal - roll <= 0) ? 0 : convincetotal - roll;
            const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
            const total = roll + reroll;
            finishRoll(results.rollId, {
                rollconvinceplusreroll: total
                });
        });
            }
            else {
            let rollString = "&{template:convince} {{name=Convince}} {{rollconvince=[[[[floor(@{convinceneb})]]d6>5]]}}";
                rollString += "{{rollconvincer1=[[0]]}}";
            startRoll(rollString, results => {
            const roll = results.results.rollconvince.result;
            finishRoll(results.rollId, {
                rollconvince: roll
                });
        });
            }
    if (unilock == 0) {
    setAttrs({
        "unimod": 0
    });
    }
    if (unirerolllock == 0) {
    setAttrs({
        "unirerollmod": 0
    });
    }
    });
});


    on('clicked:leapingdodge', (info) => {
          getAttrs(["dodgetotalspeed","gracereroll","dedsta","stam","stamtemp","offbal","defboxmove","bulkcheck","stamdodgemod","setsuccessdodge","dodgereroll","unilock","unirerolllock"], function(values) {
        let dedsta = parseInt(values.dedsta)||0;
        let stamdodgemod = parseInt(values.stamdodgemod)||0;
        let stam = parseInt(values.stam)||0;
        let stamtemp = parseInt(values.stamtemp)||0;
        let offbal = parseInt(values.offbal)||0;
        let defboxmove = parseInt(values.defboxmove)||0;
        let bulkcheck = parseInt(values.bulkcheck)||0;
        let unilock = parseInt(values.unilock)||0;
        let unirerolllock = parseInt(values.unirerolllock)||0;
        let stamtotal = stam + stamtemp;
        let spentstam = dedsta + bulkcheck + 3;
        if(spentstam <= stamtotal) {
            if(values.dodgereroll >= "1") {
            let rollString = "&{template:dodgeplusreroll} {{name=Dodge}} {{rolldodgeplusreroll=[[[[floor(@{dodgetotalspeed})]]d6>@{setsuccessdodge}]]}}";
                rollString += "{{rolldodger1=[[@{dodgereroll}d6>@{setsuccessdodge}]]}}";
            startRoll(rollString, results => {
            const dodgetotal = parseInt(values.dodgetotal)||0;
            const roll = results.results.rolldodgeplusreroll.result;
            const reroll_calculated = results.results.rolldodger1.result;
            const rerollmin = (dodgetotal - roll <= 0) ? 0 : dodgetotal - roll;
            const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
            const total = roll + reroll;
            finishRoll(results.rollId, {
                rolldodgeplusreroll: total
                });
        });
            }
            else {
            let rollString = "&{template:dodge} {{name=Dodge}} {{rolldodge=[[[[floor(@{dodgetotalspeed})]]d6>@{setsuccessdodge}]]}}";
                rollString += "{{rolldodger11=[[0]]}}";
            startRoll(rollString, results => {
            const dodgetotal = parseInt(values.dodgetotal)||0;
            const roll = results.results.rolldodge.result;
            const reroll_calculated = results.results.rolldodger11.result;
            const rerollmin = (dodgetotal - roll <= 0) ? 0 : dodgetotal - roll;
            const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
            const total = roll + reroll;
            finishRoll(results.rollId, {
                rolldodge: total
                });
        }); 
            }
        if(defboxmove == "1") {
            setAttrs({                            
                "offbal": offbal + 1
            });
        }
        setAttrs({
            "defboxmove": 0
        });
        setAttrs({
            "defboxbulk": 0
        });
        if((stamtemp > "0") && (spentstam > stam)){
            let stammath = spentstam - stam;
            setAttrs({                            
                "stam": 0
            });
            setAttrs({
                "stamtemp": stamtemp - stammath
            });    
        }
        else {
            setAttrs({                            
                "stam": stam - spentstam
            });  
        }
        setAttrs({
            "dedsta": 0
        });
    if (unilock == 0) {
    setAttrs({
        "unimod": 0
    });
    }
    if (unirerolllock == 0) {
    setAttrs({
        "unirerollmod": 0
    });
    }
        }
        else {
        let rollString = "&{template:error} {{name=Error}} {{rollerror=[[0]]}}";
        startRoll(rollString, results => {
            finishRoll(results.rollId, {
                });
            });
        }
    });
});

    on('clicked:leapingdodgepounce', (info) => {
          getAttrs(["dodgetotalspeed","gracereroll","dedsta","stam","stamtemp","offbal","defboxmove","bulkcheck","stamdodgemod","setsuccessdodge","dodgereroll","resultpounce","resultreroll","dedsta","stam","stamtemp","atkboxpaired","atkboxopportunity","stamtax","stamtaxtax","stamattackmodgeneral","stamattackmod","setsuccessattack","wpntype","attackoffbal","bulkcurrent","offbal","bulkcheck","unilock","unirerolllock"], function(values) {
        let dedsta = parseInt(values.dedsta)||0;
        let stamdodgemod = parseInt(values.stamdodgemod)||0;
        let stam = parseInt(values.stam)||0;
        let stamtemp = parseInt(values.stamtemp)||0;
        let offbal = parseInt(values.offbal)||0;
        let defboxmove = parseInt(values.defboxmove)||0;
        let bulkcheck = parseInt(values.bulkcheck)||0;
        let unilock = parseInt(values.unilock)||0;
        let unirerolllock = parseInt(values.unirerolllock)||0;
        let stamtotal = stam + stamtemp;
        let spentstam = dedsta + bulkcheck + 3;
        if(spentstam <= stamtotal) {
            if(values.dodgereroll >= "1") {
            let rollString = "&{template:dodgeplusreroll} {{name=Dodge}} {{rolldodgeplusreroll=[[[[floor(@{dodgetotalspeed})]]d6>@{setsuccessdodge}]]}}";
                rollString += "{{rolldodger1=[[@{dodgereroll}d6>@{setsuccessdodge}]]}}";
            startRoll(rollString, results => {
            const dodgetotal = parseInt(values.dodgetotal)||0;
            const roll = results.results.rolldodgeplusreroll.result;
            const reroll_calculated = results.results.rolldodger1.result;
            const rerollmin = (dodgetotal - roll <= 0) ? 0 : dodgetotal - roll;
            const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
            const total = roll + reroll;
            finishRoll(results.rollId, {
                rolldodgeplusreroll: total
                });
        });
            }
            else {
            let rollString = "&{template:dodge} {{name=Dodge}} {{rolldodge=[[[[floor(@{dodgetotalspeed})]]d6>@{setsuccessdodge}]]}}";
                rollString += "{{rolldodger11=[[0]]}}";
            startRoll(rollString, results => {
            const dodgetotal = parseInt(values.dodgetotal)||0;
            const roll = results.results.rolldodge.result;
            const reroll_calculated = results.results.rolldodger11.result;
            const rerollmin = (dodgetotal - roll <= 0) ? 0 : dodgetotal - roll;
            const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
            const total = roll + reroll;
            finishRoll(results.rollId, {
                rolldodge: total
                });
        }); 
            }
        setAttrs({
            "defboxbulk": 0
        });
        }
        else {
        let rollString = "&{template:error} {{name=Error}} {{rollerror=[[0]]}}";
        startRoll(rollString, results => {
            finishRoll(results.rollId, {
                });
            });
        }

        let atkboxopportunity = parseInt(values.atkboxopportunity)||0;
        let wpntype = parseInt(values.wpntype)||0;
        let stamattackmod = parseInt(values.stamattackmod)||0;
        let stamattackmodgeneral = parseInt(values.stamattackmodgeneral)||0;
        let stamtax = parseInt(values.stamtax)||0;
        let stamtaxmod = parseInt(values.stamtaxtax)||0;
        let attackoffbal = parseInt(values.attackoffbal)||0;
        let bulkcurrent = parseInt(values.bulkcurrent)||0;
        let offbalextra = (bulkcurrent >= 2) ? 1 : 0;
        let offbalfinal = offbalextra + offbal + attackoffbal;
        let stamtax1 = (atkboxopportunity == 0) ? stamtax : 0;
        let stamtax2 = (atkboxopportunity == 0) ? stamtaxmod : 0;
        let paired = parseInt(values.atkboxpaired)||0;
        if(spentstam <= stamtotal) {
            if(values.resultreroll >= "1") {
            let rollString = "&{template:attackplusreroll} {{name=Attack}} {{rollattackplusreroll=[[[[floor(@{resultpounce})]]d6>@{setsuccessattack}]]}}";
                rollString += "{{rollattackr1=[[@{resultreroll}d6>@{setsuccessattack}]]}}";
            startRoll(rollString, results => {
                const result = parseInt(values.result)||0;
                const roll = results.results.rollattackplusreroll.result;
                const reroll_calculated = results.results.rollattackr1.result;
                const rerollmin = (result - roll <= 0) ? 0 : result - roll;
                const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
                const total = roll + reroll;
            finishRoll(results.rollId, {
                rollattackplusreroll: total
            });
            });
            }
            else {
            let rollString = "&{template:attack} {{name=Attack}} {{rollattack=[[[[floor(@{resultpounce})]]d6>@{setsuccessattack}]]}}";
                rollString += "{{rollattackr1=[[0]]}}";
            startRoll(rollString, results => {
                const result = parseInt(values.result)||0;
                const roll = results.results.rollattack.result;
                const reroll_calculated = results.results.rollattackr1.result;
                const rerollmin = (result - roll <= 0) ? 0 : result - roll;
                const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
                const total = roll + reroll;
            finishRoll(results.rollId, {
                rollattack: total
            });
            });
            }
        setAttrs({
            "atkboxpaired": 0
        });
        setAttrs({
            "atkboxopportunity": 0
        });
        setAttrs({
            "offbal": offbalfinal + defboxmove
        });
        setAttrs({
            "defboxmove": 0
        });
        setAttrs({
            "dedstafloating": dedsta + stamattackmod
        });
        setAttrs({
            "wpntypefloating": wpntype
        });
        if((stamtemp > "0") && (spentstam > stam)){
            let stammath = spentstam - stam;
            setAttrs({                            
                "stam": 0
            });
            setAttrs({
                "stamtemp": stamtemp - stammath
            });    
        }
        else {
            setAttrs({                            
                "stam": stam - spentstam
            });  
        }
        setAttrs({
            "dedsta": 0
        });
        setAttrs({
            "stamtax": stamtax1 + stamtax2
        });
        setAttrs({
            "stamtaxnebulous": stamtax + stamtaxmod
        });
        setAttrs({
            "bulkchecknebulous": bulkcheck
        });
    if (unilock == 0) {
    setAttrs({
        "unimod": 0
    });
    }
    if (unirerolllock == 0) {
    setAttrs({
        "unirerollmod": 0
    });
    }
        }
    else {
        let rollString = "&{template:error} {{name=Error}} {{rollerror=[[0]]}}";
        startRoll(rollString, results => {
            finishRoll(results.rollId, {
                });
        });
    }

    });
});

on("change:result change:stamattackmodgeneral sheet:opened", function() {  
  getAttrs(["result","stamattackmodgeneral"], function(values) {
    let result = parseFloat(values.result)||0;
    let stamattackmodgeneral = parseInt(values.stamattackmodgeneral)||0;
    let resultpounce = result + 3 - stamattackmodgeneral
    setAttrs({
        "resultpounce": resultpounce
    });
  });
});



    on('clicked:leapingpounce', (info) => {
          getAttrs(["resultpounce","resultreroll","dedsta","stam","stamtemp","atkboxpaired","atkboxopportunity","stamtax","stamtaxtax","stamattackmodgeneral","stamattackmod","setsuccessattack","wpntype","attackoffbal","bulkcurrent","offbal","bulkcheck","unilock","unirerolllock"], function(values) {
        let atkboxopportunity = parseInt(values.atkboxopportunity)||0;
        let wpntype = parseInt(values.wpntype)||0;
        let dedsta = parseInt(values.dedsta)||0;
        let stamattackmod = parseInt(values.stamattackmod)||0;
        let stamattackmodgeneral = parseInt(values.stamattackmodgeneral)||0;
        let stam = parseInt(values.stam)||0;
        let stamtemp = parseInt(values.stamtemp)||0;
        let stamtax = parseInt(values.stamtax)||0;
        let stamtaxmod = parseInt(values.stamtaxtax)||0;
        let attackoffbal = parseInt(values.attackoffbal)||0;
        let offbal = parseInt(values.offbal)||0;
        let bulkcurrent = parseInt(values.bulkcurrent)||0;
        let unilock = parseInt(values.unilock)||0;
        let unirerolllock = parseInt(values.unirerolllock)||0;
        let bulkcheck = parseInt(values.bulkcheck)||0;
        let offbalextra = (bulkcurrent >= 2) ? 1 : 0;
        let offbalfinal = offbalextra + offbal + attackoffbal;
        let stamtax1 = (atkboxopportunity == 0) ? stamtax : 0;
        let paired = parseInt(values.atkboxpaired)||0;
        let stamtotal = stam + stamtemp;
        let spentstam = dedsta + stamtax1 + 3 - paired;
        if(spentstam <= stamtotal) {
            if(values.resultreroll >= "1") {
            let rollString = "&{template:attackplusreroll} {{name=Attack}} {{rollattackplusreroll=[[[[floor(@{resultpounce})]]d6>@{setsuccessattack}]]}}";
                rollString += "{{rollattackr1=[[@{resultreroll}d6>@{setsuccessattack}]]}}";
            startRoll(rollString, results => {
                const result = parseInt(values.result)||0;
                const roll = results.results.rollattackplusreroll.result;
                const reroll_calculated = results.results.rollattackr1.result;
                const rerollmin = (result - roll <= 0) ? 0 : result - roll;
                const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
                const total = roll + reroll;
            finishRoll(results.rollId, {
                rollattackplusreroll: total
            });
            });
            }
            else {
            let rollString = "&{template:attack} {{name=Attack}} {{rollattack=[[[[floor(@{resultpounce})]]d6>@{setsuccessattack}]]}}";
                rollString += "{{rollattackr1=[[0]]}}";
            startRoll(rollString, results => {
                const result = parseInt(values.result)||0;
                const roll = results.results.rollattack.result;
                const reroll_calculated = results.results.rollattackr1.result;
                const rerollmin = (result - roll <= 0) ? 0 : result - roll;
                const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
                const total = roll + reroll;
            finishRoll(results.rollId, {
                rollattack: total
            });
            });
            }
        setAttrs({
            "atkboxpaired": 0
        });
        setAttrs({
            "atkboxopportunity": 0
        });
        if((stamtemp > "0") && (spentstam > stam)){
            let stammath = spentstam - stam;
            setAttrs({                            
                "stam": 0
            });
            setAttrs({
                "stamtemp": stamtemp - stammath
            });    
        }
        else {
            setAttrs({                            
                "stam": stam - spentstam
            });  
        }
        setAttrs({
            "offbal": offbalfinal
        });
        setAttrs({
            "dedstafloating": dedsta + stamattackmod
        });
        setAttrs({
            "wpntypefloating": wpntype
        });
        setAttrs({
            "dedsta": 0
        });
        setAttrs({
            "stamtax": stamtax + stamtaxmod
        });
        setAttrs({
            "stamtaxnebulous": stamtax + stamtaxmod
        });
        setAttrs({
            "bulkchecknebulous": bulkcheck
        });
    if (unilock == 0) {
    setAttrs({
        "unimod": 0
    });
    }
    if (unirerolllock == 0) {
    setAttrs({
        "unirerollmod": 0
    });
    }
        }
    else {
        let rollString = "&{template:error} {{name=Error}} {{rollerror=[[0]]}}";
        startRoll(rollString, results => {
            finishRoll(results.rollId, {
                });
        });
    }
    });
});


on("change:mightreroll change:parryrerollbuff change:parrytype change:parryweaponrerollbuff change:parryshieldrerollbuff sheet:opened", function() {  
  getAttrs(["mightreroll","parryrerollbuff","parrytype","parryweaponrerollbuff","parryshieldrerollbuff"], function(values) {
    let mightreroll = parseFloat(values.mightreroll)||0;
    let parryrerollbuff = parseInt(values.parryrerollbuff)||0;
    let parrytype = parseInt(values.parrytype)||0;
    let parryweaponrerollbuff = parseInt(values.parryweaponrerollbuff)||0;
    let parryshieldrerollbuff = parseInt(values.parryshieldrerollbuff)||0;
    let parryrerollequipbuff = (parrytype == "1") ? parryweaponrerollbuff : parryshieldrerollbuff;
    setAttrs({
        "parryreroll": mightreroll + parryrerollbuff + parryrerollequipbuff
    });
  });
});

on("change:grapplefinal change:grapplererollmod sheet:opened", function() {  
  getAttrs(["grapplefinal","grapplererollmod"], function(values) {
    let recheck = parseFloat(values.grapplefinal)||0;
    let grapplererollmod = parseInt(values.grapplererollmod)||0;
    let resultreroll = recheck - Math.floor(recheck);
    if(resultreroll == "0") {
        setAttrs({
            "resultrerollgrapple": 0 + grapplererollmod
        });}
    if(resultreroll == "0.5") {
        setAttrs({
            "resultrerollgrapple": 1 + grapplererollmod
    });}
  });
});

on("change:dmgboxhit change:damcalcadd change:dmgcrt change:dedstafloating change:wpntypefloating change:shieldbashcrt change:tuskcheck sheet:opened", function() {  
  getAttrs(["dmgboxhit","dmgcrt","dedstafloating","wpntypefloating","shieldbashcrt","damcalcadd","tuskcheck"], function(values) {
    let dmgboxhit = parseInt(values.dmgboxhit)||0;
    let dmgcrtx = parseInt(values.dmgcrt)||0;
    let dedsta = parseInt(values.dedstafloating)||0;
    let wpntype = parseInt(values.wpntypefloating)||0;
    let shieldbashcrt = parseInt(values.shieldbashcrt)||0;
    let damcalcadd = parseInt(values.damcalcadd)||0;
    let tuskcheck = parseInt(values.tuskcheck)||0;
    let dmgcrt = dmgcrtx + tuskcheck;
    let rollovercap = (dedsta >= dmgcrt) ? dedsta : dmgcrt;
    let rollover = dmgboxhit - 1;
    let damageriskwpn = ((rollovercap >= rollover) && (dmgboxhit != 0)) ? rollover + dmgcrt : dmgcrt + rollovercap;
    let damageriskshield1 = ((rollovercap >= rollover) && (dmgboxhit != 0)) ? rollover + dmgcrt : dmgcrt + rollovercap;
    let damageriskshield2 = (shieldbashcrt == 0) ? dmgcrt : damageriskshield1;
    let damageriskz = (dmgboxhit == 0) ? 0 : 1;
    let damagerisk = (wpntype == 1) ? damageriskwpn : damageriskshield2;
    setAttrs({
        "damageriskz": damageriskz
    });
    setAttrs({
        "damagerisk": damagerisk + damcalcadd
    });
  });
});

    on('clicked:calcdmg', (info) => {
          getAttrs(["damagerisk","damageriskz"], function(values) {
              let damagerisk = parseInt(values.damagerisk)||0;
              let damageriskz = parseInt(values.damageriskz)||0;
            if(damageriskz != "0") {
            let rollString = "&{template:damage} {{name=Risk}} {{rolldamage=[[@{damagerisk}]]}}";
            startRoll(rollString, results => {
            finishRoll(results.rollId, {
            });
        });
            }
            else {
        let rollString = "&{template:errorhit} {{name=Error}} {{rollerrorhit=[[0]]}}";
        startRoll(rollString, results => {
            finishRoll(results.rollId, {
                });
            });
        }
        setAttrs({
            "dmgboxhit": 0
        });
    });
});

on("change:initmod change:gracetotal sheet:opened", function() {  
  getAttrs(["gracetotal","initmod"], function(values) {
    let gracetotal = parseInt(values.gracetotal)||0;
    let initmod = parseInt(values.initmod)||0;
    setAttrs({
        "inittotal": initmod + gracetotal
    });
  });
});

    on('clicked:init', (info) => {
          getAttrs(["inittotal","initreroll","unilock","unirerolllock"], function(values) {
        let unilock = parseInt(values.unilock)||0;
        let unirerolllock = parseInt(values.unirerolllock)||0;
            if (values.initreroll >= "1") {
                let rollString = "&{template:init} {{name=Test}} {{rollinit=[[[[@{inittotal}]]d6 &{tracker}]]}}";
                    rollString += "{{rollinitreroll=[[@{initreroll}d6]]}}";
                startRoll(rollString, results => {
            const inittotal = parseInt(values.inittotal)||0;
            const roll = results.results.rollinit.result;
            const reroll_calculated = results.results.rollinitreroll.result;
            const rerollmin = (inittotal - roll <= 0) ? 0 : inittotal - roll;
            const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
            const total = roll + reroll;
                finishRoll(results.rollId, {
                rollinit: total
                });
            });
            }
            else {
                let rollString = "&{template:initnoreroll} {{name=Test}} {{rollinitnoreroll=[[[[@{inittotal}]]d6 &{tracker}]]}}";
                startRoll(rollString, results => {
                finishRoll(results.rollId, {
                });
            });
            }
    if (unilock == 0) {
    setAttrs({
        "unimod": 0
    });
    }
    if (unirerolllock == 0) {
    setAttrs({
        "unirerollmod": 0
    });
    }
    });
});

    on('clicked:losebelly', (info) => {
          getAttrs(["belly","bellymax","bellylostmod"], function(values) {
            let belly = parseInt(values.belly)||0;
            let bellymax = parseInt(values.bellymax)||0;
            let bellylostmod = parseInt(values.bellylostmod)||0;
        const output = {};
        output.belly = (bellymax >= 10) ? belly - bellymax - bellylostmod : 10 - bellymax - bellylostmod;
        setAttrs(output);
    });
});

    on('clicked:sleep', (info) => {
          getAttrs(["soulmax","soulmaxhalf","hungerchecksoul","restingtype"], function(values) {
            let soulmax = parseInt(values.soulmax)||0;
            let soulmaxhalf = parseInt(values.soulmaxhalf)||0;
            let hungerchecksoul = parseInt(values.hungerchecksoul)||0;
            let restingtype = parseInt(values.restingtype)||0;
                let rollString = "&{template:sleepheal} {{name=Test}} {{rollsleepheal=[[@{hungerchecksoul}]]}}";
                    rollString += "{{rollsleepsoul=[[@{soulmaxhalf}]]}}";
                startRoll(rollString, results => {
                finishRoll(results.rollId, {
                });
            });
    });
});


on("change:gracereroll change:initrerollmod sheet:opened", function() {  
  getAttrs(["gracereroll","initrerollmod"], function(values) {
    let recheck = parseFloat(values.gracereroll)||0;
    let initrerollmod = parseInt(values.initrerollmod)||0;
    setAttrs({
        "initreroll": recheck + initrerollmod
    });
  });
});

</script>

<script type="text/worker">



on("change:toggle change:mighttotalfloat change:gracetotalfloat change:insighttotalfloat change:meleeradio1 change:rangedradio1 change:mightattackmod change:graceattackmod change:insightattackmod change:mightattackrerollmod change:graceattackrerollmod change:insightattackrerollmod change:mightreroll change:gracereroll change:insightreroll change:feral sheet:opened", function() {  
  getAttrs(["mighttotalfloat","gracetotalfloat","insighttotalfloat","toggle","meleeradio1","rangedradio1","mightattackmod","graceattackmod","insightattackmod","mightattackrerollmod","graceattackrerollmod","insightattackrerollmod","mightreroll","gracereroll","insightreroll","feral"], function(values) {
    let mighttotalfloat = parseFloat(values.mighttotalfloat)||0;
    let mightattackmod = parseInt(values.mightattackmod)||0;
    let mightattackrerollmod = parseInt(values.mightattackrerollmod)||0;
    let mightreroll = parseInt(values.mightreroll)||0;
    let gracetotalfloat = parseFloat(values.gracetotalfloat)||0;
    let graceattackmod = parseInt(values.graceattackmod)||0;
    let graceattackrerollmod = parseInt(values.graceattackrerollmod)||0;
    let gracereroll = parseInt(values.gracereroll)||0;
    let insighttotalfloat = parseFloat(values.insighttotalfloat)||0;
    let insightattackmod = parseInt(values.insightattackmod)||0;
    let insightattackrerollmod = parseInt(values.insightattackrerollmod)||0;
    let insightreroll = parseInt(values.insightreroll)||0;
    let toggle = parseInt(values.toggle)||0;
    let meleeradio1 = parseInt(values.meleeradio1)||0;
    let rangedradio1 = parseInt(values.rangedradio1)||0;
    let feral = parseInt(values.feral)||0;
    if (meleeradio1 == "1") {
        setAttrs({
            "meleetotal1": mighttotalfloat + mightattackmod
        });
        setAttrs({
            "meleererolltotal1": mightattackrerollmod + mightreroll
        });
    }
    if (meleeradio1 == "2") {
        setAttrs({
            "meleetotal1": gracetotalfloat + graceattackmod - feral
        });
        setAttrs({
            "meleererolltotal1": graceattackrerollmod + gracereroll
        });
    }
    if (meleeradio1 == "3") {
        setAttrs({
            "meleetotal1": insighttotalfloat + insightattackmod
        });
        setAttrs({
            "meleererolltotal1": insightattackrerollmod + insightreroll
        });
    }
    if (rangedradio1 == "1") {
        setAttrs({
            "rangedtotal1": mighttotalfloat + mightattackmod
        });
        setAttrs({
            "rangedrerolltotal1": mightattackrerollmod + mightreroll
        });
    }
    if (rangedradio1 == "2") {
        setAttrs({
            "rangedtotal1": gracetotalfloat + graceattackmod
        });
        setAttrs({
            "rangedrerolltotal1": graceattackrerollmod + gracereroll
        });
    }
    if (rangedradio1 == "3") {
        setAttrs({
            "rangedtotal1": insighttotalfloat + insightattackmod
        });
        setAttrs({
            "rangedrerolltotal1": insightattackrerollmod + insightreroll
        });
    }
  });
});

on("change:toggle change:mighttotalfloat change:gracetotalfloat change:insighttotalfloat change:meleeradio2 change:rangedradio2 change:mightattackmod change:graceattackmod change:insightattackmod change:mightattackrerollmod change:graceattackrerollmod change:insightattackrerollmod change:mightreroll change:gracereroll change:insightreroll change:feral sheet:opened", function() {  
  getAttrs(["mighttotalfloat","gracetotalfloat","insighttotalfloat","toggle","meleeradio2","rangedradio2","mightattackmod","graceattackmod","insightattackmod","mightattackrerollmod","graceattackrerollmod","insightattackrerollmod","mightreroll","gracereroll","insightreroll","feral"], function(values) {
    let mighttotalfloat = parseFloat(values.mighttotalfloat)||0;
    let mightattackmod = parseInt(values.mightattackmod)||0;
    let mightattackrerollmod = parseInt(values.mightattackrerollmod)||0;
    let mightreroll = parseInt(values.mightreroll)||0;
    let gracetotalfloat = parseFloat(values.gracetotalfloat)||0;
    let graceattackmod = parseInt(values.graceattackmod)||0;
    let graceattackrerollmod = parseInt(values.graceattackrerollmod)||0;
    let gracereroll = parseInt(values.gracereroll)||0;
    let insighttotalfloat = parseFloat(values.insighttotalfloat)||0;
    let insightattackmod = parseInt(values.insightattackmod)||0;
    let insightattackrerollmod = parseInt(values.insightattackrerollmod)||0;
    let insightreroll = parseInt(values.insightreroll)||0;
    let toggle = parseInt(values.toggle)||0;
    let meleeradio2 = parseInt(values.meleeradio2)||0;
    let rangedradio2 = parseInt(values.rangedradio2)||0;
    let feral = parseInt(values.feral)||0;
    if (meleeradio2 == "1") {
        setAttrs({
            "meleetotal2": mighttotalfloat + mightattackmod
        });
        setAttrs({
            "meleererolltotal2": mightattackrerollmod + mightreroll
        });
    }
    if (meleeradio2 == "2") {
        setAttrs({
            "meleetotal2": gracetotalfloat + graceattackmod - feral
        });
        setAttrs({
            "meleererolltotal2": graceattackrerollmod + gracereroll
        });
    }
    if (meleeradio2 == "3") {
        setAttrs({
            "meleetotal2": insighttotalfloat + insightattackmod
        });
        setAttrs({
            "meleererolltotal2": insightattackrerollmod + insightreroll
        });
    }
    if (rangedradio2 == "1") {
        setAttrs({
            "rangedtotal2": mighttotalfloat + mightattackmod
        });
        setAttrs({
            "rangedrerolltotal2": mightattackrerollmod + mightreroll
        });
    }
    if (rangedradio2 == "2") {
        setAttrs({
            "rangedtotal2": gracetotalfloat + graceattackmod
        });
        setAttrs({
            "rangedrerolltotal2": graceattackrerollmod + gracereroll
        });
    }
    if (rangedradio2 == "3") {
        setAttrs({
            "rangedtotal2": insighttotalfloat + insightattackmod
        });
        setAttrs({
            "rangedrerolltotal2": insightattackrerollmod + insightreroll
        });
    }
  });
});

on("change:toggle change:mighttotalfloat change:gracetotalfloat change:insighttotalfloat change:meleeradio3 change:rangedradio3 change:mightattackmod change:graceattackmod change:insightattackmod change:mightattackrerollmod change:graceattackrerollmod change:insightattackrerollmod change:mightreroll change:gracereroll change:insightreroll change:feral sheet:opened", function() {  
  getAttrs(["mighttotalfloat","gracetotalfloat","insighttotalfloat","toggle","meleeradio3","rangedradio3","mightattackmod","graceattackmod","insightattackmod","mightattackrerollmod","graceattackrerollmod","insightattackrerollmod","mightreroll","gracereroll","insightreroll","feral"], function(values) {
    let mighttotalfloat = parseFloat(values.mighttotalfloat)||0;
    let mightattackmod = parseInt(values.mightattackmod)||0;
    let mightattackrerollmod = parseInt(values.mightattackrerollmod)||0;
    let mightreroll = parseInt(values.mightreroll)||0;
    let gracetotalfloat = parseFloat(values.gracetotalfloat)||0;
    let graceattackmod = parseInt(values.graceattackmod)||0;
    let graceattackrerollmod = parseInt(values.graceattackrerollmod)||0;
    let gracereroll = parseInt(values.gracereroll)||0;
    let insighttotalfloat = parseFloat(values.insighttotalfloat)||0;
    let insightattackmod = parseInt(values.insightattackmod)||0;
    let insightattackrerollmod = parseInt(values.insightattackrerollmod)||0;
    let insightreroll = parseInt(values.insightreroll)||0;
    let toggle = parseInt(values.toggle)||0;
    let meleeradio3 = parseInt(values.meleeradio3)||0;
    let rangedradio3 = parseInt(values.rangedradio3)||0;
    let feral = parseInt(values.feral)||0;
    if (meleeradio3 == "1") {
        setAttrs({
            "meleetotal3": mighttotalfloat + mightattackmod
        });
        setAttrs({
            "meleererolltotal3": mightattackrerollmod + mightreroll
        });
    }
    if (meleeradio3 == "2") {
        setAttrs({
            "meleetotal3": gracetotalfloat + graceattackmod - feral
        });
        setAttrs({
            "meleererolltotal3": graceattackrerollmod + gracereroll
        });
    }
    if (meleeradio3 == "3") {
        setAttrs({
            "meleetotal3": insighttotalfloat + insightattackmod
        });
        setAttrs({
            "meleererolltotal3": insightattackrerollmod + insightreroll
        });
    }
    if (rangedradio3 == "1") {
        setAttrs({
            "rangedtotal3": mighttotalfloat + mightattackmod
        });
        setAttrs({
            "rangedrerolltotal3": mightattackrerollmod + mightreroll
        });
    }
    if (rangedradio3 == "2") {
        setAttrs({
            "rangedtotal3": gracetotalfloat + graceattackmod
        });
        setAttrs({
            "rangedrerolltotal3": graceattackrerollmod + gracereroll
        });
    }
    if (rangedradio3 == "3") {
        setAttrs({
            "rangedtotal3": insighttotalfloat + insightattackmod
        });
        setAttrs({
            "rangedrerolltotal3": insightattackrerollmod + insightreroll
        });
    }
  });
});

on("change:toggle change:mighttotalfloat change:gracetotalfloat change:insighttotalfloat change:meleeradio4 change:rangedradio4 change:mightattackmod change:graceattackmod change:insightattackmod change:mightattackrerollmod change:graceattackrerollmod change:insightattackrerollmod change:mightreroll change:gracereroll change:insightreroll change:feral sheet:opened", function() {  
  getAttrs(["mighttotalfloat","gracetotalfloat","insighttotalfloat","toggle","meleeradio4","rangedradio4","mightattackmod","graceattackmod","insightattackmod","mightattackrerollmod","graceattackrerollmod","insightattackrerollmod","mightreroll","gracereroll","insightreroll","feral"], function(values) {
    let mighttotalfloat = parseFloat(values.mighttotalfloat)||0;
    let mightattackmod = parseInt(values.mightattackmod)||0;
    let mightattackrerollmod = parseInt(values.mightattackrerollmod)||0;
    let mightreroll = parseInt(values.mightreroll)||0;
    let gracetotalfloat = parseFloat(values.gracetotalfloat)||0;
    let graceattackmod = parseInt(values.graceattackmod)||0;
    let graceattackrerollmod = parseInt(values.graceattackrerollmod)||0;
    let gracereroll = parseInt(values.gracereroll)||0;
    let insighttotalfloat = parseFloat(values.insighttotalfloat)||0;
    let insightattackmod = parseInt(values.insightattackmod)||0;
    let insightattackrerollmod = parseInt(values.insightattackrerollmod)||0;
    let insightreroll = parseInt(values.insightreroll)||0;
    let toggle = parseInt(values.toggle)||0;
    let meleeradio4 = parseInt(values.meleeradio4)||0;
    let rangedradio4 = parseInt(values.rangedradio4)||0;
    let feral = parseInt(values.feral)||0;
    if (meleeradio4 == "1") {
        setAttrs({
            "meleetotal4": mighttotalfloat + mightattackmod
        });
        setAttrs({
            "meleererolltotal4": mightattackrerollmod + mightreroll
        });
    }
    if (meleeradio4 == "2") {
        setAttrs({
            "meleetotal4": gracetotalfloat + graceattackmod - feral
        });
        setAttrs({
            "meleererolltotal4": graceattackrerollmod + gracereroll
        });
    }
    if (meleeradio4 == "3") {
        setAttrs({
            "meleetotal4": insighttotalfloat + insightattackmod
        });
        setAttrs({
            "meleererolltotal4": insightattackrerollmod + insightreroll
        });
    }
    if (rangedradio4 == "1") {
        setAttrs({
            "rangedtotal4": mighttotalfloat + mightattackmod
        });
        setAttrs({
            "rangedrerolltotal4": mightattackrerollmod + mightreroll
        });
    }
    if (rangedradio4 == "2") {
        setAttrs({
            "rangedtotal4": gracetotalfloat + graceattackmod
        });
        setAttrs({
            "rangedrerolltotal4": graceattackrerollmod + gracereroll
        });
    }
    if (rangedradio4 == "3") {
        setAttrs({
            "rangedtotal4": insighttotalfloat + insightattackmod
        });
        setAttrs({
            "rangedrerolltotal4": insightattackrerollmod + insightreroll
        });
    }
  });
});

on("change:toggle change:mighttotalfloat change:gracetotalfloat change:insighttotalfloat change:meleeradio5 change:rangedradio5 change:mightattackmod change:graceattackmod change:insightattackmod change:mightattackrerollmod change:graceattackrerollmod change:insightattackrerollmod change:mightreroll change:gracereroll change:insightreroll change:feral sheet:opened", function() {  
  getAttrs(["mighttotalfloat","gracetotalfloat","insighttotalfloat","toggle","meleeradio5","rangedradio5","mightattackmod","graceattackmod","insightattackmod","mightattackrerollmod","graceattackrerollmod","insightattackrerollmod","mightreroll","gracereroll","insightreroll","feral"], function(values) {
    let mighttotalfloat = parseFloat(values.mighttotalfloat)||0;
    let mightattackmod = parseInt(values.mightattackmod)||0;
    let mightattackrerollmod = parseInt(values.mightattackrerollmod)||0;
    let mightreroll = parseInt(values.mightreroll)||0;
    let gracetotalfloat = parseFloat(values.gracetotalfloat)||0;
    let graceattackmod = parseInt(values.graceattackmod)||0;
    let graceattackrerollmod = parseInt(values.graceattackrerollmod)||0;
    let gracereroll = parseInt(values.gracereroll)||0;
    let insighttotalfloat = parseFloat(values.insighttotalfloat)||0;
    let insightattackmod = parseInt(values.insightattackmod)||0;
    let insightattackrerollmod = parseInt(values.insightattackrerollmod)||0;
    let insightreroll = parseInt(values.insightreroll)||0;
    let toggle = parseInt(values.toggle)||0;
    let meleeradio5 = parseInt(values.meleeradio5)||0;
    let rangedradio5 = parseInt(values.rangedradio5)||0;
    let feral = parseInt(values.feral)||0;
    if (meleeradio5 == "1") {
        setAttrs({
            "meleetotal5": mighttotalfloat + mightattackmod
        });
        setAttrs({
            "meleererolltotal5": mightattackrerollmod + mightreroll
        });
    }
    if (meleeradio5 == "2") {
        setAttrs({
            "meleetotal5": gracetotalfloat + graceattackmod - feral
        });
        setAttrs({
            "meleererolltotal5": graceattackrerollmod + gracereroll
        });
    }
    if (meleeradio5 == "3") {
        setAttrs({
            "meleetotal5": insighttotalfloat + insightattackmod
        });
        setAttrs({
            "meleererolltotal5": insightattackrerollmod + insightreroll
        });
    }
    if (rangedradio5 == "1") {
        setAttrs({
            "rangedtotal5": mighttotalfloat + mightattackmod
        });
        setAttrs({
            "rangedrerolltotal5": mightattackrerollmod + mightreroll
        });
    }
    if (rangedradio5 == "2") {
        setAttrs({
            "rangedtotal5": gracetotalfloat + graceattackmod
        });
        setAttrs({
            "rangedrerolltotal5": graceattackrerollmod + gracereroll
        });
    }
    if (rangedradio5 == "3") {
        setAttrs({
            "rangedtotal5": insighttotalfloat + insightattackmod
        });
        setAttrs({
            "rangedrerolltotal5": insightattackrerollmod + insightreroll
        });
    }
  });
});

on("change:toggle change:meleetotal change:rangedtotal sheet:opened", function() {  
  getAttrs(["toggle","meleetotal","rangedtotal"], function(values) {
    let toggle = parseInt(values.toggle)||0;
    let meleetotal = parseFloat(values.meleetotal)||0;
    let rangedtotal = parseFloat(values.rangedtotal)||0;
    const output = {};
    output.mg = (toggle == "1") ? meleetotal : rangedtotal;
    setAttrs(output);
  });
});

on("change:toggle change:meleetotal1 change:rangedtotal1 sheet:opened", function() {  
  getAttrs(["toggle","meleetotal1","rangedtotal1"], function(values) {
    let toggle = parseInt(values.toggle)||0;
    let meleetotal = parseFloat(values.meleetotal1)||0;
    let rangedtotal = parseFloat(values.rangedtotal1)||0;
    const output = {};
    output.mg1 = (toggle == "1") ? meleetotal : rangedtotal;
    setAttrs(output);
  });
});

on("change:toggle change:meleetotal2 change:rangedtotal2 sheet:opened", function() {  
  getAttrs(["toggle","meleetotal2","rangedtotal2"], function(values) {
    let toggle = parseInt(values.toggle)||0;
    let meleetotal = parseFloat(values.meleetotal2)||0;
    let rangedtotal = parseFloat(values.rangedtotal2)||0;
    const output = {};
    output.mg2 = (toggle == "1") ? meleetotal : rangedtotal;
    setAttrs(output);
  });
});

on("change:toggle change:meleetotal3 change:rangedtotal3 sheet:opened", function() {  
  getAttrs(["toggle","meleetotal3","rangedtotal3"], function(values) {
    let toggle = parseInt(values.toggle)||0;
    let meleetotal = parseFloat(values.meleetotal3)||0;
    let rangedtotal = parseFloat(values.rangedtotal3)||0;
    const output = {};
    output.mg3 = (toggle == "1") ? meleetotal : rangedtotal;
    setAttrs(output);
  });
});

on("change:toggle change:meleetotal4 change:rangedtotal4 sheet:opened", function() {  
  getAttrs(["toggle","meleetotal4","rangedtotal4"], function(values) {
    let toggle = parseInt(values.toggle)||0;
    let meleetotal = parseFloat(values.meleetotal4)||0;
    let rangedtotal = parseFloat(values.rangedtotal4)||0;
    const output = {};
    output.mg4 = (toggle == "1") ? meleetotal : rangedtotal;
    setAttrs(output);
  });
});

on("change:toggle change:meleetotal5 change:rangedtotal5 sheet:opened", function() {  
  getAttrs(["toggle","meleetotal5","rangedtotal5"], function(values) {
    let toggle = parseInt(values.toggle)||0;
    let meleetotal = parseFloat(values.meleetotal5)||0;
    let rangedtotal = parseFloat(values.rangedtotal5)||0;
    const output = {};
    output.mg5 = (toggle == "1") ? meleetotal : rangedtotal;
    setAttrs(output);
  });
});

</script>

<script type="text/worker">

on("change:mg1 change:qty1 change:bulk1 change:rng1 change:dmg1 change:resultmod change:dedsta change:result1zero change:paraltier change:gplequip change:grapplerollmod change:grapplearms change:grappletoggle change:shieldbashradio1 change:wpntype1 change:shieldqtybonus1 change:attackbuff1 change:attackbuffgeneral change:stamattackmodgeneral change:atkmodneb sheet:opened", function() {  
  getAttrs(["qty1","mg1","resultmod","dedsta","result1zero","paraltier","gplequip","mighttotalfloat","grapplerollmod","grapplearms","grappletoggle","shieldbashradio1","wpntype1","shieldqtybonus1","attackbuff1","attackbuffgeneral","stamattackmodgeneral","atkmodneb"], function(values) {
    let shieldbashradio = parseInt(values.shieldbashradio1)||0;
    let shieldqtybonus = parseInt(values.shieldqtybonus1)||0;
    let wpntype = parseInt(values.wpntype1)||0;
    let mighttotalfloat = parseFloat(values.mighttotalfloat)||0;
    let mg = parseFloat(values.mg1)||0;
    let attackbuff1 = parseInt(values.attackbuff1)||0;
    let attackbuffgeneral = parseInt(values.attackbuffgeneral)||0;
    let attackbuff = attackbuff1 + attackbuffgeneral;
    let qty1 = parseFloat(values.qty1)||0;
    let resultmod = parseInt(values.resultmod)||0;
    let dedsta = parseInt(values.dedsta)||0;
    let paraltier = parseInt(values.paraltier)||0;
    let stamattackmodgeneral = parseInt(values.stamattackmodgeneral)||0;
    let atkmodneb = parseInt(values.atkmodneb)||0;
    let paraldebuff = (paraltier >= 2) ? 1 : 0;
    let mindice = mg + qty1 + stamattackmodgeneral + dedsta + attackbuff + atkmodneb - resultmod - paraldebuff;
    let mindiceshield = (shieldbashradio == 0) ? mighttotalfloat + stamattackmodgeneral + dedsta - resultmod - paraldebuff : mighttotalfloat + shieldqtybonus + 1 + 1 + dedsta - resultmod - paraldebuff;
    let gplequip = parseFloat(values.gplequip)||0;
    let grapplearms = parseInt(values.grapplearms)||0;
    let grapplerollmod = parseInt(values.grapplerollmod)||0;
    let grappletoggle = parseInt(values.grappletoggle)||0;
    let grappleval = (gplequip == 1) ? 1 : 0;
    let grappledice = (grappletoggle == 1) ? (mindice + mighttotalfloat + grapplerollmod + grapplearms - mg) : (mindice + mighttotalfloat + grapplerollmod + grapplearms + resultmod - mg - qty1 - 1);
    if (wpntype == "1") {
        setAttrs({
        "result1": mindice
        });
    }
    if (wpntype == "2") {
        setAttrs({
        "result1": mindiceshield
        });
    }
    if(values.result1zero == "0") {
        setAttrs({
            "result1": 0
        });}
        if(grappleval == "1") {
        setAttrs({
            "grapplefinal": grappledice
        });}
  });
});

</script>

<script type="text/worker">

on("change:mg2 change:qty2 change:bulk2 change:rng2 change:dmg2 change:resultmod change:dedsta change:result2zero change:paraltier change:gplequip change:grapplerollmod change:grapplearms change:grappletoggle change:shieldbashradio2 change:wpntype2 change:shieldqtybonus2 change:attackbuff2 change:attackbuffgeneral change:stamattackmodgeneral change:atkmodneb sheet:opened", function() {  
  getAttrs(["qty2","mg2","resultmod","dedsta","result2zero","paraltier","gplequip","mighttotalfloat","grapplerollmod","grapplearms","grappletoggle","shieldbashradio2","wpntype2","shieldqtybonus2","attackbuff2","attackbuffgeneral","stamattackmodgeneral","atkmodneb"], function(values) {
    let shieldbashradio = parseInt(values.shieldbashradio2)||0;  
    let shieldqtybonus = parseInt(values.shieldqtybonus2)||0;
    let wpntype = parseInt(values.wpntype2)||0;
    let mighttotalfloat = parseFloat(values.mighttotalfloat)||0;
    let mg = parseFloat(values.mg2)||0;
    let attackbuff2 = parseInt(values.attackbuff2)||0;
    let attackbuffgeneral = parseInt(values.attackbuffgeneral)||0;
    let attackbuff = attackbuff2 + attackbuffgeneral;
    let qty2 = parseFloat(values.qty2)||0;
    let resultmod = parseInt(values.resultmod)||0;
    let dedsta = parseInt(values.dedsta)||0;
    let paraltier = parseInt(values.paraltier)||0;
    let stamattackmodgeneral = parseInt(values.stamattackmodgeneral)||0;
    let atkmodneb = parseInt(values.atkmodneb)||0;
    let paraldebuff = (paraltier >= 2) ? 1 : 0;
    let mindice = mg + qty2 + stamattackmodgeneral + dedsta + attackbuff + atkmodneb - resultmod - paraldebuff;
    let mindiceshield = (shieldbashradio == 0) ? mighttotalfloat + stamattackmodgeneral + dedsta - resultmod - paraldebuff : mighttotalfloat + shieldqtybonus + 1 + 1 + dedsta - resultmod - paraldebuff;
    let gplequip = parseFloat(values.gplequip)||0;
    let grapplearms = parseInt(values.grapplearms)||0;
    let grapplerollmod = parseInt(values.grapplerollmod)||0;    
    let grappletoggle = parseInt(values.grappletoggle)||0;
    let grappleval = (gplequip == 2) ? 1 : 0;
    let grappledice = (grappletoggle == 1) ? (mindice + mighttotalfloat + grapplerollmod + grapplearms - mg) : (mindice + mighttotalfloat + grapplerollmod + grapplearms + resultmod - mg - qty2 - 1);
    if (wpntype == "1") {
        setAttrs({                            
        "result2": mindice
        });
    }
    if (wpntype == "2") {
        setAttrs({                            
        "result2": mindiceshield
        });
    }
        if(values.result2zero == "0") {
        setAttrs({
            "result2": 0
        });}
        if(grappleval == "1") {
        setAttrs({
            "grapplefinal": grappledice
        });}
  });
});

on("change:mg3 change:qty3 change:bulk3 change:rng3 change:dmg3 change:resultmod change:dedsta change:result3zero change:paraltier change:gplequip change:grapplerollmod change:grapplearms change:grappletoggle change:shieldbashradio3 change:wpntype3 change:shieldqtybonus3 change:attackbuff3 change:attackbuffgeneral change:stamattackmodgeneral change:atkmodneb sheet:opened", function() {  
  getAttrs(["qty3","mg3","resultmod","dedsta","result3zero","paraltier","gplequip","mighttotalfloat","grapplerollmod","grapplearms","grappletoggle","shieldbashradio3","wpntype3","shieldqtybonus3","attackbuff3","attackbuffgeneral","stamattackmodgeneral","atkmodneb"], function(values) {
    let shieldbashradio = parseInt(values.shieldbashradio3)||0;
    let shieldqtybonus = parseInt(values.shieldqtybonus3)||0;
    let wpntype = parseInt(values.wpntype3)||0;
    let mighttotalfloat = parseFloat(values.mighttotalfloat)||0;
    let mg = parseFloat(values.mg3)||0;
    let attackbuff3 = parseInt(values.attackbuff3)||0;
    let attackbuffgeneral = parseInt(values.attackbuffgeneral)||0;
    let attackbuff = attackbuff3 + attackbuffgeneral;
    let qty3 = parseFloat(values.qty3)||0;
    let resultmod = parseInt(values.resultmod)||0;
    let dedsta = parseInt(values.dedsta)||0;
    let paraltier = parseInt(values.paraltier)||0;
    let stamattackmodgeneral = parseInt(values.stamattackmodgeneral)||0;
    let atkmodneb = parseInt(values.atkmodneb)||0;
    let paraldebuff = (paraltier >= 2) ? 1 : 0;
    let mindice = mg + qty3 + stamattackmodgeneral + dedsta + attackbuff + atkmodneb - resultmod - paraldebuff;
    let mindiceshield = (shieldbashradio == 0) ? mighttotalfloat + stamattackmodgeneral + dedsta - resultmod - paraldebuff : mighttotalfloat + shieldqtybonus + 1 + 1 + dedsta - resultmod - paraldebuff;
    let gplequip = parseFloat(values.gplequip)||0;
    let grapplearms = parseInt(values.grapplearms)||0;
    let grapplerollmod = parseInt(values.grapplerollmod)||0;    
    let grappletoggle = parseInt(values.grappletoggle)||0;
    let grappleval = (gplequip == 3) ? 1 : 0;
    let grappledice = (grappletoggle == 1) ? mindice + mighttotalfloat + grapplerollmod + grapplearms - mg : mindice + mighttotalfloat + grapplerollmod + grapplearms + resultmod - mg - qty3 - 1;
    if (wpntype == "1") {
        setAttrs({                            
        "result3": mindice
        });
    }
    if (wpntype == "2") {
        setAttrs({                            
        "result3": mindiceshield
        });
    }
        if(values.result3zero == "0") {
        setAttrs({
            "result3": 0
        });}
        if(grappleval == "1") {
        setAttrs({
            "grapplefinal": grappledice
        });}
  });
});

on("change:mg4 change:qty4 change:bulk4 change:rng4 change:dmg4 change:resultmod change:dedsta change:result4zero change:paraltier change:gplequip change:grapplerollmod change:grapplearms change:grappletoggle change:shieldbashradio4 change:wpntype4 change:shieldqtybonus4 change:attackbuff4 change:attackbuffgeneral change:stamattackmodgeneral change:atkmodneb sheet:opened", function() {  
  getAttrs(["qty4","mg4","resultmod","dedsta","result4zero","paraltier","gplequip","mighttotalfloat","grapplerollmod","grapplearms","grappletoggle","shieldbashradio4","wpntype4","shieldqtybonus4","attackbuff4","attackbuffgeneral","stamattackmodgeneral","atkmodneb"], function(values) {
    let shieldbashradio = parseInt(values.shieldbashradio4)||0;
    let shieldqtybonus = parseInt(values.shieldqtybonus4)||0;
    let wpntype = parseInt(values.wpntype4)||0;
    let mighttotalfloat = parseFloat(values.mighttotalfloat)||0;
    let mg = parseFloat(values.mg4)||0;
    let attackbuff4 = parseInt(values.attackbuff4)||0;
    let attackbuffgeneral = parseInt(values.attackbuffgeneral)||0;
    let attackbuff = attackbuff4 + attackbuffgeneral;
    let qty4 = parseFloat(values.qty4)||0;
    let resultmod = parseInt(values.resultmod)||0;
    let dedsta = parseInt(values.dedsta)||0;
    let paraltier = parseInt(values.paraltier)||0;
    let stamattackmodgeneral = parseInt(values.stamattackmodgeneral)||0;
    let atkmodneb = parseInt(values.atkmodneb)||0;
    let paraldebuff = (paraltier >= 2) ? 1 : 0;
    let mindice = mg + qty4 + stamattackmodgeneral + dedsta + attackbuff + atkmodneb - resultmod - paraldebuff;
    let mindiceshield = (shieldbashradio == 0) ? mighttotalfloat + stamattackmodgeneral + dedsta - resultmod - paraldebuff : mighttotalfloat + shieldqtybonus + 1 + 1 + dedsta - resultmod - paraldebuff;
    let gplequip = parseFloat(values.gplequip)||0;
    let grapplearms = parseInt(values.grapplearms)||0;
    let grapplerollmod = parseInt(values.grapplerollmod)||0;    
    let grappletoggle = parseInt(values.grappletoggle)||0;
    let grappleval = (gplequip == 4) ? 1 : 0;
    let grappledice = (grappletoggle == 1) ? mindice + mighttotalfloat + grapplerollmod + grapplearms - mg : mindice + mighttotalfloat + grapplerollmod + grapplearms + resultmod - mg - qty4 - 1;
    if (wpntype == "1") {
        setAttrs({                            
        "result4": mindice
        });
    }
    if (wpntype == "2") {
        setAttrs({                            
        "result4": mindiceshield
        });
    }
        if(values.result4zero == "0") {
        setAttrs({
            "result4": 0
        });}
        if(grappleval == "1") {
        setAttrs({
            "grapplefinal": grappledice
        });}
  });
});

</script>

<script type="text/worker">

on("change:mg5 change:qty5 change:bulk5 change:rng5 change:dmg5 change:resultmod change:dedsta change:result5zero change:paraltier change:gplequip change:grapplerollmod change:grapplearms change:grappletoggle change:shieldbashradio5 change:wpntype5 change:shieldqtybonus5 change:attackbuff5 change:attackbuffgeneral change:stamattackmodgeneral change:atkmodneb sheet:opened", function() {  
  getAttrs(["qty5","mg5","resultmod","dedsta","result5zero","paraltier","gplequip","mighttotalfloat","grapplerollmod","grapplearms","grappletoggle","shieldbashradio5","wpntype5","shieldqtybonus5","attackbuff5","attackbuffgeneral","stamattackmodgeneral","atkmodneb"], function(values) {
    let shieldbashradio = parseInt(values.shieldbashradio5)||0;
    let shieldqtybonus = parseInt(values.shieldqtybonus5)||0;
    let wpntype = parseInt(values.wpntype5)||0;
    let mighttotalfloat = parseFloat(values.mighttotalfloat)||0;
    let mg = parseFloat(values.mg5)||0;
    let attackbuff5 = parseInt(values.attackbuff5)||0;
    let attackbuffgeneral = parseInt(values.attackbuffgeneral)||0;
    let attackbuff = attackbuff5 + attackbuffgeneral;
    let qty5 = parseFloat(values.qty5)||0;
    let resultmod = parseInt(values.resultmod)||0;
    let dedsta = parseInt(values.dedsta)||0;
    let paraltier = parseInt(values.paraltier)||0;
    let stamattackmodgeneral = parseInt(values.stamattackmodgeneral)||0;
    let atkmodneb = parseInt(values.atkmodneb)||0;
    let paraldebuff = (paraltier >= 2) ? 1 : 0;
    let mindice = mg + qty5 + stamattackmodgeneral + dedsta + attackbuff + atkmodneb - resultmod - paraldebuff;
    let mindiceshield = (shieldbashradio == 0) ? mighttotalfloat + stamattackmodgeneral + dedsta - resultmod - paraldebuff : mighttotalfloat + shieldqtybonus + 1 + 1 + dedsta - resultmod - paraldebuff;
    let gplequip = parseFloat(values.gplequip)||0;
    let grapplearms = parseInt(values.grapplearms)||0;
    let grapplerollmod = parseInt(values.grapplerollmod)||0;
    let grappletoggle = parseInt(values.grappletoggle)||0;
    let grappleval = (gplequip == 5) ? 1 : 0;
    let grapplemath1 = mindice + mighttotalfloat + grapplerollmod + grapplearms - mg;
    let grapplemath2 = mindice + mighttotalfloat + grapplerollmod + grapplearms + resultmod - mg - qty5 - 1;
    let grappledice = (grappletoggle == 1) ? grapplemath1 : grapplemath2;
    if (wpntype == "1") {
        setAttrs({                            
        "result5": mindice
        });
    }
    if (wpntype == "2") {
        setAttrs({                            
        "result5": mindiceshield
        });
    }
        if(values.result5zero == "0") {
        setAttrs({
            "result5": 0
        });}
        if(grappleval == "1") {
        setAttrs({
            "grapplefinal": grappledice
        });}
  });
});

on("change:result change:attackrerollbuff change:meleererolltotal change:rangedrerolltotal change:toggle sheet:opened", function() {  
  getAttrs(["result","attackrerollbuff","meleererolltotal","rangedrerolltotal","toggle"], function(values) {
    let recheck = parseFloat(values.result)||0;
    let toggle = parseInt(values.toggle)||0;
    let attackrerollbuff = parseInt(values.attackrerollbuff)||0;
    let meleererolltotal = parseInt(values.meleererolltotal)||0;
    let rangedrerolltotal = parseInt(values.rangedrerolltotal)||0;
    let togglereroll = (toggle == "1") ? meleererolltotal : rangedrerolltotal;
    let resultreroll = recheck - Math.floor(recheck);
    setAttrs({
        "resultreroll": attackrerollbuff + togglereroll
    });
  });
});

</script>

<script type="text/worker">

on("change:shieldbashradio1 change:dmg1 change:bulk1 change:wpntype1 sheet:opened", function() {  
  getAttrs(["shieldbashradio1","dmg1","bulk1","wpntype1"], function(values) {
    let shieldbashradio1 = parseFloat(values.shieldbashradio1)||0;
    let dmg1 = parseInt(values.dmg1)||0;
    let bulk1 = parseInt(values.bulk1)||0;
    let wpntype1 = parseInt(values.wpntype1)||0;
    if (shieldbashradio1 == "1" && wpntype1 == "2") {
        if (bulk1 <= "0") {
            setAttrs({
                "dmg1": 2
            });   
        }
        if (bulk1 == "1") {
            setAttrs({
                "dmg1": 3
            });   
        }
        if (bulk1 >= "2") {
            setAttrs({
                "dmg1": 4
            });   
        }
    }
    if (shieldbashradio1 == "0" && wpntype1 == "2") {
        if (dmg1 == "0" || dmg1 == "2") {
            setAttrs({
                "dmg1": 2
            });          
        }
    }
  });
});

</script>

<script type="text/worker">

on("change:shieldbashradio2 change:dmg2 change:bulk2 change:wpntype2 sheet:opened", function() {  
  getAttrs(["shieldbashradio2","dmg2","bulk2","wpntype2"], function(values) {
    let shieldbashradio = parseFloat(values.shieldbashradio2)||0;
    let dmg = parseInt(values.dmg2)||0;
    let bulk = parseInt(values.bulk2)||0;
    let wpntype = parseInt(values.wpntype2)||0;
    if (shieldbashradio == "1" && wpntype == "2") {
        if (bulk <= "0") {
            setAttrs({
                "dmg2": 2
            });   
        }
        if (bulk == "1") {
            setAttrs({
                "dmg2": 3
            });   
        }
        if (bulk >= "2") {
            setAttrs({
                "dmg2": 4
            });
        }
    }
    if (shieldbashradio == "0" && wpntype == "2") {
        setAttrs({
            "dmg2": 2
        });
    }
  });
});

on("change:shieldbashradio3 change:dmg3 change:bulk3 change:wpntype3 sheet:opened", function() {  
  getAttrs(["shieldbashradio3","dmg3","bulk3","wpntype3"], function(values) {
    let shieldbashradio = parseFloat(values.shieldbashradio3)||0;
    let dmg = parseInt(values.dmg3)||0;
    let bulk = parseInt(values.bulk3)||0;
    let wpntype = parseInt(values.wpntype3)||0;
    if (shieldbashradio == "1" && wpntype == "2") {
        if (bulk <= "0") {
            setAttrs({
                "dmg3": 2
            });   
        }
        if (bulk == "1") {
            setAttrs({
                "dmg3": 3
            });   
        }
        if (bulk >= "2") {
            setAttrs({
                "dmg3": 4
            });   
        }
    }
    if (shieldbashradio == "0" && wpntype == "2") {
        if (dmg == "0" || dmg == "2") {
            setAttrs({
                "dmg3": 2
            });          
        }
    }
  });
});

on("change:shieldbashradio4 change:dmg4 change:bulk4 change:wpntype4 sheet:opened", function() {  
  getAttrs(["shieldbashradio4","dmg4","bulk4","wpntype4"], function(values) {
    let shieldbashradio = parseFloat(values.shieldbashradio4)||0;
    let dmg = parseInt(values.dmg4)||0;
    let bulk = parseInt(values.bulk4)||0;
    let wpntype = parseInt(values.wpntype4)||0;
    if (shieldbashradio == "1" && wpntype == "2") {
        if (bulk <= "0") {
            setAttrs({
                "dmg4": 2
            });   
        }
        if (bulk == "1") {
            setAttrs({
                "dmg4": 3
            });   
        }
        if (bulk >= "2") {
            setAttrs({
                "dmg4": 4
            });   
        }
    }
    if (shieldbashradio == "0" && wpntype == "2") {
        if (dmg == "0" || dmg == "2") {
            setAttrs({
                "dmg4": 2
            });          
        }
    }
  });
});

on("change:shieldbashradio5 change:dmg5 change:bulk5 change:wpntype5 sheet:opened", function() {  
  getAttrs(["shieldbashradio5","dmg5","bulk5","wpntype5"], function(values) {
    let shieldbashradio = parseFloat(values.shieldbashradio5)||0;
    let dmg = parseInt(values.dmg5)||0;
    let bulk = parseInt(values.bulk5)||0;
    let wpntype = parseInt(values.wpntype5)||0;
    if (shieldbashradio == "1" && wpntype == "2") {
        if (bulk <= "0") {
            setAttrs({
                "dmg5": 2
            });   
        }
        if (bulk == "1") {
            setAttrs({
                "dmg5": 3
            });   
        }
        if (bulk >= "2") {
            setAttrs({
                "dmg5": 4
            });   
        }
    }
    if (shieldbashradio == "0" && wpntype == "2") {
        if (dmg == "0" || dmg == "2") {
            setAttrs({
                "dmg5": 2
            });          
        }
    }
  });
});

</script>

<script type="text/worker">

on("change:grapplefinal change:grapplererollmod sheet:opened", function() {  
  getAttrs(["grapplefinal","grapplererollmod"], function(values) {
    let recheck = parseFloat(values.grapplefinal)||0;
    let grapplererollmod = parseInt(values.grapplererollmod)||0;
    let resultreroll = recheck - Math.floor(recheck);
    if(resultreroll == "0") {
        setAttrs({
            "resultrerollgrapple": 0 + grapplererollmod
        });}
    if(resultreroll == "0.5") {
        setAttrs({
            "resultrerollgrapple": 1 + grapplererollmod
    });}
  });
});

on("change:mighttotalfloat change:gracetotalfloat change:insighttotalfloat change:parryradio sheet:opened", function() {  
  getAttrs(["mighttotalfloat","parryradio","gracetotalfloat","insighttotalfloat"], function(values) {
    let mighttotalfloat = parseFloat(values.mighttotalfloat)||0;
    let gracetotalfloat = parseFloat(values.gracetotalfloat)||0;
    let insighttotalfloat = parseFloat(values.insighttotalfloat)||0;
    let parryradio = parseInt(values.parryradio)||0;
    if (parryradio == "1") {
        setAttrs({                            
            "parryatt": mighttotalfloat
        });
    }
    if (parryradio == "2") {
        setAttrs({                            
            "parryatt": gracetotalfloat
        });
    }
    if (parryradio == "3") {
        setAttrs({                            
            "parryatt": insighttotalfloat
        });
    }
  });
});

on("change:mighttotalfloat change:gracetotalfloat change:insighttotalfloat change:dodgeradio sheet:opened", function() {  
  getAttrs(["mighttotalfloat","dodgeradio","gracetotalfloat","insighttotalfloat"], function(values) {
    let mighttotalfloat = parseFloat(values.mighttotalfloat)||0;
    let gracetotalfloat = parseFloat(values.gracetotalfloat)||0;
    let insighttotalfloat = parseFloat(values.insighttotalfloat)||0;
    let dodgeradio = parseInt(values.dodgeradio)||0;
    if (dodgeradio == "1") {
        setAttrs({                            
            "dodgeatt": mighttotalfloat
        });
    }
    if (dodgeradio == "2") {
        setAttrs({                            
            "dodgeatt": gracetotalfloat
        });
    }
    if (dodgeradio == "3") {
        setAttrs({                            
            "dodgeatt": insighttotalfloat
        });
    }
  });
});

on("change:dodgemod change:dodgeatt change:dedsta change:defboxbulk change:paraltier change:dodgebuff change:speed change:civmodneb sheet:opened", function() {  
  getAttrs(["dodgemod","dodgeatt","dedsta","defboxbulk","paraltier","dodgebuff","speed","civmodneb"], function(values) {
    let dodgeatt = parseFloat(values.dodgeatt)||0;
    let dodgebuff = parseInt(values.dodgebuff)||0;
    let dodgemod = values.dodgemod||0;
    let defboxbulk = parseInt(values.defboxbulk)||0;
    let dedsta = parseInt(values.dedsta)||0;
    let dedstabulk = dedsta * defboxbulk;
    let paraltier = parseInt(values.paraltier)||0;
    let speed = parseInt(values.speed)||0;
    let civilized = parseInt(values.civmodneb)||0;
    let paraldebuff = (paraltier >= 2) ? 1 : 0;
    setAttrs({                            
      "dodgetotal": dodgeatt + dedsta + dedstabulk + dodgebuff + civilized - dodgemod - paraldebuff
    });
    setAttrs({                            
      "dodgetotalspeed": speed + dedsta + dedstabulk + dodgebuff + civilized - dodgemod - paraldebuff
    });
  });
});

on("change:parrymod change:parryatt change:parrybonus change:paraltier change:parrybuff change:civmodneb sheet:opened", function() {  
  getAttrs(["parrymod","parryatt","parrybonus","paraltier","parrybuff","civmodneb"], function(values) {
    let parryatt = parseFloat(values.parryatt)||0;
    let parrybuff = parseInt(values.parrybuff)||0;
    let parrymod = parseInt(values.parrymod)||0;
    let parrybonus = parseInt(values.parrybonus)||0;
    let paraltier = parseInt(values.paraltier)||0;
    let civilized = parseInt(values.civmodneb)||0;
    let paraldebuff = (paraltier >= 2) ? 1 : 0;
    setAttrs({                            
      "parrytotal": parryatt + parrybonus + parrybuff + civilized - parrymod - paraldebuff
    });
  });
});

on("change:mighttotalload change:loadmod change:naturalsaddle change:semightfin change:seprimeattfin change:bulkcheck sheet:opened", function() {  
  getAttrs(["mighttotalload","loadmod","naturalsaddle","semightfin","seprimeattfin","bulkcheck"], function(values) {
    let mighttotal = parseInt(values.mighttotalload)||0;
    let loadmod = parseInt(values.loadmod)||0;
    let naturalsaddle = parseInt(values.naturalsaddle)||0;
    let semightfin = parseInt(values.semightfin)||0;
    let seprimeattfin = parseInt(values.seprimeattfin)||0;
    let bulkcheck = parseInt(values.bulkcheck)||0;
    let saddle = Math.ceil(naturalsaddle / 2);

    const output = {};
    output.load = mighttotal + loadmod + saddle - semightfin - seprimeattfin
    setAttrs(output);
  });
});

on("change:might sheet:opened change:mightmod change:bulkcheck change:mightcheckbuff change:unimodneb change:mightrerollmod change:semight change:seprimeatt change:attrnummodneb change:unirerollmodneb", function() {  
  getAttrs(["might","mightmod","bulkcheck","mightcheckbuff","mightrerollmod","unimodneb","semight","seprimeatt","attrnummodneb","unirerollmodneb"], function(values) {
    let might = parseFloat(values.might)||0;
    let mightmod = parseFloat(values.mightmod)||0;
    let mightcheckbuff = parseInt(values.mightcheckbuff)||0;
    let mightrerollmod = parseInt(values.mightrerollmod)||0;
    let bulkcheck = parseInt(values.bulkcheck)||0;
    let unimodneb = parseInt(values.unimodneb)||0;
    let semight = parseInt(values.semight)||0;
    let seprimeatt = parseInt(values.seprimeatt)||0;
    let attrnummodneb = parseInt(values.attrnummodneb)||0;
    let unirerollmodneb = parseInt(values.unirerollmodneb)||0;
    let mighttotal = might + mightmod + mightcheckbuff + unimodneb + semight + seprimeatt + attrnummodneb - bulkcheck;
    let mightreroll = mighttotal - Math.floor(mighttotal);

    const output = {};
    output.mighttotal = Math.floor(mighttotal)
    output.mighttotalload = Math.floor(mighttotal) + bulkcheck
    output.mighttotalfloat = mighttotal
    output.mightreroll = (mightreroll == 0) ? mightrerollmod + unirerollmodneb : 1 + mightrerollmod + unirerollmodneb
    setAttrs(output);
  });
});

on("change:grace sheet:opened change:gracemod change:bulkcheck change:gracecheckbuff change:gracererollmod change:unimodneb change:segrace change:seprimeatt change:attrnummodneb change:unirerollmodneb", function() {  
  getAttrs(["grace","gracemod","bulkcheck","gracecheckbuff","gracererollmod","unimodneb","segrace","seprimeatt","attrnummodneb","unirerollmodneb"], function(values) {
    let grace = parseFloat(values.grace)||0;
    let gracemod = parseFloat(values.gracemod)||0;
    let gracecheckbuff = parseInt(values.gracecheckbuff)||0;
    let gracererollmod = parseInt(values.gracererollmod)||0;
    let bulkcheck = parseInt(values.bulkcheck)||0;
    let unimodneb = parseInt(values.unimodneb)||0;
    let segrace = parseInt(values.segrace)||0;
    let seprimeatt = parseInt(values.seprimeatt)||0;
    let attrnummodneb = parseInt(values.attrnummodneb)||0;
    let unirerollmodneb = parseInt(values.unirerollmodneb)||0;
    let gracetotal = grace + gracemod + gracecheckbuff + unimodneb + segrace + seprimeatt + attrnummodneb - bulkcheck;
    let gracereroll = gracetotal - Math.floor(gracetotal);
    setAttrs({                            
      "gracetotal": Math.floor(gracetotal)
    });
    setAttrs({                            
      "gracetotalfloat": gracetotal
    });
    if(gracereroll == "0") {
        setAttrs({
            "gracereroll": 0 + gracererollmod + unirerollmodneb
        });}
    if(gracereroll == "0.5") {
        setAttrs({
            "gracereroll": 1 + gracererollmod + unirerollmodneb
        });}
  });
});

on("change:shell sheet:opened change:shellmod change:shellcheckbuff change:shellrerollmod change:elytra change:unimodneb change:seshell change:seprimeatt change:attrnummodneb change:unirerollmodneb", function() {  
  getAttrs(["shell","shellmod","shellcheckbuff","shellrerollmod","unimodneb","elytra","seshell","seprimeatt","attrnummodneb","unirerollmodneb"], function(values) {
    let shell = parseFloat(values.shell)||0;
    let shellmod = parseFloat(values.shellmod)||0;
    let shellcheckbuff = parseInt(values.shellcheckbuff)||0;
    let shellrerollmod = parseInt(values.shellrerollmod)||0;
    let unimodneb = parseInt(values.unimodneb)||0;
    let elytra = parseInt(values.elytra)||0;
    let seshell = parseInt(values.seshell)||0;
    let seprimeatt = parseInt(values.seprimeatt)||0;
    let attrnummodneb = parseInt(values.attrnummodneb)||0;
    let unirerollmodneb = parseInt(values.unirerollmodneb)||0;
    let shelltotal = shell + shellmod + shellcheckbuff + unimodneb + seshell + seprimeatt + attrnummodneb - elytra;
    let shellreroll = shelltotal - Math.floor(shelltotal);
    setAttrs({                            
      "shelltotal": Math.floor(shelltotal)
    });
    setAttrs({
      "shelltotalfloat": shelltotal
    });
    if(shellreroll == "0") {
        setAttrs({
            "shellreroll": 0 + shellrerollmod + unirerollmodneb
        });}
    if(shellreroll == "0.5") {
        setAttrs({
            "shellreroll": 1 + shellrerollmod + unirerollmodneb
        });}
  });
});

on("change:insight sheet:opened change:insightmod change:insightcheckbuff change:insightrerollmod change:deceivemod change:deceivererollmod change:convincemod change:convincererollmod change:unimodneb change:seinsight change:seprimeatt change:attrnummodneb change:unirerollmodneb", function() {  
  getAttrs(["insight","insightmod","insightcheckbuff","insightrerollmod","deceivemod","deceivererollmod","convincemod","convincererollmod","unimodneb","seinsight","seprimeatt","attrnummodneb","unirerollmodneb"], function(values) {
    let insight = parseFloat(values.insight)||0;
    let insightmod = parseFloat(values.insightmod)||0;
    let insightcheckbuff = parseInt(values.insightcheckbuff)||0;
    let insightrerollmod = parseInt(values.insightrerollmod)||0;
    let deceivemod = parseInt(values.deceivemod)||0;
    let deceivererollmod = parseInt(values.deceivererollmod)||0;
    let convincemod = parseInt(values.convincemod)||0;
    let convincererollmod = parseInt(values.convincererollmod)||0;
    let unimodneb = parseInt(values.unimodneb)||0;
    let seinsight = parseInt(values.seinsight)||0;
    let seprimeatt = parseInt(values.seprimeatt)||0;
    let attrnummodneb = parseInt(values.attrnummodneb)||0;
    let unirerollmodneb = parseInt(values.unirerollmodneb)||0;
    let insighttotal = insight + insightmod + insightcheckbuff + unimodneb + seinsight + seprimeatt + attrnummodneb;
    let insightreroll = insighttotal - Math.floor(insighttotal);
    setAttrs({                            
      "insighttotal": Math.floor(insighttotal)
    });
    setAttrs({                            
      "insighttotalfloat": insighttotal
    });
    setAttrs({                            
      "deceiveneb": insighttotal + deceivemod
    });
    setAttrs({                            
      "convinceneb": insighttotal + convincemod
    });
    if(insightreroll == "0") {
        setAttrs({
            "insightreroll": 0 + insightrerollmod + unirerollmodneb
        });
        setAttrs({
            "deceivenebreroll": 0 + insightrerollmod + deceivererollmod + unirerollmodneb
        });
        setAttrs({
            "convincenebreroll": 0 + insightrerollmod + convincererollmod + unirerollmodneb
        });
    }
    if(insightreroll == "0.5") {
        setAttrs({
            "insightreroll": 1 + insightrerollmod + unirerollmodneb
        });
        setAttrs({
            "deceivenebreroll": 1 + insightrerollmod + deceivererollmod + unirerollmodneb
        });
        setAttrs({
            "convincenebreroll": 1 + insightrerollmod + convincererollmod + unirerollmodneb
        });
    }
  });
});

on("change:cute change:cutererollmod change:endearmod change:endearrerollmod change:unimodneb change:unirerollmodneb sheet:opened", function() {  
  getAttrs(["cute","cutererollmod","endearmod","endearrerollmod","unimodneb","unirerollmodneb"], function(values) {
    let cutefloat = parseFloat(values.cute)||0;
    let cutererollmod = parseInt(values.cutererollmod)||0;
    let endearmod = parseInt(values.endearmod)||0;
    let endearrerollmod = parseInt(values.endearrerollmod)||0;
    let unimodneb = parseInt(values.unimodneb)||0;
    let unirerollmodneb = parseInt(values.unirerollmodneb)||0;
    let cute = cutefloat + unimodneb;
    let cutereroll = cute - Math.floor(cute);
    setAttrs({                            
      "cutetotal": Math.floor(cute)
    });
    setAttrs({                            
      "cutetotalfloat": cute
    });
    setAttrs({                            
      "endearneb": cute + endearmod
    });
    if(cutereroll == "0") {
        setAttrs({
            "cutereroll": 0 + cutererollmod + unirerollmodneb
        });
        setAttrs({
            "endearnebreroll": 0 + cutererollmod + endearrerollmod + unirerollmodneb
        });
    }
    if(cutereroll == "0.5") {
        setAttrs({
            "cutereroll": 1 + cutererollmod + unirerollmodneb
        });
        setAttrs({
            "endearnebreroll": 1 + cutererollmod + endearrerollmod + unirerollmodneb
        });
    }
  });
});

on("change:spook change:spookrerollmod change:bullymod change:bullyrerollmod change:unimodneb change:unirerollmodneb sheet:opened", function() {  
  getAttrs(["spook","spookrerollmod","bullymod","bullyrerollmod","unimodneb","unirerollmodneb"], function(values) {
    let spookfloat = parseFloat(values.spook)||0;
    let spookrerollmod = parseInt(values.spookrerollmod)||0;
    let bullymod = parseInt(values.bullymod)||0;
    let bullyrerollmod = parseInt(values.bullyrerollmod)||0;
    let unimodneb = parseInt(values.unimodneb)||0;
    let unirerollmodneb = parseInt(values.unirerollmodneb)||0;
    let spook = spookfloat + unimodneb;
    let spookreroll = spook - Math.floor(spook);
    setAttrs({                            
      "spooktotal": Math.floor(spook)
    });
    setAttrs({                            
      "spooktotalfloat": spook
    });
    setAttrs({                            
      "bullyneb": spook + bullymod
    });
    if(spookreroll == "0") {
        setAttrs({
            "spookreroll": 0 + spookrerollmod + unirerollmodneb
        });
        setAttrs({
            "bullynebreroll": 0 + spookrerollmod + bullyrerollmod + unirerollmodneb
        });
    }
    if(spookreroll == "0.5") {
        setAttrs({
            "spookreroll": 1 + spookrerollmod + unirerollmodneb
        });
        setAttrs({
            "bullynebreroll": 1 + spookrerollmod + bullyrerollmod + unirerollmodneb
        });
    }
  });
});

on("change:atkboxgrapple change:atkboxopportunity change:atkboxpaired change:atkboxsqueeze change:atkboxunseen change:defboxgrapple change:defboxsqueeze change:defboxunseen change:defboxranged change:defboxmove sheet:opened", function() {  
  getAttrs(["atkboxgrapple","atkboxpaired","atkboxopportunity","atkboxsqueeze","atkboxunseen","defboxgrapple","defboxsqueeze","defboxunseen","defboxranged","defboxmove"], function(values) {
    if(values.atkboxgrapple == "0") {
        setAttrs({
            "grapplemod": 0
        });}
    if(values.atkboxgrapple == "1") {
        setAttrs({
            "grapplemod": 1
        });}
    if(values.atkboxpaired == "0") {
        setAttrs({
            "pairedmod": 0
        });}
    if(values.atkboxpaired == "1") {
        setAttrs({
            "pairedmod": 1
        });}
    if(values.atkboxopportunity == "0") {
        setAttrs({
            "opportunitymod": 0
        });}
    if(values.atkboxopportunity == "1") {
        setAttrs({
            "opportunitymod": 1
        });}
    if(values.atkboxsqueeze == "0") {
        setAttrs({
            "squeezemod": 0
        });}
    if(values.atkboxsqueeze == "1") {
        setAttrs({
            "squeezemod": 1
        });}
    if(values.atkboxunseen == "0") {
        setAttrs({
            "unseenmod": 0
        });}
    if(values.atkboxunseen == "1") {
        setAttrs({
            "unseenmod": 2
        });}
    if(values.defboxgrapple == "0") {
        setAttrs({
            "defgrapplemod": 0
        });}
    if(values.defboxgrapple == "1") {
        setAttrs({
            "defgrapplemod": 1
        });}
    if(values.defboxsqueeze == "0") {
        setAttrs({
            "defsqueezemod": 0
        });}
    if(values.defboxsqueeze == "1") {
        setAttrs({
            "defsqueezemod": 1
        });}
    if(values.defboxunseen == "0") {
        setAttrs({
            "defunseenmod": 0
        });}
    if(values.defboxunseen == "1") {
        setAttrs({
            "defunseenmod": 2
        });}
    if(values.defboxranged == "0") {
        setAttrs({
            "defrangedmod": 0
        });}
    if(values.defboxranged == "1") {
        setAttrs({
            "defrangedmod": 2
        });}
    if(values.defboxmove == "0") {
        setAttrs({
            "defmovemod": 0
        });}
    if(values.defboxmove == "1") {
        setAttrs({
            "defmovemod": 1
        });}

  });
});

on("change:stinger change:sharpproboscis sheet:opened", function() {  
  getAttrs(["stinger","sharpproboscis"], function(values) {
    let stinger = parseInt(values.stinger)||0;
    let sp = parseInt(values.sharpproboscis)||0;
    let stingermod = stinger * 2;
    let spmod = sp * 2;

        setAttrs({
            "traitsattackmod": stingermod
        });
    });
});

on("change:grapplemod change:squeezemod change:pairedmod change:opportunitymod change:unseenmod change:atkboxcovered change:defgrapplemod change:defsqueezemod change:defunseenmod change:defrangedmod change:attackbuff change:traitsattackmod change:hivemind sheet:opened", function() {  
  getAttrs(["grapplemod","squeezemod","pairedmod","opportunitymod","unseenmod","atkboxcovered","defgrapplemod","defsqueezemod","defunseenmod","defrangedmod","attackbuff","traitsattackmod","hivemind"], function(values) {
    let grapplemod = values.grapplemod||0;
    let squeezemod = values.squeezemod||0;
    let attackbuff = parseInt(values.attackbuff)||0;
    let opportunitymod = values.opportunitymod||0;
    let pairedmod = values.pairedmod||0;
    let unseenmod = values.unseenmod||0;
    let atkboxcovered = values.atkboxcovered||0;
    let defgrapplemod = values.defgrapplemod||0;
    let defsqueezemod = values.defsqueezemod||0;
    let defunseenmod = values.defunseenmod||0;
    let defrangedmod = values.defrangedmod||0;
    let bulkcheck = values.bulkcheck||0;
    let traitsattackmod = parseInt(values.traitsattackmod)||0;
    let hivemind = parseInt(values.hivemind)||0;
    setAttrs({
        "resultmod": grapplemod + squeezemod + pairedmod + opportunitymod + unseenmod + (4 * atkboxcovered) + traitsattackmod - hivemind
    });
    setAttrs({
        "dodgemod": defgrapplemod + defsqueezemod + defunseenmod
    });
    setAttrs({
        "parrymod": defgrapplemod + defsqueezemod + defunseenmod + defrangedmod
    });
  });
});

</script>

<script type="text/worker">

on("change:atkequip change:pryequip change:result1 change:result2 change:result3 change:result4 change:result5 change:wpntype1 change:wpntype2 change:wpntype3 change:wpntype4 change:wpntype5 change:qty1 change:qty2 change:qty3 change:qty4 change:qty5 change:dmg1 change:dmg2 change:dmg3 change:dmg4 change:dmg5 change:shieldqtybonus1 change:shieldqtybonus2 change:shieldqtybonus3 change:shieldqtybonus4 change:shieldqtybonus5 change:shieldbashradio1 change:shieldbashradio2 change:shieldbashradio3 change:shieldbashradio4 change:shieldbashradio5 change:stamtaxtax1 change:stamtaxtax2 change:stamtaxtax3 change:stamtaxtax4 change:stamtaxtax5 change:stamtaxtaxgeneral change:stamattackmod1 change:stamattackmod2 change:stamattackmod3 change:stamattackmod4 change:stamattackmod5 change:stamattackmodgeneral change:parryweaponbuff1 change:parryweaponbuff2 change:parryweaponbuff3 change:parryweaponbuff4 change:parryweaponbuff5 change:parryweaponbuffgeneral change:parryweaponrerollbuff1 change:parryweaponrerollbuff2 change:parryweaponrerollbuff3 change:parryweaponrerollbuff4 change:parryweaponrerollbuff5 change:parryweaponrerollbuffgeneral change:parryshieldbuff1 change:parryshieldbuff2 change:parryshieldbuff3 change:parryshieldbuff4 change:parryshieldbuff5 change:parryshieldbuffgeneral change:parryshieldrerollbuff1 change:parryshieldrerollbuff2 change:parryshieldrerollbuff3 change:parryshieldrerollbuff4 change:parryshieldrerollbuff5 change:parryshieldrerollbuffgeneral change:grapplerollmod1 change:grapplerollmod2 change:grapplerollmod3 change:grapplerollmod4 change:grapplerollmod5 change:grapplerollmodgeneral change:grapplererollmod1 change:grapplererollmod2 change:grapplererollmod3 change:grapplererollmod4 change:grapplererollmod5 change:grapplererollmodgeneral change:attackbuff1 change:attackbuff2 change:attackbuff3 change:attackbuff4 change:attackbuff5 change:attackbuffgeneral change:attackrerollbuff1 change:attackrerollbuff2 change:attackrerollbuff3 change:attackrerollbuff4 change:attackrerollbuff5 change:attackrerollbuffgeneral change:mightattackmod1 change:mightattackmod2 change:mightattackmod3 change:mightattackmod4 change:mightattackmod5 change:mightattackmodgeneral change:mightattackrerollmod1 change:mightattackrerollmod2 change:mightattackrerollmod3 change:mightattackrerollmod4 change:mightattackrerollmod5 change:mightattackrerollmodgeneral change:graceattackmod1 change:graceattackmod2 change:graceattackmod3 change:graceattackmod4 change:graceattackmod5 change:graceattackmodgeneral change:graceattackrerollmod1 change:graceattackrerollmod2 change:graceattackrerollmod3 change:graceattackrerollmod4 change:graceattackrerollmod5 change:graceattackrerollmodgeneral change:insightattackmod1 change:insightattackmod2 change:insightattackmod3 change:insightattackmod4 change:insightattackmod5 change:insightattackmodgeneral change:insightattackrerollmod1 change:insightattackrerollmod2 change:insightattackrerollmod3 change:insightattackrerollmod4 change:insightattackrerollmod5 change:insightattackrerollmodgeneral change:meleererolltotal1 change:meleererolltotal2 change:meleererolltotal3 change:meleererolltotal4 change:meleererolltotal5 change:rangedrerolltotal1 change:rangedrerolltotal2 change:rangedrerolltotal3 change:rangedrerolltotal4 change:rangedrerolltotal5 change:gplequip change:bulk1 change:bulk2 change:bulk3 change:bulk4 change:bulk5 change:attackoffbal1 change:attackoffbal2 change:attackoffbal3 change:attackoffbal4 change:attackoffbal5 change:wpnclass1 change:wpnclass2 change:wpnclass3 change:wpnclass4 change:wpnclass5 sheet:opened", function() {  
  getAttrs(["atkequip","pryequip","result1","result2","result3","result4","result5","wpntype1","wpntype2","wpntype3","wpntype4","wpntype5","qty1","qty2","qty3","qty4","qty5","dmg1","dmg2","dmg3","dmg4","dmg5","shieldqtybonus1","shieldqtybonus2","shieldqtybonus3","shieldqtybonus4","shieldqtybonus5","shieldbashradio1","shieldbashradio2","shieldbashradio3","shieldbashradio4","shieldbashradio5","stamtaxtax1","stamtaxtax2","stamtaxtax3","stamtaxtax4","stamtaxtax5","stamtaxtaxgeneral","stamattackmod1","stamattackmod2","stamattackmod3","stamattackmod4","stamattackmod5","stamattackmodgeneral","parryweaponbuff1","parryweaponbuff2","parryweaponbuff3","parryweaponbuff4","parryweaponbuff5","parryweaponbuffgeneral","parryweaponrerollbuff1","parryweaponrerollbuff2","parryweaponrerollbuff3","parryweaponrerollbuff4","parryweaponrerollbuff5","parryweaponrerollbuffgeneral","parryshieldbuff1","parryshieldbuff2","parryshieldbuff3","parryshieldbuff4","parryshieldbuff5","parryshieldbuffgeneral","parryshieldrerollbuff1","parryshieldrerollbuff2","parryshieldrerollbuff3","parryshieldrerollbuff4","parryshieldrerollbuff5","parryshieldrerollbuffgeneral","grapplerollmodgeneral","grapplerollmod1","grapplerollmod2","grapplerollmod3","grapplerollmod4","grapplerollmod5","grapplererollmod1","grapplererollmod2","grapplererollmod3","grapplererollmod4","grapplererollmod5","grapplererollmodgeneral","attackbuff1","attackbuff2","attackbuff3","attackbuff4","attackbuff5","attackbuffgeneral","attackrerollbuff1","attackrerollbuff2","attackrerollbuff3","attackrerollbuff4","attackrerollbuff5","attackrerollbuffgeneral","mightattackmod1","mightattackmod2","mightattackmod3","mightattackmod4","mightattackmod5","mightattackmodgeneral","mightattackrerollmod1","mightattackrerollmod2","mightattackrerollmod3","mightattackrerollmod4","mightattackrerollmod5","mightattackrerollmodgeneral","graceattackmod1","graceattackmod2","graceattackmod3","graceattackmod4","graceattackmod5","graceattackmodgeneral","graceattackrerollmod1","graceattackrerollmod2","graceattackrerollmod3","graceattackrerollmod4","graceattackrerollmod5","graceattackrerollmodgeneral","insightattackmod1","insightattackmod2","insightattackmod3","insightattackmod4","insightattackmod5","insightattackmodgeneral","insightattackrerollmod1","insightattackrerollmod2","insightattackrerollmod3","insightattackrerollmod4","insightattackrerollmod5","insightattackrerollmodgeneral","gplequip","meleererolltotal1","meleererolltotal2","meleererolltotal3","meleererolltotal4","meleererolltotal5","rangedrerolltotal1","rangedrerolltotal2","rangedrerolltotal3","rangedrerolltotal4","rangedrerolltotal5","bulk1","bulk2","bulk3","bulk4","bulk5","attackoffbal1","attackoffbal2","attackoffbal3","attackoffbal4","attackoffbal5","wpnclass1","wpnclass2","wpnclass3","wpnclass4","wpnclass5"], function(values) {
    let atkequip = parseInt(values.atkequip)||0;
    let pryequip = parseInt(values.pryequip)||0;
    let gplequip = parseInt(values.gplequip)||0;
    let result1 = parseFloat(values.result1)||0;
    let result2 = parseFloat(values.result2)||0;
    let result3 = parseFloat(values.result3)||0;
    let result4 = parseFloat(values.result4)||0;
    let result5 = parseFloat(values.result5)||0;
    let dmg1 = parseInt(values.dmg1)||0;
    let dmg2 = parseInt(values.dmg2)||0;
    let dmg3 = parseInt(values.dmg3)||0;
    let dmg4 = parseInt(values.dmg4)||0;
    let dmg5 = parseInt(values.dmg5)||0;
    let qty1 = parseInt(values.qty1)||0;
    let qty2 = parseInt(values.qty2)||0;
    let qty3 = parseInt(values.qty3)||0;
    let qty4 = parseInt(values.qty4)||0;
    let qty5 = parseInt(values.qty5)||0;
    let wpntype1 = parseFloat(values.wpntype1)||0;
    let wpntype2 = parseFloat(values.wpntype2)||0;
    let wpntype3 = parseFloat(values.wpntype3)||0;
    let wpntype4 = parseFloat(values.wpntype4)||0;
    let wpntype5 = parseFloat(values.wpntype5)||0;
    let shieldqtybonus1 = parseInt(values.shieldqtybonus1)||0;
    let shieldqtybonus2 = parseInt(values.shieldqtybonus2)||0;
    let shieldqtybonus3 = parseInt(values.shieldqtybonus3)||0;
    let shieldqtybonus4 = parseInt(values.shieldqtybonus4)||0;
    let shieldqtybonus5 = parseInt(values.shieldqtybonus5)||0;
    let shieldbashradio1 = parseInt(values.shieldbashradio1)||0;
    let shieldbashradio2 = parseInt(values.shieldbashradio2)||0;
    let shieldbashradio3 = parseInt(values.shieldbashradio3)||0;
    let shieldbashradio4 = parseInt(values.shieldbashradio4)||0;
    let shieldbashradio5 = parseInt(values.shieldbashradio5)||0;
    let stamtaxtax1 = parseInt(values.stamtaxtax1)||0;
    let stamtaxtax2 = parseInt(values.stamtaxtax2)||0;
    let stamtaxtax3 = parseInt(values.stamtaxtax3)||0;
    let stamtaxtax4 = parseInt(values.stamtaxtax4)||0;
    let stamtaxtax5 = parseInt(values.stamtaxtax5)||0;
    let stamtaxtaxgeneral = parseInt(values.stamtaxtaxgeneral)||0;
    let stamattackmod1 = parseInt(values.stamattackmod1)||0;
    let stamattackmod2 = parseInt(values.stamattackmod2)||0;
    let stamattackmod3 = parseInt(values.stamattackmod3)||0;
    let stamattackmod4 = parseInt(values.stamattackmod4)||0;
    let stamattackmod5 = parseInt(values.stamattackmod5)||0;
    let stamattackmodgeneral = parseInt(values.stamattackmodgeneral)||0;
    let parryweaponbuff1 = parseInt(values.parryweaponbuff1)||0;
    let parryweaponbuff2 = parseInt(values.parryweaponbuff2)||0;
    let parryweaponbuff3 = parseInt(values.parryweaponbuff3)||0;
    let parryweaponbuff4 = parseInt(values.parryweaponbuff4)||0;
    let parryweaponbuff5 = parseInt(values.parryweaponbuff5)||0;
    let parryweaponbuffgeneral = parseInt(values.parryweaponbuffgeneral)||0;
    let parryweaponrerollbuff1 = parseInt(values.parryweaponrerollbuff1)||0;
    let parryweaponrerollbuff2 = parseInt(values.parryweaponrerollbuff2)||0;
    let parryweaponrerollbuff3 = parseInt(values.parryweaponrerollbuff3)||0;
    let parryweaponrerollbuff4 = parseInt(values.parryweaponrerollbuff4)||0;
    let parryweaponrerollbuff5 = parseInt(values.parryweaponrerollbuff5)||0;
    let parryweaponrerollbuffgeneral = parseInt(values.parryweaponrerollbuffgeneral)||0;
    let parryshieldbuff1 = parseInt(values.parryshieldbuff1)||0;
    let parryshieldbuff2 = parseInt(values.parryshieldbuff2)||0;
    let parryshieldbuff3 = parseInt(values.parryshieldbuff3)||0;
    let parryshieldbuff4 = parseInt(values.parryshieldbuff4)||0;
    let parryshieldbuff5 = parseInt(values.parryshieldbuff5)||0;
    let parryshieldbuffgeneral = parseInt(values.parryshieldbuffgeneral)||0;
    let parryshieldrerollbuff1 = parseInt(values.parryshieldrerollbuff1)||0;
    let parryshieldrerollbuff2 = parseInt(values.parryshieldrerollbuff2)||0;
    let parryshieldrerollbuff3 = parseInt(values.parryshieldrerollbuff3)||0;
    let parryshieldrerollbuff4 = parseInt(values.parryshieldrerollbuff4)||0;
    let parryshieldrerollbuff5 = parseInt(values.parryshieldrerollbuff5)||0;
    let parryshieldrerollbuffgeneral = parseInt(values.parryshieldrerollbuffgeneral)||0;

    let grapplerollmod1 = parseInt(values.grapplerollmod1)||0;
    let grapplerollmod2 = parseInt(values.grapplerollmod2)||0;
    let grapplerollmod3 = parseInt(values.grapplerollmod3)||0;
    let grapplerollmod4 = parseInt(values.grapplerollmod4)||0;
    let grapplerollmod5 = parseInt(values.grapplerollmod5)||0;
    let grapplerollmodgeneral = parseInt(values.grapplerollmodgeneral)||0;

    let grapplererollmod1 = parseInt(values.grapplererollmod1)||0;
    let grapplererollmod2 = parseInt(values.grapplererollmod2)||0;
    let grapplererollmod3 = parseInt(values.grapplererollmod3)||0;
    let grapplererollmod4 = parseInt(values.grapplererollmod4)||0;
    let grapplererollmod5 = parseInt(values.grapplererollmod5)||0;
    let grapplererollmodgeneral = parseInt(values.grapplererollmodgeneral)||0;
    
    let attackbuff1 = parseInt(values.attackbuff1)||0;   
    let attackbuff2 = parseInt(values.attackbuff2)||0;
    let attackbuff3 = parseInt(values.attackbuff3)||0; 
    let attackbuff4 = parseInt(values.attackbuff4)||0; 
    let attackbuff5 = parseInt(values.attackbuff5)||0; 
    let attackbuffgeneral = parseInt(values.attackbuffgeneral)||0;

    let attackrerollbuff1 = parseInt(values.attackrerollbuff1)||0;
    let attackrerollbuff2 = parseInt(values.attackrerollbuff2)||0;    
    let attackrerollbuff3 = parseInt(values.attackrerollbuff3)||0;    
    let attackrerollbuff4 = parseInt(values.attackrerollbuff4)||0;    
    let attackrerollbuff5 = parseInt(values.attackrerollbuff5)||0;    
    let attackrerollbuffgeneral = parseInt(values.attackrerollbuffgeneral)||0;
    
    let mightattackmod1 = parseInt(values.mightattackmod1)||0;
    let mightattackmod2 = parseInt(values.mightattackmod2)||0;
    let mightattackmod3 = parseInt(values.mightattackmod3)||0;    
    let mightattackmod4 = parseInt(values.mightattackmod4)||0;    
    let mightattackmod5 = parseInt(values.mightattackmod5)||0;    
    let mightattackmodgeneral = parseInt(values.mightattackmodgeneral)||0;

    let mightattackrerollmod1 = parseInt(values.mightattackrerollmod1)||0;
    let mightattackrerollmod2 = parseInt(values.mightattackrerollmod2)||0;
    let mightattackrerollmod3 = parseInt(values.mightattackrerollmod3)||0;
    let mightattackrerollmod4 = parseInt(values.mightattackrerollmod4)||0;
    let mightattackrerollmod5 = parseInt(values.mightattackrerollmod5)||0;
    let mightattackrerollmodgeneral = parseInt(values.mightattackrerollmodgeneral)||0;
 
    let graceattackmod1 = parseInt(values.mightattackrerollmod1)||0;
    let graceattackmod2 = parseInt(values.mightattackrerollmod2)||0;
    let graceattackmod3 = parseInt(values.mightattackrerollmod3)||0;
    let graceattackmod4 = parseInt(values.mightattackrerollmod4)||0;
    let graceattackmod5 = parseInt(values.mightattackrerollmod5)||0;
    let graceattackmodgeneral = parseInt(values.mightattackrerollmodgeneral)||0;

    let graceattackrerollmod1 = parseInt(values.mightattackrerollmod1)||0;
    let graceattackrerollmod2 = parseInt(values.mightattackrerollmod2)||0;
    let graceattackrerollmod3 = parseInt(values.mightattackrerollmod3)||0;
    let graceattackrerollmod4 = parseInt(values.mightattackrerollmod4)||0;
    let graceattackrerollmod5 = parseInt(values.mightattackrerollmod5)||0;
    let graceattackrerollmodgeneral = parseInt(values.mightattackrerollmodgeneral)||0;

    let insightattackmod1 = parseInt(values.mightattackrerollmod1)||0;
    let insightattackmod2 = parseInt(values.mightattackrerollmod2)||0;
    let insightattackmod3 = parseInt(values.mightattackrerollmod3)||0;
    let insightattackmod4 = parseInt(values.mightattackrerollmod4)||0;
    let insightattackmod5 = parseInt(values.mightattackrerollmod5)||0;
    let insightattackmodgeneral = parseInt(values.mightattackrerollmodgeneral)||0;

    let insightattackrerollmod1 = parseInt(values.mightattackrerollmod1)||0;
    let insightattackrerollmod2 = parseInt(values.mightattackrerollmod2)||0;
    let insightattackrerollmod3 = parseInt(values.mightattackrerollmod3)||0;
    let insightattackrerollmod4 = parseInt(values.mightattackrerollmod4)||0;
    let insightattackrerollmod5 = parseInt(values.mightattackrerollmod5)||0;
    let insightattackrerollmodgeneral = parseInt(values.mightattackrerollmodgeneral)||0;
    
    let meleererolltotal1 = parseInt(values.meleererolltotal1)||0;
    let meleererolltotal2 = parseInt(values.meleererolltotal2)||0;
    let meleererolltotal3 = parseInt(values.meleererolltotal3)||0;
    let meleererolltotal4 = parseInt(values.meleererolltotal4)||0;
    let meleererolltotal5 = parseInt(values.meleererolltotal5)||0;
    let rangedrerolltotal1 = parseInt(values.rangedrerolltotal1)||0;
    let rangedrerolltotal2 = parseInt(values.rangedrerolltotal2)||0;
    let rangedrerolltotal3 = parseInt(values.rangedrerolltotal3)||0;
    let rangedrerolltotal4 = parseInt(values.rangedrerolltotal4)||0;
    let rangedrerolltotal5 = parseInt(values.rangedrerolltotal5)||0;
    
    let bulk1 = parseInt(values.bulk1)||0;
    let bulk2 = parseInt(values.bulk2)||0;
    let bulk3 = parseInt(values.bulk3)||0;
    let bulk4 = parseInt(values.bulk4)||0;
    let bulk5 = parseInt(values.bulk5)||0;

    let attackoffbal1 = parseInt(values.attackoffbal1)||0;
    let attackoffbal2 = parseInt(values.attackoffbal2)||0;
    let attackoffbal3 = parseInt(values.attackoffbal3)||0;
    let attackoffbal4 = parseInt(values.attackoffbal4)||0;
    let attackoffbal5 = parseInt(values.attackoffbal5)||0;

    let wpnclass1 = parseInt(values.wpnclass1)||0;
    let wpnclass2 = parseInt(values.wpnclass2)||0;
    let wpnclass3 = parseInt(values.wpnclass3)||0;
    let wpnclass4 = parseInt(values.wpnclass4)||0;
    let wpnclass5 = parseInt(values.wpnclass5)||0;

    if(gplequip == "1") {
        setAttrs({
            "grapplerollmod": grapplerollmod1 + grapplerollmodgeneral
        });
        setAttrs({
            "grapplererollmod": grapplererollmod1 + grapplererollmodgeneral
        });
    }
    if(gplequip == "2") {
        setAttrs({
            "grapplerollmod": grapplerollmod2 + grapplerollmodgeneral
        });
        setAttrs({
            "grapplererollmod": grapplererollmod2 + grapplererollmodgeneral
        });
    }
    if(gplequip == "3") {
        setAttrs({
            "grapplerollmod": grapplerollmod3 + grapplerollmodgeneral
        });
        setAttrs({
            "grapplererollmod": grapplererollmod3 + grapplererollmodgeneral
        });
    }
    if(gplequip == "4") {
        setAttrs({
            "grapplerollmod": grapplerollmod4 + grapplerollmodgeneral
        });
        setAttrs({
            "grapplererollmod": grapplererollmod4 + grapplererollmodgeneral
        });
    }
    if(gplequip == "5") {
        setAttrs({
            "grapplerollmod": grapplerollmod5 + grapplerollmodgeneral
        });
        setAttrs({
            "grapplererollmod": grapplererollmod5 + grapplererollmodgeneral
        });
    }

    if(atkequip == "1") {
        setAttrs({
            "result": result1
        });
        setAttrs({
            "dmgcrt": dmg1
        });
        setAttrs({
            "wpntype": wpntype1
        });
        setAttrs({
            "shieldbashcrt": shieldbashradio1
        });
        setAttrs({
            "stamtaxtax": stamtaxtax1 + stamtaxtaxgeneral
        });
        setAttrs({
            "stamattackmod": stamattackmod1 + stamattackmodgeneral
        });
        setAttrs({
            "attackbuff": attackbuff1 + attackbuffgeneral
        });
        setAttrs({
            "attackrerollbuff": attackrerollbuff1 + attackrerollbuffgeneral
        });
        setAttrs({
            "mightattackmodx": mightattackmod1 + mightattackmodgeneral
        });
        setAttrs({
            "mightattackrerollmodx": mightattackrerollmod1 + mightattackrerollmodgeneral
        });
        setAttrs({
            "graceattackmodx": graceattackmod1 + graceattackmodgeneral
        });
        setAttrs({
            "graceattackrerollmodx": graceattackrerollmod1 + graceattackrerollmodgeneral
        });
        setAttrs({
            "insightattackmodx": insightattackmod1 + insightattackmodgeneral
        });
        setAttrs({
            "insightattackrerollmodx": insightattackrerollmod1 + insightattackrerollmodgeneral
        });
        setAttrs({
            "meleererolltotal": meleererolltotal1
        });
        setAttrs({
            "rangedrerolltotal": rangedrerolltotal1
        });
        setAttrs({
            "bulkcurrent": bulk1
        });
        setAttrs({
            "attackoffbal": attackoffbal1
        });
        setAttrs({
            "wpnclasscurrent": wpnclass1
        });
    }
    if(atkequip == "2") {
        setAttrs({
            "result": result2
        });
        setAttrs({
            "dmgcrt": dmg2
        });
        setAttrs({
            "wpntype": wpntype2
        });
        setAttrs({
            "shieldbashcrt": shieldbashradio2
        });
        setAttrs({
            "stamtaxtax": stamtaxtax2 + stamtaxtaxgeneral
        });
        setAttrs({
            "stamattackmod": stamattackmod2 + stamattackmodgeneral
        })
        setAttrs({
            "attackbuff": attackbuff2 + attackbuffgeneral
        });
        setAttrs({
            "attackrerollbuff": attackrerollbuff2 + attackrerollbuffgeneral
        });
        setAttrs({
            "mightattackmodx": mightattackmod2 + mightattackmodgeneral
        });
        setAttrs({
            "mightattackrerollmodx": mightattackrerollmod2 + mightattackrerollmodgeneral
        });
        setAttrs({
            "graceattackmodx": graceattackmod2 + graceattackmodgeneral
        });
        setAttrs({
            "graceattackrerollmodx": graceattackrerollmod2 + graceattackrerollmodgeneral
        });
        setAttrs({
            "insightattackmodx": insightattackmod2 + insightattackmodgeneral
        });
        setAttrs({
            "insightattackrerollmodx": insightattackrerollmod2 + insightattackrerollmodgeneral
        });
        setAttrs({
            "meleererolltotal": meleererolltotal2
        });
        setAttrs({
            "rangedrerolltotal": rangedrerolltotal2
        });
        setAttrs({
            "bulkcurrent": bulk2
        });
        setAttrs({
            "attackoffbal": attackoffbal2
        });
        setAttrs({
            "wpnclasscurrent": wpnclass2
        });
    }
    if(atkequip == "3") {
        setAttrs({
            "result": result3
        });
        setAttrs({
            "dmgcrt": dmg3
        });
        setAttrs({
            "wpntype": wpntype3
        });
        setAttrs({
            "shieldbashcrt": shieldbashradio3
        });
        setAttrs({
            "stamtaxtax": stamtaxtax3 + stamtaxtaxgeneral
        });
        setAttrs({
            "stamattackmod": stamattackmod3 + stamattackmodgeneral
        });
        setAttrs({
            "attackbuff": attackbuff3 + attackbuffgeneral
        });
        setAttrs({
            "attackrerollbuff": attackrerollbuff3 + attackrerollbuffgeneral
        });
        setAttrs({
            "mightattackmodx": mightattackmod3 + mightattackmodgeneral
        });
        setAttrs({
            "mightattackrerollmodx": mightattackrerollmod3 + mightattackrerollmodgeneral
        });
        setAttrs({
            "graceattackmodx": graceattackmod3 + graceattackmodgeneral
        });
        setAttrs({
            "graceattackrerollmodx": graceattackrerollmod3 + graceattackrerollmodgeneral
        });
        setAttrs({
            "insightattackmodx": insightattackmod3 + insightattackmodgeneral
        });
        setAttrs({
            "insightattackrerollmodx": insightattackrerollmod3 + insightattackrerollmodgeneral
        });
        setAttrs({
            "meleererolltotal": meleererolltotal3
        });
        setAttrs({
            "rangedrerolltotal": rangedrerolltotal3
        });
        setAttrs({
            "bulkcurrent": bulk3
        });
        setAttrs({
            "attackoffbal": attackoffbal3
        });
        setAttrs({
            "wpnclasscurrent": wpnclass3
        });
    }
    if(atkequip == "4") {
        setAttrs({
            "result": result4
        });
        setAttrs({
            "dmgcrt": dmg4
        });
        setAttrs({
            "wpntype": wpntype4
        });
        setAttrs({
            "shieldbashcrt": shieldbashradio4
        });
        setAttrs({
            "stamtaxtax": stamtaxtax4 + stamtaxtaxgeneral
        });
        setAttrs({
            "stamattackmod": stamattackmod4 + stamattackmodgeneral
        });
        setAttrs({
            "attackbuff": attackbuff4 + attackbuffgeneral
        });
        setAttrs({
            "attackrerollbuff": attackrerollbuff4 + attackrerollbuffgeneral
        });
        setAttrs({
            "mightattackmodx": mightattackmod4 + mightattackmodgeneral
        });
        setAttrs({
            "mightattackrerollmodx": mightattackrerollmod4 + mightattackrerollmodgeneral
        });
        setAttrs({
            "graceattackmodx": graceattackmod4 + graceattackmodgeneral
        });
        setAttrs({
            "graceattackrerollmodx": graceattackrerollmod4 + graceattackrerollmodgeneral
        });
        setAttrs({
            "insightattackmodx": insightattackmod4 + insightattackmodgeneral
        });
        setAttrs({
            "insightattackrerollmodx": insightattackrerollmod4 + insightattackrerollmodgeneral
        });
        setAttrs({
            "meleererolltotal": meleererolltotal4
        });
        setAttrs({
            "rangedrerolltotal": rangedrerolltotal4
        });
        setAttrs({
            "bulkcurrent": bulk4
        });
        setAttrs({
            "attackoffbal": attackoffbal4
        });
        setAttrs({
            "wpnclasscurrent": wpnclass4
        });
    }
    if(atkequip == "5") {
        setAttrs({
            "result": result5
        });
        setAttrs({
            "dmgcrt": dmg5
        });
        setAttrs({
            "wpntype": wpntype5
        });
        setAttrs({
            "shieldbashcrt": shieldbashradio5
        });
        setAttrs({
            "stamtaxtax": stamtaxtax5 + stamtaxtaxgeneral
        });
        setAttrs({
            "stamattackmod": stamattackmod5 + stamattackmodgeneral
        });
        setAttrs({
            "attackbuff": attackbuff5 + attackbuffgeneral
        });
        setAttrs({
            "attackrerollbuff": attackrerollbuff5 + attackrerollbuffgeneral
        });
        setAttrs({
            "mightattackmodx": mightattackmod5 + mightattackmodgeneral
        });
        setAttrs({
            "mightattackrerollmodx": mightattackrerollmod5 + mightattackrerollmodgeneral
        });
        setAttrs({
            "graceattackmodx": graceattackmod5 + graceattackmodgeneral
        });
        setAttrs({
            "graceattackrerollmodx": graceattackrerollmod5 + graceattackrerollmodgeneral
        });
        setAttrs({
            "insightattackmodx": insightattackmod5 + insightattackmodgeneral
        });
        setAttrs({
            "insightattackrerollmodx": insightattackrerollmod5 + insightattackrerollmodgeneral
        });
        setAttrs({
            "meleererolltotal": meleererolltotal5
        });
        setAttrs({
            "rangedrerolltotal": rangedrerolltotal5
        });
        setAttrs({
            "bulkcurrent": bulk5
        });
        setAttrs({
            "attackoffbal": attackoffbal5
        });
        setAttrs({
            "wpnclasscurrent": wpnclass5
        });
    }
    if(pryequip == "1") {
        setAttrs({
            "parrytype": wpntype1
        });
        setAttrs({
            "qtycrt": qty1 + shieldqtybonus1
        });
        setAttrs({
            "parryweaponbuff": parryweaponbuff1 + parryweaponbuffgeneral
        });
        setAttrs({
            "parryweaponrerollbuff": parryweaponrerollbuff1 + parryweaponrerollbuffgeneral
        });
        setAttrs({
            "parryshieldbuff": parryshieldbuff1 + parryshieldbuffgeneral
        });
        setAttrs({
            "parryshieldrerollbuff": parryshieldrerollbuff1 + parryshieldrerollbuffgeneral
        });
    }
    if(pryequip == "2") {
        setAttrs({
            "parrytype": wpntype2
        });
        setAttrs({
            "qtycrt": qty2 + shieldqtybonus2
        });
        setAttrs({
            "parryweaponbuff": parryweaponbuff2 + parryweaponbuffgeneral
        });
        setAttrs({
            "parryweaponrerollbuff": parryweaponrerollbuff2 + parryweaponrerollbuffgeneral
        });
        setAttrs({
            "parryshieldbuff": parryshieldbuff2 + parryshieldbuffgeneral
        });
        setAttrs({
            "parryshieldrerollbuff": parryshieldrerollbuff2 + parryshieldrerollbuffgeneral
        });
    }
    if(pryequip == "3") {
        setAttrs({
            "parrytype": wpntype3
        });
        setAttrs({
            "qtycrt": qty3 + shieldqtybonus3
        });
        setAttrs({
            "parryweaponbuff": parryweaponbuff3 + parryweaponbuffgeneral
        });
        setAttrs({
            "parryweaponrerollbuff": parryweaponrerollbuff3 + parryweaponrerollbuffgeneral
        });
        setAttrs({
            "parryshieldbuff": parryshieldbuff3 + parryshieldbuffgeneral
        });
        setAttrs({
            "parryshieldrerollbuff": parryshieldrerollbuff3 + parryshieldrerollbuffgeneral
        });
    }
    if(pryequip == "4") {
        setAttrs({
            "parrytype": wpntype4
        });
        setAttrs({
            "qtycrt": qty4 + shieldqtybonus4
        });
        setAttrs({
            "parryweaponbuff": parryweaponbuff4 + parryweaponbuffgeneral
        });
        setAttrs({
            "parryweaponrerollbuff": parryweaponrerollbuff4 + parryweaponrerollbuffgeneral
        });
        setAttrs({
            "parryshieldbuff": parryshieldbuff4 + parryshieldbuffgeneral
        });
        setAttrs({
            "parryshieldrerollbuff": parryshieldrerollbuff4 + parryshieldrerollbuffgeneral
        });
    }
    if(pryequip == "5") {
        setAttrs({
            "parrytype": wpntype5
        });
        setAttrs({
            "qtycrt": qty5 + shieldqtybonus5
        });
        setAttrs({
            "parryweaponbuff": parryweaponbuff5 + parryweaponbuffgeneral
        });
        setAttrs({
            "parryweaponrerollbuff": parryweaponrerollbuff5 + parryweaponrerollbuffgeneral
        });
        setAttrs({
            "parryshieldbuff": parryshieldbuff5 + parryshieldbuffgeneral
        });
        setAttrs({
            "parryshieldrerollbuff": parryshieldrerollbuff5 + parryshieldrerollbuffgeneral
        });
    }
  });
});

</script>

<script type="text/worker">

on("change:parrytype change:dedsta change:qtycrt change:parryweaponbuff change:parryshieldbuff sheet:opened", function() {  
  getAttrs(["parrytype","dedsta","qtycrt","parryweaponbuff","parryshieldbuff"], function(values) {
    let parrytype = parseInt(values.parrytype)||0;
    let dedsta = parseInt(values.dedsta)||0;
    let qtycrt = parseInt(values.qtycrt)||0;
    let parryweaponbuff = parseInt(values.parryweaponbuff)||0;
    let parryshieldbuff = parseInt(values.parryshieldbuff)||0;
    if(parrytype == "1") {
        if(qtycrt >= dedsta) {
            let parrybonus = dedsta * 2;
            setAttrs({
                "parrybonus": parrybonus + parryweaponbuff
            });    
        }
        if(qtycrt < dedsta) {
            let parrymin = qtycrt * 2;
            let parrybonus = parrymin + dedsta + parryweaponbuff - qtycrt;
            setAttrs({
                "parrybonus": parrybonus
            });    
        }
        
    }
    if(parrytype == "2") {
        let parrybonus = qtycrt + dedsta + parryshieldbuff;
        setAttrs({
            "parrybonus": parrybonus
        });}
  });
});

</script>

<script type="text/worker">

on("change:bulk1 change:bulk2 change:bulk3 change:bulk4 change:bulk5 change:dmg1 change:dmg2 change:dmg3 change:dmg4 change:dmg5 change:rng1 change:rng2 change:rng3 change:rng4 change:rng5 change:qty1 change:qty2 change:qty3 change:qty4 change:qty5 sheet:opened", function() {  
  getAttrs(["bulk1","bulk2","bulk3","bulk4","bulk5","dmg1","dmg2","dmg3","dmg4","dmg5","rng1","rng2","rng3","rng4","rng5","qty1","qty2","qty3","qty4","qty5"], function(values) {
        if(values.bulk1 == 0 && values.dmg1 == 0 && values.rng1 == 0 && values.qty1 == 0) {
            setAttrs({
                "result1zero": 0
            });
        } if(values.bulk1 >= 1 || values.dmg1 >= 1 || values.rng1 >= 1 || values.qty1 >= 1) {
            setAttrs({
                "result1zero": 1
            });
        }
        if(values.bulk2 == 0 && values.dmg2 == 0 && values.rng2 == 0 && values.qty2 == 0) {
            setAttrs({
                "result2zero": 0
            });
        } if(values.bulk2 >= 1 || values.dmg2 >= 1 || values.rng2 >= 1 || values.qty2 >= 1) {
            setAttrs({
                "result2zero": 1
            });
        }
        if(values.bulk3 == 0 && values.dmg3 == 0 && values.rng3 == 0 && values.qty3 == 0) {
            setAttrs({
                "result3zero": 0
            });
        } if(values.bulk3 >= 1 || values.dmg3 >= 1 || values.rng3 >= 1 || values.qty3 >= 1) {
            setAttrs({
                "result3zero": 1
            });
        }
        if(values.bulk4 == 0 && values.dmg4 == 0 && values.rng4 == 0 && values.qty4 == 0) {
            setAttrs({
                "result4zero": 0
            });
        } if(values.bulk4 >= 1 || values.dmg4 >= 1 || values.rng4 >= 1 || values.qty4 >= 1) {
            setAttrs({
                "result4zero": 1
            });
        }
        if(values.bulk5 == 0 && values.dmg5 == 0 && values.rng5 == 0 && values.qty5 == 0) {
            setAttrs({
                "result5zero": 0
            });
        } if(values.bulk5 >= 1 || values.dmg5 >= 1 || values.rng5 >= 1 || values.qty5 >= 1) {
            setAttrs({
                "result5zero": 1
            });
        }
  });
});

on('change:heart sheet:opened', () => {
    getAttrs(['heartmax', 'heart'], function(values) {
        let heartmax = parseInt(values.heartmax)||0;
        let heart = parseInt(values.heart)||0;
        if(heart > heartmax) {
            setAttrs({
                "heart": heartmax
                });
        }
    });
});

on('change:soul sheet:opened', () => {
    getAttrs(['soulmax', 'soul'], function(values) {
        let soulmax = parseInt(values.soulmax)||0;
        let soul = parseInt(values.soul)||0;
        if(soul > soulmax) {
            setAttrs({
                "soul": soulmax
                });
        }
    });
});

on('change:stam change:paraltier sheet:opened', () => {
    getAttrs(['stammax', 'stam', 'paraltier'], function(values) {
        let stammax = parseInt(values.stammax)||0;
        let stam = parseInt(values.stam)||0;
        let paraltier = parseInt(values.paraltier)||0;
        let paralcheck = (paraltier >= 1) ? 1 : 0;
        let stamcheck = stammax - 1;
        if(stam > stammax && paraltier == 0) {
            setAttrs({
                "stam": stammax
                });
        }
        if(stam > stamcheck && paraltier != 0) {
            setAttrs({
                "stam": stamcheck
                });
        }
    });
});

on('change:cust1 sheet:opened', () => {
    getAttrs(['cust1max', 'cust1'], function(values) {
        let custmax = parseInt(values.cust1max)||0;
        let cust = parseInt(values.cust1)||0;
        if(cust > custmax) {
            setAttrs({
                "cust1": custmax
                });
        }
    });
});

on('change:cust2 sheet:opened', () => {
    getAttrs(['cust2max', 'cust2'], function(values) {
        let custmax = parseInt(values.cust2max)||0;
        let cust = parseInt(values.cust2)||0;
        if(cust > custmax) {
            setAttrs({
                "cust2": custmax
                });
        }
    });
});

on('change:cust3 sheet:opened', () => {
    getAttrs(['cust3max', 'cust3'], function(values) {
        let custmax = parseInt(values.cust3max)||0;
        let cust = parseInt(values.cust3)||0;
        if(cust > custmax) {
            setAttrs({
                "cust3": custmax
                });
        }
    });
});

on('change:dedsta change:stam change:stamtemp sheet:opened', () => {
    getAttrs(['dedsta', 'stamtemp', 'stam'], function(values) {
        let stam = parseInt(values.stam)||0;
        let stamtemp = parseInt(values.stamtemp)||0;
        let dedsta = parseInt(values.dedsta)||0;
        let maxdedsta = stam + stamtemp - 1;
        if(maxdedsta <= 0) {
            setAttrs({
                "dedsta": 0
                });
        }
        if((dedsta > maxdedsta) && (maxdedsta != "-1")) {
            setAttrs({
                "dedsta": maxdedsta
                });
        }
    });
});

//on('change:speed change:speedmax sheet:opened', () => {
//    getAttrs(['speed','speedmax'], function(values) {
//        let speedmax = parseInt(values.speedmax)||0;
//        let speed = parseInt(values.speed)||0;
//        if(speed > speedmax) {
//           setAttrs({
//                "speed": speedmax
//                });
//        }
//    });
//});

on('change:gracetotal change:footworkmod change:segracefin change:seprimeattfin sheet:opened', () => {
    getAttrs(['gracetotal','footworkmod','segracefin','seprimeattfin'], function(values) {
        let gt = parseInt(values.gracetotal)||0;
        let fwm = parseInt(values.footworkmod)||0;
        let segracefin = parseInt(values.segracefin)||0;
        let seprimeattfin = parseInt(values.seprimeattfin)||0;
        let fwt = gt + (fwm * 2) - segracefin - seprimeattfin;
        let footwork = Math.ceil(fwt / 2);
        setAttrs({
            "footwork": footwork
        });
    });
});

on('change:insighttotal change:techmod change:seinsightfin change:seprimeattfin sheet:opened', () => {
    getAttrs(['insighttotal','techmod','seinsightfin','seprimeattfin'], function(values) {
        let gt = parseInt(values.insighttotal)||0;
        let fwm = parseInt(values.techmod)||0;
        let segracefin = parseInt(values.seinsightfin)||0;
        let seprimeattfin = parseInt(values.seprimeattfin)||0;
        let fwt = gt + fwm - segracefin - seprimeattfin;
        let footwork = Math.floor(fwt);
        setAttrs({
            "techslot": footwork
        });
    });
});

on('change:shelltotal change:beltmod change:seshellfin change:seprimeattfin sheet:opened', () => {
    getAttrs(['shelltotal','beltmod','seshellfin','seprimeattfin'], function(values) {
        let shelltotal = parseInt(values.shelltotal)||0;
        let beltmod = parseInt(values.beltmod)||0;
        let seshellfin = parseInt(values.seshellfin)||0;
        let seprimeattfin = parseInt(values.seprimeattfin)||0;
        let belt = shelltotal + beltmod - seshellfin - seprimeattfin;
        setAttrs({
            "belt": belt
        });
    });
});


</script>

<script type="text/worker">

on('change:dr change:armdur change:armsoak change:armsoakreroll change:armordrcheck1 change:armordrcheck2 change:armordrcheck3 change:resistradio change:damredbuffnostack change:armoractive1 change:sharpproboscis sheet:opened', () => {
    getAttrs(['armdur','dr','armsoak','armsoakreroll','armordrcheck1','armordrcheck2','armordrcheck3','resistradio','damredbuffnostack','armoractive1','sharpproboscis'], function(values) {
        let armdur = parseInt(values.armdur)||0;
        let armsoak = parseInt(values.armsoak)||0;
        let armsoakreroll = parseInt(values.armsoakreroll)||0;
        let armordrcheck1 = parseInt(values.armordrcheck1)||0;
        let armordrcheck2 = parseInt(values.armordrcheck2)||0;
        let armordrcheck3 = parseInt(values.armordrcheck3)||0;
        let resistradio = parseInt(values.resistradio)||0;
        let armoractive1 = parseInt(values.armoractive1)||0;
        let sp = parseInt(values.sharpproboscis)||0;
        let dr = parseInt(values.dr)||0;
        let damredbuffnostack = parseInt(values.damredbuffnostack)||0;
    if((armdur > "0") && (armoractive1 == "1") && (sp == "0")) {
        if(resistradio == "0") {
            if (dr > damredbuffnostack) {
                if(armordrcheck1 == "1") {
                    setAttrs({
                        "drarb": dr
                    });
                }
                if(armordrcheck1 == "0") {
                    setAttrs({
                        "drarb": damredbuffnostack
                    });
                }
            }
            else {
                setAttrs({
                    "drarb": damredbuffnostack
                });
            }
        }
        if(resistradio == "1") {
            if (dr > damredbuffnostack) {
                if(armordrcheck2 == "1") {
                    setAttrs({
                        "drarb": dr
                    });
                }
                else {
                    setAttrs({
                        "drarb": damredbuffnostack
                    });
                }
            }
            else {
                setAttrs({
                    "drarb": damredbuffnostack
                });
            }
        }
        if(resistradio == "2") {
            if (dr > damredbuffnostack) {
                if(armordrcheck3 == "1") {
                    setAttrs({
                        "drarb": dr
                    });
                }
                else {
                    setAttrs({
                        "drarb": damredbuffnostack
                    });
                }
            }
            else {
                setAttrs({
                    "drarb": damredbuffnostack
                });
            }
        }
    }
    else {
        setAttrs({
            "drarb": 0
        });
    }
        const output = {};
        output.armsoakarb = ((armdur > "0") && (armoractive1 == "1")) ? armsoak : 0;
        output.armsoakrerollarb = ((armdur > "0") && (armoractive1 == "1")) ? armsoakreroll : 0;
        setAttrs(output);
    });
});





on('change:soakrerollmod change:armsoakrerollarb change:soakmagicrerollmod change:soakenvirorerollmod change:soakmagicradio change:soakenviroradio change:softbody change:shellreroll change:armorsoakcheck1 change:armorsoakcheck2 change:armorsoakcheck3 change:armsoakrerollmagicextra change:armsoakrerollenviroextra sheet:opened', () => {
    getAttrs(["soakrerollmod","armsoakrerollarb","soakmagicrerollmod","soakenvirorerollmod","soakmagicradio","soakenviroradio","softbody","shellreroll","armorsoakcheck1","armorsoakcheck2","armorsoakcheck3","armsoakrerollmagicextra","armsoakrerollenviroextra"], function(values) {
        let shellreroll = parseInt(values.shellreroll)||0;
        let softbody = parseInt(values.softbody)||0;
        let soakrerollmod = parseInt(values.soakrerollmod)||0;
        let armsoakreroll = parseInt(values.armsoakrerollarb)||0;
        let soakmagicrerollmod = parseInt(values.soakmagicrerollmod)||0;
        let soakenvirorerollmod = parseInt(values.soakenvirorerollmod)||0;
        let soakmagicradio = parseInt(values.soakmagicradio)||0;
        let soakenviroradio = parseInt(values.soakenviroradio)||0;
        let armorsoakcheck1 = parseInt(values.armorsoakcheck1)||0;
        let armorsoakcheck2 = parseInt(values.armorsoakcheck2)||0;
        let armorsoakcheck3 = parseInt(values.armorsoakcheck3)||0;
        let armsoakrerollmagicextra = parseInt(values.armsoakrerollmagicextra)||0;
        let armsoakrerollenviroextra = parseInt(values.armsoakrerollenviroextra)||0;
        let armsoakrerollnormal = (armorsoakcheck1 == 1) ? armsoakreroll : 0;
        let armsoakrerollmagic = (armorsoakcheck2 == 1) ? armsoakreroll : 0;
        let armsoakrerollenviro = (armorsoakcheck3 == 1) ? armsoakreroll : 0;
        let shellrerollcheck = (softbody == 0) ? shellreroll : 0;
        let soakrerollnormal = soakrerollmod + shellrerollcheck;
        const output = {};
        output.soakrerollnormal = soakrerollnormal + armsoakrerollnormal;
        output.soakrerollmagic = (soakmagicradio == "1") ? soakmagicrerollmod + soakrerollnormal + armsoakrerollmagic + armsoakrerollmagicextra : soakmagicrerollmod + armsoakrerollmagic + armsoakrerollmagicextra;
        output.soakrerollenviro = (soakenviroradio == "1") ? soakenvirorerollmod + soakrerollnormal + armsoakrerollenviro + armsoakrerollenviroextra : soakenvirorerollmod + armsoakrerollenviro + armsoakrerollenviroextra;
        setAttrs(output);
    });
});


on("change:softbody change:resistradio change:shelltotal change:armsoakarb change:soakmod change:soakmagicmod change:soakenviromod change:soakmagicradio change:soakenviroradio change:drisk change:drarb change:damredbuff change:damriskbuff change:soakrerollnormal change:soakrerollmagic change:soakrerollenviro change:armorsoakcheck1 change:armorsoakcheck2 change:armorsoakcheck3 change:armsoakmagicextra change:armsoakenviroextra change:res change:sharpproboscis change:soakdastardlymod change:phobia sheet:opened", function() {  
  getAttrs(["shelltotal","armsoakarb","soakmod","soakmagicmod","soakenviromod","softbody","soakmagicradio","soakenviroradio","resistradio","drisk","drarb","damredbuff","damriskbuff","soakrerollnormal","soakrerollmagic","soakrerollenviro","armorsoakcheck1","armorsoakcheck2","armorsoakcheck3","armsoakmagicextra","armsoakenviroextra","res","sharpproboscis","soakdastardlymod","phobia"], function(values) {
    let dr = parseInt(values.drarb)||0;
    let damredbuff = parseInt(values.damredbuff)||0;
    let damriskbuff = parseInt(values.damriskbuff)||0;
    let drisk = parseInt(values.drisk)||0;
    let dredresult = drisk + damriskbuff - dr - damredbuff;
    const output = {}; // create the output variable to contain the final values.
    output.driskdr = (dredresult <= 0) ? 1 : dredresult;
    setAttrs(output);
    let softbody = parseInt(values.softbody)||0;
    let resistradio = parseInt(values.resistradio)||0;
    let shelltotal = parseInt(values.shelltotal)||0;
    let armsoak = parseInt(values.armsoakarb)||0;
    let sp = parseInt(values.sharpproboscis)||0;
    let armsoakmagicextra = parseInt(values.armsoakmagicextra)||0;
    let armsoakenviroextra = parseInt(values.armsoakenviroextra)||0;
    let soakmod = parseInt(values.soakmod)||0;
    let soakmagicmod = parseInt(values.soakmagicmod)||0;
    let soakenviromod = parseInt(values.soakenviromod)||0;
    let soakrerollnormal = parseInt(values.soakrerollnormal)||0;
    let soakrerollmagic = parseInt(values.soakrerollmagic)||0;
    let soakrerollenviro = parseInt(values.soakrerollenviro)||0;
    let soakmagicradio = parseInt(values.soakmagicradio)||0;
    let soakenviroradio = parseInt(values.soakenviroradio)||0;
    let armorsoakcheck1 = parseInt(values.armorsoakcheck1)||0;
    let armorsoakcheck2 = parseInt(values.armorsoakcheck2)||0;
    let armorsoakcheck3 = parseInt(values.armorsoakcheck3)||0;
    let res = parseInt(values.res)||0;
    let soakdastardlymod = parseInt(values.soakdastardlymod)||0;
    let phobia = parseInt(values.phobia)||0;
    let armsoaknormal = (armorsoakcheck1 == 1) ? armsoak : 0;
    let armsoakmagic = (armorsoakcheck2 == 1) ? armsoak : 0;
    let armsoakenviro = (armorsoakcheck3 == 1) ? armsoak : 0;
    let shellbonus = (softbody == 0) ? shelltotal : 0;
    let shellsoakbonus = soakmod + shellbonus + phobia;
    let shellsoakbonusmagic = (soakmagicradio == 1) ? (shellsoakbonus + soakmagicmod) : soakmagicmod;
    let shellsoakbonusenviro = (soakenviroradio == 1) ? (shellsoakbonus + soakenviromod) : soakenviromod;
    if(resistradio == 0) {
        setAttrs({
            "soaktotal": Math.max(0,(shellsoakbonus + armsoaknormal + soakdastardlymod + (res * 4) - (sp * 2))) 
        });
        setAttrs({
            "soakreroll": soakrerollnormal
        });
    }
    if(resistradio == 1) {
        setAttrs({
            "soaktotal": Math.max(0,(shellsoakbonusmagic + armsoakmagic + soakdastardlymod + armsoakmagicextra + (res * 4) - (sp * 2)))
        });
        setAttrs({
            "soakreroll": soakrerollmagic
        });
    }
    if(resistradio == 2) {
        setAttrs({
            "soaktotal": Math.max(0,(shellsoakbonusenviro + armsoakenviro + soakdastardlymod + armsoakenviroextra + (res * 4) - (sp * 2)))
        });
        setAttrs({
            "soakreroll": soakrerollenviro
        });
    }
        setAttrs({
            "soakenvirototal": shellsoakbonusenviro + armsoakenviro + armsoakenviroextra + (res * 4)
        });
        setAttrs({
            "soakenviroreroll": soakrerollenviro
        });
  });
});

</script>

<script type="text/worker">

on('change:absorption change:absorptiondur change:armoractive2 sheet:opened', () => {
    getAttrs(['absorption','absorptiondur','armoractive2'], function(values) {
        let absorption = parseInt(values.absorption)||0;
        let absorptiondur = parseInt(values.absorptiondur)||0;
        let armoractive2 = parseInt(values.armoractive2)||0;
        const output = {};
        output.absorptionarb = ((absorptiondur > "0") && (armoractive2 == "1")) ? absorption : 0;
        setAttrs(output);
    });
});

on("clicked:resist", function(info) {  
  getAttrs(["driskdr","absorptionarb","resistradio","softbody","shelltotal","shellreroll","drisk","soaktotal","soakreroll","setsuccesssoak","vul","unilock","unirerolllock"], function(values) {
    let soakreroll = parseInt(values.soakreroll)||0;
    let driskdr = parseInt(values.driskdr)||0;
    let drisk = parseInt(values.drisk)||0;
    let absorption = parseInt(values.absorptionarb)||0;
    let radio = parseInt(values.resistradio)||0;
    let soaktotal = parseInt(values.soaktotal)||0;
    let vul = parseInt(values.vul)||0;
    let unilock = parseInt(values.unilock)||0;
    let unirerolllock = parseInt(values.unirerolllock)||0;
    let raidoalt  = (radio >= 1) ? 1 : 0;
    if(drisk != 0) {
        if(soakreroll >= "1") {
        let rollString = "&{template:soakplusreroll} {{name=Soak}} {{rollsoakplusreroll=[[[[floor(@{soaktotal})]]d6>@{setsuccesssoak}]]}}";
            rollString += "{{rollsoakr1=[[@{soakreroll}d6>5]]}}";
        startRoll(rollString, results => {
            const roll = results.results.rollsoakplusreroll.result;
            const reroll_calculated = results.results.rollsoakr1.result;
            const rerollmin = (soaktotal - roll <= 0) ? 0 : soaktotal - roll;
            const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
            const total = driskdr - roll - reroll;
            const absconst = ((total <= 0) || (absorption <= 0)) ? 0 : 1;
            const totalfinal = (total <= 0) ? 0 : total;
            const absorbfinal = (absorption >= 1) ? absorption : 1;
            const totalabs = Math.floor(totalfinal / absorbfinal) + absconst + vul;
        finishRoll(results.rollId, {
                rollsoakplusreroll: totalabs
                });
        });
    }
        else {
        let rollString = "&{template:soak} {{name=Soak}} {{rollsoak=[[[[floor(@{soaktotal})]]d6>@{setsuccesssoak}]]}}";
            rollString += "{{rollsoakr1=[[0]]}}";
        startRoll(rollString, results => {
            const roll = results.results.rollsoak.result;
            const reroll_calculated = results.results.rollsoakr1.result;
            const rerollmin = (soaktotal - roll <= 0) ? 0 : soaktotal - roll;
            const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
            const total = driskdr - roll - reroll;
            const absconst = ((total <= 0) || (absorption <= 0)) ? 0 : 1;
            const totalfinal = (total <= 0) ? 0 : total;
            const absorbfinal = (absorption >= 1) ? absorption : 1;
            const totalabs = Math.floor(totalfinal / absorbfinal) + absconst + vul;
        finishRoll(results.rollId, {
                rollsoak: totalabs
                });
        });
        }
        setAttrs({
            "drisk": 0
        });
        setAttrs({
            "resistradio": 0
        });
        setAttrs({
            "res": 0
        });
        setAttrs({
            "vul": 0
        });
        setAttrs({
            "sharpproboscis": 0
        });
    if (unilock == 0) {
    setAttrs({
        "unimod": 0
    });
    }
    if (unirerolllock == 0) {
    setAttrs({
        "unirerollmod": 0
    });
    }
    }
    if(drisk == 0) {
        let rollString = "&{template:errordrisk} {{name=Errordrisk}} {{rollerrordrisk=[[0]]}}";
        startRoll(rollString, results => {
            finishRoll(results.rollId, {
                });
        });
    }
    });
});

</script>

<script type="text/worker">

on("clicked:turn", function() {  
  getAttrs(["dot1","dot2","dot3","stamtax","offbal","heart","stammax","paraltier","paral","speedmax","stamtaxmod","bulkcheck","hearttemp","soakenviroreroll","soakenvirototal","driskdr","drisk","absorptionarb","damredbuffdot"], function(values) {
    let dot1 = parseInt(values.dot1)||0;
    let dot2 = parseInt(values.dot2)||0;
    let dot3 = parseInt(values.dot3)||0;
    let speedmax = parseInt(values.speedmax)||0;
    let stamtax = parseInt(values.stamtax)||0;
    let offbal = parseInt(values.offbal)||0;
    let stammax = parseInt(values.stammax)||0;
    let heart = parseInt(values.heart)||0;
    let hearttemp = parseInt(values.hearttemp)||0;
    let paraltier = parseInt(values.paraltier)||0;
    
    let soakenvirototal = parseInt(values.soakenvirototal)||0;
    let soakenviroreroll = parseInt(values.soakenviroreroll)||0;
    let driskdr = parseInt(values.driskdr)||0;
    let drisk = parseInt(values.drisk)||0;
    let absorption = parseInt(values.absorptionarb)||0;
    let damredbuffdot = parseInt(values.damredbuffdot)||0;
    
    let dotdr1 = ((dot1 - damredbuffdot) >= 1) ? damredbuffdot : 0;
    let dotdr2 = ((dot2 - damredbuffdot) >= 1) ? damredbuffdot : 0;
    let dotdr3 = ((dot3 - damredbuffdot) >= 1) ? damredbuffdot : 0;
    
    if ((dot1 == "0") & (dot2 == "0") & (dot3 == "0")) {
        let paraldebuff = (paraltier >= 1) ? 1 : 0;
        let offbalfinal = (offbal != 0) ? offbal - 1 : 0;
        let stammath = stammax - offbal - paraldebuff;
        let stamfinal = (stammath < 0) ? 0 : stammath;
        setAttrs({
            "offbal": offbalfinal
        });
        setAttrs({
            "stam": stamfinal
        });
        setAttrs({
            "speed": speedmax
        });
    }
    if ((dot1 >= "1") && ((soakenvirototal >= "1") || (absorption >= "1"))) {
        if (soakenviroreroll >= "1") {
        let rollString = "&{template:soakdot1plusreroll} {{name=SoakDot1plusreroll}} {{rollsoakdot1plusreroll=[[[[floor(@{soakenvirototal})]]d6>@{setsuccesssoak}]]}}";
            rollString += "{{rollsoakdot1r1=[[@{soakenviroreroll}d6>5]]}}";
        startRoll(rollString, results => {
            const roll = results.results.rollsoakdot1plusreroll.result;
            const reroll_calculated = results.results.rollsoakdot1r1.result;
            const rerollmin = (soakenvirototal - roll <= 0) ? 0 : soakenvirototal - roll;
            const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
            const total = dot1 - roll - reroll - dotdr1;
            const absconst = ((total <= 0) || (absorption <= 0)) ? 0 : 1;
            const totalfinal = (total <= 0) ? 0 : total;
            const absorbfinal = (absorption >= 1) ? absorption : 1;
            const totalabs1 = Math.floor(totalfinal / absorbfinal) + absconst;
        finishRoll(results.rollId, {
                rollsoakdot1plusreroll: totalabs1
                });
        });
        }
        else {
        let rollString = "&{template:soakdot1} {{name=SoakDot}} {{rollsoakdot1=[[[[floor(@{soakenvirototal})]]d6>@{setsuccesssoak}]]}}";
            rollString += "{{rollsoakdot1r1=[[0]]}}";
        startRoll(rollString, results => {
            const roll = results.results.rollsoakdot1.result;
            const reroll_calculated = results.results.rollsoakdot1r1.result;
            const rerollmin = (soakenvirototal - roll <= 0) ? 0 : soakenvirototal - roll;
            const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
            const total = dot1 - roll - reroll - dotdr1;
            const absconst = ((total <= 0) || (absorption <= 0)) ? 0 : 1;
            const totalfinal = (total <= 0) ? 0 : total;
            const absorbfinal = (absorption >= 1) ? absorption : 1;
            const totalabs1 = Math.floor(totalfinal / absorbfinal) + absconst;
        finishRoll(results.rollId, {
                rollsoakdot1: totalabs1
                });
        });
        }
    }
    
    if ((dot2 >= "1") && ((soakenvirototal >= "1") || (absorption >= "1"))) {
        if (soakenviroreroll >= "1") {
        let rollString = "&{template:soakdot2plusreroll} {{name=SoakDot2plusreroll}} {{rollsoakdot2plusreroll=[[[[floor(@{soakenvirototal})]]d6>@{setsuccesssoak}]]}}";
            rollString += "{{rollsoakdot2r1=[[@{soakenviroreroll}d6>5]]}}";
        startRoll(rollString, results => {
            const roll = results.results.rollsoakdot2plusreroll.result;
            const reroll_calculated = results.results.rollsoakdot2r1.result;
            const rerollmin = (soakenvirototal - roll <= 0) ? 0 : soakenvirototal - roll;
            const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
            const total = dot2 - roll - reroll - dotdr2;
            const absconst = ((total <= 0) || (absorption <= 0)) ? 0 : 1;
            const totalfinal = (total <= 0) ? 0 : total;
            const absorbfinal = (absorption >= 1) ? absorption : 1;
            const totalabs1 = Math.floor(totalfinal / absorbfinal) + absconst;
        finishRoll(results.rollId, {
                rollsoakdot2plusreroll: totalabs1
                });
        });
        }
        else {
        let rollString = "&{template:soakdot2} {{name=SoakDot2}} {{rollsoakdot2=[[[[floor(@{soakenvirototal})]]d6>@{setsuccesssoak}]]}}";
            rollString += "{{rollsoakdot2r1=[[0]]}}";
        startRoll(rollString, results => {
            const roll = results.results.rollsoakdot2.result;
            const reroll_calculated = results.results.rollsoakdot2r1.result;
            const rerollmin = (soakenvirototal - roll <= 0) ? 0 : soakenvirototal - roll;
            const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
            const total = dot2 - roll - reroll - dotdr2;
            const absconst = ((total <= 0) || (absorption <= 0)) ? 0 : 1;
            const totalfinal = (total <= 0) ? 0 : total;
            const absorbfinal = (absorption >= 1) ? absorption : 1;
            const totalabs1 = Math.floor(totalfinal / absorbfinal) + absconst;
        finishRoll(results.rollId, {
                rollsoakdot2: totalabs1
                });
        });
        }
    }

    if ((dot3 >= "1") && ((soakenvirototal >= "1") || (absorption >= "1"))) {
        if (soakenviroreroll >= "1") {
        let rollString = "&{template:soakdot3plusreroll} {{name=SoakDot3plusreroll}} {{rollsoakdot3plusreroll=[[[[floor(@{soakenvirototal})]]d6>@{setsuccesssoak}]]}}";
            rollString += "{{rollsoakdot3r1=[[@{soakenviroreroll}d6>5]]}}";
        startRoll(rollString, results => {
            const roll = results.results.rollsoakdot3plusreroll.result;
            const reroll_calculated = results.results.rollsoakdot3r1.result;
            const rerollmin = (soakenvirototal - roll <= 0) ? 0 : soakenvirototal - roll;
            const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
            const total = dot3 - roll - reroll - dotdr3;
            const absconst = ((total <= 0) || (absorption <= 0)) ? 0 : 1;
            const totalfinal = (total <= 0) ? 0 : total;
            const absorbfinal = (absorption >= 1) ? absorption : 1;
            const totalabs1 = Math.floor(totalfinal / absorbfinal) + absconst;
        finishRoll(results.rollId, {
                rollsoakdot3plusreroll: totalabs1
                });
        });
        }
        else {
        let rollString = "&{template:soakdot3} {{name=SoakDot3}} {{rollsoakdot3=[[[[floor(@{soakenvirototal})]]d6>@{setsuccesssoak}]]}}";
            rollString += "{{rollsoakdot3r1=[[0]]}}";
        startRoll(rollString, results => {
            const roll = results.results.rollsoakdot3.result;
            const reroll_calculated = results.results.rollsoakdot3r1.result;
            const rerollmin = (soakenvirototal - roll <= 0) ? 0 : soakenvirototal - roll;
            const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
            const total = dot3 - roll - reroll - dotdr3;
            const absconst = ((total <= 0) || (absorption <= 0)) ? 0 : 1;
            const totalfinal = (total <= 0) ? 0 : total;
            const absorbfinal = (absorption >= 1) ? absorption : 1;
            const totalabs1 = Math.floor(totalfinal / absorbfinal) + absconst;
        finishRoll(results.rollId, {
                rollsoakdot3: totalabs1
                });
        });
        }
    }

    let dot1if = ((soakenvirototal >= "1") || (absorption >= "1")) ? 0 : dot1;
    let dot2if = ((soakenvirototal >= "1") || (absorption >= "1")) ? 0 : dot2;
    let dot3if = ((soakenvirototal >= "1") || (absorption >= "1")) ? 0 : dot3;
    
    let dotdr = dotdr1 + dotdr2 + dotdr3;
    let paraldebuff = (paraltier >= 1) ? 1 : 0;
    let offbalfinal = (offbal != 0) ? offbal - 1 : 0;
    let dot1final = (dot1 != 0) ? dot1 - 1 : 0;
    let dot2final = (dot2 != 0) ? dot2 - 1 : 0;
    let dot3final = (dot3 != 0) ? dot3 - 1 : 0;
    let heartmath = heart - dot1if - dot2if - dot3if + dotdr;
    let heartmath2 = heart + hearttemp - dot1if - dot2if - dot3if + dotdr;
    let heartfinal = (heartmath < 0) ? 0 : heartmath;
    let stammath = stammax - offbal - paraldebuff;
    let stamfinal = (stammath < 0) ? 0 : stammath;
    setAttrs({
        "offbal": offbalfinal
    });
    setAttrs({
        "dot1": dot1final
    });
    setAttrs({
        "dot2": dot2final
    });
    setAttrs({
        "dot3": dot3final
    });
        if(hearttemp > "0") {
            let heartfinal = (heartmath2 < 0) ? 0 : heartmath2;
            if((hearttemp - dot1if - dot2if - dot3if) <= 0) {
                setAttrs({                            
                    "hearttemp": 0
                });
                setAttrs({                            
                    "heart": heartfinal
                });
            } else {
                setAttrs({                            
                    "hearttemp": hearttemp - dot1if - dot2if - dot3if
                });
            }
        }
        else {
            let heartfinal = (heartmath < 0) ? 0 : heartmath;
            setAttrs({                            
                "heart": heartfinal
            });  
        }
    setAttrs({
        "stam": stamfinal
    });
    setAttrs({
        "speed": speedmax
    });
    setAttrs({
        "shellopp": 1
    });
  });
});

</script>

<script type="text/worker">

on("clicked:endturn", function() {  
  getAttrs(["se1","se2","se3","stamtax","paral","paraltier","stamtaxmod","bulkcheck","quickcost","flight"], function(values) {
    let se1 = parseInt(values.se1)||0;
    let se2 = parseInt(values.se2)||0;
    let se3 = parseInt(values.se3)||0;
    let bulkcheck = parseInt(values.bulkcheck)||0;
    let paral = parseInt(values.paral)||0;
    let paraltier = parseInt(values.paraltier)||0;
    let stamtax = parseInt(values.stamtax)||0;
    let stamtaxmod = parseInt(values.stamtaxmod)||0;
    let quickcost = parseInt(values.quickcost)||0;
    let elytra = parseInt(values.flight)||0;
    let se1final = (se1 != 0) ? se1 - 1 : 0;
    let se2final = (se2 != 0) ? se2 - 1 : 0;
    let se3final = (se3 != 0) ? se3 - 1 : 0;
    let parallock = (paraltier >= 3) ? 0 : 1;
    let paralfinal = (paral != 0) ? paral - parallock : 0;
    setAttrs({
        "se1": se1final
    });
    setAttrs({
        "se2": se2final
    });
    setAttrs({
        "se3": se3final
    });
    if (elytra == "1") {
        setAttrs({
            "stamtaxnebulous": stamtax
        });
        setAttrs({
            "bulkchecknebulous": bulkcheck
        });   
    }
    else {
    setAttrs({
        "stamtax": stamtaxmod + bulkcheck
    });
    setAttrs({
        "stamtaxnebulous": stamtaxmod + bulkcheck
    });
    setAttrs({
        "bulkchecknebulous": bulkcheck
    });   
    }
    setAttrs({
        "paral": paralfinal
    });
    setAttrs({
        "quickcost": 0
    });
  });
});

</script>

<script type="text/worker">

on('change:offbal sheet:opened', () => {
    getAttrs(['offbal'], function(values) {
        let offbal = parseInt(values.offbal)||0;
        if(offbal > 3) {
        setAttrs({
            "offbal": 3
        });         
        }
    });
});

on("sheet:opened change:bulk1 change:bulk2 change:bulk3 change:bulk4 change:bulk5 change:bulka change:eqmnt1load change:eqmnt2load change:eqmnt3load change:eqmnt4load change:eqmnt5load change:eqmnt6load change:eqmnt7load change:eqmnt8load change:eqmnt9load change:eqmnt10load change:naturalsaddle", function() {  
  getAttrs(["bulk1","bulk2","bulk3","bulk4","bulk5","bulka","eqmnt1load","eqmnt2load","eqmnt3load","eqmnt4load","eqmnt5load","eqmnt6load","eqmnt7load","eqmnt8load","eqmnt9load","eqmnt10load","naturalsaddle"], function(values) {
    let bulk1 = parseInt(values.bulk1)||0;
    let bulk2 = parseInt(values.bulk2)||0;
    let bulk3 = parseInt(values.bulk3)||0;
    let bulk4 = parseInt(values.bulk4)||0;
    let bulk5 = parseInt(values.bulk5)||0;
    let bulka = parseInt(values.bulka)||0;
    let eqmnt1load = parseInt(values.eqmnt1load)||0;
    let eqmnt2load = parseInt(values.eqmnt2load)||0;
    let eqmnt3load = parseInt(values.eqmnt3load)||0;
    let eqmnt4load = parseInt(values.eqmnt4load)||0;
    let eqmnt5load = parseInt(values.eqmnt5load)||0;
    let eqmnt6load = parseInt(values.eqmnt6load)||0;
    let eqmnt7load = parseInt(values.eqmnt7load)||0;
    let eqmnt8load = parseInt(values.eqmnt8load)||0;
    let eqmnt9load = parseInt(values.eqmnt9load)||0;
    let eqmnt10load = parseInt(values.eqmnt10load)||0;
    let naturalsaddle = parseInt(values.naturalsaddle)||0;
    setAttrs({
        "bulktotal": bulk1 + bulk2 + bulk3 + bulk4 + bulk5 + bulka + eqmnt1load + eqmnt2load + eqmnt3load + eqmnt4load + eqmnt5load + eqmnt6load + eqmnt7load + eqmnt8load + eqmnt9load + eqmnt10load + naturalsaddle
    });
  });
});

on('change:bulktotal change:load sheet:opened', () => {
    getAttrs(['bulktotal','load'], function(values) {
        let bulktotal = parseInt(values.bulktotal)||0;
        let load = parseInt(values.load)||0;
        let loadtotal = load;
        let bulkmax = loadtotal * 2;
        const output = {};
        output.bulkcheck = (bulktotal > load) ? 1 : 0;
        setAttrs(output);
        if(bulktotal > bulkmax) {
        let rollString = "&{template:errorload} {{name=Error}} {{rollerrorload=[[0]]}}";
        startRoll(rollString, results => {
            finishRoll(results.rollId, {
                });
        });
        }
    });
});

on('change:charmnotchmax change:charm1notch change:charm2notch change:charm3notch change:charm4notch change:charm5notch change:charm6notch change:charm7notch change:charm8notch sheet:opened', () => {
    getAttrs(['charmnotchmax','charm1notch','charm2notch','charm3notch','charm4notch','charm5notch','charm6notch','charm7notch','charm8notch'], function(values) {
        let charmnotchmax = parseInt(values.charmnotchmax)||0;
        let charm1notch = parseInt(values.charm1notch)||0;
        let charm2notch = parseInt(values.charm2notch)||0;
        let charm3notch = parseInt(values.charm3notch)||0;
        let charm4notch = parseInt(values.charm4notch)||0;
        let charm5notch = parseInt(values.charm5notch)||0;
        let charm6notch = parseInt(values.charm6notch)||0;
        let charm7notch = parseInt(values.charm7notch)||0;
        let charm8notch = parseInt(values.charm8notch)||0;
        let charmnotchtotal = charm1notch + charm2notch + charm3notch + charm4notch + charm5notch + charm6notch + charm7notch + charm8notch;
        
        if(charmnotchmax < charmnotchtotal) {
        let rollString = "&{template:overcharmed} {{name=Overcharmed}} {{rollerrorcharm=[[0]]}}";
        startRoll(rollString, results => {
            finishRoll(results.rollId, {
                });
        });
        }
    });
});

on('change:paral sheet:opened', () => {
    getAttrs(['paral'], function(values) {
        let paral = parseInt(values.paral)||0;
        if(paral == "0") {
        setAttrs({
            "paraltier": 0
        });
        }
        if(paral < "5" && paral >= "1") {
        setAttrs({
            "paraltier": 1
        });
        }
        if(paral < "10" && paral >= "5") {
        setAttrs({
            "paraltier": 2
        });
        }
        if(paral < "15" && paral >= "10") {
        setAttrs({
            "paraltier": 4
        });
        }
        if(paral < "20" && paral >= "15") {
        setAttrs({
            "paraltier": 5
        });
        setAttrs({
            "speed": 0
        });
        }
        if(paral >= "20") {
        setAttrs({
            "paraltier": 6
        });
        setAttrs({
            "heart": 0
        });
        }
    });
});

on('change:bulkcheck sheet:opened', () => {
    getAttrs(['bulkcheck','stamtaxnebulous','bulkchecknebulous'], function(values) {
        let bulkcheck = parseInt(values.bulkcheck)||0;
        let stamtaxnebulous = parseInt(values.stamtaxnebulous)||0;
        let bulkchecknebulous = parseInt(values.bulkchecknebulous)||0;
        let stamtaxmath = stamtaxnebulous + bulkcheck;
        if (bulkchecknebulous == "1") {
            setAttrs({
                "stamtax": stamtaxmath - 1
            });
        }
        else {
            setAttrs({
                "stamtax": stamtaxmath
            });
        }
    });
});

</script>

<script type="text/worker">

on('change:soaktotal change:shell change:shellmod change:soakmagicradio change:soakenviroradio change:resistradio sheet:opened', () => {
    getAttrs(['soaktotal','shell','shellmod','soakmagicradio','soakenviroradio','resistradio'], function(values) {
        let soaktotal = parseInt(values.soaktotal)||0;
        let shell = parseFloat(values.shell)||0;
        let shellmod = parseFloat(values.shellmod)||0;
        let soakmagicradio = parseInt(values.soakmagicradio)||0;
        let soakenviroradio = parseInt(values.soakenviroradio)||0;
        let resistradio = parseInt(values.resistradio)||0;
        let rerollcheck = (shell + shellmod) - Math.floor(shell + shellmod);
        if(resistradio == "0") {
                setAttrs({
                    "soaktotaltotal": soaktotal + rerollcheck
                });
        }
        if(resistradio == "1") {
            if(soakmagicradio == "1") {
                setAttrs({
                    "soaktotaltotal": soaktotal + rerollcheck
                });
            }
            else {
                setAttrs({
                    "soaktotaltotal": soaktotal
                });
            }
        }
        if(resistradio == "2") {
            if(soakenviroradio == "1") {
                setAttrs({
                    "soaktotaltotal": soaktotal + rerollcheck
                });
            }
            else {
                setAttrs({
                    "soaktotaltotal": soaktotal
                });
            }
        }
    });
});

on('change:stam change:stamtemp change:soul change:soultemp change:heart change:hearttemp sheet:opened', () => {
    getAttrs(['stam','stamtemp','soul','soultemp','heart','hearttemp'], function(values) {
        let stam = parseInt(values.stam)||0;
        let stamtemp = parseInt(values.stamtemp)||0;
        let soul = parseInt(values.soul)||0;
        let soultemp = parseInt(values.soultemp)||0;
        let heart = parseInt(values.heart)||0;
        let hearttemp = parseInt(values.hearttemp)||0;
        setAttrs({
            "token_heart": heart + hearttemp
        });
        setAttrs({
            "token_stam": stam + stamtemp
        });
        setAttrs({
            "token_soul": soul + soultemp
        });
    });
});


on('change:spellradio change:dmgheal1 change:dmgheal2 change:dmgheal3 change:dmgheal4 change:dmgheal5 change:diff1 change:diff2 change:diff3 change:diff4 change:diff5 change:splrng1 change:splrng2 change:splrng3 change:splrng4 change:splrng5 change:spldura1 change:spldura2 change:spldura3 change:spldura4 change:spldura5 change:splpath1 change:splpath2 change:splpath3 change:splpath4 change:splpath5 sheet:opened', () => {
    getAttrs(['spellradio','dmgheal1','dmgheal2','dmgheal3','dmgheal4','dmgheal5','diff1','diff2','diff3','diff4','diff5','splrng1','splrng2','splrng3','splrng4','splrng5','spldura1','spldura2','spldura3','spldura4','spldura5','splpath1','splpath2','splpath3','splpath4','splpath5'], function(values) {
        let spellradio = parseInt(values.spellradio)||0;
        let dmgheal1 = parseInt(values.dmgheal1)||0;
        let dmgheal2 = parseInt(values.dmgheal2)||0;
        let dmgheal3 = parseInt(values.dmgheal3)||0;
        let dmgheal4 = parseInt(values.dmgheal4)||0;
        let dmgheal5 = parseInt(values.dmgheal5)||0;
        let diff1 = parseInt(values.diff1)||0;
        let diff2 = parseInt(values.diff2)||0;
        let diff3 = parseInt(values.diff3)||0;
        let diff4 = parseInt(values.diff4)||0;
        let diff5 = parseInt(values.diff5)||0;
        let splrng1 = parseInt(values.splrng1)||0;
        let splrng2 = parseInt(values.splrng2)||0;
        let splrng3 = parseInt(values.splrng3)||0;
        let splrng4 = parseInt(values.splrng4)||0;
        let splrng5 = parseInt(values.splrng5)||0;
        let spldura1 = parseInt(values.spldura1)||0;
        let spldura2 = parseInt(values.spldura2)||0;
        let spldura3 = parseInt(values.spldura3)||0;
        let spldura4 = parseInt(values.spldura4)||0;
        let spldura5 = parseInt(values.spldura5)||0;
        let splpath1 = parseInt(values.splpath1)||0;
        let splpath2 = parseInt(values.splpath2)||0;
        let splpath3 = parseInt(values.splpath3)||0;
        let splpath4 = parseInt(values.splpath4)||0;
        let splpath5 = parseInt(values.splpath5)||0;

        if (spellradio == "1") {
            setAttrs({
                "dmgheal": dmgheal1
            });
            setAttrs({
                "diff": diff1
            });
            setAttrs({
                "splrng": splrng1
            });
            setAttrs({
                "spldura": spldura1
            });
            setAttrs({
                "splpath": splpath1
            });
        }

        if (spellradio == "2") {
            setAttrs({
                "dmgheal": dmgheal2
            });
            setAttrs({
                "diff": diff2
            });
            setAttrs({
                "splrng": splrng2
            });
            setAttrs({
                "spldura": spldura2
            });
            setAttrs({
                "splpath": splpath2
            });
        }

        if (spellradio == "3") {
            setAttrs({
                "dmgheal": dmgheal3
            });
            setAttrs({
                "diff": diff3
            });
            setAttrs({
                "splrng": splrng3
            });
            setAttrs({
                "spldura": spldura3
            });
            setAttrs({
                "splpath": splpath3
            });
        }

        if (spellradio == "4") {
            setAttrs({
                "dmgheal": dmgheal4
            });
            setAttrs({
                "diff": diff4
            });
            setAttrs({
                "splrng": splrng4
            });
            setAttrs({
                "spldura": spldura4
            });
            setAttrs({
                "splpath": splpath5
            });
        }

        if (spellradio == "5") {
            setAttrs({
                "dmgheal": dmgheal5
            });
            setAttrs({
                "diff": diff5
            });
            setAttrs({
                "splrng": splrng5
            });
            setAttrs({
                "spldura": spldura5
            });
            setAttrs({
                "splpath": splpath5
            });
        }
    });
});

</script>

<script type="text/worker">

on('change:quickcost change:diff change:spellsplit change:spellexpand change:spellconjur change:dmghealplus change:splrngfinal change:spldurafinal change:splpath sheet:opened', () => {
    getAttrs(['quickcost','diff','spellsplit','spellexpand','spellconjur','dmghealplus','splrngfinal','spldurafinal','splpath'], function(values) {
        let quickcost = parseInt(values.quickcost)||0;
        let diff = parseInt(values.diff)||0;
        let dmghealplus = parseInt(values.dmghealplus)||0;
        let spellsplit = parseInt(values.spellsplit)||0;
        let spellexpand = parseInt(values.spellexpand)||0;
        let spellconjur = parseInt(values.spellconjur)||0;
        let splrngfinal = parseInt(values.splrngfinal)||0;
        let spldurafinal = parseInt(values.spldurafinal)||0;
        let splpath = parseInt(values.splpath)||0;
        let splitfactor = 1 + spellsplit;
        let expandfactor = 1 + spellexpand;
        let spellfinalcost = (diff + quickcost + spellconjur + dmghealplus + splrngfinal + spldurafinal) * splitfactor * expandfactor
        setAttrs({
            "spellfinalcost": spellfinalcost
        });
    });
});

</script>

<script type="text/worker">

on('change:splrng change:extrarng change:spldura change:extradura sheet:opened', () => {
    getAttrs(['splrng','extrarng','spldura','extradura'], function(values) {
        let splrng = parseInt(values.splrng)||0;
        let extrarng = parseInt(values.extrarng)||0;
        let spldura = parseInt(values.spldura)||0;
        let extradura = parseInt(values.extradura)||0;

        if ((extrarng > splrng) && (extrarng >= "2") && ((2 - splrng) > "0")) {
        setAttrs({
            "vartouch": 1
        });
        }
        else {
        setAttrs({
            "vartouch": 0
        });
        }
        if ((extrarng > splrng) && (extrarng >= "3") && ((3 - splrng) > "0")) {
        setAttrs({
            "varclose": 1
        });
        }
        else {
        setAttrs({
            "varclose": 0
        });
        }
        if ((extrarng > splrng) && (extrarng >= "4") && ((4 - splrng) > "0")) {
        setAttrs({
            "varfar": 1
        });
        }
        else {
        setAttrs({
            "varfar": 0
        });
        }
        if ((extrarng > splrng) && (extrarng >= "5") && ((5 - splrng) > "0")) {
        setAttrs({
            "varsense": 2
        });
        }
        else {
        setAttrs({
            "varsense": 0
        });
        }
        
        
        if ((extradura > spldura) && (extradura >= "2") && ((2 - spldura) > "0")) {
        setAttrs({
            "varbrief": 1
        });
        }
        else {
        setAttrs({
            "varbrief": 0
        });
        }
        if ((extradura > spldura) && (extradura >= "3") && ((3 - spldura) > "0")) {
        setAttrs({
            "varscene": 2
        });
        }
        else {
        setAttrs({
            "varscene": 0
        });
        }
        if ((extradura > spldura) && (extradura >= "4") && ((4 - spldura) > "0")) {
        setAttrs({
            "varscenes": 2
        });
        }
        else {
        setAttrs({
            "varscenes": 0
        });
        }
        if ((extradura > spldura) && (extradura >= "5") && ((5 - spldura) > "0")) {
        setAttrs({
            "varrests": 2
        });
        }
        else {
        setAttrs({
            "varrests": 0
        });
        }
        if ((extradura > spldura) && (extradura >= "6") && ((6 - spldura) > "0")) {
        setAttrs({
            "varlifetime": 2
        });
        }
        else {
        setAttrs({
            "varlifetime": 0
        });
        }
        if ((extradura > spldura) && (extradura >= "7") && ((7 - spldura) > "0")) {
        setAttrs({
            "vareternal": 2
        });
        }
        else {
        setAttrs({
            "vareternal": 0
        });
        }
        
    });
});

on('change:splrng change:extrarng change:spldura change:extradura change:insighttotalfloat sheet:opened', () => {
    getAttrs(['splrng','extrarng','spldura','extradura','insighttotalfloat'], function(values) {
        let splrng = parseInt(values.splrng)||0;
        let extrarng = parseInt(values.extrarng)||0;
        let spldura = parseInt(values.spldura)||0;
        let extradura = parseInt(values.extradura)||0;
        let insight = parseInt(values.insighttotalfloat)||0;
        let closerange = Math.ceil(insight / 2) + 1;
        let farrange = insight + 3;
        
        if (extrarng == "0") {
        setAttrs({
            "spellfinalrange": "n/a"
        });
}

        if (extrarng == "1") {
        setAttrs({
            "spellfinalrange": "S"
        });
}

        if (extrarng == "2") {
        setAttrs({
            "spellfinalrange": "T"
        });
}

        if (extrarng == "3") {
        setAttrs({
            "spellfinalrange": closerange
        });
}

        if (extrarng == "4") {
        setAttrs({
            "spellfinalrange": farrange
        });
}

        if (extrarng == "5") {
        setAttrs({
            "spellfinalrange": "X"
        });
}

        if (extradura == "0") {
        setAttrs({
            "spellfinaldura": "n/a"
        });
}

        if (extradura == "1") {
        setAttrs({
            "spellfinaldura": "C"
        });
}

        if (extradura == "2") {
        setAttrs({
            "spellfinaldura": insight
        });
}

        if (extradura == "3") {
        setAttrs({
            "spellfinaldura": 1
        });
}

        if (extradura == "4") {
        setAttrs({
            "spellfinaldura": insight
        });
}

        if (extradura == "5") {
        setAttrs({
            "spellfinaldura": insight
        });
}

        if (extradura == "6") {
        setAttrs({
            "spellfinaldura": "L"
        });
}

        if (extradura == "7") {
        setAttrs({
            "spellfinaldura": "D"
        });
}
        
    });
});

on('change:vartouch change:varclose change:varfar change:varsense change:varbrief change:varscene change:varscenes change:varrests change:varlifetime change:vareternal sheet:opened', () => {
    getAttrs(['vartouch','varclose','varfar','varsense','varbrief','varscene','varscenes','varrests','varlifetime','vareternal'], function(values) {

        let touch = parseInt(values.vartouch)||0;
        let close = parseInt(values.varclose)||0;
        let far = parseInt(values.varfar)||0;
        let sense = parseInt(values.varsense)||0;
        let brief = parseInt(values.varbrief)||0;
        let scene = parseInt(values.varscene)||0;
        let scenes = parseInt(values.varscenes)||0;
        let rests = parseInt(values.varrests)||0;
        let lifetime = parseInt(values.varlifetime)||0;
        let eternal = parseInt(values.vareternal)||0;
        let splrngfinal = touch + close + far + sense;
        let spldurafinal = brief + scene + scenes + rests + lifetime + eternal;
        
        setAttrs({
            "splrngfinal": splrngfinal
        });
        setAttrs({
            "spldurafinal": spldurafinal
        });
    });
});


on("change:mighttotalfloat change:gracetotalfloat change:insighttotalfloat change:splmeleeradio change:splrangedradio change:extrarng change:spellatt sheet:opened", function() {  
  getAttrs(["mighttotalfloat","splmeleeradio","splrangedradio","gracetotalfloat","insighttotalfloat","extrarng","spellatt"], function(values) {
    let mighttotalfloat = parseFloat(values.mighttotalfloat)||0;
    let gracetotalfloat = parseFloat(values.gracetotalfloat)||0;
    let insighttotalfloat = parseFloat(values.insighttotalfloat)||0;
    let splmeleeradio = parseInt(values.splmeleeradio)||0;
    let splrangedradio = parseInt(values.splrangedradio)||0;
    let extrarng = parseInt(values.extrarng)||0;
    let spellatt = parseInt(values.spellatt)||0;
    
    let mightrerollcheck = mighttotalfloat - Math.floor(mighttotalfloat)
    let gracererollcheck = gracetotalfloat - Math.floor(gracetotalfloat)
    let insightrerollcheck = insighttotalfloat - Math.floor(insighttotalfloat)
    
    if (extrarng <= "2") {
    if (splmeleeradio == "1") {
        setAttrs({                            
            "splatt": insighttotalfloat
        });
        setAttrs({                            
            "splattreroll": insightrerollcheck * 2
        });
    }
    if (splmeleeradio == "2") {
        setAttrs({                            
            "splatt": mighttotalfloat
        });
        setAttrs({                            
            "splattreroll": mightrerollcheck * 2
        });
    }
  }
  if (extrarng > "2") {
    if (splrangedradio == "1") {
        setAttrs({                            
            "splatt": insighttotalfloat
        });
        setAttrs({                            
            "splattreroll": insightrerollcheck * 2
        });
    }
    if (splrangedradio == "2") {
        setAttrs({                            
            "splatt": gracetotalfloat
        });
        setAttrs({                            
            "splattreroll": gracererollcheck * 2
        });
    }
    }

if (spellatt == "1") {
        setAttrs({                            
            "splsavebbb": insighttotalfloat
        });
        setAttrs({                            
            "splsavererollbbb": insightrerollcheck * 2
        });
        setAttrs({                            
            "defspellsavetotalbbb": insighttotalfloat
        });
        setAttrs({                            
            "defspellsavererollbbb": insightrerollcheck * 2
        });
}

if (spellatt == "2") {
        setAttrs({                            
            "splsavebbb": mighttotalfloat
        });
        setAttrs({                            
            "splsavererollbbb": mightrerollcheck * 2
        });
        setAttrs({                            
            "defspellsavetotalbbb": mighttotalfloat
        });
        setAttrs({                            
            "defspellsavererollbbb": mightrerollcheck * 2
        });
}

if (spellatt == "3") {
        setAttrs({                            
            "splsavebbb": gracetotalfloat
        });
        setAttrs({                            
            "splsavererollbbb": gracererollcheck * 2
        });
        setAttrs({                            
            "defspellsavetotalbbb": gracetotalfloat
        });
        setAttrs({                            
            "defspellsavererollbbb": gracererollcheck * 2
        });
}



  });
});

on('change:spelltype change:spellcover change:spellgrapple change:spellsqueeze change:spellunseen change:splattackbuff change:splatt change:splattreroll change:splattackbuffreroll change:mystictotal change:splsavererollbbb change:splsavebbb change:splsaveoffbuff change:splsaveoffbuffreroll change:splsavedefbuff change:splsavedefbuffreroll change:defspellsavetotalbbb change:defspellsavererollbbb change:unirerollmodneb sheet:opened', () => {
    getAttrs(['spelltype','spellcover','spellgrapple','spellsqueeze','spellunseen','splattackbuff','splatt','splattreroll','splattackbuffreroll','mystictotal','splsavererollbbb','splsavebbb','splsaveoffbuff','splsaveoffbuffreroll','splsavedefbuff','splsavedefbuffreroll','defspellsavetotalbbb','defspellsavererollbbb','unirerollmodneb'], function(values) {
        let spelltype = parseInt(values.spelltype)||0;
        let spellcover = parseFloat(values.spellcover)||0;
        let spellgrapple = parseInt(values.spellgrapple)||0;
        let spellsqueeze = parseInt(values.spellsqueeze)||0;
        let spellunseen = parseInt(values.spellunseen)||0;
        let splattackbuff = parseInt(values.splattackbuff)||0;
        let splattreroll = parseInt(values.splattreroll)||0;
        let mystictotal = parseInt(values.mystictotal)||0;
        let splsavererollbbb = parseInt(values.splsavererollbbb)||0;
        let splsavebbb = parseInt(values.splsavebbb)||0;
        let splsaveoffbuff = parseInt(values.splsaveoffbuff)||0;
        let splsaveoffbuffreroll = parseInt(values.splsaveoffbuffreroll)||0;
        let splsavedefbuff = parseInt(values.splsavedefbuff)||0;
        let splsavedefbuffreroll = parseInt(values.splsavedefbuffreroll)||0;
        let defspellsavetotalbbb = parseInt(values.defspellsavetotalbbb)||0;
        let defspellsavererollbbb = parseInt(values.defspellsavererollbbb)||0;
        let splattackbuffreroll = parseInt(values.splattackbuffreroll)||0;
        let unirerollmodneb = parseInt(values.unirerollmodneb)||0;
        let attackmods = (spellcover * 4) + spellgrapple + spellsqueeze + (spellunseen * 2);
        let splatt = parseInt(values.splatt)||0;
        if (spelltype == "2") { 
        setAttrs({
            "spellfinalattack": splattackbuff + splatt + mystictotal + (splattreroll * 0.5) - attackmods
        });
        setAttrs({
            "spellfinalattackreroll": splattreroll + splattackbuffreroll + unirerollmodneb
        });  
        }
        else {
        setAttrs({
            "spellfinalattack": 0
        });
        setAttrs({
            "spellfinalattackreroll": 0
        });  
        }
        setAttrs({
            "splsave": splsavebbb + splsaveoffbuff
        });  
        setAttrs({
            "splsavereroll": splsavererollbbb + splsaveoffbuffreroll + unirerollmodneb
        });
        setAttrs({
            "defspellsavetotal": defspellsavetotalbbb + splsavedefbuff
        });
        setAttrs({
            "defspellsavereroll": defspellsavererollbbb + splsavedefbuffreroll + unirerollmodneb
        });

    });
});

on('change:dmgheal change:dmghealplus change:dmghealbuff sheet:opened', () => {
    getAttrs(['dmgheal','dmghealplus','dmghealbuff'], function(values) {
        let dmgheal = parseInt(values.dmgheal)||0;
        let dmghealplus = parseInt(values.dmghealplus)||0;
        let dmghealbuff = parseInt(values.dmghealbuff)||0;
        setAttrs({
            "spellfinaldmgheal": dmgheal + dmghealplus + dmghealbuff
        });
    });
});

    on('clicked:cast', (info) => {
          getAttrs(["spellfinalattack","spellfinalattackreroll","stam","stamtemp","soul","soultemp","bulkcheck","setsuccessattack","quickcost","spellfinalcost","spellfinaldmgheal","quickcheck","spelltype","maxdiff","splsave","splsavereroll","unilock","unirerolllock"], function(values) {
        let stam = parseInt(values.stam)||0;
        let stamtemp = parseInt(values.stamtemp)||0;
        let soul = parseInt(values.soul)||0;
        let soultemp = parseInt(values.soultemp)||0;
        let bulkcheck = parseInt(values.bulkcheck)||0;
        let quickcost = parseInt(values.quickcost)||0;
        let quickcheck = parseInt(values.quickcheck)||0;
        let unilock = parseInt(values.unilock)||0;
        let unirerolllock = parseInt(values.unirerolllock)||0;
        let spellfinalcost = parseInt(values.spellfinalcost)||0;
        let spellfinaldmgheal = parseInt(values.spellfinaldmgheal)||0;
        let spelltype = parseInt(values.spelltype)||0;
        let maxdiff = parseInt(values.maxdiff)||0;
        let splsave = parseInt(values.splsave)||0;
        let splsavereroll = parseInt(values.splsavereroll)||0;
        
        let bulkcheckfin = (quickcost >= "1") ? bulkcheck : 0;
        let quickcostfin = ((quickcost >= "1") && (quickcheck == "1")) ? 1 : 0;
        let stamtotal = stam + stamtemp;
        let spentstam = quickcostfin + bulkcheckfin;
        let soultotal = soul + soultemp;
        let spentsoul = spellfinalcost;
        
        if((spentstam <= stamtotal) && (spentsoul <= soultotal) && (quickcost < "4") && (spellfinalcost <= maxdiff)) {
            if((values.spellfinalattackreroll >= "1") && (spelltype == "2")) {
            let rollString = "&{template:magicattackplusreroll} {{name=MagicAttack}} {{rollmagicattackplusreroll=[[[[floor(@{spellfinalattack})]]d6>@{setsuccessattack}]]}}";
                rollString += "{{rollspellfinalattackrerollr1=[[@{spellfinalattackreroll}d6>@{setsuccessattack}]]}}";
                rollString += "{{rollmagicdamage=[[@{spellfinaldmgheal}]]}}";
            startRoll(rollString, results => {
            const magicattacktotal = parseInt(values.spellfinalattack)||0;
            const roll = results.results.rollmagicattackplusreroll.result;
            const reroll_calculated = results.results.rollspellfinalattackrerollr1.result;
            const rerollmin = (magicattacktotal - roll <= 0) ? 0 : magicattacktotal - roll;
            const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
            const total = roll + reroll;
            finishRoll(results.rollId, {
                rollmagicattackplusreroll: total
                });
        });
            }
            if ((values.spellfinalattackreroll == "0") && (spelltype == "2")) {
            let rollString = "&{template:magicattack} {{name=MagicAttack}} {{rollmagicattack=[[[[floor(@{spellfinalattack})]]d6>@{setsuccessattack}]]}}";
                rollString += "{{rollspellfinalattackrerollr11=[[0]]}}";
                rollString += "{{rollmagicdamage=[[@{spellfinaldmgheal}]]}}";
            startRoll(rollString, results => {
            const magicattacktotal = parseInt(values.spellfinalattack)||0;
            const roll = results.results.rollmagicattack.result;
            const reroll_calculated = results.results.rollspellfinalattackrerollr11.result;
            const rerollmin = (magicattacktotal - roll <= 0) ? 0 : magicattacktotal - roll;
            const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
            const total = roll + reroll;
            finishRoll(results.rollId, {
                rollmagicattack: total
                });
        }); 
            }
            if (spelltype == "1") {
            let rollString = "&{template:magic} {{name=MagicAttack}} {{rollmagicdmgheal=[[@{spellfinaldmgheal}]]}}";
            startRoll(rollString, results => {
            finishRoll(results.rollId, {
                });
        }); 
            }
            if ((splsavereroll >= "1") && (spelltype == "3")) {
            let rollString = "&{template:magicsaveplusreroll} {{name=MagicSave}} {{rollmagicsaveplusreroll=[[[[floor(@{splsave})]]d6>5]]}}";
                rollString += "{{rollmagicsavererollr1=[[@{splsavereroll}d6>@{setsuccessattack}]]}}";
                rollString += "{{rollmagicdamage=[[@{spellfinaldmgheal}]]}}";
            startRoll(rollString, results => {
            const magicattacktotal = parseInt(values.splsave)||0;
            const roll = results.results.rollmagicsaveplusreroll.result;
            const reroll_calculated = results.results.rollmagicsavererollr1.result;
            const rerollmin = (magicattacktotal - roll <= 0) ? 0 : magicattacktotal - roll;
            const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
            const total = roll + reroll;
            finishRoll(results.rollId, {
                rollmagicsaveplusreroll: total
                });
            }); 
            }
            if ((splsavereroll == "0") && (spelltype == "3")) { 
            let rollString = "&{template:magicsave} {{name=MagicSave}} {{rollmagicsave=[[[[floor(@{splsave})]]d6>5]]}}";
                rollString += "{{rollmagicsavererollr11=[[0]]}}";
                rollString += "{{rollmagicdamage=[[@{spellfinaldmgheal}]]}}";
            startRoll(rollString, results => {
            const magicattacktotal = parseInt(values.splsave)||0;
            const roll = results.results.rollmagicsave.result;
            const reroll_calculated = results.results.rollmagicsavererollr11.result;
            const rerollmin = (magicattacktotal - roll <= 0) ? 0 : magicattacktotal - roll;
            const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
            const total = roll + reroll;
            finishRoll(results.rollId, {
                rollmagicsave: total
                });
            }); 
            }

        if((stamtemp > "0") && (spentstam > stam)){
            let stammath = spentstam - stam;
            setAttrs({                            
                "stam": 0
            });
            setAttrs({
                "stamtemp": stamtemp - stammath
            });    
        }
        else {
            setAttrs({                            
                "stam": stam - spentstam
            });  
        }
        if((soultemp > "0") && (spentsoul > soul)){
            let soulmath = spentsoul - soul;
            setAttrs({                            
                "soul": 0
            });
            setAttrs({
                "soultemp": soultemp - soulmath
            });    
        }
        else {
            setAttrs({                            
                "soul": soul - spentsoul
            });  
        }

            setAttrs({                            
                "dmghealplus": 0
            });
            setAttrs({                            
                "spellsplit": 0
            });
            setAttrs({                            
                "spellexpand": 0
            });
            setAttrs({                            
                "spellconjur": 0
            });
            setAttrs({                            
                "spellunseen": 0
            });
            setAttrs({                            
                "quickcost": quickcost + 1
            });
    if (unilock == 0) {
    setAttrs({
        "unimod": 0
    });
    }
    if (unirerolllock == 0) {
    setAttrs({
        "unirerollmod": 0
    });
    }
        }
        else {
            if ((spentsoul > soultotal)) {
        let rollString = "&{template:errormagic} {{name=Error}} {{rollerror=[[0]]}}";
        startRoll(rollString, results => {
            finishRoll(results.rollId, {
                });
            });
            }
            if ((spentstam > stamtotal)) {
        let rollString = "&{template:error} {{name=Error}} {{rollerror=[[0]]}}";
        startRoll(rollString, results => {
            finishRoll(results.rollId, {
                });
            });
            }
            if ((quickcost >= "4")) {
        let rollString = "&{template:errorquick} {{name=Error}} {{rollerror=[[0]]}}";
        startRoll(rollString, results => {
            finishRoll(results.rollId, {
                });
            });
            }
            if (spellfinalcost > maxdiff) {
        let rollString = "&{template:errordiffmax} {{name=Error}} {{rollerror=[[0]]}}";
        startRoll(rollString, results => {
            finishRoll(results.rollId, {
                });
            });
            }
        }
    });
});


on('change:path1 change:path1 change:path1 change:path4 change:path5 change;path6 change:pathbox1 change:pathbox2 change:pathbox3 change:pathbox4 change:pathbox5 change:pathbox6 change:arbpath1 change:arbpathbox1 change:arbpath2 change:arbpathbox2 change:arbpath3 change:arbpathbox3 change:arbpath4 change:arbpathbox4 change:arbpath5 change:arbpathbox5 change:arbpath6 change:arbpathbox6 sheet:opened', () => {
    getAttrs(['path1','path2','path3','path4','path5','path6','pathbox1','pathbox2','pathbox3','pathbox4','pathbox5','pathbox6','arbpath1','arbpathbox1','arbpath2','arbpathbox2','arbpath3','arbpathbox3','arbpath4','arbpathbox4','arbpath5','arbpathbox5','arbpath6','arbpathbox6'], function(values) {
        let path1 = parseInt(values.path1)||0;
        let path2 = parseInt(values.path2)||0;
        let path3 = parseInt(values.path3)||0;
        let path4 = parseInt(values.path4)||0;
        let path5 = parseInt(values.path5)||0;
        let path6 = parseInt(values.path6)||0;
        let pathbox1 = parseInt(values.pathbox1)||0;
        let pathbox2 = parseInt(values.pathbox2)||0;
        let pathbox3 = parseInt(values.pathbox3)||0;
        let pathbox4 = parseInt(values.pathbox4)||0;
        let pathbox5 = parseInt(values.pathbox5)||0;
        let pathbox6 = parseInt(values.pathbox6)||0;
        let arbpath1 = parseInt(values.arbpath1)||0;
        let arbpathbox1 = parseInt(values.arbpathbox1)||0;
        let arbpath2 = parseInt(values.arbpath2)||0;
        let arbpathbox2 = parseInt(values.arbpathbox2)||0;
        let arbpath3 = parseInt(values.arbpath3)||0;
        let arbpathbox3 = parseInt(values.arbpathbox3)||0;
        let arbpath4 = parseInt(values.arbpath4)||0;
        let arbpathbox4 = parseInt(values.arbpathbox4)||0;
        let arbpath5 = parseInt(values.arbpath5)||0;
        let arbpathbox5 = parseInt(values.arbpathbox5)||0;
        let arbpath6 = parseInt(values.arbpath6)||0;
        let arbpathbox6 = parseInt(values.arbpathbox6)||0;


        if (arbpath1 != path1) {
            if (arbpath1 == "9") {
                setAttrs({
                    "numspire": 0
            });
            }
            if (arbpath1 == "10") {
                setAttrs({
                    "numcloak": 0
            });
            }
            if (arbpath1 == "11") {
                setAttrs({
                    "numdream": 0
            });
            }
            if (arbpath1 == "12") {
                setAttrs({
                    "numnightmare": 0
            });
            }
            if (arbpath1 == "13") {
                setAttrs({
                    "numbloom": 0
            });
            }
            if (arbpath1 == "14") {
                setAttrs({
                    "numthorn": 0
            });
            }
            if (arbpath1 == "15") {
                setAttrs({
                    "numdust": 0
            });
            }
            if (arbpath1 == "1") {
                setAttrs({
                    "numnail": 0
            });
            }
            if (arbpath1 == "2") {
                setAttrs({
                    "numneedle": 0
            });
            }
            if (arbpath1 == "3") {
                setAttrs({
                    "numtusk": 0
            });
            }
            if (arbpath1 == "4") {
                setAttrs({
                    "numhook": 0
            });
            }
            if (arbpath1 == "5") {
                setAttrs({
                    "nummaw": 0
            });
            }
            if (arbpath1 == "6") {
                setAttrs({
                    "numshell": 0
            });
            }
            if (arbpath1 == "7") {
                setAttrs({
                    "numsling": 0
            });
            }
            if (arbpath1 == "8") {
                setAttrs({
                    "numflask": 0
            });
            }
        }


        if (arbpath2 != path2) {
            if (arbpath2 == "9") {
                setAttrs({
                    "numspire": 0
            });
            }
            if (arbpath2 == "10") {
                setAttrs({
                    "numcloak": 0
            });
            }
            if (arbpath2 == "11") {
                setAttrs({
                    "numdream": 0
            });
            }
            if (arbpath2 == "12") {
                setAttrs({
                    "numnightmare": 0
            });
            }
            if (arbpath2 == "13") {
                setAttrs({
                    "numbloom": 0
            });
            }
            if (arbpath2 == "14") {
                setAttrs({
                    "numthorn": 0
            });
            }
            if (arbpath2 == "15") {
                setAttrs({
                    "numdust": 0
            });
            }
            if (arbpath2 == "1") {
                setAttrs({
                    "numnail": 0
            });
            }
            if (arbpath2 == "2") {
                setAttrs({
                    "numneedle": 0
            });
            }
            if (arbpath2 == "3") {
                setAttrs({
                    "numtusk": 0
            });
            }
            if (arbpath2 == "4") {
                setAttrs({
                    "numhook": 0
            });
            }
            if (arbpath2 == "5") {
                setAttrs({
                    "nummaw": 0
            });
            }
            if (arbpath2 == "6") {
                setAttrs({
                    "numshell": 0
            });
            }
            if (arbpath2 == "7") {
                setAttrs({
                    "numsling": 0
            });
            }
            if (arbpath2 == "8") {
                setAttrs({
                    "numflask": 0
            });
            }
        }


        if (arbpath3 != path3) {
            if (arbpath1 == "9") {
                setAttrs({
                    "numspire": 0
            });
            }
            if (arbpath3 == "10") {
                setAttrs({
                    "numcloak": 0
            });
            }
            if (arbpath3 == "11") {
                setAttrs({
                    "numdream": 0
            });
            }
            if (arbpath3 == "12") {
                setAttrs({
                    "numnightmare": 0
            });
            }
            if (arbpath3 == "13") {
                setAttrs({
                    "numbloom": 0
            });
            }
            if (arbpath3 == "14") {
                setAttrs({
                    "numthorn": 0
            });
            }
            if (arbpath3 == "15") {
                setAttrs({
                    "numdust": 0
            });
            }
            if (arbpath3 == "1") {
                setAttrs({
                    "numnail": 0
            });
            }
            if (arbpath3 == "2") {
                setAttrs({
                    "numneedle": 0
            });
            }
            if (arbpath3 == "3") {
                setAttrs({
                    "numtusk": 0
            });
            }
            if (arbpath3 == "4") {
                setAttrs({
                    "numhook": 0
            });
            }
            if (arbpath3 == "5") {
                setAttrs({
                    "nummaw": 0
            });
            }
            if (arbpath3 == "6") {
                setAttrs({
                    "numshell": 0
            });
            }
            if (arbpath3 == "7") {
                setAttrs({
                    "numsling": 0
            });
            }
            if (arbpath3 == "8") {
                setAttrs({
                    "numflask": 0
            });
            }
        }


        if (arbpath4 != path4) {
            if (arbpath4 == "9") {
                setAttrs({
                    "numspire": 0
            });
            }
            if (arbpath4 == "10") {
                setAttrs({
                    "numcloak": 0
            });
            }
            if (arbpath4 == "11") {
                setAttrs({
                    "numdream": 0
            });
            }
            if (arbpath4 == "12") {
                setAttrs({
                    "numnightmare": 0
            });
            }
            if (arbpath4 == "13") {
                setAttrs({
                    "numbloom": 0
            });
            }
            if (arbpath4 == "14") {
                setAttrs({
                    "numthorn": 0
            });
            }
            if (arbpath4 == "15") {
                setAttrs({
                    "numdust": 0
            });
            }
            if (arbpath4 == "1") {
                setAttrs({
                    "numnail": 0
            });
            }
            if (arbpath4 == "2") {
                setAttrs({
                    "numneedle": 0
            });
            }
            if (arbpath4 == "3") {
                setAttrs({
                    "numtusk": 0
            });
            }
            if (arbpath4 == "4") {
                setAttrs({
                    "numhook": 0
            });
            }
            if (arbpath4 == "5") {
                setAttrs({
                    "nummaw": 0
            });
            }
            if (arbpath4 == "6") {
                setAttrs({
                    "numshell": 0
            });
            }
            if (arbpath4 == "7") {
                setAttrs({
                    "numsling": 0
            });
            }
            if (arbpath4 == "8") {
                setAttrs({
                    "numflask": 0
            });
            }
        }

        if (arbpath5 != path5) {
            if (arbpath5 == "9") {
                setAttrs({
                    "numspire": 0
            });
            }
            if (arbpath5 == "10") {
                setAttrs({
                    "numcloak": 0
            });
            }
            if (arbpath5 == "11") {
                setAttrs({
                    "numdream": 0
            });
            }
            if (arbpath5 == "12") {
                setAttrs({
                    "numnightmare": 0
            });
            }
            if (arbpath5 == "13") {
                setAttrs({
                    "numbloom": 0
            });
            }
            if (arbpath5 == "14") {
                setAttrs({
                    "numthorn": 0
            });
            }
            if (arbpath5 == "15") {
                setAttrs({
                    "numdust": 0
            });
            }
            if (arbpath5 == "1") {
                setAttrs({
                    "numnail": 0
            });
            }
            if (arbpath5 == "2") {
                setAttrs({
                    "numneedle": 0
            });
            }
            if (arbpath5 == "3") {
                setAttrs({
                    "numtusk": 0
            });
            }
            if (arbpath5 == "4") {
                setAttrs({
                    "numhook": 0
            });
            }
            if (arbpath5 == "5") {
                setAttrs({
                    "nummaw": 0
            });
            }
            if (arbpath5 == "6") {
                setAttrs({
                    "numshell": 0
            });
            }
            if (arbpath5 == "7") {
                setAttrs({
                    "numsling": 0
            });
            }
            if (arbpath5 == "8") {
                setAttrs({
                    "numflask": 0
            });
            }
        }


        if (arbpath6 != path6) {
            if (arbpath6 == "9") {
                setAttrs({
                    "numspire": 0
            });
            }
            if (arbpath6 == "10") {
                setAttrs({
                    "numcloak": 0
            });
            }
            if (arbpath6 == "11") {
                setAttrs({
                    "numdream": 0
            });
            }
            if (arbpath6 == "12") {
                setAttrs({
                    "numnightmare": 0
            });
            }
            if (arbpath6 == "13") {
                setAttrs({
                    "numbloom": 0
            });
            }
            if (arbpath6 == "14") {
                setAttrs({
                    "numthorn": 0
            });
            }
            if (arbpath6 == "15") {
                setAttrs({
                    "numdust": 0
            });
            }
            if (arbpath6 == "1") {
                setAttrs({
                    "numnail": 0
            });
            }
            if (arbpath6 == "2") {
                setAttrs({
                    "numneedle": 0
            });
            }
            if (arbpath6 == "3") {
                setAttrs({
                    "numtusk": 0
            });
            }
            if (arbpath6 == "4") {
                setAttrs({
                    "numhook": 0
            });
            }
            if (arbpath6 == "5") {
                setAttrs({
                    "nummaw": 0
            });
            }
            if (arbpath6 == "6") {
                setAttrs({
                    "numshell": 0
            });
            }
            if (arbpath6 == "7") {
                setAttrs({
                    "numsling": 0
            });
            }
            if (arbpath6 == "8") {
                setAttrs({
                    "numflask": 0
            });
            }
        }





        if (path1 == "9") {
            setAttrs({
                "numspire": pathbox1
            });
        }
        if (path2 == "9") {
            setAttrs({
                "numspire": pathbox2
            });
        }
        if (path3 == "9") {
            setAttrs({
                "numspire": pathbox3
            });
        }
        if (path4 == "9") {
            setAttrs({
                "numspire": pathbox4
            });
        }
        if (path5 == "9") {
            setAttrs({
                "numspire": pathbox5
            });
        }
        if (path6 == "9") {
            setAttrs({
                "numspire": pathbox6
            });
        }


        if (path1 == "10") {
            setAttrs({
                "numcloak": pathbox1
            });
        }
        if (path2 == "10") {
            setAttrs({
                "numcloak": pathbox2
            });
        }
        if (path3 == "10") {
            setAttrs({
                "numcloak": pathbox3
            });
        }
        if (path4 == "10") {
            setAttrs({
                "numcloak": pathbox4
            });
        }
        if (path5 == "10") {
            setAttrs({
                "numcloak": pathbox5
            });
        }
        if (path6 == "10") {
            setAttrs({
                "numcloak": pathbox6
            });
        }


        if (path1 == "11") {
            setAttrs({
                "numdream": pathbox1
            });
        }
        if (path2 == "11") {
            setAttrs({
                "numdream": pathbox2
            });
        }
        if (path3 == "11") {
            setAttrs({
                "numdream": pathbox3
            });
        }
        if (path4 == "11") {
            setAttrs({
                "numdream": pathbox4
            });
        }
        if (path5 == "11") {
            setAttrs({
                "numdream": pathbox5
            });
        }
        if (path6 == "11") {
            setAttrs({
                "numdream": pathbox6
            });
        }

        if (path1 == "12") {
            setAttrs({
                "numnightmare": pathbox1
            });
        }
        if (path2 == "12") {
            setAttrs({
                "numnightmare": pathbox2
            });
        }
        if (path3 == "12") {
            setAttrs({
                "numnightmare": pathbox3
            });
        }
        if (path4 == "12") {
            setAttrs({
                "numnightmare": pathbox4
            });
        }
        if (path5 == "12") {
            setAttrs({
                "numnightmare": pathbox5
            });
        }
        if (path6 == "12") {
            setAttrs({
                "numnightmare": pathbox6
            });
        }
        
        
        if (path1 == "13") {
            setAttrs({
                "numbloom": pathbox1
            });
        }
        if (path2 == "13") {
            setAttrs({
                "numbloom": pathbox2
            });
        }
        if (path3 == "13") {
            setAttrs({
                "numbloom": pathbox3
            });
        }
        if (path4 == "13") {
            setAttrs({
                "numbloom": pathbox4
            });
        }
        if (path5 == "13") {
            setAttrs({
                "numbloom": pathbox5
            });
        }
        if (path6 == "13") {
            setAttrs({
                "numbloom": pathbox6
            });
        }


        if (path1 == "14") {
            setAttrs({
                "numthorn": pathbox1
            });
        }
        if (path2 == "14") {
            setAttrs({
                "numthorn": pathbox2
            });
        }
        if (path3 == "14") {
            setAttrs({
                "numthorn": pathbox3
            });
        }
        if (path4 == "14") {
            setAttrs({
                "numthorn": pathbox4
            });
        }
        if (path5 == "14") {
            setAttrs({
                "numthorn": pathbox5
            });
        }
        if (path6 == "14") {
            setAttrs({
                "numthorn": pathbox6
            });
        }



        if (path1 == "15") {
            setAttrs({
                "numdust": pathbox1
            });
        }
        if (path2 == "15") {
            setAttrs({
                "numdust": pathbox2
            });
        }
        if (path3 == "15") {
            setAttrs({
                "numdust": pathbox3
            });
        }
        if (path4 == "15") {
            setAttrs({
                "numdust": pathbox4
            });
        }
        if (path5 == "15") {
            setAttrs({
                "numdust": pathbox5
            });
        }
        if (path6 == "15") {
            setAttrs({
                "numdust": pathbox6
            });
        }
        
        if (path1 == "1") {
            setAttrs({
                "numnail": pathbox1
            });
        }
        if (path2 == "1") {
            setAttrs({
                "numnail": pathbox2
            });
        }
        if (path3 == "1") {
            setAttrs({
                "numnail": pathbox3
            });
        }
        if (path4 == "1") {
            setAttrs({
                "numnail": pathbox4
            });
        }
        if (path5 == "1") {
            setAttrs({
                "numnail": pathbox5
            });
        }
        if (path6 == "1") {
            setAttrs({
                "numnail": pathbox6
            });
        }
        
        if (path1 == "2") {
            setAttrs({
                "numneedle": pathbox1
            });
        }
        if (path2 == "2") {
            setAttrs({
                "numneedle": pathbox2
            });
        }
        if (path3 == "2") {
            setAttrs({
                "numneedle": pathbox3
            });
        }
        if (path4 == "2") {
            setAttrs({
                "numneedle": pathbox4
            });
        }
        if (path5 == "2") {
            setAttrs({
                "numneedle": pathbox5
            });
        }
        if (path6 == "2") {
            setAttrs({
                "numneedle": pathbox6
            });
        }

        if (path1 == "3") {
            setAttrs({
                "numtusk": pathbox1
            });
        }
        if (path2 == "3") {
            setAttrs({
                "numtusk": pathbox2
            });
        }
        if (path3 == "3") {
            setAttrs({
                "numtusk": pathbox3
            });
        }
        if (path4 == "3") {
            setAttrs({
                "numtusk": pathbox4
            });
        }
        if (path5 == "3") {
            setAttrs({
                "numtusk": pathbox5
            });
        }
        if (path6 == "3") {
            setAttrs({
                "numtusk": pathbox6
            });
        }

        if (path1 == "4") {
            setAttrs({
                "numhook": pathbox1
            });
        }
        if (path2 == "4") {
            setAttrs({
                "numhook": pathbox2
            });
        }
        if (path3 == "4") {
            setAttrs({
                "numhook": pathbox3
            });
        }
        if (path4 == "4") {
            setAttrs({
                "numhook": pathbox4
            });
        }
        if (path5 == "4") {
            setAttrs({
                "numhook": pathbox5
            });
        }
        if (path6 == "4") {
            setAttrs({
                "numhook": pathbox6
            });
        }

        if (path1 == "5") {
            setAttrs({
                "nummaw": pathbox1
            });
        }
        if (path2 == "5") {
            setAttrs({
                "nummaw": pathbox2
            });
        }
        if (path3 == "5") {
            setAttrs({
                "nummaw": pathbox3
            });
        }
        if (path4 == "5") {
            setAttrs({
                "nummaw": pathbox4
            });
        }
        if (path5 == "5") {
            setAttrs({
                "nummaw": pathbox5
            });
        }
        if (path6 == "5") {
            setAttrs({
                "nummaw": pathbox6
            });
        }

        if (path1 == "6") {
            setAttrs({
                "numshell": pathbox1
            });
        }
        if (path2 == "6") {
            setAttrs({
                "numshell": pathbox2
            });
        }
        if (path3 == "6") {
            setAttrs({
                "numshell": pathbox3
            });
        }
        if (path4 == "6") {
            setAttrs({
                "numshell": pathbox4
            });
        }
        if (path5 == "6") {
            setAttrs({
                "numshell": pathbox5
            });
        }
        if (path6 == "6") {
            setAttrs({
                "numshell": pathbox6
            });
        }


        if (path1 == "7") {
            setAttrs({
                "numsling": pathbox1
            });
        }
        if (path2 == "7") {
            setAttrs({
                "numsling": pathbox2
            });
        }
        if (path3 == "7") {
            setAttrs({
                "numsling": pathbox3
            });
        }
        if (path4 == "7") {
            setAttrs({
                "numsling": pathbox4
            });
        }
        if (path5 == "7") {
            setAttrs({
                "numsling": pathbox5
            });
        }
        if (path6 == "7") {
            setAttrs({
                "numsling": pathbox6
            });
        }

        if (path1 == "8") {
            setAttrs({
                "numflask": pathbox1
            });
        }
        if (path2 == "8") {
            setAttrs({
                "numflask": pathbox2
            });
        }
        if (path3 == "8") {
            setAttrs({
                "numflask": pathbox3
            });
        }
        if (path4 == "8") {
            setAttrs({
                "numflask": pathbox4
            });
        }
        if (path5 == "8") {
            setAttrs({
                "numflask": pathbox5
            });
        }
        if (path6 == "8") {
            setAttrs({
                "numflask": pathbox6
            });
        }

           setAttrs({
                "arbpath1": path1
            });
           setAttrs({
                "arbpathbox1": pathbox1
            });

           setAttrs({
                "arbpath2": path2
            });
           setAttrs({
                "arbpathbox2": pathbox2
            });

           setAttrs({
                "arbpath3": path3
            });
           setAttrs({
                "arbpathbox3": pathbox3
            });

           setAttrs({
                "arbpath4": path4
            });
           setAttrs({
                "arbpathbox4": pathbox4
            });

           setAttrs({
                "arbpath5": path5
            });
           setAttrs({
                "arbpathbox5": pathbox5
            });

           setAttrs({
                "arbpath6": path6
            });
           setAttrs({
                "arbpathbox6": pathbox6
            });
            
        if (( ((path1 == path2) && (path1 != "0") && (path2 != "0")) || (path1 == path3) || (path1 == path4) || (path1 == path5) || (path1 == path6) || (path2 == path3) || (path2 == path4) || (path2 == path5) || (path2 == path6) || (path3 == path4) || (path3 == path5) || (path3 == path6) || (path4 == path5) || (path4 == path6) || (path5 == path6))) {
            if ((path1 != arbpath1) && (path1 != "0") && (arbpath1 != "0")) {
                setAttrs({
                    "path1": 0
            });
            }
            if ((path2 != arbpath2) && (path2 != "0") && (arbpath2 != "0")) {
                setAttrs({
                    "path2": 0
            });
            }
            if ((path3 != arbpath3) && (path3 != "0") && (arbpath3 != "0")) {
                setAttrs({
                    "path3": 0
            });
            }
            if ((path4 != arbpath4) && (path4 != "0") && (arbpath4 != "0")) {
                setAttrs({
                    "path4": 0
            });
            }
            if ((path5 != arbpath5) && (path5 != "0") && (arbpath5 != "0")) {
                setAttrs({
                    "path5": 0
            });
            }
            if ((path6 != arbpath6) && (path6 != "0") && (arbpath6 != "0")) {
                setAttrs({
                    "path6": 0
            });
            }
        }
    });
});


on('change:numspire change:numcloak change:numdream change:numnightmare change:numbloom change:numthorn change:numdust change:attuneradio change:splpath change:numflask change:numnail change:numneedle change:numtusk change:numhook change:nummaw change:numshell change:numsling sheet:opened', () => {
    getAttrs(['numspire','numcloak','numdream','numnightmare','numbloom','numthorn','numdust','attuneradio','splpath','numnail','numneedle','numtusk','numhook','nummaw','numshell','numsling','numflask'], function(values) {
        let numspire = parseInt(values.numspire)||0;
        let numcloak = parseInt(values.numcloak)||0;
        let numdream = parseInt(values.numdream)||0;
        let numnightmare = parseInt(values.numnightmare)||0;
        let numbloom = parseInt(values.numbloom)||0;
        let numthorn = parseInt(values.numthorn)||0;
        let numdust = parseInt(values.numdust)||0;
        let attuneradio = parseInt(values.attuneradio)||0;
        let splpath = parseInt(values.splpath)||0;
        let numnail = parseInt(values.numnail)||0;
        let numneedle = parseInt(values.numneedle)||0;
        let numtusk = parseInt(values.numtusk)||0;
        let numhook = parseInt(values.numhook)||0;
        let nummaw = parseInt(values.nummaw)||0;
        let numshell = parseInt(values.numshell)||0;
        let numsling = parseInt(values.numsling)||0;
        let numflask = parseInt(values.numflask)||0;
        let nummartial = numnail + numneedle + numtusk + numhook + nummaw + numshell + numsling + numflask;
        
        if (nummartial > "0") {
            setAttrs({
                "quickcheck": 1
            });
        }
        else {
            setAttrs({
                "quickcheck": 0
            });
        }

        setAttrs({
            "mystictotal": numspire + numcloak + numdream + numnightmare + numbloom + numthorn + numdust
        });
        if (attuneradio == "0") {
            setAttrs({
                "maxdiff": 2 * (numspire + numcloak + numdream + numnightmare + numbloom + numthorn + numdust)
            });
        }
        if (attuneradio == "1") {
    
            if (splpath == "9") {
                setAttrs({
                    "maxdiff": numspire * 2
                });
            }
            if (splpath == "10") {
                setAttrs({
                    "maxdiff": numcloak * 2
                });
            }
            if (splpath == "11") {
                setAttrs({
                    "maxdiff": numdream * 2
                });
            }
            if (splpath == "12") {
                setAttrs({
                    "maxdiff": numnightmare * 2
                });
            }
            if (splpath == "13") {
                setAttrs({
                    "maxdiff": numbloom * 2
                });
            }
            if (splpath == "14") {
                setAttrs({
                    "maxdiff": numthorn * 2
                });
            }
            if (splpath == "15") {
                setAttrs({
                    "maxdiff": numdust * 2
                });
            }
            if (splpath == "0") {
                setAttrs({
                    "maxdiff": 0
                });
            }
        }
    });
});

on('change:unimod change:civilized change:heart change:heartmax change:phobia change:hungercheckattr change:unirerollmod sheet:opened', () => {
    getAttrs(['unimod','civilized','heart','heartmax','phobia','hungercheckattr','unirerollmod'], function(values) {
        let unimod = parseInt(values.unimod)||0;
        let civilized = parseInt(values.civilized)||0;
        let heart = parseInt(values.heart)||0;
        let phobia = parseInt(values.phobia)||0;
        let heartmax = parseInt(values.heartmax)||0;
        let hungercheckattr = parseInt(values.hungercheckattr);
        let unirerollmod = parseInt(values.unirerollmod)||0;
        let civmod = (heart == heartmax) ? 0 : civilized;
        setAttrs({
            "attrmodneb": 0
        });
        setAttrs({
            "attrnummodneb": 0 - hungercheckattr
        });
        setAttrs({
            "atkmodneb": 0
        });
        setAttrs({
            "unimodneb": unimod - phobia - civmod
        });
        setAttrs({
            "unirerollmodneb": unirerollmod
        });
        setAttrs({
            "civmodneb": civmod
        });
    });
});

on('change:dastardly change:heart sheet:opened', () => {
    getAttrs(['dastardly','heart'], function(values) {
        let dastardly = parseInt(values.dastardly)||0;
        let heart = parseInt(values.heart)||0;
        let dsoak = ((heart <= 1) && (dastardly == 1)) ? 2 : 0
        setAttrs({
            "soakdastardlymod": dsoak
        });
    });
});

on('change:heart change:hearttemp sheet:opened', () => {
    getAttrs(['heart','hearttemp'], function(values) {
        let heart = parseInt(values.heart)||0;
        let hearttemp = parseInt(values.hearttemp)||0;
        setAttrs({
            "hearttotal": heart + hearttemp
        });
    });
});

on('change:soul change:soultemp sheet:opened', () => {
    getAttrs(['soul','soultemp'], function(values) {
        let soul = parseInt(values.soul)||0;
        let soultemp = parseInt(values.soultemp)||0;
        setAttrs({
            "soultotal": soul + soultemp
        });
    });
});

on('change:stam change:stamtemp sheet:opened', () => {
    getAttrs(['stam','stamtemp'], function(values) {
        let stam = parseInt(values.stam)||0;
        let stamtemp = parseInt(values.stamtemp)||0;
        setAttrs({
            "stamtotal": stam + stamtemp
        });
    });
});

on('change:belly change:bellymax change:bellylostmod change:soulmax change:restingtype sheet:opened', () => {
    getAttrs(['belly','bellymax','bellylostmod','soulmax','restingtype'], function(values) {
        let belly = parseInt(values.belly)||0;
        let bellymax = parseInt(values.bellymax)||0;
        let bellylostmod = parseInt(values.bellylostmod)||0;
        let soulmax = parseInt(values.soulmax)||0;
        let restingtype = parseInt(values.restingtype)||0;
        const output = {};
        output.hungerchecksoul = (belly < 0 || restingtype == 2) ? 1 : 2;
        output.hungercheckattr = (belly < -50) ? 1 : 0;
        output.soulmaxhalf = (belly >= 0) ? soulmax : Math.ceil(soulmax / 2);
        setAttrs(output);
    });
});

on('change:mighttotal change:gracetotal change:shelltotal change:insighttotal change:attrmodneb sheet:opened', () => {
    getAttrs(['mighttotal','gracetotal','shelltotal','insighttotal','attrmodneb'], function(values) {
        let mighttotal = parseInt(values.mighttotal)||0;
        let gracetotal = parseInt(values.gracetotal)||0;
        let shelltotal = parseInt(values.shelltotal)||0;
        let insighttotal = parseInt(values.insighttotal)||0;
        let attrmodneb = parseInt(values.attrmodneb)||0;
        setAttrs({
            "mightcheck": mighttotal + attrmodneb
        });
        setAttrs({
            "gracecheck": gracetotal + attrmodneb
        });
        setAttrs({
            "shellcheck": shelltotal + attrmodneb
        });
        setAttrs({
            "insightcheck": insighttotal + attrmodneb
        });
    });
});

on('change:se1might change:se2might change:se3might change:se1insight change:se2insight change:se3insight change:se1shell change:se2shell change:se3shell change:se1grace change:se2grace change:se3grace change:se1primeatt change:se2primeatt change:se3primeatt change:se1seheart change:se2seheart change:se3seheart change:se1sesoul change:se2sesoul change:se3sesoul change:se1stamina change:se2stamina change:se3stamina change:se1speed change:se2speed change:se3speed change:se1drenviro change:se2drenviro change:se3drenviro sheet:opened', () => {
    getAttrs(['se1might','se2might','se3might','se1insight','se2insight','se3insight','se1shell','se2shell','se3shell','se1grace','se2grace','se3grace','se1primeatt','se2primeatt','se3primeatt','se1heart','se2heart','se3heart','se1soul','se2soul','se3soul','se1stamina','se2stamina','se3stamina','se1speed','se2speed','se3speed','se1dr','se2dr','se3dr','se1enviro','se2enviro','se3enviro',], function(values) {
        let se1might = parseInt(values.se1might)||0;
        let se2might = parseInt(values.se2might)||0;
        let se3might = parseInt(values.se3might)||0;
        let se1insight = parseInt(values.se1insight)||0;
        let se2insight = parseInt(values.se2insight)||0;
        let se3insight = parseInt(values.se3insight)||0;
        let se1shell = parseInt(values.se1shell)||0;
        let se2shell = parseInt(values.se2shell)||0;
        let se3shell = parseInt(values.se3shell)||0;
        let se1grace = parseInt(values.se1grace)||0;
        let se2grace = parseInt(values.se2grace)||0;
        let se3grace = parseInt(values.se3grace)||0;
        let se1primeatt = parseInt(values.se1primeatt)||0;
        let se2primeatt = parseInt(values.se2primeatt)||0;
        let se3primeatt = parseInt(values.se3primeatt)||0;
        let se1heart = parseInt(values.se1heart)||0;
        let se2heart = parseInt(values.se2heart)||0;
        let se3heart = parseInt(values.se3heart)||0;
        let se1soul = parseInt(values.se1soul)||0;
        let se2soul = parseInt(values.se2soul)||0;
        let se3soul = parseInt(values.se3soul)||0;
        let se1stamina = parseInt(values.se1stamina)||0;
        let se2stamina = parseInt(values.se2stamina)||0;
        let se3stamina = parseInt(values.se3stamina)||0;
        let se1speed = parseInt(values.se1speed)||0;
        let se2speed = parseInt(values.se2speed)||0;
        let se3speed = parseInt(values.se3speed)||0;
        let se1dr = parseInt(values.se1dr)||0;
        let se2dr = parseInt(values.se2dr)||0;
        let se3dr = parseInt(values.se3dr)||0;
        let se1enviro = parseInt(values.se1enviro)||0;
        let se2enviro = parseInt(values.se2enviro)||0;
        let se3enviro = parseInt(values.se3enviro)||0;

        const output = {};
        output.semight = se1might + se2might + se3might;
        output.seinsight = se1insight + se2insight + se3insight;
        output.seshell = se1shell + se2shell + se3shell;
        output.segrace = se1grace + se2grace + se3grace;
        output.seprimeatt = se1primeatt + se2primeatt + se3primeatt;
        output.seheart = se1heart + se2heart + se3heart;
        output.sesoul = se1soul + se2soul + se3soul;
        output.sestamina = se1stamina + se2stamina + se3stamina;
        output.sespeed = se1speed + se2speed + se3speed;
        output.sedr = se1dr + se2dr + se3dr;
        output.seenviro = se1enviro + se2enviro + se3enviro;
        setAttrs(output);
    });
});

on('change:se1autoenumber change:se1autorepeat change:se1autodrop change:se1 sheet:opened', () => {
    getAttrs(['se1autoenumber','se1autorepeat','se1autodrop','se1'], function(values) {
        let se1number = parseInt(values.se1autoenumber)||0;
        let se1repeat = parseInt(values.se1autorepeat)||0;
        let se1drop = parseInt(values.se1autodrop)||0;
        let se1 = parseInt(values.se1)||0;

        let effmath = ((se1repeat != 0) && ((se1number * Math.floor(se1 / se1repeat)) != 0)) ? se1number * Math.floor(se1 / se1repeat) : se1number;
        
        const output = {};
        if (se1 >= "1") {
        output.se1might = (se1drop == "1") ? effmath : 0;
        output.se1insight = (se1drop == "2") ? effmath : 0;
        output.se1shell = (se1drop == "3") ? effmath : 0;
        output.se1grace = (se1drop == "4") ? effmath : 0;
        output.se1primeatt = (se1drop == "5") ? effmath : 0;
        output.se1heart = (se1drop == "6") ? effmath : 0;
        output.se1soul = (se1drop == "7") ? effmath : 0;
        output.se1stamina = (se1drop == "8") ? effmath : 0;
        output.se1speed = (se1drop == "9") ? effmath : 0;
        output.se1dr = (se1drop == "10") ? effmath : 0;
        output.se1enviro = (se1drop == "11") ? effmath : 0;
        }
        else {
        output.se1might = 0;
        output.se1insight = 0;
        output.se1shell = 0;
        output.se1grace = 0;
        output.se1primeatt = 0;
        output.se1heart = 0;
        output.se1soul = 0;
        output.se1stamina = 0;
        output.se1speed = 0;
        output.se1dr = 0;
        output.se1enviro = 0;
        }
        setAttrs(output);
    });
});

on('change:se2autoenumber change:se2autorepeat change:se2autodrop change:se2 sheet:opened', () => {
    getAttrs(['se2autoenumber','se2autorepeat','se2autodrop','se2'], function(values) {
        let se2number = parseInt(values.se2autoenumber)||0;
        let se2repeat = parseInt(values.se2autorepeat)||0;
        let se2drop = parseInt(values.se2autodrop)||0;
        let se2 = parseInt(values.se2)||0;

        let effmath = ((se2repeat != 0) && ((se2number * Math.floor(se2 / se2repeat)) != 0)) ? se2number * Math.floor(se2 / se2repeat) : se2number;
        
        const output = {};
        if (se2 >= "1") {
        output.se2might = (se2drop == "1") ? effmath : 0;
        output.se2insight = (se2drop == "2") ? effmath : 0;
        output.se2shell = (se2drop == "3") ? effmath : 0;
        output.se2grace = (se2drop == "4") ? effmath : 0;
        output.se2primeatt = (se2drop == "5") ? effmath : 0;
        output.se2heart = (se2drop == "6") ? effmath : 0;
        output.se2soul = (se2drop == "7") ? effmath : 0;
        output.se2stamina = (se2drop == "8") ? effmath : 0;
        output.se2speed = (se2drop == "9") ? effmath : 0;
        output.se2dr = (se2drop == "10") ? effmath : 0;
        output.se2enviro = (se2drop == "11") ? effmath : 0;
        }
        else {
        output.se2might = 0;
        output.se2insight = 0;
        output.se2shell = 0;
        output.se2grace = 0;
        output.se2primeatt = 0;
        output.se2heart = 0;
        output.se2soul = 0;
        output.se2stamina = 0;
        output.se2speed = 0;
        output.se2dr = 0;
        output.se2enviro = 0;
        }
        setAttrs(output);
    });
});


on('change:se3autoenumber change:se3autorepeat change:se3autodrop change:se3 sheet:opened', () => {
    getAttrs(['se3autoenumber','se3autorepeat','se3autodrop','se3'], function(values) {
        let se3number = parseInt(values.se3autoenumber)||0;
        let se3repeat = parseInt(values.se3autorepeat)||0;
        let se3drop = parseInt(values.se3autodrop)||0;
        let se3 = parseInt(values.se3)||0;

        let effmath = ((se3repeat != 0) && ((se3number * Math.floor(se3 / se3repeat)) != 0)) ? se3number * Math.floor(se3 / se3repeat) : se3number;
        
        const output = {};
        if (se3 >= "1") {
        output.se3might = (se3drop == "1") ? effmath : 0;
        output.se3insight = (se3drop == "2") ? effmath : 0;
        output.se3shell = (se3drop == "3") ? effmath : 0;
        output.se3grace = (se3drop == "4") ? effmath : 0;
        output.se3primeatt = (se3drop == "5") ? effmath : 0;
        output.se3heart = (se3drop == "6") ? effmath : 0;
        output.se3soul = (se3drop == "7") ? effmath : 0;
        output.se3stamina = (se3drop == "8") ? effmath : 0;
        output.se3speed = (se3drop == "9") ? effmath : 0;
        output.se3dr = (se3drop == "10") ? effmath : 0;
        output.se3enviro = (se3drop == "11") ? effmath : 0;
        }
        else {
        output.se3might = 0;
        output.se3insight = 0;
        output.se3shell = 0;
        output.se3grace = 0;
        output.se3primeatt = 0;
        output.se3heart = 0;
        output.se3soul = 0;
        output.se3stamina = 0;
        output.se3speed = 0;
        output.se3dr = 0;
        output.se3enviro = 0;
        }
        setAttrs(output);
    });
});


on('change:se1attrcheck change:se1might change:se1insight change:se1shell change:se1grace change:se1primeatt change:se2attrcheck change:se2might change:se2insight change:se2shell change:se2grace change:se2primeatt change:se3attrcheck change:se3might change:se3insight change:se3shell change:se3grace change:se3primeatt sheet:opened', () => {
    getAttrs(['se1attrcheck','se1might','se1insight','se1shell','se1grace','se1primeatt','se2attrcheck','se2might','se2insight','se2shell','se2grace','se2primeatt','se3attrcheck','se3might','se3insight','se3shell','se3grace','se3primeatt'], function(values) {
        let se1attrcheck = parseInt(values.se1attrcheck)||0;
        let se1might = parseInt(values.se1might)||0;
        let se1insight = parseInt(values.se1insight)||0;
        let se1shell = parseInt(values.se1shell)||0;
        let se1grace = parseInt(values.se1grace)||0;
        let se1primeatt = parseInt(values.se1primeatt)||0;
        let se2attrcheck = parseInt(values.se2attrcheck)||0;
        let se2might = parseInt(values.se2might)||0;
        let se2insight = parseInt(values.se2insight)||0;
        let se2shell = parseInt(values.se2shell)||0;
        let se2grace = parseInt(values.se2grace)||0;
        let se2primeatt = parseInt(values.se2primeatt)||0;
        let se3attrcheck = parseInt(values.se3attrcheck)||0;
        let se3might = parseInt(values.se3might)||0;
        let se3insight = parseInt(values.se3insight)||0;
        let se3shell = parseInt(values.se3shell)||0;
        let se3grace = parseInt(values.se3grace)||0;
        let se3primeatt = parseInt(values.se3primeatt)||0;

        let se1mightfin = se1attrcheck * se1might;
        let se1insightfin = se1attrcheck * se1insight;
        let se1shellfin = se1attrcheck * se1shell;
        let se1gracefin = se1attrcheck * se1grace;
        let se1primeattfin = se1attrcheck * se1primeatt;

        let se2mightfin = se2attrcheck * se2might;
        let se2insightfin = se2attrcheck * se2insight;
        let se2shellfin = se2attrcheck * se2shell;
        let se2gracefin = se2attrcheck * se2grace;
        let se2primeattfin = se2attrcheck * se2primeatt;
        
        let se3mightfin = se3attrcheck * se3might;
        let se3insightfin = se3attrcheck * se3insight;
        let se3shellfin = se3attrcheck * se3shell;
        let se3gracefin = se3attrcheck * se3grace;
        let se3primeattfin = se3attrcheck * se3primeatt;

        const output = {};
        output.semightfin = se1mightfin + se2mightfin + se3mightfin;
        output.seinsightfin = se1insightfin + se2insightfin + se3insightfin;
        output.seshellfin = se1shellfin + se2shellfin + se3shellfin;
        output.segracefin = se1gracefin + se2gracefin + se3gracefin;
        output.seprimeattfin = se1primeattfin + se2primeattfin + se3primeattfin;
        setAttrs(output);
    });
});


on('change:path1 change:pathbox1 change:path2 change:pathbox2 change:path3 change:pathbox3 change:path4 change:pathbox4 change:path5 change:pathbox5 change:path6 change:pathbox6 sheet:opened', () => {
    getAttrs(['path1','pathbox1','path2','pathbox2','path3','pathbox3','path4','pathbox4','path5','pathbox5','path6','pathbox6'], function(values) {
        let path1 = parseInt(values.path1)||0;
        let pathbox1 = parseInt(values.pathbox1)||0;
        let path2 = parseInt(values.path2)||0;
        let pathbox2 = parseInt(values.pathbox2)||0;
        let path3 = parseInt(values.path3)||0;
        let pathbox3 = parseInt(values.pathbox3)||0;
        let path4 = parseInt(values.path4)||0;
        let pathbox4 = parseInt(values.pathbox4)||0;
        let path5 = parseInt(values.path5)||0;
        let pathbox5 = parseInt(values.pathbox5)||0;
        let path6 = parseInt(values.path6)||0;
        let pathbox6 = parseInt(values.pathbox6)||0;
        const output = {};

        output.tusk1 = (((path1 == 3) && (pathbox1 >= 1)) || ((path2 == 3) && (pathbox2 >= 1)) || ((path3 == 3) && (pathbox3 >= 1)) || ((path4 == 3) && (pathbox4 >= 1)) || ((path5 == 3) && (pathbox5 >= 1)) || ((path6 == 3) && (pathbox6 >= 1))) ? 1 : 0;
        output.shell1 = (((path1 == 6) && (pathbox1 >= 1)) || ((path2 == 6) && (pathbox2 >= 1)) || ((path3 == 6) && (pathbox3 >= 1)) || ((path4 == 6) && (pathbox4 >= 1)) || ((path5 == 6) && (pathbox5 >= 1)) || ((path6 == 6) && (pathbox6 >= 1))) ? 1 : 0;

        setAttrs(output);
    });
});

on('change:dedstafloating change:tusk1 change:bulkcurrent change:wpnclasscurrent sheet:opened', () => {
    getAttrs(['dedstafloating','tusk1','bulkcurrent','wpnclasscurrent'], function(values) {
        let dedstafloating = parseInt(values.dedstafloating)||0;
        let tusk1 = parseInt(values.tusk1)||0;
        let bulkcurrent = parseInt(values.bulkcurrent)||0;
        let wpnclasscurrent = parseInt(values.wpnclasscurrent)||0;
        let tuskinit = (tusk1 == 1 && dedstafloating >= 3) ? 1 : 0;
        let tuskfinal = ((tusk1 == 1 && dedstafloating >= 3) && (bulkcurrent >= 2 || wpnclasscurrent == 4)) ? tuskinit + 1 : tuskinit;
        const output = {};
        output.tuskcheck = tuskfinal;
        setAttrs(output);

    });
});

// <div class="checkmight">
//    <button type="roll" name="roll_checkmight" value="&{template:checkmight} {{name=Checkmight}} {{mightcheck=[[@{mightcheck}d6>5]]}} {{mightreroll=[[@{mightreroll}d6>5]]}}"></div>
// <div class="checkinsight">
//    <button type="roll" name="roll_checkinsight" value="&{template:checkinsight} {{name=Checkinsight}} {{insightcheck=[[@{insightcheck}d6>5]]}} {{insightreroll=[[@{insightreroll}d6>5]]}}"></div>
// <div class="checkshell">
//    <button type="roll" name="roll_checkshell" value="&{template:checkshell} {{name=Checkshell}} {{shellcheck=[[@{shellcheck}d6>5]]}} {{shellreroll=[[@{shellreroll}d6>5]]}}"></div>
// <div class="checkgrace">
//    <button type="roll" name="roll_checkgrace" value="&{template:checkgrace} {{name=Checkgrace}} {{gracecheck=[[@{gracecheck}d6>5]]}} {{gracereroll=[[@{gracereroll}d6>5]]}}"></div>
// <div class="checkcute">
//    <button type="roll" name="roll_checkcute" value="&{template:checkcute} {{name=Checkcute}} {{cutecheck=[[@{cutetotal}d6>5]]}} {{cutereroll=[[@{cutereroll}d6>5]]}}"></div>
// <div class="checkspook">
//    <button type="roll" name="roll_checkspook" value="&{template:checkspook} {{name=Checkspook}} {{spookcheck=[[@{spooktotal}d6>5]]}} {{spookreroll=[[@{spookreroll}d6>5]]}}"></div>

    on('clicked:checkmight', (info) => {
          getAttrs(["mightcheck","mightreroll","unilock","unirerolllock"], function(values) {
        let mightreroll = parseInt(values.mightreroll)||0;
        let unilock = parseInt(values.unilock)||0;
        let unirerolllock = parseInt(values.unirerolllock)||0;
            if(mightreroll >= "1") {
            let rollString = "&{template:mightcheckplusreroll} {{name=mightcheckplusreroll}} {{rollmightcheckplusreroll=[[[[floor(@{mightcheck})]]d6>5]]}}";
                rollString += "{{rollmightcheckr1=[[@{mightreroll}d6>5]]}}";
            startRoll(rollString, results => {
            const mightcheck = parseInt(values.mightcheck)||0;
            const roll = results.results.rollmightcheckplusreroll.result;
            const reroll_calculated = results.results.rollmightcheckr1.result;
            const rerollmin = (mightcheck - roll <= 0) ? 0 : mightcheck - roll;
            const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
            const total = roll + reroll;
            finishRoll(results.rollId, {
                rollmightcheckplusreroll: total
                });
        });
            }
            else {
            let rollString = "&{template:mightcheck} {{name=mightcheck}} {{rollmightcheck=[[[[floor(@{mightcheck})]]d6>5]]}}";
            startRoll(rollString, results => {
            finishRoll(results.rollId, {
                });
        });
            }
    if (unilock == 0) {
    setAttrs({
        "unimod": 0
    });
    }
    if (unirerolllock == 0) {
    setAttrs({
        "unirerollmod": 0
    });
    }
    });
});

    on('clicked:checkinsight', (info) => {
          getAttrs(["insightcheck","insightreroll","unilock","unirerolllock"], function(values) {
        let insightreroll = parseInt(values.insightreroll)||0;
        let unilock = parseInt(values.unilock)||0;
        let unirerolllock = parseInt(values.unirerolllock)||0;
            if(insightreroll >= "1") {
            let rollString = "&{template:insightcheckplusreroll} {{name=insightcheckplusreroll}} {{rollinsightcheckplusreroll=[[[[floor(@{insightcheck})]]d6>5]]}}";
                rollString += "{{rollinsightcheckr1=[[@{insightreroll}d6>5]]}}";
            startRoll(rollString, results => {
            const insightcheck = parseInt(values.insightcheck)||0;
            const roll = results.results.rollinsightcheckplusreroll.result;
            const reroll_calculated = results.results.rollinsightcheckr1.result;
            const rerollmin = (insightcheck - roll <= 0) ? 0 : insightcheck - roll;
            const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
            const total = roll + reroll;
            finishRoll(results.rollId, {
                rollinsightcheckplusreroll: total
                });
        });
            }
            else {
            let rollString = "&{template:insightcheck} {{name=insightcheck}} {{rollinsightcheck=[[[[floor(@{insightcheck})]]d6>5]]}}";
            startRoll(rollString, results => {
            finishRoll(results.rollId, {
                });
        });
            }
    if (unilock == 0) {
    setAttrs({
        "unimod": 0
    });
    }
    if (unirerolllock == 0) {
    setAttrs({
        "unirerollmod": 0
    });
    }
    });
});

    on('clicked:checkshell', (info) => {
          getAttrs(["shellcheck","shellreroll","unilock","unirerolllock"], function(values) {
        let shellreroll = parseInt(values.shellreroll)||0;
        let unilock = parseInt(values.unilock)||0;
        let unirerolllock = parseInt(values.unirerolllock)||0;
            if(shellreroll >= "1") {
            let rollString = "&{template:shellcheckplusreroll} {{name=shellcheckplusreroll}} {{rollshellcheckplusreroll=[[[[floor(@{shellcheck})]]d6>5]]}}";
                rollString += "{{rollshellcheckr1=[[@{shellreroll}d6>5]]}}";
            startRoll(rollString, results => {
            const shellcheck = parseInt(values.shellcheck)||0;
            const roll = results.results.rollshellcheckplusreroll.result;
            const reroll_calculated = results.results.rollshellcheckr1.result;
            const rerollmin = (shellcheck - roll <= 0) ? 0 : shellcheck - roll;
            const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
            const total = roll + reroll;
            finishRoll(results.rollId, {
                rollshellcheckplusreroll: total
                });
        });
            }
            else {
            let rollString = "&{template:shellcheck} {{name=shellcheck}} {{rollshellcheck=[[[[floor(@{shellcheck})]]d6>5]]}}";
            startRoll(rollString, results => {
            finishRoll(results.rollId, {
                });
        });
            }
    if (unilock == 0) {
    setAttrs({
        "unimod": 0
    });
    }
    if (unirerolllock == 0) {
    setAttrs({
        "unirerollmod": 0
    });
    }
    });
});

    on('clicked:checkgrace', (info) => {
          getAttrs(["gracecheck","gracereroll","unilock","unirerolllock"], function(values) {
        let gracereroll = parseInt(values.gracereroll)||0;
        let unilock = parseInt(values.unilock)||0;
        let unirerolllock = parseInt(values.unirerolllock)||0;
            if(gracereroll >= "1") {
            let rollString = "&{template:gracecheckplusreroll} {{name=gracecheckplusreroll}} {{rollgracecheckplusreroll=[[[[floor(@{gracecheck})]]d6>5]]}}";
                rollString += "{{rollgracecheckr1=[[@{gracereroll}d6>5]]}}";
            startRoll(rollString, results => {
            const gracecheck = parseInt(values.gracecheck)||0;
            const roll = results.results.rollgracecheckplusreroll.result;
            const reroll_calculated = results.results.rollgracecheckr1.result;
            const rerollmin = (gracecheck - roll <= 0) ? 0 : gracecheck - roll;
            const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
            const total = roll + reroll;
            finishRoll(results.rollId, {
                rollgracecheckplusreroll: total
                });
        });
            }
            else {
            let rollString = "&{template:gracecheck} {{name=gracecheck}} {{rollgracecheck=[[[[floor(@{gracecheck})]]d6>5]]}}";
            startRoll(rollString, results => {
            finishRoll(results.rollId, {
                });
        });
            }
    if (unilock == 0) {
    setAttrs({
        "unimod": 0
    });
    }
    if (unirerolllock == 0) {
    setAttrs({
        "unirerollmod": 0
    });
    }
    });
});

    on('clicked:checkcute', (info) => {
          getAttrs(["cute","cutereroll","unilock","unirerolllock"], function(values) {
        let cutereroll = parseInt(values.cutereroll)||0;
        let unilock = parseInt(values.unilock)||0;
        let unirerolllock = parseInt(values.unirerolllock)||0;
            if(cutereroll >= "1") {
            let rollString = "&{template:cutecheckplusreroll} {{name=cutecheckplusreroll}} {{rollcutecheckplusreroll=[[[[floor(@{cute})]]d6>5]]}}";
                rollString += "{{rollcutecheckr1=[[@{cutereroll}d6>5]]}}";
            startRoll(rollString, results => {
            const cutecheck = parseInt(values.cute)||0;
            const roll = results.results.rollcutecheckplusreroll.result;
            const reroll_calculated = results.results.rollcutecheckr1.result;
            const rerollmin = (cutecheck - roll <= 0) ? 0 : cutecheck - roll;
            const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
            const total = roll + reroll;
            finishRoll(results.rollId, {
                rollcutecheckplusreroll: total
                });
        });
            }
            else {
            let rollString = "&{template:cutecheck} {{name=cutecheck}} {{rollcutecheck=[[[[floor(@{cute})]]d6>5]]}}";
            startRoll(rollString, results => {
            finishRoll(results.rollId, {
                });
        });
            }
    if (unilock == 0) {
    setAttrs({
        "unimod": 0
    });
    }
    if (unirerolllock == 0) {
    setAttrs({
        "unirerollmod": 0
    });
    }
    });
});

    on('clicked:checkspook', (info) => {
          getAttrs(["spook","spookreroll","unilock","unirerolllock"], function(values) {
        let spookreroll = parseInt(values.spookreroll)||0;
        let unilock = parseInt(values.unilock)||0;
        let unirerolllock = parseInt(values.unirerolllock)||0;
            if(spookreroll >= "1") {
            let rollString = "&{template:spookcheckplusreroll} {{name=spookcheckplusreroll}} {{rollspookcheckplusreroll=[[[[floor(@{spook})]]d6>5]]}}";
                rollString += "{{rollspookcheckr1=[[@{spookreroll}d6>5]]}}";
            startRoll(rollString, results => {
            const spookcheck = parseInt(values.spook)||0;
            const roll = results.results.rollspookcheckplusreroll.result;
            const reroll_calculated = results.results.rollspookcheckr1.result;
            const rerollmin = (spookcheck - roll <= 0) ? 0 : spookcheck - roll;
            const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
            const total = roll + reroll;
            finishRoll(results.rollId, {
                rollspookcheckplusreroll: total
                });
        });
            }
            else {
            let rollString = "&{template:spookcheck} {{name=spookcheck}} {{rollspookcheck=[[[[floor(@{spook})]]d6>5]]}}";
            startRoll(rollString, results => {
            finishRoll(results.rollId, {
                });
        });
            }
    if (unilock == 0) {
    setAttrs({
        "unimod": 0
    });
    }
    if (unirerolllock == 0) {
    setAttrs({
        "unirerollmod": 0
    });
    }

    });
});

    on('clicked:defspellsave', (info) => {
          getAttrs(["defspellsavetotal","defspellsavereroll","unilock","unirerolllock"], function(values) {
        let defspellsavereroll = parseInt(values.defspellsavereroll)||0;
        let unilock = parseInt(values.unilock)||0;
        let unirerolllock = parseInt(values.unirerolllock)||0;
            if(defspellsavereroll >= "1") {
            let rollString = "&{template:defspellsaveplusreroll} {{name=defspellsaveplusreroll}} {{rolldefspellsaveplusreroll=[[[[floor(@{defspellsavetotal})]]d6>5]]}}";
                rollString += "{{rolldefspellsaver1=[[@{defspellsavereroll}d6>5]]}}";
            startRoll(rollString, results => {
            const defspellsavetotal = parseInt(values.defspellsavetotal)||0;
            const roll = results.results.rolldefspellsaveplusreroll.result;
            const reroll_calculated = results.results.rolldefspellsaver1.result;
            const rerollmin = (defspellsavetotal - roll <= 0) ? 0 : defspellsavetotal - roll;
            const reroll = (rerollmin - reroll_calculated <= 0) ? rerollmin : reroll_calculated;
            const total = roll + reroll;
            finishRoll(results.rollId, {
                rolldefspellsaveplusreroll: total
                });
        });
            }
            else {
            let rollString = "&{template:defspellsave} {{name=defspellsavecheck}} {{rolldefspellsave=[[[[floor(@{defspellsavetotal})]]d6>5]]}}";
            startRoll(rollString, results => {
            finishRoll(results.rollId, {
                });
        });
            }
    if (unilock == 0) {
    setAttrs({
        "unimod": 0
    });
    }
    if (unirerolllock == 0) {
    setAttrs({
        "unirerollmod": 0
    });
    }

    });
});

</script>
