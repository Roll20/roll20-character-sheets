<!-- TABS HTML only -->

<!-- ATTRIBUTES -->
<div class="dodaslayout">

  <div class="ATRTable">
    <div class="ATRTableHeader">
      <span class="ATRTablePhysical">Physical</span>
      <span class="ATRTableMental">Mental</span>
      <span class="ATRTableDerived">Derived</span>
    </div>
    <div class="ATRTableRow">
      <div class="ATRLetter">
        <button class="attributerollbutton" type="roll" value='&{template:default} {{name=@{character_name} Strength (+ 2xST)}} {{roll=[[2d6 + @{Strength} + @{Strength}]]}}' name="roll_strengthbutton">
          <span>STR</span></button>
      </div>
      <div class="ATRNumber">
        <input type="number" name="attr_strength" placeholder="0">
      </div>
      <div class="ATRLetter">
        <button class="attributerollbutton" type="roll" value='&{template:default} {{name=@{character_name} Willpower}} {{roll=[[2d6 + @{willpower}]]}}' name="roll_willpowerbutton">
          <span>WP</span></button>
      </div>

      <div class="ATRNumber">
        <input type="number" name="attr_willpower" placeholder="0">
      </div>
      <div class="derivedATRLetter">
        <span>AP</span>
      </div>
      <div class="derivedATRNumber">
        <input type="number" name="attr_actionpoints" style=" font-weight: bold;" placeholder="4">
      </div>
    </div>


    <div class="ATRTableRow">
      <div class="ATRLetter">
        <button class="attributerollbutton" type="roll" value='&{template:default} {{name=@{character_name} Agility (+ 2xWP)}} {{roll=[[2d6 + @{agility} + @{agility}]]}}' name="roll_agilitybutton">

          <span>AGI</span></button>
      </div>
      <div class="ATRNumber">
        <input type="number" name="attr_agility" value="0">
      </div>

      <div class="ATRLetter">
        <button class="attributerollbutton" type="roll" value='&{template:default} {{name=@{character_name} Wit}} {{roll=[[2d6 + @{wit}]]}}' name="roll_witbutton">
          <span>WIT</span></button>
      </div>
      <div class="ATRNumber">
        <input type="number" name="attr_wit" style=" font-weight: bold;" value="0" min="-5" max="5">
      </div>

      <div class="derivedATRLetter">
        <button class="derivedattributerollbutton" type="roll" value='&{template:default} {{name=@{character_name} Reflex}} {{roll=[[2d6 + @{reflex} &{tracker}]]}}' name="roll_reflexbutton">
          <span> REF</span></button>
      </div>
      <div class="derivedATRNumber">
        <input type="number" name="attr_reflex" value="0">
      </div>

    </div>

    <div class="ATRTableRow">
      <div class="ATRLetter">
        <button class="attributerollbutton" type="roll" value='&{template:default} {{name=@{character_name} Toughness (+ 2xTH)}} {{roll=[[2d6 + @{toughness}]]}}' name="roll_toughnessbutton">
          <span>TGH</span></button>
      </div>
      <div class="ATRNumber">
        <input type="number" name="attr_toughness" style=" font-weight: bold;" placeholder="0">
      </div>
      <div class="ATRLetter">
        <button class="attributerollbutton" type="roll" value='&{template:default} {{name=@{character_name} Perception}} {{roll=[[2d6 + @{perception}]]}}' name="roll_perceptionbutton">
          <span>PER</span></button>
      </div>
      <div class="ATRNumber">
        <input type="number" name="attr_perception" style=" font-weight: bold;" placeholder="0"></p>
      </div>
      <div class="derivedATRLetter">
        <button class="derivedattributerollbutton" type="roll" value='&{template:default} {{name=@{character_name} Knockdown}} {{roll=[[2d6 + @{knockdown}]]}}' name="roll_knockdownbutton">
          <span> KND</span></button>
        </div>
      <div class="derivedATRNumber">
        <input type="number" name="attr_knockdown" style=" font-weight: bold;" placeholder="0">
      </div>
    </div>

        <div class="ATRTableRow">
          <div class="ATRLetter">
            <span>SZ</span>
          </div>
          <div class="ATRNumber">
            <input type="number" name="attr_size" style=" font-weight: bold;" placeholder="0" min="-6">
          </div>
          <div class="ATRLetter">
            <button class="attributerollbutton" type="roll" value='&{template:default} {{name=@{character_name} Intelligence}} {{roll=[[2d6 + @{intelligence}]]}}' name="roll_agilitybutton">
              <span>IN</span></button>
          </div>
          <div class="ATRNumber">
            <input type="number" name="attr_intelligence" style=" font-weight: bold;" placeholder="0">
          </div>
          <div class="derivedATRLetter">
            <button class="derivedattributerollbutton" type="roll" value='&{template:default} {{name=@{character_name} Knockout}} {{roll=[[2d6 + @{knockout}]]}}' name="roll_knockoutbutton">
              <span>KO</span></button>
          </div>
          <div class="derivedATRNumber">
            <input class="" type="number" name="attr_knockout" style=" font-weight: bold;" placeholder="0">
          </div>
        </div>

        <div class="ATRTableRow">
          <div class="derivedATRLetter">
            <button class="derivedattributerollbutton" type="roll" value='&{template:default} {{name=@{character_name} Power}} {{roll=[[2d6 + @{Power}]]}}' name="roll_powerbutton">
              <span>PW</span></button>
          </div>
          <div class="derivedATRNumber">
            <input type="number" name="attr_power" style="font-weight: bold;" placeholder="0">
          </div>
          <div class="derivedATRLetter">
            <button class="derivedattributerollbutton" type="roll" value='&{template:default} {{name=@{character_name} Body}} {{roll=[[2d6 + @{Body}]]}}' name="roll_bodybutton">
              <span>BD</span></button>
            </div>
          <div class="derivedATRNumber">
            <input type="number" name="attr_body" style=" font-weight: bold;" placeholder="0">
          </div>
          <div class="derivedATRLetter">
            <span>Move</span>
          </div>
          <div>
            <input type="number" name="attr_movement" style=" font-weight: bold;" placeholder="5">
          </div>
        </div>
        </div>



        <!-- WEAPONs EQUIPPED TABLE -->
        <div class="weapontable">
          <div class="wptrow1">
            <span class="wptrangedc">Range DC</span>
            <span><input type="text" name="attr_rangedcstill" placeholder="9"> </span>
            <span><input type="text" name="attr_rangedcmoving" placeholder="12"> </span>
            <span class="cptoprow">CP</span>
            <span class="rollplus">Roll +</span>
            <span class="wpttoprowcut">Cut</span>
            <span class="wpttoprowthrust">Thrust</span>
            <span class="wpttoprowparry">Parry/</span>
            <span class="wpttoprowAP">AP</span>
            <span class="wpttoprowdodge">Dodge</span>
            <span><input type="text" name="attr_dodge"></span>
            <span class="pp">PP</span>
            <span><input type="text" name="attr_passiveperception" placeholder=7> </span>
          </div>
          <div class="wptrow2">
            <span class="wtweapon">Weapon</span>
            <span class="wtRange">Range</span>
            <span class="wtHand">Hand</span>
            <span class="wtTotal">Total</span>
            <span class="wtA">Att</span>
            <span class="wtD">Def</span>
            <span class="wtDm">Damage</span>
            <span class="wtBlock">Block</span>
            <span class="wtMod">Mod</span>
            <span class="wtOther">Other</span>
          </div>

          <fieldset class="repeating_weapons">
            <div class="wptfillrepeating">
              <input type="text" name="attr_weapon" value="">
              <input type="text" name="attr_range" value="">
              <input type="text" name="attr_hand" value="">
              <input type="text" name="attr_cptotal" value="">
              <input type="text" name="attr_skirmishattack" value="">
              <input type="text" name="attr_skirmishdefense" value="">
              <input type="text" name="attr_cutdamage" value="">
              <input type="text" name="attr_thrustdamage" value="">
              <input type="text" name="attr_parryblock" value="">
              <input type="text" name="attr_weaponactionpointmodifier" value="">
              <input type="text" name="attr_other" value="">
              <span class="weaponbutton">
              <button type="roll" value=
                      '&{template:default} {{name=@{character_name} @{weapon} }} {{attack=[[2d6 + @{skirmishattack}]] [[2d6 + @{skirmishattack}]][[2d6 + @{skirmishattack}]]}} {{Damage=@{cutdamage} , @{thrustdamage} + [[1d6]][[1d6]][[1d6]]}} {{Weapon Range=@{range}}} {{Defense=[[2d6 + @{skirmishdefense}]][[2d6 + @{skirmishdefense}]][[2d6 + @{skirmishdefense}]]}} {{Parry or Block=@{parryblock}}} {{Notes=@{other}}} '
                      name="roll_weaponrepeatingbutton"></button></span>

            </div>
          </fieldset>
        </div>



      <!-- ARMOR TABLE -->
      <div class="armor">
        <div class="toprow">
          <span class="atTopWeapon"></span>
          <span class="atTopAvEquip">AV Equip</span>
          <span class="atTopBD"></span>
          <span class="atDRTotal">DR Total</span>

        </div>
        <div class="armorsecondrow">
          <span class="atArmor">Armor</span>
          <span class="atC">c</span>
          <span class="atP">p</span>
          <span class="atB">b</span>
          <span class="atE">e</span>
          <span class="atBD">BD</span>
          <span class="attc">c</span>
          <span class="attp">p</span>
          <span class="attb">b</span>
          <span class="atte">e</span>

          <span class="atAPM">AP Mod</span>
          <span class="atStealth">Stealth</span>
          <span class="atLocation">Location / Other</span>
        </div>



        <fieldset class="repeating_armor">
          <div class="armor-fillinrepeating">
            <input type="text" name="attr_atArmor" value="">
            <input type="text" name="attr_atC" value="">
            <input type="text" name="attr_atP" value="">
            <input type="text" name="attr_atB" value="">
            <input type="text" name="attr_atE" value="">
            <input type="text" name="attr_atBD" value="">
            <input type="text" name="attr_attC" value="">
            <input type="text" name="attr_attP" value="">
            <input type="text" name="attr_attB" value="">
            <input type="text" name="attr_attE" value="">
            <input type="text" name="attr_atfAPM" value="">
            <input type="text" name="attr_atfStealth" value="">
            <input type="text" name="attr_atfLocation" value="">
          </div>
        </fieldset>
      </div>


</div>
<!-- Spells -->


            <!-- sheet buttons other tabs -->



<script type="text/worker">
    on("change:agility change:wit sheet:opened", function () {
        getAttrs([
            "agility", "wit"
        ], function (values) {
            // Reflex
            let ag = +values.agility || 0;
            let wt = +values.wit || 0;
            let total = ag + wt;
            setAttrs({reflex: total});
        });
    });

    on("change:agility change:wit sheet:opened", function () {
        getAttrs([
            "agility", "wit"
        ], function (values) {
            // Action Points
            let ag = +values.agility || 0;
            let wt = +values.wit || 0;
            let total = 4 + ag + wt;
            setAttrs({actionpoints: total});
        });
    });

    on("change:strength change:agility sheet:opened", function () {
        getAttrs([
            "strength", "agility"
        ], function (values) {
            // Knockdown
            let st = +values.strength || 0;
            let ag = +values.agility || 0;
            let total = st + ag;
            setAttrs({knockdown: total});
        });
    });

    on("change:toughness change:willpower sheet:opened", function () {
        getAttrs([
            "toughness", "willpower"
        ], function (values) {
            // Knockout
            let tg = +values.toughness || 0;
            let wp = +values.willpower || 0;
            let total = tg + wp;
            setAttrs({knockout: total});
        });
    });

    on("change:strength change:size sheet:opened", function () {
        getAttrs([
            "strength", "size"
        ], function (values) {
            // Power
            let st = +values.strength || 0;
            let sz = +values.size || 0;
            let total = st + sz;
            setAttrs({power: total});
        });
    });

    on("change:toughness change:size sheet:opened", function () {
        getAttrs([
            "toughness", "size"
        ], function (values) {
            // Body
            let tg = +values.toughness || 0;
            let sz = +values.size || 0;
            let total = tg + sz;
            setAttrs({body: total});
        });
    });

    on("change:agility change:size sheet:opened", function () {
        getAttrs([
            "agility", "size"
        ], function (values) {
            // Move
            let ag = +values.agility || 0;
            let sz = +values.size || 0;
            let total = 5 + ag + sz;
            setAttrs({movement: total});
        });
    });

    on("change:size sheet:opened", function () {
        getAttrs(["size"], function (values) {
            // Ranged DC Still
            let sz = +values.size || 0;
            let total = 9 - sz;
            setAttrs({rangedcstill: total});
        });
    });

    on("change:size sheet:opened", function () {
        getAttrs(["size"], function (values) {
            // Ranged DC Moving
            let sz = +values.size || 0;
            let total = 12 - sz;
            setAttrs({rangedcmoving: total});
        });
    });

    on("change:perception sheet:opened", function () {
        getAttrs(["perception"], function (values) {
            // Passive Perception
            let pr = +values.perception || 0;
            let total = 7 + pr + pr;
            setAttrs({passiveperception: total});
        });
      });

      on("change:repeating_armor:armortablebody change:repeating_armor:armorvalue sheet:opened", function () {
          getAttrs(["repeating_armor_armorvalue",
          "repeating_armor_armortablebody"], function (values) {
              // DR calculations
              let columnbody = +values.repeating_armor_armortablebody || 0;
              let columnav = +values.repeating_armor_armorvalue || 0;
              let total = columnbody + columnav;
              setAttrs({repeating_armor_damagereduction: total});
          });
    });
</script>
