<!-- ED4 Character Sheet v2.3 Last update: 8-22-2018
Author: Dougansf -->
<script>
    on('change:PD_Base change:PD_Mod change:ShPD change:Stance change:Blindside change:Cover change:Harried change:Overwhelmed change:Prone change:Surprised' ,function(eventinfo){
      getAttrs(['PD_Base','PD_Mod','ShPD','Stance','Blindside','Cover','Harried','Overwhelmed','Prone','Surprised'],function(values){
        setAttrs({
          PD: (values.PD_Base + values.PD_Mod + values.ShPD + values.Stance + values.Blindside + values.Cover + values.Harried + values.Overwhelmed + values.Prone + values.Surprised)
      });
    });
    on('change:PA_Base change:PA_Mod change: ArmorPA' ,function(eventinfo){
      getAttrs(['PA_Base','PA_Mod','ArmorPA'],function(values){
        setAttrs({
          PA: (values.PA_Base + values.PA_Mod + values.ArmorPA)
      });
    });
    on('change:MD_Base change:MD_Mod change:ShMD change:Stance change:Blindside change:Cover change:Harried change:Overwhelmed change:Prone change:Surprised' ,function(eventinfo){
      getAttrs(['MD_Base','MD_Mod','ShMD','Stance','Blindside','Cover','Harried','Overwhelmed','Prone','Surprised'],function(values){
        setAttrs({
          MD: (values.MD_Base + values.MD_Mod + values.ShMD + values.Stance + values.Blindside + values.Cover + values.Harried + values.Overwhelmed + values.Prone + values.Surprised)
      });
    });
    on('change:MA_Base change:MA_Mod change:ArmorMA' ,function(eventinfo){
      getAttrs(['MA_Base','MA_Mod','ArmorMA'],function(values){
        setAttrs({
          MA: (values.MA_Base + values.MA_Mod + values.ArmorMA)
      });
    });
    on('change:SD_Base change:SD_Mod' ,function(eventinfo){
      getAttrs(['SD_Base','SD_Mod'],function(values){
        setAttrs({
          SD: (values.SD_Base + values.SD_Mod)
      });
    });
    on('change:ShPD_Base change:ShieldWorn change:ShieldChecked' ,function(eventinfo){
      getAttrs(['ShPD_Base','ShieldWorn','ShieldChecked'],function(values){
        setAttrs({
          ShPD: ((values.ShPD_Base * values.ShieldWorn) * values.ShieldChecked)
      });
    });
    on('change:ShMD_Base change:ShieldWorn change:ShieldChecked' ,function(eventinfo){
      getAttrs(['ShMD_Base','ShieldWorn','ShieldChecked'],function(values){
        setAttrs({
          ShMD: ((values.ShMD_Base * values.ShieldWorn) * values.ShieldChecked)
      });
    });
    });
</script>
<table style="width: 730px; height: 50px; background-color: #FFFFFF;" border="4" cellpadding="3">
    <!-- Banner -->
    <tbody>
        <tr style="background-color: #f3e5d8;">
            <td style="width: 11%">
                <strong>
                     Name
                </strong>
            </td>
            <td style="width: 15%">
                <input style="width: 125px;" name="attr_Name" type="text" />
            </td>
            <td style="width: 11%">
                <strong>
                     Damage
                </strong>
            </td>
            <td style="width: 20%; text-align: center; ">
                <input name="attr_Uncon" type="number" value="0" style="width: 50px;"/>
            </td>
            <td style="width: 10%; vertical-align: middle;">
                <strong>Wounds</strong>
            </td>
            <td style="width: 10%; vertical-align: middle; text-align: center;">
                <input name="attr_Wounds" type="number" value="0" style="width: 50px;"/>
            </td>
            <td style="width: 7%; background-color: #d9d9d9;">
            </td>
            <td style="width: 8%; vertical-align: bottom; text-align: center; background-color: #d9d9d9;">
                <strong>
                     DEFENSE
                </strong>
            </td>
            <td style="width: 8%; vertical-align: bottom; text-align: center; background-color: #d9d9d9;">
                <strong>
                     ARMOR
                </strong>
            </td>
        </tr>
        <tr>
            <td style="vertical-align: top; text-align: left">
                <strong>
                     Movement
                </strong> <br/>
                <select class="Metric" name="attr_Metric" style= "width: 65px;">
                    <option value="Yards">
                        Yards
                    </option>
                    <option value="Meters">
                        Meters
                    </option>
                    <option value="Hexes">
                        Hexes
                    </option>
                </select>
            </td>
            <td style= "vertical-align: top; text-align: center;">
                <strong>
                    Base / Current
                </strong> <br/>
                <input name="attr_Movement_max" type="number" value="12"/>
                <strong>/</strong>
                <input name="attr_Movement" type="number" value="12"/>
            </td>
            <td>
                <strong>
                     Wound Threshold
                </strong>
            </td>
            <td style="vertical-align: middle; text-align: center;">
                <strong>
                    Base / Current
                </strong> <br/>
                <input name="attr_WoundThresh_max" type="number" value="7" style="width: 40px;"/>
                <strong>/</strong>
                <input name="attr_WoundThresh" type="number" value="7" style="width: 40px;"/>
            </td>
            <td>
                <strong>
                     Knockdown Threshold
                </strong>
            </td>
            <td style="vertical-align: middle; text-align: center;">
                <input disabled="disabled" name="attr_KDThresh" type="number" value="(@{WoundThresh}+5)" />
            </td>           
            <td style="vertical-align: middle; text-align: right; background-color: #d9d9d9;">
                <strong>
                     PHYSICAL
                </strong>
            </td>
            <td style="vertical-align: middle; text-align: center; background-color: #d9d9d9;">
                <input disabled name="attr_PD" type="number" value="(@{PD_Base}+@{PD_Mod}+@{ShPD}+@{DefConditions})" />
            </td>
            <td style="vertical-align: middle; text-align: center; background-color: #d9d9d9;">
                <input disabled="disabled" name="attr_PA" type="number" value="(@{PA_Base}+@{PA_Mod}+@{ArmorPA})" />
            </td>
        </tr>
        <tr style="background-color: #f3e5d8;">
            <td>
                <strong>
                     Karma Pool
                </strong>
            </td>
            <td style="text-align: center;">
                <strong>Max / Current</strong> <br/>
                <input style="background-color: #d9d9d9;" name="attr_Karma_max" type="number" value="5" style="width: 40px;"/>
                <strong>/</strong>
                <input style="background-color: #99ceff;" name="attr_Karma" type="number" value="5" style="width: 40px;"/>
                    <button name="roll_Karma" type="roll" value="!power {{
--format|gold
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Karma**
--Spent|[[ ?{Karma #|1} ]] Karma
--Result|** [[ [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
}}">
                    </button>
            </td>
            <td>
                <strong>
                     Unconcious Rating
                </strong>
            </td>
            <td style="vertical-align: middle; text-align: center;">
                <strong>
                    Base / Current
                </strong> <br/>
                <input name="attr_UnconBase" type="number" value="20" style="width: 45px;"/>
                <strong>/</strong>
                <input name="attr_Uncon_max" type="number" value="20" style="width: 45px;"/>
            </td>
            <td>
                <strong>
                     Resist Knockdown
                </strong>
            </td>
            <td style="vertical-align: middle; text-align: center;">
                <input name="attr_ResistKD" type="number" value="5" style="width: 40px;"/>
                <span style="background-color: #ff0000;">
                    <button name="roll_ResistKD" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Resist Knockdown**
--leftsub|vs ?{Damage Taken|@{KDThresh}} Damage
--Step|[[ ?{Step|@{ResistKD}+@{StrMod}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|[^Result.base]
--Successes|[[ floor(([$Result] { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - (?{Damage Taken}-@{WoundThresh}) ) /5)+1 ]]
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                </span>
            </td>
            <td style="vertical-align: middle; text-align: right; background-color: #d9d9d9;">
                <strong>
                     MYSTIC
                </strong>
            </td>
            <td style="vertical-align: middle; text-align: center; background-color: #d9d9d9;">
                <input disabled="disabled" name="attr_MD" type="number" value="(@{MD_Base}+@{MD_Mod}+@{ShMD}+@{DefConditions})" />
            </td>
            <td style="vertical-align: middle; text-align: center; background-color: #d9d9d9;">
                <input disabled="disabled" name="attr_MA" type="number" value="(@{MA_Base}+@{MA_Mod}+@{ArmorMA})" />
            </td>
        </tr>
        <tr>
            <td style="vertical-align: middle;">
                <strong>
                     Initiative
                </strong>
            </td>
            <td style="vertical-align: middle; text-align: center;">
                <br/>
                <input disabled="disabled" name="attr_InitTotal" type="number" value="(@{DexStep}+@{DexMod}+@{InitMod}-@{ArmorMod})" />
                &nbsp; &nbsp;
                <span style="background-color: #ff0000;">
                    <strong>
                        <button name="roll_InitStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Initiative**
--Step|[[ ?{Step|@{InitTotal}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [TRKR] [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                        </button>
                    </strong>
                </span>
                <p>
                    <hidden name="attr_GroupInitiative" value="[[ [[{1e3, 8}<[[{@{InitTotal}-@{Wounds} - 11, 0}kh1 % 11]] + floor([[{@{InitTotal}-@{Wounds} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{@{InitTotal}-@{Wounds}, 0}kh1 % 11]] + {1, 3}=[[{@{InitTotal}-@{Wounds}, 0}kh1]] + {1e3, 3}=[[{@{InitTotal}-@{Wounds} - 11, 0}kh1 % 11]] * 2]]d[[{{(@{InitTotal}-@{Wounds} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{@{InitTotal}-@{Wounds}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{InitTotal}-@{Wounds}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{InitTotal}-@{Wounds}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{@{InitTotal}-@{Wounds}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{@{InitTotal}-@{Wounds}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{InitTotal}-@{Wounds}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{InitTotal}-@{Wounds}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{@{InitTotal}-@{Wounds}, 0}kh1]] * (3 - [[{@{InitTotal}-@{Wounds}, 0}kh1]])]] ]]">
                </p>
            </td>
            <td style="vertical-align: middle;">
                <strong>
                     Death Rating
                </strong>
            </td>
            <td style="vertical-align: middle; text-align: center;">
                <strong>
                    Base / Current
                </strong> <br/>
                <input name="attr_Death" type="number" value="25" style="width: 45px;"/>
                <strong>/</strong>
                <input name="attr_Death_max" type="number" value="25" style="width: 45px;"/>
            </td>
            <td style="vertical-align: middle;">
                <strong>
                    Jump Up
                </strong>
            </td>
            <td style="vertical-align: middle; text-align: center;">
                <span style="background-color: #ff0000;">
                    <strong>
                        <button name="roll_JumpUp" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Jump Up**
--Step|[[ ?{Step|@{DexStep}+@{DexMod}+@{ActionMod}-@{Wounds}-@{ArmorMod}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|2} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]** vs TN 6
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>            </td>
            <td style="vertical-align: middle; text-align: right; background-color: #d9d9d9;">
                <strong>
                     SOCIAL
                </strong>
            </td>
            <td style="text-align: center; background-color: #d9d9d9;">
                <input disabled="disabled" name="attr_SD" type="number" value="(@{SD_Base}+@{SD_Mod})" />
            </td>
            <td style="background-color: #d9d9d9;">
            </td>
        </tr>
    </tbody>
</table>
<h4>
</h4>
<table style="width: 730px; background-color: #FFFFFF;" border="4" cellpadding="2">
    <tbody>
        <tr style="background-color: #f3e5d8;">
            <td style="width: 110px;">
                <strong>ACTION MODIFIER</strong>
            </td>
            <td style="text-align: center; background-color: #FFFFFF;">
                <input name="attr_ActionMod" type="number" value="0" style= "width: 41px" />
            </td>
            <td style="text-align: center;">
                <strong>SHIELD</strong> <br/>
            </td>
            <td style="text-align: center;" colspan="6">
                <strong>CONDITIONS</strong>
            </td>
        </tr>
        <tr style="background-color: #f3e5d8;">
            <td style="text-align: left; width: 70px;" rowspan="2">
                <strong>DEFENSE MODIFIERS</strong>
            </td>
                <input type="hidden" name="attr_DefConditions" value="(@{Stance}+@{Blindside}+@{Cover}+@{Harried}-@{Overwhelmed}+@{Prone}+@{Surprised})" />

        </tr>
        <tr style="height: 10px">
            <td style="text-align: center;">
                <strong>Stance</strong> <br/>
                <select class="Stance" name="attr_Stance" style= "width: 98px; height: 27px">
                    <option value="0">
                        Standard
                    </option>
                    <option value="-3">
                        Aggressive
                    </option>
                    <option value="3">
                        Defensive
                    </option>
                </select>
            </td>
            <td style="text-align: center;">
                <strong>Used</strong> <br/>
                <input type="checkbox"  name='attr_ShieldChecked' value='1' checked />
                <input type='hidden' name='attr_ShPD' value='(@{ShieldPD}*@{ShieldChecked})'  />
                <input type='hidden' name='attr_ShMD' value='(@{ShieldMD}*@{ShieldChecked})' />
            </td>
            <td style="text-align: center;">
                <strong>Blindside</strong> <br/>
                <input type="checkbox"  name='attr_Blindside' value='-2' />
            </td>
            <td style="text-align: center;">
                <strong>Cover</strong> <br/>
                <input type="checkbox"  name='attr_Cover' value='2' />
            </td>
            <td style="text-align: center;">
                <strong>Harried</strong> <br/>
                <input type="checkbox"  name='attr_Harried' value='-2'  />
            </td>
            <td style="text-align: center;">
                <strong>Overwhelmed</strong> <br/>
                <input type="number" name="attr_Overwhelmed" value="0" />
            </td>
            <td style="text-align: center;">
                <strong>Knocked Down</strong> <br/>
                <input type="checkbox"  name='attr_Prone' value='-3'  />
            </td>
            <td style="text-align: center;">
                <strong>Surprised</strong> <br/>
                <input type="checkbox"  name='attr_Surprised' value='-3' />
            </td>            
        </tr>
    </tbody>
</table>
<!-- Banner -->
<p></p>
<div>
    <!-- Tab Setup -->
    <input type="radio" class="sheet-tab sheet-tab1" name="attr_core-tab" value="1" title="Attributes" checked="checked"/> 
    <span class="sheet-tab sheet-tab1" style='line-height: 20px;'>ATTRIBUTES</span>
    <input type="radio" class="sheet-tab sheet-tab2" name="attr_core-tab" value="2" title="Talents" /> 
    <span class="sheet-tab sheet-tab2" style='line-height: 20px;'>TALENTS</span>
    <input type="radio" class="sheet-tab sheet-tab3" name="attr_core-tab" value="3" title="Skills" /> 
    <span class="sheet-tab sheet-tab3" style='line-height: 20px;'>SKILLS</span>
    <input type="radio" class="sheet-tab sheet-tab4" name="attr_core-tab" value="4" title="Knacks" /> 
    <span class="sheet-tab sheet-tab4" style='line-height: 20px;'>KNACKS</span>
    <input type="radio" class="sheet-tab sheet-tab6" name="attr_core-tab" value="6" title="Equipment" /> 
    <span class="sheet-tab sheet-tab6" style='line-height: 20px;'>EQUIPMENT</span>
    <input type="radio" class="sheet-tab sheet-tab9" name="attr_core-tab" value="9" title="Treasury" /> 
    <span class="sheet-tab sheet-tab9" style='line-height: 20px;'>TREASURY</span>
    <p></p>
    <input type="radio" class="sheet-tab sheet-tab5" name="attr_core-tab" value="5" title="Questor" /> 
    <span class="sheet-tab sheet-tab5" style='line-height: 20px;'>QUESTOR</span>
    <input type="radio" class="sheet-tab sheet-tab7" name="attr_core-tab" value="7" title="Matrixes" /> 
    <span class="sheet-tab sheet-tab7" style='line-height: 20px;'>MATRIXES</span>
    <input type="radio" class="sheet-tab sheet-tab8" name="attr_core-tab" value="8" title="Grimoire" /> 
    <span class="sheet-tab sheet-tab8" style='line-height: 20px;'>GRIMOIRE</span>

    <input type="radio" class="sheet-tab sheet-tab10" name="attr_core-tab" value="10" title="NPC" /> 
    <span class="sheet-tab sheet-tab10" style='line-height: 20px;'>NPC</span>
    <!-- End Tab Setup -->
<div class="sheet-section-attributes"><!-- Attributes Tab -->
<p></p>
<table style="width: 725px; height: 250px;" cellpadding="0"> <!-- Attributes & Defenses table -->
    <tbody>
        <tr>
            <td style="vertical-align: top;">
                <table style="width: 355px; height: 100%; background-color: #FFFFFF;" border="5" cellpadding="3"> <!-- Attributes Table -->
                <tbody>
                    <tr style="background-color: #f3e5d8;">
                        <td style="vertical-align: bottom; text-align: center; height:15px; width: 22%">
                            <blockquote>
                                <strong>
                                    ATTRIBUTES
                                </strong>
                            </blockquote>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 20%">
                            <blockquote>
                                <strong>
                                    VALUE
                                </strong>
                            </blockquote>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 20%" colspan="2">
                            <blockquote>
                                <strong>
                                    STEP
                                </strong>
                            </blockquote>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 30%">
                            <blockquote>
                                <strong>
                                    ROLL
                                </strong>
                            </blockquote>
                        </td>
                    </tr>
                    <tr>
                        <td style="vertical-align: bottom; text-align: left; height:15px">
                            <strong>
                                Dexterity
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center;">
                            <input name="attr_DexVal" type="number" value="10" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: bottom; text-align: center;">
                            <strong>Base</strong> <br/>
                            <input name="attr_DexStep" type="number" value="5" style="width: 35px;"/>
                        </td>
                        <td style="vertical-align: bottom; text-align: center;">
                            <strong>Modifier</strong> <br/>
                            <input name="attr_DexMod" type="number" value="0" style="width: 35px;"/>
                        </td>
                        <td style="vertical-align: bottom; text-align: center;">
                            Public / GM <br/>
                            <span style="background-color: #ff0000;">
                                <strong>
                                    <button name="roll_DexStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Dexterity**
--Step|[[ ?{Step|@{DexStep}+@{DexMod}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            <span style="background-color: #f4c542;">
                                <strong>
                                    <button name="roll_GMDexStep" type="roll" value="/w gm @{Name} Dexterity
!power {{
--whisper|GM
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Dexterity**
--Step|[[ ?{Step|@{DexStep}+@{DexMod}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                        </td>
                    </tr>
                    <tr style="background-color: #f3e5d8;">
                        <td style="text-align: left;">
                            <strong>
                                Strength
                            </strong>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_StrVal" type="number" value="10" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_StrStep" type="number" value="5" style="width: 35px;"/>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_StrMod" type="number" value="0" style="width: 35px;"/>
                        </td>
                        <td style="text-align: center;">
                            <span style="background-color: #ff0000;">
                                <strong>
                                    <button name="roll_StrStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Strength**
--Step|[[ ?{Step|@{StrStep}+@{StrMod}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            <span style="background-color: #f4c542;">
                                <strong>
                                    <button name="roll_GMStrStep" type="roll" value="/w gm @{Name} Strength
!power {{
--whisper|GM
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Strength**
--Step|[[ ?{Step|@{StrStep}+@{StrMod}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>
                                Toughness
                            </strong>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_TouVal" type="number" value="10" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_TouStep" type="number" value="5" style="width: 35px;"/>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_TouMod" type="number" value="0" style="width: 35px;"/>
                        </td>
                        <td style="text-align: center;">
                            <span style="background-color: #ff0000;">
                                <strong>
                                    <button name="roll_TouStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Toughness**
--Step|[[ ?{Step|@{TouStep}+@{TouMod}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            <span style="background-color: #f4c542;">
                                <strong>
                                    <button name="roll_GMTouStep" type="roll" value="/w gm @{Name} Toughness
!power {{
--whisper|GM
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Toughness**
--Step|[[ ?{Step|@{TouStep}+@{TouMod}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                        </td>
                    </tr>
                    <tr style="background-color: #f3e5d8;">
                        <td style="text-align: left;">
                            <strong>
                                Perception
                            </strong>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_PerVal" type="number" value="10" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_PerStep" type="number" value="5" style="width: 35px;"/>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_PerMod" type="number" value="0" style="width: 35px;"/>
                        </td>
                        <td style="text-align: center;">
                            <span style="background-color: #ff0000;">
                                <strong>
                                    <button name="roll_PerStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Perception**
--Step|[[ ?{Step|@{PerStep}+@{PerMod}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            <span style="background-color: #f4c542;">
                                <strong>
                                    <button name="roll_GMPerStep" type="roll" value="/w GM @{Name} Perception
!power {{
--whisper|GM
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Perception**
--Step|[[ ?{Step|@{PerStep}+@{PerMod}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>
                                Willpower
                            </strong>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_WilVal" type="number" value="10" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_WilStep" type="number" value="5" style="width: 35px;"/>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_WilMod" type="number" value="0" style="width: 35px;"/>
                        </td>
                        <td style="text-align: center;">
                            <span style="background-color: #ff0000;">
                                <strong>
                                    <button name="roll_WilStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Willpower**
--Step|[[ ?{Step|@{WilStep}+@{WilMod}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            <span style="background-color: #f4c542;">
                                <strong>
                                    <button name="roll_GMWilStep" type="roll" value="/w gm @{Name} Willpower
!power {{
--whisper|GM
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Willpower**
--Step|[[ ?{Step|@{WilStep}+@{WilMod}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                        </td>
                    </tr>
                    <tr style="background-color: #f3e5d8;">
                        <td style="text-align: left;">
                            <strong>
                                Charisma
                            </strong>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_ChaVal" type="number" value="10" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_ChaStep" type="number" value="5" style="width: 35px;"/>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_ChaMod" type="number" value="0" style="width: 35px;"/>
                        </td>
                        <td style="text-align: center;">
                            <span style="background-color: #ff0000;">
                                <strong>
                                    <button name="roll_ChaStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Charisma**
--Step|[[ ?{Step|@{ChaStep}+@{ChaMod}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            <span style="background-color: #f4c542;">
                                <strong>
                                    <button name="roll_GMChaStep" type="roll" value="/w gm @{Name} Charisma
!power {{
--whisper|GM
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Charisma**
--Step|[[ ?{Step|@{ChaStep}+@{ChaMod}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>
                                Initiative
                            </strong>
                        </td>
                        <td style="text-align: center; vertical-align: bottom">
                            <strong>
                                Penalty
                            </strong>
                            <input disabled name="attr_ArmorMod" type="number" value="(@{ArmorInitMod}+@{ShieldInitMod})" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center; vertical-align: bottom">
                            <strong>
                                Karma?
                            </strong>
                            <select class="Metric" name="attr_Metric" style= "width: 57px; height: 23px">
                                <option value="No">
                                    No
                                </option>
                                <option value="Yes">
                                    Yes
                                </option>
                            </select>
                        </td>
                        <td style="text-align: center; vertical-align: bottom">
                            <input name="attr_InitMod" type="number" value="0" style="width: 35px;"/>
                        </td>
                        <td style="text-align: center;">
                            <span style="background-color: #ff0000;">
                                <strong>
                                    <button name="roll_InitStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Initiative**
--Step|[[ ?{Step|@{InitTotal}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [TRKR] [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td style="vertical-align: top;"> <!-- Defenses Table -->
            <table style="width: 360px; height: 100%; float: left; background-color: #FFFFFF;" border="5" cellpadding="3">
            <tbody>
                <tr style="background-color: #f3e5d8;">
                    <td style="width: 22%;">
                    </td>
                    <td style="vertical-align: bottom; text-align: center; height:15px" colspan="2">
                        <strong>
                            DEFENSE
                        </strong>
                    </td>
                    <td style="vertical-align: bottom; text-align: center; width: 40%" colspan="2">
                        <strong>
                            ARMOR
                        </strong>
                    </td>
                </tr>
                <tr>
                    <td style="vertical-align: bottom; text-align: right; height:15px">
                        <strong>
                            Physical
                        </strong>
                    </td>
                    <td style="vertical-align: bottom; text-align: center; width: 17%;">
                        <strong>Base</strong> <br/>
                        <input name="attr_PD_Base" type="number" value="6" style="width: 41px;"/>
                    </td>
                    <td style="vertical-align: bottom; text-align: center; width: 20%;">
                        <strong>Modifier</strong> <br/>
                        <input name="attr_PD_Mod" type="number" value="0" style="width: 45px;"/>
                    </td>
                    <td style="vertical-align: bottom; text-align: center; width: 23%;">
                        <strong>Base</strong> <br/>
                        <input name="attr_PA_Base" type="number" value="0" style="width: 41px;"/>
                    </td>
                    <td style="vertical-align: bottom; text-align: center; width: 21%;">
                        <strong>Modifier</strong> <br/>
                        <input name="attr_PA_Mod" type="number" value="0" style="width: 45px;"/>
                    </td>
                </tr>
                <tr style="background-color: #f3e5d8;">
                    <td style="vertical-align: center; text-align: right;">
                        <strong>
                            Mystic
                        </strong>
                    </td>
                    <td style="text-align: center;">
                        <input name="attr_MD_Base" type="number" value="6" style="width: 41px;"/>
                    </td>
                    <td style="text-align: center;">
                        <input name="attr_MD_Mod" type="number" value="0" style="width: 45px;"/>
                    </td>
                    <td style="text-align: center;" />
                        <input name="attr_MA_Base" type="number" value="2" style="width: 41px;"/>
                    </td>
                    <td style="text-align: center;">
                        <input name="attr_MA_Mod" type="number" value="0" style="width: 45px;"/>
                    </td>
                </tr>
                <tr>
                    <td style="vertical-align: center; text-align: right;">
                        <strong>
                            Social
                        </strong>
                    </td>
                    <td style="text-align: center;">
                        <input name="attr_SD_Base" type="number" value="6" style="width: 41px;"/>
                    </td>
                    <td style="text-align: center;">
                        <input name="attr_SD_Mod" type="number" value="0" style="width: 45px;"/>
                    </td>
                    <td style="vertical-align: middle;">
                        <strong>
                            Blood Magic
                        </strong>
                    </td>
                    <td style="vertical-align: middle; text-align: center;">
                        <input name="attr_BloodMagic" type="number" value="0" style="width: 40px;"/>
                    </td>
                </tr>
                <tr style="background-color: #f3e5d8;">
                    <td>
                        <strong>
                            Race
                        </strong>
                    </td>
                    <td colspan="2">
                        <input name="attr_Race" type="text" style="width:100px;"/>
                    </td>
                    <td>
                        <strong>
                            Karma Step
                        </strong>
                    </td>
                    <td style="width: 50px; vertical-align: center; text-align: center;">
                        <input name="attr_KarmaStep" type="number" value="4" style="width: 41px;"/>
                    </td>
                </tr>
                <tr>
                    <td>
                        <strong>
                            Discipline 1
                        </strong>
                    </td>
                    <td colspan="2">
                        <input name="attr_Discipline1" type="text" style="width:100px"/>
                    </td>
                    <td>
                        <strong>
                            Circle
                        </strong>
                    </td>
                    <td style="width: 50px; vertical-align: center; text-align: center;">
                        <input name="attr_Dis1Circle" type="number" value="1" style="width: 41px;"/>
                    </td>
                </tr>
                <tr style="background-color: #f3e5d8;">
                    <td>
                        <strong>
                            Discipline 2
                        </strong>
                    </td>
                    <td colspan="2">
                        <input name="attr_Discipline2" type="text" style="width:100px"/>
                    </td>
                    <td>
                        <strong>
                            Circle
                        </strong>
                    </td>
                    <td style="vertical-align: center; text-align: center;">
                        <input name="attr_Dis2Circle" type="number" value="0" style="width: 41px;"/>
                    </td>
                </tr>
                <tr>
                    <td style="vertical-align: middle;">
                        <strong>
                            Recovery
                        </strong>
                    </td>
                    <td style="text-align: center; vertical-align: bottom;">
                        <strong>
                            Per Day
                        </strong>
                        <input name="attr_Recovery_max" type="number" value="1" style="width: 41px;"/>
                    </td>
                    <td style="text-align: center; vertical-align: bottom;">
                        <strong>
                            Current
                        </strong>
                        <input name="attr_Recovery" type="number" value="1" style="width: 41px;"/>
                    </td>
                    <td style="text-align: center; vertical-align: bottom;">
                        <strong>
                            Karma?
                        </strong>
                        <select class="RecoveryKarma" name="attr_RecoveryKarma" style= "width: 57px; height: 23px">
                            <option value="No">
                                No
                            </option>
                            <option value="Yes">
                                Yes
                            </option>
                        </select>
                    </td>
                    <td style="text-align: center; vertical-align: middle;">
                        <span style="background-color: #ff0000;">
                            <button name="roll_Recovery" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Recovery**
--Step|[[ ?{Step|@{TouStep}+@{TouMod}+@{ActionMod}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Damage Healed|[[ {1d1, ceil(( { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - ?{Wounds|@{Wounds}}) ) }kh1 ]]
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
--Recovery|-1
}}">
                            </button>
                        </span>
                    </td>
                </tr>
            </tbody>
        </table>
    </td>
</tr>
</tbody>
</table>
<p></p>
<h3>Special Abilities</h3>
<fieldset class="repeating_specials">
<table style="width: 725px; height: 50px;" border="1">
<tbody>
    <tr>
        <td>
            <table style="width: 100%; height: 100%; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="2">
                <tbody>
                    <tr>
                        <td style="text-align: left; vertical-align: top; width: 70px">
                            <strong>
                                EFFECT
                            </strong>
                        </td>
                        <td style="vertical-align: top;">
                            <textarea class="text-input-noback" style="width:90%; height:20px" name="attr_SpecialEffect"></textarea>
                        </td>
                        <td style="text-align: left; vertical-align: top; width: 70px">
                            <strong>
                                SOURCE
                            </strong>
                        </td>
                        <td style="vertical-align: top;">
                            <textarea class="text-input-noback" style="width:90%; height:20px" name="attr_SpecialSource"></textarea>
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
    </tr>
</tbody>
</table>
</fieldset>
</div>
<div class="sheet-section-talents"> <!-- Talents Tab -->
<p></p>
<fieldset class="repeating_talents">
<table style="width: 725px; height: 100px;" border="1">
<tbody>
    <tr>
        <td>
            <table style="width: 100%; height: 100%; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="1">
                <tbody>
                    <tr style="background-color: #ffa31a;">
                        <td style="text-align: left; vertical-align: bottom; width: 140px;">
                            <strong>
                                TALENT
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                STEP
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                RANK
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                BONUS
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                ATTR
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                STRAIN
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 70px">
                            <strong>
                                ACTION
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 75px">
                            <strong>
                                Vs DEFENSE
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 170px">
                            <strong>
                                DURATION
                            </strong>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left; vertical-align: top;">
                            <input name="attr_TalentName" type="text" style= "width: 135px"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input disabled="disabled" name="attr_TalentStep" type="number" value="@{AttrStep}+@{TalentRank}+@{TalentBonus}" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_TalentRank" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_TalentBonus" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: left;">
                            <select class="AttrStep" name="attr_AttrStep" style= "width: 63px">
                                <option value="0">
                                    None
                                </option>
                                <option value="@{DexStep}+@{DexMod}">
                                    DEX
                                </option>
                                <option value="@{StrStep}+@{StrMod}">
                                    STR
                                </option>
                                <option value="@{TouStep}+@{TouMod}">
                                    TOU
                                </option>
                                <option value="@{PerStep}+@{PerMod}">
                                    PER
                                </option>
                                <option value="@{WilStep}+@{WilMod}">
                                    WIL
                                </option>
                                <option value="@{ChaStep}+@{ChaMod}">
                                    CHA
                                </option>
                            </select>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_TalentStrain" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <select class="TalentAction" name="attr_TalentAction" style= "width: 90px">
                                <option value="Free">
                                    Free
                                </option>
                                <option value="Simple">
                                    Simple
                                </option>
                                <option value="Standard">
                                    Standard
                                </option>
                                <option value="Sustained">
                                    Sustained
                                </option>
                            </select>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <select class="TalentDefense" name="attr_TalentDefense" style= "width: 80px">
                                <option value="None">
                                    None
                                </option>
                                <option value="@{target|PD}">
                                    Physical
                                </option>
                                <option value="@{target|MD}">
                                    Mystic
                                </option>
                                <option value="@{target|SD}">
                                    Social
                                </option>
                            </select>
                        </td>
                        
                        <td style="vertical-align: top; text-align: center;" rowspan="2">
                                <input name="attr_TalentDurationNumber" type="number" style="vertical-align: top; width: 41px;" value="0">
                                <strong>+</strong>
                                <select class="TalentDurationRank" name="attr_TalentDurationRank" style= "width: 62px">
                                    <option value="0">
                                        Zero
                                    </option>
                                    <option value="@{TalentRank}">
                                        Rank
                                    </option>
                                </select>
                                <strong>=</strong><br/>
                                <input disabled="disabled" name="attr_TalentDurationTotal" type="number" style="vertical-align: top; width: 38px;" value="@{TalentDurationNumber}+@{TalentDurationRank}">
                                <select class="TalentDurationIncrement" name="attr_TalentDurationIncrement" style= "width: 77px">
                                    <option value="Rounds">
                                        Rounds
                                    </option>
                                    <option value="Minutes">
                                        Minutes
                                    </option>
                                    <option value="Hours">
                                        Hours
                                    </option>
                                    <option value="Days">
                                        Days
                                    </option>
                                </select>
                            </td>
                    </tr>
                    <tr>
                        <td style="vertical-align: top; text-align: center;">
                            Public / GM Only / Target<br/>
                            <span style="background-color: #ff0000;">
                                <button name="roll_TalentStep" type="roll" value="!power {{
--format|gold
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{TalentName}**
--Step|[[ ?{Step|@{TalentStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{TalentStrain}} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--?? @{TalentDurationTotal} > 0 ?? Duration| @{TalentDurationTotal} @{TalentDurationIncrement}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            <span style="background-color: #f4c542;">
                                <button name="roll_TalentStepGM" type="roll" value="/w gm @{Name} @{TalentName}
!power {{
--whisper|GM
--format|gold
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{TalentName}**
--Step|[[ ?{Step|@{TalentStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{TalentStrain}} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--?? @{TalentDurationTotal} > 0 ?? Duration| @{TalentDurationTotal} @{TalentDurationIncrement}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            <span style="background-color: #004fce;">
                                <button name="roll_TalentTarget" type="roll" value="!power {{
--format|gold
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{TalentName}**
--leftsub|vs @{target|token_name}
--Step|[[ ?{Step|@{TalentStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{TalentStrain}} ]] Strain
--Result:|**[^Result.base]**
--Successes| [[ floor(([$Result] { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{TalentDefense}) / 5)+1 ]]
--?? @{TalentDurationTotal} > 0 ?? Duration| @{TalentDurationTotal} @{TalentDurationIncrement}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                        </td>
                        <td style="text-align: center; vertical-align: top;">
                            <strong>
                                NOTES
                            </strong>
                            <button name="roll_TalentDesc" type="roll" value="@{TalentName}: @{TalentDesc}">
                            </button>
                        </td>
                        <td style="text-align: left; vertical-align: top;" colspan="6" rowspan="1">
                            <textarea class="text-input-noback" style="width:90%; height:20px" name="attr_TalentDesc"></textarea>
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
    </tr>
</tbody>
</table>
</fieldset>
<p></p>
</div>
<div class="sheet-section-skills"> <!-- Skills Tab -->
<p></p>
<fieldset class="repeating_skills">
<table style="width: 725px; height: 100px;" border="1">
<tbody>
    <tr>
        <td>
            <table style="width: 100%; height: 100%; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="1">
                <tbody>
                    <tr style="background-color: #009900; color: #FFFFFF;">
                        <td style="text-align: left; vertical-align: bottom; width: 140px;">
                            <strong>
                                SKILL
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                STEP
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                RANK
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                BONUS
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                ATTR
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                STRAIN
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 70px">
                            <strong>
                                ACTION
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 75px">
                            <strong>
                                Vs DEFENSE
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 170px">
                            <strong>
                                DURATION
                            </strong>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left; vertical-align: top;">
                            <input name="attr_SkillName" type="text" style= "width: 135px"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input disabled="disabled" name="attr_SkillStep" type="number" value="@{AttrStep}+@{SkillRank}+@{SkillBonus}" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_SkillRank" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_SkillBonus" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: left;">
                            <select class="AttrStep" name="attr_AttrStep" style= "width: 63px">
                                <option value="0">
                                    None
                                </option>
                                <option value="@{DexStep}+@{DexMod}">
                                    DEX
                                </option>
                                <option value="@{StrStep}+@{StrMod}">
                                    STR
                                </option>
                                <option value="@{TouStep}+@{TouMod}">
                                    TOU
                                </option>
                                <option value="@{PerStep}+@{PerMod}">
                                    PER
                                </option>
                                <option value="@{WilStep}+@{WilMod}">
                                    WIL
                                </option>
                                <option value="@{ChaStep}+@{ChaMod}">
                                    CHA
                                </option>
                            </select>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_SkillStrain" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <select class="SkillAction" name="attr_SkillAction" style= "width: 90px">
                                <option value="Free">
                                    Free
                                </option>
                                <option value="Simple">
                                    Simple
                                </option>
                                <option value="Standard">
                                    Standard
                                </option>
                                <option value="Sustained">
                                    Sustained
                                </option>
                            </select>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <select class="SkillDefense" name="attr_SkillDefense" style= "width: 80px">
                                <option value="None">
                                    None
                                </option>
                                <option value="@{target|PD}">
                                    Physical
                                </option>
                                <option value="@{target|MD}">
                                    Mystic
                                </option>
                                <option value="@{target|SD}">
                                    Social
                                </option>
                            </select>
                        </td>
                        
                        <td style="vertical-align: top; text-align: center;" rowspan="2">
                                <input name="attr_SkillDurationNumber" type="number" style="vertical-align: top; width: 41px;" value="0">
                                <strong>+</strong>
                                <select class="SkillDurationRank" name="attr_SkillDurationRank" style= "width: 62px">
                                    <option value="0">
                                        Zero
                                    </option>
                                    <option value="@{SkillRank}">
                                        Rank
                                    </option>
                                </select>
                                <strong>=</strong><br/>
                                <input disabled="disabled" name="attr_SkillDurationTotal" type="number" style="vertical-align: top; width: 38px;" value="@{SkillDurationNumber}+@{SkillDurationRank}">
                                <select class="SkillDurationIncrement" name="attr_SkillDurationIncrement" style= "width: 77px">
                                    <option value="Rounds">
                                        Rounds
                                    </option>
                                    <option value="Minutes">
                                        Minutes
                                    </option>
                                    <option value="Hours">
                                        Hours
                                    </option>
                                    <option value="Days">
                                        Days
                                    </option>
                                </select>
                            </td>
                    </tr>
                    <tr>
                        <td style="vertical-align: top; text-align: center;">
                            Public / GM Only / Target<br/>
                            <span style="background-color: #ff0000;">
                                <button name="roll_SkillStep" type="roll" value="!power {{
--format|green
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SkillName}**
--Step|[[ ?{Step|@{SkillStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{SkillStrain}} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--?? @{SkillDurationTotal} > 0 ?? Duration| @{SkillDurationTotal} @{SkillDurationIncrement}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            <span style="background-color: #f4c542;">
                                <button name="roll_SkillStepGM" type="roll" value="/w gm @{Name} @{SkillName}
!power {{
--whisper|GM
--format|green
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SkillName}**
--Step|[[ ?{Step|@{SkillStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{SkillStrain}} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--?? @{SkillDurationTotal} > 0 ?? Duration| @{SkillDurationTotal} @{SkillDurationIncrement}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            <span style="background-color: #004fce;">
                                <button name="roll_SkillTarget" type="roll" value="!power {{
--format|green
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SkillName}**
--leftsub|vs @{target|token_name}
--Step|[[ ?{Step|@{SkillStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{SkillStrain}} ]] Strain
--Result:|**[^Result.base]**
--Successes| [[ floor(([$Result] { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{SkillDefense}) / 5)+1 ]]
--?? @{SkillDurationTotal} > 0 ?? Duration| @{SkillDurationTotal} @{SkillDurationIncrement}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                        </td>
                        <td style="text-align: center; vertical-align: top;">
                            <strong>
                                NOTES
                            </strong>
                            <button name="roll_SkillDesc" type="roll" value="@{SkillName}: @{SkillDesc}">
                        </td>
                        <td style="text-align: left; vertical-align: top;" colspan="6" rowspan="1">
                            <textarea class="text-input-noback" style="width:90%; height:20px" name="attr_SkillDesc"></textarea>
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
    </tr>
</tbody>
</table>
</fieldset>
<p></p>
</div>
<div class="sheet-section-knacks"> <!-- Knacks Tab -->
<p></p>
<fieldset class="repeating_knacks">
<table style="width: 725px; height: 100px;" border="1">
<tbody>
    <tr>
        <td>
            <table style="width: 100%; height: 100%; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="1">
                <tbody>
                    <tr style="background-color: #6D017C; color: #FFFFFF;">
                        <td style="text-align: left; vertical-align: bottom; width: 140px;">
                            <strong>
                                KNACK
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                STEP
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                RANK
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                BONUS
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                ATTR
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                STRAIN
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 70px">
                            <strong>
                                ACTION
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 75px">
                            <strong>
                                Vs DEFENSE
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 170px">
                            <strong>
                                DURATION
                            </strong>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left; vertical-align: top;">
                            <input name="attr_KnackName" type="text" style= "width: 135px"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input disabled="disabled" name="attr_KnackStep" type="number" value="@{AttrStep}+@{KnackRank}+@{KnackBonus}" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_KnackRank" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_KnackBonus" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: left;">
                            <select class="AttrStep" name="attr_AttrStep" style= "width: 63px">
                                <option value="0">
                                    None
                                </option>
                                <option value="@{DexStep}+@{DexMod}">
                                    DEX
                                </option>
                                <option value="@{StrStep}+@{StrMod}">
                                    STR
                                </option>
                                <option value="@{TouStep}+@{TouMod}">
                                    TOU
                                </option>
                                <option value="@{PerStep}+@{PerMod}">
                                    PER
                                </option>
                                <option value="@{WilStep}+@{WilMod}">
                                    WIL
                                </option>
                                <option value="@{ChaStep}+@{ChaMod}">
                                    CHA
                                </option>
                            </select>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_KnackStrain" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <select class="KnackAction" name="attr_KnackAction" style= "width: 90px">
                                <option value="Free">
                                    Free
                                </option>
                                <option value="Simple">
                                    Simple
                                </option>
                                <option value="Standard">
                                    Standard
                                </option>
                                <option value="Sustained">
                                    Sustained
                                </option>
                            </select>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <select class="KnackDefense" name="attr_KnackDefense" style= "width: 80px">
                                <option value="None">
                                    None
                                </option>
                                <option value="@{target|PD}">
                                    Physical
                                </option>
                                <option value="@{target|MD}">
                                    Mystic
                                </option>
                                <option value="@{target|SD}">
                                    Social
                                </option>
                            </select>
                        </td>
                        
                        <td style="vertical-align: top; text-align: center;" rowspan="2">
                                <input name="attr_KnackDurationNumber" type="number" style="vertical-align: top; width: 41px;" value="0">
                                <strong>+</strong>
                                <select class="KnackDurationRank" name="attr_KnackDurationRank" style= "width: 62px">
                                    <option value="0">
                                        Zero
                                    </option>
                                    <option value="@{KnackRank}">
                                        Rank
                                    </option>
                                </select>
                                <strong>=</strong><br/>
                                <input disabled="disabled" name="attr_KnackDurationTotal" type="number" style="vertical-align: top; width: 38px;" value="@{KnackDurationNumber}+@{KnackDurationRank}">
                                <select class="KnackDurationIncrement" name="attr_KnackDurationIncrement" style= "width: 77px">
                                    <option value="Rounds">
                                        Rounds
                                    </option>
                                    <option value="Minutes">
                                        Minutes
                                    </option>
                                    <option value="Hours">
                                        Hours
                                    </option>
                                    <option value="Days">
                                        Days
                                    </option>
                                </select>
                            </td>
                    </tr>
                    <tr>
                        <td style="vertical-align: top; text-align: center;">
                            Public / GM Only / Target<br/>
                            <span style="background-color: #ff0000;">
                                <button name="roll_KnackStep" type="roll" value="!power {{
--format|gold
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{KnackName}**
--Step|[[ ?{Step|@{KnackStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{KnackStrain}} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--?? @{KnackDurationTotal} > 0 ?? Duration| @{KnackDurationTotal} @{KnackDurationIncrement}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            <span style="background-color: #f4c542;">
                                <button name="roll_KnackStepGM" type="roll" value="/w gm @{Name} @{KnackName}
!power {{
--whisper|GM
--format|gold
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{KnackName}**
--Step|[[ ?{Step|@{KnackStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{KnackStrain}} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--?? @{KnackDurationTotal} > 0 ?? Duration| @{KnackDurationTotal} @{KnackDurationIncrement}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            <span style="background-color: #004fce;">
                                <button name="roll_KnackTarget" type="roll" value="!power {{
--format|gold
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{KnackName}**
--leftsub|vs @{target|token_name}
--Step|[[ ?{Step|@{KnackStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{KnackStrain}} ]] Strain
--Result:|**[^Result.base]**
--Successes| [[ floor(([$Result] { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{KnackDefense}) / 5)+1 ]]
--?? @{KnackDurationTotal} > 0 ?? Duration| @{KnackDurationTotal} @{KnackDurationIncrement}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                        </td>
                        <td style="text-align: center; vertical-align: top;">
                            <strong>
                                NOTES
                            </strong>
                            <button name="roll_KnackDesc" type="roll" value="@{KnackName}: @{KnackDesc}">
                            </button>
                        </td>
                        <td style="text-align: left; vertical-align: top;" colspan="6" rowspan="1">
                            <textarea class="text-input-noback" style="width:90%; height:20px" name="attr_KnackDesc"></textarea>
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
    </tr>
</tbody>
</table>
</fieldset>
<p></p>
</div>
<div class="sheet-section-equipment"> <!-- Equipment Tab -->
<h3>
Melee Weapons
</h3>
<fieldset class="repeating_meleeweapons">
<table style="width: 725px; height: 70px;" border="1">
<tbody>
    <tr>
        <td>
            <table style="width: 100%; background-color: #FFFFFF;" border="5">
                <tbody>
                    <tr style="background-color: #bfbfbf">
                        <td style="text-align: left; vertical-align: bottom; width: 150px" >
                            <strong>
                                NAME
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 50px">
                            <strong>
                                STEP
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px;">
                            <strong>
                                STRAIN
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 50px">
                            <strong>
                                Vs DEFENSE
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 80px">
                            <strong>
                                ATTACK
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 50px; color: #eaeaea; background-color: #dd0000">
                            <strong>
                                STEP
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px; color: #eaeaea; background-color: #dd0000">
                            <strong>
                                STRAIN
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 50px; color: #eaeaea; background-color: #dd0000">
                            <strong>
                                Vs ARMOR
                            </strong>
                        </td>                        
                        <td style="vertical-align: bottom; text-align: center; width: 80px; color: #eaeaea; background-color: #dd0000">
                            <strong>
                                DAMAGE
                            </strong>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left; vertical-align: top;">
                            <input name="attr_WeaponName" type="text" style= "width: 150px"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_AtkStep" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_AtkStrain" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <select class="WeaponDefense" name="attr_WeaponDefense" style= "width: 80px">
                                <option value="@{target|PD}">
                                    Physical
                                </option>
                                <option value="@{target|MD}">
                                    Mystic
                                </option>
                                <option value="@{target|SD}">
                                    Social
                                </option>
                            </select>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            Public / Target <br/>
                            <span style="background-color: #ff0000;">
                                <button name="roll_AtkStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{WeaponName}**
--leftsub|Attack
--Step|[[ ?{Step|@{AtkStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{AtkStrain}} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            &nbsp;
                            <span style="background-color: #004fce;">
                                <button name="roll_AtkTarget" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{WeaponName}**
--leftsub|Attack
--Step|[[ ?{Step|@{AtkStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{AtkStrain}} ]] Strain
--Result:|**[^Result.base]** vs @{target|token_name}
--Successes| [[ floor(([$Result] { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{WeaponDefense}) / 5)+1 ]]
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_DamStep" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_DamStrain" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <select class="WeaponDamType" name="attr_WeaponDamType" style= "width: 80px">
                                <option value="@{target|PA}">
                                    Physical
                                </option>
                                <option value="@{target|MA}">
                                    Mystic
                                </option>
                                <option value="0">
                                    None
                                </option>
                            </select>
                        </td>                        
                        <td style="vertical-align: top; text-align: center;">
                            Public / Target <br/>
                            <span style="background-color: #ff0000;">
                                <button name="roll_DamStep" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{WeaponName}**
--leftsub|Damage
--Step|[[ ?{Step|@{DamStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{DamStrain}} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            &nbsp;
                            <span style="background-color: #004fce;">
                                <button name="roll_DamTarget" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{WeaponName}**
--leftsub|Damage vs @{target|token_name}
--Step|[[ ?{Step|@{DamStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{DamStrain}} ]] Strain
--Damage after Armor|[[ {0d1, ceil(( { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{WeaponDamType}) ) }kh1 ]]
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left; vertical-align: top;" rowspan="1">
                            <strong>
                                SPECIAL
                            </strong>
                        </td>
                        <td style="text-align: left; vertical-align: top" colspan="8" rowspan="1">
                            <textarea class="text-input-noback" style="width:90%; height:20px" name="attr_MWeaponSpecial"></textarea>
                        </td>
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
    </tr>
</tbody>
</table>
</fieldset>
<p></p>
<h3>
Ranged Weapons
</h3>
    &nbsp; &nbsp; &nbsp;<strong>Ammunition: &nbsp; Current</strong>
        <input name="attr_Arrow" type="number" value="0" style="width: 40px;"/>
    &nbsp; <strong>Max</strong>
        <input name="attr_Arrow_max" type="number" value="0" style="width: 40px;"/>
<fieldset class="repeating_rangedweapons">
    <table style="width: 725px; height: 70px; background-color: #FFFFFF;" border="5">
        <tbody>
            <tr style="background-color: #bfbfbf">
                <td style="text-align: left; vertical-align: bottom; width: 150px" >
                    <strong>
                        NAME
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: center; width: 40px; ">
                    <strong>
                        STEP
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: center; width: 40px; ">
                    <strong>
                        STRAIN
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: center; width: 50px; ">
                    <strong>
                        Vs DEFENSE
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: center; width: 80px; ">
                    <strong>
                        ATTACK
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: center; width: 40px; color: #eaeaea; background-color: #dd0000">
                    <strong>
                        STEP
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: center; width: 40px; color: #eaeaea; background-color: #dd0000">
                    <strong>
                        STRAIN
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: center; width: 50px; color: #eaeaea; background-color: #dd0000">
                    <strong>
                        Vs ARMOR
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: center; width: 80px; color: #eaeaea; background-color: #dd0000">
                    <strong>
                        DAMAGE
                    </strong>
                </td>
            </tr>
            <tr>
                <td style="text-align: left; vertical-align: top;">
                    <input name="attr_RWeaponName" type="text" style= "width: 150px"/>
                </td>
                <td style="vertical-align: top; text-align: center;">
                    <input name="attr_RAtkStep" type="number" value="0" style="width: 41px;"/>
                </td>
                <td style="vertical-align: top; text-align: center;">
                    <input name="attr_RAtkStrain" type="number" value="0" style="width: 41px;"/>
                </td>
                <td style="vertical-align: top; text-align: center;">
                    <select class="RWeaponDefense" name="attr_RWeaponDefense" style= "width: 80px">
                        <option value="@{target|PD}">
                            Physical
                        </option>
                        <option value="@{target|MD}">
                            Mystic
                        </option>
                        <option value="@{target|SD}">
                            Social
                        </option>
                    </select>
                </td>
                <td style="vertical-align: top; text-align: center;">
                    Public / Target <br/>
                    <span style="background-color: #ff0000;">
                        <button name="roll_RAtkStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{RWeaponName}**
--leftsub|Attack
--Step|[[ ?{Step|@{RAtkStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{RAtkStrain}} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
--Arrow|-1
}}">
                                </button>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            &nbsp;
                            <span style="background-color: #004fce;">
                                <button name="roll_RAtkTarget" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{RWeaponName}**
--leftsub|Attack
--Step|[[ ?{Step|@{RAtkStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{RAtkStrain}} ]] Strain
--Result:|**[^Result.base]** vs @{target|token_name}
--Successes| [[ floor(([$Result] { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{RWeaponDefense}) / 5)+1 ]]
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
--Arrow|-1
}}">
                                </button>
                            </span>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_RDamStep" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_RDamStrain" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <select class="RWeaponDamType" name="attr_RWeaponDamType" style= "width: 80px">
                                <option value="@{target|PA}">
                                    Physical
                                </option>
                                <option value="@{target|MA}">
                                    Mystic
                                </option>
                            </select>
                        </td>                        
                        <td style="vertical-align: top; text-align: center;">
                            Public / Target <br/>
                            <span style="background-color: #ff0000;">
                                <button name="roll_RDamStep" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{RWeaponName}**
--leftsub|Damage
--Step|[[ ?{Step|@{RDamStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{RDamStrain}} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            &nbsp;
                            <span style="background-color: #004fce;">
                                <button name="roll_DamTarget" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{RWeaponName}**
--leftsub|Damage vs @{target|token_name}
--Step|[[ ?{Step|@{RDamStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{RDamStrain}} ]] Strain
--Damage after Armor|[[ {0d1, ceil(( { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{RWeaponDamType}) ) }kh1 ]]
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                        </td>
            </tr>
            <tr>
                <td style="text-align: left; vertical-align: top;" rowspan="1">
                    <strong>
                        SPECIAL
                    </strong>
                </td>
                <td style="text-align: left; vertical-align: top" colspan="5" rowspan="1">
                    <textarea class="text-input-noback" style="width:90%; height:20px" name="attr_RWeaponSpecial"></textarea>
                </td>
                <td style="vertical-align: center; text-align: center; ">
                    <strong>
                        RANGE
                    </strong>
                </td>
                <td style="text-align: center;">
                    <strong>
                        Short &nbsp;
                    </strong>
                    <input name="attr_RangeShort" type="number" value="2" style="width: 40px;"/>
                </td>
                <td style="text-align: center;">
                    <strong>
                        Long &nbsp;
                    </strong>
                    <input name="attr_RangeLong" type="number" value="4" style="width: 40px;"/>
                </td>
            </tr>
        </tbody>
    </table>
</fieldset>
<p></p>
&nbsp;
<table style="width: 725px; height: 80px">
    <tr>
        <td>
            <h3>
                Armor Worn
            <select class="Metric" name="attr_ArmorWorn" style= "width: 57px; height: 23px">
                <option value="1">
                    Yes
                </option>
                <option value="0">
                    No
                </option>
            </select>
            </h3>
            <input type='hidden' name='attr_ArmorPA' value='((@{ArPA}+@{ArPAMod})*@{ArmorWorn})'  />
            <input type='hidden' name='attr_ArmorMA' value='((@{ArMA}+@{ArMAMod})*@{ArmorWorn})' />
            <input type='hidden' name='attr_ArmorInitMod' value='((@{ArInit}+@{ArInitMod})*@{ArmorWorn})' />
            <table style="width: 350px; height: 100%; background-color: #FFFFFF;" border="5">
                <tbody>
                    <tr style="background-color: #bfbfbf">
                        <td style="text-align: left; vertical-align: bottom; width: 110px" >
                            <strong>
                                NAME
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center;">
                            <strong>
                                PA
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center;">
                            <strong>
                                MA
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center;">
                            <strong>
                                INIT
                            </strong>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left; vertical-align: top;">
                            <input name="attr_ArmorName" type="text" style= "width: 100px"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_ArPA" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_ArMA" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_ArInit" type="number" value="0" style="width: 41px;"/>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left; vertical-align: center; width: 110px" >
                            <strong>
                                Modifiers
                            </strong>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_ArPAMod" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_ArMAMod" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_ArInitMod" type="number" value="0" style="width: 41px;"/>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left; vertical-align: top;" rowspan="1">
                            <strong>
                                SPECIAL
                            </strong>
                        </td>
                        <td style="text-align: left; vertical-align: top" colspan="3" rowspan="1">
                           <textarea class="text-input-noback" style="width:90%; height:20px" name="attr_ArmorSpecial"></textarea>
                       </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
            <h3>
            Shield Worn
            <select class="Metric" name="attr_ShieldWorn" style= "width: 57px; height: 23px">
                <option value="1">
                    Yes
                </option>
                <option value="0">
                    No
                </option>
            </select>
            </h3>
            <input type='hidden' name='attr_ShieldPD' value='((@{ShPD_Base}+@{ShPD_Mod})*@{ShieldWorn})'  />
            <input type='hidden' name='attr_ShieldMD' value='((@{ShMD_Base}+@{ShMD_Mod})*@{ShieldWorn})' />
            <input type='hidden' name='attr_ShieldInitMod' value='((@{ShInit}+@{ShInitMod})*@{ShieldWorn})' />            
            </h3>
            <table style="width: 350px; height: 100%; background-color: #FFFFFF;" border="5">
                <tbody>
                    <tr style="background-color: #bfbfbf">
                        <td style="text-align: left; vertical-align: bottom; width: 110px" >
                            <strong>
                                NAME
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center;">
                            <strong>
                                PD
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center;">
                            <strong>
                                MD
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center;">
                            <strong>
                                INIT
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center;">
                            <strong>
                                SHATTER
                            </strong>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left; vertical-align: top;">
                            <input name="attr_ShieldName" type="text" style= "width: 100px"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_ShPD_Base" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_ShMD_Base" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_ShInit" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_ShieldShatter" type="number" value="0" style="width: 41px;"/>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left; vertical-align: center; width: 110px" >
                            <strong>
                                Modifiers
                            </strong>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_ShPD_Mod" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_ShMD_Mod" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_ShInitMod" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left; vertical-align: top;" rowspan="1">
                            <strong>
                                SPECIAL
                            </strong>
                        </td>
                        <td style="text-align: left; vertical-align: top" colspan="4" rowspan="1">
                            <textarea class="text-input-noback" style="width:90%; height:20px" name="attr_ShieldSpecial"></textarea>
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
    </tr>
</table>
<p></p>
&nbsp;
<table style="width: 725px; height: 80px;">
    <tr>
        <td style="vertical-align: top;">
            <h3>Magical Equipment</h3>
            <fieldset class="repeating_bloodcharms">
                <table style="width: 350px; height: 80px;" border="1">
                    <tbody>
                        <tr>
                            <td>
                                <table style="width: 100%; height: 100%; background-color: #FFFFFF;" border="5">
                                    <tbody>
                                        <tr style="background-color: #bfbfbf">
                                            <td style="text-align: left; vertical-align: bottom; height: 15px; width: 110px;" >
                                                <strong>NAME</strong>
                                            </td>
                                            <td style="text-align: center; width: 60px;">
                                                <strong>BLOOD MAGIC</strong>
                                            </td>
                                            <td style="text-align: center; width: 40px;">
                                                <strong>STRAIN</strong>
                                            </td>
                                            
                                        </tr>
                                        <tr>
                                            <td style="text-align: left; vertical-align: top; height: 15px" >
                                                <input name="attr_BCName" type="text" style= "width: 110px"/>
                                            </td>
                                            <td style="text-align: center; vertical-align: top; height: 15px" >
                                                <input name="attr_BCDam" type="number" value="0" style="width: 41px;"/>
                                            </td>
                                            <td style="text-align: center; vertical-align: top; height: 15px" >
                                                <input name="attr_BCStrain" type="number" value="0" style="width: 41px;"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="text-align: left; ">
                                                <strong>DESCRIPTION</strong>
                                                <button name="roll_BCDesc" type="roll" value="@{BCName}: @{BCDesc}">
                                            </td>
                                            <td style="text-align: left; vertical-align: top" colspan="2">
                                                <textarea class="text-input-noback" style="width:90%; height:20px" name="attr_BCDesc"></textarea>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </fieldset>
        </td>
        <td style="vertical-align: top;">
            <h3>Thread & Pattern Items</h3>
            <fieldset class="repeating_threaditems">
                <table style="width: 350px; height: 80px;" border="1">
                    <tbody>
                        <tr>
                            <td>
                                <table style="width: 100%; height: 100%; background-color: #FFFFFF;" border="5">
                                    <tbody>
                                        <tr style="background-color: #bfbfbf">
                                            <td style="text-align: left; vertical-align: bottom; height: 15px; width: 110px;" >
                                                <strong>NAME</strong></td>
                                            <td style="text-align: center;">
                                                <strong>RANK</strong></td>
                                            <td style="text-align: center;">
                                                <strong>MAX</strong></td>
                                            <td style="text-align: center;">
                                                <strong>MD</strong></td>
                                        </tr>
                                        <tr>
                                            <td style="text-align: left; vertical-align: top; height: 15px" >
                                                <input name="attr_TIName" type="text" style= "width: 110px"/>
                                            </td>
                                            <td style="text-align: center; vertical-align: top; height: 15px" >
                                                <input name="attr_TIRank" type="number" value="0" style="width: 41px;"/>
                                            <td style="text-align: center; vertical-align: top; height: 15px" >
                                                <input name="attr_TIMaxThreads" type="number" value="0" style="width: 41px;"/>
                                            </td>
                                            <td style="text-align: center; vertical-align: top; height: 15px" >
                                                <input name="attr_TIMD" type="number" value="0" style="width: 41px;"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="text-align: left; vertical-align: top; height: 15px" >
                                                <select class="TITier" style="width: 90px;" name="attr_TITier">
                                                    <option value="Novice">
                                                        Novice
                                                    </option>
                                                    <option value="Journeman">
                                                        Journeman
                                                    </option>
                                                    <option value="Warden">
                                                        Warden
                                                    </option>
                                                    <option value="Master">
                                                        Master
                                                    </option>
                                                </select>
                                            </td>
                                            <td style="text-align: left; vertical-align: top" colspan="3">
                                                <textarea class="text-input-noback" style="width:90%; height:20px" name="attr_TIInfo"></textarea>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </fieldset>
        </td>
    </tr>
</div>
<div class="sheet-section-questor"> <!-- Questor Tab -->
<p></p>
    <table style="width: 725px; height: 80%; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="1">
        <tr style="height: 10px; color: #FFFFFF; background-color: #1d5dc4;">
            <td style="text-align: left; vertical-align: bottom; width: 100px">
                <strong>
                    PASSION
                </strong>
            </td>
            <td style="vertical-align: bottom; text-align: center; ">
                <strong>
                    QUESTOR RANK
                </strong>
            </td>
            <td style="vertical-align: bottom; text-align: center; ">
                <strong>
                    DEVOTION DIE STEP
                </strong>
            </td>
            <td style="vertical-align: bottom; text-align: center; ">
                <strong>
                    DEVOTION POINTS
                </strong>
            </td>
        </tr>
        <tr style="height: 10px">
            <td style="text-align: left; width: 160px">
                <input name="attr_PassionName" type="text" style= "width: 140px"/>
            </td>
            <td style="text-align: center;">
                <input name="attr_DevRank" type="number" value="0" style="width: 41px;">
            </td>
            <td style="text-align: center;">
                <input name="attr_DevStep" type="number" value="0" style="width: 41px;">
            </td>
            <td style="text-align: center;">
                <strong>Max / Current</strong> <br/>
                <input style="background-color: #d9d9d9;" name="attr_DevPoint_max" type="number" value="0" style="width: 40px;"/>
                <strong>/</strong>
                <input style="background-color: #99ceff;" name="attr_DevPoint" type="number" value="0" style="width: 40px;"/>
                <button name="roll_DevPoint" type="roll" value="!power {{
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Devotion Point**
--Spent|[[ ?{Devotion Points #|1} ]] Devotion Point
--Result|** [[ [[?{Devotion Points #} * ({1e3, 8}<[[{@{DevStep} - 11, 0}kh1 % 11]] + floor([[{@{DevStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Devotion Points #} * ({2, 4, 5, 6, 7}=[[{@{DevStep}, 0}kh1 % 11]] + {1, 3}=[[{@{DevStep}, 0}kh1]] + {1e3, 3}=[[{@{DevStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{DevStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Devotion Points #} * ({1e3, 8}<[[{@{DevStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{DevStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{DevStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{DevStep}, 0}kh1 % 11]] * 4]]! + [[?{Devotion Points #} * ({1e3, 8}<[[{@{DevStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{DevStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{DevStep}, 0}kh1 % 11]]))]]d8! - [[?{Devotion Points #} * ({1, 2}=[[{@{DevStep}, 0}kh1]] * (3 - [[{@{DevStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--DevPoint|-?{Devotion Points #}
}}">
                </button>
            </td>
        </tr>
        <tbody>
            <tr>
                <td style="text-align: middle; vertical-align: middle;">
                    <strong>
                        DEVOTION ABILITY 1
                    </strong>
                </td>
                <td colspan="3">
                    <input name="attr_DevAbil1" type="text" style= "width: 550px"/>
                </td>
            </tr>
            <tr>
                <td style="text-align: middle; vertical-align: middle;">
                    <strong>
                        DEVOTION ABILITY 2
                    </strong>
                </td>
                <td colspan="3">
                    <input name="attr_DevAbil2" type="text" style= "width: 550px"/>
                </td>
            </tr>
            <tr>
                <td style="text-align: middle; vertical-align: middle;">
                    <strong>
                        DEVOTION ABILITY 3
                    </strong>
                </td>
                <td colspan="3">
                    <input name="attr_DevAbil3" type="text" style= "width: 550px"/>
                </td>
            </tr>
        </tbody>
    </table>
<fieldset class="repeating_devotions">
<table style="width: 725px; height: 100px;" border="1">
<tbody>
    <tr>
        <td>
            <table style="width: 100%; height: 100%; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="1">
                <tbody>
                    <tr style="color: #FFFFFF; background-color: #1d5dc4;">
                        <td style="text-align: left; vertical-align: bottom; width: 140px;">
                            <strong>
                                GRANTED DEVOTION
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                STEP
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                RANK
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                BONUS
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                ATTR
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                STRAIN
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 70px">
                            <strong>
                                ACTION
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 75px">
                            <strong>
                                Vs DEFENSE
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 170px">
                            <strong>
                                DURATION
                            </strong>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left; vertical-align: top;">
                            <input name="attr_GDName" type="text" style= "width: 135px"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input disabled="disabled" name="attr_GDStep" type="number" value="@{AttrStep}+@{GDRank}+@{GDBonus}" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_GDRank" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_GDBonus" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: left;">
                            <select class="AttrStep" name="attr_AttrStep" style= "width: 63px">
                                <option value="0">
                                    None
                                </option>
                                <option value="@{DexStep}+@{DexMod}">
                                    DEX
                                </option>
                                <option value="@{StrStep}+@{StrMod}">
                                    STR
                                </option>
                                <option value="@{TouStep}+@{TouMod}">
                                    TOU
                                </option>
                                <option value="@{PerStep}+@{PerMod}">
                                    PER
                                </option>
                                <option value="@{WilStep}+@{WilMod}">
                                    WIL
                                </option>
                                <option value="@{ChaStep}+@{ChaMod}">
                                    CHA
                                </option>
                            </select>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_GDStrain" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <select class="GDAction" name="attr_GDAction" style= "width: 90px">
                                <option value="Free">
                                    Free
                                </option>
                                <option value="Simple">
                                    Simple
                                </option>
                                <option value="Standard">
                                    Standard
                                </option>
                                <option value="Sustained">
                                    Sustained
                                </option>
                            </select>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <select class="GDDefense" name="attr_GDDefense" style= "width: 80px">
                                <option value="None">
                                    None
                                </option>
                                <option value="@{target|PD}">
                                    Physical
                                </option>
                                <option value="@{target|MD}">
                                    Mystic
                                </option>
                                <option value="@{target|SD}">
                                    Social
                                </option>
                            </select>
                        </td>
                        
                        <td style="vertical-align: top; text-align: center;" rowspan="2">
                                <input name="attr_GDDurationNumber" type="number" style="vertical-align: top; width: 41px;" value="0">
                                <strong>+</strong>
                                <select class="GDDurationRank" name="attr_GDDurationRank" style= "width: 62px">
                                    <option value="0">
                                        Zero
                                    </option>
                                    <option value="@{GDRank}">
                                        Rank
                                    </option>
                                </select>
                                <strong>=</strong><br/>
                                <input disabled="disabled" name="attr_GDDurationTotal" type="number" style="vertical-align: top; width: 38px;" value="@{GDDurationNumber}+@{GDDurationRank}">
                                <select class="GDDurationIncrement" name="attr_GDDurationIncrement" style= "width: 77px">
                                    <option value="Rounds">
                                        Rounds
                                    </option>
                                    <option value="Minutes">
                                        Minutes
                                    </option>
                                    <option value="Hours">
                                        Hours
                                    </option>
                                    <option value="Days">
                                        Days
                                    </option>
                                </select>
                            </td>
                    </tr>
                    <tr>
                        <td style="vertical-align: top; text-align: center;">
                            Public / GM Only / Target<br/>
                            <span style="background-color: #ff0000;">
                                <button name="roll_GDStep" type="roll" value="!power {{
!power {{
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{GDName}**
--Step|[[ ?{Step|@{GDStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Devotion Points #|0} ]] Devotion Points, [[ ?{Strain #|@{GDStrain}} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Devotion Points #|0} Devotion Points] [[?{Devotion Points #} * ({1e3, 8}<[[{@{DevStep} - 11, 0}kh1 % 11]] + floor([[{@{DevStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Devotion Points #} * ({2, 4, 5, 6, 7}=[[{@{DevStep}, 0}kh1 % 11]] + {1, 3}=[[{@{DevStep}, 0}kh1]] + {1e3, 3}=[[{@{DevStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{DevStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Devotion Points #} * ({1e3, 8}<[[{@{DevStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{DevStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{DevStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{DevStep}, 0}kh1 % 11]] * 4]]! + [[?{Devotion Points #} * ({1e3, 8}<[[{@{DevStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{DevStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{DevStep}, 0}kh1 % 11]]))]]d8! - [[?{Devotion Points #} * ({1, 2}=[[{@{DevStep}, 0}kh1]] * (3 - [[{@{DevStep}, 0}kh1]]))]] ]]**
--?? @{GDDurationTotal} > 0 ?? Duration| @{GDDurationTotal} @{GDDurationIncrement}
}}
!modattr {{
--silent
--charid @{character_id}
--DevPoint|-?{Devotion Points #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            <span style="background-color: #f4c542;">
                                <button name="roll_GDStepGM" type="roll" value="/w gm @{Name} @{GDName}
!power {{
--whisper|GM
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{GDName}**
--Step|[[ ?{Step|@{GDStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Devotion Points #|0} ]] Devotion Points, [[ ?{Strain #|@{GDStrain}} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Devotion Points #|0} Devotion Points] [[?{Devotion Points #} * ({1e3, 8}<[[{@{DevStep} - 11, 0}kh1 % 11]] + floor([[{@{DevStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Devotion Points #} * ({2, 4, 5, 6, 7}=[[{@{DevStep}, 0}kh1 % 11]] + {1, 3}=[[{@{DevStep}, 0}kh1]] + {1e3, 3}=[[{@{DevStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{DevStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Devotion Points #} * ({1e3, 8}<[[{@{DevStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{DevStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{DevStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{DevStep}, 0}kh1 % 11]] * 4]]! + [[?{Devotion Points #} * ({1e3, 8}<[[{@{DevStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{DevStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{DevStep}, 0}kh1 % 11]]))]]d8! - [[?{Devotion Points #} * ({1, 2}=[[{@{DevStep}, 0}kh1]] * (3 - [[{@{DevStep}, 0}kh1]]))]] ]]**
--?? @{GDDurationTotal} > 0 ?? Duration| @{GDDurationTotal} @{GDDurationIncrement}
}}
!modattr {{
--silent
--charid @{character_id}
--DevPoint|-?{Devotion Points #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            <span style="background-color: #004fce;">
                                <button name="roll_GDTarget" type="roll" value="!power {{
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{GDName}**
--Step|[[ ?{Step|@{GDStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Devotion Points #|0} ]] Devotion Points, [[ ?{Strain #|@{GDStrain}} ]] Strain
--Result:|**[^Result.base]**
--Successes| [[ floor(([$Result] { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Devotion Points #|0} Devotion Points] [[?{Devotion Points #} * ({1e3, 8}<[[{@{DevStep} - 11, 0}kh1 % 11]] + floor([[{@{DevStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Devotion Points #} * ({2, 4, 5, 6, 7}=[[{@{DevStep}, 0}kh1 % 11]] + {1, 3}=[[{@{DevStep}, 0}kh1]] + {1e3, 3}=[[{@{DevStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{DevStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Devotion Points #} * ({1e3, 8}<[[{@{DevStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{DevStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{DevStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{DevStep}, 0}kh1 % 11]] * 4]]! + [[?{Devotion Points #} * ({1e3, 8}<[[{@{DevStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{DevStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{DevStep}, 0}kh1 % 11]]))]]d8! - [[?{Devotion Points #} * ({1, 2}=[[{@{DevStep}, 0}kh1]] * (3 - [[{@{DevStep}, 0}kh1]]))]] } - @{GDDefense}) / 5)+1 ]]
--?? @{GDDurationTotal} > 0 ?? Duration| @{GDDurationTotal} @{GDDurationIncrement}
}}
!modattr {{
--silent
--charid @{character_id}
--DevPoint|-?{Devotion Points #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                        </td>
                        <td style="text-align: center; vertical-align: top;">
                            <strong>
                                NOTES
                            </strong>
                            <button name="roll_GDDesc" type="roll" value="@{GDName}: @{GDDesc}">
                            </button>
                        </td>
                        <td style="text-align: left; vertical-align: top;" colspan="6" rowspan="1">
                            <textarea class="text-input-noback" style="width:90%; height:20px" name="attr_GDDesc"></textarea>
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
    </tr>
</tbody>
</table>
</fieldset>
</div>
<div class="sheet-section-matrixes"> <!-- Matrixes Tab -->
<p></p>
<table style="width: 725px; height: 80%; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="1">
        <tr style="height: 10px; background-color: #ffa31a;">
            <td style="text-align: left; vertical-align: bottom; width: 163px">
                <strong>
                    NAME
                </strong>
            </td>
            <td style="vertical-align: bottom; text-align: center; width: 40px">
                <strong>
                    STEP
                </strong>
            </td>
            <td style="vertical-align: bottom; text-align: center; width: 40px">
                <strong>
                    RANK
                </strong>
            </td>
            <td style="vertical-align: bottom; text-align: center; width: 40px">
                <strong>
                    BONUS
                </strong>
            </td>
            <td style="vertical-align: bottom; text-align: center; width: 60px">
                <strong>
                    ATTR
                </strong>
            </td>
            <td style="vertical-align: bottom; text-align: center; width: 40px">
                <strong>
                    STRAIN
                </strong>
            </td>
            <td style="vertical-align: bottom; text-align: center; width: 100px">
                <strong>
                    ACTION
                </strong>
            </td>
            <td style="vertical-align: bottom; text-align: center; width: 140px">
                <strong>
                    ROLL
                </strong>
            </td>
        </tr>
        <tr style="height: 10px">
            <td style="text-align: left;" >
                <strong>Spellcasting</strong>
            </td>
            <td style="text-align: center;">
                <input disabled="disabled" name="attr_SCStep" type="number" value="@{SCAttrStep}+@{SCRank}+@{SCBonus}" style="width: 41px;">
            </td>
            <td style="text-align: center;">
                <input name="attr_SCRank" type="number" value="0" style="width: 41px;"/>
            </td>
            <td style="text-align: center;">
                <input name="attr_SCBonus" type="number" value="0" style="width: 41px;"/>
            </td>
            <td style="vertical-align: center; text-align: center;">
                <select class="SCAttrStep" name="attr_SCAttrStep" style= "width: 60px">
                    <option value="@{PerStep}+@{PerMod}">
                        PER
                    </option>
                    <option value="0">
                        None
                    </option>
                    <option value="@{DexStep}+@{DexMod}">
                        DEX
                    </option>
                    <option value="@{StrStep}+@{StrMod}">
                        STR
                    </option>
                    <option value="@{TouStep}+@{TouMod}">
                        TOU
                    </option>
                    <option value="@{WilStep}+@{WilMod}">
                        WIL
                    </option>
                    <option value="@{ChaStep}+@{ChaMod}">
                        CHA
                    </option>
                </select>
            </td>
            <td style="text-align: center;">
                <input name="attr_SCStrain" type="number" value="0" style="width: 41px;"/>
            </td>
            <td style="text-align: center;">
                Standard
            </td>
            <td style="text-align: center;">
                Public / GM Only / Target <br/>
                <span style="background-color: #ff0000;">
                    <button name="roll_SCStep" type="roll" value="!power {{
--format|gold
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Spellcasting**
--Step|[[ ?{Step|@{SCStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{SCStrain}} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                </span>
                &nbsp;
                <strong>/</strong>
                <span style="background-color: #f4c542;">
                    <button name="roll_SCStepGM" type="roll" value="/w gm @{Name} Spellcasting
!power {{
--whisper|GM
--format|gold
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Spellcasting**
--Step|[[ ?{Step|@{SCStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{SCStrain}} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                </span>
                &nbsp;
                <strong>/</strong>
                <span style="background-color: #004fce;">
                    <button name="roll_SCTarget" type="roll" value="!power {{
--format|gold
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Spellcasting**
--leftsub| vs @{target|token_name}
--Step|[[ ?{Step|@{SCStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{SCStrain}} ]] Strain
--Result:|**[^Result.base]**
--Successes| [[ floor(([$Result] { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{target|MD}) / 5)+1 ]]
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                </span>
            </td>
        </tr>
        <tr style="height: 10px">
            <td style="text-align: left;" >
                <strong>Willforce</strong>
                &nbsp; Use? &nbsp;
                <input type="checkbox"  name='attr_WFChecked' value='1' />
                <input type='hidden' name='attr_WFUse' value='(@{WFChecked}*(@{WFRank}+@{WFBonus}))'  />
                <input type='hidden' name='attr_WFSUse' value='@{WFChecked}*@{WFStrain}' />
            </td>
            <td style="text-align: center;">
                <input disabled="disabled" name="attr_WFStep" type="number" value="(@{WFAttrStep}+@{WFUse})" style="width: 41px;">
            </td>
            <td style="text-align: center;">
                <input name="attr_WFRank" type="number" value="0" style="width: 41px;"/>
            </td>
            <td style="text-align: center;">
                <input name="attr_WFBonus" type="number" value="0" style="width: 41px;"/>
            </td>
            <td style="vertical-align: center; text-align: center;">
                <select class="WFAttrStep" name="attr_WFAttrStep" style= "width: 60px">
                    <option value="(@{WilStep}+@{WilMod})">
                        WIL
                    </option>
                    <option value="0">
                        None
                    </option>
                    <option value="@{DexStep}+@{DexMod}">
                        DEX
                    </option>
                    <option value="@{StrStep}+@{StrMod}">
                        STR
                    </option>
                    <option value="@{TouStep}+@{TouMod}">
                        TOU
                    </option>
                    <option value="@{PerStep}+@{PerMod}">
                        PER
                    </option>
                    <option value="@{ChaStep}+@{ChaMod}">
                        CHA
                    </option>
                </select>
            </td>
            <td style="text-align: center;">
                <input name="attr_WFStrain" type="number" value="1" style="width: 41px;"/>
            </td>
            <td style="text-align: center;">
                Free
            </td>
            <td style="text-align: left;">
                &nbsp; &nbsp;
                <span style="background-color: #ff0000;">
                    <button name="roll_WFStep" type="roll" value="!power {{
--format|gold
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Willforce**
--Step|[[ ?{Step|@{WFStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|1} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                </span>
                &nbsp;
                <strong>/</strong>
                <span style="background-color: #f4c542;">
                    <button name="roll_WFStepGM" type="roll" value="/w gm @{Name} Willforce
!power {{
--whisper|GM
--format|gold
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Willforce**
--Step|[[ ?{Step|@{WFStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|1} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                </span>
            </td>
        </tr>
</table>
<fieldset class="repeating_threadweaving">
    <table style="width: 725px; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="1">
        <tr style="height: 10px">
            <td style="text-align: left; width: 160px">
                <input name="attr_TWName" type="text" style= "width: 140px"/>
            </td>
            <td style="text-align: center; width: 40px" />
                <input disabled="disabled" name="attr_TWStep" type="number" value="@{TWAttrStep}+@{TWRank}+@{TWBonus}" style="width: 41px;">
            </td>
            <td style="text-align: center; width: 40px">
                <input name="attr_TWRank" type="number" value="0" style="width: 41px;"/>
            </td>
            <td style="text-align: center; width: 40px">
                <input name="attr_TWBonus" type="number" value="0" style="width: 41px;"/>
            </td>
            <td style="vertical-align: center; text-align: center; width: 60px">
                <select class="TWAttrStep" name="attr_TWAttrStep" style= "width: 60px">
                    <option value="@{PerStep}+@{PerMod}">
                        PER
                    </option>
                    <option value="0">
                        None
                    </option>
                    <option value="@{DexStep}+@{DexMod}">
                        DEX
                    </option>
                    <option value="@{StrStep}+@{StrMod}">
                        STR
                    </option>
                    <option value="@{TouStep}+@{TouMod}">
                        TOU
                    </option>
                    <option value="@{WilStep}+@{WilMod}">
                        WIL
                    </option>
                    <option value="@{ChaStep}+@{ChaMod}">
                        CHA
                    </option>
                </select>
            </td>
            <td style="text-align: center; width: 40px">
                <input name="attr_TWStrain" type="number" value="0" style="width: 41px;"/>
            </td>
            <td style="text-align: center; width: 96px">
                <select class="TWAction" name="attr_TWAction" style= "width: 90px">
                    <option value="Free">
                        Free
                    </option>
                    <option value="Simple">
                        Simple
                    </option>
                    <option value="Standard">
                        Standard
                    </option>
                    <option value="Sustained">
                        Sustained
                    </option>
                </select>
            </td>
            <td style="text-align: center; width: 140px">
                <span style="background-color: #ff0000;">
                    <button name="roll_TWStep" type="roll" value="!power {{
--format|gold
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{TWName}**
--Step|[[ ?{Step|@{TWStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{TWStrain}} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                </span>
                &nbsp;
                <strong>/</strong>
                <span style="background-color: #f4c542;">
                    <button name="roll_TWStepGM" type="roll" value="/w gm @{Name} @{TWName}
!power {{
--whisper|GM
--format|gold
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{TWName}**
--Step|[[ ?{Step|@{TWStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{TWStrain}} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                </span>
                &nbsp;
                <strong>/</strong>
                <span style="background-color: #004fce;">
                    <button name="roll_SCTarget" type="roll" value="!power {{
--format|gold
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{TWName}**
--leftsub| vs @{target|token_name}
--Step|[[ ?{Step|@{TWStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{TWStrain}} ]] Strain
--Result:|**[^Result.base]**
--Successes| [[ floor(([$Result] { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{target|MD}) / 5)+1 ]]
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                </span>
            </td>
        </tr>
    </table>
</fieldset>
<h3>
    Effect Test Bonus &nbsp; <input name="attr_EffBon" type="number" value="0" style= "width: 41px" />
</h3>
<h3>Matrixes</h3>
<fieldset class="repeating_matrixes">
    <table style="width: 725px; height: 100%; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="1">
        <tbody>
            <tr style="height: 10px;">
                <td style="vertical-align: bottom; text-align: center; width: 8%; background-color: #ffa31a;">
                    <strong>
                        TYPE
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 22%; background-color: #ffa31a;">
                    <strong>
                         SPELL NAME
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 25%; background-color: #ffa31a;">
                    <input name="attr_SpellName" type="text" style= "width: 160px" />
                </td>
                <td style="vertical-align: bottom; text-align: right; width: 14%">
                    <strong>
                         RANGE
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 36%" />
                    <input name="attr_SpellRange" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style="height: 10px;">
                <td style="vertical-align: top; text-align: left; background-color: #ffa31a;">
                    <select class="MatrixType" style="width: 90px;" name="attr_MatrixType">
                        <option value="Standard">
                            Standard
                        </option>
                        <option value="Enhanced">
                            Enhanced
                        </option>
                        <option value="Armored">
                            Armored
                        </option>
                        <option value="Shared">
                            Shared
                        </option>
                    </select>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                         CIRCLE
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCircle" type="number" style="vertical-align: top; width: 41px;" value="1">
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                         DURATION
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellDurationNumber" type="number" style="vertical-align: top; width: 41px;" value="0">
                    <strong>+</strong>
                    <select class="SpellDurationRank" name="attr_SpellDurationRank" style= "width: 62px">
                        <option value="0">
                            Zero
                        </option>
                        <option value="@{SCRank}">
                            Rank
                        </option>
                    </select>
                    <select class="SpellDurationIncrement" name="attr_SpellDurationIncrement" style= "width: 77px">
                        <option value="Rounds">
                            Rounds
                        </option>
                        <option value="Minutes">
                            Minutes
                        </option>
                        <option value="Hours">
                            Hours
                        </option>
                    </select>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style= "text-align: center; background-color: #ffa31a;">
                    <strong>
                        RANK
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                        THREADS
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellThreads" type="number" value="0" style="width: 41px;"/>
                    TN
                    <input type="number" name="attr_SpellWeave" value="(@{SpellCircle}+4)" disabled="true" />
                    <strong>/</strong>
                    <input type="number" name="attr_SpellAttune" value="@{SpellCircle}+9" disabled="true" />
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                        CASTING
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCastTN" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 10px;">
                <td style= "vertical-align: top; text-align: center; background-color: #ffa31a;" rowspan=2>
                    <input name="attr_MatrixRank" type="number" value="0" style="width: 41px;">
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <strong>
                        EXTRA THREADS
                    </strong>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellXThreads"></textarea>
                </td>
                <td style="vertical-align: top; text-align: right;">
                    <strong>
                        SUCCESS LEVELS
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellXSuc" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        DAMAGE
                    </strong>
                        <br/> Public / GM Only / Target <br/>
                    <span style="background-color: #ff0000;">
                    <button name="roll_SpellDamStep" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WFStep}+@{SpellDamage}+@{EffBon}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{WFSUse}} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--?? @{SpellEffectNumber} <> 0 ?? Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    <span style="background-color: #f4c542;">
                    <button name="roll_GMSpellDamStep" type="roll" value="/w gm @{Name} @{SpellName}
!power {{
--whisper|GM
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WFStep}+@{SpellDamage}+@{EffBon}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{WFSUse}} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--?? @{SpellEffectNumber} <> 0 ?? Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    <span style="background-color: #004fce;">
                        <button name="roll_DamTarget" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--leftsub|Damage vs @{target|token_name}
--Step|[[ ?{Step|@{WFStep}+@{SpellDamage}+@{EffBon}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{WFSUse}} ]] Strain
--Damage after Armor|[[ {0d1, ceil(( { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{SpellDamType}) ) }kh1 ]]
--?? @{SpellEffectNumber} <> 0 ?? Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                        </button>
                    </span>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <strong>WIL +</strong>
                    <input name="attr_SpellDamage" type="number" value="0" style="width: 41px;"/>
                        <strong>/</strong>
                    <select class="SpellDamType" name="attr_SpellDamType" style= "width: 80px">
                        <option value="@{target|PA}">
                            Physical
                        </option>
                        <option value="@{target|MA}">
                            Mystic
                        </option>
                        <option value="Effect">
                            Effect
                        </option>
                    </select>
                </td>
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        EFFECT
                    </strong>
                        <br/> Public / GM Only <br/>
                    <span style="background-color: #ff0000;">
                        <button name="roll_SpellEffectCard" type="roll" value="!power {{
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    <span style="background-color: #f4c542;">
                        <button name="roll_GMSpellEffectCard" type="roll" value="/w gm @{Name} @{SpellName}
!power {{
--whisper|GM
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <input name="attr_SpellEffectNumber" type="number" value="0" style="width: 41px;"/>
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellEffect"></textarea>
                </td>
            </tr>
                    </tbody>
                </table>
            </td>
        </tr>
        </tbody>
    </table>
</fieldset>
</div>
<div class="sheet-section-grimoire"> <!-- Grimoire Tab -->
<p></p>
    <input type="radio" name="attr_tab" class="sheet-tab sheet-tab51" value="51" title="Circle1" checked="checked" />
    <span class="sheet-tab sheet-tab51">Circle 1</span>
    <input type="radio" name="attr_tab" class="sheet-tab sheet-tab52" value="52" title="Circle2" />
    <span class="sheet-tab sheet-tab52">Circle 2</span>
    <input type="radio" name="attr_tab" class="sheet-tab sheet-tab53" value="53" title="Circle3" />
    <span class="sheet-tab sheet-tab53">Circle 3</span>
    <input type="radio" name="attr_tab" class="sheet-tab sheet-tab54" value="54" title="Circle4" />
    <span class="sheet-tab sheet-tab54">Circle 4</span>
    <input type="radio" name="attr_tab" class="sheet-tab sheet-tab55" value="55" title="Circle5" />
    <span class="sheet-tab sheet-tab55">Circle 5</span>
    <input type="radio" name="attr_tab" class="sheet-tab sheet-tab56" value="56" title="Circle6" />
    <span class="sheet-tab sheet-tab56">Circle 6</span>
    <p></p>
    <input type="radio" name="attr_tab" class="sheet-tab sheet-tab57" value="57" title="Circle7" />
    <span class="sheet-tab sheet-tab57">Circle 7</span>
    <input type="radio" name="attr_tab" class="sheet-tab sheet-tab58" value="58" title="Circle8" />
    <span class="sheet-tab sheet-tab58">Circle 8</span>
    <p></p>

<div class="sheet-section-circle1">
<fieldset class="repeating_spells1">
    <table style="width: 725px; height: 100%; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="1">
        <tbody>
            <tr style="height: 10px;">
                <td style="vertical-align: bottom; text-align: left; width: 20%; background-color: #bfbfbf;">
                    <strong>
                         SPELL NAME
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 30%; background-color: #bfbfbf;">
                    <input name="attr_SpellName" type="text" style= "width: 160px" />
                </td>
                <td style="vertical-align: bottom; text-align: right; width: 16%">
                    <strong>
                         RANGE
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 35%" />
                    <input name="attr_SpellRange" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style="height: 10px;">
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                         CIRCLE
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCircle" type="number" style="vertical-align: top;" value="1" disabled="true">
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                         DURATION
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellDurationNumber" type="number" style="vertical-align: top; width: 41px;" value="0">
                    <strong>+</strong>
                    <select class="SpellDurationRank" name="attr_SpellDurationRank" style= "width: 62px">
                        <option value="0">
                            Zero
                        </option>
                        <option value="@{SCRank}">
                            Rank
                        </option>
                    </select>
                    <select class="SpellDurationIncrement" name="attr_SpellDurationIncrement" style= "width: 77px">
                        <option value="Rounds">
                            Rounds
                        </option>
                        <option value="Minutes">
                            Minutes
                        </option>
                        <option value="Hours">
                            Hours
                        </option>
                    </select>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                        THREADS
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellThreads" type="number" value="0" style="width: 41px;"/>
                    TN
                    <input type="number" name="attr_SpellWeave" value="(@{SpellCircle}+4)" disabled="true" />
                    <strong>/</strong>
                    <input type="number" name="attr_SpellAttune" value="@{SpellCircle}+9" disabled="true" />
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                        CASTING
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCastTN" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 10px;">
                <td style="vertical-align: top; text-align: left;">
                    <strong>
                        EXTRA THREADS
                    </strong>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellXThreads"></textarea>
                </td>
                <td style="vertical-align: top; text-align: right;">
                    <strong>
                        SUCCESS LEVELS
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellXSuc" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        DAMAGE
                    </strong>
                        <br/> Public / GM Only / Target <br/>
                    <span style="background-color: #ff0000;">
                    <button name="roll_SpellDamStep" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WFStep}+@{SpellDamage}+@{EffBon}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{WFSUse}} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--?? @{SpellEffectNumber} <> 0 ?? Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    <span style="background-color: #f4c542;">
                    <button name="roll_GMSpellDamStep" type="roll" value="/w gm @{Name} @{SpellName}
!power {{
--whisper|GM
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WFStep}+@{SpellDamage}+@{EffBon}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{WFSUse}} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--?? @{SpellEffectNumber} <> 0 ?? Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    <span style="background-color: #004fce;">
                        <button name="roll_DamTarget" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--leftsub|Damage vs @{target|token_name}
--Step|[[ ?{Step|@{WFStep}+@{SpellDamage}+@{EffBon}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{WFSUse}} ]] Strain
--Damage after Armor|[[ {0d1, ceil(( { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{SpellDamType}) ) }kh1 ]]
--?? @{SpellEffectNumber} <> 0 ?? Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                        </button>
                    </span>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <strong>WIL +</strong>
                    <input name="attr_SpellDamage" type="number" value="0" style="width: 41px;"/>
                        <strong>/</strong>
                    <select class="SpellDamType" name="attr_SpellDamType" style= "width: 80px">
                        <option value="@{target|PA}">
                            Physical
                        </option>
                        <option value="@{target|MA}">
                            Mystic
                        </option>
                        <option value="Effect">
                            Effect
                        </option>
                    </select>
                </td>
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        EFFECT
                    </strong>
                        <br/> Public / GM Only <br/>
                    <span style="background-color: #ff0000;">
                        <button name="roll_SpellEffectCard" type="roll" value="!power {{
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    <span style="background-color: #f4c542;">
                        <button name="roll_GMSpellEffectCard" type="roll" value="/w gm @{Name} @{SpellName}
!power {{
--whisper|GM
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <input name="attr_SpellEffectNumber" type="number" value="0" style="width: 41px;"/>
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellEffect"></textarea>
                </td>
            </tr>
                    </tbody>
                </table>
            </td>
        </tr>
        </tbody>
    </table>
</fieldset>
</div>
<div class="sheet-section-circle2">
<fieldset class="repeating_spells2">
    <table style="width: 725px; height: 100%; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="1">
        <tbody>
            <tr style="height: 10px;">
                <td style="vertical-align: bottom; text-align: left; width: 20%; background-color: #bfbfbf;">
                    <strong>
                         SPELL NAME
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 30%; background-color: #bfbfbf;">
                    <input name="attr_SpellName" type="text" style= "width: 160px" />
                </td>
                <td style="vertical-align: bottom; text-align: right; width: 16%">
                    <strong>
                         RANGE
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 35%" />
                    <input name="attr_SpellRange" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style="height: 10px;">
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                         CIRCLE
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCircle" type="number" style="vertical-align: top;" value="2" disabled="true">
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                         DURATION
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellDurationNumber" type="number" style="vertical-align: top; width: 41px;" value="0">
                    <strong>+</strong>
                    <select class="SpellDurationRank" name="attr_SpellDurationRank" style= "width: 62px">
                        <option value="0">
                            Zero
                        </option>
                        <option value="@{SCRank}">
                            Rank
                        </option>
                    </select>
                    <select class="SpellDurationIncrement" name="attr_SpellDurationIncrement" style= "width: 77px">
                        <option value="Rounds">
                            Rounds
                        </option>
                        <option value="Minutes">
                            Minutes
                        </option>
                        <option value="Hours">
                            Hours
                        </option>
                    </select>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                        THREADS
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellThreads" type="number" value="0" style="width: 41px;"/>
                    TN
                    <input type="number" name="attr_SpellWeave" value="(@{SpellCircle}+4)" disabled="true" />
                    <strong>/</strong>
                    <input type="number" name="attr_SpellAttune" value="@{SpellCircle}+9" disabled="true" />
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                        CASTING
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCastTN" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 10px;">
                <td style="vertical-align: top; text-align: left;">
                    <strong>
                        EXTRA THREADS
                    </strong>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellXThreads"></textarea>
                </td>
                <td style="vertical-align: top; text-align: right;">
                    <strong>
                        SUCCESS LEVELS
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellXSuc" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        DAMAGE
                    </strong>
                        <br/> Public / GM Only / Target <br/>
                    <span style="background-color: #ff0000;">
                    <button name="roll_SpellDamStep" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WFStep}+@{SpellDamage}+@{EffBon}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{WFSUse}} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--?? @{SpellEffectNumber} <> 0 ?? Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    <span style="background-color: #f4c542;">
                    <button name="roll_GMSpellDamStep" type="roll" value="/w gm @{Name} @{SpellName}
!power {{
--whisper|GM
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WFStep}+@{SpellDamage}+@{EffBon}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{WFSUse}} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--?? @{SpellEffectNumber} <> 0 ?? Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    <span style="background-color: #004fce;">
                        <button name="roll_DamTarget" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--leftsub|Damage vs @{target|token_name}
--Step|[[ ?{Step|@{WFStep}+@{SpellDamage}+@{EffBon}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{WFSUse}} ]] Strain
--Damage after Armor|[[ {0d1, ceil(( { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{SpellDamType}) ) }kh1 ]]
--?? @{SpellEffectNumber} <> 0 ?? Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                        </button>
                    </span>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <strong>WIL +</strong>
                    <input name="attr_SpellDamage" type="number" value="0" style="width: 41px;"/>
                        <strong>/</strong>
                    <select class="SpellDamType" name="attr_SpellDamType" style= "width: 80px">
                        <option value="@{target|PA}">
                            Physical
                        </option>
                        <option value="@{target|MA}">
                            Mystic
                        </option>
                        <option value="Effect">
                            Effect
                        </option>
                    </select>
                </td>
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        EFFECT
                    </strong>
                        <br/> Public / GM Only <br/>
                    <span style="background-color: #ff0000;">
                        <button name="roll_SpellEffectCard" type="roll" value="!power {{
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    <span style="background-color: #f4c542;">
                        <button name="roll_GMSpellEffectCard" type="roll" value="/w gm @{Name} @{SpellName}
!power {{
--whisper|GM
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <input name="attr_SpellEffectNumber" type="number" value="0" style="width: 41px;"/>
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellEffect"></textarea>
                </td>
            </tr>
                    </tbody>
                </table>
            </td>
        </tr>
        </tbody>
    </table>
</fieldset>
</div>
<div class="sheet-section-circle3">
<fieldset class="repeating_spells3">
    <table style="width: 725px; height: 100%; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="1">
        <tbody>
            <tr style="height: 10px;">
                <td style="vertical-align: bottom; text-align: left; width: 20%; background-color: #bfbfbf;">
                    <strong>
                         SPELL NAME
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 30%; background-color: #bfbfbf;">
                    <input name="attr_SpellName" type="text" style= "width: 160px" />
                </td>
                <td style="vertical-align: bottom; text-align: right; width: 16%">
                    <strong>
                         RANGE
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 35%" />
                    <input name="attr_SpellRange" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style="height: 10px;">
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                         CIRCLE
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCircle" type="number" style="vertical-align: top;" value="3" disabled="true">
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                         DURATION
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellDurationNumber" type="number" style="vertical-align: top; width: 41px;" value="0">
                    <strong>+</strong>
                    <select class="SpellDurationRank" name="attr_SpellDurationRank" style= "width: 62px">
                        <option value="0">
                            Zero
                        </option>
                        <option value="@{SCRank}">
                            Rank
                        </option>
                    </select>
                    <select class="SpellDurationIncrement" name="attr_SpellDurationIncrement" style= "width: 77px">
                        <option value="Rounds">
                            Rounds
                        </option>
                        <option value="Minutes">
                            Minutes
                        </option>
                        <option value="Hours">
                            Hours
                        </option>
                    </select>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                        THREADS
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellThreads" type="number" value="0" style="width: 41px;"/>
                    TN
                    <input type="number" name="attr_SpellWeave" value="(@{SpellCircle}+4)" disabled="true" />
                    <strong>/</strong>
                    <input type="number" name="attr_SpellAttune" value="@{SpellCircle}+9" disabled="true" />
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                        CASTING
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCastTN" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 10px;">
                <td style="vertical-align: top; text-align: left;">
                    <strong>
                        EXTRA THREADS
                    </strong>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellXThreads"></textarea>
                </td>
                <td style="vertical-align: top; text-align: right;">
                    <strong>
                        SUCCESS LEVELS
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellXSuc" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        DAMAGE
                    </strong>
                        <br/> Public / GM Only / Target <br/>
                    <span style="background-color: #ff0000;">
                    <button name="roll_SpellDamStep" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WFStep}+@{SpellDamage}+@{EffBon}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{WFSUse}} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--?? @{SpellEffectNumber} <> 0 ?? Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    <span style="background-color: #f4c542;">
                    <button name="roll_GMSpellDamStep" type="roll" value="/w gm @{Name} @{SpellName}
!power {{
--whisper|GM
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WFStep}+@{SpellDamage}+@{EffBon}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{WFSUse}} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--?? @{SpellEffectNumber} <> 0 ?? Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    <span style="background-color: #004fce;">
                        <button name="roll_DamTarget" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--leftsub|Damage vs @{target|token_name}
--Step|[[ ?{Step|@{WFStep}+@{SpellDamage}+@{EffBon}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{WFSUse}} ]] Strain
--Damage after Armor|[[ {0d1, ceil(( { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{SpellDamType}) ) }kh1 ]]
--?? @{SpellEffectNumber} <> 0 ?? Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                        </button>
                    </span>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <strong>WIL +</strong>
                    <input name="attr_SpellDamage" type="number" value="0" style="width: 41px;"/>
                        <strong>/</strong>
                    <select class="SpellDamType" name="attr_SpellDamType" style= "width: 80px">
                        <option value="@{target|PA}">
                            Physical
                        </option>
                        <option value="@{target|MA}">
                            Mystic
                        </option>
                        <option value="Effect">
                            Effect
                        </option>
                    </select>
                </td>
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        EFFECT
                    </strong>
                        <br/> Public / GM Only <br/>
                    <span style="background-color: #ff0000;">
                        <button name="roll_SpellEffectCard" type="roll" value="!power {{
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    <span style="background-color: #f4c542;">
                        <button name="roll_GMSpellEffectCard" type="roll" value="/w gm @{Name} @{SpellName}
!power {{
--whisper|GM
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <input name="attr_SpellEffectNumber" type="number" value="0" style="width: 41px;"/>
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellEffect"></textarea>
                </td>
            </tr>
                    </tbody>
                </table>
            </td>
        </tr>
        </tbody>
    </table>
</fieldset>
</div>
<div class="sheet-section-circle4">
<fieldset class="repeating_spells4">
    <table style="width: 725px; height: 100%; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="1">
        <tbody>
            <tr style="height: 10px;">
                <td style="vertical-align: bottom; text-align: left; width: 20%; background-color: #bfbfbf;">
                    <strong>
                         SPELL NAME
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 30%; background-color: #bfbfbf;">
                    <input name="attr_SpellName" type="text" style= "width: 160px" />
                </td>
                <td style="vertical-align: bottom; text-align: right; width: 16%">
                    <strong>
                         RANGE
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 35%" />
                    <input name="attr_SpellRange" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style="height: 10px;">
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                         CIRCLE
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCircle" type="number" style="vertical-align: top;" value="4" disabled="true">
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                         DURATION
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellDurationNumber" type="number" style="vertical-align: top; width: 41px;" value="0">
                    <strong>+</strong>
                    <select class="SpellDurationRank" name="attr_SpellDurationRank" style= "width: 62px">
                        <option value="0">
                            Zero
                        </option>
                        <option value="@{SCRank}">
                            Rank
                        </option>
                    </select>
                    <select class="SpellDurationIncrement" name="attr_SpellDurationIncrement" style= "width: 77px">
                        <option value="Rounds">
                            Rounds
                        </option>
                        <option value="Minutes">
                            Minutes
                        </option>
                        <option value="Hours">
                            Hours
                        </option>
                    </select>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                        THREADS
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellThreads" type="number" value="0" style="width: 41px;"/>
                    TN
                    <input type="number" name="attr_SpellWeave" value="(@{SpellCircle}+4)" disabled="true" />
                    <strong>/</strong>
                    <input type="number" name="attr_SpellAttune" value="@{SpellCircle}+9" disabled="true" />
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                        CASTING
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCastTN" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 10px;">
                <td style="vertical-align: top; text-align: left;">
                    <strong>
                        EXTRA THREADS
                    </strong>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellXThreads"></textarea>
                </td>
                <td style="vertical-align: top; text-align: right;">
                    <strong>
                        SUCCESS LEVELS
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellXSuc" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        DAMAGE
                    </strong>
                        <br/> Public / GM Only / Target <br/>
                    <span style="background-color: #ff0000;">
                    <button name="roll_SpellDamStep" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WFStep}+@{SpellDamage}+@{EffBon}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{WFSUse}} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--?? @{SpellEffectNumber} <> 0 ?? Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    <span style="background-color: #f4c542;">
                    <button name="roll_GMSpellDamStep" type="roll" value="/w gm @{Name} @{SpellName}
!power {{
--whisper|GM
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WFStep}+@{SpellDamage}+@{EffBon}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{WFSUse}} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--?? @{SpellEffectNumber} <> 0 ?? Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    <span style="background-color: #004fce;">
                        <button name="roll_DamTarget" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--leftsub|Damage vs @{target|token_name}
--Step|[[ ?{Step|@{WFStep}+@{SpellDamage}+@{EffBon}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{WFSUse}} ]] Strain
--Damage after Armor|[[ {0d1, ceil(( { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{SpellDamType}) ) }kh1 ]]
--?? @{SpellEffectNumber} <> 0 ?? Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                        </button>
                    </span>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <strong>WIL +</strong>
                    <input name="attr_SpellDamage" type="number" value="0" style="width: 41px;"/>
                        <strong>/</strong>
                    <select class="SpellDamType" name="attr_SpellDamType" style= "width: 80px">
                        <option value="@{target|PA}">
                            Physical
                        </option>
                        <option value="@{target|MA}">
                            Mystic
                        </option>
                        <option value="Effect">
                            Effect
                        </option>
                    </select>
                </td>
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        EFFECT
                    </strong>
                        <br/> Public / GM Only <br/>
                    <span style="background-color: #ff0000;">
                        <button name="roll_SpellEffectCard" type="roll" value="!power {{
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    <span style="background-color: #f4c542;">
                        <button name="roll_GMSpellEffectCard" type="roll" value="/w gm @{Name} @{SpellName}
!power {{
--whisper|GM
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <input name="attr_SpellEffectNumber" type="number" value="0" style="width: 41px;"/>
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellEffect"></textarea>
                </td>
            </tr>
                    </tbody>
                </table>
            </td>
        </tr>
        </tbody>
    </table>
</fieldset>
</div>
<div class="sheet-section-circle5">
<fieldset class="repeating_spells5">
    <table style="width: 725px; height: 100%; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="1">
        <tbody>
            <tr style="height: 10px;">
                <td style="vertical-align: bottom; text-align: left; width: 20%; background-color: #bfbfbf;">
                    <strong>
                         SPELL NAME
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 30%; background-color: #bfbfbf;">
                    <input name="attr_SpellName" type="text" style= "width: 160px" />
                </td>
                <td style="vertical-align: bottom; text-align: right; width: 16%">
                    <strong>
                         RANGE
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 35%" />
                    <input name="attr_SpellRange" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style="height: 10px;">
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                         CIRCLE
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCircle" type="number" style="vertical-align: top;" value="5" disabled="true">
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                         DURATION
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellDurationNumber" type="number" style="vertical-align: top; width: 41px;" value="0">
                    <strong>+</strong>
                    <select class="SpellDurationRank" name="attr_SpellDurationRank" style= "width: 62px">
                        <option value="0">
                            Zero
                        </option>
                        <option value="@{SCRank}">
                            Rank
                        </option>
                    </select>
                    <select class="SpellDurationIncrement" name="attr_SpellDurationIncrement" style= "width: 77px">
                        <option value="Rounds">
                            Rounds
                        </option>
                        <option value="Minutes">
                            Minutes
                        </option>
                        <option value="Hours">
                            Hours
                        </option>
                    </select>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                        THREADS
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellThreads" type="number" value="0" style="width: 41px;"/>
                    TN
                    <input type="number" name="attr_SpellWeave" value="(@{SpellCircle}+4)" disabled="true" />
                    <strong>/</strong>
                    <input type="number" name="attr_SpellAttune" value="@{SpellCircle}+9" disabled="true" />
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                        CASTING
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCastTN" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 10px;">
                <td style="vertical-align: top; text-align: left;">
                    <strong>
                        EXTRA THREADS
                    </strong>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellXThreads"></textarea>
                </td>
                <td style="vertical-align: top; text-align: right;">
                    <strong>
                        SUCCESS LEVELS
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellXSuc" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        DAMAGE
                    </strong>
                        <br/> Public / GM Only / Target <br/>
                    <span style="background-color: #ff0000;">
                    <button name="roll_SpellDamStep" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WFStep}+@{SpellDamage}+@{EffBon}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{WFSUse}} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--?? @{SpellEffectNumber} <> 0 ?? Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    <span style="background-color: #f4c542;">
                    <button name="roll_GMSpellDamStep" type="roll" value="/w gm @{Name} @{SpellName}
!power {{
--whisper|GM
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WFStep}+@{SpellDamage}+@{EffBon}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{WFSUse}} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--?? @{SpellEffectNumber} <> 0 ?? Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    <span style="background-color: #004fce;">
                        <button name="roll_DamTarget" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--leftsub|Damage vs @{target|token_name}
--Step|[[ ?{Step|@{WFStep}+@{SpellDamage}+@{EffBon}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{WFSUse}} ]] Strain
--Damage after Armor|[[ {0d1, ceil(( { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{SpellDamType}) ) }kh1 ]]
--?? @{SpellEffectNumber} <> 0 ?? Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                        </button>
                    </span>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <strong>WIL +</strong>
                    <input name="attr_SpellDamage" type="number" value="0" style="width: 41px;"/>
                        <strong>/</strong>
                    <select class="SpellDamType" name="attr_SpellDamType" style= "width: 80px">
                        <option value="@{target|PA}">
                            Physical
                        </option>
                        <option value="@{target|MA}">
                            Mystic
                        </option>
                        <option value="Effect">
                            Effect
                        </option>
                    </select>
                </td>
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        EFFECT
                    </strong>
                        <br/> Public / GM Only <br/>
                    <span style="background-color: #ff0000;">
                        <button name="roll_SpellEffectCard" type="roll" value="!power {{
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    <span style="background-color: #f4c542;">
                        <button name="roll_GMSpellEffectCard" type="roll" value="/w gm @{Name} @{SpellName}
!power {{
--whisper|GM
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <input name="attr_SpellEffectNumber" type="number" value="0" style="width: 41px;"/>
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellEffect"></textarea>
                </td>
            </tr>
                    </tbody>
                </table>
            </td>
        </tr>
        </tbody>
    </table>
</fieldset>
</div>
<div class="sheet-section-circle6">
<fieldset class="repeating_spells6">
    <table style="width: 725px; height: 100%; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="1">
        <tbody>
            <tr style="height: 10px;">
                <td style="vertical-align: bottom; text-align: left; width: 20%; background-color: #bfbfbf;">
                    <strong>
                         SPELL NAME
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 30%; background-color: #bfbfbf;">
                    <input name="attr_SpellName" type="text" style= "width: 160px" />
                </td>
                <td style="vertical-align: bottom; text-align: right; width: 16%">
                    <strong>
                         RANGE
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 35%" />
                    <input name="attr_SpellRange" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style="height: 10px;">
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                         CIRCLE
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCircle" type="number" style="vertical-align: top;" value="6" disabled="true">
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                         DURATION
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellDurationNumber" type="number" style="vertical-align: top; width: 41px;" value="0">
                    <strong>+</strong>
                    <select class="SpellDurationRank" name="attr_SpellDurationRank" style= "width: 62px">
                        <option value="0">
                            Zero
                        </option>
                        <option value="@{SCRank}">
                            Rank
                        </option>
                    </select>
                    <select class="SpellDurationIncrement" name="attr_SpellDurationIncrement" style= "width: 77px">
                        <option value="Rounds">
                            Rounds
                        </option>
                        <option value="Minutes">
                            Minutes
                        </option>
                        <option value="Hours">
                            Hours
                        </option>
                    </select>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                        THREADS
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellThreads" type="number" value="0" style="width: 41px;"/>
                    TN
                    <input type="number" name="attr_SpellWeave" value="(@{SpellCircle}+4)" disabled="true" />
                    <strong>/</strong>
                    <input type="number" name="attr_SpellAttune" value="@{SpellCircle}+9" disabled="true" />
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                        CASTING
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCastTN" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 10px;">
                <td style="vertical-align: top; text-align: left;">
                    <strong>
                        EXTRA THREADS
                    </strong>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellXThreads"></textarea>
                </td>
                <td style="vertical-align: top; text-align: right;">
                    <strong>
                        SUCCESS LEVELS
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellXSuc" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        DAMAGE
                    </strong>
                        <br/> Public / GM Only / Target <br/>
                    <span style="background-color: #ff0000;">
                    <button name="roll_SpellDamStep" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WFStep}+@{SpellDamage}+@{EffBon}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{WFSUse}} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--?? @{SpellEffectNumber} <> 0 ?? Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    <span style="background-color: #f4c542;">
                    <button name="roll_GMSpellDamStep" type="roll" value="/w gm @{Name} @{SpellName}
!power {{
--whisper|GM
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WFStep}+@{SpellDamage}+@{EffBon}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{WFSUse}} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--?? @{SpellEffectNumber} <> 0 ?? Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    <span style="background-color: #004fce;">
                        <button name="roll_DamTarget" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--leftsub|Damage vs @{target|token_name}
--Step|[[ ?{Step|@{WFStep}+@{SpellDamage}+@{EffBon}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{WFSUse}} ]] Strain
--Damage after Armor|[[ {0d1, ceil(( { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{SpellDamType}) ) }kh1 ]]
--?? @{SpellEffectNumber} <> 0 ?? Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                        </button>
                    </span>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <strong>WIL +</strong>
                    <input name="attr_SpellDamage" type="number" value="0" style="width: 41px;"/>
                        <strong>/</strong>
                    <select class="SpellDamType" name="attr_SpellDamType" style= "width: 80px">
                        <option value="@{target|PA}">
                            Physical
                        </option>
                        <option value="@{target|MA}">
                            Mystic
                        </option>
                        <option value="Effect">
                            Effect
                        </option>
                    </select>
                </td>
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        EFFECT
                    </strong>
                        <br/> Public / GM Only <br/>
                    <span style="background-color: #ff0000;">
                        <button name="roll_SpellEffectCard" type="roll" value="!power {{
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    <span style="background-color: #f4c542;">
                        <button name="roll_GMSpellEffectCard" type="roll" value="/w gm @{Name} @{SpellName}
!power {{
--whisper|GM
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <input name="attr_SpellEffectNumber" type="number" value="0" style="width: 41px;"/>
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellEffect"></textarea>
                </td>
            </tr>
                    </tbody>
                </table>
            </td>
        </tr>
        </tbody>
    </table>
</fieldset>
</div>
<div class="sheet-section-circle7">
<fieldset class="repeating_spells7">
    <table style="width: 725px; height: 100%; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="1">
        <tbody>
            <tr style="height: 10px;">
                <td style="vertical-align: bottom; text-align: left; width: 20%; background-color: #bfbfbf;">
                    <strong>
                         SPELL NAME
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 30%; background-color: #bfbfbf;">
                    <input name="attr_SpellName" type="text" style= "width: 160px" />
                </td>
                <td style="vertical-align: bottom; text-align: right; width: 16%">
                    <strong>
                         RANGE
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 35%" />
                    <input name="attr_SpellRange" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style="height: 10px;">
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                         CIRCLE
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCircle" type="number" style="vertical-align: top;" value="7" disabled="true">
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                         DURATION
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellDurationNumber" type="number" style="vertical-align: top; width: 41px;" value="0">
                    <strong>+</strong>
                    <select class="SpellDurationRank" name="attr_SpellDurationRank" style= "width: 62px">
                        <option value="0">
                            Zero
                        </option>
                        <option value="@{SCRank}">
                            Rank
                        </option>
                    </select>
                    <select class="SpellDurationIncrement" name="attr_SpellDurationIncrement" style= "width: 77px">
                        <option value="Rounds">
                            Rounds
                        </option>
                        <option value="Minutes">
                            Minutes
                        </option>
                        <option value="Hours">
                            Hours
                        </option>
                    </select>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                        THREADS
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellThreads" type="number" value="0" style="width: 41px;"/>
                    TN
                    <input type="number" name="attr_SpellWeave" value="(@{SpellCircle}+4)" disabled="true" />
                    <strong>/</strong>
                    <input type="number" name="attr_SpellAttune" value="@{SpellCircle}+9" disabled="true" />
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                        CASTING
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCastTN" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 10px;">
                <td style="vertical-align: top; text-align: left;">
                    <strong>
                        EXTRA THREADS
                    </strong>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellXThreads"></textarea>
                </td>
                <td style="vertical-align: top; text-align: right;">
                    <strong>
                        SUCCESS LEVELS
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellXSuc" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        DAMAGE
                    </strong>
                        <br/> Public / GM Only / Target <br/>
                    <span style="background-color: #ff0000;">
                    <button name="roll_SpellDamStep" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WFStep}+@{SpellDamage}+@{EffBon}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{WFSUse}} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--?? @{SpellEffectNumber} <> 0 ?? Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    <span style="background-color: #f4c542;">
                    <button name="roll_GMSpellDamStep" type="roll" value="/w gm @{Name} @{SpellName}
!power {{
--whisper|GM
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WFStep}+@{SpellDamage}+@{EffBon}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{WFSUse}} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--?? @{SpellEffectNumber} <> 0 ?? Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    <span style="background-color: #004fce;">
                        <button name="roll_DamTarget" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--leftsub|Damage vs @{target|token_name}
--Step|[[ ?{Step|@{WFStep}+@{SpellDamage}+@{EffBon}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{WFSUse}} ]] Strain
--Damage after Armor|[[ {0d1, ceil(( { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{SpellDamType}) ) }kh1 ]]
--?? @{SpellEffectNumber} <> 0 ?? Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                        </button>
                    </span>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <strong>WIL +</strong>
                    <input name="attr_SpellDamage" type="number" value="0" style="width: 41px;"/>
                        <strong>/</strong>
                    <select class="SpellDamType" name="attr_SpellDamType" style= "width: 80px">
                        <option value="@{target|PA}">
                            Physical
                        </option>
                        <option value="@{target|MA}">
                            Mystic
                        </option>
                        <option value="Effect">
                            Effect
                        </option>
                    </select>
                </td>
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        EFFECT
                    </strong>
                        <br/> Public / GM Only <br/>
                    <span style="background-color: #ff0000;">
                        <button name="roll_SpellEffectCard" type="roll" value="!power {{
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    <span style="background-color: #f4c542;">
                        <button name="roll_GMSpellEffectCard" type="roll" value="/w gm @{Name} @{SpellName}
!power {{
--whisper|GM
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <input name="attr_SpellEffectNumber" type="number" value="0" style="width: 41px;"/>
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellEffect"></textarea>
                </td>
            </tr>
                    </tbody>
                </table>
            </td>
        </tr>
        </tbody>
    </table>
</fieldset>
</div>
<div class="sheet-section-circle8">
<fieldset class="repeating_spells8">
    <table style="width: 725px; height: 100%; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="1">
        <tbody>
            <tr style="height: 10px;">
                <td style="vertical-align: bottom; text-align: left; width: 20%; background-color: #bfbfbf;">
                    <strong>
                         SPELL NAME
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 30%; background-color: #bfbfbf;">
                    <input name="attr_SpellName" type="text" style= "width: 160px" />
                </td>
                <td style="vertical-align: bottom; text-align: right; width: 16%">
                    <strong>
                         RANGE
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 35%" />
                    <input name="attr_SpellRange" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style="height: 10px;">
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                         CIRCLE
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCircle" type="number" style="vertical-align: top;" value="8" disabled="true">
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                         DURATION
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellDurationNumber" type="number" style="vertical-align: top; width: 41px;" value="0">
                    <strong>+</strong>
                    <select class="SpellDurationRank" name="attr_SpellDurationRank" style= "width: 62px">
                        <option value="0">
                            Zero
                        </option>
                        <option value="@{SCRank}">
                            Rank
                        </option>
                    </select>
                    <select class="SpellDurationIncrement" name="attr_SpellDurationIncrement" style= "width: 77px">
                        <option value="Rounds">
                            Rounds
                        </option>
                        <option value="Minutes">
                            Minutes
                        </option>
                        <option value="Hours">
                            Hours
                        </option>
                    </select>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                        THREADS
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellThreads" type="number" value="0" style="width: 41px;"/>
                    TN
                    <input type="number" name="attr_SpellWeave" value="(@{SpellCircle}+4)" disabled="true" />
                    <strong>/</strong>
                    <input type="number" name="attr_SpellAttune" value="@{SpellCircle}+9" disabled="true" />
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                        CASTING
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCastTN" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 10px;">
                <td style="vertical-align: top; text-align: left;">
                    <strong>
                        EXTRA THREADS
                    </strong>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellXThreads"></textarea>
                </td>
                <td style="vertical-align: top; text-align: right;">
                    <strong>
                        SUCCESS LEVELS
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellXSuc" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        DAMAGE
                    </strong>
                        <br/> Public / GM Only / Target <br/>
                    <span style="background-color: #ff0000;">
                    <button name="roll_SpellDamStep" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WFStep}+@{SpellDamage}+@{EffBon}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{WFSUse}} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--?? @{SpellEffectNumber} <> 0 ?? Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    <span style="background-color: #f4c542;">
                    <button name="roll_GMSpellDamStep" type="roll" value="/w gm @{Name} @{SpellName}
!power {{
--whisper|GM
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WFStep}+@{SpellDamage}+@{EffBon}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{WFSUse}} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--?? @{SpellEffectNumber} <> 0 ?? Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    <span style="background-color: #004fce;">
                        <button name="roll_DamTarget" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--leftsub|Damage vs @{target|token_name}
--Step|[[ ?{Step|@{WFStep}+@{SpellDamage}+@{EffBon}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{WFSUse}} ]] Strain
--Damage after Armor|[[ {0d1, ceil(( { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{SpellDamType}) ) }kh1 ]]
--?? @{SpellEffectNumber} <> 0 ?? Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                        </button>
                    </span>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <strong>WIL +</strong>
                    <input name="attr_SpellDamage" type="number" value="0" style="width: 41px;"/>
                        <strong>/</strong>
                    <select class="SpellDamType" name="attr_SpellDamType" style= "width: 80px">
                        <option value="@{target|PA}">
                            Physical
                        </option>
                        <option value="@{target|MA}">
                            Mystic
                        </option>
                        <option value="Effect">
                            Effect
                        </option>
                    </select>
                </td>
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        EFFECT
                    </strong>
                        <br/> Public / GM Only <br/>
                    <span style="background-color: #ff0000;">
                        <button name="roll_SpellEffectCard" type="roll" value="!power {{
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    <span style="background-color: #f4c542;">
                        <button name="roll_GMSpellEffectCard" type="roll" value="/w gm @{Name} @{SpellName}
!power {{
--whisper|GM
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <input name="attr_SpellEffectNumber" type="number" value="0" style="width: 41px;"/>
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellEffect"></textarea>
                </td>
            </tr>
                    </tbody>
                </table>
            </td>
        </tr>
        </tbody>
    </table>
</fieldset>
</div>
</div>
<div class="sheet-section-treasury"> <!-- Treasury Tab -->
<p></p>
<h3>
    Total Legend Points <input name="attr_LegendPoints" style="width: 100px;" type="number" value="0" />
    Renown <input name="attr_Renown" type="number" value="16" />
    Reputation <input name="attr_Reputation" type="number" value="0" style="width: 41px;"/>
</h3>
<p></p>
<table style="width: 725px;" cellspacing="1" cellpadding="1">
    <tr>
        <td style="vertical-align: top">
            <h3>
                Total Silver Value
                <input disabled="disabled" style="width: 100px" name="attr_TotalSilver" type="number" value="(@{Copper}/10)+@{Silver}+(@{Gold}*10)+(@{EarthCoin}*100)+(@{WaterCoin}*100)+(@{AirCoin}*1000)+(@{FireCoin}*1000)+(@{OrichalcumCoin}*10000)" />
            </h3>
        </td>
        <td></td>
        <td>
            <h3>
                Carrying Capacity <input name="attr_CarryCap" style="width: 50px;" type="number" value="80"/>
            </h3>
        </td>
    </tr>
    <tr>
        <td>
            <table style="width: 250px; background-color: #FFFFFF;" border="1" cellspacing="0" cellpadding="2">
                <tbody>
                    <tr>
                        <td>
                        <strong>
                            COINS
                        </strong>
                        </td>
                        <td style="text-align: center">
                            <strong>Number</strong>
                        </td>
                    </tr>
                    <tr style="background-color: #f3e5d8;">
                        <td>
                            Copper
                        </td>
                        <td style="text-align: center">
                            <input name="attr_Copper" type="number" value="0" style="width: 100px;" />
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Silver
                        </td>
                        <td style="text-align: center">
                            <input name="attr_Silver" type="number" value="0" style="width: 100px;"/>
                        </td>
                    </tr>
                    <tr style="background-color: #f3e5d8;">
                        <td>
                            Gold
                        </td>
                        <td style="text-align: center">
                            <input name="attr_Gold" type="number" value="0" style="width: 100px;"/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Earth Coin
                        </td>
                        <td style="text-align: center">
                            <input name="attr_EarthCoin" type="number" value="0" style="width: 100px;"/>
                        </td>
                    </tr>
                    <tr style="background-color: #f3e5d8;">
                        <td>
                            Water Coin
                        </td>
                        <td style="text-align: center">
                            <input name="attr_WaterCoin" type="number" value="0" style="width: 100px;"/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Air Coin
                        </td>
                        <td style="text-align: center">
                            <input name="attr_AirCoin" type="number" value="0" style="width: 100px;"/>
                        </td>
                    </tr>
                    <tr style="background-color: #f3e5d8;">
                        <td>
                            Fire Coin
                        </td>
                        <td style="text-align: center">
                            <input name="attr_FireCoin" type="number" value="0" style="width: 100px;"/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Orichalcum Coin
                        </td>
                        <td style="text-align: center">
                            <input name="attr_OrichalcumCoin" type="number" value="0" style="width: 100px;"/>
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td style="width: 50px">
        </td>
    <td style="vertical-align: top;">
        <h3>Miscelaneous Gear</h3>
        <textarea class="text-input-noback" style="width:350px; height:20px" name="attr_MiscTreasure"></textarea>
    </td>
    </tr>
</table>
<p></p>
    </div>
<div class="sheet-section-NPC"><!-- NPC Tab -->
<p></p>
<table style="width: 725px; height: 250px;" cellpadding="0"> <!-- NPC Attributes & Defenses table -->
    <tbody>
        <tr>
            <td style="vertical-align: top;">
                <table style="width: 355px; height: 100%; background-color: #FFFFFF;" border="5" cellpadding="3"> <!-- NPC Attributes Table -->
                <tbody>
                    <tr style="background-color: #f3e5d8;">
                        <td style="vertical-align: bottom; text-align: center; height:15px; width: 22%">
                            <blockquote>
                                <strong>
                                    ATTRIBUTES
                                </strong>
                            </blockquote>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 38%" colspan="2">
                            <blockquote>
                                <strong>
                                    STEP
                                </strong>
                            </blockquote>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 27%">
                            <blockquote>
                                <strong>
                                    ROLL
                                </strong>
                            </blockquote>
                        </td>
                    </tr>
                    <tr>
                        <td style="vertical-align: bottom; text-align: left; height:15px">
                            <strong>
                                Dexterity
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center">
                            <strong>Base</strong> <br/>
                            <input name="attr_DexStep" type="number" value="5" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: bottom; text-align: center;">
                            <strong>Modifier</strong> 
                            <input name="attr_DexMod" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: bottom; text-align: center;">
                            Public / GM <br/>
                            <span style="background-color: #ff0000;">
                                <strong>
                                    <button name="roll_DexStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Dexterity**
--Step|[[ ?{Step|@{DexStep}+@{DexMod}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            <span style="background-color: #f4c542;">
                                <strong>
                                    <button name="roll_GMDexStep" type="roll" value="/w gm @{Name} Dexterity
!power {{
--whisper|GM
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Dexterity**
--Step|[[ ?{Step|@{DexStep}+@{DexMod}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                        </td>
                    </tr>
                    <tr style="background-color: #f3e5d8;">
                        <td style="text-align: left;">
                            <strong>
                                Strength
                            </strong>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_StrStep" type="number" value="5" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_StrMod" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <span style="background-color: #ff0000;">
                                <strong>
                                    <button name="roll_StrStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Strength**
--Step|[[ ?{Step|@{StrStep}+@{StrMod}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            <span style="background-color: #f4c542;">
                                <strong>
                                    <button name="roll_GMStrStep" type="roll" value="/w gm @{Name} Strength
!power {{
--whisper|GM
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Strength**
--Step|[[ ?{Step|@{StrStep}+@{StrMod}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>
                                Toughness
                            </strong>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_TouStep" type="number" value="5" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_TouMod" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <span style="background-color: #ff0000;">
                                <strong>
                                    <button name="roll_TouStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Toughness**
--Step|[[ ?{Step|@{TouStep}+@{TouMod}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            <span style="background-color: #f4c542;">
                                <strong>
                                    <button name="roll_GMTouStep" type="roll" value="/w gm @{Name} Toughness
!power {{
--whisper|GM
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Toughness**
--Step|[[ ?{Step|@{TouStep}+@{TouMod}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                        </td>
                    </tr>
                    <tr style="background-color: #f3e5d8;">
                        <td style="text-align: left;">
                            <strong>
                                Perception
                            </strong>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_PerStep" type="number" value="5" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_PerMod" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <span style="background-color: #ff0000;">
                                <strong>
                                    <button name="roll_PerStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Perception**
--Step|[[ ?{Step|@{PerStep}+@{PerMod}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            <span style="background-color: #f4c542;">
                                <strong>
                                    <button name="roll_GMPerStep" type="roll" value="/w gm @{Name} Perception
!power {{
--whisper|GM
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Perception**
--Step|[[ ?{Step|@{PerStep}+@{PerMod}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>
                                Willpower
                            </strong>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_WilStep" type="number" value="5" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_WilMod" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <span style="background-color: #ff0000;">
                                <strong>
                                    <button name="roll_WilStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Willpower**
--Step|[[ ?{Step|@{WilStep}+@{WilMod}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            <span style="background-color: #f4c542;">
                                <strong>
                                    <button name="roll_GMWilStep" type="roll" value="/w gm @{Name} Willpower
!power {{
--whisper|GM
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Willpower**
--Step|[[ ?{Step|@{WilStep}+@{WilMod}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                        </td>
                    </tr>
                    <tr style="background-color: #f3e5d8;">
                        <td style="text-align: left;">
                            <strong>
                                Charisma
                            </strong>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_ChaStep" type="number" value="5" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_ChaMod" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <span style="background-color: #ff0000;">
                                <strong>
                                    <button name="roll_ChaStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Charisma**
--Step|[[ ?{Step|@{ChaStep}+@{ChaMod}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            <span style="background-color: #f4c542;">
                                <strong>
                                    <button name="roll_GMChaStep" type="roll" value="/w gm @{Name} Charisma
!power {{
--whisper|GM
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Charisma**
--Step|[[ ?{Step|@{ChaStep}+@{ChaMod}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>
                                Initiative
                            </strong>
                        </td>
                        <td style="text-align: center; vertical-align: bottom">
                            <strong>
                                Penalty
                            </strong>
                            <input disabled name="attr_ArmorMod" type="number" value="(@{ArmorInitMod}+@{ShieldInitMod})" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center; vertical-align: bottom">
                            <input name="attr_InitMod" type="number" value="0" style="width: 35px;"/>
                        </td>
                        <td style="text-align: center;">
                            <span style="background-color: #ff0000;">
                                <strong>
                                    <button name="roll_InitStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Initiative**
--Step|[[ ?{Step|@{InitTotal}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [TRKR] [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td style="vertical-align: top;"> <!-- Defenses Table -->
            <table style="width: 360px; height: 100%; float: left; background-color: #FFFFFF;" border="5" cellpadding="3">
            <tbody>
                <tr style="background-color: #f3e5d8;">
                    <td style="width: 22%;">
                    </td>
                    <td style="vertical-align: bottom; text-align: center; height:15px" colspan="2">
                        <strong>
                            DEFENSE
                        </strong>
                    </td>
                    <td style="vertical-align: bottom; text-align: center; width: 40%" colspan="2">
                        <strong>
                            ARMOR
                        </strong>
                    </td>
                </tr>
                <tr>
                    <td style="vertical-align: bottom; text-align: right; height:15px">
                        <strong>
                            Physical
                        </strong>
                    </td>
                    <td style="vertical-align: bottom; text-align: center; width: 17%;">
                        <strong>Base</strong> <br/>
                        <input name="attr_PD_Base" type="number" value="6" style="width: 41px;"/>
                    </td>
                    <td style="vertical-align: bottom; text-align: center; width: 20%;">
                        <strong>Modifier</strong> <br/>
                        <input name="attr_PD_Mod" type="number" value="0" style="width: 45px;"/>
                    </td>
                    <td style="vertical-align: bottom; text-align: center; width: 23%;">
                        <strong>Base</strong> <br/>
                        <input name="attr_PA_Base" type="number" value="0" style="width: 41px;"/>
                    </td>
                    <td style="vertical-align: bottom; text-align: center; width: 21%;">
                        <strong>Modifier</strong> <br/>
                        <input name="attr_PA_Mod" type="number" value="0" style="width: 45px;"/>
                    </td>
                </tr>
                <tr style="background-color: #f3e5d8;">
                    <td style="vertical-align: center; text-align: right;">
                        <strong>
                            Mystic
                        </strong>
                    </td>
                    <td style="text-align: center;">
                        <input name="attr_MD_Base" type="number" value="6" style="width: 41px;"/>
                    </td>
                    <td style="text-align: center;">
                        <input name="attr_MD_Mod" type="number" value="0" style="width: 45px;"/>
                    </td>
                    <td style="text-align: center;" />
                        <input name="attr_MA_Base" type="number" value="2" style="width: 41px;"/>
                    </td>
                    <td style="text-align: center;">
                        <input name="attr_MA_Mod" type="number" value="0" style="width: 45px;"/>
                    </td>
                </tr>
                <tr>
                    <td style="vertical-align: center; text-align: right;">
                        <strong>
                            Social
                        </strong>
                    </td>
                    <td style="text-align: center;">
                        <input name="attr_SD_Base" type="number" value="6" style="width: 41px;"/>
                    </td>
                    <td style="text-align: center;">
                        <input name="attr_SD_Mod" type="number" value="0" style="width: 45px;"/>
                    </td>
                    <td style="vertical-align: middle;">
                        <strong>
                            Blood Magic
                        </strong>
                    </td>
                    <td style="vertical-align: middle; text-align: center;">
                        <input name="attr_BloodMagic" type="number" value="0" style="width: 40px;"/>
                    </td>
                </tr>
                <tr style="background-color: #f3e5d8;">
                    <td>
                        <strong>
                            Race
                        </strong>
                    </td>
                    <td colspan="2">
                        <input name="attr_Race" type="text" style="width:100px;"/>
                    </td>
                    <td>
                        <strong>
                            Karma Step
                        </strong>
                    </td>
                    <td style="width: 50px; vertical-align: center; text-align: center;">
                        <input name="attr_KarmaStep" type="number" value="4" style="width: 41px;"/>
                    </td>
                </tr>
                <tr>
                    <td>
                        <strong>
                            Discipline 1
                        </strong>
                    </td>
                    <td colspan="2">
                        <input name="attr_Discipline1" type="text" style="width:100px"/>
                    </td>
                    <td>
                        <strong>
                            Circle
                        </strong>
                    </td>
                    <td style="width: 50px; vertical-align: center; text-align: center;">
                        <input name="attr_Dis1Circle" type="number" value="1" style="width: 41px;"/>
                    </td>
                </tr>
                <tr style="background-color: #f3e5d8;">
                    <td>
                        <strong>
                            Discipline 2
                        </strong>
                    </td>
                    <td colspan="2">
                        <input name="attr_Discipline2" type="text" style="width:100px"/>
                    </td>
                    <td>
                        <strong>
                            Circle
                        </strong>
                    </td>
                    <td style="vertical-align: center; text-align: center;">
                        <input name="attr_Dis2Circle" type="number" value="0" style="width: 41px;"/>
                    </td>
                </tr>
                <tr>
                    <td style="vertical-align: middle;">
                        <strong>
                            Recovery
                        </strong>
                    </td>
                    <td style="text-align: center; vertical-align: bottom;">
                        <strong>
                            Per Day
                        </strong>
                        <input name="attr_Recovery_max" type="number" value="1" style="width: 41px;"/>
                    </td>
                    <td style="text-align: center; vertical-align: bottom;">
                        <strong>
                            Current
                        </strong>
                        <input name="attr_Recovery" type="number" value="1" style="width: 41px;"/>
                    </td>
                    <td style="text-align: center; vertical-align: bottom;">
                        <strong>
                            Karma?
                        </strong>
                        <select class="RecoveryKarma" name="attr_RecoveryKarma" style= "width: 57px; height: 23px">
                            <option value="No">
                                No
                            </option>
                            <option value="Yes">
                                Yes
                            </option>
                        </select>
                    </td>
                    <td style="text-align: center; vertical-align: middle;">
                        <span style="background-color: #ff0000;">
                            <button name="roll_Recovery" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Recovery**
--Step|[[ ?{Step|@{TouStep}+@{TouMod}+@{ActionMod}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Damage Healed|[[ {1d1, ceil(( { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - ?{Wounds|@{Wounds}}) ) }kh1 ]]
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
--Recovery|-1
}}">
                            </button>
                        </span>
                    </td>
                </tr>
            </tbody>
        </table>
    </td>
</tr>
</tbody>
</table>
<p></p>
<h3>Actions <input name="attr_Actions" style="width: 41px;" type="number" value="1"/> </h3>
<fieldset class="repeating_meleeweapons">
<table style="width: 725px; height: 70px;" border="1">
<tbody>
    <tr>
        <td>
            <table style="width: 100%; background-color: #FFFFFF;" border="5">
                <tbody>
                    <tr style="background-color: #bfbfbf">
                        <td style="text-align: left; vertical-align: bottom; width: 160px" >
                            <strong>
                                NAME
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 45px">
                            <strong>
                                STEP
                            </strong>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                Vs DEFENSE
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 135px">
                            <strong>
                                ATTACK
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 45px; color: #eaeaea; background-color: #dd0000">
                            <strong>
                                STEP
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px; color: #eaeaea; background-color: #dd0000">
                            <strong>
                                Vs ARMOR
                            </strong>
                        </td>                        
                        <td style="vertical-align: bottom; text-align: center; width: 130px; color: #eaeaea; background-color: #dd0000">
                            <strong>
                                DAMAGE
                            </strong>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left; vertical-align: top;">
                            <input name="attr_NPCWeaponName" type="text" style= "width: 150px"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_NPCAtkStep" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <select class="NPCWeaponDefense" name="attr_NPCWeaponDefense" style= "width: 80px">
                                <option value="@{target|PD}">
                                    Physical
                                </option>
                                <option value="@{target|MD}">
                                    Mystic
                                </option>
                                <option value="@{target|SD}">
                                    Social
                                </option>
                            </select>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            Public/GM Only/Target <br/>
                            <span style="background-color: #ff0000;">
                                <button name="roll_NPCAtkStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{NPCWeaponName}**
--leftsub|Attack
--Step|[[ ?{Step|@{NPCAtkStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            <span style="background-color: #f4c542;">
                                <button name="roll_NPCAtkStepGM" type="roll" value="/w gm @{Name} @{NPCWeaponName}
!power {{
--whisper|GM
--format|grey
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{NPCWeaponName}**
--leftsub|Attack
--Step|[[ ?{Step|@{NPCAtkStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            <span style="background-color: #004fce;">
                                <button name="roll_NPCAtkTarget" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{NPCWeaponName}**
--leftsub|Attack vs @{target|token_name}
--Step|[[ ?{Step|@{NPCAtkStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result:|**[^Result.base]**
--Successes| [[ floor(([$Result] { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{NPCWeaponDefense}) / 5)+1 ]]
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_NPCDamStep" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <select class="NPCWeaponDamType" name="attr_NPCWeaponDamType" style= "width: 80px">
                                <option value="@{target|PA}">
                                    Physical
                                </option>
                                <option value="@{target|MA}">
                                    Mystic
                                </option>
                            </select>
                        </td>                        
                        <td style="vertical-align: top; text-align: center;">
                            Public/GM Only/Target <br/>
                            <span style="background-color: #ff0000;">
                                <button name="roll_NPCDamStep" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{NPCWeaponName}**
--leftsub|Damage
--Step|[[ ?{Step|@{NPCDamStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            <span style="background-color: #f4c542;">
                                <button name="roll_NPCDamStepGM" type="roll" value="/w gm @{Name} @{NPCWeaponName}
!power {{
--whisper|GM
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{NPCWeaponName}**
--leftsub|Damage
--Step|[[ ?{Step|@{NPCDamStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            <span style="background-color: #004fce;">
                                <button name="roll_NPCDamTarget" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{NPCWeaponName}**
--leftsub|Damage vs @{target|token_name}
--Step|[[ ?{Step|@{NPCDamStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Damage after Armor|[[ {0d1, ceil(( { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{NPCWeaponDamType}) ) }kh1 ]]
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left; vertical-align: top;" rowspan="1">
                            <strong>
                                SPECIAL
                            </strong>
                        </td>
                        <td style="text-align: left; vertical-align: top" colspan="6" rowspan="1">
                            <textarea class="text-input-noback" style="width:90%; height:20px" name="attr_NPCWeaponSpecial"></textarea>
                        </td>
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
    </tr>
</tbody>
</table>
</fieldset>
<p></p>
<h3>Powers</h3>
<fieldset class="repeating_powers">
<table style="width: 725px; height: 100px;" border="1">
<tbody>
    <tr>
        <td>
            <table style="width: 100%; height: 100%; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="1">
                <tbody>
                    <tr style="background-color: #ffa31a;">
                        <td style="text-align: left; vertical-align: bottom; width: 140px;">
                            <strong>
                                POWER
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                STEP
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                RANK
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                BONUS
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                ATTR
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                STRAIN
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 70px">
                            <strong>
                                ACTION
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 75px">
                            <strong>
                                Vs DEFENSE
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 170px">
                            <strong>
                                DURATION
                            </strong>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left; vertical-align: top;">
                            <input name="attr_PowerName" type="text" style= "width: 135px"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input disabled="disabled" name="attr_PowerStep" type="number" value="@{AttrStep}+@{PowerRank}+@{PowerBonus}" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_PowerRank" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_PowerBonus" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: left;">
                            <select class="AttrStep" name="attr_AttrStep" style= "width: 60px">
                                <option value="0">
                                    None
                                </option>
                                <option value="@{DexStep}+@{DexMod}">
                                    DEX
                                </option>
                                <option value="@{StrStep}+@{StrMod}">
                                    STR
                                </option>
                                <option value="@{TouStep}+@{TouMod}">
                                    TOU
                                </option>
                                <option value="@{PerStep}+@{PerMod}">
                                    PER
                                </option>
                                <option value="@{WilStep}+@{WilMod}">
                                    WIL
                                </option>
                                <option value="@{ChaStep}+@{ChaMod}">
                                    CHA
                                </option>
                            </select>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_PowerStrain" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <select class="PowerAction" name="attr_PowerAction" style= "width: 90px">
                                <option value="Free">
                                    Free
                                </option>
                                <option value="Simple">
                                    Simple
                                </option>
                                <option value="Standard">
                                    Standard
                                </option>
                                <option value="Sustained">
                                    Sustained
                                </option>
                            </select>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <select class="PowerDefense" name="attr_PowerDefense" style= "width: 80px">
                                <option value="None">
                                    None
                                </option>
                                <option value="@{target|PD}">
                                    Physical
                                </option>
                                <option value="@{target|MD}">
                                    Mystic
                                </option>
                                <option value="@{target|SD}">
                                    Social
                                </option>
                            </select>
                        </td>
                        
                        <td style="vertical-align: top; text-align: center;" rowspan="2">
                                <input name="attr_PowerDurationNumber" type="number" style="vertical-align: top; width: 41px;" value="0">
                                <strong>+</strong>
                                <select class="PowerDurationRank" name="attr_PowerDurationRank" style= "width: 62px">
                                    <option value="0">
                                        Zero
                                    </option>
                                    <option value="@{PowerRank}">
                                        Rank
                                    </option>
                                </select>
                                <strong>=</strong><br/>
                                <input disabled="disabled" name="attr_PowerDurationTotal" type="number" style="vertical-align: top; width: 38px;" value="@{PowerDurationNumber}+@{PowerDurationRank}">
                                <select class="PowerDurationIncrement" name="attr_PowerDurationIncrement" style= "width: 77px">
                                    <option value="Rounds">
                                        Rounds
                                    </option>
                                    <option value="Minutes">
                                        Minutes
                                    </option>
                                    <option value="Hours">
                                        Hours
                                    </option>
                                    <option value="Days">
                                        Days
                                    </option>
                                </select>
                            </td>
                    </tr>
                    <tr>
                        <td style="vertical-align: top; text-align: center;">
                            Public / GM Only / Target<br/>
                            <span style="background-color: #ff0000;">
                                <button name="roll_PowerStep" type="roll" value="!power {{
--format|gold
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{PowerName}**
--Step|[[ ?{Step|@{PowerStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{PowerStrain}} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--?? @{PowerDurationTotal} > 0 ?? Duration| @{PowerDurationTotal} @{PowerDurationIncrement}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            <span style="background-color: #f4c542;">
                                <button name="roll_PowerStepGM" type="roll" value="/w gm @{Name} @{PowerName}
!power {{
--whisper|GM
--format|gold
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{PowerName}**
--Step|[[ ?{Step|@{PowerStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{PowerStrain}} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--?? @{PowerDurationTotal} > 0 ?? Duration| @{PowerDurationTotal} @{PowerDurationIncrement}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            <span style="background-color: #004fce;">
                                <button name="roll_PowerTarget" type="roll" value="!power {{
--format|gold
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{PowerName}**
--leftsub|vs @{target|token_name}
--Step|[[ ?{Step|@{PowerStep}+@{ActionMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{PowerStrain}} ]] Strain
--Result:|**[^Result.base]**
--Successes| [[ floor(([$Result] { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{PowerDefense}) / 5)+1 ]]
--?? @{PowerDurationTotal} > 0 ?? Duration| @{PowerDurationTotal} @{PowerDurationIncrement}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                        </td>
                        <td style="text-align: center; vertical-align: top;">
                            <strong>
                                NOTES
                            </strong>
                            <button name="roll_PowerDesc" type="roll" value="@{PowerName}: @{PowerDesc}">
                            </button>
                        </td>
                        <td style="text-align: left; vertical-align: top;" colspan="6" rowspan="1">
                            <textarea class="text-input-noback" style="width:90%; height:20px" name="attr_PowerDesc"></textarea>
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
    </tr>
</tbody>
</table>
</fieldset>
<p></p>
<h3>Special Maneuvers</h3>
<fieldset class="repeating_SpecialManeuvers">
<table style="width: 725px; height: 50px;" border="1">
<tbody>
    <tr>
        <td>
            <table style="width: 100%; height: 100%; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="2">
                <tbody>
                    <tr>
                        <td style="text-align: left; vertical-align: top; width: 50px">
                            <strong>
                                NAME
                            </strong>
                        </td>
                        <td style="vertical-align: top;">
                            <textarea class="text-input-noback" style="width:90%; height:20px" name="attr_SpecialName"></textarea>
                        </td>
                        <td style="text-align: left; vertical-align: top; width: 60px">
                            <strong>
                                TRIGGER
                            </strong>
                        </td>
                        <td style="vertical-align: top;">
                            <textarea class="text-input-noback" style="width:90%; height:20px" name="attr_SpecialTrigger"></textarea>
                        </td>
                        <td style="text-align: left; vertical-align: top; width: 60px">
                            <strong>
                                EFFECT
                            </strong>
                        </td>
                        <td style="vertical-align: top;">
                            <textarea class="text-input-noback" style="width:90%; height:20px" name="attr_SpecialEffect"></textarea>
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
    </tr>
</tbody>
</table>
</fieldset>
</div>
</div>
