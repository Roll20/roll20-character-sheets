<div class="sheet-maincontainer">
  <div class="sheet-onebloc">
    <input
      type="text"
      placeholder="Character Name"
      name="attr_character_name"
    />
  </div>

  <!-- COLORS & RULES -->
  <input
    type="text"
    name="attr_scriptcard_color"
    value="
--#bodyFontFace|Questrial, sans-serif
--#subtitleFontFace|Questrial, sans-serif
--#titleFontFace|Questrial, sans-serif
--/|[•••••••••••]
--#titleCardBackground|@{character_dice-color}
--/|[•••••••••••]
--#oddRowBackground|#1f1f1f
--#evenRowBackground|#1f1f1f
--#oddRowFontColor|#bdbdbd
--#evenRowFontColor|#bdbdbd
--#rollhilightcolornormal|#bdbdbd
--#rollhilightcolorfumble|#ff6821
--#rollhilightcolorcrit|#21ddff
--#buttonBackground|#1e2021
--#buttonFontSize|18px
--#buttonFontFace|Questrial, sans-serif
--#buttonPadding|10px 15px 10px 15px
--#buttonBorderColor|9e83bd
--#subtitleFontColor|white
--#buttonBorderColor|red
--#subtitleFontColor|black
--#tableShadow|0px 0px 0px 0px
"
    class="hidden"
  />

  <input
    type="text"
    class="sheet-hidden"
    name="attr_skillsroll"
    value="--#title|[&Skill]
  --#leftsub|@{character_name}
  --#rightsub|[&Dices]D6+[&Mod]

  --+|[f5]&nbsp;[/f]

  --=Reliable|[&Reliable]
  --=Dulled|[&Dulled]

  --?[$Dulled] -eq 0|Dulled6 --^Next|
  --:Dulled6| --=Dulled|6 --^Next
  --:Next|
  --/|////////////////////////////////////////



  --/|////////////////////////////////////////
  --=Total1|100
  --=Total2|100
  --=Total3|100
  --=Total4|100
  --=Total5|100
  --=Total6|100
  --=Total7|100
  --=Total8|100
  --=Total9|100
  --/|////////////////////////////////////////



  --/|////////////////////////////////////////
  --%LoopCounter|1;[&Dices];1
  --=Roll|1d6

  --?[$Dulled] -lt [$Reliable]|DulledPriority
  --?[$Roll] -le [$Reliable]|isReliable
  --^CheckDulled|
  --X|

  --:isReliable|
  --/Text|Result as been Reliabled
  --=Total[&LoopCounter]|[$Reliable]
  --^GoDisplay|

  --:CheckDulled|
  --:DulledPriority|
  --?[$Roll] -gt [$Dulled]|isDulled
  --^GoTotal|
  --X|

  --:isDulled|
  --/Text|Result as been Dulled
  --=Total[&LoopCounter]|[$Dulled]
  --^GoDisplay|

  --:GoTotal|
  --=Total[&LoopCounter]|[$Roll]
  --&Text|&nbsp;
  --^GoDisplay|

  --:GoDisplay|
  --/|[t width=100%][tr]
  [td width=30%][/td] 
  [td width=18%][c][f18] [$Roll] [/f][/c][/td] 
  [td width=4%][c]:[/c][/td] 
  [td width=18%][c][f18] [$Total[&LoopCounter]] [/f][/c][/td]
  [td width=30%][/td] 
  [/tr][/t]
  --+|[c][f12] [&Text] [/f][/c]
  --+|[f1]&nbsp;[/f]
--%|
--/|////////////////////////////////////////

--/|////////////////////////////////////////
--?[$Total4] -eq 100|CalculTotal3D6
--?[$Total5] -eq 100|CalculTotal4D6
--?[$Total6] -eq 100|CalculTotal5D6
--?[$Total7] -eq 100|CalculTotal6D6
--?[$Total8] -eq 100|CalculTotal7D6
--?[$Total9] -eq 100|CalculTotal8D6
--^CalculTotal9D6|
--/|////////////////////////////////////////

--/|////////////////////////////////////////
--:CalculTotal3D6| --=Adjustement2|600 --^NoLoopSection|
--:CalculTotal4D6| --&NmbLoop|1 --=Adjustement2|500 --^CalculateTotal|
--:CalculTotal5D6| --&NmbLoop|2 --=Adjustement2|400 --^CalculateTotal|
--:CalculTotal6D6| --&NmbLoop|3 --=Adjustement2|300 --^CalculateTotal|
--:CalculTotal7D6| --&NmbLoop|4 --=Adjustement2|200 --^CalculateTotal|
--:CalculTotal8D6| --&NmbLoop|5 --=Adjustement2|100 --^CalculateTotal|
--:CalculTotal9D6| --&NmbLoop|6 --=Adjustement2|0 --^CalculateTotal|
--/|////////////////////////////////////////

--/|////////////////////////////////////////
--:CalculateTotal| 
////////////
--%LoopCounter|1;[&NmbLoop];1
--?[$Total1] -ne 100 -and [$Total1] -le [$Total2] -and [$Total1] -le [$Total3] -and [$Total1] -le [$Total4] -and [$Total1] -le [$Total5] -and [$Total1] -le [$Total6] -and [$Total1] -le [$Total7] -and [$Total1] -le [$Total8] -and [$Total1] -le [$Total9]|9D6LowerIs1
--?[$Total2] -ne 100 -and [$Total2] -le [$Total1] -and [$Total2] -le [$Total3] -and [$Total2] -le [$Total4] -and [$Total2] -le [$Total5] -and [$Total2] -le [$Total6] -and [$Total2] -le [$Total7] -and [$Total2] -le [$Total8] -and [$Total2] -le [$Total9]|9D6LowerIs2
--?[$Total3] -ne 100 -and [$Total3] -le [$Total1] -and [$Total3] -le [$Total2] -and [$Total3] -le [$Total4] -and [$Total3] -le [$Total5] -and [$Total3] -le [$Total6] -and [$Total3] -le [$Total7] -and [$Total3] -le [$Total8] -and [$Total3] -le [$Total9]|9D6LowerIs3
--?[$Total4] -ne 100 -and [$Total4] -le [$Total1] -and [$Total4] -le [$Total2] -and [$Total4] -le [$Total3] -and [$Total4] -le [$Total5] -and [$Total4] -le [$Total6] -and [$Total4] -le [$Total7] -and [$Total4] -le [$Total8] -and [$Total4] -le [$Total9]|9D6LowerIs4
--?[$Total5] -ne 100 -and [$Total5] -le [$Total1] -and [$Total5] -le [$Total2] -and [$Total5] -le [$Total3] -and [$Total5] -le [$Total4] -and [$Total5] -le [$Total6] -and [$Total5] -le [$Total7] -and [$Total5] -le [$Total8] -and [$Total5] -le [$Total9]|9D6LowerIs5
--?[$Total6] -ne 100 -and [$Total6] -le [$Total1] -and [$Total6] -le [$Total2] -and [$Total6] -le [$Total3] -and [$Total6] -le [$Total4] -and [$Total6] -le [$Total5] -and [$Total6] -le [$Total7] -and [$Total6] -le [$Total8] -and [$Total6] -le [$Total9]|9D6LowerIs6
--?[$Total7] -ne 100 -and [$Total7] -le [$Total1] -and [$Total7] -le [$Total2] -and [$Total7] -le [$Total3] -and [$Total7] -le [$Total4] -and [$Total7] -le [$Total5] -and [$Total7] -le [$Total6] -and [$Total7] -le [$Total8] -and [$Total7] -le [$Total9]|9D6LowerIs7
--?[$Total8] -ne 100 -and [$Total8] -le [$Total1] -and [$Total8] -le [$Total2] -and [$Total8] -le [$Total3] -and [$Total8] -le [$Total4] -and [$Total8] -le [$Total5] -and [$Total8] -le [$Total6] -and [$Total8] -le [$Total7] -and [$Total8] -le [$Total9]|9D6LowerIs8
--?[$Total9] -ne 100 -and [$Total9] -le [$Total1] -and [$Total9] -le [$Total2] -and [$Total9] -le [$Total3] -and [$Total9] -le [$Total4] -and [$Total9] -le [$Total5] -and [$Total9] -le [$Total6] -and [$Total9] -le [$Total7] -and [$Total9] -le [$Total8]|9D6LowerIs9
--*|Nothing to drop
--X|
--/|////////////////////////////////////////
--:9D6LowerIs1| --=Total1|100 --^9D6EndLoop|
--:9D6LowerIs2| --=Total2|100 --^9D6EndLoop|
--:9D6LowerIs3| --=Total3|100 --^9D6EndLoop|
--:9D6LowerIs4| --=Total4|100 --^9D6EndLoop|
--:9D6LowerIs5| --=Total5|100 --^9D6EndLoop|
--:9D6LowerIs6| --=Total6|100 --^9D6EndLoop|
--:9D6LowerIs7| --=Total7|100 --^9D6EndLoop|
--:9D6LowerIs8| --=Total8|100 --^9D6EndLoop|
--:9D6LowerIs9| --=Total9|100 --^9D6EndLoop|
--:9D6EndLoop| --=LoopCounter|[&LoopCounter] --%|
--/|////////////////////////////////////////
--:NoLoopSection|
--=Adjustement|[$LoopCounter]*100+[$Adjustement2]
--=Global|[$Total1]+[$Total2]+[$Total3]+[$Total4]+[$Total5]+[$Total6]+[$Total7]+[$Total8]+[$Total9]-[$Adjustement]
--^GlobalDisplay|
--/|////////////////////////////////////////


--/|////////////////////////////////////////
--:GlobalDisplay|
--+|[f10]&nbsp;[/f]
--=GlobalMod|[$Global]+[&Mod]
--+|[c][f30][$GlobalMod][/f][/c]
--+|[f10]&nbsp;[/f]
--+|[c][f18]([$Global])[/f][/c]
--+|[f5]&nbsp;[/f]
--/|////////////////////////////////////////
  --X|"
  />

  <div class="sheet-first-category">
    <div class="sheet-column1">
      <div class="sheet-prononous-specialrow">
        <input
          type="text"
          placeholder="Pronouns"
          name="attr_character_pronouns"
        />
        <input
          type="text"
          placeholder="Dice Color"
          name="attr_character_dice-color"
        />
      </div>
      <input type="text" placeholder="Lineage" name="attr_character_lineage" />
      <input type="text" placeholder="Origin" name="attr_character_origin" />
      <input
        type="text"
        placeholder="Background"
        name="attr_character_background"
      />
      <input type="text" placeholder="Caste" name="attr_character_caste" />
      <div class="sheet-fortune-specialrow">
        <input
          type="text"
          placeholder="Fortune"
          name="attr_character_fortune"
        />
        <input
          type="text"
          class="sheet-textaligncenter"
          placeholder="CUR."
          name="attr_character_currentfortune"
        />
        <span>/</span>
        <input
          type="text"
          class="sheet-textaligncenter"
          placeholder="MAX"
          name="attr_character_maxfortune"
        />
      </div>
      <div class="sheet-debt-specialrow">
        <input
          class="sheet-hidden sheet-loupe-debt"
          type="checkbox"
          name="attr_debt-loupe"
        />
        <textarea
          class="sheet-debt-loupe"
          type="text"
          placeholder="Debt"
          name="attr_character_debt"
        ></textarea>
        <div class="sheet-loupe-container">
          <input
            class="sheet-loupe sheet-loupe-debt"
            type="checkbox"
            name="attr_debt-loupe"
          />
          <span class="sheet-loupe-icon">s</span>
        </div>
      </div>
    </div>

    <div class="sheet-column2">
      <div class="sheet-column2-sub">
        <div title="Reflexes and quickness" class="sheet-statistics">
          <span class="sheet-statistics-title">AGI</span>
          <input type="text" value="0" name="attr_agi" />
        </div>

        <div title="Physical strength and toughness" class="sheet-statistics">
          <span class="sheet-statistics-title">BRA</span>
          <input type="text" value="0" name="attr_bra" />
        </div>

        <div
          title="Education, street smarts, and quick or critical thinking"
          class="sheet-statistics"
        >
          <span class="sheet-statistics-title">WIT</span>
          <input type="text" value="0" name="attr_wit" />
        </div>

        <div
          title="Persuasiveness, attractiveness, and ability to socially affect the world"
          class="sheet-statistics"
        >
          <span class="sheet-statistics-title">CHA</span>
          <input type="text" value="0" name="attr_cha" />
        </div>

        <div
          title="Paying attention, observing, and processing the world around you"
          class="sheet-statistics"
        >
          <span class="sheet-statistics-title">AWA</span>
          <input type="text" value="0" name="attr_awa" />
        </div>

        <div
          title="The self-control to resist dominance, exert agency, and restrain impulses"
          class="sheet-statistics"
        >
          <span class="sheet-statistics-title">WIL</span>
          <input type="text" value="0" name="attr_wil" />
        </div>
      </div>
    </div>

    <div class="sheet-column3">
      <div class="sheet-values-div">
        <div class="sheet-values">
          <span class="sheet-values-title">&nbsp;Ideology</span>
        </div>
        <input class="sheet-ideology-loupe" type="text" name="attr_ideology" />
      </div>

      <div class="sheet-values-div">
        <div class="sheet-values">
          <span class="sheet-values-title">&nbsp;Value 1</span>
        </div>
        <input class="sheet-value1-loupe" type="text" name="attr_value1" />
      </div>

      <div class="sheet-values-div">
        <div class="sheet-values">
          <span class="sheet-values-title">&nbsp;Value 2</span>
        </div>
        <input class="sheet-value2-loupe" type="text" name="attr_value2" />
      </div>

      <div class="sheet-values-div">
        <div class="sheet-values">
          <span class="sheet-values-title">&nbsp;Value 3</span>
        </div>
        <input class="sheet-value3-loupe" type="text" name="attr_value3" />
      </div>
    </div>
  </div>

  <div class="sheet-second-category">
    <div class="sheet-defensebloc sheet-color-blue">
      <h1>Guard</h1>
      <input type="text" value="@{agi}*2+8" name="attr_guard" disabled />
    </div>

    <div class="sheet-defensebloc sheet-color-blue">
      <h1>VIGI.</h1>
      <input type="text" value="@{wit}*2+8" name="attr_vigilance" disabled />
    </div>

    <div class="sheet-defensebloc sheet-color-blue">
      <h1>AEGIS</h1>
      <input type="text" value="@{awa}*2+8" name="attr_aegis" disabled />
    </div>

    <div class="sheet-defensebloc sheet-color-grey">
      <h1>INI.</h1>
      <div class="sheet-defensebloc-intodaroll">
        <input
          type="text"
          value="[[@{agi}*3]]+[[@{awa}*2]]+@{wit}]]"
          name="attr_initiative"
          disabled
        />
        <button
          type="roll"
          class="sheet-button-initiative sheet-big-button tokenaction btn ui-draggable"
          name="roll_npc_initiative"
          value="!script {{
            --/|[•••••••••••  INITIATIVEROLL]
            --/|[•••••••••••]
            @{scriptcard_color} 
            --#title|Initiative
            --#leftsub|@{character_name}
            --#rightsub|[[[[@{agi}*3]]+[[@{awa}*2]]+@{wit}]]]]
            
            --/|[•••••••••••]
            --=Roll|[[@{agi}*3]]+[[@{awa}*2]]+[[@{wit}]]
            --/|[•••••••••••]
            --+|[f10]&nbsp;[/f]
            
            --+|
            [t width=100%]
            [tr][td][c][f30] [$Roll] [/f][/c][/td][/tr]
            --+|[f5]&nbsp;[/f]
            --~|turnorder;replacetoken;@{selected|token_id};[$Total]
            }}"
        ></button>
      </div>
    </div>

    <div class="sheet-defensebloc sheet-color-yellow">
      <h1>ARMOR</h1>
      <input type="text" value="0" name="attr_armor" />
    </div>

    <div class="sheet-defensebloc sheet-color-yellow">
      <h1>ADA.</h1>
      <input type="text" value="0" name="attr_adamant" />
    </div>
  </div>

  <div class="sheet-third-category">
    <div class="sheet-secondsection-column1">
      <div class="sheet-condition-section">
        <div class="sheet-condition-blocccontainer">
          <h1 class="sheet-condition-title">Health</h1>
          <div class="sheet-condition-text">
            <input type="text" value="0" name="attr_health" />
            <h1>/</h1>
            <input
              type="text"
              value="@{bra}*4+12"
              name="attr_health_max"
              disabled
            />
          </div>
        </div>

        <div class="sheet-condition-blocccontainer">
          <h1 class="sheet-condition-title">Animity</h1>
          <div class="sheet-condition-text">
            <input type="text" value="0" name="attr_animity" />
            <h1>/</h1>
            <input
              type="text"
              value="[[@{cha}*4+12]]"
              name="attr_animity_max"
              disabled
            />
          </div>
        </div>

        <div class="sheet-condition-blocccontainer">
          <h1 class="sheet-condition-title">Grit</h1>
          <div class="sheet-condition-text">
            <input type="text" value="0" name="attr_grit" />
            <h1>/</h1>
            <input type="text" value="@{wil}+6" name="attr_grit_max" disabled />
          </div>
        </div>
      </div>

      <div class="sheet-consequences-subsection">
        <span class="sheet-values-title sheet-bg-red">Consequences</span>
        <div class="sheet-consequences-section">
          <input class="" type="checkbox" name="attr_consequence1" />
          <input class="" type="checkbox" name="attr_consequence2" />
          <input class="" type="checkbox" name="attr_consequence3" />
          <input class="" type="checkbox" name="attr_consequence4" />
          <input class="" type="checkbox" name="attr_consequence5" />
        </div>
        <span class="sheet-values-title2 sheet-bg-red"
          >+1 Instance of Dulled Each</span
        >
      </div>

      <div class="sheet-impulse-section">
        <div class="sheet-impulse">
          <div class="sheet-top">
            <h1>Name</h1>
            <div class="sheet-loupe-container">
              <input
                class="sheet-loupe sheet-loupe-name"
                type="checkbox"
                name="attr_name-loupe"
              />
              <span class="sheet-loupe-icon">s</span>
            </div>
          </div>
          <input
            class="sheet-hidden sheet-loupe-name"
            type="checkbox"
            name="attr_name-loupe"
          />
          <textarea
            class="sheet-name-loupe"
            type="text"
            name="attr_name"
          ></textarea>
        </div>

        <div class="sheet-impulse">
          <div class="sheet-top">
            <h1>Triggers</h1>
            <div class="sheet-loupe-container">
              <input
                class="sheet-loupe sheet-loupe-triggers"
                type="checkbox"
                name="attr_triggers-loupe"
              />
              <span class="sheet-loupe-icon">s</span>
            </div>
          </div>
          <input
            class="sheet-hidden sheet-loupe-triggers"
            type="checkbox"
            name="attr_triggers-loupe"
          />
          <textarea
            class="sheet-triggers-loupe"
            type="text"
            name="attr_triggers"
          ></textarea>
        </div>

        <div class="sheet-impulse">
          <div class="sheet-top">
            <h1>Downtime</h1>
            <div class="sheet-loupe-container">
              <input
                class="sheet-loupe sheet-loupe-downtime"
                type="checkbox"
                name="attr_downtime-loupe"
              />
              <span class="sheet-loupe-icon">s</span>
            </div>
          </div>
          <input
            class="sheet-hidden sheet-loupe-downtime"
            type="checkbox"
            name="attr_downtime-loupe"
          />
          <textarea
            class="sheet-downtime-loupe"
            type="text"
            name="attr_downtime"
          ></textarea>
        </div>
      </div>
    </div>

    <div class="sheet-secondsection-column2">
      <div class="sheet-fieldsetcontainer">
        <span class="sheet-values-title sheet-bg-brown">Skills</span>
        <div class="sheet-skills-section">
          <div
            class="sheet-skills-section-individual sheet-skills-section-individual-title"
          >
            <h4 class="sheet-textalignleft">Skill Name</h4>
            <h4 class="sheet-textalignright">Aff.</h4>
            <h4>Rank</h4>
            <h4>Attr.</h4>
            <h4>Mod</h4>
            <div class="sheet-dulledreliablel-legend">
              <h4 class="main-input">Roll</h4>
              <h4 class="top-right-input">D</h4>
              <h4 class="bottom-left-input">R</h4>
            </div>
          </div>

          <div
            class="sheet-skills-section-individual"
            title="Arts broadly covers the expressive and artistic endeavors of a person. Ranging from acting to painting, singing to dancing, and everything in between and adjacent, Arts is what you use to create something expressive and meaningful"
          >
            <h1>Arts</h1>
            <h4>(cha)</h4>
            <select type="text" name="attr_skill-arts-rank">
              <option value="-1">✗</option>
              <option value="0">0</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>

            <input
              type="text"
              value="@{skill-arts-attribute}"
              name="attr_skill-arts-attribute-display"
              disabled
            />
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-arts-attribute"
            />

            <input type="text" name="attr_skill-arts-miscmodifier" value="0" />

            <div class="sheet-dulledreliablel-legend">
              <input
                type="text"
                name="attr_skill-arts-total"
                value="0"
                class="main-input"
              />
              <input
                type="text"
                name="attr_skill-arts-dulled"
                value="0"
                class="top-right-input"
              />
              <input
                type="text"
                name="attr_skill-arts-reliable"
                value="0"
                class="bottom-left-input"
              />
              <button
                type="roll"
                class="overlay-button btn tokenactions ui-draggable"
                name="roll_skillsarts"
                value="!script {{ --&Skill|Arts --&Dices|@{skill-arts-dices}  --&Mod|@{skill-arts-mods}  --&Dulled|@{skill-arts-dulled} --&Reliable|@{skill-arts-reliable} @{scriptcard_color} @{skillsroll} }}"
              ></button>
            </div>

            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-arts-dices"
            />
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-arts-mods"
            />
          </div>

          <div
            class="sheet-skills-section-individual"
            title="Deception covers lying, misdirection, forgeries and manipulation—essentially any case where you’re trying to convince someone something is true when it isn’t."
          >
            <h1>Deception</h1>
            <h4>(cha)</h4>
            <select type="text" name="attr_skill-deception-rank">
              <option value="-1">✗</option>
              <option value="0">0</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
            <input
              type="text"
              value="@{skill-deception-attribute}"
              name="attr_skill-deception-attribute-display"
              disabled
            />
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-deception-attribute"
            />
            <input
              type="text"
              name="attr_skill-deception-miscmodifier"
              value="0"
            />
            <div class="sheet-dulledreliablel-legend">
              <input
                type="text"
                name="attr_skill-deception-total"
                value="0"
                class="main-input"
              />
              <input
                type="text"
                name="attr_skill-deception-dulled"
                value="0"
                class="top-right-input"
              />
              <input
                type="text"
                name="attr_skill-deception-reliable"
                value="0"
                class="bottom-left-input"
              />
              <button
                type="roll"
                class="overlay-button btn tokenactions ui-draggable"
                name="roll_skillsdeception"
                value="!script {{ --&Skill|Deception --&Dices|@{skill-deception-dices}  --&Mod|@{skill-deception-mods}  --&Dulled|@{skill-deception-dulled} --&Reliable|@{skill-deception-reliable} @{scriptcard_color} @{skillsroll} }}"
              ></button>
            </div>
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-deception-dices"
            />
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-deception-mods"
            />
          </div>

          <div
            class="sheet-skills-section-individual"
            title="Humanities cover a wide range of topics around the social sciences and people's nature, covering a wide range of topics including History, Law, Current Events, Geography, Sociology, Literature and Journalism. When you answer q"
          >
            <h1>Humanites</h1>
            <h4>(wit)</h4>
            <select type="text" name="attr_skill-humanites-rank">
              <option value="-1">✗</option>
              <option value="0">0</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
            <input
              type="text"
              value="@{skill-humanites-attribute}"
              name="attr_skill-humanites-attribute-display"
              disabled
            />
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-humanites-attribute"
            />
            <input
              type="text"
              name="attr_skill-humanites-miscmodifier"
              value="0"
            />
            <div class="sheet-dulledreliablel-legend">
              <input
                type="text"
                name="attr_skill-humanites-total"
                value="0"
                class="main-input"
              />
              <input
                type="text"
                name="attr_skill-humanites-dulled"
                value="0"
                class="top-right-input"
              />
              <input
                type="text"
                name="attr_skill-humanites-reliable"
                value="0"
                class="bottom-left-input"
              />
              <button
                type="roll"
                class="overlay-button btn tokenactions ui-draggable"
                name="roll_skillshumanites"
                value="!script {{ --&Skill|Humanites --&Dices|@{skill-humanites-dices}  --&Mod|@{skill-humanites-mods}  --&Dulled|@{skill-humanites-dulled} --&Reliable|@{skill-humanites-reliable} @{scriptcard_color} @{skillsroll} }}"
              ></button>
            </div>
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-humanites-dices"
            />
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-humanites-mods"
            />
          </div>

          <div
            class="sheet-skills-section-individual"
            title="Influence covers negotiation, persuasion, intimidation, and leadership. Influence uses win-win tactics, speaks honorably and straightforwardly, uses rhetoric that leads, but isn’t manipulative. The line between Influence and Deception is sometimes ,thin, and the GM will make the final determination of whether your persuasive techniques cross over to Deception - propaganda is sometimes subtle and unconscious."
          >
            <h1>Influence</h1>
            <h4>(cha)</h4>
            <select type="text" name="attr_skill-influence-rank">
              <option value="-1">✗</option>
              <option value="0">0</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
            <input
              type="text"
              value="@{skill-influence-attribute}"
              name="attr_skill-influence-attribute-display"
              disabled
            />
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-influence-attribute"
            />
            <input
              type="text"
              name="attr_skill-influence-miscmodifier"
              value="0"
            />
            <div class="sheet-dulledreliablel-legend">
              <input
                type="text"
                name="attr_skill-influence-total"
                value="0"
                class="main-input"
              />
              <input
                type="text"
                name="attr_skill-influence-dulled"
                value="0"
                class="top-right-input"
              />
              <input
                type="text"
                name="attr_skill-influence-reliable"
                value="0"
                class="bottom-left-input"
              />
              <button
                type="roll"
                class="overlay-button btn tokenactions ui-draggable"
                name="roll_skillsinfluence"
                value="!script {{ --&Skill|Influence --&Dices|@{skill-influence-dices}  --&Mod|@{skill-influence-mods}  --&Dulled|@{skill-influence-dulled} --&Reliable|@{skill-influence-reliable} @{scriptcard_color} @{skillsroll} }}"
              ></button>
            </div>
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-influence-dices"
            />
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-influence-mods"
            />
          </div>

          <div
            class="sheet-skills-section-individual"
            title="Magic Arts cover anything dealing with magic. When ✗, Magic Arts is theoretical, providing information about magical effects, traditions, and creatures. When you become trained in Magic Arts, you may choose an aspect of Arcane, Sublime, or Sacred Magic. Once this choice is made, you cannot make another choice. You may only use magic and paradigms associated with that magic source"
          >
            <h1>Magic Arts</h1>
            <h4>(wil)</h4>
            <select type="text" name="attr_skill-magicarts-rank">
              <option value="-1">✗</option>
              <option value="0">0</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
            <input
              type="text"
              value="@{skill-magicarts-attribute}"
              name="attr_skill-magicarts-attribute-display"
              disabled
            />
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-magicarts-attribute"
            />
            <input
              type="text"
              name="attr_skill-magicarts-miscmodifier"
              value="0"
            />
            <div class="sheet-dulledreliablel-legend">
              <input
                type="text"
                name="attr_skill-magicarts-total"
                value="0"
                class="main-input"
              />
              <input
                type="text"
                name="attr_skill-magicarts-dulled"
                value="0"
                class="top-right-input"
              />
              <input
                type="text"
                name="attr_skill-magicarts-reliable"
                value="0"
                class="bottom-left-input"
              />
              <button
                type="roll"
                class="overlay-button btn tokenactions ui-draggable"
                name="roll_skillsmagicarts"
                value="!script {{ --&Skill|Magic Arts --&Dices|@{skill-magicarts-dices}  --&Mod|@{skill-magicarts-mods}  --&Dulled|@{skill-magicarts-dulled} --&Reliable|@{skill-magicarts-reliable} @{scriptcard_color} @{skillsroll} }}"
              ></button>
            </div>
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-magicarts-dices"
            />
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-magicarts-mods"
            />
          </div>

          <div
            class="sheet-skills-section-individual"
            title="Melee Combat deals with fighting in close proximity, either unarmed or wielding a melee weapon."
          >
            <h1>Melee Combat</h1>
            <h4>(agi)</h4>
            <select type="text" name="attr_skill-meleecombat-rank">
              <option value="-1">✗</option>
              <option value="0">0</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
            <input
              type="text"
              value="@{skill-meleecombat-attribute}"
              name="attr_skill-meleecombat-attribute-display"
              disabled
            />
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-meleecombat-attribute"
            />
            <input
              type="text"
              name="attr_skill-meleecombat-miscmodifier"
              value="0"
            />
            <div class="sheet-dulledreliablel-legend">
              <input
                type="text"
                name="attr_skill-meleecombat-total"
                value="0"
                class="main-input"
              />
              <input
                type="text"
                name="attr_skill-meleecombat-dulled"
                value="0"
                class="top-right-input"
              />
              <input
                type="text"
                name="attr_skill-meleecombat-reliable"
                value="0"
                class="bottom-left-input"
              />
              <button
                type="roll"
                class="overlay-button btn tokenactions ui-draggable"
                name="roll_skillsmeleecombat"
                value="!script {{ --&Skill|Melee Combat --&Dices|@{skill-meleecombat-dices}  --&Mod|@{skill-meleecombat-mods}  --&Dulled|@{skill-meleecombat-dulled} --&Reliable|@{skill-meleecombat-reliable} @{scriptcard_color} @{skillsroll} }}"
              ></button>
            </div>
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-meleecombat-dices"
            />
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-meleecombat-mods"
            />
          </div>

          <div
            class="sheet-skills-section-individual"
            title="Observation is the skill of learning things about the world, whether it be determining if someone is telling the truth, finding evidence, looking for food or shelter, judging what is safe or not, spotting traps, or deeply seeing the world around you. Searching and finding use Awareness while memory, pattern recognition, deduction, and analysis use Wit."
          >
            <h1>Observation</h1>
            <h4>(awa)</h4>
            <select type="text" name="attr_skill-observation-rank">
              <option value="-1">✗</option>
              <option value="0">0</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
            <input
              type="text"
              value="@{skill-observation-attribute}"
              name="attr_skill-observation-attribute-display"
              disabled
            />
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-observation-attribute"
            />
            <input
              type="text"
              name="attr_skill-observation-miscmodifier"
              value="0"
            />
            <div class="sheet-dulledreliablel-legend">
              <input
                type="text"
                name="attr_skill-observation-total"
                value="0"
                class="main-input"
              />
              <input
                type="text"
                name="attr_skill-observation-dulled"
                value="0"
                class="top-right-input"
              />
              <input
                type="text"
                name="attr_skill-observation-reliable"
                value="0"
                class="bottom-left-input"
              />
              <button
                type="roll"
                class="overlay-button btn tokenactions ui-draggable"
                name="roll_skillsobservation"
                value="!script {{ --&Skill|Observation --&Dices|@{skill-observation-dices}  --&Mod|@{skill-observation-mods}  --&Dulled|@{skill-observation-dulled} --&Reliable|@{skill-observation-reliable} @{scriptcard_color} @{skillsroll} }}"
              ></button>
            </div>
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-observation-dices"
            />
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-observation-mods"
            />
          </div>
          <div
            class="sheet-skills-section-individual"
            title="Physicality covers the range of physical activities the PC might perform including jumping, lifting, balancing, tumbling, swimming, and running, as well as actions like sneaking, sleight of hand, and other actions that rely on careful coordination and physical control. Physicality in general and Athletics in particular normally rely on the Brawn Attribute while Acrobatics and Stealth usually involve the Agility Attribute."
          >
            <h1>Physicality</h1>
            <select type="text" name="attr_skill-physicality-attribute-display">
              <option value="AGI">AGI</option>
              <option value="BRA">BRA</option>
            </select>
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-physicality-attribute"
            />
            <select type="text" name="attr_skill-physicality-rank">
              <option value="-1">✗</option>
              <option value="0">0</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
            <input
              type="text"
              value="@{skill-physicality-attribute}"
              name="attr_skill-physicality-attribute2"
              disabled
            />
            <input
              type="text"
              name="attr_skill-physicality-miscmodifier"
              value="0"
            />
            <div class="sheet-dulledreliablel-legend">
              <input
                type="text"
                name="attr_skill-physicality-total"
                value="0"
                class="main-input"
              />
              <input
                type="text"
                name="attr_skill-physicality-dulled"
                value="0"
                class="top-right-input"
              />
              <input
                type="text"
                name="attr_skill-physicality-reliable"
                value="0"
                class="bottom-left-input"
              />
              <button
                type="roll"
                class="overlay-button btn tokenactions ui-draggable"
                name="roll_skillsphysicality"
                value="!script {{ --&Skill|Physicality --&Dices|@{skill-physicality-dices}  --&Mod|@{skill-physicality-mods}  --&Dulled|@{skill-physicality-dulled} --&Reliable|@{skill-physicality-reliable} @{scriptcard_color} @{skillsroll} }}"
              ></button>
            </div>
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-physicality-dices"
            />
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-physicality-mods"
            />
          </div>
          <div
            class="sheet-skills-section-individual"
            title="This is the skill that deals with your ability to do mundane and fancy things while piloting a vehicle or riding a creature."
          >
            <h1>Piloting</h1>
            <h4>(awa)</h4>
            <select type="text" name="attr_skill-piloting-rank">
              <option value="-1">✗</option>
              <option value="0">0</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
            <input
              type="text"
              value="@{skill-piloting-attribute}"
              name="attr_skill-piloting-attribute-display"
              disabled
            />
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-piloting-attribute"
            />
            <input
              type="text"
              name="attr_skill-piloting-miscmodifier"
              value="0"
            />
            <div class="sheet-dulledreliablel-legend">
              <input
                type="text"
                name="attr_skill-piloting-total"
                value="0"
                class="main-input"
              />
              <input
                type="text"
                name="attr_skill-piloting-dulled"
                value="0"
                class="top-right-input"
              />
              <input
                type="text"
                name="attr_skill-piloting-reliable"
                value="0"
                class="bottom-left-input"
              />
              <button
                type="roll"
                class="overlay-button btn tokenactions ui-draggable"
                name="roll_skillspiloting"
                value="!script {{ --&Skill|Piloting --&Dices|@{skill-piloting-dices}  --&Mod|@{skill-piloting-mods}  --&Dulled|@{skill-piloting-dulled} --&Reliable|@{skill-piloting-reliable} @{scriptcard_color} @{skillsroll} }}"
              ></button>
            </div>
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-piloting-dices"
            />
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-piloting-mods"
            />
          </div>
          <div
            class="sheet-skills-section-individual"
            title="Ranged Combat is the art and science of employing ranged weapons. This covers firearms as well as more traditional weapons like bows and thrown weapons."
          >
            <h1>Ranged Combat</h1>
            <h4>(agi)</h4>
            <select type="text" name="attr_skill-rangedcombat-rank">
              <option value="-1">✗</option>
              <option value="0">0</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
            <input
              type="text"
              value="@{skill-rangedcombat-attribute}"
              name="attr_skill-rangedcombat-attribute-display"
              disabled
            />
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-rangedcombat-attribute"
            />
            <input
              type="text"
              name="attr_skill-rangedcombat-miscmodifier"
              value="0"
            />
            <div class="sheet-dulledreliablel-legend">
              <input
                type="text"
                name="attr_skill-rangedcombat-total"
                value="0"
                class="main-input"
              />
              <input
                type="text"
                name="attr_skill-rangedcombat-dulled"
                value="0"
                class="top-right-input"
              />
              <input
                type="text"
                name="attr_skill-rangedcombat-reliable"
                value="0"
                class="bottom-left-input"
              />
              <button
                type="roll"
                class="overlay-button btn tokenactions ui-draggable"
                name="roll_skillrangedcombat"
                value="!script {{ --&Skill|Ranged Combat --&Dices|@{skill-rangedcombat-dices}  --&Mod|@{skill-rangedcombat-mods}  --&Dulled|@{skill-rangedcombat-dulled} --&Reliable|@{skill-rangedcombat-reliable} @{scriptcard_color} @{skillsroll} }}"
              ></button>
            </div>
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-rangedcombat-dices"
            />
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-rangedcombat-mods"
            />
          </div>
          <div
            class="sheet-skills-section-individual"
            title="Knowledge and practical application of sciences, this skill comprises medicine, and other natural, biological, and mechanical sciences. Any time a test is needed to know stuff about the natural world that has been learned by experimentation and observation, this is the right choice."
          >
            <h1>Science</h1>
            <h4>(wit)</h4>
            <select type="text" name="attr_skill-science-rank">
              <option value="-1">✗</option>
              <option value="0">0</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
            <input
              type="text"
              value="@{skill-science-attribute}"
              name="attr_skill-science-attribute-display"
              disabled
            />
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-science-attribute"
            />
            <input
              type="text"
              name="attr_skill-science-miscmodifier"
              value="0"
            />
            <div class="sheet-dulledreliablel-legend">
              <input
                type="text"
                name="attr_skill-science-total"
                value="0"
                class="main-input"
              />
              <input
                type="text"
                name="attr_skill-science-dulled"
                value="0"
                class="top-right-input"
              />
              <input
                type="text"
                name="attr_skill-science-reliable"
                value="0"
                class="bottom-left-input"
              />
              <button
                type="roll"
                class="overlay-button btn tokenactions ui-draggable"
                name="roll_skillscience"
                value="!script {{ --&Skill|Science --&Dices|@{skill-science-dices}  --&Mod|@{skill-science-mods}  --&Dulled|@{skill-science-dulled} --&Reliable|@{skill-science-reliable} @{scriptcard_color} @{skillsroll} }}"
              ></button>
            </div>
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-science-dices"
            />
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-science-mods"
            />
          </div>
          <div
            class="sheet-skills-section-individual"
            title="Tech represents the ability to build, repair, and use technology. Without additional paradigms, tech allows characters to interact with computers and other cybertech electronics in socially acceptable, legal ways, as well as covering designing and repairing devices. Paired with certain paradigms, it facilitates Breaching - hacking cybertech, see Breaching on pg 50 - and the technical aspects ofJumping (remotely controlling drones and vehicles)."
          >
            <h1>Tech</h1>
            <h4>(wit)</h4>
            <select type="text" name="attr_skill-tech-rank">
              <option value="-1">✗</option>
              <option value="0">0</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
            <input
              type="text"
              value="@{skill-tech-attribute}"
              name="attr_skill-tech-attribute-display"
              disabled
            />
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-tech-attribute"
            />
            <input type="text" name="attr_skill-tech-miscmodifier" value="0" />
            <div class="sheet-dulledreliablel-legend">
              <input
                type="text"
                name="attr_skill-tech-total"
                value="0"
                class="main-input"
              />
              <input
                type="text"
                name="attr_skill-tech-dulled"
                value="0"
                class="top-right-input"
              />
              <input
                type="text"
                name="attr_skill-tech-reliable"
                value="0"
                class="bottom-left-input"
              />
              <button
                type="roll"
                class="overlay-button btn tokenactions ui-draggable"
                name="roll_skilltech"
                value="!script {{ --&Skill|Tech --&Dices|@{skill-tech-dices}  --&Mod|@{skill-tech-mods}  --&Dulled|@{skill-tech-dulled} --&Reliable|@{skill-tech-reliable} @{scriptcard_color} @{skillsroll} }}"
              ></button>
            </div>
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-tech-dices"
            />
            <input
              class="sheet-hidden"
              type="text"
              value="0"
              name="attr_skill-tech-mods"
            />
          </div>
        </div>
      </div>
    </div>
  </div>

  <script type="text/worker">
    on('sheet:opened change:agi change:bra change:wit change:cha change:awa change:wil change:skill-physicality-attribute-display', function(event) {

      getAttrs(['agi', 'bra', 'wit', 'cha', 'awa', 'wil', 'skill-physicality-attribute-display'], function(values) {

        console.group("✓ - Running Script : Setting Attribute Bonus");

        const agi = parseInt(values['agi']) || 0;
        const bra = parseInt(values['bra']) || 0;
        const wit = parseInt(values['wit']) || 0;
        const cha = parseInt(values['cha']) || 0;
        const awa = parseInt(values['awa']) || 0;
        const wil = parseInt(values['wil']) || 0;
        const skillPhysicalityAttributeDisplay = values['skill-physicality-attribute-display'] || '';

        let skillPhysicalityAttribute = 0;
        if (skillPhysicalityAttributeDisplay === 'AGI') {
          skillPhysicalityAttribute = agi;
        } else if (skillPhysicalityAttributeDisplay === 'BRA') {
          skillPhysicalityAttribute = bra;
        }

        const updates = {
          'skill-arts-attribute': cha,
          'skill-deception-attribute': cha,
          'skill-humanites-attribute': wit,
          'skill-influence-attribute': cha,
          'skill-magicarts-attribute': wil,
          'skill-meleecombat-attribute': agi,
          'skill-observation-attribute': awa,
          'skill-piloting-attribute': awa,
          'skill-rangedcombat-attribute': agi,
          'skill-science-attribute': wit,
          'skill-tech-attribute': wit,
          'skill-physicality-attribute': skillPhysicalityAttribute
        };

        console.log("Attributes:", { agi, bra, wit, cha, awa, wil, skillPhysicalityAttributeDisplay });
        console.log("Updates:", updates);
        console.log("Skill Physicality Attribute Display:", skillPhysicalityAttributeDisplay);

        setAttrs(updates);

        console.groupEnd();
      });
    });
  </script>

  <script type="text/worker">
    const skills = ['arts', 'deception', 'humanites', 'influence', 'magicarts', 'meleecombat', 'observation', 'physicality', 'piloting', 'rangedcombat', 'science', 'tech'];

    const updateSkill = (skillName, values) => {
      console.group("✓ - Running Script : Roll Calculation");

      const skillRank = parseInt(values[`skill-${skillName}-rank`]) || 0;
      const skillMiscModifier = parseInt(values[`skill-${skillName}-miscmodifier`]) || 0;
      const skillAttribute = parseInt(values[`skill-${skillName}-attribute`]) || 0;

      let skillDulledDice = 4;
      let skillDulledAdjustement = 0;

      if (skillRank === -1) {
        skillDulledDice = 4;
        console.log(`${skillName} | is Dulled`, skillDulledDice);
        skillDulledAdjustement = 1;
      } else {
        skillDulledDice = 6;
      }

      // Adjust dulled dice based on consequences
      if (values.consequence1 === 'on') skillDulledDice -= 1;
      if (values.consequence2 === 'on') skillDulledDice -= 1;
      if (values.consequence3 === 'on') skillDulledDice -= 1;
      if (values.consequence4 === 'on') skillDulledDice -= 1;
      if (values.consequence5 === 'on') skillDulledDice -= 1;

      if (skillDulledDice === 6) {
        skillDulledDice = 0;
      }

      console.log(`Dulled Dice`, skillDulledDice, `Dulled Adj`, skillDulledAdjustement);

      console.log(`${skillName} | Rank`, skillRank, `/ Mod`, skillMiscModifier, `/ Attr`, skillAttribute);

      const skillDices = 3 + skillRank + skillDulledAdjustement;
      const skillBonus = skillMiscModifier + skillAttribute;
      const skillTotal = `${skillDices}D6+${skillBonus}`;

      console.log(`${skillName}| Dices`, `Adj (`, skillDulledAdjustement, `)`, skillDices, `Bonus`, skillBonus, `Total:`, skillTotal);

      const attrs = {};
      attrs[`skill-${skillName}-dulled`] = skillDulledDice;
      attrs[`skill-${skillName}-dices`] = skillDices;
      attrs[`skill-${skillName}-mods`] = skillBonus;
      attrs[`skill-${skillName}-total`] = skillTotal;

      setAttrs(attrs);
      console.groupEnd();
    };

    const handleSkillChange = (event) => {
      const skillName = event.triggerName.split('-')[1];
      const attrsToGet = [
        `skill-${skillName}-attribute`,
        `skill-${skillName}-rank`,
        `skill-${skillName}-miscmodifier`,
        'consequence1',
        'consequence2',
        'consequence3',
        'consequence4',
        'consequence5'
      ];

      getAttrs(attrsToGet, (values) => {
        updateSkill(skillName, values);
      });
    };

    const handleConsequenceChange = () => {
      const attrsToGet = [
        'consequence1',
        'consequence2',
        'consequence3',
        'consequence4',
        'consequence5'
      ];

      skills.forEach(skillName => {
        attrsToGet.push(`skill-${skillName}-attribute`);
        attrsToGet.push(`skill-${skillName}-rank`);
        attrsToGet.push(`skill-${skillName}-miscmodifier`);
      });

      getAttrs(attrsToGet, (values) => {
        skills.forEach(skillName => {
          updateSkill(skillName, values);
        });
      });
    };

    // Event listeners for skill changes
    on('sheet:opened change:skill-arts-rank change:skill-arts-miscmodifier change:skill-arts-attribute change:skill-deception-rank change:skill-deception-miscmodifier change:skill-deception-attribute change:skill-humanites-rank change:skill-humanites-miscmodifier change:skill-humanites-attribute change:skill-influence-rank change:skill-influence-miscmodifier change:skill-influence-attribute change:skill-magicarts-rank change:skill-magicarts-miscmodifier change:skill-magicarts-attribute change:skill-meleecombat-rank change:skill-meleecombat-miscmodifier change:skill-meleecombat-attribute change:skill-observation-rank change:skill-observation-miscmodifier change:skill-observation-attribute change:skill-physicality-rank change:skill-physicality-miscmodifier change:skill-physicality-attribute change:skill-piloting-rank change:skill-piloting-miscmodifier change:skill-piloting-attribute change:skill-rangedcombat-rank change:skill-rangedcombat-miscmodifier change:skill-rangedcombat-attribute change:skill-science-rank change:skill-science-miscmodifier change:skill-science-attribute change:skill-tech-rank change:skill-tech-miscmodifier change:skill-tech-attribute', handleSkillChange);

    // Event listeners for consequence changes
    on('sheet:opened change:consequence1 change:consequence2 change:consequence3 change:consequence4 change:consequence5', handleConsequenceChange);
  </script>

  <div class="sheet-fieldsetcontainer">
    <span class="sheet-values-title sheet-bg-yellow">Abilities</span>
    <div class="sheet-abilities-category">
      <div class="sheet-abilities-section sheet-margin-15">
        <h2>Ability</h2>
        <h2 class="sheet-textaligncenter">Ref.</h2>
        <h2>&nbsp;</h2>
        <h2>Effects</h2>
      </div>

      <fieldset class="repeating_abilities">
        <div class="sheet-abilities-section">
          <input type="text" name="attr_ability-name" />
          <input
            type="text"
            name="attr_ability-ref"
            class="sheet-textaligncenter"
          />
          <div class="sheet-loupe-container">
            <input
              class="sheet-loupe sheet-loupe-effect"
              type="checkbox"
              name="attr_effect-loupe"
            />
            <span class="sheet-loupe-icon">s</span>
          </div>
          <input
            class="sheet-hidden sheet-loupe-effect"
            type="checkbox"
            name="attr_effect-loupe"
          />
          <textarea
            class="sheet-effect-loupe"
            type="text"
            name="attr_ability-effect"
          ></textarea>
        </div>
      </fieldset>
      <h5 class="sheet-separator-text">Add/Delete Ability</h5>
    </div>
  </div>

  <div class="sheet-thirdsection">
    <div class="sheet-values-container">
      <div class="sheet-values">
        <span class="sheet-values-title">&nbsp;Langagues</span>
      </div>
      <fieldset class="repeating_langages">
        <input type="text" name="attr_languages" />
      </fieldset>
      <h5 class="sheet-separator-text">Languages</h5>
    </div>

    <div class="sheet-values-container">
      <div class="sheet-values">
        <span class="sheet-values-title">&nbsp;Dramatic Hooks</span>
      </div>
      <fieldset class="repeating_dramatichook">
        <input type="text" name="attr_dramatichooks" />
      </fieldset>
      <h5 class="sheet-separator-text">Add/Delete Dramatic Hooks</h5>
      <div class="sheet-values-container"></div>
    </div>
  </div>

  <div class="sheet-fieldsetcontainer">
    <span class="sheet-values-title sheet-bg-pink">Social</span>
    <div class="sheet-social-category">
      <div class="sheet-social-section sheet-margin-15">
        <h2>Name</h2>
        <h2>Primary Skill</h2>
        <h2>Archetype/Aspect</h2>
        <h2>Power</h2>
        <h2>Regard</h2>
        <h2>&nbsp;</h2>
        <h2>Notes</h2>
      </div>

      <fieldset class="repeating_social">
        <div class="sheet-social-section">
          <input type="text" name="attr_social-name" />
          <input type="text" name="attr_social-primaryskill" />
          <input type="text" name="attr_social-archetypeaspect" />
          <input
            type="text"
            name="attr_social-power"
            class="sheet-textaligncenter"
          />
          <input
            type="text"
            name="attr_social-regard"
            class="sheet-textaligncenter"
          />

          <div class="sheet-loupe-container">
            <input
              class="sheet-loupe sheet-loupe-social"
              type="checkbox"
              name="attr_social-loupe"
            />
            <span class="sheet-loupe-icon">s</span>
          </div>

          <input
            class="sheet-hidden sheet-loupe-social"
            type="checkbox"
            name="attr_social-loupe"
          />
          <textarea
            class="sheet-social-loupe"
            type="text"
            name="attr_social-notes"
          ></textarea>
        </div>
      </fieldset>

      <h5 class="sheet-separator-text">Add/Delete Social Link</h5>
    </div>
  </div>

  <div class="sheet-fieldsetcontainer">
    <span class="sheet-values-title sheet-bg-grey">Gear</span>
    <div class="sheet-gear-category">
      <div class="sheet-gear-section sheet-margin-15">
        <h2>Gear</h2>
        <h2 class="sheet-textaligncenter">Ref.</h2>
        <h2>&nbsp;</h2>
        <h2>Description</h2>
      </div>

      <fieldset class="repeating_gear">
        <div class="sheet-gear-section">
          <input type="text" name="attr_gear-name" />
          <input
            type="text"
            name="attr_gear-ref"
            class="sheet-textaligncenter"
          />
          <div class="sheet-loupe-container">
            <input
              class="sheet-loupe sheet-loupe-gear"
              type="checkbox"
              name="attr_gear-loupe"
            />
            <span class="sheet-loupe-icon">s</span>
          </div>
          <input
            class="sheet-hidden sheet-loupe-gear"
            type="checkbox"
            name="attr_gear-loupe"
          />
          <textarea
            class="sheet-gear-loupe"
            type="text"
            name="attr_gear-description"
          ></textarea>
        </div>
      </fieldset>

      <h5 class="sheet-separator-text">Add/Delete Gear</h5>
    </div>
  </div>
</div>
