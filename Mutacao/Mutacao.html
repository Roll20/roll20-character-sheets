   <!-- Creditos: Igor Cardoso, Thiago Nascimento, Anderson, Joao Campelo (Mutacao), Rodrigo Matos (Mutacao), Kadu (Mutacao) --> 
<div class="sheet">
 
</div>

<div class="container">

 <div class="sheet-col">
            <!--Primeira Coluna-->
           <span class="sheet-image sheet-image-logo"><img src="https://uploaddeimagens.com.br/images/003/956/629/original/Logo.png?1658791628" stile="width:100px;"/></span>
        </div>
        
  <div class="sheet-col">
        <!-- Segunda Coluna -->
          <span class="sheet-label sheet-label-nome"><label for="nome">Nome</label></span> 
          <input class="sheet-input sheet-input-nome" name="attr_character_name" placeholder="nome do personagem" title="@{character_name}" type="text" value=""/>
          <span class="sheet-label sheet-label-idade"><label for="raca">Idade</label></span> 
          <input class="sheet-input sheet-input-idade" name="attr_idade" placeholder="idade" type="text" value=""/>
          <span class="sheet-label sheet-label-profissao"><label for="conceito">Conceito</label></span> 
          <input class="sheet-input sheet-input-profissao" name="attr_profissao" placeholder="Conceito, casta, ordem, kit, etc" type="text" value=""/>
        </div>
        
        <div class="sheet-col">
        <!-- Terceira Coluna -->
            <span class="sheet-label sheet-label-jogador"><label for="jogador">Jogador</label></span> 
            <input class="sheet-input sheet-input-jogador" name="attr_player_name" placeholder="nome do jogador" title="@{player_name}" type="text" value=""/>
            <span class="sheet-label sheet-label-nivel"><label for="nivel">Nível</label></span> 
            <input class="sheet-input sheet-input-nivel" name="attr_nivel" placeholder="nivel" type="text" value=""/>
            <span class="sheet-label sheet-label-xp"><label for="xp">Experiência</label></span> 
            <input class="sheet-input sheet-input-xp" name="attr_xp" placeholder="experiência" type="text" value=""/>
        </div>
       
    </div>
</div>

<div class="container">
    <div class="sheet-Atributos">
        <h3 style="text-align: center; color: #FFF; background-color: #000;"> <span class=sheet-label-barra>Atributos</span></h3>
    </div>
 
   <input type="text" style="width:6em;" name="Fake" value="Nome" disabled />
    <input type="text" style="width:3.5em;" name="Fake" value="Orig." disabled />
	<input type="text" style="width:3.5em;" name="Fake" value="Temp" disabled />
    <input type="text" style="width:3.5em;" name="Fake" value="Mod" disabled />
    <input type="text" style="width:4.1em;" name="Fake" value="Teste%" disabled />&nbsp;
    <input type="text" style="width:2em; visibility:hidden" name="Fake" value="Roll" />&nbsp;
	<input type="text" style="width:2em; visibility:hidden" name="Fake" value="Roll" />&nbsp;
	<input type="text" style="width:0em; visibility:hidden" name="Fake" value="Roll" />&nbsp;

	<!-- <input name="sibling2"></b><b>&nbsp;VIDA&nbsp;<b> -->
	<b>&nbsp;Total&nbsp;<b>
	<b>&nbsp;Perdido&nbsp;<b>
	<b>&nbsp;Atual&nbsp;<b>
	<input type="text" style="width:4em; visibility:hidden" name="Fake" value="Roll" />&nbsp;
	<b>&nbsp;Total&nbsp;<b>
	<b>&nbsp;Gasto&nbsp;<b>
	<b>&nbsp;Atual&nbsp;<b>
     <br>
	 <!-- FORÇA -->
    <input type="text" name="forca" style="width:6em;" value="FOR"  disabled />
    <input type="number" name="attr_For_ori" style="background-color:grey" value="0"/>
	<input type="number" name="attr_For_temp" value="0"/>
    <input type="number" width=3 style="width: 3.5em;" name="attr_For_Mod" readonly />
    <input type="number" width=4 style="background-color:grey; width: 4.1em;" name="attr_For_teste" value="0" readonly />
    <button type="roll" style="border:2px solid grey; background:transparent;color:black;" value="?{Visível só para o mestre?|Não, /r|Sim,/w gm} &{template:mutacao-atributo} {{name=@{character_name}}} {{atrib=Força}} {{val-teste=@{For_teste}}} {{Resultado=[[1d100]]}}  {{Facil=[[ceil(@{For_teste}*2)]]}} {{Dificil=[[ceil(@{For_teste}/2)]]}}"></button>
  

     <Imput name="sibling2"></b><b>&nbsp;PV´s&nbsp;<b>
     <!-- <input name="attr_hp" style="border:2px solid black;width: 4em;" type="number" value="{{Valor_Atributo=[[@{For-Teste}+@{For-Teste}/2]]}}" /> -->
     <input name="attr_pv" style="border:2px solid black;width: 4em;" type="number" value="" />
     <input type="number" name="attr_dano_recebido" width=4 style="border:2px solid black;width: 3.9em;"/>
	 <input type="number" name="attr_pv_atual" width=4 style="border:2px solid black;width: 3.9em;" value="(@{pv}-@{dano_recebido})" disabled />
     <Imput name="sibling2"></b><b>PM´s<b>
     <input name="attr_mana" style="border:2px solid black;width: 4em;" type="number" value="0"  />
     <input type="text" name="attr_mana_gasto" width=4 style="border:2px solid black;width: 3.9em;"/>
	 <input type="number" name="attr_pv_atual" width=4 style="border:2px solid black;width: 3.9em;" value="(@{mana}-@{mana_gasto})" disabled />
     
     <br>
  </div>
  
  
	 
	<!-- CONSTITUIÇÃO -->
    <input type="text" name="Constituição" style='width:6em;'value="CON" disabled />
    <input type="number" style= "background-color:grey" name="attr_Con_ori" value="0"/> 
	<input type="number" name="attr_Con_temp" value="0"/>
    <input type="number" width=3 style='width: 3.5em;' name="attr_Con_Mod" value="" readonly />
    <input type="number" width=4 style="background-color:grey; width: 4.1em;"  name="attr_Con_teste" value="" readonly />
    <button type="roll" style="border:2px solid grey;background:transparent;color:black;" value="?{Visível só para o mestre?|Não, /r|Sim,/w gm} &{template:mutacao-atributo} {{name=@{character_name}}} {{atrib=Constituição}} {{val-teste=@{Con_teste}}} {{Resultado=[[1d100]]}}  {{Facil=[[ceil(@{Con_teste}*2)]]}} {{Dificil=[[ceil(@{Con_teste}/2)]]}}"></button>
  <!-- <input type="text" name="attr_linha0" style="background-color:#FBFCFC; width: 37.3em;"/><br> -->
  
     <Imput name="sibling2"></b><b>&nbsp;PH´s&nbsp;<b>
     <!-- <input name="attr_hp" style="border:2px solid black;width: 4em;" type="number" value="{{Valor_Atributo=[[@{For-Teste}+@{For-Teste}/2]]}}" /> -->
     <input name="attr_ph" style="border:2px solid black;width: 4em;" type="number" value="" />
     <input type="number" name="attr_ph_recebido" width=4 style="border:2px solid black;width: 3.9em;"/>
	 <input type="number" name="attr_ph_atual" width=4 style="border:2px solid black;width: 3.9em;" value="(@{ph}-@{ph_recebido})" disabled />
     <Imput name="sibling2"></b><b>P.FÉ<b>
     <input name="attr_fe" style="border:2px solid black;width: 4em;" type="number" value="0"  />
     <input type="text" name="attr_fe_gasto" width=4 style="border:2px solid black;width: 3.9em;"/>
	 <input type="number" name="attr_fe_atual" width=4 style="border:2px solid black;width: 3.9em;" value="(@{fe}-@{fe_gasto})" disabled />
     
     <br>

	  <!-- REFLEXOS -->
    <input type="text" name="Reflexos" style='width:6em;'value="REF" disabled />
    <input type="number" style="background-color:grey" name="attr_Ref_ori"value="0"/>
	<input type="number" name="attr_Ref_temp" value="0"/>
    <input type="number" width=3 style='width: 3.5em;' name="attr_Ref_Mod" value="" readonly>
    <input type="number" width=4 style="background-color:grey; width: 4.1em;"  name="attr_Ref_teste"  readonly>
    <button type="roll" style="border:2px solid grey;background:transparent;color:black;" value="?{Visível só para o mestre?|Não, /r|Sim,/w gm} &{template:mutacao-atributo} {{name=@{character_name}}} {{atrib=Reflexos}} {{val-teste=@{Ref_teste}}} {{Resultado=[[1d100]]}} {{Facil=[[ceil(@{Ref_teste}*2)]]}} {{Dificil=[[ceil(@{Ref_teste}/2)]]}}"></button>
        <input type="text" name="attr_linha1" style="background-color:#FBFCFC; width: 37.3em;"/><br> 
       
	   
	
	 
	 </div>    
		<!-- MOBILIDADE -->
    <input type="text" name="Mobilidade" style='width:6em;'value="MOB" disabled />
    <input type="number" style= "background-color:grey" name="attr_Mob_ori"value="0"/> 
	<input type="number" name="attr_Mob_temp" value="0"/>
    <input type="number" width=3 style='width: 3.5em;' name="attr_Mob_Mod" value="" readonly />
    <input type="number" width=4 style="background-color:grey; width: 4.1em;" name="attr_Mob_teste"  readonly />
    <button type="roll" style="border:2px solid grey;background:transparent;color:black;" value="?{Visível só para o mestre?|Não, /r|Sim,/w gm} &{template:mutacao-atributo} {{name=@{character_name}}} {{atrib=Mobilidade}} {{val-teste=@{Mob_teste}}} {{Resultado=[[1d100]]}} {{Facil=[[ceil(@{Mob_teste}*2)]]}} {{Dificil=[[ceil(@{Mob_teste}/2)]]}}"></button>
         <input type="text" name="attr_linha2" style="background-color:#FBFCFC; width: 37.3em;"/><br>
         </div> 
		 <!-- PERCEÇÃO -->
    <input type="text" name="Percepção" style='width:6em;'value="PER" disabled/>
    <input type="number" style="background-color:grey" name="attr_Per_ori"value="0"  /> 
	<input type="number" name="attr_Per_temp" value="0"/>
    <input type="number" width=3 style='width: 3.5em;' name="attr_Per_Mod" value="" readonly>
    <input type="number" width=4 style="background-color:grey; width: 4.1em;" name="attr_Per_teste" value="" readonly>
    <button type="roll" style="border:2px solid grey;background:transparent;color:black;" value="?{Visível só para o mestre?|Não, /r|Sim,/w gm} &{template:mutacao-atributo} {{name=@{character_name}}} {{atrib=Percepção}} {{val-teste=@{Per_teste}}} {{Resultado=[[1d100]]}}{{Facil=[[ceil(@{Per_teste}*2)]]}} {{Dificil=[[ceil(@{Per_teste}/2)]]}}"></button>
         <input type="text" name="attr_linha3" style="background-color:#FBFCFC; width: 37.3em;"/><br>
        </div> 
		<!-- INTELIGÊNCIA -->
    <input type="text" name="Intêligencia" style='width:6em;'value="INT" disabled /> 
    <input type="number" style="background-color:grey" name="attr_Int_ori"value="0" /> 
	<input type="number" name="attr_Int_temp" value="0"/>
    <input type="number" width=3 style='width: 3.5em;' name="attr_Int_Mod" value="" readonly>
    <input type="number" width=4 style="background-color:grey; width: 4.1em;" name="attr_Int_teste" value="" readonly>
    <button type="roll" style="border:2px solid grey;background:transparent;color:black;" value="?{Visível só para o mestre?|Não, /r|Sim,/w gm} &{template:mutacao-atributo} {{name=@{character_name}}} {{atrib=Inteligência}} {{val-teste=@{Int_teste}}} {{Resultado=[[1d100]]}} {{Facil=[[ceil(@{Int_teste}*2)]]}} {{Dificil=[[ceil(@{Int_teste}/2)]]}}"></button>
        <input type="text" name="attr_linha4" style="background-color:#FBFCFC; width: 37.3em;"/><br>
       </div>
	   <!-- FORÇA DE VONTADE -->
    <input type="text" name="Vontade" style='width:6em;'value="VON" disabled/>
    <input type="number" style="background-color:grey" name="attr_Von_ori"value="0"  /> 
	<input type="number" name="attr_Von_temp" value="0"/>
    <input type="number" width=3 style='width: 3.5em;' name="attr_Von_Mod" value="" readonly>
    <input type="number" width=4 style="background-color:grey; width: 4.1em;" name="attr_Von_teste" value="" readonly>
    <button type="roll" style="border:2px solid grey;background:transparent;color:black;" value="?{Visível só para o mestre?|Não, /r|Sim,/w gm} &{template:mutacao-atributo} {{name=@{character_name}}} {{atrib=Vontade}} {{val-teste=@{Von_teste}}} {{Resultado=[[1d100]]}} {{Facil=[[ceil(@{Von_teste}*2)]]}} {{Dificil=[[ceil(@{Von_teste}/2)]]}}"></button>
        <input type="text" name="attr_linha5" style="background-color:#FBFCFC; width: 37.3em;"/><br>
       </div>
	   <!-- CARISMA -->
     <input type="text" name="Carisma" style='width:6em;'value="CAR" disabled/>
    <input type="number" style="background-color:grey" name="attr_Car_ori"value="0" /> 
	<input type="number" name="attr_Car_temp" value="0"/>
    <input type="number" width=3 style='width: 3.5em;' name="attr_Car_mod" value="" readonly>
    <input type="number" width=4 style="background-color:grey; width: 4.1em;" name="attr_Car_teste" value="" readonly>
    <button type="roll" style="border:2px solid grey;background:transparent;color:black;" value="?{Visível só para o mestre?|Não, /r|Sim,/w gm} &{template:mutacao-atributo} {{name=@{character_name}}} {{atrib=Carisma}} {{val-teste=@{Car_teste}}} {{Resultado=[[1d100]]}} {{Facil=[[ceil(@{Car_teste}*2)]]}} {{Dificil=[[ceil(@{Car_teste}/2)]]}}"></button>
       <input type="text" placeholder="Add infos como IP, outros pontos ou info importante." name="attr_linha6" style="background-color:#FBFCFC; width: 37.3em;"/><br>
       </div> 
       
    <input type="text" name="soma_atributos" style='width:6em;'value="TOTAL" disabled/>
    <input type="number" style="background-color:grey" name="attr_soma_atributos" value="(@{For_Ori}+@{Con_ori}+@{Ref_ori}+@{Mob_ori}+@{Int_ori}+@{Per_ori}+@{Von_ori}+@{Car_ori})" disabled/> 

       <br>
	   <!--*******************************************************
	   ***********************************************************
	   ************************PERICIAS***************************
	   ***********************************************************
	   ********************************************************-->
<div class="container">
    <div class="sheet-pericias">
      <h3 style="text-align: center; color: #FFF; background-color: #000;"><span class=sheet-label-barra>Perícias</span></h3>
    </div>
    <br>
  <b style='display: inline-block; width: 36em;'>Nome</b>
  <b style='display: inline-block; width: 7em;'>Base</b>
  <b style='display: inline-block; width: 7em;'>Gasto%</b>
  <b style='display: inline-block; width: 4.1em;'>Extra%</b>
  <b style='display: inline-block; width: 4.8em;'>Total%</b>

  <br>
  <fieldset class=repeating_PERICIAS>
    <input type=text name="attr_PERICIASNome" style="background-color:#E5E7E9; width:36em;">
    <select name="attr_PERICIASPontos" style="background-color:grey; width: 6em;">
        <option>0</option>
        <option value="(@{For_ori})">FOR</option>
        <option value="(@{Con_ori})">CON</option>
        <option value="(@{Ref_ori})">REF</option>
        <option value="(@{Mob_ori})">MOB</option>
        <option value="(@{Per_ori})">PER</option>
        <option value="(@{Int_ori})">INT</option>
        <option value="(@{Von_ori})">VON</option>
        <option value="(@{Car_ori})">CAR</option>
    </select>
    <!--<input type=number name="attr_PERICIASPontos" value="0" style="background-color:grey; width: 6em;">-->
    <input type=number name="attr_PERICIASBonus" value="0" style='width: 6em;'>
    <input type=number name="attr_PERICIASExtra" value="0" style='width: 6em;'>
    <input  type=number name="attr_PERICIASTeste" style="background-color:grey; width:6em;" value="(@{PERICIASPontos}+@{PERICIASBonus}+@{PERICIASExtra})" disabled>
    <input type=number name="attr_PERICIASBase" value="(@{PERICIASPontos}*5)" style= 'display: none;'width:10em; disabled>
    <input type=number name="attr_PERICIAS-A" value="floor(@{PERICIASTeste}/2)" style= 'display: none;'width:10em; disabled>
    <input type=number name="attr_PERICIAS-B" value="floor(@{PERICIASTeste}/2)" style= 'display: none;'width:10em; disabled>
    <input type=number name="attr_PERICIAS-C" value="floor(@{PERICIASTeste}/5)" style= 'display: none;'width:10em; disabled>
    
    <button type="roll" style="border:2px solid grey;background:transparent;color:Black;" value="?{Visível só para o mestre?|Não, /r|Sim,/w gm} &{template:mutacao-atributo} {{name=@{character_name}}} {{atrib=@{PERICIASNome}}} {{val-teste=@{PERICIASTeste}}} {{Resultado=[[1d100]]}} {{Facil=[[ceil(@{PERICIASTeste}*2)]]}} {{Dificil=[[ceil(@{PERICIASTeste}/2)]]}} {{Crítico=[[ceil(@{PERICIASTeste}/5)]]}}"</button>
  </fieldset>
   <input type="text" name="soma_pericia" style='width:6em;'value="TOTAL" disabled/>
    <input type="number" style="background-color:grey" name="attr_soma_pericias" value="0" readonly/>
  </div> 
         <br>
	   <!--*******************************************************
	   ***********************************************************
	   ************************PERICIAS COM ARMAS***************************
	   ***********************************************************
	   ********************************************************-->
<div class="container">
    <div class="sheet-pericias-armas">
      <h3 style="text-align: center; color: #FFF; background-color: #000;"><span class=sheet-label-barra>Combate</span></h3>
    </div>
    <br>
  <b style='display: inline-block; width: 12em;'>Nome</b>
  <b style='display: inline-block; width: 3.0em;'>Inic</b>
  <b style='display: inline-block; width: 5em;'>Base</b>
  <b style='display: inline-block; width: 4em;'>Ataque</b>
  <b style='display: inline-block; width: 4em;'>Bônus</b>
  <b style='display: inline-block; width: 3.8em; '>Total</b> 
  <b style='display: inline-block; width: 4em;'>Defesa</b>
  <b style='display: inline-block; width: 3.5em;'>Bônus</b>
  <b style='display: inline-block; width: 4.1em;'>Total</b>
  <b style='display: inline-block; width: 3.3em;'>Dano</b>
    <b style='display: inline-block; width: 3.3em;'>Bônus</b>
  <b style='display: inline-block; width: 2.2em;'>Inic</b>
  <b style='display: inline-block; width: 2.2em;'>Atq</b>
  <b style='display: inline-block; width: 2.2em;'>Def</b>
  <b style='display: inline-block; width: 1em;'>Dn</b>
  <br>
  <fieldset class=repeating_PERÍCIASArmas>
    <input type=text name="attr_PERICIASArmasNome" style="background-color:#E5E7E9; width:12em;">
    <input type=text name="attr_PERICIASIniciativa" value="" placeholder="Ex. +4" style="background-color:#E5E7E9; width:3em;">
    <select name="attr_PERICIAS_base_armas" style="background-color:grey; width: 5em;">
        <option >0</option>
        <option value="(@{For_ori})">FOR</option>
        <option value="(@{Con_ori})">CON</option>
        <option value="(@{Ref_ori})">REF</option>
        <option value="(@{Mob_ori})">MOB</option>
        <option value="(@{Per_ori})">PER</option>
        <option value="(@{Int_ori})">INT</option>
        <option value="(@{Von_ori})">VON</option>
        <option value="(@{Car_ori})">CAR</option>
    </select>
    <!--<input type=number name="attr_PERICIASPontos" value="0" style="background-color:grey; width: 6em;">-->
    <input type=number name="attr_PERICIAS-armaGasto" value="0" style='width: 3.6em;'>
    <input type=number name="attr_PERICIAS-armaExtra" value="0" style='width: 3.6em;'>
    <input  type=number name="attr_PERICIAS-armaTotal" style="background-color:grey; width:3.6em;" value="(@{PERICIAS_base_armas}+@{PERICIAS-armaGasto}+@{PERICIAS-armaExtra})" disabled> | 
    <input type=number name="attr_PERICIASBase" value="" style= "display: none;" width:10em; disabled>
 
    <!-- <input type=text name="attr_PERICIASArmasCrit" value="0" style="background-color:#E5E7E9; width:4em;"> -->
	<!-- defesa -->
	<input type=number name="attr_PERICIAS-defGasto" value="0" style='width: 4em;'>
	<input type=number name="attr_PERICIAS-defExtra" value="0" style='width: 3.6em;'>
    <input  type=number name="attr_PERICIAS-defTotal" style="background-color:grey; width:4em;" value="(@{PERICIAS_base_armas}+@{PERICIAS-defGasto}+@{PERICIAS-defExtra})" disabled />
    <input type=number name="attr_PERICIASBase" value="" style= 'display: none;'width:10em; disabled />
    <input type=text name="attr_PERICIASArmasCrit" value="" placeholder="Ex.1d10+2" style="background-color:#E5E7E9; width:4em;">
    <input type=text name="attr_moddano" value="" placeholder="+2" style="background-color:#E5E7E9; width:3em;">
	<!-- fim defesa -->
    <button type="roll" style="border:2px solid grey;background:transparent;color:Black;" value="&{template:mutacao-iniciativa} {{name=@{character_name}}} {{arma=@{PERICIASArmasNome}}} {{Resultado=[[1d10+@{Mob_ori}+@{Mob_temp}+@{PERICIASIniciativa}&{tracker}]]}}"</button>
    <button type="roll" style="border:2px solid grey;background:transparent;color:Black;" value="&{template:mutacao} {{name=@{character_name}}} {{atrib=@{PERICIASArmasNome}}} {{val-teste=@{PERICIAS-armatotal}}} {{Resultado=[[1d100]]}}  {{Facil=[[ceil(@{PERICIAS-armaTotal}*2)]]}} {{Dificil=[[ceil(@{PERICIAS-armaTotal}/2)]]}} {{Critico=[[ceil(@{PERICIAS-armaTotal}/5)]]}}"</button>
    <button type="roll" style="border:2px solid grey;background:transparent;color:Black;" value="&{template:mutacao-defesa} {{name=@{character_name}}} {{atrib=@{PERICIASArmasNome}}} {{val-teste=@{PERICIAS-deftotal}}} {{Resultado=[[1d100]]}}{{Facil=[[ceil(@{PERICIAS-defTotal}*2)]]}} {{Dificil=[[ceil(@{PERICIAS-defTotal}/2)]]}} {{Critico=[[ceil(@{PERICIAS-defTotal}/5)]]}}"</button>
    <button type="roll" style="border:2px solid grey;background:transparent;color:Black;" value="&{template:mutacao-dano} {{name=@{character_name}}} {{Pericia=@{PERICIASArmasNome}}} {{Dano=[[@{PERICIASArmasCrit}]]}} {{bonusdano=[[@{moddano}]]}} "></button>     
 
 <div>
      <input type="checkbox" class="sheet-toggle-show" />
      <span>Extras</span>
      <div class="sheet-body">
                <input type="text" name="attr_nomeextra1" style="width:7em;" value=""/> 
                <input type="text" name="attr_nomeextra2" style="width:7em;" value=""/> 
                <input type="text" name="attr_nomeextra3" style="width:7em;" value=""/> 
                <input type="text" name="attr_nomeextra4" style="width:7em;" value=""/> 
                <input type="text" name="attr_nomeextra5" style="width:7em;" value=""/> 
                <input type="text" name="attr_nomeextra6" style="width:7em;" value=""/> 
                <input type="text" name="attr_nomeextra7" style="width:7em;" value=""/> 
                <input type="text" name="attr_nomeextra8" style="width:7em;" value=""/> 
               
                <br>
          	    <input type=number name="attr_valextra1" value="0" style='width: 7em;'>
          	    <input type=number name="attr_valextra2" value="0" style='width: 7em;'>
          	    <input type=number name="attr_valextra3" value="0" style='width: 7em;'>
          	    <input type=number name="attr_valextra4" value="0" style='width: 7em;'>
          	    <input type=number name="attr_valextra5" value="0" style='width: 7em;'>
          	    <input type=number name="attr_valextra6" value="0" style='width: 7em;'>
          	    <input type=number name="attr_valextra7" value="0" style='width: 7em;'>
          	    <input type=number name="attr_valextra8" value="0" style='width: 7em;'>
          	    
      </div>
</div>
  
  
  
</fieldset>
  </div> 
  
  
 
	   <!--*******************************************************
	   ***********************************************************
	   ************************APRIMORAMENTOS*********************
	   ***********************************************************
	   ********************************************************-->
<div class="container">
  <div class="sheet-aprimoramentos">
      <br>
      <h3 style="text-align: center; color: #FFF; background-color: #000;"><span class=sheet-label-barra>Aprimoramentos</span></h3>
    <br>
   <b style='display: inline-block; width: 25em;'>Nome</b>
   <b style='display: inline-block; width: 6em;'>Custo</b>
   <b style='display: inline-block; width: 25em;'>Descrição</b>
   <br>
    <fieldset class=repeating_APRIMORAMENTOS>  
      <input type=text name="attr_aprimoramento" style="background-color:#E5E7E9; width:25em;">
      <input type=number name="attr_aprimoramento-custo" value="0" style="background-color:grey; width: 6em;">
         <input type="text" name="attr_linha1" style="background-color:#FBFCFC; width: 30.3em;"/>
    </fieldset>
      <input type="text" name="soma_aprimoramento" style='width:6em;'value="TOTAL" disabled/>
    <input type="number" style="background-color:grey" name="attr_soma_aprimoramentos" value="0" readonly/>
  </div> 
  
  
	   <!--*******************************************************
	   ***********************************************************
	   ************************PODERES MUTAGENICOS****************************
	   ***********************************************************
	   ********************************************************-->
<div class="container">
  <div class="sheet-poderes">
      <br>
      <h3 style="text-align: center; color: #FFF; background-color: #000;"><span class=sheet-label-barra>Poderes Mutagenicos</span></h3>
    <br>
   <b style='display: inline-block; width: 25em;'>Nome</b>
   <b style='display: inline-block; width: 6em;'>Custo</b>
   <b style='display: inline-block; width: 25em;'>Descrição</b>
   <br>
    <fieldset class=repeating_PODERES>  
      <input type=text name="attr_poder" style="background-color:#E5E7E9; width:25em;">
      <input type=number name="attr_poder-custo" value="0" style="background-color:grey; width: 6em;">
         <input type="text" name="attr_linha1" style="background-color:#FBFCFC; width: 30.3em;"/>
    </fieldset>
      <input type="text" name="soma_poder" style='width:6em;'value="TOTAL" disabled/>
    <input type="number" style="background-color:grey" name="attr_soma_poderes" value="0" readonly/>
  </div> 

<div class="container">
    <div class="sheet-magias">                  
       <br>
      <h3 style="text-align: center; color: #FFF; background-color: #000;"><span class=sheet-label-barra>Formas e Caminhos</span></h3>   
      <br/>
    <input type="text" name="entender" style='width:6em;'value="Entender" readonly />
    <input type="number" name="attr_entender" style="background-color:grey" value="0"/>
    <input type="text" name="criar" style='width:6em;'value="Criar"readonly/>
    <input type="number" name="attr_criar" style="background-color:grey" value="0"/>
    <input type="text" name="controlar" style='width:6em;'value="Controlar" readonly />
    <input type="number" name="attr_controlar"style="background-color:grey" value="0" /> 
     <input type="text" name="terra" style='width:6em;'value="Terra" readonly/>
    <input type="number" name="attr_terra"style="background-color:grey" value="0" />
     <input type="text" name="ar" style='width:6em;'value="Ar" readonly />
    <input type="number" name="attr_ar"style="background-color:grey" value="0"/>
     <input type="text" name="fogo" style='width:6em;'value="Fogo" readonly />
    <input type="number" name="attr_fogo"style="background-color:grey" value="0"/>
    <input type="text" name="agua" style='width:6em;'value="Água" readonly/>
    <input type="number" name="attr_agua"style="background-color:grey"value="0"/>
     <input type="text" name="luz" style='width:6em;'value="Luz" readonly/>
    <input type="number" name="attr_luz"style="background-color:grey"value="0"/>
     <input type="text" name="trevas" style='width:6em;'value="Trevas" readonly/>
    <input type="number" name="attr_trevas"style="background-color:grey" value="0"/>
     <input type="text" name="humanos" style='width:6em;'value="Humanos" readonly/>
    <input type="number" name="attr_humanos"style="background-color:grey" value="0"/> 
     <input type="text" name="animais" style='width:6em;'value="Animais" readonly/>
    <input type="number" name="attr_animais"style="background-color:grey" value="0"/>
     <input type="text" name="plantas" style='width:6em;'value="Plantas" readonly/>
    <input type="number" name="attr_plantas"style="background-color:grey"value="0" /> 
     <input type="text" name="spiritum" style='width:6em;'value="Spiritum" readonly/>
    <input type="number" name="attr_spiritum"style="background-color:grey" value="0" /> 
     <input type="text" name="arkanun" style='width:6em;'value="Arkanun" readonly/>
    <input type="number" name="attr_arkanun"style="background-color:grey" value="0"/> 
     <input type="text" name="metamagia" style='width:6em;'value="Metamagia" readonly/>
    <input type="number" name="attr_metamagia"style="background-color:grey"value="0" /> 
    <input type="text" name="total_focus" style='width:6em;'value="TOTAL" disabled/>
    <input type="number" style="background-color:grey" name="attr_soma_focus" value="(@{entender}+@{criar}+@{controlar}+@{terra}+@{ar}+@{agua}+@{fogo}+@{luz}+@{trevas}+@{humanos}+@{animais}+@{plantas}+@{spiritum}+@{arkanun}+@{metamagia})" disabled/> 
 <br/>
  </div> 
    
	 </div>
	 </div>
    <h3 style="text-align: center; color: #FFF; background-color: #000;"><span class=sheet-label-barra>Assentamentos</span></h3> 
    <div class=formblock>
      <textarea name="attr_anotações" style="background-color:white;"></textarea>
    </div>
    <div class=formblock>
    </div> 
  
    <div class="container">
      <div class="sheet-equipamentos">
        <h3 style="text-align: center; color: #FFF; background-color: #000;"><span class=sheet-label-barra>Equipamentos</span></h3> 
    <div class=formblock>
    <textarea name="attr_equipmentos" style="background-color:white;"></textarea>
    </div>
  <div class=formblock>
      
        <div class="container">
      <div class="sheet-equipamentos">
        <h3 style="text-align: center; color: #FFF; background-color: #000;"><span class=sheet-label-barra>INFORMAÇÕES</span></h3> 
    <div class=formblock>
    <textarea name="attr_fraquezas" style="background-color:white;"></textarea>
    </div>
  <div class=formblock>
  </div> 
  </div>
  <br/>
  
  <rolltemplate class="sheet-rolltemplate-mutacao-iniciativa">
	<table>
		<tr><th colspan="5">{{name}} rolou iniciativa com  {{arma}}</th></tr>
		<tr><td class="roll1"><span>{{Resultado}}</td>
			<tr><td class="roll2"><span class="tcat">Iniciativa</td></tr>
	</table>
</rolltemplate>

 <rolltemplate class="sheet-rolltemplate-mutacao-atributo">
	<table>
		<tr><th colspan="5">{{name}} testou {{atrib}}</th></tr>
		<tr><td class="roll1"><span>{{Resultado}}</td><td class="roll1"><=</td><td class="roll1">{{val-teste}} | </td><td class="roll1">{{Facil}} | </td> <td class="roll1">{{Dificil}}</td></tr>
		<tr><td class="roll2"><span class="tcat">Resultado</td><td  class="roll2"></td><td  class="roll2">Normal</td> <td  class="roll2">Facil</td> <td  class="roll2">Difícil</td></tr>
		
				
	</table>
</rolltemplate>

 <rolltemplate class="sheet-rolltemplate-mutacao-ataque">
	<table>
		<tr><th colspan="6">{{name}} atacou com {{atrib}}</th></tr>
		<tr><td class="roll1"><span>{{Resultado}}</td><td class="roll1"><=</td><td class="roll1">{{val-teste}} | </td><td class="roll1">{{Facil}} | </td> <td class="roll1">{{Dificil}} | </td> <td class="roll1">{{Critico}}</td></tr>
		<tr><td class="roll2"><span class="tcat">Resultado</td><td  class="roll2"></td><td  class="roll2">Normal</td> <td  class="roll2">Facil</td> <td  class="roll2">Difícil</td><td  class="roll2">Crítico</td></tr>
		
				
	</table>
</rolltemplate>

 <rolltemplate class="sheet-rolltemplate-mutacao-defesa">
	<table>
		<tr><th colspan="6">{{name}} defendeu com {{atrib}}</th></tr>
		<tr><td class="roll1"><span>{{Resultado}}</td><td class="roll1"><=</td><td class="roll1">{{val-teste}} | </td><td class="roll1">{{Facil}} | </td> <td class="roll1">{{Dificil}} |</td> <td class="roll1">{{Critico}}</td></tr>
		<tr><td class="roll2"><span class="tcat">Resultado</td><td  class="roll2"></td><td  class="roll2">Normal</td> <td  class="roll2">Facil</td> <td  class="roll2">Difícil</td><td  class="roll2">Crítico</td></tr>
		
				
	</table>
</rolltemplate>

 <rolltemplate class="sheet-rolltemplate-mutacao-dano">
	<table>
		<tr><th colspan="5">{{name}} rolou dano com {{Pericia}}</th></tr>
		<tr><td class="roll1"><span>{{Dano}}</td><td class="roll1"> | </td><td class="roll1">{{bonusdano}}</td><td class="roll1"> | </td><td class="roll1"></td>{{danototal}}</tr>
		<tr><td class="roll2"><span class="tcat">Dano</td><td  class="roll2"></td><td  class="roll2">Bônus</td></tr>

	
				
	</table>
</rolltemplate>


<script type="text/worker">

const getStatModifier = stat => stat > 14 ? Math.ceil((stat-14)/2) : [1, 3, 5, 9, 15].findIndex(n => n > stat ) -4;

const stats = ['for', 'con', 'ref', 'mob', 'int', 'per', 'von', 'car'];
stats.forEach(stat => {
    on(`change:${stat}_ori change:${stat}_temp sheet:opened`, () => {
        getAttrs([`${stat}_ori`, `${stat}_temp`], v => {
            const ori = parseInt(v[`${stat}_ori`]) || 0;
            const temp = parseInt(v[`${stat}_temp`]) || 0;
            const score = ori + temp;
            const modifier = getStatModifier(score);
            const teste = score * 5;
            setAttrs({
                [stat]: score,
                [`${stat}_mod`]: modifier,
                [`${stat}_teste`]: teste
            });
        });
    });
});


const repeatingSum = (destinations, section, fields) => {
    if (!Array.isArray(destinations)) destinations = [destinations.replace(/\s/g, '').split(',')];
    if (!Array.isArray(fields)) fields = [fields.replace(/\s/g, '').split(',')];
    getSectionIDs(`repeating_${section}`, idArray => {
        const attrArray = idArray.reduce((m, id) => [...m, ...(fields.map(field => `repeating_${section}_${id}_${field}`))], []);
        getAttrs([...attrArray], v => {
            const getValue = (section, id, field) => v[`repeating_${section}_${id}_${field}`] === 'on' ? 1 : parseFloat(v[`repeating_${section}_${id}_${field}`]) || 0;
            const commonMultipliers = (fields.length <= destinations.length) ? [] : fields.splice(destinations.length, fields.length - destinations.length);
            const output = {};
            destinations.forEach((destination, index) => {
                output[destination] = idArray.reduce((total, id) => total + getValue(section, id, fields[index]) * commonMultipliers.reduce((subtotal, mult) => subtotal * getValue(section, id, mult), 1), 0);
            });
            setAttrs(output);
        }); 
    }); 
};

on('change:repeating_pericias:periciasbonus remove:repeating_pericias', function() {
	repeatingSum("soma_pericias","pericias","periciasbonus");
});

on('change:repeating_aprimoramentos:aprimoramento-custo remove:repeating_aprimoramentos', function() {
	repeatingSum("soma_aprimoramentos","aprimoramentos","aprimoramento-custo");
});

on('change:repeating_poderes:poder-custo remove:repeating_poderes', function() {
	repeatingSum("soma_poderes","poderes","poder-custo");
});
</script>




