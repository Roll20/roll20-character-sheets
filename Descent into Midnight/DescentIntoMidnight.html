



<div>
	<input type="hidden" value="Version 1.00.00">
	<div class="header topbar">
		<input class="field-name" type="text" placeholder="Name" name="attr_character_name">
		<input class="field-class" type="text" placeholder="Playbook" name="attr_playbook">
	</div>

	<!-- SUBHEADING -->

	<div class="statistics">
		<div class="header pronoun">
			<div class="section-name">Pronouns</div>
			<input type="text" placeholder="They/Their/Them" name="attr_pronouns">
		</div>
		<div class="header harmony">
			<div class="section-name">Harmony</div>
			<input type="checkbox" class="progression" value=1 name="attr_harmony1">
			<input type="checkbox" class="progression" value=1 name="attr_harmony2">
			<input type="checkbox" class="progression" value=1 name="attr_harmony3">
			<input type="checkbox" class="progression" value=1 name="attr_harmony4">
			<input type="checkbox" class="progression" value=1 name="attr_harmony5">
		</div>
		<div class="header corruption">
			<div class="section-name">Corruption</div>
			<input type="hidden" value=0 name="attr_corruptionmarked">
			<input type="checkbox" class="progression" value=1 name="attr_corruption1">
			<input type="checkbox" class="progression" value=1 name="attr_corruption2">
			<input type="checkbox" class="progression" value=1 name="attr_corruption3">
			<input type="checkbox" class="progression" value=1 name="attr_corruption4">
			<input type="checkbox" class="progression" value=1 name="attr_corruption5">
		</div>
		<div class="header maneuvers">
			<div class="section-name">Maneuvers</div>
			<input type="number" name="attr_maneuvers" value=0>
		</div>
		<div class="clearfix"></div>
	</div>

	<!-- ATTRIBUTES -->

	<div class="attributes">
		<input type="hidden" value=0 name="attr_conditionsmarked">
		<div class="header">
			<button type="roll" name="roll_TestHope" value="/me rolls @{Hoperoll} for Hope">Hope</button>
			<input type="hidden" value="[[2d6 + @{hope} - @{despairing}]]" name="attr_Hoperoll">
			
			<div class="row-1">
				<input type="number" name="attr_hope" value=0>
			</div>

			<div class="row-2">
				<label>
					<input type="checkbox" name="attr_despairing" value="2">
					<span>despairing -2</span>
				</label>
			</div>
		</div>
		<div class="header">
			<button type="roll" name="roll_TestAltruism" value="/me rolls @{Altruismroll} for Altruism">Altruism</button>
			<input type="hidden" value="[[2d6 + @{altruism} - @{selfish}]]" name="attr_Altruismroll">

			<div class="row-1">
				<input type="number" name="attr_altruism" value=0>
			</div>

			<div class="row-2">
				<label>
					<input type="checkbox" name="attr_selfish" value="2">
					<span>selfish -2</span>
				</label>
			</div>
		</div>
		<div class="header">
			<button type="roll" name="roll_TestCommunity" value="/me rolls @{Communityroll} for Community">Community</button>
			<input type="hidden" value="[[2d6 + @{community} - @{isolated}]]" name="attr_Communityroll">

			<div class="row-1">
				<input type="number" name="attr_community" value=0>
			</div>

			<div class="row-2">
				<label>
					<input type="checkbox" name="attr_isolated" value="2">
					<span>isolated -2</span>
				</label>
			</div>
		</div>
		<div class="header">
			<button type="roll" name="roll_TestCalm" value="/me rolls @{Calmroll} for Calm">Calm</button>
			<input type="hidden" value="[[2d6 + @{calm} - @{angry}]]" name="attr_Calmroll">

			<div class="row-1">
				<input type="number" name="attr_calm" value=0>
			</div>

			<div class="row-2">
				<label>
					<input type="checkbox" name="attr_angry" value="2">
					<span>angry -2</span>
				</label>
			</div>
		</div>
		<div class="header">
			<button type="roll" name="roll_TestDrive" value="/me rolls @{Driveroll} for Drive">Drive</button>
			<input type="hidden" value="[[2d6 + @{drive} - @{conflicted}]]" name="attr_Driveroll">

			<div class="row-1">
				<input type="number" name="attr_drive" value=0>
			</div>

			<div class="row-2">
				<label>
					<input type="checkbox" name="attr_conflicted" value="2">
					<span>conflicted -2</span>
				</label>
			</div>
		</div>
		<div class="clearfix"></div>
	</div>

	<div class="col-left">
		<!-- ===== Character Description ===== -->
		<div class="header">
			<div class="section-name">Character Description</div>
		</div>
		<div class="section-look description">
			<span class="description-name">Look</span>
			<br>
			<textarea name="attr_look" placeholder="Look"></textarea>
		</div>

		<div class="section-gifts description">
			<span class="description-name">Gifts</span>
			<br>
			<textarea name="attr_gifts" placeholder="Gifts"></textarea>
		</div>

		<div class="section-attitude description">
			<span class="description-name">Attitude</span>
			<br>
			<textarea name="attr_attitude" placeholder="Attitude"></textarea>
		</div>

		<div class="section-home description">
			<span class="description-name">Home</span>
			<br>
			<textarea name="attr_home" placeholder="Home"></textarea>
		</div>

		<!-- ===== Links ===== -->
		<div class="header">
			<div class="section-name">Links</div>
		</div>
		<div class="section-links">
			<fieldset class="repeating_links">
				<textarea placeholder="Empty Link" name="attr_bond"></textarea>
				<div class="clearfix"></div>
			</fieldset>
		</div>

		<!-- ===== ADVANCEMENT ===== -->
		<div class="advancement">
			<div class="header">
				<div class="section-name">Advancement</div>
			</div>
			<label><input type="checkbox" class="advancementcheck" name="attr_advanceone"> <span>Gain another Playbook Move</span></label>
			<label><input type="checkbox" class="advancementcheck" name="attr_advancetwo"> <span>Gain another Playbook Move</span></label>
			<label><input type="checkbox" class="advancementcheck" name="attr_advancethree"> <span>Gain an additional Gift from any Playbook</span></label>
			<label><input type="checkbox" class="advancementcheck" name="attr_advancefour"> <span>Playbook Specific Advancement</span></label>
			<label><input type="checkbox" class="advancementcheck" name="attr_advancefive"> <span>Increase your Corruption Track by 1</span></label>
			<label><input type="checkbox" class="advancementcheck" name="attr_advancesix"> <span>Gain a Move from another Playbook</span></label>
			<label><input type="checkbox" class="advancementcheck" name="attr_advanceseven"> <span>Take an advancement from the Community Playboook</span></label>
			<label><input type="checkbox" class="advancementcheck" name="attr_advanceeight"> <span>Reflect on how recent events have changed you. Increase two stats by 1 and decrease a stat by 1.</span></label>
		</div>
		
		<div class="clearfix"></div>
	</div>


	<!-- ===== MOVES ===== -->

	<div class="col-right">

		<!-- ===== CUSTOM MOVES ===== -->
		<div class="header">
			<div class="section-name">Moves</div>
		</div>
		<div class="section-moves">
			<fieldset class="repeating_moves">
				<input type="text" name="attr_movename" placeholder="Move Name">
				<select name="attr_movetype">
					<option selected>Playbook</option>
					<option>Corruption</option> 
					<option>Team</option>
				</select>
				<input type="checkbox" class="toggle" title="show/hide" name="attr_move-show" value="1" />
				<textarea name="attr_movebody" class="hide" placeholder="Move Description"></textarea>
			</fieldset>
		</div>

		<!-- ===== Basic Moves ===== -->	
		<div class="header">
			<div class="section-name">Basic Moves</div>
		</div>
		<div class="section-basicmoves">
			<div class="basicmove">
				<span class="basicmove-name">Scan the Environment</span>
				<input type="checkbox" class="toggle" title="show/hide"  value="1" />
				<div class="basicmove-description hide">
					When you investigate the world around you, describe what sense, expertise, power, or skill you use to interact with your environment, and <button type="roll" class="inlinebutton" name="roll_FILLMEIN"
					value="&{template:dim} {{name=Scan the Environment}}  {{rollvalue=@{Communityroll}}} {{Hit= You gain +1 Ongoing until the end of the scene when acting on the information you gain.}} {{Partial= Your Guide will show you something about your world.}}">
					roll +Community.</button> 
					<br>On a hit, your Guide will show you something about your world. On a 10+ you gain +1 Ongoing until the end of the scene when acting on the information you gain.
				</div>
			</div>
			<div class="basicmove">
				<span class="basicmove-name">Redirect the Current</span>
				<input type="checkbox" class="toggle" title="show/hide"  value="1" />
				<div class="basicmove-description hide">
					When you act to remove an obstacle in your path, <button type="roll" class="inlinebutton" name="roll_FILLMEIN"
					value="&{template:dim} {{name=Redirect the Current}}  {{rollvalue=@{Calmroll}}} {{Hit= You avoid trouble}} {{Partial= You succeed at your task, but your Guide will give you a hard choice, introduce an instability, or enact a cost.}}">
					roll +Calm.</button> 
					<br>On a hit you succeed at your task and avoid trouble. On a 7-9 the Guide will give you a hard choice, introduce an instability, or enact a cost.
				</div>
			</div>
			<div class="basicmove">
				<span class="basicmove-name">Reach Out</span>
				<input type="checkbox" class="toggle" title="show/hide"  value="1" />
				<div class="basicmove-description hide">
					When you ask for help from nature or your community, <button type="roll" class="inlinebutton" name="roll_FILLMEIN"
					value="&{template:dim} {{name=Reach Out}}  {{rollvalue=@{Hoperoll}}} {{Hit= The help is lasting, stable, and non-threatening}} {{Partial= Your pleas are heard. Describe how the natural world or members of your community come to your aid. The Guide will describe how the help is temporary, unstable, or threatening}}">
					roll +Hope.</button> 
					<br>On a hit your pleas are heard. Describe how the natural world or members of your community come to your aid. On a 7-9 the Guide will describe how the help is temporary, unstable, or threatening
				</div>
			</div>
			<div class="basicmove">
				<span class="basicmove-name">Defend Another</span>
				<input type="checkbox" class="toggle" title="show/hide"  value="1" />
				<div class="basicmove-description hide">
					When you risk your own safety to protect another, <button type="roll" class="inlinebutton" name="roll_FILLMEIN"
					value="&{template:dim} {{name=Defend Another}}  {{rollvalue=@{Altruismroll}}} {{Hit= You protect your ward without further risk.}} {{Partial= You protect your ward, but choose two consequences}} {{Miss= Choose two consequences, and you fail to protect your ward}}">
					roll +Altruism.</button> 
					<br>On a hit you protect your ward. On a 7-9, choose two from the following list:
					<ul>
						<li>You take the hit</li>
						<li>You end up in a bad spot</li>
						<li>You lash out at a friend</li>
					</ul>
					On a miss, choose two from the above list, and your ward remains unprotected
				</div>
			</div>
			<div class="basicmove">
				<span class="basicmove-name">Do Something Wondrous</span>
				<input type="checkbox" class="toggle" title="show/hide"  value="1" />
				<div class="basicmove-description hide">
					When you use your gifts in a spectacular way, <button type="roll" class="inlinebutton" name="roll_FILLMEIN"
					value="&{template:dim} {{name=Do Something Wondrous}}  {{rollvalue=@{Driveroll}}} {{Hit= You accomplish your goal without consequences}} {{Partial= You accomplish your goal, but suffer a consequence}}">
					roll +Drive.</button> 
					<br>On a hit, describe how you accomplished your goal. On a 7-9, choose one:
					<ul>
						<li>You suffer a backlash</li>
						<li>You lose control at the worst time</li>
						<li>You put others in danger</li>
					</ul>
				</div>
			</div>
			<div class="basicmove">
				<span class="basicmove-name">Salve Wounds</span>
				<input type="checkbox" class="toggle" title="show/hide"  value="1" />
				<div class="basicmove-description hide">
					When you tend to another’s suffering, ask that player (or the Guide if it’s an NPC) if they accept your help. If the answer is yes, <button type="roll" class="inlinebutton" name="roll_FILLMEIN"
					value="&{template:dim} {{name=Salve Wounds}}  {{rollvalue=@{Hoperoll}}} {{Hit= You also mark Harmony or hold 1 Maneuver}} {{Partial= You successfully render aid. If your target is a PC, they clear a Condition or hold 1 Maneuver. If you are tending an NPC, you help them as indicated by the narrative and clear a Condition or a Corruption.}}">
					roll +Hope.</button>
					On a hit, you successfully render aid.
					<br>If your target is a PC, they clear a Condition or hold 1 Maneuver.
					<br>If you are tending an NPC, you help them as indicated by the narrative and clear a Condition or a Corruption.
					<br>On a 10+, you also mark Harmony or hold 1 Maneuver.
				</div>
			</div>
		</div>

		<!-- ===== Special Moves ===== -->
		<div class="header">
			<div class="section-name">Special Moves</div>
		</div>
		<div class="section-specialmoves">
			<div class="specialmove">
				<span class="specialmove-name">Act as a Team</span>
				<input type="checkbox" class="toggle" title="show/hide"  value="1" />
				<div class="specialmove-description hide">
					When you face a challenge as a team and choose a team leader, then answer the following questions. 
					<button type="roll" class="inlinebutton" name="roll_ActAsATeam" 
					value="&{template:dim} {{name=Act As a Team}} {{rollvalue=[[2d6+@{teamquestion-together}+@{teamquestion-prepare}+@{teamquestion-distrust}+@{teamquestion-conditions}]]}} {{Hit= The leader chooses one team member to hold 1 additional Maneuver.}} {{Partial= Each team member holds 1 Maneuver.}} {{Miss= The leader chooses one team member to hold 1 Maneuver.}}">
					Roll +Questions</button> 
					<ul>
						<li>
							<label class="question-label">
								<input type="checkbox" name="attr_teamquestion-together" value=1>
								Are all team members pursuing the same resolution? If yes, add +1
							</label>
						</li>
						<li>
							<label class="question-label">
								<input type="checkbox" name="attr_teamquestion-prepare" value=1>
								Did the team take time to prepare for the challenge? If yes, add +1
							</label>
						</li>
						<li>
							<label class="question-label">
								<input type="checkbox" name="attr_teamquestion-distrust" value=-1>
								Does at least one team member not trust another team member? If yes, add -1
							</label>
						</li>
						<li>
							<label class="question-label">
								<input type="checkbox" name="attr_teamquestion-conditions" value=-1>
								Is every team member suffering the penalties of one or more Conditions? If yes, add -1
							</label>
						</li>
					</ul>
					On a miss, the leader chooses one team member to hold 1 Maneuver. On a hit, each team member holds 1 Maneuver. On a 10+ the leader chooses one team member to hold 1 additional Maneuver.
					<br>You may spend Maneuver to do the following. More than one team member may spend Maneuver on the same roll, though no team member may spend more than one Maneuver on a single roll.
					<ul>
						<li>
							<strong>Here to Help:</strong> Spend 1 Maneuver and describe how you are assisting a team member to grant them +1 on a Basic move they’ve just made.
						</li>
						<li>
							<strong>Not on My Watch:</strong> Spend 1 Maneuver to add +1 to a Defend Another or Salve Wounds roll you just made. Describe how your training or relationship helps the target of your move.
						</li>
					</ul>
					A team member loses all unused Maneuver at the end of a session, when significant time has passed, when the narrative dictates there is a break in team cohesion, or if the Guide makes a hard move to do so.
				</div>
			</div>
			<div class="specialmove">
				<span class="specialmove-name">Descend Into Midnight</span>
				<input type="checkbox" class="toggle" title="show/hide"  value="1" />
				<div class="specialmove-description hide">
					When you embrace the negative emotions within you, mark Corruption and treat the result of any roll you just made or are about to make as a 10+. After resolving the Move, tell the Guide who or what was hurt most by your actions and mark the Condition associated with the stat of the Move you just made. If that Condition is already marked, roll to <strong>Resist Corruption</strong>
				</div>
			</div>
			<div class="specialmove">
				<span class="specialmove-name">Unleash</span>
				<input type="checkbox" class="toggle" title="show/hide"  value="1" />
				<div class="specialmove-description hide">
					When you <strong>give in to violence</strong>, <button type="roll" class="inlinebutton" name="roll_FILLMEIN"
					value="&{template:dim} {{name=Unleash}}  {{rollvalue=[[2d6+@{unleashquestion-protect}+@{unleashquestion-onlyone}+@{unleashquestion-nooption}]]}} {{Hit= Choose one consequence instead.}} {{Partial= You tear scale from skin and face the consequences. Choose two.}}">
					roll +Questions.</button>
					<ul>
						<li>
							<label class="question-label">
								<input type="checkbox" name="attr_unleashquestion-protect" value=1>
								Are you doing this to protect your community? If yes, +1
							</label>
						</li>
						<li>
							<label class="question-label">
								<input type="checkbox" name="attr_unleashquestion-onlyone" value=1>
								Are you doing this because you’re the only one who can? If yes, +1
							</label>
						</li>
						<li>
							<label class="question-label">
								<input type="checkbox" name="attr_unleashquestion-nooption" value=1>
								Are there really no other options? If yes, +1
							</label>
						</li>
					</ul>
					On a hit, you tear scale from skin and face the consequences. On a 10+, choose one. On a 7-9, choose two:
					<ul>
						<li>They retaliate as indicated by the narrative.</li>
						<li>You lose ground and your opponent gains an opportunity.</li>
						<li>You lose control in a brutal or terrifying way.</li>
					</ul>
				</div>
			</div>
			<div class="specialmove">
				<span class="specialmove-name">Endure</span>
				<input type="checkbox" class="toggle" title="show/hide"  value="1" />
				<div class="specialmove-description hide">
					When you <strong>endure physical, emotional, or psychic trauma</strong>, <button type="roll" class="inlinebutton" name="roll_FILLMEIN"
					value="&{template:dim} {{name=Endure}}  {{rollvalue=[[2d6+@{conditionsmarked}]]}} {{Hit= Either remove yourself from the scene in some way or choose two from the list}} {{Partial= Choose one from the list}} {{Miss= You avoid other consequences}}">
					roll +Conditions marked.</button>
					On a 10+ it takes its toll. Either remove yourself from the scene in some way or choose two from the following list. On a 7-9, choose one:
					<ul>
						<li>The trauma unsettles you. Mark a Condition</li>
						<li>The trauma impairs your physical, emotional, or psychic defenses. Mark Corruption</li>
						<li>Your attempt to defend yourself goes wrong. Expose an ally to danger.</li>
						<li>The trauma damages you in some way. Take -1 Ongoing and remain in pain, distressed, or distracted until you receive help as defined by the narrative.</li>
					</ul>
					<br>On a 6-, you avoid consequence, and mark Harmony as normal.
				</div>
			</div>
			<div class="specialmove">
				<span class="specialmove-name">Resist Corruption</span>
				<input type="checkbox" class="toggle" title="show/hide"  value="1" />
				<div class="specialmove-description hide">
					When you are <strong>exposed to concentrated or insidious Corruption</strong>, <button type="roll" class="inlinebutton" name="roll_FILLMEIN"
					value="&{template:dim} {{name=Resist Corruption}}  {{rollvalue=[[2d6+@{corruptionmarked}]]}} {{Hit= The corruption works its way deeper into your mind, body, and soul. Mark Corruption instead.}} {{Partial= You stave off the corruption for now, but something inside you is unsettled. Mark a Condition.}} {{Miss= You hold onto your true self. You keep the corruption at bay and reduce your Corruption score by 1.}}">
					roll +Corruption marked.</button>
					On a 10+ the corruption works its way deeper into your mind, body, and soul. Mark Corruption. On a 7-9, you stave off the corruption for now, but something inside you is unsettled. Mark a Condition. On a 6-, mark Harmony as normal and hold onto your true self. You keep the corruption at bay and reduce your Corruption score by 1.
				</div>
			</div>
			<div class="specialmove">
				<span class="specialmove-name">What Have We Done?</span>
				<input type="checkbox" class="toggle" title="show/hide"  value="1" />
				<div class="specialmove-description hide">
					When you <strong>pause to reflect on the harm you’ve caused</strong>, <button type="roll" class="inlinebutton" name="roll_FILLMEIN"
					value="&{template:dim} {{name=What Have We Done?}}  {{rollvalue=[[2d6+@{conditionsmarked}]]}} {{Hit= Also mark corruption}} {{Partial= On a hit, you worry that your actions were a part of who you are, who you were, or who you’re becoming. Choose one.}} {{Miss= Clear a Condition and narrate your character coming to terms with the trauma or engaging in a conversation with another to talk about what happened.}}">
					roll +Conditions marked.</button>
					On a hit, you worry that your actions were a part of who you are, who you were, or who you’re becoming. Choose one. On a 10+, also mark Corruption:
					<ul>
						<li>Clear Despairing and try to convince someone of an impending doom.</li>
						<li>Clear Selfish and become overprotective of someone or something of significance.</li>
						<li>Clear Isolated and push someone close to you away.</li>
						<li>Clear Angry and lash out at someone close to you or break something of significance.</li>
						<li>Clear Conflicted and act to prove yourself and your actions.</li>
						<li>Your actions weigh heavily on you. <strong>Resist Corruption.</strong></li>
					</ul>
					On a 6-, clear a Condition and narrate your character coming to terms with the trauma or engaging in a conversation with another to talk about what happened.
				</div>
			</div>
		</div>
	</div>

</div>

<!-- ROLL TEMPLATES -->

<!-- &{template:dim} {{name=Test}} {{rollvalue=[[2d6]]}} {{Hit= Hit Content}} {{Partial= Partial Content}} {{Miss= Miss Content}}-->

<rolltemplate class="sheet-rolltemplate-dim">
	<div class="container">
		<div class="template-header">{{name}}</div>
		<div class="template-row roll"><em>Roll:</em> {{rollvalue}}</div>
		{{#rollGreater() rollvalue 6}}
			<div class="template-row partial">
				<strong>Hit:</strong> {{Partial}}
			</div>
		{{/rollGreater() rollvalue 6}}
		{{#rollGreater() rollvalue 9}} {{#Hit}}
			<div class="template-row hit">
				<strong>Hit+:</strong> {{Hit}}
			</div>
		{{/Hit}} {{/rollGreater() rollvalue 9}}
		{{#rollLess() rollvalue 7}} 
			<div class="template-row miss">
				Mark Harmony.
				{{#Miss}}<br><strong>Miss:</strong> {{Miss}}{{/Miss}} 
			</div>
		{{/rollLess() rollvalue 7}}
	</div>
</rolltemplate>


<!-- Sheet Worker Scripts! -->

<script  type="text/worker">

	on("sheet:opened", function () {
		console.log("Sheet opened, JS is running");
	});
	on("change:corruption1 change:corruption2 change:corruption3 change:corruption4 change:corruption5", function() {
        getAttrs(["corruption1", "corruption2", "corruption3", "corruption4", "corruption5"], function(values) {
            sum = 0;
            for (var el in values) {
                if( values.hasOwnProperty( el ) ) {
                      sum += parseInt( values[el] );
                }
                console.log("Iterating throuogh corruption sum")
            }
            setAttrs({
                corruptionmarked: sum
            });
        });
    });
    
    on("change:despairing change:selfish change:isolated change:angry change:conflicted", function() {
        getAttrs(["despairing", "selfish", "isolated", "angry", "conflicted"], function(values) {
            sum = 0;
            for (var el in values) {
                if( values.hasOwnProperty( el ) ) {
					  sum += parseInt( values[el] )/2;
                }
			}
            setAttrs({
                conditionsmarked: sum
            });
        });
    });
	
</script>
