<!-- Note that currently the sheet's html/javascript is too long to be used by the repo to generate a sheet. I use the following regex on regexr.com
to easily shrink the line count to what the repo can handle:
Look for: \n\s*
Replace with: 

This pattern can be found at https://regexr.com/3mi9v
-->
<div class='starfinder compendium-drop-target npcs'>
    <!--Drag and drop acceptors-->
    <input type="hidden" name="attr_drop_category" accept="Category" value=''>
    <input type="hidden" name="attr_drop_name" accept="Name" value=''>
    <input type="hidden" name="attr_drop_data" accept="data" value=''>
    <input type="hidden" name="attr_drop_content" accept="Content" value=''>
    <!--End compendium acceptors-->
    
    <input hidden='true' type='text' title='@{npc_init}' name='attr_npc_init' value=''>
    <input hidden='true' type='number' title='@{initiative_npc}' name='attr_initiative_npc'>
    <input hidden='true' type='number' title='@{bab}' name='attr_bab' value='0'>
    <!-- The above 3 attributes are used for calculations for NPCs-->
    <div class='name-container'>
        <img class='header-image' src='https://cdn.rawgit.com/Roll20/roll20-character-sheets/d0602504/Starfinder%20Official/Assets/starfinder_1000x200.png'>
    </div>
    <input class="tab-button options nav hide-tab" type="checkbox" title='@{tab_select}' name="attr_tab_select" value="options" checked>
    <span class='pictos nav'>y</span>
    <span class='nav pictos'>x</span>
    <input class='page-control' type='hidden' name='attr_sheet_type' value='pc'>
    <!-- Containers -->
    <div class='container settings'>
        <div class='section-container type-container'>
            <div class='section'><!-- section is the class that is placed as the header of a section-->
                <h1 class='label' data-i18n='comms'>COMMS</h1>
                <!-- always-glow is a class that has the glow applied always. bottom-left locates it relative to the item to be glowed. corner sets it to be rotated-->
            </div>
            <div class='section-container'>
                <div class='gutter'></div><!--provides a buffer via css grid placement-->
                <div class='row'> <!-- this row holds inputs that control the whisper state (/w gm or '')-->
                    <span class='label' data-i18n='rolls-are'>ROLLS ARE</span>
                    <label class='label'><input type='radio' title='@{whisper_state}' name='attr_whisper_state' value='' checked='checked'> <span class='label' data-i18n='public'>PUBLIC</span></label>
                    <label class='label'><input type='radio' title='@{whisper_state}' name='attr_whisper_state' value='/w gm '> <span class='label' data-i18n='private'>PRIVATE</span></label>
                </div>
                <div class='gutter'></div>
            </div>
        </div>
        <div class='section-container house-container'><!-- controls what type of sheet this is-->
            <div class='section'>
                <h1 class='label' data-i18n='display-mode'>DISPLAY MODE</h1>
            </div>
            <div class='section-container'>
                <div class='gutter'></div>
                <div class='row'>
                    <label><input type='radio' title='@{sheet_type}' name='attr_sheet_type' value='pc' checked='checked'> <span class='label' data-i18n='pc' >PC</span></label>
                    <label><input type='radio' title='@{sheet_type}' name='attr_sheet_type' value='npc'> <span class='label' data-i18n='npc'>NPC</span></label>
                    <label><input type='radio' title='@{sheet_type}' name='attr_sheet_type' value='ship'> <span class='label' data-i18n='ship'>SHIP</span></label>
                </div>
                <div class='row pcrow pc'>
                    <label><input type='checkbox' title='@{drone}' name='attr_drone' value='1'><span class='label' data-i18n='drone'>DRONE</span></label>
                </div>
                <div class='gutter'></div>
            </div>
        </div>
        <div class='section-container house-container'><!--holds various house rules and rule customization options-->
            <div class='section'>
                <h1 class='label' data-i18n='house-rules'>HOUSE RULES</h1>
            </div>
            <div class='section-container'>
                <div class='gutter'></div>
                <div class='row'>
                    <span class='label' data-i18n='resolve'>RESOLVE</span>
                    <label><input type='radio' title='@{resolve_source}' name='attr_resolve_source' value='key' checked='checked'> <span class='label' data-i18n='key-ability'>KEY ABILITY</span></label>
                    <label><input type='radio' title='@{resolve_source}' name='attr_resolve_source' value='highest'> <span class='label' data-i18n='highest-ability'>HIGHEST ABILITY</span></label>
                </div>
                <div class='row'>
                    <span class='label' data-i18n='buff-stacking'>BUFF STACKING</span>
                </div>
                <textarea class='buff-stack input-field' title='@{stackable_buffs}' name='attr_stackable_buffs'>Circumstance,Luck</textarea>
                <div class='row'>
                    <span class='label' data-i18n='half-specialization-weapons'>HALF SPECIALIZATION WEAPONS</span>
                </div>
                    <textarea class='buff-stack input-field' title='@{half_specializations}' name='attr_half_specializations'>operative,small_arm</textarea>
                <div class='gutter'></div>
            </div>
        </div>
    </div>
    <div class='in-play'><!-- contains the menus and buffs sections-->
        <input class='hide-tab menu-tab' type='radio' title='@{in-play-tab}' name='attr_in-play-tab' value='menus' checked>
        <div class='section menu-tab'>
            <h1 class='label' data-i18n='menus'>MENUS</h1>
        </div>
        <div class='menus'>
            <!-- contains the chat menus for the sheet. Menus that reference an attribute, like the attacks menu, are assembled by sheetworker. The default value is only so that something is output to chat if it is clicked before any change is made to the sheet-->
            <button type='roll' title='%{initiative}' name='roll_initiative' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Initiative}} {{r1=[[1d20+@{initiative_ability}[ABILITY]@{npc_init}@{initiative_misc}+[[(@{initiative_ability}[ABILITY]@{npc_init}@{initiative_misc})/100)]][TIE BREAKER]&{tracker}]]}}' data-i18n='initiative'>INITIATIVE</button>
            <button type='roll' title='%{attacks}' name='roll_attacks' value='@{attacks_menu}' data-i18n='attacks'>ATTACKS</button>
            <button type='roll' title='%{saves}' name='roll_saves' value='/w "@{character_name}" &{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=SAVES}} {{buttons1=[Fort](~@{character_name}|fort) | [Ref](~@{character_name}|ref) | [Will](~@{character_name}|will)}}' data-i18n='saves'>SAVES</button>
            <button type='roll' title='%{abilities}' name='roll_abilities' value='@{abilities_menu}' data-i18n='abilities-u'>ABILITIES</button>
            <button type='roll' title='%{ability_checks}' name='roll_ability_checks' value='/w "@{character_name}" &{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=ABILITY CHECKS}} {{buttons1=[Strength](~@{character_name}|strength) | [Dexterity](~@{character_name}|dexterity) | [Constitution](~@{character_name}|constitution) | [Intelligence](~@{character_name}|intelligence) | [Wisdom](~@{character_name}|wisdom) | [Charisma](~@{character_name}|charisma)}}' data-i18n='ability_checks'>ABILITY CHECKS</button>
            <button type='roll' title='%{skills}' name='roll_skills' value='@{skills_menu}' data-i18n='skills'>SKILLS</button>
            <input type='text' title='@{attacks_menu}' name='attr_attacks_menu' value='/w "@{character_name}" &{template:sf_generic} {{name=@{character_name}}} {{title=ATTACKS}}' hidden='true'>
            <input class='is-caster' title='@{caster_select}' name='attr_caster_select' type='checkbox' value='1' hidden='true'>
            <div class='spell-button-container spells'><!--Contains all the spell menus. This section is only shown if one of the classes is a spellcaster. This is controlled by sheetworkers-->
                <button type='roll' title='%{spells}' name='roll_spells' value='@{spells_menu}' data-i18n='spells'>SPELLS</button>
                <input type='text' title='@{spells_menu}' name='attr_spells_menu' value='/w "@{character_name}" &{template:sf_generic} {{name=@{character_name}}} {{title=SPELLBOOKS}}' hidden='true'>
                <!--These additional menus are displayed depending on which class is a spellcaster and contain menus specific to the spellcaster class-->
                <input class='class-1 class-spells' title='@{class_1_spells}' name='attr_class_1_spells' type='checkbox' value='1' hidden='true'>
                <button type='roll' title='%{class_1_spellbook}' name='roll_class_1_spellbook' value='@{class_1_spellbook}'><span class='class-1 class-name' type='text' title='@{class_1_name}' name='attr_class_1_name' value=''></span></button>
                
                <input class='class-2 class-spells' title='@{class_2_spells}' name='attr_class_2_spells' type='checkbox' value='1' hidden='true'>
                <button type='roll' title='%{class_2_spellbook}' name='roll_class_2_spellbook' value='@{class_2_spellbook}'><span class='class-1 class-name' type='text' title='@{class_2_name}' name='attr_class_2_name' value=''></span></button>
                
                <input class='class-3 class-spells' title='@{class_3_spells}' name='attr_class_3_spells' type='checkbox' value='1' hidden='true'>
                <button type='roll' title='%{class_3_spellbook}' name='roll_class_3_spellbook' value='@{class_3_spellbook}'><span class='class-1 class-name' type='text' title='@{class_3_name}' name='attr_class_3_name' value=''></span></button>
                
                <input class='class-4 class-spells' title='@{class_4_spells}' name='attr_class_4_spells' type='checkbox' value='1' hidden='true'>
                <button type='roll' title='%{class_4_spellbook}' name='roll_class_4_spellbook' value='@{class_4_spellbook}'><span class='class-1 class-name' type='text' title='@{class_4_name}' name='attr_class_4_name' value=''></span></button>
                
                <input class='class-5 class-spells' title='@{class_5_spells}' name='attr_class_5_spells' type='checkbox' value='1' hidden='true'>
                <button type='roll' title='%{class_5_spellbook}' name='roll_class_5_spellbook' value='@{class_5_spellbook}'><span class='class-1 class-name' type='text' title='@{class_5_name}' name='attr_class_5_name' value=''></span></button>
                
                <input type='text' title='@{class_1_spellbook}' name='attr_class_1_spellbook' value='/w "@{character_name}" &{template:sf_generic} {{name=@{character_name}}}' hidden='true'>
                <input type='text' title='@{class_2_spellbook}' name='attr_class_2_spellbook' value='/w "@{character_name}" &{template:sf_generic} {{name=@{character_name}}}' hidden='true'>
                <input type='text' title='@{class_3_spellbook}' name='attr_class_3_spellbook' value='/w "@{character_name}" &{template:sf_generic} {{name=@{character_name}}}' hidden='true'>
                <input type='text' title='@{class_4_spellbook}' name='attr_class_4_spellbook' value='/w "@{character_name}" &{template:sf_generic} {{name=@{character_name}}}' hidden='true'>
                <input type='text' title='@{class_5_spellbook}' name='attr_class_5_spellbook' value='/w "@{character_name}" &{template:sf_generic} {{name=@{character_name}}}' hidden='true'>
            </div>
            <input type='text' title='@{abilities_menu}' name='attr_abilities_menu' value='/w "@{character_name}" &{template:sf_generic} {{name=@{character_name}}} {{title=ABILITIES}}' hidden='true'>
            <input type='text' title='@{skills_menu}' name='attr_skills_menu' value='/w "@{character_name}" &{template:sf_generic} {{name=@{character_name}}} {{title=SKILLS}}' hidden='true'>
        </div>
        <input class='hide-tab buff-tab' type='radio' title='@{in-play-tab}' name='attr_in-play-tab' value='buffs'>
        <div class='section buff-tab'>
            <h1 class='label' data-i18n='buffs'>BUFFS</h1>
        </div>
        <div class='buffs'><!-- contains the buffs repeating section-->
            <fieldset class='repeating_buff'>
                <input class='filter' type='checkbox' hidden='true' title='@{filter}' name='attr_filter' value='1' checked='checked'>
                <div class='filter-container buff'>
                    <input class="show-options" type="checkbox" title='@{show_options}' name="attr_show_options" checked="checked"><span>y</span>
                    <div class='row-options'>
                        <input class='buff-name input-field' type='text' title='@{name}' name='attr_name' placeholder='Haste'>
                        <div class='mod-container'>
                            <span class='label buff-mod' data-i18n='mods'>MODS</span>
                            <textarea class='buff-mod input-field' title='@{mods}' name='attr_mods'placeholder='+X to EAC'></textarea>
                        </div>
                    </div>
                    <div class='display'>
                        <label>
                            <input type='checkbox' title='@{toggle}' name='attr_toggle' value='1'>
                            <span class='buff-name label' title='@{name}' name='attr_name'>TEST</span>
                        </label>
                    </div>
                </div>
            </fieldset>
        </div>
        <input class='hide-tab condition-tab' type='radio' title='@{in-play-tab}' name='attr_in-play-tab' value='conditions'>
        <div class='section condition-tab'>
            <h1 class='label' data-i18n='conditions'>CONDITIONS</h1>
        </div>
        <div class='conditions'>
            <div class='span-all track-container'>
                <fieldset class='repeating_condition'>
                    <input class='filter' type='checkbox' hidden='true' title='@{filter}' name='attr_filter' value='1' checked='checked'>
                    <div class='filter-container condition'>
                        <input class="show-options" type="checkbox" title='@{show_options}' name="attr_show_options" checked><span>y</span>
                        <div class='row-options'>
                            <div class='row span-all display-margin'>
                                <span class='label' data-i18n='name-u'>NAME</span>
                                <input class='atk-name scalable-input input-field' type='text' title='@{name}' name='attr_name' placeholder='Insanity' value=''>
                            </div>
                            <div class='row span-all'>
                                <span class='label' data-i18n='track'>TRACK</span>
                                <input type='hidden' name='attr_track' placeholder='Insanity' value='physical_track'>
                                <select class='scalable-input input-field' title='@{repeating_condition_$X_track}' name='attr_track'>
                                    <option value='physical_track' data-i18n='physical_track' selected>PHYSICAL TRACK</option>
                                    <option value='mental_track' data-i18n='mental_track' selected>MENTAL TRACK</option>
                                    <option value='strength_track' data-i18n='strength_track' selected>STRENGTH TRACK</option>
                                    <option value='dexterity_track' data-i18n='dexterity_track' selected>DEXTERITY TRACK</option>
                                    <option value='constitution_track' data-i18n='constitution_track' selected>CONSTITUTION TRACK</option>
                                    <option value='intelligence_track' data-i18n='intelligence_track' selected>INTELLIGENCE TRACK</option>
                                    <option value='wisdom_track' data-i18n='wisdom_track' selected>WISDOM TRACK</option>
                                    <option value='charisma_track' data-i18n='charisma_track' selected>CHARISMA TRACK</option>
                                </select>
                            </div>
                            <textarea class='row span-all' name='attr_description' title='repeating_condition_$X_description'></textarea>
                        </div>
                        <div class='display'>
                            <div class='button-description'>
                                <input type='text' readonly='true' name='attr_name' placeholder='Insanity' value=''>
                                <label class='expand-button'><input hidden='true' class='expand-description' type='checkbox' name='attr_expand_description' value='1'><span class='collapsed pictos'>`</span><span class='expanded pictos'>J</span></label>
                            </div>
                            <div class='tracks'>
                                <input class='track-filter' type='hidden' name='attr_track' placeholder='Insanity' value='physical_track'>
                                <label><input class='healthy' type='radio' hidden='true' data-i18n-title='healthy' title='HEALTHY' name='attr_track_status' value='healthy' checked><span class='label' data-i18n='healthy'>HEALTHY</span></label>
                                <input class='specific-track physical mental' type='radio' data-i18n-title='latent' title='latent' name='attr_track_status' value='latent'>
                                <input class='specific-track dexterity' type='radio' data-i18n-title='sluggish' title='sluggish' name='attr_track_status' value='sluggish'>
                                <input class='specific-track dexterity' type='radio' data-i18n-title='stiffened' title='stiffened' name='attr_track_status' value='stiffened'>
                                <input class='specific-track physical mental strength constitution intelligence wisdom charisma' type='radio' data-i18n-title='weakened' title='weakened' name='attr_track_status' value='weakened'>
                                <input class='specific-track physical mental strength constitution intelligence wisdom charisma' type='radio' data-i18n-title='impaired' title='impaired' name='attr_track_status' value='impaired'>
                                <input class='specific-track charisma' type='radio' data-i18n-title='pliable' title='pliable' name='attr_track_status' value='pliable'>
                                <input class='specific-track charisma' type='radio' data-i18n-title='catatonic' title='catatonic' name='attr_track_status' value='catatonic'>
                                <input class='specific-track wisdom' type='radio' data-i18n-title='confused' title='confused' name='attr_track_status' value='confused'>
                                <input class='specific-track intelligence' type='radio' data-i18n-title='animalistic' title='animalistic' name='attr_track_status' value='animalistic'>
                                <input class='specific-track constitution' type='radio' data-i18n-title='debilitated' title='debilitated' name='attr_track_status' value='debilitated'>
                                <input class='specific-track constitution' type='radio' data-i18n-title='unconscious' title='unconscious' name='attr_track_status' value='unconscious'>
                                <input class='specific-track strength dexterity' type='radio' data-i18n-title='staggered' title='staggered' name='attr_track_status' value='staggered'>
                                <input class='specific-track strength dexterity' type='radio' data-i18n-title='immobile' title='immobile' name='attr_track_status' value='immobile'>
                                <input class='specific-track mental' type='radio' data-i18n-title='befuddled' title='befuddled' name='attr_track_status' value='befuddled'>
                                <input class='specific-track mental' type='radio' data-i18n-title='disassociated' title='disassociated' name='attr_track_status' value='disassociated'>
                                <input class='specific-track physical' type='radio' data-i18n-title='debilitated' title='debilitated' name='attr_track_status' value='debilitating'>
                                <input class='specific-track physical' type='radio' data-i18n-title='bedridden' title='bedridden' name='attr_track_status' value='bedridden'>
                                <input class='specific-track physical mental intelligence wisdom' type='radio' data-i18n-title='comatose' title='comatose' name='attr_track_status' value='comatose'>
                                <label><input class='dead' type='radio' hidden='true' data-i18n-title='dead' title='dead' name='attr_track_status' value='dead'><span class='label' data-i18n='dead'>DEAD</span></label>
                            </div>
                            <input class='expand-description' type='hidden' name='attr_expand_description'>
                            <textarea class='description span-all' title='@{description}' name='attr_description' placeholder='Description'></textarea>
                        </div>
                    </div>
                </fieldset>
            </div>
            <label class='label tactical-condition'><input value='1' type='checkbox' hidden='true' name='attr_asleep'><span class='input-field' data-i18n='asleep'>ASLEEP</span></label>
            <label class='label tactical-condition'><input value='1' type='checkbox' hidden='true' name='attr_bleeding'><span class='input-field' data-i18n='bleeding'>BLEEDING</span></label>
            <label class='label tactical-condition'><input value='1' type='checkbox' hidden='true' name='attr_blinded'><span class='input-field' data-i18n='blinded'>BLINDED</span></label>
            <label class='label tactical-condition'><input value='1' type='checkbox' hidden='true' name='attr_burning'><span class='input-field' data-i18n='burning'>BURNING</span></label>
            <label class='label tactical-condition'><input value='1' type='checkbox' hidden='true' name='attr_confused'><span class='input-field' data-i18n='confused'>CONFUSED</span></label>
            <label class='label tactical-condition'><input value='1' type='checkbox' hidden='true' name='attr_cowering'><span class='input-field' data-i18n='cowering'>COWERING</span></label>
            <label class='label tactical-condition'><input value='1' type='checkbox' hidden='true' name='attr_dazed'><span class='input-field' data-i18n='dazed'>DAZED</span></label>
            <label class='label tactical-condition'><input value='1' type='checkbox' hidden='true' name='attr_dazzled'><span class='input-field' data-i18n='dazzled'>DAZZLED</span></label>
            <label class='label tactical-condition'><input value='1' type='checkbox' hidden='true' name='attr_dead'><span class='input-field' data-i18n='dead'>DEAD</span></label>
            <label class='label tactical-condition'><input value='1' type='checkbox' hidden='true' name='attr_deafened'><span class='input-field' data-i18n='deafened'>DEAFENED</span></label>
            <label class='label tactical-condition'><input value='1' type='checkbox' hidden='true' name='attr_dying'><span class='input-field' data-i18n='dying'>DYING</span></label>
            <div class='label tactical-condition input-field'><input class='encumbrance' hidden='true' type='number' min='1' max='1' name='attr_encumber_level' value='0'><span class='span-two' data-i18n='encumbered'>ENCUMBERED</span></div>
            <label class='label tactical-condition'><input value='1' type='checkbox' hidden='true' name='attr_entangled'><span class='input-field' data-i18n='entangled'>ENTANGLED</span></label>
            <label class='label tactical-condition'><input value='1' type='checkbox' hidden='true' name='attr_exhausted'><span class='input-field' data-i18n='exhausted'>EXHAUSTED</span></label>
            <label class='label tactical-condition'><input value='1' type='checkbox' hidden='true' name='attr_fascinated'><span class='input-field' data-i18n='fascinated'>FASCINATED</span></label>
            <label class='label tactical-condition'><input value='1' type='checkbox' hidden='true' name='attr_fatigued'><span class='input-field' data-i18n='fatigued'>FATIGUED</span></label>
            <label class='label tactical-condition'><input value='1' type='checkbox' hidden='true' name='attr_flat_footed'><span class='input-field' data-i18n='flat_footed'>FLAT-FOOTED</span></label>
            <label class='label tactical-condition'><input value='1' type='checkbox' hidden='true' name='attr_frightened'><span class='input-field' data-i18n='frightened'>FRIGHTENED</span></label>
            <label class='label tactical-condition'><input value='1' type='checkbox' hidden='true' name='attr_grappled'><span class='input-field' data-i18n='grappled'>GRAPPLED</span></label>
            <label class='label tactical-condition'><input value='1' type='checkbox' hidden='true' name='attr_helpless'><span class='input-field' data-i18n='helpless'>HELPLESS</span></label>
            <label class='label tactical-condition'><input value='1' type='checkbox' hidden='true' name='attr_nauseated'><span class='input-field' data-i18n='nauseated'>NAUSEATED</span></label>
            <div class='tactical-condition'><input class='input-field' type='number' class='label' name='attr_negative_levels' value='0'><span class='label' data-i18n='negative_levels'>NEGATIVE LEVELS</span></div>
            <label class='label tactical-condition'><input value='1' type='checkbox' hidden='true' name='attr_off_kilter'><span class='input-field' data-i18n='off_kilter'>OFF-KILTER</span></label>
            <label class='label tactical-condition'><input value='1' type='checkbox' hidden='true' name='attr_off_target'><span class='input-field' data-i18n='off_target'>OFF-TARGET</span></label>
            <div class='label tactical-condition input-field'><input class='encumbrance' hidden='true' type='number' min='2' max='2' name='attr_encumber_level' value='0'><span class='span-two' data-i18n='overburdened'>OVERBURDENED</span></div>
            <label class='label tactical-condition'><input value='1' type='checkbox' hidden='true' name='attr_panicked'><span class='input-field' data-i18n='panicked'>PANICKED</span></label>
            <label class='label tactical-condition'><input value='1' type='checkbox' hidden='true' name='attr_paralyzed'><span class='input-field' data-i18n='paralyzed'>PARALYZED</span></label>
            <label class='label tactical-condition'><input value='1' type='checkbox' hidden='true' name='attr_pinned'><span class='input-field' data-i18n='pinned'>PINNED</span></label>
            <label class='label tactical-condition'><input value='1' type='checkbox' hidden='true' name='attr_prone'><span class='input-field' data-i18n='prone'>PRONE</span></label>
            <label class='label tactical-condition'><input value='1' type='checkbox' hidden='true' name='attr_shaken'><span class='input-field' data-i18n='shaken'>SHAKEN</span></label>
            <label class='label tactical-condition'><input value='1' type='checkbox' hidden='true' name='attr_sickened'><span class='input-field' data-i18n='sickened'>SICKENED</span></label>
            <label class='label tactical-condition'><input value='1' type='checkbox' hidden='true' name='attr_stable'><span class='input-field' data-i18n='stable'>STABLE</span></label>
            <label class='label tactical-condition'><input value='1' type='checkbox' hidden='true' name='attr_staggered'><span class='input-field' data-i18n='staggered'>STAGGERED</span></label>
            <label class='label tactical-condition'><input value='1' type='checkbox' hidden='true' name='attr_stunned'><span class='input-field' data-i18n='stunned'>STUNNED</span></label>
            <label class='label tactical-condition'><input value='1' type='checkbox' hidden='true' name='attr_unconscious'><span class='input-field' data-i18n='unconscious'>UNCONSCIOUS</span></label>
        </div>
    </div>
    <div class="container pc"><!-- holds all of the pc sheets-->
        <div class='content-container header-content'><!-- contains the character info and class info sections-->
            <input class='hide-tab char-details' title='@{char-tab}' name='attr_char-tab' type='radio' value='char info' checked='checked'><!--hide-tab ensures that the checkbox is set to opacity 0. The other class in the class declaration sets where the pseudo button is located-->
            <div class='section char-details'>
                <h1 class='label' data-i18n='character'>CHARACTER</h1>
            </div>
            <input class='hide-tab class-details' title='@{char-tab}' name='attr_char-tab' type='radio' value='class details'>
            <div class='section class-details'>
                <h1 class='label' data-i18n='class'>CLASS</h1>
            </div>
            <input class='is-not-caster' title='@{is_caster}' name='attr_is_caster' type='radio' value='0' hidden='true' checked='checked'>
            <input class='is-caster' title='@{is_caster}' name='attr_is_caster' type='radio' value='1' hidden='true'>
            <input class='hide-tab third-tab spells' title='@{char-tab}' name='attr_char-tab' type='radio' value='spellcaster'>
            <div class='spells third-tab section'>
                <h1 class='label' data-i18n='spellclasses'>SPELLCLASSES</h1>
            </div>
            <div class='char-info'>
                <div class='hlabel-container char-name'><!-- hlabel-container creates a div that is styled so that the input is on the top, and the label is below, with both centered in the container-->
                    <input class='input-field' type="text" title='@{character_name}' name="attr_character_name">
                    <span class="label" data-i18n="char-name-u">CHARACTER NAME</span>
                </div>
                <div class='hlabel-container class-level'>
                    <input class='input-field' type='text' readonly='true' title='@{class&level}' name='attr_class&level' >
                    <span class='label' data-i18n='class-level'>CLASS/LEVEL</span>
                </div>
                <div class='hlabel-container race'>
                    <input class='input-field' type='text' title='@{race}' name='attr_race' >
                    <span class='label' data-i18n='race'>RACE</span>
                </div>
                <div class='hlabel-container race-hp'>
                    <input class='input-field' class='' type='number' title='@{race_hp}' name='attr_race_hp' >
                    <span class='label' data-i18n='hp'>HP</span>
                </div>
                <div class='hlabel-container theme'>
                    <input class='input-field' type='text' title='@{theme}' name='attr_theme' >
                    <span class='label' data-i18n='theme'>THEME</span>
                </div>
                <div class='hlabel-container size'>
                    <select class='input-field' title='@{size}' name='attr_size'>
                        <option value='-4' data-i18n='fine'>FINE</option>
                        <option value='-3' data-i18n='diminutive'>DIMINUTIVE</option>
                        <option value='-2' data-i18n='tiny'>TINY</option>
                        <option value='-1' data-i18n='small'>SMALL</option>
                        <option value='0' data-i18n='medium' selected>MEDIUM</option>
                        <option value='1' data-i18n='large'>LARGE</option>
                        <option value='2' data-i18n='huge'>HUGE</option>
                        <option value='3' data-i18n='gargantuan'>GARGANTUAN</option>
                        <option value='4' data-i18n='colossal'>COLOSSAL</option>
                    </select>
                    <span class='label' data-i18n='size'>SIZE</span>
                </div>
                <div class='hlabel-container speed'>
                    <input class='input-field' type='text' title='@{speed}' name='attr_speed' >
                    <span class='label' data-i18n='speed'>SPEED</span>
                </div>
                <div class='hlabel-container gender'>
                    <input class='input-field' type='text' title='@{gender}' name='attr_gender' >
                    <span class='label' data-i18n='gender'>GENDER</span>
                </div>
                <div class='hlabel-container home-world'>
                    <input class='input-field' type='text' title='@{home_world}' name='attr_home_world' >
                    <span class='label' data-i18n='home-world'>HOME WORLD</span>
                </div>
                <div class='hlabel-container alignment'>
                    <input class='input-field' type='text' title='@{alignment}' name='attr_alignment' >
                    <span class='label' data-i18n='alignment'>ALIGNMENT</span>
                </div>
                <div class='hlabel-container deity'>
                    <input class='input-field' type='text' title='@{deity}' name='attr_deity' >
                    <span class='label' data-i18n='deity'>DEITY</span>
                </div>
                <div class='hlabel-container player'>
                    <input class='input-field' type='text' title='@{player}' name='attr_player' >
                    <span class='label' data-i18n='player'>PLAYER</span>
                </div>
                <div class='hlabel-container language'>
                    <input class='input-field' type='text' title='@{language}' name='attr_language' >
                    <span class='label' data-i18n='languages'>LANGUAGES</span>
                </div>
            </div>
            <div class='class-info'><!-- contains all of the basic class info like sp/hp per level, bab, saves, skills, and spellcasting-->
                <div class='left-gutter'></div>
                <div class='right-gutter'></div>
                <span class='label class-name' data-i18n='class'>CLASS</span>
                <span class='label class-num-level' data-i18n='class-num-level'>LVL</span>
                <span class='label class-health' data-i18n='class-stam'>SP</span>
                <span class='label class-health' data-i18n='hp'>HP</span>
                <span class='label class-bab' data-i18n='bab'>BAB</span>
                <span class='label class-save' data-i18n='fort'>FORT</span>
                <span class='label class-save' data-i18n='ref'>REF</span>
                <span class='label class-save' data-i18n='will'>WILL</span>
                <span class='label class-skills' data-i18n='skills'>SKILLS</span>
                <span class='label class-ability' data-i18n='abi'>ABI</span>
                <span class='label class-spells' data-i18n='spell'>SPELL</span>
                <!-- class 1 -->
                <input class='class-1 class-name input-field' type='text' title='@{class_1_name}' name='attr_class_1_name' placeholder='1st Class'>
                <input class='class-1 class-num-level input-field' type='number' title='@{class_1_level}' name='attr_class_1_level' placeholder='1'>
                <input class='class-1 class-health input-field' type='number' title='@{class_1_sp}' name='attr_class_1_sp' placeholder='4'>
                <input class='class-1 class-health input-field' type='number' title='@{class_1_hp}' name='attr_class_1_hp' placeholder='4'>
                <select class='class-1 class-bab input-field' title='@{class_1_bab}' name='attr_class_1_bab'>
                    <option value='0.5'>1/2</option>
                    <option value='0.75' selected>3/4</option>
                    <option value='1'>1</option>
                </select>
                <select class='class-1 class-save input-field' title='@{class_1_fort}' name='attr_class_1_fort'>
                    <option value='poor' data-i18n='poor' selected>POOR</option>
                    <option value='good' data-i18n='good'>GOOD</option>
                </select>
                <select class='class-1 class-save input-field' title='@{class_1_ref}' name='attr_class_1_ref'>
                    <option value='poor' data-i18n='poor' selected>POOR</option>
                    <option value='good' data-i18n='good'>GOOD</option>
                </select>
                <select class='class-1 class-save input-field' title='@{class_1_will}' name='attr_class_1_will'>
                    <option value='poor' data-i18n='poor' selected>POOR</option>
                    <option value='good' data-i18n='good'>GOOD</option>
                </select>
                <input class='class-1 class-skills input-field' type='number' title='@{class_1_skills}' name='attr_class_1_skills' placeholder='4'>
                <select class='class-1 class-ability input-field' title='@{class_1_ability}' name='attr_class_1_ability' placeholder='@{class_1_ability}'>
                    <option value='@{strength_mod}' data-i18n='str'>STR</option>
                    <option value='@{dexterity_mod}' data-i18n='dex' selected>DEX</option>
                    <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                    <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                    <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                    <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                </select>
                <input class='class-1 class-spells' title='@{class_1_spells}' name='attr_class_1_spells' type='checkbox' value='1'>
                <!-- class 2 -->
                <input class='class-2 class-name input-field' type='text' title='@{class_2_name}' name='attr_class_2_name' placeholder='2nd Class'>
                <input class='class-2 class-num-level input-field' type='number' title='@{class_2_level}' name='attr_class_2_level' placeholder='1'>
                <input class='class-2 class-health input-field' type='number' title='@{class_2_sp}' name='attr_class_2_sp' placeholder='4'>
                <input class='class-2 class-health input-field' type='number' title='@{class_2_hp}' name='attr_class_2_hp' placeholder='4'>
                <select class='class-2 class-bab input-field' title='@{class_2_bab}' name='attr_class_2_bab'>
                    <option value='0.5'>1/2</option>
                    <option value='0.75' selected>3/4</option>
                    <option value='1'>1</option>
                </select>
                <select class='class-2 class-save input-field' title='@{class_2_fort}' name='attr_class_2_fort'>
                    <option value='poor' data-i18n='poor' selected>POOR</option>
                    <option value='good' data-i18n='good'>GOOD</option>
                </select>
                <select class='class-2 class-save input-field' title='@{class_2_ref}' name='attr_class_2_ref'>
                    <option value='poor' data-i18n='poor' selected>POOR</option>
                    <option value='good' data-i18n='good'>GOOD</option>
                </select>
                <select class='class-2 class-save input-field' title='@{class_2_will}' name='attr_class_2_will'>
                    <option value='poor' data-i18n='poor' selected>POOR</option>
                    <option value='good' data-i18n='good'>GOOD</option>
                </select>
                <input class='class-2 class-skills input-field' type='number' title='@{class_2_skills}' name='attr_class_2_skills' placeholder='4'>
                <select class='class-2 class-ability input-field' title='@{class_2_ability}' name='attr_class_2_ability' placeholder='@{class_2_ability}'>
                    <option value='@{strength_mod}' data-i18n='str'>STR</option>
                    <option value='@{dexterity_mod}' data-i18n='dex' selected>DEX</option>
                    <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                    <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                    <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                    <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                </select>
                <input class='class-2 class-spells' title='@{class_2_spells}' name='attr_class_2_spells' type='checkbox' value='1'>
                <!-- class 3 -->
                <input class='class-3 class-name input-field' type='text' title='@{class_3_name}' name='attr_class_3_name' placeholder='3rd Class'>
                <input class='class-3 class-num-level input-field' type='number' title='@{class_3_level}' name='attr_class_3_level' placeholder='1'>
                <input class='class-3 class-health input-field' type='number' title='@{class_3_sp}' name='attr_class_3_sp' placeholder='4'>
                <input class='class-3 class-health input-field' type='number' title='@{class_3_hp}' name='attr_class_3_hp' placeholder='4'>
                <select class='class-3 class-bab input-field' title='@{class_3_bab}' name='attr_class_3_bab'>
                    <option value='0.5'>1/2</option>
                    <option value='0.75' selected>3/4</option>
                    <option value='1'>1</option>
                </select>
                <select class='class-3 class-save input-field' title='@{class_3_fort}' name='attr_class_3_fort'>
                    <option value='poor' data-i18n='poor' selected>POOR</option>
                    <option value='good' data-i18n='good'>GOOD</option>
                </select>
                <select class='class-3 class-save input-field' title='@{class_3_ref}' name='attr_class_3_ref'>
                    <option value='poor' data-i18n='poor' selected>POOR</option>
                    <option value='good' data-i18n='good'>GOOD</option>
                </select>
                <select class='class-3 class-save input-field' title='@{class_3_will}' name='attr_class_3_will'>
                    <option value='poor' data-i18n='poor' selected>POOR</option>
                    <option value='good' data-i18n='good'>GOOD</option>
                </select>
                <input class='class-3 class-skills input-field' type='number' title='@{class_3_skills}' name='attr_class_3_skills' placeholder='4'>
                <select class='class-3 class-ability input-field' title='@{class_3_ability}' name='attr_class_3_ability' placeholder='@{class_3_ability}'>
                    <option value='@{strength_mod}' data-i18n='str'>STR</option>
                    <option value='@{dexterity_mod}' data-i18n='dex' selected>DEX</option>
                    <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                    <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                    <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                    <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                </select>
                <input class='class-3 class-spells' title='@{class_3_spells}' name='attr_class_3_spells' type='checkbox' value='1'>
                <!-- class 4 -->
                <input class='class-4 class-name input-field' type='text' title='@{class_4_name}' name='attr_class_4_name' placeholder='4th Class'>
                <input class='class-4 class-num-level input-field' type='number' title='@{class_4_level}' name='attr_class_4_level' placeholder='1'>
                <input class='class-4 class-health input-field' type='number' title='@{class_4_sp}' name='attr_class_4_sp' placeholder='4'>
                <input class='class-4 class-health input-field' type='number' title='@{class_4_hp}' name='attr_class_4_hp' placeholder='4'>
                <select class='class-4 class-bab input-field' title='@{class_4_bab}' name='attr_class_4_bab'>
                    <option value='0.5'>1/2</option>
                    <option value='0.75' selected>3/4</option>
                    <option value='1'>1</option>
                </select>
                <select class='class-4 class-save input-field' title='@{class_4_fort}' name='attr_class_4_fort'>
                    <option value='poor' data-i18n='poor' selected>POOR</option>
                    <option value='good' data-i18n='good'>GOOD</option>
                </select>
                <select class='class-4 class-save input-field' title='@{class_4_ref}' name='attr_class_4_ref'>
                    <option value='poor' data-i18n='poor' selected>POOR</option>
                    <option value='good' data-i18n='good'>GOOD</option>
                </select>
                <select class='class-4 class-save input-field' title='@{class_4_will}' name='attr_class_4_will'>
                    <option value='poor' data-i18n='poor' selected>POOR</option>
                    <option value='good' data-i18n='good'>GOOD</option>
                </select>
                <input class='class-4 class-skills input-field' type='number' title='@{class_4_skills}' name='attr_class_4_skills' placeholder='4'>
                <select class='class-4 class-ability input-field' title='@{class_4_ability}' name='attr_class_4_ability' placeholder='@{class_4_ability}'>
                    <option value='@{strength_mod}' data-i18n='str'>STR</option>
                    <option value='@{dexterity_mod}' data-i18n='dex' selected>DEX</option>
                    <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                    <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                    <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                    <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                </select>
                <input class='class-4 class-spells' title='@{class_4_spells}' name='attr_class_4_spells' type='checkbox' value='1'>
                <!-- class 5 -->
                <input class='class-5 class-name input-field' type='text' title='@{class_5_name}' name='attr_class_5_name' placeholder='5th Class'>
                <input class='class-5 class-num-level input-field' type='number' title='@{class_5_level}' name='attr_class_5_level' placeholder='1'>
                <input class='class-5 class-health input-field' type='number' title='@{class_5_sp}' name='attr_class_5_sp' placeholder='4'>
                <input class='class-5 class-health input-field' type='number' title='@{class_5_hp}' name='attr_class_5_hp' placeholder='4'>
                <select class='class-5 class-bab input-field' title='@{class_5_bab}' name='attr_class_5_bab'>
                    <option value='0.5'>1/2</option>
                    <option value='0.75' selected>3/4</option>
                    <option value='1'>1</option>
                </select>
                <select class='class-5 class-save input-field' title='@{class_5_fort}' name='attr_class_5_fort'>
                    <option value='poor' data-i18n='poor' selected>POOR</option>
                    <option value='good' data-i18n='good'>GOOD</option>
                </select>
                <select class='class-5 class-save input-field' title='@{class_5_ref}' name='attr_class_5_ref'>
                    <option value='poor' data-i18n='poor' selected>POOR</option>
                    <option value='good' data-i18n='good'>GOOD</option>
                </select>
                <select class='class-5 class-save input-field' title='@{class_5_will}' name='attr_class_5_will'>
                    <option value='poor' data-i18n='poor' selected>POOR</option>
                    <option value='good' data-i18n='good'>GOOD</option>
                </select>
                <input class='class-5 class-skills input-field' type='number' title='@{class_5_skills}' name='attr_class_5_skills' placeholder='4'>
                <select class='class-5 class-ability input-field' title='@{class_5_ability}' name='attr_class_5_ability' placeholder='@{class_5_ability}'>
                    <option value='@{strength_mod}' data-i18n='str'>STR</option>
                    <option value='@{dexterity_mod}' data-i18n='dex' selected>DEX</option>
                    <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                    <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                    <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                    <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                </select>
                <input class='class-5 class-spells' title='@{class_5_spells}' name='attr_class_5_spells' type='checkbox' value='1'>
            </div>
            <div class='spellclass-details'>
                <div class='gutter'></div>
                <!-- Caster 1 -->
                <input class='class-1 class-spells' title='@{class_1_spells}' name='attr_class_1_spells' type='checkbox' value='1' hidden='true'>
                <div class='spellclass-container'>
                    <input class='class-1 class-show' title='@{class_1_show}' name='attr_class_1_show' titel='@{class_1_show}' type=checkbox checked='checked' value='1'>
                    <span class='class-1 class-name' title='@{class_1_name}' name='attr_class_1_name' placeholder='1st Class' readonly='true'>1st Class</span>
                    <span class='class-1 class-num-level' title='@{class_1_level}' name='attr_class_1_level' placeholder='1' readonly='true'>5</span>
                    <span class='casting-ability' data-i18n='ability'>ABILITY</span>
                    <select class='class-1 class-ability input-field' title='@{class_1_casting_ability}' name='attr_class_1_casting_ability' >
                        <option value='@{strength_mod}' data-i18n='str' selected>STR</option>
                        <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                        <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                        <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                        <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                        <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                    </select>
                    <span CLASS='spell-progression' data-i18n='progress'>PROGRESS</span>
                    <select class='class-1 class-spell-progression input-field' title='@{class_1_spell_progression}' name='attr_class_1_spell_progression' >
                        <option value='half' data-i18n='half'>HALF</option>
                        <option value='partial' data-i18n='partial' selected>PARTIAL</option>
                        <option value='full_prep' data-i18n='full_prep'>FULL PREP</option>
                        <option value='full_spont' data-i18n='full_spont'>FULL SPONT</option>
                    </select>
                    <input type='radio' class='cantrips-only' title='@{class_1_max_spell}' name='attr_class_1_max_spell' value='0' checked='checked' hidden='true'>
                    <input type='radio' class='spell1' title='@{class_1_max_spell}' name='attr_class_1_max_spell' value='1' hidden='true'>
                    <input type='radio' class='spell2' title='@{class_1_max_spell}' name='attr_class_1_max_spell' value='2' hidden='true'>
                    <input type='radio' class='spell3' title='@{class_1_max_spell}' name='attr_class_1_max_spell' value='3' hidden='true'>
                    <input type='radio' class='spell4' title='@{class_1_max_spell}' name='attr_class_1_max_spell' value='4' hidden='true'>
                    <input type='radio' class='spell5' title='@{class_1_max_spell}' name='attr_class_1_max_spell' value='5' hidden='true'>
                    <input type='radio' class='spell6' title='@{class_1_max_spell}' name='attr_class_1_max_spell' value='6' hidden='true'>
                    <input type='radio' class='spell7' title='@{class_1_max_spell}' name='attr_class_1_max_spell' value='7' hidden='true'>
                    <input type='radio' class='spell8' title='@{class_1_max_spell}' name='attr_class_1_max_spell' value='8' hidden='true'>
                    <input type='radio' class='spell9' title='@{class_1_max_spell}' name='attr_class_1_max_spell' value='9' hidden='true'>
                    <span class='label daily' data-i18n='spells-per-day'>SPELLS PER DAY</span>
                    <span class='label num aspell0'>0</span>
                    <input class='label current aspell0 input-field' title='@{class_1_cantrips_per_day}' name='attr_class_1_cantrips_per_day' type='text'><span class='label slash aspell0'>/</span>
                    <input class='label max aspell0 input-field' title='@{class_1_cantrips_per_day_max}' name='attr_class_1_cantrips_per_day_max' type='text' type='text'>
                    <span class='label num class-spells-day aspell1'>1</span>
                    <input class='label class-spells-day current aspell1 input-field' title='@{class_1_level_1_spells_per_day}' name='attr_class_1_level_1_spells_per_day' type='text'><span class='label class-spells-day slash aspell1'>/</span>
                    <input class='label class-spells-day max aspell1 input-field' title='@{class_1_level_1_spells_per_day_max}' name='attr_class_1_level_1_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell2'>2</span>
                    <input class='label class-spells-day current aspell2 input-field' title='@{class_1_level_2_spells_per_day}' name='attr_class_1_level_2_spells_per_day' type='text'><span class='label class-spells-day slash aspell2'>/</span>
                    <input class='label class-spells-day max aspell2 input-field' title='@{class_1_level_2_spells_per_day_max}' name='attr_class_1_level_2_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell3'>3</span>
                    <input class='label class-spells-day current aspell3 input-field' title='@{class_1_level_3_spells_per_day}' name='attr_class_1_level_3_spells_per_day' type='text'><span class='label class-spells-day slash aspell3'>/</span>
                    <input class='label class-spells-day max aspell3 input-field' title='@{class_1_level_3_spells_per_day_max}' name='attr_class_1_level_3_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell4'>4</span>
                    <input class='label class-spells-day current aspell4 input-field' title='@{class_1_level_4_spells_per_day}' name='attr_class_1_level_4_spells_per_day' type='text'><span class='label class-spells-day slash aspell4'>/</span>
                    <input class='label class-spells-day max aspell4 input-field' title='@{class_1_level_4_spells_per_day_max}' name='attr_class_1_level_4_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell5'>5</span>
                    <input class='label class-spells-day current aspell5 input-field' title='@{class_1_level_5_spells_per_day}' name='attr_class_1_level_5_spells_per_day' type='text'><span class='label class-spells-day slash aspell5'>/</span>
                    <input class='label class-spells-day max aspell5 input-field' title='@{class_1_level_5_spells_per_day_max}' name='attr_class_1_level_5_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell6'>6</span>
                    <input class='label class-spells-day current aspell6 input-field' title='@{class_1_level_6_spells_per_day}' name='attr_class_1_level_6_spells_per_day' type='text'><span class='label class-spells-day slash aspell6'>/</span>
                    <input class='label class-spells-day max aspell6 input-field' title='@{class_1_level_6_spells_per_day_max}' name='attr_class_1_level_6_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell7'>7</span>
                    <input class='label class-spells-day current aspell7 input-field' title='@{class_1_level_7_spells_per_day}' name='attr_class_1_level_7_spells_per_day' type='text'><span class='label class-spells-day slash aspell7'>/</span>
                    <input class='label class-spells-day max aspell7 input-field' title='@{class_1_level_7_spells_per_day_max}' name='attr_class_1_level_7_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell8'>8</span>
                    <input class='label class-spells-day current aspell8 input-field' title='@{class_1_level_8_spells_per_day}' name='attr_class_1_level_8_spells_per_day' type='text'><span class='label class-spells-day slash aspell8'>/</span>
                    <input class='label class-spells-day max aspell8 input-field' title='@{class_1_level_8_spells_per_day_max}' name='attr_class_1_level_8_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell9'>9</span>
                    <input class='label class-spells-day current aspell9 input-field' title='@{class_1_level_9_spells_per_day}' name='attr_class_1_level_9_spells_per_day' type='text'><span class='label class-spells-day slash aspell9'>/</span>
                    <input class='label class-spells-day max aspell9 input-field' title='@{class_1_level_9_spells_per_day_max}' name='attr_class_1_level_9_spells_per_day_max' type='text'>
                </div>
                <!-- Caster 2 -->
                <input class='class-2 class-spells' title='@{class_2_spells}' name='attr_class_2_spells' type='checkbox' value='1' hidden='true'>
                <div class='spellclass-container'>
                    <input class='class-2 class-show' title='@{class_2_show}' name='attr_class_2_show' titel='@{class_2_show}' type=checkbox checked='checked' value='1'>
                    <span class='class-2 class-name' title='@{class_2_name}' name='attr_class_2_name' placeholder='1st Class' readonly='true'></span>
                    <span class='class-2 class-num-level' title='@{class_2_level}' name='attr_class_2_level' placeholder='1' readonly='true'></span>
                    <span class='casting-ability' data-i18n='ability'>ABILITY</span>
                    <select class='class-2 class-ability input-field' title='@{class_2_casting_ability}' name='attr_class_2_casting_ability' >
                        <option value='@{strength_mod}' data-i18n='str' selected>STR</option>
                        <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                        <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                        <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                        <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                        <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                    </select>
                    <span CLASS='spell-progression' data-i18n='progress'>PROGRESS</span>
                    <select class='class-2 class-spell-progression input-field' title='@{class_2_spell_progression}' name='attr_class_2_spell_progression' >
                        <option value='half' data-i18n='half'>HALF</option>
                        <option value='partial' data-i18n='partial' selected>PARTIAL</option>
                        <option value='full_prep' data-i18n='full_prep'>FULL PREP</option>
                        <option value='full_spont' data-i18n='full_spont'>FULL SPONT</option>
                    </select>
                    <input type='radio' class='cantrips-only' title='@{class_2_max_spell}' name='attr_class_2_max_spell' value='0' checked='checked' hidden='true'>
                    <input type='radio' class='spell1' title='@{class_2_max_spell}' name='attr_class_2_max_spell' value='1' hidden='true'>
                    <input type='radio' class='spell2' title='@{class_2_max_spell}' name='attr_class_2_max_spell' value='2' hidden='true'>
                    <input type='radio' class='spell3' title='@{class_2_max_spell}' name='attr_class_2_max_spell' value='3' hidden='true'>
                    <input type='radio' class='spell4' title='@{class_2_max_spell}' name='attr_class_2_max_spell' value='4' hidden='true'>
                    <input type='radio' class='spell5' title='@{class_2_max_spell}' name='attr_class_2_max_spell' value='5' hidden='true'>
                    <input type='radio' class='spell6' title='@{class_2_max_spell}' name='attr_class_2_max_spell' value='6' hidden='true'>
                    <input type='radio' class='spell7' title='@{class_2_max_spell}' name='attr_class_2_max_spell' value='7' hidden='true'>
                    <input type='radio' class='spell8' title='@{class_2_max_spell}' name='attr_class_2_max_spell' value='8' hidden='true'>
                    <input type='radio' class='spell9' title='@{class_2_max_spell}' name='attr_class_2_max_spell' value='9' hidden='true'>
                    <span class='label daily' data-i18n='spells-per-day'>SPELLS PER DAY</span>
                    <span class='label num aspell0'>0</span>
                    <input class='label current aspell0 input-field' title='@{class_2_cantrips_per_day}' name='attr_class_2_cantrips_per_day' type='text'><span class='label slash aspell0'>/</span>
                    <input class='label max aspell0 input-field' title='@{class_2_cantrips_per_day_max}' name='attr_class_2_cantrips_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell1'>1</span>
                    <input class='label class-spells-day current aspell1 input-field' title='@{class_2_level_1_spells_per_day}' name='attr_class_2_level_1_spells_per_day' type='text'><span class='label class-spells-day slash aspell1'>/</span>
                    <input class='label class-spells-day max aspell1 input-field' title='@{class_2_level_1_spells_per_day_max}' name='attr_class_2_level_1_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell2'>2</span>
                    <input class='label class-spells-day current aspell2 input-field' title='@{class_2_level_2_spells_per_day}' name='attr_class_2_level_2_spells_per_day' type='text'><span class='label class-spells-day slash aspell2'>/</span>
                    <input class='label class-spells-day max aspell2 input-field' title='@{class_2_level_2_spells_per_day_max}' name='attr_class_2_level_2_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell3'>3</span>
                    <input class='label class-spells-day current aspell3 input-field' title='@{class_2_level_3_spells_per_day}' name='attr_class_2_level_3_spells_per_day' type='text'><span class='label class-spells-day slash aspell3'>/</span>
                    <input class='label class-spells-day max aspell3 input-field' title='@{class_2_level_3_spells_per_day_max}' name='attr_class_2_level_3_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell4'>4</span>
                    <input class='label class-spells-day current aspell4 input-field' title='@{class_2_level_4_spells_per_day}' name='attr_class_2_level_4_spells_per_day' type='text'><span class='label class-spells-day slash aspell4'>/</span>
                    <input class='label class-spells-day max aspell4 input-field' title='@{class_2_level_4_spells_per_day_max}' name='attr_class_2_level_4_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell5'>5</span>
                    <input class='label class-spells-day current aspell5 input-field' title='@{class_2_level_5_spells_per_day}' name='attr_class_2_level_5_spells_per_day' type='text'><span class='label class-spells-day slash aspell5'>/</span>
                    <input class='label class-spells-day max aspell5 input-field' title='@{class_2_level_5_spells_per_day_max}' name='attr_class_2_level_5_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell6'>6</span>
                    <input class='label class-spells-day current aspell6 input-field' title='@{class_2_level_6_spells_per_day}' name='attr_class_2_level_6_spells_per_day' type='text'><span class='label class-spells-day slash aspell6'>/</span>
                    <input class='label class-spells-day max aspell6 input-field' title='@{class_2_level_6_spells_per_day_max}' name='attr_class_2_level_6_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell7'>7</span>
                    <input class='label class-spells-day current aspell7 input-field' title='@{class_2_level_7_spells_per_day}' name='attr_class_2_level_7_spells_per_day' type='text'><span class='label class-spells-day slash aspell7'>/</span>
                    <input class='label class-spells-day max aspell7 input-field' title='@{class_2_level_7_spells_per_day_max}' name='attr_class_2_level_7_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell8'>8</span>
                    <input class='label class-spells-day current aspell8 input-field' title='@{class_2_level_8_spells_per_day}' name='attr_class_2_level_8_spells_per_day' type='text'><span class='label class-spells-day slash aspell8'>/</span>
                    <input class='label class-spells-day max aspell8 input-field' title='@{class_2_level_8_spells_per_day_max}' name='attr_class_2_level_8_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell9'>9</span>
                    <input class='label class-spells-day current aspell9 input-field' title='@{class_2_level_9_spells_per_day}' name='attr_class_2_level_9_spells_per_day' type='text'><span class='label class-spells-day slash aspell9'>/</span>
                    <input class='label class-spells-day max aspell9 input-field' title='@{class_2_level_9_spells_per_day_max}' name='attr_class_2_level_9_spells_per_day_max' type='text'>
                </div>
                <!-- Caster 3 -->
                <input class='class-3 class-spells' title='@{class_3_spells}' name='attr_class_3_spells' type='checkbox' value='1' hidden='true'>
                <div class='spellclass-container'>
                    <input class='class-3 class-show' title='@{class_3_show}' name='attr_class_3_show' titel='@{class_3_show}' type=checkbox checked='checked' value='1'>
                    <span class='class-3 class-name' title='@{class_3_name}' name='attr_class_3_name' placeholder='1st Class' readonly='true'></span>
                    <span class='class-3 class-num-level' title='@{class_3_level}' name='attr_class_3_level' placeholder='1' readonly='true'></span>
                    <span class='casting-ability' data-i18n='ability'>ABILITY</span>
                    <select class='class-3 class-ability input-field' title='@{class_3_casting_ability}' name='attr_class_3_casting_ability' >
                        <option value='@{strength_mod}' data-i18n='str' selected>STR</option>
                        <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                        <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                        <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                        <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                        <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                    </select>
                    <span CLASS='spell-progression' data-i18n='progress'>PROGRESS</span>
                    <select class='class-3 class-spell-progression input-field' title='@{class_3_spell_progression}' name='attr_class_3_spell_progression' >
                        <option value='half' data-i18n='half'>HALF</option>
                        <option value='partial' data-i18n='partial' selected>PARTIAL</option>
                        <option value='full_prep' data-i18n='full_prep'>FULL PREP</option>
                        <option value='full_spont' data-i18n='full_spont'>FULL SPONT</option>
                    </select>
                    <input type='radio' class='cantrips-only' title='@{class_3_max_spell}' name='attr_class_3_max_spell' value='0' checked='checked' hidden='true'>
                    <input type='radio' class='spell1' title='@{class_3_max_spell}' name='attr_class_3_max_spell' value='1' hidden='true'>
                    <input type='radio' class='spell2' title='@{class_3_max_spell}' name='attr_class_3_max_spell' value='2' hidden='true'>
                    <input type='radio' class='spell3' title='@{class_3_max_spell}' name='attr_class_3_max_spell' value='3' hidden='true'>
                    <input type='radio' class='spell4' title='@{class_3_max_spell}' name='attr_class_3_max_spell' value='4' hidden='true'>
                    <input type='radio' class='spell5' title='@{class_3_max_spell}' name='attr_class_3_max_spell' value='5' hidden='true'>
                    <input type='radio' class='spell6' title='@{class_3_max_spell}' name='attr_class_3_max_spell' value='6' hidden='true'>
                    <input type='radio' class='spell7' title='@{class_3_max_spell}' name='attr_class_3_max_spell' value='7' hidden='true'>
                    <input type='radio' class='spell8' title='@{class_3_max_spell}' name='attr_class_3_max_spell' value='8' hidden='true'>
                    <input type='radio' class='spell9' title='@{class_3_max_spell}' name='attr_class_3_max_spell' value='9' hidden='true'>
                    <span class='label daily' data-i18n='spells-per-day'>SPELLS PER DAY</span>
                    <span class='label num aspell0'>0</span>
                    <input class='label current aspell0 input-field' title='@{class_3_cantrips_per_day}' name='attr_class_3_cantrips_per_day' type='text'><span class='label slash aspell0'>/</span>
                    <input class='label max aspell0 input-field' title='@{class_3_cantrips_per_day_max}' name='attr_class_3_cantrips_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell1'>1</span>
                    <input class='label class-spells-day current aspell1 input-field' title='@{class_3_level_1_spells_per_day}' name='attr_class_3_level_1_spells_per_day' type='text'><span class='label class-spells-day slash aspell1'>/</span>
                    <input class='label class-spells-day max aspell1 input-field' title='@{class_3_level_1_spells_per_day_max}' name='attr_class_3_level_1_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell2'>2</span>
                    <input class='label class-spells-day current aspell2 input-field' title='@{class_3_level_2_spells_per_day}' name='attr_class_3_level_2_spells_per_day' type='text'><span class='label class-spells-day slash aspell2'>/</span>
                    <input class='label class-spells-day max aspell2 input-field' title='@{class_3_level_2_spells_per_day_max}' name='attr_class_3_level_2_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell3'>3</span>
                    <input class='label class-spells-day current aspell3 input-field' title='@{class_3_level_3_spells_per_day}' name='attr_class_3_level_3_spells_per_day' type='text'><span class='label class-spells-day slash aspell3'>/</span>
                    <input class='label class-spells-day max aspell3 input-field' title='@{class_3_level_3_spells_per_day_max}' name='attr_class_3_level_3_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell4'>4</span>
                    <input class='label class-spells-day current aspell4 input-field' title='@{class_3_level_4_spells_per_day}' name='attr_class_3_level_4_spells_per_day' type='text'><span class='label class-spells-day slash aspell4'>/</span>
                    <input class='label class-spells-day max aspell4 input-field' title='@{class_3_level_4_spells_per_day_max}' name='attr_class_3_level_4_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell5'>5</span>
                    <input class='label class-spells-day current aspell5 input-field' title='@{class_3_level_5_spells_per_day}' name='attr_class_3_level_5_spells_per_day' type='text'><span class='label class-spells-day slash aspell5'>/</span>
                    <input class='label class-spells-day max aspell5 input-field' title='@{class_3_level_5_spells_per_day_max}' name='attr_class_3_level_5_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell6'>6</span>
                    <input class='label class-spells-day current aspell6 input-field' title='@{class_3_level_6_spells_per_day}' name='attr_class_3_level_6_spells_per_day' type='text'><span class='label class-spells-day slash aspell6'>/</span>
                    <input class='label class-spells-day max aspell6 input-field' title='@{class_3_level_6_spells_per_day_max}' name='attr_class_3_level_6_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell7'>7</span>
                    <input class='label class-spells-day current aspell7 input-field' title='@{class_3_level_7_spells_per_day}' name='attr_class_3_level_7_spells_per_day' type='text'><span class='label class-spells-day slash aspell7'>/</span>
                    <input class='label class-spells-day max aspell7 input-field' title='@{class_3_level_7_spells_per_day_max}' name='attr_class_3_level_7_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell8'>8</span>
                    <input class='label class-spells-day current aspell8 input-field' title='@{class_3_level_8_spells_per_day}' name='attr_class_3_level_8_spells_per_day' type='text'><span class='label class-spells-day slash aspell8'>/</span>
                    <input class='label class-spells-day max aspell8 input-field' title='@{class_3_level_8_spells_per_day_max}' name='attr_class_3_level_8_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell9'>9</span>
                    <input class='label class-spells-day current aspell9 input-field' title='@{class_3_level_9_spells_per_day}' name='attr_class_3_level_9_spells_per_day' type='text'><span class='label class-spells-day slash aspell9'>/</span>
                    <input class='label class-spells-day max aspell9 input-field' title='@{class_3_level_9_spells_per_day_max}' name='attr_class_3_level_9_spells_per_day_max' type='text'>
                </div>
                <!-- Caster 4 -->
                <input class='class-4 class-spells' title='@{class_4_spells}' name='attr_class_4_spells' type='checkbox' value='1' hidden='true'>
                <div class='spellclass-container'>
                    <input class='class-4 class-show' title='@{class_4_show}' name='attr_class_4_show' titel='@{class_4_show}' type=checkbox checked='checked' value='1'>
                    <span class='class-4 class-name' title='@{class_4_name}' name='attr_class_4_name' placeholder='1st Class' readonly='true'></span>
                    <span class='class-4 class-num-level' title='@{class_4_level}' name='attr_class_4_level' placeholder='1' readonly='true'></span>
                    <span class='casting-ability' data-i18n='ability'>ABILITY</span>
                    <select class='class-4 class-ability input-field' title='@{class_4_casting_ability}' name='attr_class_4_casting_ability' >
                        <option value='@{strength_mod}' data-i18n='str' selected>STR</option>
                        <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                        <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                        <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                        <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                        <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                    </select>
                    <span CLASS='spell-progression' data-i18n='progress'>PROGRESS</span>
                    <select class='class-4 class-spell-progression input-field' title='@{class_4_spell_progression}' name='attr_class_4_spell_progression' >
                        <option value='half' data-i18n='half'>HALF</option>
                        <option value='partial' data-i18n='partial' selected>PARTIAL</option>
                        <option value='full_prep' data-i18n='full_prep'>FULL PREP</option>
                        <option value='full_spont' data-i18n='full_spont'>FULL SPONT</option>
                    </select>
                    <input type='radio' class='cantrips-only' title='@{class_4_max_spell}' name='attr_class_4_max_spell' value='0' checked='checked' hidden='true'>
                    <input type='radio' class='spell1' title='@{class_4_max_spell}' name='attr_class_4_max_spell' value='1' hidden='true'>
                    <input type='radio' class='spell2' title='@{class_4_max_spell}' name='attr_class_4_max_spell' value='2' hidden='true'>
                    <input type='radio' class='spell3' title='@{class_4_max_spell}' name='attr_class_4_max_spell' value='3' hidden='true'>
                    <input type='radio' class='spell4' title='@{class_4_max_spell}' name='attr_class_4_max_spell' value='4' hidden='true'>
                    <input type='radio' class='spell5' title='@{class_4_max_spell}' name='attr_class_4_max_spell' value='5' hidden='true'>
                    <input type='radio' class='spell6' title='@{class_4_max_spell}' name='attr_class_4_max_spell' value='6' hidden='true'>
                    <input type='radio' class='spell7' title='@{class_4_max_spell}' name='attr_class_4_max_spell' value='7' hidden='true'>
                    <input type='radio' class='spell8' title='@{class_4_max_spell}' name='attr_class_4_max_spell' value='8' hidden='true'>
                    <input type='radio' class='spell9' title='@{class_4_max_spell}' name='attr_class_4_max_spell' value='9' hidden='true'>
                    <span class='label daily' data-i18n='spells-per-day'>SPELLS PER DAY</span>
                    <span class='label num aspell0'>0</span>
                    <input class='label current aspell0 input-field' title='@{class_4_cantrips_per_day}' name='attr_class_4_cantrips_per_day' type='text'><span class='label slash aspell0'>/</span>
                    <input class='label max aspell0 input-field' title='@{class_4_cantrips_per_day_max}' name='attr_class_4_cantrips_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell1'>1</span>
                    <input class='label class-spells-day current aspell1 input-field' title='@{class_4_level_1_spells_per_day}' name='attr_class_4_level_1_spells_per_day' type='text'><span class='label class-spells-day slash aspell1'>/</span>
                    <input class='label class-spells-day max aspell1 input-field' title='@{class_4_level_1_spells_per_day_max}' name='attr_class_4_level_1_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell2'>2</span>
                    <input class='label class-spells-day current aspell2 input-field' title='@{class_4_level_2_spells_per_day}' name='attr_class_4_level_2_spells_per_day' type='text'><span class='label class-spells-day slash aspell2'>/</span>
                    <input class='label class-spells-day max aspell2 input-field' title='@{class_4_level_2_spells_per_day_max}' name='attr_class_4_level_2_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell3'>3</span>
                    <input class='label class-spells-day current aspell3 input-field' title='@{class_4_level_3_spells_per_day}' name='attr_class_4_level_3_spells_per_day' type='text'><span class='label class-spells-day slash aspell3'>/</span>
                    <input class='label class-spells-day max aspell3 input-field' title='@{class_4_level_3_spells_per_day_max}' name='attr_class_4_level_3_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell4'>4</span>
                    <input class='label class-spells-day current aspell4 input-field' title='@{class_4_level_4_spells_per_day}' name='attr_class_4_level_4_spells_per_day' type='text'><span class='label class-spells-day slash aspell4'>/</span>
                    <input class='label class-spells-day max aspell4 input-field' title='@{class_4_level_4_spells_per_day_max}' name='attr_class_4_level_4_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell5'>5</span>
                    <input class='label class-spells-day current aspell5 input-field' title='@{class_4_level_5_spells_per_day}' name='attr_class_4_level_5_spells_per_day' type='text'><span class='label class-spells-day slash aspell5'>/</span>
                    <input class='label class-spells-day max aspell5 input-field' title='@{class_4_level_5_spells_per_day_max}' name='attr_class_4_level_5_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell6'>6</span>
                    <input class='label class-spells-day current aspell6 input-field' title='@{class_4_level_6_spells_per_day}' name='attr_class_4_level_6_spells_per_day' type='text'><span class='label class-spells-day slash aspell6'>/</span>
                    <input class='label class-spells-day max aspell6 input-field' title='@{class_4_level_6_spells_per_day_max}' name='attr_class_4_level_6_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell7'>7</span>
                    <input class='label class-spells-day current aspell7 input-field' title='@{class_4_level_7_spells_per_day}' name='attr_class_4_level_7_spells_per_day' type='text'><span class='label class-spells-day slash aspell7'>/</span>
                    <input class='label class-spells-day max aspell7 input-field' title='@{class_4_level_7_spells_per_day_max}' name='attr_class_4_level_7_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell8'>8</span>
                    <input class='label class-spells-day current aspell8 input-field' title='@{class_4_level_8_spells_per_day}' name='attr_class_4_level_8_spells_per_day' type='text'><span class='label class-spells-day slash aspell8'>/</span>
                    <input class='label class-spells-day max aspell8 input-field' title='@{class_4_level_8_spells_per_day_max}' name='attr_class_4_level_8_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell9'>9</span>
                    <input class='label class-spells-day current aspell9 input-field' title='@{class_4_level_9_spells_per_day}' name='attr_class_4_level_9_spells_per_day' type='text'><span class='label class-spells-day slash aspell9'>/</span>
                    <input class='label class-spells-day max aspell9 input-field' title='@{class_4_level_9_spells_per_day_max}' name='attr_class_4_level_9_spells_per_day_max' type='text'>
                </div>
                <!-- Caster 5 -->
                <input class='class-5 class-spells' title='@{class_5_spells}' name='attr_class_5_spells' type='checkbox' value='1' hidden='true'>
                <div class='spellclass-container'>
                    <input class='class-5 class-show' title='@{class_5_show}' name='attr_class_5_show' titel='@{class_5_show}' type=checkbox checked='checked' value='1'>
                    <span class='class-5 class-name' title='@{class_5_name}' name='attr_class_5_name' placeholder='1st Class' readonly='true'></span>
                    <span class='class-5 class-num-level' title='@{class_5_level}' name='attr_class_5_level' placeholder='1' readonly='true'></span>
                    <span class='casting-ability' data-i18n='ability'>ABILITY</span>
                    <select class='class-5 class-ability input-field' title='@{class_5_casting_ability}' name='attr_class_5_casting_ability' >
                        <option value='@{strength_mod}' data-i18n='str' selected>STR</option>
                        <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                        <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                        <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                        <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                        <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                    </select>
                    <span CLASS='spell-progression' data-i18n='progress'>PROGRESS</span>
                    <select class='class-5 class-spell-progression input-field' title='@{class_5_spell_progression}' name='attr_class_5_spell_progression' >
                        <option value='half' data-i18n='half'>HALF</option>
                        <option value='partial' data-i18n='partial' selected>PARTIAL</option>
                        <option value='full_prep' data-i18n='full_prep'>FULL PREP</option>
                        <option value='full_spont' data-i18n='full_spont'>FULL SPONT</option>
                    </select>
                    <input type='radio' class='cantrips-only' title='@{class_5_max_spell}' name='attr_class_5_max_spell' value='0' checked='checked' hidden='true'>
                    <input type='radio' class='spell1' title='@{class_5_max_spell}' name='attr_class_5_max_spell' value='1' hidden='true'>
                    <input type='radio' class='spell2' title='@{class_5_max_spell}' name='attr_class_5_max_spell' value='2' hidden='true'>
                    <input type='radio' class='spell3' title='@{class_5_max_spell}' name='attr_class_5_max_spell' value='3' hidden='true'>
                    <input type='radio' class='spell4' title='@{class_5_max_spell}' name='attr_class_5_max_spell' value='4' hidden='true'>
                    <input type='radio' class='spell5' title='@{class_5_max_spell}' name='attr_class_5_max_spell' value='5' hidden='true'>
                    <input type='radio' class='spell6' title='@{class_5_max_spell}' name='attr_class_5_max_spell' value='6' hidden='true'>
                    <input type='radio' class='spell7' title='@{class_5_max_spell}' name='attr_class_5_max_spell' value='7' hidden='true'>
                    <input type='radio' class='spell8' title='@{class_5_max_spell}' name='attr_class_5_max_spell' value='8' hidden='true'>
                    <input type='radio' class='spell9' title='@{class_5_max_spell}' name='attr_class_5_max_spell' value='9' hidden='true'>
                    <span class='label daily' data-i18n='spells-per-day'>SPELLS PER DAY</span>
                    <span class='label num aspell0'>0</span>
                    <input class='label current aspell0 input-field' title='@{class_5_cantrips_per_day}' name='attr_class_5_cantrips_per_day' type='text'><span class='label slash aspell0'>/</span>
                    <input class='label max aspell0 input-field' title='@{class_5_cantrips_per_day_max}' name='attr_class_5_cantrips_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell1'>1</span>
                    <input class='label class-spells-day current aspell1 input-field' title='@{class_5_level_1_spells_per_day}' name='attr_class_5_level_1_spells_per_day' type='text'><span class='label class-spells-day slash aspell1'>/</span>
                    <input class='label class-spells-day max aspell1 input-field' title='@{class_5_level_1_spells_per_day_max}' name='attr_class_5_level_1_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell2'>2</span>
                    <input class='label class-spells-day current aspell2 input-field' title='@{class_5_level_2_spells_per_day}' name='attr_class_5_level_2_spells_per_day' type='text'><span class='label class-spells-day slash aspell2'>/</span>
                    <input class='label class-spells-day max aspell2 input-field' title='@{class_5_level_2_spells_per_day_max}' name='attr_class_5_level_2_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell3'>3</span>
                    <input class='label class-spells-day current aspell3 input-field' title='@{class_5_level_3_spells_per_day}' name='attr_class_5_level_3_spells_per_day' type='text'><span class='label class-spells-day slash aspell3'>/</span>
                    <input class='label class-spells-day max aspell3 input-field' title='@{class_5_level_3_spells_per_day_max}' name='attr_class_5_level_3_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell4'>4</span>
                    <input class='label class-spells-day current aspell4 input-field' title='@{class_5_level_4_spells_per_day}' name='attr_class_5_level_4_spells_per_day' type='text'><span class='label class-spells-day slash aspell4'>/</span>
                    <input class='label class-spells-day max aspell4 input-field' title='@{class_5_level_4_spells_per_day_max}' name='attr_class_5_level_4_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell5'>5</span>
                    <input class='label class-spells-day current aspell5 input-field' title='@{class_5_level_5_spells_per_day}' name='attr_class_5_level_5_spells_per_day' type='text'><span class='label class-spells-day slash aspell5'>/</span>
                    <input class='label class-spells-day max aspell5 input-field' title='@{class_5_level_5_spells_per_day_max}' name='attr_class_5_level_5_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell6'>6</span>
                    <input class='label class-spells-day current aspell6 input-field' title='@{class_5_level_6_spells_per_day}' name='attr_class_5_level_6_spells_per_day' type='text'><span class='label class-spells-day slash aspell6'>/</span>
                    <input class='label class-spells-day max aspell6 input-field' title='@{class_5_level_6_spells_per_day_max}' name='attr_class_5_level_6_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell7'>7</span>
                    <input class='label class-spells-day current aspell7 input-field' title='@{class_5_level_7_spells_per_day}' name='attr_class_5_level_7_spells_per_day' type='text'><span class='label class-spells-day slash aspell7'>/</span>
                    <input class='label class-spells-day max aspell7 input-field' title='@{class_5_level_7_spells_per_day_max}' name='attr_class_5_level_7_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell8'>8</span>
                    <input class='label class-spells-day current aspell8 input-field' title='@{class_5_level_8_spells_per_day}' name='attr_class_5_level_8_spells_per_day' type='text'><span class='label class-spells-day slash aspell8'>/</span>
                    <input class='label class-spells-day max aspell8 input-field' title='@{class_5_level_8_spells_per_day_max}' name='attr_class_5_level_8_spells_per_day_max' type='text'>
                    <span class='label num class-spells-day aspell9'>9</span>
                    <input class='label class-spells-day current aspell9 input-field' title='@{class_5_level_9_spells_per_day}' name='attr_class_5_level_9_spells_per_day' type='text'><span class='label class-spells-day slash aspell9'>/</span>
                    <input class='label class-spells-day max aspell9 input-field' title='@{class_5_level_9_spells_per_day_max}' name='attr_class_5_level_9_spells_per_day_max' type='text'>
                </div>
            </div>
        </div>
        <div class=tab-container><!--Contains the core and spellcasting pc sheets. Which one is displayed depends on the first two inputs-->
            <input class="tab-button core" hidden='true' type="radio" title='@{tab}' name="attr_tab" value="core" checked='checked'>
            <input class="tab-button spells" hidden='true' type="radio" title='@{tab}' name="attr_tab" value="spells">
            <div class='page core'>
                <div class='initiative-container'>
                    <div class='section'>
                        <h1><button class='label' type='roll' title='%{initiative}' name='roll_initiative' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Initiative}} {{r1=[[1d20+@{initiative_ability}[ABILITY]@{npc_init}@{initiative_misc}+[[(@{initiative_ability}[ABILITY]@{npc_init}@{initiative_misc})/100)]][TIE BREAKER]&{tracker}]]}}' data-i18n='initiative' >INITIATIVE</button></h1>
                    </div>
                    <div class='section-container'>
                        <input class='mod-buff' type='hidden' name='attr_initiative_change' value='0'>
                        <span class='mod tot modified-attr label' readonly='true' type='text' title='@{initiative}' name='attr_initiative' value='0'>0</span>
                        <span class='arith'>=</span>
                        <select class='label abi input-field' title='@{initiative_ability}' name='attr_initiative_ability'>
                            <option value='@{dexterity_mod}' data-i18n='dex' selected>DEX</option>
                            <option value='@{strength_mod}' data-i18n='str'>STR</option>
                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                        </select>
                        <input hidden='true' type='text' title='@{initiative_misc}' name='attr_initiative_misc' value=''>
                    </div>
                </div>
                <div class='xp-container'>
                    <span class='label' data-i18n='xp'>XP</span>
                    <input type='number' class='currxp input-field' title='@{xp}' name='attr_xp' value=''>
                    <span class='slash'>/</span>
                    <input type='number' class='maxxp input-field' title='@{xp_max}' name='attr_xp_max' value=''>
                </div>
                <!-- <div class='four-row'>contains the sections that span across the top of the core page (ability scores, health, ac, saves)-->
                <div class='section-container attributes'>
                    <div class='section'>
                        <h1 class='label' data-i18n='ability_scores'>ABILITY SCORES</h1>
                    </div>
                    <div class='attribute-container'>
                        <span class='button label'></span>
                        <span class='mod label' data-i18n='mod'>MOD</span>
                        <span class='attr-total-container label' data-i18n='tot'>TOT</span>
                        <span class='label pen' data-i18n='pen'>PEN</span>
                        <span class='label drain' data-i18n='drain'>DRN</span>
                        <button class='strength button' type='roll' title='%{strength}' name='roll_strength' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Strength}} {{r1=[[1d20+@{strength_mod}]]}}' data-i18n='strength'>STRENGTH</button>
                        <span class='strength mod' type='text' title='@{strength_mod}' name='attr_strength_mod' readonly='true' value='0'>0</span>
                        <div class='strength attr-base-mod-container'><!-- sometimes, to properly restrict the formatting of a buff, it needs to be in a separate div. This div also is used when the actual value may be different from what is entered by the user -->
                            <input class='base-attr attr' type='number' title='@{strength}' name='attr_strength_base' value='10' >
                            <input class='mod-buff' type='hidden' name='attr_strength_change' value='0'>
                            <span class='modified-attr attr input-field' readonly='true' type='number' title='@{strength}' name='attr_strength' value='10'>10</span>
                        </div>
                        <input class='strength pen input-field' type='number' title='@{strength_penalty}' name='attr_strength_penalty' value='' >
                        <input class='strength drain input-field' type='number' title='@{strength_drain}' name='attr_strength_drain' value='' >
                        <button class='dexterity button' type='roll' title='%{dexterity}' name='roll_dexterity' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Dexterity}} {{r1=[[1d20+@{dexterity_mod}]]}}' data-i18n='dexterity'>DEXTERITY</button>
                        <span class='dexterity mod' type='text' title='@{dexterity_mod}' name='attr_dexterity_mod' readonly='true' value='0'>0</span>
                        <div class='dexterity attr-base-mod-container'>
                            <input class='base-attr attr' type='number' title='@{dexterity}' name='attr_dexterity_base' value='10' >
                            <input class='mod-buff' type='hidden' name='attr_dexterity_change' value='0'>
                            <span class='modified-attr attr input-field' readonly='true' type='number' title='@{dexterity}' name='attr_dexterity' value='10'>10</span>
                        </div>
                        <input class='dexterity pen input-field' type='number' title='@{dexterity_penalty}' name='attr_dexterity_penalty' value='' >
                        <input class='dexterity drain input-field' type='number' title='@{dexterity_drain}' name='attr_dexterity_drain' value='' >
                        <button class='constitution button' type='roll' title='%{constitution}' name='roll_constitution' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Constitution}} {{r1=[[1d20+@{constitution_mod}]]}}' data-i18n='constitution'>CONSTITUTION</button>
                        <span class='constitution mod' type='text' title='@{constitution_mod}' name='attr_constitution_mod' readonly='true' value='0' value='0'>0</span>
                        <div class='constitution attr-base-mod-container'>
                            <input class='base-attr attr' type='number' title='@{constitution}' name='attr_constitution_base' value='10' >
                            <input class='mod-buff' type='hidden' name='attr_constitution_change' value='0'>
                            <span class='modified-attr attr input-field' readonly='true' type='number' title='@{constitution}' name='attr_constitution' value='10'>10</span>
                        </div>
                        <input class='constitution pen input-field' type='number' title='@{constitution_penalty}' name='attr_constitution_penalty' value='' >
                        <input class='constitution drain input-field' type='number' title='@{constitution_drain}' name='attr_constitution_drain' value='' >
                        <button class='intelligence button' type='roll' title='%{intelligence}' name='roll_intelligence' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Intelligence}} {{r1=[[1d20+@{intelligence_mod}]]}}' data-i18n='intelligence'>INTELLIGENCE</button>
                        <span class='intelligence mod' type='text' title='@{intelligence_mod}' name='attr_intelligence_mod' readonly='true' value='0'>0</span>
                        <div class='intelligence attr-base-mod-container'>
                            <input class='base-attr attr' type='number' title='@{intelligence}' name='attr_intelligence_base' value='10' >
                            <input class='mod-buff' type='hidden' name='attr_intelligence_change' value='0'>
                            <span class='modified-attr attr input-field' readonly='true' type='number' title='@{intelligence}' name='attr_intelligence' value='10'>10</span>
                        </div>
                        <input class='intelligence pen input-field' type='number' title='@{intelligence_penalty}' name='attr_intelligence_penalty' value='' >
                        <input class='intelligence drain input-field' type='number' title='@{intelligence_drain}' name='attr_intelligence_drain' value='' >
                        <button class='wisdom button' type='roll' title='%{wisdom}' name='roll_wisdom' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Wisdom}} {{r1=[[1d20+@{wisdom_mod}]]}}' data-i18n='wisdom'>WISDOM</button>
                        <span class='wisdom mod' type='text' title='@{wisdom_mod}' name='attr_wisdom_mod' readonly='true' value='0'>0</span>
                        <div class='wisdom attr-base-mod-container'>
                            <input class='base-attr attr' type='number' title='@{wisdom}' name='attr_wisdom_base' value='10' >
                            <input class='mod-buff' type='hidden' name='attr_wisdom_change' value='0'>
                            <span class='modified-attr attr input-field' readonly='true' type='number' title='@{wisdom}' name='attr_wisdom' value='10'>10</span>
                        </div>
                        <input class='wisdom pen input-field' type='number' title='@{wisdom_penalty}' name='attr_wisdom_penalty' value='' >
                        <input class='wisdom drain input-field' type='number' title='@{wisdom_drain}' name='attr_wisdom_drain' value='' >
                        <button class='charisma button' type='roll' title='%{charisma}' name='roll_charisma' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Charisma}} {{r1=[[1d20+@{charisma_mod}]]}}' data-i18n='charisma'>CHARISMA</button>
                        <span class='charisma mod' type='text' title='@{charisma_mod}' name='attr_charisma_mod' readonly='true' value='0'>0</span>
                        <div class='charisma attr-base-mod-container'>
                            <input class='base-attr attr' type='number' title='@{charisma}' name='attr_charisma_base' value='10' >
                            <input class='mod-buff' type='hidden' name='attr_charisma_change' value='0'>
                            <span class='modified-attr attr input-field' readonly='true' type='number' title='@{charisma}' name='attr_charisma' value='10'>10</span>
                        </div>
                        <input class='charisma pen input-field' type='number' title='@{charisma_penalty}' name='attr_charisma_penalty' value='' >
                        <input class='charisma drain input-field' type='number' title='@{charisma_drain}' name='attr_charisma_drain' value='' >
                    </div>
                </div>
                <div class='section-container health'>
                    <div class='section'>
                        <h1 class='label' data-i18n='health'>HEALTH</h1>
                    </div>
                    <!-- The next 4 inputs control the reactive styling of the health section based on health available -->
                    <input class='full-health' type='radio' title='@{health_status}' name='attr_health_status' readonly='true' hidden='true' value='0' checked='checked'>
                    <input class='no-sp' type='radio' title='@{health_status}' name='attr_health_status' value='1' readonly='true' hidden='true'>
                    <input class='no-hp' type='radio' title='@{health_status}' name='attr_health_status' value='2' readonly='true' hidden='true'>
                    <input class='no-rp' type='radio' title='@{health_status}' name='attr_health_status' value='3' readonly='true' hidden='true'>
                    <input type='hidden' name='attr_sp_max_misc'>
                    <input type='hidden' name='attr_hp_max_misc'>
                    <input type='hidden' name='attr_rp_max_misc'>
                    <input type='hidden' name='attr_temp_hp_max_misc'>
                    <div class='health-resolve-container section-container'>
                        <div class='health-container'>
                            <span class='health-label label stamina' data-i18n='sp'>STAMINA POINTS</span>
                            <span class='health-label label hp' data-i18n='char-hp'>HIT POINTS</span>
                            <span class='health-label label resolve' data-i18n='rp'>RESOLVE POINTS</span>
                            <span class='health-label label temp' data-i18n='temp-hp'>TEMPORARY HIT POINTS</span>
                            <span class='label max' data-i18n='total'>Total</span>
                            <span class='label current' data-i18n='current'>Current</span>
                            <input class='current temp' type='number' title='@{temp_hp}' name='attr_temp_hp' value='0'>
                            <div class='attr-total-container temp max'>
                                <input class='mod-buff' type='hidden' name='attr_temp_hp_change' value='0'>
                                <span class='max temp modified-attr' type='number' title='@{temp_hp_max}' name='attr_temp_hp_max' readonly='true' value='0' title=@{temp_hp|max}>0</span>
                            </div>
                            <input class='current stamina input-field' type='number' title='@{sp}' name='attr_sp' value='0'>
                            <div class='attr-total-container stamina max'>
                                <input class='mod-buff' type='hidden' name='attr_sp_change' value='0'>
                                <span class='max stamina modified-attr' type='number' title='@{sp_max}' name='attr_sp_max' readonly='true' value='0' >0</span>
                            </div>
                            <input class='current hp input-field' type='number' title='@{hp}' name='attr_hp' value='0'>
                            <div class='attr-total-container hp max'>
                                <input class='mod-buff' type='hidden' name='attr_hp_change' value='0'>
                                <span class='max hp modified-attr' type='number' title='@{hp_max}' name='attr_hp_max' readonly='true' value='0' title=@{hp|max}>0</span>
                            </div>
                            <input class='current resolve input-field' type='number' title='@{rp}' name='attr_rp' value='0'>
                            <div class='attr-total-container resolve max'>
                                <input class='mod-buff' type='hidden' name='attr_rp_change' value='0'>
                                <span class='max resolve modified-attr' type='number' title='@{rp_max}' name='attr_rp_max' readonly='true' value='0' title=@{rp|max}>0</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class='section-container ac'>
                    <div class='section'>
                        <h1 class='label' data-i18n='armorclass'>ARMOR CLASS</h1>
                    </div>
                    <div class='ac-container section-container'>
                        <input type='hidden' name='attr_eac_misc'>
                        <input type='hidden' name='attr_kac_misc'>
                        <input type='hidden' name='attr_eac_armor_misc'>
                        <input type='hidden' name='attr_kac_armor_misc'>
                        <input type='hidden' name='attr_cmd_misc'>
                        <span class='ac-type'></span>
                        <span class='label tot' data-i18n='tot'>TOT</span>
                        <span class='label arm' style='font-family:Pictos Three;'>b</span>
                        <span class='label abi' data-i18n='abi'>ABI</span>
                        <div class='label ac-type' data-i18n='eac'>EAC</div>
                        <div class='attr-total-container tot'>
                            <input class='mod-buff' type='hidden' name='attr_eac_change' value='0'>
                            <span class='tot mod modified-attr' readonly='true' title='@{eac}' name='attr_eac' value='10'>10</span>
                        </div>
                        <span class='equal'>=</span>
                        <span class='base-ten'>10</span>
                        <span class='ten-plus'>+</span>
                        <div class='attr-total-container arm'>
                            <input class='mod-buff' type='hidden' name='attr_eac_armor_change' value='0'>
                            <span class='arm mod modified-attr' readonly='true' title='@{eac_armor}' name='attr_eac_armor' value='0'>0</span>
                        </div>
                        <span class='arm-plus'>+</span>
                        <select class='label abi input-field' title='@{eac_ability}' name='attr_eac_ability' style='width; .5em;'>
                            <option value='@{strength_mod}' data-i18n='str'>STR</option>
                            <option value='@{dexterity_mod}' data-i18n='dex' selected>DEX</option>
                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                        </select>
                        <span class='label ac-type' data-i18n='kac'>KAC</span>
                        <div class='attr-total-container tot'>
                            <input class='mod-buff' type='hidden' name='attr_kac_change' value='0'>
                            <span class='tot mod modified-attr' readonly='true' title='@{kac}' name='attr_kac' value='10'>10</span>
                        </div>
                        <span class='equal'>=</span>
                        <span class='base-ten'>10</span>
                        <span class='ten-plus'>+</span>
                        <div class='attr-total-container arm'>
                            <input class='mod-buff' type='hidden' name='attr_kac_armor_change' value='0'>
                            <span class='arm mod modified-attr' readonly='true' title='@{kac_armor}' name='attr_kac_armor' value='0'>0</span>
                        </div>
                        <span class='arm-plus'>+</span>
                        <select class='label abi input-field' title='@{kac_ability}' name='attr_kac_ability' style='width; .5em;'>
                            <option value='@{strength_mod}' data-i18n='str'>STR</option>
                            <option value='@{dexterity_mod}' data-i18n='dex' selected>DEX</option>
                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                        </select>
                        <span class='label ac-type' data-i18n='cmd'>CMD</span>
                        <div class='attr-total-container tot'>
                            <input class='mod-buff' type='hidden' name='attr_cmd_change' value='0'>
                            <span class='tot mod modified-attr' readonly='true' title='@{cmd}' name='attr_cmd' value='18'>18</span>
                        </div>
                        <span class='arm'></span>
                        <span class='abi'></span>
                        <span class='label dr-span' data-i18n='dr_resist'>DR/RESIST</span>
                        <input class='dr input-field' type='text' title='@{dr}' name='attr_dr' placeholder='5/- Fire 5'>
                        <textarea class='ac-notes input-field' title='@{ac_notes}' name='attr_ac_notes' placeholder='Notes'></textarea>
                    </div>
                </div>
                <div class='section-container saves'>
                    <div class='section'>
                        <h1 class='label' data-i18n='savingthrows'>SAVING THROWS</h1>
                    </div>
                    <div class='saving-container section-container'>
                        <div class='gutter'></div>
                        <input hidden='true' type='text' title='@{fort_misc}' name='attr_fort_misc'>
                        <input hidden='true' type='text' title='@{ref_misc}' name='attr_ref_misc'>
                        <input hidden='true' type='text' title='@{will_misc}' name='attr_will_misc'>
                        <span class='label tot' data-i18n='tot'>TOT</span>
                        <span class='label base' data-i18n='base'>BASE</span>
                        <div class='label abi' data-i18n='abi'>ABI</div>
                        <button type='roll' title='%{fort}' name='roll_fort' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Fortitude}} {{r1=[[1d20+@{fort_base}[BASE]+@{fort_ability}[ABILITY]@{fort_misc}]] }} {{notes=@{save_notes}}}' data-i18n='fort' >FORT</button>
                        <div class='attr-total-container'>
                            <input class='mod-buff' type='hidden' name='attr_fort_change' value='0'>
                            <span class='mod tot modified-attr' readonly='true' type='text' title='@{fort}' name='attr_fort' value='0'>0</span>
                        </div>
                        <span class='equal'>=</span>
                        <span class='base mod' readonly='true' title='@{fort_base}' name='attr_fort_base' value='0'>0</span>
                        <span class='base-plus'>+</span>
                        <select class='label abi input-field' title='@{fort_ability}' name='attr_fort_ability' style='width; .5em;'>
                            <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                            <option value='@{strength_mod}' data-i18n='str'>STR</option>
                            <option value='@{constitution_mod}' data-i18n='con' selected>CON</option>
                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                        </select>
                        <button type='roll' title='%{ref}' name='roll_ref' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Reflex}} {{r1=[[1d20+@{ref_base}[BASE]+@{ref_ability}[ABILITY]@{ref_misc}]] }} {{notes=@{save_notes}}}' data-i18n='ref' >REF</button>
                        <div class='attr-total-container'>
                            <input class='mod-buff' type='hidden' name='attr_ref_change' value='0'>
                            <span class='mod tot modified-attr' readonly='true' type='text' title='@{ref}' name='attr_ref' value='0'>0</span>
                        </div>
                        <span class='equal'>=</span>
                        <span class='base mod' readonly='true' title='@{ref_base}' name='attr_ref_base' value='0'>0</span>
                        <span class='base-plus'>+</span>
                        <select class='label abi input-field' title='@{ref_ability}' name='attr_ref_ability' style='width; .5em;'>
                            <option value='@{dexterity_mod}' data-i18n='dex' selected>DEX</option>
                            <option value='@{strength_mod}' data-i18n='str'>STR</option>
                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                        </select>
                        <button type='roll' title='%{will}' name='roll_will' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Will}} {{r1=[[1d20+@{will_base}[BASE]+@{will_ability}[ABILITY]@{will_misc}]] }} {{notes=@{save_notes}}}' data-i18n='will' >WILL</button>
                        <div class='attr-total-container'>
                            <input class='mod-buff' type='hidden' name='attr_will_change' value='0'>
                            <span class='mod tot modified-attr' readonly='true' type='text' title='@{will}' name='attr_will' value='0'>0</span>
                        </div>
                        <span class='equal'>=</span>
                        <span class='base mod' readonly='true' title='@{will_base}' name='attr_will_base' value='0'>0</span>
                        <span class='base-plus'>+</span>
                        <select class='label abi input-field' title='@{will_ability}' name='attr_will_ability' style='width; .5em;'>
                            <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                            <option value='@{strength_mod}' data-i18n='str'>STR</option>
                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                            <option value='@{wisdom_mod}' data-i18n='wis' selected>WIS</option>
                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                        </select>
                        <textarea class='input-field' title='@{save_notes}' name='attr_save_notes' placeholder='Notes'></textarea>
                    </div>
                </div>
                <div class='skills section-container'>
                    <input type='hidden' name='attr_skill_points_max_misc'>
                    <h1 class='section label'><span data-i18n='skills'>SKILLS</span> <span>  </span> <span title='@{skill_points}' name='attr_skill_points' type='number' readonly='true'>0</span> <span>/</span>
                        <input class='mod-buff' type='hidden' name='attr_skill_points_change' value='0'>
                        <span class='skills modified-attr' title='@{skill_points_max}' name='attr_skill_points_max' type='number' readonly='true'>0</span>
                    </h1>
                    <div class='skills-container section-container'>
                        <div class='skill-container'>
                            <span class='label tot' data-i18n='tot'>TOT</span>
                            <span class='label ranks' data-i18n='rnk'>RNK</span>
                            <span class='label class-skill' data-i18n='class-skill'>CS</span>
                            <span class='label abi' data-i18n='abi'>ABI</span>
                        </div>
                        <div class='skill-container'>
                            <input class="show-options" type="checkbox" title='@{acrobatics_show_options}' name="attr_acrobatics_show_options"><span>y</span>
                            <div class='display'>
                                <input hidden='true' title='@{acrobatics_misc}' name='attr_acrobatics_misc' value=''>
                                <input class='acp' type='checkbox' title='@{acrobatics_acp}' name='attr_acrobatics_acp' hidden='true' value='1' checked='checked'>
                                <button class='acp' type='roll' title='%{acrobatics}' name='roll_acrobatics' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Acrobatics}}  {{r1=[[1d20+@{acrobatics_ranks}[Ranks]+[[({0,@{acrobatics_ranks}}>1)*@{acrobatics_class_skill}]][CS]+@{acrobatics_ability}[Ability]@{acrobatics_misc}]]}} {{notes=@{acrobatics_description}}}' data-i18n='acrobatics' >ACROBATICS</button>
                                <input class='mod-buff' type='hidden' name='attr_acrobatics_change' value='0'>
                                <span class='mod tot modified-attr' readonly='true' type='text' title='@{acrobatics}' name='attr_acrobatics' value='0'>0</span>
                                <div class='arith-equal'>=</div>
                                <input class='ranks input-field' type='number' title='@{acrobatics_ranks}' name='attr_acrobatics_ranks' value='' >
                                <div class='arith-plus'>+</div>
                                <div class='class-skill'><input type='checkbox' title='@{acrobatics_class_skill}' name='attr_acrobatics_class_skill' value='3'><span class='cs'>3</span></div>
                                <div class='arith-plus2'>+</div>
                                <select class='label abi input-field' title='@{acrobatics_ability}' name='attr_acrobatics_ability' style='width; .5em;'>
                                    <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                    <option value='@{dexterity_mod}' data-i18n='dex' selected>DEX</option>
                                    <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                    <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                    <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                    <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                </select>
                            </div>
                            <div class='row-options'>
                                <div class='row'>
                                    <span class='skill-span label' data-i18n='acp'>ACP</span>
                                    <input class='acp' type='checkbox' title='@{acrobatics_acp}' name='attr_acrobatics_acp' value='1' checked='checked'>
                                </div>
                                <textarea class='skill-description input-field' title='@{acrobatics_description}' name='attr_acrobatics_description' placeholder='Notes'></textarea>
                                <input title='@{acrobatics_buff_notes}' name='attr_acrobatics_buff_notes' hidden='true'>
                            </div>
                        </div>
                        <div class='skill-container'>
                            <input class="show-options" type="checkbox" title='@{athletics_show_options}' name="attr_athletics_show_options"><span>y</span>
                            <div class='display'>
                                <input hidden='true' title='@{athletics_misc}' name='attr_athletics_misc' value=''>
                                <input class='acp' type='checkbox' title='@{athletics_acp}' name='attr_athletics_acp' hidden='true' value='1' checked='checked'>
                                <button class='acp' type='roll' title='%{athletics}' name='roll_athletics' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Athletics}}  {{r1=[[1d20+@{athletics_ranks}[RANKS]+[[({0,@{athletics_ranks}}>1)*@{athletics_class_skill}]][CS]+@{athletics_ability}[ABILITY]@{athletics_misc}]]}} {{notes=@{athletics_description}}}' data-i18n='athletics' >ATHLETICS</button>
                                <input class='mod-buff' type='hidden' name='attr_athletics_change' value='0'>
                                <span class='mod tot modified-attr' readonly='true' type='text' title='@{athletics}' name='attr_athletics' value='0'>0</span>
                                <div class='arith'>=</div>
                                <input class='ranks input-field' type='number' title='@{athletics_ranks}' name='attr_athletics_ranks' value='' >
                                <div class='arith'>+</div>
                                <div class='class-skill'><input type='checkbox' title='@{athletics_class_skill}' name='attr_athletics_class_skill' value='3'><span class='cs'>3</span></div>
                                <div class='arith'>+</div>
                                <select class='label abi input-field' title='@{athletics_ability}' name='attr_athletics_ability' style='width; .5em;'>
                                    <option value='@{strength_mod}' data-i18n='str' selected>STR</option>
                                    <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                    <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                    <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                    <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                    <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                </select>
                            </div>
                            <div class='row-options'>
                                <div class='row'>
                                    <span class='skill-span label' data-i18n='acp'>ACP</span>
                                    <input class='acp' type='checkbox' title='@{athletics_acp}' name='attr_athletics_acp' value='1' checked='checked'>
                                </div>
                                <textarea class='skill-description input-field' title='@{athletics_description}' name='attr_athletics_description' placeholder='Notes'></textarea>
                                <input title='@{athletics_buff_notes}' name='attr_athletics_buff_notes' hidden='true'>
                            </div>
                        </div>
                        <div class='skill-container'>
                            <input class="show-options" type="checkbox" title='@{bluff_show_options}' name="attr_bluff_show_options"><span>y</span>
                            <div class='display'>
                                <input hidden='true' title='@{bluff_misc}' name='attr_bluff_misc' value=''>
                                <input class='acp' type='checkbox' title='@{bluff_acp}' name='attr_bluff_acp' hidden='true' value='1'>
                                <button class='acp' type='roll' title='%{bluff}' name='roll_bluff' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Bluff}}  {{r1=[[1d20+@{bluff_ranks}[RANKS]+[[({0,@{bluff_ranks}}>1)*@{bluff_class_skill}]][CS]+@{bluff_ability}[ABILITY]@{bluff_misc}]]}} {{notes=@{bluff_description}}}' data-i18n='bluff' >BLUFF </button>
                                <input class='mod-buff' type='hidden' name='attr_bluff_change' value='0'>
                                <span class='mod tot modified-attr' readonly='true' type='text' title='@{bluff}' name='attr_bluff' value='0'>0</span>
                                <div class='arith'>=</div>
                                <input class='ranks input-field' type='number' title='@{bluff_ranks}' name='attr_bluff_ranks' value='' >
                                <div class='arith'>+</div>
                                <div class='class-skill'><input type='checkbox' title='@{bluff_class_skill}' name='attr_bluff_class_skill' value='3'><span class='cs'>3</span></div>
                                <div class='arith'>+</div>
                                <select class='label abi input-field' title='@{bluff_ability}' name='attr_bluff_ability' style='width; .5em;'>
                                    <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                    <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                    <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                    <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                    <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                    <option value='@{charisma_mod}' data-i18n='cha' selected>CHA</option>
                                </select>
                            </div>
                            <div class='row-options'>
                                <div class='row'>
                                    <span class='skill-span label' data-i18n='acp'>ACP</span>
                                    <input class='acp' type='checkbox' title='@{bluff_acp}' name='attr_bluff_acp' value='1'>
                                </div>
                                <textarea class='skill-description input-field' title='@{bluff_description}' name='attr_bluff_description' placeholder='Notes'></textarea>
                                <input title='@{bluff_buff_notes}' name='attr_bluff_buff_notes' hidden='true'>
                            </div>
                        </div>
                        <div class='skill-container'>
                            <input class="show-options" type="checkbox" title='@{computers_show_options}' name="attr_computers_show_options"><span>y</span>
                            <div class='display'>
                                <input hidden='true' title='@{computers_misc}' name='attr_computers_misc' value=''>
                                <input class='acp' type='checkbox' title='@{computers_acp}' name='attr_computers_acp' hidden='true' value='1'>
                                <button class='acp' type='roll' title='%{computers}' name='roll_computers' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Computers}}  {{r1=[[1d20+@{computers_ranks}[RANKS]+[[({0,@{computers_ranks}}>1)*@{computers_class_skill}]][CS]+@{computers_ability}[ABILITY]@{computers_misc}]]}} {{notes=@{computers_description}}}' data-i18n='computers' >COMPUTERS</button>
                                <input class='mod-buff' type='hidden' name='attr_computers_change' value='0'>
                                <span class='mod tot modified-attr' readonly='true' type='text' title='@{computers}' name='attr_computers' value='0'>0</span>
                                <div class='arith'>=</div>
                                <input class='ranks input-field' type='number' title='@{computers_ranks}' name='attr_computers_ranks' value='' >
                                <div class='arith'>+</div>
                                <div class='class-skill'><input type='checkbox' title='@{computers_class_skill}' name='attr_computers_class_skill' value='3'><span class='cs'>3</span></div>
                                <div class='arith'>+</div>
                                <select class='label abi input-field' title='@{computers_ability}' name='attr_computers_ability' style='width; .5em;'>
                                    <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                    <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                    <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                    <option value='@{intelligence_mod}' data-i18n='int' selected>INT</option>
                                    <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                    <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                </select>
                            </div>
                            <div class='row-options'>
                                <div class='row'>
                                    <span class='skill-span label' data-i18n='acp'>ACP</span>
                                    <input class='acp' type='checkbox' title='@{computers_acp}' name='attr_computers_acp' value='1'>
                                </div>
                                <textarea class='skill-description input-field' title='@{computers_description}' name='attr_computers_description' placeholder='Notes'></textarea>
                                <input title='@{computers_buff_notes}' name='attr_computers_buff_notes' hidden='true'>
                            </div>
                        </div>
                        <div class='skill-container'>
                            <input class="show-options" type="checkbox" title='@{culture_show_options}' name="attr_culture_show_options"><span>y</span>
                            <div class='display'>
                                <input hidden='true' title='@{culture_misc}' name='attr_culture_misc' value=''>
                                <input class='acp' type='checkbox' title='@{culture_acp}' name='attr_culture_acp' hidden='true' value='1'>
                                <button class='acp' type='roll' title='%{culture}' name='roll_culture' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Culture}}  {{r1=[[1d20+@{culture_ranks}[RANKS]+[[({0,@{culture_ranks}}>1)*@{culture_class_skill}]][CS]+@{culture_ability}[ABILITY]@{culture_misc}]]}} {{notes=@{culture_description}}}' data-i18n='culture' >CULTURE</button>
                                <input class='mod-buff' type='hidden' name='attr_culture_change' value='0'>
                                <span class='mod tot modified-attr' readonly='true' type='text' title='@{culture}' name='attr_culture' value='0'>0</span>
                                <div class='arith'>=</div>
                                <input class='ranks input-field' type='number' title='@{culture_ranks}' name='attr_culture_ranks' value='' >
                                <div class='arith'>+</div>
                                <div class='class-skill'><input type='checkbox' title='@{culture_class_skill}' name='attr_culture_class_skill' value='3'><span class='cs'>3</span></div>
                                <div class='arith'>+</div>
                                <select class='label abi input-field' title='@{culture_ability}' name='attr_culture_ability' style='width; .5em;'>
                                    <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                    <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                    <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                    <option value='@{intelligence_mod}' data-i18n='int' selected>INT</option>
                                    <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                    <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                </select>
                            </div>
                            <div class='row-options'>
                                <div class='row'>
                                    <span class='skill-span label' data-i18n='acp'>ACP</span>
                                    <input class='acp' type='checkbox' title='@{culture_acp}' name='attr_culture_acp' value='1'>
                                </div>
                                <textarea class='skill-description input-field' title='@{culture_description}' name='attr_culture_description' placeholder='Notes'></textarea>
                                <input title='@{culture_buff_notes}' name='attr_culture_buff_notes' hidden='true'>
                            </div>
                        </div>
                        <div class='skill-container'>
                            <input class="show-options" type="checkbox" title='@{diplomacy_show_options}' name="attr_diplomacy_show_options"><span>y</span>
                            <div class='display'>
                                <input hidden='true' title='@{diplomacy_misc}' name='attr_diplomacy_misc' value=''>
                                <input class='acp' type='checkbox' title='@{diplomacy_acp}' name='attr_diplomacy_acp' hidden='true' value='1'>
                                <button class='acp' type='roll' title='%{diplomacy}' name='roll_diplomacy' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Diplomacy}}  {{r1=[[1d20+@{diplomacy_ranks}[RANKS]+[[({0,@{diplomacy_ranks}}>1)*@{diplomacy_class_skill}]][CS]+@{diplomacy_ability}[ABILITY]@{diplomacy_misc}]]}} {{notes=@{diplomacy_description}}}' data-i18n='diplomacy' >DIPLOMACY</button>
                                <input class='mod-buff' type='hidden' name='attr_diplomacy_change' value='0'>
                                <span class='mod tot modified-attr' readonly='true' type='text' title='@{diplomacy}' name='attr_diplomacy' value='0'>0</span>
                                <div class='arith'>=</div>
                                <input class='ranks input-field' type='number' title='@{diplomacy_ranks}' name='attr_diplomacy_ranks' value='' >
                                <div class='arith'>+</div>
                                <div class='class-skill'><input type='checkbox' title='@{diplomacy_class_skill}' name='attr_diplomacy_class_skill' value='3'><span class='cs'>3</span></div>
                                <div class='arith'>+</div>
                                <select class='label abi input-field' title='@{diplomacy_ability}' name='attr_diplomacy_ability' style='width; .5em;'>
                                    <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                    <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                    <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                    <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                    <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                    <option value='@{charisma_mod}' data-i18n='cha' selected>CHA</option>
                                </select>
                            </div>
                            <div class='row-options'>
                                <div class='row'>
                                    <span class='skill-span label' data-i18n='acp'>ACP</span>
                                    <input class='acp' type='checkbox' title='@{diplomacy_acp}' name='attr_diplomacy_acp' value='1'>
                                </div>
                                <textarea class='skill-description input-field' title='@{diplomacy_description}' name='attr_diplomacy_description' placeholder='Notes'></textarea>
                                <input title='@{diplomacy_buff_notes}' name='attr_diplomacy_buff_notes' hidden='true'>
                            </div>
                        </div>
                        <div class='skill-container'>
                            <input class="show-options" type="checkbox" title='@{disguise_show_options}' name="attr_disguise_show_options"><span>y</span>
                            <div class='display'>
                                <input hidden='true' title='@{disguise_misc}' name='attr_disguise_misc' value=''>
                                <input class='acp' type='checkbox' title='@{disguise_acp}' name='attr_disguise_acp' hidden='true' value='1'>
                                <button class='acp' type='roll' title='%{disguise}' name='roll_disguise' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Disguise}}  {{r1=[[1d20+@{disguise_ranks}[RANKS]+[[({0,@{disguise_ranks}}>1)*@{disguise_class_skill}]][CS]+@{disguise_ability}[ABILITY]@{disguise_misc}]]}} {{notes=@{disguise_description}}}' data-i18n='disguise' >DISGUISE</button>
                                <input class='mod-buff' type='hidden' name='attr_disguise_change' value='0'>
                                <span class='mod tot modified-attr' readonly='true' type='text' title='@{disguise}' name='attr_disguise' value='0'>0</span>
                                <div class='arith'>=</div>
                                <input class='ranks input-field' type='number' title='@{disguise_ranks}' name='attr_disguise_ranks' value='' >
                                <div class='arith'>+</div>
                                <div class='class-skill'><input type='checkbox' title='@{disguise_class_skill}' name='attr_disguise_class_skill' value='3'><span class='cs'>3</span></div>
                                <div class='arith'>+</div>
                                <select class='label abi input-field' title='@{disguise_ability}' name='attr_disguise_ability' style='width; .5em;'>
                                    <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                    <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                    <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                    <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                    <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                    <option value='@{charisma_mod}' data-i18n='cha' selected>CHA</option>
                                </select>
                            </div>
                            <div class='row-options'>
                                <div class='row'>
                                    <span class='skill-span label' data-i18n='acp'>ACP</span>
                                    <input class='acp' type='checkbox' title='@{disguise_acp}' name='attr_disguise_acp' value='1'>
                                </div>
                                <textarea class='skill-description input-field' title='@{disguise_description}' name='attr_disguise_description' placeholder='Notes'></textarea>
                                <input title='@{disguise_buff_notes}' name='attr_disguise_buff_notes' hidden='true'>
                            </div>
                        </div>
                        <div class='skill-container'>
                            <input class="show-options" type="checkbox" title='@{engineering_show_options}' name="attr_engineering_show_options"><span>y</span>
                            <div class='display'>
                                <input hidden='true' title='@{engineering_misc}' name='attr_engineering_misc' value=''>
                                <input class='acp' type='checkbox' title='@{engineering_acp}' name='attr_engineering_acp' hidden='true' value='1'>
                                <button class='acp' type='roll' title='%{engineering}' name='roll_engineering' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Engineering}}  {{r1=[[1d20+@{engineering_ranks}[RANKS]+[[({0,@{engineering_ranks}}>1)*@{engineering_class_skill}]][CS]+@{engineering_ability}[ABILITY]@{engineering_misc}]]}} {{notes=@{engineering_description}}}' data-i18n='engineering' >ENGINEERING</button>
                                <input class='mod-buff' type='hidden' name='attr_engineering_change' value='0'>
                                <span class='mod tot modified-attr' readonly='true' type='text' title='@{engineering}' name='attr_engineering' value='0'>0</span>
                                <div class='arith'>=</div>
                                <input class='ranks input-field' type='number' title='@{engineering_ranks}' name='attr_engineering_ranks' value='' >
                                <div class='arith'>+</div>
                                <div class='class-skill'><input type='checkbox' title='@{engineering_class_skill}' name='attr_engineering_class_skill' value='3'><span class='cs'>3</span></div>
                                <div class='arith'>+</div>
                                <select class='label abi input-field' title='@{engineering_ability}' name='attr_engineering_ability' style='width; .5em;'>
                                    <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                    <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                    <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                    <option value='@{intelligence_mod}' data-i18n='int' selected>INT</option>
                                    <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                    <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                </select>
                            </div>
                            <div class='row-options'>
                                <div class='row'>
                                    <span class='skill-span label' data-i18n='acp'>ACP</span>
                                    <input class='acp' type='checkbox' title='@{engineering_acp}' name='attr_engineering_acp' value='1'>
                                </div>
                                <textarea class='skill-description input-field' title='@{engineering_description}' name='attr_engineering_description' placeholder='Notes'></textarea>
                                <input title='@{engineering_buff_notes}' name='attr_engineering_buff_notes' hidden='true'>
                            </div>
                        </div>
                        <div class='skill-container'>
                            <input class="show-options" type="checkbox" title='@{intimidate_show_options}' name="attr_intimidate_show_options"><span>y</span>
                            <div class='display'>
                                <input hidden='true' title='@{intimidate_misc}' name='attr_intimidate_misc' value=''>
                                <input class='acp' type='checkbox' title='@{intimidate_acp}' name='attr_intimidate_acp' hidden='true' value='1'>
                                <button class='acp' type='roll' title='%{intimidate}' name='roll_intimidate' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Intimidate}}  {{r1=[[1d20+@{intimidate_ranks}[RANKS]+[[({0,@{intimidate_ranks}}>1)*@{intimidate_class_skill}]][CS]+@{intimidate_ability}[ABILITY]@{intimidate_misc}]]}} {{notes=@{intimidate_description}}}' data-i18n='intimidate' >INTIMIDATE</button>
                                <input class='mod-buff' type='hidden' name='attr_intimidate_change' value='0'>
                                <span class='mod tot modified-attr' readonly='true' type='text' title='@{intimidate}' name='attr_intimidate' value='0'>0</span>
                                <div class='arith'>=</div>
                                <input class='ranks input-field' type='number' title='@{intimidate_ranks}' name='attr_intimidate_ranks' value='' >
                                <div class='arith'>+</div>
                                <div class='class-skill'><input type='checkbox' title='@{intimidate_class_skill}' name='attr_intimidate_class_skill' value='3'><span class='cs'>3</span></div>
                                <div class='arith'>+</div>
                                <select class='label abi input-field' title='@{intimidate_ability}' name='attr_intimidate_ability' style='width; .5em;'>
                                    <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                    <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                    <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                    <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                    <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                    <option value='@{charisma_mod}' data-i18n='cha' selected>CHA</option>
                                </select>
                            </div>
                            <div class='row-options'>
                                <div class='row'>
                                    <span class='skill-span label' data-i18n='acp'>ACP</span>
                                    <input class='acp' type='checkbox' title='@{intimidate_acp}' name='attr_intimidate_acp' value='1'>
                                </div>
                                <textarea class='skill-description input-field' title='@{intimidate_description}' name='attr_intimidate_description' placeholder='Notes'></textarea>
                                <input title='@{intimidate_buff_notes}' name='attr_intimidate_buff_notes' hidden='true'>
                            </div>
                        </div>
                        <div class='skill-container'>
                            <input class="show-options" type="checkbox" title='@{life_science_show_options}' name="attr_life_science_show_options"><span>y</span>
                            <div class='display'>
                                <input hidden='true' title='@{life_science_misc}' name='attr_life_science_misc' value=''>
                                <input class='acp' type='checkbox' title='@{life_science_acp}' name='attr_life_science_acp' hidden='true' value='1'>
                                <button class='acp' type='roll' title='%{life_science}' name='roll_life_science' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Life Science}}  {{r1=[[1d20+@{life_science_ranks}[RANKS]+[[({0,@{life_science_ranks}}>1)*@{life_science_class_skill}]][CS]+@{life_science_ability}[ABILITY]@{life_science_misc}]]}} {{notes=@{life_science_description}}}' data-i18n='life-science' >LIFE SCIENCE</button>
                                <input class='mod-buff' type='hidden' name='attr_life_science_change' value='0'>
                                <span class='mod tot modified-attr' readonly='true' type='text' title='@{life_science}' name='attr_life_science' value='0'>0</span>
                                <div class='arith'>=</div>
                                <input class='ranks input-field' type='number' title='@{life_science_ranks}' name='attr_life_science_ranks' value='' >
                                <div class='arith'>+</div>
                                <div class='class-skill'><input type='checkbox' title='@{life_science_class_skill}' name='attr_life_science_class_skill' value='3'><span class='cs'>3</span></div>
                                <div class='arith'>+</div>
                                <select class='label abi input-field' title='@{life_science_ability}' name='attr_life_science_ability' style='width; .5em;'>
                                    <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                    <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                    <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                    <option value='@{intelligence_mod}' data-i18n='int' selected>INT</option>
                                    <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                    <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                </select>
                            </div>
                            <div class='row-options'>
                                <div class='row'>
                                    <span class='skill-span label' data-i18n='acp'>ACP</span>
                                    <input class='acp' type='checkbox' title='@{life_science_acp}' name='attr_life_science_acp' value='1'>
                                </div>
                                <textarea class='skill-description input-field' title='@{life_science_description}' name='attr_life_science_description' placeholder='Notes'></textarea>
                                <input title='@{life_science_buff_notes}' name='attr_life_science_buff_notes' hidden='true'>
                            </div>
                        </div>
                        <div class='skill-container'>
                            <input class="show-options" type="checkbox" title='@{medicine_show_options}' name="attr_medicine_show_options"><span>y</span>
                            <div class='display'>
                                <input hidden='true' title='@{medicine_misc}' name='attr_medicine_misc' value=''>
                                <input class='acp' type='checkbox' title='@{medicine_acp}' name='attr_medicine_acp' hidden='true' value='1'>
                                <button class='acp' type='roll' title='%{medicine}' name='roll_medicine' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Medicine}}  {{r1=[[1d20+@{medicine_ranks}[RANKS]+[[({0,@{medicine_ranks}}>1)*@{medicine_class_skill}]][CS]+@{medicine_ability}[ABILITY]@{medicine_misc}]]}} {{notes=@{medicine_description}}}' data-i18n='medicine' >MEDICINE </button>
                                <input class='mod-buff' type='hidden' name='attr_medicine_change' value='0'>
                                <span class='mod tot modified-attr' readonly='true' type='text' title='@{medicine}' name='attr_medicine' value='0'>0</span>
                                <div class='arith'>=</div>
                                <input class='ranks input-field' type='number' title='@{medicine_ranks}' name='attr_medicine_ranks' value='' >
                                <div class='arith'>+</div>
                                <div class='class-skill'><input type='checkbox' title='@{medicine_class_skill}' name='attr_medicine_class_skill' value='3'><span class='cs'>3</span></div>
                                <div class='arith'>+</div>
                                <select class='label abi input-field' title='@{medicine_ability}' name='attr_medicine_ability' style='width; .5em;'>
                                    <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                    <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                    <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                    <option value='@{intelligence_mod}' data-i18n='int' selected>INT</option>
                                    <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                    <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                </select>
                            </div>
                            <div class='row-options'>
                                <div class='row'>
                                    <span class='skill-span label' data-i18n='acp'>ACP</span>
                                    <input class='acp' type='checkbox' title='@{medicine_acp}' name='attr_medicine_acp' value='1'>
                                </div>
                                <textarea class='skill-description input-field' title='@{medicine_description}' name='attr_medicine_description' placeholder='Notes'></textarea>
                                <input title='@{medicine_buff_notes}' name='attr_medicine_buff_notes' hidden='true'>
                            </div>
                        </div>
                        <div class='skill-container'>
                            <input class="show-options" type="checkbox" title='@{mysticism_show_options}' name="attr_mysticism_show_options"><span>y</span>
                            <div class='display'>
                                <input hidden='true' title='@{mysticism_misc}' name='attr_mysticism_misc' value=''>
                                <input class='acp' type='checkbox' title='@{mysticism_acp}' name='attr_mysticism_acp' hidden='true' value='1'>
                                <button class='acp' type='roll' title='%{mysticism}' name='roll_mysticism' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Mysticism}}  {{r1=[[1d20+@{mysticism_ranks}[RANKS]+[[({0,@{mysticism_ranks}}>1)*@{mysticism_class_skill}]][CS]+@{mysticism_ability}[ABILITY]@{mysticism_misc}]]}} {{notes=@{mysticism_description}}}' data-i18n='mysticism' >MYSTICISM </button>
                                <input class='mod-buff' type='hidden' name='attr_mysticism_change' value='0'>
                                <span class='mod tot modified-attr' readonly='true' type='text' title='@{mysticism}' name='attr_mysticism' value='0'>0</span>
                                <div class='arith'>=</div>
                                <input class='ranks input-field' type='number' title='@{mysticism_ranks}' name='attr_mysticism_ranks' value='' >
                                <div class='arith'>+</div>
                                <div class='class-skill'><input type='checkbox' title='@{mysticism_class_skill}' name='attr_mysticism_class_skill' value='3'><span class='cs'>3</span></div>
                                <div class='arith'>+</div>
                                <select class='label abi input-field' title='@{mysticism_ability}' name='attr_mysticism_ability' style='width; .5em;'>
                                    <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                    <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                    <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                    <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                    <option value='@{wisdom_mod}' data-i18n='wis' selected>WIS</option>
                                    <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                </select>
                            </div>
                            <div class='row-options'>
                                <div class='row'>
                                    <span class='skill-span label' data-i18n='acp'>ACP</span>
                                    <input class='acp' type='checkbox' title='@{mysticism_acp}' name='attr_mysticism_acp' value='1'>
                                </div>
                                <textarea class='skill-description input-field' title='@{mysticism_description}' name='attr_mysticism_description' placeholder='Notes'></textarea>
                                <input title='@{mysticism_buff_notes}' name='attr_mysticism_buff_notes' hidden='true'>
                            </div>
                        </div>
                        <div class='skill-container'>
                            <input class="show-options" type="checkbox" title='@{perception_show_options}' name="attr_perception_show_options"><span>y</span>
                            <div class='display'>
                                <input hidden='true' title='@{perception_misc}' name='attr_perception_misc' value=''>
                                <input class='acp' type='checkbox' title='@{perception_acp}' name='attr_perception_acp' hidden='true' value='1'>
                                <button class='acp' type='roll' title='%{perception}' name='roll_perception' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Perception}}  {{r1=[[1d20+@{perception_ranks}[RANKS]+[[({0,@{perception_ranks}}>1)*@{perception_class_skill}]][CS]+@{perception_ability}[ABILITY]@{perception_misc}]]}} {{notes=@{perception_description}}}' data-i18n='perception' >PERCEPTION </button>
                                <input class='mod-buff' type='hidden' name='attr_perception_change' value='0'>
                                <span class='mod tot modified-attr' readonly='true' type='text' title='@{perception}' name='attr_perception' value='0'>0</span>
                                <div class='arith'>=</div>
                                <input class='ranks input-field' type='number' title='@{perception_ranks}' name='attr_perception_ranks' value='' >
                                <div class='arith'>+</div>
                                <div class='class-skill'><input type='checkbox' title='@{perception_class_skill}' name='attr_perception_class_skill' value='3'><span class='cs'>3</span></div>
                                <div class='arith'>+</div>
                                <select class='label abi input-field' title='@{perception_ability}' name='attr_perception_ability' style='width; .5em;'>
                                    <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                    <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                    <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                    <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                    <option value='@{wisdom_mod}' data-i18n='wis' selected>WIS</option>
                                    <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                </select>
                            </div>
                            <div class='row-options'>
                                <div class='row'>
                                    <span class='skill-span label' data-i18n='acp'>ACP</span>
                                    <input class='acp' type='checkbox' title='@{perception_acp}' name='attr_perception_acp' value='1'>
                                </div>
                                <textarea class='skill-description input-field' title='@{perception_description}' name='attr_perception_description' placeholder='Notes'></textarea>
                                <input title='@{perception_buff_notes}' name='attr_perception_buff_notes' hidden='true'>
                            </div>
                        </div>
                        <div class='skill-container'>
                            <input class="show-options" type="checkbox" title='@{physical_science_show_options}' name="attr_physical_science_show_options"><span>y</span>
                            <div class='display'>
                                <input hidden='true' title='@{physical_science_misc}' name='attr_physical_science_misc' value=''>
                                <input class='acp' type='checkbox' title='@{physical_science_acp}' name='attr_physical_science_acp' hidden='true' value='1'>
                                <button class='acp' type='roll' title='%{physical_science}' name='roll_physical_science' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Physical Science}}  {{r1=[[1d20+@{physical_science_ranks}[RANKS]+[[({0,@{physical_science_ranks}}>1)*@{physical_science_class_skill}]][CS]+@{physical_science_ability}[ABILITY]@{physical_science_misc}]]}} {{notes=@{physical_science_description}}}' data-i18n='physical-science' >PHYSICAL SCIENCE</button>
                                <input class='mod-buff' type='hidden' name='attr_physical_science_change' value='0'>
                                <span class='mod tot modified-attr' readonly='true' type='text' title='@{physical_science}' name='attr_physical_science' value='0'>0</span>
                                <div class='arith'>=</div>
                                <input class='ranks input-field' type='number' title='@{physical_science_ranks}' name='attr_physical_science_ranks' value='' >
                                <div class='arith'>+</div>
                                <div class='class-skill'><input type='checkbox' title='@{physical_science_class_skill}' name='attr_physical_science_class_skill' value='3'><span class='cs'>3</span></div>
                                <div class='arith'>+</div>
                                <select class='label abi input-field' title='@{physical_science_ability}' name='attr_physical_science_ability' style='width; .5em;'>
                                    <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                    <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                    <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                    <option value='@{intelligence_mod}' data-i18n='int' selected>INT</option>
                                    <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                    <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                </select>
                            </div>
                            <div class='row-options'>
                                <div class='row'>
                                    <span class='skill-span label' data-i18n='acp'>ACP</span>
                                    <input class='acp' type='checkbox' title='@{physical_science_acp}' name='attr_physical_science_acp' value='1'>
                                </div>
                                <textarea class='skill-description input-field' title='@{physical_science_description}' name='attr_physical_science_description' placeholder='Notes'></textarea>
                                <input title='@{physical_science_buff_notes}' name='attr_physical_science_buff_notes' hidden='true'>
                            </div>
                        </div>
                        <div class='skill-container'>
                            <input class="show-options" type="checkbox" title='@{piloting_show_options}' name="attr_piloting_show_options"><span>y</span>
                            <div class='display'>
                                <input hidden='true' title='@{piloting_misc}' name='attr_piloting_misc' value=''>
                                <input class='acp' type='checkbox' title='@{piloting_acp}' name='attr_piloting_acp' hidden='true' value='1'>
                                <button class='acp' type='roll' title='%{piloting}' name='roll_piloting' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Piloting}}  {{r1=[[1d20+@{piloting_ranks}[RANKS]+[[({0,@{piloting_ranks}}>1)*@{piloting_class_skill}]][CS]+@{piloting_ability}[ABILITY]@{piloting_misc}]]}} {{notes=@{piloting_description}}}' data-i18n='piloting' >PILOTING</button>
                                <input class='mod-buff' type='hidden' name='attr_piloting_change' value='0'>
                                <span class='mod tot modified-attr' readonly='true' type='text' title='@{piloting}' name='attr_piloting' value='0'>0</span>
                                <div class='arith'>=</div>
                                <input class='ranks input-field' type='number' title='@{piloting_ranks}' name='attr_piloting_ranks' value='' >
                                <div class='arith'>+</div>
                                <div class='class-skill'><input type='checkbox' title='@{piloting_class_skill}' name='attr_piloting_class_skill' value='3'><span class='cs'>3</span></div>
                                <div class='arith'>+</div>
                                <select class='label abi input-field' title='@{piloting_ability}' name='attr_piloting_ability' style='width; .5em;'>
                                    <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                    <option value='@{dexterity_mod}' data-i18n='dex' selected>DEX</option>
                                    <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                    <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                    <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                    <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                </select>
                            </div>
                            <div class='row-options'>
                                <div class='row'>
                                    <span class='skill-span label' data-i18n='acp'>ACP</span>
                                    <input class='acp' type='checkbox' title='@{piloting_acp}' name='attr_piloting_acp' value='1'>
                                </div>
                                <textarea class='skill-description input-field' title='@{piloting_description}' name='attr_piloting_description' placeholder='Notes'></textarea>
                                <input title='@{piloting_buff_notes}' name='attr_piloting_buff_notes' hidden='true'>
                            </div>
                        </div>
                        <div class='skill-fieldset'>
                            <fieldset class='repeating_profession'>
                                <input type='checkbox' hidden='true' title='@{filter}' name='attr_filter' value='1' checked='checked'><!-- controls whether the repeating item is displayed. Had plans to use this to add the ability for people to filter their repeating sections -->
                                <div class='skill-container'>
                                    <input class="show-options" type="checkbox" title='@{show_options}' name="attr_show_options"><span>y</span>
                                    <div class='display'>
                                        <input hidden='true' title='@{misc}' name='attr_misc' value=''>
                                        <input class='acp' type='checkbox' title='@{acp}' name='attr_acp' hidden='true' value='1'>
                                        <button class='acp' type='roll' title='%{roll}' name='roll_roll' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=@{name}}}  {{r1=[[1d20+@{ranks}[RANKS]+[[({0,@{ranks}}>1)*@{class_skill}]][CS]+@{ability}[ABILITY]@{misc}]]}} {{notes=@{description}}}' ><span class='profession-name' type='text' title='@{name}' name='attr_name' value='Profession'>Profession</span></button>
                                        <input class='mod-buff' type='hidden' name='attr_change' value='0'>
                                        <input hidden='true' type='text' title='@{profession}' name='attr_profession' value='0'>
                                        <span class='mod tot modified-attr' readonly='true' type='text' title='@{profession}' name='attr_profession' value='0'>0</span>
                                        <div class='arith'>=</div>
                                        <input class='ranks input-field' type='number' title='@{ranks}' name='attr_ranks' value='0'>
                                        <div class='arith'>+</div>
                                        <div class='class-skill'><input type='checkbox' title='@{class_skill}' name='attr_class_skill' checked='checked' value='3'><span class='cs'>3</span></div>
                                        <div class='arith'>+</div>
                                        <select class='label abi input-field' title='@{ability}' name='attr_ability' style='width; .5em;'>
                                            <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                            <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                            <option value='@{intelligence_mod}' data-i18n='int' selected>INT</option>
                                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                        </select>
                                    </div>
                                    <div class='row-options'>
                                        <div class='row'>
                                            <input class='scalable-input input-field' type='text' title='@{name}' name='attr_name' value='Profession'>
                                            <span class='skill-span label' data-i18n='acp'>ACP</span>
                                            <input class='acp' type='checkbox' title='@{acp}' name='attr_acp' value='1'>
                                        </div>
                                        <textarea class='skill-description input-field' title='@{description}' name='attr_description' placeholder='Notes'></textarea>
                                        <input readonly=true class='id-label' title='@{id}' name='attr_id'></input>
                                        <input title='@{buff_notes}' name='attr_buff_notes' hidden='true'>
                                    </div>
                                </div>
                            </fieldset>
                        </div>
                        <div class='skill-container'>
                            <input class="show-options" type="checkbox" title='@{sense_motive_show_options}' name="attr_sense_motive_show_options"><span>y</span>
                            <div class='display'>
                                <input hidden='true' title='@{sense_motive_misc}' name='attr_sense_motive_misc' value=''>
                                <input class='acp' type='checkbox' title='@{sense_motive_acp}' name='attr_sense_motive_acp' hidden='true' value='1'>
                                <button class='acp' type='roll' title='%{sense_motive}' name='roll_sense_motive' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Sense Motive}}  {{r1=[[1d20+@{sense_motive_ranks}[RANKS]+[[({0,@{sense_motive_ranks}}>1)*@{sense_motive_class_skill}]][CS]+@{sense_motive_ability}[ABILITY]@{sense_motive_misc}]]}} {{notes=@{sense_motive_description}}}' data-i18n='sense-motive' >SENSE MOTIVE</button>
                                <input class='mod-buff' type='hidden' name='attr_sense_motive_change' value='0'>
                                <span class='mod tot modified-attr' readonly='true' type='text' title='@{sense_motive}' name='attr_sense_motive' value='0'>0</span>
                                <div class='arith'>=</div>
                                <input class='ranks input-field' type='number' title='@{sense_motive_ranks}' name='attr_sense_motive_ranks' value='' >
                                <div class='arith'>+</div>
                                <div class='class-skill'><input type='checkbox' title='@{sense_motive_class_skill}' name='attr_sense_motive_class_skill' value='3'><span class='cs'>3</span></div>
                                <div class='arith'>+</div>
                                <select class='label abi input-field' title='@{sense_motive_ability}' name='attr_sense_motive_ability' style='width; .5em;'>
                                    <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                    <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                    <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                    <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                    <option value='@{wisdom_mod}' data-i18n='wis' selected>WIS</option>
                                    <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                </select>
                            </div>
                            <div class='row-options'>
                                <div class='row'>
                                    <span class='skill-span label' data-i18n='acp'>ACP</span>
                                    <input class='acp' type='checkbox' title='@{sense_motive_acp}' name='attr_sense_motive_acp' value='1'>
                                </div>
                                <textarea class='skill-description input-field' title='@{sense_motive_description}' name='attr_sense_motive_description' placeholder='Notes'></textarea>
                                <input title='@{sense_motive_buff_notes}' name='attr_sense_motive_buff_notes' hidden='true'>
                            </div>
                        </div>
                        <div class='skill-container'>
                            <input class="show-options" type="checkbox" title='@{sleight_of_hand_show_options}' name="attr_sleight_of_hand_show_options"><span>y</span>
                            <div class='display'>
                                <input hidden='true' title='@{sleight_of_hand_misc}' name='attr_sleight_of_hand_misc' value=''>
                                <input class='acp' type='checkbox' title='@{sleight_of_hand_acp}' name='attr_sleight_of_hand_acp' hidden='true' value='1' checked='checked'>
                                <button class='acp' type='roll' title='%{sleight_of_hand}' name='roll_sleight_of_hand' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Sleight of Hand}}  {{r1=[[1d20+@{sleight_of_hand_ranks}[RANKS]+[[({0,@{sleight_of_hand_ranks}}>1)*@{sleight_of_hand_class_skill}]][CS]+@{sleight_of_hand_ability}[ABILITY]@{sleight_of_hand_misc}]]}} {{notes=@{sleight_of_hand_description}}}' data-i18n='sleight-of-hand' >SLEIGHT OF HAND</button>
                                <input class='mod-buff' type='hidden' name='attr_sleight_of_hand_change' value='0'>
                                <span class='mod tot modified-attr' readonly='true' type='text' title='@{sleight_of_hand}' name='attr_sleight_of_hand' value='0'>0</span>
                                <div class='arith'>=</div>
                                <input class='ranks input-field' type='number' title='@{sleight_of_hand_ranks}' name='attr_sleight_of_hand_ranks' value='' >
                                <div class='arith'>+</div>
                                <div class='class-skill'><input type='checkbox' title='@{sleight_of_hand_class_skill}' name='attr_sleight_of_hand_class_skill' value='3'><span class='cs'>3</span></div>
                                <div class='arith'>+</div>
                                <select class='label abi input-field' title='@{sleight_of_hand_ability}' name='attr_sleight_of_hand_ability' style='width; .5em;'>
                                    <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                    <option value='@{dexterity_mod}' data-i18n='dex' selected>DEX</option>
                                    <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                    <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                    <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                    <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                </select>
                            </div>
                            <div class='row-options'>
                                <div class='row'>
                                    <span class='skill-span label' data-i18n='acp'>ACP</span>
                                    <input class='acp' type='checkbox' title='@{sleight_of_hand_acp}' name='attr_sleight_of_hand_acp' value='1' checked='checked'>
                                </div>
                                <textarea class='skill-description input-field' title='@{sleight_of_hand_description}' name='attr_sleight_of_hand_description' placeholder='Notes'></textarea>
                                <input title='@{sleight_of_hand_buff_notes}' name='attr_sleight_of_hand_buff_notes' hidden='true'>
                            </div>
                        </div>
                        <div class='skill-container'>
                            <input class="show-options" type="checkbox" title='@{stealth_show_options}' name="attr_stealth_show_options"><span>y</span>
                            <div class='display'>
                                <input hidden='true' title='@{stealth_misc}' name='attr_stealth_misc' value=''>
                                <input class='acp' type='checkbox' title='@{stealth_acp}' name='attr_stealth_acp' hidden='true' value='1' checked='checked'>
                                <button class='acp' type='roll' title='%{stealth}' name='roll_stealth' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Stealth}}  {{r1=[[1d20+@{stealth_ranks}[RANKS]+[[({0,@{stealth_ranks}}>1)*@{stealth_class_skill}]][CS]+@{stealth_ability}[ABILITY]@{stealth_misc}]]}} {{notes=@{stealth_description}}}' data-i18n='stealth' >STEALTH</button>
                                <input class='mod-buff' type='hidden' name='attr_stealth_change' value='0'>
                                <span class='mod tot modified-attr' readonly='true' type='text' title='@{stealth}' name='attr_stealth' value='0'>0</span>
                                <div class='arith'>=</div>
                                <input class='ranks input-field' type='number' title='@{stealth_ranks}' name='attr_stealth_ranks' value='' >
                                <div class='arith'>+</div>
                                <div class='class-skill'><input type='checkbox' title='@{stealth_class_skill}' name='attr_stealth_class_skill' value='3'><span class='cs'>3</span></div>
                                <div class='arith'>+</div>
                                <select class='label abi input-field' title='@{stealth_ability}' name='attr_stealth_ability' style='width; .5em;'>
                                    <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                    <option value='@{dexterity_mod}' data-i18n='dex' selected>DEX</option>
                                    <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                    <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                    <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                    <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                </select>
                            </div>
                            <div class='row-options'>
                                <div class='row'>
                                    <span class='skill-span label' data-i18n='acp'>ACP</span>
                                    <input class='acp' type='checkbox' title='@{stealth_acp}' name='attr_stealth_acp' value='1' checked='checked'>
                                </div>
                                <textarea class='skill-description input-field' title='@{stealth_description}' name='attr_stealth_description' placeholder='Notes'></textarea>
                                <input title='@{stealth_buff_notes}' name='attr_stealth_buff_notes' hidden='true'>
                            </div>
                        </div>
                        <div class='skill-container'>
                            <input class="show-options" type="checkbox" title='@{survival_show_options}' name="attr_survival_show_options"><span>y</span>
                            <div class='display'>
                                <input hidden='true' title='@{survival_misc}' name='attr_survival_misc' value=''>
                                <input class='acp' type='checkbox' title='@{survival_acp}' name='attr_survival_acp' hidden='true' value='1'>
                                <button class='acp' type='roll' title='%{survival}' name='roll_survival' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Survival}}  {{r1=[[1d20+@{survival_ranks}[RANKS]+[[({0,@{survival_ranks}}>1)*@{survival_class_skill}]][CS]+@{survival_ability}[ABILITY]@{survival_misc}]]}} {{notes=@{survival_description}}}' data-i18n='survival' >SURVIVAL</button>
                                <input class='mod-buff' type='hidden' name='attr_survival_change' value='0'>
                                <span class='mod tot modified-attr' readonly='true' type='text' title='@{survival}' name='attr_survival' value='0'>0</span>
                                <div class='arith'>=</div>
                                <input class='ranks input-field' type='number' title='@{survival_ranks}' name='attr_survival_ranks' value='' >
                                <div class='arith'>+</div>
                                <div class='class-skill'><input type='checkbox' title='@{survival_class_skill}' name='attr_survival_class_skill' value='3'><span class='cs'>3</span></div>
                                <div class='arith'>+</div>
                                <select class='label abi input-field' title='@{survival_ability}' name='attr_survival_ability' style='width; .5em;'>
                                    <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                    <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                    <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                    <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                    <option value='@{wisdom_mod}' data-i18n='wis' selected>WIS</option>
                                    <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                </select>
                            </div>
                            <div class='row-options'>
                                <div class='row'>
                                    <span class='skill-span label' data-i18n='acp'>ACP</span>
                                    <input class='acp' type='checkbox' title='@{survival_acp}' name='attr_survival_acp' value='1'>
                                </div>
                                <textarea class='skill-description input-field' title='@{survival_description}' name='attr_survival_description' placeholder='Notes'></textarea>
                                <input title='@{suvival_buff_notes}' name='attr_suvival_buff_notes' hidden='true'>
                            </div>
                        </div>
                        <div class='skill-container gutter'></div>
                    </div>
                </div>
                <div class='combat'>
                    <input type='radio' class='section section-check proficiencies-tab' name='attr_combat_view' value='proficiency' checked='checked'></input>
                    <div class='section head proficiencies-tab'>
                        <h1 class='label' data-i18n='combat-proficiencies'>WEAPON & ARMOR PROFICIENCIES</h1>
                    </div>
                    <input type='radio' class='section section-check items' name='attr_combat_view' value='items'></input>
                    <div class='section head items'>
                        <h1 class='label' data-i18n='equipment'>EQUIPMENT</h1>
                    </div>
                    <input type='radio' class='section section-check attacks' name='attr_combat_view' value='attacks'></input>
                    <div class='section head attacks'>
                        <h1 class='label' data-i18n='attacks'>ATTACKS</h1>
                    </div>
                    <input type='radio' class='section section-check abilities' name='attr_combat_view' value='abilities'></input>
                    <div class='section head abilities'>
                        <h1 class='label' data-i18n='abilities'>ABILITIES</h1>
                    </div>
                    <input class='is-caster' title='@{caster_select}' name='attr_caster_select' type='checkbox' value='1' hidden='true'>
                    <input type='radio' class='section section-check spells' name='attr_combat_view' value='spells'></input>
                    <div class='section head spells'>
                        <h1 class='label' data-i18n='spells'>SPELLS</h1>
                    </div>
                    <div class='section-container proficiency-section'>
                        <div class='section-container'>
                            <span class='light-armor label' data-i18n='light-armor'>LIGHT ARMOR</span>
                            <select title='@{light_armor_proficiency}' name='attr_light_armor_proficiency' class='light-armor select input-field'>
                                <option value='no' data-i18n='Not-Proficient'>NOT PROFICIENT</option>
                                <option value='yes' data-i18n='proficient' selected>PROFICIENT</option>
                            </select>
                            <span class='heavy-armor label' data-i18n='heavy-armor'>HEAVY ARMOR</span>
                            <select title='@{heavy_armor_proficiency}' name='attr_heavy_armor_proficiency' class='heavy-armor select input-field'>
                                <option value='no' data-i18n='Not-Proficient' selected>NOT PROFICIENT</option>
                                <option value='yes' data-i18n='proficient'>PROFICIENT</option>
                            </select>
                            <span class='power-armor label' data-i18n='power-armor'>POWER ARMOR</span>
                            <select title='@{power_armor_proficiency}' name='attr_power_armor_proficiency' class='power-armor select input-field'>
                                <option value='no' data-i18n='Not-Proficient' selected>NOT PROFICIENT</option>
                                <option value='yes' data-i18n='proficient'>PROFICIENT</option>
                            </select>
                            <span class='basic-melee label' data-i18n='basic-melee'>BASIC MELEE</span>
                            <select title='@{basic_melee_proficiency}' name='attr_basic_melee_proficiency' class='basic-melee select input-field'>
                                <option value='no' data-i18n='Not-Proficient'>NOT PROFICIENT</option>
                                <option value='yes' data-i18n='proficient' selected>PROFICIENT</option>
                                <option value='specialized' data-i18n='specialized'>SPECIALIZED</option>
                            </select>
                            <span class='advanced-melee label' data-i18n='advanced-melee'>ADVANCED MELEE</span>
                            <select title='@{advanced_melee_proficiency}' name='attr_advanced_melee_proficiency' class='advanced-melee select input-field'>
                                <option value='no' data-i18n='Not-Proficient' selected>NOT PROFICIENT</option>
                                <option value='yes' data-i18n='proficient'>PROFICIENT</option>
                                <option value='specialized' data-i18n='specialized'>SPECIALIZED</option>
                            </select>
                            <div class='prof-gutter'></div>
                            <span class='small-arms label' data-i18n='small-arms'>SMALL ARMS</span>
                            <select title='@{small_arm_proficiency}' name='attr_small_arm_proficiency' class='small-arms select input-field'>
                                <option value='no' data-i18n='Not-Proficient'>NOT PROFICIENT</option>
                                <option value='yes' data-i18n='proficient' selected>PROFICIENT</option>
                                <option value='specialized' data-i18n='specialized'>SPECIALIZED</option>
                            </select>
                            <span class='longarms label' data-i18n='longarms'>LONGARMS</span>
                            <select title='@{longarm_proficiency}' name='attr_longarm_proficiency' class='longarms select input-field'>
                                <option value='no' data-i18n='Not-Proficient' selected>NOT PROFICIENT</option>
                                <option value='yes' data-i18n='proficient'>PROFICIENT</option>
                                <option value='specialized' data-i18n='specialized'>SPECIALIZED</option>
                            </select>
                            <span class='heavy-weapons label' data-i18n='heavy-weapons'>HEAVY WEAPONS</span>
                            <select title='@{heavy_weapon_proficiency}' name='attr_heavy_weapon_proficiency' class='heavy-weapons select input-field'>
                                <option value='no' data-i18n='Not-Proficient' selected>NOT PROFICIENT</option>
                                <option value='yes' data-i18n='proficient'>PROFICIENT</option>
                                <option value='specialized' data-i18n='specialized'>SPECIALIZED</option>
                            </select>
                            <span class='grenades label' data-i18n='grenades'>GRENADES</span>
                            <select title='@{grenade_proficiency}' name='attr_grenade_proficiency' class='grenades select input-field'>
                                <option value='no' data-i18n='Not-Proficient' selected>NOT PROFICIENT</option>
                                <option value='yes' data-i18n='proficient'>PROFICIENT</option>
                                <option value='specialized' data-i18n='specialized'>SPECIALIZED</option>
                            </select>
                            <span class='snipers label' data-i18n='snipers'>SNIPERS</span>
                            <select title='@{sniper_proficiency}' name='attr_sniper_proficiency' class='snipers select input-field'>
                                <option value='no' data-i18n='Not-Proficient' selected>NOT PROFICIENT</option>
                                <option value='yes' data-i18n='proficient'>PROFICIENT</option>
                                <option value='specialized' data-i18n='specialized'>SPECIALIZED</option>
                            </select>
                        </div>
                    </div>
                    <div class='weapons section-container'>
                        <div class='button-description'>
                            <span data-i18n='name'>NAME</span>
                            <span data-i18n='attack'>ATTACK</span>
                            <span class='span-two' data-i18n='damage'>DAMAGE</span>
                            <span data-i18n='type'>TYPE</span>
                        </div>
                        <fieldset class='repeating_attack'>
                            <input class='filter' type='checkbox' hidden='true' title='@{filter}' name='attr_filter' value='1' checked='checked'>
                            <div class='filter-container attack'>
                                <input type='text' hidden='true' title='@{misc}' name='attr_misc' value=''>
                                <input type='text' hidden='true' title='@{damage_misc}' name='attr_damage_misc' value=''>
                                <input class="show-options" type="checkbox" title='@{show_options}' name="attr_show_options" value='1' checked="checked"><span>y</span>
                                <div class='row-options'>
                                    <div class='row span-two'>
                                        <span class='label' data-i18n='name-u'>NAME</span>
                                        <input class='atk-name scalable-input input-field' type='text' title='@{name}' name='attr_name' placeholder='Laser Pistol' value=''>
                                        <span class='label' data-i18n='lvl'>LVL</span>
                                        <input class='atk-level input-field' type='text' title='@{level}' name='attr_level' value='0'>
                                    </div>
                                    <div class='row span-two display-margin'>
                                        <select class='label proficiency input-field' title='@{proficiency}' name='attr_proficiency'>
                                            <option value='no' data-i18n='Not-Proficient'>NOT PROFICIENT</option>
                                            <option value='yes' data-i18n='proficient' selected>PROFICIENT</option>
                                            <option value='specialized' data-i18n='specialized'>SPECIALIZED</option>
                                        </select>
                                        <input hidden='true' type='text' title='@{proficiency_value}' name='attr_proficiency_value' value='0'>
                                        <input hidden='true'  type='text' title='@{damage_proficiency_value}' name='attr_damage_proficiency_value' value='0'>
                                        <span class='label' data-i18n='category'>CATEGORY</span>
                                        <select class='weapon-cat scalable-input input-field' type='text' title='@{category}' name='attr_category'>
                                            <option value = '' data-i18n='select' selected>SELECT</option>
                                            <option value = 'basic_melee' data-i18n='basic_melee' selected>BASIC MELEE</option>
                                            <option value = 'advanced_melee' data-i18n='advanced_melee'>ADVANCED MELEE</option>
                                            <option value = 'small_arm' data-i18n='small_arm'>SMALL ARM</option>
                                            <option value = 'longarm' data-i18n='longarm'>LONGARM</option>
                                            <option value = 'heavy' data-i18n='heavy'>HEAVY WEAPON</option><option value = 'grenade' data-i18n='grenade'>GRENADE</option>
                                            <option value = 'sniper' data-i18n='sniper'>SNIPER</option>
                                            <option value = 'special' data-i18n='special'>SPECIAL</option>
                                        </select>
                                    </div>
                                    <div class='row span-two'>
                                        <span class='label' data-i18n='atk-u'>ATTACK ROLL</span>
                                        <select class='label atk-ability abi input-field' title='@{ability}' name='attr_ability'>
                                            <option value='0' selected data-i18n='n/a'>N/A</option>
                                            <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                            <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                        </select>
                                        <input hidden='true' type='text' title='@{ability}' name='attr_ability' value='0'>
                                        <span class='arith'>+</span>
                                        <input class='bab' title='@{base_attack_bonus}' name='attr_base_attack_bonus' readonly='true' value='0'>
                                        <input class='atk-misc misc scalable-input input-field' type='text' title='@{bonus}' name='attr_bonus' placeholder='+@{attr}/2 + ?{Query}' value=''>
                                    </div>
                                    <div class='row span-two'>
                                        <span class='label' data-i18n='rng'>RANGE</span>
                                        <input class='atk-range scalable-input input-field' type='text' title='@{range}' name='attr_range' placeholder='30 ft' value=''>
                                        <select class='label atk-range-type input-field' title='@{engagement_range}' name='attr_engagement_range'>
                                            <option value='melee' data-i18n='melee' selected>MELEE</option>
                                            <option value='ranged' data-i18n='ranged'>RANGED</option>
                                        </select>
                                    </div>
                                    <div class='row span-two'>
                                        <span class='label' data-i18n='dmg'>DAMAGE ROLL</span>
                                        <input class='dmg-dice scalable-input input-field' type='text' name=attr_damage_dice placeholder='1d8' value=''><span>+</span>
                                        <select class='label atk-ability abi input-field' title='@{damage_ability}' name='attr_damage_ability'>
                                            <option value='0' selected data-i18n='n/a'>N/A</option>
                                            <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                            <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                        </select>
                                    </div>
                                    <div class='row span-two'>
                                        <span class='label' data-i18n='damage-type'>DAMAGE TYPE</span>
                                        <input class='atk-type scalable-input input-field' type='text' title='@{type}' name='attr_type' placeholder='Fire' value=''>
                                        <span class='label' data-i18n='crit-effect'>CRITICAL EFFECT</span>
                                        <input class='atk-crit scalable-input input-field' type='text' title='@{crit}' name='attr_crit' placeholder='Burn [[1d6]]' value=''>
                                    </div>
                                    <div class='row span-two'>
                                        <input class='label scalable-input input-field' data-i18n-placeholder='ammo' title='@{ammo_type}' name='attr_ammo_type' value='' type='text' placeholder='ammo' >
                                        <input title='@{ammo}' name='attr_ammo' type='number' value=''>
                                        <span class='label'>/</span>
                                        <input class='input-field' title='@{ammo_max}' name='attr_ammo_max' type='number' value=''>
                                    </div>
                                    <div class='row span-two'>
                                        <span class='label' data-i18n='usage'>USAGE</span>
                                        <input class='atk-usage scalable-input input-field' type='text' title='@{usage}' name='attr_usage' placeholder='1 charge' value=''>
                                        <span class='label' data-i18n='special'>SPECIAL</span>
                                        <input class='atk-special scalable-input input-field' type='text' title='@{special}' name='attr_special' placeholder='heirloom' value=''>
                                    </div>
                                    <input class='field-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                    <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'><span class='label field' data-i18n='additional-attack'>ADDITIONAL ATTACKS</span></label>
                                    <input class='field-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                    <div class='field-container inherit-grid expandable'>
                                        <input class='field-tab macro-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                        <div class='field row'>
                                            <span data-i18n='roll-full-attack_'>ROLL FULL ATTACK: </span>
                                        </div>
                                        <div class='field row span-two'>
                                            <label><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='?{Full Attack|No,0|Yes,1}' checked='checked'><span class='label'  data-i18n='query'>QUERY</span></label>
                                            <label><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='1'><span class='label' data-i18n='always'>ALWAYS</span></label>
                                            <label><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='0'><span class='label'  data-i18n='never'>NEVER</span></label>
                                        </div>
                                        <div class='field row span-two'>
                                            <span class='label' data-i18n='number-of-attacks:'>NUMBER OF ATTACKS:</span>
                                            <input class='scalable-input attack-num input-field' type='text' title='@{full_attack_number}' name='attr_full_attack_number' value='2'>
                                        </div>
                                        <div class='field row span-two'>
                                            <span class='label' data-i8n='full-attack-penalty:'>ATTACK PENALTY:</span>
                                            <input class='scalable-input attack-num input-field' type='text' title='@{full_attack_penalty}' name='attr_full_attack_penalty' value='-4'>
                                        </div>
                                    </div>
                                    <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                    <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'><span class='label field' data-i18n='attacher'>ATTACHER</span></label>
                                    <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                    <input class='field-tab macro-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                    <textarea class='expandable atk-description input-field' title='@{attacher}' name='attr_attacher' ></textarea>
                                    <div class='row span-all'>
                                        <textarea class='atk-description scalable-input input-field' title='@{description}' name='attr_description' placeholder='Description' value=''></textarea>
                                    </div>
                                    <div class='row span-all'>
                                        <input readonly=true class='id-label' title='@{id}' name='attr_id'></input>
                                    </div>
                                </div>
                                <div class='display'>
                                    <div class='button-description'>
                                        <input title='@{name}' type='text' name='attr_name' placeholder='Laser Rifle'>
                                        <div class='attr-total-container'>
                                            <input class='mod-buff' type='hidden' name='attr_total_change' value='0'>
                                            <span class='label modified-attr' title='@{total}' name='attr_total' value='0'>0</span>
                                        </div>
                                        <div class='attr-total-container span-two'>
                                            <input class='mod-buff' type='hidden' name='attr_damage_total_change' value='0'>
                                            <span class='label modified-attr' title='@{damage_total}' name='attr_damage_total' value='0'>0</span>
                                        </div>
                                        <input type='text' class='label' title='@{type}' name='attr_type' placeholder='Fire'>
                                        <button class='summary' type='roll' title='%{roll}' name='roll_roll' value='@{whisper_state}&{template:sf_attack}{{name=@{character_name}}} {{characterid=@{character_id}}} {{title=@{name}}} {{leftbanner=^{level} [[[[@{level}]]d1cs>2cf>2]]}} {{fullattack=[[@{full_attack_query}*(@{full_attack_number})]]}} {{r1name=@{name}}} {{r1=[[1d20+@{base_attack_bonus}[BAB]+@{ability}[ABILITY]+@{proficiency_value}[PROF]+[[@{full_attack_query}*(@{full_attack_penalty})]][FULL ATTACK]@{misc}@{bonus}]]}} {{damage1type=@{type}}} {{damage1=[[@{damage_dice}+@{damage_ability}[ABILITY]+@{damage_proficiency_value}[SPEC]@{damage_misc}]]}} {{crit1damage=[[@{damage_dice}+@{damage_ability}[ABILITY]+@{damage_proficiency_value}[SPEC]@{damage_misc}]]}} {{crit1effect=@{crit}}} {{r2name=@{name}}} {{r2=[[1d20+@{base_attack_bonus}[BAB]+@{ability}[ABILITY]+@{proficiency_value}[PROF]+[[@{full_attack_penalty}]][FULL ATTACK]@{misc}@{bonus}]]}} {{damage2type=@{type}}} {{damage2=[[@{damage_dice}+@{damage_ability}[ABILITY]+@{damage_proficiency_value}[SPEC]@{damage_misc}]]}} {{crit2damage=[[@{damage_dice}+@{damage_ability}[ABILITY]+@{damage_proficiency_value}[SPEC]@{damage_misc}]]}} {{crit2effect=@{crit}}} {{r3name=@{name}}} {{r3=[[1d20+@{base_attack_bonus}[BAB]+@{ability}[ABILITY]+@{proficiency_value}[PROF]+@{full_attack_penalty}[FULL ATTACK]@{misc}@{bonus}]]}} {{damage3type=@{type}}} {{damage3=[[@{damage_dice}+@{damage_ability}[ABILITY]+@{damage_proficiency_value}[SPEC]@{damage_misc}]]}} {{crit3damage=[[@{damage_dice}+@{damage_ability}[ABILITY]+@{damage_proficiency_value}[SPEC]@{damage_misc}]]}} {{crit3effect=@{crit}}} {{r4name=@{name}}} {{r4=[[1d20+@{base_attack_bonus}[BAB]+@{ability}[ABILITY]+@{proficiency_value}[PROF]+@{full_attack_penalty}[FULL ATTACK]@{misc}@{bonus}]]}} {{damage4type=@{type}}} {{damage4=[[@{damage_dice}+@{damage_ability}[ABILITY]+@{damage_proficiency_value}[SPEC]@{damage_misc}]]}} {{crit4damage=[[@{damage_dice}+@{damage_ability}[ABILITY]+@{damage_proficiency_value}[SPEC]@{damage_misc}]]}} {{crit4effect=@{crit}}} {{r5name=@{name}}} {{r5=[[1d20+@{base_attack_bonus}[BAB]+@{ability}[ABILITY]+@{proficiency_value}[PROF]+@{full_attack_penalty}[FULL ATTACK]@{misc}@{bonus}]]}} {{damage5type=@{type}}} {{damage5=[[@{damage_dice}+@{damage_ability}[ABILITY]+@{damage_proficiency_value}[SPEC]@{damage_misc}]]}} {{crit5damage=[[@{damage_dice}+@{damage_ability}[ABILITY]+@{damage_proficiency_value}[SPEC]@{damage_misc}]]}} {{crit5effect=@{crit}}} {{range=@{range}}} {{ammo_type=@{ammo_type}}} {{curr_ammo=@{ammo}}} {{rightbanner=@{special}}} {{notes=@{description}}} @{attacher}'></button>
                                        <label class='expand-button'><input hidden='true' class='expand-description' type='checkbox' name='attr_expand_description' value='1'><span class='collapsed pictos'>`</span><span class='expanded pictos'>J</span></label>
                                    </div>
                                    <input class='expand-description' type='hidden' name='attr_expand_description'>
                                    <textarea class='description span-all' title='@{description}' name='attr_description' placeholder='Description'></textarea>
                                </div>
                            </div>
                        </fieldset>
                        </div>
                    <div class='equipment section-container'>
                            <input type='radio' title='@{encumber_level}' name='attr_encumber_level' hidden='true' value='0' checked='checked'>
                            <input type='hidden' name='attr_encumber_bulk_misc'>
                            <input type='hidden' name='attr_overburden_bulk_misc'>
                            <div class='bulk-container carried'>
                                <span class='number scalable-input' title='@{carried_bulk}' name='attr_carried_bulk' readonly='true' value='0'>0</span>
                                <span class='label' data-i18n='carried'>CARRIED</span>
                            </div>
                            <input class='encumbered' type='radio' title='@{encumber_level}' name='attr_encumber_level' hidden='true' value='1'>
                            <div class='bulk-container encumber'>
                                <input class='mod-buff' type='hidden' name='attr_encumber_bulk_change' value='0'>
                                <span class='number modified-attr' name=attr_encumber_bulk readonly='true' value='5'>5</span>
                                <span class='label' data-i18n='encumber'>ENCUMBER</span>
                            </div>
                            <input class='overburdened' type='radio' title='@{encumber_level}' name='attr_encumber_level' hidden='true' value='2'>
                            <div class='bulk-container overburden'>
                                <input class='mod-buff' type='hidden' name='attr_overburden_bulk_change' value='0'>
                                <span class='number modified-attr' title='@{overburden_bulk}' name='attr_overburden_bulk' readonly='true' value='10'>10</span>
                                <span class='label' data-i18n='over'>OVER</span>
                            </div>
                            <div class='credits-container credits'>
                                <input class='input-field' type='number' title='@{credits}' name='attr_credits' value='0'>
                                <span class='label' data-i18n='credits'>CREDITS</span>
                            </div>
                            <div class='credits-container wealth'>
                                <span type='number' title='@{wealth}' name='attr_wealth' readonly='true' value='0'>0</span>
                                <span class='label' data-i18n='wealth'>WEALTH</span>
                            </div>
                            <div class='credits-container upb'>
                                <input class='input-field' type='number' title='@{upb}' name='attr_upb' value='0'>
                                <span class='label' data-i18n='upbs'>UPBs</span>
                            </div>
                            <div class='item-container'>
                                <div class='button-description'>
                                    <span data-i18n='name'>NAME</span>
                                    <span data-i18n='level'>LEVEL</span>
                                    <span data-i18n='quantity'>QUANTITY</span>
                                    <span data-i18n='bulk'>BULK</span>
                                    <span data-i18n='cost'>COST</span>
                                </div>
                                <fieldset class='repeating_item'>
                                    <input class='filter' type='checkbox' hidden='true' title='@{filter}' name='attr_filter' value='1' checked='checked'>
                                    <div class='filter-container item'>
                                        <input class="show-options" type="checkbox" title='@{show_options}' name="attr_show_options" checked="checked"><span>y</span>
                                        <div class='row-options'>
                                            <div class='row name'>
                                                <span class='label' data-i18n='name-u'>NAME</span>
                                                <input class='item-name scalable-input input-field' type='text' title='@{name}' name='attr_name' placeholder='Laser Pistol'>
                                                <span class='label' data-i18n='level'>LEVEL</span>
                                                <input class='level input-field' type='number' title='@{level}' name='attr_level' placeholder='1'>
                                            </div>
                                            <div class='row bulk-cost display-margin'>
                                                <span class='label' data-i18n='num'>NUM</span>
                                                <input class='item-quantity scalable-input input-field' type='text' title='@{quantity}' name='attr_quantity' placeholder='1'>
                                                <span class='label' data-i18n='bulk'>BULK</span>
                                                <input class='item-quantity scalable-input input-field' type='text' title='@{bulk}' name='attr_bulk' placeholder='1'>
                                                <span class='label' data-i18n='cost'>COST</span>
                                                <input class='item-quantity scalable-input input-field' type='text' title='@{cost}' name='attr_cost' placeholder='1'>
                                            </div>
                                            <input class='purpose-filter' type='hidden' name='attr_purpose'>
                                            <div class='row equip-state'>
                                                <select class='item-equip input-field' title='@{equipped}' name='attr_equipped' >
                                                    <option value='equipped' data-i18n='equipped' selected>EQUIPPED</option>
                                                    <option value='carried' data-i18n='carried'>CARRIED</option>
                                                    <option value='not carried' data-i18n='not carried'>NOT CARRIED</option>
                                                </select>
                                                <select class='input-field' title='@{purpose}' name='attr_purpose'>
                                                    <option value='' data-i18n='purpose' selected>PURPOSE</option>
                                                    <option value='armor' data-i18n='armor'>ARMOR</option>
                                                    <option value='weapon' data-i18n='weapon'>WEAPON</option>
                                                    <option value='equipment' data-i18n='equipment'>EQUIPMENT</option>
                                                </select>
                                                <input class='purpose-filter' type='hidden' name='attr_purpose'>
                                                <select title='@{type}' class='armor-purpose input-field' name='attr_type'>
                                                    <option value='' data-i18n='armor-type' selected>ARMOR TYPE</option>
                                                    <option value='light_armor' data-i18n='light-armor'>LIGHT ARMOR</option>
                                                    <option value='heavy_armor' data-i18n='heavy-armor'>HEAVY ARMOR</option>
                                                    <option value='power_armor' data-i18n='power-armor'>POWER ARMOR</option>
                                                </select>
                                                <select title='@{proficiency}' class='armor-purpose input-field' name='attr_proficiency'>
                                                    <option value='no' data-i18n='Not-Proficient' selected>NOT PROFICIENT</option>
                                                    <option value='yes' data-i18n='proficient'>PROFICIENT</option>
                                                </select>
                                            </div>
                                            <div class='row'>
                                                <input type='number' title='@{uses}' name='attr_uses' value='0'>
                                                <span class='label'>/</span>
                                                <div class='scalable-input attr-base-mod-container'>
                                                    <input class='base-attr ability-uses' type='text' title='@{uses_max}' name='attr_uses_max_base' value='10' >
                                                    <input class='mod-buff' type='hidden' name='attr_uses_change' value='0'>
                                                    <span class='input-field modified-attr attr ability-uses' readonly='true' type='text' title='@{uses_max}' name='attr_uses_max' value='10'>10</span>
                                                </div>
                                                <span class='label' data-i18n='uses'>USES</span>
                                            </div>
                                            <input class='field-tab mods' type='checkbox' title='@{mods_checkbox}' name='attr_mods_checkbox' value='1' hidden='true'>
                                            <label class='mods'><input class='field-tab mods-tab item-mods' type='checkbox' title='@{mods_checkbox}' name='attr_mods_checkbox' value='1' hidden='true'><span class='label field' data-i18n='mods'>MODS</span></label>
                                            <textarea class='field row mods input-field' type='text' title='@{mods}' name='attr_mods'placeholder='+X to EAC'></textarea>
                                            <input class='field-tab attacher' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                            <label class='attacher'><input class='field-tab macro-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'><span class='label field' data-i18n='attacher'>ATTACHER</span></label>
                                            <textarea class='field row attacher input-field' title='@{attacher}' name='attr_attacher' ></textarea>
                                            <textarea class='item-description description input-field' title='@{description}' name='attr_description' placeholder='Description'></textarea>
                                            <input readonly=true class='id-label id' title='@{id}' name='attr_id'></input>
                                        </div>
                                        <div class='display'>
                                            <div class='button-description'>
                                                <span title='@{name}' name='attr_name'></span>
                                                <span name='attr_level'></span>
                                                <span name='attr_quantity'></span>
                                                <span name='attr_bulk'></span>
                                                <span name='attr_cost'></span>
                                                <button class='summary' type='roll' title='%{roll}' name='roll_roll' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=@{name}}} {{r1name=Quantity}} {{r1=@{quantity}}} {{r2name=Bulk}} {{r2=@{bulk}}} {{r3name=Value}} {{r3=@{cost}}} {{notes=@{description}}} @{attacher}'></button>
                                                <label class='expand-button'><input hidden='true' class='expand-description' type='checkbox' name='attr_expand_description' value='1'><span class='collapsed pictos'>`</span><span class='expanded pictos'>J</span></label>
                                            </div>
                                            <input class='expand-description' type='hidden' name='attr_expand_description'>
                                            <textarea class='description' title='@{description}' name='attr_description' placeholder='Description'></textarea>
                                        </div>
                                    </div>
                                </fieldset>
                            </div>
                        </div>
                    <div class='abilities-container section-container'>
                        <div class='button-description'>
                            <span class='label' type='text' data-i18n='name'>NAME</span>
                            <span class='label' type='text' data-i18n='source'>SOURCE</span>
                            <span class='label' type='text' data-i18n='ability-type'>ABILITY TYPE</span>
                            <span class='label span-two' type='text' data-i18n='usage'>USAGE</span>
                        </div>
                        <fieldset class='repeating_ability'><input hidden='true' type='text' title='@{attack_total}' name='attr_attack_total'><input hidden='true' type='text' title='@{damage_total}' name='attr_damage_total'>
                            <input class='filter' type='checkbox' hidden='true' title='@{filter}' name='attr_filter' value='1' checked='checked'>
                            <div class='filter-container ability'>
                               <!--Hidden Ability Attributes -->
                               <input type='text' hidden='true' title='@{attack_misc}' name='attr_attack_misc' value=''>
                               <input type='text' hidden='true' title='@{attack_damage_misc}' name='attr_attack_damage_misc' value=''>
                               <input type='text' hidden='true' title='@{effect_misc}' name='attr_effect_misc' value=''>
                               <!--Shown Ability Attributes -->
                                <input class="show-options" type="checkbox" title='@{show_options}' name="attr_show_options" checked="checked"><span>y</span>
                                <div class='row-options'>
                                    <div class='row  span-two'>
                                        <span class='label' data-i18n='name-u'>NAME</span>
                                        <input class='scalable-input input-field' type='text' title='@{name}' name='attr_name' placeholder="Operative's Edge">
                                        <select class='freq-select' title='@{frequency}' name='attr_frequency'>
                                            <option value='constant' data-i18n='constant' selected>CONSTANT</option>
                                            <option value='at-will' data-i18n='at-will'>AT WILL</option>
                                            <option value='daily-limit' data-i18n='x/day'>X/DAY</option>
                                        </select>
                                    </div>
                                    <div class='row span-two display-margin'>
                                        <span class='label' data-i18n='source'>SOURCE</span>
                                        <input class='scalable-input input-field' type='text' title='@{source}' name='attr_source' placeholder='Operative'>
                                        <select title='@{type}' name='attr_type'>
                                            <option value='EX' data-i18n='extraordinary' selected>EX</option>
                                            <option value='SU' data-i18n='supernatural'>SU</option>
                                            <option value='SP' data-i18n='spell-like'>SP</option>
                                        </select>
                                    </div>
                                    <div class='row span-two'>
                                        <span class='label' data-i18n='target'>TARGET</span>
                                        <input class='scalable-input input-field' type='text' title='@{target}' name='attr_target' placeholder='self'>
                                        <span class='label' data-i18n='rng'>RANGE</span>
                                        <input class='scalable-input input-field' type='text' title='@{range}' name='attr_range' placeholder='30 ft'>
                                    </div>
                                    <div class='row'>
                                        <span class='label' data-i18n='duration'>DURATION</span>
                                        <input class='scalable-input input-field' type='text' title='@{duration}' name='attr_duration' placeholder='1 round' value=''>
                                    </div>
                                    <input class='type-filter' type='hidden' name='attr_type' value='EX'>
                                    <div class='row type-span'>
                                        <span class='label' data-i18n='level'>LEVEL</span>
                                        <input class='atk-level input-field' type='number' name='attr_level' value='0'>
                                        <span class='label' data-i18n='spell-resistance-abbrv'>SR</span>
                                        <input type='hidden' name='attr_spell_penetration_misc' value=''><select name='attr_spell_resistance'>
                                            <option value='' data-i18n='no' selected>NO</option>
                                            <option value='yes' data-i18n='yes'>YES</option>
                                        </select>
                                    </div>
                                    <input type='hidden' title='@{frequency}' name='attr_frequency' class='freq-check'>
                                    <div class='row at-will daily-limit'>
                                        <span class='label abi-cost' data-i18n='usage'>USAGE</span>
                                        <input class='scalable-input input-field' type='text' title='@{usage}' name='attr_usage' placeholder='move action, 1 resolve point'>
                                    </div>
                                    <div class='row daily-limit'>
                                        <input class='' type='number' title='@{uses}' name='attr_uses' value='0'>
                                        <span class='label'>/</span>
                                        <div class='scalable-input attr-base-mod-container'>
                                            <input class='base-attr ability-uses' type='text' title='@{uses_max}' name='attr_uses_max_base' value='10' >
                                            <input class='mod-buff' type='hidden' name='attr_uses_change' value='0'>
                                            <span class='input-field modified-attr attr ability-uses' readonly='true' type='text' title='@{uses_max}' name='attr_uses_max' value='10'>10</span>
                                        </div>
                                        <span class='label' data-i18n='_-daily-uses'>Daily Uses</span>
                                    </div>
                                    <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                    <label class='expandable'><input class='field-tab atk-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'><span class='field label' data-i18n='atk'>ATTACK ROLL</span></label>
                                    <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                    <div class='field-container expandable inherit-grid'>
                                        <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                        <div class='field row span-all'>
                                            <select class='label atk-ability abi' title='@{attack_ability}' name='attr_attack_ability'>
                                                <option value='0' selected data-i18n='n/a'>N/A</option>
                                                <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                                <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                                <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                                <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                                <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                                <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                            </select>
                                            <input hidden='true' title='@{attack_ability}' name='attr_attack_ability' value='0'>
                                            <span class='arith'>+</span>
                                            <input class='bab' title='@{base_attack_bonus}' name='attr_base_attack_bonus' readonly='true' value='0'>
                                            <input class='scalable-input input-field' type='text' title='@{attack_bonus}' name='attr_attack_bonus' placeholder='+@{attr}/2 + ?{Query}'>
                                        </div>
                                    </div>
                                    <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                    <label class='expandable'><input class='field-tab dmg-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'><span class='field label' data-i18n='dmg'>DAMAGE ROLL</span></label>
                                    <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                    <div class='field-container expandable inherit-grid'>
                                        <input hidden='true' title='@{damage_misc}' name='attr_damage_misc' value=''>
                                        <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                        <div class='field row span-two'>
                                            <input class='scalable-input input-field' type='text' name=attr_damage_dice placeholder='1d8'><span>+</span>
                                            <select class='label atk-ability abi' title='@{damage_ability}' name='attr_damage_ability'>
                                                <option value='0' selected data-i18n='n/a'>N/A</option>
                                                <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                                <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                                <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                                <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                                <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                                <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                            </select>
                                            <input type='text' hidden='true' title='@{damage_ability}' name='attr_damage_ability' value='0'>
                                        </div>
                                        <div class='field row span-two'>
                                            <span class='label' data-i18n='damage-type'>DAMAGE TYPE</span>
                                            <input class='scalable-input input-field' type='text' title='@{attack_type}' name='attr_attack_type' placeholder='Fire'>
                                            <span class='label' data-i18n='crit-effect'>CRITICAL EFFECT</span>
                                            <input class='scalable-input input-field' type='text' title='@{attack_crit}' name='attr_attack_crit' placeholder='Burn'>
                                        </div>
                                    </div>
                                    <input class='field-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                    <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'><span class='label field' data-i18n='additional-attack'>ADDITIONAL ATTACKS</span></label>
                                    <input class='field-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                    <div class='field-container expandable inherit-grid'>
                                        <input class='field-tab macro-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                        <div class='field row'>
                                            <span data-i18n='roll-full-attack_'>ROLL FULL ATTACK: </span>
                                        </div>
                                        <div class='field row span-two'>
                                            <label><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='?{Full Attack|No,0|Yes,1}'><span class='label'  data-i18n='query'>QUERY</span></label>
                                            <label><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='1'><span class='label' data-i18n='always'>ALWAYS</span></label>
                                            <label><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='0' checked='checked'><span class='label'  data-i18n='never'>NEVER</span></label>
                                        </div>
                                        <div class='field row span-two'>
                                            <span class='label' data-i18n='number-of-attacks:'>NUMBER OF ATTACKS:</span>
                                            <input class='scalable-input input-field' type='text' title='@{full_attack_number}' name='attr_full_attack_number' value='2'>
                                        </div>
                                        <div class='field row span-two'>
                                            <span class='label' data-i8n='full-attack-penalty:'>ATTACK PENALTY:</span>
                                            <input class='scalable-input input-field' type='text' title='@{full_attack_penalty}' name='attr_full_attack_penalty' value='-4'>
                                        </div>
                                    </div>
                                    <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                    <label class='expandable'><input class='field-tab save-effect-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'><span class='field label' data-i18n='save-effect'>SAVE EFFECT</span></label>
                                    <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                    <div class='field-container expandable inherit-grid'>
                                        <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                        <div class='field row span-two'>
                                            <select class='label atk-ability abi input-field' title='@{save_ability}' name='attr_save_ability'>
                                                <option value='0' selected data-i18n='n/a'>N/A</option>
                                                <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                                <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                                <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                                <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                                <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                                <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                            </select>
                                            <span class='label' data-i18n='based-dc_'>Based DC </span>
                                            <input class='mod-buff' type='hidden' name='attr_dc_change' value='0'>
                                            <input title='@{dc}' name='attr_dc' type='number' value='10' hidden='true'>
                                            <span class='save-dc modified-attr label' title='@{dc}' name='attr_dc' value='10'>10</span>
                                            <select class='label save-type input-field' title='@{save_type}' name='attr_save_type'>
                                                <option value='' selected>-</option>
                                                <option value='FORT' data-i18n='fort-save'>FORT SAVE</option>
                                                <option value='REF' data-i18n='ref-save'>REF SAVE</option>
                                                <option value='WILL' data-i18n='will-save'>WILL SAVE</option>
                                            </select>
                                        </div>
                                        <div class='field row span-all'>
                                            <textarea title='@{effect}' name='attr_effect' placeholder='Effect on a Failed Save'></textarea>
                                        </div>
                                        <div class='field row span-all'>
                                            <span class='label' data-i18n='A-Sucessful-Save:'>A Sucessful Save:</span>
                                        </div>
                                        <div class='field row span-all'>
                                            <textarea title='@{save_effect}' name='attr_save_effect' placeholder='Effect on a Successful Save'></textarea>
                                        </div>
                                    </div>
                                    <input class='field-tab' type='checkbox' title='@{mods_checkbox}' name='attr_mods_checkbox' value='1' hidden='true'>
                                    <label class='expandable'><input class='field-tab mods-tab item-mods' type='checkbox' title='@{mods_checkbox}' name='attr_mods_checkbox' value='1' hidden='true'><span class='label field' data-i18n='mods'>MODS</span></label>
                                    <input class='field-tab' type='checkbox' title='@{mods_checkbox}' name='attr_mods_checkbox' value='1' hidden='true'>
                                    <div class='row field-container mod-container expandable'>
                                        <input class='field-tab' type='checkbox' title='@{mods_checkbox}' name='attr_mods_checkbox' value='1' hidden='true'>
                                        <textarea class='field row scalable-input input-field' type='text' title='@{mods}' name='attr_mods'placeholder='+X to EAC'></textarea>
                                    </div>
                                    <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                    <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'><span class='label field' data-i18n='attacher'>ATTACHER</span></label>
                                    <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                    <div class='row field-container mod-container expandable'>
                                        <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                        <textarea class='field row scalable-input input-field' type='text' title='@{attacher}' name='attr_attacher'></textarea>
                                    </div>
                                    <div class='row span-all'>
                                        <textarea class='' title='@{description}' name='attr_description' placeholder='Description'></textarea>
                                        </div>
                                    <div class='row span-all'><input readonly=true class='id-label' title='@{id}' name='attr_id'></input>
                                    </div>
                                </div>
                                <div class='display'>
                                    <input type='hidden' title='@{frequency}' name='attr_frequency' class='freq-check'>
                                    <input class='freq-check at-will daily-limit' type='checkbox' title='@{toggle}' name='attr_toggle' value='1'>
                                    <div class='button-description'>
                                        <input class='label' type='text' title='@{name}' name='attr_name' placeholder='Laser Pistol'>
                                        <input class='label' type='text' name='attr_source' placeholder='Operative'>
                                        <input class='label force-uppercase' type='text' name='attr_type'>
                                        <input class='const-check' name='attr_frequency' type='hidden'>
                                        <input class='label span-two constant force-uppercase' type='text' name='attr_frequency'>
                                        <input class='label span-two not-constant' type='text' name='attr_usage'>
                                        <button class='npcsummary' type='roll' title='%{roll}' name='roll_roll' value='@{whisper_state}&{template:sf_spell} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=@{name}}} {{rightbanner=@{source}}} {{saveflag=[[1d@{save_checkbox}]]}} {{srflag=@{spell_resistance}}} {{srroll=[[1d20+@{character_level}@{spell_penetration_misc}]]}} {{activation=@{usage}}} {{duration=@{duration}}} {{targets=@{target}}} {{range=@{range}}} {{savedc=@{dc}}} {{savetype=@{save_type}}} {{effect=@{effect}}} {{saveeffect=@{save_effect}}} {{attackflag=[[1d@{attack_checkbox}]]}} {{fullattack=[[@{full_attack_query}*(@{full_attack_number})]]}} {{r1=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+[[@{full_attack_query}*(@{full_attack_penalty})]][FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage1type=@{attack_type}}} {{damage1=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit1damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit1effect=@{attack_crit}}}  {{r2=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage2type=@{attack_type}}} {{damage2=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit2damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit2effect=@{attack_crit}}} {{r3=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage3type=@{attack_type}}} {{damage3=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit3damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit3effect=@{attack_crit}}} {{r4=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage4type=@{attack_type}}} {{damage4=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit4damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit4effect=@{attack_crit}}} {{r5=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage5type=@{attack_type}}} {{damage5=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit5damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit5effect=@{attack_crit}}} {{rightbanner=@{type}}} {{notes=@{description}}} @{attacher}'></button>
                                        <label class='expand-button'><input hidden='true' class='expand-description' type='checkbox' name='attr_expand_description' value='1'><span class='collapsed pictos'>`</span><span class='expanded pictos'>J</span></label>
                                    </div>
                                    <input class='expand-description' type='hidden' name='attr_expand_description'>
                                    <textarea class='description' title='@{description}' name='attr_description' placeholder='Description'></textarea>
                                </div>
                            </div>
                        </fieldset>
                    </div>
                    <div class='spell-containers'>
                        <div class='spell-column'>
                            <input type='hidden' class='spell-levels-display' title='@{char_max_spell}' name='attr_char_max_spell'>
                            <div class='section-container aspell0'>
                                <div class='section'>
                                    <h1 class='label' data-i18n='cantrips'>CANTRIPS</h1>
                                </div>
                                <div class='section-container'>
                                    <div class='button-description'>
                                        <span class='label' data-i18n='name'>NAME</span>
                                        <span class='label' data-i18n='school'>SCHOOL</span>
                                    </div>
                                    <fieldset class='repeating_spell'><input hidden='true' type='text' title='@{attack_total}' name='attr_attack_total'><input hidden='true' type='text' title='@{damage_total}' name='attr_damage_total'>
                                        <input class='filter' type='hidden' title='@{filter}' name='attr_filter'>
                                        <div class='filter-container spell cantrip'>
                                                <input type='text' hidden='true' title='@{attack_misc}' name='attr_attack_misc' value=''>
                                                <input type='text' hidden='true' title='@{effect_misc}' name='attr_effect_misc' value=''>
                                                <input class="show-options" type="checkbox" title='@{show_options}' name="attr_show_options" checked="checked"><span>y</span>
                                                <div class='row-options'>
                                                    <div class='row span-two display-margin'>
                                                        <span class='label' data-i18n='name-u'>NAME</span>
                                                        <input class='atk-name scalable-input input-field' type='text' title='@{name}' name='attr_name' placeholder="Operative's Edge">
                                                        <span class='label' data-i18n='lvl'>LVL</span>
                                                        <input class='atk-level' title='@{level}' name='attr_level' type='text' value=''>
                                                    </div>
                                                    <div class='row'>
                                                        <span class='label' data-i18n='source'>SOURCE</span>
                                                        <input class='scalable-input input-field' type='text' title='@{source}' name='attr_source' placeholder='Operative'>
                                                    </div>
                                                    <div class='row'>
                                                        <span class='label' data-i18n='school'>SCHOOL</span>
                                                        <input class='scalable-input input-field' title='@{school}' name='attr_school' type='text' placeholder='abjuration'>
                                                    </div>
                                                    <div class='row span-two'>
                                                        <span class='label' data-i18n='target'>TARGET</span>
                                                        <input class='scalable-input input-field' type='text' title='@{target}' name='attr_target' placeholder='self'>
                                                        <span class='label' data-i18n='rng'>RNG</span>
                                                        <input class='scalable-input input-field' type='text' title='@{range}' name='attr_range' placeholder='30 ft'>
                                                    </div>
                                                    <div class='row'>
                                                        <span class='label' data-i18n='duration'>DURATION</span>
                                                        <input class='scalable-input input-field' type='text' title='@{duration}' name='attr_duration' placeholder='1 round' value=''>
                                                    </div>
                                                    <div class='row'>
                                                        <span class='label abi-cost' data-i18n='usage'>USAGE</span>
                                                        <input class='scalable-input input-field' type='text' title='@{usage}' name='attr_usage' placeholder='Standard Action'>
                                                    </div>
                                                    <div class='row'>
                                                    <span class='label' data-i18n='spell-resistance-abbrv'>SR</span>
                                                    <input type='hidden' name='attr_spell_penetration_misc' value=''><select name='attr_spell_resistance'>
                                                    <option value='' data-i18n='no' selected>NO</option>
                                                    <option value='yes' data-i18n='yes'>YES</option>
                                                    </select>
                                                    </div>
                                                    <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                                    <label class='expandable'><input class='field-tab atk-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'><span class='field label' data-i18n='atk'>ATK</span></label>
                                                    <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                                    <div class='field-container expandable inherit-grid'>
                                                        <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                                        <div class='field row span-two'>
                                                            <select class='label atk-ability abi' title='@{attack_ability}' name='attr_attack_ability'>
                                                                <option value='@{strength_mod}' data-i18n='str' selected>STR</option>
                                                                <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                                                <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                                                <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                                                <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                                                <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                                            </select>
                                                            <input hidden='true' title='@{attack_ability}' name='attr_attack_ability' value='0'>
                                                            <span class='arith'>+</span>
                                                            <input class='bab' title='@{base_attack_bonus}' name='attr_base_attack_bonus' readonly='true' value='0'>
                                                            <input class='abi-misc' type='text' title='@{attack_bonus}' name='attr_attack_bonus' placeholder='+@{attr}/2 + ?{Query}'>
                                                        </div>
                                                    </div>
                                                    <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                                    <label class='expandable'><input class='field-tab dmg-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'><span class='field label' data-i18n='dmg'>DMG</span></label>
                                                    <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                                    <div class='field-container expandable inherit-grid'>
                                                        <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                                        <input hidden='true' title='@{damage_misc}' name='attr_damage_misc' value=''>
                                                        <div class='field row span-two'>
                                                            <input class='abi-dmg-dice' type='text' name=attr_damage_dice placeholder='1d8'><span>+</span>
                                                            <select class='label atk-ability abi' title='@{damage_ability}' name='attr_damage_ability'>
                                                                <option value='' selected data-i18n='n/a'>N/A</option>
                                                                <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                                                <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                                                <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                                                <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                                                <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                                                <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                                            </select>
                                                            <input hidden='true' title='@{damage_ability}' name='attr_damage_ability' value='0'>
                                                        </div>
                                                        <div class='field row span-two'>
                                                            <span class='label' data-i18n='type'>TYPE</span>
                                                            <input class='scalable-input input-field' type='text' title='@{attack_type}' name='attr_attack_type' placeholder='Fire'>
                                                            <span class='label' data-i18n='crit-effect'>CRIT EFFECT</span>
                                                            <input class='scalable-input input-field' type='text' title='@{attack_crit}' name='attr_attack_crit' placeholder='Burn'>
                                                        </div>
                                                    </div>
                                                    <input class='field-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                                    <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'><span class='label field' data-i18n='additional-attack'>ADDITIONAL ATTACKS</span></label>
                                                    <input class='field-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                                    <div class='field-container expandable inherit-grid'>
                                                        <input class='field-tab macro-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                                        <div class='field row span-two'>
                                                            <span data-i18n='roll-full-attack_'>ROLL FULL ATTACK: </span>
                                                            <label class='scalable-input'><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='?{Full Attack|No,0|Yes,1}'><span class='label'  data-i18n='query'>QUERY</span></label>
                                                            <label class='scalable-input'><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='1'><span class='label' data-i18n='always'>ALWAYS</span></label>
                                                            <label class='scalable-input'><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='0' checked='checked'><span class='label'  data-i18n='never'>NEVER</span></label>
                                                        </div>
                                                        <div class='field row span-two'>
                                                            <span class='label' data-i18n='number-of-attacks:'>NUMBER OF ATTACKS:</span>
                                                            <input class='scalable-input attack-num' type='text' title='@{full_attack_number}' name='attr_full_attack_number' value='2'>
                                                            <span class='label' data-i8n='full-attack-penalty:'>ATTACK PENALTY:</span>
                                                            <input class='scalable-input attack-num' type='text' title='@{full_attack_penalty}' name='attr_full_attack_penalty' value='-4'>
                                                        </div>
                                                    </div>
                                                    <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                                    <label class='expandable'><input class='field-tab save-effect-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'><span class='field label' data-i18n='save-effect'>SAVE EFFECT</span></label>
                                                    <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                                    <div class='field-container expandable inherit-grid'>
                                                        <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                                        <div class='field row span-two'>
                                                            <select class='label atk-ability abi' title='@{save_ability}' name='attr_save_ability'>
                                                                <option value='@{strength_mod}' data-i18n='str' selected>STR</option>
                                                                <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                                                <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                                                <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                                                <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                                                <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                                            </select>
                                                            <span class='label' data-i18n='based-dc_'>Based DC </span>
                                                            <input class='mod-buff' type='hidden' name='attr_dc_change' value='0'>
                                                            <input title='@{dc}' name='attr_dc' type='number' value='10' hidden='true'>
                                                            <span class='save-dc modified-attr label' title='@{dc}' name='attr_dc' value='10'>10</span>
                                                            <select class='label save-type' title='@{save_type}' name='attr_save_type'>
                                                                <option value='' selected>-</option>
                                                                <option value='FORT' data-i18n='fort-save'>FORT SAVE</option>
                                                                <option value='REF' data-i18n='ref-save'>REF SAVE</option>
                                                                <option value='WILL' data-i18n='will-save'>WILL SAVE</option>
                                                            </select>
                                                        </div>
                                                        <div class='field row span-two'>
                                                            <textarea class='' title='@{effect}' name='attr_effect' placeholder='Effect on a Failed Save'></textarea>
                                                        </div>
                                                        <div class='field row span-two'>
                                                            <span class='label' data-i18n='A-Sucessful-Save:'>A Sucessful Save:</span>
                                                        </div>
                                                        <div class='field row span-two'>
                                                            <textarea class='' title='@{save_effect}' name='attr_save_effect' placeholder='Effect on a Successful Save'></textarea>
                                                        </div>
                                                    </div>
                                                    <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                                    <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'><span class='label field' data-i18n='attacher'>ATTACHER</span></label>
                                                    <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                                    <div class='row field-container mod-container expandable'>
                                                        <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                                        <textarea class='field row' type='text' title='@{attacher}' name='attr_attacher'></textarea>
                                                    </div>
                                                    <div class='row span-two'>
                                                        <textarea class='' title='@{description}' name='attr_description' placeholder='Description'></textarea>
                                                    </div>
                                                    <div class='row span-two'>
                                                        <input readonly=true class='id-label' title='@{id}' name='attr_id'></input>
                                                    </div>
                                                </div>
                                                <div class='display'>
                                                    <div class='button-description'>
                                                        <input class='label' title='@{name}' name='attr_name' placeholder='Operative'>
                                                        <input class='label' name='attr_school' placeholder='Abjuration'>
                                                        <button class='npcsummary' type='roll' title='%{roll}' name='roll_roll' value='@{whisper_state}&{template:sf_spell} {{name=@{character_name}}} {{characterid=@{character_id}}} {{rightbanner=@{school}}} {{title=@{name}}} {{leftbanner=^{level} [[[[@{level}]]d1cs>2cf>2]]}} {{saveflag=[[1d@{save_checkbox}]]}} {{srflag=@{spell_resistance}}} {{srroll=[[1d20+@{caster_level}@{spell_penetration_misc}]]}} {{activation=@{usage}}} {{duration=@{duration}}} {{targets=@{target}}} {{range=@{range}}} {{savedc=@{dc}}} {{savetype=@{save_type}}} {{effect=@{effect}}} {{saveeffect=@{save_effect}}} {{attackflag=[[1d@{attack_checkbox}]]}}{{fullattack=[[@{full_attack_query}*(@{full_attack_number})]]}} {{r1=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+[[@{full_attack_query}*(@{full_attack_penalty})]][FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage1type=@{attack_type}}} {{damage1=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit1damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit1effect=@{attack_crit}}}  {{r2=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage2type=@{attack_type}}} {{damage2=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit2damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit2effect=@{attack_crit}}} {{r3=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage3type=@{attack_type}}} {{damage3=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit3damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit3effect=@{attack_crit}}} {{r4=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage4type=@{attack_type}}} {{damage4=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit4damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit4effect=@{attack_crit}}} {{r5=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage5type=@{attack_type}}} {{damage5=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit5damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit5effect=@{attack_crit}}} {{rightbanner=@{school}}}{{notes=@{description}}} @{attacher}'></button>
                                                        <label class='expand-button'><input hidden='true' class='expand-description' type='checkbox' name='attr_expand_description' value='1'><span class='collapsed pictos'>`</span><span class='expanded pictos'>J</span></label>
                                                    </div>
                                                    <input class='expand-description' type='hidden' name='attr_expand_description'>
                                                    <textarea class='description' title='@{description}' name='attr_description' placeholder='Description'></textarea>
                                                </div>
                                            </div>
                                    </fieldset>
                                    <label class='pseudo-repcontrol spell'>
                                        <input type='checkbox' title='@{create_cantrip}' name='attr_create_cantrip' value='1'>
                                        <span>&</span>
                                    </label>
                                </div>
                            </div>
                            <div class='section-container aspell2 class-spells-day'>
                                <div class='section'>
                                    <h1 class='label' data-i18n='2nd-level'>2nd LEVEL</h1>
                                </div>
                                <div class='section-container'>
                                    <div class='button-description'>
                                        <span class='label' data-i18n='name'>NAME</span>
                                        <span class='label' data-i18n='school'>SCHOOL</span>
                                    </div>
                                    <fieldset class='repeating_spell'><input hidden='true' type='text' title='@{attack_total}' name='attr_attack_total'><input hidden='true' type='text' title='@{damage_total}' name='attr_damage_total'>
                                        <input class='filter' type='hidden' title='@{filter}' name='attr_filter'>
                                        <div class='filter-container spell second'>
                                            <input type='text' hidden='true' title='@{attack_misc}' name='attr_attack_misc' value=''>
                                            <input type='text' hidden='true' title='@{effect_misc}' name='attr_effect_misc' value=''>
                                            <input class="show-options" type="checkbox" title='@{show_options}' name="attr_show_options" checked="checked"><span>y</span>
                                            <div class='row-options'>
                                                <div class='row span-two display-margin'>
                                                    <span class='label' data-i18n='name-u'>NAME</span>
                                                    <input class='atk-name scalable-input input-field' type='text' title='@{name}' name='attr_name' placeholder="Operative's Edge">
                                                    <span class='label' data-i18n='lvl'>LVL</span>
                                                    <input class='atk-level' title='@{level}' name='attr_level' type='text' value=''>
                                                </div>
                                                <div class='row'>
                                                    <span class='label' data-i18n='source'>SOURCE</span>
                                                    <input class='scalable-input input-field' type='text' title='@{source}' name='attr_source' placeholder='Operative'>
                                                </div>
                                                <div class='row'>
                                                    <span class='label' data-i18n='school'>SCHOOL</span>
                                                    <input class='scalable-input input-field' title='@{school}' name='attr_school' type='text' placeholder='abjuration'>
                                                </div>
                                                <div class='row span-two'>
                                                    <span class='label' data-i18n='target'>TARGET</span>
                                                    <input class='scalable-input input-field' type='text' title='@{target}' name='attr_target' placeholder='self'>
                                                    <span class='label' data-i18n='rng'>RNG</span>
                                                    <input class='scalable-input input-field' type='text' title='@{range}' name='attr_range' placeholder='30 ft'>
                                                </div>
                                                <div class='row'>
                                                    <span class='label' data-i18n='duration'>DURATION</span>
                                                    <input class='scalable-input input-field' type='text' title='@{duration}' name='attr_duration' placeholder='1 round' value=''>
                                                </div>
                                                <div class='row'>
                                                    <span class='label abi-cost' data-i18n='usage'>USAGE</span>
                                                    <input class='scalable-input input-field' type='text' title='@{usage}' name='attr_usage' placeholder='Standard Action'>
                                                </div>
                                                <div class='row'>
                                                <span class='label' data-i18n='spell-resistance-abbrv'>SR</span>
                                                <input type='hidden' name='attr_spell_penetration_misc' value=''><select name='attr_spell_resistance'>
                                                <option value='' data-i18n='no' selected>NO</option>
                                                <option value='yes' data-i18n='yes'>YES</option>
                                                </select>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab atk-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'><span class='field label' data-i18n='atk'>ATK</span></label>
                                                <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                                    <div class='field row span-two'>
                                                        <select class='label atk-ability abi' title='@{attack_ability}' name='attr_attack_ability'>
                                                            <option value='@{strength_mod}' data-i18n='str' selected>STR</option>
                                                            <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                                        </select>
                                                        <input hidden='true' title='@{attack_ability}' name='attr_attack_ability' value='0'>
                                                        <span class='arith'>+</span>
                                                        <input class='bab' title='@{base_attack_bonus}' name='attr_base_attack_bonus' readonly='true' value='0'>
                                                        <input class='abi-misc' type='text' title='@{attack_bonus}' name='attr_attack_bonus' placeholder='+@{attr}/2 + ?{Query}'>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab dmg-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'><span class='field label' data-i18n='dmg'>DMG</span></label>
                                                <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                                    <input hidden='true' title='@{damage_misc}' name='attr_damage_misc' value=''>
                                                    <div class='field row span-two'>
                                                        <input class='abi-dmg-dice' type='text' name=attr_damage_dice placeholder='1d8'><span>+</span>
                                                        <select class='label atk-ability abi' title='@{damage_ability}' name='attr_damage_ability'>
                                                            <option value='' selected data-i18n='n/a'>N/A</option>
                                                            <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                                            <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                                        </select>
                                                        <input hidden='true' title='@{damage_ability}' name='attr_damage_ability' value='0'>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <span class='label' data-i18n='type'>TYPE</span>
                                                        <input class='scalable-input input-field' type='text' title='@{attack_type}' name='attr_attack_type' placeholder='Fire'>
                                                        <span class='label' data-i18n='crit-effect'>CRIT EFFECT</span>
                                                        <input class='scalable-input input-field' type='text' title='@{attack_crit}' name='attr_attack_crit' placeholder='Burn'>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'><span class='label field' data-i18n='additional-attack'>ADDITIONAL ATTACKS</span></label>
                                                <input class='field-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab macro-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                                    <div class='field row span-two'>
                                                        <span data-i18n='roll-full-attack_'>ROLL FULL ATTACK: </span>
                                                        <label class='scalable-input'><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='?{Full Attack|No,0|Yes,1}'><span class='label'  data-i18n='query'>QUERY</span></label>
                                                        <label class='scalable-input'><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='1'><span class='label' data-i18n='always'>ALWAYS</span></label>
                                                        <label class='scalable-input'><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='0' checked='checked'><span class='label'  data-i18n='never'>NEVER</span></label>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <span class='label' data-i18n='number-of-attacks:'>NUMBER OF ATTACKS:</span>
                                                        <input class='scalable-input attack-num' type='text' title='@{full_attack_number}' name='attr_full_attack_number' value='2'>
                                                        <span class='label' data-i8n='full-attack-penalty:'>ATTACK PENALTY:</span>
                                                        <input class='scalable-input attack-num' type='text' title='@{full_attack_penalty}' name='attr_full_attack_penalty' value='-4'>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab save-effect-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'><span class='field label' data-i18n='save-effect'>SAVE EFFECT</span></label>
                                                <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                                    <div class='field row span-two'>
                                                        <select class='label atk-ability abi' title='@{save_ability}' name='attr_save_ability'>
                                                            <option value='@{strength_mod}' data-i18n='str' selected>STR</option>
                                                            <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                                        </select>
                                                        <span class='label' data-i18n='based-dc_'>Based DC </span>
                                                        <input class='mod-buff' type='hidden' name='attr_dc_change' value='0'>
                                                        <input title='@{dc}' name='attr_dc' type='number' value='10' hidden='true'>
                                                        <span class='save-dc modified-attr label' title='@{dc}' name='attr_dc' value='10'>10</span>
                                                        <select class='label save-type' title='@{save_type}' name='attr_save_type'>
                                                            <option value='' selected>-</option>
                                                            <option value='FORT' data-i18n='fort-save'>FORT SAVE</option>
                                                            <option value='REF' data-i18n='ref-save'>REF SAVE</option>
                                                            <option value='WILL' data-i18n='will-save'>WILL SAVE</option>
                                                        </select>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <textarea class='' title='@{effect}' name='attr_effect' placeholder='Effect on a Failed Save'></textarea>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <span class='label' data-i18n='A-Sucessful-Save:'>A Sucessful Save:</span>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <textarea class='' title='@{save_effect}' name='attr_save_effect' placeholder='Effect on a Successful Save'></textarea>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'><span class='label field' data-i18n='attacher'>ATTACHER</span></label>
                                                <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                                <div class='row field-container mod-container expandable'>
                                                    <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                                    <textarea class='field row' type='text' title='@{attacher}' name='attr_attacher'></textarea>
                                                </div>
                                                <div class='row span-two'>
                                                    <textarea class='' title='@{description}' name='attr_description' placeholder='Description'></textarea>
                                                </div>
                                                <div class='row span-two'>
                                                    <input readonly=true class='id-label' title='@{id}' name='attr_id'></input>
                                                </div>
                                            </div>
                                            <div class='display'>
                                                <div class='button-description'>
                                                    <input class='label' title='@{name}' name='attr_name' placeholder='Operative'>
                                                    <input class='label' name='attr_school' placeholder='Abjuration'>
                                                    <button class='npcsummary' type='roll' title='%{roll}' name='roll_roll' value='@{whisper_state}&{template:sf_spell} {{name=@{character_name}}} {{characterid=@{character_id}}} {{rightbanner=@{school}}} {{title=@{name}}} {{leftbanner=^{level} [[[[@{level}]]d1cs>2cf>2]]}} {{saveflag=[[1d@{save_checkbox}]]}} {{srflag=@{spell_resistance}}} {{srroll=[[1d20+@{caster_level}@{spell_penetration_misc}]]}} {{activation=@{usage}}} {{duration=@{duration}}} {{targets=@{target}}} {{range=@{range}}} {{savedc=@{dc}}} {{savetype=@{save_type}}} {{effect=@{effect}}} {{saveeffect=@{save_effect}}} {{attackflag=[[1d@{attack_checkbox}]]}}{{fullattack=[[@{full_attack_query}*(@{full_attack_number})]]}} {{r1=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+[[@{full_attack_query}*(@{full_attack_penalty})]][FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage1type=@{attack_type}}} {{damage1=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit1damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit1effect=@{attack_crit}}}  {{r2=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage2type=@{attack_type}}} {{damage2=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit2damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit2effect=@{attack_crit}}} {{r3=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage3type=@{attack_type}}} {{damage3=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit3damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit3effect=@{attack_crit}}} {{r4=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage4type=@{attack_type}}} {{damage4=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit4damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit4effect=@{attack_crit}}} {{r5=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage5type=@{attack_type}}} {{damage5=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit5damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit5effect=@{attack_crit}}} {{rightbanner=@{school}}}{{notes=@{description}}} @{attacher}'></button>
                                                    <label class='expand-button'><input hidden='true' class='expand-description' type='checkbox' name='attr_expand_description' value='1'><span class='collapsed pictos'>`</span><span class='expanded pictos'>J</span></label>
                                                </div>
                                                <input class='expand-description' type='hidden' name='attr_expand_description'>
                                                <textarea class='description' title='@{description}' name='attr_description' placeholder='Description'></textarea>
                                            </div>
                                        </div>
                                    </fieldset>
                                    <label class='pseudo-repcontrol spell'>
                                        <input type='checkbox' title='@{create_2nd}' name='attr_create_2nd' value='1'>
                                        <span>&</span>
                                    </label>
                                </div>
                            </div>
                            <div class='section-container aspell4 class-spells-day'>
                                <div class='section'>
                                    <h1 class='label' data-i18n='4th-level'>4th LEVEL</h1>  
                                </div>
                                <div class='section-container'>
                                    <div class='button-description'>
                                        <span class='label' data-i18n='name'>NAME</span>
                                        <span class='label' data-i18n='school'>SCHOOL</span>
                                    </div>
                                    <fieldset class='repeating_spell'><input hidden='true' type='text' title='@{attack_total}' name='attr_attack_total'><input hidden='true' type='text' title='@{damage_total}' name='attr_damage_total'>
                                        <input class='filter' type='hidden' title='@{filter}' name='attr_filter'>
                                        <div class='filter-container spell fourth'>
                                            <input type='text' hidden='true' title='@{attack_misc}' name='attr_attack_misc' value=''>
                                            <input type='text' hidden='true' title='@{effect_misc}' name='attr_effect_misc' value=''>
                                            <input class="show-options" type="checkbox" title='@{show_options}' name="attr_show_options" checked="checked"><span>y</span>
                                            <div class='row-options'>
                                                <div class='row span-two display-margin'>
                                                    <span class='label' data-i18n='name-u'>NAME</span>
                                                    <input class='atk-name scalable-input input-field' type='text' title='@{name}' name='attr_name' placeholder="Operative's Edge">
                                                    <span class='label' data-i18n='lvl'>LVL</span>
                                                    <input class='atk-level' title='@{level}' name='attr_level' type='text' value=''>
                                                </div>
                                                <div class='row'>
                                                    <span class='label' data-i18n='source'>SOURCE</span>
                                                    <input class='scalable-input input-field' type='text' title='@{source}' name='attr_source' placeholder='Operative'>
                                                </div>
                                                <div class='row'>
                                                    <span class='label' data-i18n='school'>SCHOOL</span>
                                                    <input class='scalable-input input-field' title='@{school}' name='attr_school' type='text' placeholder='abjuration'>
                                                </div>
                                                <div class='row span-two'>
                                                    <span class='label' data-i18n='target'>TARGET</span>
                                                    <input class='scalable-input input-field' type='text' title='@{target}' name='attr_target' placeholder='self'>
                                                    <span class='label' data-i18n='rng'>RNG</span>
                                                    <input class='scalable-input input-field' type='text' title='@{range}' name='attr_range' placeholder='30 ft'>
                                                </div>
                                                <div class='row'>
                                                    <span class='label' data-i18n='duration'>DURATION</span>
                                                    <input class='scalable-input input-field' type='text' title='@{duration}' name='attr_duration' placeholder='1 round' value=''>
                                                </div>
                                                <div class='row'>
                                                    <span class='label abi-cost' data-i18n='usage'>USAGE</span>
                                                    <input class='scalable-input input-field' type='text' title='@{usage}' name='attr_usage' placeholder='Standard Action'>
                                                </div>
                                                <div class='row'>
                                                <span class='label' data-i18n='spell-resistance-abbrv'>SR</span>
                                                <input type='hidden' name='attr_spell_penetration_misc' value=''><select name='attr_spell_resistance'>
                                                <option value='' data-i18n='no' selected>NO</option>
                                                <option value='yes' data-i18n='yes'>YES</option>
                                                </select>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab atk-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'><span class='field label' data-i18n='atk'>ATK</span></label>
                                                <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                                    <div class='field row span-two'>
                                                        <select class='label atk-ability abi' title='@{attack_ability}' name='attr_attack_ability'>
                                                            <option value='@{strength_mod}' data-i18n='str' selected>STR</option>
                                                            <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                                        </select>
                                                        <input hidden='true' title='@{attack_ability}' name='attr_attack_ability' value='0'>
                                                        <span class='arith'>+</span>
                                                        <input class='bab' title='@{base_attack_bonus}' name='attr_base_attack_bonus' readonly='true' value='0'>
                                                        <input class='abi-misc' type='text' title='@{attack_bonus}' name='attr_attack_bonus' placeholder='+@{attr}/2 + ?{Query}'>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab dmg-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'><span class='field label' data-i18n='dmg'>DMG</span></label>
                                                <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                                    <input hidden='true' title='@{damage_misc}' name='attr_damage_misc' value=''>
                                                    <div class='field row span-two'>
                                                        <input class='abi-dmg-dice' type='text' name=attr_damage_dice placeholder='1d8'><span>+</span>
                                                        <select class='label atk-ability abi' title='@{damage_ability}' name='attr_damage_ability'>
                                                            <option value='' selected data-i18n='n/a'>N/A</option>
                                                            <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                                            <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                                        </select>
                                                        <input hidden='true' title='@{damage_ability}' name='attr_damage_ability' value='0'>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <span class='label' data-i18n='type'>TYPE</span>
                                                        <input class='scalable-input input-field' type='text' title='@{attack_type}' name='attr_attack_type' placeholder='Fire'>
                                                        <span class='label' data-i18n='crit-effect'>CRIT EFFECT</span>
                                                        <input class='scalable-input input-field' type='text' title='@{attack_crit}' name='attr_attack_crit' placeholder='Burn'>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'><span class='label field' data-i18n='additional-attack'>ADDITIONAL ATTACKS</span></label>
                                                <input class='field-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab macro-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                                    <div class='field row span-two'>
                                                        <span data-i18n='roll-full-attack_'>ROLL FULL ATTACK: </span>
                                                        <label class='scalable-input'><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='?{Full Attack|No,0|Yes,1}'><span class='label'  data-i18n='query'>QUERY</span></label>
                                                        <label class='scalable-input'><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='1'><span class='label' data-i18n='always'>ALWAYS</span></label>
                                                        <label class='scalable-input'><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='0' checked='checked'><span class='label'  data-i18n='never'>NEVER</span></label>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <span class='label' data-i18n='number-of-attacks:'>NUMBER OF ATTACKS:</span>
                                                        <input class='scalable-input attack-num' type='text' title='@{full_attack_number}' name='attr_full_attack_number' value='2'>
                                                        <span class='label' data-i8n='full-attack-penalty:'>ATTACK PENALTY:</span>
                                                        <input class='scalable-input attack-num' type='text' title='@{full_attack_penalty}' name='attr_full_attack_penalty' value='-4'>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab save-effect-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'><span class='field label' data-i18n='save-effect'>SAVE EFFECT</span></label>
                                                <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                                    <div class='field row span-two'>
                                                        <select class='label atk-ability abi' title='@{save_ability}' name='attr_save_ability'>
                                                            <option value='@{strength_mod}' data-i18n='str' selected>STR</option>
                                                            <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                                        </select>
                                                        <span class='label' data-i18n='based-dc_'>Based DC </span>
                                                        <input class='mod-buff' type='hidden' name='attr_dc_change' value='0'>
                                                        <input title='@{dc}' name='attr_dc' type='number' value='10' hidden='true'>
                                                        <span class='save-dc modified-attr label' title='@{dc}' name='attr_dc' value='10'>10</span>
                                                        <select class='label save-type' title='@{save_type}' name='attr_save_type'>
                                                            <option value='' selected>-</option>
                                                            <option value='FORT' data-i18n='fort-save'>FORT SAVE</option>
                                                            <option value='REF' data-i18n='ref-save'>REF SAVE</option>
                                                            <option value='WILL' data-i18n='will-save'>WILL SAVE</option>
                                                        </select>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <textarea class='' title='@{effect}' name='attr_effect' placeholder='Effect on a Failed Save'></textarea>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <span class='label' data-i18n='A-Sucessful-Save:'>A Sucessful Save:</span>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <textarea class='' title='@{save_effect}' name='attr_save_effect' placeholder='Effect on a Successful Save'></textarea>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'><span class='label field' data-i18n='attacher'>ATTACHER</span></label>
                                                <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                                <div class='row field-container mod-container expandable'>
                                                    <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                                    <textarea class='field row' type='text' title='@{attacher}' name='attr_attacher'></textarea>
                                                </div>
                                                <div class='row span-two'>
                                                    <textarea class='' title='@{description}' name='attr_description' placeholder='Description'></textarea>
                                                </div>
                                                <div class='row span-two'>
                                                    <input readonly=true class='id-label' title='@{id}' name='attr_id'></input>
                                                </div>
                                            </div>
                                            <div class='display'>
                                                <div class='button-description'>
                                                    <input class='label' title='@{name}' name='attr_name' placeholder='Operative'>
                                                    <input class='label' name='attr_school' placeholder='Abjuration'>
                                                    <button class='npcsummary' type='roll' title='%{roll}' name='roll_roll' value='@{whisper_state}&{template:sf_spell} {{name=@{character_name}}} {{characterid=@{character_id}}} {{rightbanner=@{school}}} {{title=@{name}}} {{leftbanner=^{level} [[[[@{level}]]d1cs>2cf>2]]}} {{saveflag=[[1d@{save_checkbox}]]}} {{srflag=@{spell_resistance}}} {{srroll=[[1d20+@{caster_level}@{spell_penetration_misc}]]}} {{activation=@{usage}}} {{duration=@{duration}}} {{targets=@{target}}} {{range=@{range}}} {{savedc=@{dc}}} {{savetype=@{save_type}}} {{effect=@{effect}}} {{saveeffect=@{save_effect}}} {{attackflag=[[1d@{attack_checkbox}]]}}{{fullattack=[[@{full_attack_query}*(@{full_attack_number})]]}} {{r1=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+[[@{full_attack_query}*(@{full_attack_penalty})]][FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage1type=@{attack_type}}} {{damage1=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit1damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit1effect=@{attack_crit}}}  {{r2=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage2type=@{attack_type}}} {{damage2=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit2damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit2effect=@{attack_crit}}} {{r3=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage3type=@{attack_type}}} {{damage3=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit3damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit3effect=@{attack_crit}}} {{r4=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage4type=@{attack_type}}} {{damage4=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit4damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit4effect=@{attack_crit}}} {{r5=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage5type=@{attack_type}}} {{damage5=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit5damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit5effect=@{attack_crit}}} {{rightbanner=@{school}}}{{notes=@{description}}} @{attacher}'></button>
                                                    <label class='expand-button'><input hidden='true' class='expand-description' type='checkbox' name='attr_expand_description' value='1'><span class='collapsed pictos'>`</span><span class='expanded pictos'>J</span></label>
                                                </div>
                                                <input class='expand-description' type='hidden' name='attr_expand_description'>
                                                <textarea class='description' title='@{description}' name='attr_description' placeholder='Description'></textarea>
                                            </div>
                                        </div>
                                    </fieldset>
                                    <label class='pseudo-repcontrol spell'>
                                        <input type='checkbox' title='@{create_4th}' name='attr_create_4th' value='1'>
                                        <span>&</span>
                                    </label>
                                </div>
                            </div>
                            <div class='section-container aspell6 class-spells-day'>
                                <div class='section'>
                                    <h1 class='label' data-i18n='6th-level'>6th LEVEL</h1>
                                </div>
                                <div class='section-container'>
                                    <div class='button-description'>
                                        <span class='label' data-i18n='name'>NAME</span>
                                        <span class='label' data-i18n='school'>SCHOOL</span>
                                    </div>
                                    <fieldset class='repeating_spell'><input hidden='true' type='text' title='@{attack_total}' name='attr_attack_total'><input hidden='true' type='text' title='@{damage_total}' name='attr_damage_total'>
                                            <input class='filter' type='hidden' title='@{filter}' name='attr_filter'>
                                            <div class='filter-container spell sixth'>
                                                <input type='text' hidden='true' title='@{attack_misc}' name='attr_attack_misc' value=''>
                                                <input type='text' hidden='true' title='@{effect_misc}' name='attr_effect_misc' value=''>
                                                <input class="show-options" type="checkbox" title='@{show_options}' name="attr_show_options" checked="checked"><span>y</span>
                                                <div class='row-options'>
                                                <div class='row span-two display-margin'>
                                                    <span class='label' data-i18n='name-u'>NAME</span>
                                                    <input class='atk-name scalable-input input-field' type='text' title='@{name}' name='attr_name' placeholder="Operative's Edge">
                                                    <span class='label' data-i18n='lvl'>LVL</span>
                                                    <input class='atk-level' title='@{level}' name='attr_level' type='text' value=''>
                                                </div>
                                                <div class='row'>
                                                    <span class='label' data-i18n='source'>SOURCE</span>
                                                    <input class='scalable-input input-field' type='text' title='@{source}' name='attr_source' placeholder='Operative'>
                                                </div>
                                                <div class='row'>
                                                    <span class='label' data-i18n='school'>SCHOOL</span>
                                                    <input class='scalable-input input-field' title='@{school}' name='attr_school' type='text' placeholder='abjuration'>
                                                </div>
                                                <div class='row span-two'>
                                                    <span class='label' data-i18n='target'>TARGET</span>
                                                    <input class='scalable-input input-field' type='text' title='@{target}' name='attr_target' placeholder='self'>
                                                    <span class='label' data-i18n='rng'>RNG</span>
                                                    <input class='scalable-input input-field' type='text' title='@{range}' name='attr_range' placeholder='30 ft'>
                                                </div>
                                                <div class='row'>
                                                    <span class='label' data-i18n='duration'>DURATION</span>
                                                    <input class='scalable-input input-field' type='text' title='@{duration}' name='attr_duration' placeholder='1 round' value=''>
                                                </div>
                                                <div class='row'>
                                                    <span class='label abi-cost' data-i18n='usage'>USAGE</span>
                                                    <input class='scalable-input input-field' type='text' title='@{usage}' name='attr_usage' placeholder='Standard Action'>
                                                </div>
                                                <div class='row'>
                                                <span class='label' data-i18n='spell-resistance-abbrv'>SR</span>
                                                <input type='hidden' name='attr_spell_penetration_misc' value=''><select name='attr_spell_resistance'>
                                                <option value='' data-i18n='no' selected>NO</option>
                                                <option value='yes' data-i18n='yes'>YES</option>
                                                </select>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab atk-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'><span class='field label' data-i18n='atk'>ATK</span></label>
                                                <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                                    <div class='field row span-two'>
                                                        <select class='label atk-ability abi' title='@{attack_ability}' name='attr_attack_ability'>
                                                            <option value='@{strength_mod}' data-i18n='str' selected>STR</option>
                                                            <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                                        </select>
                                                        <input hidden='true' title='@{attack_ability}' name='attr_attack_ability' value='0'>
                                                        <span class='arith'>+</span>
                                                        <input class='bab' title='@{base_attack_bonus}' name='attr_base_attack_bonus' readonly='true' value='0'>
                                                        <input class='abi-misc' type='text' title='@{attack_bonus}' name='attr_attack_bonus' placeholder='+@{attr}/2 + ?{Query}'>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab dmg-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'><span class='field label' data-i18n='dmg'>DMG</span></label>
                                                <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                                    <input hidden='true' title='@{damage_misc}' name='attr_damage_misc' value=''>
                                                    <div class='field row span-two'>
                                                        <input class='abi-dmg-dice' type='text' name=attr_damage_dice placeholder='1d8'><span>+</span>
                                                        <select class='label atk-ability abi' title='@{damage_ability}' name='attr_damage_ability'>
                                                            <option value='' selected data-i18n='n/a'>N/A</option>
                                                            <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                                            <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                                        </select>
                                                        <input hidden='true' title='@{damage_ability}' name='attr_damage_ability' value='0'>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <span class='label' data-i18n='type'>TYPE</span>
                                                        <input class='scalable-input input-field' type='text' title='@{attack_type}' name='attr_attack_type' placeholder='Fire'>
                                                        <span class='label' data-i18n='crit-effect'>CRIT EFFECT</span>
                                                        <input class='scalable-input input-field' type='text' title='@{attack_crit}' name='attr_attack_crit' placeholder='Burn'>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'><span class='label field' data-i18n='additional-attack'>ADDITIONAL ATTACKS</span></label>
                                                <input class='field-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab macro-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                                    <div class='field row span-two'>
                                                        <span data-i18n='roll-full-attack_'>ROLL FULL ATTACK: </span>
                                                        <label class='scalable-input'><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='?{Full Attack|No,0|Yes,1}'><span class='label'  data-i18n='query'>QUERY</span></label>
                                                        <label class='scalable-input'><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='1'><span class='label' data-i18n='always'>ALWAYS</span></label>
                                                        <label class='scalable-input'><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='0' checked='checked'><span class='label'  data-i18n='never'>NEVER</span></label>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <span class='label' data-i18n='number-of-attacks:'>NUMBER OF ATTACKS:</span>
                                                        <input class='scalable-input attack-num' type='text' title='@{full_attack_number}' name='attr_full_attack_number' value='2'>
                                                        <span class='label' data-i8n='full-attack-penalty:'>ATTACK PENALTY:</span>
                                                        <input class='scalable-input attack-num' type='text' title='@{full_attack_penalty}' name='attr_full_attack_penalty' value='-4'>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab save-effect-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'><span class='field label' data-i18n='save-effect'>SAVE EFFECT</span></label>
                                                <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                                    <div class='field row span-two'>
                                                        <select class='label atk-ability abi' title='@{save_ability}' name='attr_save_ability'>
                                                            <option value='@{strength_mod}' data-i18n='str' selected>STR</option>
                                                            <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                                        </select>
                                                        <span class='label' data-i18n='based-dc_'>Based DC </span>
                                                        <input class='mod-buff' type='hidden' name='attr_dc_change' value='0'>
                                                        <input title='@{dc}' name='attr_dc' type='number' value='10' hidden='true'>
                                                        <span class='save-dc modified-attr label' title='@{dc}' name='attr_dc' value='10'>10</span>
                                                        <select class='label save-type' title='@{save_type}' name='attr_save_type'>
                                                            <option value='' selected>-</option>
                                                            <option value='FORT' data-i18n='fort-save'>FORT SAVE</option>
                                                            <option value='REF' data-i18n='ref-save'>REF SAVE</option>
                                                            <option value='WILL' data-i18n='will-save'>WILL SAVE</option>
                                                        </select>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <textarea class='' title='@{effect}' name='attr_effect' placeholder='Effect on a Failed Save'></textarea>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <span class='label' data-i18n='A-Sucessful-Save:'>A Sucessful Save:</span>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <textarea class='' title='@{save_effect}' name='attr_save_effect' placeholder='Effect on a Successful Save'></textarea>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'><span class='label field' data-i18n='attacher'>ATTACHER</span></label>
                                                <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                                <div class='row field-container mod-container expandable'>
                                                    <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                                    <textarea class='field row' type='text' title='@{attacher}' name='attr_attacher'></textarea>
                                                </div>
                                                <div class='row span-two'>
                                                    <textarea class='' title='@{description}' name='attr_description' placeholder='Description'></textarea>
                                                </div>
                                                <div class='row span-two'>
                                                    <input readonly=true class='id-label' title='@{id}' name='attr_id'></input>
                                                </div>
                                            </div>
                                            <div class='display'>
                                                <div class='button-description'>
                                                    <input class='label' title='@{name}' name='attr_name' placeholder='Operative'>
                                                    <input class='label' name='attr_school' placeholder='Abjuration'>
                                                    <button class='npcsummary' type='roll' title='%{roll}' name='roll_roll' value='@{whisper_state}&{template:sf_spell} {{name=@{character_name}}} {{characterid=@{character_id}}} {{rightbanner=@{school}}} {{title=@{name}}} {{leftbanner=^{level} [[[[@{level}]]d1cs>2cf>2]]}} {{saveflag=[[1d@{save_checkbox}]]}} {{srflag=@{spell_resistance}}} {{srroll=[[1d20+@{caster_level}@{spell_penetration_misc}]]}} {{activation=@{usage}}} {{duration=@{duration}}} {{targets=@{target}}} {{range=@{range}}} {{savedc=@{dc}}} {{savetype=@{save_type}}} {{effect=@{effect}}} {{saveeffect=@{save_effect}}} {{attackflag=[[1d@{attack_checkbox}]]}}{{fullattack=[[@{full_attack_query}*(@{full_attack_number})]]}} {{r1=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+[[@{full_attack_query}*(@{full_attack_penalty})]][FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage1type=@{attack_type}}} {{damage1=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit1damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit1effect=@{attack_crit}}}  {{r2=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage2type=@{attack_type}}} {{damage2=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit2damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit2effect=@{attack_crit}}} {{r3=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage3type=@{attack_type}}} {{damage3=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit3damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit3effect=@{attack_crit}}} {{r4=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage4type=@{attack_type}}} {{damage4=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit4damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit4effect=@{attack_crit}}} {{r5=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage5type=@{attack_type}}} {{damage5=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit5damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit5effect=@{attack_crit}}} {{rightbanner=@{school}}}{{notes=@{description}}} @{attacher}'></button>
                                                    <label class='expand-button'><input hidden='true' class='expand-description' type='checkbox' name='attr_expand_description' value='1'><span class='collapsed pictos'>`</span><span class='expanded pictos'>J</span></label>
                                                </div>
                                                <input class='expand-description' type='hidden' name='attr_expand_description'>
                                                <textarea class='description' title='@{description}' name='attr_description' placeholder='Description'></textarea>
                                            </div>
                                            </div>
                                        </fieldset>
                                    <label class='pseudo-repcontrol spell'>
                                        <input type='checkbox' title='@{create_6th}' name='attr_create_6th' value='1'>
                                        <span>&</span>
                                    </label>
                                </div>
                            </div>
                            <div class='section-container aspell8 class-spells-day'>
                                <div class='section'>
                                    <h1 class='label' data-i18n='8th-level'>8th LEVEL</h1>
                                </div>
                                <div class='section-container'>
                                    <div class='button-description'>
                                        <span class='label' data-i18n='name'>NAME</span>
                                        <span class='label' data-i18n='school'>SCHOOL</span>
                                    </div>
                                    <fieldset class='repeating_spell'><input hidden='true' type='text' title='@{attack_total}' name='attr_attack_total'><input hidden='true' type='text' title='@{damage_total}' name='attr_damage_total'>
                                        <input class='filter' type='hidden' title='@{filter}' name='attr_filter'>
                                        <div class='filter-container spell eighth'>
                                            <input type='text' hidden='true' title='@{attack_misc}' name='attr_attack_misc' value=''>
                                            <input type='text' hidden='true' title='@{effect_misc}' name='attr_effect_misc' value=''>
                                            <input class="show-options" type="checkbox" title='@{show_options}' name="attr_show_options" checked="checked"><span>y</span>
                                            <div class='row-options'>
                                                <div class='row span-two display-margin'>
                                                    <span class='label' data-i18n='name-u'>NAME</span>
                                                    <input class='atk-name scalable-input input-field' type='text' title='@{name}' name='attr_name' placeholder="Operative's Edge">
                                                    <span class='label' data-i18n='lvl'>LVL</span>
                                                    <input class='atk-level' title='@{level}' name='attr_level' type='text' value=''>
                                                </div>
                                                <div class='row'>
                                                    <span class='label' data-i18n='source'>SOURCE</span>
                                                    <input class='scalable-input input-field' type='text' title='@{source}' name='attr_source' placeholder='Operative'>
                                                </div>
                                                <div class='row'>
                                                    <span class='label' data-i18n='school'>SCHOOL</span>
                                                    <input class='scalable-input input-field' title='@{school}' name='attr_school' type='text' placeholder='abjuration'>
                                                </div>
                                                <div class='row span-two'>
                                                    <span class='label' data-i18n='target'>TARGET</span>
                                                    <input class='scalable-input input-field' type='text' title='@{target}' name='attr_target' placeholder='self'>
                                                    <span class='label' data-i18n='rng'>RNG</span>
                                                    <input class='scalable-input input-field' type='text' title='@{range}' name='attr_range' placeholder='30 ft'>
                                                </div>
                                                <div class='row'>
                                                    <span class='label' data-i18n='duration'>DURATION</span>
                                                    <input class='scalable-input input-field' type='text' title='@{duration}' name='attr_duration' placeholder='1 round' value=''>
                                                </div>
                                                <div class='row'>
                                                    <span class='label abi-cost' data-i18n='usage'>USAGE</span>
                                                    <input class='scalable-input input-field' type='text' title='@{usage}' name='attr_usage' placeholder='Standard Action'>
                                                </div>
                                                <div class='row'>
                                                <span class='label' data-i18n='spell-resistance-abbrv'>SR</span>
                                                <input type='hidden' name='attr_spell_penetration_misc' value=''><select name='attr_spell_resistance'>
                                                <option value='' data-i18n='no' selected>NO</option>
                                                <option value='yes' data-i18n='yes'>YES</option>
                                                </select>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab atk-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'><span class='field label' data-i18n='atk'>ATK</span></label>
                                                <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                                    <div class='field row span-two'>
                                                        <select class='label atk-ability abi' title='@{attack_ability}' name='attr_attack_ability'>
                                                            <option value='@{strength_mod}' data-i18n='str' selected>STR</option>
                                                            <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                                        </select>
                                                        <input hidden='true' title='@{attack_ability}' name='attr_attack_ability' value='0'>
                                                        <span class='arith'>+</span>
                                                        <input class='bab' title='@{base_attack_bonus}' name='attr_base_attack_bonus' readonly='true' value='0'>
                                                        <input class='abi-misc' type='text' title='@{attack_bonus}' name='attr_attack_bonus' placeholder='+@{attr}/2 + ?{Query}'>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab dmg-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'><span class='field label' data-i18n='dmg'>DMG</span></label>
                                                <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                                    <input hidden='true' title='@{damage_misc}' name='attr_damage_misc' value=''>
                                                    <div class='field row span-two'>
                                                        <input class='abi-dmg-dice' type='text' name=attr_damage_dice placeholder='1d8'><span>+</span>
                                                        <select class='label atk-ability abi' title='@{damage_ability}' name='attr_damage_ability'>
                                                            <option value='' selected data-i18n='n/a'>N/A</option>
                                                            <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                                            <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                                        </select>
                                                        <input hidden='true' title='@{damage_ability}' name='attr_damage_ability' value='0'>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <span class='label' data-i18n='type'>TYPE</span>
                                                        <input class='scalable-input input-field' type='text' title='@{attack_type}' name='attr_attack_type' placeholder='Fire'>
                                                        <span class='label' data-i18n='crit-effect'>CRIT EFFECT</span>
                                                        <input class='scalable-input input-field' type='text' title='@{attack_crit}' name='attr_attack_crit' placeholder='Burn'>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'><span class='label field' data-i18n='additional-attack'>ADDITIONAL ATTACKS</span></label>
                                                <input class='field-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab macro-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                                    <div class='field row span-two'>
                                                        <span data-i18n='roll-full-attack_'>ROLL FULL ATTACK: </span>
                                                        <label class='scalable-input'><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='?{Full Attack|No,0|Yes,1}'><span class='label'  data-i18n='query'>QUERY</span></label>
                                                        <label class='scalable-input'><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='1'><span class='label' data-i18n='always'>ALWAYS</span></label>
                                                        <label class='scalable-input'><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='0' checked='checked'><span class='label'  data-i18n='never'>NEVER</span></label>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <span class='label' data-i18n='number-of-attacks:'>NUMBER OF ATTACKS:</span>
                                                        <input class='scalable-input attack-num' type='text' title='@{full_attack_number}' name='attr_full_attack_number' value='2'>
                                                        <span class='label' data-i8n='full-attack-penalty:'>ATTACK PENALTY:</span>
                                                        <input class='scalable-input attack-num' type='text' title='@{full_attack_penalty}' name='attr_full_attack_penalty' value='-4'>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab save-effect-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'><span class='field label' data-i18n='save-effect'>SAVE EFFECT</span></label>
                                                <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                                    <div class='field row span-two'>
                                                        <select class='label atk-ability abi' title='@{save_ability}' name='attr_save_ability'>
                                                            <option value='@{strength_mod}' data-i18n='str' selected>STR</option>
                                                            <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                                        </select>
                                                        <span class='label' data-i18n='based-dc_'>Based DC </span>
                                                        <input class='mod-buff' type='hidden' name='attr_dc_change' value='0'>
                                                        <input title='@{dc}' name='attr_dc' type='number' value='10' hidden='true'>
                                                        <span class='save-dc modified-attr label' title='@{dc}' name='attr_dc' value='10'>10</span>
                                                        <select class='label save-type' title='@{save_type}' name='attr_save_type'>
                                                            <option value='' selected>-</option>
                                                            <option value='FORT' data-i18n='fort-save'>FORT SAVE</option>
                                                            <option value='REF' data-i18n='ref-save'>REF SAVE</option>
                                                            <option value='WILL' data-i18n='will-save'>WILL SAVE</option>
                                                        </select>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <textarea class='' title='@{effect}' name='attr_effect' placeholder='Effect on a Failed Save'></textarea>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <span class='label' data-i18n='A-Sucessful-Save:'>A Sucessful Save:</span>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <textarea class='' title='@{save_effect}' name='attr_save_effect' placeholder='Effect on a Successful Save'></textarea>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'><span class='label field' data-i18n='attacher'>ATTACHER</span></label>
                                                <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                                <div class='row field-container mod-container expandable'>
                                                    <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                                    <textarea class='field row' type='text' title='@{attacher}' name='attr_attacher'></textarea>
                                                </div>
                                                <div class='row span-two'>
                                                    <textarea class='' title='@{description}' name='attr_description' placeholder='Description'></textarea>
                                                </div>
                                                <div class='row span-two'>
                                                    <input readonly=true class='id-label' title='@{id}' name='attr_id'></input>
                                                </div>
                                            </div>
                                            <div class='display'>
                                                <div class='button-description'>
                                                    <input class='label' title='@{name}' name='attr_name' placeholder='Operative'>
                                                    <input class='label' name='attr_school' placeholder='Abjuration'>
                                                    <button class='npcsummary' type='roll' title='%{roll}' name='roll_roll' value='@{whisper_state}&{template:sf_spell} {{name=@{character_name}}} {{characterid=@{character_id}}} {{rightbanner=@{school}}} {{title=@{name}}} {{leftbanner=^{level} [[[[@{level}]]d1cs>2cf>2]]}} {{saveflag=[[1d@{save_checkbox}]]}} {{srflag=@{spell_resistance}}} {{srroll=[[1d20+@{caster_level}@{spell_penetration_misc}]]}} {{activation=@{usage}}} {{duration=@{duration}}} {{targets=@{target}}} {{range=@{range}}} {{savedc=@{dc}}} {{savetype=@{save_type}}} {{effect=@{effect}}} {{saveeffect=@{save_effect}}} {{attackflag=[[1d@{attack_checkbox}]]}}{{fullattack=[[@{full_attack_query}*(@{full_attack_number})]]}} {{r1=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+[[@{full_attack_query}*(@{full_attack_penalty})]][FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage1type=@{attack_type}}} {{damage1=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit1damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit1effect=@{attack_crit}}}  {{r2=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage2type=@{attack_type}}} {{damage2=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit2damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit2effect=@{attack_crit}}} {{r3=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage3type=@{attack_type}}} {{damage3=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit3damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit3effect=@{attack_crit}}} {{r4=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage4type=@{attack_type}}} {{damage4=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit4damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit4effect=@{attack_crit}}} {{r5=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage5type=@{attack_type}}} {{damage5=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit5damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit5effect=@{attack_crit}}} {{rightbanner=@{school}}}{{notes=@{description}}} @{attacher}'></button>
                                                    <label class='expand-button'><input hidden='true' class='expand-description' type='checkbox' name='attr_expand_description' value='1'><span class='collapsed pictos'>`</span><span class='expanded pictos'>J</span></label>
                                                </div>
                                                <input class='expand-description' type='hidden' name='attr_expand_description'>
                                                <textarea class='description' title='@{description}' name='attr_description' placeholder='Description'></textarea>
                                            </div>
                                        </div>
                                    </fieldset>
                                    <label class='pseudo-repcontrol spell'>
                                        <input type='checkbox' title='@{create_8th}' name='attr_create_8th' value='1'>
                                        <span>&</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div class='spell-column'>
                            <input type='hidden' class='spell-levels-display' title='@{char_max_spell}' name='attr_char_max_spell'>
                            <div class='section-container aspell1 class-spells-day'>
                                <div class='section'>
                                    <h1 class='label' data-i18n='1st-level'>1st LEVEL</h1>
                                </div>
                                <div class='section-container'>
                                    <div class='button-description'>
                                        <span class='label' data-i18n='name'>NAME</span>
                                        <span class='label' data-i18n='school'>SCHOOL</span>
                                    </div>
                                    <fieldset class='repeating_spell'><input hidden='true' type='text' title='@{attack_total}' name='attr_attack_total'><input hidden='true' type='text' title='@{damage_total}' name='attr_damage_total'>
                                        <input class='filter' type='hidden' title='@{filter}' name='attr_filter'>
                                        <div class='filter-container spell first'>
                                            <input type='text' hidden='true' title='@{attack_misc}' name='attr_attack_misc' value=''>
                                            <input type='text' hidden='true' title='@{effect_misc}' name='attr_effect_misc' value=''>
                                            <input class="show-options" type="checkbox" title='@{show_options}' name="attr_show_options" checked="checked"><span>y</span>
                                            <div class='row-options'>
                                                <div class='row span-two display-margin'>
                                                    <span class='label' data-i18n='name-u'>NAME</span>
                                                    <input class='atk-name scalable-input input-field' type='text' title='@{name}' name='attr_name' placeholder="Operative's Edge">
                                                    <span class='label' data-i18n='lvl'>LVL</span>
                                                    <input class='atk-level' title='@{level}' name='attr_level' type='text' value=''>
                                                </div>
                                                <div class='row'>
                                                    <span class='label' data-i18n='source'>SOURCE</span>
                                                    <input class='scalable-input input-field' type='text' title='@{source}' name='attr_source' placeholder='Operative'>
                                                </div>
                                                <div class='row'>
                                                    <span class='label' data-i18n='school'>SCHOOL</span>
                                                    <input class='scalable-input input-field' title='@{school}' name='attr_school' type='text' placeholder='abjuration'>
                                                </div>
                                                <div class='row span-two'>
                                                    <span class='label' data-i18n='target'>TARGET</span>
                                                    <input class='scalable-input input-field' type='text' title='@{target}' name='attr_target' placeholder='self'>
                                                    <span class='label' data-i18n='rng'>RNG</span>
                                                    <input class='scalable-input input-field' type='text' title='@{range}' name='attr_range' placeholder='30 ft'>
                                                </div>
                                                <div class='row'>
                                                    <span class='label' data-i18n='duration'>DURATION</span>
                                                    <input class='scalable-input input-field' type='text' title='@{duration}' name='attr_duration' placeholder='1 round' value=''>
                                                </div>
                                                <div class='row'>
                                                    <span class='label abi-cost' data-i18n='usage'>USAGE</span>
                                                    <input class='scalable-input input-field' type='text' title='@{usage}' name='attr_usage' placeholder='Standard Action'>
                                                </div>
                                                <div class='row'>
                                                <span class='label' data-i18n='spell-resistance-abbrv'>SR</span>
                                                <input type='hidden' name='attr_spell_penetration_misc' value=''><select name='attr_spell_resistance'>
                                                <option value='' data-i18n='no' selected>NO</option>
                                                <option value='yes' data-i18n='yes'>YES</option>
                                                </select>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab atk-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'><span class='field label' data-i18n='atk'>ATK</span></label>
                                                <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                                    <div class='field row span-two'>
                                                        <select class='label atk-ability abi' title='@{attack_ability}' name='attr_attack_ability'>
                                                            <option value='@{strength_mod}' data-i18n='str' selected>STR</option>
                                                            <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                                        </select>
                                                        <input hidden='true' title='@{attack_ability}' name='attr_attack_ability' value='0'>
                                                        <span class='arith'>+</span>
                                                        <input class='bab' title='@{base_attack_bonus}' name='attr_base_attack_bonus' readonly='true' value='0'>
                                                        <input class='abi-misc' type='text' title='@{attack_bonus}' name='attr_attack_bonus' placeholder='+@{attr}/2 + ?{Query}'>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab dmg-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'><span class='field label' data-i18n='dmg'>DMG</span></label>
                                                <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                                    <input hidden='true' title='@{damage_misc}' name='attr_damage_misc' value=''>
                                                    <div class='field row span-two'>
                                                        <input class='abi-dmg-dice' type='text' name=attr_damage_dice placeholder='1d8'><span>+</span>
                                                        <select class='label atk-ability abi' title='@{damage_ability}' name='attr_damage_ability'>
                                                            <option value='' selected data-i18n='n/a'>N/A</option>
                                                            <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                                            <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                                        </select>
                                                        <input hidden='true' title='@{damage_ability}' name='attr_damage_ability' value='0'>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <span class='label' data-i18n='type'>TYPE</span>
                                                        <input class='scalable-input input-field' type='text' title='@{attack_type}' name='attr_attack_type' placeholder='Fire'>
                                                        <span class='label' data-i18n='crit-effect'>CRIT EFFECT</span>
                                                        <input class='scalable-input input-field' type='text' title='@{attack_crit}' name='attr_attack_crit' placeholder='Burn'>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'><span class='label field' data-i18n='additional-attack'>ADDITIONAL ATTACKS</span></label>
                                                <input class='field-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab macro-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                                    <div class='field row span-two'>
                                                        <span data-i18n='roll-full-attack_'>ROLL FULL ATTACK: </span>
                                                        <label class='scalable-input'><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='?{Full Attack|No,0|Yes,1}'><span class='label'  data-i18n='query'>QUERY</span></label>
                                                        <label class='scalable-input'><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='1'><span class='label' data-i18n='always'>ALWAYS</span></label>
                                                        <label class='scalable-input'><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='0' checked='checked'><span class='label'  data-i18n='never'>NEVER</span></label>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <span class='label' data-i18n='number-of-attacks:'>NUMBER OF ATTACKS:</span>
                                                        <input class='scalable-input attack-num' type='text' title='@{full_attack_number}' name='attr_full_attack_number' value='2'>
                                                        <span class='label' data-i8n='full-attack-penalty:'>ATTACK PENALTY:</span>
                                                        <input class='scalable-input attack-num' type='text' title='@{full_attack_penalty}' name='attr_full_attack_penalty' value='-4'>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab save-effect-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'><span class='field label' data-i18n='save-effect'>SAVE EFFECT</span></label>
                                                <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                                    <div class='field row span-two'>
                                                        <select class='label atk-ability abi' title='@{save_ability}' name='attr_save_ability'>
                                                            <option value='@{strength_mod}' data-i18n='str' selected>STR</option>
                                                            <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                                        </select>
                                                        <span class='label' data-i18n='based-dc_'>Based DC </span>
                                                        <input class='mod-buff' type='hidden' name='attr_dc_change' value='0'>
                                                        <input title='@{dc}' name='attr_dc' type='number' value='10' hidden='true'>
                                                        <span class='save-dc modified-attr label' title='@{dc}' name='attr_dc' value='10'>10</span>
                                                        <select class='label save-type' title='@{save_type}' name='attr_save_type'>
                                                            <option value='' selected>-</option>
                                                            <option value='FORT' data-i18n='fort-save'>FORT SAVE</option>
                                                            <option value='REF' data-i18n='ref-save'>REF SAVE</option>
                                                            <option value='WILL' data-i18n='will-save'>WILL SAVE</option>
                                                        </select>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <textarea class='' title='@{effect}' name='attr_effect' placeholder='Effect on a Failed Save'></textarea>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <span class='label' data-i18n='A-Sucessful-Save:'>A Sucessful Save:</span>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <textarea class='' title='@{save_effect}' name='attr_save_effect' placeholder='Effect on a Successful Save'></textarea>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'><span class='label field' data-i18n='attacher'>ATTACHER</span></label>
                                                <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                                <div class='row field-container mod-container expandable'>
                                                    <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                                    <textarea class='field row' type='text' title='@{attacher}' name='attr_attacher'></textarea>
                                                </div>
                                                <div class='row span-two'>
                                                    <textarea class='' title='@{description}' name='attr_description' placeholder='Description'></textarea>
                                                </div>
                                                <div class='row span-two'>
                                                    <input readonly=true class='id-label' title='@{id}' name='attr_id'></input>
                                                </div>
                                            </div>
                                            <div class='display'>
                                                <div class='button-description'>
                                                    <input class='label' title='@{name}' name='attr_name' placeholder='Operative'>
                                                    <input class='label' name='attr_school' placeholder='Abjuration'>
                                                    <button class='npcsummary' type='roll' title='%{roll}' name='roll_roll' value='@{whisper_state}&{template:sf_spell} {{name=@{character_name}}} {{characterid=@{character_id}}} {{rightbanner=@{school}}} {{title=@{name}}} {{leftbanner=^{level} [[[[@{level}]]d1cs>2cf>2]]}} {{saveflag=[[1d@{save_checkbox}]]}} {{srflag=@{spell_resistance}}} {{srroll=[[1d20+@{caster_level}@{spell_penetration_misc}]]}} {{activation=@{usage}}} {{duration=@{duration}}} {{targets=@{target}}} {{range=@{range}}} {{savedc=@{dc}}} {{savetype=@{save_type}}} {{effect=@{effect}}} {{saveeffect=@{save_effect}}} {{attackflag=[[1d@{attack_checkbox}]]}}{{fullattack=[[@{full_attack_query}*(@{full_attack_number})]]}} {{r1=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+[[@{full_attack_query}*(@{full_attack_penalty})]][FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage1type=@{attack_type}}} {{damage1=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit1damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit1effect=@{attack_crit}}}  {{r2=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage2type=@{attack_type}}} {{damage2=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit2damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit2effect=@{attack_crit}}} {{r3=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage3type=@{attack_type}}} {{damage3=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit3damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit3effect=@{attack_crit}}} {{r4=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage4type=@{attack_type}}} {{damage4=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit4damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit4effect=@{attack_crit}}} {{r5=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage5type=@{attack_type}}} {{damage5=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit5damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit5effect=@{attack_crit}}} {{rightbanner=@{school}}}{{notes=@{description}}} @{attacher}'></button>
                                                    <label class='expand-button'><input hidden='true' class='expand-description' type='checkbox' name='attr_expand_description' value='1'><span class='collapsed pictos'>`</span><span class='expanded pictos'>J</span></label>
                                                </div>
                                                <input class='expand-description' type='hidden' name='attr_expand_description'>
                                                <textarea class='description' title='@{description}' name='attr_description' placeholder='Description'></textarea>
                                            </div>
                                        </div>
                                    </fieldset>
                                    <label class='pseudo-repcontrol spell'>
                                        <input type='checkbox' title='@{create_1st}' name='attr_create_1st' value='1'>
                                        <span>&</span>
                                    </label>
                                </div>
                            </div>
                            <div class='section-container aspell3 class-spells-day'>
                                <div class='section'>
                                    <h1 class='label' data-i18n='3rd-level'>3rd LEVEL</h1>
                                </div>
                                <div class='section-container'>
                                    <div class='button-description'>
                                        <span class='label' data-i18n='name'>NAME</span>
                                        <span class='label' data-i18n='school'>SCHOOL</span>
                                    </div>
                                    <fieldset class='repeating_spell'><input hidden='true' type='text' title='@{attack_total}' name='attr_attack_total'><input hidden='true' type='text' title='@{damage_total}' name='attr_damage_total'>
                                            <input class='filter' type='hidden' title='@{filter}' name='attr_filter'>
                                            <div class='filter-container spell third'>
                                                <input type='text' hidden='true' title='@{attack_misc}' name='attr_attack_misc' value=''>
                                                <input type='text' hidden='true' title='@{effect_misc}' name='attr_effect_misc' value=''>
                                                <input class="show-options" type="checkbox" title='@{show_options}' name="attr_show_options" checked="checked"><span>y</span>
                                                <div class='row-options'>
                                                <div class='row span-two display-margin'>
                                                    <span class='label' data-i18n='name-u'>NAME</span>
                                                    <input class='atk-name scalable-input input-field' type='text' title='@{name}' name='attr_name' placeholder="Operative's Edge">
                                                    <span class='label' data-i18n='lvl'>LVL</span>
                                                    <input class='atk-level' title='@{level}' name='attr_level' type='text' value=''>
                                                </div>
                                                <div class='row'>
                                                    <span class='label' data-i18n='source'>SOURCE</span>
                                                    <input class='scalable-input input-field' type='text' title='@{source}' name='attr_source' placeholder='Operative'>
                                                </div>
                                                <div class='row'>
                                                    <span class='label' data-i18n='school'>SCHOOL</span>
                                                    <input class='scalable-input input-field' title='@{school}' name='attr_school' type='text' placeholder='abjuration'>
                                                </div>
                                                <div class='row span-two'>
                                                    <span class='label' data-i18n='target'>TARGET</span>
                                                    <input class='scalable-input input-field' type='text' title='@{target}' name='attr_target' placeholder='self'>
                                                    <span class='label' data-i18n='rng'>RNG</span>
                                                    <input class='scalable-input input-field' type='text' title='@{range}' name='attr_range' placeholder='30 ft'>
                                                </div>
                                                <div class='row'>
                                                    <span class='label' data-i18n='duration'>DURATION</span>
                                                    <input class='scalable-input input-field' type='text' title='@{duration}' name='attr_duration' placeholder='1 round' value=''>
                                                </div>
                                                <div class='row'>
                                                    <span class='label abi-cost' data-i18n='usage'>USAGE</span>
                                                    <input class='scalable-input input-field' type='text' title='@{usage}' name='attr_usage' placeholder='Standard Action'>
                                                </div>
                                                <div class='row'>
                                                <span class='label' data-i18n='spell-resistance-abbrv'>SR</span>
                                                <input type='hidden' name='attr_spell_penetration_misc' value=''><select name='attr_spell_resistance'>
                                                <option value='' data-i18n='no' selected>NO</option>
                                                <option value='yes' data-i18n='yes'>YES</option>
                                                </select>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab atk-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'><span class='field label' data-i18n='atk'>ATK</span></label>
                                                <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                                    <div class='field row span-two'>
                                                        <select class='label atk-ability abi' title='@{attack_ability}' name='attr_attack_ability'>
                                                            <option value='@{strength_mod}' data-i18n='str' selected>STR</option>
                                                            <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                                        </select>
                                                        <input hidden='true' title='@{attack_ability}' name='attr_attack_ability' value='0'>
                                                        <span class='arith'>+</span>
                                                        <input class='bab' title='@{base_attack_bonus}' name='attr_base_attack_bonus' readonly='true' value='0'>
                                                        <input class='abi-misc' type='text' title='@{attack_bonus}' name='attr_attack_bonus' placeholder='+@{attr}/2 + ?{Query}'>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab dmg-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'><span class='field label' data-i18n='dmg'>DMG</span></label>
                                                <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                                    <input hidden='true' title='@{damage_misc}' name='attr_damage_misc' value=''>
                                                    <div class='field row span-two'>
                                                        <input class='abi-dmg-dice' type='text' name=attr_damage_dice placeholder='1d8'><span>+</span>
                                                        <select class='label atk-ability abi' title='@{damage_ability}' name='attr_damage_ability'>
                                                            <option value='' selected data-i18n='n/a'>N/A</option>
                                                            <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                                            <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                                        </select>
                                                        <input hidden='true' title='@{damage_ability}' name='attr_damage_ability' value='0'>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <span class='label' data-i18n='type'>TYPE</span>
                                                        <input class='scalable-input input-field' type='text' title='@{attack_type}' name='attr_attack_type' placeholder='Fire'>
                                                        <span class='label' data-i18n='crit-effect'>CRIT EFFECT</span>
                                                        <input class='scalable-input input-field' type='text' title='@{attack_crit}' name='attr_attack_crit' placeholder='Burn'>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'><span class='label field' data-i18n='additional-attack'>ADDITIONAL ATTACKS</span></label>
                                                <input class='field-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab macro-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                                    <div class='field row span-two'>
                                                        <span data-i18n='roll-full-attack_'>ROLL FULL ATTACK: </span>
                                                        <label class='scalable-input'><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='?{Full Attack|No,0|Yes,1}'><span class='label'  data-i18n='query'>QUERY</span></label>
                                                        <label class='scalable-input'><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='1'><span class='label' data-i18n='always'>ALWAYS</span></label>
                                                        <label class='scalable-input'><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='0' checked='checked'><span class='label'  data-i18n='never'>NEVER</span></label>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <span class='label' data-i18n='number-of-attacks:'>NUMBER OF ATTACKS:</span>
                                                        <input class='scalable-input attack-num' type='text' title='@{full_attack_number}' name='attr_full_attack_number' value='2'>
                                                        <span class='label' data-i8n='full-attack-penalty:'>ATTACK PENALTY:</span>
                                                        <input class='scalable-input attack-num' type='text' title='@{full_attack_penalty}' name='attr_full_attack_penalty' value='-4'>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab save-effect-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'><span class='field label' data-i18n='save-effect'>SAVE EFFECT</span></label>
                                                <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                                    <div class='field row span-two'>
                                                        <select class='label atk-ability abi' title='@{save_ability}' name='attr_save_ability'>
                                                            <option value='@{strength_mod}' data-i18n='str' selected>STR</option>
                                                            <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                                        </select>
                                                        <span class='label' data-i18n='based-dc_'>Based DC </span>
                                                        <input class='mod-buff' type='hidden' name='attr_dc_change' value='0'>
                                                        <input title='@{dc}' name='attr_dc' type='number' value='10' hidden='true'>
                                                        <span class='save-dc modified-attr label' title='@{dc}' name='attr_dc' value='10'>10</span>
                                                        <select class='label save-type' title='@{save_type}' name='attr_save_type'>
                                                            <option value='' selected>-</option>
                                                            <option value='FORT' data-i18n='fort-save'>FORT SAVE</option>
                                                            <option value='REF' data-i18n='ref-save'>REF SAVE</option>
                                                            <option value='WILL' data-i18n='will-save'>WILL SAVE</option>
                                                        </select>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <textarea class='' title='@{effect}' name='attr_effect' placeholder='Effect on a Failed Save'></textarea>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <span class='label' data-i18n='A-Sucessful-Save:'>A Sucessful Save:</span>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <textarea class='' title='@{save_effect}' name='attr_save_effect' placeholder='Effect on a Successful Save'></textarea>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'><span class='label field' data-i18n='attacher'>ATTACHER</span></label>
                                                <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                                <div class='row field-container mod-container expandable'>
                                                    <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                                    <textarea class='field row' type='text' title='@{attacher}' name='attr_attacher'></textarea>
                                                </div>
                                                <div class='row span-two'>
                                                    <textarea class='' title='@{description}' name='attr_description' placeholder='Description'></textarea>
                                                </div>
                                                <div class='row span-two'>
                                                    <input readonly=true class='id-label' title='@{id}' name='attr_id'></input>
                                                </div>
                                            </div>
                                            <div class='display'>
                                                <div class='button-description'>
                                                    <input class='label' title='@{name}' name='attr_name' placeholder='Operative'>
                                                    <input class='label' name='attr_school' placeholder='Abjuration'>
                                                    <button class='npcsummary' type='roll' title='%{roll}' name='roll_roll' value='@{whisper_state}&{template:sf_spell} {{name=@{character_name}}} {{characterid=@{character_id}}} {{rightbanner=@{school}}} {{title=@{name}}} {{leftbanner=^{level} [[[[@{level}]]d1cs>2cf>2]]}} {{saveflag=[[1d@{save_checkbox}]]}} {{srflag=@{spell_resistance}}} {{srroll=[[1d20+@{caster_level}@{spell_penetration_misc}]]}} {{activation=@{usage}}} {{duration=@{duration}}} {{targets=@{target}}} {{range=@{range}}} {{savedc=@{dc}}} {{savetype=@{save_type}}} {{effect=@{effect}}} {{saveeffect=@{save_effect}}} {{attackflag=[[1d@{attack_checkbox}]]}}{{fullattack=[[@{full_attack_query}*(@{full_attack_number})]]}} {{r1=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+[[@{full_attack_query}*(@{full_attack_penalty})]][FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage1type=@{attack_type}}} {{damage1=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit1damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit1effect=@{attack_crit}}}  {{r2=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage2type=@{attack_type}}} {{damage2=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit2damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit2effect=@{attack_crit}}} {{r3=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage3type=@{attack_type}}} {{damage3=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit3damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit3effect=@{attack_crit}}} {{r4=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage4type=@{attack_type}}} {{damage4=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit4damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit4effect=@{attack_crit}}} {{r5=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage5type=@{attack_type}}} {{damage5=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit5damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit5effect=@{attack_crit}}} {{rightbanner=@{school}}}{{notes=@{description}}} @{attacher}'></button>
                                                    <label class='expand-button'><input hidden='true' class='expand-description' type='checkbox' name='attr_expand_description' value='1'><span class='collapsed pictos'>`</span><span class='expanded pictos'>J</span></label>
                                                </div>
                                                <input class='expand-description' type='hidden' name='attr_expand_description'>
                                                <textarea class='description' title='@{description}' name='attr_description' placeholder='Description'></textarea>
                                            </div>
                                            </div>
                                        </fieldset>
                                    <label class='pseudo-repcontrol spell'>
                                        <input type='checkbox' title='@{create_3rd}' name='attr_create_3rd' value='1'>
                                        <span>&</span>
                                    </label>
                                </div>
                            </div>
                            <div class='section-container aspell5 class-spells-day'>
                                <div class='section'>
                                    <h1 class='label' data-i18n='5th-level'>5th LEVEL</h1>
                                </div>
                                <div class='section-container'>
                                    <div class='button-description'>
                                        <span class='label' data-i18n='name'>NAME</span>
                                        <span class='label' data-i18n='school'>SCHOOL</span>
                                    </div>
                                    <fieldset class='repeating_spell'><input hidden='true' type='text' title='@{attack_total}' name='attr_attack_total'><input hidden='true' type='text' title='@{damage_total}' name='attr_damage_total'>
                                        <input class='filter' type='hidden' title='@{filter}' name='attr_filter'>
                                        <div class='filter-container spell fifth'>
                                            <input type='text' hidden='true' title='@{attack_misc}' name='attr_attack_misc' value=''>
                                            <input type='text' hidden='true' title='@{effect_misc}' name='attr_effect_misc' value=''>
                                            <input class="show-options" type="checkbox" title='@{show_options}' name="attr_show_options" checked="checked"><span>y</span>
                                            <div class='row-options'>
                                                <div class='row span-two display-margin'>
                                                    <span class='label' data-i18n='name-u'>NAME</span>
                                                    <input class='atk-name scalable-input input-field' type='text' title='@{name}' name='attr_name' placeholder="Operative's Edge">
                                                    <span class='label' data-i18n='lvl'>LVL</span>
                                                    <input class='atk-level' title='@{level}' name='attr_level' type='text' value=''>
                                                </div>
                                                <div class='row'>
                                                    <span class='label' data-i18n='source'>SOURCE</span>
                                                    <input class='scalable-input input-field' type='text' title='@{source}' name='attr_source' placeholder='Operative'>
                                                </div>
                                                <div class='row'>
                                                    <span class='label' data-i18n='school'>SCHOOL</span>
                                                    <input class='scalable-input input-field' title='@{school}' name='attr_school' type='text' placeholder='abjuration'>
                                                </div>
                                                <div class='row span-two'>
                                                    <span class='label' data-i18n='target'>TARGET</span>
                                                    <input class='scalable-input input-field' type='text' title='@{target}' name='attr_target' placeholder='self'>
                                                    <span class='label' data-i18n='rng'>RNG</span>
                                                    <input class='scalable-input input-field' type='text' title='@{range}' name='attr_range' placeholder='30 ft'>
                                                </div>
                                                <div class='row'>
                                                    <span class='label' data-i18n='duration'>DURATION</span>
                                                    <input class='scalable-input input-field' type='text' title='@{duration}' name='attr_duration' placeholder='1 round' value=''>
                                                </div>
                                                <div class='row'>
                                                    <span class='label abi-cost' data-i18n='usage'>USAGE</span>
                                                    <input class='scalable-input input-field' type='text' title='@{usage}' name='attr_usage' placeholder='Standard Action'>
                                                </div>
                                                <div class='row'>
                                                <span class='label' data-i18n='spell-resistance-abbrv'>SR</span>
                                                <input type='hidden' name='attr_spell_penetration_misc' value=''><select name='attr_spell_resistance'>
                                                <option value='' data-i18n='no' selected>NO</option>
                                                <option value='yes' data-i18n='yes'>YES</option>
                                                </select>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab atk-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'><span class='field label' data-i18n='atk'>ATK</span></label>
                                                <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                                    <div class='field row span-two'>
                                                        <select class='label atk-ability abi' title='@{attack_ability}' name='attr_attack_ability'>
                                                            <option value='@{strength_mod}' data-i18n='str' selected>STR</option>
                                                            <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                                        </select>
                                                        <input hidden='true' title='@{attack_ability}' name='attr_attack_ability' value='0'>
                                                        <span class='arith'>+</span>
                                                        <input class='bab' title='@{base_attack_bonus}' name='attr_base_attack_bonus' readonly='true' value='0'>
                                                        <input class='abi-misc' type='text' title='@{attack_bonus}' name='attr_attack_bonus' placeholder='+@{attr}/2 + ?{Query}'>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab dmg-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'><span class='field label' data-i18n='dmg'>DMG</span></label>
                                                <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                                    <input hidden='true' title='@{damage_misc}' name='attr_damage_misc' value=''>
                                                    <div class='field row span-two'>
                                                        <input class='abi-dmg-dice' type='text' name=attr_damage_dice placeholder='1d8'><span>+</span>
                                                        <select class='label atk-ability abi' title='@{damage_ability}' name='attr_damage_ability'>
                                                            <option value='' selected data-i18n='n/a'>N/A</option>
                                                            <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                                            <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                                        </select>
                                                        <input hidden='true' title='@{damage_ability}' name='attr_damage_ability' value='0'>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <span class='label' data-i18n='type'>TYPE</span>
                                                        <input class='scalable-input input-field' type='text' title='@{attack_type}' name='attr_attack_type' placeholder='Fire'>
                                                        <span class='label' data-i18n='crit-effect'>CRIT EFFECT</span>
                                                        <input class='scalable-input input-field' type='text' title='@{attack_crit}' name='attr_attack_crit' placeholder='Burn'>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'><span class='label field' data-i18n='additional-attack'>ADDITIONAL ATTACKS</span></label>
                                                <input class='field-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab macro-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                                    <div class='field row span-two'>
                                                        <span data-i18n='roll-full-attack_'>ROLL FULL ATTACK: </span>
                                                        <label class='scalable-input'><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='?{Full Attack|No,0|Yes,1}'><span class='label'  data-i18n='query'>QUERY</span></label>
                                                        <label class='scalable-input'><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='1'><span class='label' data-i18n='always'>ALWAYS</span></label>
                                                        <label class='scalable-input'><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='0' checked='checked'><span class='label'  data-i18n='never'>NEVER</span></label>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <span class='label' data-i18n='number-of-attacks:'>NUMBER OF ATTACKS:</span>
                                                        <input class='scalable-input attack-num' type='text' title='@{full_attack_number}' name='attr_full_attack_number' value='2'>
                                                        <span class='label' data-i8n='full-attack-penalty:'>ATTACK PENALTY:</span>
                                                        <input class='scalable-input attack-num' type='text' title='@{full_attack_penalty}' name='attr_full_attack_penalty' value='-4'>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab save-effect-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'><span class='field label' data-i18n='save-effect'>SAVE EFFECT</span></label>
                                                <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                                    <div class='field row span-two'>
                                                        <select class='label atk-ability abi' title='@{save_ability}' name='attr_save_ability'>
                                                            <option value='@{strength_mod}' data-i18n='str' selected>STR</option>
                                                            <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                                        </select>
                                                        <span class='label' data-i18n='based-dc_'>Based DC </span>
                                                        <input class='mod-buff' type='hidden' name='attr_dc_change' value='0'>
                                                        <input title='@{dc}' name='attr_dc' type='number' value='10' hidden='true'>
                                                        <span class='save-dc modified-attr label' title='@{dc}' name='attr_dc' value='10'>10</span>
                                                        <select class='label save-type' title='@{save_type}' name='attr_save_type'>
                                                            <option value='' selected>-</option>
                                                            <option value='FORT' data-i18n='fort-save'>FORT SAVE</option>
                                                            <option value='REF' data-i18n='ref-save'>REF SAVE</option>
                                                            <option value='WILL' data-i18n='will-save'>WILL SAVE</option>
                                                        </select>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <textarea class='' title='@{effect}' name='attr_effect' placeholder='Effect on a Failed Save'></textarea>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <span class='label' data-i18n='A-Sucessful-Save:'>A Sucessful Save:</span>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <textarea class='' title='@{save_effect}' name='attr_save_effect' placeholder='Effect on a Successful Save'></textarea>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'><span class='label field' data-i18n='attacher'>ATTACHER</span></label>
                                                <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                                <div class='row field-container mod-container expandable'>
                                                    <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                                    <textarea class='field row' type='text' title='@{attacher}' name='attr_attacher'></textarea>
                                                </div>
                                                <div class='row span-two'>
                                                    <textarea class='' title='@{description}' name='attr_description' placeholder='Description'></textarea>
                                                </div>
                                                <div class='row span-two'>
                                                    <input readonly=true class='id-label' title='@{id}' name='attr_id'></input>
                                                </div>
                                            </div>
                                            <div class='display'>
                                                <div class='button-description'>
                                                    <input class='label' title='@{name}' name='attr_name' placeholder='Operative'>
                                                    <input class='label' name='attr_school' placeholder='Abjuration'>
                                                    <button class='npcsummary' type='roll' title='%{roll}' name='roll_roll' value='@{whisper_state}&{template:sf_spell} {{name=@{character_name}}} {{characterid=@{character_id}}} {{rightbanner=@{school}}} {{title=@{name}}} {{leftbanner=^{level} [[[[@{level}]]d1cs>2cf>2]]}} {{saveflag=[[1d@{save_checkbox}]]}} {{srflag=@{spell_resistance}}} {{srroll=[[1d20+@{caster_level}@{spell_penetration_misc}]]}} {{activation=@{usage}}} {{duration=@{duration}}} {{targets=@{target}}} {{range=@{range}}} {{savedc=@{dc}}} {{savetype=@{save_type}}} {{effect=@{effect}}} {{saveeffect=@{save_effect}}} {{attackflag=[[1d@{attack_checkbox}]]}}{{fullattack=[[@{full_attack_query}*(@{full_attack_number})]]}} {{r1=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+[[@{full_attack_query}*(@{full_attack_penalty})]][FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage1type=@{attack_type}}} {{damage1=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit1damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit1effect=@{attack_crit}}}  {{r2=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage2type=@{attack_type}}} {{damage2=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit2damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit2effect=@{attack_crit}}} {{r3=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage3type=@{attack_type}}} {{damage3=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit3damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit3effect=@{attack_crit}}} {{r4=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage4type=@{attack_type}}} {{damage4=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit4damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit4effect=@{attack_crit}}} {{r5=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage5type=@{attack_type}}} {{damage5=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit5damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit5effect=@{attack_crit}}} {{rightbanner=@{school}}}{{notes=@{description}}} @{attacher}'></button>
                                                    <label class='expand-button'><input hidden='true' class='expand-description' type='checkbox' name='attr_expand_description' value='1'><span class='collapsed pictos'>`</span><span class='expanded pictos'>J</span></label>
                                                </div>
                                                <input class='expand-description' type='hidden' name='attr_expand_description'>
                                                <textarea class='description' title='@{description}' name='attr_description' placeholder='Description'></textarea>
                                            </div>
                                        </div>
                                    </fieldset>
                                    <label class='pseudo-repcontrol spell'>
                                        <input type='checkbox' title='@{create_5th}' name='attr_create_5th' value='1'>
                                        <span>&</span>
                                    </label>
                                </div>
                            </div>
                            <div class='section-container aspell7 class-spells-day'>
                                <div class='section'>
                                    <h1 class='label' data-i18n='7th-level'>7th LEVEL</h1>
                                </div>
                                <div class='section-container'>
                                    <div class='button-description'>
                                        <span class='label' data-i18n='name'>NAME</span>
                                        <span class='label' data-i18n='school'>SCHOOL</span>
                                    </div>
                                    <fieldset class='repeating_spell'><input hidden='true' type='text' title='@{attack_total}' name='attr_attack_total'><input hidden='true' type='text' title='@{damage_total}' name='attr_damage_total'>
                                        <input class='filter' type='hidden' title='@{filter}' name='attr_filter'>
                                        <div class='filter-container spell seventh'>
                                            <input type='text' hidden='true' title='@{attack_misc}' name='attr_attack_misc' value=''>
                                            <input type='text' hidden='true' title='@{effect_misc}' name='attr_effect_misc' value=''>
                                            <input class="show-options" type="checkbox" title='@{show_options}' name="attr_show_options" checked="checked"><span>y</span>
                                            <div class='row-options'>
                                                <div class='row span-two display-margin'>
                                                    <span class='label' data-i18n='name-u'>NAME</span>
                                                    <input class='atk-name scalable-input input-field' type='text' title='@{name}' name='attr_name' placeholder="Operative's Edge">
                                                    <span class='label' data-i18n='lvl'>LVL</span>
                                                    <input class='atk-level' title='@{level}' name='attr_level' type='text' value=''>
                                                </div>
                                                <div class='row'>
                                                    <span class='label' data-i18n='source'>SOURCE</span>
                                                    <input class='scalable-input input-field' type='text' title='@{source}' name='attr_source' placeholder='Operative'>
                                                </div>
                                                <div class='row'>
                                                    <span class='label' data-i18n='school'>SCHOOL</span>
                                                    <input class='scalable-input input-field' title='@{school}' name='attr_school' type='text' placeholder='abjuration'>
                                                </div>
                                                <div class='row span-two'>
                                                    <span class='label' data-i18n='target'>TARGET</span>
                                                    <input class='scalable-input input-field' type='text' title='@{target}' name='attr_target' placeholder='self'>
                                                    <span class='label' data-i18n='rng'>RNG</span>
                                                    <input class='scalable-input input-field' type='text' title='@{range}' name='attr_range' placeholder='30 ft'>
                                                </div>
                                                <div class='row'>
                                                    <span class='label' data-i18n='duration'>DURATION</span>
                                                    <input class='scalable-input input-field' type='text' title='@{duration}' name='attr_duration' placeholder='1 round' value=''>
                                                </div>
                                                <div class='row'>
                                                    <span class='label abi-cost' data-i18n='usage'>USAGE</span>
                                                    <input class='scalable-input input-field' type='text' title='@{usage}' name='attr_usage' placeholder='Standard Action'>
                                                </div>
                                                <div class='row'>
                                                <span class='label' data-i18n='spell-resistance-abbrv'>SR</span>
                                                <input type='hidden' name='attr_spell_penetration_misc' value=''><select name='attr_spell_resistance'>
                                                <option value='' data-i18n='no' selected>NO</option>
                                                <option value='yes' data-i18n='yes'>YES</option>
                                                </select>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab atk-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'><span class='field label' data-i18n='atk'>ATK</span></label>
                                                <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                                    <div class='field row span-two'>
                                                        <select class='label atk-ability abi' title='@{attack_ability}' name='attr_attack_ability'>
                                                            <option value='@{strength_mod}' data-i18n='str' selected>STR</option>
                                                            <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                                        </select>
                                                        <input hidden='true' title='@{attack_ability}' name='attr_attack_ability' value='0'>
                                                        <span class='arith'>+</span>
                                                        <input class='bab' title='@{base_attack_bonus}' name='attr_base_attack_bonus' readonly='true' value='0'>
                                                        <input class='abi-misc' type='text' title='@{attack_bonus}' name='attr_attack_bonus' placeholder='+@{attr}/2 + ?{Query}'>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab dmg-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'><span class='field label' data-i18n='dmg'>DMG</span></label>
                                                <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                                    <input hidden='true' title='@{damage_misc}' name='attr_damage_misc' value=''>
                                                    <div class='field row span-two'>
                                                        <input class='abi-dmg-dice' type='text' name=attr_damage_dice placeholder='1d8'><span>+</span>
                                                        <select class='label atk-ability abi' title='@{damage_ability}' name='attr_damage_ability'>
                                                            <option value='' selected data-i18n='n/a'>N/A</option>
                                                            <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                                            <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                                        </select>
                                                        <input hidden='true' title='@{damage_ability}' name='attr_damage_ability' value='0'>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <span class='label' data-i18n='type'>TYPE</span>
                                                        <input class='scalable-input input-field' type='text' title='@{attack_type}' name='attr_attack_type' placeholder='Fire'>
                                                        <span class='label' data-i18n='crit-effect'>CRIT EFFECT</span>
                                                        <input class='scalable-input input-field' type='text' title='@{attack_crit}' name='attr_attack_crit' placeholder='Burn'>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'><span class='label field' data-i18n='additional-attack'>ADDITIONAL ATTACKS</span></label>
                                                <input class='field-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab macro-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                                    <div class='field row span-two'>
                                                        <span data-i18n='roll-full-attack_'>ROLL FULL ATTACK: </span>
                                                        <label class='scalable-input'><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='?{Full Attack|No,0|Yes,1}'><span class='label'  data-i18n='query'>QUERY</span></label>
                                                        <label class='scalable-input'><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='1'><span class='label' data-i18n='always'>ALWAYS</span></label>
                                                        <label class='scalable-input'><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='0' checked='checked'><span class='label'  data-i18n='never'>NEVER</span></label>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <span class='label' data-i18n='number-of-attacks:'>NUMBER OF ATTACKS:</span>
                                                        <input class='scalable-input attack-num' type='text' title='@{full_attack_number}' name='attr_full_attack_number' value='2'>
                                                        <span class='label' data-i8n='full-attack-penalty:'>ATTACK PENALTY:</span>
                                                        <input class='scalable-input attack-num' type='text' title='@{full_attack_penalty}' name='attr_full_attack_penalty' value='-4'>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab save-effect-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'><span class='field label' data-i18n='save-effect'>SAVE EFFECT</span></label>
                                                <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                                    <div class='field row span-two'>
                                                        <select class='label atk-ability abi' title='@{save_ability}' name='attr_save_ability'>
                                                            <option value='@{strength_mod}' data-i18n='str' selected>STR</option>
                                                            <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                                        </select>
                                                        <span class='label' data-i18n='based-dc_'>Based DC </span>
                                                        <input class='mod-buff' type='hidden' name='attr_dc_change' value='0'>
                                                        <input title='@{dc}' name='attr_dc' type='number' value='10' hidden='true'>
                                                        <span class='save-dc modified-attr label' title='@{dc}' name='attr_dc' value='10'>10</span>
                                                        <select class='label save-type' title='@{save_type}' name='attr_save_type'>
                                                            <option value='' selected>-</option>
                                                            <option value='FORT' data-i18n='fort-save'>FORT SAVE</option>
                                                            <option value='REF' data-i18n='ref-save'>REF SAVE</option>
                                                            <option value='WILL' data-i18n='will-save'>WILL SAVE</option>
                                                        </select>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <textarea class='' title='@{effect}' name='attr_effect' placeholder='Effect on a Failed Save'></textarea>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <span class='label' data-i18n='A-Sucessful-Save:'>A Sucessful Save:</span>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <textarea class='' title='@{save_effect}' name='attr_save_effect' placeholder='Effect on a Successful Save'></textarea>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'><span class='label field' data-i18n='attacher'>ATTACHER</span></label>
                                                <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                                <div class='row field-container mod-container expandable'>
                                                    <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                                    <textarea class='field row' type='text' title='@{attacher}' name='attr_attacher'></textarea>
                                                </div>
                                                <div class='row span-two'>
                                                    <textarea class='' title='@{description}' name='attr_description' placeholder='Description'></textarea>
                                                </div>
                                                <div class='row span-two'>
                                                    <input readonly=true class='id-label' title='@{id}' name='attr_id'></input>
                                                </div>
                                            </div>
                                            <div class='display'>
                                                <div class='button-description'>
                                                    <input class='label' title='@{name}' name='attr_name' placeholder='Operative'>
                                                    <input class='label' name='attr_school' placeholder='Abjuration'>
                                                    <button class='npcsummary' type='roll' title='%{roll}' name='roll_roll' value='@{whisper_state}&{template:sf_spell} {{name=@{character_name}}} {{characterid=@{character_id}}} {{rightbanner=@{school}}} {{title=@{name}}} {{leftbanner=^{level} [[[[@{level}]]d1cs>2cf>2]]}} {{saveflag=[[1d@{save_checkbox}]]}} {{srflag=@{spell_resistance}}} {{srroll=[[1d20+@{caster_level}@{spell_penetration_misc}]]}} {{activation=@{usage}}} {{duration=@{duration}}} {{targets=@{target}}} {{range=@{range}}} {{savedc=@{dc}}} {{savetype=@{save_type}}} {{effect=@{effect}}} {{saveeffect=@{save_effect}}} {{attackflag=[[1d@{attack_checkbox}]]}}{{fullattack=[[@{full_attack_query}*(@{full_attack_number})]]}} {{r1=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+[[@{full_attack_query}*(@{full_attack_penalty})]][FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage1type=@{attack_type}}} {{damage1=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit1damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit1effect=@{attack_crit}}}  {{r2=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage2type=@{attack_type}}} {{damage2=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit2damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit2effect=@{attack_crit}}} {{r3=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage3type=@{attack_type}}} {{damage3=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit3damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit3effect=@{attack_crit}}} {{r4=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage4type=@{attack_type}}} {{damage4=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit4damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit4effect=@{attack_crit}}} {{r5=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage5type=@{attack_type}}} {{damage5=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit5damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit5effect=@{attack_crit}}} {{rightbanner=@{school}}}{{notes=@{description}}} @{attacher}'></button>
                                                    <label class='expand-button'><input hidden='true' class='expand-description' type='checkbox' name='attr_expand_description' value='1'><span class='collapsed pictos'>`</span><span class='expanded pictos'>J</span></label>
                                                </div>
                                                <input class='expand-description' type='hidden' name='attr_expand_description'>
                                                <textarea class='description' title='@{description}' name='attr_description' placeholder='Description'></textarea>
                                            </div>
                                        </div>
                                    </fieldset>
                                    <label class='pseudo-repcontrol spell'>
                                        <input type='checkbox' title='@{create_7th}' name='attr_create_7th' value='1'>
                                        <span>&</span>
                                    </label>
                                </div>
                            </div>
                            <div class='section-container aspell9 class-spells-day'>
                                <div class='section'>
                                    <h1 class='label' data-i18n='9th-level'>9th LEVEL</h1>
                                </div>
                                <div class='section-container'>
                                    <div class='button-description'>
                                        <span class='label' data-i18n='name'>NAME</span>
                                        <span class='label' data-i18n='school'>SCHOOL</span>
                                    </div>
                                    <fieldset class='repeating_spell'><input hidden='true' type='text' title='@{attack_total}' name='attr_attack_total'><input hidden='true' type='text' title='@{damage_total}' name='attr_damage_total'>
                                            <input class='filter' type='hidden' title='@{filter}' name='attr_filter'>
                                            <div class='filter-container spell ninth'>
                                                <input type='text' hidden='true' title='@{attack_misc}' name='attr_attack_misc' value=''>
                                                <input type='text' hidden='true' title='@{effect_misc}' name='attr_effect_misc' value=''>
                                                <input class="show-options" type="checkbox" title='@{show_options}' name="attr_show_options" checked="checked"><span>y</span>
                                                <div class='row-options'>
                                                <div class='row span-two display-margin'>
                                                    <span class='label' data-i18n='name-u'>NAME</span>
                                                    <input class='atk-name scalable-input input-field' type='text' title='@{name}' name='attr_name' placeholder="Operative's Edge">
                                                    <span class='label' data-i18n='lvl'>LVL</span>
                                                    <input class='atk-level' title='@{level}' name='attr_level' type='text' value=''>
                                                </div>
                                                <div class='row'>
                                                    <span class='label' data-i18n='source'>SOURCE</span>
                                                    <input class='scalable-input input-field' type='text' title='@{source}' name='attr_source' placeholder='Operative'>
                                                </div>
                                                <div class='row'>
                                                    <span class='label' data-i18n='school'>SCHOOL</span>
                                                    <input class='scalable-input input-field' title='@{school}' name='attr_school' type='text' placeholder='abjuration'>
                                                </div>
                                                <div class='row span-two'>
                                                    <span class='label' data-i18n='target'>TARGET</span>
                                                    <input class='scalable-input input-field' type='text' title='@{target}' name='attr_target' placeholder='self'>
                                                    <span class='label' data-i18n='rng'>RNG</span>
                                                    <input class='scalable-input input-field' type='text' title='@{range}' name='attr_range' placeholder='30 ft'>
                                                </div>
                                                <div class='row'>
                                                    <span class='label' data-i18n='duration'>DURATION</span>
                                                    <input class='scalable-input input-field' type='text' title='@{duration}' name='attr_duration' placeholder='1 round' value=''>
                                                </div>
                                                <div class='row'>
                                                    <span class='label abi-cost' data-i18n='usage'>USAGE</span>
                                                    <input class='scalable-input input-field' type='text' title='@{usage}' name='attr_usage' placeholder='Standard Action'>
                                                </div>
                                                <div class='row'>
                                                <span class='label' data-i18n='spell-resistance-abbrv'>SR</span>
                                                <input type='hidden' name='attr_spell_penetration_misc' value=''><select name='attr_spell_resistance'>
                                                <option value='' data-i18n='no' selected>NO</option>
                                                <option value='yes' data-i18n='yes'>YES</option>
                                                </select>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab atk-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'><span class='field label' data-i18n='atk'>ATK</span></label>
                                                <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                                    <div class='field row span-two'>
                                                        <select class='label atk-ability abi' title='@{attack_ability}' name='attr_attack_ability'>
                                                            <option value='@{strength_mod}' data-i18n='str' selected>STR</option>
                                                            <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                                        </select>
                                                        <input hidden='true' title='@{attack_ability}' name='attr_attack_ability' value='0'>
                                                        <span class='arith'>+</span>
                                                        <input class='bab' title='@{base_attack_bonus}' name='attr_base_attack_bonus' readonly='true' value='0'>
                                                        <input class='abi-misc' type='text' title='@{attack_bonus}' name='attr_attack_bonus' placeholder='+@{attr}/2 + ?{Query}'>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab dmg-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'><span class='field label' data-i18n='dmg'>DMG</span></label>
                                                <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                                    <input hidden='true' title='@{damage_misc}' name='attr_damage_misc' value=''>
                                                    <div class='field row span-two'>
                                                        <input class='abi-dmg-dice' type='text' name=attr_damage_dice placeholder='1d8'><span>+</span>
                                                        <select class='label atk-ability abi' title='@{damage_ability}' name='attr_damage_ability'>
                                                            <option value='' selected data-i18n='n/a'>N/A</option>
                                                            <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                                            <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                                        </select>
                                                        <input hidden='true' title='@{damage_ability}' name='attr_damage_ability' value='0'>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <span class='label' data-i18n='type'>TYPE</span>
                                                        <input class='scalable-input input-field' type='text' title='@{attack_type}' name='attr_attack_type' placeholder='Fire'>
                                                        <span class='label' data-i18n='crit-effect'>CRIT EFFECT</span>
                                                        <input class='scalable-input input-field' type='text' title='@{attack_crit}' name='attr_attack_crit' placeholder='Burn'>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'><span class='label field' data-i18n='additional-attack'>ADDITIONAL ATTACKS</span></label>
                                                <input class='field-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab macro-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                                    <div class='field row span-two'>
                                                        <span data-i18n='roll-full-attack_'>ROLL FULL ATTACK: </span>
                                                        <label class='scalable-input'><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='?{Full Attack|No,0|Yes,1}'><span class='label'  data-i18n='query'>QUERY</span></label>
                                                        <label class='scalable-input'><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='1'><span class='label' data-i18n='always'>ALWAYS</span></label>
                                                        <label class='scalable-input'><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='0' checked='checked'><span class='label'  data-i18n='never'>NEVER</span></label>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <span class='label' data-i18n='number-of-attacks:'>NUMBER OF ATTACKS:</span>
                                                        <input class='scalable-input attack-num' type='text' title='@{full_attack_number}' name='attr_full_attack_number' value='2'>
                                                        <span class='label' data-i8n='full-attack-penalty:'>ATTACK PENALTY:</span>
                                                        <input class='scalable-input attack-num' type='text' title='@{full_attack_penalty}' name='attr_full_attack_penalty' value='-4'>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab save-effect-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'><span class='field label' data-i18n='save-effect'>SAVE EFFECT</span></label>
                                                <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                                <div class='field-container expandable inherit-grid'>
                                                    <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                                    <div class='field row span-two'>
                                                        <select class='label atk-ability abi' title='@{save_ability}' name='attr_save_ability'>
                                                            <option value='@{strength_mod}' data-i18n='str' selected>STR</option>
                                                            <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                                            <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                                            <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                                            <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                                            <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                                        </select>
                                                        <span class='label' data-i18n='based-dc_'>Based DC </span>
                                                        <input class='mod-buff' type='hidden' name='attr_dc_change' value='0'>
                                                        <input title='@{dc}' name='attr_dc' type='number' value='10' hidden='true'>
                                                        <span class='save-dc modified-attr label' title='@{dc}' name='attr_dc' value='10'>10</span>
                                                        <select class='label save-type' title='@{save_type}' name='attr_save_type'>
                                                            <option value='' selected>-</option>
                                                            <option value='FORT' data-i18n='fort-save'>FORT SAVE</option>
                                                            <option value='REF' data-i18n='ref-save'>REF SAVE</option>
                                                            <option value='WILL' data-i18n='will-save'>WILL SAVE</option>
                                                        </select>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <textarea class='' title='@{effect}' name='attr_effect' placeholder='Effect on a Failed Save'></textarea>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <span class='label' data-i18n='A-Sucessful-Save:'>A Sucessful Save:</span>
                                                    </div>
                                                    <div class='field row span-two'>
                                                        <textarea class='' title='@{save_effect}' name='attr_save_effect' placeholder='Effect on a Successful Save'></textarea>
                                                    </div>
                                                </div>
                                                <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                                <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'><span class='label field' data-i18n='attacher'>ATTACHER</span></label>
                                                <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                                <div class='row field-container mod-container expandable'>
                                                    <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                                    <textarea class='field row' type='text' title='@{attacher}' name='attr_attacher'></textarea>
                                                </div>
                                                <div class='row span-two'>
                                                    <textarea class='' title='@{description}' name='attr_description' placeholder='Description'></textarea>
                                                </div>
                                                <div class='row span-two'>
                                                    <input readonly=true class='id-label' title='@{id}' name='attr_id'></input>
                                                </div>
                                            </div>
                                            <div class='display'>
                                                <div class='button-description'>
                                                    <input class='label' title='@{name}' name='attr_name' placeholder='Operative'>
                                                    <input class='label' name='attr_school' placeholder='Abjuration'>
                                                    <button class='npcsummary' type='roll' title='%{roll}' name='roll_roll' value='@{whisper_state}&{template:sf_spell} {{name=@{character_name}}} {{characterid=@{character_id}}} {{rightbanner=@{school}}} {{title=@{name}}} {{leftbanner=^{level} [[[[@{level}]]d1cs>2cf>2]]}} {{saveflag=[[1d@{save_checkbox}]]}} {{srflag=@{spell_resistance}}} {{srroll=[[1d20+@{caster_level}@{spell_penetration_misc}]]}} {{activation=@{usage}}} {{duration=@{duration}}} {{targets=@{target}}} {{range=@{range}}} {{savedc=@{dc}}} {{savetype=@{save_type}}} {{effect=@{effect}}} {{saveeffect=@{save_effect}}} {{attackflag=[[1d@{attack_checkbox}]]}}{{fullattack=[[@{full_attack_query}*(@{full_attack_number})]]}} {{r1=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+[[@{full_attack_query}*(@{full_attack_penalty})]][FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage1type=@{attack_type}}} {{damage1=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit1damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit1effect=@{attack_crit}}}  {{r2=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage2type=@{attack_type}}} {{damage2=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit2damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit2effect=@{attack_crit}}} {{r3=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage3type=@{attack_type}}} {{damage3=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit3damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit3effect=@{attack_crit}}} {{r4=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage4type=@{attack_type}}} {{damage4=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit4damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit4effect=@{attack_crit}}} {{r5=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage5type=@{attack_type}}} {{damage5=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit5damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit5effect=@{attack_crit}}} {{rightbanner=@{school}}}{{notes=@{description}}} @{attacher}'></button>
                                                    <label class='expand-button'><input hidden='true' class='expand-description' type='checkbox' name='attr_expand_description' value='1'><span class='collapsed pictos'>`</span><span class='expanded pictos'>J</span></label>
                                                </div>
                                                <input class='expand-description' type='hidden' name='attr_expand_description'>
                                                <textarea class='description' title='@{description}' name='attr_description' placeholder='Description'></textarea>
                                            </div>
                                            </div>
                                        </fieldset>
                                    <label class='pseudo-repcontrol spell'>
                                        <input type='checkbox' title='@{create_9th}' name='attr_create_9th' value='1'>
                                        <span>&</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="container npc">
        <div class='statblock'>
            <div class='statblock-header'>
                <input class='scalable-input char-name' type='text' title='@{character_name}' name='attr_character_name'>
                <span class='cr label' data-i18n='cr'>CR</span>
                <input class='cr' type='text' title='@{character_level}' name='attr_character_level' value='' placeholder='1/3'>
            </div>
            <div class='row'>
                <span class='xp label' data-i18n='xp'>XP</span>
                <input class='xp' type='number' title='@{xp}' name='attr_xp' placeholder='200'>
            </div>
            <div class='row'>
                <input class='scalable-input input-field' type='text' title='@{race}' name='attr_race' placeholder='RACE & GRAFTS'>
            </div>
            <div class='row'>
                <input class='alignment' type='text' title='@{alignment}' name='attr_alignment' placeholder='NE'>
                <select class='size' title='@{size}' name='attr_size'>
                    <option value='-4' data-i18n='fine'>FINE</option>
                    <option value='-3' data-i18n='diminutive'>DIMINUTIVE</option>
                    <option value='-2' data-i18n='tiny'>TINY</option>
                    <option value='-1' data-i18n='small'>SMALL</option>
                    <option value='0' data-i18n='medium' selected>MEDIUM</option>
                    <option value='1' data-i18n='large'>LARGE</option>
                    <option value='2' data-i18n='huge'>HUGE</option>
                    <option value='3' data-i18n='gargantuan'>GARGANTUAN</option>
                    <option value='4' data-i18n='colossal'>COLOSSAL</option>
                </select>
                <input class='scalable-input input-field' type='text' title='@{type_subtype}' name='attr_type_subtype' placeholder='Type (subtype)'>
            </div>
            <div class='row initiative-row'>
                <button class='label' type='roll' title='%{initiative}' name='roll_initiative' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Initiative}} {{r1=[[1d20+@{initiative_ability}[ABILITY]@{npc_init}@{initiative_misc}+[[(@{initiative_ability}[ABILITY]@{npc_init}@{initiative_misc})/100)]][TIE BREAKER]&{tracker}]]}}' data-i18n='init' >INIT</button>
                <div class='attr-base-mod-container init'>
                    <input class='base-attr input-field' type='number' title='@{initiative}' name='attr_initiative_base' value='0'>
                    <input class='mod-buff' type='hidden' name='attr_initiative_change' value='0'>
                    <span class='modified-attr input-field' title='@{initiative}' name='attr_initiative' value='0'>0</span>
                </div>
                <input hidden='true' type='text' title='@{initiative_misc}' name='attr_initiative_misc' value=''>
                <span class='senses label' data-i81n='senses'>SENSES</span>
                <input class='senses input-field' type='text' title='@{senses}' name='attr_senses' placeholder='Darkvision (60ft)'>
            </div>
            <div class='row ability-scores'>
                <span class='perception label' data-i18n='perception'>PERCEPTION</span>
                <div class='attr-base-mod-container perception'>
                    <input class='base-attr' type='number' title='@{perception}' name='attr_perception_base' value='0'>
                    <input class='mod-buff' type='hidden' name='attr_perception_change' value='0'>
                    <span class='modified-attr input-field' name='attr_perception'>0</span>
                </div>
            </div>
            <div class='row'>
                <span class='aura label' data-i18n='aura'>AURA</span>
                <input class='aura scalable-input input-field' type='text' title='@{aura}' name='attr_aura' placeholder='Unnatural Aura (30ft)'>
            </div>
            <div class='statblock-section-header defense-header'>
                <span data-i18n='defense'>DEFENSE</span>
                <div class='hp-rp-container'>
                    <span class='hp' data-i18n='hp'>HP</span>
                    <input class='hp' type='number' title='@{hp}' name='attr_hp' placeholder='20'>
                    <span class='slash'>/</span>
                    <input class='hp' type='number' title='@{hp_max}' name='attr_hp_max' placeholder='20'>
                    <span class='rp' data-18n='rp'>RP</span>
                    <input class='rp' type='number' title='@{rp}' name='attr_rp' value='0'>
                    <span class='slash'>/</span>
                    <input class='rp' type='number' title='@{rp_max}' name='attr_rp_max' value='0'>
                </div>
            </div>
            <div class='row defense-row'>
                <span class='npc-ac' data-i18n='eac'>EAC</span>
                <div class='attr-base-mod-container npc-ac'>
                    <input class='base-attr' type='number' title='@{eac}' name='attr_eac_base' value='10'>
                    <input class='mod-buff' type='hidden' name='attr_eac_change' value='0'>
                    <span class='modified-attr input-field' title='@{eac}' name='attr_eac' value='10'>10</span>
                </div>
                <span class='npc-ac' data-i18n='kac'>KAC</span>
                <div class='attr-base-mod-container npc-ac'>
                    <input class='base-attr' type='number' title='@{kac}' name='attr_kac_base' value='10'>
                    <input class='mod-buff' type='hidden' name='attr_kac_change' value='0'>
                    <span class='modified-attr input-field' title='@{kac}' name='attr_kac' value='10'>10</span>
                </div>
                <span class='npc-ac' data-i18n='cmd'>CMD</span>
                <div class='attr-base-mod-container npc-ac'>
                    <input class='base-attr' type='number' title='@{cmd}' name='attr_cmd_base' value='10'>
                    <input class='mod-buff' type='hidden' name='attr_cmd_change' value='0'>
                    <span class='modified-attr input-field' title='@{kac}' name='attr_cmd' value='10'>10</span>
                </div>
                <input class='npc-ac-notes input-field' type='text' title='@{ac_notes}' name='attr_ac_notes' placeholder='AC Notes'>
            </div>
            <div class='row defense-row'>
                <button class='npc-save' type='roll' title='%{fort}' name='roll_fort' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Fortitude}} {{r1=[[1d20+@{fort_base}[BASE]+@{fort_ability}[ABILITY]@{fort_misc}]] }} {{notes=@{save_notes}}}' data-i18n='fort' >FORT</button>
                <div class='attr-base-mod-container npc-save'>
                    <input class='base-attr' type='number' title='@{fort}' name='attr_fort_base' value='0'>
                    <input class='mod-buff' type='hidden' name='attr_fort_change' value='0'>
                    <span class='modified-attr input-field' title='@{fort}' name='attr_fort' value='0'>0</span>
                </div>
                <button class='npc-save' type='roll' title='%{ref}' name='roll_ref' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Ref}} {{r1=[[1d20+@{ref_base}[BASE]+@{ref_ability}[ABILITY]@{ref_misc}]] }} {{notes=@{save_notes}}}' data-i18n='ref' >REF</button>
                <div class='attr-base-mod-container npc-save'>
                    <input class='base-attr' type='number' title='@{ref}' name='attr_ref_base' value='0'>
                    <input class='mod-buff' type='hidden' name='attr_ref_change' value='0'>
                    <span class='modified-attr input-field' title='@{ref}' name='attr_ref' value='0'>0</span>
                </div>
                <button class='npc-save' type='roll' title='%{will}' name='roll_will' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Will}} {{r1=[[1d20+@{will_base}[BASE]+@{will_ability}[ABILITY]@{will_misc}]] }} {{notes=@{save_notes}}}' data-i18n='will' >WILL</button>
                <div class='attr-base-mod-container npc-save'>
                    <input class='base-attr' type='number' title='@{will}' name='attr_will_base' value='0'>
                    <input class='mod-buff' type='hidden' name='attr_will_change' value='0'>
                    <span class='modified-attr input-field' title='@{will}' name='attr_will' value='0'>0</span>
                </div>
                <input class='npc-save-notes input-field' type='text' title='@{save_notes}' name='attr_save_notes' placeholder='Save Notes'>
            </div>
            <div class='row'>
                <span class='def-abilities' data-i18n='defensive-abilities'>DEFENSIVE ABILITIES</span>
                <input class='def-abilities scalable-input input-field' type='text' title='@{defensive_abilities}' name='attr_defensive_abilities'>
            </div>
            <div class='row'>
                <span class='dr' data-i18n='dr'>DR</span>
                <input class='scalable-input input-field' type='text' title='@{dr}' name='attr_dr'>
                <span class='immunities' data-i18n='immunities'>IMMUNITIES</span>
                <input class='immunities scalable-input input-field' type='text' title='@{immunities}' name='attr_immunities'>
                <span class='sr' data-i18n='sr'>SR</span>
                <input class='sr' type='number' title='@{sr}' name='attr_sr'>
            </div>
            <div class='row'>
                <span class='resistances' data-i18n='resistances'>RESISTANCES</span>
                <input class='resistances scalable-input input-field' type='text' title='@{resistances}' name='attr_resistances'>
                <span class='weaknesses' data-i18n='weaknesses'>WEAKNESSES</span>
                <input class='weaknesses scalable-input input-field' type='text' title='@{weaknesses}' name='attr_weaknesses'>
            </div>
            <div class='statblock-section-header offense-header'>
                <span data-i18n='offense'>OFFENSE</span>
            </div>
            <div class='row'>
                <span data-i18n='speed'>SPEED</span>
                <input class='speed scalable-input input-field' type='text' title='@{speed}' name='attr_speed'>
            </div>
            <div class='attack-row'>
                <span class='attack-label label' data-i18n='melee'>MELEE</span>
                <fieldset class='repeating_attack'>
                    <input hidden='true' type='text' title='@{proficiency_value}' name='attr_proficiency_value' value='0'>
                    <input hidden='true'  type='text' title='@{damage_proficiency_value}' name='attr_damage_proficiency_value' value='0'>
                    <input class='filter' type='radio' hidden='true' title='@{range_filter}' name='attr_range_filter' value='melee' checked='checked'>
                    <input type='radio' hidden='true' title='@{range_filter}' name='attr_range_filter' value='ranged'>
                    <div class='filter-container attack'>
                        <input type='text' hidden='true' title='@{misc}' name='attr_misc' value=''>
                        <input type='text' hidden='true' title='@{damage_misc}' name='attr_damage_misc' value=''>
                        <input class="show-options" type="checkbox" title='@{show_options}' name="attr_show_options" value='1' checked="checked"><span>y</span>
                        <div class='row-options'>
                            <div class='row span-all'>
                                <span class='label' data-i18n='name-u'>NAME</span>
                                <input class='atk-name scalable-input input-field' type='text' title='@{name}' name='attr_name' placeholder='Laser Pistol' value=''>
                                <span class='label' data-i18n='lvl'>LVL</span>
                                <input class='atk-level input-field' type='text' title='@{level}' name='attr_level' value='0'>
                            </div>
                            <div class='row span-two'>
                                <span class='label' data-i18n='atk-u'>ATTACK ROLL</span>
                                <input class='bab input-field' type='number' title='@{base_attack_bonus_base}' name='attr_base_attack_bonus_base' value='0'>
                                <input class='bab input-field' type='hidden' title='@{base_attack_bonus_base}' name='attr_base_attack_bonus' value='0'>
                                <input class='atk-misc misc scalable-input input-field' type='text' title='@{bonus}' name='attr_bonus' placeholder='+@{attr}/2 + ?{Query}' value=''>
                            </div>
                            <div class='row span-two'>
                                <span class='label' data-i18n='dmg'>DAMAGE ROLL</span>
                                <input class='dmg-dice scalable-input input-field' type='text' name=attr_damage_dice placeholder='1d8' value=''>
                            </div>
                            <div class='row span-two'>
                                <input hidden='true' type='text' title='@{ability}' name='attr_ability' value='0'>
                                <span class='label' data-i18n='attack-affected-by-buffs-to'>ATTACK ROLL AFFECTED BY BUFFS TO</span>
                                <select class='label atk-ability abi input-field' title='@{ability}' name='attr_ability'>
                                    <option value='0' selected data-i18n='n/a'>N/A</option>
                                    <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                    <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                    <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                    <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                    <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                    <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                </select>
                            </div>
                            <div class='row span-two'>
                                <input hidden='true' type='text' title='@{damage_ability}' name='attr_damage_ability' value='0'>
                                <span class='label' data-i18n='damage-affected-by-buffs-to'>DAMAGE AFFECTED BY BUFFS TO</span>
                                <select class='label atk-ability abi input-field' title='@{damage_ability}' name='attr_damage_ability'>
                                    <option value='0' selected data-i18n='n/a'>N/A</option>
                                    <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                    <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                    <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                    <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                    <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                    <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                </select>
                            </div>
                            <div class='row span-two'>
                                <span class='label' data-i18n='damage-type'>DAMAGE TYPE</span>
                                <input class='atk-type scalable-input input-field' type='text' title='@{type}' name='attr_type' placeholder='Fire' value=''>
                            </div>
                            <div class='row span-two'>
                                <span class='label' data-i18n='crit-effect'>CRITICAL EFFECT</span>
                                <input class='atk-crit scalable-input input-field' type='text' title='@{crit}' name='attr_crit' placeholder='Burn [[1d6]]' value=''>
                            </div>
                            <div class='row span-two'>
                                <span class='label' data-i18n='rng'>RANGE</span>
                                <input class='atk-range scalable-input input-field' type='text' title='@{range}' name='attr_range' placeholder='30 ft' value=''>
                                <select class='label atk-range-type input-field' title='@{engagement_range}' name='attr_engagement_range'>
                                    <option value='melee' data-i18n='melee' selected>MELEE</option>
                                    <option value='ranged' data-i18n='ranged'>RANGED</option>
                                </select>
                            </div>
                            <div class='row span-two'>
                                <input class='label scalable-input input-field' data-i18n-placeholder='ammo' title='@{ammo_type}' name='attr_ammo_type' value='' type='text' placeholder='ammo' >
                                <input title='@{ammo}' name='attr_ammo' type='number' value=''>
                                <span class='label'>/</span>
                                <input class='input-field' title='@{ammo_max}' name='attr_ammo_max' type='number' value=''>
                            </div>
                            <div class='row span-two'>
                                <span class='label' data-i18n='usage'>USAGE</span>
                                <input class='atk-usage scalable-input input-field' type='text' title='@{usage}' name='attr_usage' placeholder='1 charge' value=''>
                            </div>
                            <div class='row span-two'>
                                <span class='label' data-i18n='special'>SPECIAL</span>
                                <input class='atk-special scalable-input input-field' type='text' title='@{special}' name='attr_special' placeholder='heirloom' value=''>
                            </div>
                            <input class='field-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                            <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'><span class='label field' data-i18n='additional-attack'>ADDITIONAL ATTACKS</span></label>
                            <input class='field-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                            <div class='field-container inherit-grid expandable'>
                                <input class='field-tab macro-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                <div class='field row'>
                                    <span data-i18n='roll-full-attack_'>ROLL FULL ATTACK: </span>
                                </div>
                                <div class='field row span-two'>
                                    <label><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='?{Full Attack|No,0|Yes,1}' checked='checked'><span class='label'  data-i18n='query'>QUERY</span></label>
                                    <label><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='1'><span class='label' data-i18n='always'>ALWAYS</span></label>
                                    <label><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='0'><span class='label'  data-i18n='never'>NEVER</span></label>
                                </div>
                                <div class='field row span-two'>
                                    <span class='label' data-i18n='number-of-attacks:'>NUMBER OF ATTACKS:</span>
                                    <input class='scalable-input attack-num input-field' type='text' title='@{full_attack_number}' name='attr_full_attack_number' value='2'>
                                </div>
                                <div class='field row span-two'>
                                    <span class='label' data-i8n='full-attack-penalty:'>ATTACK PENALTY:</span>
                                    <input class='scalable-input attack-num input-field' type='text' title='@{full_attack_penalty}' name='attr_full_attack_penalty' value='-4'>
                                </div>
                            </div>
                            <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                            <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'><span class='label field' data-i18n='attacher'>ATTACHER</span></label>
                            <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                            <input class='field-tab macro-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                            <textarea class='expandable atk-description input-field' title='@{attacher}' name='attr_attacher' ></textarea>
                            <div class='row span-all'>
                                <textarea class='atk-description scalable-input input-field' title='@{description}' name='attr_description' placeholder='Description' value=''></textarea>
                            </div>
                            <div class='row span-all'>
                                <input readonly=true class='id-label' title='@{id}' name='attr_id'></input>
                            </div>
                        </div>
                        <input type='hidden' name='attr_damage_ability_base' value='0'>
                        <div class='display'>
                            <div class='button-description'>
                                <input class='label' title='@{name}' type='text' name='attr_name' placeholder='Laser Rifle'>
                                <div class='attr-total-container'>
                                    <input class='mod-buff' type='hidden' name='attr_total_change' value='0'>
                                    <span class='label modified-attr' title='@{total}' name='attr_total' value='0'>0</span>
                                </div>
                                <div class='attr-total-container span-two'>
                                    <input class='mod-buff' type='hidden' name='attr_damage_total_change' value='0'>
                                    <span class='label modified-attr' title='@{damage_total}' name='attr_damage_total' value='0'>0</span>
                                </div>
                                <input type='text' class='label' title='@{type}' name='attr_type' placeholder='Fire'>
                                <button class='summary' type='roll' title='%{npc_roll}' name='roll_npc_roll' value='@{whisper_state}&{template:sf_attack}{{name=@{character_name}}} {{characterid=@{character_id}}} {{title=@{name}}} {{leftbanner=^{level} [[[[@{level}]]d1cs>2cf>2]]}} {{fullattack=[[@{full_attack_query}*(@{full_attack_number})]]}} {{r1name=@{name}}} {{r1=[[1d20+@{base_attack_bonus}[BAB]+@{ability}[ABILITY]+@{proficiency_value}[PROF]+[[@{full_attack_query}*(@{full_attack_penalty})]][FULL ATTACK]@{misc}@{bonus}]]}} {{damage1type=@{type}}} {{damage1=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]+@{damage_proficiency_value}[SPEC]@{damage_misc}]]}} {{crit1damage=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]+@{damage_proficiency_value}[SPEC]@{damage_misc}]]}} {{crit1effect=@{crit}}} {{r2name=@{name}}} {{r2=[[1d20+@{base_attack_bonus}[BAB]+@{ability}[ABILITY]+@{proficiency_value}[PROF]+[[@{full_attack_penalty}]][FULL ATTACK]@{misc}@{bonus}]]}} {{damage2type=@{type}}} {{damage2=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]+@{damage_proficiency_value}[SPEC]@{damage_misc}]]}} {{crit2damage=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]+@{damage_proficiency_value}[SPEC]@{damage_misc}]]}} {{crit2effect=@{crit}}} {{r3name=@{name}}} {{r3=[[1d20+@{base_attack_bonus}[BAB]+@{ability}[ABILITY]+@{proficiency_value}[PROF]+@{full_attack_penalty}[FULL ATTACK]@{misc}@{bonus}]]}} {{damage3type=@{type}}} {{damage3=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]+@{damage_proficiency_value}[SPEC]@{damage_misc}]]}} {{crit3damage=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]+@{damage_proficiency_value}[SPEC]@{damage_misc}]]}} {{crit3effect=@{crit}}} {{r4name=@{name}}} {{r4=[[1d20+@{base_attack_bonus}[BAB]+@{ability}[ABILITY]+@{proficiency_value}[PROF]+@{full_attack_penalty}[FULL ATTACK]@{misc}@{bonus}]]}} {{damage4type=@{type}}} {{damage4=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]+@{damage_proficiency_value}[SPEC]@{damage_misc}]]}} {{crit4damage=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]+@{damage_proficiency_value}[SPEC]@{damage_misc}]]}} {{crit4effect=@{crit}}} {{r5name=@{name}}} {{r5=[[1d20+@{base_attack_bonus}[BAB]+@{ability}[ABILITY]+@{proficiency_value}[PROF]+@{full_attack_penalty}[FULL ATTACK]@{misc}@{bonus}]]}} {{damage5type=@{type}}} {{damage5=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]+@{damage_proficiency_value}[SPEC]@{damage_misc}]]}} {{crit5damage=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]+@{damage_proficiency_value}[SPEC]@{damage_misc}]]}} {{crit5effect=@{crit}}} {{range=@{range}}} {{ammo_type=@{ammo_type}}} {{curr_ammo=@{ammo}}} {{rightbanner=@{special}}} {{notes=@{description}}} @{attacher}'></button>
                                <label class='expand-button'><input hidden='true' class='expand-description' type='checkbox' name='attr_expand_description' value='1'><span class='collapsed pictos'>`</span><span class='expanded pictos'>J</span></label>
                            </div>
                            <input class='expand-description' type='hidden' name='attr_expand_description'>
                            <textarea class='description span-all' title='@{description}' name='attr_description' placeholder='Description'></textarea>
                        </div>
                    </div>
                </fieldset>
                <label class='pseudo-repcontrol'><input type='checkbox' title='@{create_npcmelee}' name='attr_create_npcmelee' value='melee'><span>&</span></label>
            </div>
            <div class='attack-row'>
                <span class='attack-label label' data-i18n='ranged'>RANGED</span>
                <fieldset class='repeating_attack'>
                    <input hidden='true' type='text' title='@{proficiency_value}' name='attr_proficiency_value' value='0'>
                    <input hidden='true'  type='text' title='@{damage_proficiency_value}' name='attr_damage_proficiency_value' value='0'>
                    <input type='radio' hidden='true' title='@{range_filter}' name='attr_range_filter' value='melee' checked='checked'>
                    <input class='filter' type='radio' hidden='true' title='@{range_filter}' name='attr_range_filter' value='ranged'>
                    <div class='filter-container attack'>
                        <input type='text' hidden='true' title='@{misc}' name='attr_misc' value=''>
                        <input type='text' hidden='true' title='@{damage_misc}' name='attr_damage_misc' value=''>
                        <input class="show-options" type="checkbox" title='@{show_options}' name="attr_show_options" value='1' checked="checked"><span>y</span>
                        <div class='row-options'>
                            <div class='row  span-all'>
                                <span class='label' data-i18n='name-u'>NAME</span>
                                <input class='atk-name scalable-input input-field' type='text' title='@{name}' name='attr_name' placeholder='Laser Pistol' value=''>
                                <span class='label' data-i18n='lvl'>LVL</span>
                                <input class='atk-level input-field' type='text' title='@{level}' name='attr_level' value='0'>
                            </div>
                            <div class='row span-two'>
                                <span class='label' data-i18n='atk-u'>ATTACK ROLL</span>
                                <input class='bab input-field' type='number' title='@{base_attack_bonus_base}' name='attr_base_attack_bonus_base' value='0'>
                                <input class='bab input-field' type='hidden' title='@{base_attack_bonus_base}' name='attr_base_attack_bonus' value='0'>
                                <input class='atk-misc misc scalable-input input-field' type='text' title='@{bonus}' name='attr_bonus' placeholder='+@{attr}/2 + ?{Query}' value=''>
                            </div>
                            <div class='row span-two'>
                                <span class='label' data-i18n='dmg'>DAMAGE ROLL</span>
                                <input class='dmg-dice scalable-input input-field' type='text' name=attr_damage_dice placeholder='1d8' value=''>
                            </div>
                            <div class='row span-two'>
                                <input hidden='true' type='text' title='@{ability}' name='attr_ability' value='0'>
                                <span class='label' data-i18n='attack-affected-by-buffs-to'>ATTACK ROLL AFFECTED BY BUFFS TO</span>
                                <select class='label atk-ability abi input-field' title='@{ability}' name='attr_ability'>
                                    <option value='0' selected data-i18n='n/a'>N/A</option>
                                    <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                    <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                    <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                    <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                    <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                    <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                </select>
                            </div>
                            <div class='row span-two'>
                                <input hidden='true' type='text' title='@{damage_ability}' name='attr_damage_ability' value='0'>
                                <span class='label' data-i18n='damage-affected-by-buffs-to'>DAMAGE AFFECTED BY BUFFS TO</span>
                                <select class='label atk-ability abi input-field' title='@{damage_ability}' name='attr_damage_ability'>
                                    <option value='0' selected data-i18n='n/a'>N/A</option>
                                    <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                    <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                    <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                    <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                    <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                    <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                </select>
                            </div>
                            <div class='row span-two'>
                                <span class='label' data-i18n='damage-type'>DAMAGE TYPE</span>
                                <input class='atk-type scalable-input input-field' type='text' title='@{type}' name='attr_type' placeholder='Fire' value=''>
                            </div>
                            <div class='row span-two'>
                                <span class='label' data-i18n='crit-effect'>CRITICAL EFFECT</span>
                                <input class='atk-crit scalable-input input-field' type='text' title='@{crit}' name='attr_crit' placeholder='Burn [[1d6]]' value=''>
                            </div>
                            <div class='row span-two'>
                                <span class='label' data-i18n='rng'>RANGE</span>
                                <input class='atk-range scalable-input input-field' type='text' title='@{range}' name='attr_range' placeholder='30 ft' value=''>
                                <select class='label atk-range-type input-field' title='@{engagement_range}' name='attr_engagement_range'>
                                    <option value='melee' data-i18n='melee' selected>MELEE</option>
                                    <option value='ranged' data-i18n='ranged'>RANGED</option>
                                </select>
                            </div>
                            <div class='row span-two'>
                                <input class='label scalable-input input-field' data-i18n-placeholder='ammo' title='@{ammo_type}' name='attr_ammo_type' value='' type='text' placeholder='ammo' >
                                <input title='@{ammo}' name='attr_ammo' type='number' value=''>
                                <span class='label'>/</span>
                                <input class='input-field' title='@{ammo_max}' name='attr_ammo_max' type='number' value=''>
                            </div>
                            <div class='row span-two'>
                                <span class='label' data-i18n='usage'>USAGE</span>
                                <input class='atk-usage scalable-input input-field' type='text' title='@{usage}' name='attr_usage' placeholder='1 charge' value=''>
                            </div>
                            <div class='row span-two'>
                                <span class='label' data-i18n='special'>SPECIAL</span>
                                <input class='atk-special scalable-input input-field' type='text' title='@{special}' name='attr_special' placeholder='heirloom' value=''>
                            </div>
                            <input class='field-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                            <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'><span class='label field' data-i18n='additional-attack'>ADDITIONAL ATTACKS</span></label>
                            <input class='field-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                            <div class='field-container inherit-grid expandable'>
                                <input class='field-tab macro-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                <div class='field row'>
                                    <span data-i18n='roll-full-attack_'>ROLL FULL ATTACK: </span>
                                </div>
                                <div class='field row span-two'>
                                    <label><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='?{Full Attack|No,0|Yes,1}' checked='checked'><span class='label'  data-i18n='query'>QUERY</span></label>
                                    <label><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='1'><span class='label' data-i18n='always'>ALWAYS</span></label>
                                    <label><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='0'><span class='label'  data-i18n='never'>NEVER</span></label>
                                </div>
                                <div class='field row span-two'>
                                    <span class='label' data-i18n='number-of-attacks:'>NUMBER OF ATTACKS:</span>
                                    <input class='scalable-input attack-num input-field' type='text' title='@{full_attack_number}' name='attr_full_attack_number' value='2'>
                                </div>
                                <div class='field row span-two'>
                                    <span class='label' data-i8n='full-attack-penalty:'>ATTACK PENALTY:</span>
                                    <input class='scalable-input attack-num input-field' type='text' title='@{full_attack_penalty}' name='attr_full_attack_penalty' value='-4'>
                                </div>
                            </div>
                            <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                            <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'><span class='label field' data-i18n='attacher'>ATTACHER</span></label>
                            <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                            <input class='field-tab macro-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                            <textarea class='expandable atk-description input-field' title='@{attacher}' name='attr_attacher' ></textarea>
                            <div class='row span-all'>
                                <textarea class='atk-description scalable-input input-field' title='@{description}' name='attr_description' placeholder='Description' value=''></textarea>
                            </div>
                            <div class='row span-all'>
                                <input readonly=true class='id-label' title='@{id}' name='attr_id'></input>
                            </div>
                        </div>
                        <input type='hidden' name='attr_damage_ability_base' value='0'>
                        <div class='display'>
                            <div class='button-description'>
                                <input class='label' title='@{name}' type='text' name='attr_name' placeholder='Laser Rifle'>
                                <div class='attr-total-container'>
                                    <input class='mod-buff' type='hidden' name='attr_total_change' value='0'>
                                    <span class='label modified-attr' title='@{total}' name='attr_total' value='0'>0</span>
                                </div>
                                <div class='attr-total-container span-two'>
                                    <input class='mod-buff' type='hidden' name='attr_damage_total_change' value='0'>
                                    <span class='label modified-attr' title='@{damage_total}' name='attr_damage_total' value='0'>0</span>
                                </div>
                                <input type='text' class='label' title='@{type}' name='attr_type' placeholder='Fire'>
                                <button class='summary' type='roll' title='%{npc_roll}' name='roll_npc_roll' value='@{whisper_state}&{template:sf_attack}{{name=@{character_name}}} {{characterid=@{character_id}}} {{title=@{name}}} {{leftbanner=^{level} [[[[@{level}]]d1cs>2cf>2]]}} {{fullattack=[[@{full_attack_query}*(@{full_attack_number})]]}} {{r1name=@{name}}} {{r1=[[1d20+@{base_attack_bonus}[BAB]+@{ability}[ABILITY]+@{proficiency_value}[PROF]+[[@{full_attack_query}*(@{full_attack_penalty})]][FULL ATTACK]@{misc}@{bonus}]]}} {{damage1type=@{type}}} {{damage1=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]+@{damage_proficiency_value}[SPEC]@{damage_misc}]]}} {{crit1damage=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]+@{damage_proficiency_value}[SPEC]@{damage_misc}]]}} {{crit1effect=@{crit}}} {{r2name=@{name}}} {{r2=[[1d20+@{base_attack_bonus}[BAB]+@{ability}[ABILITY]+@{proficiency_value}[PROF]+[[@{full_attack_penalty}]][FULL ATTACK]@{misc}@{bonus}]]}} {{damage2type=@{type}}} {{damage2=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]+@{damage_proficiency_value}[SPEC]@{damage_misc}]]}} {{crit2damage=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]+@{damage_proficiency_value}[SPEC]@{damage_misc}]]}} {{crit2effect=@{crit}}} {{r3name=@{name}}} {{r3=[[1d20+@{base_attack_bonus}[BAB]+@{ability}[ABILITY]+@{proficiency_value}[PROF]+@{full_attack_penalty}[FULL ATTACK]@{misc}@{bonus}]]}} {{damage3type=@{type}}} {{damage3=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]+@{damage_proficiency_value}[SPEC]@{damage_misc}]]}} {{crit3damage=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]+@{damage_proficiency_value}[SPEC]@{damage_misc}]]}} {{crit3effect=@{crit}}} {{r4name=@{name}}} {{r4=[[1d20+@{base_attack_bonus}[BAB]+@{ability}[ABILITY]+@{proficiency_value}[PROF]+@{full_attack_penalty}[FULL ATTACK]@{misc}@{bonus}]]}} {{damage4type=@{type}}} {{damage4=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]+@{damage_proficiency_value}[SPEC]@{damage_misc}]]}} {{crit4damage=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]+@{damage_proficiency_value}[SPEC]@{damage_misc}]]}} {{crit4effect=@{crit}}} {{r5name=@{name}}} {{r5=[[1d20+@{base_attack_bonus}[BAB]+@{ability}[ABILITY]+@{proficiency_value}[PROF]+@{full_attack_penalty}[FULL ATTACK]@{misc}@{bonus}]]}} {{damage5type=@{type}}} {{damage5=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]+@{damage_proficiency_value}[SPEC]@{damage_misc}]]}} {{crit5damage=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]+@{damage_proficiency_value}[SPEC]@{damage_misc}]]}} {{crit5effect=@{crit}}} {{range=@{range}}} {{ammo_type=@{ammo_type}}} {{curr_ammo=@{ammo}}} {{rightbanner=@{special}}} {{notes=@{description}}} @{attacher}'></button>
                                <label class='expand-button'><input hidden='true' class='expand-description' type='checkbox' name='attr_expand_description' value='1'><span class='collapsed pictos'>`</span><span class='expanded pictos'>J</span></label>
                            </div>
                            <input class='expand-description' type='hidden' name='attr_expand_description'>
                            <textarea class='description span-all' title='@{description}' name='attr_description' placeholder='Description'></textarea>
                        </div>
                    </div>
                </fieldset>
                <label class='pseudo-repcontrol'><input type='checkbox' title='@{create_npcranged}' name='attr_create_npcranged' value='ranged'><span>&</span></label>
            </div>
            <div class='row'>
                <span data-i18n='space'>SPACE</span>
                <input class='space' type='text' title='@{space}' name='attr_space' value='5 ft'>
                <span data-i18n='reach'>REACH</span>
                <input class='reach scalable-input input-field' type='text' title='@{reach}' name='attr_reach'>
            </div>
            <div class='row'>
                <span data-i18n='spells-known'>SPELLS KNOWN</span>
                <span data-i18n='(cl'>(CL</span>
                <input class='cl' type='number' title='@{caster_level}' name='attr_caster_level'>
                <span>)</span>
                <fieldset class='repeating_spell'><input hidden='true' type='text' title='@{attack_total}' name='attr_attack_total'><input hidden='true' type='text' title='@{damage_total}' name='attr_damage_total'>
                    <div class='spell'>
                        <input type='text' hidden='true' title='@{attack_misc}' name='attr_attack_misc' value=''>
                        <input type='text' hidden='true' title='@{effect_misc}' name='attr_effect_misc' value=''>
                        <input type='hidden' name='attr_dc' value='10'>
                        <input class="show-options" type="checkbox" title='@{show_options}' name="attr_show_options" checked="checked"><span>y</span>
                        <div class='row-options'>
                            <div class='row span-two display-margin'>
                                <span class='label' data-i18n='name-u'>NAME</span>
                                <input class='atk-name scalable-input input-field' type='text' title='@{name}' name='attr_name' placeholder="Operative's Edge">
                                <span class='label' data-i18n='lvl'>LVL</span>
                                <input class='atk-level' title='@{level}' name='attr_level' type='text' value=''>
                                <span class='label' data-i18n='spell-resistance-abbrv'>SR</span>
                                <input type='hidden' name='attr_spell_penetration_misc' value=''><select name='attr_spell_resistance'>
                                <option value='' data-i18n='no' selected>NO</option>
                                <option value='yes' data-i18n='yes'>YES</option>
                                </select>
                            </div>
                            <div class='row'>
                                <span class='label' data-i18n='source'>SOURCE</span>
                                <input class='scalable-input input-field' type='text' title='@{source}' name='attr_source' placeholder='Operative'>
                            </div>
                            <div class='row'>
                                <span class='label' data-i18n='school'>SCHOOL</span>
                                <input class='scalable-input input-field' title='@{school}' name='attr_school' type='text' placeholder='abjuration'>
                            </div>
                            <div class='row span-two'>
                                <span class='label' data-i18n='target'>TARGET</span>
                                <input class='scalable-input input-field' type='text' title='@{target}' name='attr_target' placeholder='self'>
                                <span class='label' data-i18n='rng'>RNG</span>
                                <input class='scalable-input input-field' type='text' title='@{range}' name='attr_range' placeholder='30 ft'>
                            </div>
                            <div class='row'>
                                <span class='label' data-i18n='duration'>DURATION</span>
                                <input class='scalable-input input-field' type='text' title='@{duration}' name='attr_duration' placeholder='1 round' value=''>
                            </div>
                            <div class='row'>
                                <span class='label abi-cost' data-i18n='usage'>USAGE</span>
                                <input class='scalable-input input-field' type='text' title='@{usage}' name='attr_usage' placeholder='Standard Action'>
                            </div>
                            <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                            <label class='expandable'><input class='field-tab atk-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'><span class='field label' data-i18n='atk'>ATK</span></label>
                            <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                            <div class='field-container expandable inherit-grid'>
                                <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                <div class='field row span-two'>
                                    <select class='label atk-ability abi' title='@{attack_ability}' name='attr_attack_ability'>
                                        <option value='@{strength_mod}' data-i18n='str' selected>STR</option>
                                        <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                        <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                        <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                        <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                        <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                    </select>
                                    <input hidden='true' title='@{attack_ability}' name='attr_attack_ability' value='0'>
                                    <span class='arith'>+</span>
                                    <input class='bab input-field' type='number' title='@{base_attack_bonus_base}' name='attr_base_attack_bonus_base' value='0'>
                                    <input class='bab input-field' type='hidden' title='@{base_attack_bonus_base}' name='attr_base_attack_bonus' value='0'>
                                    <input class='abi-misc' type='text' title='@{attack_bonus}' name='attr_attack_bonus' placeholder='+@{attr}/2 + ?{Query}'>
                                </div>
                            </div>
                            <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                            <label class='expandable'><input class='field-tab dmg-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'><span class='field label' data-i18n='dmg'>DMG</span></label>
                            <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                            <div class='field-container expandable inherit-grid'>
                                <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                <input hidden='true' title='@{damage_misc}' name='attr_damage_misc' value=''>
                                <div class='field row span-two'>
                                    <input class='abi-dmg-dice' type='text' name=attr_damage_dice placeholder='1d8'><span>+</span>
                                    <select class='label atk-ability abi' title='@{damage_ability}' name='attr_damage_ability'>
                                        <option value='' selected data-i18n='n/a'>N/A</option>
                                        <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                        <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                        <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                        <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                        <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                        <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                    </select>
                                    <input hidden='true' title='@{damage_ability}' name='attr_damage_ability' value='0'>
                                </div>
                                <div class='field row span-two'>
                                    <span class='label' data-i18n='type'>TYPE</span>
                                    <input class='scalable-input input-field' type='text' title='@{attack_type}' name='attr_attack_type' placeholder='Fire'>
                                    <span class='label' data-i18n='crit-effect'>CRIT EFFECT</span>
                                    <input class='scalable-input input-field' type='text' title='@{attack_crit}' name='attr_attack_crit' placeholder='Burn'>
                                </div>
                            </div>
                            <input class='field-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                            <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'><span class='label field' data-i18n='additional-attack'>ADDITIONAL ATTACKS</span></label>
                            <input class='field-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                            <div class='field-container expandable inherit-grid'>
                                <input class='field-tab macro-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                <div class='field row span-two'>
                                    <span data-i18n='roll-full-attack_'>ROLL FULL ATTACK: </span>
                                    <label class='scalable-input'><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='?{Full Attack|No,0|Yes,1}'><span class='label'  data-i18n='query'>QUERY</span></label>
                                    <label class='scalable-input'><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='1'><span class='label' data-i18n='always'>ALWAYS</span></label>
                                    <label class='scalable-input'><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='0' checked='checked'><span class='label'  data-i18n='never'>NEVER</span></label>
                                </div>
                                <div class='field row span-two'>
                                    <span class='label' data-i18n='number-of-attacks:'>NUMBER OF ATTACKS:</span>
                                    <input class='scalable-input attack-num' type='text' title='@{full_attack_number}' name='attr_full_attack_number' value='2'>
                                    <span class='label' data-i8n='full-attack-penalty:'>ATTACK PENALTY:</span>
                                    <input class='scalable-input attack-num' type='text' title='@{full_attack_penalty}' name='attr_full_attack_penalty' value='-4'>
                                </div>
                            </div>
                            <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                            <label class='expandable'><input class='field-tab save-effect-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'><span class='field label' data-i18n='save-effect'>SAVE EFFECT</span></label>
                            <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                            <div class='field-container expandable inherit-grid'>
                                <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                <div class='field row span-two'>
                                    <select class='label atk-ability abi' title='@{save_ability}' name='attr_save_ability'>
                                        <option value='@{strength_mod}' data-i18n='str' selected>STR</option>
                                        <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                        <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                        <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                        <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                        <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                    </select>
                                    <span class='label' data-i18n='based-dc_'>Based DC </span>
                                    <div class='attr-base-mod-container save-dc'>
                                        <input class='base-attr' type='number' title='@{dc}' name='attr_dc_base' value='10'>
                                        <input class='mod-buff' type='hidden' name='attr_dc_change' value='0'>
                                        <span class='modified-attr input-field' title='@{dc}' name='attr_dc' value='10'>10</span>
                                    </div>
                                    <select class='label save-type' title='@{save_type}' name='attr_save_type'>
                                        <option value='' selected>-</option>
                                        <option value='FORT' data-i18n='fort-save'>FORT SAVE</option>
                                        <option value='REF' data-i18n='ref-save'>REF SAVE</option>
                                        <option value='WILL' data-i18n='will-save'>WILL SAVE</option>
                                    </select>
                                </div>
                                <div class='field row span-two'>
                                    <textarea class='' title='@{effect}' name='attr_effect' placeholder='Effect on a Failed Save'></textarea>
                                </div>
                                <div class='field row span-two'>
                                    <span class='label' data-i18n='A-Sucessful-Save:'>A Sucessful Save:</span>
                                </div>
                                <div class='field row span-two'>
                                    <textarea class='' title='@{save_effect}' name='attr_save_effect' placeholder='Effect on a Successful Save'></textarea>
                                </div>
                            </div>
                            <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                            <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'><span class='label field' data-i18n='attacher'>ATTACHER</span></label>
                            <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                            <div class='row field-container mod-container expandable'>
                                <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                <textarea class='field row' type='text' title='@{attacher}' name='attr_attacher'></textarea>
                            </div>
                            <div class='row span-two'>
                                <textarea class='' title='@{description}' name='attr_description' placeholder='Description'></textarea>
                            </div>
                            <div class='row span-two'>
                                <input readonly=true class='id-label' title='@{id}' name='attr_id'></input>
                            </div>
                        </div>
                        <input type='hidden' name='attr_damage_ability_base' value='0'>
                        <div class='display'>
                            <div class='button-description'>
                                <input class='label' title='@{name}' name='attr_name' placeholder='Operative'>
                                <input class='label' name='attr_school' placeholder='Abjuration'>
                                <button class='npcsummary' type='roll' title='%{npc_roll}' name='roll_npc_roll' value='@{whisper_state}&{template:sf_spell} {{name=@{character_name}}} {{characterid=@{character_id}}} {{rightbanner=@{school}}} {{title=@{name}}} {{leftbanner=^{level} [[[[@{level}]]d1cs>2cf>2]]}} {{saveflag=[[1d@{save_checkbox}]]}} {{srflag=@{spell_resistance}}} {{srroll=[[1d20+@{caster_level}@{spell_penetration_misc}]]}} {{activation=@{usage}}} {{duration=@{duration}}} {{targets=@{target}}} {{range=@{range}}} {{savedc=@{dc}}} {{savetype=@{save_type}}} {{effect=@{effect}}} {{saveeffect=@{save_effect}}} {{attackflag=[[1d@{attack_checkbox}]]}}{{fullattack=[[@{full_attack_query}*(@{full_attack_number})]]}} {{r1=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+[[@{full_attack_query}*(@{full_attack_penalty})]][FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage1type=@{attack_type}}} {{damage1=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]@{damage_misc}]]}} {{crit1damage=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]@{damage_misc}]]}} {{crit1effect=@{attack_crit}}}  {{r2=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage2type=@{attack_type}}} {{damage2=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]@{damage_misc}]]}} {{crit2damage=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]@{damage_misc}]]}} {{crit2effect=@{attack_crit}}} {{r3=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage3type=@{attack_type}}} {{damage3=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]@{damage_misc}]]}} {{crit3damage=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]@{damage_misc}]]}} {{crit3effect=@{attack_crit}}} {{r4=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage4type=@{attack_type}}} {{damage4=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]@{damage_misc}]]}} {{crit4damage=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]@{damage_misc}]]}} {{crit4effect=@{attack_crit}}} {{r5=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage5type=@{attack_type}}} {{damage5=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]@{damage_misc}]]}} {{crit5damage=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]@{damage_misc}]]}} {{crit5effect=@{attack_crit}}} {{rightbanner=@{school}}}{{notes=@{description}}} @{attacher}'></button>
                                <label class='expand-button'><input hidden='true' class='expand-description' type='checkbox' name='attr_expand_description' value='1'><span class='collapsed pictos'>`</span><span class='expanded pictos'>J</span></label>
                            </div>
                            <input class='expand-description' type='hidden' name='attr_expand_description'>
                            <textarea class='description' title='@{description}' name='attr_description' placeholder='Description'></textarea>
                        </div>
                    </div>
                </fieldset>
            </div>
            <div class='statblock-section-header statistics-header'>
                <span data-i18n='statistics'>STATISTICS</span>
            </div>
            <div class='row ability-scores'>
                <span data-i18n='str'>STR</span>
                <div class='input-field attr-base-mod-container init'>
                    <input class='base-attr' type='number' title='@{strength_mod}' name='attr_strength_base' value='0'>
                    <input class='mod-buff' type='hidden' name='attr_strength_change' value='0'>
                    <span class='modified-attr input-field' title='@{strength_mod}' name='attr_strength_mod' value='0'>0</span>
                </div>
                <span data-i18n='dex'>DEX</span>
                <div class='input-field attr-base-mod-container init'>
                    <input class='base-attr input-field' type='number' title='@{dexterity_mod}' name='attr_dexterity_base' value='0'>
                    <input class='mod-buff' type='hidden' name='attr_dexterity_change' value='0'>
                    <span class='modified-attr input-field' title='@{dexterity_mod}' name='attr_dexterity_mod' value='0'>0</span>
                </div>
                <span data-i18n='con'>CON</span>
                <div class='input-field attr-base-mod-container init'>
                    <input class='base-attr input-field' type='number' title='@{constitution_mod}' name='attr_constitution_base' value='0'>
                    <input class='mod-buff' type='hidden' name='attr_constitution_change' value='0'>
                    <span class='modified-attr input-field' title='@{strength_mod}' name='attr_constitution_mod' value='0'>0</span>
                </div>
                <span data-i18n='int'>INT</span>
                <div class='input-field attr-base-mod-container init'>
                    <input class='base-attr input-field' type='number' title='@{intelligence_mod}' name='attr_intelligence_base' value='0'>
                    <input class='mod-buff' type='hidden' name='attr_intelligence_change' value='0'>
                    <span class='modified-attr input-field' title='@{intelligence_mod}' name='attr_intelligence_mod' value='0'>0</span>
                </div>
                <span data-i18n='wis'>WIS</span>
                <div class='input-field attr-base-mod-container init'>
                    <input class='base-attr input-field' type='number' title='@{wisdom_mod}' name='attr_wisdom_base' value='0'>
                    <input class='mod-buff' type='hidden' name='attr_wisdom_change' value='0'>
                    <span class='modified-attr input-field' title='@{wisdom_mod}' name='attr_wisdom_mod' value='0'>0</span>
                </div>
                <span data-i18n='cha'>CHA</span>
                <div class='input-field attr-base-mod-container init'>
                    <input class='base-attr input-field' type='number' title='@{charisma_mod}' name='attr_charisma_base' value='0'>
                    <input class='mod-buff' type='hidden' name='attr_charisma_change' value='0'>
                    <span class='modified-attr input-field' title='@{charisma_mod}' name='attr_charisma_mod' value='0'>0</span>
                </div>
            </div>
            <div class='row skills-row'>
                <span data-i18n='skills'>SKILLS</span>
                <div class='skill-container'>
                    <input class="show-options" type="checkbox" title='@{acrobatics_show_options}' name="attr_acrobatics_show_options"><span>y</span>
                    <div class='display'>
                        <input hidden='true' title='@{acrobatics_misc}' name='attr_acrobatics_misc' value=''>
                        <input class='ranks input-field' type='number' hidden='true' title='@{acrobatics_ranks}' name='attr_acrobatics_ranks' value='0'>
                        <input hidden='true' type='checkbox' title='@{acrobatics_class_skill}' name='attr_acrobatics_class_skill' value='3'>
                        <button class='acp' type='roll' title='%{acrobatics}' name='roll_acrobatics' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Acrobatics}}  {{r1=[[1d20+@{acrobatics_ranks}[Ranks]+[[({0,@{acrobatics_ranks}}>1)*@{acrobatics_class_skill}]][CS]+@{acrobatics_ability}[Ability]@{acrobatics_misc}]]}} {{notes=@{acrobatics_description}}}' data-i18n='acrobatics' >ACROBATICS</button>
                        <div class='attr-base-mod-container tot'>
                            <input class='base-attr input-field' type='number' title='@{acrobatics}' name='attr_acrobatics_base' value='0'>
                            <input class='mod-buff' type='hidden' name='attr_acrobatics_change' value='0'>
                            <span class='modified-attr input-field' title='@{acrobatics}' name='attr_acrobatics' value='0'>0</span>
                        </div>
                    </div>
                    <div class='row-options'>
                        <div class='row'>
                            <span class='skill-span label' data-i18n='acp'>ACP</span>
                            <input class='acp' type='checkbox' title='@{acrobatics_acp}' name='attr_acrobatics_acp' value='1' checked='checked'>
                            <select class='label abi input-field' title='@{acrobatics_ability}' name='attr_acrobatics_ability' style='width; .5em;'>
                                <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                <option value='@{dexterity_mod}' data-i18n='dex' selected>DEX</option>
                                <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                            </select>
                        </div>
                        <textarea class='skill-description input-field' title='@{acrobatics_description}' name='attr_acrobatics_description' placeholder='Notes'></textarea>
                        <input title='@{acrobatics_buff_notes}' name='attr_acrobatics_buff_notes' hidden='true'>
                    </div>
                </div>
                <div class='skill-container'>
                    <input class="show-options" type="checkbox" title='@{athletics_show_options}' name="attr_athletics_show_options"><span>y</span>
                    <div class='display'>
                        <input hidden='true' title='@{athletics_misc}' name='attr_athletics_misc' value=''>
                        <input class='ranks input-field' type='number' hidden='true' title='@{athletics_ranks}' name='attr_athletics_ranks' value='0'>
                        <input hidden='true' type='checkbox' title='@{athletics_class_skill}' name='attr_athletics_class_skill' value='3'>
                        <button class='acp' type='roll' title='%{athletics}' name='roll_athletics' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Athletics}}  {{r1=[[1d20+@{athletics_ranks}[RANKS]+[[({0,@{athletics_ranks}}>1)*@{athletics_class_skill}]][CS]+@{athletics_ability}[ABILITY]@{athletics_misc}]]}} {{notes=@{athletics_description}}}' data-i18n='athletics' >ATHLETICS</button>
                        <div class='attr-base-mod-container tot'>
                            <input class='base-attr input-field' type='number' title='@{athletics}' name='attr_athletics_base' value='0'>
                            <input class='mod-buff' type='hidden' name='attr_athletics_change' value='0'>
                            <span class='modified-attr input-field' title='@{athletics}' name='attr_athletics' value='0'>0</span>
                        </div>
                    </div>
                    <div class='row-options'>
                        <div class='row'>
                            <span class='skill-span label' data-i18n='acp'>ACP</span>
                            <input class='acp' type='checkbox' title='@{athletics_acp}' name='attr_athletics_acp' value='1' checked='checked'>
                            <select class='label abi input-field' title='@{athletics_ability}' name='attr_athletics_ability' style='width; .5em;'>
                                <option value='@{strength_mod}' data-i18n='str' selected>STR</option>
                                <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                            </select>
                        </div>
                        <textarea class='skill-description input-field' title='@{athletics_description}' name='attr_athletics_description' placeholder='Notes'></textarea>
                        <input title='@{athletics_buff_notes}' name='attr_athletics_buff_notes' hidden='true'>
                    </div>
                </div>
                <div class='skill-container'>
                    <input class="show-options" type="checkbox" title='@{bluff_show_options}' name="attr_bluff_show_options"><span>y</span>
                    <div class='display'>
                        <input hidden='true' title='@{bluff_misc}' name='attr_bluff_misc' value=''>
                        <input class='ranks input-field' type='number' hidden='true' title='@{bluff_ranks}' name='attr_bluff_ranks' value='0'>
                        <input hidden='true' type='checkbox' title='@{bluff_class_skill}' name='attr_bluff_class_skill' value='3'>
                        <button class='acp' type='roll' title='%{bluff}' name='roll_bluff' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Bluff}}  {{r1=[[1d20+@{bluff_ranks}[RANKS]+[[({0,@{bluff_ranks}}>1)*@{bluff_class_skill}]][CS]+@{bluff_ability}[ABILITY]@{bluff_misc}]]}} {{notes=@{bluff_description}}}' data-i18n='bluff' >BLUFF </button>
                        <div class='attr-base-mod-container tot'>
                            <input class='base-attr input-field' type='number' title='@{bluff}' name='attr_bluff_base' value='0'>
                            <input class='mod-buff' type='hidden' name='attr_bluff_change' value='0'>
                            <span class='modified-attr input-field' title='@{bluff}' name='attr_bluff' value='0'>0</span>
                        </div>
                    </div>
                    <div class='row-options'>
                        <div class='row'>
                            <span class='skill-span label' data-i18n='acp'>ACP</span>
                            <input class='acp' type='checkbox' title='@{bluff_acp}' name='attr_bluff_acp' value='1'>
                            <select class='label abi input-field' title='@{bluff_ability}' name='attr_bluff_ability' style='width; .5em;'>
                                <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                <option value='@{charisma_mod}' data-i18n='cha' selected>CHA</option>
                            </select>
                        </div>
                        <textarea class='skill-description input-field' title='@{bluff_description}' name='attr_bluff_description' placeholder='Notes'></textarea>
                        <input title='@{bluff_buff_notes}' name='attr_bluff_buff_notes' hidden='true'>
                    </div>
                </div>
                <div class='skill-container'>
                    <input class="show-options" type="checkbox" title='@{computers_show_options}' name="attr_computers_show_options"><span>y</span>
                    <div class='display'>
                        <input hidden='true' title='@{computers_misc}' name='attr_computers_misc' value=''>
                        <input class='ranks input-field' type='number' hidden='true' title='@{computers_ranks}' name='attr_computers_ranks' value='0'>
                        <input hidden='true' type='checkbox' title='@{computers_class_skill}' name='attr_computers_class_skill' value='3'>
                        <button class='acp' type='roll' title='%{computers}' name='roll_computers' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Computers}}  {{r1=[[1d20+@{computers_ranks}[RANKS]+[[({0,@{computers_ranks}}>1)*@{computers_class_skill}]][CS]+@{computers_ability}[ABILITY]@{computers_misc}]]}} {{notes=@{computers_description}}}' data-i18n='computers' >COMPUTERS</button>
                        <div class='attr-base-mod-container tot'>
                            <input class='base-attr input-field' type='number' title='@{computers}' name='attr_computers_base' value='0'>
                            <input class='mod-buff' type='hidden' name='attr_computers_change' value='0'>
                            <span class='modified-attr input-field' title='@{computers}' name='attr_computers' value='0'>0</span>
                        </div>
                    </div>
                    <div class='row-options'>
                        <div class='row'>
                            <span class='skill-span label' data-i18n='acp'>ACP</span>
                            <input class='acp' type='checkbox' title='@{computers_acp}' name='attr_computers_acp' value='1'>
                            <select class='label abi input-field' title='@{computers_ability}' name='attr_computers_ability' style='width; .5em;'>
                                <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                <option value='@{intelligence_mod}' data-i18n='int' selected>INT</option>
                                <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                            </select>
                        </div>
                        <textarea class='skill-description input-field' title='@{computers_description}' name='attr_computers_description' placeholder='Notes'></textarea>
                        <input title='@{computers_buff_notes}' name='attr_computers_buff_notes' hidden='true'>
                    </div>
                </div>
                <div class='skill-container'>
                    <input class="show-options" type="checkbox" title='@{culture_show_options}' name="attr_culture_show_options"><span>y</span>
                    <div class='display'>
                        <input hidden='true' title='@{culture_misc}' name='attr_culture_misc' value=''>
                        <input class='ranks input-field' type='number' hidden='true' title='@{culture_ranks}' name='attr_culture_ranks' value='0'>
                        <input hidden='true' type='checkbox' title='@{culture_class_skill}' name='attr_culture_class_skill' value='3'>
                        <button class='acp' type='roll' title='%{culture}' name='roll_culture' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Culture}}  {{r1=[[1d20+@{culture_ranks}[RANKS]+[[({0,@{culture_ranks}}>1)*@{culture_class_skill}]][CS]+@{culture_ability}[ABILITY]@{culture_misc}]]}} {{notes=@{culture_description}}}' data-i18n='culture' >CULTURE</button>
                        <div class='attr-base-mod-container tot'>
                            <input class='base-attr input-field' type='number' title='@{culture}' name='attr_culture_base' value='0'>
                            <input class='mod-buff' type='hidden' name='attr_culture_change' value='0'>
                            <span class='modified-attr input-field' title='@{culture}' name='attr_culture' value='0'>0</span>
                        </div>
                    </div>
                    <div class='row-options'>
                        <div class='row'>
                            <span class='skill-span label' data-i18n='acp'>ACP</span>
                            <input class='acp' type='checkbox' title='@{culture_acp}' name='attr_culture_acp' value='1'>
                            <select class='label abi input-field' title='@{culture_ability}' name='attr_culture_ability' style='width; .5em;'>
                                <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                <option value='@{intelligence_mod}' data-i18n='int' selected>INT</option>
                                <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                            </select>
                        </div>
                        <textarea class='skill-description input-field' title='@{culture_description}' name='attr_culture_description' placeholder='Notes'></textarea>
                        <input title='@{culture_buff_notes}' name='attr_culture_buff_notes' hidden='true'>
                    </div>
                </div>
                <div class='skill-container'>
                    <input class="show-options" type="checkbox" title='@{diplomacy_show_options}' name="attr_diplomacy_show_options"><span>y</span>
                    <div class='display'>
                        <input hidden='true' title='@{diplomacy_misc}' name='attr_diplomacy_misc' value=''>
                        <input class='ranks input-field' type='number' hidden='true' title='@{diplomacy_ranks}' name='attr_diplomacy_ranks' value='0'>
                        <input hidden='true' type='checkbox' title='@{diplomacy_class_skill}' name='attr_diplomacy_class_skill' value='3'>
                        <button class='acp' type='roll' title='%{diplomacy}' name='roll_diplomacy' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Diplomacy}}  {{r1=[[1d20+@{diplomacy_ranks}[RANKS]+[[({0,@{diplomacy_ranks}}>1)*@{diplomacy_class_skill}]][CS]+@{diplomacy_ability}[ABILITY]@{diplomacy_misc}]]}} {{notes=@{diplomacy_description}}}' data-i18n='diplomacy' >DIPLOMACY</button>
                        <div class='attr-base-mod-container tot'>
                            <input class='base-attr input-field' type='number' title='@{diplomacy}' name='attr_diplomacy_base' value='0'>
                            <input class='mod-buff' type='hidden' name='attr_diplomacy_change' value='0'>
                            <span class='modified-attr input-field' title='@{diplomacy}' name='attr_diplomacy' value='0'>0</span>
                        </div>
                    </div>
                    <div class='row-options'>
                        <div class='row'>
                            <span class='skill-span label' data-i18n='acp'>ACP</span>
                            <input class='acp' type='checkbox' title='@{diplomacy_acp}' name='attr_diplomacy_acp' value='1'>
                            <select class='label abi input-field' title='@{diplomacy_ability}' name='attr_diplomacy_ability' style='width; .5em;'>
                                <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                <option value='@{charisma_mod}' data-i18n='cha' selected>CHA</option>
                            </select>
                        </div>
                        <textarea class='skill-description input-field' title='@{diplomacy_description}' name='attr_diplomacy_description' placeholder='Notes'></textarea>
                        <input title='@{diplomacy_buff_notes}' name='attr_diplomacy_buff_notes' hidden='true'>
                    </div>
                </div>
                <div class='skill-container'>
                    <input class="show-options" type="checkbox" title='@{disguise_show_options}' name="attr_disguise_show_options"><span>y</span>
                    <div class='display'>
                        <input hidden='true' title='@{disguise_misc}' name='attr_disguise_misc' value=''>
                        <input class='ranks input-field' type='number' hidden='true' title='@{disguise_ranks}' name='attr_disguise_ranks' value='0'>
                        <input hidden='true' type='checkbox' title='@{disguise_class_skill}' name='attr_disguise_class_skill' value='3'>
                        <button class='acp' type='roll' title='%{disguise}' name='roll_disguise' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Disguise}}  {{r1=[[1d20+@{disguise_ranks}[RANKS]+[[({0,@{disguise_ranks}}>1)*@{disguise_class_skill}]][CS]+@{disguise_ability}[ABILITY]@{disguise_misc}]]}} {{notes=@{disguise_description}}}' data-i18n='disguise' >DISGUISE</button>
                        <div class='attr-base-mod-container tot'>
                            <input class='base-attr input-field' type='number' title='@{disguise}' name='attr_disguise_base' value='0'>
                            <input class='mod-buff' type='hidden' name='attr_disguise_change' value='0'>
                            <span class='modified-attr input-field' title='@{disguise}' name='attr_disguise' value='0'>0</span>
                        </div>
                    </div>
                    <div class='row-options'>
                        <div class='row'>
                            <span class='skill-span label' data-i18n='acp'>ACP</span>
                            <input class='acp' type='checkbox' title='@{disguise_acp}' name='attr_disguise_acp' value='1'>
                            <select class='label abi input-field' title='@{disguise_ability}' name='attr_disguise_ability' style='width; .5em;'>
                                <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                <option value='@{charisma_mod}' data-i18n='cha' selected>CHA</option>
                            </select>
                        </div>
                        <textarea class='skill-description input-field' title='@{disguise_description}' name='attr_disguise_description' placeholder='Notes'></textarea>
                        <input title='@{disguise_buff_notes}' name='attr_disguise_buff_notes' hidden='true'>
                    </div>
                </div>
                <div class='skill-container'>
                    <input class="show-options" type="checkbox" title='@{engineering_show_options}' name="attr_engineering_show_options"><span>y</span>
                    <div class='display'>
                        <input hidden='true' title='@{engineering_misc}' name='attr_engineering_misc' value=''>
                        <input class='ranks input-field' type='number' hidden='true' title='@{engineering_ranks}' name='attr_engineering_ranks' value='0'>
                        <input hidden='true' type='checkbox' title='@{engineering_class_skill}' name='attr_engineering_class_skill' value='3'>
                        <button class='acp' type='roll' title='%{engineering}' name='roll_engineering' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Engineering}}  {{r1=[[1d20+@{engineering_ranks}[RANKS]+[[({0,@{engineering_ranks}}>1)*@{engineering_class_skill}]][CS]+@{engineering_ability}[ABILITY]@{engineering_misc}]]}} {{notes=@{engineering_description}}}' data-i18n='engineering' >ENGINEERING</button>
                        <div class='attr-base-mod-container tot'>
                            <input class='base-attr input-field' type='number' title='@{engineering}' name='attr_engineering_base' value='0'>
                            <input class='mod-buff' type='hidden' name='attr_engineering_change' value='0'>
                            <span class='modified-attr input-field' title='@{engineering}' name='attr_engineering' value='0'>0</span>
                        </div>
                    </div>
                    <div class='row-options'>
                        <div class='row'>
                            <span class='skill-span label' data-i18n='acp'>ACP</span>
                            <input class='acp' type='checkbox' title='@{engineering_acp}' name='attr_engineering_acp' value='1'>
                            <select class='label abi input-field' title='@{engineering_ability}' name='attr_engineering_ability' style='width; .5em;'>
                                <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                <option value='@{intelligence_mod}' data-i18n='int' selected>INT</option>
                                <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                            </select>
                        </div>
                        <textarea class='skill-description input-field' title='@{engineering_description}' name='attr_engineering_description' placeholder='Notes'></textarea>
                        <input title='@{engineering_buff_notes}' name='attr_engineering_buff_notes' hidden='true'>
                    </div>
                </div>
                <div class='skill-container'>
                    <input class="show-options" type="checkbox" title='@{intimidate_show_options}' name="attr_intimidate_show_options"><span>y</span>
                    <div class='display'>
                        <input hidden='true' title='@{intimidate_misc}' name='attr_intimidate_misc' value=''>
                        <input class='ranks input-field' type='number' hidden='true' title='@{intimidate_ranks}' name='attr_intimidate_ranks' value='0'>
                        <input hidden='true' type='checkbox' title='@{intimidate_class_skill}' name='attr_intimidate_class_skill' value='3'>
                        <button class='acp' type='roll' title='%{intimidate}' name='roll_intimidate' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Intimidate}}  {{r1=[[1d20+@{intimidate_ranks}[RANKS]+[[({0,@{intimidate_ranks}}>1)*@{intimidate_class_skill}]][CS]+@{intimidate_ability}[ABILITY]@{intimidate_misc}]]}} {{notes=@{intimidate_description}}}' data-i18n='intimidate' >INTIMIDATE</button>
                        <div class='attr-base-mod-container tot'>
                            <input class='base-attr input-field' type='number' title='@{intimidate}' name='attr_intimidate_base' value='0'>
                            <input class='mod-buff' type='hidden' name='attr_intimidate_change' value='0'>
                            <span class='modified-attr input-field' title='@{intimidate}' name='attr_intimidate' value='0'>0</span>
                        </div>
                    </div>
                    <div class='row-options'>
                        <div class='row'>
                            <span class='skill-span label' data-i18n='acp'>ACP</span>
                            <input class='acp' type='checkbox' title='@{intimidate_acp}' name='attr_intimidate_acp' value='1'>
                            <select class='label abi input-field' title='@{intimidate_ability}' name='attr_intimidate_ability' style='width; .5em;'>
                                <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                <option value='@{charisma_mod}' data-i18n='cha' selected>CHA</option>
                            </select>
                        </div>
                        <textarea class='skill-description input-field' title='@{intimidate_description}' name='attr_intimidate_description' placeholder='Notes'></textarea>
                        <input title='@{intimidate_buff_notes}' name='attr_intimidate_buff_notes' hidden='true'>
                    </div>
                </div>
                <div class='skill-container'>
                    <input class="show-options" type="checkbox" title='@{life_science_show_options}' name="attr_life_science_show_options"><span>y</span>
                    <div class='display'>
                        <input hidden='true' title='@{life_science_misc}' name='attr_life_science_misc' value=''>
                        <input class='ranks input-field' type='number' hidden='true' title='@{life_science_ranks}' name='attr_life_science_ranks' value='0'>
                        <input hidden='true' type='checkbox' title='@{life_science_class_skill}' name='attr_life_science_class_skill' value='3'>
                        <button class='acp' type='roll' title='%{life_science}' name='roll_life_science' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Life Science}}  {{r1=[[1d20+@{life_science_ranks}[RANKS]+[[({0,@{life_science_ranks}}>1)*@{life_science_class_skill}]][CS]+@{life_science_ability}[ABILITY]@{life_science_misc}]]}} {{notes=@{life_science_description}}}' data-i18n='life-science' >LIFE SCIENCE</button>
                        <div class='attr-base-mod-container tot'>
                            <input class='base-attr input-field' type='number' title='@{life_science}' name='attr_life_science_base' value='0'>
                            <input class='mod-buff' type='hidden' name='attr_life_science_change' value='0'>
                            <span class='modified-attr input-field' title='@{life_science}' name='attr_life_science' value='0'>0</span>
                        </div>
                    </div>
                    <div class='row-options'>
                        <div class='row'>
                            <span class='skill-span label' data-i18n='acp'>ACP</span>
                            <input class='acp' type='checkbox' title='@{life_science_acp}' name='attr_life_science_acp' value='1'>
                            <select class='label abi input-field' title='@{life_science_ability}' name='attr_life_science_ability' style='width; .5em;'>
                                <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                <option value='@{intelligence_mod}' data-i18n='int' selected>INT</option>
                                <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                            </select>
                        </div>
                        <textarea class='skill-description input-field' title='@{life_science_description}' name='attr_life_science_description' placeholder='Notes'></textarea>
                        <input title='@{life_science_buff_notes}' name='attr_life_science_buff_notes' hidden='true'>
                    </div>
                </div>
                <div class='skill-container'>
                    <input class="show-options" type="checkbox" title='@{medicine_show_options}' name="attr_medicine_show_options"><span>y</span>
                    <div class='display'>
                        <input hidden='true' title='@{medicine_misc}' name='attr_medicine_misc' value=''>
                        <input class='ranks input-field' type='number' hidden='true' title='@{medicine_ranks}' name='attr_medicine_ranks' value='0'>
                        <input hidden='true' type='checkbox' title='@{medicine_class_skill}' name='attr_medicine_class_skill' value='3'>
                        <button class='acp' type='roll' title='%{medicine}' name='roll_medicine' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Medicine}}  {{r1=[[1d20+@{medicine_ranks}[RANKS]+[[({0,@{medicine_ranks}}>1)*@{medicine_class_skill}]][CS]+@{medicine_ability}[ABILITY]@{medicine_misc}]]}} {{notes=@{medicine_description}}}' data-i18n='medicine' >MEDICINE </button>
                        <div class='attr-base-mod-container tot'>
                            <input class='base-attr input-field' type='number' title='@{medicine}' name='attr_medicine_base' value='0'>
                            <input class='mod-buff' type='hidden' name='attr_medicine_change' value='0'>
                            <span class='modified-attr input-field' title='@{medicine}' name='attr_medicine' value='0'>0</span>
                        </div>
                    </div>
                    <div class='row-options'>
                        <div class='row'>
                            <span class='skill-span label' data-i18n='acp'>ACP</span>
                            <input class='acp' type='checkbox' title='@{medicine_acp}' name='attr_medicine_acp' value='1'>
                            <select class='label abi input-field' title='@{medicine_ability}' name='attr_medicine_ability' style='width; .5em;'>
                                <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                <option value='@{intelligence_mod}' data-i18n='int' selected>INT</option>
                                <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                            </select>
                        </div>
                        <textarea class='skill-description input-field' title='@{medicine_description}' name='attr_medicine_description' placeholder='Notes'></textarea>
                        <input title='@{medicine_buff_notes}' name='attr_medicine_buff_notes' hidden='true'>
                    </div>
                </div>
                <div class='skill-container'>
                    <input class="show-options" type="checkbox" title='@{mysticism_show_options}' name="attr_mysticism_show_options"><span>y</span>
                    <div class='display'>
                        <input hidden='true' title='@{mysticism_misc}' name='attr_mysticism_misc' value=''>
                        <input class='ranks input-field' type='number' hidden='true' title='@{mysticism_ranks}' name='attr_mysticism_ranks' value='0'>
                        <input hidden='true' type='checkbox' title='@{mysticism_class_skill}' name='attr_mysticism_class_skill' value='3'>
                        <button class='acp' type='roll' title='%{mysticism}' name='roll_mysticism' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Mysticism}}  {{r1=[[1d20+@{mysticism_ranks}[RANKS]+[[({0,@{mysticism_ranks}}>1)*@{mysticism_class_skill}]][CS]+@{mysticism_ability}[ABILITY]@{mysticism_misc}]]}} {{notes=@{mysticism_description}}}' data-i18n='mysticism' >MYSTICISM </button>
                        <div class='attr-base-mod-container tot'>
                            <input class='base-attr input-field' type='number' title='@{mysticism}' name='attr_mysticism_base' value='0'>
                            <input class='mod-buff' type='hidden' name='attr_mysticism_change' value='0'>
                            <span class='modified-attr input-field' title='@{mysticism}' name='attr_mysticism' value='0'>0</span>
                        </div>
                    </div>
                    <div class='row-options'>
                        <div class='row'>
                            <span class='skill-span label' data-i18n='acp'>ACP</span>
                            <input class='acp' type='checkbox' title='@{mysticism_acp}' name='attr_mysticism_acp' value='1'>
                            <select class='label abi input-field' title='@{mysticism_ability}' name='attr_mysticism_ability' style='width; .5em;'>
                                <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                <option value='@{wisdom_mod}' data-i18n='wis' selected>WIS</option>
                                <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                            </select>
                        </div>
                        <textarea class='skill-description input-field' title='@{mysticism_description}' name='attr_mysticism_description' placeholder='Notes'></textarea>
                        <input title='@{mysticism_buff_notes}' name='attr_mysticism_buff_notes' hidden='true'>
                    </div>
                </div>
                <div class='skill-container'>
                    <input class="show-options" type="checkbox" title='@{perception_show_options}' name="attr_perception_show_options"><span>y</span>
                    <div class='display'>
                        <input hidden='true' title='@{perception_misc}' name='attr_perception_misc' value=''>
                        <input class='ranks input-field' type='number' hidden='true' title='@{perception_ranks}' name='attr_perception_ranks' value='0'>
                        <input hidden='true' type='checkbox' title='@{perception_class_skill}' name='attr_perception_class_skill' value='3'>
                        <button class='acp' type='roll' title='%{perception}' name='roll_perception' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Perception}}  {{r1=[[1d20+@{perception_ranks}[RANKS]+[[({0,@{perception_ranks}}>1)*@{perception_class_skill}]][CS]+@{perception_ability}[ABILITY]@{perception_misc}]]}} {{notes=@{perception_description}}}' data-i18n='perception' >PERCEPTION </button>
                        <div class='attr-base-mod-container tot'>
                            <input class='base-attr input-field' type='number' title='@{perception}' name='attr_perception_base' value='0'>
                            <input class='mod-buff' type='hidden' name='attr_perception_change' value='0'>
                            <span class='modified-attr input-field' title='@{perception}' name='attr_perception' value='0'>0</span>
                        </div>
                    </div>
                    <div class='row-options'>
                        <div class='row'>
                            <span class='skill-span label' data-i18n='acp'>ACP</span>
                            <input class='acp' type='checkbox' title='@{perception_acp}' name='attr_perception_acp' value='1'>
                            <select class='label abi input-field' title='@{perception_ability}' name='attr_perception_ability' style='width; .5em;'>
                                <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                <option value='@{wisdom_mod}' data-i18n='wis' selected>WIS</option>
                                <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                            </select>
                        </div>
                        <textarea class='skill-description input-field' title='@{perception_description}' name='attr_perception_description' placeholder='Notes'></textarea>
                        <input title='@{perception_buff_notes}' name='attr_perception_buff_notes' hidden='true'>
                    </div>
                </div>
                <div class='skill-container'>
                    <input class="show-options" type="checkbox" title='@{physical_science_show_options}' name="attr_physical_science_show_options"><span>y</span>
                    <div class='display'>
                        <input hidden='true' title='@{physical_science_misc}' name='attr_physical_science_misc' value=''>
                        <input class='ranks input-field' type='number' hidden='true' title='@{physical_science_ranks}' name='attr_physical_science_ranks' value='0'>
                        <input hidden='true' type='checkbox' title='@{physical_science_class_skill}' name='attr_physical_science_class_skill' value='3'>
                        <button class='acp' type='roll' title='%{physical_science}' name='roll_physical_science' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Physical Science}}  {{r1=[[1d20+@{physical_science_ranks}[RANKS]+[[({0,@{physical_science_ranks}}>1)*@{physical_science_class_skill}]][CS]+@{physical_science_ability}[ABILITY]@{physical_science_misc}]]}} {{notes=@{physical_science_description}}}' data-i18n='physical-science' >PHYSICAL SCIENCE</button>
                        <div class='attr-base-mod-container tot'>
                            <input class='base-attr input-field' type='number' title='@{physical_science}' name='attr_physical_science_base' value='0'>
                            <input class='mod-buff' type='hidden' name='attr_physical_science_change' value='0'>
                            <span class='modified-attr input-field' title='@{physical_science}' name='attr_physical_science' value='0'>0</span>
                        </div>
                    </div>
                    <div class='row-options'>
                        <div class='row'>
                            <span class='skill-span label' data-i18n='acp'>ACP</span>
                            <input class='acp' type='checkbox' title='@{physical_science_acp}' name='attr_physical_science_acp' value='1'>
                            <select class='label abi input-field' title='@{physical_science_ability}' name='attr_physical_science_ability' style='width; .5em;'>
                                <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                <option value='@{intelligence_mod}' data-i18n='int' selected>INT</option>
                                <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                            </select>
                        </div>
                        <textarea class='skill-description input-field' title='@{physical_science_description}' name='attr_physical_science_description' placeholder='Notes'></textarea>
                        <input title='@{physical_science_buff_notes}' name='attr_physical_science_buff_notes' hidden='true'>
                    </div>
                </div>
                <div class='skill-container'>
                    <input class="show-options" type="checkbox" title='@{piloting_show_options}' name="attr_piloting_show_options"><span>y</span>
                    <div class='display'>
                        <input hidden='true' title='@{piloting_misc}' name='attr_piloting_misc' value=''>
                        <input class='ranks input-field' type='number' hidden='true' title='@{piloting_ranks}' name='attr_piloting_ranks' value='0'>
                        <input hidden='true' type='checkbox' title='@{piloting_class_skill}' name='attr_piloting_class_skill' value='3'>
                        <button class='acp' type='roll' title='%{piloting}' name='roll_piloting' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Piloting}}  {{r1=[[1d20+@{piloting_ranks}[RANKS]+[[({0,@{piloting_ranks}}>1)*@{piloting_class_skill}]][CS]+@{piloting_ability}[ABILITY]@{piloting_misc}]]}} {{notes=@{piloting_description}}}' data-i18n='piloting' >PILOTING</button>
                        <div class='attr-base-mod-container tot'>
                            <input class='base-attr input-field' type='number' title='@{piloting}' name='attr_piloting_base' value='0'>
                            <input class='mod-buff' type='hidden' name='attr_piloting_change' value='0'>
                            <span class='modified-attr input-field' title='@{piloting}' name='attr_piloting' value='0'>0</span>
                        </div>
                    </div>
                    <div class='row-options'>
                        <div class='row'>
                            <span class='skill-span label' data-i18n='acp'>ACP</span>
                            <input class='acp' type='checkbox' title='@{piloting_acp}' name='attr_piloting_acp' value='1'>
                            <select class='label abi input-field' title='@{piloting_ability}' name='attr_piloting_ability' style='width; .5em;'>
                                <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                <option value='@{dexterity_mod}' data-i18n='dex' selected>DEX</option>
                                <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                            </select>
                        </div>
                        <textarea class='skill-description input-field' title='@{piloting_description}' name='attr_piloting_description' placeholder='Notes'></textarea>
                        <input title='@{piloting_buff_notes}' name='attr_piloting_buff_notes' hidden='true'>
                    </div>
                </div>
                <div class='skill-container'>
                    <input class="show-options" type="checkbox" title='@{sense_motive_show_options}' name="attr_sense_motive_show_options"><span>y</span>
                    <div class='display'>
                        <input hidden='true' title='@{sense_motive_misc}' name='attr_sense_motive_misc' value=''>
                        <input class='ranks input-field' type='number' hidden='true' title='@{sense_motive_ranks}' name='attr_sense_motive_ranks' value='0'>
                        <input hidden='true' type='checkbox' title='@{sense_motive_class_skill}' name='attr_sense_motive_class_skill' value='3'>
                        <button class='acp' type='roll' title='%{sense_motive}' name='roll_sense_motive' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Sense Motive}}  {{r1=[[1d20+@{sense_motive_ranks}[RANKS]+[[({0,@{sense_motive_ranks}}>1)*@{sense_motive_class_skill}]][CS]+@{sense_motive_ability}[ABILITY]@{sense_motive_misc}]]}} {{notes=@{sense_motive_description}}}' data-i18n='sense-motive' >SENSE MOTIVE</button>
                        <div class='attr-base-mod-container tot'>
                            <input class='base-attr input-field' type='number' title='@{sense_motive}' name='attr_sense_motive_base' value='0'>
                            <input class='mod-buff' type='hidden' name='attr_sense_motive_change' value='0'>
                            <span class='modified-attr input-field' title='@{sense_motive}' name='attr_sense_motive' value='0'>0</span>
                        </div>
                    </div>
                    <div class='row-options'>
                        <div class='row'>
                            <span class='skill-span label' data-i18n='acp'>ACP</span>
                            <input class='acp' type='checkbox' title='@{sense_motive_acp}' name='attr_sense_motive_acp' value='1'>
                            <select class='label abi input-field' title='@{sense_motive_ability}' name='attr_sense_motive_ability' style='width; .5em;'>
                                <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                <option value='@{wisdom_mod}' data-i18n='wis' selected>WIS</option>
                                <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                            </select>
                        </div>
                        <textarea class='skill-description input-field' title='@{sense_motive_description}' name='attr_sense_motive_description' placeholder='Notes'></textarea>
                        <input title='@{sense_motive_buff_notes}' name='attr_sense_motive_buff_notes' hidden='true'>
                    </div>
                </div>
                <div class='skill-container'>
                    <input class="show-options" type="checkbox" title='@{sleight_of_hand_show_options}' name="attr_sleight_of_hand_show_options"><span>y</span>
                    <div class='display'>
                        <input hidden='true' title='@{sleight_of_hand_misc}' name='attr_sleight_of_hand_misc' value=''>
                        <input class='ranks input-field' type='number' hidden='true' title='@{sleight_of_hand_ranks}' name='attr_sleight_of_hand_ranks' value='0'>
                        <input hidden='true' type='checkbox' title='@{sleight_of_hand_class_skill}' name='attr_sleight_of_hand_class_skill' value='3'>
                        <button class='acp' type='roll' title='%{sleight_of_hand}' name='roll_sleight_of_hand' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Sleight of Hand}}  {{r1=[[1d20+@{sleight_of_hand_ranks}[RANKS]+[[({0,@{sleight_of_hand_ranks}}>1)*@{sleight_of_hand_class_skill}]][CS]+@{sleight_of_hand_ability}[ABILITY]@{sleight_of_hand_misc}]]}} {{notes=@{sleight_of_hand_description}}}' data-i18n='sleight-of-hand' >SLEIGHT OF HAND</button>
                        <div class='attr-base-mod-container tot'>
                            <input class='base-attr input-field' type='number' title='@{sleight_of_hand}' name='attr_sleight_of_hand_base' value='0'>
                            <input class='mod-buff' type='hidden' name='attr_sleight_of_hand_change' value='0'>
                            <span class='modified-attr input-field' title='@{sleight_of_hand}' name='attr_sleight_of_hand' value='0'>0</span>
                        </div>
                    </div>
                    <div class='row-options'>
                        <div class='row'>
                            <span class='skill-span label' data-i18n='acp'>ACP</span>
                            <input class='acp' type='checkbox' title='@{sleight_of_hand_acp}' name='attr_sleight_of_hand_acp' value='1' checked='checked'>
                            <select class='label abi input-field' title='@{sleight_of_hand_ability}' name='attr_sleight_of_hand_ability' style='width; .5em;'>
                                <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                <option value='@{dexterity_mod}' data-i18n='dex' selected>DEX</option>
                                <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                            </select>
                        </div>
                        <textarea class='skill-description input-field' title='@{sleight_of_hand_description}' name='attr_sleight_of_hand_description' placeholder='Notes'></textarea>
                        <input title='@{sleight_of_hand_buff_notes}' name='attr_sleight_of_hand_buff_notes' hidden='true'>
                    </div>
                </div>
                <div class='skill-container'>
                    <input class="show-options" type="checkbox" title='@{stealth_show_options}' name="attr_stealth_show_options"><span>y</span>
                    <div class='display'>
                        <input hidden='true' title='@{stealth_misc}' name='attr_stealth_misc' value=''>
                        <input class='ranks input-field' type='number' hidden='true' title='@{stealth_ranks}' name='attr_stealth_ranks' value='0'>
                        <input hidden='true' type='checkbox' title='@{stealth_class_skill}' name='attr_stealth_class_skill' value='3'>
                        <button class='acp' type='roll' title='%{stealth}' name='roll_stealth' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Stealth}}  {{r1=[[1d20+@{stealth_ranks}[RANKS]+[[({0,@{stealth_ranks}}>1)*@{stealth_class_skill}]][CS]+@{stealth_ability}[ABILITY]@{stealth_misc}]]}} {{notes=@{stealth_description}}}' data-i18n='stealth' >STEALTH</button>
                        <div class='attr-base-mod-container tot'>
                            <input class='base-attr input-field' type='number' title='@{stealth}' name='attr_stealth_base' value='0'>
                            <input class='mod-buff' type='hidden' name='attr_stealth_change' value='0'>
                            <span class='modified-attr input-field' title='@{stealth}' name='attr_stealth' value='0'>0</span>
                        </div>
                    </div>
                    <div class='row-options'>
                        <div class='row'>
                            <span class='skill-span label' data-i18n='acp'>ACP</span>
                            <input class='acp' type='checkbox' title='@{stealth_acp}' name='attr_stealth_acp' value='1' checked='checked'>
                            <select class='label abi input-field' title='@{stealth_ability}' name='attr_stealth_ability' style='width; .5em;'>
                                <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                <option value='@{dexterity_mod}' data-i18n='dex' selected>DEX</option>
                                <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                            </select>
                        </div>
                        <textarea class='skill-description input-field' title='@{stealth_description}' name='attr_stealth_description' placeholder='Notes'></textarea>
                        <input title='@{stealth_buff_notes}' name='attr_stealth_buff_notes' hidden='true'>
                    </div>
                </div>
                <div class='skill-container'>
                    <input class="show-options" type="checkbox" title='@{survival_show_options}' name="attr_survival_show_options"><span>y</span>
                    <div class='display'>
                        <input hidden='true' title='@{survival_misc}' name='attr_survival_misc' value=''>
                        <input class='ranks input-field' type='number' hidden='true' title='@{survival_ranks}' name='attr_survival_ranks' value='0'>
                        <input hidden='true' type='checkbox' title='@{survival_class_skill}' name='attr_survival_class_skill' value='3'>
                        <button class='acp' type='roll' title='%{survival}' name='roll_survival' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=Survival}}  {{r1=[[1d20+@{survival_ranks}[RANKS]+[[({0,@{survival_ranks}}>1)*@{survival_class_skill}]][CS]+@{survival_ability}[ABILITY]@{survival_misc}]]}} {{notes=@{survival_description}}}' data-i18n='survival' >SURVIVAL</button>
                        <div class='attr-base-mod-container tot'>
                            <input class='base-attr input-field' type='number' title='@{survival}' name='attr_survival_base' value='0'>
                            <input class='mod-buff' type='hidden' name='attr_survival_change' value='0'>
                            <span class='modified-attr input-field' title='@{survival}' name='attr_survival' value='0'>0</span>
                        </div>
                    </div>
                    <div class='row-options'>
                        <div class='row'>
                            <span class='skill-span label' data-i18n='acp'>ACP</span>
                            <input class='acp' type='checkbox' title='@{survival_acp}' name='attr_survival_acp' value='1'>
                            <select class='label abi input-field' title='@{survival_ability}' name='attr_survival_ability' style='width; .5em;'>
                                <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                <option value='@{wisdom_mod}' data-i18n='wis' selected>WIS</option>
                                <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                            </select>
                        </div>
                        <textarea class='skill-description input-field' title='@{survival_description}' name='attr_survival_description' placeholder='Notes'></textarea>
                        <input title='@{suvival_buff_notes}' name='attr_suvival_buff_notes' hidden='true'>
                    </div>
                </div>
                <div class='skill-fieldset span-two'>
                    <fieldset class='repeating_profession'>
                        <input type='checkbox' hidden='true' title='@{filter}' name='attr_filter' value='1' checked='checked'><!-- controls whether the repeating item is displayed. Had plans to use this to add the ability for people to filter their repeating sections -->
                        <div class='skill-container'>
                            <input class="show-options" type="checkbox" title='@{show_options}' name="attr_show_options"><span>y</span>
                            <div class='display'>
                                <input hidden='true' title='@{repeating_profession_$X_misc}' name='attr_misc' value=''>
                                <input class='ranks input-field' type='number' hidden='true' title='@{stealth_ranks}' name='attr_ranks' value='0'>
                                <input hidden='true' type='checkbox' title='@{stealth_class_skill}' name='attr_class_skill' value='3'>
                                <button class='acp' type='roll' title='%{roll}' name='roll_roll' value='@{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=@{name}}}  {{r1=[[1d20+@{ranks}[RANKS]+[[({0,@{ranks}}>1)*@{class_skill}]][CS]+@{ability}[ABILITY]@{misc}]]}} {{notes=@{description}}}' ><span class='profession-name' type='text' title='@{name}' name='attr_name' value='Profession'>Profession</span></button>
                                <div class='attr-base-mod-container tot'>
                                    <input class='base-attr input-field' type='number' title='@{repeating_profession_$X_profession}' name='attr_base' value='0'>
                                    <input class='mod-buff' type='hidden' name='attr_change' value='0'>
                                    <span class='modified-attr input-field' title='@{repeating_profession_$X_profession}' name='attr_profession' value='0'>0</span>
                                </div>
                            </div>
                            <div class='row-options'>
                                <div class='row'>
                                    <input class='scalable-input input-field' type='text' title='@{name}' name='attr_name' value='Profession'>
                                </div>
                                <div class='row'>
                                    <span class='skill-span label' data-i18n='acp'>ACP</span>
                                    <input class='acp' type='checkbox' title='@{stealth_acp}' name='attr_acp' value='1' checked='checked'>
                                    <select class='label abi input-field' title='@{stealth_ability}' name='attr_ability' style='width; .5em;'>
                                        <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                        <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                        <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                        <option value='@{intelligence_mod}' data-i18n='int' selected>INT</option>
                                        <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                        <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                    </select>
                                </div>
                                <textarea class='skill-description input-field' title='@{repeating_profession_$X_description}' name='attr_description' placeholder='Notes'></textarea>
                                <input title='@{repeating_profession_$Xbuff_notes}' name='attr_buff_notes' hidden='true'>
                            </div>
                        </div>
                    </fieldset>
                </div>
            </div>
            <div class='row'>
                <span data-i18n='feats'>FEATS</span>
                <input class='scalable-input input-field' type='text' title='@{feats}' name='attr_feats'>
            </div>
            <div class='row'>
                <span data-i18n='languages'>LANGUAGES</span>
                <input class='scalable-input input-field' type='text' title='@{languages}' name='attr_languages'>
            </div>
            <div class='row'>
                <span data-i18n='other-abilities'>OTHER ABILITIES</span>
                <input class='scalable-input input-field' type='text' title='@{other_abilities}' name='attr_other_abilities'>
            </div>
            <div class='row'>
                <span data-i18n='gear'>GEAR</span>
            </div>
            <div class='row'>
                <textarea title='@{gear}' name='attr_gear' type='text' class='scalable-input input-field'></textarea>
            </div>
            <div class='statblock-section-header ecology-header'>
                <span data-i18n='ecology'>ECOLOGY</span>
            </div>
            <div class='row'>
                <span data-i18n='environment'>ENVIRONMENT</span>
            </div>
            <div class='row'>
                <textarea class='scalable-input input-field' type='text' title='@{environment}' name='attr_environment'></textarea>
            </div>
            <div class='row'>
                <span data-i18n='organization'>ORGANIZATION</span>
            </div>
            <div class='row'>
                <textarea class='scalable-input input-field' type='text' title='@{organization}' name='attr_organization'></textarea>
            </div>
            <div class='row'>
                <span data-i18n='tactics'>TACTICS</span>
            </div>
            <div class='row'>
                <textarea class='scalable-input input-field' type='text' title='@{tactics}' name='attr_tactics'></textarea>
            </div>
            <div class='row special-abilities'>
                <div class='statblock-section-header special-abilities-header'>
                    <span data-i18n='special-abilities'>SPECIAL ABILITIES</span>
                </div>
                <fieldset class='repeating_ability'><input hidden='true' type='text' title='@{attack_total}' name='attr_attack_total'><input hidden='true' type='text' title='@{damage_total}' name='attr_damage_total'>
                    <input class='filter' type='checkbox' hidden='true' title='@{filter}' name='attr_filter' value='1' checked='checked'>
                    <div class='filter-container ability'>
                       <!--Hidden Ability Attributes -->
                       <input type='text' hidden='true' title='@{attack_misc}' name='attr_attack_misc' value=''>
                       <input type='text' hidden='true' title='@{attack_damage_misc}' name='attr_attack_damage_misc' value=''>
                       <input type='text' hidden='true' title='@{effect_misc}' name='attr_effect_misc' value=''>
                       <input type='hidden' name='attr_dc' value='10'>
                       <!--Shown Ability Attributes -->
                        <input class="show-options" type="checkbox" title='@{show_options}' name="attr_show_options" checked="checked"><span>y</span>
                        <div class='row-options'>
                            <div class='row  span-two'>
                                <span class='label' data-i18n='name-u'>NAME</span>
                                <input class='scalable-input input-field' type='text' title='@{name}' name='attr_name' placeholder="Operative's Edge">
                                <select class='freq-select' title='@{frequency}' name='attr_frequency'>
                                    <option value='constant' data-i18n='constant' selected>CONSTANT</option>
                                    <option value='at-will' data-i18n='at-will'>AT WILL</option>
                                    <option value='daily-limit' data-i18n='x/day'>X/DAY</option>
                                </select>
                            </div>
                            <div class='row span-two display-margin'>
                                <span class='label' data-i18n='source'>SOURCE</span>
                                <input class='scalable-input input-field' type='text' title='@{source}' name='attr_source' placeholder='Operative'>
                                <select title='@{type}' name='attr_type'>
                                    <option value='EX' data-i18n='extraordinary' selected>EX</option>
                                    <option value='SU' data-i18n='supernatural'>SU</option>
                                    <option value='SP' data-i18n='spell-like'>SP</option>
                                </select>
                            </div>
                            <div class='row span-two'>
                                <span class='label' data-i18n='target'>TARGET</span>
                                <input class='scalable-input input-field' type='text' title='@{target}' name='attr_target' placeholder='self'>
                                <span class='label' data-i18n='rng'>RANGE</span>
                                <input class='scalable-input input-field' type='text' title='@{range}' name='attr_range' placeholder='30 ft'>
                            </div>
                            <div class='row'>
                                <span class='label' data-i18n='duration'>DURATION</span>
                                <input class='scalable-input input-field' type='text' title='@{duration}' name='attr_duration' placeholder='1 round' value=''>
                            </div>
                            <input class='type-filter' type='hidden' name='attr_type' value='EX'>
                            <div class='row type-span'>
                                <span class='label' data-i18n='level'>LEVEL</span>
                                <input class='atk-level input-field' type='number' name='attr_level' value='0'>
                                <span class='label' data-i18n='spell-resistance-abbrv'>SR</span>
                                <input type='hidden' name='attr_spell_penetration_misc' value=''><select name='attr_spell_resistance'>
                                    <option value='' data-i18n='no' selected>NO</option>
                                    <option value='yes' data-i18n='yes'>YES</option>
                                </select>
                            </div>
                            <input type='hidden' title='@{frequency}' name='attr_frequency' class='freq-check'>
                            <div class='row at-will daily-limit'>
                                <span class='label abi-cost' data-i18n='usage'>USAGE</span>
                                <input class='scalable-input input-field' type='text' title='@{usage}' name='attr_usage' placeholder='move action, 1 resolve point'>
                            </div>
                            <div class='row span-two daily-limit'>
                                <input class='' type='number' title='@{uses}' name='attr_uses' value='0'>
                                <span class='label'>/</span>
                                <div class='attr-base-mod-container'>
                                    <input class='base-attr ability-uses' type='text' title='@{uses_max}' name='attr_uses_max_base' value='10' >
                                    <input class='mod-buff' type='hidden' name='attr_uses_change' value='0'>
                                    <span class='input-field modified-attr attr ability-uses' readonly='true' type='text' title='@{uses_max}' name='attr_uses_max' value='10'>10</span>
                                </div>
                                <span class='label' data-i18n='_-daily-uses'>Daily Uses</span>
                            </div>
                            <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                            <label class='expandable'><input class='field-tab atk-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'><span class='field label' data-i18n='atk'>ATTACK ROLL</span></label>
                            <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                            <div class='field-container expandable inherit-grid'>
                                <input class='field-tab' type='checkbox' title='@{attack_checkbox}' name='attr_attack_checkbox' value='1' hidden='true'>
                                <div class='field row span-all'>
                                    <select class='label atk-ability abi' title='@{attack_ability}' name='attr_attack_ability'>
                                        <option value='0' selected data-i18n='n/a'>N/A</option>
                                        <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                        <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                        <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                        <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                        <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                        <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                    </select>
                                    <input hidden='true' title='@{attack_ability}' name='attr_attack_ability' value='0'>
                                    <span class='arith'>+</span>
                                    <input class='bab input-field' type='number' title='@{base_attack_bonus_base}' name='attr_base_attack_bonus_base' value='0'>
                                    <input class='bab input-field' type='hidden' title='@{base_attack_bonus_base}' name='attr_base_attack_bonus' value='0'>
                                    <input class='scalable-input input-field' type='text' title='@{attack_bonus}' name='attr_attack_bonus' placeholder='+@{attr}/2 + ?{Query}'>
                                </div>
                            </div>
                            <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                            <label class='expandable'><input class='field-tab dmg-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'><span class='field label' data-i18n='dmg'>DAMAGE ROLL</span></label>
                            <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                            <div class='field-container expandable inherit-grid'>
                                <input hidden='true' title='@{damage_misc}' name='attr_damage_misc' value=''>
                                <input class='field-tab' type='checkbox' title='@{damage_checkbox}' name='attr_damage_checkbox' value='1' hidden='true'>
                                <div class='field row span-two'>
                                    <input class='scalable-input input-field' type='text' name=attr_damage_dice placeholder='1d8'><span>+</span>
                                    <select class='label atk-ability abi' title='@{damage_ability}' name='attr_damage_ability'>
                                        <option value='0' selected data-i18n='n/a'>N/A</option>
                                        <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                        <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                        <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                        <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                        <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                        <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                    </select>
                                    <input type='text' hidden='true' title='@{damage_ability}' name='attr_damage_ability' value='0'>
                                </div>
                                <div class='field row span-two'>
                                    <span class='label' data-i18n='damage-type'>DAMAGE TYPE</span>
                                    <input class='scalable-input input-field' type='text' title='@{attack_type}' name='attr_attack_type' placeholder='Fire'>
                                    <span class='label' data-i18n='crit-effect'>CRITICAL EFFECT</span>
                                    <input class='scalable-input input-field' type='text' title='@{attack_crit}' name='attr_attack_crit' placeholder='Burn'>
                                </div>
                            </div>
                            <input class='field-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                            <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'><span class='label field' data-i18n='additional-attack'>ADDITIONAL ATTACKS</span></label>
                            <input class='field-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                            <div class='field-container expandable inherit-grid'>
                                <input class='field-tab macro-tab' type='checkbox' title='@{full_attack_checkbox}' name='attr_full_attack_checkbox' value='1' hidden='true'>
                                <div class='field row'>
                                    <span data-i18n='roll-full-attack_'>ROLL FULL ATTACK: </span>
                                </div>
                                <div class='field row span-two'>
                                    <label><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='?{Full Attack|No,0|Yes,1}'><span class='label'  data-i18n='query'>QUERY</span></label>
                                    <label><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='1'><span class='label' data-i18n='always'>ALWAYS</span></label>
                                    <label><input type='radio' title='@{full_attack_query}' name='attr_full_attack_query' value='0' checked='checked'><span class='label'  data-i18n='never'>NEVER</span></label>
                                </div>
                                <div class='field row span-two'>
                                    <span class='label' data-i18n='number-of-attacks:'>NUMBER OF ATTACKS:</span>
                                    <input class='scalable-input input-field' type='text' title='@{full_attack_number}' name='attr_full_attack_number' value='2'>
                                </div>
                                <div class='field row span-two'>
                                    <span class='label' data-i8n='full-attack-penalty:'>ATTACK PENALTY:</span>
                                    <input class='scalable-input input-field' type='text' title='@{full_attack_penalty}' name='attr_full_attack_penalty' value='-4'>
                                </div>
                            </div>
                            <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                            <label class='expandable'><input class='field-tab save-effect-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'><span class='field label' data-i18n='save-effect'>SAVE EFFECT</span></label>
                            <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                            <div class='field-container expandable inherit-grid'>
                                <input class='field-tab' type='checkbox' title='@{save_checkbox}' name='attr_save_checkbox' value='1' hidden='true'>
                                <div class='field row span-all'>
                                    <select class='label atk-ability abi input-field' title='@{save_ability}' name='attr_save_ability'>
                                        <option value='0' selected data-i18n='n/a'>N/A</option>
                                        <option value='@{strength_mod}' data-i18n='str'>STR</option>
                                        <option value='@{dexterity_mod}' data-i18n='dex'>DEX</option>
                                        <option value='@{constitution_mod}' data-i18n='con'>CON</option>
                                        <option value='@{intelligence_mod}' data-i18n='int'>INT</option>
                                        <option value='@{wisdom_mod}' data-i18n='wis'>WIS</option>
                                        <option value='@{charisma_mod}' data-i18n='cha'>CHA</option>
                                    </select>
                                    <span class='label' data-i18n='based-dc_'>Based DC </span>
                                    <div class='attr-base-mod-container save-dc'>
                                        <input class='base-attr' type='number' title='@{dc}' name='attr_dc_base' value='10'>
                                        <input class='mod-buff' type='hidden' name='attr_dc_change' value='0'>
                                        <span class='modified-attr input-field' title='@{dc}' name='attr_dc' value='10'>10</span>
                                    </div>
                                    <select class='label save-type input-field' title='@{save_type}' name='attr_save_type'>
                                        <option value='' selected>-</option>
                                        <option value='FORT' data-i18n='fort-save'>FORT SAVE</option>
                                        <option value='REF' data-i18n='ref-save'>REF SAVE</option>
                                        <option value='WILL' data-i18n='will-save'>WILL SAVE</option>
                                    </select>
                                </div>
                                <div class='field row span-all'>
                                    <textarea title='@{effect}' name='attr_effect' placeholder='Effect on a Failed Save'></textarea>
                                </div>
                                <div class='field row span-all'>
                                    <span class='label' data-i18n='A-Sucessful-Save:'>A Sucessful Save:</span>
                                </div>
                                <div class='field row span-all'>
                                    <textarea title='@{save_effect}' name='attr_save_effect' placeholder='Effect on a Successful Save'></textarea>
                                </div>
                            </div>
                            <input class='field-tab' type='checkbox' title='@{mods_checkbox}' name='attr_mods_checkbox' value='1' hidden='true'>
                            <label class='expandable'><input class='field-tab mods-tab item-mods' type='checkbox' title='@{mods_checkbox}' name='attr_mods_checkbox' value='1' hidden='true'><span class='label field' data-i18n='mods'>MODS</span></label>
                            <input class='field-tab' type='checkbox' title='@{mods_checkbox}' name='attr_mods_checkbox' value='1' hidden='true'>
                            <div class='row field-container mod-container expandable'>
                                <input class='field-tab' type='checkbox' title='@{mods_checkbox}' name='attr_mods_checkbox' value='1' hidden='true'>
                                <textarea class='field row scalable-input input-field' type='text' title='@{mods}' name='attr_mods'placeholder='+X to EAC'></textarea>
                            </div>
                            <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                            <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'><span class='label field' data-i18n='attacher'>ATTACHER</span></label>
                            <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                            <div class='row field-container mod-container expandable'>
                                <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                <textarea class='field row scalable-input input-field' type='text' title='@{attacher}' name='attr_attacher'></textarea>
                            </div>
                            <div class='row span-all'>
                                <textarea class='' title='@{description}' name='attr_description' placeholder='Description'></textarea>
                                </div>
                            <div class='row span-all'><input readonly=true class='id-label' title='@{id}' name='attr_id'></input>
                            </div>
                        </div>
                        <input type='hidden' name='attr_damage_ability_base' value='0'>
                        <div class='display'>
                            <input type='hidden' title='@{frequency}' name='attr_frequency' class='freq-check'>
                            <input class='freq-check at-will daily-limit' type='checkbox' title='@{toggle}' name='attr_toggle' value='1'>
                            <div class='button-description'>
                                <input class='label' type='text' title='@{name}' name='attr_name' placeholder='Laser Pistol'>
                                <input class='label' type='text' name='attr_source' placeholder='Operative'>
                                <input class='label force-uppercase' type='text' name='attr_type'>
                                <input class='const-check' name='attr_frequency' type='hidden'>
                                <input class='label span-two constant force-uppercase' type='text' name='attr_frequency'>
                                <input class='label span-two not-constant' type='text' name='attr_usage'>
                                <button class='npcsummary' type='roll' title='%{npc_roll}' name='roll_npc_roll' value='@{whisper_state}&{template:sf_spell} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=@{name}}} {{rightbanner=@{source}}} {{saveflag=[[1d@{save_checkbox}]]}} {{srflag=@{spell_resistance}}} {{srroll=[[1d20 + @{character_level}@{spell_penetration_misc}}} {{activation=@{usage}}} {{duration=@{duration}}} {{targets=@{target}}} {{range=@{range}}} {{savedc=@{dc}}} {{savetype=@{save_type}}} {{effect=@{effect}}} {{saveeffect=@{save_effect}}} {{attackflag=[[1d@{attack_checkbox}]]}} {{fullattack=[[@{full_attack_query}*(@{full_attack_number})]]}} {{r1=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+[[@{full_attack_query}*(@{full_attack_penalty})]][FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage1type=@{attack_type}}} {{damage1=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]@{damage_misc}]]}} {{crit1damage=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]@{damage_misc}]]}} {{crit1effect=@{attack_crit}}}  {{r2=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage2type=@{attack_type}}} {{damage2=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]@{damage_misc}]]}} {{crit2damage=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]@{damage_misc}]]}} {{crit2effect=@{attack_crit}}} {{r3=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage3type=@{attack_type}}} {{damage3=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]@{damage_misc}]]}} {{crit3damage=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]@{damage_misc}]]}} {{crit3effect=@{attack_crit}}} {{r4=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage4type=@{attack_type}}} {{damage4=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]@{damage_misc}]]}} {{crit4damage=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]@{damage_misc}]]}} {{crit4effect=@{attack_crit}}} {{r5=[[1d20+@{base_attack_bonus}[BAB]+@{attack_ability}[ABILITY]+@{full_attack_penalty}[FULL ATTACK]@{attack_misc}@{attack_bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damage5type=@{attack_type}}} {{damage5=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]@{damage_misc}]]}} {{crit5damage=[[@{damage_dice}+0(@{damage_ability}-@{damage_ability_base})[ABILITY]@{damage_misc}]]}} {{crit5effect=@{attack_crit}}} {{rightbanner=@{type}}} {{notes=@{description}}} @{attacher}'></button>
                                <label class='expand-button'><input hidden='true' class='expand-description' type='checkbox' name='attr_expand_description' value='1'><span class='collapsed pictos'>`</span><span class='expanded pictos'>J</span></label>
                            </div>
                            <input class='expand-description' type='hidden' name='attr_expand_description'>
                            <textarea class='description' title='@{description}' name='attr_description' placeholder='Description'></textarea>
                        </div>
                    </div>
                </fieldset>
            </div>
        </div>
    </div>
    <div class="container ship">
        <input hidden='true' title='@{attack_query}' name='attr_attack_query' type='text' value='?{Fire at will|No, |Yes,-4}'>
        <div class='shields'>
            <div class='hex-container'><!-- contains the hex displays of the shield container -->
                <div class='hex-row'>
                    <div class='hexagon'></div>
                    <div class='hexagon'></div>
                    <div class='hexagon'></div>
                    <div class='hexagon'></div>
                    <div class='hexagon'></div>
                    <div class='hexagon'></div>
                </div>
                <div class='hex-row'>
                    <div class='hexagon dual-arc'></div>
                    <div class='hexagon'></div>
                    <div class='hexagon'></div>
                    <div class='hexagon'></div>
                    <div class='hexagon'></div>
                    <div class='hexagon'></div>
                </div>
                <div class='hex-row'>
                    <div class='hexagon'></div>
                    <div class='hexagon dual-arc'></div>
                    <div class='hexagon'></div>
                    <div class='hexagon'></div>
                    <div class='hexagon dual-arc'></div>
                    <div class='hexagon'></div>
                </div>
                <div class='hex-row center-container'>
                    <div class='hexagon'></div>
                    <div class='hexagon'></div>
                    <div class='hexagon'></div>
                    <div class='hexagon center-hex'>
                        <img src='https://cdn.rawgit.com/Roll20/roll20-character-sheets/d0602504/Starfinder%20Official/Assets/ship.png'>
                    </div>
                    <div class='hexagon'></div>
                    <div class='hexagon'></div>
                </div>
                <div class='hex-row'>
                    <div class='hexagon'></div>
                    <div class='hexagon dual-arc'></div>
                    <div class='hexagon'></div>
                    <div class='hexagon'></div>
                    <div class='hexagon dual-arc'></div>
                    <div class='hexagon'></div>
                </div>
                <div class='hex-row'>
                    <div class='hexagon dual-arc'></div>
                    <div class='hexagon'></div>
                    <div class='hexagon'></div>
                    <div class='hexagon'></div>
                    <div class='hexagon'></div>
                    <div class='hexagon'></div>
                </div>
                <div class='hex-row'>
                    <div class='hexagon'></div>
                    <div class='hexagon'></div>
                    <div class='hexagon'></div>
                    <div class='hexagon'></div>
                    <div class='hexagon'></div>
                    <div class='hexagon'></div>
                </div>
                <div class='line-left'></div>
                <div class='line-right'></div>
            </div>
        </div>
        <div class="starship-type section-container">
            <div class='section'>
                <h1 class='label' data-i18n='starship-info'>STARSHIP INFO</h1>
            </div>
            <div class='section-container'>
                <div class='top-gutter'></div>
                <div class='label-container ship-name'>
                    <input type="text" title='@{character_name}' name="attr_character_name">
                    <span class="label" data-i18n="starship-name">STARSHIP NAME</span>
                </div>
                <div class='label-container ship-tier'>
                    <input type="text" title='@{ship_tier}' name="attr_ship_tier">
                    <span class="label" data-i18n="tier">TIER</span>
                </div>
                
                <div class='label-container ship-make-model'>
                    <input type="text" title='@{make_model}' name="attr_make_model">
                    <span class="label" data-i18n="make-and-model">MAKE AND MODEL</span>
                </div>
                <div class='label-container ship-size'>
                    <select class='input-field' title='@{size}' name="attr_size">
                        <option value='tiny' data-i18n='tiny' selected>TINY</option>
                        <option value='small' data-i18n='small'>SMALL</option>
                        <option value='medium' data-i18n='medium'>MEDIUM</option>
                        <option value='large' data-i18n='large'>LARGE</option>
                        <option value='huge' data-i18n='huge'>HUGE</option>
                        <option value='gargantuan' data-i18n='gargantuan'>GARGANTUAN</option>
                        <option value='colossal' data-i18n='colossal'>COLOSSAL</option>
                    </select>
                    <span class="label" data-i18n="size">SIZE</span>
                </div>
                <div class='label-container ship-frame'>
                    <input type="text" title='@{frame}' name="attr_frame">
                    <span class="label" data-i18n="frame">FRAME</span>
                </div>
                <div class='label-container ship-speed'>
                    <input type="number" title='@{speed}' name="attr_speed">
                    <span class="label" data-i18n="speed">SPEED</span>
                </div>
                
                <div class='label-container ship-maneuverability'>
                    <select class='input-field' title='@{maneuverability}' name="attr_maneuverability">
                        <option value='clumsy' data-i18n='clumsy' selected>CLUMSY</option>
                        <option value='poor' data-i18n='poor'>POOR</option>
                        <option value='average' data-i18n='average'>AVERAGE</option>
                        <option value='good' data-i18n='good'>GOOD</option>
                        <option value='perfect' data-i18n='perfect'>PERFECT</option>
                    </select>
                    <span class="label" data-i18n="maneuverability">MANEUVERABILITY</span>
                </div>
                
                <div class='label-container ship-drift-rating'>
                    <input type="text" title='@{drift_rating}' name="attr_drift_rating">
                    <span class="label" data-i18n="drift-rating">DRIFT RATING</span>
                </div>
                <div class='top-gutter'></div>
            
            
            </div>
            
            
            
            
        </div>
        <div class='crew section-container'>
            <div class='section'>
                <h1 class='label' data-i18n='crew'>CREW</h1>
            </div>
            <div class='section-container'>
                <div class='top-gutter'></div>
                <div class='label-container captain'>
                    <input type="text" title='@{captain}' name="attr_captain">
                    <button type='roll' class="label" title='%{captain}' data-i18n="captain" name='roll_captain' value='@{captain_bonus}'>CAPTAIN</button>
                    <input hidden='true' type='text' title='@{captain_bonus}' name='attr_captain_bonus'>
                </div>
                <div class='label-container engineer'>
                    <input type="text" title='@{engineer}' name="attr_engineer">
                    <button type='roll' class="label" title='%{engineer}' data-i18n="engineer" name='roll_engineer' value='@{engineer_bonus}'>ENGINEER</button>
                    <input hidden='true' type='text' title='@{engineer_bonus}' name='attr_engineer_bonus'>
                </div>
                <div class='label-container pilot'>
                    <input type="text" title='@{pilot}' name="attr_pilot">
                    <button type='roll' class="label" title='%{pilot}' data-i18n="pilot" name='roll_pilot' value='@{pilot_bonus}'>PILOT</button>
                    <input hidden='true' type='text' title='@{pilot_bonus}' name='attr_pilot_bonus'>
                </div>
                <div class='label-container science-officer'>
                    <input type="text" title='@{science_officer}' name="attr_science_officer">
                    <button type='roll' class="label" title='%{science_officer}' data-i18n="science-officer" name='roll_science_officer' value='@{science_officer_bonus}'>SCIENCE OFFICER</button>
                    <input hidden='true' type='text' title='@{science_officer_bonus}' name='attr_science_officer_bonus'>
                </div>
                <div class='label-container gunner'>
                    <input type="text" title='@{gunner}' name="attr_gunner">
                    <input type='text' name='attr_gunner_roll' hidden='true'>
                    <span type='roll' class="label" data-i18n="gunner">GUNNER</span>
                    <input hidden='true' type='text' title='@{gunner_bonus}' name='attr_gunner_bonus'>
                </div>
                <div class='top-gutter'></div>
            </div>
        </div>
        <div class='shields non-hex'>
            <div class='forward-shield arc-shield'>
                <input type='number' title='@{forward_shields}' name='attr_forward_shields' value='' placeholder='0'>
                <span class='label' data-i18n='forward'>FORWARD</span>
            </div>
            <div class='port-shield arc-shield'>
                <span class='label' data-i18n='port'>PORT</span>
                <input type='number' title='@{port_shields}' name='attr_port_shields' value='' placeholder='0'>
            </div>
            <div class='aft-shield arc-shield'>
                <span class='label' data-i18n='aft'>AFT</span>
                <input type='number' title='@{aft_shields}' name='attr_aft_shields' value='' placeholder='0'>
            </div>
            <div class='starboard-shield arc-shield'>
                <span class='label' data-i18n='starboard'>STARBOARD</span>
                <input type='number' title='@{starboard_shields}' name='attr_starboard_shields' value='' placeholder='0'>
            </div>
        </div>
        <div class='starship-defense section-container'>
            <label class='rank-import'><input name='attr_update_pilot_ranks' type='checkbox' value='1' hidden='true'><span data-i18n-title='update-pilot-tooltip' title="Pull piloting ranks from the opened pilot's sheet" class='label' data-i18n='update-pilot'>UPDATE PILOT</span></label>
            <div class='section'>
                <h1 class='label' data-i18n='starship-defenses'>DEFENSES</h1>
            </div>
            <div class='section-container'>
                <div class='top-gutter'></div>
                <div class='ac-container'>
                                                                        <span class='total labels' data-i18n='total'>TOTAL</span>                     <span class='piloting labels' data-i18n='piloting'>PILOTING</span>            <span class='armor label'>b</span>
                    <span class='ac row-label' data-i18n='ac'>AC</span> <span class='ac total' type='number' title='@{ac}' name='attr_ac' readonly='true'>0</span><span class='ac equal'>=</span> <input class='piloting ac' type='text' title='@{ship_piloting_ranks}' name='attr_ship_piloting_ranks' value='0'><span class='ac plus'>+</span>  <span class='armor ac' type='number' title='@{ac_armor}' name='attr_ac_armor' readonly='true'>0</span>
                    <span class='tl row-label' data-i18n='tl'>TL</span> <span class='tl total' type='number' title='@{tl}' name='attr_tl' readonly='true'>0</span><span class='tl equal'>=</span> <input class='piloting tl' type='text' title='@{ship_piloting_ranks}' name='attr_ship_piloting_ranks' value='0'><span class='tl plus'>+</span>  <span class='armor tl' type='number' title='@{tl_countermeasures}' name='attr_tl_countermeasures' readonly='true'>0</span>
                </div>
                <div class='hp-container'>
                    <span class='current labels' data-i18n='current'>CURRENT</span><span class='total labels' data-i18n='total'>TOTAL</span>
                    <span class='value row-label' data-i18n='hp'>HP</span> <input class='value current' type='number' title='@{hp}' name='attr_hp'><span class='value slash'>/</span> <input class='value total' type='number' title='@{hp_max}' name='attr_hp_max'>
                </div>
                <div class='threshold-container'>
                    <span class='over-label' data-i18n='thresholds'>THRESHOLDS</span>
                    <span class='labels damage label' data-i18n='damage'>DAMAGE</span><span class='labels critical label' data-i18n='critical'>CRITICAL</span>
                    <input class='value damage' type='number' title='@{damage_threshold}' name='attr_damage_threshold' value='0'><input type='number' class='value critical' title='@{critical_threshold}' name='attr_critical_threshold' value='' placeholder='10'>
                </div>
                <div class='shields-container'>
                    <span class='label' data-i18n='shield-total'>SHIELD TOTAL</span>
                    <input class='current' type='number' value='0' title='@{shield_total}' name='attr_shield_total'>
                    <span class='label slash'>/</span>
                    <input type='max number' value='0' title='@{shield_total_max}' name='attr_shield_total_max'>
                </div>
                <div class='modifiers-container'>
                </div>
            </div>
        </div>
        <div class='ship-menus section-container'>
            <div class='section'>
                <h1 class='label' data-i18n='power&computers'>POWER & COMPUTERS</h1>
            </div>
            <div class='section-container'>
                <span class='label power' data-i18n='power'>POWER</span>
                <input class='current power' type='number' readonly='true' title='@{ship_pcu}' name='attr_ship_pcu'>
                <span class='slash power'>/</span>
                <input class='max power' type='number' readonly='true' title='@{ship_pcu_max}' name='attr_ship_pcu_max'>
                <span class='label computer' data-i18n='computer'>COMPUTER</span>
                <input class='current computer' readonly='true' type='text' title='@{ship_computer}' name='attr_ship_computer'>
                <input hidden='true' name='attr_computer_query' value='?{Use Computer|No, |Yes, }'>
                <div class='sensor-bp'>
                    <span class='label sensor' data-i18n='sensors'>SENSORS</span>
                    <input type='text' readonly='true' title='@{ship_sensors}' name='attr_ship_sensors' value=0>
                    <span class='label bp' data-i18n='bp'>BP</span>
                    <input type='text' title='@{ship_bp}' readonly='true' name='attr_ship_bp'>
                </div>
            </div>
        </div>
        <div class='ship-weapons'>
            <div class='forward-weapon section-container'>
                <div class='section'>
                    <h1 class='label' data-i18n='forward'>FORWARD</h1>
                </div>
                <div class='section-container'>
                    <fieldset class='repeating_attack'>
                        <input class='filter' type='radio' hidden='true' title='@{arc}' name='attr_arc' value='forward' checked='checked'>
                        <input type='radio' hidden='true' title='@{arc}' name='attr_arc' value='port'>
                        <input type='radio' hidden='true' title='@{arc}' name='attr_arc' value='aft'>
                        <input type='radio' hidden='true' title='@{arc}' name='attr_arc' value='starboard'>
                        <input type='radio' hidden='true' title='@{arc}' name='attr_arc' value='turret'>
                        <div class='filter-container attack'>
                            <input type='text' hidden='true' title='@{misc}' name='attr_misc' value=''>
                            <input type='text' hidden='true' title='@{damage_misc}' name='attr_damage_misc' value=''>
                            <input class="show-options" type="checkbox" title='@{show_options}' name="attr_show_options" value='1' checked="checked"><span>y</span>
                            <div class='row-options'>
                                <div class='row span-all display-margin'>
                                    <span class='label' data-i18n='name-u'>NAME</span>
                                    <input class='atk-name scalable-input input-field' type='text' title='@{name}' name='attr_name' placeholder='Laser Cannon' value=''>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='type'>TYPE</span>
                                    <select class='input-field label' title='@{type}' name='attr_type'>
                                        <option value='' direct-fire'' selected>-</option><option value='direct-fire' data-i8n='direct-fire'>DIRECT FIRE</option>
                                        <option value='tracking' data-i8n='tracking'>TRACKING</option>
                                    </select>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='class'>CLASS</span>
                                    <select class='input-field label proficiency' title='@{class}' name='attr_class'>
                                        <option value='light' data-i8n='light' selected>LIGHT</option>
                                        <option value='heavy' data-i8n='heavy'>HEAVY</option>
                                        <option value='capital' data-i8n='capital'>CAPITAL</option>
                                    </select>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='rng'>RNG</span>
                                    <select class='label atk-range-type' title='@{range}' name='attr_range'>
                                        <option value='' selected data-i18n='n/a'>NA</option>
                                        <option value='5' data-i18n='short'>SHORT</option>
                                        <option value='10' data-i18n='medium'>MEDIUM</option>
                                        <option value='20' data-i18n='long'>LONG</option>
                                    </select>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='dmg'>DMG</span>
                                    <input class='dmg-dice scalable-input input-field' type='text' name=attr_damage_dice placeholder='1d8' value=''>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='arc'>ARC</span>
                                    <select class='input-field atk-type' title='@{arc}' name='attr_arc'>
                                        <option value='forward' data-i18n='forward' selected>FORWARD</option>
                                        <option value='port' data-i18n='port'>PORT</option>
                                        <option value='aft' data-i18n='aft'>AFT</option>
                                        <option value='starboard' data-i18n='starboard' selected>STARBOARD</option>
                                        <option value='turret' data-i18n='turret'>TURRET</option>
                                    </select>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='pcu'>PCU</span>
                                    <input class='atk-special scalable-input input-field' type='text' title='@{pcu}' name='attr_pcu' placeholder='1' value=''>
                                    <span class='label' data-i18n='bp'>BP</span>
                                    <input class='atk-special scalable-input input-field' type='text' title='@{bp}' name='attr_bp' placeholder='1' value=''>
                                </div>
                                <div class='row span-all'>
                                    <input class='label scalable-input input-field' data-i18n-placeholder='ammo' title='@{ammo_type}' name='attr_ammo_type' value='' type='text' placeholder='ammo' >
                                    <input title='@{ammo}' name='attr_ammo' type='number' value=''>
                                    <span class='label'>/</span>
                                    <input title='@{ammo_max}' name='attr_ammo_max' type='number' value=''>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='special'>SPECIAL</span>
                                    <input class='atk-special scalable-input input-field' type='text' title='@{special}' name='attr_special' placeholder='Array' value=''>
                                </div>
                                <div class='row span-all'>
                                    <select class='input-field atk-type' title='@{powered}' name='attr_powered'>
                                        <option class='off' value='OFF' data-i18n='off'>OFF</option>
                                        <option class='on' value='ON' data-i18n='on' selected>ON</option>
                                    </select>
                                </div>
                                <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'><span class='label field' data-i18n='attacher'>ATTACHER</span></label>
                                <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                <input class='field-tab macro-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                <textarea class='expandable atk-description input-field' title='@{attacher}' name='attr_attacher' ></textarea>
                                <textarea class='atk-description span-all input-field' title='@{description}' name='attr_description' placeholder='Description' value=''></textarea>
                                <div class='row span-all'>
                                    <input readonly=true class='id-label' title='@{id}' name='attr_id'></input>
                                </div>
                            </div>
                            <input hidden='true' name='attr_arc_status' type='text' value=''>
                            <div class='display'>
                                <button class='npcsummary' type='roll' title='%{repeating_attack_$X_ship_roll}' name='roll_ship_roll' value='@{whisper_state}&{template:sf_ship} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=@{name}}} {{leftbanner=^{@{arc}}}} {{r1=[[1d20+[[@{gunner_roll}]]@{attack_query}@{computer_query}@{arc_status}@{power_core_status}]]}} {{damage1=[[@{damage_dice}]]}} {{range=@{range} ^{hexes}}} {{class=^{@{class}}}} {{type=^{@{type}}}} {{curr_ammo=@{ammo}}} {{ammo_type=@{ammo_type}}} {{rightbanner=@{special}}} {{notes=@{description}}} @{attacher}'>
                                    <span class='label' title='@{name}' name='attr_name'></span>
                                </button>
                            </div>
                        </div>
                    </fieldset>
                    <label class='pseudo-repcontrol'>
                        <input hidden='true' type='checkbox' title='@{create_forward}' name='attr_create_forward' value='1'>
                        <span>&</span>
                    </label>
                </div>
            </div>
            <div class='port-weapon section-container'>
                <div class='section'>
                    <h1 class='label' data-i18n='port'>PORT</h1>
                </div>
                <div class='section-container'>
                    <fieldset class='repeating_attack'>
                        <input type='radio' hidden='true' title='@{arc}' name='attr_arc' value='forward' checked='checked'>
                        <input class='filter' type='radio' hidden='true' title='@{arc}' name='attr_arc' value='port'>
                        <input type='radio' hidden='true' title='@{arc}' name='attr_arc' value='aft'>
                        <input type='radio' hidden='true' title='@{arc}' name='attr_arc' value='starboard'>
                        <input type='radio' hidden='true' title='@{arc}' name='attr_arc' value='turret'>
                        <div class='filter-container attack'>
                            <input type='text' hidden='true' title='@{misc}' name='attr_misc' value=''>
                            <input type='text' hidden='true' title='@{damage_misc}' name='attr_damage_misc' value=''>
                            <input class="show-options" type="checkbox" title='@{show_options}' name="attr_show_options" value='1' checked="checked"><span>y</span>
                            <div class='row-options'>
                                <div class='row span-all display-margin'>
                                    <span class='label' data-i18n='name-u'>NAME</span>
                                    <input class='atk-name scalable-input input-field' type='text' title='@{name}' name='attr_name' placeholder='Laser Cannon' value=''>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='type'>TYPE</span>
                                    <select class='input-field label' title='@{type}' name='attr_type'>
                                        <option value='' direct-fire'' selected>-</option><option value='direct-fire' data-i8n='direct-fire'>DIRECT FIRE</option>
                                        <option value='tracking' data-i8n='tracking'>TRACKING</option>
                                    </select>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='class'>CLASS</span>
                                    <select class='input-field label proficiency' title='@{class}' name='attr_class'>
                                        <option value='light' data-i8n='light' selected>LIGHT</option>
                                        <option value='heavy' data-i8n='heavy'>HEAVY</option>
                                        <option value='capital' data-i8n='capital'>CAPITAL</option>
                                    </select>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='rng'>RNG</span>
                                    <select class='label atk-range-type' title='@{range}' name='attr_range'>
                                        <option value='' selected data-i18n='n/a'>NA</option>
                                        <option value='5' data-i18n='short'>SHORT</option>
                                        <option value='10' data-i18n='medium'>MEDIUM</option>
                                        <option value='20' data-i18n='long'>LONG</option>
                                    </select>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='dmg'>DMG</span>
                                    <input class='dmg-dice scalable-input input-field' type='text' name=attr_damage_dice placeholder='1d8' value=''>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='arc'>ARC</span>
                                    <select class='input-field atk-type' title='@{arc}' name='attr_arc'>
                                        <option value='forward' data-i18n='forward' selected>FORWARD</option>
                                        <option value='port' data-i18n='port'>PORT</option>
                                        <option value='aft' data-i18n='aft'>AFT</option>
                                        <option value='starboard' data-i18n='starboard' selected>STARBOARD</option>
                                        <option value='turret' data-i18n='turret'>TURRET</option>
                                    </select>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='pcu'>PCU</span>
                                    <input class='atk-special scalable-input input-field' type='text' title='@{pcu}' name='attr_pcu' placeholder='1' value=''>
                                    <span class='label' data-i18n='bp'>BP</span>
                                    <input class='atk-special scalable-input input-field' type='text' title='@{bp}' name='attr_bp' placeholder='1' value=''>
                                </div>
                                <div class='row span-all'>
                                    <input class='label scalable-input input-field' data-i18n-placeholder='ammo' title='@{ammo_type}' name='attr_ammo_type' value='' type='text' placeholder='ammo' >
                                    <input title='@{ammo}' name='attr_ammo' type='number' value=''>
                                    <span class='label'>/</span>
                                    <input title='@{ammo_max}' name='attr_ammo_max' type='number' value=''>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='special'>SPECIAL</span>
                                    <input class='atk-special scalable-input input-field' type='text' title='@{special}' name='attr_special' placeholder='Array' value=''>
                                </div>
                                <div class='row span-all'>
                                    <select class='input-field atk-type' title='@{powered}' name='attr_powered'>
                                        <option class='off' value='OFF' data-i18n='off'>OFF</option>
                                        <option class='on' value='ON' data-i18n='on' selected>ON</option>
                                    </select>
                                </div>
                                <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'><span class='label field' data-i18n='attacher'>ATTACHER</span></label>
                                <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                <input class='field-tab macro-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                <textarea class='expandable atk-description input-field' title='@{attacher}' name='attr_attacher' ></textarea>
                                <textarea class='atk-description span-all input-field' title='@{description}' name='attr_description' placeholder='Description' value=''></textarea>
                                <div class='row span-all'>
                                    <input readonly=true class='id-label' title='@{id}' name='attr_id'></input>
                                </div>
                            </div>
                            <input hidden='true' name='attr_arc_status' type='text' value=''>
                            <div class='display'>
                                <button class='npcsummary' type='roll' title='%{repeating_attack_$X_ship_roll}' name='roll_ship_roll' value='@{whisper_state}&{template:sf_ship} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=@{name}}} {{leftbanner=^{@{arc}}}} {{r1=[[1d20+[[@{gunner_roll}]]@{attack_query}@{computer_query}@{arc_status}@{power_core_status}]]}} {{damage1=[[@{damage_dice}]]}} {{range=@{range} ^{hexes}}} {{class=^{@{class}}}} {{type=^{@{type}}}} {{curr_ammo=@{ammo}}} {{ammo_type=@{ammo_type}}} {{rightbanner=@{special}}} {{notes=@{description}}} @{attacher}'>
                                    <span class='label' title='@{name}' name='attr_name'></span>
                                </button>
                            </div>
                        </div>
                    </fieldset>
                    <label class='pseudo-repcontrol'>
                        <input hidden='true' type='checkbox' title='@{create_port}' name='attr_create_port' value='1'>
                        <span>&</span>
                    </label>
                </div>
            </div>
            <div class='aft-weapon section-container'>
                <div class='section'>
                    <h1 class='label' data-i18n='aft'>AFT</h1>
                </div>
                <div class='section-container'>
                    <fieldset class='repeating_attack'>
                        <input type='radio' hidden='true' title='@{arc}' name='attr_arc' value='forward' checked='checked'>
                        <input type='radio' hidden='true' title='@{arc}' name='attr_arc' value='port'>
                        <input class='filter' type='radio' hidden='true' title='@{arc}' name='attr_arc' value='aft'>
                        <input type='radio' hidden='true' title='@{arc}' name='attr_arc' value='starboard'>
                        <input type='radio' hidden='true' title='@{arc}' name='attr_arc' value='turret'>
                        <div class='filter-container attack'>
                            <input type='text' hidden='true' title='@{misc}' name='attr_misc' value=''>
                            <input type='text' hidden='true' title='@{damage_misc}' name='attr_damage_misc' value=''>
                            <input class="show-options" type="checkbox" title='@{show_options}' name="attr_show_options" value='1' checked="checked"><span>y</span>
                            <div class='row-options'>
                                <div class='row span-all display-margin'>
                                    <span class='label' data-i18n='name-u'>NAME</span>
                                    <input class='atk-name scalable-input input-field' type='text' title='@{name}' name='attr_name' placeholder='Laser Cannon' value=''>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='type'>TYPE</span>
                                    <select class='input-field label' title='@{type}' name='attr_type'>
                                        <option value='' direct-fire'' selected>-</option><option value='direct-fire' data-i8n='direct-fire'>DIRECT FIRE</option>
                                        <option value='tracking' data-i8n='tracking'>TRACKING</option>
                                    </select>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='class'>CLASS</span>
                                    <select class='input-field label proficiency' title='@{class}' name='attr_class'>
                                        <option value='light' data-i8n='light' selected>LIGHT</option>
                                        <option value='heavy' data-i8n='heavy'>HEAVY</option>
                                        <option value='capital' data-i8n='capital'>CAPITAL</option>
                                    </select>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='rng'>RNG</span>
                                    <select class='label atk-range-type' title='@{range}' name='attr_range'>
                                        <option value='' selected data-i18n='n/a'>NA</option>
                                        <option value='5' data-i18n='short'>SHORT</option>
                                        <option value='10' data-i18n='medium'>MEDIUM</option>
                                        <option value='20' data-i18n='long'>LONG</option>
                                    </select>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='dmg'>DMG</span>
                                    <input class='dmg-dice scalable-input input-field' type='text' name=attr_damage_dice placeholder='1d8' value=''>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='arc'>ARC</span>
                                    <select class='input-field atk-type' title='@{arc}' name='attr_arc'>
                                        <option value='forward' data-i18n='forward' selected>FORWARD</option>
                                        <option value='port' data-i18n='port'>PORT</option>
                                        <option value='aft' data-i18n='aft'>AFT</option>
                                        <option value='starboard' data-i18n='starboard' selected>STARBOARD</option>
                                        <option value='turret' data-i18n='turret'>TURRET</option>
                                    </select>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='pcu'>PCU</span>
                                    <input class='atk-special scalable-input input-field' type='text' title='@{pcu}' name='attr_pcu' placeholder='1' value=''>
                                    <span class='label' data-i18n='bp'>BP</span>
                                    <input class='atk-special scalable-input input-field' type='text' title='@{bp}' name='attr_bp' placeholder='1' value=''>
                                </div>
                                <div class='row span-all'>
                                    <input class='label scalable-input input-field' data-i18n-placeholder='ammo' title='@{ammo_type}' name='attr_ammo_type' value='' type='text' placeholder='ammo' >
                                    <input title='@{ammo}' name='attr_ammo' type='number' value=''>
                                    <span class='label'>/</span>
                                    <input title='@{ammo_max}' name='attr_ammo_max' type='number' value=''>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='special'>SPECIAL</span>
                                    <input class='atk-special scalable-input input-field' type='text' title='@{special}' name='attr_special' placeholder='Array' value=''>
                                </div>
                                <div class='row span-all'>
                                    <select class='input-field atk-type' title='@{powered}' name='attr_powered'>
                                        <option class='off' value='OFF' data-i18n='off'>OFF</option>
                                        <option class='on' value='ON' data-i18n='on' selected>ON</option>
                                    </select>
                                </div>
                                <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'><span class='label field' data-i18n='attacher'>ATTACHER</span></label>
                                <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                <input class='field-tab macro-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                <textarea class='expandable atk-description input-field' title='@{attacher}' name='attr_attacher' ></textarea>
                                <textarea class='atk-description span-all input-field' title='@{description}' name='attr_description' placeholder='Description' value=''></textarea>
                                <div class='row span-all'>
                                    <input readonly=true class='id-label' title='@{id}' name='attr_id'></input>
                                </div>
                            </div>
                            <input hidden='true' name='attr_arc_status' type='text' value=''>
                            <div class='display'>
                                <button class='npcsummary' type='roll' title='%{repeating_attack_$X_ship_roll}' name='roll_ship_roll' value='@{whisper_state}&{template:sf_ship} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=@{name}}} {{leftbanner=^{@{arc}}}} {{r1=[[1d20+[[@{gunner_roll}]]@{attack_query}@{computer_query}@{arc_status}@{power_core_status}]]}} {{damage1=[[@{damage_dice}]]}} {{range=@{range} ^{hexes}}} {{class=^{@{class}}}} {{type=^{@{type}}}} {{curr_ammo=@{ammo}}} {{ammo_type=@{ammo_type}}} {{rightbanner=@{special}}} {{notes=@{description}}} @{attacher}'>
                                    <span class='label' title='@{name}' name='attr_name'></span>
                                </button>
                            </div>
                        </div>
                    </fieldset>
                    <label class='pseudo-repcontrol'>
                        <input hidden='true' type='checkbox' title='@{create_aft}' name='attr_create_aft' value='1'>
                        <span>&</span>
                    </label>
                </div>
            </div>
            <div class='starboard-weapon section-container'>
                <div class='section'>
                    <h1 class='label' data-i18n='starboard'>STARBOARD</h1>
                </div>
                <div class='section-container'>
                    <fieldset class='repeating_attack'>
                        <input type='radio' hidden='true' title='@{arc}' name='attr_arc' value='forward' checked='checked'>
                        <input type='radio' hidden='true' title='@{arc}' name='attr_arc' value='port'>
                        <input type='radio' hidden='true' title='@{arc}' name='attr_arc' value='aft'>
                        <input class='filter' type='radio' hidden='true' title='@{arc}' name='attr_arc' value='starboard'>
                        <input type='radio' hidden='true' title='@{arc}' name='attr_arc' value='turret'>
                        <div class='filter-container attack'>
                            <input type='text' hidden='true' title='@{misc}' name='attr_misc' value=''>
                            <input type='text' hidden='true' title='@{damage_misc}' name='attr_damage_misc' value=''>
                            <input class="show-options" type="checkbox" title='@{show_options}' name="attr_show_options" value='1' checked="checked"><span>y</span>
                            <div class='row-options'>
                                <div class='row span-all display-margin'>
                                    <span class='label' data-i18n='name-u'>NAME</span>
                                    <input class='atk-name scalable-input input-field' type='text' title='@{name}' name='attr_name' placeholder='Laser Cannon' value=''>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='type'>TYPE</span>
                                    <select class='input-field label' title='@{type}' name='attr_type'>
                                        <option value='' direct-fire'' selected>-</option><option value='direct-fire' data-i8n='direct-fire'>DIRECT FIRE</option>
                                        <option value='tracking' data-i8n='tracking'>TRACKING</option>
                                    </select>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='class'>CLASS</span>
                                    <select class='input-field label proficiency' title='@{class}' name='attr_class'>
                                        <option value='light' data-i8n='light' selected>LIGHT</option>
                                        <option value='heavy' data-i8n='heavy'>HEAVY</option>
                                        <option value='capital' data-i8n='capital'>CAPITAL</option>
                                    </select>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='rng'>RNG</span>
                                    <select class='label atk-range-type' title='@{range}' name='attr_range'>
                                        <option value='' selected data-i18n='n/a'>NA</option>
                                        <option value='5' data-i18n='short'>SHORT</option>
                                        <option value='10' data-i18n='medium'>MEDIUM</option>
                                        <option value='20' data-i18n='long'>LONG</option>
                                    </select>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='dmg'>DMG</span>
                                    <input class='dmg-dice scalable-input input-field' type='text' name=attr_damage_dice placeholder='1d8' value=''>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='arc'>ARC</span>
                                    <select class='input-field atk-type' title='@{arc}' name='attr_arc'>
                                        <option value='forward' data-i18n='forward' selected>FORWARD</option>
                                        <option value='port' data-i18n='port'>PORT</option>
                                        <option value='aft' data-i18n='aft'>AFT</option>
                                        <option value='starboard' data-i18n='starboard' selected>STARBOARD</option>
                                        <option value='turret' data-i18n='turret'>TURRET</option>
                                    </select>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='pcu'>PCU</span>
                                    <input class='atk-special scalable-input input-field' type='text' title='@{pcu}' name='attr_pcu' placeholder='1' value=''>
                                    <span class='label' data-i18n='bp'>BP</span>
                                    <input class='atk-special scalable-input input-field' type='text' title='@{bp}' name='attr_bp' placeholder='1' value=''>
                                </div>
                                <div class='row span-all'>
                                    <input class='label scalable-input input-field' data-i18n-placeholder='ammo' title='@{ammo_type}' name='attr_ammo_type' value='' type='text' placeholder='ammo' >
                                    <input title='@{ammo}' name='attr_ammo' type='number' value=''>
                                    <span class='label'>/</span>
                                    <input title='@{ammo_max}' name='attr_ammo_max' type='number' value=''>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='special'>SPECIAL</span>
                                    <input class='atk-special scalable-input input-field' type='text' title='@{special}' name='attr_special' placeholder='Array' value=''>
                                </div>
                                <div class='row span-all'>
                                    <select class='input-field atk-type' title='@{powered}' name='attr_powered'>
                                        <option class='off' value='OFF' data-i18n='off'>OFF</option>
                                        <option class='on' value='ON' data-i18n='on' selected>ON</option>
                                    </select>
                                </div>
                                <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'><span class='label field' data-i18n='attacher'>ATTACHER</span></label>
                                <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                <input class='field-tab macro-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                <textarea class='expandable atk-description input-field' title='@{attacher}' name='attr_attacher' ></textarea>
                                <textarea class='atk-description span-all input-field' title='@{description}' name='attr_description' placeholder='Description' value=''></textarea>
                                <div class='row span-all'>
                                    <input readonly=true class='id-label' title='@{id}' name='attr_id'></input>
                                </div>
                            </div>
                            <input hidden='true' name='attr_arc_status' type='text' value=''>
                            <div class='display'>
                                <button class='npcsummary' type='roll' title='%{repeating_attack_$X_ship_roll}' name='roll_ship_roll' value='@{whisper_state}&{template:sf_ship} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=@{name}}} {{leftbanner=^{@{arc}}}} {{r1=[[1d20+[[@{gunner_roll}]]@{attack_query}@{computer_query}@{arc_status}@{power_core_status}]]}} {{damage1=[[@{damage_dice}]]}} {{range=@{range} ^{hexes}}} {{class=^{@{class}}}} {{type=^{@{type}}}} {{curr_ammo=@{ammo}}} {{ammo_type=@{ammo_type}}} {{rightbanner=@{special}}} {{notes=@{description}}} @{attacher}'>
                                    <span class='label' title='@{name}' name='attr_name'></span>
                                </button>
                            </div>
                        </div>
                    </fieldset>
                    <label class='pseudo-repcontrol'>
                        <input hidden='true' type='checkbox' title='@{create_starboard}' name='attr_create_starboard' value='1'>
                        <span>&</span>
                    </label>
                </div>
            </div>
            <div class='turret-weapon section-container'>
                <div class='section'>
                    <h1 class='label' data-i18n='turret'>TURRET</h1>
                </div>
                <div class='section-container'>
                    <fieldset class='repeating_attack'>
                        <input type='radio' hidden='true' title='@{arc}' name='attr_arc' value='forward' checked='checked'>
                        <input type='radio' hidden='true' title='@{arc}' name='attr_arc' value='port'>
                        <input type='radio' hidden='true' title='@{arc}' name='attr_arc' value='aft'>
                        <input type='radio' hidden='true' title='@{arc}' name='attr_arc' value='starboard'>
                        <input class='filter' type='radio' hidden='true' title='@{arc}' name='attr_arc' value='turret'>
                        <div class='filter-container attack'>
                            <input type='text' hidden='true' title='@{misc}' name='attr_misc' value=''>
                            <input type='text' hidden='true' title='@{damage_misc}' name='attr_damage_misc' value=''>
                            <input class="show-options" type="checkbox" title='@{show_options}' name="attr_show_options" value='1' checked="checked"><span>y</span>
                            <div class='row-options'>
                                <div class='row span-all display-margin'>
                                    <span class='label' data-i18n='name-u'>NAME</span>
                                    <input class='atk-name scalable-input input-field' type='text' title='@{name}' name='attr_name' placeholder='Laser Cannon' value=''>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='type'>TYPE</span>
                                    <select class='input-field label' title='@{type}' name='attr_type'>
                                        <option value='' direct-fire'' selected>-</option><option value='direct-fire' data-i8n='direct-fire'>DIRECT FIRE</option>
                                        <option value='tracking' data-i8n='tracking'>TRACKING</option>
                                    </select>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='class'>CLASS</span>
                                    <select class='input-field label proficiency' title='@{class}' name='attr_class'>
                                        <option value='light' data-i8n='light' selected>LIGHT</option>
                                        <option value='heavy' data-i8n='heavy'>HEAVY</option>
                                        <option value='capital' data-i8n='capital'>CAPITAL</option>
                                    </select>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='rng'>RNG</span>
                                    <select class='label atk-range-type' title='@{range}' name='attr_range'>
                                        <option value='' selected data-i18n='n/a'>NA</option>
                                        <option value='5' data-i18n='short'>SHORT</option>
                                        <option value='10' data-i18n='medium'>MEDIUM</option>
                                        <option value='20' data-i18n='long'>LONG</option>
                                    </select>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='dmg'>DMG</span>
                                    <input class='dmg-dice scalable-input input-field' type='text' name=attr_damage_dice placeholder='1d8' value=''>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='arc'>ARC</span>
                                    <select class='input-field atk-type' title='@{arc}' name='attr_arc'>
                                        <option value='forward' data-i18n='forward' selected>FORWARD</option>
                                        <option value='port' data-i18n='port'>PORT</option>
                                        <option value='aft' data-i18n='aft'>AFT</option>
                                        <option value='starboard' data-i18n='starboard' selected>STARBOARD</option>
                                        <option value='turret' data-i18n='turret'>TURRET</option>
                                    </select>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='pcu'>PCU</span>
                                    <input class='atk-special scalable-input input-field' type='text' title='@{pcu}' name='attr_pcu' placeholder='1' value=''>
                                    <span class='label' data-i18n='bp'>BP</span>
                                    <input class='atk-special scalable-input input-field' type='text' title='@{bp}' name='attr_bp' placeholder='1' value=''>
                                </div>
                                <div class='row span-all'>
                                    <input class='label scalable-input input-field' data-i18n-placeholder='ammo' title='@{ammo_type}' name='attr_ammo_type' value='' type='text' placeholder='ammo' >
                                    <input title='@{ammo}' name='attr_ammo' type='number' value=''>
                                    <span class='label'>/</span>
                                    <input title='@{ammo_max}' name='attr_ammo_max' type='number' value=''>
                                </div>
                                <div class='row span-all'>
                                    <span class='label' data-i18n='special'>SPECIAL</span>
                                    <input class='atk-special scalable-input input-field' type='text' title='@{special}' name='attr_special' placeholder='Array' value=''>
                                </div>
                                <div class='row span-all'>
                                    <select class='input-field atk-type' title='@{powered}' name='attr_powered'>
                                        <option class='off' value='OFF' data-i18n='off'>OFF</option>
                                        <option class='on' value='ON' data-i18n='on' selected>ON</option>
                                    </select>
                                </div>
                                <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                <label class='expandable'><input class='field-tab macro-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'><span class='label field' data-i18n='attacher'>ATTACHER</span></label>
                                <input class='field-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                <input class='field-tab macro-tab' type='checkbox' title='@{macro_checkbox}' name='attr_macro_checkbox' value='1' hidden='true'>
                                <textarea class='expandable atk-description input-field' title='@{attacher}' name='attr_attacher' ></textarea>
                                <textarea class='atk-description span-all input-field' title='@{description}' name='attr_description' placeholder='Description' value=''></textarea>
                                <div class='row span-all'>
                                    <input readonly=true class='id-label' title='@{id}' name='attr_id'></input>
                                </div>
                            </div>
                            <input hidden='true' name='attr_arc_status' type='text' value=''>
                            <div class='display'>
                                <button class='npcsummary' type='roll' title='%{repeating_attack_$X_ship_roll}' name='roll_ship_roll' value='@{whisper_state}&{template:sf_ship} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=@{name}}} {{leftbanner=^{@{arc}}}} {{r1=[[1d20+[[@{gunner_roll}]]@{attack_query}@{computer_query}@{arc_status}@{power_core_status}]]}} {{damage1=[[@{damage_dice}]]}} {{range=@{range} ^{hexes}}} {{class=^{@{class}}}} {{type=^{@{type}}}} {{curr_ammo=@{ammo}}} {{ammo_type=@{ammo_type}}} {{rightbanner=@{special}}} {{notes=@{description}}} @{attacher}'>
                                    <span class='label' title='@{name}' name='attr_name'></span>
                                </button>
                            </div>
                        </div>
                    </fieldset>
                    <label class='pseudo-repcontrol'>
                        <input hidden='true' type='checkbox' title='@{create_turret}' name='attr_create_turret' value='1'>
                        <span>&</span>
                    </label>
                </div>
            </div>
        </div>
        <div class='bottom-section'>
            <div class='systems section-container'>
                <div class='section'>
                    <h1 class='label' data-i18n='systems'>SYSTEMS</h1>
                </div>
                <div class='section-container'>
                    <fieldset class='repeating_system'>
                        <input type='radio' class='filter' title='@{type}' name='attr_type' value='system' hidden='true' checked='checked'>
                        <input type='radio' title='@{type}' name='attr_type' value='expansion' hidden='true'>
                        <div class='filter-container system'>
                            <input class="show-options" type="checkbox" title='@{show_options}' name="attr_show_options" value='1' checked="checked"><span>y</span>
                            <div class='row-options'>
                                <div class='row '>
                                    <span class='label' data-i18n='name-u'>NAME</span>
                                    <input class='atk-name scalable-input input-field' type='text' title='@{name}' name='attr_name' placeholder='Power Core' value=''>
                                </div>
                                <div class='row'>
                                    <span class='label' data-i18n='purpose'>PURPOSE</span>
                                    <select class='input-field label' title='@{purpose}' name='attr_purpose'>
                                        <option value='power-core' data-i8n='power-core' selected>POWER CORE</option>
                                        <option value='thrusters' data-i8n='thrusters'>THRUSTERS</option>
                                        <option value='armor' data-i8n='armor'>ARMOR</option>
                                        <option value='computer' data-i8n='computer'>COMPUTER</option>
                                        <option value='crew-quarters' data-i8n='crew-quarters'>CREW QUARTERS</option>
                                        <option value='countermeasures' data-i8n='countermeasures'>COUNTERMEASURES</option>
                                        <option value='drift-engines' data-i8n='drift-engines'>DRIFT ENGINES</option>
                                        <option value='expansion-bay' data-i8n='expansion-bay'>EXPANSION BAY</option>
                                        <option value='security' data-i8n='security'>SECURITY</option>
                                        <option value='sensors' data-i8n='sensors'>SENSORS</option>
                                        <option value='shields' data-i8n='shields'>SHIELDS</option>
                                    </select>
                                </div>
                                <div class='row'>
                                    <select class='input-field atk-type' title='@{powered}' name='attr_powered'>
                                        <option class='off' value='OFF' data-i18n='off'>OFF</option>
                                        <option class='on' value='ON' data-i18n='on' selected>ON</option>
                                    </select>
                                    <span class='label' data-i18n='pcu'>PCU</span>
                                    <input class='atk-special scalable-input input-field' type='text' title='@{pcu}' name='attr_pcu' placeholder='1' value=''>
                                    <span class='label' data-i18n='bp'>BP</span>
                                    <input class='atk-special scalable-input input-field' type='text' title='@{bp}' name='attr_bp' placeholder='1' value=''>
                                </div>
                                <div class='row'>
                                    <span class='label' data-i18n='computer-bonus'>COMPUTER BONUS</span>
                                    <input class='scalable-input input-field' title='@{comp_bonus}' type='text' name='attr_comp_bonus' value=''>
                                    <span class='label' data-i18n='sensor-bonus'>SENSOR BONUS</span>
                                    <input class='scalable-input input-field' title='@{sensor_bonus}' type='text' name='attr_sensor_bonus' value=''>
                                </div>
                                <div class='row'>
                                    <span class='label' data-i18n='shields'>SHIELDS</span>
                                    <input class='scalable-input input-field' title='@{shields}' type='text' name='attr_shields' value=''>
                                    <span class='label armor'>b</span>
                                    <input class='scalable-input input-field' title='@{armor}' type='text' name='attr_armor' value=''>
                                    <span class='label' data-i18n='tl'>TL</span>
                                    <input class='scalable-input input-field' title='@{countermeasure}' type='text' name='attr_countermeasure' value=''>
                                </div>
                                <div class='row'>
                                    <textarea class='atk-description scalable-input input-field' title='@{description}' name='attr_description' placeholder='Description' value=''></textarea>
                                </div>
                            </div>
                            <div class='display'>
                                <button class='npcsummary' type='roll' title='%{roll}' name='roll_roll' value='@{whisper_state}&{template:sf_attack}{{name=@{character_name}}} {{characterid=@{character_id}}} {{title=@{name}}} {{r1name=@{name}}} {{r1=[[1d20+@{base_attack_bonus}@{attack_query}]]}} {{damage1=[[@{damage_dice}]]}} {{notes=@{description}}}'>
                                    <span class='label' title='@{name}' name='attr_name'></span>
                                </button>
                            </div>
                        </div>
                    </fieldset>
                    <label class='pseudo-repcontrol'>
                        <input hidden='true' type='checkbox' title='@{create_system}' name='attr_create_system' value='1'>
                        <span>&</span>
                    </label>
                </div>
            </div>
            <div class='expansion section-container'>
                <div class='section'>
                    <h1 class='label' data-i18n='expansion-bays'>EXPANSION BAYS</h1>
                </div>
                <div class='section-container'>
                    <fieldset class='repeating_system'>
                        <input type='radio'  title='@{type}' name='attr_type' value='system' hidden='true' checked='checked'>
                        <input type='radio' class='filter' title='@{type}' name='attr_type' value='expansion' hidden='true'>
                        <div class='filter-container system'>
                            
                            <input class="show-options" type="checkbox" title='@{show_options}' name="attr_show_options" value='1' checked="checked"><span>y</span>
                            <div class='row-options'>
                                <div class='row '>
                                    <span class='label' data-i18n='name-u'>NAME</span>
                                    <input class='atk-name scalable-input input-field' type='text' title='@{name}' name='attr_name' placeholder='Power Core' value=''>
                                </div>
                                <div class='row'>
                                    <span class='label' data-i18n='purpose'>PURPOSE</span>
                                    <select class='input-field label' title='@{purpose}' name='attr_purpose'>
                                        <option value='power-core' data-i8n='power-core' selected>POWER CORE</option>
                                        <option value='thrusters' data-i8n='thrusters'>THRUSTERS</option>
                                        <option value='armor' data-i8n='armor'>ARMOR</option>
                                        <option value='computer' data-i8n='computer'>COMPUTER</option>
                                        <option value='crew-quarters' data-i8n='crew-quarters'>CREW QUARTERS</option>
                                        <option value='countermeasures' data-i8n='countermeasures'>COUNTERMEASURES</option>
                                        <option value='drift-engines' data-i8n='drift-engines'>DRIFT ENGINES</option>
                                        <option value='expansion-bay' data-i8n='expansion-bay'>EXPANSION BAY</option>
                                        <option value='security' data-i8n='security'>SECURITY</option>
                                        <option value='sensors' data-i8n='sensors'>SENSORS</option>
                                        <option value='shields' data-i8n='shields'>SHIELDS</option>
                                    </select>
                                </div>
                                <div class='row'>
                                    <select class='input-field atk-type' title='@{powered}' name='attr_powered'>
                                        <option class='off' value='OFF' data-i18n='off'>OFF</option>
                                        <option class='on' value='ON' data-i18n='on' selected>ON</option>
                                    </select>
                                    <span class='label' data-i18n='pcu'>PCU</span>
                                    <input class='atk-special scalable-input input-field' type='text' title='@{pcu}' name='attr_pcu' placeholder='1' value=''>
                                    <span class='label' data-i18n='bp'>BP</span>
                                    <input class='atk-special scalable-input input-field' type='text' title='@{bp}' name='attr_bp' placeholder='1' value=''>
                                </div>
                                <div class='row'>
                                    <span class='label' data-i18n='computer-bonus'>COMPUTER BONUS</span>
                                    <input class='scalable-input input-field' title='@{comp_bonus}' type='text' name='attr_comp_bonus' value=''>
                                    <span class='label' data-i18n='sensor-bonus'>SENSOR BONUS</span>
                                    <input class='scalable-input input-field' title='@{sensor_bonus}' type='text' name='attr_sensor_bonus' value=''>
                                </div>
                                <div class='row'>
                                    <span class='label' data-i18n='shields'>SHIELDS</span>
                                    <input class='scalable-input input-field' title='@{shields}' type='text' name='attr_shields' value=''>
                                    <span class='label armor'>b</span>
                                    <input class='scalable-input input-field' title='@{armor}' type='text' name='attr_armor' value=''>
                                    <span class='label' data-i18n='tl'>TL</span>
                                    <input class='scalable-input input-field' title='@{countermeasure}' type='text' name='attr_countermeasure' value=''>
                                </div>
                                <div class='row'>
                                    <textarea class='atk-description scalable-input input-field' title='@{description}' name='attr_description' placeholder='Description' value=''></textarea>
                                </div><div class='row'><input readonly=true class='id-label' title='@{id}' name='attr_id'></input>
                                </div>
                            </div>
                            <div class='display'>
                                <button class='npcsummary' type='roll' title='%{roll}' name='roll_roll' value='@{whisper_state}&{template:sf_attack}{{name=@{character_name}}} {{characterid=@{character_id}}} {{title=@{name}}} {{r1name=@{name}}} {{r1=[[1d20+@{base_attack_bonus}@{attack_query}]]}} {{damage1=[[@{damage_dice}]]}} {{notes=@{description}}}'>
                                    <span class='label' title='@{name}' name='attr_name'></span>
                                </button>
                            </div>
                        </div>
                    </fieldset>
                    <label class='pseudo-repcontrol'>
                        <input hidden='true' type='checkbox' title='@{create_expansion}' name='attr_create_expansion' value='1'>
                        <span>&</span>
                    </label>
                
                
                </div>
                
                
                
                
            </div>
            <div class='cargo section-container'>
                <div class='section'>
                    <h1 class='label' data-i18n='cargo/passengers'>CARGO/PASSENGERS</h1>
                </div>
                <div class='section-container'>
                    <div class='top-gutter'></div>
                    <textarea title='@{cargo}' name='attr_cargo' data-i18n-placeholder='cargo-placeholder' placeholder='Enter any cargo/passengers being carried here'></textarea>
                    <div class='top-gutter'></div>
                </div>
            </div>
        </div>
        <div class='critical section-container'>
            <div class='section'>
                <h1 class='label' data-i18n='system-status'>SYSTEM STATUS</h1>
            </div>
            <div class='section-container'>
                <div class='roll-crit'>
                    <button title='%{starship_crit}' class='label' name='roll_starship_crit' type='roll' value='&{template:sf_ship} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=^{crit-effect}}} {{rcrit=[[1d100cf<0cs<0]]}} {{rcrit2=[[1d4cf<0cs<0]]}}' data-i18n='roll-crit'>ROLL CRITICAL EFFECT</button>
                </div>
                <div class='life-support'>
                    <span class='label' data-i18n='life-support-dice-range'>LIFE SUPPORT (1-10)</span>
                    <input class='hide-patch' name='attr_life_support_status' type='hidden' value='+0'>
                    <input class='patch-status' name='attr_life_support_patch' type='hidden'>
                    <label class='patch'><input name='attr_life_support_patch' type='checkbox' hidden='true' value='1' data-toggle="toggle"><span class='label patched' data-i18n='patched'>PATCHED</span><span class='label unpatched' data-i18n='unpatched'>UNPATCHED</span></label>
                    <label class='nominal'><input type='radio' hidden='true' title='@{life_support_status}' name='attr_life_support_status' value='+0' checked='checked'><span class='label' data-i18n='nominal'>NOMINAL</span></label>
                    <label class='glitch'><input type='radio' hidden='true' title='@{life_support_status}' name='attr_life_support_status' value='-2'><span class='label' data-i18n='glitching'>GLITCHING</span></label>
                    <label class='malfunction'><input type='radio' hidden='true' title='@{life_support_status}' name='attr_life_support_status' value='-4'><span class='label' data-i18n='malfunctioning'>MALFUNCTIONING</span></label>
                    <label class='wreck'><input type='radio' hidden='true' title='@{life_support_status}' name='attr_life_support_status' value='+1d0cf<0cs>1[wrecked]'><span class='label' data-i18n='wrecked'>WRECKED</span></label>
                </div>
                <div class='sensors'>
                    <span class='label' data-i18n='sensors-dice-range'>SENSORS (11-30)</span>
                    <input class='hide-patch' name='attr_sensors_status' type='hidden' value='+0'>
                    <input class='patch-status' name='attr_sensors_patch' type='hidden'>
                    <label class='patch'><input name='attr_sensors_patch' type='checkbox' hidden='true' value='1'><span class='label patched' data-i18n='patched'>PATCHED</span><span class='label unpatched' data-i18n='unpatched'>UNPATCHED</span></label>
                    <label class='nominal'><input type='radio' hidden='true' title='@{sensors_status}' name='attr_sensors_status' value='+0' checked='checked'><span class='label' data-i18n='nominal'>NOMINAL</span></label>
                    <label class='glitch'><input type='radio' hidden='true' title='@{sensors_status}' name='attr_sensors_status' value='-2'><span class='label' data-i18n='glitching'>GLITCHING</span></label>
                    <label class='malfunction'><input type='radio' hidden='true' title='@{sensors_status}' name='attr_sensors_status' value='-4'><span class='label' data-i18n='malfunctioning'>MALFUNCTIONING</span></label>
                    <label class='wreck'><input type='radio' hidden='true' title='@{sensors_status}' name='attr_sensors_status' value='+1d0cf<0cs>1[wrecked]'><span class='label' data-i18n='wrecked'>WRECKED</span></label>
                </div>
                <div class='weapon-background'></div>
                <div class='weapons'>
                    <span class='label' data-i18n='weapons-array-dice-range'>WEAPONS ARRAY (31-60)</span>
                </div>
                <div class='engines'>
                    <span class='label' data-i18n='engines-dice-range'>ENGINES (61-80)</span>
                    <input class='hide-patch' name='attr_engines_status' type='hidden' value='+0'>
                    <input class='patch-status' name='attr_engines_patch' type='hidden'>
                    <label class='patch'><input name='attr_engines_patch' type='checkbox' hidden='true' value='1'><span class='label patched' data-i18n='patched'>PATCHED</span><span class='label unpatched' data-i18n='unpatched'>UNPATCHED</span></label>
                    <label class='nominal'><input type='radio' hidden='true' title='@{engines_status}' name='attr_engines_status' value='+0' checked='checked'><span class='label' data-i18n='nominal'>NOMINAL</span></label>
                    <label class='glitch'><input type='radio' hidden='true' title='@{engines_status}' name='attr_engines_status' value='-2'><span class='label' data-i18n='glitching'>GLITCHING</span></label>
                    <label class='malfunction'><input type='radio' hidden='true' title='@{engines_status}' name='attr_engines_status' value='-4'><span class='label' data-i18n='malfunctioning'>MALFUNCTIONING</span></label>
                    <label class='wreck'><input type='radio' hidden='true' title='@{engines_status}' name='attr_engines_status' value='+1d0cf<0cs>1[wrecked]'><span class='label' data-i18n='wrecked'>WRECKED</span></label>
                </div>
                <div class='power'>
                    <span class='label' data-i18n='power-core-dice-range'>POWER CORE (81-100)</span>
                    <input class='hide-patch' name='attr_power_core_status' type='hidden' value='+0'>
                    <input class='patch-status' name='attr_power_core_patch' type='hidden'>
                    <label class='patch'><input name='attr_power_core_patch' type='checkbox' hidden='true' value='1'><span class='label patched' data-i18n='patched'>PATCHED</span><span class='label unpatched' data-i18n='unpatched'>UNPATCHED</span></label>
                    <label class='nominal'><input type='radio' hidden='true' title='@{power_core_status}' name='attr_power_core_status' value='+0' checked='checked'><span class='label' data-i18n='nominal'>NOMINAL</span></label>
                    <label class='glitch'><input type='radio' hidden='true' title='@{power_core_status}' name='attr_power_core_status' value=' '><span class='label' data-i18n='glitching'>GLITCHING</span></label>
                    <label class='malfunction'><input type='radio' hidden='true' title='@{power_core_status}' name='attr_power_core_status' value='-2'><span class='label' data-i18n='malfunctioning'>MALFUNCTIONING</span></label>
                    <label class='wreck'><input type='radio' hidden='true' title='@{power_core_status}' name='attr_power_core_status' value='-4'><span class='label' data-i18n='wrecked'>WRECKED</span></label>
                </div>
                <div class='weapon-details'>
                    <span class='label nominal' data-i18n='nominal'>NOMINAL</span>
                    <span class='label glitch' data-i18n='glitching'>GLITCHING</span>
                    <span class='label malfunction' data-i18n='malfunctioning'>MALFUNCTIONING</span>
                    <span class='label wreck' data-i18n='wrecked'>WRECKED</span>
                    <div class='status nominal'>
                        <label class='forward'><input type='radio' hidden='true' title='@{forward_weapons_status}' name='attr_forward_weapons_status' value='' checked='checked'><span class='label' data-i18n='fwd (1)'>FWD (1)</span><div></div></label>
                        <label class='starboard'><input type='radio' hidden='true' title='@{starboard_weapons_status}' name='attr_starboard_weapons_status' value='' checked='checked'><span class='label' data-i18n='stbd (2)'>STBD (2)</span><div></div></label>
                        <label class='port'><input type='radio' hidden='true' title='@{port_weapons_status}' name='attr_port_weapons_status' value='' checked='checked'><span class='label' data-i18n='port (4)'>PORT (4)</span><div></div></label>
                        <label class='aft'><input type='radio' hidden='true' title='@{aft_weapons_status}' name='attr_aft_weapons_status' value='' checked='checked'><span class='label' data-i18n='aft (3)'>AFT (3)</span><div></div></label>
                    </div>
                    <div class='status glitch'>
                        <label class='forward'><input type='radio' hidden='true' title='@{forward_weapons_status}' name='attr_forward_weapons_status' value='-2'><span class='label' data-i18n='fwd (1)'>FWD (1)</span><div></div></label>
                        <label class='starboard'><input type='radio' hidden='true' title='@{starboard_weapons_status}' name='attr_starboard_weapons_status' value='-2'><span class='label' data-i18n='stbd (2)'>STBD (2)</span><div></div></label>
                        <label class='port'><input type='radio' hidden='true' title='@{port_weapons_status}' name='attr_port_weapons_status' value='-2'><span class='label' data-i18n='port (4)'>PORT (4)</span><div></div></label>
                        <label class='aft'><input type='radio' hidden='true' title='@{aft_weapons_status}' name='attr_aft_weapons_status' value='-2'><span class='label' data-i18n='aft (3)'>AFT (3)</span><div></div></label>
                    </div>
                    <div class='status malfunction'>
                        <label class='forward'><input type='radio' hidden='true' title='@{forward_weapons_status}' name='attr_forward_weapons_status' value='-4'><span class='label' data-i18n='fwd (1)'>FWD (1)</span><div></div></label>
                        <label class='starboard'><input type='radio' hidden='true' title='@{starboard_weapons_status}' name='attr_starboard_weapons_status' value='-4'><span class='label' data-i18n='stbd (2)'>STBD (2)</span><div></div></label>
                        <label class='port'><input type='radio' hidden='true' title='@{port_weapons_status}' name='attr_port_weapons_status' value='-4'><span class='label' data-i18n='port (4)'>PORT (4)</span><div></div></label>
                        <label class='aft'><input type='radio' hidden='true' title='@{aft_weapons_status}' name='attr_aft_weapons_status' value='-4'><span class='label' data-i18n='aft (3)'>AFT (3)</span><div></div></label>
                    </div>
                    <div class='status wreck'>
                        <label class='forward'><input type='radio' hidden='true' title='@{forward_weapons_status}' name='attr_forward_weapons_status' value='+1d0cf<0cs>1[wrecked]'><span class='label' data-i18n='fwd (1)'>FWD (1)</span><div></div></label>
                        <label class='starboard'><input type='radio' hidden='true' title='@{starboard_weapons_status}' name='attr_starboard_weapons_status' value='+1d0cf<0cs>1[wrecked]'><span class='label' data-i18n='stbd (2)'>STBD (2)</span><div></div></label>
                        <label class='port'><input type='radio' hidden='true' title='@{port_weapons_status}' name='attr_port_weapons_status' value='+1d0cf<0cs>1[wrecked]'><span class='label' data-i18n='port (4)'>PORT (4)</span><div></div></label>
                        <label class='aft'><input type='radio' hidden='true' title='@{aft_weapons_status}' name='attr_aft_weapons_status' value='+1d0cf<0cs>1[wrecked]'><span class='label' data-i18n='aft (3)'>AFT (3)</span><div></div></label>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <span class='disclaimer' data-i18n='disclaimer'> 2018. Starfinder, the Starfinder logo, the Paizo golem, all Paizo titles, the Starfinder Roleplaying Game rules, and Paizos character names and distinctive likenesses are property and copyright of Paizo, Inc. in the United States and other countries.</span>
</div>
<div class='rolltemplates' hidden='true'>
    <!-- Roll Template Definitions
    Generic Roll Template
    Macro Text: 
        @{whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title= }} {{r1name= }} {{r1= }} {{notes= }}
    -->
    <rolltemplate class="sheet-rolltemplate-sf_generic">
        {{#title}}
            <div class='generic-header'>
                <div>
                    {{title}}
                </div> 
            </div>
        {{/title}}
        {{#leftbanner}}
            <div class='side-banner left'>
                <div>
                    {{leftbanner}}
                </div>
            </div>
        {{/leftbanner}}
        <div class='generic-body'>
            <div class='content-container'>{{#r1}}
                    <div class='split-container across'>
                        <div class='highlighted split r1name'>
                            {{#r1name}}
                                {{r1name}}
                            {{/r1name}}
                            {{^r1name}}
                                <span data-i18n='check'>CHECK</span>
                            {{/r1name}}
                        </div>
                        <div class='highlighted split roll'>
                            {{r1}}
                        </div>
                    </div>
                {{/r1}}{{#r2}}
                    <div class='split-container across'>
                        <div class='highlighted split r1name'>
                            {{#r2name}}
                                {{r2name}}
                            {{/r2name}}
                            {{^r2name}}
                                <span data-i18n='check'>CHECK</span>
                            {{/r2name}}
                        </div>
                        <div class='highlighted split roll'>
                            {{r2}}
                        </div>
                    </div>
                {{/r2}}{{#r3}}
                    <div class='split-container across'>
                        <div class='highlighted split r1name'>
                            {{#r3name}}
                                {{r3name}}
                            {{/r3name}}
                            {{^r3name}}
                                <span data-i18n='check'>CHECK</span>
                            {{/r3name}}
                        </div>
                        <div class='highlighted split roll'>
                            {{r3}}
                        </div>
                    </div>
                {{/r3}}{{#r4}}
                    <div class='split-container across'>
                        <div class='highlighted split r1name'>
                            {{#r4name}}
                                {{r4name}}
                            {{/r4name}}
                            {{^r4name}}
                                <span data-i18n='check'>CHECK</span>
                            {{/r4name}}
                        </div>
                        <div class='highlighted split roll'>
                            {{r4}}
                        </div>
                    </div>
                {{/r4}}{{#r5}}
                    <div class='split-container across'>
                        <div class='highlighted split r1name'>
                            {{#r5name}}
                                {{r5name}}
                            {{/r5name}}
                            {{^r5name}}
                                <span data-i18n='check'>CHECK</span>
                            {{/r5name}}
                        </div>
                        <div class='highlighted split roll'>
                            {{r5}}
                        </div>
                    </div>
                {{/r5}}{{#notes}}
                    <div class='highlighted across notes-row'>
                        <span class='notes' data-i18n='notes:'>NOTES:</span><span> {{notes}}</span>
                    </div>
                {{/notes}}{{#buttons0}}
                    <div class='highlighted across notes-row'>
                        <span>{{buttons0}}</span>
                    </div>
                {{/buttons0}}{{#buttons1}}
                    <div class='highlighted across notes-row'>
                        <span>{{buttons1}}</span>
                    </div>
                {{/buttons1}}{{#buttons2}}
                    <div class='highlighted across notes-row'>
                        <span>{{buttons2}}</span>
                    </div>
                {{/buttons2}}{{#buttons3}}
                    <div class='highlighted across notes-row'>
                        <span>{{buttons3}}</span>
                    </div>
                {{/buttons3}}{{#buttons4}}
                    <div class='highlighted across notes-row'>
                        <span>{{buttons4}}</span>
                    </div>
                {{/buttons4}}{{#buttons5}}
                    <div class='highlighted across notes-row'>
                        <span>{{buttons5}}</span>
                    </div>
                {{/buttons5}}{{#buttons6}}
                    <div class='highlighted across notes-row'>
                        <span>{{buttons6}}</span>
                    </div>
                {{/buttons6}}{{#buttons7}}
                    <div class='highlighted across notes-row'>
                        <span>{{buttons7}}</span>
                    </div>
                {{/buttons7}}{{#buttons8}}
                    <div class='highlighted across notes-row'>
                        <span>{{buttons8}}</span>
                    </div>
                {{/buttons8}}{{#buttons9}}
                    <div class='highlighted across notes-row'>
                        <span>{{buttons9}}</span>
                    </div>
                {{/buttons9}}</div>
        </div>
        {{#rightbanner}}
            <div class='side-banner right'>
                <div>
                    {{rightbanner}}
                </div>
            </div>
        {{/rightbanner}}
        {{#name}}
            <div class='generic-footer'>
                <div>
                    {{#characterid}}
                        {{#name}}
                            [{{name}}](https://journal.roll20.net/character/{{characterid}})
                        {{/name}}
                    {{/characterid}}
                    {{^characterid}}
                        {{name}}
                    {{/characterid}}
                </div>
            </div>
        {{/name}}
    </rolltemplate>
    <!-- Attack Roll Templates -->
    <!-- Macro Text: 
        @{whisper_state}&{template:sf_attack} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=@{name}}} {{leftbanner=^{level} [[@{level}d1]]}} {{r1=[[1d20+@{base_attack_bonus}[BAB]+@{ability}[ABILITY]@{misc}@{bonus}]]}} 
        {{damagetype=@{type}}} {{damage1=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} 
        {{crit1damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit1effect=@{crit}}}
        {{targets=}} {{range=}}
        {{notes=@{description}}}
    -->
    <rolltemplate class="sheet-rolltemplate-sf_attack">
        {{#title}}
            <div class='generic-header'>
                <div>
                    {{title}}
                </div>
            </div>
        {{/title}}
        {{#leftbanner}}
            <div class='side-banner left'>
                <div>
                    {{leftbanner}}
                </div>
            </div>
        {{/leftbanner}}
        <div class='generic-body'>
            <div class='content-container'>{{#r1}}
                    {{#rollGreater() fullattack 1}}
                        <span class='across attack-label' data-i18n='1st-attack'>1st ATTACK</span>
                    {{/rollGreater() fullattack 1}}
                    <div class='split-container across'>
                        <div class='highlighted split r1name'>
                            {{#r1name}}
                                {{r1name}}
                            {{/r1name}}
                            {{^r1name}}
                                <span data-i18n='attack'>ATTACK</span>
                            {{/r1name}}
                        </div>
                        <div class='highlighted split roll'>
                            {{r1}}
                        </div>
                    </div>
                {{/r1}}{{#damage1}}
                    <div class='split-container across'>
                        <div class='highlighted split r1name'>
                            {{#damage1type}}
                                {{damage1type}}
                            {{/damage1type}}
                            {{^damage1type}}
                                <span data-i18n='damage'>DAMAGE</span>
                            {{/damage1type}}
                        </div>
                        <div class='highlighted split roll'>
                            {{damage1}}
                            {{#rollWasCrit() r1}}
                                {{#crit1damage}}
                                    +{{crit1damage}}
                                {{/crit1damage}}
                                {{#crit1effect}}
                                    <br>+{{crit1effect}}
                                {{/crit1effect}}
                            {{/rollWasCrit() r1}}
                        </div>
                    </div>
                {{/damage1}}{{#rollGreater() fullattack 1}}
                    <span class='across attack-label' data-i18n='2nd-attack'>2nd ATTACK</span>
                    {{#r2}}
                        <div class='split-container across'>
                            <div class='highlighted split r1name'>
                                {{#r2name}}
                                    {{r2name}}
                                {{/r2name}}
                                {{^r2name}}
                                    <span data-i18n='attack'>ATTACK</span>
                                {{/r2name}}
                            </div>
                            <div class='highlighted split roll'>
                                {{r2}}
                            </div>
                        </div>
                    {{/r2}}
                    {{#damage2}}
                        <div class='split-container across'>
                            <div class='highlighted split r1name'>
                                {{#damage2type}}
                                    {{damage2type}}
                                {{/damage2type}}
                                {{^damage2type}}
                                    <span data-i18n='damage'>DAMAGE</span>
                                {{/damage2type}}
                            </div>
                            <div class='highlighted split roll'>
                                {{damage2}}
                                {{#rollWasCrit() r2}}
                                    {{#crit2damage}}
                                        +{{crit2damage}}
                                    {{/crit2damage}}
                                    {{#crit2effect}}
                                        <br>+{{crit2effect}}
                                    {{/crit2effect}}
                                {{/rollWasCrit() r2}}
                            </div>
                        </div>
                    {{/damage2}}{{/rollGreater() fullattack 1}}{{#rollGreater() fullattack 2}}
                    <span class='across attack-label' data-i18n='3rd-attack'>3rd ATTACK</span>
                    {{#r3}}
                        <div class='split-container across'>
                            <div class='highlighted split r1name'>
                                {{#r3name}}
                                    {{r3name}}
                                {{/r3name}}
                                {{^r3name}}
                                    <span data-i18n='attack'>ATTACK</span>
                                {{/r3name}}
                            </div>
                            <div class='highlighted split roll'>
                                {{r3}}
                            </div>
                        </div>
                    {{/r3}}
                    {{#damage3}}
                        <div class='split-container across'>
                            <div class='highlighted split r1name'>
                                {{#damage3type}}
                                    {{damage3type}}
                                {{/damage3type}}
                                {{^damage3type}}
                                    <span data-i18n='damage'>DAMAGE</span>
                                {{/damage3type}}
                            </div>
                            <div class='highlighted split roll'>
                                {{damage3}}
                                {{#rollWasCrit() r3}}
                                    {{#crit3damage}}
                                        +{{crit3damage}}
                                    {{/crit3damage}}
                                    {{#crit3effect}}
                                        <br>+{{crit3effect}}
                                    {{/crit3effect}}
                                {{/rollWasCrit() r3}}
                            </div>
                        </div>
                    {{/damage3}}{{/rollGreater() fullattack 2}}{{#rollGreater() fullattack 3}}
                    <span class='across attack-label' data-i18n='4th-attack'>4th ATTACK</span>
                    {{#r4}}
                        <div class='split-container across'>
                            <div class='highlighted split r1name'>
                                {{#r4name}}
                                    {{r4name}}
                                {{/r4name}}
                                {{^r4name}}
                                    <span data-i18n='attack'>ATTACK</span>
                                {{/r4name}}
                            </div>
                            <div class='highlighted split roll'>
                                {{r4}}
                            </div>
                        </div>
                    {{/r4}}
                    {{#damage4}}
                        <div class='split-container across'>
                            <div class='highlighted split r1name'>
                                {{#damage4type}}
                                    {{damage4type}}
                                {{/damage4type}}
                                {{^damage4type}}
                                    <span data-i18n='damage'>DAMAGE</span>
                                {{/damage4type}}
                            </div>
                            <div class='highlighted split roll'>
                                {{damage4}}
                                {{#rollWasCrit() r4}}
                                    {{#crit4damage}}
                                        +{{crit4damage}}
                                    {{/crit4damage}}
                                    {{#crit4effect}}
                                        <br>+{{crit4effect}}
                                    {{/crit4effect}}
                                {{/rollWasCrit() r4}}
                            </div>
                        </div>
                    {{/damage4}}{{/rollGreater() fullattack 3}}{{#rollGreater() fullattack 4}}
                    <span class='across attack-label' data-i18n='5th-attack'>5th ATTACK</span>
                    {{#r5}}
                        <div class='split-container across'>
                            <div class='highlighted split r1name'>
                                {{#r5name}}
                                    {{r5name}}
                                {{/r5name}}
                                {{^r5name}}
                                    <span data-i18n='attack'>ATTACK</span>
                                {{/r5name}}
                            </div>
                            <div class='highlighted split roll'>
                                {{r5}}
                            </div>
                        </div>
                    {{/r5}}
                    {{#damage5}}
                        <div class='split-container across'>
                            <div class='highlighted split r1name'>
                                {{#damage5type}}
                                    {{damage5type}}
                                {{/damage5type}}
                                {{^damage5type}}
                                    <span data-i18n='damage'>DAMAGE</span>
                                {{/damage5type}}
                            </div>
                            <div class='highlighted split roll'>
                                {{damage5}}
                                {{#rollWasCrit() r5}}
                                    {{#crit5damage}}
                                        +{{crit5damage}}
                                    {{/crit5damage}}
                                    {{#crit5effect}}
                                        <br>+{{crit5effect}}
                                    {{/crit5effect}}
                                {{/rollWasCrit() r5}}
                            </div>
                        </div>
                    {{/damage5}}{{/rollGreater() fullattack 4}}{{#targets}}
                    <div class='split-container across'>
                        <div class='highlighted split r1name'>
                            <span data-i18n='targets'>TARGETS</span>
                        </div>
                        <div class='highlighted split roll'>
                            {{targets}}
                        </div>
                    </div>
                {{/targets}}{{#range}}
                    <div class='split-container across'>
                        <div class='highlighted split r1name'>
                            <span data-i18n='range'>RANGE</span>
                        </div>
                        <div class='highlighted split roll'>
                            {{range}}
                        </div>
                    </div>
                {{/range}}{{#curr_ammo}}
                    <div class='split-container across'>
                        <div class='highlighted split r1name'>
                            {{^ammo_type}}
                                <span data-i18n='ammo'>AMMO</span>
                            {{/ammo_type}}
                            {{#ammo_type}}
                                {{ammo_type}}
                            {{/ammo_type}}
                        </div>
                        <div class='highlighted split roll'>
                            {{curr_ammo}}
                        </div>
                    </div>
                {{/curr_ammo}}{{#notes}}
                    <div class='highlighted across notes-row'>
                        <span class='notes' data-i18n='notes:'>NOTES:</span>{{notes}}
                    </div>
                {{/notes}}{{#buttons0}}
                    <div class='highlighted across notes-row'>
                        <span>{{buttons0}}</span>
                    </div>
                {{/buttons0}}{{#buttons1}}
                    <div class='highlighted across notes-row'>
                        <span>{{buttons1}}</span>
                    </div>
                {{/buttons1}}{{#buttons2}}
                    <div class='highlighted across notes-row'>
                        <span>{{buttons2}}</span>
                    </div>
                {{/buttons2}}{{#buttons3}}
                    <div class='highlighted across notes-row'>
                        <span>{{buttons3}}</span>
                    </div>
                {{/buttons3}}{{#buttons4}}
                    <div class='highlighted across notes-row'>
                        <span>{{buttons4}}</span>
                    </div>
                {{/buttons4}}{{#buttons5}}
                    <div class='highlighted across notes-row'>
                        <span>{{buttons5}}</span>
                    </div>
                {{/buttons5}}{{#buttons6}}
                    <div class='highlighted across notes-row'>
                        <span>{{buttons6}}</span>
                    </div>
                {{/buttons6}}{{#buttons7}}
                    <div class='highlighted across notes-row'>
                        <span>{{buttons7}}</span>
                    </div>
                {{/buttons7}}{{#buttons8}}
                    <div class='highlighted across notes-row'>
                        <span>{{buttons8}}</span>
                    </div>
                {{/buttons8}}{{#buttons9}}
                    <div class='highlighted across notes-row'>
                        <span>{{buttons9}}</span>
                    </div>
                {{/buttons9}}</div>
        </div>
        {{#rightbanner}}
            <div class='side-banner right'>
                <div>
                    <span>{{rightbanner}}</span>
                </div>
            </div>
        {{/rightbanner}}
        {{#name}}
            <div class='generic-footer'>
                <div>
                    {{#characterid}}
                        {{#name}}
                            [{{name}}](https://journal.roll20.net/character/{{characterid}})
                        {{/name}}
                    {{/characterid}}
                    {{^characterid}}
                        {{name}}
                    {{/characterid}}
                </div>
            </div>
        {{/name}}
    </rolltemplate>
    <!--Ship roll templates
    &{template:sf_ship} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=@{name}}} {{leftbanner=@{arc}}} {{r1=[[1d20+@{base_attack_bonus}[BAB]+@{ability}[ABILITY]@{misc}@{bonus}]]}} 
    {{damage1=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{range=@{range} ^{hexes}}} {{class=^{@{class}}}} {{type=^{@{type}}}} {{curr_ammo=@{ammo}}} {{ammo_type=@{ammo_type}}} {{rightbanner=@{special}}} {{notes=@{description}}} @{attacher}
    -->
    <rolltemplate class="sheet-rolltemplate-sf_ship">
        {{#title}}
            <div class='generic-header'>
                <div>
                    {{title}}
                </div>
            </div>
        {{/title}}
        {{#leftbanner}}
            <div class='side-banner left'>
                <div>
                    {{leftbanner}}
                </div>
            </div>
        {{/leftbanner}}
        <div class='generic-body'>
            <div class='content-container'>{{#rcrit}}
                    <div class='highlighted across ship-crit'>
                        <div>{{rcrit}}
                            <span data-i18n="{{#rollLess() rcrit 11}}life-support{{/rollLess() rcrit 11}}{{#rollGreater() rcrit 10}}{{#rollLess() rcrit 31}}sensors{{/rollLess() rcrit 31}}{{/rollGreater() rcrit 10}}{{#rollGreater() rcrit 30}}{{#rollLess() rcrit 61}}weapons{{/rollLess() rcrit 61}}{{/rollGreater() rcrit 30}}{{#rollGreater() rcrit 60}}{{#rollLess() rcrit 81}}engines{{/rollLess() rcrit 81}}{{/rollGreater() rcrit 60}}{{#rollGreater() rcrit 80}}power-core{{/rollGreater() rcrit 80}}"></span>
                        </div>
                        {{#rollGreater() rcrit 30}}{{#rollLess() rcrit 61}}
                            <div>
                                {{rcrit2}}
                                <span data-i18n="{{#rollTotal() rcrit2 1}}forward-arc{{/rollTotal() rcrit2 1}}{{#rollTotal() rcrit2 2}}starboard-arc{{/rollTotal() rcrit2 2}}{{#rollTotal() rcrit2 3}}aft-arc{{/rollTotal() rcrit2 3}}{{#rollTotal() rcrit2 4}}port-arc{{/rollTotal() rcrit2 4}}"></span>
                            </div>
                        {{/rollLess() rcrit 61}}{{/rollGreater() rcrit 30}}
                    </div>
                {{/rcrit}}{{#r1}}
                    <div class='split-container across'>
                        <div class='highlighted split r1name'>
                            {{#r1name}}
                                {{r1name}}
                            {{/r1name}}
                            {{^r1name}}
                                <span data-i18n='attack'>ATTACK</span>
                            {{/r1name}}
                        </div>
                        <div class='highlighted split roll'>
                            {{r1}}
                        </div>
                    </div>
                {{/r1}}{{#damage1}}
                    <div class='split-container across'>
                        <div class='highlighted split r1name'>
                            {{#damage1type}}
                                {{damage1type}}
                            {{/damage1type}}
                            {{^damage1type}}
                                <span data-i18n='damage'>DAMAGE</span>
                            {{/damage1type}}
                        </div>
                        <div class='highlighted split roll'>
                            {{damage1}}
                        </div>
                    </div>
                {{/damage1}}{{#range}}
                    <div class='split-container across'>
                        <div class='highlighted split r1name'>
                            <span data-i18n='range'>RANGE</span>
                        </div>
                        <div class='highlighted split roll'>
                            {{range}}
                        </div>
                    </div>
                {{/range}}{{#class}}
                    <div class='split-container across'>
                        <div class='highlighted split r1name'>
                            <span data-i18n='class'>CLASS</span>
                        </div>
                        <div class='highlighted split roll'>
                            {{class}}
                        </div>
                    </div>
                {{/class}}{{#type}}
                    <div class='split-container across'>
                        <div class='highlighted split r1name'>
                            <span data-i18n='type'>TYPE</span>
                        </div>
                        <div class='highlighted split roll'>
                            {{type}}
                        </div>
                    </div>
                {{/type}}{{#curr_ammo}}
                    <div class='split-container across'>
                        <div class='highlighted split r1name'>
                            {{^ammo_type}}
                                <span data-i18n='ammo'>AMMO</span>
                            {{/ammo_type}}
                            {{#ammo_type}}
                                {{ammo_type}}
                            {{/ammo_type}}
                        </div>
                        <div class='highlighted split roll'>
                            {{curr_ammo}}
                        </div>
                    </div>
                {{/curr_ammo}}{{#notes}}
                    <div class='highlighted across notes-row'>
                        <span class='notes' data-i18n='notes:'>NOTES:</span>{{notes}}
                    </div>
                {{/notes}}{{#buttons0}}
                    <div class='highlighted across notes-row'>
                        <span>{{buttons0}}</span>
                    </div>
                {{/buttons0}}{{#buttons1}}
                    <div class='highlighted across notes-row'>
                        <span>{{buttons1}}</span>
                    </div>
                {{/buttons1}}{{#buttons2}}
                    <div class='highlighted across notes-row'>
                        <span>{{buttons2}}</span>
                    </div>
                {{/buttons2}}{{#buttons3}}
                    <div class='highlighted across notes-row'>
                        <span>{{buttons3}}</span>
                    </div>
                {{/buttons3}}{{#buttons4}}
                    <div class='highlighted across notes-row'>
                        <span>{{buttons4}}</span>
                    </div>
                {{/buttons4}}{{#buttons5}}
                    <div class='highlighted across notes-row'>
                        <span>{{buttons5}}</span>
                    </div>
                {{/buttons5}}{{#buttons6}}
                    <div class='highlighted across notes-row'>
                        <span>{{buttons6}}</span>
                    </div>
                {{/buttons6}}{{#buttons7}}
                    <div class='highlighted across notes-row'>
                        <span>{{buttons7}}</span>
                    </div>
                {{/buttons7}}{{#buttons8}}
                    <div class='highlighted across notes-row'>
                        <span>{{buttons8}}</span>
                    </div>
                {{/buttons8}}{{#buttons9}}
                    <div class='highlighted across notes-row'>
                        <span>{{buttons9}}</span>
                    </div>
                {{/buttons9}}</div>
        </div>
        {{#rightbanner}}
            <div class='side-banner right'>
                <div>
                    <span>{{rightbanner}}</span>
                </div>
            </div>
        {{/rightbanner}}
        {{#name}}
            <div class='generic-footer'>
                <div>
                    {{#characterid}}
                        {{#name}}
                            [{{name}}](https://journal.roll20.net/character/{{characterid}})
                        {{/name}}
                    {{/characterid}}
                    {{^characterid}}
                        {{name}}
                    {{/characterid}}
                </div>
            </div>
        {{/name}}
    </rolltemplate>
    <!-- Spell Roll Templates -->
    <!-- @{whisper_state}&{template:sf_spell} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=@{name}}} {{leftbanner=^{level} [[@{level}d1}} {{activation}} {{duration=}} {{targets=}} {{range=}} {{saveflag=[[1d@{save_checkbox}]]}} {{savedc=@{dc}}} 
    {{savetype=@{save_type}}} {{effect=@{effect}}} {{saveeffect=@{save_effect}}} {{attackflag=[[1d@{attack_checkbox}]]}} 
    {{r1=[[1d20+@{base_attack_bonus}[BAB]+@{ability}[ABILITY]@{misc}@{bonus}]]}} {{damageflag=[[1d@{damage_checkbox}]]}} {{damagetype=@{type}}} 
    {{damage1=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} 
    {{crit1damage=[[@{damage_dice}+@{damage_ability}[ABILITY]@{damage_misc}]]}} {{crit1effect=@{crit_effect}}} 
    {{notes=@{description}}} -->
    <rolltemplate class="sheet-rolltemplate-sf_spell">
        {{#title}}
            <div class='generic-header'>
                <div>
                    {{title}}
                </div>
            </div>
        {{/title}}
        {{#leftbanner}}
            <div class='side-banner left'>
                <div>
                    {{leftbanner}}
                </div>
            </div>
        {{/leftbanner}}
        <div class='generic-body'>
            <div class='content-container'>{{#activation}}
                <div class='split-container across'>
                    <div class='highlighted split r1name'>
                        <span data-i18n='activation'>ACTIVATION</span>
                    </div>
                    <div class='highlighted split roll'>
                        {{activation}}
                    </div>
                </div>
            {{/activation}}{{#duration}}
                <div class='split-container across'>
                    <div class='highlighted split r1name'>
                        <span data-i18n='duration'>DURATION</span>
                    </div>
                    <div class='highlighted split roll'>
                        {{duration}}
                    </div>
                </div>
            {{/duration}}{{#targets}}
                <div class='split-container across'>
                    <div class='highlighted split r1name'>
                        <span data-i18n='targets'>TARGETS</span>
                    </div>
                    <div class='highlighted split roll'>
                        {{targets}}
                    </div>
                </div>
            {{/targets}}{{#range}}
                <div class='split-container across'>
                    <div class='highlighted split r1name'>
                        <span data-i18n='range'>RANGE</span>
                    </div>
                    <div class='highlighted split roll'>
                        {{range}}
                    </div>
                </div>
            {{/range}}{{#rollGreater() saveflag 0}}
                <div class='highlighted across notes-row'>
                    <span class='notes' data-i18n='full-effect:'>FULL EFFECT:</span> <span>{{effect}}</span>
                </div>
                <div class='split-container across'>
                    <div class='highlighted split r1name'>
                        <span class='savetype'>{{savetype}} </span><span data-i18n='_save'> SAVE</span>
                    </div>
                    <div class='highlighted split roll'>
                        <span data-i18n='dc'>DC</span> <span>{{savedc}}</span>
                    </div>
                </div>
                <div class='highlighted across notes-row'>
                    <span class='notes' data-i18n='save-effect:'>SAVE EFFECT:</span> <span>{{saveeffect}}</span>
                </div>
            {{/rollGreater() saveflag 0}}{{#srflag}}
                <div class='split-container across'>
                    <div class='highlighted split r1name'>
                        <span data-i18n='spell-penetration'>Spell Penetration</span>
                    </div>
                    <div class='highlighted split roll'>
                        {{srroll}}
                    </div>
                </div>
            {{/srflag}}{{#rollGreater() attackflag 0}}
                {{#r1}}
                    <span class='across' data-i18n='1st-attack'>1st ATTACK</span>
                    <div class='split-container across'>
                        <div class='highlighted split r1name'>
                            {{#r1name}}
                                {{r1name}}
                            {{/r1name}}
                            {{^r1name}}
                                <span data-i18n='attack'>ATTACK</span>
                            {{/r1name}}
                        </div>
                        <div class='highlighted split roll'>
                            {{r1}}
                        </div>
                    </div>
                {{/r1}}
            {{/rollGreater() attackflag 0}}{{#rollGreater() damageflag 0}}
                {{#^rollGreater() attackflag 0}}
                    <span class='across attack-label' data-i18n='1st-attack'>1st ATTACK</span>
                {{/^rollGreater() attackflag 0}}
                {{#damage1}}
                    <div class='split-container across'>
                        <div class='highlighted split r1name'>
                            {{#damage1type}}
                                {{damage1type}}
                            {{/damage1type}}
                            {{^damage1type}}
                                <span data-i18n='damage'>DAMAGE</span>
                            {{/damage1type}}
                        </div>
                        <div class='highlighted split roll'>
                            {{damage1}}
                        </div>
                    </div>
                    {{#rollWasCrit() r1}}
                        {{#rollGreater() attackflag 0}}
                            {{#crit1effect}}
                                <div class='split-container across'>
                                    <div class='highlighted split r1name'>
                                        <span data-i18n='crit-effect'>CRIT EFFECT</span>
                                    </div>
                                    <div class='highlighted split roll'>
                                        {{crit1effect}}
                                    </div>
                                </div>
                            {{/crit1effect}}
                            {{#crit1damage}}
                                <div class='split-container across'>
                                    <div class='highlighted split r1name'>
                                        <span data-i18n='crit-damage'>CRIT DAMAGE</span>
                                    </div>
                                    <div class='highlighted split roll'>
                                        {{crit1damage}}
                                    </div>
                                </div>
                            {{/crit1damage}}
                        {{/rollGreater() attackflag 0}}
                    {{/rollWasCrit() r1}}
                {{/damage1}}
            {{/rollGreater() damageflag 0}}{{#rollGreater() fullattack 1}}
                {{#rollGreater() attackflag 0}}
                    {{#r2}}
                        <span class='across attack-label' data-i18n='2nd-attack'>2nd ATTACK</span>
                        <div class='split-container across'>
                            <div class='highlighted split r1name'>
                                {{#r2name}}
                                    {{r2name}}
                                {{/r2name}}
                                {{^r2name}}
                                    <span data-i18n='attack'>ATTACK</span>
                                {{/r2name}}
                            </div>
                            <div class='highlighted split roll'>
                                {{r2}}
                            </div>
                        </div>
                    {{/r2}}
                {{/rollGreater() attackflag 0}}
                {{#rollGreater() damageflag 0}}
                    {{#damage2}}
                    <div class='split-container across'>
                        <div class='highlighted split r1name'>
                            {{#damage2type}}
                                {{damage2type}}
                            {{/damage2type}}
                            {{^damage2type}}
                                <span data-i18n='damage'>DAMAGE</span>
                            {{/damage2type}}
                        </div>
                        <div class='highlighted split roll'>
                            {{damage2}}
                        </div>
                    </div>
                        {{#rollWasCrit() r2}}
                            {{#rollGreater() attackflag 0}}
                                {{#crit2effect}}
                                <div class='split-container across'>
                                    <div class='highlighted split r1name'>
                                        <span data-i18n='crit-effect'>CRIT EFFECT</span>
                                    </div>
                                    <div class='highlighted split roll'>
                                        {{crit2effect}}
                                    </div>
                                </div>
                                {{/crit2effect}}
                                {{#crit2damage}}
                                <div class='split-container across'>
                                    <div class='highlighted split r1name'>
                                        <span data-i18n='crit-damage'>CRIT DAMAGE</span>
                                    </div>
                                    <div class='highlighted split roll'>
                                        {{crit2damage}}
                                    </div>
                                </div>
                                {{/crit2damage}}
                            {{/rollGreater() attackflag 0}}
                        {{/rollWasCrit() r2}}
                    {{/damage2}}
                {{/rollGreater() damageflag 0}}
            {{/rollGreater() fullattack 1}}{{#rollGreater() fullattack 2}}
                {{#rollGreater() attackflag 0}}
                    {{#r3}}
                    <span class='across attack-label' data-i18n='3rd-attack'>3rd ATTACK</span>
                    <div class='split-container across'>
                        <div class='highlighted split r1name'>
                            {{#r3name}}
                                {{r3name}}
                            {{/r3name}}
                            {{^r3name}}
                                <span data-i18n='attack'>ATTACK</span>
                            {{/r3name}}
                        </div>
                        <div class='highlighted split roll'>
                            {{r3}}
                        </div>
                    </div>
                    {{/r3}}
                {{/rollGreater() attackflag 0}}
                {{#rollGreater() damageflag 0}}
                    {{#damage3}}
                    <div class='split-container across'>
                        <div class='highlighted split r1name'>
                            {{#damage3type}}
                                {{damage3type}}
                            {{/damage3type}}
                            {{^damage3type}}
                                <span data-i18n='damage'>DAMAGE</span>
                            {{/damage3type}}
                        </div>
                        <div class='highlighted split roll'>
                            {{damage3}}
                        </div>
                    </div>
                        {{#rollWasCrit() r3}}
                            {{#rollGreater() attackflag 0}}
                                {{#crit3effect}}
                                <div class='split-container across'>
                                    <div class='highlighted split r1name'>
                                        <span data-i18n='crit-effect'>CRIT EFFECT</span>
                                    </div>
                                    <div class='highlighted split roll'>
                                        {{crit3effect}}
                                    </div>
                                </div>
                                {{/crit3effect}}
                                {{#crit3damage}}
                                <div class='split-container across'>
                                    <div class='highlighted split r1name'>
                                        <span data-i18n='crit-damage'>CRIT DAMAGE</span>
                                    </div>
                                    <div class='highlighted split roll'>
                                        {{crit3damage}}
                                    </div>
                                </div>
                                {{/crit3damage}}
                            {{/rollGreater() attackflag 0}}
                        {{/rollWasCrit() r3}}
                    {{/damage3}}
                {{/rollGreater() damageflag 0}}
            {{/rollGreater() fullattack 2}}{{#rollGreater() fullattack 3}}
                {{#rollGreater() attackflag 0}}
                    {{#r4}}
                    <span class='across attack-label' data-i18n='4th-attack'>4th ATTACK</span>
                    <div class='split-container across'>
                        <div class='highlighted split r1name'>
                            {{#r4name}}
                                {{r4name}}
                            {{/r4name}}
                            {{^r4name}}
                                <span data-i18n='attack'>ATTACK</span>
                            {{/r4name}}
                        </div>
                        <div class='highlighted split roll'>
                            {{r4}}
                        </div>
                    </div>
                    {{/r4}}
                {{/rollGreater() attackflag 0}}
                {{#rollGreater() damageflag 0}}
                    {{#damage4}}
                    <div class='split-container across'>
                        <div class='highlighted split r1name'>
                            {{#damage4type}}
                                {{damage4type}}
                            {{/damage4type}}
                            {{^damage4type}}
                                <span data-i18n='damage'>DAMAGE</span>
                            {{/damage4type}}
                        </div>
                        <div class='highlighted split roll'>
                            {{damage4}}
                        </div>
                    </div>
                        {{#rollWasCrit() r4}}
                            {{#rollGreater() attackflag 0}}
                                {{#crit4effect}}
                                <div class='split-container across'>
                                    <div class='highlighted split r1name'>
                                        <span data-i18n='crit-effect'>CRIT EFFECT</span>
                                    </div>
                                    <div class='highlighted split roll'>
                                        {{crit4effect}}
                                    </div>
                                </div>
                                {{/crit4effect}}
                                {{#crit4damage}}
                                <div class='split-container across'>
                                    <div class='highlighted split r1name'>
                                        <span data-i18n='crit-damage'>CRIT DAMAGE</span>
                                    </div>
                                    <div class='highlighted split roll'>
                                        {{crit4damage}}
                                    </div>
                                </div>
                                {{/crit4damage}}
                            {{/rollGreater() attackflag 0}}
                        {{/rollWasCrit() r4}}
                    {{/damage4}}
                {{/rollGreater() damageflag 0}}
            {{/rollGreater() fullattack 3}}{{#rollGreater() fullattack 4}}
                {{#rollGreater() attackflag 0}}
                    {{#r5}}
                    <span class='across attack-label' data-i18n='5th-attack'>5th ATTACK</span>
                    <div class='split-container across'>
                        <div class='highlighted split r1name'>
                            {{#r5name}}
                                {{r5name}}
                            {{/r5name}}
                            {{^r5name}}
                                <span data-i18n='attack'>ATTACK</span>
                            {{/r5name}}
                        </div>
                        <div class='highlighted split roll'>
                            {{r5}}
                        </div>
                    </div>
                    {{/r5}}
                {{/rollGreater() attackflag 0}}
                {{#rollGreater() damageflag 0}}
                    {{#damage5}}
                    <div class='split-container across'>
                        <div class='highlighted split r1name'>
                            {{#damage5type}}
                                {{damage5type}}
                            {{/damage5type}}
                            {{^damage5type}}
                                <span data-i18n='damage'>DAMAGE</span>
                            {{/damage5type}}
                        </div>
                        <div class='highlighted split roll'>
                            {{damage5}}
                        </div>
                    </div>
                        {{#rollWasCrit() r5}}
                            {{#rollGreater() attackflag 0}}
                                {{#crit5effect}}
                                <div class='split-container across'>
                                    <div class='highlighted split r1name'>
                                        <span data-i18n='crit-effect'>CRIT EFFECT</span>
                                    </div>
                                    <div class='highlighted split roll'>
                                        {{crit5effect}}
                                    </div>
                                </div>
                                {{/crit5effect}}
                                {{#crit5damage}}
                                <div class='split-container across'>
                                    <div class='highlighted split r1name'>
                                        <span data-i18n='crit-damage'>CRIT DAMAGE</span>
                                    </div>
                                    <div class='highlighted split roll'>
                                        {{crit5damage}}
                                    </div>
                                </div>
                                {{/crit5damage}}
                            {{/rollGreater() attackflag 0}}
                        {{/rollWasCrit() r5}}
                    {{/damage5}}
                {{/rollGreater() damageflag 0}}
            {{/rollGreater() fullattack 4}}{{#notes}}
                <div class='highlighted across notes-row'>
                    <span class='notes' data-i18n='notes:'>NOTES:</span> {{notes}}
                </div>
            {{/notes}}{{#buttons0}}
                <div class='highlighted across notes-row'>
                    <span>{{buttons0}}</span>
                </div>
            {{/buttons0}}{{#buttons1}}
                <div class='highlighted across notes-row'>
                    <span>{{buttons1}}</span>
                </div>
            {{/buttons1}}{{#buttons2}}
                <div class='highlighted across notes-row'>
                    <span>{{buttons2}}</span>
                </div>
            {{/buttons2}}{{#buttons3}}
                <div class='highlighted across notes-row'>
                    <span>{{buttons3}}</span>
                </div>
            {{/buttons3}}{{#buttons4}}
                <div class='highlighted across notes-row'>
                    <span>{{buttons4}}</span>
                </div>
            {{/buttons4}}{{#buttons5}}
                <div class='highlighted across notes-row'>
                    <span>{{buttons5}}</span>
                </div>
            {{/buttons5}}{{#buttons6}}
                <div class='highlighted across notes-row'>
                    <span>{{buttons6}}</span>
                </div>
            {{/buttons6}}{{#buttons7}}
                <div class='highlighted across notes-row'>
                    <span>{{buttons7}}</span>
                </div>
            {{/buttons7}}{{#buttons8}}
                <div class='highlighted across notes-row'>
                    <span>{{buttons8}}</span>
                </div>
            {{/buttons8}}{{#buttons9}}
                <div class='highlighted across notes-row'>
                    <span>{{buttons9}}</span>
                </div>
            {{/buttons9}}</div>
        </div>
        {{#rightbanner}}
            <div class='side-banner right'>
                <div>
                    <span>{{rightbanner}}</span>
                </div>
            </div>
        {{/rightbanner}}
        {{#name}}
            <div class='generic-footer'>
                <div>
                    {{#characterid}}
                        {{#name}}
                            [{{name}}](https://journal.roll20.net/character/{{characterid}})
                        {{/name}}
                    {{/characterid}}
                    {{^characterid}}
                        {{name}}
                    {{/characterid}}
                </div>
                
                
                
                
                
            </div>
        {{/name}}
    </rolltemplate>
</div>
<script type='text/worker'>
    /* ---- BEGIN: TheAaronSheet.js ---- */
    /* Github:   https://github.com/shdwjk/TheAaronSheet/blob/master/TheAaronSheet.js
     By:       The Aaron, Arcane Scriptomancer
     Contact:  https://app.roll20.net/users/104025/the-aaron*/
    
    //This is a stripped down block of TAS that only has the logging functions. I only have it in because it makes logs easier to spot in the console
    var TAS = TAS || (function(){
       'use strict';
    
        var loggingSettings = {
                debug: {
                    key:    'debug',
                    title:  'Starfinder-DEBUG',
                    color: {
                        bgLabel:'#7732A2',
                        label:  '#F2EF40',
                        bgText: '#FFFEB7',
                        text:   '#7732A2'
                    }
                },
                error: {
                    key:    'error',
                    title:  'Starfinder-Error',
                    color: {
                        bgLabel:'#C11713',
                        label:  'white',
                        bgText: '#C11713',
                        text:   'white'
                    }
                },
                warn: {
                    key:    'warn',
                    title:  'Starfinder-Warning',
                    color: {
                        bgLabel:'#F29140',
                        label:  'white',
                        bgText: '#FFD8B7',
                        text:   'black'
                    }
                },
                info: {
                    key:    'info',
                    title:  'Starfinder-Info',
                    color: {
                        bgLabel:'#413FA9',
                        label:  'white',
                        bgText: '#B3B2EB',
                        text:   'black'
                    }
                },
                notice: {
                    key:    'notice',
                    title:  'Starfinder-Notice',
                    color: {
                        bgLabel:'#33C133',
                        label:  'white',
                        bgText: '#ADF1AD',
                        text:   'black'
                    }
                },
                log: {
                    key:    'log',
                    title:  'Starfinder-Log',
                    color: {
                        bgLabel:'#f2f240',
                        label:  'black',
                        bgText: '#ffff90',
                        text:   'black'
                    }
                },
                callstack: {
                    key:    'TAS',
                    title:  'Starfinder-function',
                    color: {
                        bgLabel:'#413FA9',
                        label:  'white',
                        bgText: '#B3B2EB',
                        text:   'black'
                    }
                },
                callstack_async: {
                    key:    'TAS',
                    title:  'Starfinder-ASYNC CALL',
                    color: {
                        bgLabel:'#413FA9',
                        label:  'white',
                        bgText: '#413FA9',
                        text:   'white'
                    }
                },
                TAS: {
                    key:    'TAS',
                    title:  'Starfinder-TAS',
                    color: {
                        bgLabel:'grey',
                        label:  'black;background:linear-gradient(#304352,#d7d2cc,#d7d2cc,#d7d2cc,#304352)',
                        bgText: 'grey',
                        text:   'black;background:linear-gradient(#304352,#d7d2cc,#d7d2cc,#d7d2cc,#304352)'
                    }
                }
            },
    
    
            config = {
                debugMode: false,
                logging: {
                    log: true,
                    notice: true,
                    info: true,
                    warn: true,
                    error: true,
                    debug: false
                }
            },
    
        dataLogger = function(primaryLogger,secondaryLogger,data){
            _.each(data,function(m){
                var type = complexType(m);
                switch(type){
                    case'string':
                        primaryLogger(m);
                        break;
                    case'undefined':
                    case'null':
                    case'NaN':
                        primaryLogger('['+type+']');
                        break;
                    case'number':
                    case'not a number':
                    case'integer':
                    case'decimal':
                    case'boolean':
                        primaryLogger('['+type+']:'+m);
                        break;
                    default:
                        primaryLogger('['+type+']:=========================================');
                        secondaryLogger(m);
                        primaryLogger('=========================================================');
                        break;
                }
            });
    },
    complexType = function(o){
            switch(typeof o){
                case'string':
                    return'string';
                case'boolean':
                    return'boolean';
                case'number':
                    return (_.isNaN(o) ?'NaN' : (o.toString().match(/\./) ?'decimal' :'integer'));
                case'function':
                    return'function:'+(o.name ? o.name+'()' :'(anonymous)');
                case'object':
                    return (_.isArray(o) ?'array' : (_.isArguments(o) ?'arguments' : ( _.isNull(o) ?'null' :'object')));
                default:
                    return typeof o;
            }
        },
    
        colorLog = function(options){
            var coloredLoggerFunction,
                key = options.key,
                label = options.title ||'TAS',
                lBGColor = (options.color && options.color.bgLabel) ||'blue',
                lTxtColor = (options.color && options.color.label) ||'white',
                mBGColor = (options.color && options.color.bgText) ||'blue',
                mTxtColor = (options.color && options.color.text) ||'white';
    
            coloredLoggerFunction = function(message){
                console.log(
                   '%c'+label+': %c'+message +'',
                   'background-color:'+lBGColor+';color:'+lTxtColor+'; font-weight:bold;',
                   'background-color:'+mBGColor+';color:'+mTxtColor+';'
                ); 
            };
            return function(){
                if('TAS'===key || config.logging[key]){
                   dataLogger(coloredLoggerFunction,function(m){console.log(m);},_.toArray(arguments)); 
                }
            };
        },
    
        logDebug  = colorLog(loggingSettings.debug),
        logError  = colorLog(loggingSettings.error),
        logWarn   = colorLog(loggingSettings.warn),
        logInfo   = colorLog(loggingSettings.info),
        logNotice = colorLog(loggingSettings.notice),
        logLog    = colorLog(loggingSettings.log),
        log       = colorLog(loggingSettings.TAS),
        logCS     = colorLog(loggingSettings.callstack),
        logCSA    = colorLog(loggingSettings.callstack_async);
    
        return {
            /* Logging */
            debug: logDebug,
            error: logError,
            warn: logWarn,
            info: logInfo,
            notice: logNotice,
            log: logLog
        };
    }());
    
    /* ---- END: TheAaronSheet.js ---- */
    /*start starfinder.js*/
    var starfinder = starfinder || (function(){
       'use strict';
        const version = '1.001535461200',//The sheet's current version. This is put into the character_sheet attribute when a sheet is opened. I've been doing version numbering as 0.0Xyyyyyyyyyy where X represents the state of the sheet (currently in stage 4, or open beta) and y is the UNIX epoch timestamp for when I finished that build
            pilotingRanks={},
            sheetAttributes = [/*An array of all the non-repeating sheet attributes that could potentially be used in the calculations performed by the script
                                This array is used in the getAttrs call in accessStarfinder()*/
                /*Class & Character attributes*/
               'character_name','character_id','bab','character_level','race','caster_level',
               'class_1_name','class_2_name','class_3_name','class_4_name','class_5_name',
               'class_1_max_spell','class_2_max_spell','class_3_max_spell','class_4_max_spell','class_5_max_spell',
               'class_1_level','class_2_level','class_3_level','class_4_level','class_5_level','class_1_sp','class_2_sp',
               'class_3_sp','class_4_sp','class_5_sp','class_1_hp','class_2_hp','class_3_hp','class_4_hp','class_5_hp',
               'class_1_bab','class_2_bab','class_3_bab','class_4_bab','class_5_bab',
               'class_1_fort','class_2_fort','class_3_fort','class_4_fort','class_5_fort',
               'class_1_ref','class_2_ref','class_3_ref','class_4_ref','class_5_ref',
               'class_1_will','class_2_will','class_3_will','class_4_will','class_5_will',
               'class_1_ability','class_2_ability','class_3_ability','class_4_ability','class_5_ability',
               'class_1_skills','class_2_skills','class_3_skills','class_4_skills','class_5_skills',
               'class_1_casting_ability','class_2_casting_ability','class_3_casting_ability','class_4_casting_ability','class_5_casting_ability',
               'class_1_spells','class_2_spells','class_3_spells','class_4_spells','class_5_spells','is_caster',
               'class_1_spell_progression','class_2_spell_progression','class_3_spell_progression','class_4_spell_progression','class_5_spell_progression',
               'char_max_spell','race_hp','cr',
                /*ability score attributes*/
               'strength','dexterity','constitution','intelligence','wisdom','charisma','strength_penalty','dexterity_penalty','constitution_penalty',
               'strength_base','dexterity_base','constitution_base','intelligence_base','wisdom_base','charisma_base',
               'intelligence_penalty','wisdom_penalty','charisma_penalty','strength_drain','dexterity_drain','constitution_drain','intelligence_drain',
               'wisdom_drain','charisma_drain','strength_mod','dexterity_mod','constitution_mod','intelligence_mod','wisdom_mod','charisma_mod',
                /*Initiative attributes*/
               'initiative_ability','initiative',
                /*AC attributes*/
               'eac','kac','cmd','eac_armor','kac_armor','eac_ability','kac_ability','eac_base','kac_base','cmd_base',
                /*Save attributess*/
               'fort','ref','will','fort_base','ref_base','will_base','fort_ability','ref_ability','will_ability',
                /*Skill attributes*/
               'skill_points_max',
               'acrobatics','athletics','bluff','computers','culture','diplomacy','disguise','engineering','intimidate','life_science','medicine','mysticism',
               'perception','physical_science','piloting','sense_motive','sleight_of_hand','stealth','survival','acrobatics_ability','athletics_ability',
               'bluff_ability','computers_ability','culture_ability','diplomacy_ability','disguise_ability','engineering_ability','intimidate_ability',
               'life_science_ability','medicine_ability','mysticism_ability','perception_ability','physical_science_ability','piloting_ability',
               'sense_motive_ability','sleight_of_hand_ability','stealth_ability','survival_ability','acrobatics_ranks','athletics_ranks','bluff_ranks',
               'computers_ranks','culture_ranks','diplomacy_ranks','disguise_ranks','engineering_ranks','intimidate_ranks','life_science_ranks',
               'medicine_ranks','mysticism_ranks','perception_ranks','physical_science_ranks','piloting_ranks','sense_motive_ranks','sleight_of_hand_ranks',
               'stealth_ranks','survival_ranks','acrobatics_class_skill','athletics_class_skill','bluff_class_skill','computers_class_skill',
               'culture_class_skill','diplomacy_class_skill','disguise_class_skill','engineering_class_skill','intimidate_class_skill',
               'life_science_class_skill','medicine_class_skill','mysticism_class_skill','perception_class_skill','physical_science_class_skill',
               'piloting_class_skill','sense_motive_class_skill','sleight_of_hand_class_skill','stealth_class_skill','survival_class_skill',
               'acrobatics_acp','athletics_acp','bluff_acp','computers_acp','culture_acp','diplomacy_acp','disguise_acp','engineering_acp','intimidate_acp','life_science_acp','medicine_acp','mysticism_acp',
               'perception_acp','physical_science_acp','piloting_acp','sense_motive_acp','sleight_of_hand_acp','stealth_acp','survival_acp',
               'acrobatics_base','athletics_base','bluff_base','computers_base','culture_base','diplomacy_base','disguise_base','engineering_base','intimidate_base','life_science_base','medicine_base','mysticism_base',
               'perception_base','physical_science_base','piloting_base','sense_motive_base','sleight_of_hand_base','stealth_base','survival_base',
                /*Health attributes*/
               'sp','hp','rp','temp_hp','sp_max','hp_max','rp_max','temp_hp_max',
                /*Item attributes*/
               'wealth','carried_bulk','encumber_bulk','overburden_bulk',
                /*sheet setting attributes*/
               'resolve_source','stackable_buffs','sheet_type','half_specializations','drone',
               //proficiency attributes
               'light_armor_proficiency','heavy_armor_proficiency','power_armor_proficiency','basic_melee_proficiency','advanced_melee_proficiency',
               'small_arm_proficiency','longarm_proficiency','heavy_weapon_proficiency','grenade_proficiency','sniper_proficiency',
               //conditions
               'asleep','blinded','cowering','dazzled','deafened','encumbered','entangled','exhausted','fascinated','fatigued','flat_footed',
               'frightened','grappled','helpless','negative_levels','off_kilter','off_target','overburdened','panicked','paralyzed','pinned','prone',
               'shaken','sickened','stunned','unconscious'
            ],
            repeatingAttributes = [/*Array of objects with the attributes in each repeating section that need to be gotten with getAttrs,
                                    used in getID()
                Entity format:
                {
                    section:'Name of the section',
                    fields:['name_of_the_attribute']
                }
                */
                {
                    section:'item',
                    fields:['name','bulk','cost','quantity','mods','equipped','purpose','type','proficiency','level','uses_max','uses_max_base','uses']
                },
                {
                    section:'attack',
                    fields:['ability','bonus','damage_dice','damage_ability','damage_bonus','level','bonus',
                           'type','total','damage_total','proficiency','category','range','name','engagement_range','base_attack_bonus','base_attack_bonus_base','special']
                },
                {
                    section:'profession',
                    fields:['ranks','class_skill','ability','acp','name','base']
                },
                {
                    section:'buff',
                    fields:['mods','toggle','range','name']
                },
                {
                    section:'ability',
                    fields:['level','mods','toggle','frequency','source','uses_max_base','base_attack_bonus_base','base_attack_bonus','attack_bonus','range','name','attack_ability','damage_ability','attack_type','save_ability','dc_base','type','spell_resistance','spell_penetration_misc']
                },
                {
                    section:'spell',
                    fields:['source','attack_bonus','attack_ability','damage_ability','base_attack_bonus_base','base_attack_bonus','range','name','attack_type','save_ability','level','dc_base','spell_resistance','spell_penetration_misc']
                },
                {
                    section:'condition',
                    fields:['track','track_status','name']
                }
            ],
            repeatingShipAttributes = [//as repeatingAttributes, but for when the sheet is set to be a ship
                {
                    section:'attack',
                    fields:['pcu','bp','powered']
                },
                {
                    section:'system',
                    fields:['pcu','bp','powered','comp_bonus','purpose','shields','armor','countermeasure','sensor_bonus']
                },
            ],
            skillList=[//Array of all the skills, used to iterate through them.
               'acrobatics',
               'athletics',
               'bluff',
               'computers',
               'culture',
               'diplomacy',
               'disguise',
               'engineering',
               'intimidate',
               'life_science',
               'medicine',
               'mysticism',
               'profession',
               'perception',
               'physical_science',
               'piloting',
               'sense_motive',
               'sleight_of_hand',
               'stealth',
               'survival'
            ],
            conditionList = ['asleep','blinded','confused','cowering','dazed','dazzled','dead','deafened','dying','entangled','exhausted','fascinated','fatigued','flat_footed','frightened','grappled','helpless','nauseated','negative_levels','off_kilter','off_target','panicked','paralyzed','pinned','prone','shaken','sickened','stable','staggered','stunned','unconscious'],
            attributeObjs={
                'ability|spell_resistance':{
                    repeating:'ability',attr:'spell_resistance',affects:[],attrAdds:[],moddable:false,rollTime:'spell_penetration_misc'
                },
                'ability|source':{
                    repeating:'ability',attr:'source',affects:[],attrAdds:[],moddable:false,rollTime:false
                },
                'ability|name':{
                    repeating:'ability',attr:'name',affects:[],attrAdds:[],moddable:false,rollTime:false
                },
                'spell|spell_resistance':{
                    repeating:'spell',attr:'spell_resistance',affects:[],attrAdds:[],moddable:false,rollTime:'spell_penetration_misc'
                },
                'spell|source':{
                    repeating:'spell',attr:'source',affects:[],attrAdds:[],moddable:false,rollTime:false
                },
                'spell|name':{
                    repeating:'spell',attr:'name',affects:[],attrAdds:[],moddable:false,rollTime:false
                },
                light_armor_proficiency:{
                    attr:'light_armor_proficiency',affects:['item|proficiency']
                },
                heavy_armor_proficiency:{
                    attr:'heavy_armor_proficiency',affects:['item|proficiency']
                },
                power_armor_proficiency:{
                    attr:'power_armor_proficiency',affects:['item|proficiency']
                },
                basic_melee_proficiency:{
                    attr:'basic_melee_proficiency',affects:['attack|proficiency']
                },
                advanced_melee_proficiency:{
                    attr:'advanced_melee_proficiency',affects:['attack|proficiency']
                },
                small_arm_proficiency:{
                    attr:'small_arm_proficiency',affects:['attack|proficiency']
                },
                longarm_proficiency:{
                    attr:'longarm_proficiency',affects:['attack|proficiency']
                },
                heavy_weapon_proficiency:{
                    attr:'heavy_weapon_proficiency',affects:['attack|proficiency']
                },
                grenade_proficiency:{
                    attr:'grenade_proficiency',affects:['attack|proficiency']
                },
                sniper_proficiency:{
                    attr:'sniper_proficiency',affects:['attack|proficiency']
                },
                'asleep':{
                    attr:'asleep',affects:['perception','helpless']
                },
                'blinded':{
                    attr:'blinded',affects:['perception','flat_footed']
                },
                'confused':{
                    attr:'confused',affects:[]
                },
                'cowering':{
                    attr:'cowering',affects:['flat_footed']
                },
                'dazzled':{
                    attr:'dazzled',affects:['perception','attack|total','spell|attack_total','ability|attack_total']
                },
                'deafened':{
                    attr:'deafened',affects:['initiative','perception']
                },
                'encumbered':{
                    attr:'encumbered',affects:['eac','kac']
                },
                'entangled':{
                    attr:'entangled',affects:['eac','kac','attack|total','spell|attack_total','ability|attack_total','ref','initiative']
                },
                'exhausted':{
                    attr:'exhausted',affects:['eac','kac','attack|total','attack|damage_total','spell|attack_total','ability|attack_total','ref','initiative','encumber_bulk']
                },
                'fascinated':{
                    attr:'fascinated',affects:[]//think about handling for this
                },
                'fatigued':{
                    attr:'fatigued',affects:['eac','kac','attack|total','attack|damage_total','spell|attack_total','ability|attack_total','ref','initiative','encumber_bulk']
                },
                'flat_footed':{
                    attr:'flat_footed',affects:['eac','kac']
                },
                'frightened':{
                    attr:'frightened',affects:['attack|total','spell|attack_total','ability|attack_total','ref','fort','will','acrobatics','athletics','bluff','computers','culture','diplomacy','disguise','engineering','intimidate','life_science','medicine','mysticism','perception','physical_science','piloting','profession|profession','sense_motive','sleight_of_hand','stealth','survival']
                },
                'grappled':{
                    attr:'grappled',affects:['eac','kac','initiative','ref','attack|total','spell|attack_total','ability|attack_total']
                },
                'helpless':{
                    attr:'helpless',affects:['dexterity_mod']
                },
                'negative_levels':{
                    attr:'negative_levels',affects:['ref','fort','will','acrobatics','athletics','bluff','computers','culture','diplomacy','disguise','engineering','intimidate','life_science','medicine','mysticism','perception','physical_science','piloting','profession|profession','sense_motive','sleight_of_hand','stealth','survival','eac','kac','sp_max','hp_max','attack|total','spell|attack_total','ability|attack_total']
                },
                'off_kilter':{
                    attr:'off_kilter',affects:['attack|total','spell|attack_total','ability|attack_total','flat_footed']
                },
                'off_target':{
                    attr:'off_target',affects:['attack|total','spell|attack_total','ability|attack_total']
                },
                'overburdened':{
                    attr:'overburdened',affects:[]
                },
                'panicked':{
                    attr:'panicked',affects:['ref','fort','will','acrobatics','athletics','bluff','computers','culture','diplomacy','disguise','engineering','intimidate','life_science','medicine','mysticism','perception','physical_science','piloting','profession|profession','sense_motive','sleight_of_hand','stealth','survival']
                },
                'paralyzed':{
                    attr:'paralyzed',affects:['dexterity_mod']
                },
                'pinned':{
                    attr:'pinned',affects:['eac','kac','initiative','ref','attack|total','spell|attack_total','ability|attack_total']
                },
                'prone':{
                    attr:'prone',affects:['attack|total']
                },
                'shaken':{
                    attr:'shaken',affects:['attack|total','spell|attack_total','ability|attack_total','ref','fort','will','acrobatics','athletics','bluff','computers','culture','diplomacy','disguise','engineering','intimidate','life_science','medicine','mysticism','perception','physical_science','piloting','profession|profession','sense_motive','sleight_of_hand','stealth','survival']
                },
                'sickened':{
                    attr:'sickened',affects:['attack|total','attack|damage_total','spell|attack_total','ability|attack_total','ref','fort','will','acrobatics','athletics','bluff','computers','culture','diplomacy','disguise','engineering','intimidate','life_science','medicine','mysticism','perception','physical_science','piloting','profession|profession','sense_motive','sleight_of_hand','stealth','survival']
                },
                'stunned':{
                    attr:'stunned',affects:['flat_footed']
                },
                'unconscious':{
                    attr:'unconscious',affects:['helpless']
                },
                'condition|track':{
                    repeating:'condition',attr:'track',affects:['sickened','fatigued','exhausted','unconscious','dead','shaken','spell|dc','ability|dc','flat_footed','encumber_level','overburden_bulk','encumber_bulk','staggered','helpless','ref','eac','kac','fort','intelligence','will','confused']
                },
                'condition|track_status':{
                    repeating:'condition',attr:'track_status',affects:['sickened','fatigued','exhausted','unconscious','dead','shaken','spell|dc','ability|dc','flat_footed','encumber_level','overburden_bulk','encumber_bulk','staggered','helpless','ref','eac','kac','fort','intelligence','will','confused']
                },
                'temp_hp_buff':{
                    attr:'temp_hp_buff',affects:['temp_hp_max']
                },
                'sp_buff':{
                    attr:'sp_buff',affects:['sp_max']
                },
                'hp_buff':{
                    attr:'hp_buff',affects:['hp_max']
                },
                'rp_buff':{
                    attr:'rp_buff',affects:['rp_max']
                },
                'sp_max_buff':{
                attr:'sp_max_buff',affects:['sp_max']
                },
                'hp_max_buff':{
                attr:'hp_max_buff',affects:['hp_max']
                },
                'rp_max_buff':{
                attr:'rp_max_buff',affects:['rp_max']
                },
                'temp_hp_max_buff':{
                attr:'temp_hp_max_buff',affects:['temp_hp_max']
                },
                'light_armor_proficiency':{
                    attr:'light_armor_proficiency',affects:['eac','kac']
                },
                'heavy_armor_proficiency':{
                    attr:'heavy_armor_proficiency',affects:['eac','kac']
                },
                'power_armor_proficiency':{
                    attr:'power_armor_proficiency',affects:['eac','kac']
                },
                'strength_buff':{
                attr:'strength_buff',affects:['strength']
                },
                'dexterity_buff':{
                attr:'dexterity_buff',affects:['dexterity']
                },
                'constitution_buff':{
                attr:'constitution_buff',affects:['constitution']
                },
                'intelligence_buff':{
                attr:'intelligence_buff',affects:['intelligence']
                },
                'wisdom_buff':{
                attr:'wisdom_buff',affects:['wisdom']
                },
                'charisma_buff':{
                attr:'charisma_buff',affects:['charisma']
                },
                'eac_buff':{
                attr:'eac_buff',affects:['eac']
                },
                'eac_armor_buff':{
                attr:'eac_armor_buff',affects:['eac_armor']
                },
                'kac_buff':{
                attr:'kac_buff',affects:['kac']
                },
                'kac_armor_buff':{
                attr:'kac_armor_buff',affects:['kac_armor']
                },
                armor_buff:{attr:'armor_buff',affects:['eac','eac_armor','kac','kac_armor']},
                'cmd_buff':{
                attr:'cmd_buff',affects:['cmd']
                },
                'fort_buff':{
                attr:'fort_buff',affects:['fort']
                },
                'ref_buff':{
                attr:'ref_buff',affects:['ref']
                },
                'will_buff':{
                attr:'will_buff',affects:['will']
                },
                'skill_points_buff':{
                attr:'skill_points_buff',affects:['skill_points_max']
                },
                'acrobatics_buff':{
                attr:'acrobatics_buff',affects:['acrobatics']
                },
                'athletics_buff':{
                attr:'athletics_buff',affects:['athletics']
                },
                'bluff_buff':{
                attr:'bluff_buff',affects:['bluff']
                },
                'computers_buff':{
                attr:'computers_buff',affects:['computers']
                },
                'culture_buff':{
                attr:'culture_buff',affects:['culture']
                },
                'diplomacy_buff':{
                attr:'diplomacy_buff',affects:['diplomacy']
                },
                'disguise_buff':{
                attr:'disguise_buff',affects:['disguise']
                },
                'engineering_buff':{
                attr:'engineering_buff',affects:['engineering']
                },
                'intimidate_buff':{
                attr:'intimidate_buff',affects:['intimidate']
                },
                'life_science_buff':{
                attr:'life_science_buff',affects:['life_science']
                },
                'medicine_buff':{
                attr:'medicine_buff',affects:['medicine']
                },
                'mysticism_buff':{
                attr:'mysticism_buff',affects:['mysticism']
                },
                'perception_buff':{
                attr:'perception_buff',affects:['perception']
                },
                'physical_science_buff':{
                attr:'physical_science_buff',affects:['physical_science']
                },
                'piloting_buff':{
                attr:'piloting_buff',affects:['piloting']
                },
                'sense_motive_buff':{
                attr:'sense_motive_buff',affects:['sense_motive']
                },
                'sleight_of_hand_buff':{
                attr:'sleight_of_hand_buff',affects:['sleight_of_hand']
                },
                'stealth_buff':{
                attr:'stealth_buff',affects:['stealth']
                },
                'survival_buff':{
                attr:'survival_buff',affects:['survival']
                },
                'encumber_bulk_buff':{
                attr:'encumber_bulk_buff',affects:['encumber_bulk']
                },
                'overburden_bulk_buff':{
                attr:'overburden_bulk_buff',affects:['overburden_bulk']
                },
                'caster_level_buff':{
                attr:'caster_level_buff',affects:['caster_level']
                },
                'initiative_buff':{
                attr:'initiative_buff',affects:['initiative']
                },
                'skills_buff':{
                attr:'skills_buff',affects:['acrobatics','athletics','bluff','computers','culture','diplomacy','disguise','engineering','intimidate','life_science','medicine','mysticism','profession|profession','perception','physical_science','piloting','sense_motive','sleight_of_hand','stealth','survival']
                },
                "race_hp":{
                "repeating":false,"attr":"race_hp","affects":["hp_max"]
                },
                "class_1_level":{
                "repeating":false,"attr":"class_1_level","affects":["sp_max","hp_max","rp_max","fort_base","ref_base","will_base","bab","skill_points_max","spell|dc","ability|dc","caster_level","character_level"]
                },
                "class_1_sp":{
                "repeating":false,"attr":"class_1_sp","affects":["sp_max"]
                },
                "class_1_hp":{
                "repeating":false,"attr":"class_1_hp","affects":["hp_max"]
                },
                "class_1_bab":{
                "repeating":false,"attr":"class_1_bab","affects":["bab"]
                },
                "class_1_fort":{
                "repeating":false,"attr":"class_1_fort","affects":["fort_base"]
                },
                "class_1_ref":{
                "repeating":false,"attr":"class_1_ref","affects":["ref_base"]
                },
                "class_1_will":{
                "repeating":false,"attr":"class_1_will","affects":["will_base"]
                },
                "class_1_skills":{
                "repeating":false,"attr":"class_1_skills","affects":["skill_points_max"]
                },
                "class_1_spells":{
                repeating:false,attr:"class_1_spells",affects:['caster_level']
                },
                "class_1_ability":{
                "repeating":false,"attr":"class_1_ability","affects":["rp_max","spell|dc","ability|dc"]
                },
                "class_2_level":{
                "repeating":false,"attr":"class_2_level","affects":["character_level","sp_max","hp_max","ability|dc","caster_level","rp_max","fort_base","ref_base","will_base","bab","skill_points_max","spell|dc","ability|dc"]
                },
                "class_2_sp":{
                "repeating":false,"attr":"class_2_sp","affects":["sp_max"]
                },
                "class_2_hp":{
                "repeating":false,"attr":"class_2_hp","affects":["hp_max"]
                },
                "class_2_bab":{
                "repeating":false,"attr":"class_2_bab","affects":["bab"]
                },
                "class_2_fort":{
                "repeating":false,"attr":"class_2_fort","affects":["fort_base"]
                },
                "class_2_ref":{
                "repeating":false,"attr":"class_2_ref","affects":["ref_base"]
                },
                "class_2_will":{
                "repeating":false,"attr":"class_2_will","affects":["will_base"]
                },
                "class_2_skills":{
                "repeating":false,"attr":"class_2_skills","affects":["skill_points_max"]
                },
                "class_2_spells":{
                repeating:false,attr:"class_2_spells",affects:['caster_level']
                },
                "class_2_ability":{
                "repeating":false,"attr":"class_2_ability","affects":["rp_max","spell|dc","ability|dc"]
                },
                "class_3_level":{
                "repeating":false,"attr":"class_3_level","affects":["character_level","sp_max","hp_max","ability|dc","caster_level","rp_max","fort_base","ref_base","will_base","bab","skill_points_max","spell|dc","ability|dc"]
                },
                "class_3_sp":{
                "repeating":false,"attr":"class_3_sp","affects":["sp_max"]
                },
                "class_3_hp":{
                "repeating":false,"attr":"class_3_hp","affects":["hp_max"]
                },
                "class_3_bab":{
                "repeating":false,"attr":"class_3_bab","affects":["bab"]
                },
                "class_3_fort":{
                "repeating":false,"attr":"class_3_fort","affects":["fort_base"]
                },
                "class_3_ref":{
                "repeating":false,"attr":"class_3_ref","affects":["ref_base"]
                },
                "class_3_will":{
                "repeating":false,"attr":"class_3_will","affects":["will_base"]
                },
                "class_3_skills":{
                "repeating":false,"attr":"class_3_skills","affects":["skill_points_max"]
                },
                "class_3_spells":{
                repeating:false,attr:"class_3_spells",affects:['caster_level']
                },
                "class_3_ability":{
                "repeating":false,"attr":"class_3_ability","affects":["rp_max","spell|dc","ability|dc"]
                },
                "class_4_level":{
                "repeating":false,"attr":"class_4_level","affects":["character_level","sp_max","hp_max","ability|dc","caster_level","rp_max","fort_base","ref_base","will_base","bab","skill_points_max","spell|dc","ability|dc"]
                },
                "class_4_sp":{
                "repeating":false,"attr":"class_4_sp","affects":["sp_max"]
                },
                "class_4_hp":{
                "repeating":false,"attr":"class_4_hp","affects":["hp_max"]
                },
                "class_4_bab":{
                "repeating":false,"attr":"class_4_bab","affects":["bab"]
                },
                "class_4_fort":{
                "repeating":false,"attr":"class_4_fort","affects":["fort_base"]
                },
                "class_4_ref":{
                "repeating":false,"attr":"class_4_ref","affects":["ref_base"]
                },
                "class_4_will":{
                "repeating":false,"attr":"class_4_will","affects":["will_base"]
                },
                "class_4_skills":{
                "repeating":false,"attr":"class_4_skills","affects":["skill_points_max"]
                },
                "class_4_spells":{
                repeating:false,attr:"class_4_spells",affects:['caster_level']
                },
                "class_4_ability":{
                "repeating":false,"attr":"class_4_ability","affects":["rp_max","spell|dc","ability|dc"]
                },
                "class_5_level":{
                "repeating":false,"attr":"class_5_level","affects":["character_level","sp_max","hp_max","ability|dc","caster_level","rp_max","fort_base","ref_base","will_base","bab","skill_points_max","spell|dc","ability|dc"]
                },
                "class_5_sp":{
                "repeating":false,"attr":"class_5_sp","affects":["sp_max"]
                },
                "class_5_hp":{
                "repeating":false,"attr":"class_5_hp","affects":["hp_max"]
                },
                "class_5_bab":{
                "repeating":false,"attr":"class_5_bab","affects":["bab"]
                },
                "class_5_fort":{
                "repeating":false,"attr":"class_5_fort","affects":["fort_base"]
                },
                "class_5_ref":{
                "repeating":false,"attr":"class_5_ref","affects":["ref_base"]
                },
                "class_5_will":{
                "repeating":false,"attr":"class_5_will","affects":["will_base"]
                },
                "class_5_skills":{
                "repeating":false,"attr":"class_5_skills","affects":["skill_points_max"]
                },
                "class_5_spells":{
                repeating:false,attr:"class_5_spells",affects:['caster_level']
                },
                "class_5_ability":{
                "repeating":false,"attr":"class_5_ability","affects":["rp_max","spell|dc","ability|dc"]
                },
                caster_level:{
                    repeating:false,attr:'caster_level',affects:[]
                },
                character_level:{
                    repeating:false,attr:'character_level',affects:[]
                },
                "bab":{
                "repeating":false,"attr":"bab","affects":["attack|base_attack_bonus","spell|base_attack_bonus","ability|base_attack_bonus","spell|attack_total","ability|attack_total","attack|total"]
                },
                "strength":{
                "repeating":false,"attr":"strength","affects":["strength_mod","encumber_bulk","overburden_bulk"],"numAdds":0,"attrAdds":["strength_base","strength_drain"],"multAdds":[1,-1],"addlBonus":[],"ability":'',"repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "encumber_bulk":{
                "repeating":false,"attr":"encumber_bulk","numAdds":1,"attrAdds":["strength"],"multAdds":[0.5],"affects":['encumber_level'],rollTime:'_misc',moddable:'_change'
                },
                "overburden_bulk":{
                "repeating":false,"attr":"overburden_bulk","numAdds":0,"attrAdds":["strength"],"multAdds":[1],"affects":['encumber_level'],rollTime:'_misc',moddable:'_change'
                },
                "strength_penalty":{
                "repeating":false,"attr":"strength_penalty","affects":["strength_mod"]
                },
                "strength_drain":{
                "repeating":false,"attr":"strength_drain","affects":["strength"]
                },
                "strength_base":{
                "repeating":false,"attr":"strength_base","affects":["strength"]
                },
                "dexterity":{
                "repeating":false,"attr":"dexterity","affects":["dexterity_mod"],"numAdds":0,"attrAdds":["dexterity_base","dexterity_drain"],"multAdds":[1,-1],"addlBonus":[],"ability":'',"repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "dexterity_penalty":{
                "repeating":false,"attr":"dexterity_penalty","affects":["dexterity_mod"]
                },
                "dexterity_drain":{
                "repeating":false,"attr":"dexterity_drain","affects":["dexterity"]
                },
                "dexterity_base":{
                "repeating":false,"attr":"dexterity_base","affects":["dexterity"]
                },
                "constitution":{
                "repeating":false,"attr":"constitution","affects":["constitution_mod"],"numAdds":0,"attrAdds":["constitution_base","constitution_drain"],"multAdds":[1,-1],"addlBonus":[],"ability":'',"repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "constitution_penalty":{
                "repeating":false,"attr":"constitution_penalty","affects":["constitution_mod"]
                },
                "constitution_drain":{
                "repeating":false,"attr":"constitution_drain","affects":["constitution"]
                },
                "constitution_base":{
                "repeating":false,"attr":"constitution_base","affects":["constitution"]
                },
                "intelligence":{
                "repeating":false,"attr":"intelligence","affects":["intelligence_mod"],"numAdds":0,"attrAdds":["intelligence_base","intelligence_drain"],"multAdds":[1,-1],"addlBonus":[],"ability":'',"repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                skill_points_max:{
                    "repeating":false,"attr":"skill_points_max","affects":[],"numAdds":0,"attrAdds":["intelligence_mod",'class_1_skills','class_2_skills','class_3_skills','class_4_skills','class_5_skills'],"multAdds":['character_level','class_1_level','class_2_level','class_3_level','class_4_level','class_5_level'],"addlBonus":[],"ability":'',"repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "intelligence_penalty":{
                "repeating":false,"attr":"intelligence_penalty","affects":["intelligence_mod"]
                },
                "intelligence_drain":{
                "repeating":false,"attr":"intelligence_drain","affects":["intelligence"]
                },
                "intelligence_base":{
                "repeating":false,"attr":"intelligence_base","affects":["intelligence"]
                },
                "wisdom":{
                "repeating":false,"attr":"wisdom","affects":["wisdom_mod"],"numAdds":0,"attrAdds":["wisdom_base","wisdom_drain"],"multAdds":[1,-1],"addlBonus":[],"ability":'',"repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "wisdom_penalty":{
                "repeating":false,"attr":"wisdom_penalty","affects":["wisdom_mod"]
                },
                "wisdom_drain":{
                "repeating":false,"attr":"wisdom_drain","affects":["wisdom"]
                },
                "wisdom_base":{
                "repeating":false,"attr":"wisdom_base","affects":["wisdom"]
                },
                "charisma":{
                "repeating":false,"attr":"charisma","affects":["charisma_mod"],"numAdds":0,"attrAdds":["charisma_base","charisma_drain"],"multAdds":[1,-1],"addlBonus":[],"ability":'',"repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "charisma_penalty":{
                "repeating":false,"attr":"charisma_penalty","affects":["charisma_mod"]
                },
                "charisma_drain":{
                "repeating":false,"attr":"charisma_drain","affects":["charisma"]
                },
                "charisma_base":{
                "repeating":false,"attr":"charisma_base","affects":["charisma"]
                },
                "strength_mod":{
                "repeating":false,"attr":"strength_mod","affects":[],"numAdds":-5,"attrAdds":["strength","strength_penalty"],"multAdds":[0.5,0.5],"addlBonus":[],"ability":'',"repeatTextAdds":[],"repeatAdds":[],"textAdds":[]
                },
                "dexterity_mod":{
                "repeating":false,"attr":"dexterity_mod","affects":[],"numAdds":-5,"attrAdds":["dexterity","dexterity_penalty"],"multAdds":[0.5,0.5],"addlBonus":[],"ability":'',"repeatTextAdds":[],"repeatAdds":[],"textAdds":[]
                },
                "constitution_mod":{
                "repeating":false,"attr":"constitution_mod","affects":["sp_max"],"numAdds":-5,"attrAdds":["constitution","constitution_penalty"],"multAdds":[0.5,0.5],"addlBonus":[],"ability":'',"repeatTextAdds":[],"repeatAdds":[],"textAdds":[]
                },
                "intelligence_mod":{
                "repeating":false,"attr":"intelligence_mod","affects":["skill_points_max"],"numAdds":-5,"attrAdds":["intelligence","intelligence_penalty"],"multAdds":[0.5,0.5],"addlBonus":[],"ability":'',"repeatTextAdds":[],"repeatAdds":[],"textAdds":[]
                },
                "wisdom_mod":{
                "repeating":false,"attr":"wisdom_mod","affects":[],"numAdds":-5,"attrAdds":["wisdom","wisdom_penalty"],"multAdds":[0.5,0.5],"addlBonus":[],"ability":'',"repeatTextAdds":[],"repeatAdds":[],"textAdds":[]
                },
                "charisma_mod":{
                "repeating":false,"attr":"charisma_mod","affects":[],"numAdds":-5,"attrAdds":["charisma","charisma_penalty"],"multAdds":[0.5,0.5],"addlBonus":[],"ability":'',"repeatTextAdds":[],"repeatAdds":[],"textAdds":[]
                },
                "sp_max":{
                "repeating":false,"attr":"sp_max",rollTime:'_misc',"affects":[],"numAdds":0,"attrAdds":["constitution_mod","class_1_sp","class_2_sp","class_3_sp","class_4_sp","class_5_sp"],"multAdds":["character_level","class_1_level","class_2_level","class_3_level","class_4_level","class_5_level"],"addlBonus":[],"ability":'',"repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change"
                },
                "hp_max":{
                "repeating":false,"attr":"hp_max",rollTime:'_misc',"affects":[],"numAdds":0,"attrAdds":["class_1_hp","class_2_hp","class_3_hp","class_4_hp","class_5_hp","race_hp"],"multAdds":["class_1_level","class_2_level","class_3_level","class_4_level","class_5_level",1],"addlBonus":[],"ability":'',"repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change"
                },
                "rp_max":{
                "repeating":false,"attr":"rp_max",rollTime:'_misc',"affects":[],"numAdds":0,"attrAdds":[],"ability":"abi","moddable":"_change"
                },
                "temp_hp_max":{
                "repeating":false,"attr":"temp_hp_max",rollTime:'_misc',"affects":[],"numAdds":0,"attrAdds":[],"multAdds":[],"addlBonus":[],"ability":'',"repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change"
                },
                "eac_armor":{
                "repeating":false,"attr":"eac_armor",rollTime:'_misc',"affects":["eac"],"numAdds":0,"attrAdds":[],"addlBonus":["armor"],"repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change"
                },
                "eac_ability":{
                "repeating":false,"attr":"eac_ability","affects":["eac"]
                },
                "kac_armor":{
                "repeating":false,"attr":"kac_armor",rollTime:'_misc',"affects":["kac"],"numAdds":0,"attrAdds":[],"addlBonus":["armor"],"repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change"
                },
                "kac_ability":{
                "repeating":false,"attr":"kac_ability","affects":["kac"]
                },
                "eac":{
                "repeating":false,"attr":"eac",rollTime:'_misc',"affects":[],"numAdds":10,"attrAdds":["eac_armor"],"multAdds":[1],"ability":"eac_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change"
                },
                "kac":{
                "repeating":false,"attr":"kac",rollTime:'_misc',"affects":["cmd"],"numAdds":10,"attrAdds":["kac_armor"],"multAdds":[1],"ability":"kac_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change"
                },
                "cmd":{
                "repeating":false,"attr":"cmd",rollTime:'_misc',"affects":[],"numAdds":8,"attrAdds":["kac"],"multAdds":[1],"repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change"
                },
                "fort":{
                "repeating":false,"attr":"fort","affects":[],"numAdds":0,"attrAdds":["fort_base"],"multAdds":[1],"ability":"fort_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "fort_base":{
                "repeating":false,"attr":"fort_base","affects":["fort"],"numAdds":0,"attrAdds":[],"multAdds":[],"ability":"","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":false,"rollTime":false
                },
                "fort_ability":{
                "repeating":false,"attr":"fort_ability","affects":["fort"]
                },
                "ref":{
                "repeating":false,"attr":"ref","affects":[],"numAdds":0,"attrAdds":["ref_base"],"multAdds":[1],"ability":"ref_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "ref_base":{
                "repeating":false,"attr":"ref_base","affects":["ref"],"numAdds":0,"attrAdds":[],"multAdds":[],"ability":"","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":false,"rollTime":false
                },
                "ref_ability":{
                "repeating":false,"attr":"ref_ability","affects":["ref"]
                },
                "will":{
                "repeating":false,"attr":"will","affects":[],"numAdds":0,"attrAdds":["will_base"],"multAdds":[1],"ability":"will_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "will_base":{
                "repeating":false,"attr":"will_base","affects":["will"],"numAdds":0,"attrAdds":[],"multAdds":[],"ability":"","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":false,"rollTime":false
                },
                "will_ability":{
                "repeating":false,"attr":"will_ability","affects":["will"]
                },
                "initiative":{
                "repeating":false,"attr":"initiative","affects":[],"numAdds":0,"attrAdds":[],"ability":"initiative_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "initiative_ability":{
                "repeating":false,"attr":"initiative_ability","affects":["initiative"]
                },
                "acrobatics":{
                "repeating":false,"attr":"acrobatics","affects":[],"isSkill":true,"numAdds":0,"attrAdds":["acrobatics_ranks","acrobatics_class_skill"],"multAdds":[1,1],"ability":"acrobatics_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "acrobatics_ranks":{
                "repeating":false,"attr":"acrobatics_ranks","affects":["acrobatics"]
                },
                "acrobatics_class_skill":{
                "repeating":false,"attr":"acrobatics_class_skill","affects":["acrobatics"]
                },
                "acrobatics_ability":{
                "repeating":false,"attr":"acrobatics_ability","affects":["acrobatics"]
                },
                "athletics":{
                "repeating":false,"attr":"athletics","affects":[],"isSkill":true,"numAdds":0,"attrAdds":["athletics_ranks","athletics_class_skill"],"multAdds":[1,1],"ability":"athletics_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "athletics_ranks":{
                "repeating":false,"attr":"athletics_ranks","affects":["athletics"]
                },
                "athletics_class_skill":{
                "repeating":false,"attr":"athletics_class_skill","affects":["athletics"]
                },
                "athletics_ability":{
                "repeating":false,"attr":"athletics_ability","affects":["athletics"]
                },
                "bluff":{
                "repeating":false,"attr":"bluff","affects":[],"isSkill":true,"numAdds":0,"attrAdds":["bluff_ranks","bluff_class_skill"],"multAdds":[1,1],"ability":"bluff_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "bluff_ranks":{
                "repeating":false,"attr":"bluff_ranks","affects":["bluff"]
                },
                "bluff_class_skill":{
                "repeating":false,"attr":"bluff_class_skill","affects":["bluff"]
                },
                "bluff_ability":{
                "repeating":false,"attr":"bluff_ability","affects":["bluff"]
                },
                "computers":{
                "repeating":false,"attr":"computers","affects":[],"isSkill":true,"numAdds":0,"attrAdds":["computers_ranks","computers_class_skill"],"multAdds":[1,1],"ability":"computers_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "computers_ranks":{
                "repeating":false,"attr":"computers_ranks","affects":["computers"]
                },
                "computers_class_skill":{
                "repeating":false,"attr":"computers_class_skill","affects":["computers"]
                },
                "computers_ability":{
                "repeating":false,"attr":"computers_ability","affects":["computers"]
                },
                "culture":{
                "repeating":false,"attr":"culture","affects":[],"isSkill":true,"numAdds":0,"attrAdds":["culture_ranks","culture_class_skill"],"multAdds":[1,1],"ability":"culture_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "culture_ranks":{
                "repeating":false,"attr":"culture_ranks","affects":["culture"]
                },
                "culture_class_skill":{
                "repeating":false,"attr":"culture_class_skill","affects":["culture"]
                },
                "culture_ability":{
                "repeating":false,"attr":"culture_ability","affects":["culture"]
                },
                "diplomacy":{
                "repeating":false,"attr":"diplomacy","affects":[],"isSkill":true,"numAdds":0,"attrAdds":["diplomacy_ranks","diplomacy_class_skill"],"multAdds":[1,1],"ability":"diplomacy_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "diplomacy_ranks":{
                "repeating":false,"attr":"diplomacy_ranks","affects":["diplomacy"]
                },
                "diplomacy_class_skill":{
                "repeating":false,"attr":"diplomacy_class_skill","affects":["diplomacy"]
                },
                "diplomacy_ability":{
                "repeating":false,"attr":"diplomacy_ability","affects":["diplomacy"]
                },
                "disguise":{
                "repeating":false,"attr":"disguise","affects":[],"isSkill":true,"numAdds":0,"attrAdds":["disguise_ranks","disguise_class_skill"],"multAdds":[1,1],"ability":"disguise_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "disguise_ranks":{
                "repeating":false,"attr":"disguise_ranks","affects":["disguise"]
                },
                "disguise_class_skill":{
                "repeating":false,"attr":"disguise_class_skill","affects":["disguise"]
                },
                "disguise_ability":{
                "repeating":false,"attr":"disguise_ability","affects":["disguise"]
                },
                "engineering":{
                "repeating":false,"attr":"engineering","affects":[],"isSkill":true,"numAdds":0,"attrAdds":["engineering_ranks","engineering_class_skill"],"multAdds":[1,1],"ability":"engineering_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "engineering_ranks":{
                "repeating":false,"attr":"engineering_ranks","affects":["engineering"]
                },
                "engineering_class_skill":{
                "repeating":false,"attr":"engineering_class_skill","affects":["engineering"]
                },
                "engineering_ability":{
                "repeating":false,"attr":"engineering_ability","affects":["engineering"]
                },
                "intimidate":{
                "repeating":false,"attr":"intimidate","affects":[],"isSkill":true,"numAdds":0,"attrAdds":["intimidate_ranks","intimidate_class_skill"],"multAdds":[1,1],"ability":"intimidate_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "intimidate_ranks":{
                "repeating":false,"attr":"intimidate_ranks","affects":["intimidate"]
                },
                "intimidate_class_skill":{
                "repeating":false,"attr":"intimidate_class_skill","affects":["intimidate"]
                },
                "intimidate_ability":{
                "repeating":false,"attr":"intimidate_ability","affects":["intimidate"]
                },
                "life_science":{
                "repeating":false,"attr":"life_science","affects":[],"isSkill":true,"numAdds":0,"attrAdds":["life_science_ranks","life_science_class_skill"],"multAdds":[1,1],"ability":"life_science_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "life_science_ranks":{
                "repeating":false,"attr":"life_science_ranks","affects":["life_science"]
                },
                "life_science_class_skill":{
                "repeating":false,"attr":"life_science_class_skill","affects":["life_science"]
                },
                "life_science_ability":{
                "repeating":false,"attr":"life_science_ability","affects":["life_science"]
                },
                "medicine":{
                "repeating":false,"attr":"medicine","affects":[],"isSkill":true,"numAdds":0,"attrAdds":["medicine_ranks","medicine_class_skill"],"multAdds":[1,1],"ability":"medicine_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "medicine_ranks":{
                "repeating":false,"attr":"medicine_ranks","affects":["medicine"]
                },
                "medicine_class_skill":{
                "repeating":false,"attr":"medicine_class_skill","affects":["medicine"]
                },
                "medicine_ability":{
                "repeating":false,"attr":"medicine_ability","affects":["medicine"]
                },
                "mysticism":{
                "repeating":false,"attr":"mysticism","affects":[],"isSkill":true,"numAdds":0,"attrAdds":["mysticism_ranks","mysticism_class_skill"],"multAdds":[1,1],"ability":"mysticism_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "mysticism_ranks":{
                "repeating":false,"attr":"mysticism_ranks","affects":["mysticism"]
                },
                "mysticism_class_skill":{
                "repeating":false,"attr":"mysticism_class_skill","affects":["mysticism"]
                },
                "mysticism_ability":{
                "repeating":false,"attr":"mysticism_ability","affects":["mysticism"]
                },
                "perception":{
                "repeating":false,"attr":"perception","affects":[],"isSkill":true,"numAdds":0,"attrAdds":["perception_ranks","perception_class_skill"],"multAdds":[1,1],"ability":"perception_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "perception_ranks":{
                "repeating":false,"attr":"perception_ranks","affects":["perception"]
                },
                "perception_class_skill":{
                "repeating":false,"attr":"perception_class_skill","affects":["perception"]
                },
                "perception_ability":{
                "repeating":false,"attr":"perception_ability","affects":["perception"]
                },
                "physical_science":{
                "repeating":false,"attr":"physical_science","affects":[],"isSkill":true,"numAdds":0,"attrAdds":["physical_science_ranks","physical_science_class_skill"],"multAdds":[1,1],"ability":"physical_science_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "physical_science_ranks":{
                "repeating":false,"attr":"physical_science_ranks","affects":["physical_science"]
                },
                "physical_science_class_skill":{
                "repeating":false,"attr":"physical_science_class_skill","affects":["physical_science"]
                },
                "physical_science_ability":{
                "repeating":false,"attr":"physical_science_ability","affects":["physical_science"]
                },
                "piloting":{
                "repeating":false,"attr":"piloting","affects":[],"isSkill":true,"numAdds":0,"attrAdds":["piloting_ranks","piloting_class_skill"],"multAdds":[1,1],"ability":"piloting_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "piloting_ranks":{
                "repeating":false,"attr":"piloting_ranks","affects":["piloting"]
                },
                "piloting_class_skill":{
                "repeating":false,"attr":"piloting_class_skill","affects":["piloting"]
                },
                "piloting_ability":{
                "repeating":false,"attr":"piloting_ability","affects":["piloting"]
                },
                "profession|profession":{
                "repeating":"profession","attr":"profession","affects":[],"isSkill":true,"numAdds":0,"attrAdds":[],"repeatAdds":["ranks","class_skill"],"ability":"ability","repeatTextAdds":[],"textAdds":[],"moddable":"_change","rollTime":"misc"
                },
                "profession|ranks":{
                "repeating":"profession","attr":"ranks","affects":["profession|profession"]
                },
                "profession|class_skill":{
                "repeating":"profession","attr":"class_skill","affects":["profession|profession"]
                },
                "profession|ability":{
                "repeating":'profession',"attr":"ability","affects":["profession|profession"]
                },
                "sense_motive":{
                "repeating":false,"attr":"sense_motive","affects":[],"isSkill":true,"numAdds":0,"attrAdds":["sense_motive_ranks","sense_motive_class_skill"],"multAdds":[1,1],"ability":"sense_motive_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "sense_motive_ranks":{
                "repeating":false,"attr":"sense_motive_ranks","affects":["sense_motive"]
                },
                "sense_motive_class_skill":{
                "repeating":false,"attr":"sense_motive_class_skill","affects":["sense_motive"]
                },
                "sense_motive_ability":{
                "repeating":false,"attr":"sense_motive_ability","affects":["sense_motive"]
                },
                "sleight_of_hand":{
                "repeating":false,"attr":"sleight_of_hand","affects":[],"isSkill":true,"numAdds":0,"attrAdds":["sleight_of_hand_ranks","sleight_of_hand_class_skill"],"multAdds":[1,1],"ability":"sleight_of_hand_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "sleight_of_hand_ranks":{
                "repeating":false,"attr":"sleight_of_hand_ranks","affects":["sleight_of_hand"]
                },
                "sleight_of_hand_class_skill":{
                "repeating":false,"attr":"sleight_of_hand_class_skill","affects":["sleight_of_hand"]
                },
                "sleight_of_hand_ability":{
                "repeating":false,"attr":"sleight_of_hand_ability","affects":["sleight_of_hand"]
                },
                "stealth":{
                "repeating":false,"attr":"stealth","affects":[],"isSkill":true,"numAdds":0,"attrAdds":["stealth_ranks","stealth_class_skill"],"multAdds":[1,1],"ability":"stealth_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "stealth_ranks":{
                "repeating":false,"attr":"stealth_ranks","affects":["stealth"]
                },
                "stealth_class_skill":{
                "repeating":false,"attr":"stealth_class_skill","affects":["stealth"]
                },
                "stealth_ability":{
                "repeating":false,"attr":"stealth_ability","affects":["stealth"]
                },
                "survival":{
                "repeating":false,"attr":"survival","affects":[],"isSkill":true,"numAdds":0,"attrAdds":["survival_ranks","survival_class_skill"],"multAdds":[1,1],"ability":"survival_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "survival_ranks":{
                "repeating":false,"attr":"survival_ranks","affects":["survival"]
                },
                "survival_class_skill":{
                "repeating":false,"attr":"survival_class_skill","affects":["survival"]
                },
                "survival_ability":{
                "repeating":false,"attr":"survival_ability","affects":["survival"]
                },
                'item|proficiency':{
                    repeating:'item',attr:'proficiency',affects:['eac','kac']
                },
                'item|type':{
                    repeating:'item',attr:'type',affects:['eac','kac']
                },
                'item|purpose':{
                    repeating:'item',attr:'purpose',affects:['eac','kac']
                },
                'item|equipped':{
                    repeating:'item',attr:'equipped',affects:['eac','kac','carried_bulk','wealth']
                },
                'item|bulk':{
                    repeating:'item',attr:'bulk',affects:['carried_bulk']
                },
                'item|quantity':{
                    repeating:'item',attr:'quantity',affects:['carried_bulk','wealth']
                },
                'item|cost':{
                    repeating:'item',attr:'cost',affects:['wealth']
                },
                carried_bulk:{
                    repeating:false,attr:'carried_bulk',affects:['encumber_level']
                },
                wealth:{
                    repeating:false,attr:'wealth',affects:[]
                },
                encumber_level:{
                    repeating:false,attr:'encumber_level',affects:['eac','kac','acrobatics','athletics','bluff','computers','culture','diplomacy','disguise','engineering','intimidate','life_science','medicine','mysticism','perception','physical_science','piloting','sense_motive','sleight_of_hand','stealth','survival','profession|profession']
                },
                "attack|total":{
                "repeating":"attack","attr":"total","affects":[],"numAdds":0,"attrAdds":["bab"],"multAdds":[1],"category":"category","ability":"ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"misc"
                },
                "attack|base_attack_bonus":{
                "repeating":"attack","attr":"base_attack_bonus","affects":[],"numAdds":0,"attrAdds":["bab"],"multAdds":[1],"category":"category","ability":"","repeatTextAdds":[],"repeatAdds":[],"textAdds":[]
                },
                "attack|ability":{
                "repeating":'attack',"attr":"ability","affects":["attack|total"]
                },
                'attack|engagement_range':{
                    repeating:'attack',attr:'engagement_range',affects:[]
                },
                'attack|type':{
                    repeating:'attack',attr:'type',affects:[]
                },
                'attack|crit':{
                    repeating:'attack',attr:'crit',affects:[]
                },
                'attack|damage_dice':{
                    repeating:'attack',attr:'damage_dice',affects:['attack|damage_total']
                },
                'attack|proficiency':{
                    "repeating":'attack',"attr":"proficiency","affects":["attack|total",'attack|damage_total']
                },
                'attack|category':{
                    "repeating":'attack',"attr":"category","affects":["attack|total",'attack|damage_total']
                },
                "attack|damage_total":{
                "repeating":"attack","attr":"damage_total","affects":[],"numAdds":0,"attrAdds":[],"repeatTextAdds":["damage_dice"],"category":"category","ability":"damage_ability","repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"misc"
                },
                "attack|damage_ability":{
                "repeating":'attack',"attr":"damage_ability","affects":["attack|damage_total"]
                },
                'item|uses_max_base':{
                    repeating:'item',attr:'uses_max_base',affects:['item|uses_max']
                },
                "item|uses_max":{
                "repeating":"item","attr":"uses_max","affects":[],"numAdds":0,"attrAdds":[],"multAdds":[],"repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"repeatParseField":["uses_max_base"],"moddable":"_change"
                },
                'ability|uses_max_base':{
                    repeating:'ability',attr:'uses_max_base',affects:['ability|uses_max']
                },
                "ability|uses_max":{
                "repeating":"ability","attr":"uses_max","affects":[],"numAdds":0,"attrAdds":[],"multAdds":[],"repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"repeatParseField":["uses_max_base"],"moddable":"_change"
                },
                "ability|base_attack_bonus":{
                "repeating":"ability","attr":"base_attack_bonus","affects":[],"numAdds":0,"attrAdds":["bab"],"multAdds":[1],"category":"category","ability":"","repeatTextAdds":[],"repeatAdds":[],"textAdds":[]
                },
                "ability|attack_total":{
                "repeating":"ability","attr":"attack_total","affects":[],"numAdds":0,"attrAdds":["bab"],"multAdds":[1],"ability":"ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":true,"rollTime":"misc"
                },
                "ability|attack_ability":{
                "repeating":'ability',"attr":"attack_ability","affects":["ability|attack_total"]
                },
                'ability|damage_dice':{
                    repeating:'attack',attr:'damage_dice',affects:['ability|damage_total']
                },
                "ability|damage_total":{
                "repeating":"ability","attr":"damage_total","affects":[],"numAdds":0,"attrAdds":[],"repeatTextAdds":["damage_dice"],"ability":"damage_ability","repeatAdds":[],"textAdds":[],"moddable":true,"rollTime":"misc"
                },
                "ability|damage_ability":{
                "repeating":'ability',"attr":"damage_ability","affects":["ability|damage_total"]
                },
                'ability|type':{
                    "repeating":'ability',"attr":"type","affects":["ability|dc"]
                },
                'ability|level':{
                    "repeating":'ability',"attr":"level","affects":["ability|dc"]
                },
                "ability|dc":{
                "repeating":"ability","attr":"dc","affects":[],"attrAdds":["lvl"],"multAdds":[0.5],"numAdds":10,"ability":"save_ability","moddable":"_change"
                },
                "ability|save_ability":{
                "repeating":'ability',"attr":"save_ability","affects":["ability|dc"]
                },
                "spell|level":{
                "repeating":"spell","attr":"level","affects":["spell|filter"]
                },
                "spell|base_attack_bonus":{
                "repeating":"spell","attr":"base_attack_bonus","affects":[],"numAdds":0,"attrAdds":["bab"],"multAdds":[1],"category":"category","ability":"","repeatTextAdds":[],"repeatAdds":[],"textAdds":[]
                },
                "spell|filter":{
                "repeating":"spell","attr":"filter","affects":[]
                },
                "spell|attack_total":{
                "repeating":"spell","attr":"attack_total","affects":[],"numAdds":0,"attrAdds":["bab"],"multAdds":[1],"ability":"attack_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"misc"
                },
                "spell|attack_ability":{
                "repeating":'spell',"attr":"attack_ability","affects":["spell|attack_total"]
                },
                "spell|damage_total":{
                "repeating":"spell","attr":"damage_total","affects":[],"numAdds":0,"attrAdds":[],"repeatTextAdds":["damage_dice","damage_bonus"],"category":"category","ability":"damage_ability","repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"misc"
                },
                "spell|damage_ability":{
                "repeating":'spell',"attr":"damage_ability","affects":["spell|damage_total"]
                },
                'spell|damage_dice':{
                    repeating:'spell',attr:'damage_dice',affects:['spell|damage_total']
                },
                "spell|dc":{
                "repeating":"spell","attr":"dc","affects":[],"attrAdds":[],"repeatAdds":["level"],"numAdds":10,"ability":"save_ability","moddable":"_change"
                },
                "spell|save_ability":{
                "repeating":'spell',"attr":"save_ability","affects":["spell|dc"]
                },
            },
            npcAttributeObjs={
                'ability|spell_resistance':{
                    repeating:'ability',attr:'spell_resistance',affects:[],attrAdds:[],moddable:false,rollTime:'spell_penetration_misc'
                },
                'spell|spell_resistance':{
                    repeating:'spell',attr:'spell_resistance',affects:[],attrAdds:[],moddable:false,rollTime:'spell_penetration_misc'
                },
                'strength_buff':{
                attr:'strength_buff',affects:['strength_mod']
                },
                'dexterity_buff':{
                attr:'dexterity_buff',affects:['dexterity_mod']
                },
                'constitution_buff':{
                attr:'constitution_buff',affects:['constitution_mod']
                },
                'intelligence_buff':{
                attr:'intelligence_buff',affects:['intelligence_mod']
                },
                'wisdom_buff':{
                attr:'wisdom_buff',affects:['wisdom_mod']
                },
                'charisma_buff':{
                attr:'charisma_buff',affects:['charisma_mod']
                },
                'eac_buff':{
                attr:'eac_buff',affects:['eac']
                },
                'eac_armor_buff':{
                attr:'eac_armor_buff',affects:['eac_armor']
                },
                'kac_buff':{
                attr:'kac_buff',affects:['kac']
                },
                'kac_armor_buff':{
                attr:'kac_armor_buff',affects:['kac']
                },
                'cmd_buff':{
                attr:'cmd_buff',affects:['cmd']
                },
                'fort_buff':{
                attr:'fort_buff',affects:['fort']
                },
                'ref_buff':{
                attr:'ref_buff',affects:['ref']
                },
                'will_buff':{
                attr:'will_buff',affects:['will']
                },
                'skills_buff':{
                attr:'skills_buff',affects:['acrobatics']
                },
                'acrobatics_buff':{
                attr:'acrobatics_buff',affects:['acrobatics']
                },
                'athletics_buff':{
                attr:'athletics_buff',affects:['athletics']
                },
                'bluff_buff':{
                attr:'bluff_buff',affects:['bluff']
                },
                'computers_buff':{
                attr:'computers_buff',affects:['computers']
                },
                'culture_buff':{
                attr:'culture_buff',affects:['culture']
                },
                'diplomacy_buff':{
                attr:'diplomacy_buff',affects:['diplomacy']
                },
                'disguise_buff':{
                attr:'disguise_buff',affects:['disguise']
                },
                'engineering_buff':{
                attr:'engineering_buff',affects:['engineering']
                },
                'intimidate_buff':{
                attr:'intimidate_buff',affects:['intimidate']
                },
                'life_science_buff':{
                attr:'life_science_buff',affects:['life_science']
                },
                'medicine_buff':{
                attr:'medicine_buff',affects:['medicine']
                },
                'mysticism_buff':{
                attr:'mysticism_buff',affects:['mysticism']
                },
                'perception_buff':{
                attr:'perception_buff',affects:['perception']
                },
                'physical_science_buff':{
                attr:'physical_science_buff',affects:['physical_science']
                },
                'piloting_buff':{
                attr:'piloting_buff',affects:['piloting']
                },
                'sense_motive_buff':{
                attr:'sense_motive_buff',affects:['sense_motive']
                },
                'sleight_of_hand_buff':{
                attr:'sleight_of_hand_buff',affects:['sleight_of_hand']
                },
                'stealth_buff':{
                attr:'stealth_buff',affects:['stealth']
                },
                'survival_buff':{
                attr:'survival_buff',affects:['survival']
                },
                'caster_level_buff':{
                attr:'caster_level_buff',affects:['caster_level']
                },
                'initiative_buff':{
                attr:'initiative_buff',affects:['initiative']
                },
                'asleep':{
                    attr:'asleep',affects:['perception','helpless']
                },
                'blinded':{
                    attr:'blinded',affects:['perception','flat_footed']
                },
                'confused':{
                    attr:'confused',affects:[]
                },
                'cowering':{
                    attr:'cowering',affects:['flat_footed']
                },
                'dazzled':{
                    attr:'dazzled',affects:['perception','attack|total','spell|attack_total','ability|attack_total']
                },
                'deafened':{
                    attr:'deafened',affects:['initiative','perception']
                },
                'encumbered':{
                    attr:'encumbered',affects:['eac','kac']
                },
                'entangled':{
                    attr:'entangled',affects:['eac','kac','attack|total','spell|attack_total','ability|attack_total','ref','initiative']
                },
                'exhausted':{
                    attr:'exhausted',affects:['eac','kac','attack|total','attack|damage_total','spell|attack_total','ability|attack_total','ref','initiative','encumber_bulk']
                },
                'fascinated':{
                    attr:'fascinated',affects:[]//think about handling for this
                },
                'fatigued':{
                    attr:'fatigued',affects:['eac','kac','attack|total','attack|damage_total','spell|attack_total','ability|attack_total','ref','initiative','encumber_bulk']
                },
                'flat_footed':{
                    attr:'flat_footed',affects:['eac','kac']
                },
                'frightened':{
                    attr:'frightened',affects:['attack|total','spell|attack_total','ability|attack_total','ref','fort','will','acrobatics','athletics','bluff','computers','culture','diplomacy','disguise','engineering','intimidate','life_science','medicine','mysticism','perception','physical_science','piloting','profession|profession','sense_motive','sleight_of_hand','stealth','survival']
                },
                'grappled':{
                    attr:'grappled',affects:['eac','kac','initiative','ref','attack|total','spell|attack_total','ability|attack_total']
                },
                'helpless':{
                    attr:'helpless',affects:['dexterity_mod']
                },
                'negative_levels':{
                    attr:'negative_levels',affects:['ref','fort','will','acrobatics','athletics','bluff','computers','culture','diplomacy','disguise','engineering','intimidate','life_science','medicine','mysticism','perception','physical_science','piloting','profession|profession','sense_motive','sleight_of_hand','stealth','survival','eac','kac','sp_max','hp_max','attack|total','spell|attack_total','ability|attack_total']
                },
                'off_kilter':{
                    attr:'off_kilter',affects:['attack|total','spell|attack_total','ability|attack_total','flat_footed']
                },
                'off_target':{
                    attr:'off_target',affects:['attack|total','spell|attack_total','ability|attack_total']
                },
                'overburdened':{
                    attr:'overburdened',affects:[]
                },
                'panicked':{
                    attr:'panicked',affects:['ref','fort','will','acrobatics','athletics','bluff','computers','culture','diplomacy','disguise','engineering','intimidate','life_science','medicine','mysticism','perception','physical_science','piloting','profession|profession','sense_motive','sleight_of_hand','stealth','survival']
                },
                'paralyzed':{
                    attr:'paralyzed',affects:['dexterity_mod']
                },
                'pinned':{
                    attr:'pinned',affects:['eac','kac','initiative','ref','attack|total','spell|attack_total','ability|attack_total']
                },
                'prone':{
                    attr:'prone',affects:['attack|total']
                },
                'shaken':{
                    attr:'shaken',affects:['attack|total','spell|attack_total','ability|attack_total','ref','fort','will','acrobatics','athletics','bluff','computers','culture','diplomacy','disguise','engineering','intimidate','life_science','medicine','mysticism','perception','physical_science','piloting','profession|profession','sense_motive','sleight_of_hand','stealth','survival']
                },
                'sickened':{
                    attr:'sickened',affects:['attack|total','attack|damage_total','spell|attack_total','ability|attack_total','ref','fort','will','acrobatics','athletics','bluff','computers','culture','diplomacy','disguise','engineering','intimidate','life_science','medicine','mysticism','perception','physical_science','piloting','profession|profession','sense_motive','sleight_of_hand','stealth','survival']
                },
                'stunned':{
                    attr:'stunned',affects:['flat_footed']
                },
                'unconscious':{
                    attr:'unconscious',affects:['helpless']
                },
                'condition|track':{
                    attr:'condition|track',affects:['sickened','fatigued','exhausted','unconscious','dead','shaken','spell|dc','ability|dc','flat_footed','encumber_level','overburden_bulk','encumber_bulk','staggered','helpless','ref','eac','kac','fort','intelligence','will','confused']
                },
                'condition|track_status':{
                    attr:'condition|track_status',affects:['sickened','fatigued','exhausted','unconscious','dead','shaken','spell|dc','ability|dc','flat_footed','encumber_level','overburden_bulk','encumber_bulk','staggered','helpless','ref','eac','kac','fort','intelligence','will','confused']
                },
                "strength_base":{
                "repeating":false,"attr":"strength_base","affects":["strength_mod"]
                },
                "dexterity_base":{
                "repeating":false,"attr":"dexterity_base","affects":["dexterity_mod"]
                },
                "constitution_base":{
                "repeating":false,"attr":"constitution_base","affects":["constitution_mod"]
                },
                "intelligence_base":{
                "repeating":false,"attr":"intelligence_base","affects":["intelligence_mod"]
                },
                "wisdom_base":{
                "repeating":false,"attr":"wisdom_base","affects":["wisdom_mod"]
                },
                "charisma_base":{
                "repeating":false,"attr":"charisma_base","affects":["charisma_mod"]
                },
                "strength_mod":{
                "repeating":false,"attr":"strength_mod","affects":[],"numAdds":0,"attrAdds":["strength_base"],"multAdds":[1],"addlBonus":[],"ability":'',"repeatTextAdds":[],"repeatAdds":[],"textAdds":[],moddable:'_change'
                },
                "dexterity_mod":{
                "repeating":false,"attr":"dexterity_mod","affects":['eac','kac'],"numAdds":0,"attrAdds":["dexterity_base"],"multAdds":[1],"addlBonus":[],"ability":'',"repeatTextAdds":[],"repeatAdds":[],"textAdds":[],moddable:'_change'
                },
                "constitution_mod":{
                "repeating":false,"attr":"constitution_mod","affects":[],"numAdds":0,"attrAdds":["constitution_base"],"multAdds":[1],"addlBonus":[],"ability":'',"repeatTextAdds":[],"repeatAdds":[],"textAdds":[],moddable:'_change'
                },
                "intelligence_mod":{
                "repeating":false,"attr":"intelligence_mod","affects":[],"numAdds":0,"attrAdds":["intelligence_base"],"multAdds":[1],"addlBonus":[],"ability":'',"repeatTextAdds":[],"repeatAdds":[],"textAdds":[],moddable:'_change'
                },
                "wisdom_mod":{
                "repeating":false,"attr":"wisdom_mod","affects":[],"numAdds":0,"attrAdds":["wisdom_base"],"multAdds":[1],"addlBonus":[],"ability":'',"repeatTextAdds":[],"repeatAdds":[],"textAdds":[],moddable:'_change'
                },
                "charisma_mod":{
                "repeating":false,"attr":"charisma_mod","affects":[],"numAdds":0,"attrAdds":["charisma_base"],"multAdds":[1],"addlBonus":[],"ability":'',"repeatTextAdds":[],"repeatAdds":[],"textAdds":[],moddable:'_change'
                },
                "hp_max":{
                "repeating":false,"attr":"hp_max",rollTime:'_misc',"affects":[],"numAdds":0,"attrAdds":[],"multAdds":[],"addlBonus":[],"ability":'',"repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":false
                },
                "rp_max":{
                "repeating":false,"attr":"rp_max",rollTime:'_misc',"affects":[],"numAdds":0,"attrAdds":[],"ability":'',"moddable":false
                },
                "eac_base":{
                "repeating":false,"attr":"eac_base","affects":["eac"],"numAdds":0,"attrAdds":[],"addlBonus":["armor"],"repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change",rollTime:false
                },
                "kac_base":{
                "repeating":false,"attr":"kac_base","affects":["kac"],"numAdds":0,"attrAdds":[],"addlBonus":[],"repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":false,rollTime:false
                },
                "cmd_base":{
                "repeating":false,"attr":"cmd_base","affects":["cmd"],"numAdds":0,"attrAdds":[],"addlBonus":[],"repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":false,rollTime:false
                },
                "eac":{
                "repeating":false,"attr":"eac",rollTime:'_misc',"affects":[],"numAdds":0,"attrAdds":["eac_base"],"multAdds":[1],"ability":'abi',"repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change"
                },
                "kac":{
                "repeating":false,"attr":"kac",rollTime:'_misc',"affects":[],"numAdds":0,"attrAdds":["kac_base"],"multAdds":[1],"ability":'abi',"repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change"
                },
                "cmd":{
                "repeating":false,"attr":"cmd",rollTime:'_misc',"affects":[],"numAdds":0,ability:'abi',"attrAdds":["cmd_base"],"multAdds":[1],"repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change"
                },
                "fort":{
                "repeating":false,"attr":"fort","affects":[],"numAdds":0,"attrAdds":["fort_base"],"multAdds":[1],"ability":'abi',"repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "fort_base":{
                "repeating":false,"attr":"fort_base","affects":["fort"],"numAdds":0,"attrAdds":[],"multAdds":[],"ability":"","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":false,"rollTime":false
                },
                "ref":{
                "repeating":false,"attr":"ref","affects":[],"numAdds":0,"attrAdds":["ref_base"],"multAdds":[1],"ability":"abi","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "ref_base":{
                "repeating":false,"attr":"ref_base","affects":["ref"],"numAdds":0,"attrAdds":[],"multAdds":[],"ability":"","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":false,"rollTime":false
                },
                "will":{
                "repeating":false,"attr":"will","affects":[],"numAdds":0,"attrAdds":["will_base"],"multAdds":[1],"ability":"abi","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "will_base":{
                "repeating":false,"attr":"will_base","affects":["will"],"numAdds":0,"attrAdds":[],"multAdds":[],"ability":"","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":false,"rollTime":false
                },
                "initiative":{
                "repeating":false,"attr":"initiative","affects":[],"numAdds":0,"attrAdds":[],"ability":"abi","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "initiative_base":{
                "repeating":false,"attr":"initiative_base","affects":['initiative','npc_init'],"numAdds":0,"attrAdds":[],"ability":"","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"","rollTime":""
                },
                "npc_init":{
                "repeating":false,"attr":"initiative_base","affects":[],"numAdds":0,"attrAdds":['initiative_base'],"ability":"abi","repeatTextAdds":[],"repeatAdds":[],"textAdds":['+'],"moddable":"","rollTime":""
                },
                'profession|profession':{
                    repeating:'profession',attr:'profession',affects:[],attrAdds:[],repeatAdds:['base'],ability:'ability',isSkill:true,numAdds:0,moddable:'change',rollTime:'_misc'
                },
                'profession|ranks':{
                    repeating:'profession',attr:'ranks',affects:[],attrAdds:[],repeatAdds:['base'],ability:'ability'
                },
                'profession|base':{
                    repeating:'profession',attr:'base',affects:['profession|profession','profession|ranks']
                },
                'profession|ability':{
                    repeating:'profession',attr:'ability',affects:['profession|profession','profession|ranks']
                },
                "acrobatics":{
                "repeating":false,"attr":"acrobatics","affects":[],"isSkill":true,"numAdds":0,"attrAdds":['acrobatics_base'],"multAdds":[1],"ability":"acrobatics_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "acrobatics_ranks":{
                "repeating":false,"attr":"acrobatics_ranks","affects":[],attrAdds:['acrobatics_base'],multAdds:[1],ability:'acrobatics_ability'
                },
                "acrobatics_base":{
                attr:'acrobatics_base',affects:['acrobatics','acrobatics_ranks']
                },
                "acrobatics_ability":{
                "repeating":false,"attr":"acrobatics_ability","affects":["acrobatics",'acrobatics_ranks']
                },
                "athletics":{
                "repeating":false,"attr":"athletics","affects":[],"isSkill":true,"numAdds":0,"attrAdds":['athletics_base'],"multAdds":[1],"ability":"athletics_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "athletics_ranks":{
                "repeating":false,"attr":"athletics_ranks","affects":[],attrAdds:['athletics_base'],multAdds:[1],ability:'athletics_ability'
                },
                "athletics_base":{
                attr:'athletics_base',affects:['athletics','athletics_ranks']
                },
                "athletics_ability":{
                "repeating":false,"attr":"athletics_ability","affects":["athletics",'athletics_ranks']
                },
                "bluff":{
                "repeating":false,"attr":"bluff","affects":[],"isSkill":true,"numAdds":0,"attrAdds":['bluff_base'],"multAdds":[1],"ability":"bluff_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "bluff_ranks":{
                "repeating":false,"attr":"bluff_ranks","affects":[],attrAdds:['bluff_base'],multAdds:[1],ability:'bluff_ability'
                },
                "bluff_base":{
                attr:'bluff_base',affects:['bluff','bluff_ranks']
                },
                "bluff_ability":{
                "repeating":false,"attr":"bluff_ability","affects":["bluff",'bluff_ranks']
                },
                "computers":{
                "repeating":false,"attr":"computers","affects":[],"isSkill":true,"numAdds":0,"attrAdds":['computers_base'],"multAdds":[1],"ability":"computers_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "computers_ranks":{
                "repeating":false,"attr":"computers_ranks","affects":[],attrAdds:['computers_base'],multAdds:[1],ability:'computers_ability'
                },
                "computers_base":{
                attr:'computers_base',affects:['computers','computers_ranks']
                },
                "computers_ability":{
                "repeating":false,"attr":"computers_ability","affects":["computers",'computers_ranks']
                },
                "culture":{
                "repeating":false,"attr":"culture","affects":[],"isSkill":true,"numAdds":0,"attrAdds":['culture_base'],"multAdds":[1],"ability":"culture_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "culture_ranks":{
                "repeating":false,"attr":"culture_ranks","affects":[],attrAdds:['culture_base'],multAdds:[1],ability:'culture_ability'
                },
                "culture_base":{
                attr:'culture_base',affects:['culture','culture_ranks']
                },
                "culture_ability":{
                "repeating":false,"attr":"culture_ability","affects":["culture",'culture_ranks']
                },
                "diplomacy":{
                "repeating":false,"attr":"diplomacy","affects":[],"isSkill":true,"numAdds":0,"attrAdds":['diplomacy_base'],"multAdds":[1],"ability":"diplomacy_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "diplomacy_ranks":{
                "repeating":false,"attr":"diplomacy_ranks","affects":[],attrAdds:['diplomacy_base'],multAdds:[1],ability:'diplomacy_ability'
                },
                "diplomacy_base":{
                attr:'diplomacy_base',affects:['diplomacy','diplomacy_ranks']
                },
                "diplomacy_ability":{
                "repeating":false,"attr":"diplomacy_ability","affects":["diplomacy",'diplomacy_ranks']
                },
                "disguise":{
                "repeating":false,"attr":"disguise","affects":[],"isSkill":true,"numAdds":0,"attrAdds":['disguise_base'],"multAdds":[1],"ability":"disguise_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "disguise_ranks":{
                "repeating":false,"attr":"disguise_ranks","affects":[],attrAdds:['disguise_base'],multAdds:[1],ability:'disguise_ability'
                },
                "disguise_base":{
                attr:'disguise_base',affects:['disguise','disguise_ranks']
                },
                "disguise_ability":{
                "repeating":false,"attr":"disguise_ability","affects":["disguise",'disguise_ranks']
                },
                "engineering":{
                "repeating":false,"attr":"engineering","affects":[],"isSkill":true,"numAdds":0,"attrAdds":['engineering_base'],"multAdds":[1],"ability":"engineering_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "engineering_ranks":{
                "repeating":false,"attr":"engineering_ranks","affects":[],attrAdds:['engineering_base'],multAdds:[1],ability:'engineering_ability'
                },
                "engineering_base":{
                attr:'engineering_base',affects:['engineering','engineering_ranks']
                },
                "engineering_ability":{
                "repeating":false,"attr":"engineering_ability","affects":["engineering",'engineering_ranks']
                },
                "intimidate":{
                "repeating":false,"attr":"intimidate","affects":[],"isSkill":true,"numAdds":0,"attrAdds":['intimidate_base'],"multAdds":[1],"ability":"intimidate_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "intimidate_ranks":{
                "repeating":false,"attr":"intimidate_ranks","affects":[],attrAdds:['intimidate_base'],multAdds:[1],ability:'intimidate_ability'
                },
                "intimidate_base":{
                attr:'intimidate_base',affects:['intimidate','intimidate_ranks']
                },
                "intimidate_ability":{
                "repeating":false,"attr":"intimidate_ability","affects":["intimidate",'intimidate_ranks']
                },
                "life_science":{
                "repeating":false,"attr":"life_science","affects":[],"isSkill":true,"numAdds":0,"attrAdds":['life_science_base'],"multAdds":[1],"ability":"life_science_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "life_science_ranks":{
                "repeating":false,"attr":"life_science_ranks","affects":[],attrAdds:['life_science_base'],multAdds:[1],ability:'life_science_ability'
                },
                "life_science_base":{
                attr:'life_science_base',affects:['life_science','life_science_ranks']
                },
                "life_science_ability":{
                "repeating":false,"attr":"life_science_ability","affects":["life_science",'life_science_ranks']
                },
                "medicine":{
                "repeating":false,"attr":"medicine","affects":[],"isSkill":true,"numAdds":0,"attrAdds":['medicine_base'],"multAdds":[1],"ability":"medicine_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "medicine_ranks":{
                "repeating":false,"attr":"medicine_ranks","affects":[],attrAdds:['medicine_base'],multAdds:[1],ability:'medicine_ability'
                },
                "medicine_base":{
                attr:'medicine_base',affects:['medicine','medicine_ranks']
                },
                "medicine_ability":{
                "repeating":false,"attr":"medicine_ability","affects":["medicine",'medicine_ranks']
                },
                "mysticism":{
                "repeating":false,"attr":"mysticism","affects":[],"isSkill":true,"numAdds":0,"attrAdds":['mysticism_base'],"multAdds":[1],"ability":"mysticism_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "mysticism_ranks":{
                "repeating":false,"attr":"mysticism_ranks","affects":[],attrAdds:['mysticism_base'],multAdds:[1],ability:'mysticism_ability'
                },
                "mysticism_base":{
                attr:'mysticism_base',affects:['mysticism','mysticism_ranks']
                },
                "mysticism_ability":{
                "repeating":false,"attr":"mysticism_ability","affects":["mysticism",'mysticism_ranks']
                },
                "perception":{
                "repeating":false,"attr":"perception","affects":[],"isSkill":true,"numAdds":0,"attrAdds":['perception_base'],"multAdds":[1],"ability":"perception_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "perception_ranks":{
                "repeating":false,"attr":"perception_ranks","affects":[],attrAdds:['perception_base'],multAdds:[1],ability:'perception_ability'
                },
                "perception_base":{
                attr:'perception_base',affects:['perception','perception_ranks']
                },
                "perception_ability":{
                "repeating":false,"attr":"perception_ability","affects":["perception",'perception_ranks']
                },
                "physical_science":{
                "repeating":false,"attr":"physical_science","affects":[],"isSkill":true,"numAdds":0,"attrAdds":['physical_science_base'],"multAdds":[1],"ability":"physical_science_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "physical_science_ranks":{
                "repeating":false,"attr":"physical_science_ranks","affects":[],attrAdds:['physical_science_base'],multAdds:[1],ability:'physical_science_ability'
                },
                "physical_science_base":{
                attr:'physical_science_base',affects:['physical_science','physical_science_ranks']
                },
                "physical_science_ability":{
                "repeating":false,"attr":"physical_science_ability","affects":["physical_science",'physical_science_ranks']
                },
                "piloting":{
                "repeating":false,"attr":"piloting","affects":[],"isSkill":true,"numAdds":0,"attrAdds":['piloting_base'],"multAdds":[1],"ability":"piloting_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "piloting_ranks":{
                "repeating":false,"attr":"piloting_ranks","affects":[],attrAdds:['piloting_base'],multAdds:[1],ability:'piloting_ability'
                },
                "piloting_base":{
                attr:'piloting_base',affects:['piloting','piloting_ranks']
                },
                "piloting_ability":{
                "repeating":false,"attr":"piloting_ability","affects":["piloting",'piloting_ranks']
                },
                "sense_motive":{
                "repeating":false,"attr":"sense_motive","affects":[],"isSkill":true,"numAdds":0,"attrAdds":['sense_motive_base'],"multAdds":[1],"ability":"sense_motive_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "sense_motive_ranks":{
                "repeating":false,"attr":"sense_motive_ranks","affects":[],attrAdds:['sense_motive_base'],multAdds:[1],ability:'sense_motive_ability'
                },
                "sense_motive_base":{
                attr:'sense_motive_base',affects:['sense_motive','sense_motive_ranks']
                },
                "sense_motive_ability":{
                "repeating":false,"attr":"sense_motive_ability","affects":["sense_motive",'sense_motive_ranks']
                },
                "sleight_of_hand":{
                "repeating":false,"attr":"sleight_of_hand","affects":[],"isSkill":true,"numAdds":0,"attrAdds":['sleight_of_hand_base'],"multAdds":[1],"ability":"sleight_of_hand_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "sleight_of_hand_ranks":{
                "repeating":false,"attr":"sleight_of_hand_ranks","affects":[],attrAdds:['sleight_of_hand_base'],multAdds:[1],ability:'sleight_of_hand_ability'
                },
                "sleight_of_hand_base":{
                attr:'sleight_of_hand_base',affects:['sleight_of_hand','sleight_of_hand_ranks']
                },
                "sleight_of_hand_ability":{
                "repeating":false,"attr":"sleight_of_hand_ability","affects":["sleight_of_hand",'sleight_of_hand_ranks']
                },
                "stealth":{
                "repeating":false,"attr":"stealth","affects":[],"isSkill":true,"numAdds":0,"attrAdds":['stealth_base'],"multAdds":[1],"ability":"stealth_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "stealth_ranks":{
                "repeating":false,"attr":"stealth_ranks","affects":[],attrAdds:['stealth_base'],multAdds:[1],ability:'stealth_ability'
                },
                "stealth_base":{
                attr:'stealth_base',affects:['stealth','stealth_ranks']
                },
                "stealth_ability":{
                "repeating":false,"attr":"stealth_ability","affects":["stealth",'stealth_ranks']
                },
                "survival":{
                "repeating":false,"attr":"survival","affects":[],"isSkill":true,"numAdds":0,"attrAdds":['survival_base'],"multAdds":[1],"ability":"survival_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"_misc"
                },
                "survival_ranks":{
                "repeating":false,"attr":"survival_ranks","affects":[],attrAdds:['survival_base'],multAdds:[1],ability:'survival_ability'
                },
                "survival_base":{
                attr:'survival_base',affects:['survival','survival_ranks']
                },
                "survival_ability":{
                "repeating":false,"attr":"survival_ability","affects":["survival",'survival_ranks']
                },
                "attack|total":{
                "repeating":"attack","attr":"total","affects":[],"numAdds":0,"attrAdds":["bab"],"multAdds":[1],"category":"category","ability":"ability","repeatTextAdds":[],"repeatAdds":['base_attack_bonus_base'],"textAdds":[],"moddable":"_change","rollTime":"misc"
                },
                "attack|base_attack_bonus":{
                "repeating":"attack","attr":"base_attack_bonus","affects":['attack|total'],"numAdds":0,"attrAdds":[],"multAdds":[1],"category":"category","ability":"ability","repeatTextAdds":[],"repeatAdds":['base_attack_bonus_base'],"textAdds":[]
                },
                "attack|base_attack_bonus_base":{
                "repeating":"attack","attr":"base_attack_bonus_base","affects":['attack|base_attack_bonus'],"numAdds":0,"attrAdds":[],"multAdds":[1],"category":"category","ability":"","repeatTextAdds":[],"repeatAdds":[],"textAdds":[]
                },
                "attack|ability":{
                "repeating":'attack',"attr":"ability","affects":["attack|total","attack|base_attack_bonus"]
                },
                'attack|damage_dice':{
                    repeating:'attack',attr:'damage_dice',affects:['attack|damage_total']
                },
                'attack|proficiency':{
                    "repeating":'attack',"attr":"proficiency","affects":["attack|total",'attack|damage_total']
                },
                'attack|category':{
                    "repeating":'attack',"attr":"category","affects":["attack|total",'attack|damage_total']
                },
                "attack|damage_total":{
                "repeating":"attack","attr":"damage_total","affects":[],"numAdds":0,"attrAdds":[],"repeatTextAdds":["damage_dice"],"category":"category","ability":"damage_ability","repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"misc"
                },
                "attack|damage_ability":{
                "repeating":'attack',"attr":"damage_ability","affects":["attack|damage_total"]
                },
                "ability|uses_max":{
                "repeating":"ability","attr":"uses_max","affects":[],"numAdds":0,"attrAdds":[],"multAdds":[],"repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"repeatParseField":["uses_max_base"],"moddable":"_change"
                },
                'ability|uses_max_base':{
                    repeating:'ability',attr:'uses_max_base',affects:['ability|uses_max']
                },
                "ability|base_attack_bonus":{
                "repeating":"ability","attr":"base_attack_bonus","affects":['ability|attack_total'],"numAdds":0,"attrAdds":[""],"multAdds":[1],"category":"category","ability":"attack_ability","repeatTextAdds":[],"repeatAdds":['base_attack_bonus_base'],"textAdds":[]
                },
                "ability|base_attack_bonus_base":{
                "repeating":"ability","attr":"base_attack_bonus_base","affects":['ability|base_attack_bonus'],"numAdds":0,"attrAdds":[],"multAdds":[1],"category":"category","ability":"attack_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[]
                },
                "ability|attack_total":{
                "repeating":"ability","attr":"attack_total","affects":[],"numAdds":0,"attrAdds":["base_attack_bonus"],"multAdds":[1],"ability":"ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":true,"rollTime":"misc"
                },
                "ability|attack_ability":{
                "repeating":'ability',"attr":"attack_ability","affects":["ability|attack_total",'ability|base_attack_bonus']
                },
                'ability|damage_dice':{
                    repeating:'attack',attr:'damage_dice',affects:['ability|damage_total']
                },
                "ability|damage_total":{
                "repeating":"ability","attr":"damage_total","affects":[],"numAdds":0,"attrAdds":[],"repeatTextAdds":["damage_dice"],"ability":"damage_ability","repeatAdds":[],"textAdds":[],"moddable":true,"rollTime":"misc"
                },
                "ability|damage_ability":{
                "repeating":'ability',"attr":"damage_ability","affects":["ability|damage_total"]
                },
                "ability|dc":{
                "repeating":"ability","attr":"dc","affects":[],"attrAdds":[],"multAdds":[],repeatAdds:['dc_base'],"numAdds":0,"ability":"save_ability","moddable":"_change"
                },
                "ability|dc_base":{
                "repeating":"ability","attr":"dc_base","affects":['ability|dc'],"attrAdds":[],"multAdds":[],"numAdds":0,"ability":"","moddable":false
                },
                "ability|save_ability":{
                "repeating":'ability',"attr":"save_ability","affects":["ability|dc"]
                },
                "spell|level":{
                "repeating":"spell","attr":"level","affects":["spell|filter"]
                },
                "spell|base_attack_bonus":{
                "repeating":"spell","attr":"base_attack_bonus","affects":['spell|attack_total'],"numAdds":0,"attrAdds":[""],"multAdds":[1],"category":"category","ability":"attack_ability","repeatTextAdds":[],"repeatAdds":['base_attack_bonus_base'],"textAdds":[]
                },
                "spell|base_attack_bonus_base":{
                "repeating":"spell","attr":"base_attack_bonus_base","affects":['spell|base_attack_bonus'],"numAdds":0,"attrAdds":[],"multAdds":[1],"category":"category","ability":"attack_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[]
                },
                "spell|filter":{
                "repeating":"spell","attr":"filter","affects":[]
                },
                "spell|attack_total":{
                "repeating":"spell","attr":"attack_total","affects":[],"numAdds":0,"attrAdds":["bab"],"multAdds":[1],"ability":"attack_ability","repeatTextAdds":[],"repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"misc"
                },
                "spell|attack_ability":{
                "repeating":'spell',"attr":"attack_ability","affects":["spell|attack_total",'spell|base_attack_bonus']
                },
                "spell|damage_total":{
                "repeating":"spell","attr":"damage_total","affects":[],"numAdds":0,"attrAdds":[],"repeatTextAdds":["damage_dice","damage_bonus"],"category":"category","ability":"damage_ability","repeatAdds":[],"textAdds":[],"moddable":"_change","rollTime":"misc"
                },
                "spell|damage_ability":{
                "repeating":'spell',"attr":"damage_ability","affects":["spell|damage_total"]
                },
                'spell|damage_dice':{
                    repeating:'spell',attr:'damage_dice',affects:['spell|damage_total']
                },
                "spell|dc":{
                "repeating":"spell","attr":"dc","affects":[],"attrAdds":[],"repeatAdds":['dc_base'],"numAdds":0,"ability":"save_ability","moddable":"_change"
                },
                "spell|dc_base":{
                "repeating":"spell","attr":"dc_base","affects":['spell|dc'],"attrAdds":[],"multAdds":[],"numAdds":0,"ability":"","moddable":false
                },
                "spell|save_ability":{
                "repeating":'spell',"attr":"save_ability","affects":["spell|dc"]
                },
            },
        
        //esRE and HE are used to html escape characters for use in some of the menus that are made. Full credit to Aaron for these functions    
        esRE = function (s) {
            var escapeForRegexp = /(\\|\/|\[|\]|\(|\)|\{|\}|\?|\+|\*|\||\.|\^|\$)/g;
            return s.replace(escapeForRegexp,"\\$1");
        },
        
        HE = (function(){
            var entities={
                /*'' :'&'+'nbsp'+';',*/
               '*' :'&'+'#42'+';',
               '&' :'&'+'amp'+';',
               '<' :'&'+'lt'+';',
               '>' :'&'+'gt'+';',
                "'" :'&'+'#39'+';',
               '@' :'&'+'#64'+';',
               '{' :'&'+'#123'+';',
               '|' :'&'+'#124'+';',
               '}' :'&'+'#125'+';',
               ',' :'&'+'#44'+';',
               '[' :'&'+'#91'+';',
               ']' :'&'+'#93'+';',
               '"' :'&'+'quot'+';',
               ':' :'&'+'#58'+';',
               '(' :'&'+'#40'+';',
               ')' :'&'+'#41'+';'
                /*'-' :'&'+'mdash'+';'*/
            },
            re=new RegExp('('+_.map(_.keys(entities),esRE).join('|')+')','g');
            return function(s){
                return s.replace(re, function(c){ return entities[c] || c; });
            };
        }()),
        
        //Registers the on() handlers
        RegisterEventHandlers = function(){
            //Compendium drop handlers
            on('change:drop_category',dropHandler);
            
            //user changes
            on('sheet:opened',updateSheet);//when the sheet is first opened, do any fixes necessary, and update the sheet version attribute
            on('change:tab_select change:resolve_source change:stackable_buffs change:sheet_type ' //
            +'change:class_1_name change:class_2_name change:class_3_name change:class_4_name change:class_5_name '
            +'change:class_1_level change:class_2_level change:class_3_level change:class_4_level change:class_5_level '
            +'change:class_1_sp change:class_2_sp change:class_3_sp change:class_4_sp change:class_5_sp '
            +'change:class_1_hp change:class_2_hp change:class_3_hp change:class_4_hp change:class_5_hp '
            +'change:class_1_bab change:class_2_bab change:class_3_bab change:class_4_bab change:class_5_bab '
            +'change:class_1_fort change:class_2_fort change:class_3_fort change:class_4_fort change:class_5_fort '
            +'change:class_1_ref change:class_2_ref change:class_3_ref change:class_4_ref change:class_5_ref '
            +'change:class_1_will change:class_2_will change:class_3_will change:class_4_will change:class_5_will '
            +'change:class_1_skills change:class_2_skills change:class_3_skills change:class_4_skills change:class_5_skills '
            +'change:class_1_ability change:class_2_ability change:class_3_ability change:class_4_ability change:class_5_ability '
            +'change:class_1_spells change:class_2_spells change:class_3_spells change:class_4_spells change:class_5_spells '
            +'change:class_1_spell_progression change:class_2_spell_progression change:class_3_spell_progression change:class_4_spell_progression change:class_5_spell_progression '
            +'change:class_1_casting_ability change:class_2_casting_ability change:class_3_casting_ability change:class_4_casting_ability change:class_5_casting_ability '
            +'change:race_hp change:strength_base change:strength_enhance change:strength_penalty change:strength_drain '
            +'change:dexterity_base change:dexterity_enhance change:dexterity_penalty change:dexterity_drain change:constitution_base '
            +'change:constitution_enhance change:constitution_penalty change:constitution change:intelligence_base change:intelligence_enhance '
            +'change:intelligence_penalty change:intelligence_drain change:wisdom_base change:wisdom_enhance change:wisdom_penalty change:wisdom_drain '
            +'change:charisma_base change:charisma_enhance change:charisma_penalty change:charisma_drain change:eac_ability change:kac_ability '
            +'change:dexterity_mod change:strength_mod change:constitution_mod change:intelligence_mod change:wisdom_mod change:charisma_mod '
            +'change:fort_ability change:fort change:ref_ability change:ref change:will_ability change:will change:initiative_ability change:initiative change:sp change:hp change:rp change:temp_hp '
            +'change:acrobatics change:athletics change:bluff change:computers change:culture change:diplomacy change:disguise change:engineering change:intimidate change:life_science change:medicine change:mysticism change:profession change:perception change:physical_science change:piloting change:sense_motive change:sleight_of_hand change:stealth change:survival '
            +'change:acrobatics_ranks change:acrobatics_class_skill change:acrobatics_ability change:acrobatics_acp '
            +'change:athletics_ranks change:athletics_class_skill change:athletics_ability change:athletics_acp '
            +'change:bluff_ranks change:bluff_class_skill change:bluff_ability change:bluff_acp '
            +'change:computers_ranks change:computers_class_skill change:computers_ability change:computers_acp '
            +'change:culture_ranks change:culture_class_skill change:culture_ability change:culture_acp '
            +'change:diplomacy_ranks change:diplomacy_class_skill change:diplomacy_ability change:diplomacy_acp '
            +'change:disguise_ranks change:disguise_class_skill change:disguise_ability change:disguise_acp '
            +'change:engineering_ranks change:engineering_class_skill change:engineering_ability  change:engineering_acp '
            +'change:intimidate_ranks change:intimidate_class_skill change:intimidate_ability  change:intimidate_acp '
            +'change:life_science_ranks change:life_science_class_skill change:life_science_ability  change:life_science_acp '
            +'change:medicine_ranks change:medicine_class_skill change:medicine_ability  change:medicine_acp '
            +'change:mysticism_ranks change:mysticism_class_skill change:mysticism_ability change:mysticism_acp '
            +'change:perception_ranks change:perception_class_skill change:perception_ability change:perception_acp '
            +'change:physical_science_ranks change:physical_science_class_skill change:physical_science_ability change:physical_science_acp '
            +'change:piloting_ranks change:piloting_class_skill change:piloting_ability change:_acp '
            +'change:sense_motive_ranks change:sense_motive_class_skill change:sense_motive_ability change:sense_motive_acp '
            +'change:sleight_of_hand_ranks change:sleight_of_hand_class_skill change:sleight_of_hand_ability change:sleight_of_hand_acp '
            +'change:stealth_ranks change:stealth_class_skill change:stealth_ability change:stealth_acp '
            +'change:survival_ranks change:survival_class_skill change:survival_ability change:survival_acp '
            +'change:eac_base change:kac_base change:cmd_base change:fort_base change:ref_base change:will_base '
            +'change:repeating_item change:repeating_attack change:repeating_profession change:repeating_buff change:repeating_ability change:repeating_spell '
            +'change:create_cantrip change:create_1st change:create_2nd change:create_3rd change:create_4th change:create_5th change:create_6th change:create_7th change:create_8th change:create_9th '
            +'change:create_npcmelee change:create_npcranged change:stackable_buffs change:half_specializations change:drone '
            +'remove:repeating_item remove:repeating_buff remove:repeating_ability '
            +'change:light_armor_proficiency change:heavy_armor_proficiency change:power_armor_proficiency change:basic_melee_proficiency change:advanced_melee_proficiency '
            +'change:small_arm_proficiency change:longarm_proficiency change:heavy_weapon_proficiency change:grenade_proficiency change:sniper_proficiency '
            +'change:acrobatics_base change:athletics_base change:bluff_base change:computers_base change:culture_base change:diplomacy_base change:disguise_base change:engineering_base change:intimidate_base change:life_science_base change:medicine_base change:mysticism_base '
            +'change:perception_base change:physical_science_base change:piloting_base change:sense_motive_base change:sleight_of_hand_base change:stealth_base change:survival_base '
            /*starship events*/
            +'change:create_forward change:create_port change:create_aft change:create_starboard change:create_turret '
            +'change:create_system change:create_expansion '
            //conditions
            //disease and poison tracks
            +'change:repeating_condition '
            //tactical conditions
            +'change:asleep change:blinded change:cowering change:dazzled change:deafened change:encumbered change:entangled change:exhausted change:fascinated '
            +'change:fatigued change:flat_footed change:frightened change:grappled change:helpless change:negative_levels change:off_kilter change:off_target '
            +'change:overburdened change:panicked change:paralyzed change:pinned change:prone change:shaken change:sickened change:stunned change:unconscious '
            +'change:gunner change:captain change:engineer change:pilot change:science_officer change:speed change:maneuverability',
            accessStarfinder);
            /*ship specific listener*/
            on('change:ship_piloting_ranks change:repeating_system:shields change:repeating_system:sensor_bonus change:repeating_system:armor change:repeating_system:countermeasure change:repeating_system:purpose change:repeating_system:pcu change:repeating_system:bp change:repeating_system:powered change:repeating_system:comp_bonus change:repeating_attack:pcu change:repeating_attack:bp change:repeating_attack:powered change:ship_computer change:size',()=>{
                getID(JSON.parse(JSON.stringify(repeatingShipAttributes)),shipSystemHandler);
            });
            on('change:update_pilot_ranks',updatePilot);
            //shield change listener
            on('change:forward_shields change:port_shields change:aft_shields change:starboard_shields',shieldHandler);
            //patch listener
            on('change:life_support_patch change:sensors_patch change:engines_patch change:power_core_patch',patchHandler);
            
        },
        //updates the sheet when it is first opened
        updateSheet = function(){
            var setObj = {character_sheet:'Starfinder v'+version},
                attributes = [];
                TAS.log('Updating Sheet');
            getID(JSON.parse(JSON.stringify(repeatingAttributes)),(sectionAggregate)=>{
                TAS.log('Repeating Sections Loaded');
                _.each(sectionAggregate,(section)=>{
                    _.each(section.id,(sid)=>{
                        _.each(section.fields,(f)=>{
                            attributes.push('repeating_'+section.section+'_'+sid+'_'+f);
                            if(f==='name' && section.section==='attack'){
                                attributes.push('repeating_'+section.section+'_'+sid+'_bab');
                            }
                        });
                    });
                });
                TAS.log('Repeating Section Attribute Names Assembled');
                attributes = attributes.concat(sheetAttributes).concat(['character_sheet','class&level']);
                getAttrs(attributes,(updateAttrs)=>{
                    TAS.log('Sheet Attributes Acquired');
                    _.each(['strength_mod','dexterity_mod','constitution_mod','intelligence_mod','wisdom_mod','charisma_mod'],(mod)=>{
                        if(!updateAttrs[mod]){
                            setObj[mod]=0;
                            updateAttrs[mod]=0;
                        }
                    })
                    if(updateAttrs.character_sheet){
                        let upgradeFrom = updateAttrs.character_sheet.replace(/Starfinder v/,''),
                            lastDate;
                        TAS.log('Base Attack Bonuses Updated');
                        TAS.log('upgradeFrom: '+upgradeFrom);
                        if(upgradeFrom*1<version*1){
                            upgradeFrom.replace(/(\d+\.\d{2})(\d+)/,(match,version,build)=>{
                                upgradeFrom = version*1;
                                lastDate = build*1;
                            });
                            TAS.log(`upgradeFrom: ${upgradeFrom}`);
                            TAS.log(`lastDate: ${lastDate}`);
                            if(upgradeFrom<0.07){
                                if(updateAttrs.whisper_state === '/w gm'){
                                    setObj.whisper_state = '/w gm ';
                                }
                                let repeatBabs = _.filter(_.keys(updateAttrs),(k)=>{
                                    return k.match(/repeating_[^_]+_[^_]+_bab/);
                                });
                                _.each(repeatBabs,(r)=>{
                                    if(updateAttrs[r]!== 'replaced'){
                                        setObj[r]='replaced';
                                        setObj[r.replace(/bab/,'base_attack_bonus')]=updateAttrs[r];
                                    }
                                });
                                [updateAttrs,setObj] = updateToOfficial(updateAttrs,setObj);
                            }
                            if(upgradeFrom<=0.08){
                                TAS.log('update to new build');
                                if(lastDate<1532287051){
                                    updateToZeroEightJuly22(updateAttrs,setObj);
                                }
                                if(lastDate < 1532723850 && updateAttrs.sheet_type==='npc'){
                                    updateToZeroEightJuly27(updateAttrs,setObj);
                                }
                            }
                        }
                    }
                    setObj = buildMenus(updateAttrs,setObj);
                    storeInfo(updateAttrs);
                    TAS.log(`presetAttrs setObj: ${JSON.stringify(setObj)}`);
                    setAttrs(setObj,{silent:true});
                });
            });
        },
        
        updateToOfficial = function(attributes,setObj){
            TAS.log('updating to Roll20 Official Sheet');
            let attributeKeys = _.keys(attributes),
                attackCategories = _.filter(attributeKeys,(k)=>{return /repeating_attack_[^_]+_category/.test(k)}),
                abilityFrequencies = _.filter(attributeKeys,(k)=>{return /repeating_ability_[^_]+_frequencies/.test(k)}),
                spellLevels = _.filter(attributeKeys,(k)=>{return /repeating_spell_[^_]+_level/.test(k)}),
                toggles = _.filter(attributeKeys,(k)=>{return /_toggle/.test(k)}),
                modFields = _.filter(attributeKeys,(k)=>{return /_mods/.test(k)});
                
            if(attributes.sheet_type==='npc'){
                _.each(['strength_mod','dexterity_mod','constitution_mod','intelligence_mod','wisdom_mod','charisma_mod','eac','kac','cmd','initiative'],(attr)=>{
                    setObj[attr.replace(/_mod$/,'')+'_base']=attributes[attr]*1||0;
                    attributes[attr.replace(/_mod$/,'')+'_base']=attributes[attr]*1||0;
                });
                TAS.log('ability mods, ac, and initiative updated');
                _.each(['acrobatics','athletics','bluff','computers','culture','diplomacy','disguise','engineering','intimidate','life_science','medicine','mysticism','perception','physical_science','piloting','sense_motive','sleight_of_hand','stealth','survival'],(skill)=>{
                    setObj[skill+'_base']=attributes[skill]*1||0;
                    setObj[skill+'_ranks']=(attributes[skill]*1||0) > 0 ? (attributes[skill]*1||0) - (attributes[attributes[skill+'_ability'].replace(/@{|}/g,'').replace(/mod$/,'base')]*1||0) : 0;
                });
                TAS.log('skills updated');
                _.each(attackCategories,(category)=>{
                    const rowID = category.replace(/category$/,'');
                    setObj[rowID+'base_attack_bonus_base']=attributes[rowID+'base_attack_bonus']*1||0;
                    setObj[rowID+'base_attack_bonus']=(attributes[rowID+'base_attack_bonus']*1||0) - (attributes[attributes[rowID+'ability'].replace(/@{|}/g,'').replace(/mod$/,'base')]*1||0);
                    TAS.log(`setObj[${rowID}base_attack_bonus_base]: ${setObj[rowID+'base_attack_bonus_base']} | setObj[${rowID}base_attack_bonus]: ${setObj[rowID+'base_attack_bonus']}`);
                });
                TAS.log('attacks updated');
                _.each(abilityFrequencies.concat(spellLevels),(level)=>{
                    const rowID = level.replace(/(?:level|frequency)$/,'');
                    setObj[rowID+'base_attack_bonus_base']=attributes[rowID+'base_attack_bonus']*1||0;
                    setObj[rowID+'base_attack_bonus']=(attributes[rowID+'base_attack_bonus']*1||0) - (attributes[attributes[rowID+'attack_ability'].replace(/@{|}/g,'').replace(/mod$/,'base')]*1||0);
                    setObj[rowID+'dc_base']=attributes[rowID+'dc']*1||0;
                    if(/repeating_ability_/.test(rowID)){
                        setObj[rowID+'frequency']=attributes[rowID+'frequency'].replace(/\s+/,'-');
                    }
                });
                TAS.log('spells and special abilities updated');
            }
            _.each(attackCategories,(category)=>{
                switch(true){
                    case /operative/i.test(attributes[category]):
                        setObj[category]='basic_melee';
                        setObj[category.replace(/category/,'special')]=[setObj[category.replace(/category/,'special')],'Operative'].join(', ');
                        break;
                    case /basic/i.test(attributes[category]):
                        setObj[category]='basic_melee';
                        break;
                    case /advance/i.test(attributes[category]):
                        setObj[category]='advanced_melee';
                        break;
                    case /small/i.test(attributes[category]):
                        setObj[category]='small_arm';
                        break;
                    case /long/i.test(attributes[category]):
                        setObj[category]='longarm';
                        break;
                    case /sniper/i.test(attributes[category]):
                        setObj[category]='sniper';
                        break;
                    case /heavy/i.test(attributes[category]):
                        setObj[category]='heavy';
                        break;
                    case /grenade/i.test(attributes[category]):
                        setObj[category]='grenade';
                        break;
                    default:
                        setObj[category]='special';
                        break;
                }
                attributes[category]=setObj[category];
            });
            _.each(abilityFrequencies,(frequency)=>{
                const freqSwitch = {
                    "at will":"at-will",
                    "daily limit":"daily-limit",
                    "constant":"constant"
                }
                setObj[frequency]=freqSwitch[attributes[frequency]];
                attributes[frequency]=setObj[frequency];
            });
            _.each(spellLevels,(filter)=>{
                let rowID = filter.replace(/(repeating_spell_[^_]+)_level/,'$1');
                setObj[rowID+'_filter']=attributes[filter]*1||'cantrip';
            });
            _.each(toggles,(toggle)=>{
                if(attributes[toggle]==='enabled'){
                    setObj[toggle]=1;
                    attributes[toggle]=1;
                }
            });
            _.each(modFields,(mods)=>{
                setObj[mods]=attributes[mods].replace(/(\|.*category:.+) weapons?/g,'$1');
            });
            setObj.char_max_spell = '';
            _.each(_.range(attributes.char_max_spell*1||0) + 1,(r)=>{
                setObj.char_max_spell+=' '+r;
            });
            attributes['class&level'].replace(/(.+?) (\d+)/g,(match,p1,p2)=>{
                const profLevel = p2*1>=3 ? 'specialized': 'yes',
                    profs = {
                        soldier:{armor:['heavy_armor'],weapons:['basic_melee','small_arm','advanced_melee','heavy_weapon','sniper','grenade','longarm']},
                        solarian:{armor:[],weapons:['basic_melee','small_arm','advanced_melee']},
                        envoy:{armor:[],weapons:['basic_melee','small_arm','grenade']},
                        mechanic:{armor:[],weapons:['basic_melee','small_arm','grenade']},
                        mystic:{armor:[],weapons:['basic_melee','small_arm']},
                        technomancer:{armor:[],weapons:['basic_melee','small_arm']},
                        operative:{armor:[],weapons:['basic_melee','small_arm','sniper']},
                    }
                if(!/soldier|solari[ao]n|envoy|mystic|operative|mechanic|technomancer/i.test(p1)){
                    p1='mystic';
                }
                _.each(profs[p1.trim().toLowerCase()].weapons,(prof)=>{
                    setObj[prof+'_proficiency']=profLevel;
                });
                _.each(profs[p1.trim().toLowerCase()].armor,(prof)=>{
                    setObj[prof+'_proficiency']='yes';
                });
            });
            TAS.log(`Final setObj[repeating_attack_-lemx9xj5qwm6osnjvpz_base_attack_bonus_base]: ${setObj['repeating_attack_-lemx9xj5qwm6osnjvpz_base_attack_bonus_base']}`);
            TAS.log('Starfinder HUD upgraded to Starfinder (Official)');
            return [attributes,setObj];
        },
        
        updateToZeroEightJuly22 = function(attributes,setObj){
            attributes.half_specializations = attributes.half_specializations.replace(/small\s+arms,\s*small\s+arm/i,'small_arm');
            setObj.half_specializations = attributes.half_specializations;
        },
        
        updateToZeroEightJuly27 = function(attributes,setObj){
            attributes.character_level = attributes.cr;
            setObj.character_level = attributes.cr;
        },
        
        storeInfo = function(attributes){
            pilotingRanks[attributes.character_name.replace(/\s+/,'_').toLowerCase()]=attributes.piloting_ranks;
        },
        //gets the repeating item IDs to assemble an array of repeating attributes to be used in getAttrs() calls
        /*arguments:
            cloneRepAttr: a cloned version of the repeatingAttributes or repeatingShipAttributes variable
            callback: the function to execute and pass sectionAggregate to
            sectionAggregate: Array of objects containing the information on each repeating item
        */
        getID = function(cloneRepAttr,callback,sectionAggregate){
            var currSection=cloneRepAttr.shift();
            sectionAggregate = sectionAggregate || [];
            getSectionIDs('repeating_'+currSection.section,(itemIDArr)=>{
                sectionAggregate.push({
                    section:currSection.section,
                    id:itemIDArr,
                    fields:currSection.fields
                });
                if(_.isEmpty(cloneRepAttr)){
                    callback(sectionAggregate);
                }else{
                    getID(cloneRepAttr,callback,sectionAggregate);
                }
            });
        },
        
        //Function that acts as a traffic switch to determine how to react to many of the attribute changes.
        //This function needs some serious clean up which was on my to do list for the next version release once I had the release bugs handled.
        accessStarfinder = function (event){
            TAS.log(`accessStarfinder for: ${JSON.stringify(event)}`);
            var attribute = event.sourceAttribute,
                repeatSec = event.sourceAttribute.match(/repeating_([^_]+)/) ? event.sourceAttribute.match(/repeating_([^_]+)/)[1] : false,
                cloneRepAttr = JSON.parse(JSON.stringify(repeatingAttributes)),
                currSection,trigger,
                attributes=[],
                bonuses,
                setObj={},
                useID = (sectionAggregate) => {
                    _.each(sectionAggregate,(section)=>{
                        _.each(section.id,(sid)=>{
                            _.each(section.fields,(f)=>{
                                attributes.push('repeating_'+section.section+'_'+sid+'_'+f);
                            });
                        });
                    });
                    attributes = attributes.concat(sheetAttributes);
                    getAttrs(attributes,(objs)=>{
                        if(attribute.match(/^(?:rp|hp|sp|temp_hp)$/)){
                            healthHandler(objs,event);
                        }else{
                            if(attribute.match(/frequency/)){
                                setObj[event.sourceAttribute.replace(/frequency/,'toggle_freq_dependency')]=objs[event.sourceAttribute];
                                setObj[event.sourceAttribute.replace(/frequency/,'usage_freq_dependency')]=objs[event.sourceAttribute];
                                setObj[event.sourceAttribute.replace(/frequency/,'uses_freq_dependency')]=objs[event.sourceAttribute];
                            }else if(attribute==='sheet_type'){
                                setObj.sheet_type_nav=event.newValue;
                                if(event.newValue==='npc'){
                                    setObj.whisper_state='/w gm ';
                                    setObj.npc_init='+@{initiative_npc}';
                                }else{
                                    setObj.whisper_state='';
                                    setObj.npc_init='';
                                }
                            }else if (attribute==='drone'){
                                setObj=classLevelHandler(objs);
                            }else if(/_item_[^_]+_type|_attack_[^_]+_category|(?:armor|melee|longarm|arm|weapon|grenade|sniper)_proficiency/.test(attribute)){
                                setObj = setProficiency(attribute,objs);
                            }else if(/asleep|blinded|cowering|dazzled|deafened|encumbered|entangled|exhausted|fascinated|fatigued|flat_footed|frightened|grappled|helpless|negative_levels|off_kilter|off_target|overburdened|panicked|paralyzed|pinned|prone|shaken|sickened|unconscious|stunned|_condition_/.test(attribute)){
                                setObj=expandConditions(attribute,objs,setObj,event);
                            }else{
                                setObj = attribute.match(/class_\d/) ? classHandler(objs,attribute) : attribute.match(/repeating_ability|repeating_spell/) ? abilityHandler(objs,attribute) : {};
                            }
                            if(setObj){
                                _.each(_.keys(setObj),(key)=>{
                                    objs[key]=_.clone(setObj[key]);
                                });
                                bonuses=parseBuffs(objs);
                                bonuses = assignConditions(objs,bonuses);
                                TAS.log(`bonuses: ${JSON.stringify(bonuses)}`);
                                if(event.removedInfo){
                                    _.each(_.keys(event.removedInfo),(key)=>{
                                        if(/_mods$/.test(key)){
                                            event.newValue=event.removedInfo[key];
                                            event.sourceAttribute=key;
                                            attribute=key;
                                        }
                                    });
                                }
                                trigger = assembleTrigger(attribute,objs,event);
                                TAS.log(`trigger: ${JSON.stringify(trigger)}`)
                                if(!/remove/.test(event.triggerName)){
                                    attribute.replace(/repeating_(?:attack|spell|ability|item)_([^_]+)_/,(match,id)=>{
                                        if(!/^\-/.test(objs[match+'id'])){
                                            setObj[match+'id']=id;
                                        }
                                    });
                                }
                                applyBuffs(objs,trigger,bonuses,setObj);
                            }
                        }
                    });
                };
            if(attribute.match(/show_options/)){
                return;
            }
            //Handles changes to the display state of the sheet. This ensures that the change to the attribute propagates to all instances of it
            if(attribute==='tab_select'){
                if(event.newValue==='options'){
                    setObj.npcship_toggle='settings';
                }else if(event.newValue==='npc'){
                    setObj.npcship_toggle='npc';
                }else if(event.newValue==='ship'){
                    setObj.npcship_toggle='ship';
                }else{
                    setObj.npcship_toggle='pc';
                    setObj.tab=event.newValue;
                }
                setAttrs(setObj,{silent:true});
            //as with the tab_select, but for the section tabs within a repeating element
            }else if(attribute.match(/(?:save|attack|mods|damage)_checkbox/)){
                getAttrs([event.sourceAttribute],(objs)=>{
                    setObj[event.sourceAttribute]=objs[event.sourceAttribute];
                    setAttrs(setObj,{silent:true});
                });
            //Handles clicking of the change checkboxes for creation of various repeating elements to have them default to the appropriate stats.
            }else if(attribute.match(/create/)){
                let createSwitch = {
                   'cantrip':{section:'_spell_',attrs:['_level','_filter'],values:[0,'cantrip']},
                   '1st':{section:'_spell_',attrs:['_level','_filter'],values:[1,1]},
                   '2nd':{section:'_spell_',attrs:['_level','_filter'],values:[2,2]},
                   '3rd':{section:'_spell_',attrs:['_level','_filter'],values:[3,3]},
                   '4th':{section:'_spell_',attrs:['_level','_filter'],values:[4,4]},
                   '5th':{section:'_spell_',attrs:['_level','_filter'],values:[5,5]},
                   '6th':{section:'_spell_',attrs:['_level','_filter'],values:[6,6]},
                   '7th':{section:'_spell_',attrs:['_level','_filter'],values:[7,7]},
                   '8th':{section:'_spell_',attrs:['_level','_filter'],values:[8,8]},
                   '9th':{section:'_spell_',attrs:['_level','_filter'],values:[9,9]},
                   'npcmelee':{section:'_attack_',attrs:['_engagement_range','_range_filter','_ability','_damage_ability','_proficiency'],values:['melee','melee','@{strength_mod}','@{strength_mod}','specialized']},
                   'npcranged':{section:'_attack_',attrs:['_engagement_range','_range_filter','_ability','_proficiency'],values:['ranged','ranged','@{dexterity_mod}','specialized']},
                   'forward':{section:'_attack_',attrs:['_arc','_arc_status'],values:['forward','@{forward_weapons_status}']},
                   'port':{section:'_attack_',attrs:['_arc','_arc_status'],values:['port','@{port_weapons_status}']},
                   'aft':{section:'_attack_',attrs:['_arc','_arc_status'],values:['aft','@{aft_weapons_status}']},
                   'starboard':{section:'_attack_',attrs:['_arc','_arc_status'],values:['starboard','@{starboard_weapons_status}']},
                   'turret':{section:'_attack_',attrs:['_arc','_arc_status'],values:['turret','?{'+getTranslationByKey('which-arc')+'|'+getTranslationByKey('forward')+',@{forward_weapons_status}'+'|'+getTranslationByKey('port')+',@{starboard_weapons_status}'+'|'+getTranslationByKey('aft')+',@{aft_weapons_status}'+'|'+getTranslationByKey('starboard')+',@{starboard_weapons_status}}']},
                   'system':{section:'_system_',attrs:['_type'],values:['system']},
                   'expansion':{section:'_system_',attrs:['_type','_purpose'],values:['expansion','expansion-bay']},
                };
                let createTarget=createSwitch[attribute.replace(/create_/,'')];
                let rowID = generateRowID();
                _.each(_.range(createTarget.attrs.length),(n)=>{
                    setObj['repeating'+createTarget.section+rowID+createTarget.attrs[n]]=createTarget.values[n];
                    setObj['repeating'+createTarget.section+rowID+'_id']=rowID;
                });
                setObj[attribute]=0;
                setAttrs(setObj,{silent:true},()=>{
                    setObj={};
                    getID(cloneRepAttr,useID);
                });
            //Accesses the crew handling functions
            }else if(attribute.match(/^(?:captain|engineer|pilot|science_officer|speed|maneuverability)$/)){
                if(attribute.match(/speed|maneuverability/)){
                    getAttrs(['pilot'],(p)=>{
                        event.newValue = p.pilot;
                        attribute = 'pilot';
                        shipCrewHandler(event,attribute);
                    });
                }else{
                    shipCrewHandler(event,attribute);
                }
            //accesses the gunner handling function
            }else if(attribute.match(/gunner/)){
                shipGunnerHandler();
            }else{
                getID(cloneRepAttr,useID);
            }
        },
        
        updatePilot = function(){
            getAttrs(['pilot','ship_piloting_ranks','ac_armor','tl_countermeasures'],(attributes)=>{
                const setObj = {
                    ship_piloting_ranks:pilotingRanks[attributes.pilot.replace(/\s+/,'_').toLowerCase()]||attributes.ship_piloting_ranks*1||0,
                    update_pilot_ranks:0,
                    ac:10+(pilotingRanks[attributes.pilot.replace(/\s+/,'_').toLowerCase()]*1||attributes.ship_piloting_ranks*1||0)+(attributes.ac_armor*1||0),
                    tl:10+(pilotingRanks[attributes.pilot.replace(/\s+/,'_').toLowerCase()]*1||attributes.ship_piloting_ranks*1||0)+(attributes.tl_countermeasures*1||0),
                };
                setAttrs(setObj,{silent:true});
            });
        },
        
        expandConditions = function(attribute,attributes,setObj,event){
            const propagatingConditions = {
                    asleep:{triggers:['helpless'],triggeredBy:[]},
                    blinded:{triggers:['flat_footed'],triggeredBy:[]},
                    confused:{triggers:[],triggeredBy:['wisdom_track4']},
                    cowering:{triggers:['flat_footed'],triggeredBy:[]},
                    dazed:{triggers:[],triggeredBy:[]},
                    dazzled:{triggers:[],triggeredBy:[]},
                    dead:{triggers:[],triggeredBy:['physical_track8','mental_track8','dexterity_track6','strength_track6','constitution_track6','intelligence_track6','wisdom_track6','charisma_track6']},
                    deafened:{triggers:[],triggeredBy:[]},
                    dying:{triggers:[],triggeredBy:[]},
                    entangled:{triggers:[],triggeredBy:[]},
                    exhausted:{triggers:[],triggeredBy:['physical_track4'],replaces:['fatigued']},
                    fascinated:{triggers:[],triggeredBy:[]},
                    fatigued:{triggers:[],triggeredBy:['physical_track3']},
                    flat_footed:{triggers:[],triggeredBy:['off_kilter','blinded','pinned','stunned','mental_track4']},
                    frightened:{triggers:[],triggeredBy:[]},
                    grappled:{triggers:[],triggeredBy:[]},
                    helpless:{triggers:[],triggeredBy:['asleep','unconscious','dexterity_track5','strength_track5']},
                    nauseated:{triggers:[],triggeredBy:[]},
                    negative_levels:{triggers:[],triggeredBy:[]},
                    off_kilter:{triggers:['flat_footed'],triggeredBy:[]},
                    off_target:{triggers:[],triggeredBy:[]},
                    panicked:{triggers:[],triggeredBy:[]},
                    paralyzed:{triggers:[],triggeredBy:[]},
                    pinned:{triggers:['flat_footed'],triggeredBy:[]},
                    prone:{triggers:[],triggeredBy:[]},
                    shaken:{triggers:[],triggeredBy:[]},
                    sickened:{triggers:[],triggeredBy:['physical_track3']},
                    stable:{triggers:[],triggeredBy:[]},
                    staggered:{triggers:[],triggeredBy:['dexterity_track4','strength_track4']},
                    stunned:{triggers:['flat_footed'],triggeredBy:[]},
                    unconscious:{triggers:['helpless'],triggeredBy:['physical_track7','mental_track7','constitution_track5','intelligence_track5','wisdom_track5','charisma_track5']},
                    
                    physical_trackhealthy:{triggers:[],triggeredBy:[]},//healthy
                    physical_tracklatent:{triggers:[],triggeredBy:[]},
                    physical_trackweakened:{triggers:['sickened','fatigued'],triggeredBy:[]},
                    physical_trackimpaired:{triggers:['exhausted'],triggeredBy:[]},
                    physical_trackdebilitated:{triggers:[],triggeredBy:[]},
                    physical_trackbedridden:{triggers:[],triggeredBy:[]},
                    physical_trackcomatose:{triggers:['unconscious'],triggeredBy:[]},
                    physical_trackdead:{triggers:['dead'],triggeredBy:[]},
                    
                    mental_trackhealthy:{triggers:[],triggeredBy:[]},
                    mental_tracklatent:{triggers:[],triggeredBy:[]},
                    mental_trackweakened:{triggers:[],triggeredBy:[]},
                    mental_trackimpaired:{triggers:['flat_footed'],triggeredBy:[]},
                    mental_trackbefuddled:{triggers:[],triggeredBy:[]},
                    mental_trackdisassociated:{triggers:[],triggeredBy:[]},
                    mental_trackcomatose:{triggers:['unconscious'],triggeredBy:[]},
                    mental_trackdead:{triggers:['dead'],triggeredBy:[]},
                    
                    strength_trackhealthy:{triggers:[],triggeredBy:[]},
                    strength_trackweakened:{triggers:[],triggeredBy:[]},
                    strength_trackimpaired:{triggers:[],triggeredBy:[]},
                    strength_trackstaggered:{triggers:['staggered'],triggeredBy:[]},
                    strength_trackimmobile:{triggers:['helpless'],triggeredBy:[]},
                    strength_trackdead:{triggers:['dead'],triggeredBy:[]},
    
                    dexterity_trackhealthy:{triggers:[],triggeredBy:[]},
                    dexterity_tracksluggish:{triggers:[],triggeredBy:[]},
                    dexterity_trackstiffened:{triggers:[],triggeredBy:[]},
                    dexterity_trackstaggered:{triggers:['staggered'],triggeredBy:[]},
                    dexterity_trackimmobile:{triggers:['helpless'],triggeredBy:[]},
                    dexterity_trackdead:{triggers:['dead'],triggeredBy:[]},
    
                    constitution_trackhealthy:{triggers:[],triggeredBy:[]},
                    constitution_trackweakened:{triggers:[],triggeredBy:[]},
                    constitution_trackimpaired:{triggers:[],triggeredBy:[]},
                    constitution_trackdebilitated:{triggers:[],triggeredBy:[]},
                    constitution_trackunconscious:{triggers:['unconscious'],triggeredBy:[]},
                    constitution_trackdead:{triggers:['dead'],triggeredBy:[]},
    
                    intelligence_trackhealthy:{triggers:[],triggeredBy:[]},
                    intelligence_trackweakend:{triggers:[],triggeredBy:[]},
                    intelligence_trackimpaired:{triggers:[],triggeredBy:[]},
                    intelligence_trackanimalistic:{triggers:[],triggeredBy:[]},
                    intelligence_trackcomatose:{triggers:['unconscious'],triggeredBy:[]},
                    intelligence_trackdead:{triggers:['dead'],triggeredBy:[]},
    
                    wisdom_trackhealthy:{triggers:[],triggeredBy:[]},
                    wisdom_trackweakened:{triggers:[],triggeredBy:[]},
                    wisdom_trackimpaired:{triggers:[],triggeredBy:[]},
                    wisdom_trackconfused:{triggers:['confused'],triggeredBy:[]},
                    wisdom_trackcomatose:{triggers:['unconscious'],triggeredBy:[]},
                    wisdom_trackdead:{triggers:['dead'],triggeredBy:[]},
    
                    charisma_trackhealthy:{triggers:[],triggeredBy:[]},//healthy
                    charisma_trackweakened:{triggers:[],triggeredBy:[]},
                    charisma_trackimpaired:{triggers:[],triggeredBy:[]},
                    charisma_trackpliable:{triggers:[],triggeredBy:[]},
                    charisma_trackcatatonic:{triggers:['unconscious'],triggeredBy:[]},
                    charisma_trackdead:{triggers:['dead'],triggeredBy:[]},
                },
                trackStatusConverter = {
                    physical_track:{numConvert:["healthy","latent","weakened","impaired","debilitated","bedridden","comatose","dead"],statusConvert:{"healthy":1,"latent":2,"weakened":3,"impaired":4,"debilitated":5,"bedridden":6,"comatose":7,"dead":8}},
                    mental_track:{numConvert:["healthy","latent","weakened","impaired","befuddled","disassociated","comatose","dead"],statusConvert:{"healthy":1,"latent":2,"weakened":3,"impaired":4,"befuddled":5,"disassociated":6,"comatose":7,"dead":8}},
                    strength_track:{numConvert:["healthy","weakened","impaired","staggered","immobile","dead","",""],statusConvert:{"healthy":1,"weakened":2,"impaired":3,"staggered":4,"immobile":5,"dead":6}},
                    dexterity_track:{numConvert:["healthy","sluggish","stiffened","staggered","immobile","dead","",""],statusConvert:{"healthy":1,"sluggish":2,"stiffened":3,"staggered":4,"immobile":5,"dead":6}},
                    constitution_track:{numConvert:["healthy","weakened","impaired","debilitated","unconscious","dead","",""],statusConvert:{"healthy":1,"weakened":2,"impaired":3,"debilitated":4,"unconscious":5,"dead":6}},
                    intelligence_track:{numConvert:["healthy","weakend","impaired","animalistic","comatose","dead","",""],statusConvert:{"healthy":1,"weakend":2,"impaired":3,"animalistic":4,"comatose":5,"dead":6}},
                    wisdom_track:{numConvert:["healthy","weakened","impaired","confused","comatose","dead","",""],statusConvert:{"healthy":1,"weakened":2,"impaired":3,"confused":4,"comatose":5,"dead":6}},
                    charisma_track:{numConvert:["healthy","weakened","impaired","pliable","catatonic","dead","",""],statusConvert:{"healthy":1,"weakened":2,"impaired":3,"pliable":4,"catatonic":5,"dead":6}}
                },
                finalConditions=[],
                toSet = [];
            let additionalChecks = [],
                trackState = '',
                value;
                
            if(/_condition_/.test(attribute)){
                let track = attributes[attribute.replace(/_status/,'')];
                if(/_track_status$/.test(attribute)){
                    trackState = _.max([trackStatusConverter[track].statusConvert[event.newValue],trackStatusConverter[track].statusConvert[event.previousValue],1]);
                }else if(/_track$/.test(attribute)){
                    trackState = trackStatusConverter[track].statusConvert[attributes[attribute+'_status']];
                }
                _.each(_.range(trackState),(r)=>{
                    let status = trackStatusConverter[track].numConvert[r];
                    additionalChecks = additionalChecks.concat(propagatingConditions[track+status].triggers);
                });
            }else{
                additionalChecks = additionalChecks.concat(propagatingConditions[attribute].triggers);
            }
            while(additionalChecks.length){
                let condition = additionalChecks.shift(),
                    tempObj={};
                    
                value='';
                _.each(propagatingConditions[condition].triggers,(triggered)=>{
                    if(!_.contains(additionalChecks.concat(toSet),triggered)){
                        additionalChecks.push(triggered);
                    }
                });
                toSet.push(condition);
            }
            if(/_track_status$/.test(attribute) && event.newValue*1 > event.previousValue*1){
                _.each(toSet,(ts)=>{
                    if(!setObj[ts]){
                        setObj[ts]=1;
                        attributes[ts]=1;
                    }
                    if(propagatingConditions[ts]){
                        if(propagatingConditions[ts].replaces){
                            setObj[propagatingConditions[ts].replaces]='0';
                            attributes[propagatingConditions[ts].replaces]='0';
                        }
                    }
                });
            }else{
                const afflictionIDs = _.chain(_.keys(attributes))
                        .filter((attr)=>{return /_condition_[^_]+_track$/.test(attr)})
                        .map((attr)=>{
                            return attr.replace(/track/,'');
                        })
                        .value();
                _.each(toSet,(ts)=>{
                    if(_.every(propagatingConditions[ts].triggeredBy,(triggeredBy)=>{
                        let value,
                            check = triggeredBy.replace(/([a-z_]+)(\d*)/i,(match,p1,p2)=>{
                                value = p2*1||1;
                                return p1;
                            });
                        if(/_track/.test(check)){
                            return _.every(afflictionIDs,(rowID)=>{
                                return attributes[rowID+'track']!==check || trackStatusConverter[attributes[rowID+'track']].statusConvert[attributes[rowID+'track_status']] < value;
                            });
                        }else{
                            return attributes[check]*1 < value;
                        }
                    })){
                        setObj[ts]=0;
                        attributes[ts]=0;
                    }else{
                        setObj[ts]=1;
                        attributes[ts]=1;
                    }
                });
            }
            return setObj;
        },
        
        assembleTrigger = function(attribute,objs,origEvent){
            let trigger=[];
            attribute = attribute.replace(/(repeating_[^_]+_[^_]+_.*?)(?:frequency|toggle)$/,(match,p1)=>{
                origEvent.newValue = objs[p1+'mods'];
                origEvent.previousValue = undefined;
                return p1+'mods';
            });
            if(/_(?:equipped|mods)$/.test(attribute)){
                let event={};
                if(/_equipped$/.test(attribute)){
                    trigger.push(attribute);
                    attribute.replace(/(repeating_item_[^_]+_).+/,(match,p1)=>{
                        event.newValue = objs[p1+'mods'];
                    });
                }else{
                    event = origEvent;
                }
                const repeatAttrs = {
                    total:['attack'],
                    damage_total:['attack','ability','spell'],
                    dc:['ability','spell'],
                    attack_total:['ability','spell'],
                    profession:['profession'],
                    attack:['attack','ability','spell'],
                    damage:['attack','ability','spell'],
                    spell_penetration:['ability','spell']
                },
                repeatAbilities = {
                    total:['ability'],
                    damage_total:['damage_ability'],
                    dc:['save_ability'],
                    attack_total:['attack_ability'],
                    profession:['ability'],
                    attack:['ability','attack_ability'],
                    damage:['damage_ability'],
                    spell_penetration:['spell_resistance']
                };
                TAS.log(`event: ${JSON.stringify(event)}`);
                _.each([event.previousValue,event.newValue],(value)=>{
                    if(value){
                        value=value.replace(/category:heavy(?:_|\s+)weapons?/,'heavy');
                        value.replace(/(?:\s+([a-z\s]+))?(?:\s+to\s+)(.+)/gmi,(match,p1,seg2)=>{
                            _.each(seg2.split(/\s+and\s+/g),(target)=>{
                                target.replace(/(.+?(?=\||$))(?:\|(.+))?/,(m,p2,p3)=>{
                                    if(repeatAttrs[p2.trim().replace(/\s+/g,'_').toLowerCase()]){
                                        TAS.log(`m: ${m} | p2: ${p2.replace(/\s+/g,'_')} | p3: ${p3} | repeatAttrs[${p2.replace(/\s+/g,'_')}]: ${JSON.stringify(repeatAttrs[p2.replace(/\s+/g,'_')])}`);
                                        const objKeys = _.keys(objs);
                                        _.each(repeatAttrs[p2.replace(/\s+/g,'_')],(sct)=>{
                                            const sctKeys = _.filter(objKeys,(key)=>{return new RegExp('repeating_'+sct+'_[^_]+_(?:'+repeatAbilities[p2.replace(/\s+/g,'_')].join('|')+')').test(key)});
                                            TAS.log(`sctKeys: ${JSON.stringify(sctKeys)}`);
                                            _.each(sctKeys,(attrName)=>{
                                                let filtered = true;
                                                let id = attrName.match(/repeating_[^_]+_[^_]+_/)[0];
                                                TAS.log(`id: ${id}`);
                                                try{
                                                    p3.replace(/([^:,]+):([^,]+)/g,(expr,filterAttr,filterValue)=>{
                                                        if(/section/i.test(filterAttr)){
                                                            filtered = sct===filterValue.toLowerCase();
                                                        }else{
                                                            filtered = (objs[id+filterAttr.replace(/\s+/g,'_')]+'').toLowerCase()===filterValue.toLowerCase();
                                                        }
                                                        if(!filtered){
                                                            undefinedToBreak;
                                                        }
                                                    });
                                                }catch(err){
                                                    //breaks the replace loop
                                                }
                                                if(filtered){
                                                    trigger.push(attrName.trim().toLowerCase());
                                                }
                                            });
                                        });
                                    }else{
                                        p2=p2.trim().replace(/\s+/g,'_');
                                        TAS.log(`p1: ${p1} | p2: ${p2} | ${/armor/i.test(p1)} && ${/^(?:eac|kac)$/i.test(p2)}`);
                                        if(/armor/i.test(p1) && /^(?:eac|kac)$/i.test(p2)){
                                            TAS.log(`p1: ${p1}`);
                                            trigger.push(p2+'_armor_buff');
                                        }else if(/armor/i.test(p1) && /^(?:ac|armor)$/i.test(p2)){
                                            trigger = trigger.concat(['eac_armor_buff','kac_armor_buff']);
                                        }else if(/caster_level/i.test(p2)){
                                            trigger.push('caster_level_buff');
                                        }else if(/acp/i.test(p2)){
                                            let skillArray = ['acrobatics','athletics','bluff','computers','culture','diplomacy','disguise','engineering','intimidate','life_science','medicine','mysticism','perception','physical_science','piloting','sense_motive','sleight_of_hand','stealth','survival'];
                                            _.each(_.keys(objs),(a)=>{
                                                if(/repeating_profession_[^_]+_profession/.test(a)){
                                                    skillArray.push(a.match(/repeating_profession_[^_]+/)[0]);
                                                }
                                            });
                                            _.each(skillArray,(skill)=>{
                                                if(objs[skill+'_acp']*1===1){
                                                    trigger.push(skill+'_ranks');
                                                }
                                            });
                                        }else{
                                            trigger.push((p2.replace(/_max/,'')+'_buff').toLowerCase());
                                        }
                                    }
                                });
                            });
                        });
                    }
                });
            }else{
                trigger.push(attribute.toLowerCase());
            }
            TAS.log(`trigger: ${JSON.stringify(trigger)}`);
            return _.unique(trigger);
        },
        
        setProficiency = function(attribute,attributes){
            const setObj = {};
            let sectionAttr;
            if(/repeating/.test(attribute)){
                const profItem = attributes[attribute]+'_proficiency';
                sectionAttr = attribute.replace(/(repeating_[^_]+_[^_]+_).+/i,'$1proficiency');
                setObj[sectionAttr]=attributes[profItem];
                attributes[sectionAttr]=setObj[sectionAttr];
            }else{
                const profArray = _.filter(_.keys(attributes),(a)=>{
                    if(/(?:melee|arm|weapon|grenade|sniper)/.test(attribute) && /repeating_attack_[^_]+_category/.test(a) && attributes[a]===attribute.replace(/_proficiency/,'')){
                        return true;
                    }else if(/armor/.test(attribute) && /repeating_item_[^_]+_purpose/.test(a) && attributes[a]==='armor' && attributes[a.replace(/purpose/,'type')]===attribute.replace(/_proficiency/,'')){
                        return true;
                    }
                    return false;
                });
                _.each(profArray,(a)=>{
                    sectionAttr = a.replace(/(repeating_[^_]+_[^_]+_).+/i,'$1proficiency');
                    setObj[sectionAttr]=attributes[attribute];
                    attributes[sectionAttr]=attributes[attribute];
                });
            }
            return setObj;
        },
        
        //Sets the current total sheilds to be equal to the total of the four arcs' shields
        shieldHandler = function(event){
            var shields = 0,
                setObj={};
                
            getAttrs(['forward_shields','port_shields','aft_shields','starboard_shields'],(shields)=>{
                setObj.shield_total = _.reduce(shields,(memo,s)=>{
                    return memo+=s*1||0;
                },0);
                setAttrs(setObj,{silent:true});
            });
        },
        
        //Handles changes to the repeating_system items. Affects the computers bonus of the ship, armor, Defensive countermeasures, shields, and power
        shipSystemHandler = function(sections){
            var attributes = ['size','ship_piloting_ranks','ship_computer'],
                setObj = {},
                ids=[],
                pcu=0,
                pcu_max=0,
                bp=0,
                shield_total=0,
                armor=0,
                countermeasure=0,
                computerMatch,
                computerQuery='',
                computer='',
                newComp,
                sensor=0,
                sizeSwitch = {
                    'tiny':2,
                    'small':1,
                    'medium':0,
                    'large':-1,
                    'huge':-2,
                    'gargantuan':-4,
                    'colossal':-8
                };
            _.each(sections,(section)=>{
                _.each(section.id,(sid)=>{
                    ids.push('repeating_'+section.section+'_'+sid);
                    _.each(section.fields,(f)=>{
                        attributes.push('repeating_'+section.section+'_'+sid+'_'+f);
                    });
                });
            });
            getAttrs(attributes,(resources)=>{
                _.each(ids,(i)=>{
                    bp+=resources[i+'_bp']*1||0;
                    if(i.match(/attack/)){
                        if(resources[i+'_powered']==='ON'){
                            pcu+=resources[i+'_pcu']*1||0;
                        }
                    }else if(i.match(/system/)){
                        if(resources[i+'_powered']==='ON'){
                            armor+=resources[i+'_armor']*1||0;
                            countermeasure+=resources[i+'_countermeasure']*1||0;
                            shield_total+=resources[i+'_shields']*1||0;
                            if(resources[i+'_comp_bonus'].length>1){
                                let origComp=newComp*1||0;
                                resources[i+'_comp_bonus'].replace(/\d+/,(match)=>{
                                    newComp = match*1||0;
                                });
                                if(newComp*1 > origComp){
                                    computer = resources[i+'_comp_bonus'];
                                }
                            }
                            if(resources[i+'_sensor_bonus'].length>0){
                                sensor=Math.max(sensor,(resources[i+'_sensor_bonus'].replace(/\+|\s+/g,'')*1||0));
                            }
                            if(resources[i+'_purpose']==='power-core'){
                                pcu_max+=resources[i+'_pcu']*1||0;
                            }else{
                                pcu+=resources[i+'_pcu']*1||0;
                            }
                        }
                    }
                });
                computerMatch=computer.replace(/\+\s*\d+/,(match)=>{
                    computerQuery = '?{'+getTranslationByKey('use-computer')+'|'+getTranslationByKey('no')+', |'+getTranslationByKey('yes')+','+match+'}';
                });
                armor+=sizeSwitch[resources.size]*1||0;
                countermeasure+=sizeSwitch[resources.size]*1||0;
                setObj={
                    ship_pcu_max:pcu_max,
                    ship_pcu:pcu,
                    ship_computer:computer,
                    computer_query:computerQuery,
                    shield_total_max:shield_total,
                    ac_armor:armor,
                    ship_bp:bp,
                    ship_sensors:sensor,
                    tl_countermeasures:countermeasure,
                    ac:(resources.ship_piloting_ranks*1||0)+armor + 10,
                    tl:(resources.ship_piloting_ranks*1||0)+countermeasure + 10
                };
                setAttrs(setObj,{silent:true});
            });
        },
        
        //Handles the changes to the crew attributes (except for gunner), and creates the menus, or skill rolls necessary for that position
        shipCrewHandler = function(event,attribute){
            var people=event.newValue.split(/\s*,\s*/),
                maneuverSwitch = {
                    'clumsy':'-2',
                    'poor':'-1',
                    'average':'',
                    'good':'+1',
                    'perfect':'+2'
                },
                speedMod = (speed) => {
                    switch(speed){
                        case 1:
                        case 2:
                        case 3:
                        case 4:
                            return '+2';
                            break;
                        case 5:
                        case 6:
                        case 7:
                            return '+1';
                            break;
                        case 8:
                        case 9:
                        case 10:
                            return '';
                            break;
                        case 11:
                        case 12:
                            return '-1';
                            break;
                        default:
                            return '-2';
                            break;
                    }
                },
                crewSwitch = {
                   'engineer':(name,shipName)=>'@{'+name+'|engineering_ranks}[RNK]+[[({0,@{'+name+'|engineering_ranks}}>1) * @{'+name+'|engineering_class_skill}]][CS]+@{'+name+'|engineering_ability}[ABI]@{'+name+'|engineering_misc}',
                   'pilot':(name,shipName,size,maneuver)=>'@{'+name+'|piloting_ranks}[RNK]+[[({0,@{'+name+'|piloting_ranks}}>1) * @{'+name+'|piloting_class_skill}]][CS]+@{'+name+'|piloting_ability}[ABI]'+speedMod(size*1||1)+maneuverSwitch[maneuver]+'@{'+name+'|piloting_misc}@{'+shipName+'|engines_status}@{'+shipName+'|power_core_status}',
                   'science_officer':(name,shipName)=>'@{'+name+'|computers_ranks}[RNK]+[[({0,@{'+name+'|computers_ranks}}>1) * @{'+name+'|computers_class_skill}]][CS]+@{'+name+'|computers_ability}[ABI]@{'+name+'|computers_misc}+@{ship_sensors}[sensors]@{'+shipName+'|sensors_status}@{'+shipName+'|power_core_status}',
                },
                npcCrewSwitch = {
                   'engineer':(name)=>'',
                   'pilot':(name)=>'@{'+name+'|engines_status}',
                   'science_officer':(name)=>'@{'+name+'|sensors_status}',
                   'captain':(name)=>'@{'+name+'|life_support_status}'
                },
                query='{{title='+getTranslationByKey(attribute.replace(/_/g,'-')+'-query')+'}} {{buttons0=',
                matcher='',
                setObj={},
                shipSpeed,shipManeuver,values;
            people=_.map(people,(p)=>{
                let retValue = {};
                retValue.bonus = p.match(/[+\-]\s*\d+/);
                if(retValue.bonus){
                    retValue.bonus = retValue.bonus[0];
                    p=p.replace(retValue.bonus,'');
                }
                retValue.actor = p.trim();
                return retValue;
            });
            getAttrs(['character_name','speed','maneuverability'],(name)=>{
                shipSpeed = name.speed;
                shipManeuver = name.maneuverability;
                name=name.character_name;
                _.each(people,(p)=>{
                    if(p.bonus){
                        if(people.length>1){
                            query+=(query.match(/=$/) ?'' :' |')+'['+p.actor.trim()+'](!/&#13;'+HE('@{'+name+'|whisper_state}&{template:sf_generic} {{name=@{'+name+'|character_name}}} {{characterid=@{'+name+'|character_id}}} {{title=^{'+attribute.replace(/_/g,'-')+'}}} {{r1=[[1d20'+p.bonus+npcCrewSwitch[attribute](name)+'@{'+name+'|power_core_status}@{'+name+'|computer_query}'+(attribute==='pilot' ?'?{'+getTranslationByKey('helm-check')+'|'+getTranslationByKey('no')+', |'+getTranslationByKey('yes')+',&{tracker'+HE('}')+'}' :'')+']]}} {{r1name='+p.actor.trim()+'}}')+')';
                        }else{
                            query=' {{title=^{'+attribute.replace(/_/g,'-')+'}}} {{r1=[[1d20'+p.bonus+npcCrewSwitch[attribute](name)+'@{power_core_status}@{'+name+'|computer_query}'+(attribute==='pilot' ?'?{'+getTranslationByKey('helm-check')+'|'+getTranslationByKey('no')+', |'+getTranslationByKey('yes')+',&{tracker'+HE('}')+'}' :'')+']]}} {{r1name='+p.actor;
                        }
                    }else{
                        if(people.length>1 && attribute!=='captain'){
                            query+=(query.match(/=$/) ?'' :' |')+'['+p.actor.trim()+'](!/&#13;'+HE('@{'+name+'|whisper_state}&{template:sf_generic} {{name=@{'+name+'|character_name}}} {{characterid=@{'+name+'|character_id}}} {{title=^{'+attribute.replace(/_/g,'-')+'}}} {{r1=[[1d20+'+crewSwitch[attribute](p.actor.trim(),name,shipSpeed,shipManeuver)+'@{'+name+'|power_core_status}@{'+name+'|computer_query}'+(attribute==='pilot' ?'?{'+getTranslationByKey('helm-check')+'|'+getTranslationByKey('no')+', |'+getTranslationByKey('yes')+',&{tracker'+HE('}')+'}' :'')+']]}} {{r1name='+p.actor+'}}')+')';
                        }else if(people.length===1 && attribute==='captain'){
                            _.each(skillList,(s)=>{
                                if(s!=='profession'){
                                    query+=(query.match(/=$/) ?'' :' |')+'[^{'+s.toLowerCase().replace(/_/g,'-')+'}](!/&#13;'+HE('@{'+name+'|whisper_state}&{template:sf_generic} {{name=@{'+name+'|character_name}}} {{characterid=@{'+name+'|character_id}}} {{title=^{'+s.toLowerCase().replace(/_/g,'-')+'}}} {{r1=[[1d20+@{'+p.actor.trim()+'|'+s+'_ranks}+'+'@{'+p.actor.trim()+'|'+s+'_ability}@{'+p.actor.trim()+'|'+s+'_misc}@{'+name+'|power_core_status}@{'+name+'|computer_query}]]}} {{r1name='+p.actor+'}}')+')';
                                }
                            });
                        }else if(people.length===1){
                            query=' {{title=^{'+attribute.replace(/_/g,'-')+'}}} {{r1=[[1d20+'+crewSwitch[attribute](p.actor.trim(),name,shipSpeed,shipManeuver)+'@{'+name+'|computer_query}'+(attribute==='pilot' ?'?{'+getTranslationByKey('helm-check')+'|'+getTranslationByKey('no')+', |'+getTranslationByKey('yes')+',&{tracker'+HE('}')+'}' :'')+']]}} {{r1name='+p.actor;
                        }
                    }
                });
                if(query.match(/buttons0=/)){
                    query='/w "'+name+'"&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}}'+query+'}}';
                }else{
                    query='@{'+name+'|whisper_state}&{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}}'+query+'}}';
                }
                setObj[attribute+'_bonus']=query;
                setAttrs(setObj,{silent:true});
            });
            
        },
        
        //Handles changes to the gunner attribute, sets the gunner_roll attribute which is used by all the ship attacks to calculate the attack bonus.
        shipGunnerHandler = function(){
            var setObj={},
                query='?{'+getTranslationByKey('which-gunner')+'|',
                matcher;
            getAttrs(['gunner'],(gunners)=>{
                gunners = _.map(gunners.gunner.split(/\s*,\s*/),(p)=>{
                    let retValue = {};
                    retValue.bonus = p.match(/[+\-]\s*\d+/);
                    if(retValue.bonus){
                        retValue.bonus = retValue.bonus[0];
                        p=p.replace(retValue.bonus,'');
                    }
                    retValue.actor = p.trim();
                    return retValue;
                });
                if(gunners.length>1){
                    _.each(gunners,(gun)=>{
                        query+=gun.actor+','+(gun.bonus||HE('{')+'@{'+gun.actor+'|piloting_ranks}'+HE(',')+'@{'+gun.actor+'|bab}'+HE('}')+'kh1+@{'+gun.actor+'|dexterity_mod}')+'|';
                    });
                    query+='}';
                }else{
                    query = gunners[0].bonus||'{@{'+gunners[0].actor+'|piloting_ranks},@{'+gunners[0].actor+'|bab}}kh1+@{'+gunners[0].actor+'|dexterity_mod}';
                }
                setObj.gunner_roll=query;
                setAttrs(setObj,{silent:true});
            });
        },
        
        patchHandler = function(event){
            const system = event.sourceAttribute.replace(/patch/,'status'),
                valueConvert = {
                    '+0':0,
                    '-2':1,
                    '-4':2,
                    '+1d0cf<0cs>1[wrecked]':3,
                },
                powerConvert = {
                    '+0':0,
                    ' ':1,
                    '-2':2,
                    '-4':3,
                },
                valueArray = _.keys(valueConvert),
                powerValueArray = _.keys(powerConvert),
                setObj={};
                
            getAttrs([system],(attributes)=>{
                let converted
                if(/power_core/.test(system)){
                    converted = powerConvert[attributes[system]];
                    converted = Math.min(Math.max((converted+(event.newValue*1===1 ? -1 : 1)),0),3);
                    setObj[system]=powerValueArray[converted];
                }else{
                    converted = valueConvert[attributes[system]];
                    converted = Math.min(Math.max((converted+(event.newValue*1===1 ? -1 : 1)),0),3);
                    setObj[system]=valueArray[converted];
                }
                setAttrs(setObj,{silent:true});
            });
        },
        
        //Handles changes to current health that cause the reactive styling of the health container to change.
        healthHandler = function(attributes,event){
            const setObj = _.reduce(['temp_hp','sp','hp','rp'],(memo,h)=>{
                if(attributes[h]*1<0){
                    if(h==='sp'){
                        memo.hp=attributes.hp*1 + attributes.sp*1;
                        attributes.hp=memo.hp;
                    }else if(h==='temp_hp'){
                        memo.sp=attributes.sp*1 + attributes.temp_hp*1;
                        attributes.sp=memo.sp;
                    }
                    memo[h]=0;
                    attributes[h]=memo[h];
                }
                if(h!=='temp_hp'){
                    memo.health_status+=((attributes[h]*1 <= 0 && attributes[h]*1!==attributes[h+'_max']*1) ? 1 : 0);
                }
                return memo;
            },{health_status:0});
            setAttrs(setObj,{silent:true});
            return undefined;
        },
        
        /*class attribute handling functions*/
        //Handles changes to the class specific attributes and acts as a traffic switch to determine how to handle them
        classHandler = function(attributes,attribute){
            var classVar = attribute.replace(/class_\d_/,''),
                classNum = attribute.replace(/class_(\d)_.+/,'$1'),
                varSwitch = {
                    name:classNameHandler,//Handles changes to the class's name. Attributes affected: class&name
                    level:classLevelHandler,//Handles changes to the class's level. Attributes affected: class&name, bab, saves, skill points, sp, hp
                    sp:classHealthHandler,//actually does nothing, only here to prevent errors when class attributes change
                    hp:classHealthHandler,
                    spell_progression:spell_progressionHandler,
                    bab:classBABHandler,//Handles changes to the class's bab. Attributes affected: bab
                    fort:classSaveHandler,//Handles changes to the class's save progressions. Attributes affected: saves
                    ref:classSaveHandler,//Handles changes to the class's save progressions. Attributes affected: saves
                    will:classSaveHandler,//Handles changes to the class's save progressions. Attributes affected: saves
                    spells:classSpellHandler,/*Handles changes to the class's spell attributes. Controls whether the spells sheet is accessible
                                            and what spell levels are accessible*/
                    casting_ability:classAbilityHandler,//Handles changes to what is the core ability score. Controls what abilities and spells linked to that
                                                        //class are set to base their DC off of by default.
                    ability:classAbilityHandler,//See above
                    skills:classHealthHandler
                },
                setObj;
            return varSwitch[classVar](attributes,classVar,classNum);
        },
        
        spell_progressionHandler = function(attributes){
            const convertProgress = {//object of fat arrow functions that calculates the spell level available for a class
               'half':(lvl)=>lvl >= 13 ? 4 : lvl >= 10 ? 3 : lvl >= 7 ? 2 : lvl >= 4 ? 1 : 0,
               'partial':(lvl)=> lvl >= 16 ? 6 : lvl >= 13 ? 5 : lvl >= 10 ? 4 : lvl >= 7 ? 3 : lvl >= 4 ? 2 : lvl >= 1 ? 1 : 0,
               'full_prep':(lvl)=>Math.min(Math.floor((lvl+ 1)/2),9),
               'full_spont':(lvl)=>lvl*1===1 ? 1 : Math.floor(lvl/2)
            };
            const setObj = _.reduce([1,2,3,4,5],(memo,n)=>{
                let preClass='class_'+n;
                if(attributes[preClass+'_spells']*1===1){
                    memo['caster_level']+=(attributes[preClass+'_level']*1||0);
                    memo[preClass+'_show']=1;
                    memo[preClass+'_max_spell']=convertProgress[attributes[preClass+'_spell_progression']](attributes[preClass+'_level']*1)||0;
                }else{
                    memo[preClass+'_show']=0;
                    memo[preClass+'_max_spell']=0;
                }
                memo.char_max_spell = _.max([memo.char_max_spell,memo[preClass+'_max_spell'],0]);
                return memo;
            },{caster_level:0});
            setObj.char_max_spell=_.reduce(_.range(setObj.char_max_spell + 1),(m,num)=>{
                return m+=' '+num;
            },'');
            return setObj;
        },
        
        classNameHandler = function(attributes){
            var temp,
                classNL = _.reduce([1,2,3,4,5],(memo,n)=>{
                    temp=(attributes['class_'+n+'_name']||'')+((attributes['class_'+n+'_name']&&attributes['class_'+n+'_name']!==''&&attributes['class_'+n+'_level']&&attributes['class_'+n+'_level']!=='') ? ' ' :'')+(attributes['class_'+n+'_level']||'');
                    memo+=temp.length>0 ? (memo.length>0 ?' /' :'')+temp :'';
                    return memo;
                },'');
                setAttrs({'class&level':classNL},{silent:true});
                return undefined;
        },
        
        classLevelHandler = function(attributes){
            const convertProgress = {//object of fat arrow functions that calculates the spell level available for a class
               'half':(lvl)=>lvl >= 13 ? 4 : lvl >= 10 ? 3 : lvl >= 7 ? 2 : lvl >= 4 ? 1 : 0,
               'partial':(lvl)=> lvl >= 16 ? 6 : lvl >= 13 ? 5 : lvl >= 10 ? 4 : lvl >= 7 ? 3 : lvl >= 4 ? 2 : lvl >= 1 ? 1 : 0,
               'full_prep':(lvl)=>Math.min(Math.floor((lvl+ 1)/2),9),
               'full_spont':(lvl)=>lvl*1===1 ? 1 : Math.floor(lvl/2)
            };
            var convertSave = {
                    poor:(lvl)=>attributes.drone*1===1 ? Math.round((lvl - 1)/4) : Math.floor(lvl/3),
                    good:(lvl)=> 2+ (attributes.drone*1===1 ? Math.ceil((lvl*0.75 - 1)/2) : Math.floor(lvl/2))
                },
                temp;
            const setObj = _.reduce([1,2,3,4,5],(memo,n)=>{
                let preClass='class_'+n;
                memo.character_level=(memo.character_level||0)+(attributes[preClass+'_level']*1||0);
                memo.bab+=attributes.drone*1===1 ? Math.ceil((attributes[preClass+'_level']*0.75)||0) : Math.floor(attributes[preClass+'_bab']*attributes[preClass+'_level']||0);
                temp=(attributes['class_'+n+'_name']||'')+((attributes[preClass+'_name']&&attributes[preClass+'_name']!==''&&attributes[preClass+'_level']&&attributes[preClass+'_level']!=='') ?' ' :'')+(attributes[preClass+'_level']||'');
                memo['class&level']+=temp.length>0 ? (memo['class&level'].length>0 ?' / ' :'')+temp :'';
                if(attributes[preClass+'_spells']*1===1){
                    memo['caster_level']+=(attributes[preClass+'_level']*1||0);
                    memo[preClass+'_show']=1;
                    memo[preClass+'_max_spell']=convertProgress[attributes[preClass+'_spell_progression']](attributes[preClass+'_level']*1)||0;
                }else{
                    memo[preClass+'_show']=0;
                    memo[preClass+'_max_spell']=0;
                }
                _.each(['fort','ref','will'],(save)=>{
                    memo[save+'_base']+=convertSave[attributes[preClass+'_'+save]](attributes[preClass+'_level']);
                });
                memo.char_max_spell = _.max([memo.char_max_spell,memo[preClass+'_max_spell'],0]);
                return memo;
            },{level:0,fort_base:0,ref_base:0,will_base:0,bab:0,'class&level':'',caster_level:0});
            setObj.char_max_spell=_.reduce(_.range(setObj.char_max_spell + 1),(m,num)=>{
                return m+=' '+num;
            },'');
            return setObj;
        },
        
        classHealthHandler = function(){
            return {};
        },
        
        classBABHandler = function(attributes){
            return _.reduce([1,2,3,4,5],(memo,n)=>{
                memo.bab+=Math.floor(attributes['class_'+n+'_bab']*attributes['class_'+n+'_level']||0);
                return memo;
            },{bab:0});
        },
        
        classSaveHandler = function(attributes,save){
            var convertSave = {
                    poor:(lvl)=>Math.floor(lvl/3),
                    good:(lvl)=>lvl>0 ? (Math.floor(lvl/2) + 2) : 0
                },
                memObj = {};
                
            memObj[save+'_base']=0;
            memObj = _.reduce([1,2,3,4,5],(memo,n)=>{
                memo[save+'_base']+=convertSave[attributes['class_'+n+'_'+save]](attributes['class_'+n+'_level']*1||0);
                return memo;
            },memObj);
            return memObj;
        },
        
        classAbilityHandler = function(attributes,attr,classNum){
            var preClass ='class_'+classNum,
                setObj={},
                repeatingSources = _.filter(_.keys(attributes),(a)=>{return a.match(/repeating_[^_]+_-[^_]+_source/)});
                
            if(attr==='ability'){
                setObj[preClass+'_casting_ability']=attributes[preClass+'_ability'];
            }
            return _.reduce(repeatingSources,(memo,s)=>{
                if((attributes[s]+'').toLowerCase()===(attributes[preClass+'_name']+'').toLowerCase()){
                    memo[s.replace(/source/,'save_ability')]=attributes[preClass+((attr==='casting_ability' && s.match(/spell/)) ?'_casting' :'')+'_ability'];
                }
                return memo;
            },setObj);
        },
        
        classSpellHandler = function(attributes,attr,classNum){
            var setObj = {},
                preClass ='class_'+classNum;
            _.some([1,2,3,4,5],(n)=>{
                if(attributes['class_'+n+'_spells']*1===1){
                    setObj.is_caster = 1;
                    setObj.caster_select = 1;
                    return true;
                }else{
                    setObj.is_caster=0;
                    setObj.caster_select = 0;
                }
            });
            if(attr==='spells' && attributes[preClass+'_spells']*1===1){
                setObj[preClass+'_casting_ability']=attributes[preClass+'_ability'];
            }
            return {...setObj,...spell_progressionHandler(attributes)};
        },
        
        abilityHandler = function(attributes,attr){//Handles changes to an ability or spell item. Was originally planned as a switcher function, however only one function was needed in the end
            var field = attr.replace(/repeating_(?:spell|ability)_-[^_]+_/,''),
                setObj={};
            
            switch(field){
                case'source':
                    setObj = abilitySourceHandler(attributes,attr);
                    break;
            }
            return setObj;
        },
        
        abilitySourceHandler = function(attributes,attr){//Handles when an ability's or spell's source attribute is changed to automatically set
                                                        // it's save DC ability and what class level it is based off of
            return _.reduce([1,2,3,4,5],(memo,n)=>{
                if((attributes['class_'+n+'_name']+'').toLowerCase()===(attributes[attr]+'').toLowerCase()){
                    memo[attr.replace(/source/,'save_ability')]=attributes['class_'+n+'_ability'];
                }
                return memo;
            },{});
        },
        
        buildMenus = function(attributes,setObj){//Constructs the chat based menus using the character's name, and the abilities/spells/attacks
            var sectionIDs,
                preMenu ='/w @{character_name} &{template:sf_generic} {{name=@{character_name}}} {{characterid=@{character_id}}} {{title=';
                setObj.attacks_menu=preMenu+'ATTACKS}}';
                setObj.spells_menu=attributes.sheet_type==='pc' ? preMenu+'SPELLBOOKS}} {{buttons1=' : preMenu+'SPELLS}}';
                setObj.ability_checks_menu=preMenu+'ABILITY CHECKS}}';
                setObj.abilities_menu=preMenu+'SPECIAL ABILITIES}}';
                setObj.skills_menu=preMenu+'SKILLS}}';
            /*attack menu build*/
            sectionIDs=_.chain(_.keys(attributes))
                .reduce((m,a)=>{
                    if(a.match(/repeating_attack/)){
                        m.push(a.replace(/repeating_attack_(-[^_]+)_.*/,'$1'));
                    }
                    return m;
                },[])
                .uniq()
                .value();
            let ranged ='{{buttons2=RANGED\n';
            let melee ='{{buttons1=MELEE\n';
            _.each(sectionIDs,(id)=>{
                let preRepeat ='repeating_attack_'+id+'_';
                if((attributes[preRepeat+'engagement_range'])==='ranged'){
                    if(ranged!=='{{buttons2=RANGED\n'){
                        ranged+=' |';
                    }
                    ranged+='['+HE(attributes[preRepeat+'name'])+'](~'+attributes.character_id+'|'+preRepeat+'roll)';
                }else{
                    if(melee!=='{{buttons1=MELEE\n'){
                        melee+=' |';
                    }
                    melee+='['+HE(attributes[preRepeat+'name'])+'](~'+attributes.character_id+'|'+preRepeat+'roll)';
                }
            });
            melee+='}}';
            ranged+='}}';
            setObj.attacks_menu+=melee+''+ranged;
            if(attributes.sheet_type==='pc'){
                /*spells menu build*/
                let spellClassNums = _.filter([1,2,3,4,5],(n)=>{
                    return attributes['class_'+n+'_spells']*1===1;
                });
                _.each(spellClassNums,(n)=>{
                    let preClass ='class_'+n+'_';
                    if(setObj.spells_menu!==preMenu+'SPELLBOOKS}} {{buttons1='){
                        setObj.spells_menu+=' |';
                    }
                    setObj.spells_menu+='['+HE(attributes[preClass+'name']).toUpperCase()+'](~'+attributes.character_id+'|'+preClass+'spellbook)';
                    let spellLevels = attributes[preClass+'max_spell']*1 + 1;
                    let classSpellBook = preMenu+attributes[preClass+'name'].toUpperCase()+' Spells}}';
                    _.each(_.range(spellLevels),(r)=>{
                        let spellLevel ='{{buttons'+r+'='+(r===0 ?'CANTRIPS' :'LEVEL'+r)+' [[0@{'+preClass+(r===0 ?'cantrips' :'level_'+r+'_spells')+'_per_day}]] / [[0@{'+preClass+(r===0 ?'cantrips' :'level_'+r+'_spells')+'_per_day|max}]]\n';
                        sectionIDs=_.chain(_.keys(attributes))
                            .reduce((m,a)=>{
                                if(a.match(/repeating_spell_([^_]+)_source/)){
                                    if(attributes[a]===attributes[preClass+'name'] && attributes[a.replace(/source/,'level')]*1===r){
                                        m.push(a.replace(/repeating_spell_(-[^_]+)_.*/,'$1'));
                                    }
                                }
                                return m;
                            },[])
                            .value();
                        _.each(sectionIDs,(id)=>{
                            let preRepeat ='repeating_spell_'+id+'_';
                            if(spellLevel !=='{{buttons'+r+'='+(r===0 ?'CANTRIPS' :'LEVEL'+r)+' [[0@{'+preClass+(r===0 ?'cantrips' :'level_'+r+'_spells')+'_per_day}]] / [[0@{'+preClass+(r===0 ?'cantrips' :'level_'+r+'_spells')+'_per_day|max}]]\n'){
                                spellLevel +=' |';
                            }
                            spellLevel+='['+HE(attributes[preRepeat+'name'])+'](~'+attributes.character_id+'|'+preRepeat+'roll)';
                        });
                        spellLevel+='}}';
                        classSpellBook+=spellLevel.replace(/\n}}/,'}}');
                    });
                    setObj[preClass+'spellbook']=classSpellBook;
                });
                setObj.spells_menu+='}}';
                /*abilities menu*/
                sectionIDs=_.chain(_.keys(attributes))
                    .reduce((m,a)=>{
                        if(a.match(/repeating_ability/)){
                            m.push(a.replace(/repeating_ability_(-[^_]+)_.*/,'$1'));
                        }
                        return m;
                    },[])
                    .uniq()
                    .value();
                let racial_abilities ='{{buttons1=^{racial}\n';
                let feat_abilities ='{{buttons2=^{feats}\n';
                let class_abilities = {
                    class_1_abilities:'{{buttons3='+attributes.class_1_name.toUpperCase()+'\n',
                    class_2_abilities:'{{buttons4='+attributes.class_2_name.toUpperCase()+'\n',
                    class_3_abilities:'{{buttons5='+attributes.class_3_name.toUpperCase()+'\n',
                    class_4_abilities:'{{buttons6='+attributes.class_4_name.toUpperCase()+'\n',
                    class_5_abilities:'{{buttons7='+attributes.class_5_name.toUpperCase()+'\n'
                }
                _.each(sectionIDs,(id)=>{
                    let preRepeat ='repeating_ability_'+id+'_';
                    let classNum=0;
                    if((attributes[preRepeat+'source']+'').toLowerCase()===(attributes.race+'').toLowerCase()){
                        if(racial_abilities!=='{{buttons1=^{racial}\n'){
                            racial_abilities+=' |';
                        }
                        racial_abilities+='['+HE(attributes[preRepeat+'name'])+'](~'+attributes.character_id+'|'+preRepeat+'roll)';
                    }else if(_.some([1,2,3,4,5],(n)=>{
                            classNum=n;
                            return (attributes['class_'+n+'_name']+'').toLowerCase()===(attributes[preRepeat+'source']+'').toLowerCase();
                        })){
                        if(class_abilities['class_'+classNum+'_abilities']!=='{{buttons'+(classNum + 2)+'='+attributes['class_'+classNum+'_name'].toUpperCase()+'\n'){
                            class_abilities['class_'+classNum+'_abilities']+=' |';
                        }
                        class_abilities['class_'+classNum+'_abilities']+='['+HE(attributes[preRepeat+'name'])+'](~'+attributes.character_id+'|'+preRepeat+'roll)';
                    }else{
                        if(feat_abilities!=='{{buttons2=^{feats}\n'){
                            feat_abilities+=' |';
                        }
                        feat_abilities+='['+HE(attributes[preRepeat+'name'])+'](~'+attributes.character_id+'|'+preRepeat+'roll)';
                    }
                });
                racial_abilities+='}}';
                feat_abilities +='}}';
                class_abilities = {
                    class_1_abilities:(class_abilities.class_1_abilities+'}}').replace(/\n}}/,''),
                    class_2_abilities:(class_abilities.class_2_abilities+'}}').replace(/\n}}/,''),
                    class_3_abilities:(class_abilities.class_3_abilities+'}}').replace(/\n}}/,''),
                    class_4_abilities:(class_abilities.class_4_abilities+'}}').replace(/\n}}/,''),
                    class_5_abilities:(class_abilities.class_5_abilities+'}}').replace(/\n}}/,'')
                }
                racial_abilities=racial_abilities.replace(/{{buttons1=\^{racial}\n}}/,'');
                feat_abilities=feat_abilities.replace(/{{buttons2=\^{feats}\n}}/,'');
                setObj.abilities_menu+=racial_abilities+''+feat_abilities+''+_.reduce(class_abilities,(m,ca)=>{return m+ca},'');
            }else if(attributes.sheet_type==='npc'){
                /*spells menu build*/
                let spellObjs = _.reduce(_.keys(attributes),(memo,k)=>{
                    if(k.match('repeating_spell_-[^_]+_name')){
                        memo.push({
                            name:attributes[k],
                            level:attributes[k.replace(/name/,'level')]*1||0,
                            roll:k.replace(/name/,'npc_roll')
                        });
                    }
                    return memo;
                },[]);
                let spellLevels = {
                    cantrips:'{{buttons0=CANTRIPS',
                    level1:'{{buttons1=LEVEL 1',
                    level2:'{{buttons2=LEVEL 2',
                    level3:'{{buttons3=LEVEL 3',
                    level4:'{{buttons4=LEVEL 4',
                    level5:'{{buttons5=LEVEL 5',
                    level6:'{{buttons6=LEVEL 6',
                    level7:'{{buttons7=LEVEL 7',
                    level8:'{{buttons8=LEVEL 8',
                    level9:'{{buttons9=LEVEL 9'
                }
                _.each(spellObjs,(s)=>{
                    spellLevels[s.level===0 ?'cantrips' :'level'+s.level]+=(spellLevels[s.level===0 ?'cantrips' :'level'+s.level].match(/\n/) ?' |':'\n')+'['+s.name+'](~'+attributes.character_name+'|'+s.roll+')';
                });
                _.each(_.keys(spellLevels),(k)=>{
                    if(spellLevels[k].match(/\n/)){
                        spellLevels[k]+='}}';
                    }else{
                        spellLevels[k]=spellLevels[k].replace(/({{buttons\d=).+/,'$1}}');
                    }
                    setObj.spells_menu+=''+spellLevels[k];
                });
                if(setObj.spells_menu.match(/\n/)){
                    setObj.caster_select=1;
                }
                /*abilities menu*/
                sectionIDs=_.chain(_.keys(attributes))
                    .reduce((m,a)=>{
                        if(a.match(/repeating_ability/)){
                            m.push(a.replace(/repeating_ability_(-[^_]+)_.*/,'$1'));
                        }
                        return m;
                    },[])
                    .uniq()
                    .value();
                let racial_abilities ='{{buttons1=RACIAL\n';
                let feat_abilities ='{{buttons2=FEATS\n';
                let class_abilities = {
                    class_1_abilities:'{{buttons3='+attributes.class_1_name.toUpperCase()+'\n',
                    class_2_abilities:'{{buttons4='+attributes.class_2_name.toUpperCase()+'\n',
                    class_3_abilities:'{{buttons5='+attributes.class_3_name.toUpperCase()+'\n',
                    class_4_abilities:'{{buttons6='+attributes.class_4_name.toUpperCase()+'\n',
                    class_5_abilities:'{{buttons7='+attributes.class_5_name.toUpperCase()+'\n'
                }
                _.each(sectionIDs,(id)=>{
                    let preRepeat ='repeating_ability_'+id+'_';
                    let classNum=0;
                    if((attributes[preRepeat+'source']+'').toLowerCase()===(attributes.race+'').toLowerCase()){
                        if(racial_abilities!=='{{buttons1=RACIAL\n'){
                            racial_abilities+=' |';
                        }
                        racial_abilities+='['+HE(attributes[preRepeat+'name'])+'](~'+attributes.character_id+'|'+preRepeat+'npc_roll)';
                    }else if(_.some([1,2,3,4,5],(n)=>{
                            classNum=n;
                            return (attributes['class_'+n+'_name']+'').toLowerCase()===(attributes[preRepeat+'source']+'').toLowerCase();
                        })){
                        if(class_abilities['class_'+classNum+'_abilities']!=='{{buttons'+(classNum + 2)+'='+attributes['class_'+classNum+'_name']+'\n'){
                            class_abilities['class_'+classNum+'_abilities']+=' |';
                        }
                        class_abilities['class_'+classNum+'_abilities']+='['+HE(attributes[preRepeat+'name'])+'](~'+attributes.character_id+'|'+preRepeat+'npc_roll)';
                    }else{
                        if(feat_abilities!=='{{buttons2=FEATS\n'){
                            feat_abilities+=' |';
                        }
                        feat_abilities+='['+HE(attributes[preRepeat+'name'])+'](~'+attributes.character_id+'|'+preRepeat+'npc_roll)';
                    }
                });
                racial_abilities+='}}';
                feat_abilities +='}}';
                class_abilities = {
                    class_1_abilities:(class_abilities.class_1_abilities+'}}').replace(/\n}}/,''),
                    class_2_abilities:(class_abilities.class_2_abilities+'}}').replace(/\n}}/,''),
                    class_3_abilities:(class_abilities.class_3_abilities+'}}').replace(/\n}}/,''),
                    class_4_abilities:(class_abilities.class_4_abilities+'}}').replace(/\n}}/,''),
                    class_5_abilities:(class_abilities.class_5_abilities+'}}').replace(/\n}}/,'')
                }
                setObj.abilities_menu+=racial_abilities+''+feat_abilities+''+_.reduce(class_abilities,(m,ca)=>{return m+ca},'');
            }
            /*skills*/
            setObj.skills_menu+='{{buttons0=[Perception](~'+attributes.character_id+'|perception)}}'
                +'{{buttons1=PHYSICAL\n[Acrobatics](~'+attributes.character_id+'|acrobatics) | [Athletics](~'+attributes.character_id+'|athletics) | [Piloting](~'+attributes.character_id+'|piloting)}}'
                +'{{buttons2=SOCIAL\n[Bluff](~'+attributes.character_id+'|bluff) | [Diplomacy](~'+attributes.character_id+'|diplomacy) | [Disguise](~'+attributes.character_id+'|disguise) | [Intimidate](~'+attributes.character_id+'|intimidate) | [Sense Motive](~'+attributes.character_id+'|sense_motive)}}'
                +'{{buttons3=THIEVERY\n[Sleight of Hand](~'+attributes.character_id+'|sleight_of_hand) | [Stealth](~'+attributes.character_id+'|stealth)}}'
                +'{{buttons4=KNOWLEDGE\n[Computers](~'+attributes.character_id+'|computers) | [Culture](~'+attributes.character_id+'|culture) | [Engineering](~'+attributes.character_id+'|engineering) | [Life Science](~'+attributes.character_id+'|life_science) | [Medicine](~'+attributes.character_id+'|medicine) | [Mysticism](~'+attributes.character_id+'|mysticism) | [Physical Science](~'+attributes.character_id+'|physical_science) | [Survival](~'+attributes.character_id+'|survival)}}';
            let professionMenu='{{buttons5=PROFESSION\n'
            sectionIDs=_.chain(_.keys(attributes))
                .reduce((m,a)=>{
                    if(a.match(/repeating_profession/)){
                        m.push(a.replace(/repeating_profession_(-[^_]+)_.*/,'$1'));
                    }
                    return m;
                },[])
                .uniq()
                .value();
            _.each(sectionIDs,(id)=>{
                let preRepeat ='repeating_profession_'+id+'_';
                if(professionMenu!=='{{buttons5=PROFESSION\n'){
                    professionMenu+=' |';
                }
                professionMenu+='['+HE(attributes[preRepeat+'name'])+'](~'+attributes.character_id+'|'+preRepeat+'roll)';
            });
            professionMenu+='}}';
            setObj.skills_menu+=professionMenu.replace(/PROFESSION\n}}/,'');
            return setObj;
        },
        
        assignConditions = function(attributes,bonuses){
            const skillArray = ['acrobatics','athletics','bluff','computers','culture','diplomacy','disguise','engineering','intimidate','life_science','medicine','mysticism','perception','physical_science','piloting','sense_motive','sleight_of_hand','stealth','survival'],
                activeConditions = _.filter(_.keys(attributes),(k)=>{return /repeating_condition_[^_]+_name/.test(k)}),
                filteredSkillDamage = {
                    'dexSkills':_.filter(_.keys(attributes),(key)=>{
                        if(new RegExp(skillArray.join('|')+'$').test(key) && attributes[key+'_ability']==='@{dexterity_mod}'){
                            return true;
                        }
                        return false;
                    }).concat(['profession|ability:@{dexterity_mod}']),
                    'strSkills':_.filter(_.keys(attributes),(key)=>{
                        if(new RegExp(skillArray.join('|')+'$').test(key) && attributes[key+'_ability']==='@{strength_mod}'){
                            return true;
                        }
                        return false;
                    }).concat(['profession|ability:@{strength_mod}']),
                    'intSkills':_.filter(_.keys(attributes),(key)=>{
                        if(new RegExp(skillArray.join('|')+'$').test(key) && attributes[key+'_ability']==='@{intelligence_mod}'){
                            return true;
                        }
                        return false;
                    }).concat(['profession|ability:@{intelligence_mod}']),
                    'wisSkills':_.filter(_.keys(attributes),(key)=>{
                        if(new RegExp(skillArray.join('|')+'$').test(key) && attributes[key+'_ability']==='@{wisdom_mod}'){
                            return true;
                        }
                        return false;
                    }).concat(['profession|ability:@{wisdom_mod}']),
                    'chaSkills':_.filter(_.keys(attributes),(key)=>{
                        if(new RegExp(skillArray.join('|')+'$').test(key) && attributes[key+'_ability']==='@{charisma_mod}'){
                            return true;
                        }
                        return false;
                    }).concat(['profession|ability:@{charisma_mod}']),
                    'meleeDamage':['damage|engagement_range:melee'],
                    'meleeAttack':['attack|engagement_range:melee'],
                    'weaponDamage':['damage|section:attack'],
                    'dexAttack':['total|ability:@{dexterity_mod}'],
                    'strAttack':['total|ability:@{strength_mod}'],
                    'strDamage':['damage|damage_ability:@{strength_mod},section:attack'],
                    'conDC':['dc|save_ability:@{constitution_mod}'],
                },
                conditions = [
                    {condition:'asleep',penalties:[['perception',-10]]},
                    {condition:'blinded',penalties:[['dexSkills',-4],['strSkills',-4],['perception','-?{'+getTranslationByKey('opposed-roll')+'|'+getTranslationByKey('no')+',0|'+getTranslationByKey('yes')+',4}']]},
                    {condition:'dazzled',penalties:[['perception','-?{'+getTranslationByKey('visual')+'|'+getTranslationByKey('no')+',0|'+getTranslationByKey('yes')+',1}'],['attack',-1]]},
                    {condition:'deafened',penalties:[['initiative',-4],['perception','-?{'+getTranslationByKey('opposed-roll')+'|'+getTranslationByKey('no')+',0|'+getTranslationByKey('yes')+',4}']]},
                    {condition:'entangled',penalties:[['eac',-2],['kac',-2],['attack',-2],['ref',-2],['initiative',-2],['dexSkills',-2]]},
                    {condition:'exhausted',penalties:[['eac',-3],['kac',-3],['attack',-3],['meleeDamage',-3],['ref',-3],['initiative',-3],['strSkills',-3],['dexSkills',-3],['encumber_bulk',-3]]},
                    {condition:'fatigued',penalties:[['eac',-1],['kac',-1],['attack',-1],['meleeDamage',-1],['ref',-1],['initiative',-1],['strSkills',-1],['dexSkills',-1],['encumber_bulk',-1]]},
                    {condition:'flat_footed',penalties:[['eac',-2],['kac',-2]]},
                    {condition:'frightened',penalties:[['attack',-2],['ref',-2],['fort',-2],['will',-2],['skills',-2]]},
                    {condition:'negative_levels',penalties:[['attack',-1],['ref',-1],['fort',-1],['will',-1],['skills',-1],['eac',-1],['kac',-1],['sp_max',-5],['hp_max',-5]]},
                    {condition:'off_kilter',penalties:[['attack',-2]]},
                    {condition:'off_target',penalties:[['attack',-2]]},
                    {condition:'panicked',penalties:[['ref',-2],['fort',-2],['will',-2],['skills',-2]]},
                    {condition:'grappled',penalties:[['eac',-2],['kac',-2],['attack',-2],['ref',-2],['initiative',-2],['dexSkills','-?{'+getTranslationByKey('escaping-grapple')+'|'+getTranslationByKey('no')+',0|'+getTranslationByKey('yes')+',2}']]},
                    {condition:'pinned',penalties:[['eac',-4],['kac',-4],['attack',-4],['ref',-4],['initiative',-4],['dexSkills',-4]]},
                    {condition:'prone',penalties:[['meleeAttack',-4]]},
                    {condition:'shaken',penalties:[['attack',-2],['ref',-2],['fort',-2],['will',-2],['skills',-2]]},
                    {condition:'sickened',penalties:[['attack',-2],['fort',-2],['ref',-2],['will',-2],['weaponDamage',-2],['skills',-2]]},
                ],
                diseasePoison = {
                    'physical_track':[
                        [],//Healthy
                        [],//latent
                        [],//weakened
                        [],//impaired
                        [],//debilitated
                        [],//bedridden
                        [],//comatose
                        [],//You're Dead!
                    ],
                    'mental_track':[
                        [],//healthy
                        [],//latent
                        [['spell|dc',-2],['ability|dc',-2]],//weakened
                        [['spell|dc',-2],['ability|dc',-2]],//impaired
                        [],//befuddled
                        [],//disassociated
                        [],//comatose
                        [],//You're Dead!
                    ],
                    'strength_track':[
                        [],//healthy
                        [['strAttack',-2],['strDamage',-2],['strSkills',-2],['spell|dc',-2],['ability|dc',-2]],//weakened
                        [['strAttack',-2],['strDamage',-2],['strSkills',-2],['spell|dc',-2],['ability|dc',-2]],//impaired
                        [],//staggered
                        [],//immobile
                        [],//You're Dead!
                    ],
                    'dexterity_track':[
                        [],//healthy
                        [['ref',-2],['dexAttack',-2],['dexSkills',-2],['spell|dc',-2],['ability|dc',-2]],//sluggish
                        [],//stiffened
                        [],//staggered
                        [],//immobile
                        [],//You're Dead!
                    ],
                    'constitution_track':[
                        [],//healthy
                        [['fort',-2],['conDC',-2]],//weakened
                        [['fort',-2],['conDC',-2]],//impaired
                        [],//debilitated
                        [],//unconscious
                        [],//You're Dead!
                    ],
                    'intelligence_track':[
                        [],//healthy
                        [['intSkills',-2],['spell|dc',-2],['ability|dc',-2]],//weakend
                        [['intSkills',-2],['spell|dc',-2],['ability|dc',-2]],//impaired
                        [],//animalistic
                        [],//comatose
                        [],//You're Dead!
                    ],
                    'wisdom_track':[
                        [],//healthy
                        [['will',-2],['wisSkills',-2],['spell|dc',-2],['ability|dc',-2]],//weakened
                        [['will',-2],['wisSkills',-2],['spell|dc',-2],['ability|dc',-2]],//impaired
                        [],//confused
                        [],//comatose
                        [],//You're Dead!
                    ],
                    'charisma_track':[
                        [],//healthy
                        [['chaSkills',-2],['spell|dc',-2],['ability|dc',-2]],//weakened
                        [['chaSkills',-2],['spell|dc',-2],['ability|dc',-2]],//impaired
                        [],//pliable
                        [],//catatonic
                        [],//You're Dead!
                    ]
                },
                trackNumConvert = {
                    'physical_track':{
                        healthy:1,
                        latent:2,
                        weakened:3,
                        impaired:4,
                        debilitated:5,
                        bedridden:6,
                        comatose:7,
                        dead:8
                    },
                    'mental_track':{
                        healthy:1,
                        latent:2,
                        weakened:3,
                        impaired:4,
                        befuddled:5,
                        disassociated:6,
                        comatose:7,
                        dead:8
                    },
                    'strength_track':{
                        healthy:1,
                        weakened:2,
                        impaired:3,
                        staggered:4,
                        immobile:5,
                        dead:6
                    },
                    'dexterity_track':{
                        healthy:1,
                        sluggish:2,
                        stiffened:3,
                        staggered:4,
                        immobile:5,
                        dead:6
                    },
                    'constitution_track':{
                        healthy:1,
                        weakened:2,
                        impaired:3,
                        debilitated:4,
                        unconscious:5,
                        dead:6
                    },
                    'intelligence_track':{
                        healthy:1,
                        weakened:2,
                        impaired:3,
                        animalistic:4,
                        comatose:5,
                        dead:6
                    },
                    'wisdom_track':{
                        healthy:1,
                        weakened:2,
                        impaired:3,
                        confused:4,
                        comatose:5,
                        dead:6
                    },
                    'charisma_track':{
                        healthy:1,
                        weakened:2,
                        impaired:3,
                        pliable:4,
                        catatonic:5,
                        dead:6
                    },
                };
                
            _.each(activeConditions,(condition)=>{
                const rowID = condition.replace(/name/,''),
                    track = attributes[rowID+'track'],
                    status = attributes[rowID+'track_status'],
                    statusValue = trackNumConvert[track] ? trackNumConvert[track][status]||1 : undefined;
                    
                if(statusValue){
                    _.each(_.range(statusValue),(state)=>{
                        _.each(diseasePoison[track][state],(effect)=>{
                            let expandedPenalties = filteredSkillDamage[effect[0]]||[effect[0]];
                            _.each(expandedPenalties,(affected)=>{
                                bonuses[affected]=bonuses[affected]||{};
                                bonuses[affected]['Affliction']=bonuses[affected]['Affliction']||[];
                                bonuses[affected]['Affliction'].push(effect[1]);
                            });
                        });
                    });
                }
            });
            _.each(conditions,(cond)=>{
                let conditionName=cond.condition.replace(/_/g,'-');
                if(Math.abs(attributes[cond.condition]*1)>0){
                    _.each(cond.penalties,(effect)=>{
                        let expandedPenalties
                        if(effect[0]==='skills'){
                            expandedPenalties = skillArray.concat(['profession']);
                        }else{
                            expandedPenalties = filteredSkillDamage[effect[0]]||[effect[0]];
                        }
                        _.each(expandedPenalties,(affected)=>{
                            bonuses[affected]=bonuses[affected]||{};
                            bonuses[affected][conditionName]=bonuses[affected][conditionName]||[];
                            bonuses[affected][conditionName].push(effect[1]*Math.abs(attributes[cond.condition]*1)||effect[1]);
                        });
                    });
                }
            });
            return bonuses;
        },
        
        parseBuffs = function(attributes){//parses all of the buffs contained in the repeating_buff, repeating_item, and repeating_ability items
                                        //  creates an object indexed by attribute to be buffed containing objects that have all of the buffs for that attribute
                                        //  indexed by buff type
            let armor = false,
                armorProf,
                profPenalty='';
            var modRegex = /((?:\+|\-)?.*?(?=(?:[a-z\s]+)?\s+to\s+))(?:\s+([a-z\s]+))?\s+to\s+([^\n]+)/i,//allow wrapping of equation in ()'s
                buffSplit,buffMatch,buff,buffType,buffed,evalBuff,
                buffFields = _.chain(_.keys(attributes))
                    .filter((k)=>{
                        return k.match(/repeating_(?:item_-[^_]+_mods|buff_-[^_]+_mods|ability_-[^_]+_mods)/);
                    })
                    .filter((k)=>{
                        let typeSwitch = {
                               'item':(p1)=>[p1+'equipped'],
                               'buff':(p1)=>[p1+'toggle'],
                               'ability':(p1)=>[p1+'toggle',p1+'frequency']
                            };
                        let typeMatch = k.match(/(repeating_(item|buff|ability)_-[^_]+_)mods/);
                        return _.some(typeSwitch[typeMatch[2]](typeMatch[1]),(ts)=>{
                            return (attributes[ts]+'').match(/enabled|equipped|constant|1/);
                        });
                    })
                    .map((k)=>{
                        let typeMatch = k.match(/(repeating_(item|buff|ability)_-[^_]+_)mods/);
                        if(typeMatch[2]==='item'&&attributes[typeMatch[1]+'purpose']==='armor'){
                            armor = /power/.test(attributes[typeMatch[1]+'type']) ? 'power' : (armor === 'power' ? 'power':true);
                            armorProf = attributes[typeMatch[1]+'proficiency'];
                        }
                        return attributes[k];
                    })
                    .reject((f)=>{return _.isEmpty(f)})
                    .reduce((memo,f)=>{
                        buffSplit = f.split(/\s*\n\s*/);
                        memo=memo.concat(buffSplit);
                        return memo;
                    },[])
                    .reduce((memo,f)=>{
                        buffMatch = f.match(modRegex);
                        if(buffMatch){
                            let rawBuff = buffMatch[1].toLowerCase();
                            buffed = buffMatch[3].toLowerCase().split(/\s+and\s+/);
                            buffType = buffMatch[2] ? buffMatch[2].toLowerCase().replace(/max dex/i,'max_dex') :'untyped';
                            _.each(buffed,(b)=>{
                                b = b.trim();
                                buff = rawBuff;
                                if(/^(?:strength|dexterity|constitution|intelligence|wisdom|charisma)$/i.test(b) && attributes.sheet_type==='npc'){
                                    buff = 'floor(('+rawBuff+')/2)';
                                    b=b+'_mod';
                                }
                                if((b==='eac'||b==='kac')&&buffType==='armor'){
                                    b+='_armor';
                                }else if(b==='sp'||b==='rp'||b==='hp'||b.match(/temp[^\s]*\s*hp/)){
                                    b+='_max';
                                }
                                if(armor){
                                    if(armorProf==='no'){
                                        profPenalty='-4';
                                    }
                                }
                                b=b.replace(/(.+?(?=\|)|(?:\||,).+?(?=:))/g,'$1').replace(/\s+/,'_').replace(/heavy(?:_|\s+)weapons?/,'heavy').toLowerCase();
                                if(b.startsWith('category:')){
                                    b=b.replace(/category:_?/,'');
                                    memo.categories[b]=memo.categories[b]||{};
                                    memo.categories[b][buffType]=memo.categories[b][buffType]||[];
                                    memo.categories[b][buffType].push(buff);
                                }else if(b.match(/^(?:ac|armor)$/i)){
                                    if(/armor/i.test(buffType)){
                                        memo.eac_armor=memo.eac_armor||{};
                                        memo.eac_armor[buffType]=memo.eac_armor[buffType]||[];
                                        memo.eac_armor[buffType].push(buff);
                                        memo.kac_armor=memo.kac_armor||{};
                                        memo.kac_armor[buffType]=memo.kac_armor[buffType]||[];
                                        memo.kac_armor[buffType].push(buff);
                                    }else{
                                        memo.eac=memo.eac||{};
                                        memo.eac[buffType]=memo.eac[buffType]||[];
                                        memo.eac[buffType].push(buff);
                                        memo.kac=memo.kac||{};
                                        memo.kac[buffType]=memo.kac[buffType]||[];
                                        memo.kac[buffType].push(buff);
                                    }
                                }else if(b.match(/^skills?$/i)){
                                    _.each(skillList,(skill)=>{
                                        memo[skill]=memo[skill]||{};
                                        memo[skill][buffType]=memo[skill][buffType]||[];
                                        memo[skill][buffType].push(buff);
                                    });
                                }else if(b==='acp'){
                                    memo[b]=memo[b]||{};
                                    memo[b].acp=memo[b].acp||[];
                                    memo[b].acp.push(buff);
                                }else if(b==='saves'){
                                    _.each(['fort','ref','will'],(save)=>{
                                        memo[save]=memo[save]||{};
                                        memo[save][buffType]=memo[save][buffType]||[];
                                        memo[save][buffType].push(buff);
                                    });
                                }else{
                                    memo[b]=memo[b]||{};
                                    memo[b][buffType]=memo[b][buffType]||[];
                                    memo[b][buffType].push(buff);
                                }
                            });
                        }
                        return memo;
                    },{})
                    .value();
            if(armor){
                if(armorProf==='no'){
                    buffFields.eac = buffFields.eac||{};
                    buffFields.eac.untyped = buffFields.eac.untyped||[];
                    buffFields.eac.untyped.push('-4');
                    buffFields.kac = buffFields.kac||{};
                    buffFields.kac.untyped = buffFields.kac.untyped||[];
                    buffFields.kac.untyped.push('-4');
                }
            }
            return buffFields;
        },
        
        starfinderMax = function(){//Returns the maximum value if first argument is null/undefined/false. otherwise returns minimum
            if(arguments[0]===true){
                return _.min(_.rest(arguments));
            }else{
                return _.max(_.rest(arguments));
            }
        },
        
        calcBuffs = function(attributes,bonus,setObj,output){//calculates the buff to apply for any given type. Also takes into account stacking.
            var tObj,evalBuff, redAttr = _.reduce(_.keys(bonus),(memo,t)=>{
                tObj = _.reduce(bonus[t],(m,b)=>{
                    evalBuff=(b+'').replace(/(floor|ceil|abs|round|abs)\(/g,'Math.$1(').replace(/@{([^}]+)}/g,(match,p1)=>{
                        return setObj[p1.toLowerCase()]*1 || attributes[p1.toLowerCase()]*1||'@{'+p1+'}';
                    });
                    try{
                        evalBuff=eval(evalBuff);
                        if(t==='acp'){
                            m.acp=starfinderMax(true,m.acp,evalBuff);
                        }else if(evalBuff>=0){
                            if(t==='armor'){
                                m.armor=starfinderMax(false,m.armor,evalBuff);
                            }else if(t==='max_dex'){
                                m.max_dex=starfinderMax(true,m.max_dex,evalBuff);
                            }else if(_.contains((attributes.stackable_buffs.toLowerCase()+',untyped').split(/\s*(?:,|\n+)\s*/),t.toLowerCase())){
                                m.buff+=evalBuff;
                            }else{
                                m.buff=starfinderMax(false,m.buff,evalBuff);
                            }
                        }else if(evalBuff<0){
                            m.pen+=evalBuff;
                        }
                    }catch(err){}
                    if(_.contains((attributes.stackable_buffs.toLowerCase()+',untyped,affliction').split(/\s*(?:,|\n+)\s*/),t.toLowerCase())){
                        m.misc+=(m.misc==='' ?'' :'+')+(b+'').replace(/^\+/,'');
                    }else if((b+'').length>0){
                        m.misc+=(m.misc==='' ?'' :',')+'{'+(b+'').replace(/^\+/,'')+'}'
                    }
                    return m;
                },{buff:0,pen:0,misc:'',armor:0,acp:0});
                memo.total+=tObj.buff+tObj.pen+tObj.acp;
                if(_.contains((`${attributes.stackable_buffs.toLowerCase()},untyped,affliction`).split(/\s*(?:,|\n+)\s*/).concat(conditionList),t.toLowerCase())&&tObj.misc.length>0){
                    memo.misc+='+[['+tObj.misc+']]['+t+']';
                }else{
                    if(tObj.misc.length>1){
                        memo.misc+=`+[[{${tObj.misc},{0}}kl1 + {${tObj.misc},{0}}kh1]][${t}]`;
                    }
                }
                memo.armor=starfinderMax(false,memo.armor,tObj.armor);
                if(_.isNumber(tObj.max_dex*1)){
                    memo.max_dex=starfinderMax(true,memo.max_dex,tObj.max_dex);
                }
                return memo;
            },{total:0,misc:'',armor:0,acp:0});
            return redAttr;
        },
        
        affectWhat = function(attributes,trigger,bonus){
            let abiSel;
            if(attributes.sheet_type==='pc'){
                abiSel = ['eac_ability','kac_ability','fort_ability','ref_ability','initiative_ability','will_ability','class_1_ability','class_2_ability','class_3_ability','class_4_ability','class_5_ability','acrobatics_ability','athletics_ability','bluff_ability','computers_ability','culture_ability','diplomacy_ability','disguise_ability','engineering_ability','intimidate_ability','life_science_ability','medicine_ability','mysticism_ability','perception_ability','physical_science_ability','piloting_ability','sense_motive_ability','sleight_of_hand_ability','stealth_ability','survival_ability'];
            }else{
                abiSel = ['acrobatics_ability','athletics_ability','bluff_ability','computers_ability','culture_ability','diplomacy_ability','disguise_ability','engineering_ability','intimidate_ability','life_science_ability','medicine_ability','mysticism_ability','perception_ability','physical_science_ability','piloting_ability','sense_motive_ability','sleight_of_hand_ability','stealth_ability','survival_ability']
            }
            const objSwitch = {
                    npc:npcAttributeObjs,
                    pc:attributeObjs
                },
                bonusKeys=_.keys(bonus),
                affected={},
                affectedKeys=[],
                propagatedTriggers = _.reduce(trigger,(memo,trig)=>{
                    trig.replace(/(?:(repeating_([^_]+)_[^_]+_))?(.+)/,(match,sectionID,section,attr)=>{
                        let objName;
                        if(section){
                            objName = section+'|'+attr;
                        }else{
                            objName = attr;
                        }
                        memo[trig]=JSON.parse(JSON.stringify(objSwitch[attributes.sheet_type][objName]));
                    });
                    return memo;
                },{}),
                complicatedConditions = {
                    entangled:['dexSkills'],
                    exhausted:['dexSkills','strSkills'],
                    blinded:['dexSkills','strSkills'],
                    fatigued:['dexSkills','strSkills','meleeDamage'],
                    strength_track:['strSkills','strAttack','strDamage'],
                    dexterity_track:['dexSkills','dexAttack'],
                    constitution_track:['conDC'],
                    intelligence_track:['intSkills'],
                    wisdom_track:['wisSkills'],
                    charisma_track:['chaSkills'],
                },
                skillArray = ['acrobatics','athletics','bluff','computers','culture','diplomacy','disguise','engineering','intimidate','life_science','medicine','mysticism','perception','physical_science','piloting','sense_motive','sleight_of_hand','stealth','survival'],
                filteredSkillDamage = {
                    'dexSkills':_.filter(_.keys(attributes),(key)=>{
                        if(new RegExp('(?:repeating_profession_[^_]+_profession|'+skillArray.join('|')+')').test(key) && attributes[key.replace(/_profession$/,'')+'_ability']==='@{dexterity_mod}'){
                            return true;
                        }
                        return false;
                    }),
                    'strSkills':_.filter(_.keys(attributes),(key)=>{
                        if(new RegExp('(?:repeating_profession_[^_]+_profession|'+skillArray.join('|')+')').test(key) && attributes[key.replace(/_profession$/,'')+'_ability']==='@{strength_mod}'){
                            return true;
                        }
                        return false;
                    }),
                    'intSkills':_.filter(_.keys(attributes),(key)=>{
                        if(new RegExp('(?:repeating_profession_[^_]+_profession|'+skillArray.join('|')+')').test(key) && attributes[key.replace(/_profession$/,'')+'_ability']==='@{intelligence_mod}'){
                            return true;
                        }
                        return false;
                    }),
                    'wisSkills':_.filter(_.keys(attributes),(key)=>{
                        if(new RegExp('(?:repeating_profession_[^_]+_profession|'+skillArray.join('|')+')').test(key) && attributes[key.replace(/_profession$/,'')+'_ability']==='@{wisdom_mod}'){
                            return true;
                        }
                        return false;
                    }),
                    'chaSkills':_.filter(_.keys(attributes),(key)=>{
                        if(new RegExp('(?:repeating_profession_[^_]+_profession|'+skillArray.join('|')+')').test(key) && attributes[key.replace(/_profession$/,'')+'_ability']==='@{charisma_mod}'){
                            return true;
                        }
                        return false;
                    }),
                    'meleeDamage':_.filter(_.keys(attributes),(key)=>{
                        if(/repeating_attack_[^_]+_damage_total/.test(key) && attributes[key.replace(/_damage_total$/,'_engagement_range')]==='melee'){
                            return true;
                        }
                        return false;
                    }),
                    'meleeAttack':_.filter(_.keys(attributes),(key)=>{
                        if(/repeating_attack_[^_]+_total/.test(key) && attributes[key.replace(/_total$/,'_engagement_range')]==='melee'){
                            return true;
                        }
                        return false;
                    }),
                    'weaponDamage':_.filter(_.keys(attributes),(key)=>{
                        if(/repeating_attack_[^_]+_damage_total/.test(key)){
                            return true;
                        }
                        return false;
                    }),
                    'dexAttack':_.filter(_.keys(attributes),(key)=>{
                        if(/repeating_(?:attack_[^_]+_total|(?:spell|ability)_[^_]+_attack_total)/.test(key) && attributes[key.replace(/_total$/,'_ability')]==='@{dexterity_mod}'){
                            return true;
                        }
                        return false;
                    }),
                    'strAttack':_.filter(_.keys(attributes),(key)=>{
                        if(/repeating_(?:attack_[^_]+_total|(?:spell|ability)_[^_]+_attack_total)/.test(key) && attributes[key.replace(/_total$/,'_ability')]==='@{strength_mod}'){
                            return true;
                        }
                        return false;
                    }),
                    'strDamage':_.filter(_.keys(attributes),(key)=>{
                        if(/repeating_(?:attack|spell|ability)_[^_]+_damage_total/.test(key) && attributes[key.replace(/_total$/,'_ability')]==='@{strength_mod}'){
                            return true;
                        }
                        return false;
                    }),
                    'conDC':_.filter(_.keys(attributes),(key)=>{
                        if(/_dc$/.test(key) && attributes[key.replace(/_dc$/,'_save_ability')]==='@{constitution_mod}'){
                            return true;
                        }
                        return false;
                    }),
                },
                repeatAttrs = {
                    total:[['attack','total']],
                    damage_total:[['attack','damage_total'],['ability','damage_total'],['spell','damage_total']],
                    dc:[['ability','dc'],['spell','dc']],
                    attack_total:[['ability','attack_total'],['spell','attack_total']],
                    profession:[['profession']],
                    attack:[['attack','total'],['ability','attack_total'],['spell','attack_total']],
                    damage:[['attack','damage_total'],['ability','damage_total'],['spell','damage_total']]
                },
                triggerKeys = _.keys(propagatedTriggers),
                repeatKeys = _.reduce(_.keys(attributes),(memo,key)=>{
                    key.replace(/(repeating_([^_]+)_[^_]+_).+|_ability$/,(match,p1,p2)=>{
                        if(p1){
                            if(!_.contains(memo[p2],p1)){
                                memo[p2].push(p1);
                            }
                        }
                        if(/_ability$/.test(match) && /repeating/.test(key)){
                            memo.abilitySelects.push(match);
                        }
                    });
                    return memo;
                },{attack:[],condition:[],profession:[],ability:[],spell:[],item:[],abilitySelects:abiSel,buff:[]});
            while(triggerKeys[0]){
                let key = triggerKeys.shift();
                let section = propagatedTriggers[key].repeating;
                if(/^(?:strength|dexterity|constitution|intelligence|wisdom|charisma)_mod$/.test(propagatedTriggers[key].attr)){
                    _.each(repeatKeys.abilitySelects,(as)=>{
                        if(attributes[as]==='@{'+key+'}'){
                            as.replace(/(repeating_([^_]+)_[^_]+_)?(.+)/,(match,sectionID,section,attr)=>{
                                let objName;
                                if(section){
                                    objName = section+'|'+attr;
                                }else{
                                    objName = attr;
                                }
                                //TAS.log(`objSwitch[attributes.sheet_type][${objName}].affects: ${JSON.stringify(objSwitch[attributes.sheet_type][objName].affects)}`);
                                _.each(objSwitch[attributes.sheet_type][objName].affects,(affect)=>{
                                    let affectName
                                    if(sectionID){
                                        affectName = affect.replace(/.+?\|(.+)/,sectionID+'$1');
                                        if(!_.contains(propagatedTriggers[key].affects,affect)){
                                            propagatedTriggers[key].affects.push(affectName);
                                        }
                                    }else{
                                        affect.replace(/(?:(.+?)\|)?(.+)/,(match,section,attribute)=>{
                                            if(section){
                                                _.each(_.keys(attributes),(a) =>{
                                                    if(new RegExp(`repeating_${section}_[^_]+_${attribute}$`).test(a)){
                                                        propagatedTriggers[key].affects.push(a);
                                                    }
                                                });
                                            }else{
                                                propagatedTriggers[key].affects.push(affect);
                                            }
                                        });
                                    }
                                });
                            });
                        }
                    });
                    //TAS.log(`affects: ${JSON.stringify(propagatedTriggers[key].affects)}`);
                }
                _.each(complicatedConditions[propagatedTriggers[key].attr],(filt)=>{
                    propagatedTriggers[key].affects = propagatedTriggers[key].affects.concat(filteredSkillDamage[filt]);
                });
                _.each(bonusKeys,(buffTarget)=>{
                    if(!propagatedTriggers[buffTarget]&&!_.contains(propagatedTriggers[key].affects,buffTarget)){
                        let trueTarget=[buffTarget.replace(/\|.+/,'')],
                            repeatTarget = repeatAttrs[trueTarget[0]];
                            
                        if(repeatTarget){
                            trueTarget = _.reduce(repeatTarget,(memo,sectionAttr)=>{
                                let sectionIDs = _.map(repeatKeys[sectionAttr[0]],(id)=>{
                                    return `${id}${sectionAttr[1]}`;
                                });
                                return memo.concat(sectionIDs);
                            },[]);
                        }
                        _.some(bonus[buffTarget],(buffType)=>{
                            return _.some(buffType,(buffValue)=>{
                                if(new RegExp('@{'+propagatedTriggers[key].attr+'}').test(buffValue)){
                                    propagatedTriggers[key].affects = propagatedTriggers[key].affects.concat(trueTarget);
                                    return true;
                                }
                                return false;
                            });
                        });
                    }
                });
                if(section){
                    _.each(_.range(propagatedTriggers[key].affects.length),(n)=>{
                        if(new RegExp(section+'\\|').test(propagatedTriggers[key].affects[n])){
                            propagatedTriggers[key].affects[n]=propagatedTriggers[key].affects[n].replace(/[^|]+\|(.+)/,key.replace(/(repeating_[^_]+_[^_]+_).+/,'$1')+'$1');
                        }
                    });
                    if(propagatedTriggers[key].repeatAdds){
                        _.each(_.range(propagatedTriggers[key].repeatAdds.length),(n)=>{
                            propagatedTriggers[key].repeatAdds[n]=key.replace(/(repeating_[^_]+_[^_]+_).+/,'$1')+propagatedTriggers[key].repeatAdds[n];
                        });
                    }
                    if(propagatedTriggers[key].repeatTextAdds){
                        _.each(_.range(propagatedTriggers[key].repeatTextAdds.length),(n)=>{
                            propagatedTriggers[key].repeatTextAdds[n]=key.replace(/(repeating_[^_]+_[^_]+_).+/,'$1')+propagatedTriggers[key].repeatTextAdds[n];
                        });
                    }
                    if(propagatedTriggers[key].repeatParseField){
                        _.each(_.range(propagatedTriggers[key].repeatParseField.length),(n)=>{
                            propagatedTriggers[key].repeatParseField[n]=key.replace(/(repeating_[^_]+_[^_]+_).+/,'$1')+propagatedTriggers[key].repeatParseField[n];
                        });
                    }
                }else{
                    propagatedTriggers[key].affects=_.reduce(propagatedTriggers[key].affects,(memo,affect)=>{
                        affect.replace(/(?:([^|]+)\|)?(.+)/,(match,section,attr)=>{
                            if(section){
                                memo = memo.concat(_.map(repeatKeys[section],(id)=>{return id+attr}));
                            }else{
                                memo.push(attr);
                            }
                        });
                        return memo;
                    },[]);
                }
                _.each(propagatedTriggers[key].affects,(affect)=>{
                    if(!propagatedTriggers[affect]){
                        affect.replace(/(?:(repeating_([^_]+)_[^_]+_))?(.+)/,(match,sectionID,sectionMatch,attrMatch)=>{
                            let objName;
                            if(sectionMatch){
                                objName = sectionMatch+'|'+attrMatch;
                            }else{
                                objName = attrMatch;
                            }
                            propagatedTriggers[affect]=JSON.parse(JSON.stringify(objSwitch[attributes.sheet_type][objName]));
                            triggerKeys.push(affect);
                            affectedKeys.push(affect);
                        });
                    }
                });
                if(/spell_resistance/.test(key)){
                    affectedKeys.push(key);
                }
            }
            _.each(affectedKeys,(key)=>{
                affected[key]=propagatedTriggers[key];
            });
            return affected;
        },
        
        oldaffectWhat = function(attributes,trigger,bonus){
            let index=0;
            // Need to check buffs
            // Need to handle differing repeating items (e.g. different attack ability)
            do{
                let aObj = currentAttributeObjs[propagatedTriggers[index]];
                if(aObj){
                    
                    _.each(aObj.affects,(attr)=>{
                        if(!_.contains(_.keys(affected),attr)){
                            affected[attr]=currentAttributeObjs[attr];
                            propagatedTriggers.push(attr);
                        }
                    });
                }
                index++;
            }while(index < propagatedTriggers.length);
            return affected;
        },
        
        applyBuffs = function(attributes,trigger,bonus,setObj){
            /*
                This is the workhorse of the sheet. It iterates through all of the attributes contained in the attributeObjs or npcAttributeObjs variable
                to calculate the final value of any given attribute. This function is not used for starships. Currently it iterates through all variables
                regardless of what attribute was changed. I had planned to put logic in to assemble a list of attributes that actually needed to be
                updated based on what was changed, but had not gotten to it yet.
            */
            const objSwitch = {
                   'pc':attributeObjs,
                   'npc':npcAttributeObjs,
                   'ship':{}
                },
                bonusKeys = _.keys(bonus),//Keys of the bonus object
                affected = affectWhat(attributes,trigger,bonus);
                const nonRecursiveEvalKeys = [],
                sortAffected = (keys)=>{
                    //TAS.log('keys: '+JSON.stringify(keys));
                    let key = keys.shift();
                    let insertIndex = 0;
                    //TAS.log('sortedAffectedKeys: '+JSON.stringify(sortedAffectedKeys));
                    _.each(_.range(sortedAffectedKeys.length),(i)=>{
                        //TAS.log('sortedAffectedKeys['+i+']: '+sortedAffectedKeys[i]);
                        //TAS.log('affected['+sortedAffectedKeys[i]+']: '+JSON.stringify(affected[sortedAffectedKeys[i]]));
                        if(_.contains(affected[sortedAffectedKeys[i]].affects,key)){
                            insertIndex=i + 1;
                        }
                    });
                    sortedAffectedKeys.splice(insertIndex,0,key);
                    if(keys[0]){
                        sortAffected(keys);
                    }
                };
                
            let bTotal,//total buff
                sectionIDs,//array for all section IDs
                repeatIDs,//Array of the applicable repeating IDs
                rpAbility,//resolve point ability value
                specificBonus,//holds the specific bonus object for the attribute being worked on
                abilityMax,//The maximum ability score to apply
                levelClass=0,
                spellFilters = [],
                affectedKeys = _.keys(affected),
                sortedAffectedKeys = [];
                affectedKeys = _.reject(affectedKeys,(key)=>{
                    if((/^strength$/.test(key) && attributes.sheet_type==='pc')||/_proficiency|repeating_spell_[^_]+_filter|caster_level|encumber_bulk|overburden_bulk|character_level|bab|(?:ref|will|fort)?_base$|encumber_level|wealth|carried_bulk|asleep|bleeding|blinded|burning|confused|cowering|dazed|dazzled|dead|deafened|dying|encumbered|entangled|exhausted|fascinated|fatigued|flat_footed|frightened|grappled|helpless|nauseated|negative_levels|off_kilter|off_target|overburdened|panicked|paralyzed|pinned|prone|shaken|sickened|stable|staggered|stunned|unconscious/.test(key)){
                        if(/^strength$|encumber_level|wealth|carried_bulk|encumber_bulk|overburden_bulk|caster_level/.test(key)){
                            nonRecursiveEvalKeys.push(key);
                        }else if(/repeating_spell_[^_]+_filter/.test(key)){
                            spellFilters.push(key);
                        }
                        return true;
                    }else{
                        return false;
                    }
                });
                sortAffected(affectedKeys);
                affectedKeys = _.reject(sortedAffectedKeys,(sak)=>{return !sak});
            /*Caster Class buffing*/
            if((setObj.is_caster||attributes.is_caster)&&setObj.is_caster!==0&&_.contains(nonRecursiveEvalKeys,'caster_level')){
                if(!setObj.caster_level){
                    const convertProgress = {//object of fat arrow functions that calculates the spell level available for a class
                       'half':(lvl)=>lvl >= 13 ? 4 : lvl >= 10 ? 3 : lvl >= 7 ? 2 : lvl >= 4 ? 1 : 0,
                       'partial':(lvl)=> lvl >= 16 ? 6 : lvl >= 13 ? 5 : lvl >= 10 ? 4 : lvl >= 7 ? 3 : lvl >= 4 ? 2 : lvl >= 1 ? 1 : 0,
                       'full_prep':(lvl)=>Math.min(Math.floor((lvl+ 1)/2),9),
                       'full_spont':(lvl)=>lvl*1===1 ? 1 : Math.floor(lvl/2)
                    };
                    setObj.caster_level = 0;
                    setObj = _.reduce([1,2,3,4,5],(memo,n)=>{
                        let preClass='class_'+n;
                        if(attributes[preClass+'_spells']*1===1){
                            memo['caster_level']+=(attributes[preClass+'_level']*1||0);
                        }
                        return memo;
                    },setObj);
                    attributes.caster_level = setObj.caster_level;
                }
                if(attributes.caster_level>0){
                    bTotal=calcBuffs(attributes,bonus.caster_level,setObj).total;
                    setObj.caster_level=attributes.caster_level + bTotal;
                    setObj.caster_level_change=bTotal > 0 ? 1 : bTotal < 0 ? -1 : 0;
                }
            }
            if(attributes.sheet_type==='pc'){
                /*Encumbrance*/
                const bulkCost = [];
                let bulkTest = false,
                    wealthTest = false;
                if(_.contains(nonRecursiveEvalKeys,'carried_bulk')){
                    setObj.carried_bulk = 0;
                    bulkCost.push('bulk');
                    bulkTest = true;
                }
                if(_.contains(nonRecursiveEvalKeys,'wealth')){
                    setObj.wealth = 0;
                    bulkCost.push('cost');
                    wealthTest = true;
                }
                if(bulkTest||wealthTest){
                    _.each(_.keys(attributes),(a)=>{
                        let aMatch =a.match(new RegExp('repeating_item_-[^_]+_('+bulkCost.join('|')+')'));
                        if(aMatch){
                            if(aMatch[1]==='bulk' && attributes[a.replace(/bulk/,'equipped')]!=='not carried'){
                                setObj.carried_bulk = setObj.carried_bulk + ((attributes[a]+'').match(/l/i) ? 0.1 : attributes[a]*1||0)*attributes[a.replace(/bulk/,'quantity')]||0;
                            }else if(aMatch[1]==='cost'){
                                setObj.wealth=setObj.wealth + (attributes[a]*1||0)*attributes[a.replace(/cost/,'quantity')]||0;
                            }
                        }
                    });
                    if(bulkTest){
                        setObj.carried_bulk=Math.floor(setObj.carried_bulk)||0;
                        attributes.carried_bulk = setObj.carried_bulk;
                    }
                }
                _.each(spellFilters,(filter)=>{
                    let sLevel = attributes[filter.replace(/filter/,'level')];
                    setObj[filter] = sLevel*1 ? Math.min(Math.max(sLevel,1),9) : 'cantrip';
                });
                if(_.contains(nonRecursiveEvalKeys,'strength')){
                    /*strength handling*/
                    //Strength calculations are not included in the iteration further down due to their effect on carry weight
                    specificBonus=calcBuffs(attributes,bonus.strength,setObj);//Converts specific Bonus to the calculated object.
                    bTotal = specificBonus.total;//sets bTotal to the total value from specificBonus
                    setObj.strength = (attributes.strength_base*1||0) - (Math.abs(attributes.strength_drain*1||0)) + bTotal;
                    attributes.strength = setObj.strength;
                    setObj.strength_misc = specificBonus.misc;
                    setObj.strength_change = bTotal > 0 ? 1 : (bTotal < 0 ? -1 : 0);
                }
                const strength_track = _.chain(_.keys(attributes))
                        .filter((attr)=>{
                            return /_condition_[^_]+_track/.test(attr) && attributes[attr]==='strength_track';
                        })
                        .reduce((memo,attr)=>{
                            if(attributes[attr+'_status']!=='healthy'){
                                if(attributes[attr+'_status']!=='weakened'){
                                    memo=3;
                                }else{
                                    memo = Math.max(memo,2);
                                }
                            }
                            return memo;
                        },1)
                        .value();
                if(_.contains(nonRecursiveEvalKeys,'encumber_bulk')){
                    bTotal=calcBuffs(attributes,bonus.encumber_bulk,setObj).total;
                    if(strength_track*1>1){
                        setObj.encumber_bulk = 0;
                        setObj.encumber_bulk_change=-1;
                    }else{
                        setObj.encumber_bulk = Math.floor(attributes.strength/2)+ 1 +bTotal;
                        setObj.encumber_bulk_change=bTotal > 0 ? 1 : (bTotal < 0 ? -1 : 0);
                    }
                    attributes.encumber_bulk=setObj.encumber_bulk;
                }
                if(_.contains(nonRecursiveEvalKeys,'overburden_bulk')){
                    if(strength_track*1>1){
                        setObj.overburden_bulk = Math.max(Math.floor(((attributes.strength*1||0)+bTotal)/3),1);
                        setObj.overburden_bulk_change=-1;
                    }else{
                        bTotal=calcBuffs(attributes,bonus.overburden_bulk,setObj).total;
                        setObj.overburden_bulk = (attributes.strength*1||0)+bTotal;
                        setObj.overburden_bulk_change=bTotal > 0 ? 1 : (bTotal < 0 ? -1 : 0);
                    }
                    attributes.overburden_bulk=setObj.overburden_bulk;
                }
                if(_.contains(nonRecursiveEvalKeys,'encumber_level')){
                    if(strength_track===1){
                        setObj.encumber_level = Math.min(Math.floor(attributes.carried_bulk/attributes.encumber_bulk||0),1)+Math.min(Math.floor(attributes.carried_bulk/attributes.overburden_bulk||0),1);
                    }else if(strength_track<3){
                        setObj.encumber_level = 1+Math.min(Math.floor(attributes.carried_bulk/attributes.overburden_bulk||0),1);
                    }else{
                        setObj.encumber_level = 2;
                    }
                    if(setObj.encumber_level > 0){
                        bonus.eac = bonus.eac || {};
                        bonus.kac = bonus.kac || {};
                        bonus.eac.max_dex = bonus.eac.max_dex || [];
                        bonus.kac.max_dex = bonus.kac.max_dex || [];
                        bonus.acp = bonus.acp || {acp:[]};
                        bonus.acp.acp.push(-5);
                        if(setObj.encumber_level>1){
                            bonus.eac.max_dex.push(0);
                            bonus.kac.max_dex.push(0);
                        }else{
                            bonus.eac.max_dex.push(2);
                            bonus.kac.max_dex.push(2);
                        }
                    }
                }
            }
            _.each(affectedKeys,(key)=>{
                TAS.log(`key: ${key}`);
                let id = '';
                key.replace(/repeating_[^_]+_[^_]+_/,(match)=>{
                    id=match;
                });
                if(/_dc/.test(key) && /sp/i.test(attributes[id+'type'])){
                    affected[key].attrAdds=[];
                    affected[key].multAdds=[];
                    affected[key].repeatAdds=[id+'level'];
                }
                if(key==='rp_max'){//The rp attribute has special handling
                    if(attributes.resolve_source==='key'){//RAW RP calculation
                        rpAbility=_.reduce([1,2,3,4,5],(m,n)=>{
                            if(attributes['class_'+n+'_level']>0){
                                m = _.max([m,attributes[attributes['class_'+n+'_ability'].replace(/@{|}/g,'')]*1]);
                            }
                            return m;
                        },0);
                    }else{//Homebrew Calculation
                        rpAbility=_.max([attributes.strength_mod,attributes.dexterity_mod,attributes.constitution_mod,attributes.intelligence_mod,attributes.wisdom_mod,attributes.charisma_mod,0],(v)=>{return v*1});
                    }
                }else{//if affected[key].attr is not rp_max, rpAbility is 0
                    rpAbility=0;
                }
                bTotal=0;//reset bTotal
                let attributeMod;
                if(attributes.sheet_type==='pc'){
                    attributeMod=_.reduce([attributes[(attributes[id+affected[key].ability]+'').replace(/@{|}/g,'')]*1,rpAbility*1],(m,a)=>{
                        if((a||a===0) && m===''){
                            m=a;
                        }
                        return m;
                    },'');//Set the mod score of the relevant attribute
                }else{
                    const abiSwap = {
                        ref:'dexterity_mod',
                        fort:'constitution_mod',
                        will:'wisdom_mod',
                        eac:'dexterity_mod',
                        kac:'dexterity_mod',
                        cmd:'dexterity_mod',
                        initiative:'dexterity_mod',
                        npc_init:'dexterity_mod'
                    };
                    let abi;
                    if(affected[key].ability==='abi'){
                        abi=abiSwap[key];
                    }else{
                        abi=(attributes[id+affected[key].ability]+'').replace(/@{|}/g,'');
                    }
                    if(/_ranks|base_attack_bonus$|npc_init/.test(key)){
                        abi=abi.replace(/_mod/,'_base');
                        if(/_ranks|npc_init/.test(key) && attributes[key.replace(/_ranks/,'').replace(/npc_init/,'initiative')]){
                            attributeMod=0;
                        }else{
                            attributeMod=attributes[abi]*-1||0;
                        }
                    }else{
                        attributeMod = ((attributes[abi]*1||0) - (attributes[abi.replace(/_mod/,'_base')]*1||0));
                    }
                }
                if(affected[key].moddable||affected[key].rollTime){
                    specificBonus = bonus[key.replace(/repeating_[^_]+_[^_]+_/,'').replace(/spell_resistance/,'spell_penetration')] || {};//assign specificBonus to the relevant bonus object or an empty object
                    _.each(bonusKeys,(k)=>{//Looks for special bonus keywords like attack and damage, and looks for special filtering of buffs
                        if(k.startsWith(key.replace(/repeating_[^_]+_[^_]+_/,'')+'|')||(k.startsWith('attack')&&/repeating_[^_]+_[^_]+_(?:attack_)?total/.test(key))||(k.startsWith('damage')&&/damage_total$/.test(key))){/*Handling for filtering application of buffs to attributes based on filtering syntax.
                                                                                                                                                                                Looks for bonus keys that start with the relevant attribute name with the | after it or special attack/damage syntax*/
                            let kSplit = k.replace(/[^|]+\|/,'').split(/\s*,\s*/g);//remove the non filtering text from the bonus key and split the objects to filter by into their separate keys
                            let objSpec = _.reduce(kSplit,(m,s)=>{
                                let sSplit = s.split(/:/);//separate the name of the attribute to filter by from the value to look for
                                if(sSplit[1]){
                                    m[sSplit[0]]=sSplit[1];//undo the earlier handling for spaces
                                }
                                return m;
                            },{});
                            if(_.isEmpty(objSpec)||_.every(_.keys(objSpec),(os)=>{
                                if(os.toLowerCase()==='section'){
                                    return affected[key].repeating.toLowerCase()===objSpec[os.toLowerCase()].toLowerCase();
                                }else{
                                    return (setObj[id+os] ? (setObj[id+os]+'').toLowerCase()===objSpec[os].toLowerCase() : (attributes[id+os]+'').toLowerCase()===objSpec[os].toLowerCase());
                                }
                            })){//Check to see if the current attribute matches the filtering
                                _.each(_.keys(bonus[k]),(sk)=>{//iterate through the keys of the bonus types for the attribute in question
                                    specificBonus[sk]=specificBonus[sk] || [];//Default the array of the bonuses for this type to an array if it doesn't already exist
                                    specificBonus[sk]=specificBonus[sk].concat(bonus[k][sk]);//Concatenate the current bonuses of a given type with the new array of bonuses for that type
                                });
                            }
                        }
                    });
                    if(attributes[id+(affected[key].repeating ?'acp' : key+'_acp')]*1===1){//if there is an attribute for acp
                        specificBonus.acp=bonus.acp ? bonus.acp.acp : 0;//set the acp key of specificBonus to the acp array from bonus
                    }
                    specificBonus = calcBuffs(attributes,specificBonus,setObj,key==='acrobatics' ? true : false);//Convert the specificBonus object to an object of the calculated bonuses
                    if(affected[key].rollTime){
                        setObj[key.replace(/total$|profession$|_npc|spell_resistance/,'')+affected[key].rollTime]=specificBonus.misc||'';//set the attribute for holding rollTime evaluation macros of bonuses
                    }
                    abilityMax = _.min([attributeMod,specificBonus.max_dex*1,(attributes.dexterity_track*1 > 2 ? 0 : undefined)]);//figures the maximum ability to be applied
                    let abilityDiff = abilityMax - attributeMod;//if this is negative, and overwhelms any bonuses, the attr is formatted for penalty
                    bTotal = specificBonus.total + (/eac|kac/.test(key) ? 0 : specificBonus.armor*1||0);
                    if(affected[key].moddable){
                        setObj[key.replace(/_max|_profession$/,'')+affected[key].moddable]=(bTotal+abilityDiff) > 0 ? 1 : ((bTotal+abilityDiff) < 0 ? -1 : 0);
                    }
                }else{
                    abilityMax = attributeMod;//abilityMax defaults to attributeMod if not moddable
                }
                //assemble the numerical values of the attribute
                if(!/spell_resistance/.test(key)){
                    let memoNum = _.reduce(affected[key].repeatParseField,(m,add)=>{//Handles fields that will have macro syntax in them
                                let calculated = calcBuffs(attributes,{untyped:[attributes[add]]},setObj).total
                                return m + calculated;
                            },0)//add the value of the parse field
                            +abilityMax//add the maximum ability score
                            +(affected[key].numAdds||0);//add any flat numbers that should be added to the attribute
                            TAS.log(`abilityMax: ${abilityMax}`);
                            TAS.log(`1st memoNum: ${memoNum}`);
                            memoNum+=_.reduce(_.range(affected[key].attrAdds.length),(m,add)=>{//iterate through all the attributes to add to the attribute and add their numerical values
                                TAS.log(`attributes[${affected[key].attrAdds[add]}]: ${attributes[affected[key].attrAdds[add]]} | attributes[${affected[key].multAdds[add]}]: ${attributes[affected[key].multAdds[add]]}`);
                                let csMatch = affected[key].attrAdds[add].match('class_skill');
                                levelClass = 0;
                                if(affected[key].attr==='dc' && affected[key].attrAdds[add]==='lvl'){//if the attribute is the dc, or attrAdds of the obj is "lvl"
                                    if(affected[key].repeating==='ability'){//if the repeating section is "ability"
                                        levelClass = _.reduce([1,2,3,4,5],(mem,n)=>{//iterate through all the classes
                                            if(attributes['class_'+n+'_name'].toLowerCase()===attributes[id+'source'].toLowerCase()){//check if the name of the class is the same as the source of the section in question
                                                mem=attributes['class_'+n+'_level']*1||0;//set the memo to the level of this class (There should only ever be one match, so there is no handling for multiple matches)
                                            }
                                            if(n===5 && mem===0){//check if all the classes have been iterated through already and no level has already been recognized (This should never be 0)
                                                mem=attributes.character_level;//set mem to the total character_level
                                            }
                                            return mem;
                                        },0);
                                    }
                                }
                                if(attributes.sheet_type==='npc' && affected[key].isSkill){//handling for npc skills
                                    if(attributes[affected[key].attrAdds[add]]*1){//otherwise add it to m
                                        m+=(attributes[affected[key].attrAdds[add]]*1||0)-(rpAbility*1||0);
                                    }
                                }else if(!csMatch || attributes[affected[key].attrAdds[add].replace(/class_skill/,'ranks')]*1>0){//if the attribute being added is either not a class skill attribute or the skill's ranks are at least 1
                                    if(affected[key].attrAdds[add].match(/(?:strength|dexterity|constitution|intelligence|wisdom|charisma)_(?:penalty|drain)/)){//special calculation for penalty/drain
                                        m-=Math.abs(Math.floor((attributes[affected[key].attrAdds[add]]*1||levelClass||0)*(affected[key].multAdds[add]*1||attributes[affected[key].multAdds[add]]*1||1)));
                                    }else{//otherwise add the value to m
                                        m+=Math.floor((attributes[affected[key].attrAdds[add]]*1||levelClass||0)*(affected[key].multAdds[add]*1||attributes[affected[key].multAdds[add]]*1||1));
                                    }
                                }
                                TAS.log(`m: ${m}`);
                                return m;
                            },0);
                            TAS.log(`2nd memoNum: ${memoNum}`);
                            memoNum+=_.reduce(affected[key].repeatAdds,(m,add)=>{//iterate through all of the attributes internal to the repeating section to add
                                let csMatch = add.match('class_skill');
                                TAS.lo
                                if(!csMatch || attributes[add.replace(/class_skill/,'ranks')]*1>0){//This is the same handling for class skills as seen above
                                    m+=(attributes[add]*1||0);
                                }
                                return m;
                            },0)
                            +bTotal//add the total numerical value of the bonus for the attribute
                            +_.reduce(affected[key].addlBonus,(m,add)=>{//add any additional bonuses to the attribute (bonuses not specifically called out to this attribute)
                                return m+(specificBonus[add]*1||0);
                            },0);
                            TAS.log(`3rd memoNum: ${memoNum}`);
                    //assembles the text values of the attribute
                    let memoText=_.reduce(affected[key].repeatTextAdds,(m,add)=>{//iterate through all of the attributes within the repeating item that should hold text
                            return m+(attributes[add]||'')
                        },'')+_.reduce(affected[key].textAdds,(m,add)=>{//iterate through all of the attributes within the repeating item that should hold text
                            return m+(attributes[add]||'')
                        },'');
                    if(key.match(/_filter/) && affected[key].repeating==='spell'){//handling for the filtering attribute for spells
                        setObj[key]=Math.min(Math.max(attributes[key]*1||0,0),9);//set the filter attribute to the level of the spell or to 0 if no level parsed
                        setObj[key]=attributes[key]*1===0 ?'cantrip' : attributes[key];
                    }else if(/repeating_(?:attack|spell|ability)_[^_]+_(?:damage_)?total/.test(key)){
                        if(attributes.sheet_type==='pc' && /repeating_attack/.test(key)){
                            if(attributes[id+'proficiency']==='no'){//setting the prof value to -4 when not prof
                                setObj[id+'proficiency_value']=-4;
                                setObj[id+'damage_proficiency_value']=0;
                                attributes[id+'proficiency_value']=setObj[id+'proficiency_value'];
                                attributes[id+'damage_proficiency_value']=setObj[id+'damage_proficiency_value'];
                            }else if(attributes[id+'proficiency']==='specialized'){//setting the damage prof value to level or half level (depending on weapon type or weapon special properties) if specialized
                                setObj[id+'proficiency_value']=0;
                                attributes[id+'proficiency_value']=setObj[id+'proficiency_value'];
                                if(_.some(attributes.half_specializations.toLowerCase().split(/,|\n+/),(half)=>{
                                    return attributes[id+'category'].toLowerCase().match(half)||attributes[id+'special'].toLowerCase().match(half);
                                })){
                                    setObj[id+'damage_proficiency_value']=Math.floor((attributes.character_level*1)/2);
                                    attributes[id+'proficiency_value']=setObj[id+'proficiency_value'];
                                }else{
                                    setObj[id+'damage_proficiency_value']=attributes.character_level*1;
                                    attributes[id+'damage_proficiency_value']=setObj[id+'damage_proficiency_value'];
                                }
                            }else{
                                setObj[id+'proficiency_value']=0;
                                setObj[id+'damage_proficiency_value']=0;
                                attributes[id+'proficiency_value']=setObj[id+'proficiency_value'];
                                attributes[id+'damage_proficiency_value']=setObj[id+'damage_proficiency_value'];
                            }
                        }else{
                            if(/repeating_attack/.test(key)){
                                setObj[id+'proficiency_value']=0;
                                attributes[id+'proficiency_value']=setObj[id+'proficiency_value'];
                                setObj[id+'damage_proficiency_value']=attributes.cr*1||0;
                                attributes[id+'damage_proficiency_value']=setObj[id+'damage_proficiency_value'];
                            }
                            setObj[`${id}damage_ability_base`]=attributes[`${id}damage_ability`].replace(/_mod/,'_base');
                        }
                        memoNum+=setObj[id+(/repeating_[^_]+_[^_]+_total/.test(key) ? 'proficiency_value' : 'damage_proficiency_value')]*1||0;
                    }
                    memoNum=memoNum || 0;
                    if(key==='dexterity_mod' && (attributes.helpless*1===1 || attributes.paralyzed*1===1)){
                        memoNum=-5;
                    }else if(/intelligence/.test(key)){
                        let intelligence_tracks = _.filter(_.keys(attributes),(cond)=>{
                            return /_track_status$/.test(cond) && attributes[cond.replace(/_status/,'')]==='intelligence_track';
                        });
                        if(_.every(intelligence_tracks,(track)=>{return /healthy|weakened|impaired/.test(attributes[track])})){
                            setObj.intelligence_change = setObj.intelligence_change||0;
                        }else{
                            if(key==='intelligence' && attributes.sheet_type==='pc'){
                                memoNum = 1;
                                setObj.intelligence_change = -1;
                            }else if(key==='intelligence_mod' && attributes.sheet_type==='npc'){
                                memoNum = -5;
                                setObj.intelligence_change = -1;
                            }
                        }
                    }
                    memoText=memoText || '';
                    setObj[key]=(memoText+' +'+memoNum).replace(/(.+)\s+\+\s*0/,'$1');
                    if(!/_total$/.test(key)||affected[key].repeating!=='attack'){
                        setObj[key]=setObj[key].replace(/^\s*\+/,'');
                    }
                    setObj[key]=setObj[key].replace(/\+\-/g,'-');
                    if(!/(?:rp|sp|hp)_max/.test(key)){
                        attributes[key]=setObj[key];
                    }
                }
            });
            if(attributes.sheet_type==='pc'){
                //calculates the skill points used and available
                let skillRanks = _.filter(_.keys(attributes),(a)=>{return a.match(/_ranks/)});
                setObj.skill_points=_.reduce(skillRanks,(memo,r)=>{
                    return memo+(attributes[r]*1||0);
                },0);
                if(attributes.drone*1===1){//handling for when the sheet is a pc drone
                    if(setObj.sp_max){
                        setObj.sp_max=0;
                    }
                    if(setObj.hp_max){
                        setObj.hp_max=_.reduce(_.range(1,(setObj.character_level*1||attributes.character_level*1||0) + 1),(memo,l)=>{
                            return memo + 10*(1+Math.floor(l/18));
                        },0);
                    }
                    if(setObj.rp_max){
                        setObj.rp_max=0;
                    }
                }else if(setObj.rp_max){
                    setObj.rp_max=Math.max((setObj.rp_max*1+Math.max(Math.floor((setObj.character_level*1||attributes.character_level*1||0)/2),1)),1);
                }
                _.each(['sp','hp','rp','temp_hp'],(p)=>{
                    if(setObj[p+'_max'] || setObj[p+'_max']===0){
                        setObj[p]=Math.max(Math.min((attributes[p]*1||0)+((setObj[p+'_max']*1||0)-(attributes[p+'_max']||0)),(setObj[p+'_max']*1||0)),0);
                    }
                });
            }
            storeInfo(attributes);
            TAS.log('setObj: '+JSON.stringify(setObj));
            setObj=buildMenus(attributes,setObj);//build the menus
            setAttrs(setObj,{silent:true});
        },
        
        dropObjs = {
            npc:{
                //sheet_attribute:{data:[array of data keys to add/concatenate],propagates_to:[array of sheet attributes that the final calculated value propagates to],default_adds:[array of arrays, each array contains a sheet attribute or raw value to add and a multiplier],default_value:what value to use if there isn't a data attribute passed},
                character_name:{data:['name'],default_value:''},
                tab_select:{default_value:0},
                character_level:{data:['cr'],default_value:''},
                xp:{data:['xp'],default_value:''},
                race:{data:['race','creature type graft','class grafts','other grafts'],joiner:' ',default_value:''},
                alignment:{data:['alignment'],default_value:''},
                size:{data:['size'],translator:{Fine:-4,Diminutive:-3,Tiny:-2,Small:-1,Medium:0,Large:1,Huge:2,Colossal:3,Gargantuan:4},default_value:'Medium'},
                type_subtype:{data:['type (subtype)'],default_value:''},
                initiative_base:{data:['initiative'],propagates_to:['initiative'],default_value:0},
                senses:{data:['senses'],propagates_to:[],default_value:''},
                aura:{data:['aura'],propagates_to:[],default_value:''},
                hp:{data:['hp'],propagates_to:['hp_max'],default_value:0},
                rp:{data:['rp'],propagates_to:['rp_max'],default_value:0},
                eac_base:{data:['eac'],propagates_to:['eac'],default_value:10},
                kac_base:{data:['kac'],propagates_to:['kac'],default_value:10},
                cmd_base:{data:['cmd'],propagates_to:['cmd'],default_adds:[['kac_base',1],[8,1]],default_value:0},
                ac_notes:{data:['ac-notes'],propagates_to:[],default_value:''},
                fort_base:{data:['fort'],propagates_to:['fort'],default_value:0},
                ref_base:{data:['ref'],propagates_to:['ref'],default_value:0},
                will_base:{data:['will'],propagates_to:['will'],default_value:0},
                save_notes:{data:['save-notes'],propagates_to:[],default_value:''},
                defensive_abilities:{data:['defensive-abilities'],propagates_to:[],default_value:''},
                dr:{data:['dr'],propagates_to:[],default_value:''},
                immunities:{data:['immunities'],propagates_to:[],default_value:''},
                sr:{data:['sr'],propagates_to:[],default_value:0},
                resistances:{data:['resistances'],propagates_to:[],default_value:''},
                weaknesses:{data:['weaknesses'],propagates_to:[],default_value:''},
                speed:{data:['speed'],propagates_to:[],default_value:''},
                offensive_abilities:{data:['offensive abilities'],propagates_to:[],default_value:''},
                space:{data:['space'],propagates_to:[],default_value:''},
                reach:{data:['reach'],propagates_to:[],default_value:''},
                caster_level:{data:['caster level'],propagates_to:[],default_value:0},
                strength_base:{data:['strength mod'],propagates_to:['strength_mod'],default_value:0},
                dexterity_base:{data:['dexterity mod'],propagates_to:['dexterity_mod'],default_value:0},
                constitution_base:{data:['constitution mod'],propagates_to:['constitution_mod'],default_value:0},
                intelligence_base:{data:['intelligence mod'],propagates_to:['intelligence_mod'],default_value:0},
                wisdom_base:{data:['wisdom mod'],propagates_to:['wisdom_mod'],default_value:0},
                charisma_base:{data:['charisma mod'],propagates_to:['charisma_mod'],default_value:0},
                acrobatics_base:{data:['acrobatics'],propagates_to:['acrobatics'],default_value:0},
                athletics_base:{data:['athletics'],propagates_to:['athletics'],default_value:0},
                bluff_base:{data:['bluff'],propagates_to:['bluff'],default_value:0},
                computers_base:{data:['computers'],propagates_to:['computers'],default_value:0},
                culture_base:{data:['culture'],propagates_to:['culture'],default_value:0},
                diplomacy_base:{data:['diplomacy'],propagates_to:['diplomacy'],default_value:0},
                disguise_base:{data:['disguise'],propagates_to:['disguise'],default_value:0},
                engineering_base:{data:['engineering'],propagates_to:['engineering'],default_value:0},
                intimidate_base:{data:['intimidate'],propagates_to:['intimidate'],default_value:0},
                life_science_base:{data:['life science'],propagates_to:['life_science'],default_value:0},
                medicine_base:{data:['medicine'],propagates_to:['medicine'],default_value:0},
                mysticism_base:{data:['mysticism'],propagates_to:['mysticism'],default_value:0},
                perception_base:{data:['perception'],propagates_to:['perception'],default_value:0},
                physical_science_base:{data:['physical science'],propagates_to:['physical_science'],default_value:0},
                piloting_base:{data:['piloting'],propagates_to:['piloting'],default_value:0},
                sense_motive_base:{data:['sense motive'],propagates_to:['sense_motive'],default_value:0},
                sleight_of_hand_base:{data:['sleight of hand'],propagates_to:['sleight_of_hand'],default_value:0},
                stealth_base:{data:['stealth'],propagates_to:['stealth'],default_value:0},
                survival_base:{data:['survival'],propagates_to:['survival'],default_value:0},
                feats:{data:['feats'],default_value:''},
                languages:{data:['languages'],default_value:''},
                other_abilities:{data:['other abilities'],default_value:''},
                gear:{data:['gear'],default_value:''},
                environment:{data:['environment'],default_value:''},
                organization:{data:['organization'],default_value:''},
                tactics:{data:['tactics'],default_value:''},
            },
        },
        
        dropHandler = function(event){
            let category = event.newValue;
            const categorySwitch = {
                    NPCs:npcDropHandler,
                    Equipment:equipmentDropHandler,
                    Spells:spellDropHandler,
                    Abilities:abilityDropHandler
                },
                dropSkillList = _.reject(skillList,(skill)=>{return skill === 'profession'}),
                attributeNames = sheetAttributes.concat(['drop_name','drop_category','drop_data','drop_content']),
                setObj = {
                    drop_name:'',
                    drop_category:'',
                    drop_data:'',
                    drop_content:''
                };
            
            TAS.log(`Drop Category Change: ${JSON.stringify(event)}`);
            getAttrs(attributeNames,(dropValues)=>{
                dropValues.drop_data = JSON.parse(dropValues.drop_data);
                dropValues.drop_data.name=dropValues.drop_name;
                dropValues.drop_data.content = dropValues.drop_content;
                categorySwitch[category](dropValues,setObj);
                buildMenus(dropValues,setObj);
                setAttrs(setObj,{silent:true});
            });
        },
        
        npcDropHandler = function(attributes,setObj){
            const data = attributes.drop_data,
                dropSkillList = _.reject(skillList,(skill)=>{return skill === 'profession'});
                
            setObj.sheet_type='npc';
            attributes.sheet_type='npc';
                
            _.each(_.keys(dropObjs.npc),(attr)=>{
                setObj[attr] = _.reduce(dropObjs.npc[attr].data,(memo,dataKey)=>{
                    let iterativeAdd = data[dataKey]||dropObjs.npc[attr].default_value;
                    if(typeof dropObjs.npc[attr].default_value ==='number'){
                        iterativeAdd = iterativeAdd*1||dropObjs.npc[attr].default_value;
                    }else if(dropObjs.npc[attr].joiner){
                        iterativeAdd+=dropObjs.npc[attr].joiner;
                    }
                    return memo += iterativeAdd;
                },(typeof dropObjs.npc[attr].default_value === 'number' ? 0 : ''));
                if(setObj[attr]===dropObjs.npc[attr].default_value){
                    _.each(dropObjs.npc[attr].default_adds,(add)=>{
                        if(typeof add[0] ==='string'){
                            setObj[attr]+=setObj[add[0]]*add[1];
                        }else{
                            setObj[attr]+=add[0]*add[1];
                        }
                    });
                }
                if(dropObjs.npc[attr].translator){
                    setObj[attr]=dropObjs.npc[attr].translator[setObj[attr]];
                }
                if(typeof setObj[attr] === 'string'){
                    setObj[attr]=setObj[attr].trim();
                }
                _.each(dropObjs.npc[attr].propagates_to,(prop)=>{
                    setObj[prop] = setObj[attr];
                });
            });
            _.each(dropSkillList,(skill)=>{
                if(setObj[`${skill}_base`]*1 === 0){
                    setObj[`${skill}_ranks`] = 0;
                    setObj[`${skill}`] = setObj[attributes[`${skill}_ability`].replace(/@{|}/g,'')]*1||0;
                    setObj[`${skill}_base`] = setObj[attributes[`${skill}_ability`].replace(/@{|}/g,'')]*1||0;
                }else{
                    setObj[`${skill}_ranks`]=setObj[`${skill}_base`]*1 - setObj[attributes[`${skill}_ability`].replace(/@{|}/g,'')]*1||0;
                }
            });
            if(data['data-profession']){
                data['data-profession']=JSON.parse(data['data-profession']);
                _.each(data['data-profession'],(profObj)=>{
                    let rowID = generateRowID();
                    setObj[`repeating_profession_${rowID}_name`]=profObj.name||'';
                    if(profObj.mod*1===0){
                        setObj[`repeating_profession_${rowID}_ranks`]=0;
                        setObj[`repeating_profession_${rowID}_profession`]=setObj.intelligence_mod;
                        setObj[`repeating_profession_${rowID}_base`]=setObj.intelligence_mod;
                    }else{
                        setObj[`repeating_profession_${rowID}_base`]=profObj.mod||0;
                        setObj[`repeating_profession_${rowID}_profession`]=profObj.mod||0;
                        setObj[`repeating_profession_${rowID}_ranks`]=profObj.mod*1 - setObj.intelligence_mod*1||0;
                    }
                });
            }
            //Attack parsing
            if(data['data-attacks']){
                data['data-attacks']=JSON.parse(data['data-attacks']);
                _.each(data['data-attacks'],(obj)=>{
                    let rowID = generateRowID();
                    setObj[`repeating_attack_${rowID}_name`]=obj.name||'';
                    setObj[`repeating_attack_${rowID}_base_attack_bonus_base`]=obj.attack_total*1||0;
                    setObj[`repeating_attack_${rowID}_total`]=obj.attack_total*1||0;
                    setObj[`repeating_attack_${rowID}_damage_dice`]=obj.damage_total||'';
                    setObj[`repeating_attack_${rowID}_damage_total`]=obj.damage_total||'';
                    setObj[`repeating_attack_${rowID}_type`]=obj.damage_type||'';
                    setObj[`repeating_attack_${rowID}_crit`]=obj.critical_effect||'';
                    setObj[`repeating_attack_${rowID}_special`]=obj.special||'';
                    setObj[`repeating_attack_${rowID}_engagement_range`]=(obj.engagement_range||'melee').toLowerCase();
                    setObj[`repeating_attack_${rowID}_range_filter`]=(obj.engagement_range||'melee').toLowerCase();
                    setObj[`repeating_attack_${rowID}_show_options`]=0;
                    if(/ranged/i.test(obj.engagement_range)){
                        setObj[`repeating_attack_${rowID}_ability`]='@{dexterity_mod}';
                        setObj[`repeating_attack_${rowID}_damage_ability`]=0;
                        setObj[`repeating_attack_${rowID}_base_attack_bonus`]=setObj[`repeating_attack_${rowID}_base_attack_bonus_base`]*1 - setObj.dexterity_mod*1||0;
                    }else{
                        setObj[`repeating_attack_${rowID}_ability`]='@{strength_mod}';
                        setObj[`repeating_attack_${rowID}_damage_ability`]='@{strength_mod}';
                        setObj[`repeating_attack_${rowID}_base_attack_bonus`]=setObj[`repeating_attack_${rowID}_base_attack_bonus_base`]*1 - setObj.strength_mod*1||0;
                    }
                });
            }
            //Spell parsing
            if(data['data-spells']){
                data['data-spells']=JSON.parse(data['data-spells']);
                _.each(data['data-spells'],(obj)=>{
                    let rowID = generateRowID();
                    setObj[`repeating_spell_${rowID}_show_options`]=0;
                    setObj[`repeating_spell_${rowID}_name`]=obj.name||'';
                    setObj[`repeating_spell_${rowID}_dc_base`]=obj.dc||10;
                    setObj[`repeating_spell_${rowID}_dc`]=obj.dc||10;
                    setObj[`repeating_spell_${rowID}_level`]=obj.level||0;
                });
            }
            //Ability parsing
            if(data['data-abilities']){
                data['data-abilities']=JSON.parse(data['data-abilities']);
                _.each(data['data-abilities'],(obj)=>{
                    let rowID = generateRowID();
                    setObj[`repeating_ability_${rowID}_show_options`]=0;
                    setObj[`repeating_ability_${rowID}_name`]=obj.name||'';
                    setObj[`repeating_ability_${rowID}_dc_base`]=obj.dc||10;
                    setObj[`repeating_ability_${rowID}_dc`]=obj.dc||10;
                    setObj[`repeating_ability_${rowID}_level`]=obj.level||0;
                    setObj[`repeating_ability_${rowID}_type`]=obj.type||'';
                    setObj[`repeating_ability_${rowID}_duration`]=obj.duration||'';
                    setObj[`repeating_ability_${rowID}_type`]=obj.type||'';
                    setObj[`repeating_ability_${rowID}_frequency`]=(obj.frequency||'').toLowerCase();
                    setObj[`repeating_ability_${rowID}_description`]=obj['description']||'';
                });
            }
        },
        
        abilityDropHandler = function(data,setObj){
            
        },
        
        spellDropHandler = function(data,setObj){
            
        },
        
        equipmentDropHandler = function(data,setObj){
            
        },
        
        bootup = function(){
            //Only purpose is to log the character sheet version in the console log at start
            version.replace(/(\d+\.\d{2})(.+)/,(match,ver,buildDate)=>{
                TAS.log(`Starfinder Character Sheet v${ver}, build Date:${buildDate} loaded`);
            });
            /*var selectItem = _.reduce(equipment,(m,e)=>{
                return m+='<option value="'+e.name+'" data-i18n="'+e.name.replace(/\s+/g,'_')+'">'+e.name.toUpperCase()+'</option>';
            },'<select title='@{equipment_compendium}' name="attr_equipment_compendium">');
            selectItem+='</select>';
            TAS.log(JSON.stringify(selectItem));*/
            /*const newObj = {};
            _.each(attributeObjs,(ak)=>{
                newObj[(ak.repeating ? ak.repeating+'|' : '')+ak.attr]=ak;
            });
            TAS.log(JSON.stringify(newObj));*/
        };
        return {
            Bootup: bootup,
            RegisterEventHandlers: RegisterEventHandlers
        };
    }());
    starfinder.Bootup();
    starfinder.RegisterEventHandlers();
    /*end of starfinder.js*/
</script>
