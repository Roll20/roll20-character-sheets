<div class="preload"><img src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/Blades%20in%20the%20Dark/Assets/teeth/xptooth-red.png"/><img src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/Blades%20in%20the%20Dark/Assets/teeth/xptooth-white.png"/><img src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/Blades%20in%20the%20Dark/Assets/teeth/stresstooth-red.png"/><img src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/Blades%20in%20the%20Dark/Assets/teeth/stresstooth-black.png"/><img src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/Blades%20in%20the%20Dark/Assets/teeth/stresstooth-halfgrey.png"/><img src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/Blades%20in%20the%20Dark/Assets/teeth/stresstooth-white.png"/><img src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/Blades%20in%20the%20Dark/Assets/teeth/shorttooth-red.png"/><img src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/Blades%20in%20the%20Dark/Assets/teeth/shorttooth-grey.png"/>
</div>
<input class="focus-shadow" type="hidden" name="attr_setting_focus_shadow" value="1"/>
<input class="show-broadcast" type="hidden" name="attr_setting_show_broadcast" value="1"/>
<input class="show-itemdesc" type="hidden" name="attr_setting_show_itemdesc" value="1"/>
<input class="use-kirsty" type="hidden" name="attr_setting_usekirsty" value="0"/>
<input class="flexwidth" type="hidden" name="attr_setting_flexwidth" value="0"/>
<input type="hidden" name="attr_changed_attributes" value=""/>
<input type="hidden" name="attr_bonusdice" value="Bonus dice"/>
<input type="hidden" name="attr_numberofdice" value=" {{?{Number of dice|0,zerodice=[[d6]]&amp;#44; [[d6]]|1,dice=[[d6]]|2,dice=[[d6]]&amp;#44; [[d6]]|3,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|4,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|5,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|6,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]}}}"/>
<input type="hidden" name="attr_notes_query" value="?{Notes}"/>
<input type="hidden" name="attr_position_query" value="?{Position|Risky,position=Risky|Controlled,position=Controlled|Desperate,position=Desperate|Fortune roll,position=}"/>
<input type="hidden" name="attr_effect_query" value="?{Effect|Standard|Limited|Great|Extreme|Zero}"/>
<input type="hidden" name="attr_consequence_query" value="^{a_consequence}"/>
<input type="hidden" name="attr_stress_max" value="9"/>
<input type="hidden" name="attr_trauma_max" value="4"/>
<input type="hidden" name="attr_coin_max" value="4"/>
<input type="hidden" name="attr_stash_max" value="0"/>
<input type="hidden" name="attr_playbook_xp_max" value="8"/>
<input type="hidden" name="attr_rep_max" value="12"/>
<input type="hidden" name="attr_turf_max" value="6"/>
<input type="hidden" name="attr_crew_tier_max" value="4"/>
<input type="hidden" name="attr_heat_max" value="9"/>
<input type="hidden" name="attr_wanted_max" value="4"/>
<input type="hidden" name="attr_crewcoin_max" value="16"/>
<input type="hidden" name="attr_crew_xp_max" value="8"/>
<div class="container">
  <input class="type" type="hidden" name="attr_sheet_type" value="character"/>
  <!-- Title & Version-->
  <div class="topholder flex">
    <!-- Toggle the type of sheet-->
    <div class="type-selector label">
      <input class="hidden sheet-3waybox" type="checkbox" name="attr_sheet_type" value="faction"/>
      <input class="sheet-3waybox" type="radio" name="attr_sheet_type" value="character" checked="checked"/>
      <input class="sheet-3waybox" type="radio" name="attr_sheet_type" value="crew"/>
      <input class="sheet-3waybox" type="radio" name="attr_sheet_type" value="faction"/><span data-i18n="character_mode"></span><span data-i18n="crew_mode"></span><span data-i18n="faction_mode"></span>
    </div>
    <label class="settings-checkbox">
      <input type="checkbox" name="attr_show_settings" value="1"/><span>y</span>
    </label>
    <div class="version"><span class="version-text" data-i18n="version"></span><span name="attr_version"></span></div>
  </div>
  <input class="hider" type="hidden" name="attr_show_settings" value="0"/>
  <!-- Settings-->
  <div class="settings flex-wrap">
    <div class="setting-char generaterow">
      <select name="attr_generate_source_character" title="Choose source">
        <option value="aegis" data-i18n="aegis"></option>
        <option value="kestrel" data-i18n="kestrel"></option>
        <option value="proxy" data-i18n="proxy"></option>
        <option value="Scholar" data-i18n="Scholar"></option>
        <option value="scrapper" data-i18n="scrapper"></option>
        <option value="witch" data-i18n="witch"></option>
        <option value="charter" data-i18n="charter"></option>
      </select>
      <label class="generatebutton">
        <input type="checkbox" name="attr_generate_ability" value="1"/><span data-i18n="add_abilities"></span>
      </label>
      <label class="generatebutton">
        <input type="checkbox" name="attr_generate_friend" value="1"/><span data-i18n="add_friends"></span>
      </label>
      <label class="generatebutton">
        <input type="checkbox" name="attr_generate_playbookitem" value="1"/><span data-i18n="add_items"></span>
      </label>
    </div>
    <div class="setting-crew generaterow">
      <select name="attr_generate_source_crew" title="Choose source">
        <option value="augurs" data-i18n="augurs"></option>
        <option value="couriers" data-i18n="couriers"></option>
        <option value="magpies" data-i18n="magpies"></option>
        <option value="rangers" data-i18n="rangers"></option>
        <option value="silvers" data-i18n="silvers"></option>
      </select>
      <label class="generatebutton">
        <input type="checkbox" name="attr_generate_crewability" value="1"/><span data-i18n="add_abilities"></span>
      </label>
      <label class="generatebutton">
        <input type="checkbox" name="attr_generate_contact" value="1"/><span data-i18n="add_contacts"></span>
      </label>
      <label class="generatebutton">
        <input type="checkbox" name="attr_generate_upgrade" value="1"/><span data-i18n="add_upgrades"></span>
      </label>
    </div>
    <div class="setting-faction generaterow">
      <label class="generatebutton">
        <input type="checkbox" name="attr_generate_factions" value="1"/><span data-i18n="generate_factions"></span>
      </label>
    </div>
    <div class="setting-char">
      <label>
        <select name="attr_setting_extra_stress" title="Stress Boxes">
          <option value="0" selected="selected">9</option>
          <option value="1">10</option>
          <option value="2">11</option>
          <option value="3">12</option>
        </select><span data-i18n="number_stress_boxes"></span>
      </label>
    </div>
    <div class="setting-char">
      <label>
        <input class="checkbox squarebox" type="checkbox" name="attr_setting_extra_trauma" value="1"/><span></span><span data-i18n="show_extra_trauma_box"></span>
      </label>
    </div>
    <div class="setting-char setting-crew">
      <label>
        <input class="checkbox squarebox" type="checkbox" name="attr_setting_extra_xp" value="1"/><span></span><span data-i18n="show_extra_xp_condition"></span>
      </label>
    </div>
    <div class="setting-char setting-crew">
      <label>
        <input class="checkbox squarebox" type="checkbox" name="attr_setting_show_itemdesc" value="1" checked="checked"/><span></span><span data-i18n="show_item_description"></span>
      </label>
    </div>
    <div class="setting-char">
      <label>
        <input class="checkbox squarebox" type="checkbox" name="attr_setting_show_cohort" value="1"/><span></span><span data-i18n="show_cohort_section"></span>
      </label>
    </div>
    <div class="setting-char"><span data-i18n="resistance_bonus"></span>
      <label>
        <input type="number" name="attr_setting_resbonus_analysis" value="0"/><span data-i18n="analysis"></span>
      </label>
      <label>
        <input type="number" name="attr_setting_resbonus_kinesis" value="0"/><span data-i18n="kinesis"></span>
      </label>
      <label>
        <input type="number" name="attr_setting_resbonus_semiosis" value="0"/><span data-i18n="semiosis"></span>
      </label>
    </div>
    <div class="setting-char">
      <label>
        <input class="checkbox squarebox" type="checkbox" name="attr_setting_consequence_query" value="1"/><span></span><span data-i18n="query_for_consequence"></span>
      </label>
    </div>
    <div class="setting-char"><span data-i18n="load:"></span>
      <label>
        <input type="number" name="attr_setting_load_l" value="3"/><span data-i18n="light"></span>
      </label>
      <label>
        <input type="number" name="attr_setting_load_n" value="5"/><span data-i18n="normal"></span>
      </label>
      <label>
        <input type="number" name="attr_setting_load_h" value="6"/><span data-i18n="heavy"></span>
      </label>
    </div>
    <div class="setting-char setting-crew setting-faction">
      <label>
        <input class="checkbox squarebox" type="checkbox" name="attr_setting_flexwidth" value="1"/><span></span><span data-i18n="flexible_width"></span>
      </label>
    </div>
    <div class="setting-char setting-crew setting-faction">
      <label>
        <input class="checkbox squarebox" type="checkbox" name="attr_setting_focus_shadow" value="1" checked="checked"/><span></span><span data-i18n="show_outline"></span>
      </label>
    </div>
    <div class="setting-char setting-crew setting-faction">
      <label>
        <input class="checkbox squarebox" type="checkbox" name="attr_setting_show_broadcast" value="1" checked="checked"/><span></span><span data-i18n="show_broadcast"></span>
      </label>
    </div>
    <div class="setting-char setting-crew">
      <label>
        <input class="checkbox squarebox" type="checkbox" name="attr_setting_autofill" value="1" checked="checked"/><span></span><span data-i18n="fill_fields"></span>
      </label>
    </div>
    <div class="setting-char setting-crew">
      <input class="wide" type="text" spellcheck="false" name="attr_chat_image" value=""/><span data-i18n="chat_image"></span>
    </div>
    <div class="setting-char setting-crew setting-faction kirsty-option">
      <label>
        <input class="checkbox squarebox" type="checkbox" name="attr_setting_usekirsty" value="1"/><span></span><span data-i18n="use_kirsty"></span>
      </label>
    </div>
    <div class="setting-faction">
      <label>
        <input class="checkbox squarebox" type="checkbox" name="attr_setting_clocks_only" value="1"/><span></span><span data-i18n="clocks_only"></span>
      </label>
    </div>
  </div>
  <!-- Character Sheet-->
  <div class="type-character flex">
    <!-- Left column-->
    <div class="col55 flex-wrap">
      <!-- Logo, Header text fields-->
      <div class="col100 header flex">
        <div class="col55 bladeslogo"></div>
        <label class="col45 header">
          <input type="text" spellcheck="false" name="attr_crew"/>
          <div class="label text title" data-i18n="crew"></div>
        </label>
        <label class="col55">
          <input type="text" spellcheck="false" name="attr_name"/>
          <div class="label text title" data-i18n="name"></div>
        </label>
        <label class="col45">
          <div class="auto-expand"><span name="attr_substrate"></span>
            <textarea spellcheck="false" name="attr_substrate"></textarea>
          </div>
          <input type="hidden" name="attr_substrate" value=""/>
          <div class="text"><span class="label title" data-i18n="substrate"></span><span class="uppercase info" data-i18n="substrate_info"></span></div>
        </label>
        <label class="col100">
          <input type="text" spellcheck="false" name="attr_look"/>
          <div class="label text title" data-i18n="look"></div>
        </label>
        <label class="col55">
          <div class="auto-expand"><span name="attr_heritage"></span>
            <textarea spellcheck="false" name="attr_heritage"></textarea>
          </div>
          <input type="hidden" name="attr_heritage" value=""/>
          <div class="text"><span class="label title" data-i18n="heritage"></span><span class="uppercase info" data-i18n="heritage_info"></span></div>
        </label>
        <label class="col45">
          <div class="auto-expand"><span name="attr_background"></span>
            <textarea spellcheck="false" name="attr_background"></textarea>
          </div>
          <input type="hidden" name="attr_background" value=""/>
          <div class="text"><span class="label title" data-i18n="background"></span><span class="uppercase info" data-i18n="background_info"></span></div>
        </label>
        <label class="col100 vice normal">
          <div class="auto-expand"><span name="attr_vice_purveyor"></span>
            <textarea spellcheck="false" name="attr_vice_purveyor"></textarea>
          </div>
          <input type="hidden" name="attr_vice_purveyor" value=""/>
          <div class="text"><span class="label title" data-i18n="vice_purveyor"></span><span class="uppercase info" data-i18n="vice_info"></span></div>
          <button class="vicebutton borderbutton" type="roll" name="roll_Vice" value="&{template:bitd} {{charname=@{character_name}}} {{{{subtitle=^{viceroll1}@{stress}&nbsp;^{stress}^{viceroll2}}} {{vice=1}} {{title=^{vice}}} @{vice_formula} {{charimage=@{chat_image}}}" data-i18n="indulge_vice"></button>
          <input type="hidden" name="attr_vice_formula" value=" {{?{@{bonusdice}|0,zerodice=[[d6]]&amp;#44; [[d6]]|1,dice=[[d6]]|2,dice=[[d6]]&amp;#44; [[d6]]|3,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|4,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|5,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|6,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|-1,zerodice=[[d6]]&amp;#44; [[d6]]|-2,zerodice=[[d6]]&amp;#44; [[d6]]|-3,zerodice=[[d6]]&amp;#44; [[d6]]}}}"/>
        </label>
      </div>
      <!-- Stress and Trauma-->
      <div class="col100 flex stress def-margin">
        <!-- Stress markers-->
        <div class="stress1 blackheader">
          <div class="label" data-i18n="stress"></div>
        </div>
        <div class="stress2 blackborder flex">
          <input class="tooth zero" type="radio" name="attr_stress" value="0" checked="checked"/><span></span>
          <input class="tooth stresstooth" type="radio" name="attr_stress" value="1"/><span></span>
          <input class="tooth stresstooth" type="radio" name="attr_stress" value="2"/><span></span>
          <input class="tooth stresstooth" type="radio" name="attr_stress" value="3"/><span></span>
          <input class="tooth stresstooth" type="radio" name="attr_stress" value="4"/><span></span>
          <input class="tooth stresstooth" type="radio" name="attr_stress" value="5"/><span></span>
          <input class="tooth stresstooth" type="radio" name="attr_stress" value="6"/><span></span>
          <input class="tooth stresstooth" type="radio" name="attr_stress" value="7"/><span></span>
          <input class="tooth stresstooth" type="radio" name="attr_stress" value="8"/><span></span>
          <input class="hidden extra-teeth" type="checkbox" name="attr_setting_extra_stress" value="0" checked="checked"/>
          <input class="tooth stresstooth" type="radio" name="attr_stress" value="9"/><span></span>
          <input class="hidden extra-teeth" type="checkbox" name="attr_setting_extra_stress" value="1"/>
          <input class="tooth stresstooth" type="radio" name="attr_stress" value="10"/><span></span>
          <input class="hidden extra-teeth" type="checkbox" name="attr_setting_extra_stress" value="2"/>
          <input class="tooth stresstooth" type="radio" name="attr_stress" value="11"/><span></span>
          <input class="tooth stresstooth" type="radio" name="attr_stress" value="12"/><span></span>
        </div>
        <!-- Trauma markers-->
        <div class="stress3">
          <div class="greyheader">
            <div class="label" data-i18n="trauma"></div>
          </div>
          <div class="traumaholder flex">
            <input class="tooth zero" type="radio" name="attr_trauma" value="0" checked="checked"/><span></span>
            <input class="tooth regulartooth" type="radio" name="attr_trauma" value="1"/><span></span>
            <input class="tooth regulartooth" type="radio" name="attr_trauma" value="2"/><span></span>
            <input class="tooth regulartooth" type="radio" name="attr_trauma" value="3"/><span></span>
            <input class="hidden extra-teeth" type="checkbox" name="attr_setting_extra_trauma" value="0" checked="checked"/>
            <input class="tooth regulartooth" type="radio" name="attr_trauma" value="4"/><span></span>
            <input class="tooth regulartooth" type="radio" name="attr_trauma" value="5"/><span></span>
          </div>
        </div>
        <!-- Individual traumata-->
        <div class="stress4 blackborder">
          <div>
            <div class="flex">
              <label class="text-button">
                <input type="checkbox" name="attr_trauma_anxious" value="1"/><span data-i18n="anxious"></span>
              </label><span>—</span>
              <label class="text-button">
                <input type="checkbox" name="attr_trauma_cynical" value="1"/><span data-i18n="cynical"></span>
              </label><span>—</span>
              <label class="text-button">
                <input type="checkbox" name="attr_trauma_detached" value="1"/><span data-i18n="detached"></span>
              </label><span>—</span>
              <label class="text-button">
                <input type="checkbox" name="attr_trauma_haunted" value="1"/><span data-i18n="haunted"></span>
              </label>
            </div>
            <div class="flex">
              <label class="text-button">
                <input type="checkbox" name="attr_trauma_obsessed" value="1"/><span data-i18n="obsessed"></span>
              </label><span>—</span>
              <label class="text-button">
                <input type="checkbox" name="attr_trauma_reckless" value="1"/><span data-i18n="reckless"></span>
              </label><span>—</span>
              <label class="text-button">
                <input type="checkbox" name="attr_trauma_shaky" value="1"/><span data-i18n="shaky"></span>
              </label><span>—</span>
              <label class="text-button">
                <input type="checkbox" name="attr_trauma_vindictive" value="1"/><span data-i18n="vindictive"></span>
              </label>
            </div>
          </div>
        </div>
      </div>
      <!-- Harm, Healing, Armor, Coin-->
      <div class="col100 flex def-margin">
        <!-- Harm-->
        <div class="harm col63">
          <div class="blackheader col100">
            <div class="label" data-i18n="harm"></div>
            <button class="broadcast-button" type="roll" name="roll_Harm" value="&{template:bitd-broadcast} {{charname=@{character_name}}} {{harm=1}} {{harm3=@{harm3}}} {{harm2_1=@{harm2_1}}} {{harm2_2=@{harm2_2}}} {{harm1_1=@{harm1_1}}} {{harm1_2=@{harm1_2}}} {{charimage=@{chat_image}}}" data-i18n-title="send_details_to_chat">:</button>
          </div>
          <div class="harmbody">
            <div class="flex-center harmnumber">3</div>
            <textarea class="twocols" spellcheck="false" name="attr_harm3"></textarea>
            <div class="flex-center harmeffect" data-i18n="need_help"></div>
            <div class="flex-center harmnumber">2</div>
            <textarea spellcheck="false" name="attr_harm2_1"></textarea>
            <textarea spellcheck="false" name="attr_harm2_2"></textarea>
            <div class="flex-center harmeffect" data-i18n="minus1d"></div>
            <div class="flex-center harmnumber">1</div>
            <textarea spellcheck="false" name="attr_harm1_1"></textarea>
            <textarea spellcheck="false" name="attr_harm1_2"></textarea>
            <div class="flex-center harmeffect" data-i18n="less_effect"></div>
          </div>
        </div>
        <!-- Armor, Healing and Coin-->
        <div class="col37 flex-wrap">
          <!-- Armor-->
          <div class="armor col100">
            <div class="blackheader col100">
              <div class="label" data-i18n="armor_uses"></div>
            </div>
            <label>
              <input class="checkbox squarebox" type="checkbox" name="attr_armor" value="1"/><span></span><span class="label" data-i18n="armor"></span>
            </label>
            <label>
              <input class="checkbox squarebox" type="checkbox" name="attr_heavy" value="1"/><span></span><span class="label" data-i18n="heavy"></span>
            </label>
            <label>
              <input class="checkbox squarebox" type="checkbox" name="attr_special" value="1"/><span></span><span class="label" data-i18n="special"></span>
            </label>
          </div>
          <!-- Coin and Stash-->
          <div class="col100 coin-and-stash">
            <!-- Coin-->
            <div class="col100 coinrow flex">
              <div class="coin flex">
                <div class="label" data-i18n="coin"></div>
                <input class="zero" type="radio" name="attr_coin" value="0" checked="checked"/><span></span>
                <input class="radiobox" type="radio" name="attr_coin" value="1"/><span></span><br/>
                <input class="radiobox" type="radio" name="attr_coin" value="2"/><span></span><br/>
                <input class="radiobox" type="radio" name="attr_coin" value="3"/><span></span><br/>
                <input class="radiobox" type="radio" name="attr_coin" value="4"/><span></span><br/>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Special abilities-->
      <div class="col100 def-margin">
        <div class="specialheader col100 label" data-i18n="special_abilities"></div>
        <div class="greyholder col100">
          <fieldset class="repeating_ability">
            <div class="specialability flex">
              <button class="broadcast-button" type="roll" name="roll_Show" value="&{template:bitd-broadcast} {{charname=@{character_name}}} {{type=^{special_ability}}} {{title=@{name}}} {{content=@{description}}} {{charimage=@{chat_image}}}" data-i18n-title="send_details_to_chat">:</button>
              <input class="checkbox circlebox" type="checkbox" name="attr_check" value="1"/><span></span>
              <div class="auto-expand abilityname smallcaps"><span name="attr_name"></span>
                <textarea spellcheck="false" name="attr_name" data-i18n-placeholder="ability_name"></textarea>
              </div>
              <div class="auto-expand abilitydesc"><span name="attr_description"></span>
                <textarea spellcheck="false" name="attr_description" data-i18n-placeholder="ability_description"></textarea>
              </div>
            </div>
          </fieldset>
        </div>
      </div>
      <!-- Advancement-->
      <div class="col100 def-margin">
        <div class="advancement-header flex blackheader">
          <div class="label markxp" data-i18n="mark_xp:"></div>
          <div class="label" data-i18n="playbook_advancement"></div>
          <div class="xpholder flex">
            <input class="tooth zero" type="radio" name="attr_playbook_xp" value="0" checked="checked"/><span></span>
            <input class="tooth xptooth" type="radio" name="attr_playbook_xp" value="1"/><span></span>
            <input class="tooth xptooth" type="radio" name="attr_playbook_xp" value="2"/><span></span>
            <input class="tooth xptooth" type="radio" name="attr_playbook_xp" value="3"/><span></span>
            <input class="tooth xptooth" type="radio" name="attr_playbook_xp" value="4"/><span></span>
            <input class="tooth xptooth" type="radio" name="attr_playbook_xp" value="5"/><span></span>
            <input class="tooth xptooth" type="radio" name="attr_playbook_xp" value="6"/><span></span>
            <input class="tooth xptooth" type="radio" name="attr_playbook_xp" value="7"/><span></span>
            <input class="tooth xptooth" type="radio" name="attr_playbook_xp" value="8"/><span></span>
          </div>
        </div>
        <ul class="advancement-desc">
          <li data-i18n="xp_desperate"></li>
          <li class="nondot" data-i18n="xp_top"></li>
          <li>
            <div class="auto-expand"><span name="attr_xp_condition"></span>
              <textarea spellcheck="false" name="attr_xp_condition" data-i18n-placeholder="xp_specific"></textarea>
            </div>
          </li>
          <input class="hider" type="hidden" name="attr_setting_extra_xp" value="0"/>
          <li>
            <div class="auto-expand"><span name="attr_xp_condition_extra"></span>
              <textarea spellcheck="false" name="attr_xp_condition_extra" data-i18n-placeholder="xp_specific_extra"></textarea>
            </div>
          </li>
          <li>
            <div class="auto-expand"><span name="attr_xp_condition2">You expressed your beliefs, drives, heritage, or background.</span>
              <textarea spellcheck="false" name="attr_xp_condition2">You expressed your beliefs, drives, heritage, or background.</textarea>
            </div>
          </li>
          <li>
            <div class="auto-expand"><span name="attr_xp_condition3"></span>
              <textarea spellcheck="false" name="attr_xp_condition3"></textarea>
            </div>
          </li>
        </ul>
      </div>
      <!-- Teamwork-->
      <div class="col45 right-column def-margin">
        <div class="plainheader label" data-i18n="teamwork"></div>
        <div class="teamworkbox" data-i18n="assist_a_teammate"></div>
        <div class="teamworkbox" data-i18n="lead_a_group_action"></div>
        <div class="teamworkbox" data-i18n="protect_a_teammate"></div>
        <div class="teamworkbox" data-i18n="set_up_a_teammate"></div>
      </div>
      <!-- Gather Information-->
      <div class="col55 right-column def-margin">
        <div class="gatherinfo col100">
          <div class="plainheader label" data-i18n="gather_information"></div>
          <div>
            <ul>
              <li>
                <input class="inherit" type="text" spellcheck="false" name="attr_gatherinfo1" data-i18n-placeholder="gatherinfo_whats_their_intention"/>
              </li>
              <li>
                <input class="inherit" type="text" spellcheck="false" name="attr_gatherinfo2" data-i18n-placeholder="gatherinfo_what_might_I_suspect"/>
              </li>
              <li>
                <input class="inherit" type="text" spellcheck="false" name="attr_gatherinfo3" data-i18n-placeholder="gatherinfo_whats_the_danger_here"/>
              </li>
              <li>
                <input class="inherit" type="text" spellcheck="false" name="attr_gatherinfo4" data-i18n-placeholder="gatherinfo_how_can_I_find"/>
              </li>
              <li>
                <input class="inherit" type="text" spellcheck="false" name="attr_gatherinfo5" data-i18n-placeholder="gatherinfo_how_can_I_help_here"/>
              </li>
              <li>
                <input class="inherit" type="text" spellcheck="false" name="attr_gatherinfo6" data-i18n-placeholder="gatherinfo_whats_going_on"/>
              </li>
              <li>
                <input class="inherit" type="text" spellcheck="false" name="attr_gatherinfo7" data-i18n-placeholder="gatherinfo_detail_for_plan"/>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
    <!-- Right column-->
    <div class="col45 flex-wrap right-column">
      <!-- Playbook name and description-->
      <div class="playbook flex">
        <input class="label" type="text" spellcheck="false" name="attr_playbook" data-i18n-placeholder="playbook"/>
        <textarea class="label" spellcheck="false" name="attr_playbook_description" data-i18n-placeholder="playbook_description"></textarea>
        <input class="hider" type="hidden" name="attr_show_playbook_reminder" value="1"/>
        <div class="reminder"><span data-i18n="autofill_reminder_playbook"></span><br/><span data-i18n="list_playbooks"></span></div>
      </div>
      <!-- Items and Planning-->
      <div class="col53 itemcolumn small-margin">
        <!-- Load-->
        <div class="loadheader flex col100">
          <div class="label" data-i18n="load"></div>
          <label>
            <input class="checkbox" type="checkbox" name="attr_load" value="light"/><span></span><span class="loadnumber" name="attr_setting_load_l"></span><span data-i18n="light"></span>
          </label>
          <label>
            <input class="checkbox" type="checkbox" name="attr_load" value="normal"/><span></span><span class="loadnumber" name="attr_setting_load_n"></span><span data-i18n="normal"></span>
          </label>
          <label>
            <input class="checkbox" type="checkbox" name="attr_load" value="heavy"/><span></span><span class="loadnumber" name="attr_setting_load_h"></span><span data-i18n="heavy"></span>
          </label>
        </div>
        <div class="itemheader small-margin col100 flex">
          <div class="label" data-i18n="items"></div><span class="italic" data-i18n="italics_dont_count"></span>
          <label class="text-button">
            <input type="checkbox" name="attr_reset_items" value="1"/><span data-i18n="reset?"></span>
          </label>
        </div>
        <!-- Items-->
        <div class="itemholder col100 items">
          <!-- Playbook items-->
          <div class="playbookitems col100 free-repcontrol">
            <fieldset class="repeating_playbookitem">
              <input class="boxes-chosen" type="hidden" name="attr_boxes_chosen" value="0"/>
              <div class="item numboxes-chooser">
                <div data-i18n="how_much_load"></div>
                <input type="number" name="attr_numboxes" min="0" max="3" value="0"/>
                <label>
                  <input type="checkbox" name="attr_bold" value="1"/><span data-i18n="bold"></span>
                </label>
                <label>
                  <input type="checkbox" name="attr_boxes_chosen" value="1"/><span data-i18n="ok"></span>
                </label>
              </div>
              <div class="item">
                <input class="input-bold" type="hidden" name="attr_bold" value="0"/>
                <input class="numboxes" type="hidden" name="attr_numboxes" value="0"/>
                <input class="checkbox squarebox" type="checkbox" name="attr_check_1" value="1"/><span></span><span class="floatingbar boxesgeq2"></span>
                <input class="checkbox squarebox boxesgeq2" type="checkbox" name="attr_check_2" value="1"/><span class="boxesgeq2"></span><span class="floatingbar boxesgeq3 boxesgeq2"></span>
                <input class="checkbox squarebox boxesgeq2 boxesgeq3" type="checkbox" name="attr_check_3" value="1"/><span class="boxesgeq2 boxesgeq3"></span>
                <div class="auto-expand itemname"><span name="attr_name"></span>
                  <textarea spellcheck="false" name="attr_name" data-i18n-placeholder="item_name"></textarea>
                </div>
              </div>
              <div class="item-description">
                <input class="expand" type="checkbox" name="attr_expand" value="1"/><span></span>
                <textarea spellcheck="false" name="attr_description" data-i18n-placeholder="description"></textarea>
              </div>
            </fieldset>
          </div>
          <!-- Regular items-->
          <div class="regularitems col100 free-repcontrol free-repcontrol">
            <fieldset class="repeating_item">
              <input class="input-short" type="hidden" name="attr_short" value="0"/>
              <input class="input-expand" type="hidden" name="attr_expand" value="0"/>
              <div class="item-container">
                <input class="boxes-chosen" type="hidden" name="attr_boxes_chosen" value="0"/>
                <div class="item numboxes-chooser">
                  <div data-i18n="how_much_load"></div>
                  <input type="number" name="attr_numboxes" min="0" max="3" value="0"/>
                  <label>
                    <input type="checkbox" name="attr_short" value="1"/><span data-i18n="short"></span>
                  </label>
                  <label>
                    <input type="checkbox" name="attr_boxes_chosen" value="1"/><span data-i18n="ok"></span>
                  </label>
                </div>
                <div class="item">
                  <input class="numboxes" type="hidden" name="attr_numboxes" value="0"/>
                  <input class="checkbox squarebox" type="checkbox" name="attr_check_1" value="1"/><span></span><span class="floatingbar boxesgeq2"></span>
                  <input class="checkbox squarebox boxesgeq2" type="checkbox" name="attr_check_2" value="1"/><span class="boxesgeq2"></span><span class="floatingbar boxesgeq3 boxesgeq2"></span>
                  <input class="checkbox squarebox boxesgeq2 boxesgeq3" type="checkbox" name="attr_check_3" value="1"/><span class="boxesgeq2 boxesgeq3"></span>
                  <input class="itemname" type="text" spellcheck="false" name="attr_name" data-i18n-placeholder="item_name"/>
                </div>
                <div class="item-description">
                  <input class="expand" type="checkbox" name="attr_expand" value="1"/><span></span>
                  <textarea spellcheck="false" name="attr_description" data-i18n-placeholder="description"></textarea>
                </div>
              </div>
            </fieldset>
          </div>
        </div>
        <!-- Planning and Load-->
        <div class="planning col100 def-margin">
          <input class="title-checkbox" type="checkbox" name="attr_show_planning" value="1" checked="checked"/><span class="label plainheader" data-i18n="planning_load"></span>
          <div class="planning-content">
            <div class="planningdesc" data-i18n="planningdesc"></div>
            <div class="teamworkbox"><span class="bold" data-i18n="assault"></span><span class="italic" data-i18n="detail_assault"></span></div>
            <div class="teamworkbox"><span class="bold" data-i18n="occult"></span><span class="italic" data-i18n="detail_occult"></span></div>
            <div class="teamworkbox"><span class="bold" data-i18n="deception"></span><span class="italic" data-i18n="detail_deception"></span></div>
            <div class="teamworkbox"><span class="bold" data-i18n="social"></span><span class="italic" data-i18n="detail_social"></span></div>
            <div class="teamworkbox"><span class="bold" data-i18n="stealth"></span><span class="italic" data-i18n="detail_stealth"></span></div>
            <div class="teamworkbox"><span class="bold" data-i18n="transport"></span><span class="italic" data-i18n="detail_transport"></span></div>
          </div>
        </div>
      </div>
      <!-- Action ratings-->
      <div class="col47 right-column actioncolumn small-margin">
        <div class="attribute col100">
          <div class="attribute-title flex col100">
            <button class="rollbutton label" type="roll" name="roll_analysis" value="&{template:bitd} {{charname=@{character_name}}} {{resist=1}} {{subtitle=^{resists} @{consequence_query} ^{with}}} {{title=^{analysis}}} @{analysis_formula} {{charimage=@{chat_image}}}" data-i18n="analysis" data-i18n-title="analysis_description"></button>
            <input type="hidden" name="attr_analysis" value="0"/>
            <input type="hidden" name="attr_analysis_formula" value=" {{?{@{bonusdice}|0,zerodice=[[d6]]&amp;#44; [[d6]]|1,dice=[[d6]]|2,dice=[[d6]]&amp;#44; [[d6]]|3,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|4,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|5,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|6,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|-1,zerodice=[[d6]]&amp;#44; [[d6]]|-2,zerodice=[[d6]]&amp;#44; [[d6]]|-3,zerodice=[[d6]]&amp;#44; [[d6]]}}}"/>
            <input type="hidden" name="attr_analysis_xp_max" value="6"/>
            <div class="attribute-xp-box flex">
              <input class="tooth zero" type="radio" name="attr_analysis_xp" value="0" checked="checked"/><span></span>
              <input class="tooth xptooth" type="radio" name="attr_analysis_xp" value="1"/><span></span>
              <input class="tooth xptooth" type="radio" name="attr_analysis_xp" value="2"/><span></span>
              <input class="tooth xptooth" type="radio" name="attr_analysis_xp" value="3"/><span></span>
              <input class="tooth xptooth" type="radio" name="attr_analysis_xp" value="4"/><span></span>
              <input class="tooth xptooth" type="radio" name="attr_analysis_xp" value="5"/><span></span>
              <input class="tooth xptooth" type="radio" name="attr_analysis_xp" value="6"/><span></span>
            </div>
          </div>
          <div class="actions col100">
            <div class="action flex col100">
              <input type="hidden" name="attr_read_formula" value=" {{?{@{bonusdice}|0,zerodice=[[d6]]&amp;#44; [[d6]]|1,dice=[[d6]]|2,dice=[[d6]]&amp;#44; [[d6]]|3,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|4,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|5,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|6,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|-1,zerodice=[[d6]]&amp;#44; [[d6]]|-2,zerodice=[[d6]]&amp;#44; [[d6]]|-3,zerodice=[[d6]]&amp;#44; [[d6]]}}}"/>
              <input class="hidden fakeradio" type="checkbox" name="attr_read" value="0" checked="checked"/>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_read" value="1"/><span></span>
              <div class="divider"></div>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_read" value="2"/><span></span>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_read" value="3"/><span></span>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_read" value="4"/><span></span>
              <button class="rollbutton label" type="roll" name="roll_read" value="&{template:bitd} {{charname=@{character_name}}} {{action=1}} {{subtitle=^{rolls}}} {{title=^{read}}} {{@{position_query}}} {{effect=@{effect_query}}} @{read_formula} {{charimage=@{chat_image}}}" data-i18n="read" data-i18n-title="read_description"></button>
            </div>
            <div class="action flex col100">
              <input type="hidden" name="attr_shape_formula" value=" {{?{@{bonusdice}|0,zerodice=[[d6]]&amp;#44; [[d6]]|1,dice=[[d6]]|2,dice=[[d6]]&amp;#44; [[d6]]|3,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|4,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|5,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|6,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|-1,zerodice=[[d6]]&amp;#44; [[d6]]|-2,zerodice=[[d6]]&amp;#44; [[d6]]|-3,zerodice=[[d6]]&amp;#44; [[d6]]}}}"/>
              <input class="hidden fakeradio" type="checkbox" name="attr_shape" value="0" checked="checked"/>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_shape" value="1"/><span></span>
              <div class="divider"></div>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_shape" value="2"/><span></span>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_shape" value="3"/><span></span>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_shape" value="4"/><span></span>
              <button class="rollbutton label" type="roll" name="roll_shape" value="&{template:bitd} {{charname=@{character_name}}} {{action=1}} {{subtitle=^{rolls}}} {{title=^{shape}}} {{@{position_query}}} {{effect=@{effect_query}}} @{shape_formula} {{charimage=@{chat_image}}}" data-i18n="shape" data-i18n-title="shape_description"></button>
            </div>
            <div class="action flex col100">
              <input type="hidden" name="attr_sunder_formula" value=" {{?{@{bonusdice}|0,zerodice=[[d6]]&amp;#44; [[d6]]|1,dice=[[d6]]|2,dice=[[d6]]&amp;#44; [[d6]]|3,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|4,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|5,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|6,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|-1,zerodice=[[d6]]&amp;#44; [[d6]]|-2,zerodice=[[d6]]&amp;#44; [[d6]]|-3,zerodice=[[d6]]&amp;#44; [[d6]]}}}"/>
              <input class="hidden fakeradio" type="checkbox" name="attr_sunder" value="0" checked="checked"/>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_sunder" value="1"/><span></span>
              <div class="divider"></div>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_sunder" value="2"/><span></span>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_sunder" value="3"/><span></span>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_sunder" value="4"/><span></span>
              <button class="rollbutton label" type="roll" name="roll_sunder" value="&{template:bitd} {{charname=@{character_name}}} {{action=1}} {{subtitle=^{rolls}}} {{title=^{sunder}}} {{@{position_query}}} {{effect=@{effect_query}}} @{sunder_formula} {{charimage=@{chat_image}}}" data-i18n="sunder" data-i18n-title="sunder_description"></button>
            </div>
            <div class="action flex col100">
              <input type="hidden" name="attr_trace_formula" value=" {{?{@{bonusdice}|0,zerodice=[[d6]]&amp;#44; [[d6]]|1,dice=[[d6]]|2,dice=[[d6]]&amp;#44; [[d6]]|3,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|4,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|5,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|6,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|-1,zerodice=[[d6]]&amp;#44; [[d6]]|-2,zerodice=[[d6]]&amp;#44; [[d6]]|-3,zerodice=[[d6]]&amp;#44; [[d6]]}}}"/>
              <input class="hidden fakeradio" type="checkbox" name="attr_trace" value="0" checked="checked"/>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_trace" value="1"/><span></span>
              <div class="divider"></div>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_trace" value="2"/><span></span>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_trace" value="3"/><span></span>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_trace" value="4"/><span></span>
              <button class="rollbutton label" type="roll" name="roll_trace" value="&{template:bitd} {{charname=@{character_name}}} {{action=1}} {{subtitle=^{rolls}}} {{title=^{trace}}} {{@{position_query}}} {{effect=@{effect_query}}} @{trace_formula} {{charimage=@{chat_image}}}" data-i18n="trace" data-i18n-title="trace_description"></button>
            </div>
          </div>
        </div>
        <div class="attribute col100">
          <div class="attribute-title flex col100">
            <button class="rollbutton label" type="roll" name="roll_kinesis" value="&{template:bitd} {{charname=@{character_name}}} {{resist=1}} {{subtitle=^{resists} @{consequence_query} ^{with}}} {{title=^{kinesis}}} @{kinesis_formula} {{charimage=@{chat_image}}}" data-i18n="kinesis" data-i18n-title="kinesis_description"></button>
            <input type="hidden" name="attr_kinesis" value="0"/>
            <input type="hidden" name="attr_kinesis_formula" value=" {{?{@{bonusdice}|0,zerodice=[[d6]]&amp;#44; [[d6]]|1,dice=[[d6]]|2,dice=[[d6]]&amp;#44; [[d6]]|3,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|4,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|5,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|6,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|-1,zerodice=[[d6]]&amp;#44; [[d6]]|-2,zerodice=[[d6]]&amp;#44; [[d6]]|-3,zerodice=[[d6]]&amp;#44; [[d6]]}}}"/>
            <input type="hidden" name="attr_kinesis_xp_max" value="6"/>
            <div class="attribute-xp-box flex">
              <input class="tooth zero" type="radio" name="attr_kinesis_xp" value="0" checked="checked"/><span></span>
              <input class="tooth xptooth" type="radio" name="attr_kinesis_xp" value="1"/><span></span>
              <input class="tooth xptooth" type="radio" name="attr_kinesis_xp" value="2"/><span></span>
              <input class="tooth xptooth" type="radio" name="attr_kinesis_xp" value="3"/><span></span>
              <input class="tooth xptooth" type="radio" name="attr_kinesis_xp" value="4"/><span></span>
              <input class="tooth xptooth" type="radio" name="attr_kinesis_xp" value="5"/><span></span>
              <input class="tooth xptooth" type="radio" name="attr_kinesis_xp" value="6"/><span></span>
            </div>
          </div>
          <div class="actions col100">
            <div class="action flex col100">
              <input type="hidden" name="attr_finesse_formula" value=" {{?{@{bonusdice}|0,zerodice=[[d6]]&amp;#44; [[d6]]|1,dice=[[d6]]|2,dice=[[d6]]&amp;#44; [[d6]]|3,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|4,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|5,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|6,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|-1,zerodice=[[d6]]&amp;#44; [[d6]]|-2,zerodice=[[d6]]&amp;#44; [[d6]]|-3,zerodice=[[d6]]&amp;#44; [[d6]]}}}"/>
              <input class="hidden fakeradio" type="checkbox" name="attr_finesse" value="0" checked="checked"/>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_finesse" value="1"/><span></span>
              <div class="divider"></div>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_finesse" value="2"/><span></span>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_finesse" value="3"/><span></span>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_finesse" value="4"/><span></span>
              <button class="rollbutton label" type="roll" name="roll_finesse" value="&{template:bitd} {{charname=@{character_name}}} {{action=1}} {{subtitle=^{rolls}}} {{title=^{finesse}}} {{@{position_query}}} {{effect=@{effect_query}}} @{finesse_formula} {{charimage=@{chat_image}}}" data-i18n="finesse" data-i18n-title="finesse_description"></button>
            </div>
            <div class="action flex col100">
              <input type="hidden" name="attr_shadow_formula" value=" {{?{@{bonusdice}|0,zerodice=[[d6]]&amp;#44; [[d6]]|1,dice=[[d6]]|2,dice=[[d6]]&amp;#44; [[d6]]|3,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|4,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|5,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|6,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|-1,zerodice=[[d6]]&amp;#44; [[d6]]|-2,zerodice=[[d6]]&amp;#44; [[d6]]|-3,zerodice=[[d6]]&amp;#44; [[d6]]}}}"/>
              <input class="hidden fakeradio" type="checkbox" name="attr_shadow" value="0" checked="checked"/>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_shadow" value="1"/><span></span>
              <div class="divider"></div>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_shadow" value="2"/><span></span>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_shadow" value="3"/><span></span>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_shadow" value="4"/><span></span>
              <button class="rollbutton label" type="roll" name="roll_shadow" value="&{template:bitd} {{charname=@{character_name}}} {{action=1}} {{subtitle=^{rolls}}} {{title=^{shadow}}} {{@{position_query}}} {{effect=@{effect_query}}} @{shadow_formula} {{charimage=@{chat_image}}}" data-i18n="shadow" data-i18n-title="shadow_description"></button>
            </div>
            <div class="action flex col100">
              <input type="hidden" name="attr_skirmish_formula" value=" {{?{@{bonusdice}|0,zerodice=[[d6]]&amp;#44; [[d6]]|1,dice=[[d6]]|2,dice=[[d6]]&amp;#44; [[d6]]|3,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|4,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|5,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|6,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|-1,zerodice=[[d6]]&amp;#44; [[d6]]|-2,zerodice=[[d6]]&amp;#44; [[d6]]|-3,zerodice=[[d6]]&amp;#44; [[d6]]}}}"/>
              <input class="hidden fakeradio" type="checkbox" name="attr_skirmish" value="0" checked="checked"/>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_skirmish" value="1"/><span></span>
              <div class="divider"></div>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_skirmish" value="2"/><span></span>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_skirmish" value="3"/><span></span>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_skirmish" value="4"/><span></span>
              <button class="rollbutton label" type="roll" name="roll_skirmish" value="&{template:bitd} {{charname=@{character_name}}} {{action=1}} {{subtitle=^{rolls}}} {{title=^{skirmish}}} {{@{position_query}}} {{effect=@{effect_query}}} @{skirmish_formula} {{charimage=@{chat_image}}}" data-i18n="skirmish" data-i18n-title="skirmish_description"></button>
            </div>
            <div class="action flex col100">
              <input type="hidden" name="attr_wayfare_formula" value=" {{?{@{bonusdice}|0,zerodice=[[d6]]&amp;#44; [[d6]]|1,dice=[[d6]]|2,dice=[[d6]]&amp;#44; [[d6]]|3,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|4,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|5,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|6,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|-1,zerodice=[[d6]]&amp;#44; [[d6]]|-2,zerodice=[[d6]]&amp;#44; [[d6]]|-3,zerodice=[[d6]]&amp;#44; [[d6]]}}}"/>
              <input class="hidden fakeradio" type="checkbox" name="attr_wayfare" value="0" checked="checked"/>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_wayfare" value="1"/><span></span>
              <div class="divider"></div>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_wayfare" value="2"/><span></span>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_wayfare" value="3"/><span></span>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_wayfare" value="4"/><span></span>
              <button class="rollbutton label" type="roll" name="roll_wayfare" value="&{template:bitd} {{charname=@{character_name}}} {{action=1}} {{subtitle=^{rolls}}} {{title=^{wayfare}}} {{@{position_query}}} {{effect=@{effect_query}}} @{wayfare_formula} {{charimage=@{chat_image}}}" data-i18n="wayfare" data-i18n-title="wayfare_description"></button>
            </div>
          </div>
        </div>
        <div class="attribute col100">
          <div class="attribute-title flex col100">
            <button class="rollbutton label" type="roll" name="roll_semiosis" value="&{template:bitd} {{charname=@{character_name}}} {{resist=1}} {{subtitle=^{resists} @{consequence_query} ^{with}}} {{title=^{semiosis}}} @{semiosis_formula} {{charimage=@{chat_image}}}" data-i18n="semiosis" data-i18n-title="semiosis_description"></button>
            <input type="hidden" name="attr_semiosis" value="0"/>
            <input type="hidden" name="attr_semiosis_formula" value=" {{?{@{bonusdice}|0,zerodice=[[d6]]&amp;#44; [[d6]]|1,dice=[[d6]]|2,dice=[[d6]]&amp;#44; [[d6]]|3,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|4,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|5,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|6,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|-1,zerodice=[[d6]]&amp;#44; [[d6]]|-2,zerodice=[[d6]]&amp;#44; [[d6]]|-3,zerodice=[[d6]]&amp;#44; [[d6]]}}}"/>
            <input type="hidden" name="attr_semiosis_xp_max" value="6"/>
            <div class="attribute-xp-box flex">
              <input class="tooth zero" type="radio" name="attr_semiosis_xp" value="0" checked="checked"/><span></span>
              <input class="tooth xptooth" type="radio" name="attr_semiosis_xp" value="1"/><span></span>
              <input class="tooth xptooth" type="radio" name="attr_semiosis_xp" value="2"/><span></span>
              <input class="tooth xptooth" type="radio" name="attr_semiosis_xp" value="3"/><span></span>
              <input class="tooth xptooth" type="radio" name="attr_semiosis_xp" value="4"/><span></span>
              <input class="tooth xptooth" type="radio" name="attr_semiosis_xp" value="5"/><span></span>
              <input class="tooth xptooth" type="radio" name="attr_semiosis_xp" value="6"/><span></span>
            </div>
          </div>
          <div class="actions col100">
            <div class="action flex col100">
              <input type="hidden" name="attr_bluff_formula" value=" {{?{@{bonusdice}|0,zerodice=[[d6]]&amp;#44; [[d6]]|1,dice=[[d6]]|2,dice=[[d6]]&amp;#44; [[d6]]|3,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|4,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|5,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|6,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|-1,zerodice=[[d6]]&amp;#44; [[d6]]|-2,zerodice=[[d6]]&amp;#44; [[d6]]|-3,zerodice=[[d6]]&amp;#44; [[d6]]}}}"/>
              <input class="hidden fakeradio" type="checkbox" name="attr_bluff" value="0" checked="checked"/>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_bluff" value="1"/><span></span>
              <div class="divider"></div>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_bluff" value="2"/><span></span>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_bluff" value="3"/><span></span>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_bluff" value="4"/><span></span>
              <button class="rollbutton label" type="roll" name="roll_bluff" value="&{template:bitd} {{charname=@{character_name}}} {{action=1}} {{subtitle=^{rolls}}} {{title=^{bluff}}} {{@{position_query}}} {{effect=@{effect_query}}} @{bluff_formula} {{charimage=@{chat_image}}}" data-i18n="bluff" data-i18n-title="bluff_description"></button>
            </div>
            <div class="action flex col100">
              <input type="hidden" name="attr_command_formula" value=" {{?{@{bonusdice}|0,zerodice=[[d6]]&amp;#44; [[d6]]|1,dice=[[d6]]|2,dice=[[d6]]&amp;#44; [[d6]]|3,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|4,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|5,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|6,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|-1,zerodice=[[d6]]&amp;#44; [[d6]]|-2,zerodice=[[d6]]&amp;#44; [[d6]]|-3,zerodice=[[d6]]&amp;#44; [[d6]]}}}"/>
              <input class="hidden fakeradio" type="checkbox" name="attr_command" value="0" checked="checked"/>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_command" value="1"/><span></span>
              <div class="divider"></div>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_command" value="2"/><span></span>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_command" value="3"/><span></span>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_command" value="4"/><span></span>
              <button class="rollbutton label" type="roll" name="roll_command" value="&{template:bitd} {{charname=@{character_name}}} {{action=1}} {{subtitle=^{rolls}}} {{title=^{command}}} {{@{position_query}}} {{effect=@{effect_query}}} @{command_formula} {{charimage=@{chat_image}}}" data-i18n="command" data-i18n-title="command_description"></button>
            </div>
            <div class="action flex col100">
              <input type="hidden" name="attr_connect_formula" value=" {{?{@{bonusdice}|0,zerodice=[[d6]]&amp;#44; [[d6]]|1,dice=[[d6]]|2,dice=[[d6]]&amp;#44; [[d6]]|3,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|4,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|5,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|6,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|-1,zerodice=[[d6]]&amp;#44; [[d6]]|-2,zerodice=[[d6]]&amp;#44; [[d6]]|-3,zerodice=[[d6]]&amp;#44; [[d6]]}}}"/>
              <input class="hidden fakeradio" type="checkbox" name="attr_connect" value="0" checked="checked"/>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_connect" value="1"/><span></span>
              <div class="divider"></div>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_connect" value="2"/><span></span>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_connect" value="3"/><span></span>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_connect" value="4"/><span></span>
              <button class="rollbutton label" type="roll" name="roll_connect" value="&{template:bitd} {{charname=@{character_name}}} {{action=1}} {{subtitle=^{rolls}}} {{title=^{connect}}} {{@{position_query}}} {{effect=@{effect_query}}} @{connect_formula} {{charimage=@{chat_image}}}" data-i18n="connect" data-i18n-title="connect_description"></button>
            </div>
            <div class="action flex col100">
              <input type="hidden" name="attr_tune_formula" value=" {{?{@{bonusdice}|0,zerodice=[[d6]]&amp;#44; [[d6]]|1,dice=[[d6]]|2,dice=[[d6]]&amp;#44; [[d6]]|3,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|4,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|5,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|6,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|-1,zerodice=[[d6]]&amp;#44; [[d6]]|-2,zerodice=[[d6]]&amp;#44; [[d6]]|-3,zerodice=[[d6]]&amp;#44; [[d6]]}}}"/>
              <input class="hidden fakeradio" type="checkbox" name="attr_tune" value="0" checked="checked"/>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_tune" value="1"/><span></span>
              <div class="divider"></div>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_tune" value="2"/><span></span>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_tune" value="3"/><span></span>
              <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_tune" value="4"/><span></span>
              <button class="rollbutton label" type="roll" name="roll_tune" value="&{template:bitd} {{charname=@{character_name}}} {{action=1}} {{subtitle=^{rolls}}} {{title=^{tune}}} {{@{position_query}}} {{effect=@{effect_query}}} @{tune_formula} {{charimage=@{chat_image}}}" data-i18n="tune" data-i18n-title="tune_description"></button>
            </div>
          </div>
        </div>
        <!-- Cohort-->
        <input class="hider" type="hidden" name="attr_setting_show_cohort" value="0"/>
        <div class="cohort">
          <input type="hidden" name="attr_char_cohort_verb" value="^{rolls_their}"/>
          <input type="hidden" name="attr_char_cohort_roll_formula" value=" {{?{@{bonusdice}|0,zerodice=[[d6]]&amp;#44; [[d6]]|1,dice=[[d6]]|2,dice=[[d6]]&amp;#44; [[d6]]|3,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|4,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|5,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|6,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|-1,zerodice=[[d6]]&amp;#44; [[d6]]|-2,zerodice=[[d6]]&amp;#44; [[d6]]|-3,zerodice=[[d6]]&amp;#44; [[d6]]}}}"/>
          <div class="cohort-title flex col100 label">
            <input class="inherit" type="text" spellcheck="false" name="attr_char_cohort_name" value="Expert"/>
            <button class="inherit rollbutton" type="roll" name="roll_char_cohort_roll" value="&{template:bitd} {{charname=@{character_name}}} {{resist=1}} {{short=1}} {{charname=@{char_cohort_name} (^{@{char_cohort_type}}, @{char_cohort_subtype})}} {{title=^{cohort_quality}}} {{subtitle=@{char_cohort_verb}}}) @{char_cohort_roll_formula} {{charimage=@{chat_image}}}" data-i18n="roll-inf"></button>
          </div>
          <div class="cohort-info flex col100 uppercase">
            <div class="cohort-dropdown">
              <div><span name="attr_char_cohort_type" data-i18n-dynamic="data-i18n-dynamic"></span></div>
              <div>
                <input type="radio" name="attr_char_cohort_type" value="expert" checked="checked"/><span data-i18n="expert"></span>
              </div>
            </div>
            <input class="sheet-inherit" type="text" spellcheck="false" name="attr_char_cohort_subtype" data-i18n-placeholder="hunter"/>
            <div class="label cohort-quality-label" data-i18n="quality_abbreviated">Q:</div>
            <input class="label" type="number" name="attr_char_cohort_quality" min="0" max="5" value="1"/>
          </div>
          <div class="cohort-condition flex col100">
            <label><span class="cohort-condition-name uppercase" data-i18n="weak"></span>
              <input class="tooth regulartooth" type="checkbox" name="attr_char_cohort_weak" value="1"/><span></span>
            </label>
            <label><span class="cohort-condition-name uppercase" data-i18n="impaired"></span>
              <input class="tooth regulartooth" type="checkbox" name="attr_char_cohort_impaired" value="1"/><span></span>
            </label>
            <label><span class="cohort-condition-name uppercase" data-i18n="broken"></span>
              <input class="tooth regulartooth" type="checkbox" name="attr_char_cohort_broken" value="1"/><span></span>
            </label>
            <label><span class="cohort-condition-name label" data-i18n="neutralized"></span>
              <input class="tooth regulartooth" type="checkbox" name="attr_char_cohort_neutralized" value="1"/><span></span>
            </label>
          </div>
          <label class="cohort-edgeflaw"><span class="uppercase" data-i18n="edges"></span>
            <div class="auto-expand"><span name="attr_char_cohort_edges"></span>
              <textarea spellcheck="false" name="attr_char_cohort_edges"></textarea>
            </div>
          </label>
          <label class="cohort-edgeflaw"><span class="uppercase" data-i18n="flaws"></span>
            <div class="auto-expand"><span name="attr_char_cohort_flaws"></span>
              <textarea spellcheck="false" name="attr_char_cohort_flaws"></textarea>
            </div>
          </label>
          <textarea class="cohort-description" spellcheck="false" name="attr_char_cohort_description"></textarea>
        </div>
        <!-- Bonus die box-->
        <div class="bonusdie col100">
          <div class="col100 label" data-i18n="bonus_die"></div>
          <div class="col100 flex">
            <div class="flex-center bonusdieplus">+</div>
            <div class="bonusdietext">
              <div class="label" data-i18n="push_yourself"></div><span data-i18n="push_yourself_desc"></span>
              <div class="label" data-i18n="devils_bargain"></div>
            </div>
          </div>
          <div class="col100 flex">
            <div class="flex-center bonusdieplus">+</div>
            <div class="bonusdietext">
              <div class="label" data-i18n="get_assisted"></div>
            </div>
          </div>
          <div class="col100 flex">
            <div class="flex-center bonusdieplus">+</div>
            <div class="bonusdietext">
              <div class="label" data-i18n="spend_harmony"></div>
            </div>
          </div>
        </div>
        <!-- Friends-->
        <div class="col100 def-margin friends">
          <div class="specialheader col100 label flex">
            <input class="inherit" type="text" spellcheck="false" name="attr_friends_title" value="Friends"/>
          </div>
          <div class="greyholder col100">
            <fieldset class="repeating_friend">
              <div class="friend-contact friend flex">
                <input class="friendstate" type="hidden" name="attr_status" value="0"/>
                <label class="up">
                  <input class="checkbox" type="checkbox" name="attr_status" value="up"/><span></span>
                </label>
                <label class="down">
                  <input class="checkbox" type="checkbox" name="attr_status" value="down"/><span></span>
                </label>
                <div class="auto-expand"><span name="attr_name"></span>
                  <textarea spellcheck="false" name="attr_name" data-i18n-placeholder="friend_name"></textarea>
                </div>
              </div>
              <input class="expand" type="checkbox" name="attr_null" value="1"/><span></span>
              <textarea class="description" spellcheck="false" name="attr_description" data-i18n-placeholder="notes"></textarea>
            </fieldset>
          </div>
        </div>
        <!-- Roll Fortune-->
        <button class="fortunebutton borderbutton" type="roll" name="roll_Fortune" value="&{template:bitd} {{charname=@{character_name}}} {{fortune=1}} {{subtitle=^{rolls}}} {{title=^{fortune}}} @{numberofdice} {{charimage=@{chat_image}}} {{notes=@{notes_query}}} " data-i18n="roll_fortune"></button>
      </div>
      <!-- Clocks-->
      <div class="col100 clocks def-margin free-repcontrol">
        <div class="specialheader label" data-i18n="clocks"></div>
        <fieldset class="repeating_clock">
          <input class="size" type="hidden" name="attr_size" value=""/>
          <div class="auto-expand smallcaps"><span name="attr_name"></span>
            <textarea spellcheck="false" name="attr_name" data-i18n-placeholder="clock_name"></textarea>
          </div>
          <button class="broadcast-button" type="roll" name="roll_Show" value="&{template:bitd-broadcast} {{charname=@{character_name}}} {{title=@{name}}} {{clock=1}} {{clocksize=@{size}}} {{clockprogress=@{progress}}} {{charimage=@{chat_image}}}" data-i18n-title="send_details_to_chat">:</button>
          <div class="size-choice">
            <label class="text-button">
              <input type="radio" name="attr_size" value="4"/><span>4</span>
            </label>
            <label class="text-button">
              <input type="radio" name="attr_size" value="6"/><span>6</span>
            </label>
            <label class="text-button">
              <input type="radio" name="attr_size" value="8"/><span>8</span>
            </label>
            <label class="text-button">
              <input type="radio" name="attr_size" value="10"/><span>10</span>
            </label>
            <label class="text-button">
              <input type="radio" name="attr_size" value="12"/><span>12</span>
            </label>
          </div>
          <div class="clock-container">
            <div class="spoke-0 all"></div>
            <div class="spoke-30 sheet-12clock"></div>
            <div class="spoke-45 sheet-8clock"></div>
            <div class="spoke-36 sheet-10clock"></div>
            <div class="spoke-60 sheet-6clock sheet-12clock"></div>
            <div class="spoke-72 sheet-10clock"></div>
            <div class="spoke-90 sheet-4clock sheet-8clock sheet-12clock"></div>
            <div class="spoke-108 sheet-10clock"></div>
            <div class="spoke-120 sheet-6clock sheet-12clock"></div>
            <div class="spoke-135 sheet-8clock"></div>
            <div class="spoke-144 sheet-10clock"></div>
            <div class="spoke-150 sheet-12clock"></div>
            <input class="zero input-progress" type="radio" name="attr_progress" value="0" checked="checked"/><span></span>
            <input class="input-progress all" type="radio" name="attr_progress" value="1"/>
            <input class="input-progress all" type="radio" name="attr_progress" value="2"/>
            <input class="input-progress all" type="radio" name="attr_progress" value="3"/>
            <input class="input-progress all" type="radio" name="attr_progress" value="4"/>
            <input class="input-progress sheet-6clock sheet-8clock sheet-10clock sheet-12clock" type="radio" name="attr_progress" value="5"/>
            <input class="input-progress sheet-6clock sheet-8clock sheet-10clock sheet-12clock" type="radio" name="attr_progress" value="6"/>
            <input class="input-progress sheet-8clock sheet-10clock sheet-12clock" type="radio" name="attr_progress" value="7"/>
            <input class="input-progress sheet-8clock sheet-10clock sheet-12clock" type="radio" name="attr_progress" value="8"/>
            <input class="input-progress sheet-10clock sheet-12clock" type="radio" name="attr_progress" value="9"/>
            <input class="input-progress sheet-10clock sheet-12clock" type="radio" name="attr_progress" value="10"/>
            <input class="input-progress sheet-12clock" type="radio" name="attr_progress" value="11"/>
            <input class="input-progress sheet-12clock" type="radio" name="attr_progress" value="12"/>
            <div class="clock"></div>
          </div>
        </fieldset>
      </div>
      <textarea class="notes" spellcheck="false" name="attr_beliefs" data-i18n-placeholder="beliefs"></textarea>
      <textarea class="notes" spellcheck="false" name="attr_drives" data-i18n-placeholder="drives"></textarea>
      <textarea class="notes" spellcheck="false" name="attr_notes" data-i18n-placeholder="notes"></textarea>
    </div>
  </div>
  <!-- Crew Sheet-->
  <div class="type-crew flex">
    <!-- Left column-->
    <div class="col55 flex-wrap">
      <!-- Logo, Header text fields-->
      <div class="col100 header flex-wrap">
        <div class="col55 bladeslogo"></div>
        <div class="col45 crewheader label" data-i18n="crew_sheet"></div>
        <label class="col55">
          <input type="text" spellcheck="false" name="attr_crew_name"/>
          <div class="label text title" data-i18n="crew_name"></div>
        </label>
        <label class="col45">
          <input type="text" spellcheck="false" name="attr_reputation"/>
          <div class="label text title" data-i18n="reputation"></div>
        </label>
        <label class="col100">
          <input type="text" spellcheck="false" name="attr_lair"/>
          <div class="label text title" data-i18n="lair"></div>
        </label>
      </div>
      <!-- Rep, Hold, and Tier-->
      <div class="col100 flex rep-and-hold def-margin">
        <div class="rep flex col45">
          <div class="rep1 blackheader">
            <div class="label" data-i18n="rep"></div>
          </div>
          <div class="rep2 blackborder flex">
            <div class="turfbox">
              <input type="radio" name="attr_turf" value="1"/><span></span>
              <input type="radio" name="attr_turf" value="2"/><span></span>
              <input type="radio" name="attr_turf" value="3"/><span></span>
              <input type="radio" name="attr_turf" value="4"/><span></span>
              <input type="radio" name="attr_turf" value="5"/><span></span>
              <input type="radio" name="attr_turf" value="6"/><span></span>
            </div>
            <input class="turf-input" type="hidden" name="attr_turf" value="0"/>
            <input class="tooth zero" type="radio" name="attr_rep" value="0" checked="checked"/><span></span>
            <input class="tooth stresstooth" type="radio" name="attr_rep" value="1"/><span></span>
            <input class="tooth stresstooth" type="radio" name="attr_rep" value="2"/><span></span>
            <input class="tooth stresstooth" type="radio" name="attr_rep" value="3"/><span></span>
            <input class="tooth stresstooth" type="radio" name="attr_rep" value="4"/><span></span>
            <input class="tooth stresstooth" type="radio" name="attr_rep" value="5"/><span></span>
            <input class="tooth stresstooth" type="radio" name="attr_rep" value="6"/><span></span>
            <input class="tooth stresstooth turf6" type="radio" name="attr_rep" value="7"/><span></span>
            <input class="tooth stresstooth turf6 turf5" type="radio" name="attr_rep" value="8"/><span></span>
            <input class="tooth stresstooth turf6 turf5 turf4" type="radio" name="attr_rep" value="9"/><span></span>
            <input class="tooth stresstooth turf6 turf5 turf4 turf3" type="radio" name="attr_rep" value="10"/><span></span>
            <input class="tooth stresstooth turf6 turf5 turf4 turf3 turf2" type="radio" name="attr_rep" value="11"/><span></span>
            <input class="tooth stresstooth turf6 turf5 turf4 turf3 turf2 turf1" type="radio" name="attr_rep" value="12"/><span></span>
          </div>
          <div class="rep3 blackborder">
            <div class="black-on-grey">
              <div class="label" data-i18n="turf"></div>
            </div>
            <div class="turfzero-holder">
              <input class="zero" type="radio" name="attr_turf" value="0" checked="checked"/><span></span>
            </div>
          </div>
        </div>
        <!-- Hold-->
        <div class="hold flex">
          <div class="hold1 blackheader">
            <div class="label" data-i18n="hold"></div>
          </div>
          <label class="blackborder">
            <div class="black-on-grey">
              <div class="label" data-i18n="weak"></div>
            </div>
            <input class="tooth holdtooth" type="radio" name="attr_hold" value="weak"/><span></span>
          </label>
          <label class="blackborder">
            <div class="black-on-grey">
              <div class="label" data-i18n="strong"></div>
            </div>
            <input class="tooth holdtooth" type="radio" name="attr_hold" value="strong" checked="checked"/><span></span>
          </label>
          <!-- Tier-->
          <div class="blackheader">
            <button class="label inherit rollbutton" type="roll" name="roll_Tier" value="&{template:bitd} {{charname=@{character_name}}} {{resist=1}} {{short=1}} {{title=^{crew_tier}}} {{subtitle=^{roll_their}}} @{crew_tier_formula} {{charimage=@{chat_image}}}" data-i18n="tier"></button>
            <input type="hidden" name="attr_crew_tier_formula" value=" {{?{@{bonusdice}|0,zerodice=[[d6]]&amp;#44; [[d6]]|1,dice=[[d6]]|2,dice=[[d6]]&amp;#44; [[d6]]|3,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|4,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|5,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|6,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|-1,zerodice=[[d6]]&amp;#44; [[d6]]|-2,zerodice=[[d6]]&amp;#44; [[d6]]|-3,zerodice=[[d6]]&amp;#44; [[d6]]}}}"/>
          </div>
          <div class="tier flex">
            <input class="hidden fakeradio" type="checkbox" name="attr_crew_tier" value="0" checked="checked"/>
            <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_crew_tier" value="1"/><span></span>
            <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_crew_tier" value="2"/><span></span>
            <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_crew_tier" value="3"/><span></span>
            <input class="checkbox circlebox fakeradio" type="checkbox" name="attr_crew_tier" value="4"/><span></span>
          </div>
        </div>
      </div>
      <!-- Claims-->
      <div class="claims col100 free-repcontrol">
        <div class="claimsrow flex">
            <input type="hidden" name="attr_claim_1_check" value="0"/>
            <div class="claimbox">
              <label>
                <input class="checkbox squarebox-small" type="checkbox" name="attr_claim_1_check" value="1"/><span></span>
              </label>
              <textarea class="label" spellcheck="false" name="attr_claim_1_name"></textarea>
              <textarea class="claim-desc" spellcheck="false" name="attr_claim_1_desc"></textarea>
            </div>
            <label class="claimbridge claims-horisep">
              <input type="checkbox" name="attr_claim_bridge_1_2" value="1" checked="checked"/><span></span>
            </label>
            <input type="hidden" name="attr_claim_2_check" value="0"/>
            <div class="claimbox">
              <label>
                <input class="checkbox squarebox-small" type="checkbox" name="attr_claim_2_check" value="1"/><span></span>
              </label>
              <textarea class="label" spellcheck="false" name="attr_claim_2_name"></textarea>
              <textarea class="claim-desc" spellcheck="false" name="attr_claim_2_desc"></textarea>
            </div>
            <label class="claimbridge claims-horisep">
              <input type="checkbox" name="attr_claim_bridge_2_3" value="1" checked="checked"/><span></span>
            </label>
            <input type="hidden" name="attr_claim_3_check" value="0"/>
            <div class="claimbox">
              <label>
                <input class="checkbox squarebox-small" type="checkbox" name="attr_claim_3_check" value="1"/><span></span>
              </label>
              <textarea class="label" spellcheck="false" name="attr_claim_3_name"></textarea>
              <textarea class="claim-desc" spellcheck="false" name="attr_claim_3_desc"></textarea>
            </div>
            <label class="claimbridge claims-horisep">
              <input type="checkbox" name="attr_claim_bridge_3_4" value="1" checked="checked"/><span></span>
            </label>
            <input type="hidden" name="attr_claim_4_check" value="0"/>
            <div class="claimbox">
              <label>
                <input class="checkbox squarebox-small" type="checkbox" name="attr_claim_4_check" value="1"/><span></span>
              </label>
              <textarea class="label" spellcheck="false" name="attr_claim_4_name"></textarea>
              <textarea class="claim-desc" spellcheck="false" name="attr_claim_4_desc"></textarea>
            </div>
            <label class="claimbridge claims-horisep">
              <input type="checkbox" name="attr_claim_bridge_4_5" value="1" checked="checked"/><span></span>
            </label>
            <input type="hidden" name="attr_claim_5_check" value="0"/>
            <div class="claimbox">
              <label>
                <input class="checkbox squarebox-small" type="checkbox" name="attr_claim_5_check" value="1"/><span></span>
              </label>
              <textarea class="label" spellcheck="false" name="attr_claim_5_name"></textarea>
              <textarea class="claim-desc" spellcheck="false" name="attr_claim_5_desc"></textarea>
            </div>
        </div>
        <div class="claims-seprow flex">
            <label class="claimbridge claims-vertsep">
              <input type="checkbox" name="attr_claim_bridge_1_6" value="1" checked="checked"/><span></span>
            </label>
            <label class="claimbridge claims-vertsep">
              <input type="checkbox" name="attr_claim_bridge_2_7" value="1" checked="checked"/><span></span>
            </label>
            <label class="claimbridge claims-vertsep">
              <input type="checkbox" name="attr_claim_bridge_3_8" value="1" checked="checked"/><span></span>
            </label>
            <label class="claimbridge claims-vertsep">
              <input type="checkbox" name="attr_claim_bridge_4_9" value="1" checked="checked"/><span></span>
            </label>
            <label class="claimbridge claims-vertsep">
              <input type="checkbox" name="attr_claim_bridge_5_10" value="1" checked="checked"/><span></span>
            </label>
        </div>
        <div class="claimsrow flex">
            <input type="hidden" name="attr_claim_6_check" value="0"/>
            <div class="claimbox">
              <label>
                <input class="checkbox squarebox-small" type="checkbox" name="attr_claim_6_check" value="1"/><span></span>
              </label>
              <textarea class="label" spellcheck="false" name="attr_claim_6_name"></textarea>
              <textarea class="claim-desc" spellcheck="false" name="attr_claim_6_desc"></textarea>
            </div>
            <label class="claimbridge claims-horisep">
              <input type="checkbox" name="attr_claim_bridge_6_7" value="1" checked="checked"/><span></span>
            </label>
            <input type="hidden" name="attr_claim_7_check" value="0"/>
            <div class="claimbox">
              <label>
                <input class="checkbox squarebox-small" type="checkbox" name="attr_claim_7_check" value="1"/><span></span>
              </label>
              <textarea class="label" spellcheck="false" name="attr_claim_7_name"></textarea>
              <textarea class="claim-desc" spellcheck="false" name="attr_claim_7_desc"></textarea>
            </div>
            <label class="claimbridge claims-horisep">
              <input type="checkbox" name="attr_claim_bridge_7_8" value="1" checked="checked"/><span></span>
            </label>
          <div class="lairbox flex-center uppercase" data-i18n="lair"></div>
            <label class="claimbridge claims-horisep">
              <input type="checkbox" name="attr_claim_bridge_8_9" value="1" checked="checked"/><span></span>
            </label>
            <input type="hidden" name="attr_claim_9_check" value="0"/>
            <div class="claimbox">
              <label>
                <input class="checkbox squarebox-small" type="checkbox" name="attr_claim_9_check" value="1"/><span></span>
              </label>
              <textarea class="label" spellcheck="false" name="attr_claim_9_name"></textarea>
              <textarea class="claim-desc" spellcheck="false" name="attr_claim_9_desc"></textarea>
            </div>
            <label class="claimbridge claims-horisep">
              <input type="checkbox" name="attr_claim_bridge_9_10" value="1" checked="checked"/><span></span>
            </label>
            <input type="hidden" name="attr_claim_10_check" value="0"/>
            <div class="claimbox">
              <label>
                <input class="checkbox squarebox-small" type="checkbox" name="attr_claim_10_check" value="1"/><span></span>
              </label>
              <textarea class="label" spellcheck="false" name="attr_claim_10_name"></textarea>
              <textarea class="claim-desc" spellcheck="false" name="attr_claim_10_desc"></textarea>
            </div>
        </div>
        <div class="claims-seprow flex">
            <label class="claimbridge claims-vertsep">
              <input type="checkbox" name="attr_claim_bridge_6_11" value="1" checked="checked"/><span></span>
            </label>
            <label class="claimbridge claims-vertsep">
              <input type="checkbox" name="attr_claim_bridge_7_12" value="1" checked="checked"/><span></span>
            </label>
            <label class="claimbridge claims-vertsep">
              <input type="checkbox" name="attr_claim_bridge_8_13" value="1" checked="checked"/><span></span>
            </label>
            <label class="claimbridge claims-vertsep">
              <input type="checkbox" name="attr_claim_bridge_9_14" value="1" checked="checked"/><span></span>
            </label>
            <label class="claimbridge claims-vertsep">
              <input type="checkbox" name="attr_claim_bridge_10_15" value="1" checked="checked"/><span></span>
            </label>
        </div>
        <div class="claimsrow flex">
            <input type="hidden" name="attr_claim_11_check" value="0"/>
            <div class="claimbox">
              <label>
                <input class="checkbox squarebox-small" type="checkbox" name="attr_claim_11_check" value="1"/><span></span>
              </label>
              <textarea class="label" spellcheck="false" name="attr_claim_11_name"></textarea>
              <textarea class="claim-desc" spellcheck="false" name="attr_claim_11_desc"></textarea>
            </div>
            <label class="claimbridge claims-horisep">
              <input type="checkbox" name="attr_claim_bridge_11_12" value="1" checked="checked"/><span></span>
            </label>
            <input type="hidden" name="attr_claim_12_check" value="0"/>
            <div class="claimbox">
              <label>
                <input class="checkbox squarebox-small" type="checkbox" name="attr_claim_12_check" value="1"/><span></span>
              </label>
              <textarea class="label" spellcheck="false" name="attr_claim_12_name"></textarea>
              <textarea class="claim-desc" spellcheck="false" name="attr_claim_12_desc"></textarea>
            </div>
            <label class="claimbridge claims-horisep">
              <input type="checkbox" name="attr_claim_bridge_12_13" value="1" checked="checked"/><span></span>
            </label>
            <input type="hidden" name="attr_claim_13_check" value="0"/>
            <div class="claimbox">
              <label>
                <input class="checkbox squarebox-small" type="checkbox" name="attr_claim_13_check" value="1"/><span></span>
              </label>
              <textarea class="label" spellcheck="false" name="attr_claim_13_name"></textarea>
              <textarea class="claim-desc" spellcheck="false" name="attr_claim_13_desc"></textarea>
            </div>
            <label class="claimbridge claims-horisep">
              <input type="checkbox" name="attr_claim_bridge_13_14" value="1" checked="checked"/><span></span>
            </label>
            <input type="hidden" name="attr_claim_14_check" value="0"/>
            <div class="claimbox">
              <label>
                <input class="checkbox squarebox-small" type="checkbox" name="attr_claim_14_check" value="1"/><span></span>
              </label>
              <textarea class="label" spellcheck="false" name="attr_claim_14_name"></textarea>
              <textarea class="claim-desc" spellcheck="false" name="attr_claim_14_desc"></textarea>
            </div>
            <label class="claimbridge claims-horisep">
              <input type="checkbox" name="attr_claim_bridge_14_15" value="1" checked="checked"/><span></span>
            </label>
            <input type="hidden" name="attr_claim_15_check" value="0"/>
            <div class="claimbox">
              <label>
                <input class="checkbox squarebox-small" type="checkbox" name="attr_claim_15_check" value="1"/><span></span>
              </label>
              <textarea class="label" spellcheck="false" name="attr_claim_15_name"></textarea>
              <textarea class="claim-desc" spellcheck="false" name="attr_claim_15_desc"></textarea>
            </div>
        </div>
        <fieldset class="repeating_claim">
          <div class="claims-seprow flex">
              <label class="claimbridge claims-vertsep">
                <input type="checkbox" name="attr_claim_bridge_top_1" value="1" checked="checked"/><span></span>
              </label>
              <label class="claimbridge claims-vertsep">
                <input type="checkbox" name="attr_claim_bridge_top_2" value="1" checked="checked"/><span></span>
              </label>
              <label class="claimbridge claims-vertsep">
                <input type="checkbox" name="attr_claim_bridge_top_3" value="1" checked="checked"/><span></span>
              </label>
              <label class="claimbridge claims-vertsep">
                <input type="checkbox" name="attr_claim_bridge_top_4" value="1" checked="checked"/><span></span>
              </label>
              <label class="claimbridge claims-vertsep">
                <input type="checkbox" name="attr_claim_bridge_top_5" value="1" checked="checked"/><span></span>
              </label>
          </div>
          <div class="claimsrow flex">
              <input type="hidden" name="attr_claim_1_check" value="0"/>
              <div class="claimbox">
                <label>
                  <input class="checkbox squarebox-small" type="checkbox" name="attr_claim_1_check" value="1"/><span></span>
                </label>
                <textarea class="label" spellcheck="false" name="attr_claim_1_name"></textarea>
                <textarea class="claim-desc" spellcheck="false" name="attr_claim_1_desc"></textarea>
              </div>
              <label class="claimbridge claims-horisep">
                <input type="checkbox" name="attr_claim_bridge_1_2" value="1" checked="checked"/><span></span>
              </label>
              <input type="hidden" name="attr_claim_2_check" value="0"/>
              <div class="claimbox">
                <label>
                  <input class="checkbox squarebox-small" type="checkbox" name="attr_claim_2_check" value="1"/><span></span>
                </label>
                <textarea class="label" spellcheck="false" name="attr_claim_2_name"></textarea>
                <textarea class="claim-desc" spellcheck="false" name="attr_claim_2_desc"></textarea>
              </div>
              <label class="claimbridge claims-horisep">
                <input type="checkbox" name="attr_claim_bridge_2_3" value="1" checked="checked"/><span></span>
              </label>
              <input type="hidden" name="attr_claim_3_check" value="0"/>
              <div class="claimbox">
                <label>
                  <input class="checkbox squarebox-small" type="checkbox" name="attr_claim_3_check" value="1"/><span></span>
                </label>
                <textarea class="label" spellcheck="false" name="attr_claim_3_name"></textarea>
                <textarea class="claim-desc" spellcheck="false" name="attr_claim_3_desc"></textarea>
              </div>
              <label class="claimbridge claims-horisep">
                <input type="checkbox" name="attr_claim_bridge_3_4" value="1" checked="checked"/><span></span>
              </label>
              <input type="hidden" name="attr_claim_4_check" value="0"/>
              <div class="claimbox">
                <label>
                  <input class="checkbox squarebox-small" type="checkbox" name="attr_claim_4_check" value="1"/><span></span>
                </label>
                <textarea class="label" spellcheck="false" name="attr_claim_4_name"></textarea>
                <textarea class="claim-desc" spellcheck="false" name="attr_claim_4_desc"></textarea>
              </div>
              <label class="claimbridge claims-horisep">
                <input type="checkbox" name="attr_claim_bridge_4_5" value="1" checked="checked"/><span></span>
              </label>
              <input type="hidden" name="attr_claim_5_check" value="0"/>
              <div class="claimbox">
                <label>
                  <input class="checkbox squarebox-small" type="checkbox" name="attr_claim_5_check" value="1"/><span></span>
                </label>
                <textarea class="label" spellcheck="false" name="attr_claim_5_name"></textarea>
                <textarea class="claim-desc" spellcheck="false" name="attr_claim_5_desc"></textarea>
              </div>
          </div>
        </fieldset>
      </div>
      <!-- Heat and Coin-->
      <div class="col100 flex heat-and-vault def-margin">
        <div class="blackheader crewcoin1">
          <div class="label" data-i18n="supply"></div>
        </div>
      </div>
      <!-- Coin and Stash-->
      <div class="col100 sheet-coin-and-stash">
        <!-- Coin-->
        <div class="col100 coinrow flex">
          <div class="col100 stash">
            <input class="zero" type="radio" name="attr_stash" value="0" checked="checked"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="1"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="2"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="3"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="4"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="5"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="6"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="7"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="8"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="9"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="10"/><span></span><br/>
            <input class="radiobox" type="radio" name="attr_stash" value="11"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="12"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="13"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="14"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="15"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="16"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="17"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="18"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="19"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="20"/><span></span><br/>
            <input class="radiobox" type="radio" name="attr_stash" value="21"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="22"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="23"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="24"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="25"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="26"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="27"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="28"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="29"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="30"/><span></span><br/>
            <input class="radiobox" type="radio" name="attr_stash" value="31"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="32"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="33"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="34"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="35"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="36"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="37"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="38"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="39"/><span></span>
            <input class="radiobox" type="radio" name="attr_stash" value="40"/><span></span><br/>
          </div>
        </div>
      </div>
      <div class="col100 flex heat-and-vault def-margin">
        <div class="blackheader crewcoin1">
          <div class="label" data-i18n="investment"></div>
        </div>
      </div>
      <div class="col100 sheet-coin-and-stash">
        <div class="col100 coinrow flex">
          <div class="col100 investment">
            <input class="zero" type="radio" name="attr_investment" value="0" checked="checked"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="1"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="2"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="3"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="4"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="5"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="6"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="7"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="8"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="9"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="10"/><span></span><br/>
            <input class="radiobox" type="radio" name="attr_investment" value="11"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="12"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="13"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="14"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="15"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="16"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="17"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="18"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="19"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="20"/><span></span><br/>
            <input class="radiobox" type="radio" name="attr_investment" value="21"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="22"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="23"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="24"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="25"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="26"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="27"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="28"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="29"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="30"/><span></span><br/>
            <input class="radiobox" type="radio" name="attr_investment" value="31"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="32"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="33"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="34"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="35"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="36"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="37"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="38"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="39"/><span></span>
            <input class="radiobox" type="radio" name="attr_investment" value="40"/><span></span><br/>
          </div>
        </div>
      </div>
      <!-- Special abilities-->
      <div class="col100 def-margin">
        <div class="specialheader col100 label" data-i18n="special_abilities"></div>
        <div class="greyholder col100">
          <fieldset class="repeating_crewability">
            <div class="specialability flex">
              <button class="broadcast-button" type="roll" name="roll_Show" value="&{template:bitd-broadcast} {{charname=@{character_name}}} {{type=^{special_ability}}} {{title=@{name}}} {{content=@{description}}} {{charimage=@{chat_image}}}" data-i18n-title="send_details_to_chat">:</button>
              <input class="checkbox circlebox" type="checkbox" name="attr_check" value="1"/><span></span>
              <div class="auto-expand abilityname smallcaps"><span name="attr_name"></span>
                <textarea spellcheck="false" name="attr_name" data-i18n-placeholder="ability_name"></textarea>
              </div>
              <div class="auto-expand abilitydesc"><span name="attr_description"></span>
                <textarea spellcheck="false" name="attr_description" data-i18n-placeholder="ability_description"></textarea>
              </div>
            </div>
          </fieldset>
        </div>
      </div>
      <!-- Advancement-->
      <div class="col100 def-margin">
        <div class="advancement-header flex blackheader">
          <div class="label markxp" data-i18n="mark_xp:"></div>
          <div class="label" data-i18n="crew_advancement"></div>
          <div class="xpholder flex">
            <input class="tooth zero" type="radio" name="attr_crew_xp" value="0" checked="checked"/><span></span>
            <input class="tooth xptooth" type="radio" name="attr_crew_xp" value="1"/><span></span>
            <input class="tooth xptooth" type="radio" name="attr_crew_xp" value="2"/><span></span>
            <input class="tooth xptooth" type="radio" name="attr_crew_xp" value="3"/><span></span>
            <input class="tooth xptooth" type="radio" name="attr_crew_xp" value="4"/><span></span>
            <input class="tooth xptooth" type="radio" name="attr_crew_xp" value="5"/><span></span>
            <input class="tooth xptooth" type="radio" name="attr_crew_xp" value="6"/><span></span>
            <input class="tooth xptooth" type="radio" name="attr_crew_xp" value="7"/><span></span>
            <input class="tooth xptooth" type="radio" name="attr_crew_xp" value="8"/><span></span>
            <input class="tooth xptooth" type="radio" name="attr_crew_xp" value="9"/><span></span>
            <input class="tooth xptooth" type="radio" name="attr_crew_xp" value="10"/><span></span>
          </div>
        </div>
        <ul class="advancement-desc">
          <li class="nondot" data-i18n="xp_top"></li>
          <li>
            <div class="auto-expand"><span name="attr_crew_xp_condition"></span>
              <textarea spellcheck="false" name="attr_crew_xp_condition" data-i18n-placeholder="xp_crew_specific"></textarea>
            </div>
          </li>
          <input class="hider" type="hidden" name="attr_setting_extra_xp" value="0"/>
          <li>
            <div class="auto-expand"><span name="attr_xp_condition_extra"></span>
              <textarea spellcheck="false" name="attr_xp_condition_extra" data-i18n-placeholder="xp_specific_extra"></textarea>
            </div>
          </li>
          <li data-i18n="xp_contend"></li>
          <li data-i18n="xp_bolster"></li>
          <li data-i18n="xp_express"></li>
        </ul>
      </div>
    </div>
    <!-- Right column-->
    <div class="col45 flex-wrap right-column">
      <!-- Crew Type-->
      <div class="playbook flex">
        <input class="label" type="text" spellcheck="false" name="attr_crew_type" data-i18n-placeholder="crew" placeholder="Crew"/>
        <textarea class="label" spellcheck="false" name="attr_crew_description" data-i18n-placeholder="crew_description" placeholder="A short crew description"></textarea>
        <input class="hider" type="hidden" name="attr_show_playbook_reminder" value="1"/>
        <div class="reminder"><span data-i18n="autofill_reminder_crew"></span><br/><span data-i18n="list_crews"></span></div>
      </div>
      <!-- Upgrades and Hunting Grounds-->
      <div class="col53 small-margin">
        <!-- Upgrades-->
        <div class="itemheader col100"><span class="label" data-i18n="crew_upgrades"></span></div>
        <div class="itemholder col100 upgrades">
          <!-- Specific upgrades-->
          <div class="playbookitems col100 free-repcontrol">
            <fieldset class="repeating_upgrade">
              <input class="boxes-chosen" type="hidden" name="attr_boxes_chosen" value="0"/>
              <div class="item numboxes-chooser">
                <div data-i18n="how_many_boxes"></div>
                <input type="number" name="attr_numboxes" min="1" max="3" value="1"/>
                <label>
                  <input type="checkbox" name="attr_boxes_chosen" value="1"/><span data-i18n="ok"></span>
                </label>
              </div>
              <div class="item">
                <input class="numboxes" type="hidden" name="attr_numboxes" value="1"/>
                <input class="checkbox squarebox" type="checkbox" name="attr_check_1" value="1"/><span></span><span class="floatingbar boxesgeq2"></span>
                <input class="checkbox squarebox boxesgeq2" type="checkbox" name="attr_check_2" value="1"/><span class="boxesgeq2"></span><span class="floatingbar boxesgeq3 boxesgeq2"></span>
                <input class="checkbox squarebox boxesgeq2 boxesgeq3" type="checkbox" name="attr_check_3" value="1"/><span class="boxesgeq2 boxesgeq3"></span>
                <div class="auto-expand itemname"><span name="attr_name"></span>
                  <textarea spellcheck="false" name="attr_name" data-i18n-placeholder="an_upgrade"></textarea>
                </div>
              </div>
              <div class="item-description">
                <input class="expand" type="checkbox" name="attr_expand" value="1"/><span></span>
                <textarea spellcheck="false" name="attr_description" data-i18n-placeholder="description"></textarea>
              </div>
            </fieldset>
          </div>
          <!-- Regular upgrades-->
          <div class="regularitems flex-wrap col100">
            <div class="item col50"><span class="label" data-i18n="lair"></span></div>
            <div class="item col50"><span class="label" data-i18n="quality"></span></div>
              <div class="col50">
                <div class="item">
                  <input class="checkbox squarebox" type="checkbox" name="attr_upgrade_5_check_1" value="1"/><span></span>
                  <input class="itemname" type="text" spellcheck="false" name="attr_upgrade_5_name" value="Rover"/>
                </div>
                <div class="item-description">
                  <input class="expand" type="checkbox" name="attr_upgrade_5_expand" value="1"/><span></span>
                  <textarea spellcheck="false" name="attr_upgrade_5_description" data-i18n-placeholder="description">You have a heavy, 6-wheeled, all-terrain rover and a garage to store it. The rover’s equipped with cargo compartments and big enough to comfortably fit a large group’s worth of people (about 20).  A second upgrade improves the rover with heavy armor and a dome-shield that can remain active as long as the rover is still. You can hitch a trailer or truckbed to the rover.</textarea>
                </div>
              </div>
              <div class="col50">
                <div class="item">
                  <input class="checkbox squarebox" type="checkbox" name="attr_upgrade_11_check_1" value="1"/><span></span>
                  <input class="itemname" type="text" spellcheck="false" name="attr_upgrade_11_name" value="Packs"/>
                </div>
                <div class="item-description">
                  <input class="expand" type="checkbox" name="attr_upgrade_11_expand" value="1"/><span></span>
                  <textarea spellcheck="false" name="attr_upgrade_11_description" data-i18n-placeholder="description">Each upgrade improves the quality rating of all packs, which covers analysis, comms, &amp; survival packs.</textarea>
                </div>
              </div>
              <div class="col50">
                <div class="item">
                  <input class="checkbox squarebox" type="checkbox" name="attr_upgrade_6_check_1" value="1"/><span></span>
                  <input class="itemname" type="text" spellcheck="false" name="attr_upgrade_6_name" value="Dropjet"/>
                </div>
                <div class="item-description">
                  <input class="expand" type="checkbox" name="attr_upgrade_6_expand" value="1"/><span></span>
                  <textarea spellcheck="false" name="attr_upgrade_6_description" data-i18n-placeholder="description">You have a VTOL transport jet and a hangar to store and deploy it. The jet’s sealed and rated for short stints in a vacuum or underwater, and big enough to comfortably fit a medium group’s worth of people (about 12). A second upgrade improves the jet with heavy armor and equips it with optical cloaking and noise bafflers for stealthy flight.</textarea>
                </div>
              </div>
              <div class="col50">
                <div class="item">
                  <input class="checkbox squarebox" type="checkbox" name="attr_upgrade_12_check_1" value="1"/><span></span>
                  <input class="itemname" type="text" spellcheck="false" name="attr_upgrade_12_name" value="Weapons"/>
                </div>
                <div class="item-description">
                  <input class="expand" type="checkbox" name="attr_upgrade_12_expand" value="1"/><span></span>
                  <textarea spellcheck="false" name="attr_upgrade_12_description" data-i18n-placeholder="description">Each upgrade improves the quality rating of all packs, which covers melee weapons, small arms, and heavy ordnance.</textarea>
                </div>
              </div>
              <div class="col50">
                <div class="item">
                  <input class="checkbox squarebox" type="checkbox" name="attr_upgrade_7_check_1" value="1"/><span></span>
                  <input class="itemname" type="text" spellcheck="false" name="attr_upgrade_7_name" value="Quarters"/>
                </div>
                <div class="item-description">
                  <input class="expand" type="checkbox" name="attr_upgrade_7_expand" value="1"/><span></span>
                  <textarea spellcheck="false" name="attr_upgrade_7_description" data-i18n-placeholder="description">Your base has a few bunks, but this upgrade gives you enough that you can all reliably sleep on the base — plus lots more in case you find refugees who need a place to stay for a while.</textarea>
                </div>
              </div>
              <div class="col50">
                <div class="item">
                  <input class="checkbox squarebox" type="checkbox" name="attr_upgrade_13_check_1" value="1"/><span></span>
                  <input class="itemname" type="text" spellcheck="false" name="attr_upgrade_13_name" value="Tools"/>
                </div>
                <div class="item-description">
                  <input class="expand" type="checkbox" name="attr_upgrade_13_expand" value="1"/><span></span>
                  <textarea spellcheck="false" name="attr_upgrade_13_description" data-i18n-placeholder="description">Each upgrade improves the quality rating of all packs, which covers charmwork tools, repair tools, and demolition tools.</textarea>
                </div>
              </div>
              <div class="col50">
                <div class="item">
                  <input class="checkbox squarebox" type="checkbox" name="attr_upgrade_8_check_1" value="1"/><span></span>
                  <input class="itemname" type="text" spellcheck="false" name="attr_upgrade_8_name" value="Warehouses"/>
                </div>
                <div class="item-description">
                  <input class="expand" type="checkbox" name="attr_upgrade_8_expand" value="1"/><span></span>
                  <textarea spellcheck="false" name="attr_upgrade_8_description" data-i18n-placeholder="description">Your base has a large warehouse to contain your trade, increasing your storage capacity from 4 to 8. A second upgrade increases your storage capacity to 16.</textarea>
                </div>
              </div>
              <div class="col50">
                <div class="item">
                  <input class="checkbox squarebox" type="checkbox" name="attr_upgrade_14_check_1" value="1"/><span></span>
                  <input class="itemname" type="text" spellcheck="false" name="attr_upgrade_14_name" value="Kits"/>
                </div>
                <div class="item-description">
                  <input class="expand" type="checkbox" name="attr_upgrade_14_expand" value="1"/><span></span>
                  <textarea spellcheck="false" name="attr_upgrade_14_description" data-i18n-placeholder="description">Each upgrade improves the quality rating of all packs, which covers medkits, infiltration kits, and jumpkits.</textarea>
                </div>
              </div>
              <div class="col50">
                <div class="item">
                  <input class="checkbox squarebox" type="checkbox" name="attr_upgrade_9_check_1" value="1"/><span></span>
                  <input class="checkbox squarebox" type="checkbox" name="attr_upgrade_9_check_2" value="1"/><span></span>
                  <input class="itemname" type="text" spellcheck="false" name="attr_upgrade_9_name" value="Security"/>
                </div>
                <div class="item-description">
                  <input class="expand" type="checkbox" name="attr_upgrade_9_expand" value="1"/><span></span>
                  <textarea spellcheck="false" name="attr_upgrade_9_description" data-i18n-placeholder="description">Your base comes equipped with locks, intruder alarms, and cameras to help stop intruders. A second upgrade improves your base with hard armor and arcane defenses to defend against military or arcane attack.</textarea>
                </div>
              </div>
              <div class="col50">
                <div class="item">
                  <input class="checkbox squarebox" type="checkbox" name="attr_upgrade_15_check_1" value="1"/><span></span>
                  <input class="itemname" type="text" spellcheck="false" name="attr_upgrade_15_name" value=" "/>
                </div>
                <div class="item-description">
                  <input class="expand" type="checkbox" name="attr_upgrade_15_expand" value="1"/><span></span>
                  <textarea spellcheck="false" name="attr_upgrade_15_description" data-i18n-placeholder="description"></textarea>
                </div>
              </div>
              <div class="col50">
                <div class="item">
                  <input class="checkbox squarebox" type="checkbox" name="attr_upgrade_10_check_1" value="1"/><span></span>
                  <input class="itemname" type="text" spellcheck="false" name="attr_upgrade_10_name" value="Workshop"/>
                </div>
                <div class="item-description">
                  <input class="expand" type="checkbox" name="attr_upgrade_10_expand" value="1"/><span></span>
                  <textarea spellcheck="false" name="attr_upgrade_10_description" data-i18n-placeholder="description">3D printers, welding and soldering torches, a forge, high-end computers, arcane texts, ancient runes, and a stock of technological and arcane supplies with which you might manufacture anything your heart desires. Your Tier counts as 1 higher when you make a crafting roll.</textarea>
                </div>
              </div>
            <div class="item col50"></div>
            <div class="item upgradecaption col50"><span class="label" data-i18n="training"></span></div>
            <div class="item upgradecaption col50"><span class="label" data-i18n="cohorts"></span></div>
              <div class="col50">
                <div class="item">
                  <input class="checkbox squarebox" type="checkbox" name="attr_upgrade_20_check_1" value="1"/><span></span>
                  <input class="itemname" type="text" spellcheck="false" name="attr_upgrade_20_name"/>
                </div>
                <div class="item-description">
                  <input class="expand" type="checkbox" name="attr_upgrade_20_expand" value="1"/><span></span>
                  <textarea spellcheck="false" name="attr_upgrade_20_description" data-i18n-placeholder="description"></textarea>
                </div>
              </div>
            <div class="item col50">
              <div class="label upgradecosts" data-i18n="upgrade_costs"></div>
            </div>
              <div class="col50">
                <div class="item">
                  <input class="checkbox squarebox" type="checkbox" name="attr_upgrade_21_check_1" value="1"/><span></span>
                  <input class="itemname" type="text" spellcheck="false" name="attr_upgrade_21_name"/>
                </div>
                <div class="item-description">
                  <input class="expand" type="checkbox" name="attr_upgrade_21_expand" value="1"/><span></span>
                  <textarea spellcheck="false" name="attr_upgrade_21_description" data-i18n-placeholder="description"></textarea>
                </div>
              </div>
            <div class="item col50">
              <div class="upgradecosts" data-i18n="new_cohort"></div>
            </div>
              <div class="col50">
                <div class="item">
                  <input class="checkbox squarebox" type="checkbox" name="attr_upgrade_22_check_1" value="1"/><span></span>
                  <input class="itemname" type="text" spellcheck="false" name="attr_upgrade_22_name"/>
                </div>
                <div class="item-description">
                  <input class="expand" type="checkbox" name="attr_upgrade_22_expand" value="1"/><span></span>
                  <textarea spellcheck="false" name="attr_upgrade_22_description" data-i18n-placeholder="description"></textarea>
                </div>
              </div>
            <div class="item col50">
              <div class="upgradecosts" data-i18n="add_type"></div>
            </div>
              <div class="col50">
                <div class="item">
                  <input class="checkbox squarebox" type="checkbox" name="attr_upgrade_23_check_1" value="1"/><span></span>
                  <input class="itemname" type="text" spellcheck="false" name="attr_upgrade_23_name" value="Playbook"/>
                </div>
                <div class="item-description">
                  <input class="expand" type="checkbox" name="attr_upgrade_23_expand" value="1"/><span></span>
                  <textarea spellcheck="false" name="attr_upgrade_23_description" data-i18n-placeholder="description">Earn 2 xp when training playbook during downtime.</textarea>
                </div>
              </div>
          </div>
        </div>
        <div class="hunting-grounds col100 def-margin">
          <div class="auto-expand plainheader label"><span name="attr_hunting_grounds_type"></span>
            <textarea spellcheck="false" name="attr_hunting_grounds_type" data-i18n-placeholder="hunting_grounds"></textarea>
          </div>
          <div class="auto-expand description"><span name="attr_hunting_grounds_description"></span>
            <textarea spellcheck="false" name="attr_hunting_grounds_description" data-i18n-placeholder="hunting_grounds_description"></textarea>
          </div>
        </div>
        <button class="engagementbutton borderbutton" type="roll" name="roll_Engagement" value="&{template:bitd} {{charname=@{character_name}}} {{action=1}} {{short=1}} {{small-title=1}} {{subtitle=^{roll_for}}} {{title=^{engagement}}} @{numberofdice} {{charimage=@{chat_image}}} " data-i18n="roll_engagement"></button>
      </div>
      <!-- Cohorts and Contacts-->
      <div class="col47 right-column small-margin">
        <!-- First Cohort-->
        <div class="cohort">
          <input type="hidden" name="attr_cohort1_verb" value="^{roll_their}"/>
          <input type="hidden" name="attr_cohort1_roll_formula" value=" {{?{@{bonusdice}|0,zerodice=[[d6]]&amp;#44; [[d6]]|1,dice=[[d6]]|2,dice=[[d6]]&amp;#44; [[d6]]|3,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|4,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|5,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|6,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|-1,zerodice=[[d6]]&amp;#44; [[d6]]|-2,zerodice=[[d6]]&amp;#44; [[d6]]|-3,zerodice=[[d6]]&amp;#44; [[d6]]}}}"/>
          <div class="cohort-title flex col100 label">
            <input class="inherit" type="text" spellcheck="false" name="attr_cohort1_name" value="Expert"/>
            <button class="inherit rollbutton" type="roll" name="roll_cohort1_roll" value="&{template:bitd} {{charname=@{character_name}}} {{resist=1}} {{short=1}} {{charname=@{cohort1_name} (^{@{cohort1_type}}, @{cohort1_subtype})}} {{title=^{cohort_quality}}} {{subtitle=@{cohort1_verb}}}) @{cohort1_roll_formula} {{charimage=@{chat_image}}}" data-i18n="roll-inf"></button>
          </div>
          <div class="cohort-info flex col100 uppercase">
            <div class="cohort-dropdown">
              <div><span name="attr_cohort1_type" data-i18n-dynamic="data-i18n-dynamic"></span></div>
              <div>
                <input type="radio" name="attr_cohort1_type" value="expert"/><span data-i18n="expert"></span>
              </div>
            </div>
            <input class="sheet-inherit" type="text" spellcheck="false" name="attr_cohort1_subtype" data-i18n-placeholder="gang_type"/>
          </div>
          <div class="cohort-condition flex col100">
            <label><span class="cohort-condition-name uppercase" data-i18n="weak"></span>
              <input class="tooth regulartooth" type="checkbox" name="attr_cohort1_weak" value="1"/><span></span>
            </label>
            <label><span class="cohort-condition-name uppercase" data-i18n="impaired"></span>
              <input class="tooth regulartooth" type="checkbox" name="attr_cohort1_impaired" value="1"/><span></span>
            </label>
            <label><span class="cohort-condition-name uppercase" data-i18n="broken"></span>
              <input class="tooth regulartooth" type="checkbox" name="attr_cohort1_broken" value="1"/><span></span>
            </label>
            <label><span class="cohort-condition-name label" data-i18n="neutralized"></span>
              <input class="tooth regulartooth" type="checkbox" name="attr_cohort1_neutralized" value="1"/><span></span>
            </label>
          </div>
          <label class="cohort-edgeflaw"><span class="uppercase" data-i18n="edges"></span>
            <div class="auto-expand"><span name="attr_cohort1_edges"></span>
              <textarea spellcheck="false" name="attr_cohort1_edges"></textarea>
            </div>
          </label>
          <label class="cohort-edgeflaw"><span class="uppercase" data-i18n="flaws"></span>
            <div class="auto-expand"><span name="attr_cohort1_flaws"></span>
              <textarea spellcheck="false" name="attr_cohort1_flaws"></textarea>
            </div>
          </label>
          <textarea class="cohort-description" spellcheck="false" name="attr_cohort1_description"></textarea>
        </div>
        <!-- Cohort repeating section-->
        <div class="col100 cohorts free-repcontrol">
          <fieldset class="repeating_cohort">
            <div class="cohort">
              <input type="hidden" name="attr_verb" value="^{roll_their}"/>
              <input type="hidden" name="attr_roll_formula" value=" {{?{@{bonusdice}|0,zerodice=[[d6]]&amp;#44; [[d6]]|1,dice=[[d6]]|2,dice=[[d6]]&amp;#44; [[d6]]|3,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|4,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|5,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|6,dice=[[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]&amp;#44; [[d6]]|-1,zerodice=[[d6]]&amp;#44; [[d6]]|-2,zerodice=[[d6]]&amp;#44; [[d6]]|-3,zerodice=[[d6]]&amp;#44; [[d6]]}}}"/>
              <div class="cohort-title flex col100 label">
                <input class="inherit" type="text" spellcheck="false" name="attr_name" value="Expert"/>
                <button class="inherit rollbutton" type="roll" name="roll_roll" value="&{template:bitd} {{charname=@{character_name}}} {{resist=1}} {{short=1}} {{charname=@{name} (^{@{type}}, @{subtype})}} {{title=^{cohort_quality}}} {{subtitle=@{verb}}}) @{roll_formula} {{charimage=@{chat_image}}}" data-i18n="roll-inf"></button>
              </div>
              <div class="cohort-info flex col100 uppercase">
                <div class="cohort-dropdown">
                  <div><span name="attr_type" data-i18n-dynamic="data-i18n-dynamic"></span></div>
                  <div>
                    <input type="radio" name="attr_type" value="expert"/><span data-i18n="expert"></span>
                  </div>
                </div>
                <input class="sheet-inherit" type="text" spellcheck="false" name="attr_subtype" data-i18n-placeholder="gang_type"/>
              </div>
              <div class="cohort-condition flex col100">
                <label><span class="cohort-condition-name uppercase" data-i18n="weak"></span>
                  <input class="tooth regulartooth" type="checkbox" name="attr_weak" value="1"/><span></span>
                </label>
                <label><span class="cohort-condition-name uppercase" data-i18n="impaired"></span>
                  <input class="tooth regulartooth" type="checkbox" name="attr_impaired" value="1"/><span></span>
                </label>
                <label><span class="cohort-condition-name uppercase" data-i18n="broken"></span>
                  <input class="tooth regulartooth" type="checkbox" name="attr_broken" value="1"/><span></span>
                </label>
                <label><span class="cohort-condition-name label" data-i18n="neutralized"></span>
                  <input class="tooth regulartooth" type="checkbox" name="attr_neutralized" value="1"/><span></span>
                </label>
              </div>
              <label class="cohort-edgeflaw"><span class="uppercase" data-i18n="edges"></span>
                <div class="auto-expand"><span name="attr_edges"></span>
                  <textarea spellcheck="false" name="attr_edges"></textarea>
                </div>
              </label>
              <label class="cohort-edgeflaw"><span class="uppercase" data-i18n="flaws"></span>
                <div class="auto-expand"><span name="attr_flaws"></span>
                  <textarea spellcheck="false" name="attr_flaws"></textarea>
                </div>
              </label>
              <textarea class="cohort-description" spellcheck="false" name="attr_description"></textarea>
            </div>
          </fieldset>
        </div>
        <!-- Contacts-->
        <div class="col100 def-margin contacts">
          <div class="specialheader col100 label flex">
            <input class="inherit" type="text" spellcheck="false" name="attr_contacts_title" value="Contacts"/>
          </div>
          <div class="greyholder col100">
            <fieldset class="repeating_contact">
              <div class="friend-contact contact flex">
                <input class="friendstate" type="hidden" name="attr_check" value="0"/>
                <label>
                  <input class="checkbox" type="checkbox" name="attr_check" value="1"/><span></span>
                </label>
                <div class="auto-expand"><span name="attr_name"></span>
                  <textarea spellcheck="false" name="attr_name" data-i18n-placeholder="contact_name"></textarea>
                </div>
              </div>
              <input class="expand" type="checkbox" name="attr_null" value="1"/><span></span>
              <textarea class="description" spellcheck="false" name="attr_description" data-i18n-placeholder="notes"></textarea>
            </fieldset>
          </div>
        </div>
        <!-- Roll Fortune-->
        <button class="fortunebutton borderbutton" type="roll" name="roll_Fortune_crew" value="&{template:bitd} {{charname=@{character_name}}} {{fortune=1}} {{subtitle=^{roll}}} {{title=^{fortune}}} @{numberofdice} {{charimage=@{chat_image}}} {{notes=@{notes_query}}} " data-i18n="roll_fortune"></button>
      </div>
      <!-- Clocks-->
      <div class="col100 clocks def-margin free-repcontrol">
        <div class="specialheader label" data-i18n="clocks"></div>
        <fieldset class="repeating_crewclock">
          <input class="size" type="hidden" name="attr_size" value=""/>
          <div class="auto-expand smallcaps"><span name="attr_name"></span>
            <textarea spellcheck="false" name="attr_name" data-i18n-placeholder="clock_name"></textarea>
          </div>
          <button class="broadcast-button" type="roll" name="roll_Show" value="&{template:bitd-broadcast} {{charname=@{character_name}}} {{title=@{name}}} {{clock=1}} {{clocksize=@{size}}} {{clockprogress=@{progress}}} {{charimage=@{chat_image}}}" data-i18n-title="send_details_to_chat">:</button>
          <div class="size-choice">
            <label class="text-button">
              <input type="radio" name="attr_size" value="4"/><span>4</span>
            </label>
            <label class="text-button">
              <input type="radio" name="attr_size" value="6"/><span>6</span>
            </label>
            <label class="text-button">
              <input type="radio" name="attr_size" value="8"/><span>8</span>
            </label>
            <label class="text-button">
              <input type="radio" name="attr_size" value="10"/><span>10</span>
            </label>
            <label class="text-button">
              <input type="radio" name="attr_size" value="12"/><span>12</span>
            </label>
          </div>
          <div class="clock-container">
            <div class="spoke-0 all"></div>
            <div class="spoke-30 sheet-12clock"></div>
            <div class="spoke-45 sheet-8clock"></div>
            <div class="spoke-36 sheet-10clock"></div>
            <div class="spoke-60 sheet-6clock sheet-12clock"></div>
            <div class="spoke-72 sheet-10clock"></div>
            <div class="spoke-90 sheet-4clock sheet-8clock sheet-12clock"></div>
            <div class="spoke-108 sheet-10clock"></div>
            <div class="spoke-120 sheet-6clock sheet-12clock"></div>
            <div class="spoke-135 sheet-8clock"></div>
            <div class="spoke-144 sheet-10clock"></div>
            <div class="spoke-150 sheet-12clock"></div>
            <input class="zero input-progress" type="radio" name="attr_progress" value="0" checked="checked"/><span></span>
            <input class="input-progress all" type="radio" name="attr_progress" value="1"/>
            <input class="input-progress all" type="radio" name="attr_progress" value="2"/>
            <input class="input-progress all" type="radio" name="attr_progress" value="3"/>
            <input class="input-progress all" type="radio" name="attr_progress" value="4"/>
            <input class="input-progress sheet-6clock sheet-8clock sheet-10clock sheet-12clock" type="radio" name="attr_progress" value="5"/>
            <input class="input-progress sheet-6clock sheet-8clock sheet-10clock sheet-12clock" type="radio" name="attr_progress" value="6"/>
            <input class="input-progress sheet-8clock sheet-10clock sheet-12clock" type="radio" name="attr_progress" value="7"/>
            <input class="input-progress sheet-8clock sheet-10clock sheet-12clock" type="radio" name="attr_progress" value="8"/>
            <input class="input-progress sheet-10clock sheet-12clock" type="radio" name="attr_progress" value="9"/>
            <input class="input-progress sheet-10clock sheet-12clock" type="radio" name="attr_progress" value="10"/>
            <input class="input-progress sheet-12clock" type="radio" name="attr_progress" value="11"/>
            <input class="input-progress sheet-12clock" type="radio" name="attr_progress" value="12"/>
            <div class="clock"></div>
          </div>
        </fieldset>
      </div>
      <textarea class="notes" spellcheck="false" name="attr_crew_notes" data-i18n-placeholder="notes"></textarea>
    </div>
  </div>
  <!-- Faction Sheet-->
  <input class="input-clocks-only" type="hidden" name="attr_setting_clocks_only" value="0"/>
  <div class="type-faction flex-wrap">
    <div class="factiontitle flex col100">
      <input class="label" type="text" spellcheck="false" name="attr_factions_title" value="Factions of Tamaris"/>
      <input class="hider" type="hidden" name="attr_show_faction_generatebutton" value="1"/>
      <label class="generatebutton">
        <input type="checkbox" name="attr_generate_factions" value="1"/><span data-i18n="generate_factions"></span>
      </label>
      <button class="fortunebutton borderbutton" type="roll" name="roll_Fortune_faction" value="&{template:bitd} {{charname=@{character_name}}} {{fortune=1}} {{title=^{fortune}}} {{short=1}} {{charname=}} @{numberofdice} {{charimage=@{chat_image}}} {{notes=@{notes_query}}} " data-i18n="roll_fortune"></button>
    </div>
    <div class="factions flex free-repcontrol">
      <div class="col30b">
          <div class="factions-header flex uppercase">
            <input class="faction-name label" type="text" spellcheck="false" name="attr_factions1_header" value="International Factions"/><span class="faction-tier" data-i18n="tier"></span><span class="faction-hold" data-i18n="hold"></span><span class="faction-status" data-i18n="status"></span>
          </div>
          <fieldset class="repeating_factions1">
            <div class="faction">
              <input class="expand" type="checkbox" name="attr_expand" value="1"/><span></span>
              <input class="faction-name" type="text" spellcheck="false" name="attr_name"/>
              <input class="faction-tier" type="text" spellcheck="false" name="attr_tier"/>
              <input class="faction-hold" type="text" spellcheck="false" name="attr_hold"/>
              <input class="faction-status" type="number" name="attr_status"/>
              <textarea spellcheck="false" name="attr_notes" data-i18n-placeholder="faction_notes"></textarea>
            </div>
          </fieldset>
          <div class="factions-header flex uppercase">
            <input class="faction-name label" type="text" spellcheck="false" name="attr_factions2_header" value="Acanthia"/><span class="faction-tier" data-i18n="tier"></span><span class="faction-hold" data-i18n="hold"></span><span class="faction-status" data-i18n="status"></span>
          </div>
          <fieldset class="repeating_factions2">
            <div class="faction">
              <input class="expand" type="checkbox" name="attr_expand" value="1"/><span></span>
              <input class="faction-name" type="text" spellcheck="false" name="attr_name"/>
              <input class="faction-tier" type="text" spellcheck="false" name="attr_tier"/>
              <input class="faction-hold" type="text" spellcheck="false" name="attr_hold"/>
              <input class="faction-status" type="number" name="attr_status"/>
              <textarea spellcheck="false" name="attr_notes" data-i18n-placeholder="faction_notes"></textarea>
            </div>
          </fieldset>
          <div class="factions-header flex uppercase sheet-def-margin">
            <input class="faction-name label" type="text" spellcheck="false" name="attr_factions3_header" value="Malvarose"/><span class="faction-tier" data-i18n="tier"></span><span class="faction-hold" data-i18n="hold"></span><span class="faction-status" data-i18n="status"></span>
          </div>
          <fieldset class="repeating_factions3">
            <div class="faction">
              <input class="expand" type="checkbox" name="attr_expand" value="1"/><span></span>
              <input class="faction-name" type="text" spellcheck="false" name="attr_name"/>
              <input class="faction-tier" type="text" spellcheck="false" name="attr_tier"/>
              <input class="faction-hold" type="text" spellcheck="false" name="attr_hold"/>
              <input class="faction-status" type="number" name="attr_status"/>
              <textarea spellcheck="false" name="attr_notes" data-i18n-placeholder="faction_notes"></textarea>
            </div>
          </fieldset>
      </div>
      <div class="col30b">
          <div class="factions-header flex uppercase">
            <input class="faction-name label" type="text" spellcheck="false" name="attr_factions4_header" value="Meridian Valley"/><span class="faction-tier" data-i18n="tier"></span><span class="faction-hold" data-i18n="hold"></span><span class="faction-status" data-i18n="status"></span>
          </div>
          <fieldset class="repeating_factions4">
            <div class="faction">
              <input class="expand" type="checkbox" name="attr_expand" value="1"/><span></span>
              <input class="faction-name" type="text" spellcheck="false" name="attr_name"/>
              <input class="faction-tier" type="text" spellcheck="false" name="attr_tier"/>
              <input class="faction-hold" type="text" spellcheck="false" name="attr_hold"/>
              <input class="faction-status" type="number" name="attr_status"/>
              <textarea spellcheck="false" name="attr_notes" data-i18n-placeholder="faction_notes"></textarea>
            </div>
          </fieldset>
          <div class="factions-header flex uppercase">
            <input class="faction-name label" type="text" spellcheck="false" name="attr_factions5_header" value="Pinelocke"/><span class="faction-tier" data-i18n="tier"></span><span class="faction-hold" data-i18n="hold"></span><span class="faction-status" data-i18n="status"></span>
          </div>
          <fieldset class="repeating_factions5">
            <div class="faction">
              <input class="expand" type="checkbox" name="attr_expand" value="1"/><span></span>
              <input class="faction-name" type="text" spellcheck="false" name="attr_name"/>
              <input class="faction-tier" type="text" spellcheck="false" name="attr_tier"/>
              <input class="faction-hold" type="text" spellcheck="false" name="attr_hold"/>
              <input class="faction-status" type="number" name="attr_status"/>
              <textarea spellcheck="false" name="attr_notes" data-i18n-placeholder="faction_notes"></textarea>
            </div>
          </fieldset>
          <div class="factions-header flex uppercase">
            <input class="faction-name label" type="text" spellcheck="false" name="attr_factions6_header" value="Red Empire"/><span class="faction-tier" data-i18n="tier"></span><span class="faction-hold" data-i18n="hold"></span><span class="faction-status" data-i18n="status"></span>
          </div>
          <fieldset class="repeating_factions6">
            <div class="faction">
              <input class="expand" type="checkbox" name="attr_expand" value="1"/><span></span>
              <input class="faction-name" type="text" spellcheck="false" name="attr_name"/>
              <input class="faction-tier" type="text" spellcheck="false" name="attr_tier"/>
              <input class="faction-hold" type="text" spellcheck="false" name="attr_hold"/>
              <input class="faction-status" type="number" name="attr_status"/>
              <textarea spellcheck="false" name="attr_notes" data-i18n-placeholder="faction_notes"></textarea>
            </div>
          </fieldset>
      </div>
      <div class="col30b">
          <div class="factions-header flex uppercase">
            <input class="faction-name label" type="text" spellcheck="false" name="attr_factions7_header" value="Serafin"/><span class="faction-tier" data-i18n="tier"></span><span class="faction-hold" data-i18n="hold"></span><span class="faction-status" data-i18n="status"></span>
          </div>
          <fieldset class="repeating_factions7">
            <div class="faction">
              <input class="expand" type="checkbox" name="attr_expand" value="1"/><span></span>
              <input class="faction-name" type="text" spellcheck="false" name="attr_name"/>
              <input class="faction-tier" type="text" spellcheck="false" name="attr_tier"/>
              <input class="faction-hold" type="text" spellcheck="false" name="attr_hold"/>
              <input class="faction-status" type="number" name="attr_status"/>
              <textarea spellcheck="false" name="attr_notes" data-i18n-placeholder="faction_notes"></textarea>
            </div>
          </fieldset>
          <div class="factions-header flex uppercase">
            <input class="faction-name label" type="text" spellcheck="false" name="attr_factions8_header" value="Starfire Pelagic"/><span class="faction-tier" data-i18n="tier"></span><span class="faction-hold" data-i18n="hold"></span><span class="faction-status" data-i18n="status"></span>
          </div>
          <fieldset class="repeating_factions8">
            <div class="faction">
              <input class="expand" type="checkbox" name="attr_expand" value="1"/><span></span>
              <input class="faction-name" type="text" spellcheck="false" name="attr_name"/>
              <input class="faction-tier" type="text" spellcheck="false" name="attr_tier"/>
              <input class="faction-hold" type="text" spellcheck="false" name="attr_hold"/>
              <input class="faction-status" type="number" name="attr_status"/>
              <textarea spellcheck="false" name="attr_notes" data-i18n-placeholder="faction_notes"></textarea>
            </div>
          </fieldset>
      </div>
    </div>
    <div class="clocks col55 free-repcontrol">
      <div class="specialheader label" data-i18n="clocks"></div>
      <fieldset class="repeating_factionclock">
        <input class="size" type="hidden" name="attr_size" value=""/>
        <div class="auto-expand smallcaps"><span name="attr_name"></span>
          <textarea spellcheck="false" name="attr_name" data-i18n-placeholder="clock_name"></textarea>
        </div>
        <button class="broadcast-button" type="roll" name="roll_Show" value="&{template:bitd-broadcast} {{charname=@{character_name}}} {{title=@{name}}} {{clock=1}} {{clocksize=@{size}}} {{clockprogress=@{progress}}} {{charimage=@{chat_image}}}" data-i18n-title="send_details_to_chat">:</button>
        <div class="size-choice">
          <label class="text-button">
            <input type="radio" name="attr_size" value="4"/><span>4</span>
          </label>
          <label class="text-button">
            <input type="radio" name="attr_size" value="6"/><span>6</span>
          </label>
          <label class="text-button">
            <input type="radio" name="attr_size" value="8"/><span>8</span>
          </label>
          <label class="text-button">
            <input type="radio" name="attr_size" value="10"/><span>10</span>
          </label>
          <label class="text-button">
            <input type="radio" name="attr_size" value="12"/><span>12</span>
          </label>
        </div>
        <div class="clock-container">
          <div class="spoke-0 all"></div>
          <div class="spoke-30 sheet-12clock"></div>
          <div class="spoke-45 sheet-8clock"></div>
          <div class="spoke-36 sheet-10clock"></div>
          <div class="spoke-60 sheet-6clock sheet-12clock"></div>
          <div class="spoke-72 sheet-10clock"></div>
          <div class="spoke-90 sheet-4clock sheet-8clock sheet-12clock"></div>
          <div class="spoke-108 sheet-10clock"></div>
          <div class="spoke-120 sheet-6clock sheet-12clock"></div>
          <div class="spoke-135 sheet-8clock"></div>
          <div class="spoke-144 sheet-10clock"></div>
          <div class="spoke-150 sheet-12clock"></div>
          <input class="zero input-progress" type="radio" name="attr_progress" value="0" checked="checked"/><span></span>
          <input class="input-progress all" type="radio" name="attr_progress" value="1"/>
          <input class="input-progress all" type="radio" name="attr_progress" value="2"/>
          <input class="input-progress all" type="radio" name="attr_progress" value="3"/>
          <input class="input-progress all" type="radio" name="attr_progress" value="4"/>
          <input class="input-progress sheet-6clock sheet-8clock sheet-10clock sheet-12clock" type="radio" name="attr_progress" value="5"/>
          <input class="input-progress sheet-6clock sheet-8clock sheet-10clock sheet-12clock" type="radio" name="attr_progress" value="6"/>
          <input class="input-progress sheet-8clock sheet-10clock sheet-12clock" type="radio" name="attr_progress" value="7"/>
          <input class="input-progress sheet-8clock sheet-10clock sheet-12clock" type="radio" name="attr_progress" value="8"/>
          <input class="input-progress sheet-10clock sheet-12clock" type="radio" name="attr_progress" value="9"/>
          <input class="input-progress sheet-10clock sheet-12clock" type="radio" name="attr_progress" value="10"/>
          <input class="input-progress sheet-12clock" type="radio" name="attr_progress" value="11"/>
          <input class="input-progress sheet-12clock" type="radio" name="attr_progress" value="12"/>
          <div class="clock"></div>
        </div>
      </fieldset>
    </div>
    <div class="col45 right-column">
      <textarea class="notes" spellcheck="false" name="attr_faction_notes" data-i18n-placeholder="notes"></textarea>
    </div>
  </div>
</div>
<rolltemplate class="sheet-rolltemplate-bitd">
  <div class="holder{{#action}} action{{/action}}{{#resist}} resist{{/resist}}{{#vice}} vice{{/vice}}{{#fortune}} fortune{{/fortune}}{{#short}} short{{/short}}{{#action}}{{^position}} short{{/position}}{{/action}}">{{#charimage}}
    <div class="char-image">[Image]({{charimage}})</div>{{/charimage}}
    <div class="header{{#charimage}} narrow{{/charimage}}">{{charname}} {{subtitle}}</div>
    <div class="title"><span class="{{#small-title}}small-title{{/small-title}}">{{title}}</span></div>
    <div class="dice">{{^zerodice}}{{dice}}{{/zerodice}}{{#zerodice}}
      <div class="zerodice1">{{zerodice}}</div>
      <div class="zerodice2" data-i18n="zerodice"></div>{{/zerodice}}
    </div>{{#position}}
    <div class="position">{{position}}</div>{{/position}}{{#effect}}
    <div class="effect">{{effect}}</div>{{/effect}}{{#resist}}{{^short}}
    <div class="instructions" data-i18n="resist_instructions"></div>{{/short}}{{/resist}}{{#vice}}{{^short}}
    <div class="instructions" data-i18n="vice_instructions"></div>{{/short}}{{/vice}}{{#notes}}
    <div class="notes">{{notes}}</div>{{/notes}}
  </div>
</rolltemplate>
<rolltemplate class="sheet-rolltemplate-bitd-broadcast">
  <div>{{#charimage}}{{^clock}}
    <div class="char-image">[Image]({{charimage}})</div>{{/clock}}{{/charimage}}
    <div class="header{{#charimage}}{{^clock}} narrow{{/clock}}{{/charimage}}">
      <div>{{charname}}</div>
      <div>{{type}}</div>
    </div>{{#content}}
    <div class="title">{{title}}</div>
    <div class="content">{{content}}</div>{{/content}}{{#clock}}
    <div class="flex">
      <div class="clock size-{{clocksize}} progress-{{clockprogress}}">
        <div class="spoke-0"></div>
        <div class="spoke-30"></div>
        <div class="spoke-36"></div>
        <div class="spoke-45"></div>
        <div class="spoke-60"></div>
        <div class="spoke-72"></div>
        <div class="spoke-90"></div>
        <div class="spoke-108"></div>
        <div class="spoke-135"></div>
        <div class="spoke-144"></div>
        <div class="spoke-120"></div>
        <div class="spoke-150"></div>
      </div>
      <div class="title">{{title}}</div>
    </div>{{/clock}}{{#harm}}
    <div class="title" data-i18n="harm"></div>
    <table class="harm">
      <tr>
        <td>3</td>
        <td>
          <div class="harm-inner">{{harm3}}</div>
        </td>
        <td data-i18n="need_help"></td>
      </tr>
      <tr>
        <td>2</td>
        <td>{{#harm2_1}}
          <div class="harm-inner">{{harm2_1}}</div>{{/harm2_1}}{{#harm2_2}}
          <div class="harm-inner">{{harm2_2}}</div>{{/harm2_2}}
        </td>
        <td data-i18n="minus1d"></td>
      </tr>
      <tr>
        <td>1</td>
        <td>{{#harm1_1}}
          <div class="harm-inner">{{harm1_1}}</div>{{/harm1_1}}{{#harm1_2}}
          <div class="harm-inner">{{harm1_2}}</div>{{/harm1_2}}
        </td>
        <td data-i18n="less_effect"></td>
      </tr>
    </table>{{/harm}}
  </div>
</rolltemplate>
<script type="text/worker">
"use strict";
const data = {
	"crew": {
		"augurs": {
			"base": {
				"claim_1_name": "claim_custom_workspaces",
				"claim_1_desc": "claim_custom_workspaces_description",
				"claim_2_desc": "claim_artisan_crafters_description",
				"claim_2_name": "claim_artisan_crafters",
				"claim_3_desc": "claim_radiant_archive_description",
				"claim_3_name": "claim_radiant_archive",
				"claim_4_desc": "claim_exotic_weave_description",
				"claim_4_name": "claim_exotic_weave",
				"claim_5_desc": "claim_quintessic_loom_description",
				"claim_5_name": "claim_quintessic_loom",
				"claim_6_name": "claim_production",
				"claim_7_name": "claim_production",
				"claim_9_name": "claim_production",
				"claim_10_name": "claim_production",
				"claim_11_desc": "claim_laboratory_description",
				"claim_11_name": "claim_laboratory",
				"claim_12_desc": "claim_charmflair_description",
				"claim_12_name": "claim_charmflair",
				"claim_13_desc": "claim_popular_science_description",
				"claim_13_name": "claim_popular_science",
				"claim_14_desc": "claim_wormhole_gate_description",
				"claim_14_name": "claim_wormhole_gate",
				"claim_15_desc": "claim_medical_bay_description",
				"claim_15_name": "claim_medical_bay",
				"claim_bridge_3_4": "0",
				"claim_bridge_7_12": "0",
				"claim_bridge_9_14": "0",
				"claim_bridge_12_13": "0",
				"claim_bridge_13_14": "0",
				"crew_description": "crew_augurs_description",
				"crew_xp_condition": "crew_augurs_xp_condition",
				"hunting_grounds_type": "crew_augurs_hunting_grounds_type",
				"hunting_grounds_description": "crew_augurs_hunting_grounds_description",
				"upgrade_14_check_1": "1",
				"upgrade_22_check_1": "1"
			},
			"crewability": ["elementary", "case_file_drive", "cut_loose", "drift_compatible", "rescue_warp", "spirits_perch", "uxies_promise", "experienced"],
			"upgrade": [{
				"name": "crew_upgrade_exoadaptive_tech",
				"description": "crew_upgrade_exoadaptive_tech_description",
				"numboxes": "1"
			}, {
				"name": "crew_upgrade_neural_overlay",
				"description": "crew_upgrade_neural_overlay_description",
				"numboxes": "1"
			}, {
				"name": "crew_upgrade_lake_in_the_sky",
				"description": "crew_upgrade_lake_in_the_sky_description",
				"numboxes": "2"
			}, {
				"name": "crew_upgrade_flexible",
				"description": "crew_upgrade_flexible_description",
				"numboxes": "3"
			}]
		},
		"couriers": {
			"base": {
				"claim_1_name": "claim_artisan_crafters",
				"claim_1_desc": "claim_artisan_crafters_description",
				"claim_2_name": "claim_production",
				"claim_3_desc": "claim_side_shipments_description",
				"claim_3_name": "claim_side_shipments",
				"claim_4_desc": "claim_terrain_maps_description",
				"claim_4_name": "claim_terrain_maps",
				"claim_5_desc": "claim_medical_bay_description",
				"claim_5_name": "claim_medical_bay",
				"claim_6_name": "claim_production",
				"claim_7_name": "claim_production",
				"claim_9_name": "claim_production",
				"claim_10_name": "claim_production",
				"claim_11_desc": "claim_low_emissions_energy_description",
				"claim_11_name": "claim_low_emissions_energy",
				"claim_12_desc": "claim_wormhole_gate_description",
				"claim_12_name": "claim_wormhole_gate",
				"claim_13_desc": "claim_fleet_description",
				"claim_13_name": "claim_fleet",
				"claim_14_desc": "claim_mobile_city_description",
				"claim_14_name": "claim_mobile_city",
				"claim_15_desc": "claim_warehouses_description",
				"claim_15_name": "claim_warehouses",
				"claim_bridge_3_4": "0",
				"claim_bridge_6_11": "0",
				"claim_bridge_12_13": "0",
				"claim_bridge_13_14": "0",
				"cohort1_description": "vehicle_edges_flaws",
				"cohort1_name": "vehicle",
				"cohort1_subtype": "rover_dropjet_other",
				"cohort1_type": "expert",
				"crew_description": "crew_couriers_description",
				"crew_xp_condition": "crew_couriers_description_xp_condition",
				"hunting_grounds_type": "crew_couriers_hunting_grounds_type",
				"hunting_grounds_description": "crew_couriers_hunting_grounds_description",
				"upgrade_6_check_1": "1",
				"upgrade_20_check_1": "1"
			},
			"crewability": ["go_for_miles", "all_hands", "distributed_weight", "experts_talk_logistics", "friendly", "one_of_us", "punch_it", "experienced"],
			"upgrade": [{
				"name": "crew_upgrade_internal_compasses",
				"description": "crew_upgrade_internal_compasses_description",
				"numboxes": "1"
			}, {
				"name": "crew_upgrade_hoverbikes",
				"description": "crew_upgrade_hoverbikes_description",
				"numboxes": "1"
			}, {
				"name": "crew_upgrade_dont_shirk_work",
				"description": "crew_upgrade_dont_shirk_work_ddescription",
				"numboxes": "2"
			}, {
				"name": "crew_upgrade_flexible",
				"description": "crew_upgrade_flexible_description",
				"numboxes": "3"
			}]
		},
		"magpies": {
			"base": {
				"claim_1_name": "claim_assembly_arms",
				"claim_1_desc": "claim_assembly_arms_description",
				"claim_2_desc": "claim_artisan_crafters_description",
				"claim_2_name": "claim_artisan_crafters",
				"claim_3_desc": "claim_minifacturing_description",
				"claim_3_name": "claim_minifacturing",
				"claim_4_desc": "claim_radiant_archive_description",
				"claim_4_name": "claim_radiant_archive",
				"claim_5_desc": "claim_laboratory_description",
				"claim_5_name": "claim_laboratory",
				"claim_6_name": "claim_production",
				"claim_7_name": "claim_production",
				"claim_9_name": "claim_production",
				"claim_10_name": "claim_production",
				"claim_11_desc": "claim_custom_workspaces_description",
				"claim_11_name": "claim_custom_workspaces",
				"claim_12_desc": "claim_low_emissions_energy_description",
				"claim_12_name": "claim_low_emissions_energy",
				"claim_13_desc": "claim_open_license_specs_description",
				"claim_13_name": "claim_open_license_specs",
				"claim_14_desc": "claim_repair_shop_description",
				"claim_14_name": "claim_repair_shop",
				"claim_15_desc": "claim_adaptive_hardware_description",
				"claim_15_name": "claim_adaptive_hardware",
				"claim_bridge_1_2": "0",
				"claim_bridge_2_3": "0",
				"claim_bridge_3_4": "0",
				"claim_bridge_4_5": "0",
				"claim_bridge_11_12": "0",
				"claim_bridge_14_15": "0",
				"claim_bridge_12_13": "0",
				"claim_bridge_13_14": "0",
				"crew_description": "crew_magpies_description",
				"crew_xp_condition": "crew_magpies_xp_condition",
				"hunting_grounds_type": "crew_magpies_hunting_grounds_type",
				"hunting_grounds_description": "crew_magpies_hunting_grounds_description",
				"upgrade_11_check_1": "1",
				"upgrade_20_check_1": "1"
			},
			"crewability": ["feather_transform", "custom_os", "engineers", "foundation_frames", "resilience", "scrapyards", "sum_of_its_parts", "experienced"],
			"upgrade": [{
				"name": "crew_upgrade_magic_circle",
				"description": "crew_upgrade_magic_circle_description",
				"numboxes": "1"
			}, {
				"name": "crew_upgrade_autofac_systems",
				"description": "crew_upgrade_autofac_systems_description",
				"numboxes": "1"
			}, {
				"name": "crew_upgrade_ten_into_eleven",
				"description": "crew_upgrade_ten_into_eleven_description",
				"numboxes": "2"
			}, {
				"name": "crew_upgrade_flexible",
				"description": "crew_upgrade_flexible_description",
				"numboxes": "3"
			}]
		},
		"rangers": {
			"base": {
				"claim_1_desc": "claim_civilian_testimonies_description",
				"claim_1_name": "claim_civilian_testimonies",
				"claim_2_desc": "claim_artisan_crafters_description",
				"claim_2_name": "claim_artisan_crafters",
				"claim_3_desc": "claim_salvage_side_ops_description",
				"claim_3_name": "claim_salvage_side_ops",
				"claim_4_desc": "claim_field_medicine_description",
				"claim_4_name": "claim_field_medicine",
				"claim_5_desc": "claim_medical_bay_description",
				"claim_5_name": "claim_medical_bay",
				"claim_6_desc": "claim_combat_sims_description",
				"claim_6_name": "claim_combat_sims",
				"claim_7_name": "claim_production",
				"claim_9_name": "claim_production",
				"claim_10_name": "claim_production",
				"claim_11_desc": "claim_training_facilities_description",
				"claim_11_name": "claim_training_facilities",
				"claim_12_name": "claim_production",
				"claim_13_desc": "claim_warehouses_description",
				"claim_13_name": "claim_warehouses",
				"claim_14_desc": "claim_wormhole_gate_description",
				"claim_14_name": "claim_wormhole_gate",
				"claim_15_desc": "claim_passive_camo_description",
				"claim_15_name": "claim_passive_camo",
				"claim_bridge_2_3": "0",
				"claim_bridge_3_4": "0",
				"claim_bridge_9_14": "0",
				"claim_bridge_12_13": "0",
				"claim_bridge_13_14": "0",
				"crew_description": "crew_rangers_description",
				"crew_xp_condition": "crew_rangers_xp_condition",
				"hunting_grounds_type": "crew_rangers_hunting_grounds_type",
				"hunting_grounds_description": "crew_rangers_hunting_grounds_description",
				"upgrade_7_check_1": "1",
				"upgrade_21_check_1": "1"
			},
			"crewability": ["six_coyotes", "disaster_relief", "the_easy_way", "forged_in_fire", "reassuring", "synchronized", "war_dogs", "experienced"],
			"upgrade": [{
				"name": "crew_upgrade_quantum_encryption",
				"description" : "crew_upgrade_quantum_encryption_description",
				"numboxes": "1"
			}, {
				"name": "crew_upgrade_condor_satellite",
				"description": "crew_upgrade_condor_satellite_description",
				"numboxes": "1"
			}, {
				"name": "crew_upgrade_chorus_line_hypothesis",
				"description": "crew_upgrade_chorus_line_hypothesis_description",
				"numboxes": "2"
			}, {
				"name": "crew_upgrade_tempered",
				"description": "crew_upgrade_tempered_description",
				"numboxes": "3"
			}]
		},
		"silvers": {
			"base": {
				"claim_1_desc": "claim_intercontinental_aid_description",
				"claim_1_name": "claim_intercontinental_aid",
				"claim_2_desc": "claim_artisan_crafters_description",
				"claim_2_name": "claim_artisan_crafters",
				"claim_3_desc": "claim_positive_spin_description",
				"claim_3_name": "claim_positive_spin",
				"claim_4_desc": "claim_cover_operation_description",
				"claim_4_name": "claim_cover_operation",
				"claim_5_desc": "claim_cover_identities_description",
				"claim_5_name": "claim_cover_identities",
				"claim_6_name": "claim_production",
				"claim_7_name": "claim_production",
				"claim_9_name": "claim_production",
				"claim_10_desc": "claim_luxury_venue_description",
				"claim_10_name": "claim_luxury_venue",
				"claim_11_name": "claim_production",
				"claim_12_desc": "claim_fashion_experts_description",
				"claim_12_name": "claim_fashion_experts",
				"claim_13_desc": "claim_black_market_contacts_description",
				"claim_13_name": "claim_black_market_contacts",
				"claim_14_desc": "claim_friends_in_low_places_description",
				"claim_14_name": "claim_friends_in_low_places",
				"claim_15_desc": "claim_expose_description",
				"claim_15_name": "claim_expose",
				"claim_bridge_2_3": "0",
				"claim_bridge_3_4": "0",
				"claim_bridge_12_13": "0",
				"claim_bridge_13_14": "0",
				"crew_description": "crew_silvers_description",
				"crew_xp_condition": "crew_silvers_xp_condition",
				"hunting_grounds_type": "crew_silvers_hunting_grounds_type",
				"hunting_grounds_description": "crew_silvers_hunting_grounds_description",
				"upgrade_20_check_1": "1",
				"upgrade_22_check_1": "1"
			},
			"crewability": ["amiable", "cant_hate_us", "captivating", "heartfelt", "locals", "suppliers_network", "view_from_the_top", "experienced"],
			"upgrade": [{
				"name": "crew_upgrade_infil_rigging",
				"description": "",
				"numboxes": "1"
			}, {
				"name": "crew_upgrade_surveillance_scramblers",
				"description": "",
				"numboxes": "1"
			}, {
				"name": "crew_upgrade_electro_phi_betas",
				"description": "",
				"numboxes": "2"
			}, {
				"name": "crew_upgrade_tempered",
				"description": "",
				"numboxes": "3"
			}]
		}
},
	"playbook": {
		"aegis": {
	"ability": ["interpolation_protocol", "hits_keep_coming", "charmfield", "field_medic", "flow_and_crash", "the_reverie_school", "spark_of_hope", "spirit_soldier", "titanomach", "experienced"],
	"base": {
		"friends_title": "playbook_aegis_friends_title",
		"command": "1",
		"gatherinfo1": "gatherinfo_whats_their_intention",
		"gatherinfo2": "gatherinfo_what_might_I_suspect",
		"gatherinfo3": "gatherinfo_whats_the_danger_here",
		"gatherinfo4": "gatherinfo_how_can_I_find",
		"gatherinfo5": "gatherinfo_how_can_I_help_here",
		"gatherinfo6": "gatherinfo_whats_going_on",
		"gatherinfo7": "gatherinfo_detail_for_plan",
		"playbook_description": "playbook_aegis_description",
		"skirmish": "2",
		"xp_condition": "playbook_aegis_xp_condition"
	},
	"playbookitem": [{
		"bold": "1",
		"name": "playbook_item_fine_hand_weapon",
		"description": "playbook_item_fine_hand_weapon_description",
		"numboxes": "1"
	}, {
		"name": "playbook_item_heavy_shield",
		"description": "playbook_item_heavy_shield_description",
		"numboxes": "2"
	}, {
		"bold": "1",
		"name": "playbook_item_fine_sidearm",
		"description": "playbook_item_fine_sidearm_description",
		"numboxes": "1"
	}, {
		"bold": "1",
		"name": "playbook_item_fine_spark_rifle",
		"description": "playbook_item_fine_spark_rifle_description",
		"numboxes": "1"
	}, {
		"name": "playbook_item_tactical_grenades",
		"description": "playbook_item_tactical_grenades_description",
		"numboxes": "1"
	}, {
		"name": "playbook_item_mark_of_training",
		"description": "playbook_item_mark_of_training_description",
		"numboxes": "0"
	}]
},
	"kestrel": {
	"ability": ["seventh_sense", "mother_duck", "charmlink", "natures_bounty", "nighthawk_tactics", "relentless", "red_eyes_shining", "storm_warning", "way_of_the_seeker", "experienced"],
	"base": {
	"friends_title": "playbook_kestrel_friends_title",
	"trace": "1",
	"gatherinfo1": "gatherinfo_whats_their_intention",
	"gatherinfo2": "gatherinfo_what_might_I_suspect",
	"gatherinfo3": "gatherinfo_whats_the_danger_here",
	"gatherinfo4": "gatherinfo_how_can_I_find",
	"gatherinfo5": "gatherinfo_how_can_I_help_here",
	"gatherinfo6": "gatherinfo_whats_going_on",
	"gatherinfo7": "gatherinfo_detail_for_plan",
	"playbook_description": "playbook_kestrel_description",
	"wayfare": "2",
	"xp_condition": "playbook_kestrel_xp_condition"
	},
	"playbookitem": [{
	"bold": "1",
	"name": "playbook_item_fine_hunting_knives",
	"description": "playbook_item_fine_hunting_knives_description",
	"numboxes": "1"
	}, {
	"bold": "1",
	"name": "playbook_item_fine_rifle_or_longbow",
	"description": "playbook_item_fine_rifle_or_longbow_description",
	"numboxes": "2"
	}, {
	"name": "playbook_item_a_tracking_pet",
	"description": "playbook_item_a_tracking_pet_description",
	"numboxes": "0"
	}, {
	"name": "playbook_item_optical_rig",
	"description": "playbook_item_optical_rig_description",
	"numboxes": "0"
	}, {
	"name": "playbook_item_tracking_beacons",
	"description": "playbook_item_tracking_beacons_description",
	"numboxes": "0"
	}, {
	"name": "playbook_item_memento_of_the_wilds",
	"description": "playbook_item_memento_of_the_wilds_description",
	"numboxes": "0"
	}]
},
	"proxy": {
"ability": ["de_escalation", "keen", "both_eyes_open", "carrot_strategem", "charmtongue", "face_full_of_sunshine", "finding_time", "specter", "threads_of_fate", "experienced"],
"base": {
	"friends_title": "playbook_proxy_friends_title",
	"bluff": "1",
	"gatherinfo1": "gatherinfo_whats_their_intention",
	"gatherinfo2": "gatherinfo_what_might_I_suspect",
	"gatherinfo3": "gatherinfo_whats_the_danger_here",
	"gatherinfo4": "gatherinfo_how_can_I_find",
	"gatherinfo5": "gatherinfo_how_can_I_help_here",
	"gatherinfo6": "gatherinfo_whats_going_on",
	"gatherinfo7": "gatherinfo_detail_for_plan",
	"playbook_description": "playbook_proxy_description",
	"connect": "2",
	"xp_condition": "playbook_proxy_xp_condition"
},
"playbookitem": [{
	"bold": "1",
	"name": "playbook_item_fine_gift",
	"description": "playbook_item_fine_gift_description",
	"numboxes": "2"
}, {
	"bold": "1",
	"name": "playbook_item_fine_clothes",
	"description": "playbook_item_fine_clothes_description",
	"numboxes": "2"
}, {
	"name": "playbook_item_self_defense_weapon",
	"description": "playbook_item_self_defense_weapon_description",
	"numboxes": "1"
}, {
	"name": "playbook_item_legitimate_id",
	"description": "playbook_item_legitimate_id_description",
	"numboxes": "0"
}, {
	"name": "playbook_item_legitimate_id_wink",
	"description": "playbook_item_legitimate_id_wink_description",
	"numboxes": "0"
}, {
	"name": "playbook_item_token_of_your_past",
	"description": "playbook_item_token_of_your_past_description",
	"numboxes": "0"
}]
},
	"Scholar": {
"ability": ["curiosity_satisfaction", "charmsight", "charmtrick", "endless_road", "epiphany", "jstor_login", "researcher", "state_alchemists_dilemma", "studied_the_blade", "experienced"],
"base": {
	"friends_title": "playbook_scholar_friends_title",
	"finesse": "1",
	"gatherinfo1": "gatherinfo_whats_their_intention",
	"gatherinfo2": "gatherinfo_what_might_I_suspect",
	"gatherinfo3": "gatherinfo_whats_the_danger_here",
	"gatherinfo4": "gatherinfo_how_can_I_find",
	"gatherinfo5": "gatherinfo_how_can_I_help_here",
	"gatherinfo6": "gatherinfo_whats_going_on",
	"gatherinfo7": "gatherinfo_detail_for_plan",
	"playbook_description": "playbook_scholar_description",
	"read": "2",
	"xp_condition": "playbook_scholar_xp_condition"
},
"playbookitem": [{
	"bold": "1",
	"name": "playbook_item_data_cloner",
	"description": "playbook_item_data_cloner_description",
	"numboxes": "1"
}, {
	"bold": "1",
	"name": "playbook_item_fine_research_gear",
	"description": "playbook_item_fine_research_gear_description",
	"numboxes": "2"
}, {
	"name": "playbook_item_books_and_journals",
	"description": "playbook_item_books_and_journals_description",
	"numboxes": "3"
}, {
	"name": "playbook_item_notebooks",
	"description": "playbook_item_notebooks_description",
	"numboxes": "0"
}, {
	"name": "playbook_item_translation_codex",
	"description": "playbook_item_translation_codex_description",
	"numboxes": "0"
}, {
	"name": "playbook_item_worn_book",
	"description": "playbook_item_worn_book_description",
	"numboxes": "0"
}]
},
	"scrapper": {
"ability": ["hotfix", "paracause_protocol", "99_miles_per_hour", "a_horse_called_duck", "charlie_and_bee", "charmhack", "controlled_chaos", "neurocoupling", "tesseraction", "experienced"],
"base": {
	"friends_title": "playbook_scrapper_friends_title",
	"read": "1",
	"gatherinfo1": "gatherinfo_whats_their_intention",
	"gatherinfo2": "gatherinfo_what_might_I_suspect",
	"gatherinfo3": "gatherinfo_whats_the_danger_here",
	"gatherinfo4": "gatherinfo_how_can_I_find",
	"gatherinfo5": "gatherinfo_how_can_I_help_here",
	"gatherinfo6": "gatherinfo_whats_going_on",
	"gatherinfo7": "gatherinfo_detail_for_plan",
	"playbook_description": "playbook_scrapper_description",
	"shape": "2",
	"xp_condition": "playbook_scrapper_xp_condition"
},
"playbookitem": [{
	"bold": "1",
	"name": "playbook_item_fine_repair_tools",
	"description": "playbook_item_fine_repair_tools_description",
	"numboxes": "1"
}, {
	"bold": "1",
	"name": "playbook_item_fine_splicekit",
	"description": "playbook_item_fine_splicekit_description",
	"numboxes": "2"
}, {
	"bold": "1",
	"name": "playbook_item_spare_parts",
	"description": "playbook_item_spare_parts_description",
	"numboxes": "1"
}, {
	"name": "playbook_item_magnifying_lenses",
	"description": "playbook_item_magnifying_lenses_description",
	"numboxes": "0"
}, {
	"name": "playbook_item_stasis_pack",
	"description": "playbook_item_stasis_pack_description",
	"numboxes": "2"
}, {
	"name": "playbook_item_relic_fragment",
	"description": "playbook_item_relic_fragment_description",
	"numboxes": "0"
}]
},
	"witch": {
"ability": ["charmwork", "carolines_heart", "charmbreak", "cultivate_saplings", "kythe", "the_moon_upright", "painsplit", "ravens_at_dusk", "skyfall_safeguard", "experienced"],
"base": {
	"friends_title": "playbook_witch_friends_title",
	"finesse": "1",
	"gatherinfo1": "gatherinfo_whats_their_intention",
	"gatherinfo2": "gatherinfo_what_might_I_suspect",
	"gatherinfo3": "gatherinfo_whats_the_danger_here",
	"gatherinfo4": "gatherinfo_how_can_I_find",
	"gatherinfo5": "gatherinfo_how_can_I_help_here",
	"gatherinfo6": "gatherinfo_whats_going_on",
	"gatherinfo7": "gatherinfo_detail_for_plan",
	"playbook_description": "playbook_witch_description",
	"tune": "2",
	"xp_condition": "playbook_witch_xp_condition"
},
"playbookitem": [{
	"bold": "1",
	"name": "playbook_item_fine_charmwork_tools",
	"description": "playbook_item_fine_charmwork_tools_description",
	"numboxes": "1"
}, {
	"bold": "1",
	"name": "playbook_item_fine_healing_supplies",
	"description": "playbook_item_fine_healing_supplies_description",
	"numboxes": "1"
}, {
	"name": "playbook_item_familiar",
	"description": "playbook_item_familiar_description",
	"numboxes": "0"
}, {
	"name": "playbook_item_arcana_zero",
	"description": "playbook_item_arcana_zero_description",
	"numboxes": "0"
}, {
	"name": "playbook_item_small_totems",
	"description": "playbook_item_small_totems_description",
	"numboxes": "0"
}, {
	"name": "playbook_item_book_of_legends",
	"description": "playbook_item_book_of_legends_description",
	"numboxes": "0"
}]
},
	"charter": {
	"ability": ["long_thought", "coordinated", "charmsync", "fight_a_few_fears", "meticulous", "polymath", "planned_for_everything", "self_care", "up_late", "experienced"],
	"base": {
		"friends_title": "playbook_charter_friends_title",
		"long_thought": "1",
		"connect": "1",
		"gatherinfo1": "gatherinfo_whats_their_intention",
		"gatherinfo2": "gatherinfo_what_might_I_suspect",
		"gatherinfo3": "gatherinfo_whats_the_danger_here",
		"gatherinfo4": "gatherinfo_how_can_I_find",
		"gatherinfo5": "gatherinfo_how_can_I_help_here",
		"gatherinfo6": "gatherinfo_whats_going_on",
		"gatherinfo7": "gatherinfo_detail_for_plan",
		"playbook_description": "playbook_charter_description",
		"read": "2",
		"xp_condition": "playbook_charter_xp_condition"
	},
	"playbookitem": [{
		"name": "playbook_item_signal_flares",
		"description": "playbook_item_signal_flares_description",
		"numboxes": "1"
	}, {
		"name": "playbook_item_forged_documents",
		"description": "playbook_item_forged_documents_description",
		"numboxes": "0"
	}, {
		"name": "playbook_item_dossiers",
		"description": "playbook_item_dossiers_description",
		"numboxes": "0"
	}, {
		"name": "playbook_item_stun_charge",
		"description": "playbook_item_stun_charge_description",
		"numboxes": "1"
	}, {
		"name": "playbook_item_recon_beetle",
		"description": "playbook_item_recon_beetle_description",
		"numboxes": "0"
	}, {
		"name": "playbook_item_log_book",
		"description": "playbook_item_log_book_description",
		"numboxes": "1"
	}]
	}
},
	"factions": {
		"factions1": [{
	"name": "faction_the_asphodel_pinnacle",
	"tier": "V",
	"hold": "S"
}, {
	"name": "faction_tsunami",
	"tier": "III",
	"hold": "S"
}, {
		"name": "faction_asriony_union_of_journalists",
		"tier": "III",
		"hold": "W"
}, {
		"name": "faction_the_order_of_the_spiral",
		"tier": "II",
		"hold": "S"
}, {
	"name": "faction_synaptic_wreath",
	"tier": "I",
	"hold": "S"
}],
"factions2": [{
	"name": "faction_acanthia_citizenship",
	"tier": "V",
	"hold": "S"
}, {
	"name": "faction_astatine_throne",
	"tier": "V",
	"hold": "S"
}, {
	"name": "faction_cedar_phantoms",
	"tier": "IV",
	"hold": "W"
}, {
	"name": "faction_nomothesis_blue",
	"tier": "III",
	"hold": "W"
}, {
	"name": "faction_aqua_regia",
	"tier": "III",
	"hold": "S"
}, {
	"name": "faction_ace_of_hearts",
	"tier": "I",
	"hold": "W"
}],
"factions3": [{
	"name": "faction_malvarose_citizenship",
	"tier": "IV",
	"hold": "S"
}, {
	"name": "faction_rosewhite_academy",
	"tier": "IV",
	"hold": "W"
}, {
	"name": "faction_the_lantern_agency",
	"tier": "III",
	"hold": "S"
}, {
	"name": "faction_pyrehollows",
	"tier": "I",
	"hold": "S"
}],
"factions4": [{
	"name": "faction_meridian_valley_citizenship",
	"tier": "III",
	"hold": "S"
}, {
	"name": "faction_path_of_bluebells",
	"tier": "IV",
	"hold": "W"
}, {
	"name": "faction_meridian_coalition",
	"tier": "III",
	"hold": "S"
}, {
	"name": "faction_leafneedles",
	"tier": "III",
	"hold": "W"
}, {
	"name": "faction_salaphiels_quills",
	"tier": "III",
	"hold": "W"
}, {
	"name": "faction_rust_devils",
	"tier": "I",
	"hold": "S"
}],
"factions5": [{
	"name": "faction_pinelock_citizenship",
	"tier": "III",
	"hold": "W"
}, {
	"name": "faction_the_monstral_fair",
	"tier": "IV",
	"hold": "S"
}, {
	"name": "faction_mistral_research_collective",
	"tier": "II",
	"hold": "S"
}],
"factions6": [{
	"name": "faction_red_empire_citizenship",
	"tier": "II",
	"hold": "W"
}, {
	"name": "faction_red_crowns",
	"tier": "V",
	"hold": "S"
}, {
	"name": "faction_imperial_paladins",
	"tier": "IV",
	"hold": "S"
}, {
	"name": "faction_cardinal_frontier_division",
	"tier": "III",
	"hold": "S"
}, {
	"name": "faction_tango_foxtrot",
	"tier": "II",
	"hold": "S"
}],
"factions7": [{
	"name": "faction_serafin_citizenship",
	"tier": "V",
	"hold": "S"
}, {
	"name": "faction_seraph_architectonics_corps",
	"tier": "IV",
	"hold": "S"
}, {
	"name": "faction_spinhawks",
	"tier": "II",
	"hold": "W"
}, {
	"name": "faction_glowjacks",
	"tier": "II",
	"hold": "W"
}, {
	"name": "faction_the_lighthouse",
	"tier": "I",
	"hold": "S"
}, {
	"name": "faction_keening_echos",
	"tier": "I",
	"hold": "W"
}],
"factions8": [{
	"name": "faction_starfire_pelagic_citizenship",
	"tier": "IV",
	"hold": "S"
}, {
	"name": "faction_koiaia_council",
	"tier": "IV",
	"hold": "S"
}, {
	"name": "faction_lunamoths",
	"tier": "III",
	"hold": "S"
 }]
},
	"actions": {
		"analysis": ["read", "shape", "sunder", "trace"],
		"kinesis": ["finesse", "shadow", "skirmish", "wayfare"],
		"semiosis": ["bluff", "command", "connect", "tune"]
	},
	"traumas": ["anxious", "cynical", "detached", "haunted", "obsessed", "reckless", "shaky", "vindictive"],
	"items": [{
		"name": "simple_comms",
		"description": "simple_comms_description",
		"numboxes": "0"
	}, {
		"name": "lumeslate",
		"description": "lumeslate_description",
		"numboxes": "0"
	}, {
		"name": "analysis_pack",
		"description": "analysis_pack_description",
		"numboxes": "2"
	}, {
		"name": "comms_pack",
		"description": "comms_pack_description",
		"numboxes": "1"
	}, {
		"name": "survival_pack",
		"description": "survival_pack_description",
		"numboxes": "2"
	}, {
		"name": "medkit",
		"description": "medkit_description",
		"numboxes": "1"
	}, {
		"name": "blade_or_hammer",
		"description": "blade_or_hammer_description",
		"numboxes": "1"
	}, {
		"name": "sparkshot",
		"description": "sparkshot_description",
		"numboxes": "1"
	}, {
		"name": "strange_weapon",
		"description": "strange_weapon_description",
		"numboxes": "1"
	}, {
		"name": "assault_ordnance",
		"description": "assault_ordnance_description",
		"numboxes": "2"
	}, {
		"name": "armor",
		"description": "armor_description",
		"numboxes": "1",
		"short": "1"
	}, {
		"name": "+heavy",
		"description": "+heavy_description",
		"numboxes": "2",
		"short": "1"
	}, {
		"name": "charmwork_tools",
		"description": "charmwork_tools_description",
		"numboxes": "1"
	}, {
		"name": "repair_tools",
		"description": "repair_tools_description",
		"numboxes": "1"
	}, {
		"name": "demolition_tools",
		"description": "demolition_tools_description",
		"numboxes": "2"
	}, {
		"name": "infiltration_kit",
		"description": "infiltration_kit_description",
		"numboxes": "1"
	}, {
		"name": "jumpkit",
		"description": "jumpkit_description",
		"numboxes": "2"
	}],
	"translatedDefaults": {
		"cohort1_name": "expert",
		"contacts_title": "contacts",
		"factions_title": "factions_title",
		"factions1_header": "factions1",
		"factions2_header": "factions2",
		"factions3_header": "factions3",
		"factions4_header": "factions4",
		"factions5_header": "factions5",
		"friends_title": "friends",
		"upgrade_5_name": "rover",
		"upgrade_5_description": "upgrade_rover_description",
		"upgrade_6_name": "dropjet",
		"upgrade_6_description": "upgrade_dropjet_description",
		"upgrade_7_name": "quarters",
		"upgrade_7_description": "upgrade_quarters_description",
		"upgrade_8_name": "warehouses",
		"upgrade_8_description": "upgrade_warehouses_description",
		"upgrade_9_name": "security",
		"upgrade_9_description": "upgrade_security_description",
		"upgrade_10_name": "workshop",
		"upgrade_10_description": "upgrade_workshop_description",
		"upgrade_11_name": "packs",
		"upgrade_11_description": "upgrade_packs_description",
		"upgrade_12_name": "weapons",
		"upgrade_12_description": "upgrade_weapons_description",
		"upgrade_13_name": "tools",
		"upgrade_13_description": "upgrade_tools_description",
		"upgrade_14_name": "kits",
		"upgrade_14_description": "upgrade_kits_description",
		"upgrade_15_name": "spacer",
		"upgrade_20_name": "analysis",
		"upgrade_20_description": "upgrade_analysis_description",
		"upgrade_21_name": "kinesis",
		"upgrade_21_description": "upgrade_kinesis_description",
		"upgrade_22_name": "semiosis",
		"upgrade_22_description": "upgrade_semiosis_description",
		"upgrade_23_name": "personal",
		"upgrade_23_description": "upgrade_personal_description",
		"xp_condition2": "xp_beliefs",
		"xp_condition3": "xp_relief"
	},
	"defaultValues": {
		"tune": "0",
		"command": "0",
		"connect": "0",
		"finesse": "0",
		"trace": "0",
		"shadow": "0",
		"skirmish": "0",
		"shape": "0",
		"read": "0",
		"bluff": "0",
		"sunder": "0",
		"wayfare": "0"
	},
	"maxFriendsPerPlaybook": 5,
	"maxContactsPerCrew": 5,
	"friendlessPlaybooks": [],
	"translatedCrewAttributes": ["claim_1_name", "claim_2_name", "claim_3_name", "claim_4_name", "claim_5_name", "claim_6_name", "claim_7_name", "claim_8_name", "claim_9_name", "claim_10_name", "claim_11_name", "claim_12_name", "claim_13_name", "claim_14_name", "claim_15_name", "claim_1_desc", "claim_2_desc", "claim_3_desc", "claim_4_desc", "claim_5_desc", "claim_6_desc", "claim_7_desc", "claim_8_desc", "claim_9_desc", "claim_10_desc", "claim_11_desc", "claim_12_desc", "claim_13_desc", "claim_14_desc", "claim_15_desc", "cohort1_description", "cohort1_name", "cohort1_subtype", "hunting_grounds_type", "hunting_grounds_description", "upgrade_6_name", "upgrade_8_name", "crew_description", "crew_xp_condition"],
	"translatedPlaybookAttributes": ["friends_title", "gatherinfo1", "gatherinfo2", "gatherinfo3", "gatherinfo4", "gatherinfo5", "gatherinfo6", "gatherinfo7", "playbook_description","xp_condition"]
};
/* global data, getTranslationByKey, getAttrs, setAttrs, on, getSectionIDs, generateRowID, removeRepeatingRow */
const sheetVersion = "0.4";
const sheetName = "Songs for the Dusk";
const getTranslation = (key) => (getTranslationByKey(key) || "NO_TRANSLATION_FOUND");
/* It's necessary to include the base data at the start of the file */
/* Translate all the data */
Object.keys(data.crew).forEach(crew => {
	const base = data.crew[crew].base;
	Object.keys(base).forEach(attr => {
		if (data.translatedCrewAttributes.includes(attr)) {
			base[attr] = getTranslation(base[attr]);
		}
	});
	/* Generate crew contacts from translation file */
	data.crew[crew].contact = [...Array(data.maxContactsPerCrew).keys()].map(i => ({
		name: getTranslation(`crew_${crew}_contact_${i}`)
	}));
	data.crew[crew].crewability = data.crew[crew].crewability.map(name => ({
		name: getTranslation(`crew_ability_${name}`),
		description: getTranslation(`crew_ability_${name}_description`)
	}));
	data.crew[crew].upgrade.forEach(upgrade => {
		upgrade.name = getTranslation(upgrade.name);
		if (upgrade.description) {
			upgrade.description = getTranslationByKey(upgrade.description) || "";
		}
		upgrade.boxes_chosen = "1";
	});
});
data.items.forEach(item => {
	item.boxes_chosen = "1";
	item.name = getTranslation(item.name);
	item.description = getTranslationByKey(item.description) || "";
});
Object.keys(data.translatedDefaults).forEach(k => {
	data.translatedDefaults[k] = getTranslation(data.translatedDefaults[k]);
});
Object.assign(data.defaultValues, data.translatedDefaults);
Object.keys(data.factions).forEach(x => {
	data.factions[x].forEach(faction => {
		faction.name = getTranslation(faction.name);
	});
});
Object.keys(data.playbook).forEach(playbook => {
	const base = data.playbook[playbook].base;
	Object.keys(base).forEach(attr => {
		if (data.translatedPlaybookAttributes.includes(attr)) {
			base[attr] = getTranslation(base[attr]);
		}
	});
	/* Generate playbook friends from translation file */
	if (!data.friendlessPlaybooks.includes(playbook)) {
		data.playbook[playbook].friend = [...Array(data.maxFriendsPerPlaybook).keys()]
			.map(i => ({
				name: getTranslation(`playbook_${playbook}_friend_${i}`)
			}))
			.filter(o => o.name);
	}
	else data.playbook[playbook].friend = [];
	data.playbook[playbook].ability = data.playbook[playbook].ability.map(name => ({
		name: getTranslation(`playbook_ability_${name}`),
		description: getTranslation(`playbook_ability_${name}_description`)
	}));
	data.playbook[playbook].playbookitem.forEach(item => {
		item.name = getTranslation(item.name);
		if (item.description) {
			item.description = getTranslationByKey(item.description) || "";
		}
		item.boxes_chosen = "1";
	});
});
const playbookAbilityMap = new Map([...Object.values(data.playbook).map(x => x.ability).reduce((m, v) => {
	v.forEach(a => m.add(a));
	return m;
}, new Set())].map(x => {
	return [x.name.toLowerCase(), x.description];
}));
const crewAbilityMap = new Map([...Object.values(data.crew).map(x => x.crewability).reduce((m, v) => {
	v.forEach(a => m.add(a));
	return m;
}, new Set())].map(x => {
	return [x.name.toLowerCase(), x.description];
}));
/* Utility functions - shouldn't need to touch most of these */
const mySetAttrs = (attrs, options, callback) => {
		const finalAttrs = Object.keys(attrs).reduce((m, k) => {
			m[k] = `${attrs[k]}`;
			return m;
		}, {});
		setAttrs(finalAttrs, options, callback);
	},
	setAttr = (name, value) => {
		getAttrs([name], v => {
			const setting = {};
			if (v[name] !== `${value}`) setting[name] = `${value}`;
			setAttrs(setting);
		});
	},
	fillRepeatingSectionFromData = (sectionName, dataList, autogen, callback) => {
		callback = callback || (() => {});
		getSectionIDs(`repeating_${sectionName}`, idList => {
			const existingRowAttributes = [
				...idList.map(id => `repeating_${sectionName}_${id}_name`),
				...idList.map(id => `repeating_${sectionName}_${id}_autogen`)
			];
			getAttrs(existingRowAttributes, v => {
				/* Delete auto-generated rows */
				if (autogen) {
					idList = idList.filter(id => {
						if (v[`repeating_${sectionName}_${id}_autogen`]) {
							removeRepeatingRow(`repeating_${sectionName}_${id}`);
							return false;
						}
						else return true;
					});
				}
				const existingRowNames = idList.map(id => v[`repeating_${sectionName}_${id}_name`]),
					createdIDs = [],
					setting = dataList.filter(o => !existingRowNames.includes(o.name))
						.map(o => {
							let rowID;
							while (!rowID) {
								let newID = generateRowID();
								if (!createdIDs.includes(newID)) {
									rowID = newID;
									createdIDs.push(rowID);
								}
							}
							const newAttrs = {};
							if (autogen) {
								newAttrs[`repeating_${sectionName}_${rowID}_autogen`] = "1";
							}
							return Object.keys(o).reduce((m, key) => {
								m[`repeating_${sectionName}_${rowID}_${key}`] = o[key];
								return m;
							}, newAttrs);
						})
						.reduce((m, o) => Object.assign(m, o), {});
				mySetAttrs(setting, {}, callback);
			});
		});
	},
	diceMagic = num => {
		const range = end => [...Array(end + 1).keys()].slice(1);
		if (num > 0) return `dice=${range(num).map(() => "[[d6]]").join("&"+"#44"+"; ")}`;
		else return "zerodice=[[d6]]&"+"#44"+"; [[d6]]";
	},
	buildRollFormula = base => {
		return ` {{?{@{bonusdice}|${
			[0, 1, 2, 3, 4, 5, 6, -1, -2, -3].map(n => `${n},${diceMagic(n + (parseInt(base) || 0))}`).join("|")
		}}}}`;
	},
	buildNumdiceFormula = () => {
		return ` {{?{${getTranslation("numberofdice")}|${
			[0, 1, 2, 3, 4, 5, 6].map(n => `${n},${diceMagic(n)}`).join("|")
		}}}}`;
	},
	emptyFirstRowIfUnnamed = sectionName => {
		getSectionIDs(`repeating_${sectionName}`, idList => {
			const id = idList[0];
			getAttrs([`repeating_${sectionName}_${id}_name`], v => {
				if (!v[`repeating_${sectionName}_${id}_name`]) {
					removeRepeatingRow(`repeating_${sectionName}_${id}`);
				}
			});
		});
	},
	handleBoxesFill = (name, upToFour) => {
		on(`change:${name}1 change:${name}2 change:${name}3 change:${name}4`, event => {
			if (event.sourceType !== "player") return;
			getAttrs([event.sourceAttribute], v => {
				const rName = event.sourceAttribute.slice(0, -1),
					setting = {};
				if (String(v[event.sourceAttribute]) === "1") {
					switch (event.sourceAttribute.slice(-1)) {
					case "4":
						setting[`${rName}3`] = 1;
						/* falls through */
					case "3":
						setting[`${rName}2`] = 1;
						/* falls through */
					case "2":
						setting[`${rName}1`] = 1;
					}
				}
				if (String(v[event.sourceAttribute]) === "0") {
					switch (event.sourceAttribute.slice(-1)) {
					case "1":
						setting[`${rName}2`] = 0;
						/* falls through */
					case "2":
						setting[`${rName}3`] = 0;
						/* falls through */
					case "3":
						if (upToFour) setting[`${rName}4`] = 0;
					}
				}
				mySetAttrs(setting);
			});
		});
	},
	calculateResistance = name => {
		getAttrs([...data.actions[name], `setting_resbonus_${name}`], v => {
			const total = data.actions[name].map(x => v[x])
				.reduce((s, c) => s + (`${c}` === "0" ? 0 : 1), 0);
			setAttr(name, total);
			setAttr(`${name}_formula`, buildRollFormula(total + parseInt(v[`setting_resbonus_${name}`])));
		});
	},
	calculateVice = () => {
		getAttrs(Object.keys(data.actions), v => {
			const total = Math.min(...Object.keys(v).map(x => parseInt(v[x]) || 0));
			setAttr("vice_formula", buildRollFormula(total));
		});
	},
	calculateStashFormula = () => getAttrs(["stash"], v => {
		setAttr("stash_formula", buildRollFormula(Math.floor(parseInt(v.stash) / 10)));
	}),
	calculateWantedFormula = () => getAttrs(["wanted"], v => {
		setAttr("wanted_formula", buildRollFormula(v.wanted));
	}),
	calculateCohortDice = prefixes => {
		const sourceAttrs = [
			"crew_tier",
			...prefixes.map(p => `${p}_impaired`),
			...prefixes.map(p => `${p}_type`),
			...prefixes.map(p => `${p}_roll_formula`),
		];
		getAttrs(sourceAttrs, v => {
			const setting = {};
			prefixes.forEach(prefix => {
				const dice = (parseInt(v.crew_tier) || 0) - (parseInt(v[`${prefix}_impaired`]) || 0) +
						((v[`${prefix}_type`] === "elite" || v[`${prefix}_type`] === "expert") ? 1 : 0),
					formula = buildRollFormula(dice);
				if (formula !== v[`${prefix}_roll_formula`]) setting[`${prefix}_roll_formula`] = formula;
			});
			setAttrs(setting);
		});
	};
/* CONSTANTS */
const crewAttributes = [...new Set([].concat(...Object.keys(data.crew).map(x => Object.keys(data.crew[x].base))))],
	playbookAttributes = [...new Set([].concat(...Object.keys(data.playbook).map(x => Object.keys(data.playbook[x].base))))],
	watchedAttributes = new Set(crewAttributes.concat(playbookAttributes)),
	actionsFlat = [].concat(...Object.keys(data.actions).map(x => data.actions[x])),
	autoExpandFields = [
		"repeating_ability:name",
		"repeating_ability:description",
		"repeating_crewability:name",
		"repeating_crewability:description",
		"repeating_playbookitem:name",
		"repeating_upgrade:name",
		"repeating_friend:name",
		"repeating_contact:name",
		"repeating_clock:name",
		"repeating_crewclock:name",
		"repeating_factionclock:name",
		"repeating_cohort:edges",
		"repeating_cohort:flaws",
		"repeating_alchemical:name",
		"xp_condition",
		"xp_condition_extra",
		"xp_condition2",
		"xp_condition3",
		"crew_xp_condition",
		"hunting_grounds_type",
		"hunting_grounds_description",
		"cohort1_edges",
		"cohort1_flaws",
		"heritage",
		"background",
		"vice_purveyor",
	],
	autogenSections = [
		"ability",
		"crewability",
		"friend",
		"contact",
		"playbookitem",
		"upgrade"
	],
	translatedNames = [...Object.keys(data.playbook), ...Object.keys(data.crew)].reduce((m, keyName) => {
		if (getTranslationByKey(keyName)) m[getTranslationByKey(keyName).toLowerCase()] = keyName;
		else m[keyName.toLowerCase()] = keyName;
		return m;
	}, {});
/* EVENT HANDLERS */
/* Set default fields when setting crew type or playbook */
on("change:crew_type change:playbook", event => {
	getAttrs(["playbook", "crew_type", "changed_attributes", "setting_autofill", ...watchedAttributes], v => {
		const changedAttributes = (v.changed_attributes || "").split(","),
			sourceName = translatedNames[(event.sourceAttribute === "crew_type" ? v.crew_type : v.playbook).toLowerCase()],
			fillBaseData = (inputData, defaultAttrNames) => {
				if (data) {
					const finalSettings = defaultAttrNames.filter(name => !changedAttributes.includes(name))
						// do not reset attributes which have been changed by the user
						.filter(name => v[name] !== (data.defaultValues[name] || ""))
						// do not set attributes if current value is equal to sheet defaults
						.reduce((m, name) => {
							m[name] = data.defaultValues[name] || "";
							return m;
						}, {});
					Object.keys(inputData).filter(name => !changedAttributes.includes(name))
						.forEach(name => (finalSettings[name] = inputData[name]));
					mySetAttrs(finalSettings);
				}
			};
		if (event.sourceAttribute === "crew_type" ? v.crew_type : v.playbook) {
			setAttr("show_playbook_reminder", "0");
		}
		if (v.setting_autofill !== "1") return;
		if (event.sourceAttribute === "crew_type" && sourceName in data.crew) {
			fillRepeatingSectionFromData("contact", data.crew[sourceName].contact, true);
			fillRepeatingSectionFromData("crewability", data.crew[sourceName].crewability, true);
			fillRepeatingSectionFromData("upgrade", data.crew[sourceName].upgrade, true);
			fillBaseData(data.crew[sourceName].base, crewAttributes);
		}
		if (event.sourceAttribute === "playbook" && sourceName in data.playbook) {
			fillRepeatingSectionFromData("friend", data.playbook[sourceName].friend, true);
			fillRepeatingSectionFromData("ability", data.playbook[sourceName].ability, true);
			fillRepeatingSectionFromData("playbookitem", data.playbook[sourceName].playbookitem, true);
			fillBaseData(data.playbook[sourceName].base, playbookAttributes);
		}
	});
});
const fillPlaybookAbility = () => {
	const prefix = "repeating_ability";
	getAttrs([`${prefix}_name`, `${prefix}_description`], v => {
		if (!v[`${prefix}_description`]) {
			const description = playbookAbilityMap.get((v[`${prefix}_name`] || "").toLowerCase());
			if (description) setAttr(`${prefix}_description`, description);
		}
	});
};
const fillCrewAbility = () => {
	const prefix = "repeating_crewability";
	getAttrs([`${prefix}_name`, `${prefix}_description`], v => {
		if (!v[`${prefix}_description`]) {
			const description = crewAbilityMap.get((v[`${prefix}_name`] || "").toLowerCase());
			if (description) setAttr(`${prefix}_description`, description);
		}
	});
};
on("change:repeating_ability:name", fillPlaybookAbility);
on("change:repeating_crewability:name", fillCrewAbility);
/* Watch repeating rows for changes and set autogen to false if change happens */
autogenSections.forEach(sectionName => {
	on(`change:repeating_${sectionName}`, event => {
		getAttrs([`repeating_${sectionName}_autogen`], v => {
			if (v[`repeating_${sectionName}_autogen`] && event.sourceType === "player") {
				setAttr(`repeating_${sectionName}_autogen`, "");
			}
		});
	});
});
/* Watch for changes in auto-set attributes and update changed_attributes*/
watchedAttributes.forEach(name => {
	on(`change:${name}`, event => {
		if (event.sourceType === "player") {
			getAttrs(["changed_attributes"], v => {
				const changedAttributes = [...new Set(v.changed_attributes.split(",")).add(name)]
					.filter(x => !!x).join(",");
				setAttr("changed_attributes", changedAttributes);
			});
		}
	});
});
/* Register attribute/action event handlers */
Object.keys(data.actions).forEach(attrName => {
	on([...data.actions[attrName], `setting_resbonus_${attrName}`]
		.map(x => `change:${x}`).join(" "), () => calculateResistance(attrName)
	);
	on(`change:${attrName}`, calculateVice);
});
/* Calculate stash */
on("change:stash", calculateStashFormula);
on("change:wanted", calculateWantedFormula);
/* Calculate trauma */
on(data.traumas.map(x => `change:trauma_${x}`).join(" "), event => {
	getAttrs(data.traumas.map(x => `trauma_${x}`), v => {
		if (event.sourceType === "player") {
			const newTrauma = data.traumas.reduce((m, name) => m + (parseInt(v[`trauma_${name}`]) || 0), 0);
			setAttr("trauma", newTrauma);
		}
	});
});
/* Generate buttons */
on("change:generate_factions", () => {
	setAttr("show_faction_generatebutton", "0");
	Object.keys(data.factions).forEach(sectionName => {
		fillRepeatingSectionFromData(sectionName, data.factions[sectionName]);
	});
});
autogenSections.forEach(sectionName => {
	on(`change:generate_${sectionName}`, () => {
		getAttrs(["generate_source_character", "generate_source_crew", "sheet_type"], v => {
			const dataVar = (v.sheet_type === "character") ? data.playbook : data.crew,
				genSource = v[`generate_source_${v.sheet_type}`];
			if (genSource in dataVar) {
				emptyFirstRowIfUnnamed(sectionName);
				fillRepeatingSectionFromData(sectionName, dataVar[genSource][sectionName]);
			}
		});
	});
});
/* Extra stress and trauma */
on("change:setting_extra_stress", event => setAttr("stress_max", 9 + (parseInt(event.newValue) || 0)));
on("change:setting_extra_trauma", event => setAttr("trauma_max", 4 + (parseInt(event.newValue) || 0)));
/* Calculate cohort quality */
on(["crew_tier", "cohort1_impaired", "cohort1_type"].map(x => `change:${x}`).join(" "), () => calculateCohortDice(["cohort1"]));
on("change:repeating_cohort", () => calculateCohortDice(["repeating_cohort"]));
on("change:crew_tier", () => {
	getSectionIDs("repeating_cohort", a => calculateCohortDice(a.map(id => `repeating_cohort_${id}`)));
});
on("change:char_cohort_quality change:char_cohort_impaired change:setting_show_cohort", () => {
	getAttrs(["char_cohort_quality", "char_cohort_impaired"], v => {
		const dice = (parseInt(v.char_cohort_quality) || 0) - (parseInt(v.char_cohort_impaired) || 0);
		setAttr("char_cohort_roll_formula", buildRollFormula(dice));
	});
});
/* Set correct verb for cohort roll button */
["char_cohort", "cohort1", "repeating_cohort"].forEach(prefix => {
	const eventString = "change:" + ((prefix === "repeating_cohort") ? `${prefix}:type` : `${prefix}_type`);
	on(eventString, event => {
		const verb = (event.newValue === "expert") ? "^{rolls_their}" : "^{roll_their}";
		setAttr(`${prefix}_verb`, verb);
	});
});
/* Left-fill checkboxes */
handleBoxesFill("upgrade_24_check_", true);
handleBoxesFill("bandolier1_check_");
handleBoxesFill("bandolier2_check_");
["item", "playbookitem", "upgrade"].forEach(sName => handleBoxesFill(`repeating_${sName}:check_`));
/* Pseudo-radios */
["crew_tier", ...actionsFlat].forEach(name => {
	on(`change:${name}`, event => {
		if (String(event.newValue) === "0" && event.sourceType === "player") {
			setAttr(name, (parseInt(event.previousValue) || 1) - 1);
		}
		setAttr(`${name}_formula`, buildRollFormula(event.newValue || "0"));
	});
});
/* Item reset button */
on("change:reset_items", () => {
	const clearChecks = sectionName => {
		getSectionIDs(`repeating_${sectionName}`, idArray => {
			const setting = [
				...idArray.map(id => `repeating_${sectionName}_${id}_check_1`),
				...idArray.map(id => `repeating_${sectionName}_${id}_check_2`),
				...idArray.map(id => `repeating_${sectionName}_${id}_check_3`)
			].reduce((m, name) => {
				m[name] = 0;
				return m;
			}, {});
			mySetAttrs(setting);
		});
	};
	setAttr("load", 0);
	["item", "playbookitem"].forEach(clearChecks);
});
/* Default values for number of upgrades boxes — probably not necessary anymore */
// on('change:repeating_upgrade:boxes_chosen', () => {
// 	getAttrs(['repeating_upgrade_numboxes'], v => {
// 		if (!['1', '2', '3'].includes(v.repeating_upgrade_numboxes)) {
// 			setAttr('repeating_upgrade_numboxes', '1');
// 		}
// 	});
// });
/* Resistance query */
on("change:setting_consequence_query sheet:opened", () => {
	getAttrs(["setting_consequence_query"], v => {
		const consequenceQuery = (String(v.setting_consequence_query) === "1") ?
			`?{${getTranslation("consequence")}|${getTranslation("a_consequence")}}` :
			"^{a_consequence}";
		setAttr("consequence_query", consequenceQuery);
	});
});
/* Trim whitespace in auto-expand fields */
autoExpandFields.forEach(name => {
	on(`change:${name}`, event => {
		const attrName = name.replace(":", "_");
		getAttrs([attrName], v => {
			if (v[attrName].trim() !== v[attrName] && event.sourceType === "player") {
				setAttr(attrName, v[attrName].trim());
			}
		});
	});
});
/* Clean chat image URL */
on("change:chat_image", event => {
	const match = (event.newValue || "").match(/^(https:\/\/s3\.amazonaws\.com\/files\.d20\.io\/images\/.*\.jpg)\?\d+$/);
	if (match) setAttr("chat_image", match[1]);
});
/* Number of dice prompt */
on("sheet:opened", () => {
	/* Set up translated attributes */
	const translatedAttrs = {
		bonusdice: getTranslation("bonusdice"),
		effect_query: getTranslation("effect_query"),
		notes_query: `?{${getTranslation("notes")}}`,
		numberofdice: buildNumdiceFormula(),
		position_query: `?{${getTranslation("position")}|` +
			`${getTranslation("risky")},position=${getTranslation("risky")}|` +
			`${getTranslation("controlled")},position=${getTranslation("controlled")}|` +
			`${getTranslation("desperate")},position=${getTranslation("desperate")}|` +
			`${getTranslation("fortune_roll")},position=}`,
	};
	getAttrs(Object.keys(translatedAttrs), v => {
		const setting = {};
		Object.keys(translatedAttrs).forEach(name => {
			if (v[name] !== translatedAttrs[name]) setting[name] = translatedAttrs[name];
		});
		mySetAttrs(setting);
	});
});
/* INITIALISATION AND UPGRADES */
on("sheet:opened", () => {
	getAttrs(["sheet_type", "changed_attributes", "crew_type", "playbook"], v => {
		/* Make sure sheet_type is never 0 */
		if (!["crew", "faction"].includes(v.sheet_type)) setAttr("sheet_type", "character");
		/* Remove reminder box if we have playbook or crew name */
		if (v.playbook || v.crew_type) setAttr("show_playbook_reminder", "0");
	});
	/* Setup and upgrades */
	getAttrs(["version"], v => {
		const upgradeSheet = version => {
				// const [major, minor] = version && version.split(".").map(x => parseInt(x));
				console.log(`Found version ${version}.`);
			},
			initialiseSheet = () => {
				const setting = ["ability", "friend", "crewability", "contact", "playbookitem", "upgrade", "framefeature"]
					.reduce((memo, sectionName) => {
						memo[`repeating_${sectionName}_${generateRowID()}_autogen`] = 1;
						return memo;
					}, {});
				mySetAttrs(setting);
				fillRepeatingSectionFromData("item", data.items);
				/* Set translated default values */
				getAttrs(Object.keys(data.translatedDefaults), v => {
					const setting = {};
					Object.keys(data.translatedDefaults).forEach(k => {
						if (v[k] !== data.translatedDefaults[k]) setting[k] = data.translatedDefaults[k];
					});
					mySetAttrs(setting);
				});
				console.log("Initialising new sheet.");
			};
		if (v.version) upgradeSheet(v.version);
		else initialiseSheet();
		// Set version number
		mySetAttrs({
			version: sheetVersion,
			character_sheet: `${sheetName} v${sheetVersion}`,
		});
	});
});
</script>
