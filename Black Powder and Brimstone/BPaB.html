<input name="attr_version" type="hidden" value="1.0"/>
<input name="attr_setupDone" type="hidden" value="0"/>
<div class="compendium-drop-target monsters" style="display: none;">
	<input type="text" name="attr_isCompendium" accept="Type" style="display: none;" value="">
	<input accept="Category" name="attr_drop_category" type="hidden"/>
	<input accept="Name" name="attr_drop_name" type="hidden"/>
	<input accept="data" name="attr_drop_data" type="hidden"/>
	<input accept="Content" name="attr_drop_content" type="hidden"/>
</div>
<input type="checkbox" class="sheet-block-switch"  style="display: none;" name="attr_block_switch" value="1">

<div class="character-sheet" style="position: absolute; z-index: 3;" >
	<input type="checkbox" class="sheet-block-switch" name="attr_block_switch" style="display: none;" value="1">
	<div class="sheet-block-a">
		<label for="extraNotes" style="display: inline-block; vertical-align: top; width: 8px; height: 20px; color: Red; margin: -10px 0px 0px -12px; padding: 0px 0px 0px 0px; border: 0px solid Red;" data-i18n-title="characterCreation-c">&#x25BC;</label>
		<input type="checkbox" name='attr_setup' id="extraNotes" class="sheet-toggle-show" style="width: 8px; height: 20px; margin: -10px 0px 0px -12px;" />
		<div class="sheet-body" style="position: absolute; z-index: 4; height: 812px; width: 808px; background-color: White; margin-top: -28px; border: 2px solid Black;">
			<div class="sheet-body" style="display: inline-block; vertical-align: top; height: 650px; width: 400px; background-color: White; margin-top: 0px; border: 1px solid Transparent;">
				<label style="display: inline-block; vertical-align: top; height: 70px; width: 800px; color: Black; margin: 8px 0px 0px 0px; padding: 4px 0px 0px 0px; font-family: UnifrakturMaguntia; font-stretch: ultra-condensed; font-size: 40px; text-align: center; border: 2px solid Transparent;" data-i18n="characterCreation-c">Character Creation</label>

				<label style="display: inline-block; vertical-align: top; height: 26px; width: 80px; color: Black; margin: 0px 0px 0px 0px; padding: 6px 0px 0px 0px; font-family: Arial; font-stretch: ultra-condensed; font-size: 20px; text-align: center; border: 0px solid Black;" data-i18n="archetype-c">Archetype</label>
				<select  name='attr_archetype' data-i18n-title="archetype" spellcheck="false" style='width: 200px; text-align: center; height: 30px; padding: 0px 0px -4px 0px; font-size: 16px; margin: 0px 0px 0px 4px; border: 0px solid Blue'> 
					<option  type="text" style="color:Black" data-i18n="none-c">  None</option> 
					<option  type="text" style="color:SaddleBrown" data-i18n="rifleman-c">  Rifleman</option> 
					<option  type="text" style="color:SaddleBrown" data-i18n="greatswordsman-c"> Greatswordsman</option> 
					<option  type="text" style="color:SaddleBrown" data-i18n="grenadier-c">  Grenadier</option> 
					<option  type="text" style="color:Purple" data-i18n="pistolier-c">  Pistolier</option>
					<option  type="text" style="color:Purple" data-i18n="masterTrapper-c">  Master Trapper</option>
					<option  type="text" style="color:Purple" data-i18n="beastHunter-c">  Beast Hunter</option>
					<option  type="text" style="color:DarkRed" data-i18n="woodsWitch-c">  Woods Witch</option>
					<option  type="text" style="color:DarkRed" data-i18n="herbalist-c">  Herbalist</option>
					<option  type="text" style="color:DarkRed" data-i18n="hexen-c">  Hexen</option>
					<option  type="text" style="color:Navy" data-i18n="adventurer-c">  Adventurer</option>
					<option  type="text" style="color:Navy" data-i18n="sneakThief-c">  Sneak Thief</option>
					<option  type="text" style="color:Navy" data-i18n="silver-ToungedTrickster-c">  Silver-Tounged Trickster</option>
					<option  type="text" style="color:DarkGreen" data-i18n="vowOfWar-c">  Vow Of Sustenance</option>
					<option  type="text" style="color:DarkGreen" data-i18n="vowOfHealing-c">  Vow Of Healing</option>
					<option  type="text" style="color:DarkGreen" data-i18n="vowOfSustenance-c">  Vow Of Sustenance</option>
				</select>
				<input type="checkbox" class="showNoArchetype" style="height: 18px; width: 18px;" name="attr_showNotArchetype" value="1" />

				<div class="sheet-body" style="display: inline-block; vertical-align: top; height: 300px; width: 300px; background-color: White; margin-top: 0px; border: 1px solid Transparent;">
					<button class="btn sheet-weapon" type="action" name="act_abilities" style="height: 16px; width: 12px; font-size: 14px; font-family: dicefontd20; color: Black; background-color: transparent; margin: 4px 0px 0px 20px; padding: 2px;">t</button>
					<label style="display: inline-block; vertical-align: top; height: 30px; width: 80px; color: Black; margin: 0px 0px 0px  0px; padding: 4px 0px 0px 0px; font-family: Arial; font-stretch: ultra-condensed; font-size: 20px; text-align: center; border: 2px solid Transparent;" data-i18n="rollStats-c">Roll Stats</label>
					<label style="display: inline-block; vertical-align: top; height: 30px; width: 40px; color: Black; margin: 0px 0px 0px 50px; padding: 4px 0px 0px 0px; font-family: Arial; font-stretch: ultra-condensed; font-size: 20px; text-align: center; border: 2px solid Transparent;" data-i18n="stat-c">Stat</label>
					<label style="display: inline-block; vertical-align: top; height: 30px; width: 40px; color: Black; margin: 0px 0px 0px 10px; padding: 4px 0px 0px 0px; font-family: Arial; font-stretch: ultra-condensed; font-size: 20px; text-align: center; border: 2px solid Transparent;" data-i18n="ability-c">Ability</label>
					<br>
					<label style="display: inline-block; vertical-align: top; height: 26px; width: 130px; color: Black;  margin: 8px 0px 2px 24px; font-family: Arial; font-style: normal; font-size: 28px; font-weight: bold; text-align: left; padding: 6px 0px 0px 0px; border: 1px solid Transparent;" data-i18n="strength-c">Strength</label>
					<input type="text" name="attr_str"      class="sheet-profileInput" style="width: 40px; height: 30px; font-size: 22px; font-style: bold; text-align: center; margin: 8px 0px 0px 22px; border: 2px solid Red;" value="">
					<input type="text" name="attr_strength" class="sheet-profileInput" style="width: 30px; height: 30px; font-size: 22px; font-style: bold; text-align: center; margin: 8px 0px 0px 22px; border: 2px solid Red;" value="">
					<br>
					<label style="display: inline-block; vertical-align: top; height: 26px; width: 130px; color: Black;  margin: 8px 0px 2px 24px; font-family: Arial; font-style: normal; font-size: 28px; font-weight: bold; text-align: left; padding: 6px 0px 0px 0px; border: 1px solid Transparent;" data-i18n="agility-c">Agility</label>
					<input type="text" name="attr_agi"      class="sheet-profileInput" style="width: 40px; height: 30px; font-size: 22px; font-style: bold; text-align: center; margin: 8px 0px 0px 22px; border: 2px solid Red;" value="">
					<input type="text" name="attr_agility"  class="sheet-profileInput" style="width: 30px; height: 30px; font-size: 22px; font-style: bold; text-align: center; margin: 8px 0px 0px 22px; border: 2px solid Red;" value="">
					<br>
					<label style="display: inline-block; vertical-align: top; height: 26px; width: 130px; color: Black;  margin: 8px 0px 2px 24px; font-family: Arial; font-style: normal; font-size: 28px; font-weight: bold; text-align: left; padding: 6px 0px 0px 0px; border: 1px solid Transparent;" data-i18n="presence-c">Presence</label>
					<input type="text" name="attr_pre"      class="sheet-profileInput" style="width: 40px; height: 30px; font-size: 22px; font-style: bold; text-align: center; margin: 8px 0px 0px 22px; border: 2px solid Red;" value="">
					<input type="text" name="attr_presence" class="sheet-profileInput" style="width: 30px; height: 30px; font-size: 22px; font-style: bold; text-align: center; margin: 8px 0px 0px 22px; border: 2px solid Red;" value="">
					<br>
					<label style="display: inline-block; vertical-align: top; height: 26px; width: 130px; color: Black;  margin: 8px 0px 2px 24px; font-family: Arial; font-style: normal; font-size: 28px; font-weight: bold; text-align: left; padding: 6px 0px 0px 0px; border: 1px solid Transparent;" data-i18n="toughness-c">Toughness</label>
					<input type="text" name="attr_tgh"       class="sheet-profileInput" style="width: 40px; height: 30px; font-size: 22px; font-style: bold; text-align: center; margin: 8px 0px 0px 22px; border: 2px solid Red;" value="">
					<input type="text" name="attr_toughness" class="sheet-profileInput" style="width: 30px; height: 30px; font-size: 22px; font-style: bold; text-align: center; margin: 8px 0px 0px 22px; border: 2px solid Red;" value="">
					<br>
					<label style="display: inline-block; vertical-align: top; height: 26px; width: 130px; color: Black;  margin: 8px 0px 2px 24px; font-family: Arial; font-style: normal; font-size: 28px; font-weight: bold; text-align: left; padding: 6px 0px 0px 0px; border: 1px solid Transparent;" data-i18n="health-c">Health</label>
					<input type="text" name="attr_hpMax"       class="sheet-profileInput" style="width: 96px; height: 30px; font-size: 22px; font-style: bold; text-align: center; margin: 8px 0px 0px 22px; border: 2px solid Red;" value="">
				</div>
				<!-- Hidden Variables from Archetype selection - to be used in Roll Stats -->
				<input type="number" name="attr_StrAdjustment" style="display: none;" value="0">
				<input type="number" name="attr_AgiAdjustment" style="display: none;" value="0">
				<input type="number" name="attr_PreAdjustment" style="display: none;" value="0">
				<input type="number" name="attr_TghAdjustment" style="display: none;" value="0">
				<input type="number" name="attr_Wealth"        style="display: none;" value="0">
				<input type="number" name="attr_HPDie"         style="display: none;" value="0">
				<input type="number" name="attr_HPAdjustment"  style="display: none;" value="0">
				<input type="text"   name="attr_Secret"        style="display: none;" value="None">
				<input type="text"   name="attr_Benefit"       style="display: none;" value="None">
				<input type="text"   name="attr_Gear1"         style="display: none;" value="">
				<input type="text"   name="attr_Gear2"         style="display: none;" value="">
				<input type="text"   name="attr_Gear3"         style="display: none;" value="">
				<input type="text"   name="attr_Gear4"         style="display: none;" value="">
				<input type="text"   name="attr_Gear5"         style="display: none;" value="">
				<input type="text"   name="attr_Gear6"         style="display: none;" value="">
				<input type="text"   name="attr_Gear7"         style="display: none;" value="">
				<input type="text"   name="attr_Gear8"         style="display: none;" value="">
				<input type="text"   name="attr_Gear1enc"      style="display: none;" value=0>
				<input type="text"   name="attr_Gear2enc"      style="display: none;" value=0>
				<input type="text"   name="attr_Gear3enc"      style="display: none;" value=0>
				<input type="text"   name="attr_Gear4enc"      style="display: none;" value=0>
				<input type="text"   name="attr_Gear5enc"      style="display: none;" value=0>
				<input type="text"   name="attr_Gear6enc"      style="display: none;" value=0>
				<input type="text"   name="attr_Gear7enc"      style="display: none;" value=0>
				<input type="text"   name="attr_Gear8enc"      style="display: none;" value=0>
				<input type="text"   name="attr_Kit"           style="display: none;" value="">
				<input type="text"   name="attr_KitDesc"       style="display: none;" value="">
				<input type="text"   name="attr_Kit2"          style="display: none;" value="">
				<input type="text"   name="attr_Kit2Desc"      style="display: none;" value="">
				<input type="text"   name="attr_Armour"        style="display: none;" value="">
				<input type="text"   name="attr_Weapon1"       style="display: none;" value="">
				<input type="text"   name="attr_Weapon1Ammo"   style="display: none;" value="">
				<input type="text"   name="attr_Weapon1Desc"   style="display: none;" value="">
				<input type="text"   name="attr_Weapon1Damage" style="display: none;" value="">
				<input type="text"   name="attr_Weapon1Cost"   style="display: none;" value="">
				<input type="text"   name="attr_Weapon1Rule"   style="display: none;" value="">
				<input type="text"   name="attr_Weapon1Special" style="display: none;" value="">
				<input type="text"   name="attr_Weapon1Ranged" style="display: none;" value="">
				<input type="text"   name="attr_Weapon1BlackPowder" style="display: none;" value="">
				<input type="text"   name="attr_Weapon2"       style="display: none;" value="">
				<input type="text"   name="attr_Weapon2Ammo"   style="display: none;" value="">
				<input type="text"   name="attr_Weapon2Desc"   style="display: none;" value="">
				<input type="text"   name="attr_Weapon2Damage" style="display: none;" value="">
				<input type="text"   name="attr_Weapon2Cost"   style="display: none;" value="">
				<input type="text"   name="attr_Weapon2Rule"   style="display: none;" value="">
				<input type="text"   name="attr_Weapon2Special" style="display: none;" value="">
				<input type="text"   name="attr_Weapon2Ranged" style="display: none;" value="">
				<input type="text"   name="attr_Weapon2BlackPowder" style="display: none;" value="">

				<div class="noArchetype">
					<div style="display: inline-block; vertical-align: top; height: 250px; width: 80px; background-color: White; margin: -302px 0px 0px 302px; border: 1px solid Green;"  >
						<label style="display: inline-block; vertical-align: top; height: 24px; width: 50px; color: Black; margin: 0px 0px 0px 10px; padding: 4px 0px 0px 0px; font-family: Arial; font-stretch: ultra-condensed; font-size: 18px; text-align: center; border: 2px solid Transparent;" data-i18n-title="4d6kh3Def">4d6kh3</label>
						<label style="display: inline-block; vertical-align: top; height: 12px; width: 70px; color: Black; margin: 22px 0px 0px -66px; padding: 0px 0px 0px 0px; font-family: Arial; font-stretch: ultra-condensed; font-size: 14px; text-align: center; border: 2px solid Transparent;" data-i18n-title="chooseTwo-c" data-i18n="chooseTwo-c">Choose Two</label>
						<div style="height: 36px; width: 90px; border: 1px solid Transparent">
							<input type="checkbox" name='attr_ccStrAdv' style="width: 18px; color: Black; accent-color: Black; border: 2px solid Black; opacity: 1; margin: 22px 40px 0px 30px;" value="1">
						</div>
						<div style="height: 40px; width: 90px; border: 1px solid Transparent">			
							<input type="checkbox" name='attr_ccAgiAdv' style="width: 18px; color: Black; accent-color: Black; border: 2px solid Black; opacity: 1; margin: 24px 40px 0px 30px; padding: 10px 40px 0px 30px;" value="1">
						</div>
						<div style="height: 40px; width: 90px; border: 1px solid Transparent">			
							<input type="checkbox" name='attr_ccPreAdv' style="width: 18px; color: Black; accent-color: Black; border: 2px solid Black; opacity: 1; margin: 24px 40px 0px 30px; padding: 10px 40px 0px 30px;" value="1">
						</div>
						<div style="height: 40px; width: 90px; border: 1px solid Transparent">			
							<input type="checkbox" name='attr_ccTghAdv' style="width: 18px; color: Black; accent-color: Black; border: 2px solid Black; opacity: 1; margin: 24px 40px 0px 30px; padding: 10px 40px 0px 30px;" value="1">
						</div>
					</div>
				</div>
			</div>
			<!-- Optional Character Traits -->
			<div class="sheet-body" style="display: inline-block; vertical-align: top; height: 650px; width: 400px; background-color: White; margin-top: 0px; border: 1px solid Transparent;">
				<label style="display: inline-block; vertical-align: top; height: 70px; width: 800px; color: Black; margin: 8px 0px 8px 0px; padding: 4px 0px 0px 0px; font-family: UnifrakturMaguntia; font-stretch: ultra-condensed; font-size: 40px; text-align: center; line-height: 95%; border: 2px solid Transparent;" data-i18n="optionalCharacterTraits-c">Optional Character Traits</label>
				<button class="sheet-profileInput" type="action" name="act_character_is" style="display: inline-block; vertical-align: top; height: 20px; width: 220px; color: Black; background-color: rgba(136, 79, 0, 0.7); margin: 2px 0px 2px 10px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 16px; font-weight: normal; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Purple;" >
					<label style="text-align: center;" data-i18n="yourCharacterIs:">Your character is:</label> </button>
				<input type="text" name="attr_characterTrait" class="sheet-profileInput" style="width:  120px; height: 26px; margin: 0px 0px 0px -4px; padding: 2px;" value="">

				<button class="sheet-profileInput" type="action" name="act_character_wants" style="display: inline-block; vertical-align: top; height: 20px; width: 220px; color: Black; background-color: rgba(136, 79, 0, 0.7); margin: 2px 0px 2px 10px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 16px; font-weight: normal; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Purple;" >
					<label style="text-align: center;" data-i18n="yourCharacterWants:">Your character wants:</label> </button>
				<input type="text" name="attr_characterDesire" class="sheet-profileInput" style="width:  120px; height: 26px; margin: 0px 0px 0px -4px; padding: 2px;" value="">

				<button class="sheet-profileInput" type="action" name="act_character_setback" style="display: inline-block; vertical-align: top; height: 20px; width: 220px; color: Black; background-color: rgba(136, 79, 0, 0.7); margin: 2px 0px 2px 10px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 16px; font-weight: normal; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Purple;" >
					<label style="text-align: center;" data-i18n="yourCharacter'sSetback:">Your character's setback:</label> </button>
				<input type="text" name="attr_characterSetback" class="sheet-profileInput" style="width:  120px; height: 26px; margin: 0px 0px 0px -4px; padding: 2px;" value="">

				<button class="sheet-profileInput" type="action" name="act_additional_skills" style="display: inline-block; vertical-align: top; height: 20px; width: 220px; color: Black; background-color: rgba(136, 79, 0, 0.4); margin: 12px 0px 2px 10px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 16px; font-weight: normal; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Purple;" >
					<label style="text-align: center;" data-i18n="additionalSkills:-c">Additional skills:</label> </button>
				<input type="text" name="attr_additionalSkills" class="sheet-profileInput" style="width:  120px; height: 26px; margin: 10px 0px 0px -4px; padding: 2px;" value="">

				<button class="sheet-profileInput" type="action" name="act_passions" style="display: inline-block; vertical-align: top; height: 20px; width: 220px; color: Black; background-color: rgba(136, 79, 0, 0.4); margin: 2px 0px 2px 10px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 16px; font-weight: normal; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Purple;" >
					<label style="text-align: center;" data-i18n="passions:-c">Passions:</label> </button>
				<input type="text" name="attr_passions" class="sheet-profileInput" style="width:  120px; height: 26px; margin: 0px 0px 0px -4px; padding: 2px;" value="">

				<button class="sheet-profileInput" type="action" name="act_notable_physical_attribute" style="display: inline-block; vertical-align: top; height: 20px; width: 220px; color: Black; background-color: rgba(136, 79, 0, 0.4); margin: 2px 0px 2px 10px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 16px; font-weight: normal; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Purple;" >
					<label style="text-align: center;" data-i18n="notablePhysicalAttribute:-c">Notable Physical Attribute:</label> </button>
				<input type="text" name="attr_notablePhysicalAttribute" class="sheet-profileInput" style="width:  120px; height: 26px; margin: 0px 0px 0px -4px; padding: 2px;" value="">
			</div>
			
			<!-- Custom Configuration -->
			<div class="sheet-body" style="display: inline-block; vertical-align: top; height: 150px; width: 400px; background-color: White; margin: -200px 0px 0px 0px; border: 1px solid Transparent;">
				<label style="display: inline-block; vertical-align: top; height: 34px; width: 800px; color: Black; margin: 8px 0px 8px 0px; padding: 4px 0px 0px 0px; font-family: UnifrakturMaguntia; font-stretch: ultra-condensed; font-size: 40px; text-align: center; border: 2px solid Transparent;" data-i18n="customConfiguration-c">Custom Configuration</label>

				<label style="display: inline-block; vertical-align: top; height: 20px; width: 220px; color: Black; margin: 2px 0px 2px 10px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 16px; font-weight: normal; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" data-i18n="defaultDifficultyRating-c">Default Difficulty Rating</label>
				<input type="text" name="attr_defaultDR" class="sheet-profileInput" style="width: 32px; height: 24px; text-align: center; margin: 0px 0px 0px 4px; padding: 2px;" value="12">
				<label style="display: inline-block; vertical-align: top; height: 20px; width: 220px; color: Black; margin: 2px 0px 2px 10px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 16px; font-weight: normal; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" data-i18n="misfireSuppression-c">Misfire Suppression</label>
				<input type="checkbox" name='attr_suppresMisfire' style="width: 18px; color: Black; accent-color: Black; border: 2px solid Black; opacity: 1; margin: 6px 0px 0px 10px;" value="1">
	<!--
				<label for="extraFeat1" style="display: inline-block; vertical-align: top; width: 8px; height: 16px; color: Black; margin: 22px 0px 0px -4px; padding: 0px 0px 0px 0px; border: 0px solid Red;" data-i18n-title="featExpansion-c">&#x25BD;</label>
				<input type="checkbox" name='attr_featExtra1' id="extraFeat1" class="sheet-toggle-show" style="width: 8px; height: 20px; margin: 2px 18px 0px -22px;" />
	-->
				<label for="isGM" style="display: inline-block; vertical-align: top; height: 20px; width: 220px; color: Black; margin: 2px 0px 2px 10px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 16px; font-weight: normal; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" data-i18n="isGM?-c" data-i18n-title="isThisSheetForTheGameMaster?">isGM?</label>
				<input type="checkbox" name='attr_isGM'  id="isGM" class="sheet-toggle-show" style="width: 18px; color: Black; accent-color: Black; border: 2px solid Black; opacity: 1; margin: 6px 0px 0px 10px;" value="1">
				<div class="sheet-body" style="position: absolute; z-index: 2; height: 60px; width: 470px; background-color: White; margin: 0px 0px 0px 8px; border: 2px solid Black;">
					<button class="sheet-profileInput" type="action" name="act_search" style="display: inline-block; vertical-align: top; height: 20px; width: 140px; color: Black; background-color: rgba(136, 79, 0, 0.7); margin: 2px 0px 2px 10px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 16px; font-weight: normal; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" value="&{template:check} {{name=@{character_name}}} {{Search=[[1d6*10+1d6]]}}" >
						<label style="text-align: center;" data-i18n="searchTheBody-c">Search The Body</label> </button>
					<button class="sheet-profileInput" type="action" name="act_weather" style="display: inline-block; vertical-align: top; height: 20px; width: 140px; color: Black; background-color: rgba(136, 79, 0, 0.4); margin: 2px 0px 2px 10px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 16px; font-weight: normal; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" value="&{template:check} {{name=@{character_name}}}" >
						<label style="text-align: center;" data-i18n="weather-c">Weather</label> </button>
					<button class="sheet-profileInput" type="action" name="act_road" style="display: inline-block; vertical-align: top; height: 20px; width: 140px; color: Black; background-color: rgba(136, 79, 0, 0.4); margin: 2px 0px 2px 10px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 16px; font-weight: normal; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" value="&{template:check} {{name=@{character_name}}}">
						<label style="text-align: center;" data-i18n="onTheRoad-c">On The Road</label> </button>
					<br />
					<button class="sheet-profileInput" type="action" name="act_animal" style="display: inline-block; vertical-align: top; height: 20px; width: 140px; color: Black; background-color: rgba(235, 223, 199, 0.9); margin: 2px 0px 2px 10px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 16px; font-weight: normal; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" value="&{template:check} {{name=@{character_name}}}" >
						<label style="text-align: center;" data-i18n="huntAnimal-c">Hunt Animal</label> </button>
					<button class="sheet-profileInput" type="action" name="act_huntingMishap" style="display: inline-block; vertical-align: top; height: 20px; width: 140px; color: Black; background-color: rgba(235, 223, 199, 0.9); margin: 2px 0px 2px 10px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 16px; font-weight: normal; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" value="&{template:check} {{name=@{character_name}}}" >
						<label style="text-align: center;" data-i18n="huntingMishap-c">Hunting Mishap</label> </button>
					<button class="sheet-profileInput" type="action" name="act_enemies" style="display: inline-block; vertical-align: top; height: 20px; width: 140px; color: Black; background-color: rgba(136, 79, 0, 0.8); margin: 2px 0px 2px 10px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 16px; font-weight: normal; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" value="&{template:check} {{name=@{character_name}}}">
						<label style="text-align: center;" data-i18n="enemies-c">Enemies</label> </button>
				</div>
			</div>
		</div>
	</div>
	<div class="sheet-block-b" style="height:20px">
	</div>

	<div style="margin: -30px 0px 0px 686px; padding-top: 2px 0px 0px 0px; width: 90px">
		<input id="DR" type="checkbox" class="suppress" name="attr_suppressDR" style="margin: 0px; width: 90px; "value="1"><label class="suppress" style='margin: -14px 0px -4px 0px; width: 90px; font-size: 10px; padding: 0;' title="When DarkRed: Request Difficulty for roll. When Black: Don't request" for="DR" data-i18n="suppressDifficulty-c">Suppress Difficulty?</label>
	</div>
	
	<!-- Banner -->
	<div style="display: inline-block; vertical-align: top; height: 550px; width: 220px; margin: -2px 0px 0px 20px; border: 2px solid Transparent;">
		<label style="display: inline-block; vertical-align: top; height: 70px; width: 220px; color: Black; margin: 0px 0px 0px 0px; padding: 4px 0px 0px 0px; font-family: UnifrakturMaguntia; font-stretch: ultra-condensed; font-size: 38px; text-align: center; line-height: 70%; border: 0px solid Red;" data-i18n="blackPowderAndBrimstone">Black Powder</label>

		<label style="display: inline-block; vertical-align: top; height: 22px; width: 44px; color: Black; margin: 6px 0px 2px 12px; font-family: UnifrakturMaguntia; font-size: 16px; padding-top: 9px; border: 1px solid Transparent;" data-i18n="name-c">Name:</label>
		<input type="text" name="attr_character_name" class="sheet-profileInput" spellcheck="false" style="width: 140px; margin-top: 14px; padding: 0px 2px 1px 2px; background-color: transparent; border: 1px solid Transparent;" value="">

		<label style="display: inline-block; vertical-align: top; height: 18px; width: 96px; color: Black; margin: 4px 0px 2px 10px; font-family: UnifrakturMaguntia; font-size: 16px; padding-top: 3px; border: 1px solid Transparent;" data-i18n="description-c">Description</label>
		<label style="display: inline-block; vertical-align: top; height: 18px; width: 74px; color: Black; margin: 4px 0px 2px  2px; font-family: UnifrakturMaguntia; font-size: 16px; padding-top: 3px; border: 1px solid Transparent;" data-i18n="likeness-c">Likeness</label>

		<div  style="display: inline-block; vertical-align: top; height: 156px; width: 106px; margin: 1px 0px 0px 9px; border: 1px solid transparent;">
			<div class="compendium-drop-target monsters">
				<textarea name="attr_description" accept="Description" spellcheck="false" rows="34" cols="80" style="margin: 0px 0px 0px -2px; padding: 2px 1px 1px 4px; font-size: 12px; line-height: 14px; background-color: transparent;">
				</textarea>
			</div>
		</div>

		<div  style="display: inline-block; vertical-align: top; width: 68px; height: 138px; margin: 15px 0px 0px 9px; padding: 0; background-color: rgb(240,230,215); border: 1px solid #BFBFBF;">
			<img name="attr_character_avatar" style="width: 68px; height: 138px; margin: 0px 0px 0px 0px;" title="ID Photograph"> 
		</div>

	<!-- Spells and Class -->

		<label style="display: inline-block; vertical-align: top; height: 22px; width:  80px; color: Black; margin: 20px 0px 2px 0px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 20px; font-weight: bold; text-align: left; padding: 4px 0px 0px 6px; border: 1px solid Transparent;"  data-i18n-title="classAkaArchetype" data-i18n="class-u">CLASS</label>
		<input type="text" name="attr_classType" class="sheet-profileInput" style="width: 134px; height: 20px; font-size: 14px; text-align: center; margin: 22px 0px 0px -14px; padding: 0px 0px 0px 0px; border: none;" value="">

		<button class="sheet-profileInput" type="action" name="act_spellPreparation" style="display: inline-block; vertical-align: top; height: 22px; width: 70px; color: Black; margin: 18px 0px 2px 8px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 22px; font-weight: bold; text-align: left; padding: 2px 0px 0px 2px; border: 0px solid transparent;" value="&{template:check} {{name=@{character_name} *prepares Spells*}} {{SpellPrep=[[@{presence}+1d4]]}}" data-i18n-title="rollDailySpellPreparation-c">
			<label data-i18n="spells-c">Spells</label> </button>
		<input type="text" name="attr_numSpell" class="sheet-profileInput" style="width: 12px; height: 22px; margin: 16px 0px 0px -2px; padding: 2px 1px 2px 1px; border: 1px solid Black;" data-i18n-title="numberOfSpells-c" value="">
		<label style="display: inline-block; vertical-align: top; height: 10px; width: 110px; color: Black; margin: 20px 0px 2px -2px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 9px; font-weight: bold; text-align: left; padding: 0px 0px 0px 1px; border: 1px solid Transparent;" data-i18n-title="spellDef" data-i18n="spellDef">Presence + D4 times per day</label>

		<div>
			<button type="action" name="act_spell1" style="display: inline-block; vertical-align: top; height: 18px; width: 18px; color: Black; margin: -2px 0px 2px 10px; font-family: dicefontd20; font-size: 18px; font-weight: regular; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" data-i18n-title="castSpell-c">t</button>
			<input type="text" name="attr_spell1" class="sheet-profileInput" style="width: 150px; height: 22px; margin: -2px 0px 0px -2px; border: 1px solid Black;" value="">
			<label for="extraSpell1" style="display: inline-block; vertical-align: top; width: 8px; height: 20px; color: Black; margin: 2px 14px 0px 0px; padding: 0px 0px 0px 0px; border: 0px solid Red;" data-i18n-title="characterCreation-c">&#x25BC;</label>
			<input type="checkbox" name='attr_spellDesc1' id="extraSpell1" class="sheet-toggle-show" style="width: 8px; height: 20px; margin: 2px 14px 0px -20px;" />
			<div class="sheet-body" style="position: absolute; z-index: 2; height: 160px; width: 196px; background-color: White; margin: 0px 0px 0px 8px; border: 0px solid Purple;">
				<label style="display: inline-block; vertical-align: top; height: 22px; width: 160px; color: Black; margin: 0px 0px 0px 0px; padding: 4px 0px 0px 0px; font-family: Arial; font-stretch: ultra-condensed; font-size: 16px; text-align: left; border: 2px solid Transparent;" data-i18n="displaySpell-c">Display Spell</label>
				<input type="checkbox" name='attr_displaySpell1' style="display: inline-block; vertical-align: top; width: 18px; color: Black; accent-color: Black; border: 2px solid Black; opacity: 1; margin: 8px 0px 0px 0px;" value="1" data-i18n-title="displaySpecialRule">
				<textarea name="attr_spellDescription1" cols=120 rows=12 style="width: 192px; height: 140px; font-weight: normal; font-size: 16px; text-align: center; border: 2px solid Black; margin: 1px 0px 0px 0px; padding: 0px 2px 0px 2px;" placeholder="Spell1 Description"></textarea>
			</div>
		</div>
		<div>
			<button type="action" name="act_spell2" style="display: inline-block; vertical-align: top; height: 18px; width: 18px; color: Black; margin: -3px 0px 2px 10px; font-family: dicefontd20; font-size: 18px; font-weight: bold;    text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" data-i18n-title="castSpell-c">t</button>
			<input type="text" name="attr_spell2" class="sheet-profileInput" style="width: 150px; height: 22px; margin: -3px 0px 0px -2px; border: 1px solid Black;" value="">
			<label for="extraSpell2" style="display: inline-block; vertical-align: top; width: 8px; height: 20px; color: Black; margin: 2px 14px 0px 0px; padding: 0px 0px 0px 0px; border: 0px solid Red;" data-i18n-title="characterCreation-c">&#x25BC;</label>
			<input type="checkbox" name='attr_spellDesc2' id="extraSpell2" class="sheet-toggle-show" style="width: 8px; height: 20px; margin: 2px 14px 0px -20px;" />
			<div class="sheet-body" style="position: absolute; z-index: 2; height: 160px; width: 200px; background-color: White; margin: 0px 0px 0px 8px; border: 0px solid Purple;">
				<label style="display: inline-block; vertical-align: top; height: 22px; width: 160px; color: Black; margin: 0px 0px 0px 0px; padding: 4px 0px 0px 0px; font-family: Arial; font-stretch: ultra-condensed; font-size: 16px; text-align: left; border: 2px solid Transparent;" data-i18n="displaySpell-c">Display Spell</label>
				<input type="checkbox" name='attr_displaySpell2' style="display: inline-block; vertical-align: top; width: 18px; color: Black; accent-color: Black; border: 2px solid Black; opacity: 1; margin: 8px 0px 0px 0px;" value="1" data-i18n-title="displaySpecialRule">
				<textarea name="attr_spellDescription2" cols=120 rows=12 style="width: 200px; height: 140px; font-weight: normal; font-size: 16px; text-align: center; border: 2px solid Black; margin: 1px 0px 0px 0px; padding: 0px 2px 0px 2px;" placeholder="Spell2 Description"></textarea>
			</div>
		</div>

		<div>
			<button type="action" name="act_spell3" style="display: inline-block; vertical-align: top; height: 18px; width: 18px; color: Black; margin: -3px 0px 2px 10px; font-family: dicefontd20; font-size: 18px; font-weight: regular; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" data-i18n-title="castSpell-c">t</button>
			<input type="text" name="attr_spell3" class="sheet-profileInput" style="width: 150px; height: 22px; margin: -3px 0px 0px -2px; border: 1px solid Black;" value="">
			<label for="extraSpell3" style="display: inline-block; vertical-align: top; width: 8px; height: 20px; color: Black; margin: 2px 14px 0px 0px; padding: 0px 0px 0px 0px; border: 0px solid Red;" data-i18n-title="characterCreation-c">&#x25BC;</label>
			<input type="checkbox" name='attr_spellDesc3' id="extraSpell3" class="sheet-toggle-show" style="width: 8px; height: 20px; margin: 2px 14px 0px -20px;" />
			<div class="sheet-body" style="position: absolute; z-index: 2; height: 160px; width: 200px; background-color: White; margin: 0px 0px 0px 8px; border: 0px solid Purple;">
				<label style="display: inline-block; vertical-align: top; height: 22px; width: 160px; color: Black; margin: 0px 0px 0px 0px; padding: 4px 0px 0px 0px; font-family: Arial; font-stretch: ultra-condensed; font-size: 16px; text-align: left; border: 2px solid Transparent;" data-i18n="displaySpell-c">Display Spell</label>
				<input type="checkbox" name='attr_displaySpell3' style="display: inline-block; vertical-align: top; width: 18px; color: Black; accent-color: Black; border: 2px solid Black; opacity: 1; margin: 8px 0px 0px 0px;" value="1" data-i18n-title="displaySpecialRule">
				<textarea name="attr_spellDescription3" cols=120 rows=12 style="width: 200px; height: 140px; font-weight: normal; font-size: 16px; text-align: center; border: 2px solid Black; margin: 1px 0px 0px 0px; padding: 0px 2px 0px 2px;" placeholder="Spell3 Description"></textarea>
			</div>
		</div>

		<div>
			<button type="action" name="act_spell4" style="display: inline-block; vertical-align: top; height: 18px; width: 18px; color: Black; margin: -3px 0px 2px 10px; font-family: dicefontd20; font-size: 18px; font-weight: bold;    text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" data-i18n-title="castSpell-c">t</button>
			<input type="text" name="attr_spell4" class="sheet-profileInput" style="width: 150px; height: 22px; margin: -3px 0px 0px -2px; border: 1px solid Black;" value="">
			<label for="extraSpell4" style="display: inline-block; vertical-align: top; width: 8px; height: 20px; color: Black; margin: 2px 14px 0px 0px; padding: 0px 0px 0px 0px; border: 0px solid Red;" data-i18n-title="characterCreation-c">&#x25BC;</label>
			<input type="checkbox" name='attr_spellDesc4' id="extraSpell4" class="sheet-toggle-show" style="width: 8px; height: 20px; margin: 2px 14px 0px -20px;" />
			<div class="sheet-body" style="position: absolute; z-index: 2; height: 160px; width: 200px; background-color: White; margin: 0px 0px 0px 8px; border: 0px solid Purple;">
				<label style="display: inline-block; vertical-align: top; height: 22px; width: 160px; color: Black; margin: 0px 0px 0px 0px; padding: 4px 0px 0px 0px; font-family: Arial; font-stretch: ultra-condensed; font-size: 16px; text-align: left; border: 2px solid Transparent;" data-i18n="displaySpell-c">Display Spell</label>
				<input type="checkbox" name='attr_displaySpell4' style="display: inline-block; vertical-align: top; width: 18px; color: Black; accent-color: Black; border: 2px solid Black; opacity: 1; margin: 8px 0px 0px 0px;" value="1" data-i18n-title="displaySpecialRule">
				<textarea name="attr_spellDescription4" cols=120 rows=12 style="width: 200px; height: 140px; font-weight: normal; font-size: 16px; text-align: center; border: 2px solid Black; margin: 1px 0px 0px 0px; padding: 0px 2px 0px 2px;" placeholder="Spell4 Description"></textarea>
			</div>
		</div>

		<div>
			<button type="action" name="act_spell5" style="display: inline-block; vertical-align: top; height: 18px; width: 18px; color: Black; margin: -3px 0px 2px 10px; font-family: dicefontd20; font-size: 18px; font-weight: regular; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" data-i18n-title="castSpell-c">t</button>
			<input type="text" name="attr_spell5" class="sheet-profileInput" style="width: 150px; height: 22px; margin: -3px 0px 0px -2px; border: 1px solid Black;" value="">
			<label for="extraSpell5" style="display: inline-block; vertical-align: top; width: 8px; height: 20px; color: Black; margin: 2px 14px 0px 0px; padding: 0px 0px 0px 0px; border: 0px solid Red;" data-i18n-title="characterCreation-c">&#x25BC;</label>
			<input type="checkbox" name='attr_spellDesc5' id="extraSpell5" class="sheet-toggle-show" style="width: 8px; height: 20px; margin: 2px 14px 0px -20px;" />
			<div class="sheet-body" style="position: absolute; z-index: 2; height: 160px; width: 200px; background-color: White; margin: 0px 0px 0px 8px; border: 0px solid Purple;">
				<label style="display: inline-block; vertical-align: top; height: 22px; width: 160px; color: Black; margin: 0px 0px 0px 0px; padding: 4px 0px 0px 0px; font-family: Arial; font-stretch: ultra-condensed; font-size: 16px; text-align: left; border: 2px solid Transparent;" data-i18n="displaySpell-c">Display Spell</label>
				<input type="checkbox" name='attr_displaySpell5' style="display: inline-block; vertical-align: top; width: 18px; color: Black; accent-color: Black; border: 2px solid Black; opacity: 1; margin: 8px 0px 0px 0px;" value="1" data-i18n-title="displaySpecialRule">
				<textarea name="attr_spellDescription5" cols=120 rows=12 style="width: 200px; height: 140px; font-weight: normal; font-size: 16px; text-align: center; border: 2px solid Black; margin: 1px 0px 0px 0px; padding: 0px 2px 0px 2px;" placeholder="Spell5 Description"></textarea>
			</div>
		</div>
		
		<div>
			<button type="action" name="act_spell6" style="display: inline-block; vertical-align: top; height: 18px; width: 18px; color: Black; margin: -3px 0px 2px 10px; font-family: dicefontd20; font-size: 18px; font-weight: bold; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" data-i18n-title="castSpell-c">t</button>
			<input type="text" name="attr_spell6" class="sheet-profileInput" style="width: 150px; height: 22px; margin: -3px 0px 0px -2px; border: 1px solid Black;" value="">
			<label for="extraSpell6" style="display: inline-block; vertical-align: top; width: 8px; height: 20px; color: Black; margin: 2px 14px 0px 0px; padding: 0px 0px 0px 0px; border: 0px solid Red;" data-i18n-title="characterCreation-c">&#x25BC;</label>
			<input type="checkbox" name='attr_spellDesc6' id="extraSpell6" class="sheet-toggle-show" style="width: 8px; height: 20px; margin: 2px 14px 0px -20px;" />
			<div class="sheet-body" style="position: absolute; z-index: 2; height: 160px; width: 200px; background-color: White; margin: 0px 0px 0px 8px; border: 0px solid Purple;">
				<label style="display: inline-block; vertical-align: top; height: 22px; width: 160px; color: Black; margin: 0px 0px 0px 0px; padding: 4px 0px 0px 0px; font-family: Arial; font-stretch: ultra-condensed; font-size: 16px; text-align: left; border: 2px solid Transparent;" data-i18n="displaySpell-c">Display Spell</label>
				<input type="checkbox" name='attr_displaySpell6' style="display: inline-block; vertical-align: top; width: 18px; color: Black; accent-color: Black; border: 2px solid Black; opacity: 1; margin: 8px 0px 0px 0px;" value="1" data-i18n-title="displaySpecialRule">
				<textarea name="attr_spellDescription6" cols=120 rows=12 style="width: 200px; height: 140px; font-weight: normal; font-size: 16px; text-align: center; border: 2px solid Black; margin: 1px 0px 0px 0px; padding: 0px 2px 0px 2px;" placeholder="Spell6 Description"></textarea>
			</div>
		</div>
	</div>
	
	<!-- Stat Block -->
	<div style="display: inline-block; vertical-align: top; height: 550px; width: 220px; margin: -2px 0px 0px 0px; border: 2px solid Transparent;">
		<label style="display: inline-block; vertical-align: top; height: 26px; width: 120px; color: Black; margin: 8px 0px 2px 56px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 24px; font-weight: bold; text-align: left; padding: 6px 0px 0px 0px; border: 1px solid Transparent;" data-i18n="hitPoints-c">Hit Points</label>
		<div class="compendium-drop-target monsters">
			<input type="text" name="attr_hpCurrent" accept="HP" class="sheet-profileInput" style="width: 70px; text-align: center; margin: 12px 0px 0px 40px; border: 2px solid DimGray;" value="">
			<input type="text" name="attr_hpMax"     accept="HP" class="sheet-profileInput" style="width: 70px; text-align: center; margin: 12px 0px 0px 20px; border: 2px solid Black;" value="">
		</div>
		<label style="display: inline-block; vertical-align: top; height: 26px; width: 90px; color: Black; margin: 20px 0px 2px 30px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 28px; font-weight: bold; text-align: left; padding: 6px 0px 0px 0px; border: 1px solid Transparent;" data-i18n="current-c">Current</label>
		<label style="display: inline-block; vertical-align: top; height: 26px; width: 60px; color: Black; margin: 20px 0px 2px  6px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 28px; font-weight: bold; text-align: left; padding: 6px 0px 0px 0px; border: 1px solid Transparent;" data-i18n="max-c">Max</label>

		<button class="sheet-profileInput" type="action" name="act_strength" style="display: inline-block; vertical-align: top; height: 26px; width: 120px; color: White; background-color: Black; margin: 62px 0px 2px 24px; font-family: UnifrakturCook; font-style: normal; font-size: 28px; font-weight: bold; text-align: left; padding: 0px 0px 0px 0px; border: 1px solid Transparent;" data-i18n-title="strengthDefn">
			<label style="height: 26px; width: 128px; color: White; background-color: Black; padding: 0px 6px 0px 0px; margin: 0px 0px 0px -2px;" data-i18n="strength-c">Strength</label> </button>

		<input type="text" name="attr_strength" class="sheet-profileInput" style="width: 30px; height: 30px; font-size: 22px; font-style: bold; text-align: center; margin: 54px 0px 0px 22px; border: 2px solid Black;" value="">

		<button class="sheet-profileInput" type="action" name="act_agility" style="display: inline-block; vertical-align: top; height: 26px; width: 120px; color: White; background-color: Black; margin: 4px 0px 2px 24px; font-family: Ballet; font-style: normal; font-size: 26px; font-weight: bold; text-align: left; padding: 0px 0px 0px 0px; border: 1px solid Transparent;" data-i18n-title="agilityDefn">
			<label style="height: 26px; width: 128px; color: White; background-color: Black; padding: 0px 6px 0px 0px; margin: 0px 0px 0px -2px;" data-i18n="agility-c">Agility</label> </button>

		<input type="text" name="attr_agility" class="sheet-profileInput" style="width: 30px; height: 30px; font-size: 22px; font-style: bold; text-align: center; margin: -2px 0px 0px 22px; border: 2px solid Black;" value="">

		<button class="sheet-profileInput" type="action" name="act_presence" style="display: inline-block; vertical-align: top; height: 26px; width: 120px; color: White; background-color: Black; margin: 4px 0px 2px 24px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 26px; font-weight: bold; text-align: left; padding: 0px 0px 0px 0px; border: 1px solid Transparent;" data-i18n-title="presenceDefn">
			<label style="height: 26px; width: 128px; color: White; background-color: Black; padding: 0px 6px 0px 0px; margin: 0px 0px 0px -2px;" data-i18n="presence-c">Presence</label> </button>

		<input type="text" name="attr_presence" class="sheet-profileInput" style="width: 30px; height: 30px; font-size: 22px; font-style: bold; text-align: center; margin: -2px 0px 0px 22px; border: 2px solid Black;" value="">

		<button class="sheet-profileInput" type="action" name="act_toughness" style="display: inline-block; vertical-align: top; height: 26px; width: 120px; color: White; background-color: Black; margin: 4px 0px 2px 24px; font-family: Pirata One; font-style: normal; font-size: 26px; font-weight: bold; text-align: left; padding: 0px 0px 0px 0px; border: 1px solid Transparent;" data-i18n-title="toughnessDefn">
			<label style="height: 26px; width: 128px; color: White; background-color: Black; padding: 0px 6px 0px 0px; margin: 0px 0px 0px -2px;" data-i18n="toughness-c">Toughness</label> </button>

		<input type="text" name="attr_toughness" class="sheet-profileInput" style="width: 30px; height: 30px; font-size: 22px; font-style: bold; text-align: center; margin: -2px 0px 0px 22px; border: 2px solid Black;" value="">

	<!-- Feats -->
		<label style="display: inline-block; vertical-align: top; height: 22px; width: 70px; color: Black; margin:  22px 0px 2px 2px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 28px; font-weight: bold; text-align: left; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" data-i18n="feats-c">Feats</label>
		<div>
			<input type="text" name="attr_feat1" class="sheet-profileInput" style="width:  200px; height: 36px; margin: 15px 0px 0px 8px; border-bottom: 0px solid Red;" value="">
			<label for="extraFeat1" style="display: inline-block; vertical-align: top; width: 8px; height: 16px; color: Black; margin: 22px 0px 0px -4px; padding: 0px 0px 0px 0px; border: 0px solid Red;" data-i18n-title="featExpansion-c">&#x25BD;</label>
			<input type="checkbox" name='attr_featExtra1' id="extraFeat1" class="sheet-toggle-show" style="width: 8px; height: 20px; margin: 2px 18px 0px -22px;" />
			<div class="sheet-body" style="position: absolute; z-index: 2; height:100px; width: 196px; background-color: White; margin: 0px 0px 0px 8px; border: 2px solid Black;">
				<textarea name="attr_FeatDescription1" cols=120 rows=12 style="width: 196px; height: 100px; font-weight: normal; font-size: 16px; text-align: center; border: 0px solid Black; margin: 0px 0px 0px 0px; padding: 0px 1px 0px 1px;" placeholder="Feat Description"></textarea>
			</div>
		</div>
		<div>
			<input type="text" name="attr_feat2" class="sheet-profileInput" style="width:  200px; height: 36px; margin: 22px 0px 0px 8px; border-bottom: 0px solid Red;" value="">
			<label for="extraFeat2" style="display: inline-block; vertical-align: top; width: 8px; height: 16px; color: Black; margin: 22px 0px 0px -4px; padding: 0px 0px 0px 0px; border: 0px solid Red;" data-i18n-title="featExpansion-c">&#x25BD;</label>
			<input type="checkbox" name='attr_featExtra2' id="extraFeat2" class="sheet-toggle-show" style="width: 8px; height: 20px; margin: 2px 18px 0px -22px;" />
			<div class="sheet-body" style="position: absolute; z-index: 2; height:100px; width: 196px; background-color: White; margin: 0px 0px 0px 8px; border: 2px solid Black;">
				<textarea name="attr_FeatDescription2" cols=120 rows=12 style="width: 196px; height: 100px; font-weight: normal; font-size: 16px; text-align: center; border: 0px solid Black; margin: 0px 0px 0px 0px; padding: 0px 1px 0px 1px;" placeholder="Feat Description"></textarea>
			</div>
		</div>
		<div>
			<input type="text" name="attr_feat3" class="sheet-profileInput" style="width:  200px; height: 36px; margin: 24px 0px 0px 8px; border-bottom: 2px solid Black;" value="">
			<label for="extraFeat3" style="display: inline-block; vertical-align: top; width: 8px; height: 16px; color: Black; margin: 22px 0px 0px -4px; padding: 0px 0px 0px 0px; border: 0px solid Red;" data-i18n-title="featExpansion-c">&#x25BD;</label>
			<input type="checkbox" name='attr_featExtra3' id="extraFeat3" class="sheet-toggle-show" style="width: 8px; height: 20px; margin: 2px 18px 0px -22px;" />
			<div class="sheet-body" style="position: absolute; z-index: 2; height:100px; width: 196px; background-color: White; margin: 0px 0px 0px 8px; border: 2px solid Black;">
				<textarea name="attr_FeatDescription3" cols=120 rows=12 style="width: 196px; height: 100px; font-weight: normal; font-size: 16px; text-align: center; border: 0px solid Black; margin: 0px 0px 0px 0px; padding: 0px 1px 0px 1px;" placeholder="Feat Description"></textarea>
			</div>
		</div>
	</div>
	
	<!-- Weapons -->
	<div style="display: inline-block; vertical-align: top; height: 550px; width: 300px; margin: 10px 0px 2px 2px; border: 2px solid Transparent;">
		<label style="display: inline-block; vertical-align: top; height: 28px; width: 100px; color: Black; margin: 6px 0px 2px  6px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 24px; font-weight: bold; text-align: left; padding: 2px 0px 0px 0px; border: 1px solid Transparent;" data-i18n="weapons-c">Weapons</label>
		<div style="display: inline-block; vertical-align: top; margin: 10px 0px 0px 60px; padding-top: 0px 0px 0px 0px; width: 30px; border: 0px solid Red;">
			<input id="CalledShot" type="checkbox" class="suppress" name="attr_calledShot" style="margin: 0px; width: 30px;" value="1"><label class="suppress" style='margin: 0px 0px 0px 0px; width: 90px; font-size: 18px; text-align: right; padding: 0;' title="Reckless Attack/Called Shot: active when DarkRed, inactive when Black" for="CalledShot">&#x25ce;</label>
		</div>
	<label style="display: inline-block; vertical-align: top; height: 28px; width:  60px; color: Black; margin: 6px 0px 2px  2px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 24px; font-weight: bold; text-align: left; padding: 2px 0px 0px 26px;" data-i18n="ammo-c">Ammo</label>

		<!-- From GiGs's Cybersphere https://cybersphere.me/buttons-in-rolltemplates-2/ -->
<!--		<button type="roll" name="roll_misfireDamage" class="hidden" value="&{template:default} {{title=@{character_name} rolls Misfire Damage}} {{roll=[[1d6]]}}"></button> -->
		<button type="roll" name="roll_misfireDamage" class="hidden" value="&{template:check} {{name=@{character_name} rolls Misfire Damage}} {{MisfireDamage=[[1d4]]}}"></button>
		<button type="roll" name="roll_d4"   class="hidden" value="&{template:check} {{name=@{character_name} rolls [[1d4]]}}"></button>
		<button type="roll" name="roll_d6"   class="hidden" value="&{template:check} {{name=@{character_name} rolls [[1d6]]}}"></button>
		<button type="roll" name="roll_d10"  class="hidden" value="&{template:check} {{name=@{character_name} rolls [[1d10]]}}"></button>
		<button type="roll" name="roll_d12"  class="hidden" value="&{template:check} {{name=@{character_name} rolls [[1d12]]}}"></button>
		<button type="roll" name="roll_d20"  class="hidden" value="&{template:check} {{name=@{character_name} rolls [[1d20]]}}"></button>
		<button type="roll" name="roll_2d20" class="hidden" value="&{template:check} {{name=@{character_name} rolls [[2d20]]}}"></button>
		<button type="roll" name="roll_3d20" class="hidden" value="&{template:check} {{name=@{character_name} rolls [[3d20]]}}"></button>

		<button type="action" name="act_weapon1" style="display: inline-block; vertical-align: top; height: 18px; width: 18px; color: Black; margin: 0px 0px 0px 2px; font-family: dicefontd20; font-size: 18px; font-weight: regular; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" data-i18n-title="weaponAttack-c">t</button>
		<div class="compendium-drop-target monsters" style="display: inline-block; vertical-align: top;">
			<input type="text" name="attr_weapon1" accept="Attack" class="sheet-profileInput" style="width: 180px; height: 26px; font-style: normal; font-size: 20px; margin: 0px 0px 0px -4px; border-bottom: 2px solid Black; background-color: transparent;" value="">
		</div>
		<label for="extraWeapon1" style="display: inline-block; vertical-align: top; width: 8px; height: 20px; color: Black; margin: 2px 14px 0px 0px; padding: 0px 0px 0px 0px; border: 0px solid Red;" data-i18n-title="weaponExpansion-c">&#x25BC;</label> <!-- 25BD -->
		<input type="checkbox" name='attr_weaponExtra1' id="extraWeapon1" class="sheet-toggle-show" style="width: 8px; height: 20px; margin: 2px 14px 0px -20px;" />
		<div class="sheet-body" style="position: absolute; z-index: 2; height:310px; width: 294px; background-color: White; margin-top: 0px; border: 2px solid Purple;">
			<label style="display: inline-block; vertical-align: top; height: 24px; width: 66px; color: Black; margin: 6px 0px 0px  0px; padding: 4px 0px 0px 0px; font-family: Arial; font-stretch: ultra-condensed; font-size: 20px; text-align: center; border: 2px solid Transparent;" data-i18n="damage-c">Damage</label>
			<div class="compendium-drop-target monsters" style="display: inline-block; vertical-align: top;">
				<input type="text" name="attr_weaponDamage1" accept="Attack Damage" class="sheet-profileInput" style="width: 70px; height: 26px; font-size: 20px; font-style: bold; text-align: center; margin: 8px 0px 0px 2px; padding: 2px; border: 2px solid Black;" value="">
			</div>
			<label style="display: inline-block; vertical-align: top; height: 24px; width: 40px; color: Black; margin: 6px 0px 0px 0px; padding: 4px 0px 0px 0px; font-family: Arial; font-stretch: ultra-condensed; font-size: 20px; text-align: center; border: 2px solid Transparent;" data-i18n="cost-c">Cost</label>
			<input type="text" name="attr_weaponCost1" class="sheet-profileInput" style="width: 70px; height: 26px; font-size: 20px; font-style: bold; text-align: center; margin: 8px 0px 0px 2px; border: 2px solid Black;" value="">
			<br>
			<label style="display: inline-block; vertical-align: top; height: 22px; width: 76px; color: Black; margin: 0px 0px 0px 0px; padding: 2px 0px 0px 0px; font-family: Arial; font-stretch: ultra-condensed; font-size: 20px; text-align: left; border: 2px solid Transparent;" data-i18n="ranged?-c">Ranged?</label>
			<input type="checkbox" name='attr_weaponRanged1' style="width: 18px; color: Black; accent-color: Black; border: 2px solid Black; opacity: 1; margin: 6px 0px 0px 0px;" value="1">
			<label style="display: inline-block; vertical-align: top; height: 22px; width: 120px; color: Black; margin: 0px 0px 0px 40px; padding: 2px 0px 0px 0px; font-family: Arial; font-stretch: ultra-condensed; font-size: 20px; text-align: left; border: 2px solid Transparent;" data-i18n="blackPowder?-c">Black Powder?</label>
			<input type="checkbox" name='attr_weaponBlackPowder1' style="width: 18px; color: Black; accent-color: Black; border: 2px solid Black; opacity: 1; margin: 6px 0px 0px 0px;" value="1">
			<textarea name="attr_weaponDescription1" cols=120 rows=12 style="width: 294px; height: 100px; font-weight: normal; font-size: 16px; text-align: center; border: 2px solid Black; margin: 3px 0px 0px 0px; padding: 0px 3px 0px 3px;" placeholder="Description"></textarea>
			<label style="display: inline-block; vertical-align: top; height: 22px; width: 242px; color: Black; margin: 0px 0px 0px 0px; padding: 4px 0px 0px 0px; font-family: Arial; font-stretch: ultra-condensed; font-size: 20px; text-align: left; border: 2px solid Transparent;" data-i18n="specialRule">Special rule</label>
			<input type="checkbox" name='attr_displaySpeciaRule1' style="width: 18px; color: Black; accent-color: Black; border: 2px solid Black; opacity: 1; margin: 8px 0px 0px 0px;" value="1" data-i18n-title="displaySpecialRule">
			<textarea name="attr_weaponSpecialRule1" cols=120 rows=12 style="width: 294px; height: 100px; font-weight: normal; font-size: 16px; text-align: center; border: 2px solid Black; margin: 3px 0px 0px 0px; padding: 0px 3px 0px 3px;" placeholder="Special Rule"></textarea>
			<br>
		</div>
		<input type="text" name="attr_ammo1"   class="sheet-profileInput" style="width:  64px; height: 26px; text-align: center; margin: 0px 0px 0px 0px; border-bottom: 2px solid Black;" value="">

		<div>
			<button type="action" name="act_weapon2" style="display: inline-block; vertical-align: top; height: 18px; width: 18px; color: Black; margin: 0px 0px 0px 2px; font-family: dicefontd20; font-size: 18px; font-weight: regular; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" data-i18n-title="weaponAttack-c">t</button>
			<div class="compendium-drop-target monsters" style="display: inline-block; vertical-align: top;">
				<input type="text" name="attr_weapon2" accept="Attack2" class="sheet-profileInput" style="width: 180px; height: 26px; font-style: normal; font-size: 20px; margin: 0px 0px 0px -4px; border-bottom: 2px solid Black; background-color: transparent;" value="">
			</div>
			<label for="extraWeapon2" style="display: inline-block; vertical-align: top; width: 8px; height: 20px; color: Black; margin: 2px 14px 0px 0px; padding: 0px 0px 0px 0px; border: 0px solid Red;" data-i18n-title="characterCreation-c">&#x25BC;</label>
			<input type="checkbox" name='attr_weaponExtra2' id="extraWeapon2" class="sheet-toggle-show" style="width: 8px; height: 20px; margin: 2px 14px 0px -20px;" />
			<div class="sheet-body" style="position: absolute; z-index: 2; height:310px; width: 294px; background-color: White; margin-top: 0px; border: 2px solid Purple;">
				<label style="display: inline-block; vertical-align: top; height: 24px; width: 66px; color: Black; margin: 6px 0px 0px  0px; padding: 4px 0px 0px 0px; font-family: Arial; font-stretch: ultra-condensed; font-size: 20px; text-align: center; border: 2px solid Transparent;" data-i18n="damage-c">Damage</label>
				<div class="compendium-drop-target monsters" style="display: inline-block; vertical-align: top;">
					<input type="text" name="attr_weaponDamage2" accept="Attack2 Damage" class="sheet-profileInput" style="width: 70px; height: 26px; font-size: 20px; font-style: bold; text-align: center; margin: 8px 0px 0px 2px; padding: 2px; border: 2px solid Black;" value="">
				</div>
				<label style="display: inline-block; vertical-align: top; height: 24px; width: 40px; color: Black; margin: 6px 0px 0px 0px; padding: 4px 0px 0px 0px; font-family: Arial; font-stretch: ultra-condensed; font-size: 20px; text-align: center; border: 2px solid Transparent;" data-i18n="cost-c">Cost</label>
				<input type="text" name="attr_weaponCost2" class="sheet-profileInput" style="width: 70px; height: 26px; font-size: 20px; font-style: bold; text-align: center; margin: 8px 0px 0px 2px; border: 2px solid Black;" value="">
				<br>
				<label style="display: inline-block; vertical-align: top; height: 22px; width: 76px; color: Black; margin: 0px 0px 0px 0px; padding: 2px 0px 0px 0px; font-family: Arial; font-stretch: ultra-condensed; font-size: 20px; text-align: left; border: 2px solid Transparent;" data-i18n="ranged?-c">Ranged?</label>
				<input type="checkbox" name='attr_weaponRanged2' style="width: 18px; color: Black; accent-color: Black; border: 2px solid Black; opacity: 1; margin: 6px 0px 0px 0px;" value="1">
				<label style="display: inline-block; vertical-align: top; height: 22px; width: 120px; color: Black; margin: 0px 0px 0px 40px; padding: 2px 0px 0px 0px; font-family: Arial; font-stretch: ultra-condensed; font-size: 20px; text-align: left; border: 2px solid Transparent;" data-i18n="blackPowder?-c">Black Powder?</label>
				<input type="checkbox" name='attr_weaponBlackPowder2' style="width: 18px; color: Black; accent-color: Black; border: 2px solid Black; opacity: 1; margin: 6px 0px 0px 0px;" value="1">
				<textarea name="attr_weaponDescription2" cols=120 rows=12 style="width: 294px; height: 100px; font-weight: normal; font-size: 16px; text-align: center; border: 2px solid Black; margin: 3px 0px 0px 0px; padding: 0px 3px 0px 3px;" placeholder="Description"></textarea>
				<label style="display: inline-block; vertical-align: top; height: 22px; width: 242px; color: Black; margin: 0px 0px 0px 0px; padding: 4px 0px 0px 0px; font-family: Arial; font-stretch: ultra-condensed; font-size: 20px; text-align: left; border: 2px solid Transparent;" data-i18n="specialRule">Special rule</label>
				<input type="checkbox" name='attr_displaySpeciaRule2' style="width: 18px; color: Black; accent-color: Black; border: 2px solid Black; opacity: 1; margin: 8px 0px 0px 0px;" value="1" data-i18n-title="displaySpecialRule">
				<textarea name="attr_weaponSpecialRule2" cols=120 rows=12 style="width: 294px; height: 100px; font-weight: normal; font-size: 16px; text-align: center; border: 2px solid Black; margin: 3px 0px 0px 0px; padding: 0px 3px 0px 3px;" placeholder="Special Rule"></textarea>
				<br>
			</div>
			<input type="text" name="attr_ammo2"   class="sheet-profileInput" style="width:  64px; height: 26px; text-align: center; margin: 0px 0px 0px -0px; border-bottom: 2px solid Black;" value="">
		</div>

		<div>
			<button type="action" name="act_weapon3" style="display: inline-block; vertical-align: top; height: 18px; width: 18px; color: Black; margin: 0px 0px 0px 2px; font-family: dicefontd20; font-size: 18px; font-weight: regular; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" data-i18n-title="weaponAttack-c">t</button>
			<input type="text" name="attr_weapon3" class="sheet-profileInput" style="width: 180px; height: 26px; font-style: normal; font-size: 20px; margin: 0px 0px 0px -4px; border-bottom: 2px solid Black; background-color: transparent;" value="">
			<label for="extraWeapon3" style="display: inline-block; vertical-align: top; width: 8px; height: 20px; color: Black; margin: 2px 14px 0px 0px; padding: 0px 0px 0px 0px; border: 0px solid Red;" data-i18n-title="characterCreation-c">&#x25BC;</label>
			<input type="checkbox" name='attr_weaponExtra3' id="extraWeapon3" class="sheet-toggle-show" style="width: 8px; height: 20px; margin: 2px 14px 0px -20px;" />
			<div class="sheet-body" style="position: absolute; z-index: 2; height:310px; width: 294px; background-color: White; margin-top: 0px; border: 2px solid Purple;">
				<label style="display: inline-block; vertical-align: top; height: 24px; width: 66px; color: Black; margin: 6px 0px 0px  0px; padding: 4px 0px 0px 0px; font-family: Arial; font-stretch: ultra-condensed; font-size: 20px; text-align: center; border: 2px solid Transparent;" data-i18n="damage-c">Damage</label>
				<input type="text" name="attr_weaponDamage3" class="sheet-profileInput" style="width: 70px; height: 26px; font-size: 20px; font-style: bold; text-align: center; margin: 8px 0px 0px 2px; padding: 2px; border: 2px solid Black;" value="">
				<label style="display: inline-block; vertical-align: top; height: 24px; width: 40px; color: Black; margin: 6px 0px 0px 0px; padding: 4px 0px 0px 0px; font-family: Arial; font-stretch: ultra-condensed; font-size: 20px; text-align: center; border: 2px solid Transparent;" data-i18n="cost-c">Cost</label>
				<input type="text" name="attr_weaponCost3" class="sheet-profileInput" style="width: 70px; height: 26px; font-size: 20px; font-style: bold; text-align: center; margin: 8px 0px 0px 2px; border: 2px solid Black;" value="">
				<br>
				<label style="display: inline-block; vertical-align: top; height: 22px; width: 76px; color: Black; margin: 0px 0px 0px 0px; padding: 2px 0px 0px 0px; font-family: Arial; font-stretch: ultra-condensed; font-size: 20px; text-align: left; border: 2px solid Transparent;" data-i18n="ranged?-c">Ranged?</label>
				<input type="checkbox" name='attr_weaponRanged3' style="width: 18px; color: Black; accent-color: Black; border: 2px solid Black; opacity: 1; margin: 6px 0px 0px 0px;" value="1">
				<label style="display: inline-block; vertical-align: top; height: 22px; width: 120px; color: Black; margin: 0px 0px 0px 40px; padding: 2px 0px 0px 0px; font-family: Arial; font-stretch: ultra-condensed; font-size: 20px; text-align: left; border: 2px solid Transparent;" data-i18n="blackPowder?-c">Black Powder?</label>
				<input type="checkbox" name='attr_weaponBlackPowder3' style="width: 18px; color: Black; accent-color: Black; border: 2px solid Black; opacity: 1; margin: 6px 0px 0px 0px;" value="1">
				<textarea name="attr_weaponDescription3" cols=120 rows=12 style="width: 294px; height: 100px; font-weight: normal; font-size: 16px; text-align: center; border: 2px solid Black; margin: 3px 0px 0px 0px; padding: 0px 3px 0px 3px;" placeholder="Description"></textarea>
				<label style="display: inline-block; vertical-align: top; height: 22px; width: 242px; color: Black; margin: 0px 0px 0px 0px; padding: 4px 0px 0px 0px; font-family: Arial; font-stretch: ultra-condensed; font-size: 20px; text-align: left; border: 2px solid Transparent;" data-i18n="specialRule">Special rule</label>
				<input type="checkbox" name='attr_displaySpeciaRule3' style="width: 18px; color: Black; accent-color: Black; border: 2px solid Black; opacity: 1; margin: 8px 0px 0px 0px;" value="1" data-i18n-title="displaySpecialRule">
				<textarea name="attr_weaponSpecialRule3" cols=120 rows=12 style="width: 294px; height: 100px; font-weight: normal; font-size: 16px; text-align: center; border: 2px solid Black; margin: 3px 0px 0px 0px; padding: 0px 3px 0px 3px;" placeholder="Special Rule"></textarea>
				<br>
			</div>
			<input type="text" name="attr_ammo3"   class="sheet-profileInput" style="width:  64px; height: 26px; text-align: center; margin: 0px 0px 0px -0px; border-bottom: 2px solid Black;" value="">
		</div>

		<div>
			<button type="action" name="act_weapon4" style="display: inline-block; vertical-align: top; height: 18px; width: 18px; color: Black; margin: 0px 0px 0px 2px; font-family: dicefontd20; font-size: 18px; font-weight: regular; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" data-i18n-title="weaponAttack-c">t</button>
			<input type="text" name="attr_weapon4" class="sheet-profileInput" style="width: 180px; height: 26px; font-style: normal; font-size: 20px; margin: 0px 0px 0px -4px; border-bottom: 2px solid Black; background-color: transparent;" value="">
			<label for="extraWeapon4" style="display: inline-block; vertical-align: top; width: 8px; height: 20px; color: Black; margin: 2px 14px 0px 0px; padding: 0px 0px 0px 0px; border: 0px solid Red;" data-i18n-title="characterCreation-c">&#x25BC;</label>
			<input type="checkbox" name='attr_weaponExtra4' id="extraWeapon4" class="sheet-toggle-show" style="width: 8px; height: 20px; margin: 2px 14px 0px -20px;" />
			<div class="sheet-body" style="position: absolute; z-index: 2; height:310px; width: 294px; background-color: White; margin-top: 0px; border: 2px solid Purple;">
				<label style="display: inline-block; vertical-align: top; height: 24px; width: 66px; color: Black; margin: 6px 0px 0px  0px; padding: 4px 0px 0px 0px; font-family: Arial; font-stretch: ultra-condensed; font-size: 20px; text-align: center; border: 2px solid Transparent;" data-i18n="damage-c">Damage</label>
				<input type="text" name="attr_weaponDamage4" class="sheet-profileInput" style="width: 70px; height: 26px; font-size: 20px; font-style: bold; text-align: center; margin: 8px 0px 0px 2px; padding: 2px; border: 2px solid Black;" value="">
				<label style="display: inline-block; vertical-align: top; height: 24px; width: 40px; color: Black; margin: 6px 0px 0px 0px; padding: 4px 0px 0px 0px; font-family: Arial; font-stretch: ultra-condensed; font-size: 20px; text-align: center; border: 2px solid Transparent;" data-i18n="cost-c">Cost</label>
				<input type="text" name="attr_weaponCost4" class="sheet-profileInput" style="width: 70px; height: 26px; font-size: 20px; font-style: bold; text-align: center; margin: 8px 0px 0px 2px; border: 2px solid Black;" value="">
				<br>
				<label style="display: inline-block; vertical-align: top; height: 22px; width: 76px; color: Black; margin: 0px 0px 0px 0px; padding: 2px 0px 0px 0px; font-family: Arial; font-stretch: ultra-condensed; font-size: 20px; text-align: left; border: 2px solid Transparent;" data-i18n="ranged?-c">Ranged?</label>
				<input type="checkbox" name='attr_weaponRanged4' style="width: 18px; color: Black; accent-color: Black; border: 2px solid Black; opacity: 1; margin: 6px 0px 0px 0px;" value="1">
				<label style="display: inline-block; vertical-align: top; height: 22px; width: 120px; color: Black; margin: 0px 0px 0px 40px; padding: 2px 0px 0px 0px; font-family: Arial; font-stretch: ultra-condensed; font-size: 20px; text-align: left; border: 2px solid Transparent;" data-i18n="blackPowder?-c">Black Powder?</label>
				<input type="checkbox" name='attr_weaponBlackPowder4' style="width: 18px; color: Black; accent-color: Black; border: 2px solid Black; opacity: 1; margin: 6px 0px 0px 0px;" value="1">
				<textarea name="attr_weaponDescription4" cols=120 rows=12 style="width: 294px; height: 100px; font-weight: normal; font-size: 16px; text-align: center; border: 2px solid Black; margin: 3px 0px 0px 0px; padding: 0px 3px 0px 3px;" placeholder="Description"></textarea>
				<label style="display: inline-block; vertical-align: top; height: 22px; width: 242px; color: Black; margin: 0px 0px 0px 0px; padding: 4px 0px 0px 0px; font-family: Arial; font-stretch: ultra-condensed; font-size: 20px; text-align: left; border: 2px solid Transparent;" data-i18n="specialRule">Special rule</label>
				<input type="checkbox" name='attr_displaySpeciaRule4' style="width: 18px; color: Black; accent-color: Black; border: 2px solid Black; opacity: 1; margin: 8px 0px 0px 0px;" value="1" data-i18n-title="displaySpecialRule">
				<textarea name="attr_weaponSpecialRule4" cols=120 rows=12 style="width: 294px; height: 100px; font-weight: normal; font-size: 16px; text-align: center; border: 2px solid Black; margin: 3px 0px 0px 0px; padding: 0px 3px 0px 3px;" placeholder="Special Rule"></textarea>
				<br>
			</div>
			<input type="text" name="attr_ammo4"   class="sheet-profileInput" style="width:  64px; height: 26px; text-align: center; margin: 0px 0px 0px -0px; border-bottom: 2px solid Black;" value="">
		</div>

		<!-- Armour -->
		<div style="display: inline-block; vertical-align: top; height: 38px; width: 294px; margin: 2px 0px 2px 0px; border: 2px solid Transparent;">
			<div class="compendium-drop-target monsters">
				<button class="sheet-profileInput" type="action" name="act_armour" style="height: 28px; width: 100px; font-size: 14px; margin: 2px 0px 0px 0px; padding: 2px 0px 0px 0px; background-color: transparent; border: 0px solid DarkRed;" >
					<label style="display: inline-block; vertical-align: top; height: 28px; width: 100px; color: Black; margin: 2px 0px 2px  6px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 28px; font-weight: bold; text-align: left; background-color: transparent; padding: 0px 0px 0px 2px; border: 1px solid Transparent;" data-i18n="armour-c">Armour</label></button>
<!--			<label style="display: inline-block; vertical-align: top; height: 28px; width: 100px; color: Black; margin: 2px 0px 2px  6px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 28px; font-weight: bold; text-align: left; background-color: transparent; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" data-i18n="armour-c">Armour</label> -->
<!--			<input type="text" name="attr_armour"   class="sheet-profileInput" style="width:  98px; height: 26px; margin: -2px 0px 0px -2px; padding: 0px 2px 1px 2px; border-bottom: 2px solid Black;" value=""> -->
<!--			<div class="compendium-drop-target monsters"> -->
				<select  name='attr_armour'  accept="Armour" data-i18n-title="ArmourTypeWithXAsDegrades" style='width: 98px; text-align: center; height: 26px; font-size: 16px; margin: -2px 0px 0px -2px; padding: 0px 2px 1px 2px; border-bottom: 2px solid Black;'> 
					<option  type="text" style="color:Black" ></option> 
					<option  type="text" style="color:Black"   data-i18n="light-c"> Light</option> 
					<option  type="text" style="color:Black"   data-i18n="medium-c"> Medium</option> 
					<option  type="text" style="color:Black"   data-i18n="heavy-c"> Heavy</option> 
					<option  type="text" style="color:Red"     data-i18n="mediumX-c"> Medium X</option>
					<option  type="text" style="color:DarkRed" data-i18n="heavyX-c">  Heavy X</option>
					<option  type="text" style="color:Red"     data-i18n="heavyXX-c"> Heavy XX</option>
				</select>

				<button class="sheet-profileInput" type="roll" name="roll_armourCheck" style="height: 24px; width: 20px; font-size: 14px; margin: -2px 0px 0px -2px; padding: 2px 0px 0px 0px; background-color: rgba(255,255,255,0.3); border: 2px solid DarkRed;" value="&{template:check} {{name=@{character_name} *shielded by* @{armour}}} {{Absorb=[[1d2]]}}" data-i18n-title="lightArmourCheck-c">
					<label style="background-color: transparent; padding: 1px 0px 0px 0px;">d2</label></button>
				<button class="sheet-profileInput" type="roll" name="roll_armourCheck" style="height: 24px; width: 20px; font-size: 14px; margin: -2px 0px 0px -2px; padding: 2px 0px 0px 0px; background-color: rgba(255,255,255,0.3); border: 2px solid Purple;" value="&{template:check} {{name=@{character_name} *shielded by* @{armour}}} {{Absorb=[[1d4]]}}" data-i18n-title="mediumArmourCheck-c">
					<label style="background-color: transparent; padding: 1px 0px 0px 0px;">d4</label></button>
				<button class="sheet-profileInput" type="roll" name="roll_armourCheck" style="height: 24px; width: 20px; font-size: 14px; margin: -2px 0px 0px -2px; padding: 2px 0px 0px 0px; background-color: rgba(255,255,255,0.3); border: 2px solid DarkBlue;" value="&{template:check} {{name=@{character_name} *shielded by* @{armour}}} {{Absorb=[[1d6]]}}" data-i18n-title="heavyArmourCheck-c">
					<label style="background-color: transparent; padding: 1px 0px 0px 0px;">d6</label></button>
				<button class="sheet-profileInput" type="action" name="act_degradeArmour"  style="height: 24px; width: 16px; font-size: 18px; margin:  8px 0px 0px -6px; padding: 0px 0px 0px 0px; background-color: rgba(255,255,255,0.3); border: 2px solid transparent;" data-i18n-title="armourDegrades-c">
					<label style="background-color: transparent;  color: DarkRed; font-family: UnifrakturMaguntia; font-weight: 700; padding: 6px 0px 0px 0px;">X</label></button>
			</div>
		</div>

		<!-- Gear -->
		<input type="number" name="attr_totalGear"  style="display: none;" value="0">
		<input type="number" name="attr_capacity"   style="display: none;" value="0">
		<input type="number" name="attr_encumbered" style="display: none;" value="">
		<div style="display: inline-block; vertical-align: top; height: 58px; width: 134px; margin: 4px 0px 2px 0px; border: 2px solid Transparent;">
			<label style="display: inline-block; vertical-align: top; height: 22px; width: 90px; color: White; margin:  6px 0px 2px 2px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 28px; font-weight: bold; text-align: left; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" data-i18n="gear-c">Gear</label>
			<input type="text" name="attr_encumbered" style="display: inline-block; vertical-align: top; height: 28px; width: 28px; color: Red; background-color: transparent; margin:  2px 0px 0px 0px; font-size: 18px; font-weight: bold; text-align: center; padding: 0px 0px 0px 0px; border: 1px solid Transparent;" readonly />

			<label style="display: inline-block; vertical-align: top; height: 12px; width: 132px; color: White; margin: -2px 0px 2px 0px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 10px; font-weight: bold; text-align: left; padding: 0px 0px 0px 1px; border: 1px solid Transparent;" data-i18n-title="gearDef" data-i18n="gearDef1">Strength +8 items or</label>
			<label style="display: inline-block; vertical-align: top; height: 12px; width: 132px; color: White; margin: -6px 0px 2px 0px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 9px; font-weight: bold; text-align: left; padding: 0px 0px 0px 1px; border: 1px solid Transparent;" data-i18n-title="gearDef" data-i18n="gearDef2">DR +2 Agility / Strength tests</label>
		</div>
		<div style="display: inline-block; vertical-align: top; height: 58px; width: 144px; margin: 4px 0px 2px 0px; border: 2px solid Transparent;">
			<label style="display: inline-block; vertical-align: top; height: 22px; width: 144px; color: Black; margin:  6px 0px 2px 2px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 28px; font-weight: bold; text-align: center; padding: 4px 0px 0px 2px; border: 1px solid Transparent;" data-i18n="gold-c">Gold</label>
			<input type="text" name="attr_gold" class="sheet-profileInput" style="width:  134px; height: 26px; text-align: center; margin: -8px 0px 0px 10px; border-bottom: 2px solid Black;" value="">
		</div>
		<input type="text" name="attr_gl1" class="sheet-profileInput" style="width: 138px; height: 22px; margin: 0px; padding: 0px 2px 1px 3px; background-color: transparent; border: 1px solid transparent;" value="Satchel">
		<input type="checkbox" name='attr_glenc1' class="gearCheck" value="1" data-i18n-title="normalSizeItem?-c" />
		<input type="text" name="attr_gr1" class="sheet-profileInput" style="width: 136px; height: 22px; margin: 0px 0px 0px 8px; padding: 0px 2px 1px 3px; background-color: transparent; border: 1px solid transparent;" value="">
		<input type="checkbox" name='attr_grenc1' class="gearCheck"   style="margin: 6px 2px 0px 0px;" value="1" data-i18n-title="normalSizeItem?-c" />

		<input type="text" name="attr_gl2" class="sheet-profileInput" style="width: 138px; height: 23px; margin: -2px 0px 0px 0px; padding: 0px 2px 1px 3px; background-color: transparent; border: 1px solid transparent;" value="Water/Rations 3 day">
		<input type="checkbox"  name='attr_glenc2'  class="gearCheck" value="1" data-i18n-title="normalSizeItem?-c" />
		<input type="text" name="attr_gr2" class="sheet-profileInput" style="width: 136px; height: 23px; margin: -2px 0px 0px 8px; padding: 0px 2px 1px 3px; background-color: transparent; border: 1px solid transparent;" value="">
		<input type="checkbox" name='attr_grenc2' class="gearCheck"   style="margin: 6px 2px 0px 0px;" value="1" data-i18n-title="normalSizeItem?-c" />

		<input type="text" name="attr_gl3" class="sheet-profileInput" style="width: 138px; height: 22px; margin: -2px 0px 0px 0px; padding: 0px 2px 1px 3px; background-color: transparent; border: 1px solid transparent;" value="Bedroll">
		<input type="checkbox"  name='attr_glenc3'  class="gearCheck" value="1" data-i18n-title="normalSizeItem?-c" />
		<input type="text" name="attr_gr3" class="sheet-profileInput" style="width: 136px; height: 22px; margin: -2px 0px 0px 8px; padding: 0px 2px 1px 3px; background-color: transparent; border: 1px solid transparent;" value="">
		<input type="checkbox" name='attr_grenc3' class="gearCheck"   style="margin: 6px 2px 0px 0px;" value="1" data-i18n-title="normalSizeItem?-c" />

		<input type="text" name="attr_gl4" class="sheet-profileInput" style="width: 138px; height: 23px; margin: -2px 0px 0px 0px; padding: 0px 2px 1px 3px; background-color: transparent; border: 1px solid transparent;" value="Flint and steel">
		<input type="checkbox"  name='attr_glenc4'  class="gearCheck" value="1" data-i18n-title="normalSizeItem?-c" />
		<input type="text" name="attr_gr4" class="sheet-profileInput" style="width: 136px; height: 23px; margin: -2px 0px 0px 8px; padding: 0px 2px 1px 3px; background-color: transparent; border: 1px solid transparent;" value="">
		<input type="checkbox" name='attr_grenc4' class="gearCheck"   style="margin: 6px 2px 0px 0px;" value="1" data-i18n-title="normalSizeItem?-c" />

		<input type="text" name="attr_gl5" class="sheet-profileInput" style="width: 138px; height: 22px; margin: -2px 0px 0px 0px; padding: 0px 2px 1px 3px; background-color: transparent; border: 1px solid transparent;" value="50ft rope">
		<input type="checkbox"  name='attr_glenc5'  class="gearCheck" value="1" data-i18n-title="normalSizeItem?-c" />
		<input type="text" name="attr_gr5" class="sheet-profileInput" style="width: 136px; height: 22px; margin: -2px 0px 0px 8px; padding: 0px 2px 1px 3px; background-color: transparent; border: 1px solid transparent;" value="">
		<input type="checkbox" name='attr_grenc5' class="gearCheck"   style="margin: 6px 2px 0px 0px;" value="1" data-i18n-title="normalSizeItem?-c" />

		<input type="text" name="attr_gl6" class="sheet-profileInput" style="width: 138px; height: 23px; margin: -2px 0px 0px 0px; padding: 0px 2px 1px 3px; background-color: transparent; border: 1px solid transparent;" value="2 torches">
		<input type="checkbox"  name='attr_glenc6'  class="gearCheck" value="1" data-i18n-title="normalSizeItem?-c" />
		<input type="text" name="attr_gr6" class="sheet-profileInput" style="width: 136px; height: 23px; margin: -2px 0px 0px 8px; padding: 0px 2px 1px 3px; background-color: transparent; border: 1px solid transparent;" value="">
		<input type="checkbox" name='attr_grenc6' class="gearCheck"   style="margin: 6px 2px 0px 0px;" value="1" data-i18n-title="normalSizeItem?-c" />

		<input type="text" name="attr_gl7" class="sheet-profileInput" style="width: 138px; height: 22px; margin: -2px 0px 0px 0px; padding: 0px 2px 1px 3px; background-color: transparent; border: 1px solid transparent;" value="">
		<input type="checkbox"  name='attr_glenc7'  class="gearCheck" value="1" data-i18n-title="normalSizeItem?-c" />
		<input type="text" name="attr_gr7" class="sheet-profileInput" style="width: 136px; height: 22px; margin: -2px 0px 0px 8px; padding: 0px 2px 1px 3px; background-color: transparent; border: 1px solid transparent;" value="">
		<input type="checkbox" name='attr_grenc7' class="gearCheck"   style="margin: 6px 2px 0px 0px;" value="1" data-i18n-title="normalSizeItem?-c" />

		<input type="text" name="attr_gl8" class="sheet-profileInput" style="width: 138px; height: 23px; margin: -2px 0px 0px 0px; padding: 0px 2px 1px 3px; background-color: transparent; border: 1px solid transparent;" value="">
		<input type="checkbox"  name='attr_glenc8'  class="gearCheck" value="1" data-i18n-title="normalSizeItem?-c" />
		<input type="text" name="attr_gr8" class="sheet-profileInput" style="width: 136px; height: 23px; margin: -2px 0px 0px 8px; padding: 0px 2px 1px 3px; background-color: transparent; border: 1px solid transparent;" value="">
		<input type="checkbox" name='attr_grenc8' class="gearCheck"   style="margin: 6px 2px 0px 0px;" value="1" data-i18n-title="normalSizeItem?-c" />

		<input type="checkbox" class="sheet-block-switch" name="attr_block_switch" style="display: none;" value="1">
		<div class="sheet-block-a">
			<!-- Devil's Luck -->
			<button class="sheet-profileInput" type="action" name="act_devilsLuck" style="display: inline-block; vertical-align: top; height: 22px; width: 140px; color: Black; margin: 0px 0px 0px -4px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 22px; font-weight: bold; text-align: left; padding: 2px 0px 0px 2px; border: 1px solid transparent;" value="&{template:check} {{name=@{character_name} *requests Devil's Luck*}}" data-i18n-title="devil'sLuck-c">
				<label style="display: inline-block; vertical-align: top; height: 22px; width: 294px; color: Black; margin:  0px 0px 2px 0px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 26px; font-weight: normal; text-align: left; padding: 6px 0px 0px 2px; border: 1px solid Transparent;" data-i18n="devil'sLuck-c">Devil's Luck</label></button>
			<input type="text" name="attr_luck" class="sheet-profileInput" style="width:  30px; height: 40px; font-size: 22px; text-align: center; margin: 44px 0px 0px -90px; padding: 4px 0px 0px 0px; border: 1px solid transparent; background-color: transparent" value="3">
			<div style="height:130px; width: 186px; margin: -78px 0px 0px 126px; opacity: 0.9; border: 0px solid Red;">
				<label style="display: inline-block; vertical-align: top; height: 14px; width: 180px; color: Black;   margin:  0px 0px 2px 2px; font-style: normal; font-size: 10px; font-weight: normal; text-align: left; padding: 4px 0px 0px 4px; background-color: rgba(255,255,255,0.6); border: 0px solid Green;" data-i18n="lowerDR">Lower the DR on a roll by 2 before the roll</label>
				<label style="display: inline-block; vertical-align: top; height: 14px; width: 180px; color: DarkRed; margin:  0px 0px 2px 2px; font-style: bold;   font-size: 12px; font-weight: normal; text-align: left; padding: 4px 0px 0px 4px; border: 0px solid Green;" data-i18n="activateDarkPower">Activate a Dark Power</label>
				<label style="display: inline-block; vertical-align: top; height: 14px; width: 120px; color: DarkRed; margin:  0px 0px 2px 2px; font-style: bold;   font-size: 12px; font-weight: normal; text-align: left; padding: 4px 0px 0px 4px; background-color: rgba(255,255,255,0.8); border: 0px solid Green;" data-i18n="dealMaximumDamage-c">Deal Maximum Damage</label>
				<label style="display: inline-block; vertical-align: top; height: 14px; width: 134px; color: DarkRed; margin:  0px 0px 2px 2px; font-style: bold;   font-size: 12px; font-weight: normal; text-align: left; padding: 4px 0px 0px 4px; background-color: rgba(255,255,255,0.8); border: 0px solid Green;" data-i18n="neutralizeACritOrFumble">Neutralize a Crit or Fumble</label>
				<label style="display: inline-block; vertical-align: top; height: 14px; width: 168px; color: DarkRed; margin:  0px 0px 2px 2px; font-style: bold;   font-size: 12px; font-weight: normal; text-align: left; padding: 4px 0px 0px 4px; background-color: rgba(255,255,255,0.8); border: 0px solid Green;" data-i18n="re-rollAnyRoll,yoursOrAnother's">Re-roll any roll, yours or another's</label>
				<label style="display: inline-block; vertical-align: top; height: 14px; width: 150px; color: DarkRed; margin:  0px 0px 2px 2px; font-style: bold;   font-size: 12px; font-weight: normal; text-align: left; padding: 4px 0px 0px 4px; background-color: rgba(255,255,255,0.8); border: 0px solid Green;" data-i18n="ignoreAllDamageDealtToYou">Ignore all damage dealt to you</label>
			</div>
		</div>
		<div class="sheet-block-b">
			<div style="height:130px; width: 300px; margin: 0px 0px 0px 0px; background-color: White; opacity: 0.9; border: 1px solid transparent;"> 
				<button class="sheet-profileInput" type="action" name="act_morale" style="display: inline-block; vertical-align: top; height: 26px; width: 100px; color: White; background-color: Black; margin: 12px 0px 2px 20px; font-family: UnifrakturCook; font-style: normal; font-size: 28px; font-weight: bold; text-align: left; padding: 0px 0px 0px 0px; border: 1px solid Transparent;" data-i18n-title="moraleDefn">
					<label style="display: inline-block; vertical-align: top; height: 28px; width: 108px; color: Black; background-color: White; padding: 0px 6px 0px 0px; margin: -1px 0px 0px -2px; border: none;" data-i18n="morale-c">Morale</label> </button>
				<div class="compendium-drop-target monsters" style="display: inline-block; vertical-align: top; ">
					<input type="text" name="attr_morale" accept="Morale" class="sheet-profileInput" style="display: inline-block; vertical-align: top; width: 60px; height: 30px; font-size: 22px; font-style: bold; text-align: center; margin: 4px 0px 0px 20px; border: 2px solid Black;" value="">
				</div>
				<div class="sheet-body" style="height: 88px; width: 320px; background-color: White; margin: -2px 0px 0px 8px; border: 2px solid Black;">
					<div class="compendium-drop-target monsters" style="display: inline-block; vertical-align: top; ">
						<textarea name="attr_special" accept="Special" spellcheck="false" rows=4 cols=120 style="height: 88px; margin: -2px 0px 0px -2px; padding: 2px 1px 1px 4px; font-size: 12px; line-height: 14px; background-color: transparent;" placeholder="Special">
						</textarea>
					</div>
				</div>
			</div>
		</div>			
	</div>
	<input type="checkbox" class="sheet-block-switch" style="margin: 0px 0px 0px 0px;" name="attr_block_switch" value="1">
	<div class="sheet-block-a">
		<!-- Extras -->
		<div class="Archetype">
			<div style="display: inline-block; vertical-align: top; height: 230px; width: 820px; background-color: White; margin: 6px 0px 0px -12px; border: 2px solid DimGray;"  >

				<label style="display: inline-block; vertical-align: top; height: 22px; width: 50px; color: Black; margin: 8px 0px 2px 12px; font-family: UnifrakturMaguntia; font-size: 16px; padding-top: 9px; border: 1px solid Transparent;" data-i18n="benefit:-c">Benefit:</label>
				<textarea name="attr_Benefit" class="sheet-profileInput" style="width: 740px; height: 44px; font-size: 16px; font-weight: 500; margin-top: 4px; padding: 2px; background-color: transparent; border: 1px solid Black;" readonly value=""></textarea>

				<label style="display: inline-block; vertical-align: top; height: 22px; width: 26px; color: Black; margin: -6px 0px 2px 12px; font-family: UnifrakturMaguntia; font-size: 16px; padding-top: 9px; border: 1px solid Transparent;" data-i18n="kit:-c">Kit:</label>
				<input type="text" name="attr_Kit" class="sheet-profileInput" style="width: 140px; margin-top: -2px; padding: 2px; background-color: transparent; border: 1px solid Black;" readonly value="">
				<input type="text" name="attr_KitDesc" class="sheet-profileInput" style="width: 626px; font-size: 12px; font-weight: 400; margin-top: -2px; padding: 2px; background-color: transparent; border: 1px solid Black;" readonly value="">
				<input type="text" name="attr_Kit2" class="sheet-profileInput" style="width: 140px; margin: -6px 0px 0px 49px; padding: 2px; background-color: transparent; border: 1px solid Black;" readonly value="">
				<input type="text" name="attr_Kit2Desc" class="sheet-profileInput" style="width: 626px; font-size: 12px; font-weight: 400; margin: -6px 0px 0px -4px; padding: 2px; background-color: transparent; border: 1px solid Black;" readonly value="">

				<label style="display: inline-block; vertical-align: top; height: 22px; width: 50px; color: Black; margin: 0px 0px 2px 12px; font-family: UnifrakturMaguntia; font-size: 16px; padding-top: 7px; border: 1px solid Transparent;" data-i18n="secret:-c">Secret:</label>
				<input type="text" name="attr_Secret" class="sheet-profileInput" style="width: 740px; font-size: 16px; font-weight: 500; margin-top: 4px; padding: 2px; background-color: transparent; border: 1px solid Black;" value="">


				<label class="sheet-profileInput" style="display: inline-block; vertical-align: top; height: 20px; width: 220px; color: Black; background-color: rgba(136, 79, 0, 0.7); margin: 8px 0px 2px 30px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 16px; font-weight: normal; text-align: center; padding: 2px 0px 0px 2px; border: 0px solid Purple;" data-i18n="yourCharacterIs:">Your character is:</label>
				<input type="text" name="attr_characterTrait" class="sheet-profileInput" style="width:  120px; height: 26px; margin: 8px 0px 0px -4px; padding: 2px; border-bottom: 0px solid Red;" value="">

				<label class="sheet-profileInput" style="display: inline-block; vertical-align: top; height: 20px; width: 220px; color: Black; background-color: rgba(136, 79, 0, 0.4); margin: 8px 0px 2px 10px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 16px; font-weight: normal; text-align: center; padding: 2px 0px 0px 2px; border: 0px solid Purple;" data-i18n="additionalSkills:-c">Additional skills:</label>
				<input type="text" name="attr_additionalSkills" class="sheet-profileInput" style="width:  120px; height: 26px; margin: 8px 0px 0px -4px; padding: 2px; border-bottom: 0px solid Red;" value="">

				<label class="sheet-profileInput" style="display: inline-block; vertical-align: top; height: 20px; width: 220px; color: Black; background-color: rgba(136, 79, 0, 0.7); margin: 2px 0px 2px 30px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 16px; font-weight: normal; text-align: center; padding: 2px 0px 0px 2px; border: 0px solid Purple;" data-i18n="yourCharacterWants:">Your character wants:</label>
				<input type="text" name="attr_characterDesire" class="sheet-profileInput" style="width:  120px; height: 26px; margin: 0px 0px 0px -4px; padding: 2px; border-bottom: 0px solid Red;" value="">

				<label class="sheet-profileInput" style="display: inline-block; vertical-align: top; height: 20px; width: 220px; color: Black; background-color: rgba(136, 79, 0, 0.4); margin: 2px 0px 2px 10px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 16px; font-weight: normal; text-align: center; padding: 2px 0px 0px 2px; border: 0px solid Purple;" data-i18n="passions:-c">Passions:</label>
				<input type="text" name="attr_passions" class="sheet-profileInput" style="width:  120px; height: 26px; margin: 0px 0px 0px -4px; padding: 2px; border-bottom: 0px solid Red;" value="">

				<label class="sheet-profileInput" style="display: inline-block; vertical-align: top; height: 20px; width: 220px; color: Black; background-color: rgba(136, 79, 0, 0.7); margin: 2px 0px 2px 30px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 16px; font-weight: normal; text-align: center; padding: 2px 0px 0px 2px; border: 0px solid Purple;" data-i18n="yourCharacter'sSetback:">Your character's setback:</label>
				<input type="text" name="attr_characterSetback" class="sheet-profileInput" style="width:  120px; height: 26px; margin: 0px 0px 0px -4px; padding: 2px; border-bottom: 0px solid Red;" value="">

				<label class="sheet-profileInput" style="display: inline-block; vertical-align: top; height: 20px; width: 220px; color: Black; background-color: rgba(136, 79, 0, 0.4); margin: 2px 0px 2px 10px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 16px; font-weight: normal; text-align: center; padding: 2px 0px 0px 2px; border: 0px solid Purple;" data-i18n="notablePhysicalAttribute:-c">Notable Physical Attribute:</label>
				<input type="text" name="attr_notablePhysicalAttribute" class="sheet-profileInput" style="width:  120px; height: 26px; margin: 0px 0px 0px -4px; padding: 2px; border-bottom: 0px solid Red;" value="">

			</div>
		</div>
	</div>
	<div class="sheet-block-b">
	</div>
	<!-- Footnote Buttons -->
	<div style="display: inline-block; vertical-align: top; height: 60px; width: 817px; margin: 6px 0px 0px -10px; border: 2px solid Brown;">
		<button class="sheet-profileInput" type="action" name="act_initiative" style="display: inline-block; vertical-align: top; height: 20px; width: 140px; color: Black; background-color: LightSalmon; margin: 2px 0px 2px 120px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 16px; font-weight: normal; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" value="&{template:check} {{name=@{character_name}}}" data-i18n-title="initiativeDef-c">
			<label style="text-align: center;" data-i18n="initiative-c">Initiative</label> </button>
		<button class="sheet-profileInput" type="action" name="act_nightRest" style="display: inline-block; vertical-align: top; height: 20px; width: 140px; color: Black; background-color: rgba(235, 223, 199, 0.9); margin: 2px 0px 2px 70px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 16px; font-weight: normal; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" value="&{template:check} {{name=@{character_name}}}" data-i18n-title="nightRest-c" >
			<label style="text-align: center;" data-i18n="nightRest-c">Night Rest</label> </button>
		<button class="sheet-profileInput" type="action" name="act_shortRest" style="display: inline-block; vertical-align: top; height: 20px; width: 140px; color: Black; background-color: rgba(235, 223, 199, 0.9); margin: 2px 0px 2px 70px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 16px; font-weight: normal; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" value="&{template:check} {{name=@{character_name}}}" data-i18n-title="shortRest-c" >
			<label style="text-align: center;" data-i18n="shortRest-c">Short Rest</label> </button>
		<br />
		<button class="sheet-profileInput" type="action" name="act_wound" style="display: inline-block; vertical-align: top; height: 20px; width: 140px; color: Black; background-color: rgba(136, 79, 0, 0.4); margin: 2px 0px 2px 120px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 16px; font-weight: normal; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" value="&{template:check} {{name=@{character_name}}}" data-i18n-title="wickedWound-c">
			<label style="text-align: center;" data-i18n="wickedWound-c">Wicked Wound</label> </button>
		<button class="sheet-profileInput" type="action" name="act_darkpower" style="display: inline-block; vertical-align: top; height: 20px; width: 140px; color: Black; background-color: FireBrick; margin: 2px 0px 2px 70px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 16px; font-weight: normal; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" value="&{template:check} {{name=@{character_name}}}">
			<label style="text-align: center;" data-i18n="darkPower-c">Dark Power</label> </button>
		<button class="sheet-profileInput" type="action" name="act_broken" style="display: inline-block; vertical-align: top; height: 20px; width: 140px; color: Black; background-color: FireBrick; margin: 2px 0px 2px 70px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 16px; font-weight: normal; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" value="&{template:check} {{name=@{character_name}}}" >
			<label style="text-align: center;" data-i18n="broken-c">Broken</label> </button>
		<br />
		<input type="checkbox" name='attr_isGM'  id="isGM" class="sheet-toggle-show" style="display: none">
		<div class="sheet-body" style="position: absolute; z-index: 2; height: 60px; width: 810px; background-color: White; margin: 0px 0px 0px 8px; border: 2px solid Black;">
			<button class="sheet-profileInput" type="action" name="act_search" style="display: inline-block; vertical-align: top; height: 20px; width: 140px; color: Black; background-color: rgba(136, 79, 0, 0.7); margin: 2px 0px 2px 10px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 16px; font-weight: normal; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" value="&{template:check} {{name=@{character_name}}} {{Search=[[1d6*10+1d6]]}}" >
				<label style="text-align: center;" data-i18n="searchTheBody-c">Search The Body</label> </button>
			<button class="sheet-profileInput" type="action" name="act_weather" style="display: inline-block; vertical-align: top; height: 20px; width: 140px; color: Black; background-color: rgba(136, 79, 0, 0.4); margin: 2px 0px 2px 10px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 16px; font-weight: normal; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" value="&{template:check} {{name=@{character_name}}}" >
				<label style="text-align: center;" data-i18n="weather-c">Weather</label> </button>
			<button class="sheet-profileInput" type="action" name="act_road" style="display: inline-block; vertical-align: top; height: 20px; width: 140px; color: Black; background-color: rgba(136, 79, 0, 0.4); margin: 2px 0px 2px 10px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 16px; font-weight: normal; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" value="&{template:check} {{name=@{character_name}}}">
				<label style="text-align: center;" data-i18n="onTheRoad-c">On The Road</label> </button>
			<br />
			<button class="sheet-profileInput" type="action" name="act_animal" style="display: inline-block; vertical-align: top; height: 20px; width: 140px; color: Black; background-color: rgba(235, 223, 199, 0.9); margin: 2px 0px 2px 10px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 16px; font-weight: normal; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" value="&{template:check} {{name=@{character_name}}}" >
				<label style="text-align: center;" data-i18n="huntAnimal-c">Hunt Animal</label> </button>
			<button class="sheet-profileInput" type="action" name="act_huntingMishap" style="display: inline-block; vertical-align: top; height: 20px; width: 140px; color: Black; background-color: rgba(235, 223, 199, 0.9); margin: 2px 0px 2px 10px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 16px; font-weight: normal; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" value="&{template:check} {{name=@{character_name}}}" >
				<label style="text-align: center;" data-i18n="huntingMishap-c">Hunting Mishap</label> </button>
			<button class="sheet-profileInput" type="action" name="act_enemies" style="display: inline-block; vertical-align: top; height: 20px; width: 140px; color: Black; background-color: rgba(136, 79, 0, 0.8); margin: 2px 0px 2px 10px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 16px; font-weight: normal; text-align: center; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" value="&{template:check} {{name=@{character_name}}}">
				<label style="text-align: center;" data-i18n="enemies-c">Enemies</label> </button>
		</div>
	</div>
</div>

<!-- Roll Templates -->
<rolltemplate class="sheet-rolltemplate-initiative">
    <div class="container">
        <div><h1>Initiative *for* {{name}}</h1></div>
		<div class="arrow-container"><div class="arrow-right"></div></div>
		<div class="rowcolor"><span class="tcat">Rolled: </span>{{computed::roll1}}</div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-warDie">
    <div class="container">
        <div><h1>War Die *for* {{name}}: {{Roll}}</h1></div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-check">
    <div class="container">
<!--        <div><h1>{{name}}{{#SkillName}} *for* {{SkillName}}{{/SkillName}}</h1></div> -->
        <div><h1>{{name}}{{#SkillName}}<span class="tcat" data-i18n="for-l"> *for* </span> {{SkillName}}{{/SkillName}}</h1></div>
		<div class="arrow-container"><div class="arrow-right"></div></div>

		{{#DR}}
			<div class="rowcolor"><span class="tcat" data-i18n="roll:-c">Roll: </span>{{Roll}}</div>
			<div class="rowcolor"><span class="tcat">DR: </span>{{DR}}</div>
			{{#rollLess() computed::Roll DR }}
				<div class="rowcolor"><span class="tcat" data-i18n="result-c">Result: </span><span data-i18n="failure-c">Failure</span></div>
				{{#Failure}}
					<div class="rowcolor" style="font-size: 0.75em; line-height: 0.9em;">{{Failure}}</div>
				{{/Failure}}
			{{/rollLess() computed::Roll DR }}
			{{#^rollLess() computed::Roll DR }}
				<div class="rowcolor"><span class="tcat" data-i18n="result-c">Result: </span><span data-i18n="success-c">Success!</span></div>
				{{#Success}}
					<div class="rowcolor" style="font-size: 0.75em; line-height: 0.9em;">{{Success}}</div>
				{{/Success}}
				{{#Damage}}
					<div class="rowcolor"><span class="tcat" data-i18n="damage:-c">Damage: </span>{{computed::Damage}}</div>
				{{/Damage}}
			{{/^rollLess() computed::Roll DR }}

			{{#rollGreater() computed::Crit 0 }}
				<div class="rowcolor"><span class="tcat" data-i18n="alert:-c">Alert: </span><span style="color: Red; font-weight: bold;" data-i18n="critical-c" >Critical!!</span></div>
<!--				<div class="rowcolor"><span class="tcat" data-i18n="choose2xDamageOr">Choose 2x Damage or </span></div> -->
				<div class="rowcolor">{{computed::Outcome}}</div>
			{{/rollGreater() computed::Crit 0 }}
			{{#rollGreater() computed::Fumble 0 }}
				<div class="rowcolor"><span class="tcat" data-i18n="alert:-c">Alert: </span><span style="color: Red; font-weight: bold;" data-i18n="fumble-c" >Fumble</span></div>
				<div class="rowcolor">{{computed::Outcome}}</div>
			{{/rollGreater() computed::Fumble 0 }}
		{{/DR}}
		{{#Absorb}}
			<div class="rowcolor"><span class="tcat" data-i18n="absorb:-c">Absorb: </span>{{Absorb}}</div>
		{{/Absorb}}
		{{#SpellPrep}}
			<div class="rowcolor"><span class="tcat" data-i18n="prepares:-c">Prepares: </span>{{SpellPrep}}</div>
		{{/SpellPrep}}
		{{#Misfire}}
			<div class="rowcolor"><span class="tcat" data-i18n="misfire:-c">Misfire: </span>{{computed::Misfire}}</div>
			{{#rollTotal() computed::Misfire 1 }}
<!--				<div class="rowcolor"><span class="tcat" data-i18n="result-c">Result: </span><span style="color: Red; font-weight: bold;" data-i18n="explodesRollD6">EXPLODES!! Roll d6</span></div> -->
				<div class="rowcolor"><span class="tcat" data-i18n="result-c">Result: </span>[<span data-i18n="explodes!!-u"></span>](~selected|misfireDamage)</div>
<!--				<div class="rowcolor"><span class="tcat" data-i18n="result-c">Result: </span><span style="color: Red; font-weight: bold;" data-i18n="explodes!!-u">EXPLODES!!</span>[<span data-i18n="misfire-u"></span>](~selected|misfireDamage)</div> -->
<!--            <div>
                <div class="template-button">
                  [<span data-i18n="misfire-u"></span>](~@{character_name}|misfireDamage)
				</div>
            </div>
-->
			{{/rollTotal() computed::Misfire 1 }}
			{{#rollTotal() computed::Misfire 2 }}
				<div class="rowcolor"><span class="tcat" data-i18n="result-c">Result: </span><span style="font-weight: bold;" data-i18n="misfire-u">MISFIRE</span></div>
			{{/rollTotal() computed::Misfire 2 }}
		{{/Misfire}}
		{{#MisfireDamage}}
			<div class="rowcolor"><span class="tcat" data-i18n="damage:-c">Damage: </span>{{MisfireDamage}}</div>
		{{/MisfireDamage}}
		{{#Luck}}
			<div class="rowcolor"><span class="tcat" data-i18n="luck:-c">Luck: </span>{{computed::Luck}}</div>
			{{#rollTotal() computed::Luck 1 }}
				<div class="rowcolor"><span class="tcat" data-i18n="result-c">Result: </span><span data-i18n="failure-c">Failure</span></div>
			{{/rollTotal() computed::Luck 1 }}
			{{#^rollTotal() computed::Luck 1 }}
				<div class="rowcolor"><span class="tcat" data-i18n="result-c">Result: </span><span data-i18n="success-c">Success!</span></div>
			{{/^rollTotal() computed::Luck 1 }}
		{{/Luck}}
		{{#NoAmmo}}
			<div class="rowcolor"><span class="tcat" style="font-weight: bold;" data-i18n="weaponOutOfAmmo-c">Weapon Out Of Ammo</span></div>
		{{/NoAmmo}}		
 		{{#NoSpell}}
			<div class="rowcolor"><span class="tcat" style="font-weight: bold;" data-i18n="spellCapacityExhausted!-c">Spell Capacity Exhausted!</span></div>
		{{/NoSpell}}
		{{#Morale}}
			<div class="rowcolor"><span class="tcat" data-i18n="roll:-c">Roll: </span>{{Roll}}</div>
			<div class="rowcolor"><span class="tcat">Morale: </span>{{Morale}}</div>
			{{#rollGreater() computed::Roll Morale }}
				<div class="rowcolor"><span class="tcat" data-i18n="result-c">Result: </span><span data-i18n="failure-c">Failure</span></div>
			{{/rollGreater() computed::Roll Morale }}
			{{#^rollGreater() computed::Roll Morale }}
				<div class="rowcolor"><span class="tcat" data-i18n="result-c">Result: </span><span data-i18n="success-c">Success!</span></div>
			{{/^rollGreater() computed::Roll Morale }}
		{{/Morale}}		
  		{{#Fanatic}}
			<div class="rowcolor"><span class="tcat" style="font-weight: bold;" data-i18n="WillNEVERFlee!">Will NEVER Flee!</span></div>
		{{/Fanatic}}
   </div>
</rolltemplate>


<script type="text/worker">
	
var SpecialHasBeenParsedSoNoInfiniteLoop = 0;

on("sheet:opened", function(eventInfo){
    
	
	getAttrs(["setupDone"], function(pvalue) {
	console.log("Hello there");

	let SetupDone=parseInt(pvalue.setupDone);
	console.log("setupdone: "+SetupDone );
	
	SpecialHasBeenParsedSoNoInfiniteLoop = 0;
	
	if (SetupDone==0){
		console.log("Do setup");
		setAttrs({setupDone:1});
	}	
  });    
});

	on('change:health_max sheet:opened', () => {
			getAttrs(['health_max'], values => {
					const output = {};
					const max = +values.health_max || 0;
					for(let n = 0; n <= 16; n++) {
							output[`toggle_health${n}`] = n <= max ? 1: 0;
					}
					//console.log(" output: " + JSON.stringify(output));
					setAttrs(output);
			});
	});

	function strncmp(str1, str2, n) {
	  // Extract the first 'n' characters from each string
	  const subStr1 = str1.substring(0, n);
	  const subStr2 = str2.substring(0, n);
		//console.log(" strncmp: " + subStr1 +  "   " +  subStr2 + " N " + n + " returns " + (subStr1 === subStr2) + ".");

	  // Compare the substrings lexicographically
	  if (subStr1 === subStr2) {
		return 0; // Strings are equal up to 'n' characters
	  } else if (subStr1 > subStr2) {
		return 1; // subStr1 is lexicographically greater than subStr2
	  } else {
		return -1; // subStr1 is lexicographically less than subStr2
	  }
	}
	
	on("change:isCompendium", function(eventInfo) {
		let NewValue = eventInfo.newValue;
		let OldValue = eventInfo.previousValue;
		let SourceAttribute = eventInfo.sourceAttribute;
		console.log(" isCompendium");
		console.log("   isCompendium SourceAttribute: " + SourceAttribute);
		console.log("   isCompendium NewValue: " + NewValue);
		
	
		if (NewValue != "") {
			getAttrs(["weapon1","weapon2","weapon3","drop_data","drop_name","drop_content","drop_category"], function(values) {
			    // don't do handling if this was changed by api or sheetworker
				//if(event.sourceType !== 'player') return;
				
				let SpecialMatchText = "";
				
				try{
					var data = JSON.parse(values.drop_data);
					const Drop_data = values.drop_data;
					var Drop_name = values.drop_name;
					const Drop_content = values.drop_content;
					const Drop_category = values.drop_category;
					console.log("   isCompendium data: " + data);
					for (const [key, value] of Object.entries(data)) {
						console.log(`${key}: ${value}`);
					}
					console.log("   isCompendium: end iteration");
					console.log("\n   isCompendium: 2nd iteration");
					
					const keys = Object.keys(data);
					console.log(" Keys: " + keys);

					for (let i = 0; i < keys.length; i++) {
						//console.log("        i = " + i + ": " + keys[i]);
						//console.log("           strncmp will return: " + strncmp(keys[i],"Special:", 8) + "!");
						let ThisValue = data[keys[i]];
						console.log("        Key " + keys[i] + " Value " + ThisValue);
						if (strncmp(keys[i],"Special:", 8) == 0) {
							console.log("       Match i = " + i + " - " + keys[i] + " : " + ThisValue) ;
							SpecialMatchText += keys[i].substring(9) + " - " + ThisValue + "\n";
							//console.log("        SpecialMatchText: " + SpecialMatchText) ;
						} 
					}
					console.log("   isCompendium: end 2nd iteration with SpecialMatchText:\n" + SpecialMatchText);
					

					console.log("   isCompendium data.Morale: " + data["Morale"]);
					console.log("   isCompendium Drop_data: " + Drop_data);
					console.log("   isCompendium Drop_name: " + Drop_name);
					console.log("   isCompendium Drop_content: " + Drop_content);
					console.log("   isCompendium Drop_category: " + Drop_category);
					if(data.Category == 'Monster'){
						console.log("   isCompendium data.Category: " + data.Category);
					  // monster processing
					}else if(data.Category === 'other category'){
					  // other category, conditional handling for each droppable category
					}
				}catch(err){
					console.log("   isCompendium drop_data - unable to parse ");
					// handling for if the data isn't correct
				}
				let Armour = data["Armour"];
				console.log("   isCompendium Armour: " + Armour);
				
				// Spells
				let Spells = data["Spells"];
				let NumSpell = "";
				let Spell1 = "", Spell2 = "", Spell3 = "";
				//let SpellDesc1 = "", SpellDesc2 = "", SpellDesc3 = "";
				let SpellDescription1 = "", SpellDescription2 = "", SpellDescription3 = "";
				let DisplaySpell1 = "0", DisplaySpell2 = "0", DisplaySpell3 = "0";

				
				console.log("   isCompendium Spells: " + Spells);
				if (Spells != undefined) {
					console.log("   isCompendium Spells: Welcome Mother Goethel");
					// Note: The spell list is not parsed to preserve the "Player must still need the Rulebook" guidance
					//   so just assume Mother Goethel loadout
					NumSpell = "99";
					Spell1 = "Spectral Skeletons", Spell2 = "Raise the Dead", Spell3 = "Death Glare";
					//SpellDesc1 = "", SpellDesc2 = "", SpellDesc3 = "";
					SpellDescription1 = "Summon d6 spectral skeletons"
					SpellDescription2 = "You may raise a recently dead corpse to fight for you. They retain their original stats, but only half their HP. Unless slain, it will fight for d4 rounds before collapsing in death again"
					SpellDescription3 = "All creatures you can see lose 4d12 HP";
					DisplaySpell1 = "1", DisplaySpell2 = "1", DisplaySpell3 = "1";
				}
				
				
				/* Specials:
					Special: Bounty (Captured)
					Special: Bounty (Dead)
					Special: Smiting Blow
					Special: Tests
					Special: Reload
					Special: Sustain
					Special: Bleed
					Special: Dizzying Fumes
					Special: Lashing Strike
					Special: Bashing Strike
					Special: Branding Blow
					Special: Spell Resistance
					Special: Disorient
					Special: Rusty Implements
					Special: Lumbering Swing
					Special: Chilling Touch
					Special: Quasi-Incorporeal
					Special: Hidden
					Special: Sleeping Dust
					Special: Curse Belch
					Special: Cry
					Special: Snap Crack
					Special: Wild Strike
					Special: Devil's Flame
					Special: Enthral
					Special: Summon
					Special: Invisiblity
					Special: True Form
					Special: Buffered Attack
					Special: Resistances
					Special: Cracked Mirror
					Special: Quick
					Special: Replicant
					Special: Absorption
					Special: The Bell Tolls
					Special: Proximity
					Special: Fire Fear
					Special: Strength in Numbers
					Special: Dispersion Threshold
					Special: All Target
					Special: No Defense
					Special: Infect
					Special: Size
					Special: Rotten Scythe
					Special: Rusted Axe
					Special: Star-forged Rifle
					Special: Bottle of Fog
					Special: Grappling Hook Crossbow
					Special: Summon Rat Swarm
					Special: Second Pistol
					Special: Silver Tounge
					Special: Lucky Bastard
					Special: Gelding Scissors
					Special: Invulnerable
					Special: Wrath of Purity
					Special: Blood Weeping Shield
					Special: Life Drain
					Special: Overwhelm
					Special: Stinging Grip
					Special: Sharp
					Special: Swift
					Special: Hardened Skin
					Special: Flailing Strike
					Special: Warp
					Special: Reality Tear
					Special: Last Word
					Special: Flight
					Special: Flack Jacketed
									
				*/
				/*
				console.log("   isCompendium Specials: ");
				let SpecialText = "";
				
				let SpecialTitle = "Special: Bounty (Captured)";
				let SpecialData = data[SpecialTitle];
				if (SpecialData != undefined) {
					console.log("    isCompendium Special: " +  SpecialTitle +  " - " + SpecialData);
					SpecialText += SpecialTitle + " - " + SpecialData + "\n";
				}
				
				SpecialTitle = "Special: Bounty (Dead)";
				SpecialData = data[SpecialTitle];
				if (SpecialData != undefined) {
					console.log("    isCompendium Special: " +  SpecialTitle +  " - " + SpecialData);
					SpecialText += SpecialTitle + " - " + SpecialData + "\n";
				}
				console.log("    isCompendium SpecialText = " + SpecialText) ;
				*/
				
				// Compensate for Rat Swarm
				let Morale = data["Morale"];
				let HP = data["HP"];
				let Size = 1;
				console.log("   isCompendium Morale: " + Morale + " HP: " + HP);
				if (Drop_name == "Rat Swarm") {
					Size = Math.floor(Math.random() * 40) + 20;
					HP = Size;
					Morale = Math.floor(Size/2);
					console.log("   isCompendium Rat Swarm Size: " + Size + " Morale: " + Morale + " HP: " + HP);
				} else if  (Drop_name == "Rat Swarm (Skulking)") {
					Size = Math.floor(Math.random() * 80) + 40;
					HP = Size;
					Morale = Math.floor(Size/2);
					console.log("   isCompendium Rat Swarm  (Skulking) Size: " + Size + " Morale: " + Morale + " HP: " + HP);
				} else if  (Drop_name == "Rat Swarm (Death)") {
					Size = Math.floor(Math.random() * 1400) + 180;
					HP = Size;
					Morale = Math.floor(Size/2);
					console.log("   isCompendium Rat Swarm (Death) Size: " + Size + " Morale: " + Morale + " HP: " + HP);
				} else if  (Drop_name == "Rat Swarm (Apocalypse)") {
					Size = Math.floor(Math.random() * 6660) + 1000;
					HP = Size;
					Morale = Math.floor(Size/2);
					console.log("   isCompendium Rat Swarm (Apocalypse) Size: " + Size + " Morale: " + Morale + " HP: " + HP);
				}
				console.log("   isCompendium after Rat Swarm check Morale: " + Morale + " HP: " + HP);
				// Remove Gear
				console.log("   isCompendium Remove Gear ");
				// 
				let Weapon1 = values.weapon1;
				let WeaponRanged1 = "0";
				let WeaponBlackPowder1 = "0";
				let Ammo1 = "";
				
				let Weapon2 = values.weapon2;
				let WeaponRanged2 = "0";
				let WeaponBlackPowder2 = "0";
				let Ammo2 = "";
				
				if ((Weapon1 == "Star-forged Rifle") || (Weapon1 == "Pistol")) {
					WeaponRanged1 = "1";
					WeaponBlackPowder1 = "1";
					Ammo1 = "12";
				}
				if ((Weapon2 == "Musket") || (Weapon2 == "Pistol")) {
					WeaponRanged2 = "1";
					WeaponBlackPowder2 = "1";
					Ammo2 = "12";
				}
				console.log("   isCompendium Weapon1: " + Weapon1 + " Ammo1 " + Ammo1 + " WeaponRanged1 " + WeaponRanged1 + " WeaponBlackPowder1 " + WeaponBlackPowder1 );
				console.log("   isCompendium Weapon2: " + Weapon2 + " Ammo2 " + Ammo2 + " WeaponRanged2 " + WeaponRanged2 + " WeaponBlackPowder2 " + WeaponBlackPowder2 );

				let Weapon3 = values.weapon3;
				let WeaponRanged3 = "0";
				let WeaponBlackPowder3 = "0";
				let Ammo3 = "";
				let WeaponDescription3 = "";
				let WeaponDamage3 = "";
				let WeaponSpecialRule3 = "";
				let WeaponCost3 = "";
				let Feat1 = ""; // Lord Flash
				let FeatDescription1 = "";

				if (Drop_name == "Carmen SanDominica") {
					console.log("   isCompendium Name: Welcome Carmen SanDominica");
					console.log("   isCompendium:      Weapon3", Weapon3);
					if (Weapon3 == "") {
						Weapon3 = "Hook Crossbow";
						WeaponRanged3 = "1";
						WeaponBlackPowder3 = "0";
						WeaponDescription3 = "The peak of precision weapons engineering.";
						WeaponCost3 = "60";
						WeaponDamage3 = "d2";
						Ammo3 = "1";
						WeaponSpecialRule3 = "A custom made crossbow will shoot a grappling hook and rope up to 30ft. The rope is light and can only support one person at a time";
					}
				} else if (Drop_name == "Lord Flash") {
					Feat1 = "3 Devil's Luck, per day";
					FeatDescription1 = "Lord Flash is favoured by fate like the players. He has his own 3DL points per day";
				}
				
			
				setAttrs({                            
					gl1: " ", gl2: " ", gl3: " ", gl4: " ", gl5: " ", gl6: " ", archetype: NewValue, block_switch: "1",
					hpCurrent: HP, hpMax: HP, morale: Morale, armour: Armour,
					spell1: Spell1, spell2: Spell2, spell3: Spell3, numSpell: NumSpell,
					spellDescription1: SpellDescription1, spellDescription2: SpellDescription2, spellDescription3: SpellDescription3,
					displaySpell1: DisplaySpell1, displaySpell2: DisplaySpell2, displaySpell3: DisplaySpell3,
					feat1: Feat1, FeatDescription1: FeatDescription1,
					special: SpecialMatchText,
					weaponRanged1: WeaponRanged1, weaponBlackPowder1: WeaponBlackPowder1, ammo1: Ammo1, 
					weaponRanged2: WeaponRanged2, weaponBlackPowder2: WeaponBlackPowder2, ammo2: Ammo2, 
					weapon3: Weapon3, weaponRanged3: WeaponRanged3, weaponBlackPowder3: WeaponBlackPowder3, ammo3: Ammo3, 
					weaponDescription3: WeaponDescription3, weaponDamage3: WeaponDamage3, weaponSpecialRule3: WeaponSpecialRule3, weaponCost3:WeaponCost3
				});
			});			
		}
	});
	
	on("change:hpCurrent", function(eventInfo) {
		let NewValue = eventInfo.newValue;
		let OldValue = eventInfo.previousValue;
		let SourceAttribute = eventInfo.sourceAttribute;
		console.log(" hpCurrent");
		console.log("   hpCurrent SourceAttribute: " + SourceAttribute);
		console.log("   hpCurrent NewValue: " + NewValue);
		
		getAttrs(["character_name","isCompendium","morale", "hpMax"], function(values) {
			let Name = values.character_name;
			let IsCompendium = values.isCompendium;
			let Morale = values.morale;
			let hpMax = parseInt(values.hpMax);

			console.log("   hpCurrent data: Name " + Name + " IsCompendium " + IsCompendium + " Morale " + Morale);
			if (IsCompendium != "" && (Name == "Rat Swarm" || Name == "Rat Swarm (Skulking)" || Name == "Rat Swarm (Death)" || Name == "Rat Swarm (Apocalypse)")) {
				let MaxMorale = Math.floor((parseInt(hpMax) || 0 )/ 2);
				console.log("   hpCurrent MaxMorale: " + MaxMorale );
				let Wound = hpMax - parseInt(NewValue)||0;
				console.log("   hpCurrent Wound " + Wound );
				let NewMorale = MaxMorale - Wound;
				if (NewMorale < 0) { NewMorale = 0;}
				console.log("   hpCurrent new Morale: NewMorale " + NewMorale );
				setAttrs({                            
					morale: String(NewMorale)
				});
			}
		});			
	});
	

	on("change:special", function(eventInfo) {
	/*
		console.log("  Test SpecialHasBeenParsedSoNoInfiniteLoop: " + SpecialHasBeenParsedSoNoInfiniteLoop);
		if (SpecialHasBeenParsedSoNoInfiniteLoop != 0) {
			console.log(" Avoiding Infinite Loop. SpecialHasBeenParsedSoNoInfiniteLoop = " + SpecialHasBeenParsedSoNoInfiniteLoop);
			return;
		}
		SpecialHasBeenParsedSoNoInfiniteLoop = 1;
		
		let NewValue = eventInfo.newValue;
		let OldValue = eventInfo.previousValue;
		let SourceAttribute = eventInfo.sourceAttribute;
		console.log(" special:  SourceAttribute: " + SourceAttribute);
		console.log(" special:  NewValue: " + NewValue);
		console.log(" special:   eventInfo: " + JSON.stringify(eventInfo));

		let Output = "";
		// Some sort of parser
		let idx = 0;
		let len = NewValue.length;
		
		//if (len > 300) { console.log(" Exceessive length detected: " + len); return};
		let Text = "";
		let Name = "";
		let Effect = "" ;
		let NameFlag = 1;
		let prevChar = '';
		console.log(" special:    NewValue length: " + len);
		while (idx < len) {
			let a = NewValue.charAt(idx);
			switch (a) {
				case '{':  break;
				case '}':  break;
				case '"':  break;
				case ':':  Text += String(a); NameFlag = 0; break;
				case '\\': break;
				case ',':  if (prevChar == '\"') {Text += String('\n'); NameFlag = 1; console.log(" special:    Name: " + Name + " Effect: " + Effect); Name = ""; Effect = "";}; break;
				default: 
					Text += String(a);
					if (NameFlag == 1) {
						Name += String(a);
					} else {
						Effect += String(a);
					}
			}
			if (a === ':') {
				Text += String(' ');
			}
			//console.log("    Text: " + Text + " Name: " + Name + " Effect: " + Effect);
			prevChar = a;
			idx++;
		}
		console.log(" special:     Text: " + Text + " Name: " + Name + " Effect: " + Effect);
		setAttrs({                            
					special: Text 
				});
	*/
	});

	on("change:ccStrAdv change:ccAgiAdv change:ccPreAdv change:ccTghAdv", function(eventInfo) {
		let NewValue = eventInfo.newValue;
		let OldValue = eventInfo.previousValue;
		let SourceAttribute = eventInfo.sourceAttribute;
		console.log(" SourceAttribute: " + SourceAttribute);
		console.log(" NewValue: " + NewValue);
		
		getAttrs(["ccStrAdv","ccAgiAdv","ccPreAdv","ccTghAdv"], function(values) {
			let StrAdv = parseInt(values.ccStrAdv)||0;
			let AgiAdv = parseInt(values.ccAgiAdv)||0;
			let PreAdv = parseInt(values.ccPreAdv)||0;
			let TghAdv = parseInt(values.ccTghAdv)||0;
			
			let Total = 0;
			if (StrAdv != 0) { Total += 1; }
			if (AgiAdv != 0) { Total += 1; }
			if (PreAdv != 0) { Total += 1; }
			if (TghAdv != 0) { Total += 1; }
			
			console.log ( " Total = " + Total); 


			if (Total == 3) {
				switch (SourceAttribute){
					case "ccstradv": StrAdv = 0; break;
					case "ccagiadv": AgiAdv = 0; break;
					case "ccpreadv": PreAdv = 0; break;
					case "cctghadv": TghAdv = 0; break;
					default: 
						console.log(" Unknown SourceAttribute: " + SourceAttribute);
				}			}			
			
			console.log("  StrAdv: " + StrAdv + "  AgiAdv: " + AgiAdv + "  PreAdv: " + PreAdv + "  TghAdv: " + TghAdv);
		
			setAttrs({                            
				ccStrAdv: StrAdv, ccAgiAdv: AgiAdv, ccPreAdv: PreAdv, ccTghAdv: TghAdv
			});
		});
	});

	function rollD2() {
	  return Math.floor(Math.random() * 2) + 1;
	}
	function rollD3() {
	  return Math.floor(Math.random() * 3) + 1;
	}	
	function rollD4() {
	  return Math.floor(Math.random() * 4) + 1;
	}	
	function rollD6() {
	  return Math.floor(Math.random() * 6) + 1;
	}	
	function rollD8() {
	  return Math.floor(Math.random() * 8) + 1;
	}
	function rollD10() {
	  return Math.floor(Math.random() * 10) + 1;
	}
	function rollD12() {
	  return Math.floor(Math.random() * 12) + 1;
	}	
	function rollD20() {
	  return Math.floor(Math.random() * 20) + 1;
	}		
	function roll4D6kh3() {
	  let r = [Math.floor(Math.random() * 6) + 1,Math.floor(Math.random() * 6) + 1,Math.floor(Math.random() * 6) + 1,Math.floor(Math.random() * 6) + 1,];
	  let lowest = r[0];
	  let sum = 0;

	  for (let i = 1; i < 4; i++) { 
		if (r[i] < lowest) {
			sum += lowest;
			lowest = r[i];
			/* console.log("  i="+ i + " sum=" + sum + " lowest=" + lowest + " r[i]=" + r[i]); */
		} else {
			sum += r[i];
			/* console.log("  i="+ i + " sum=" + sum + " lowest=" + lowest + " r[i]=" + r[i]); */
		}
	  }
 	  console.log("   r=" + r + "  sum=" + sum );
	  return sum;
	}
	
	function makeAbility(stat) {
	  let ability = -4;
	  if (stat < 5) { ability = -3; } 
       else if (stat < 7)   { ability = -2; }	  
       else if (stat < 9)   { ability = -1; }
	   else if (stat < 13)  { ability = 0; }	
       else if (stat < 15)  { ability = 1; }	  
       else if (stat < 17)  { ability = 2; }
	   else  { ability = 3; }	

	  return ability;
	}
	
on("change:archetype", function(eventInfo) {
		let NewValue = eventInfo.newValue;
		let OldValue = eventInfo.previousValue;
		let SourceAttribute = eventInfo.sourceAttribute;
		console.log(" SourceAttribute: " + SourceAttribute);
		console.log(" NewValue: " + NewValue);

		let StrAdjustment =  0;
		let AgiAdjustment =  0;
		let PreAdjustment =  0;
		let TghAdjustment =  0;
		let Wealth        =  (rollD6() + rollD6()) * 10;; // Baseline for Non Archetype
		
		let HPDie = 8;
		let HPAdjustment = 2;
		
		let Secret = "None";
		let SecretRoll = String(rollD6());
		let Benefit = "";
		
		let Gear1 = "";
		let Gear2 = "";
		let Gear3 = "";
		let Gear4 = "";
		let Gear5 = "";
		let Gear6 = "";
		let Gear7 = "";
		let Gear8 = "";
		let Gear1enc = 0;
		let Gear2enc = 0;
		let Gear3enc = 0;
		let Gear4enc = 0;
		let Gear5enc = 0;
		let Gear6enc = 0;
		let Gear7enc = 0;
		let Gear8enc = 0;
		
		let Kit = "";
		let KitDesc = "";
		let Kit2 = "";
		let Kit2Desc = "";
		
		let Armour = "";
		let Weapon1 = "";
		let Weapon1Ammo = "";
		let Weapon1Desc = "";
		let Weapon1Damage = "";
		let Weapon1Cost = "";
		let Weapon1Rule = "";
		let Weapon1Special = "";
		let Weapon1Ranged = "";
		let Weapon1BlackPowder = "";
		let Weapon2 = "";
		let Weapon2Ammo = "";
		let Weapon2Desc = "";
		let Weapon2Cost = "";
		let Weapon2Damage = "";
		let Weapon2Rule = "";
		let Weapon2Special = "";
		let Weapon2Ranged = "";
		let Weapon2BlackPowder = "";
	
		if ((NewValue == "Rifleman") || (NewValue == "Greatswordsman") || (NewValue == "Grenadier"))  {
			HPDie = 10;
			HPAdjustment = 0;
			StrAdjustment =  2;
			AgiAdjustment = -1;
			PreAdjustment = -1;
			TghAdjustment =  2;
			Wealth = (rollD6() + rollD6()) * 10;
			switch (SecretRoll) {
				case "1": Secret = "You saw something that will haunt you until you die: the savage ransacking of a town by you and your fellows."; break;
				case "2": Secret = "You saw something that will haunt you until you die: the massacre of your defeated company."; break;
				case "3": Secret = "You saw something that will haunt you until you die: your beloved commander ripped apart by a demon."; break;
				case "4": Secret = "You saw something that will haunt you until you die: stacks of corpses set alight, the flames billowing to the sky."; break;
				case "5": Secret = "You saw something that will haunt you until you die: your drunken comrades, beaten to death by farmers."; break;
				case "6": Secret = "You saw something that will haunt you until you die: your brother, executed for cowardice and desertion."; break;
				default: 
					RollType = "No Name"; console.log("  Archetype: " + NewValue + " Secret Anomoly: " + Secret);
			}
			if (NewValue == "Rifleman") {
				Benefit = "Shots with a musket get +2 at range.";
				Gear1 = "Musket";
				Gear1enc = 1;
				Gear2 = "10 rounds of shot";
				Gear3 = "One gunpowder pouch";
				Gear4 = "Bullet kit";
				Gear4enc = 1;
				Kit = "Bullet kit";
				KitDesc = "When at rest, you can make your own bullets from metal that you have about with the use of this small forge.";
				Weapon1 = "Musket";
				Weapon1Desc = "The peak of precision weapons engineering.";
				Weapon1Ammo = "10";
				Weapon1Damage = "d10+2";
				Weapon1Cost = "250";
				Weapon1Rule = "Shots with a musket get +2 at range.";
				Weapon1Special = "Although unwieldy in tight spots, a skilled marksman can hit a coin off the head of a conscript at fifty paces. +1 to hit and damage at range outside of melee, 1 to hit in melee range.";
				Weapon1Ranged = "1";
				Weapon1BlackPowder = "1";
			} else if (NewValue == "Greatswordsman") {
				Benefit = "Zweihander. Roll an extra d4 damage on a successful hit with Zweihander.";
				Gear1 = "Zweihander";
				Gear1enc = 1;
				Kit = "Flamboyant Clothes";
				KitDesc = "These garments are a sign of your martial skill and so will command respect amongst other men and women of war.";
				Weapon1 = "Zweihander";
				Weapon1Desc = "A mastercraft of workmanship, these enormous swords are known to be able to cleave a man in twain.";
				Weapon1Special = "A successful hit with a roll of 18+ leads to a creature that is man sized being sliced in half. Cumbersome. In a confined space, all attacks suffer a 2 to hit.";
				Weapon1Damage = "d10+d4";
				Weapon1Cost = "60";
				Weapon1Rule = "Roll an extra d4 damage on a successful hit with Zweihander.";
			} else {
				Benefit = "You may reroll a bomb malfunction dice, but you must keep the second roll.";
				Gear1 = "6 bombs";
				Gear2 = "2 gunpowder pouches";
				Gear3 = "Bomb Makers Kit";
				Gear1enc = 1;
				Gear3enc = 1;
				Kit = "Bomb Makers Kit";
				KitDesc = "While at rest, you may roll d4 to see how many bombs you make with the materials you have. This includes the gunpowder and wick. Best do this away from an open flame.";
				Weapon1 = "Bomb";
				Weapon1Desc = "A studded iron sphere, stuffed with gunpowder and a three second wick.";
				Weapon1Special = "4d6 damage to all creatures within a six feet radius. Roll d6 once lit: 2. A dud that fails to explode. 1. It explodes in your hand taking it clean off and dealing 2d6 damage to you.";
				Weapon1Ammo = "6";
				Weapon1Cost = "240";
				Weapon1Rule = "You may reroll a bomb malfunction dice, but you must keep the second roll.";
				Weapon1Ranged = "1";
				Weapon1BlackPowder = "1";
			}  
		} else if ((NewValue == "Pistolier") || (NewValue == "Master Trapper") || (NewValue == "Beast Hunter")){
			HPDie = 8;
			HPAdjustment = 0;
			StrAdjustment =  1;
			AgiAdjustment =  0;
			PreAdjustment =  2;
			TghAdjustment =  0;
			Wealth = (rollD6() + rollD6() + rollD6()) * 10;
			switch (SecretRoll) {
				case "1": Secret = "You will always remember the screams in the night as horrid laughter rang out."; break;
				case "2": Secret = "You will always remember the thrill of your first kill, your fathers proud hand on your shoulder."; break;
				case "3": Secret = "You will always remember eyes watching you from the forest, burning and hungry."; break;
				case "4": Secret = "You will always remember the glimmer of the coins handed to you for your first bounty."; break;
				case "5": Secret = "You will always remember the blood as it dripped down the bars of the black iron cage."; break;
				case "6": Secret = "You will always remember the warm touch of their hand on a cold winters night."; break;
				default: 
					RollType = "No Name"; console.log("  Archetype: " + NewValue + " Secret Anomoly: " + Secret);
			}
			if (NewValue == "Pistolier") {
				Benefit = "You may reroll a misfire dice but you must keep the second roll.";
				Gear1 = "2 pistols,";
				Gear2 = "12 shot";
				Gear3 = "2 gunpowder pouches";
				Gear4 = "Firearms Repair Kit";
				Gear1enc = 1;
				Gear4enc = 1;
				Kit = "Firearms Repair Kit";
				KitDesc = "While at rest, you may use this handy kit to repair a damaged firearm. However, if the weapon is broken beyond repair it cannot be salvaged.";
				Weapon1 = "Pistol";
				Weapon1Desc = "A smaller and more portable version of the musket.";
				Weapon1Special = "If a character has more than one pistol they may fire each turn until they run out of loaded pistols.";
				Weapon1Ammo = "6";
				Weapon1Damage = "d6+2";
				Weapon1Cost = "80";
				Weapon1Rule = "You may reroll a misfire dice but you must keep the second roll.";
				Weapon1Ranged = "1";
				Weapon1BlackPowder = "1";
				Weapon2 = "Pistol";
				Weapon2Desc = "A smaller and more portable version of the musket.";
				Weapon2Special = "If a character has more than one pistol they may fire each turn until they run out of loaded pistols.";
				Weapon2Ammo = "6";
				Weapon2Damage = "d6+2";
				Weapon2Cost = "80";
				Weapon2Rule = "You may reroll a misfire dice but you must keep the second roll.";
				Weapon2Ranged = "1";
				Weapon2BlackPowder = "1";
			} else if (NewValue == "Master Trapper") {
				Benefit = "To find and make traps is Presence +2. Setting up a trap takes one round.";
				Gear1 = "Two bear traps";
				Gear2 = "Ten caltrops";
				Gear3 = "Shovel";
				Gear4 = "Hunters Knife d4";
				Gear5 = "Large heavy net";
				Gear6 = "Jar of bees";
				Gear7 = "Jar of sleep gas";
				Gear8 = "Rope 100ft.";
				Gear1enc = 1;
				Gear3enc = 1;
				Gear5enc = 1;
				Gear8enc = 1;
				Kit = "";
				KitDesc = "";
				Weapon1 = "Hunter's Knife";
				Weapon1Desc = "A common weapon that is carried in some form by most people.";
				Weapon1Special = "These weapons are often allowed in spaces where weapons are forbidden as they are technically a tool.";
				Weapon1Damage = "d4";
			} else {
				Benefit = "All rolls to track a creatures trail is Presence DR8, and you can figure out where your prey is going.";
				Gear1 = "A bow/crossbow with 10 arrows";
				Gear2 = "Hunting Knife d4";
				Gear3 = "Bait Bag";
				Gear1enc = 1;
				Gear3enc = 1;
				Kit = "Bait Bag";
				KitDesc = "This stinking, musky bag will attract predators both natural and demonic. Be careful where you place it.";
				Weapon1 = "Bow or Crossbow";
				Weapon1Desc = "Player must choose between a Bow or a Crossbow.";
				Weapon1Ammo = "10";
				Weapon1Cost = "25 or 40";
				Weapon1Ranged = "1";
				Weapon2 = "Hunting Knife";
				Weapon2Desc = "A common weapon that is carried in some form by most people.";
				Weapon2Special = "These weapons are often allowed in spaces where weapons are forbidden as they are technically a tool.";
				Weapon2Damage = "d4";
				Weapon2Cost = "10";
			}  
		} else if ((NewValue == "Woods Witch") || (NewValue == "Herbalist") || (NewValue == "Hexen")){
			HPDie = 6;
			HPAdjustment = 0;
			StrAdjustment = -2;
			AgiAdjustment =  0;
			PreAdjustment =  2;
			TghAdjustment =  0;
			Wealth = rollD6() * 10;
			switch (SecretRoll) {
				case "1": Secret = "You are running from The Inquisition."; break;
				case "2": Secret = "You are running from a killing in self defense."; break;
				case "3": Secret = "You are running from a dark pursuer."; break;
				case "4": Secret = "You are running from a man who thinks you owe him."; break;
				case "5": Secret = "You are running from a deal gone wrong."; break;
				case "6": Secret = "You are running from your fate."; break;
				default: 
					RollType = "No Name"; console.log("  Archetype: " + NewValue + " Secret Anomoly: " + Secret);
			}
			if (NewValue == "Woods Witch") {
				Benefit = "Roll Presence +2 to find your way in the woods. ";
				Kit = "Trusty Bird";
				KitDesc = "Your bird is loyal but only to you and despises everyone else. You have a primeval link to its thoughts and it will do as you command. It can scout, keep watch and even attack your foes. HP 4 Claws/bite d4";
				Kit2 = "Talisman";
				Kit2Desc = "A small wood and stone item that can be used to bless others. You can give +1 to any roll not made by yourself once per round.";
				Gear1 = "Trusty Bird";
				Gear2 = "Talisman";
			} else if (NewValue == "Herbalist") {
				Benefit = "You may brew d6 of the potions or poisons as long as you can scrounge up some ingredients. Potions made in the wild lose vitality after 24 hours.";
				Kit = "A Brewers Kit";
				KitDesc = "Consisting of; Brass pot Weights and scales, Flint and steel, Six glass bottles with stops, One pint of pure ethanol.";
				Kit2 = "Healers Mask";
				Kit2Desc = "This mask has glass lenses and a long beak stuffed with healing herbs. This will protect you from miasma as well as foul smells and airborne maladies. It also makes people uncomfortable.";
				Gear1 = "A Brewers Kit";
				Gear2 = "Healers Mask";
				Gear1enc = 1;
				Gear2enc = 1;
			} else {
				Benefit = "You may curse one creature a day that has done you wrong. All tests are an additional 2 on behalf of the creature and all attacks upon it gain +2.";
				Kit = "Black Candles";
				KitDesc = "These inky black candles once lit, can offer protection from malevolent spirits and entities.";
				Kit2 = "Deck of Cards";
				Kit2Desc = "These esoteric cards can be shuffled and drawn to tell the future. However the future is always dark and vague.";
				Gear1 = "Black Candles";
				Gear2 = "Deck of Cards";
			}  
		} else if ((NewValue == "Adventurer") || (NewValue == "Sneak Thief") || (NewValue == "Silver-Tounged Trickster")){
			HPDie = 6;
			HPAdjustment = 0;
			StrAdjustment = -2;
			AgiAdjustment =  0;
			PreAdjustment =  0;
			TghAdjustment =  0;
			Wealth = (rollD6() + rollD6()) * 10;
			switch (SecretRoll) {
				case "1": Secret = "You desire more than anything to drown in gold."; break;
				case "2": Secret = "You desire more than anything to buy back your familys estate."; break;
				case "3": Secret = "You desire more than anything to pay off your debt to a dangerous criminal."; break;
				case "4": Secret = "You desire more than anything to never return to the gutter."; break;
				case "5": Secret = "You desire more than anything to prove yourself worthy of their love."; break;
				case "6": Secret = "You desire more than anything to die before you become old and frail."; break;
				default: 
					RollType = "No Name"; console.log("  Archetype: " + NewValue + " Secret Anomoly: " + Secret);
			}
			if (NewValue == "Adventurer") {
				Benefit = "Rolls for doing acrobatics gain +2.";
				Gear1 = "Grappling hook and rope";
				Gear2 = "Crossbow";
				Gear3 = "Ten bolts";
				Gear4 = "Sportsmans Sword d6+2";
				Gear5 = "The Broken Compass";
				Gear1enc = 1;
				Gear2enc = 1;
				Gear4enc = 1;
				Kit = "The Broken Compass";
				KitDesc = "This compass does not point north, it does however point to the thing you most desire.";
				Kit2 = "Sportsmans Sword d6+2";
				Kit2Desc = "DR10 to disarm an opponent of their held weapon rather than inflict harm.";
				Weapon1 = "Crossbow";
				Weapon1Desc = "This weapon requires less physical requirements to master than the bow but is nevertheless both silent and deadly at medium range.";
				Weapon1Special = "Takes a round or movement action to reload, you may not reload in melee range.";
				Weapon1Ammo = "10";
				Weapon1Damage = "d8";
				Weapon1Cost = "40";
				Weapon1Ranged = "1";
				Weapon2 = "Sportsmans Sword";
				Weapon2Desc = "The standard weapon of soldiers, mercenaries and professional killers the world over.";
				Weapon2Special = "Parry, +2 to all melee defence rolls when equipped.";
				Weapon2Damage = "d6+2";
				Weapon2Cost = "25";
				Weapon2Rule = "DR10 to disarm an opponent of their held weapon rather than inflict harm."
			} else if (NewValue == "Sneak Thief") {
				Benefit = "Picking pockets and locks gains +2 to a roll.";
				Gear1 = "Grappling Hook Crossbow";
				Gear2 = "Smoke bombs  5";
				Gear1enc = 1;
				Gear2enc = 1;
				Kit = "Grappling Hook Crossbow";
				KitDesc = "This custom made crossbow will shoot a grappling hook and rope up to 30ft. The rope is light and can only support one person at a time.";
				Kit2 = "Smoke bombs  5";
				Kit2Desc = "Once thrown, these will cover a ten foot sphere and dissipate after a couple of seconds.";
			} else {
				Benefit = "Convincing or lying to others gains +2 to a roll.";
				Kit = "Lucky Coin";
				KitDesc = "A large brilliantly shiny gold coin from a foreign land. It will return to your hand after a few minutes. Perfect for bribery.";
				Kit2 = "Perfume";
				Kit2Desc = "The smell of a rose is irresistible to all that smell it. Also handy for those with no time to bathe.";
			}  
		} else if ((NewValue == "Vow Of War") || (NewValue == "Vow Of Healing") || (NewValue == "Vow Of Sustenance")){
			HPDie = 12;
			HPAdjustment = 0;
			StrAdjustment =  1;
			AgiAdjustment = -1;
			PreAdjustment = -1;
			TghAdjustment =  1;
			Wealth = rollD6() * 10;
			switch (SecretRoll) {
				case "1": Secret = "You have a secret, you murdered your superior after you saw what they had done."; break;
				case "2": Secret = "You have a secret, you stole this Practitioners identity after they died at your side."; break;
				case "3": Secret = "You have a secret, deep down, you lost your faith. But you carry on anyway."; break;
				case "4": Secret = "You have a secret, you have worked as a spy for years."; break;
				case "5": Secret = "You have a secret, you fear good deeds will not absolve the sins of your past."; break;
				case "6": Secret = "You have a secret, you have seen the terrible secret of the Sanguine Church."; break;
				default: 
					RollType = "No Name"; console.log("  Archetype: " + NewValue + " Secret Anomoly: " + Secret);
			}
			if (NewValue == "Vow Of War") {
				Benefit = "When your health drops to 0 in combat, you may roll DR12 Toughness to regain d4 hit points for one round. If you do not heal by the next round you fall unconscious at 0 HP.";
				Gear1 = "Heavy Armour";
				Gear2 = "Short Sword";
				Gear1enc = 1;
				Gear2enc = 1;
				Kit = "Badge of Honour";
				KitDesc = "You wear a badge of honour earned in combat, this will command respect from the faithful.";
				Armour = "Heavy";
				Weapon1 = "Short Sword";
				Weapon1Desc = "The standard weapon of soldiers, mercenaries and professional killers the world over.";
				Weapon1Special = "Parry, +2 to all melee defence rolls when equipped.";
				Weapon1Damage = "d6";
				Weapon1Cost = "20";
			} else if (NewValue == "Vow Of Healing") {
				Benefit = "When not in combat, you may heal a character 2d4 damage up to their max HP.";
				Kit = "Surgical precision";
				KitDesc = "You may declare a called attack on a creature at DR14. On a success, the creature suffers d4 internal bleeding damage for 2 rounds.";
				Gear1 = "Needle, catgut thread";
				Gear2 = "Gauze and bandages";
				Gear3 = "Surgical tongs";
				Gear4 = "Ointment";
				Gear5 = "Smelling salts";
				Gear6 = "Poppy extract";
				Gear7 = "Small sharp knife";
				Gear8 = "Cauterising stamp, tincture";
				Gear8enc = 1;
			} else {
				Benefit = "Provided you have some ingredients, you may make a hearty meal for you and your companions that recovers d8 HP and gives a +2 to Agility, Strength and Toughness saves for the rest of the day.";
				Kit = "Cast Iron Wallop";
				KitDesc = "Succeed DR12 Strength to knock a human sized creature unconscious for d4 rounds. The pan can also be used to parry like a sword. Not bad for a humble skillet.";
				Gear1 = "8 rations and two water skins";
				Gear2 = "Box of salt";
				Gear3 = "Cooking pot";
				Gear4 = "Skillet";
				Gear5 = "Cutting knife and spoon";
				Gear6 = "Enough bowls for the rest of the party";
				Gear7 = "A precious cache of herbs and spices";
				Gear1enc = 1;
				Gear3enc = 1;
				Gear4enc = 1;
				Gear6enc = 1;
				Weapon1 = "Skillet";
				Weapon1Rule = "Succeed DR12 Strength to knock a human sized creature unconscious for d4 rounds. The pan can also be used to parry like a sword. Not bad for a humble skillet.";
			}  
		} else {
			console.log("  Unknown Archetype: " + NewValue + " assuming Compendium and returning");
			setAttrs({  classType: NewValue });
			return;
		}
		console.log("   Archetype: " + NewValue);

		console.log("        HPDie: " + HPDie);
		console.log(" HPAdjustment: " + HPAdjustment);

		console.log("       Secret: " + Secret);
		console.log("      Benefit: " + Benefit);
		console.log("       Wealth: " + Wealth);
		console.log("          Kit: " + Kit2 + " Desc: " + Kit2Desc);
		console.log("        Gear1: " + Gear1);
		console.log("        Gear2: " + Gear2);
		console.log("        Gear3: " + Gear3);
		console.log("        Gear4: " + Gear4);
		console.log("        Gear5: " + Gear5);
		console.log("        Gear6: " + Gear6);
		console.log("        Gear7: " + Gear7);
		console.log("        Gear8: " + Gear8);

		console.log("       Armour: " + Armour);
		
		console.log("      Weapon1: " + Weapon1);
		console.log("  Weapon1Desc: " + Weapon1Desc);
		console.log("  Weapon1Ammo: " + Weapon1Ammo);
		console.log("Weapon1Damage: " + Weapon1Damage);
		console.log("  Weapon1Cost: " + Weapon1Cost);
		console.log("  Weapon1Rule: " + Weapon1Rule);
		console.log("  Weapon1Special: " + Weapon1Special);
		console.log("Weapon1Ranged: " + Weapon1Ranged);
		console.log("Weapon1BlackPowder: " + Weapon1BlackPowder);
		console.log("      Weapon2: " + Weapon2);
		console.log("  Weapon2Desc: " + Weapon2Desc);
		console.log("  Weapon2Ammo: " + Weapon2Ammo);
		console.log("Weapon2Damage: " + Weapon2Damage);
		console.log("  Weapon2Cost: " + Weapon2Cost);
		console.log("  Weapon2Rule: " + Weapon2Rule);
		console.log("  Weapon2Special: " + Weapon2Special);
		console.log("Weapon2Ranged: " + Weapon2Ranged);
		console.log("Weapon2BlackPowder: " + Weapon2BlackPowder);

		let ShowNotArchetype = "0";
		if (NewValue != "None") { ShowNotArchetype = "1"; }
		console.log("  ShowNotArchetype: " + ShowNotArchetype);
			setAttrs({                            
				showNotArchetype: ShowNotArchetype
			});
	
		setAttrs({                            
			StrAdjustment: StrAdjustment,
			AgiAdjustment: AgiAdjustment,
			PreAdjustment: PreAdjustment,
			TghAdjustment: TghAdjustment,
			Wealth: Wealth,
			HPDie: HPDie,
			HPAdjustment: HPAdjustment,
			Secret: Secret,
			Benefit: Benefit,
			Gear1: Gear1,
			Gear2: Gear2,
			Gear3: Gear3,
			Gear4: Gear4,
			Gear5: Gear5,
			Gear6: Gear6,
			Gear7: Gear7,
			Gear8: Gear8,
			Gear1enc: Gear1enc,
			Gear2enc: Gear2enc,
			Gear3enc: Gear3enc,
			Gear4enc: Gear4enc,
			Gear5enc: Gear5enc,
			Gear6enc: Gear6enc,
			Gear7enc: Gear7enc,
			Gear8enc: Gear8enc,
			Kit: Kit,
			KitDesc: KitDesc,
			Kit2: Kit2,
			Kit2Desc: Kit2Desc,
			
			Armour: Armour,
			
			Weapon1: Weapon1,
			Weapon1Desc: Weapon1Desc,
			Weapon1Ammo: Weapon1Ammo,
			Weapon1Damage: Weapon1Damage,
			Weapon1Cost: Weapon1Cost,
			Weapon1Rule: Weapon1Rule,
			Weapon1Special: Weapon1Special,
			Weapon1Ranged: Weapon1Ranged,
			Weapon1BlackPowder: Weapon1BlackPowder,
			Weapon2: Weapon2,
			Weapon2Desc: Weapon2Desc,
			Weapon2Ammo: Weapon2Ammo,
			Weapon2Damage: Weapon2Damage,
			Weapon2Cost: Weapon2Cost,
			Weapon2Rule: Weapon2Rule,
			Weapon2Special: Weapon2Special,
			Weapon2Ranged: Weapon2Ranged,
			Weapon2BlackPowder: Weapon2BlackPowder
		});
	});

	on("change:glenc1 change:grenc1 change:glenc2 change:grenc2 change:glencenc3 change:grenc3 change:glenc4 change:grenc4 change:glenc5 change:grenc5 change:glenc6 change:grenc6 change:glenc7 change:grenc7 change:glenc8 change:grenc8", function(eventInfo) {
		let NewValue = eventInfo.newValue;
		let OldValue = eventInfo.previousValue;
		let SourceAttribute = eventInfo.sourceAttribute;
		console.log(" SourceAttribute: " + SourceAttribute);
		console.log(" NewValue: " + NewValue);

		getAttrs(["strength", "glenc1","grenc1","glenc2","grenc2","glenc3","grenc3","glenc4","grenc4","glenc5","grenc5","glenc6","grenc6","glenc7","grenc7","glenc8","grenc8"], function(values) {
			let Strength = parseInt(values.strength)||0;
			let Glenc1 = parseInt(values.glenc1)||0;
			let Glenc2 = parseInt(values.glenc2)||0;
			let Glenc3 = parseInt(values.glenc3)||0;
			let Glenc4 = parseInt(values.glenc4)||0;
			let Glenc5 = parseInt(values.glenc5)||0;
			let Glenc6 = parseInt(values.glenc6)||0;
			let Glenc7 = parseInt(values.glenc7)||0;
			let Glenc8 = parseInt(values.glenc8)||0;
			let Grenc1 = parseInt(values.grenc1)||0;
			let Grenc2 = parseInt(values.grenc2)||0;
			let Grenc3 = parseInt(values.grenc3)||0;
			let Grenc4 = parseInt(values.grenc4)||0;
			let Grenc5 = parseInt(values.grenc5)||0;
			let Grenc6 = parseInt(values.grenc6)||0;
			let Grenc7 = parseInt(values.grenc7)||0;
			let Grenc8 = parseInt(values.grenc8)||0;
			
			let Total = Glenc1 + Glenc2 + Glenc3 + Glenc4 + Glenc5  + Glenc6  + Glenc7 + Glenc8 + Grenc1 + Grenc2 + Grenc3 + Grenc4 + Grenc5 + Grenc6 + Grenc7 + Grenc8;
			let Capacity = Strength + 8;
			let Encumbered = "";
			
			if (Total > Capacity) 
				{ Encumbered = ""; }
			
			console.log ( " Total: " + Total + " Capacity: " + Capacity + " Encumbered: " + Encumbered); 


			setAttrs({                            
				totalGear: Total, capacity: Capacity, encumbered: Encumbered
			});
		});
	});

	
on("clicked:abilities", function(eventInfo) {
	let TriggerName = eventInfo.triggerName;
	let Name = eventInfo.triggerName.substring(8);

	console.log("  TriggerName: " + TriggerName);
	console.log("  Name: " + Name);
	console.log("  eventInfo: " + JSON.stringify(eventInfo));

	getAttrs(["archetype","StrAdjustment","AgiAdjustment","PreAdjustment","TghAdjustment","Wealth","HPDie","HPAdjustment","Secret","Benefit",
			  "Gear1","Gear2","Gear3","Gear4","Gear5","Gear6","Gear7","Gear8","Kit","KitDesc","Kit2","Kit2Desc", "Armour",
			  "Gear1enc","Gear2enc","Gear3enc","Gear4enc","Gear5enc","Gear6enc","Gear7enc","Gear8enc",
			  "Weapon1","Weapon1Desc","Weapon1Ammo","Weapon1Damage","Weapon1Cost","Weapon1Rule","Weapon1Special","Weapon1Ranged","Weapon1BlackPowder",
			  "Weapon2","Weapon2Desc","Weapon2Ammo","Weapon2Damage","Weapon2Cost","Weapon2Rule","Weapon2Special","Weapon2Ranged","Weapon2BlackPowder",
			  "ccStrAdv","ccAgiAdv","ccPreAdv","ccTghAdv"], function(values) {
		let Archetype = values.archetype;
		let StrAdjustment = parseInt(values.StrAdjustment)||0;
		let AgiAdjustment = parseInt(values.AgiAdjustment)||0;
		let PreAdjustment = parseInt(values.PreAdjustment)||0;
		let TghAdjustment = parseInt(values.TghAdjustment)||0;
		let Wealth = parseInt(values.Wealth)||0;
		let HPDieFaces = parseInt(values.HPDie)||0; // The number of die faces
		let HPAdjustment = parseInt(values.HPAdjustment)||0;
		let Secret = values.Secret;
		let Benefit = values.Benefit;
		let Gear1 = values.Gear1;
		let Gear2 = values.Gear2;
		let Gear3 = values.Gear3;
		let Gear4 = values.Gear4;
		let Gear5 = values.Gear5;
		let Gear6 = values.Gear6;
		let Gear7 = values.Gear7;
		let Gear8 = values.Gear8;
		let Gear1enc = parseInt(values.Gear1enc)||0;
		let Gear2enc = parseInt(values.Gear2enc)||0;
		let Gear3enc = parseInt(values.Gear3enc)||0;
		let Gear4enc = parseInt(values.Gear4enc)||0;
		let Gear5enc = parseInt(values.Gear5enc)||0;
		let Gear6enc = parseInt(values.Gear6enc)||0;
		let Gear7enc = parseInt(values.Gear7enc)||0;
		let Gear8enc = parseInt(values.Gear8enc)||0;
		let Kit = values.Kit;
		let KitDesc = values.KitDesc;
		let Kit2 = values.Kit2;
		let Kit2Desc = values.Kit2Desc;
		let Armour = values.Armour;
		let Weapon1 = values.Weapon1;
		let Weapon1Desc = values.Weapon1Desc;
		let Weapon1Ammo = values.Weapon1Ammo;
		let Weapon1Damage = values.Weapon1Damage;
		let Weapon1Cost = values.Weapon1Cost;
		let Weapon1Rule = values.Weapon1Rule;
		let Weapon1Special = values.Weapon1Special;
		let Weapon1Ranged = values.Weapon1Ranged;
		let Weapon1BlackPowder = values.Weapon1BlackPowder;
		let Weapon2 = values.Weapon2;
		let Weapon2Desc = values.Weapon2Desc;
		let Weapon2Ammo = values.Weapon2Ammo;
		let Weapon2Damage = values.Weapon2Damage;
		let Weapon2Cost = values.Weapon2Cost;
		let Weapon2Rule = values.Weapon2Rule;
		let Weapon2Special = values.Weapon2Special;
		let Weapon2Ranged = values.Weapon2Ranged;
		let Weapon2BlackPowder = values.Weapon2BlackPowder;
		
		
		let StrAdv = parseInt(values.ccStrAdv)||0;
		let AgiAdv = parseInt(values.ccAgiAdv)||0;
		let PreAdv = parseInt(values.ccPreAdv)||0;
		let TghAdv = parseInt(values.ccTghAdv)||0;
		
		let HPDie = 1;
		switch (HPDieFaces) {
			case 6: HPDie = rollD6(); break;
			case 8: HPDie = rollD8(); break;
			case 10: HPDie = rollD10(); break;
			case 12: HPDie = rollD12(); break;
			default: 
				HPDie = rollD8();
		}
		console.log("  HPDieFaces: " + HPDieFaces + " HPDie " + HPDie);
		
		console.log("   Archetype: " + Archetype);
		console.log("        HPDie: " + HPDie);
		console.log(" HPAdjustment: " + HPAdjustment);
		console.log("       Secret: " + Secret);
		console.log("      Benefit: " + Benefit);
		console.log("       Wealth: " + Wealth);
		console.log("          Kit: " + Kit + " Desc: " + KitDesc);
		console.log("          Kit: " + Kit2 + " Desc: " + Kit2Desc);
		console.log("        Gear1: " + Gear1);
		console.log("        Gear2: " + Gear2);
		console.log("        Gear3: " + Gear3);
		console.log("        Gear4: " + Gear4);
		console.log("        Gear5: " + Gear5);
		console.log("        Gear6: " + Gear6);
		console.log("        Gear7: " + Gear7);
		console.log("        Gear8: " + Gear8);
		console.log("        Gear1enc: " + Gear1enc);
		console.log("        Gear2enc: " + Gear2enc);
		console.log("        Gear3enc: " + Gear3enc);
		console.log("        Gear4enc: " + Gear4enc);
		console.log("        Gear5enc: " + Gear5enc);
		console.log("        Gear6enc: " + Gear6enc);
		console.log("        Gear7enc: " + Gear7enc);
		console.log("        Gear8enc: " + Gear8enc);
		console.log("\n        Armour: " + Armour);
		console.log("         Weapon1: " + Weapon1);
		console.log("     Weapon1Desc: " + Weapon1Desc);
		console.log("     Weapon1Ammo: " + Weapon1Ammo);
		console.log("   Weapon1Damage: " + Weapon1Damage);
		console.log("     Weapon1Cost: " + Weapon1Cost);
		console.log("     Weapon1Rule: " + Weapon1Rule);
		console.log("  Weapon1Special: " + Weapon1Special);
		console.log("   Weapon1Ranged: " + Weapon1Ranged);
		console.log("   Weapon1BlackPowder: " + Weapon1BlackPowder);
		console.log("         Weapon2: " + Weapon2);
		console.log("     Weapon2Desc: " + Weapon2Desc);
		console.log("     Weapon2Ammo: " + Weapon2Ammo);
		console.log("   Weapon2Damage: " + Weapon2Damage);
		console.log("     Weapon2Cost: " + Weapon2Cost);
		console.log("     Weapon2Rule: " + Weapon2Rule);
		console.log("  Weapon2Special: " + Weapon2Special);
		console.log("   Weapon2Ranged: " + Weapon2Ranged);
		console.log("   Weapon2BlackPowder: " + Weapon2BlackPowder);
		
		console.log("\n        StrAdjustment: " + StrAdjustment);
		console.log("        AgiAdjustment: " + AgiAdjustment);
		console.log("        PreAdjustment: " + PreAdjustment);
		console.log("        TghAdjustment: " + TghAdjustment);

		// Is Archetype?
		if (Archetype == "None") {
			// Check that Two Stats will be rolled / have been selected  for advantage
			// Note: Code disallows more than two 
			let CheckedAdvantages = StrAdv + AgiAdv + PreAdv + TghAdv;
			if (CheckedAdvantages != 2) {
				console.log("  Failed CheckedAdvantages: " + CheckedAdvantages);
				// For now, arbitrarily choose for Player as a consolation
				if (CheckedAdvantages == 0) {TghAdv = 1; AgiAdv = 1;}
				if (CheckedAdvantages == 1) {
					if (TghAdv != 1) { TghAdv = 1;} 
					else if (AgiAdv != 1) { AgiAdv = 1;}
				}
				console.log("  CheckedAdvantages algorithmically set:  StrAdv " + StrAdv + " AgiAdv " + AgiAdv + " PreAdv " + PreAdv + " TghAdv " + TghAdv);
			}
		} else {
			StrAdv = 0;
			AgiAdv = 0;
			PreAdv = 0;
			TghAdv = 0;
		}
		
		let Str = 3;
		let Agi = 3;
		let Pre = 3;
		let Tgh = 3;
		if (StrAdv == 1) {
			Str = roll4D6kh3();
		} else {
			let D1 = rollD6();
			let D2 = rollD6();
			let D3 = rollD6();
			Str = D1 + D2 + D3 + StrAdjustment;
			console.log("  Str: " + Str + " D1 " + D1 + " D2 " + D2 + " D3 " + D3 + " StrAdjustment " + StrAdjustment);
		}
		if (AgiAdv == 1) {
			Agi = roll4D6kh3();
		} else {
			let D1 = rollD6();
			let D2 = rollD6();
			let D3 = rollD6();
			Agi = D1 + D2 + D3 + AgiAdjustment;
			console.log("  Agi: " + Agi + " D1 " + D1 + " D2 " + D2 + " D3 " + D3 + " AgiAdjustment " + AgiAdjustment);
		}
		if (PreAdv == 1) {
			Pre = roll4D6kh3();
		} else {
			let D1 = rollD6();
			let D2 = rollD6();
			let D3 = rollD6();
			Pre = D1 + D2 + D3 + PreAdjustment;
			console.log("  Pre: " + Pre + " D1 " + D1 + " D2 " + D2 + " D3 " + D3 + " PreAdjustment " + PreAdjustment);
		}
		if (TghAdv == 1) {
			Tgh = roll4D6kh3();
		} else {
			let D1 = rollD6();
			let D2 = rollD6();
			let D3 = rollD6();
			Tgh = D1 + D2 + D3 + TghAdjustment;
			console.log("  Tgh: " + Tgh + " D1 " + D1 + " D2 " + D2 + " D3 " + D3 + " TghAdjustment " + TghAdjustment);
		}
		console.log("  Str: " + Str + " Agi " + Agi + " Pre " + Pre + " Tgh " + Tgh);

		const Strength = makeAbility(Str);
		const Agility = makeAbility(Agi);
		const Presence = makeAbility(Pre);	
		const Toughness = makeAbility(Tgh);
		console.log("  Strength: " + Strength + " Agility " + Agility + " Presence " + Presence + " Toughness " + Toughness);
		let Health = Toughness + (Math.floor(Math.random() * 8) + 1) + 2; //Default for No Archetype
		if (Archetype != "None") {
			Health = Toughness + HPDie + HPAdjustment;
			console.log("  Health: " + Health + " = Toughness " + Toughness + " + HPDie " + HPDie + " + HPAdjustment " + HPAdjustment);
		}
		if (Health < 1) { Health = 1; }
		
		console.log("  Health: " + Health );

		setAttrs({                            
				strength: Strength, agility: Agility, presence: Presence, toughness: Toughness, str: Str, agi: Agi, pre: Pre, tgh: Tgh,
				hpCurrent: Health, hpMax: Health,
				gr1: Gear1, gr2: Gear2, gr3: Gear3, gr4: Gear4, gr5: Gear5, gr6: Gear6, gr7: Gear7, gr8: Gear8,
				glenc1: 1, glenc2: 1, glenc3: 1, glenc4: 0, glenc5: 1, glenc6: 1,
				grenc1: Gear1enc, grenc2: Gear2enc, grenc3: Gear3enc, grenc4: Gear4enc, grenc5: Gear5enc, grenc6: Gear6enc, grenc7: Gear7enc, grenc8: Gear8enc,
				gold: Wealth, classType: Archetype, 
				armour: Armour,
				weapon1: Weapon1, weaponDescription1: Weapon1Desc, ammo1: Weapon1Ammo, weaponDamage1: Weapon1Damage, weaponSpecialRule1: Weapon1Rule + " " + Weapon1Special, weaponRanged1: Weapon1Ranged,
				weaponCost1: Weapon1Cost, weaponBlackPowder1: Weapon1BlackPowder,
				weapon2: Weapon2, weaponDescription2: Weapon2Desc, ammo2: Weapon2Ammo, weaponDamage2: Weapon2Damage, weaponSpecialRule2: Weapon2Rule + " " + Weapon2Special, weaponRanged2: Weapon2Ranged,
				weaponCost2: Weapon2Cost, weaponBlackPowder2: Weapon2BlackPowder,
				ccStrAdv: StrAdv, ccAgiAdv: AgiAdv, ccPreAdv: PreAdv, ccTghAdv: TghAdv
		});
	});
});

on("clicked:strength clicked:agility clicked:presence clicked:toughness", function(eventInfo) {
	let TriggerName = eventInfo.triggerName;
	let Name = eventInfo.triggerName.substring(8);

	console.log("  TriggerName: " + TriggerName);
	console.log("  Name: " + Name);
	console.log("  eventInfo: " + JSON.stringify(eventInfo));
	
	getAttrs(["strength","agility","presence","toughness","armour","encumbered","suppressDR","defaultDR"], function(values) {
		let Strength = parseInt(values.strength)||0;
		let Agility = parseInt(values.agility)||0;
		let Presence = parseInt(values.presence)||0;
		let Toughness = parseInt(values.toughness)||0;
		let Armour = values.armour;
		let Encumbered = values.encumbered;
		let SuppressDR = parseInt(values.suppressDR)||0;
		let DefaultDR = parseInt(values.defaultDR)||0;
		
		let DR = "{{DR=[["+DefaultDR+"]]}}";
		if (SuppressDR == 0) {
			DR = "{{DR=[[?{Difficulty Rating|"+DefaultDR+"}]]}}" ;
		}
		
		let RollType = "Unknown Roll";
		switch (Name) {
/*			case "strength": RollType = "Close Combat"; break;
			case "agility": RollType = "Defence"; break;
			case "presence": RollType = "Long Range Combat or Magic"; break;
*/
			case "strength":  RollType = "Strength"; break;
			case "agility":   RollType = "Agility"; break;
			case "presence":  RollType = "Presence"; break;
			case "toughness": RollType = "Toughness"; break;
			default: 
				RollType = "No Name";
		}
		console.log("  Name: " + Name + " RollType " + RollType);
		
		let rollBase = "";
		let ArmourPenalty = 0;

		if (Name == "agility") {
			console.log("  Agiity test: Armour = " + Armour + " lowercase = " + Armour.toLowerCase()); 
			switch (Armour.toLowerCase()) {
				case "heavy": 
				case "heavy armor":
				case "heavy armour":
				case "heavy x":
				case "heavy xx":
				case "heavy xxx": 
					ArmourPenalty = -2; break;
				case "medium": 
				case "medium armor":
				case "medium armour":
				case "medium x":
				case "medium xx":
					ArmourPenalty = -1; break;
				default: 
					console.log("  Unknown Armour type: " + Armour.toLowerCase());
			}
			if (Encumbered != "") {
				DR = "{{DR=[["+DefaultDR+"+2]]}}";
				if (SuppressDR == 0) {
				DR = "{{DR=[[?{Difficulty Rating|"+DefaultDR+"}+2]]}}" ;
				}
			}

			rollBase = "&{template:check} {{name=@{character_name} *" + RollType + "*}} {{Roll=[[1d20+@{"+Name+"}+"+ArmourPenalty+"]]}} "+ DR + " {{Crit=[[0]]}} {{Fumble=[[0]]}} {{Outcome=[[0]]}}";
		} else if ((Name == "toughness") || (Name == "presence")) {
			rollBase = "&{template:check} {{name=@{character_name} *" + RollType + "*}} {{Roll=[[1d20+@{"+Name+"}]]}} "+ DR + " {{Crit=[[0]]}} {{Fumble=[[0]]}}";
		} else {
			if (Encumbered != "") {
				DR = "{{DR=[["+DefaultDR+"+2]]}}";
				if (SuppressDR == 0) {
				DR = "{{DR=[[?{Difficulty Rating|"+DefaultDR+"}+2]]}}" ;
				}
			}
			rollBase = "&{template:check} {{name=@{character_name} *" + RollType + "*}} {{Roll=[[1d20+@{"+Name+"}]]}} "+ DR + " {{Crit=[[0]]}} {{Fumble=[[0]]}}";
		}
		console.log("  rollBase = " + rollBase);

	    startRoll(rollBase, rollResult => {
		
			console.log(" Roll Dice " + rollResult.results.Roll.dice );
			console.log("  Roll Dice 1 " + rollResult.results.Roll.dice[0] );
			//console.log("  Roll Dice 2 " + rollResult.results.Roll.dice[1] );
			let Die1 = rollResult.results.Roll.dice[0];
			//let Die2 = rollResult.results.Roll.dice[1];
			//let computedDoubles = 0;
			console.log("  Die1 " + Die1 );
			//console.log("  Die2 " + Die2 );
			let computedCrit = 0;
			let computedFumble = 0;
			let critFumbleResult = "";
			if (Die1 === 20) { computedCrit = 1; critFumbleResult = "The player gets a free attack on their attacker."; console.log(" CRITICAL!! " + critFumbleResult); }
			//if (Die1 ===  1) { computedFumble = 1; critFumbleResult = "Player Character takes double damage and their armour is reduced by one tier until it is repaired.[degradeArmour](~selected|Armour Degrades)"; console.log(" FUMBLE!! " + critFumbleResult); }
			if (Die1 ===  1) { computedFumble = 1; critFumbleResult = "Player Character takes double damage and their armour is reduced by one tier until it is repaired."; console.log(" FUMBLE!! " + critFumbleResult); }
			//console.log(" Roll Result " + rollResult.results.Roll.result );[<span data-i18n="explodes!!-u"></span>](~selected|misfireDamage)
			//console.log(" Roll Expression " + rollResult.results.Roll.expression );
			//console.log("  stringify: " + JSON.stringify(rollResult.results.Roll));
			//console.log(" rollBase: " + rollBase);
			let numDice = rollResult.results.Roll.dice.length;
			console.log(" numDice: " + numDice);

			let computed = rollResult.results.Roll.result; // Not altering total, just want to check if War Dice were used 
			
			finishRoll(
				rollResult.rollId,
				{
					Crit: computedCrit, Fumble: computedFumble, Outcome: critFumbleResult
				}
			);
		});

	});
});

on("clicked:morale", function(eventInfo) {
	let TriggerName = eventInfo.triggerName;
	let Name = eventInfo.triggerName.substring(8);

	console.log("  TriggerName: " + TriggerName);
	console.log("  Name: " + Name);
	console.log("  eventInfo: " + JSON.stringify(eventInfo));
	
	getAttrs(["morale"], function(values) {
	
		if (values.morale == "-") {
			let rollBase = "&{template:check} {{name=@{character_name} *remains unflinching* }} {{Fanatic=[[1]]}}";
			// Exit here???
			startRoll(rollBase, rollResult => {
				finishRoll(
					rollResult.rollId,
					{
						
					}
				);
			});
			return;
		}
		
		let Morale = parseInt(values.morale)||0;
		
		let RollType = "Unknown Roll";
		switch (Name) {
			case "morale":    RollType = "Morale"; break;
			default: 
				RollType = "No Name";
		}
		console.log("  Name: " + Name + " RollType " + RollType);
		
		let rollBase = "";
		let ArmourPenalty = 0;

		rollBase = "&{template:check} {{name=@{character_name} *" + RollType + "*}} {{Roll=[[2d6]]}} {{Morale=[["+Morale+"]]}}";

		console.log("  rollBase = " + rollBase);

	    startRoll(rollBase, rollResult => {
		
			console.log(" Roll Dice " + rollResult.results.Roll.dice );
			console.log("  Roll Dice 1 " + rollResult.results.Roll.dice[0] );
			console.log("  Roll Dice 2 " + rollResult.results.Roll.dice[1] );
			let Die1 = rollResult.results.Roll.dice[0];
			let Die2 = rollResult.results.Roll.dice[1];
			console.log("  Die1 " + Die1 );
			console.log("  Die2 " + Die2 );
			//console.log(" Roll Result " + rollResult.results.Roll.result );[<span data-i18n="explodes!!-u"></span>](~selected|misfireDamage)
			//console.log(" Roll Expression " + rollResult.results.Roll.expression );
			//console.log("  stringify: " + JSON.stringify(rollResult.results.Roll));
			//console.log(" rollBase: " + rollBase);
			let numDice = rollResult.results.Roll.dice.length;
			console.log(" numDice: " + numDice);

			let computed = rollResult.results.Roll.result; // Not altering total, just want to check if War Dice were used 
			
			finishRoll(
				rollResult.rollId,
				{
					
				}
			);
		});

	});
});

	
on("clicked:spell1 clicked:spell2 clicked:spell3 clicked:spell4 clicked:spell5 clicked:spell6", function(eventInfo) {
	let TriggerName = eventInfo.triggerName;
	let Name = eventInfo.triggerName.substring(8);

	console.log("  TriggerName: " + TriggerName);
	console.log("  Name: " + Name);
	console.log("  eventInfo: " + JSON.stringify(eventInfo));

	getAttrs(["numSpell", "presence","spell1","spell2","spell3","spell4","spell5","spell6",
		"spellDescription1","spellDescription2","spellDescription3","spellDescription4","spellDescription5","spellDescription6",
		"displaySpell1","displaySpell2","displaySpell3","displaySpell4","displaySpell5","displaySpell6",
		"armour","suppressDR","defaultDR"], function(values) {
		let NumSpell = parseInt(values.numSpell)||0;
		let Presence = parseInt(values.presence)||0;
		let Spell1 = values.spell1;
		let Spell2 = values.spell2;
		let Spell3 = values.spell3;
		let Spell4 = values.spell4;
		let Spell5 = values.spell5;
		let Spell6 = values.spell6;
		let Desc1 = values.spellDescription1;
		let Desc2 = values.spellDescription2;
		let Desc3 = values.spellDescription3;
		let Desc4 = values.spellDescription4;
		let Desc5 = values.spellDescription5;
		let Desc6 = values.spellDescription6;
		let Display1 = parseInt(values.displaySpell1)||0;
		let Display2 = parseInt(values.displaySpell2)||0;
		let Display3 = parseInt(values.displaySpell3)||0;
		let Display4 = parseInt(values.displaySpell4)||0;
		let Display5 = parseInt(values.displaySpell5)||0;
		let Display6 = parseInt(values.displaySpell6)||0;
		let Armour = values.armour;
		let SuppressDR = parseInt(values.suppressDR)||0;
		let DefaultDR = parseInt(values.defaultDR)||0;

		console.log("  Display Spells  1: " + Display1 + " 2: " + Display2 + " 3: " + Display3 + " 4: " + Display4 + " 5: " + Display5 + " 6: " + Display6);
		let DR = "{{DR=[["+DefaultDR+"]]}}";
		if (SuppressDR == 0) {
			DR = "{{DR=[[?{Difficulty Rating|"+DefaultDR+"}]]}}" ;
		}	
		
		let ArmourPenalty = 0;
		switch (Armour.toLowerCase()) {
			case "ultraheavy": 
			case "ultraheavy armor":
			case "ultraheavy armour":
				ArmourPenalty = -3; break;
			case "heavy": 
			case "heavy armor":
			case "heavy armour":
				ArmourPenalty = -2; break;
			case "medium": 
			case "medium armor":
			case "medium armour":
				ArmourPenalty = -1; break;
			default: 
				console.log("  Unknown Armour type: " + Armour.toLowerCase());
		}
		
		if (ArmourPenalty != 0) {
			let rollBase = "&{template:check} {{name=@{character_name} *can not cast a spell in Medium or Heavy Armour* }}";
			// Exit here???
			startRoll(rollBase, rollResult => {
				finishRoll(
					rollResult.rollId,
					{
						
					}
				);
			});
			return;
		}
		
		console.log("  NumSpell: " + NumSpell);

		if (NumSpell < 1) {
			let rollBase = "&{template:check} {{name=@{character_name} *can not cast a spell* }} {{NoSpell=[[1]]}}";
			// Exit here???
			startRoll(rollBase, rollResult => {
				finishRoll(
					rollResult.rollId,
					{
						
					}
				);
			});
			return;
		}

		let Description = "";
		let Display = 0;
		switch (Name) {
			case "spell1": Description = Desc1; Display = Display1; break;
			case "spell2": Description = Desc2; Display = Display2; break;
			case "spell3": Description = Desc3; Display = Display3; break;
			case "spell4": Description = Desc4; Display = Display4; break;
			case "spell5": Description = Desc5; Display = Display5; break;
			case "spell6": Description = Desc6; Display = Display6; break;
			default: 
				Description = "Unhallowed";
		}
		console.log("  Display: " + Display + " Description: " + Description); 
		
		if (Display == 0) 
			{ Description = ""; }
		
		let Failure = "The spell does not work and you become dizzy for [d6](~selected|d6) rounds. Spells cast when dizzy automatically fail.";
		console.log("  Name: " + Name + " Description " + Description); 
		const rollBase = "&{template:check} {{name=@{character_name} *casts* @{" + Name + "}}} {{Roll=[[1d20+@{presence}]]}} " + DR + " {{Crit=[[0]]}} {{Fumble=[[0]]}} {{Success="+Description+"}} {{Failure="+Failure+"}} {{Outcome=[[0]]}}";
//		const rollBase = "&{template:check} {{name=@{character_name} *casts* @{" + Name + "}}} {{Roll=[[1d20+@{presence}]]}} " + DR + " {{Crit=[[0]]}} {{Fumble=[[0]]}}";
		
		console.log("  rollBase = " + rollBase);

	    startRoll(rollBase, rollResult => {

			console.log(" Roll Dice " + rollResult.results.Roll.dice );
			console.log("  Roll Dice 1 " + rollResult.results.Roll.dice[0] );
			//console.log("  Roll Dice 2 " + rollResult.results.Roll.dice[1] );
			let Die1 = rollResult.results.Roll.dice[0];
			//let Die2 = rollResult.results.Roll.dice[1];
			//let computedDoubles = 0;
			console.log("  Die1 " + Die1 );
			//console.log("  Die2 " + Die2 );
			let spellCost = 1;
			let computedCrit = 0;
			let computedFumble = 0;
			let critFumbleResult = "";
			if (Die1 === 20) { 
				let D3 = rollD3();
				switch (D3) {
					case 1: critFumbleResult = "Choose 2x Damage OR\n Nothing to bury. The target liquifies into a black ooze."; break;
					case 2: critFumbleResult = "Choose 2x Damage OR\n Double Trouble. The spell triggers twice without using an additional spell slot."; break;
					case 3: critFumbleResult = "Choose 2x Damage OR\n Another! The spell did not use a slot."; spellCost = 0; break;
					default: 
						critFumbleResult = "Another! The spell did not use a slot."; spellCost = 0; console.log(" Magical Critical D3 rolled " + D3 );
				}
				computedCrit = 1; 
				console.log(" CRITICAL!! Magical Critical D3 rolled " + D3 + " - " + critFumbleResult + "\n"); 
			}
			
			setAttrs({ numSpell: NumSpell -= spellCost });
			

			if (Die1 ===  1) { 
				let D20 = rollD20();
				switch (D20) {
					case  1: critFumbleResult = "You have pierced the veil. If you look up at the night sky for too long, roll DR12. On a failure you scream in horror at the terrible truth."; break;
					case  2: critFumbleResult = "The air cracks with lighting. Three capering Imps appear and wreak havoc and chaos until killed or driven away. See page 144."; break;
					case  3: critFumbleResult = "The spell has the opposite effect."; break;
					case  4: critFumbleResult = "The flesh of your mouth and jaw rots away revealing the white bones beneath. Better wear a mask for now on."; break;
					case  5: critFumbleResult = "If a spell was intended for a foe, it strikes a friend, and vice versa."; break;
					case  6: critFumbleResult = "You vomit a black orb that grows and swells into an exact clone of yourself. The clone is everything you are not, and it wants you dead."; break;
					case  7: critFumbleResult = "The sunlight burns you. Direct sunlight on your skin burns you for d4 damage per minute."; break;
					case  8: critFumbleResult = "The moon knows what you did. When in sight of the moon, you take a 1 to all roles."; break;
					case  9: critFumbleResult = "You see all about tall spindly figures. Only the mad and the damned can see them too. If they suspect that you see them, they will attack."; break;
					case 10: critFumbleResult = "Crack! Lightning strikes you for d4 damage."; break;
					case 11: critFumbleResult = "Nature tries to reclaim you. d8 vines spring from the earth and begin dragging you down. Succeed DR12 Strength or be buried alive."; break;
					case 12: critFumbleResult = "Never again. Performing the spell again deals d4 damage to you."; break;
					case 13: critFumbleResult = "Reality tears. A rift in space opens and terrible creatures spill out and attack everything in sight."; break;
					case 14: critFumbleResult = "A mischievous shade. Your shadow now has a will of its own; it will try to undermine you at every opportunity."; break;
					case 15: critFumbleResult = "Who am I? Your stats including HP are shuffled. (A max HP of 0 becomes 1)"; break;
					case 16: critFumbleResult = "Food and water sickens you. Only blood and raw flesh will sate and sustain you. You must imbibe fresh blood daily to survive. Best you not be seen eating."; break;
					case 17: critFumbleResult = "Black as the night. Your eyes go black and anyone who looks at them is filled with a chilling dread. If you suspect the townsfolk or Inquisition are on to you, they are now."; break;
					case 18: critFumbleResult = "Mist and moonbeams. You turn into a vapour and cannot move or interact with the world for d4 rounds."; break;
					case 19: critFumbleResult = "A hunters mark you alone can see. A symbol burns above your head. In d4 days, a Shadow Hunter will find you and try to slay you."; break;
					case 20: critFumbleResult = "A bell tolls. At a time of rest, you will be approached by a charming and mysterious figure. They will challenge you to a game of chance; if you win you get a free DL. Lose and they will snatch you away."; break;
					default: 
						critFumbleResult = "The spell has the opposite effect."; console.log(" Magical Mis-haps D20 rolled " + D20);
				}
				computedFumble = 1; 
				console.log(" FUMBLE!! Magical Mis-hap: " + D20 + " - " + critFumbleResult);
			}
			//console.log(" Roll Result " + rollResult.results.Roll.result );
			//console.log(" Roll Expression " + rollResult.results.Roll.expression );
			//console.log("  stringify: " + JSON.stringify(rollResult.results.Roll));
			//console.log(" rollBase: " + rollBase);
			let numDice = rollResult.results.Roll.dice.length;
			console.log(" numDice: " + numDice);
			console.log(" Crit: " + computedCrit + " Fumble: " + computedFumble +  " critFumbleResult: " + critFumbleResult);

			let computed = rollResult.results.Roll.result; // Not altering total, just want to check if War Dice were used 
			


			finishRoll(
				rollResult.rollId,
				{
					Crit: computedCrit, Fumble: computedFumble, Outcome: critFumbleResult
				}
			);
		});
	
	});

});


on("clicked:weapon1 clicked:weapon2 clicked:weapon3 clicked:weapon4", function(eventInfo) {
	let TriggerName = eventInfo.triggerName;
	let Name = eventInfo.triggerName.substring(8);

	console.log("  TriggerName: " + TriggerName);
	console.log("  Name: " + Name);
	console.log("  eventInfo: " + JSON.stringify(eventInfo));
	
	getAttrs(["strength","agility","weapon1","weaponDamage1","weapon2","weaponDamage2","weapon3","weaponDamage3","weapon4","weaponDamage4",
			  "weaponRanged1","weaponRanged2","weaponRanged3","weaponRanged4",
			  "ammo1","ammo2","ammo3","ammo4",
			  "weaponBlackPowder1","weaponBlackPowder2","weaponBlackPowder3","weaponBlackPowder4",
			  "weaponSpecialRule1","weaponSpecialRule2","weaponSpecialRule3","weaponSpecialRule4",
			  "displaySpeciaRule1","displaySpeciaRule2","displaySpeciaRule3","displaySpeciaRule4",
			  "calledShot", "suppressDR","defaultDR","suppresMisfire"], function(values) {
		let Strength = parseInt(values.strength)||0;
		let Agility = parseInt(values.agility)||0;
		let Weapon1 = values.weapon1;
		let Weapon2 = values.weapon2;
		let Weapon3 = values.weapon3;
		let Weapon4 = values.weapon4;
		let Damage1 = values.weaponDamage1;
		let Damage2 = values.weaponDamage2;
		let Damage3 = values.weaponDamage3;
		let Damage4 = values.weaponDamage4;
		let Ranged1 = parseInt(values.weaponRanged1)||0;
		let Ranged2 = parseInt(values.weaponRanged2)||0;
		let Ranged3 = parseInt(values.weaponRanged3)||0;
		let Ranged4 = parseInt(values.weaponRanged4)||0;
		let Ammo = 0;
		let Ammo1 = parseInt(values.ammo1)||0;
		let Ammo2 = parseInt(values.ammo2)||0;
		let Ammo3 = parseInt(values.ammo3)||0;
		let Ammo4 = parseInt(values.ammo4)||0;
		let MisfireRoll = "";
		let BlackPowder1 = parseInt(values.weaponBlackPowder1)||0;
		let BlackPowder2 = parseInt(values.weaponBlackPowder2)||0;
		let BlackPowder3 = parseInt(values.weaponBlackPowder3)||0;
		let BlackPowder4 = parseInt(values.weaponBlackPowder4)||0;
		let WeaponSpecialRule1 = values.weaponSpecialRule1;
		let WeaponSpecialRule2 = values.weaponSpecialRule2;
		let WeaponSpecialRule3 = values.weaponSpecialRule3;
		let WeaponSpecialRule4 = values.weaponSpecialRule4;
		let DisplaySpecial1 = parseInt(values.displaySpeciaRule1)||0;
		let DisplaySpecial2 = parseInt(values.displaySpeciaRule2)||0;
		let DisplaySpecial3 = parseInt(values.displaySpeciaRule3)||0;
		let DisplaySpecial4 = parseInt(values.displaySpeciaRule4)||0;
		let CalledShot = parseInt(values.calledShot)||0;
		let SuppressDR = parseInt(values.suppressDR)||0;
		let DefaultDR = parseInt(values.defaultDR)||0;
		let SuppresMisfire = parseInt(values.suppresMisfire)||0;
		
		let DR = "{{DR=[["+DefaultDR+"]]}}";
		if (SuppressDR == 0) {
			DR = "{{DR=[[?{Difficulty Rating|"+DefaultDR+"}]]}}" ;
		}	


		console.log("  Weapon Names -   1: " + Weapon1 + " 2 : " + Weapon2 + " 3: " + Weapon3 + " 4: " + Weapon4);
		console.log("  Weapon Damage -  1: " + Damage1 + " 2 : " + Damage2 + " 3: " + Damage3 + " 4: " + Damage4);
		console.log("  Weapon Ranged? - 1: " + Ranged1 + "   2 : " + Ranged2 + "   3: " + Ranged3 + "   4: " + Ranged4);
		console.log("  Weapon Ammo    - 1: " + Ammo1   + "   2 : " + Ammo2 +   "   3: " + Ammo3   + "   4: " + Ammo4);
		console.log("  Called Shot       : " + CalledShot);
		
		let Weapon = " Unknown Weapon";
		let Damage = "0";
		let Ranged = 0;
		let BlackPowder = 0;
		let Description = "";  // Note: Both Success and Failure are same Description, as it might influence outcome
		let Display = 0;
		
		switch (Name) {
			case "weapon1": Ranged = Ranged1; Weapon = Weapon1; Damage = Damage1; Ammo = Ammo1; BlackPowder = BlackPowder1; Description = WeaponSpecialRule1; Display = DisplaySpecial1; break;
			case "weapon2": Ranged = Ranged2; Weapon = Weapon2; Damage = Damage2; Ammo = Ammo2; BlackPowder = BlackPowder2; Description = WeaponSpecialRule2; Display = DisplaySpecial2; break;
			case "weapon3": Ranged = Ranged3; Weapon = Weapon3; Damage = Damage3; Ammo = Ammo3; BlackPowder = BlackPowder3; Description = WeaponSpecialRule3; Display = DisplaySpecial3; break;
			case "weapon4": Ranged = Ranged4; Weapon = Weapon4; Damage = Damage4; Ammo = Ammo4; BlackPowder = BlackPowder4; Description = WeaponSpecialRule4; Display = DisplaySpecial4; break;
			default: 
				console.log("No Name!!!");
		}
		if (Display == 0) { Description = "";}
		console.log(" Attack Type: " + Name + " Display: " + Display + " Description " + Description);
		let RollType = "strength";
		let Action = "uses";
		if (Ranged == 1) {
			RollType = "agility";
			Action = "fires";
		}
		console.log("Roll Type: " + RollType + " Weapon: " + Weapon + " Damage: " + Damage);
		
		if ((BlackPowder == 1) && (SuppresMisfire == 0)) {
			MisfireRoll = " {{Misfire=[[1d8]]}}";
		}

		console.log("  Name: " + Name + " RollType " + RollType);
		let rollBase = "&{template:check} {{name=@{character_name} *"+Action+"* " + Weapon + "}} {{Roll=[[1d20+@{"+RollType+"}-2*"+CalledShot+"]]}} " + DR + " {{Crit=[[0]]}} {{Fumble=[[0]]}} {{Damage=[["+Damage+"]]}} {{baseDice=[[d6]]}} "+MisfireRoll+" {{Success="+Description+"}} {{Failure="+Description+"}}  {{Outcome=[[0]]}}";

		if ((Ranged == 1) && (Ammo < 1)) {
			rollBase = "&{template:check} {{name=@{character_name} *"+Action+"* " + Weapon + "}} {{NoAmmo=[[1]]}}";
			// Exit here???
			startRoll(rollBase, rollResult => {
				finishRoll(
					rollResult.rollId,
					{
						
					}
				);
			});
			return;
		}

		console.log("  rollBase = " + rollBase);

	    startRoll(rollBase, rollResult => {
		
			console.log(" Roll Dice " + rollResult.results.Roll.dice );
			console.log("  Roll Dice 1 " + rollResult.results.Roll.dice[0] );
			//console.log("  Roll Dice 2 " + rollResult.results.Roll.dice[1] );
			let Die1 = rollResult.results.Roll.dice[0];
			//let Die2 = rollResult.results.Roll.dice[1];
			//let computedDoubles = 0;
			console.log("  Die1 " + Die1 );
			//console.log("  Die2 " + Die2 );

			let finalDamage = rollResult.results.Damage.result;
			console.log("  finalDamage: " + finalDamage);
			if (CalledShot == 1) {
				finalDamage *=2;
				console.log("  finalDamage DOUBLED with Called Shot: " + finalDamage);
			}
			
			console.log("  finalDamage: " + finalDamage);
			//console.log("  stringify: " + JSON.stringify(rollResult.results.Damage));

			let Misfire = 0;
			if ((BlackPowder == 1) && (SuppresMisfire == 0)) {
				Misfire = rollResult.results.Misfire.result;
				console.log("  Misfire: " + Misfire);
				console.log("  stringify: " + JSON.stringify(rollResult.results.Misfire));
			}

			let computedCrit = 0;
			let computedFumble = 0;
			let critFumbleResult = "";
			if (Die1 === 20) { 
				let D3 = rollD3();
				let D4 = rollD4();
				if (BlackPowder == 1) { Misfire = 0; console.log(" Black Powder Critical Misfire " + Misfire )} // Don't let a Critical go to waste (authour approved rule)
				if (Ranged == 1) {
					switch (D3) {
						case 1: critFumbleResult = "Choose 2x Damage, armor/protection reduced one tier, OR\nHead taken clean off."; break;
						case 2: critFumbleResult = "Choose 2x Damage, armor/protection reduced one tier, OR\nSoft target. The PC may choose exactly where the shot hits."; break;
						case 3: critFumbleResult = "Choose 2x Damage, armor/protection reduced one tier, OR\nTwo for One. The projectile goes through the first target and hits whatever is behind it for half damage."; break;
						default: 
							critFumbleResult = "Choose 2x Damage OR\nHead taken clean off."; 
							console.log(" Long Range Critical D3 rolled " + D3 );
					}
				} else {
					switch (D3) {
						case 1: critFumbleResult = "Choose 2x Damage, armor/protection reduced one tier, OR\nSliced in half."; break;
						case 2: critFumbleResult = "Choose 2x Damage, armor/protection reduced one tier, OR\nBleeding wound. Target bleeds 2 damage for " + D4 + " rounds."; break;
						case 3: critFumbleResult = "Choose 2x Damage, armor/protection reduced one tier, OR\nKnocked down. Creatures must spend a turn getting up and are vulnerable to attacks of opportunity."; break;
						default: 
							critFumbleResult = "Choose 2x Damage OR\nSliced in half."; 
							console.log(" Close Quarters Critical D3 rolled " + D3 );
					}
				}
				computedCrit = 1; 
				console.log(" CRITICAL!! Weapon Critical D3 rolled " + D3 + " - " + critFumbleResult + "\n"); 
			}			
			
			
			if (Die1 ===  1) {
				let CFDie = 0;
				if (Ranged == 1) {
					CFDie = rollD2();
					D6 = rollD6();
					halfDamage = Math.floor(finalDamage/2);
					console.log("   D6: " + D6 + " halfDamage " + halfDamage);
					let VictimRoll = rollD3();
					let Victim = "";
					switch (VictimRoll) {
						case 1: Victim = "another character in range"; break;
						case 2: Victim = "a friend in range"; break;
						case 3: Victim = "you"; break;
						default: 
							Victim = "you"; console.log(" Victim D3 rolled " + VictimRoll + " Victim: " + Victim );
					}

					switch (CFDie) {
						case 1: critFumbleResult = "The weapon breaks, dealing you " + D6 + " damage."; finalDamage = D6; break;
						case 2: critFumbleResult = "The shot goes high and strikes " + Victim + " for " + halfDamage + " damage."; finalDamage = halfDamage; break;
						default: 
							critFumbleResult = "The weapon breaks, dealing you " + D6 + " damage."; finalDamage = D6; console.log(" Long Range Fumble D2 rolled " + CFDie );
					}
				} else {
					CFDie = rollD3();
					D4 = rollD4();
					console.log("   D4: " + D4);
					switch (CFDie) {
						case 1: critFumbleResult = "The weapon slips from your grasp, you must spend an action to pick it back up."; finalDamage = 0; break;
						case 2: critFumbleResult = "The weapon is broken and must be repaired to be used again."; finalDamage = 0; break;
						case 3: critFumbleResult = "You hit yourself for " + D4 + " damage"; finalDamage = D4; break;
						default: 
							critFumbleResult = "The weapon slips from your grasp, you must spend an action to pick it back up."; console.log(" Close Quarters Fumble D3 rolled " + CFDie );
					}
				}
				computedFumble = 1; 
				console.log(" FUMBLE!! Weapon Fumble Die rolled " + CFDie + " - " + critFumbleResult + "\n"); 
			}
			//console.log(" Roll Result " + rollResult.results.Roll.result );
			//console.log(" Roll Expression " + rollResult.results.Roll.expression );
			//console.log("  stringify: " + JSON.stringify(rollResult.results.Roll));
			//console.log(" rollBase: " + rollBase);
			let numDice = rollResult.results.Roll.dice.length;
			console.log(" numDice: " + numDice);

			let computed = rollResult.results.Roll.result; // Not altering total, just want to check  
			

			if ((Ranged == 1) && (Ammo > 0)) {
				switch (Name) {
					case "weapon1": setAttrs({ ammo1: Ammo1 -= 1 }); break;
					case "weapon2": setAttrs({ ammo2: Ammo2 -= 1 }); break;
					case "weapon3": setAttrs({ ammo3: Ammo3 -= 1 }); break;
					case "weapon4": setAttrs({ ammo4: Ammo4 -= 1 });; break;
					default: 
						console.log("No Name for Ammo!!!");
				}
			}
			if ((BlackPowder != 1) || (SuppresMisfire == 1)) {
				finishRoll(
					rollResult.rollId,
					{
						Damage: finalDamage, Crit: computedCrit, Fumble: computedFumble, Outcome: critFumbleResult
					}
				);
			} else {
				console.log("  Misfire still " + Misfire);
				finishRoll(
					rollResult.rollId,
					{
						Damage: finalDamage, Crit: computedCrit, Fumble: computedFumble, Outcome: critFumbleResult, Misfire: Misfire
					}
				);
			}
		});

	});
});

on("clicked:character_is clicked:character_wants clicked:character_setback clicked:additional_skills clicked:passions clicked:notable_physical_attribute", function(eventInfo) {
	let TriggerName = eventInfo.triggerName;
	let Name = eventInfo.triggerName.substring(8);

	console.log("  TriggerName: " + TriggerName);
	console.log("  Name: " + Name);
	console.log("  eventInfo: " + JSON.stringify(eventInfo));
	let Action = "Thinks ";
	let Found = "Nothing";
	if (Name == "character_is") {
			Action = "finds";
			let Being = (Math.floor(Math.random() * 10)) + 1;
			console.log("  character_is - Being: " + Being);
				switch (Being) {
					case 1: Found = "Shifty"; break;
					case 2: Found = "Cheery"; break;
					case 3: Found = "Sullen"; break;
					case 4: Found = "Brash"; break;
					case 5: Found = "Smarmy"; break;
					case 6: Found = "Generous"; break;
					case 7: Found = "Pious"; break;
					case 8: Found = "Blasphemous"; break;
					case 9: Found = "Foul Mouthed"; break;
					case 10: Found = "Smouldering"; break;
					default: 
						console.log("Not Found!!! " + Being);
				}
			console.log("  Found: " + Found);
			setAttrs({ characterTrait: Found });

		} else if (Name == "character_wants") {
			Action = "experiences";
			let Desire = (Math.floor(Math.random() * 10)) + 1;
			console.log("  character_desire - Desire: " + Desire);
				switch (Desire) {
					case 1:  Found = "Riches"; break;
					case 2:  Found = "Anarchy"; break;
					case 3:  Found = "Knowledge"; break;
					case 4:  Found = "Fame"; break;
					case 5:  Found = "Peace"; break;
					case 6:  Found = "Revenge"; break;
					case 7:  Found = "Revelry"; break;
					case 8:  Found = "Adventure"; break;
					case 9:  Found = "To write a book"; break;
					case 10: Found = "Justice"; break;
					default: 
						console.log("Not Found!!! " + Desire);
				}
			console.log("  Found: " + Found);
			setAttrs({ characterDesire: Found });
		} else if (Name == "character_setback") {
			Action = "hunts";
			let Setback = (Math.floor(Math.random() * 10)) + 1;
			console.log("  character_setback - Setback: " + Setback);
				switch (Setback) {
					case 1:  Found = "Greedy"; break;
					case 2:  Found = "Overconfident"; break;
					case 3:  Found = "Paranoid"; break;
					case 4:  Found = "Cowardly"; break;
					case 5:  Found = "Vengeful"; break;
					case 6:  Found = "Vain"; break;
					case 7:  Found = "Lazy"; break;
					case 8:  Found = "Haunted"; break;
					case 9:  Found = "Impatient"; break;
					case 10: Found = "Rude"; break;
					default: 
						console.log("Not Found!!! " + Setback);
				}
			console.log("  Found: " + Found);
			setAttrs({ characterSetback: Found });
		} else if (Name == "additional_skills") {
			Action = "mischanced by";
			let Skill = (Math.floor(Math.random() * 20)) + 1;
			console.log("  Skill: " + Skill);
				switch (Skill) {
					case 1:  Found = "Carpentry"; break;
					case 2:  Found = "Good with animals"; break;
					case 3:  Found = "Metalwork"; break;
					case 4:  Found = "Literate"; break;
					case 5:  Found = "Cookery"; break;
					case 6:  Found = "Brewing"; break;
					case 7:  Found = "Sewing"; break;
					case 8:  Found = "Sailing"; break;
					case 9:  Found = "Singing"; break;
					case 10: Found = "Painting"; break;
					case 11: Found = "Dancing"; break;
					case 12: Found = "Music"; break;
					case 13: Found = "Poetry"; break;
					case 14: Found = "Storytelling"; break;
					case 15: Found = "Languages"; break;
					case 16: Found = "Cooking"; break;
					case 17: Found = "Fishing"; break;
					case 18: Found = "Diplomacy"; break;
					case 19: Found = "Whittling"; break;
					case 20: Found = "Arithmetic"; break;
					default: 
						console.log("Not Found!!! " + Skill);
				}
			console.log("  Found: " + Found);
			setAttrs({ additionalSkills: Found });
		} else if (Name == "passions") {
			Action = "is broken";
			let Passion = (Math.floor(Math.random() * 20)) + 1;
			console.log("  Passion: " + Passion);
				switch (Passion) {
					case 1:  Found = "History"; break;
					case 2:  Found = "Politics"; break;
					case 3:  Found = "Gossip"; break;
					case 4:  Found = "Technology"; break;
					case 5:  Found = "Nature"; break;
					case 6:  Found = "Books"; break;
					case 7:  Found = "Sex"; break;
					case 8:  Found = "Food and Drink"; break;
					case 9:  Found = "Fashion"; break;
					case 10: Found = "Money"; break;
					case 11: Found = "Creativity"; break;
					case 12: Found = "Sport"; break;
					case 13: Found = "Hunting"; break;
					case 14: Found = "Debate"; break;
					case 15: Found = "Theatre"; break;
					case 16: Found = "Weapons"; break;
					case 17: Found = "Anarchy"; break;
					case 18: Found = "Law"; break;
					case 19: Found = "Gambling"; break;
					case 20: Found = "Astrology"; break;
					default: 
						console.log("Not Found!!! " + Passion);
				}
			console.log("  Found: " + Found);
			setAttrs({ passions: Found });
		} else if (Name == "notable_physical_attribute") {
			Action = "sustains";
			let Notable = (Math.floor(Math.random() * 20)) + 1;
			console.log("  Notable: " + Notable);
				switch (Notable) {
					case 1:  Found = "Well-groomed"; break;
					case 2:  Found = "Distinctive smell"; break;
					case 3:  Found = "Thousand yard stare"; break;
					case 4:  Found = "Rough hands"; break;
					case 5:  Found = "Tall"; break;
					case 6:  Found = "Short"; break;
					case 7:  Found = "Scruffy"; break;
					case 8:  Found = "Scarred"; break;
					case 9:  Found = "Ruddy complexion"; break;
					case 10: Found = "Wild hair"; break;
					case 11: Found = "Piercing eyes"; break;
					case 12: Found = "Notable jewellery"; break;
					case 13: Found = "Broken nose"; break;
					case 14: Found = "Gold teeth"; break;
					case 15: Found = "Torture scars"; break;
					case 16: Found = "Flamboyant"; break;
					case 17: Found = "Demure"; break;
					case 18: Found = "Corpulent"; break;
					case 19: Found = "Gaunt"; break;
					case 20: Found = "Battle worn"; break;
					default: 
						console.log("Not Found!!! " + Notable);
				}
			console.log("  Found: " + Found);
			setAttrs({ notablePhysicalAttribute: Found });
		}
/*
		let rollBase = "&{template:check} {{name=@{character_name} *"+ Action+"*:\n&nbsp;&nbsp;&nbsp; " + Found + "}}";
		

			startRoll(rollBase, rollResult => {
				finishRoll(
					rollResult.rollId,
					{
						
					}
				);
			});
*/
});




on("clicked:search clicked:road clicked:weather clicked:animal clicked:nightRest clicked:shortRest clicked:huntingMishap clicked:broken clicked:darkpower clicked:wound clicked:road clicked:enemies", function(eventInfo) {
	let TriggerName = eventInfo.triggerName;
	let Name = eventInfo.triggerName.substring(8);

	console.log("  TriggerName: " + TriggerName);
	console.log("  Name: " + Name);
	console.log("  eventInfo: " + JSON.stringify(eventInfo));
	let Action = "Thinks ";
	let Found = "Nothing";
	if (Name == "search") {
			Action = "finds";
			let Search = (Math.floor(Math.random() * 55)) + 12;
			console.log("  Search: " + Search);

				switch (Search) {
/*					case 11: Found = "Gold " + (Math.floor(Math.random() * 20) + 1).toString(); break;
					case 12: Found = "Gold " + (Math.floor(Math.random() * 20) + Math.floor(Math.random() * 20) + 2).toString(); break;
					case 13: Found = "Gold " + (Math.floor(Math.random() * 20) + Math.floor(Math.random() * 20) + Math.floor(Math.random() * 20) + 3).toString(); break;
					case 14: Found = "Bullets " + (Math.floor(Math.random() * 12) + 1).toString(); break;
					case 15: Found = "Gunpowder pouch" + (Math.floor(Math.random() * 10) + 1).toString(); break;
					case 16: Found = "Arrows "  + (Math.floor(Math.random() * 12) + 1).toString(); break;
					case 17: Found = "Knife " + (Math.floor(Math.random() * 4) + 1).toString(); break;
*/
					case 11: Found = "Gold [d20](~selected|d20)"; break;
					case 12: Found = "Gold [2d20](~selected|2d20)"; break;
					case 13: Found = "Gold [3d20](~selected|3d20)"; break;
					case 14: Found = "Bullets [d12](~selected|d12)"; break;
					case 15: Found = "Gunpowder pouch [d10](~selected|d10)"; break;
					case 16: Found = "Arrows [d12](~selected|d12)"; break;
					case 17: Found = "Knife [d4](~selected|d4)"; break;
					case 18: Found = "Healers Kit"; break;
					case 19: Found = "Vino Vita"; break;
					case 20: Found = "Directions to a cache"; break;
					case 21: Found = "Gold Ring"; break;
					case 22: Found = "Gold teeth: [d4](~selected|d4)"; break;
					case 23: Found = "Poison"; break;
					case 24: Found = "Chalk"; break;
					case 25: Found = "Food Ration"; break;
					case 26: Found = "Waterskin"; break;
					case 27: Found = "Lantern"; break;
					case 28: Found = "Salt"; break;
					case 29: Found = "Backpack"; break;
					case 30: Found = "Blanket"; break;
					case 31: Found = "Medicine Kit"; break;
					case 32: Found = "Fire steel"; break;
					case 33: Found = "Random potion"; break;
					case 34: Found = "Empty coin purse"; break;
					case 35: Found = "Key to nearby door"; break;
					case 36: Found = "Small key to chest"; break;
					case 37: Found = "Treasure map"; break;
					case 38: Found = "Dead Rabbit"; break;
					case 39: Found = "Strong alcohol"; break;
					case 40: Found = "Iron nails"; break;
					case 41: Found = "Wanted poster"; break;
					case 42: Found = "Lock of Hair"; break;
					case 43: Found = "[d4](~selected|d4) Candles"; break;
					case 44: Found = "Iron Skillet"; break;
					case 45: Found = "Incriminating letters"; break;
					case 46: Found = "Rotten food"; break;
					case 47: Found = "Strange idol"; break;
					case 48: Found = "Religious icon"; break;
					case 49: Found = "Wolf's skull"; break;
					case 50: Found = "Foreign coins"; break;
					case 51: Found = "Broken pistol"; break;
					case 52: Found = "Letter from loved ones"; break;
					case 53: Found = "Ritual dagger [d6](~selected|d6)"; break;
					case 54: Found = "Human hand (2 gold rings)"; break;
					case 55: Found = "Ball of string"; break;
					case 56: Found = "Chapbook of smut"; break;
					case 57: Found = "Telescope"; break;
					case 58: Found = "Strange rystals"; break;
					case 59: Found = "Animal teeth"; break;
					case 60: Found = "Compass"; break;
					case 61: Found = "Ornate wooden box"; break;
					case 62: Found = "Jewelry"; break;
					case 63: Found = "Live rat"; break;
					case 64: Found = "Suspicious sausage"; break;
					case 65: Found = "Horse blanket"; break;
					case 66: Found = "An egg"; break;
					default: 
						console.log("Not Found!!! " + Search);
				}
			console.log("  Found: " + Found);
		} else if (Name == "weather") {
			Action = "experiences";
			let Search = (Math.floor(Math.random() * 12)) + 1;
			console.log("  Search: " + Search);
				switch (Search) {
					case 1:  Found = "Swelteringly hot"; break;
					case 2:  Found = "Iron grey skies"; break;
					case 3:  Found = "Pelting rain"; break;
					case 4:  Found = "Thick fog"; break;
					case 5:  Found = "Roaring thunder"; break;
					case 6:  Found = "Freezing cold"; break;
					case 7:  Found = "Biting wind"; break;
					case 8:  Found = "Snow"; break;
					case 9:  Found = "Lightning strikes"; break;
					case 10: Found = "Light mist"; break;
					case 11: Found = "Fine sun"; break;
					case 12: Found = "Light drizzle"; break;
					default: 
						console.log("Not Found!!! " + Search);
				}
			console.log("  Found: " + Found);
		} else if (Name == "animal") {
			Action = "hunts";
			let Search = (Math.floor(Math.random() * 10)) + 1;
			console.log("  Search: " + Search);
				switch (Search) {
					case 1:  Found = "Rabbit"; break;
					case 2:  Found = "Boar"; break;
					case 3:  Found = "Deer"; break;
					case 4:  Found = "Bear"; break;
					case 5:  Found = "Goat"; break;
					case 6:  Found = "Pig"; break;
					case 7:  Found = "Fish"; break;
					case 8:  Found = "Cow"; break;
					case 9:  Found = "Sheep"; break;
					case 10: Found = "Wolf"; break;
					default: 
						console.log("Not Found!!! " + Search);
				}
			console.log("  Found: " + Found);
		} else if (Name == "nightrest") {
			Action = "recovers";
			let HP = Math.floor(Math.random() * 6) + 1;
			let Spells = Math.floor(Math.random() * 4) + 1;
			console.log("  HP: " + HP + " possible Spells " + Spells);
			Found = "d6 Hit Points, resets Devil's Luck, and Spells (if applicable)"
			getAttrs(["hpCurrent","hpMax","classType","luck","presence"], function(values) {
				let HPcurrent = parseInt(values.hpCurrent)||0;
				let HPmax = parseInt(values.hpMax)||0;
				let Class = values.classType;
				let Luck = parseInt(values.luck)||0;
				let Presence = parseInt(values.presence)||0;
				console.log("   Class: " + Class + " Luck " + Luck + " Presence " + Presence + " Spells " + Spells + " HPcurrent " + HPcurrent + " HPmax " + HPmax);
				HPcurrent += HP;
				if ( HPcurrent > HPmax) { HPcurrent = HPmax;} 
				Spells += Presence;
				if ( Spells < 1 ) { Spells = 1; console.log("   Spells reset to " + Spells); };

				let LuckReset = 3 - Luck;
				Found = HP  + " Hit Points, Devil's Luck " + LuckReset;
				//Armour.toLowerCase()
				if ((Class == "Woods Witch") || (Class == "Apothecary") || (Class == "Hexen")) {
					Found = HP  + " Hit Points, Devil's Luck " + LuckReset + " Spells " + Spells;
					console.log(" Class: " + Class + " Found " + Found);
					setAttrs({ hpCurrent: HPcurrent, luck: 3, numSpell: Spells });
				} else {
					Found = HP  + " Hit Points, Devil's Luck " + LuckReset;
					console.log(" Class: " + Class + " Found " + Found);
					setAttrs({ hpCurrent: HPcurrent, luck: 3 });
				}
				console.log("   Found Here: " + Found);
			});
			console.log("   Found: " + Found);
		} else if (Name == "shortrest") {
			Action = "recovers";
			let HP = Math.floor(Math.random() * 4) + 1;
			console.log("  HP: " + HP);
			Found = "d4 Hit Points"
			getAttrs(["hpCurrent","hpMax"], function(values) {
				let HPcurrent = parseInt(values.hpCurrent)||0;
				let HPmax = parseInt(values.hpMax)||0;
				console.log("   HPcurrent " + HPcurrent + " HPmax " + HPmax);
				HPcurrent += HP;
				if ( HPcurrent > HPmax) { HPcurrent = HPmax;} 

				Found = HP  + " Hit Points";
				console.log(" Short Rest: Found " + Found);
				setAttrs({ hpCurrent: HPcurrent });
			});
		} else if (Name == "huntingmishap") {
			Action = "mischanced by";
			let Search = (Math.floor(Math.random() * 6)) + 1;
			console.log("  Search: " + Search);
				switch (Search) {
					case 1: Found = "A large predator is lurking nearby in the shadows."; break;
					case 2: Found = "Your would-be meal is sick with a terrible ailment.\nBlack slime drips from its mouth and eyes."; break;
					case 3: Found = "A rival hunting party of bandits closes in."; break;
					case 4: Found = "The beast runs to its flock. They pose to attack."; break;
					case 5: Found = "Upon death, the beast twists and contrts into a ferocious demon."; break;
					case 6: Found = "The death of the beast summons a Rat Swarm."; break;
					default: 
						console.log("Not Found!!! " + Search);
				}
			console.log("  Found: " + Found);
		} else if (Name == "broken") {
			Action = "is broken";
			let Search = (Math.floor(Math.random() * 6)) + 1;
			console.log("  Search: " + Search);
				switch (Search) {
					case 1:
					case 2: Found = "Fall unconscious for [d4](~selected|d4) rounds, awaken with [d4](~selected|d4) HP."; break;
					case 3:
					case 4: Found = "Roll on the [Wounds Table](~selected|wound). Then you become active with [d4](~selected|d4) HP."; break;
					case 5:
					case 6: Found = "Bleeding out: death in [d6](~selected|d6) minutes unless treated. All tests are DR16 until you are treated."; break;
					default: 
						console.log("Not Found!!! " + Search);
				}
			console.log("  Found: " + Found);
		} else if (Name == "wound") {
			Action = "sustains";
			let Search = (Math.floor(Math.random() * 10)) + 1;
			console.log("  Search: " + Search);
				switch (Search) {
					case 1:  Found = "Smal scar"; break;
					case 2:  Found = "Missing leg"; break;
					case 3:  Found = "Missing hand/arm"; break;
					case 4:  Found = "Large scar"; break;
					case 5:  Found = "Missing eye"; break;
					case 6:  Found = "Missing nose"; break;
					case 7:  Found = "A bone-deep ache"; break;
					case 8:  Found = "Missing teeth"; break;
					case 9:  Found = "Broken arm/leg"; break;
					case 10: Found = "Broken ribs"; break;
					default: 
						console.log("Not Found!!! " + Search);
				}
			console.log("  Found: " + Found);
		} else if (Name == "darkpower") {
			Action = "invokes a Dark Power";
			let DarkPowerRoll = (Math.floor(Math.random() * 6)) + 1;

 			if (DarkPowerRoll != 1) {
				Found = " Safely! (rolled a " + DarkPowerRoll + ")";
			} else {
				Action = "invokes a Dark Power but suffers";
			
				let Search = (Math.floor(Math.random() * 20)) + 1;
				console.log("  Search: " + Search);
					switch (Search) {
						case 1:  Found = "Small horns grow on your forehead"; break;
						case 2:  Found = "Your hands are permanently blackened"; break;
						case 3:  Found = "The colour of your eyes invert"; break;
						case 4:  Found = "Your teeth elongate, sharp and vicious, like that of a beast"; break;
						case 5:  Found = "The hair on your forearms hardens into dark spikes like that of a hedgehog"; break;
						case 6:  Found = "Your skin becomes scaly and rigid, devoid of feeling"; break;
						case 7:  Found = "Your feet fuse to become cloven hooves"; break;
						case 8:  Found = "You grow tall"; break;
						case 9:  Found = "Each hand grows another finger"; break;
						case 10: Found = "Your skin turns red"; break;
						case 11: Found = "Your tongue forks at the tip... like that of a serpent"; break;
						case 12: Found = "Small, horn-like spikes grow over your jaw and chin"; break;
						case 13: Found = "A pair of small bat wings sprout from your back"; break;
						case 14: Found = "Your fingernails harden into talons"; break;
						case 15: Found = "In the dark your eyes glow like coals"; break;
						case 16: Found = "Your spine grows spikes that erupt from your back, splitting the skin"; break;
						case 17: Found = "When eating test DR12 toughness. Fail and you belch flames"; break;
						case 18: Found = "Your noes hardens to a bone-like spike"; break;
						case 19: Found = "Your blood runs black, like tar"; break;
						case 20: Found = "Direct sunlight to exposed skin burns you"; break;
						default: 
							console.log("Not Found!!! " + Search);
					}
			}
			console.log("  Found: " + Found);
		} else if (Name == "road") {
			Action = "peers";
			let Search = (Math.floor(Math.random() * 10)) + 1;
			console.log("  Search: " + Search);
				switch (Search) {
					case 1:  Found = "You find a corpse swinging from a tree. Around its neck is a sign with the word 'heretic' written on it"; break;
					case 2:  Found = "The howl of many wolves drifts on the wind. Is sounds like it is getting closer"; break;
					case 3:  Found = "You hear the clip-clop of horses hoooves and a whistled tune; a two-horse wagon appears with a lone man perched upon it "; break;
					case 4:  Found = "You see the glint of halberd blades; a company of mercenaries twenty strong, marches towards you"; break;
					case 5:  Found = "You see a deathly pale figure standing in the middle of the road. as you approach the figure fades into thin air. You start to hear whispers"; break;
					case 6:  Found = "You see a parade of flagellants holding banner and flails aloft. They wail their hymns and whip themselves, as well as any within reach, as they pass"; break;
					case 7:  Found = "You spot some refugees huddled around a fire. They are attempting to make a soup out of rain water and grass. They eye you cautiously, but do not seem hostile"; break;
					case 8:  Found = "A blind, old figure, wrapped in rags hunches over thier stick. They offer to tell your future for coin"; break;
					case 9:  Found = "A stranger runs into you ath. He starts to theatrically cry and writhe in pain. On either side of the road, eyes watch from the shadows"; break;
					case 10: Found = "At the crossroads, a lone figure leans against a signpost. His clothes are finely made, but dusty from travel. He smiles as you approach, as if he's been waiting for you"; break;
					default: 
						console.log("Not Found!!! " + Search);
				}
			console.log("  Found: " + Found);
		} else if (Name == "enemies") {
			Action = "sees approaching";
			let Search = (Math.floor(Math.random() * 10)) + 1;
			console.log("  Search: " + Search);
				switch (Search) {
					case 1:  Found = "Bandits"; break;
					case 2:  Found = "Mercenaries"; break;
					case 3:  Found = "The Inquisition"; break;
					case 4:  Found = "Puritans"; break;
					case 5:  Found = "Orthodox"; break;
					case 6:  Found = "Mutants"; break;
					case 7:  Found = "Demons"; break;
					case 8:  Found = "Ghosts"; break;
					case 9:  Found = "The Pox"; break;
					case 10: Found = "Cultists"; break;
					default: 
						console.log("Not Found!!! " + Search);
				}
			console.log("  Found: " + Found);
		}
		let rollBase = "&{template:check} {{name=@{character_name} *"+ Action+"*:\n&nbsp;&nbsp;&nbsp; " + Found + "}}";
		

			startRoll(rollBase, rollResult => {
				finishRoll(
					rollResult.rollId,
					{
						
					}
				);
			});
});


<!--			<button class="sheet-profileInput" type="roll" name="roll_armourCheck" style="height: 24px; width: 22px; font-size: 14px; margin: 2px 0px 0px 0px; padding: 2px 0px 0px 0px; background-color: rgba(255,255,255,0.3); border: 2px solid DarkRed;" value="&{template:check} {{name=@{character_name} *shielded by* @{armour}}} {{Absorb=[[1d2]]}}" data-i18n-title="lightArmourCheck-c"> -->

on('clicked:armour', function(eventInfo) {
	let TriggerName = eventInfo.triggerName;
	let Name = eventInfo.triggerName.substring(8);

	console.log("  TriggerName: " + TriggerName);
	console.log("  Name: " + Name);
	console.log("  eventInfo: " + JSON.stringify(eventInfo));

	getAttrs(["armour"], function(values) {
		let Armour = values.armour;
		let ArmourSoak = "";

		console.log("  Armour: " + Armour);
		switch (Armour) {
			case "Light":    ArmourSoak = "d2"; break;
			case "Medium":   ArmourSoak = "d4"; break;
			case "Heavy":    ArmourSoak = "d6"; break;
			case "Ultraheavy": ArmourSoak = "d8"; break;
			case "Medium X": ArmourSoak = "d2"; break;
			case "Heavy XX": ArmourSoak = "d2"; break;
			case "Heavy X":  ArmourSoak = "d4"; break;
			case "Light X":   ArmourSoak = "d2-1"; break; // Severely Degraded
			case "Medium XX": ArmourSoak = "d2-1"; break; // Severely Degraded
			case "Heavy XXX": ArmourSoak = "d2-1"; break; // Severely Degraded
			default: 
				ArmourSoak = "d0";
		}
		console.log("  Armour: " + Armour + " Soak: " + ArmourSoak);
		let rollBase = "&{template:check} {{name=@{character_name} *shielded by* @{armour}}} {{Absorb=[["+ArmourSoak+"]]}}"

		console.log("  rollBase = " + rollBase);

	    startRoll(rollBase, rollResult => {

			finishRoll(
				rollResult.rollId,
				{
					
				}
			);
		});
	});
});
on('clicked:degradeArmour', function(eventInfo) {
	let TriggerName = eventInfo.triggerName;
	let Name = eventInfo.triggerName.substring(8);

	console.log("  TriggerName: " + TriggerName);
	console.log("  Name: " + Name);
	console.log("  eventInfo: " + JSON.stringify(eventInfo));

	getAttrs(["armour"], function(values) {
		let Armour = values.armour;
		let DegradedArmour = "";

		console.log("  Armour: " + Armour);
		switch (Armour) {
			case "Light":    DegradedArmour = "Light X"; break;
			case "Medium":   DegradedArmour = "Medium X"; break;
			case "Heavy":    DegradedArmour = "Heavy X"; break;
			case "Medium X": DegradedArmour = "Medium XX"; break;
			case "Heavy XX": DegradedArmour = "Heavy XXX"; break;
			case "Heavy X":  DegradedArmour = "Heavy XX"; break;
			default: 
				DegradedArmour = Armour;
		}
		console.log("  Armour: " + Armour + " DegradedArmour: " + DegradedArmour);
		setAttrs({ Armour: DegradedArmour });

		let rollBase = "&{template:check} {{name=@{character_name} *now wears* "+DegradedArmour+"}}"

		console.log("  rollBase = " + rollBase);

	    startRoll(rollBase, rollResult => {

			finishRoll(
				rollResult.rollId,
				{
					
				}
			);
		});
	});
});
/*
		<button class="sheet-profileInput" type="action" name="act_spellPreparation" style="display: inline-block; vertical-align: top; height: 22px; width: 70px; color: Black; margin: 24px 0px 2px 8px; font-family: UnifrakturMaguntia; font-style: normal; font-size: 22px; font-weight: bold; text-align: left; padding: 2px 0px 0px 2px; border: 1px solid Transparent;" value="&{template:check} {{name=@{character_name} *prepares Spells*}} {{SpellPrep=[[@{presence}+1d4]]}}" data-i18n-title="rollDailySpellPreparation-c">
&{template:check} {{name=@{character_name} *prepares Spells*}} {{SpellPrep=[[@{presence}+1d4]]}}" data-i18n-title="rollDailySpellPreparation-c">
*/
on('clicked:spellPreparation', (info) => {
	startRoll("&{template:check} {{name=@{character_name} *prepares daily Spells*}} {{SpellPrep=[[@{presence}+1d4]]}}", (results) => {
		const total = results.results.SpellPrep.result;
		console.log("  SpellPrep: " + total);
		const computed = total;

		setAttrs({ numSpell: total });

		finishRoll(
			results.rollId,
			{
				SpellPrep: total
			}
		);
	});
});
on('clicked:devilsLuck', (info) => {

	getAttrs(["luck"], function(values) {
		let Luck = parseInt(values.luck)||0;

		if (Luck < 1) {
			console.log("  Insufficent Luck: " + Luck);
			return;
		}
		Luck -= 1;
	
		startRoll("&{template:check} {{name=@{character_name} *uses Devil's Luck*}} {{Luck=[[1d6]]}}", (results) => {
			const LuckRoll = results.results.Luck.result;
			console.log("  devilsLuck:   Luck: " + Luck + " LuckRoll: " + LuckRoll);
			const computed = LuckRoll;

			setAttrs({ luck: Luck });

			finishRoll(
				results.rollId,
				{
				}
			);
		});
	});
});
on('clicked:initiative', (info) => {
	startRoll("&{template:initiative} {{name=@{character_name}}} {{roll1=[[d6+@{agility} &{tracker}]]}}", (results) => {
		const total = results.results.roll1.result;
		const computed = total;

		setAttrs({ initiative: computed });

		finishRoll(
			results.rollId,
			{
				roll1: computed
			}
		);
	});
});

  on('change:drop_data',(event) => {
    // don't do handling if this was changed by api or sheetworker
    //if(event.sourceType !== 'player') return;

    getAttrs(['drop_data'],(attributes) => {
      try{
 	   console.log("  drop_data: " + JSON.stringify(attributes.drop_data));
       const data = JSON.parse(attributes.drop_data);
        if(data.Category === 'NPCs'){
          // npc processing
        }else if(data.Category === 'other category'){
          // other category, conditional handling for each droppable category
        }
      }catch(err){
        // handlig for if the data isn't correct
      }
    })
  })
</script>
