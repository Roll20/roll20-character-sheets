<!-- Custom Character Sheet ordered by Yojoman for Level Up Advanced 5th Edition -->
<!-- Made by Spirito, www.spirito.fr, Spirito#6973, spirito35220@gmail.com -->

<rolltemplate class="sheet-rolltemplate-levelup">
  <div class="sheet-template-header sheet-bloc-header">
    <!-- ========================================================= -->
    <!-- HEADER -->
    <!-- ========================================================= -->
    <div class="sheet-header-bloc">
      <span class="sheet-headerstyle1">{{name}}</span>
      {{#category}}<span class="sheet-headerstyle2">{{charactername}} ♦ {{category}}</span>{{/category}}
    </div>

    <!-- ========================================================= -->
    <!-- DETAILS -->
    <!-- ========================================================= -->
    {{#rollTotal() details 1}}
    <div id="DETAILS" class="sheet-template-rolls sheet-template-rolls4">
      <span class="sheet-headerstyle3"> {{#usage}}USA. /{{/usage}} {{#duration}}DURA. /{{/duration}} {{#range}}RNG /{{/range}} {{#target}}TAR /{{/target}} {{#charge}}CHRG{{/charge}} </span>
      <span class="sheet-headerstyle4"> {{#usage}}{{usage}} /{{/usage}} {{#duration}}{{duration}} /{{/duration}} {{#range}}{{range}} /{{/range}} {{#target}}{{target}} /{{/target}} {{#charge}}{{charge}}{{/charge}} </span>
    </div>
    {{/rollTotal() details 1}}

    <!-- ========================================================= -->
    <!-- ATTACK ROLLS (only if NOT dmgonly) -->
    <!-- ========================================================= -->

    {{^norollnodamage}} 
    {{^withdmg}}
    {{^dmgonly}} 
     <!-- ------------------------- -->
      {{#rollGreater() roll 0}}
      <!-- ------------------------- -->
    <!-- ------------------------- -->
    <!-- STANDARD (only if no adv/dis) -->
    <!-- ------------------------- -->
    {{#standard}} {{^advantage}} {{^disadvantage}}
    <div id="STANDARD" class="sheet-template-rolls">
      <div class="sheet-roll">{{roll}}</div>

      {{#deathsave}} {{#rollTotal() roll 20}}<span class="sheet-headerstyle2">Critical Sucess !</span>{{/rollTotal() roll 20}} {{#^rollTotal() roll 20}} {{#rollGreater() roll 9}}<span class="sheet-headerstyle2">Success !</span>{{/rollGreater() roll 9}} {{/^rollTotal() roll 20}} {{#rollTotal() roll 1}}<span class="sheet-headerstyle2">Critical Fail !</span>{{/rollTotal() roll 1}} {{#rollLess() roll 10}} {{#^rollTotal() roll 1}}<span class="sheet-headerstyle2">Fail !</span>{{/^rollTotal() roll 1}} {{/rollLess() roll 10}} {{/deathsave}}
    </div>
    {{/disadvantage}} {{/advantage}} {{/standard}}

    <!-- ------------------------- -->
    <!-- ADVANTAGE -->
    <!-- ------------------------- -->
    {{#advantage}}
    <div id="ADVANTAGE" class="sheet-template-rolls sheet-template-rolls2">
      {{#rollGreater() roll1 roll2}}
      <div class="sheet-roll">{{roll1}}</div>
      <div class="sheet-roll sheet-allgrey">{{roll2}}</div>
      {{/rollGreater() roll1 roll2}} {{#rollGreater() roll2 roll1}}
      <div class="sheet-roll sheet-allgrey">{{roll1}}</div>
      <div class="sheet-roll">{{roll2}}</div>
      {{/rollGreater() roll2 roll1}} {{#rollTotal() roll1 roll2}}
      <div class="sheet-roll">{{roll1}}</div>
      <div class="sheet-roll">{{roll2}}</div>
      {{/rollTotal() roll1 roll2}}
    </div>
    {{/advantage}}

    <!-- ------------------------- -->
    <!-- DISADVANTAGE -->
    <!-- ------------------------- -->
    {{#disadvantage}}
    <div id="DISADVANTAGE" class="sheet-template-rolls sheet-template-rolls2">
      {{#rollGreater() roll1 roll2}}
      <div class="sheet-roll sheet-allgrey">{{roll1}}</div>
      <div class="sheet-roll">{{roll2}}</div>
      {{/rollGreater() roll1 roll2}} {{#rollGreater() roll2 roll1}}
      <div class="sheet-roll">{{roll1}}</div>
      <div class="sheet-roll sheet-allgrey">{{roll2}}</div>
      {{/rollGreater() roll2 roll1}} {{#rollTotal() roll1 roll2}}
      <div class="sheet-roll">{{roll1}}</div>
      <div class="sheet-roll">{{roll2}}</div>
      {{/rollTotal() roll1 roll2}}
    </div>
    {{/disadvantage}} 
    <!-- ------------------------- -->
    <!-- ------------------------- -->
     {{/rollGreater() roll 0}} 
     <!-- ------------------------- -->
  {{/dmgonly}} 
   {{/withdmg}}
  {{/norollnodamage}}  
<!-- ------------------------- -->

    <!-- ========================================================= -->
    <!-- DAMAGES (only if dmgonly) + MANUAL CRIT (critical=[[0/1]]) -->
    <!-- NOTE: critical MUST be an inline roll in the button:
    <!--       {{critical=[[?{Critical hit?|No,0|Yes,1}]]}} -->
    <!-- ========================================================= -->
      {{^norollnodamage}}  
      {{^standard}}
       <!-- ------------------------- -->
        {{#rollGreater() dmg1 0}}
         <!-- ------------------------- -->
    <div class="sheet-template-dmg">
      <!-- ------------------------- -->
      <!-- TWO DAMAGES -->
      <!-- ------------------------- -->
      {{#rollGreater() dmg2 0}}
      <div id="TWO DAMAGES" class="sheet-template-rolls sheet-template-rolls2">
        {{#rollTotal() critical 1}}
        <div class="sheet-roll sheet-dmg sheet-allnormal">{{dmg1}} + {{dmg1crit}}</div>
        <div class="sheet-roll sheet-dmg sheet-allnormal">{{dmg2}} + {{dmg2crit}}</div>
        {{/rollTotal() critical 1}} {{#rollTotal() critical 0}}
        <div class="sheet-roll sheet-dmg sheet-allnormal">{{dmg1}}</div>
        <div class="sheet-roll sheet-dmg sheet-allnormal">{{dmg2}}</div>
        {{/rollTotal() critical 0}} {{#dmg1type}}
        <div class="sheet-description sheet-description-dmg">{{dmg1type}}</div>
        {{/dmg1type}} {{#dmg2type}}
        <div class="sheet-description sheet-description-dmg">{{dmg2type}}</div>
        {{/dmg2type}}
      </div>
      {{/rollGreater() dmg2 0}}

      <!-- ------------------------- -->
      <!-- ONE DAMAGE -->
      <!-- ------------------------- -->
      {{#^rollGreater() dmg2 0}}
      <div id="ONE DAMAGE" class="sheet-template-rolls">
        {{#rollTotal() critical 1}}
        <div class="sheet-roll sheet-dmg sheet-allnormal">{{dmg1}} + {{dmg1crit}}</div>
        {{/rollTotal() critical 1}} {{#rollTotal() critical 0}}
        <div class="sheet-roll sheet-dmg sheet-allnormal">{{dmg1}}</div>
        {{/rollTotal() critical 0}} {{#dmg1type}}
        <div class="sheet-description sheet-description-dmg">{{dmg1type}}</div>
        {{/dmg1type}}
      </div>
      {{/^rollGreater() dmg2 0}}
    </div>
     <!-- ------------------------- -->
    {{/rollGreater() dmg1 0}}  
     <!-- ------------------------- -->
    {{/standard}}
    {{/norollnodamage}} 
 <!-- ------------------------- -->
    <!-- ========================================================= -->
    <!-- SAVE -->
    <!-- ========================================================= -->
    {{#rollGreater() save 0}}
    <div id="SAVE" class="sheet-template-rolls sheet-template-rolls3">
      <div class="sheet-description3">DC: {{save}} {{savecomp}}</div>
      <div class="sheet-description">{{saveeffect}}</div>
    </div>
    {{/rollGreater() save 0}}

    <!-- ========================================================= -->
    <!-- EXTRA BUTTON (only if NOT dmgonly AND NOT nodmg AND desc) -->
    <!-- ========================================================= -->
      {{#rollGreater() dmg1 0}} {{^norollnodamage}} {{^dmgonly}} {{^nodmg}} {{#desc}}
    <div class="sheet-extra-button sheet-doublecolumn sheet-doublebutton">{{button}}{{buttoncrit}}</div>
    {{/desc}} {{/nodmg}} {{/dmgonly}} 
    {{/norollnodamage}} {{/rollGreater() dmg1 0}}

    <!-- ========================================================= -->
    <!-- DESCRIPTION -->
    <!-- ========================================================= -->
       {{^withdmg}}
       {{#norollnodamage}}
           <div id="DESCRIPTION" class="sheet-template-rolls sheet-template-rolls3" style="border-top:none!important;">
      <div class="sheet-description"><b>Description</b> : {{description}}</div>
    </div>
         {{/norollnodamage}}

         {{^norollnodamage}} 
    {{#description}}
    <div id="DESCRIPTION" class="sheet-template-rolls sheet-template-rolls3">
      <div class="sheet-description"><b>Description</b> : {{description}}</div>
    </div>
    {{/description}}
      {{/norollnodamage}}
      {{/withdmg}}
  </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-levelup-description">
  <div class="sheet-template-header sheet-bloc-header">
    <!-- ========================================================= -->
    <!-- HEADER -->
    <!-- ========================================================= -->
    {{#name}}
    <span class="sheet-headerstyle1">{{name}}</span>
    {{/name}} {{#source}}
    <span class="sheet-headerstyle2">{{source}}</span>
    {{/source}}

    <!-- ========================================================= -->
    <!-- DESCRIPTION -->
    <!-- ========================================================= -->
    {{#description}}
    <div id="DESCRIPTION" class="sheet-template-rolls sheet-template-rolls3">
      <div class="sheet-description"><b>Description</b> : {{description}}</div>
    </div>
    {{/description}}

    <!-- ========================================================= -->
    <!-- FOOTER / CHARACTER -->
    <!-- ========================================================= -->
    {{#charactername}}
    <span class="sheet-headerstyle2 sheet-headerstyle123">{{charactername}}</span>
    {{/charactername}}
  </div>
</rolltemplate>

<div class="sheet-charsheet">
  <!-- CHARNAME -->
  <div class="sheet-main-header-charactername">
    <input type="text" placeholder="Character Name" data-i18n-placeholder="character-name-placeholder" name="attr_character_name" />
    <input type="text" placeholder="Destiny" data-i18n-placeholder="destiny-placeholder" name="attr_destiny" />
  </div>

  <!-- ----- HEADER -----  -->
  <div class="sheet-main-header">
    <!-- ----- IMAGE -----  -->
    <div class="sheet-main-image"></div>

    <!-- ----- HEADER BLOC RIGHT -----  -->
    <div class="sheet-header-display1 sheet-standardbox sheet-standardbox2">
      <div class="sheet-oneline">
        <!-- HEADER BLOC 3 -->
        <div class="sheet-main-header-size">
          <h4 class="sheet-left" data-i18n="size-label">Size</h4>
          <input type="text" placeholder="0" data-i18n-placeholder="0-placeholder" name="attr_size" />

          <h4 class="sheet-left" data-i18n="heritage-label">Heritage</h4>
          <input class="sheet-left" type="text" placeholder="Heritage" data-i18n-placeholder="heritage-placeholder" name="attr_heritage" />

          <h4 class="sheet-left" data-i18n="speed-label">Speed</h4>
          <input type="text" placeholder="0" data-i18n-placeholder="0-placeholder" name="attr_speed" />

          <h4 class="sheet-left" data-i18n="culture-label">Culture</h4>
          <input class="sheet-left" type="text" placeholder="Culture" data-i18n-placeholder="culture-placeholder" name="attr_culture" />

          <h4 class="sheet-left" data-i18n="xp-points-label">XP points</h4>
          <input type="number" placeholder="0" data-i18n-placeholder="0-placeholder" name="attr_xp" />

          <h4 class="sheet-left" data-i18n="background-label">Background</h4>
          <input class="sheet-left" type="text" placeholder="Background" data-i18n-placeholder="background-placeholder" name="attr_background" />
        </div>

        <!-- LEVEL -->
        <div class="sheet-main-header-class sheet-hidden">
          <h4 data-i18n="glevel-label">G.Level</h4>
          <input type="number" value="0" name="attr_level" readonly />
        </div>

        <script id="LEVEL : TOTAL LEVEL CALC" type="text/worker">
          const recalcTotalLevel = () => {
            getSectionIDs("classarchetype", ids => {
              const fields = ids.map(id => `repeating_classarchetype_${id}_level`);

              if (!fields.length) {
                setAttrs({ level: 0 });
                return;
              }

              getAttrs(fields, v => {
                const total = fields.reduce((sum, a) => {
                  const n = parseInt(v[a] || 0, 10);
                  return sum + (isNaN(n) ? 0 : n);
                }, 0);

                setAttrs({ level: total });
              });
            });
          };

          on(
            "sheet:opened " +
            "change:repeating_classarchetype:level " +
            "remove:repeating_classarchetype",
            recalcTotalLevel
          );
        </script>

        <div class="sheet-header-bloc1">
          <h4 class="sheet-left" data-i18n="class-label">Class</h4>
          <h4 class="sheet-left" data-i18n="archetype-label">Archetype</h4>
          <h4 data-i18n="hit-dice-label">Hit Dice</h4>
          <h4 data-i18n="level-label">Level</h4>
        </div>
        <!-- FIELDSET CLASSES -->
        <fieldset class="repeating_classarchetype">
          <div class="sheet-header-bloc1">
            <input type="text" placeholder="Class" data-i18n-placeholder="class-placeholder" name="attr_class" />
            <input type="text" placeholder="Archetype" data-i18n-placeholder="archetype-placeholder" name="attr_archetype" />
            <input type="text" value="0" name="attr_hitdice" />
            <input type="number" value="0" name="attr_level" />
          </div>
        </fieldset>
      </div>
    </div>

    <!-- ----- MENU2 -----  -->
    <div class="sheet-main-menu sheet-main-menu2">
      <!-- ----- ROLL PRIVACY -----  -->
      <div class="sheet-main-menu-privacy sheet-triplecolumn sheet-standardbox sheet-standardbox2">
        <!-- -->
        <div class="sheet-button-holder">
          <!-- -->
          <input id="public" class="sheet-globalprivacy" type="radio" value="&nbsp;" name="attr_global-privacy-status" checked />
          <label for="public" data-i18n="pc-label">PC</label>
          <!-- -->
        </div>
        <!-- -->
        <div class="sheet-button-holder">
          <!-- -->
          <input id="to-gm" class="sheet-globalprivacy" type="radio" value="/w gm" name="attr_global-privacy-status" />
          <label for="to-gm" data-i18n="gm-label">GM</label>
          <!-- -->
        </div>
        <!-- -->
        <div class="sheet-button-holder">
          <!-- -->
          <input id="private" class="sheet-globalprivacy" type="radio" value="/me" name="attr_global-privacy-status" />
          <label for="private" data-i18n="pv-label">PV</label>
          <!-- -->
        </div>
      </div>

      <!-- ----- ROLL STATUT -----  -->
      <div class="sheet-main-menu-statut sheet-triplecolumn sheet-standardbox sheet-standardbox2">
        <!-- -->
        <div class="sheet-button-holder">
          <!-- -->
          <input id="advantage" class="input-colored2" type="radio" value="advantage" name="attr_global-advantage-status" />
          <label for="advantage" data-i18n="adv-label">ADV</label>
          <!-- -->
        </div>
        <!-- -->
        <div class="sheet-button-holder">
          <!-- -->
          <input id="standard" class="input-colored1" type="radio" value="standard" name="attr_global-advantage-status" checked />
          <label for="standard" data-i18n="std-label">STD</label>
          <!-- -->
        </div>
        <!-- -->
        <div class="sheet-button-holder">
          <!-- -->
          <input id="disadvantage" class="input-colored2" type="radio" value="disadvantage" name="attr_global-advantage-status" />
          <label for="disadvantage" data-i18n="dis-label">DIS</label>
          <!-- -->
        </div>
      </div>

      <!-- ----- SHEET TYPE -----  -->
      <div class="sheet-main-menu-npcornot sheet-standardbox sheet-standardbox2">
        <!-- -->
        <div class="sheet-button-holder">
          <!-- -->
          <input id="player" class="input-colored2" type="radio" value="player" name="attr_npcornot-status" checked />
          <label for="player"><span class="material-symbols-outlined"> accessibility </span></label>
          <!-- -->
        </div>
        <!-- -->
        <div class="sheet-button-holder">
          <!-- -->
          <input id="npc" class="input-colored1" type="radio" value="npc" name="attr_npcornot-status" />
          <label for="npc"><span class="material-symbols-outlined"> chess_knight </span></label>
          <!-- -->
        </div>
      </div>

      <!-- ----- SHEET TYPE -----  -->
      <div class="sheet-main-menu-roll sheet-standardbox sheet-standardbox2">
        <!-- -->
        <div class="sheet-button-holder">
          <!-- -->
          <button type="roll" class="sheet-reallyspecialbutton sheet-button-roll" name="roll_talent" value="@{global-privacy-status} &{template:levelup} {{name=Custom}} {{charactername=@{character_name}}} {{category=A&S}} {{@{global-advantage-status}=1}} {{roll=[[?{Roll}]]}} {{roll1=[[?{Roll}]]}} {{roll2=[[?{Roll}]]}}"></button>
          <!-- -->
        </div>
      </div>
    </div>
  </div>

  <!-- ----- MENU -----  -->
  <div class="sheet-main-menu">
    <!-- ----- TRUE MENU -----  -->
    <div class="sheet-main-menu-mainone sheet-standardbox sheet-standardbox2">
      <div class="sheet-oneline">
        <div class="sheet-online">
          <input type="radio" value="sheet-character" name="attr_changepage" checked />
          <label class="radio-button" data-i18n="character-label">Character</label>
        </div>
        <div class="sheet-online">
          <input type="radio" value="sheet-spells" name="attr_changepage" />
          <label class="radio-button" data-i18n="spells-label">Spells</label>
        </div>
        <div class="sheet-online">
          <input type="radio" value="sheet-combats" name="attr_changepage" />
          <label class="radio-button" data-i18n="combat-label">Combat</label>
        </div>
        <div class="sheet-online">
          <input type="radio" value="sheet-maneuvers" name="attr_changepage" />
          <label class="radio-button" data-i18n="maneuvers-label">Maneuvers</label>
        </div>
        <div class="sheet-online">
          <input type="radio" value="sheet-features" name="attr_changepage" />
          <label class="radio-button" data-i18n="features-label">Features</label>
        </div>
        <div class="sheet-online">
          <input type="radio" value="sheet-inventaire" name="attr_changepage" />
          <label class="radio-button" data-i18n="inventory-label">Inventory</label>
        </div>
        <div class="sheet-online">
          <input type="radio" value="sheet-background" name="attr_changepage" />
          <label class="radio-button" data-i18n="background-label">Background</label>
        </div>
        <div class="sheet-online">
          <input type="radio" value="sheet-admin" name="attr_changepage" />
          <label class="radio-button"><span class="material-symbols-outlined">manufacturing</span></label>
        </div>
      </div>
    </div>

    <script id="✓ CALC : Display Page" type="text/worker">
      on("sheet:opened change:changepage", function () {
        getAttrs(["changepage"], function (values) {

          const selectedPage = values.changepage || "sheet-character";

          const pageMap = {
            "sheet-character": "sheet-character-display",
            "sheet-spells": "sheet-spells-display",
            "sheet-maneuvers": "sheet-maneuvers-display",
            "sheet-admin": "sheet-admin-display",
            "sheet-features": "sheet-features-display",
            "sheet-inventaire": "sheet-inventaire-display",
            "sheet-combats": "sheet-combats-display",
            "sheet-background": "sheet-background-display"
          };

          Object.keys(pageMap).forEach(pageKey => {
            const element = $20(`.${pageMap[pageKey]}`);
            if (selectedPage === pageKey) {
              element.removeClass("sheet-hidden");
            } else {
              element.addClass("sheet-hidden");
            }
          });

        });
      });
    </script>
  </div>

  <!-- ----- ADMIN -----  -->
  <div class="sheet-admin-display sheet-hidden">
    <!-- ----- ADMIN LEFT -----  -->
    <div class="sheet-adminleft">
      <!-- ----- GLOBAL BONUSES -----  -->
      <div class="sheet-standardbox sheet-standardbox2">
        <h4 class="sheet-minititles2" style="grid-column: 1/-1" data-i18n="global-label">Global</h4>
        <div class="sheet-oneline">
          <h3 data-i18n="global-ability-bonus-label">Global Ability Bonus</h3>
          <input type="number" value="0" name="attr_global-ability-bonus" />
          <h3 data-i18n="global-skill-bonus-label">Global Skill Bonus</h3>
          <input type="number" value="0" name="attr_global-skill-bonus" />
          <h3 data-i18n="global-passive-bonus-label">Global Passive Bonus</h3>
          <input type="number" value="0" name="attr_global-passive-bonus" />
          <h3 data-i18n="global-save-bonus-label">Global Save Bonus</h3>
          <input type="number" value="0" name="attr_global-save-bonus" />
        </div>
      </div>

      <!-- ----- SPECIFICITIES -----  -->
      <div class="sheet-standardbox sheet-standardbox2">
        <h4 class="sheet-minititles2" style="grid-column: 1/-1" data-i18n="specificities-label">Specificities</h4>
        <div class="sheet-oneline">
          <h3 data-i18n="spells-points-activated-label">Spells Points Activated</h3>
          <input type="checkbox" value="1" name="attr_spellpoints" />
        </div>
      </div>

      <!-- ----- SPECIFICITIES -----  -->
      <div class="sheet-standardbox sheet-standardbox2">
        <h4 class="sheet-minititles2" style="grid-column: 1/-1" data-i18n="inventory-label">Inventory</h4>
        <div class="sheet-oneline">
          <h3 data-i18n="weight-of-coins-label">Weight of coins</h3>
          <input type="checkbox" value="1" name="attr_weightofcoins" />
        </div>
      </div>

      <!-- ----- ABILITY BONUSES ----- -->
      <div class="sheet-standardbox sheet-standardbox2">
        <h4 class="sheet-minititles2" style="grid-column: 1/-1" data-i18n="ability-bonuses-label">Ability Bonuses</h4>

        <div class="sheet-oneline">
          <h3 data-i18n="strength-bonus-label">Strength Bonus</h3>
          <input type="number" value="0" name="attr_strength-ability-bonus" />

          <h3 data-i18n="dexterity-bonus-label">Dexterity Bonus</h3>
          <input type="number" value="0" name="attr_dexterity-ability-bonus" />

          <h3 data-i18n="constitution-bonus-label">Constitution Bonus</h3>
          <input type="number" value="0" name="attr_constitution-ability-bonus" />

          <h3 data-i18n="intelligence-bonus-label">Intelligence Bonus</h3>
          <input type="number" value="0" name="attr_intelligence-ability-bonus" />

          <h3 data-i18n="wisdom-bonus-label">Wisdom Bonus</h3>
          <input type="number" value="0" name="attr_wisdom-ability-bonus" />

          <h3 data-i18n="charisma-bonus-label">Charisma Bonus</h3>
          <input type="number" value="0" name="attr_charisma-ability-bonus" />
        </div>
      </div>
    </div>

    <!-- ----- ADMIN LEFT -----  -->
    <div class="sheet-adminright">
      <!-- ----- SKILLS BONUSES -----  -->
      <div class="sheet-standardbox sheet-standardbox2">
        <h4 class="sheet-minititles2" style="grid-column: 1/-1" data-i18n="skills-bonuses-label">Skills Bonuses</h4>

        <div class="sheet-oneline">
          <h3 data-i18n="acrobatics-label">Acrobatics</h3>
          <input type="number" name="attr_acrobatics_bonus" value="0" />
          <h3 data-i18n="animal-handling-label">Animal Handling</h3>
          <input type="number" name="attr_animalhandling_bonus" value="0" />
          <h3 data-i18n="arcana-label">Arcana</h3>
          <input type="number" name="attr_arcana_bonus" value="0" />
          <h3 data-i18n="athletics-label">Athletics</h3>
          <input type="number" name="attr_athletics_bonus" value="0" />
          <h3 data-i18n="culture-label">Culture</h3>
          <input type="number" name="attr_culture_bonus" value="0" />
          <h3 data-i18n="deception-label">Deception</h3>
          <input type="number" name="attr_deception_bonus" value="0" />
          <h3 data-i18n="engineering-label">Engineering</h3>
          <input type="number" name="attr_engineering_bonus" value="0" />
          <h3 data-i18n="history-label">History</h3>
          <input type="number" name="attr_history_bonus" value="0" />
          <h3 data-i18n="insight-label">Insight</h3>
          <input type="number" name="attr_insight_bonus" value="0" />
          <h3 data-i18n="intimidation-label">Intimidation</h3>
          <input type="number" name="attr_intimidation_bonus" value="0" />
          <h3 data-i18n="investigation-label">Investigation</h3>
          <input type="number" name="attr_investigation_bonus" value="0" />
          <h3 data-i18n="medicine-label">Medicine</h3>
          <input type="number" name="attr_medicine_bonus" value="0" />
          <h3 data-i18n="nature-label">Nature</h3>
          <input type="number" name="attr_nature_bonus" value="0" />
          <h3 data-i18n="perception-label">Perception</h3>
          <input type="number" name="attr_perception_bonus" value="0" />
          <h3 data-i18n="performance-label">Performance</h3>
          <input type="number" name="attr_performance_bonus" value="0" />
          <h3 data-i18n="persuasion-label">Persuasion</h3>
          <input type="number" name="attr_persuasion_bonus" value="0" />
          <h3 data-i18n="religion-label">Religion</h3>
          <input type="number" name="attr_religion_bonus" value="0" />
          <h3 data-i18n="sleight-of-hand-label">Sleight of Hand</h3>
          <input type="number" name="attr_sleightofhand_bonus" value="0" />
          <h3 data-i18n="stealth-label">Stealth</h3>
          <input type="number" name="attr_stealth_bonus" value="0" />
          <h3 data-i18n="survival-label">Survival</h3>
          <input type="number" name="attr_survival_bonus" value="0" />
          <h3 data-i18n="vehicles-label">Vehicles</h3>
          <input type="number" name="attr_vehicles_bonus" value="0" />
        </div>
      </div>

       <div class="sheet-standardbox sheet-standardbox2">
        <h4 class="sheet-minititles2" style="grid-column: 1/-1" data-i18n="roll-label">Roll</h4>

        <div class="sheet-oneline">
          <h3 data-i18n="critical-label">Critical</h3>
          <input type="number" name="attr_criticalrange" value="20" />
        </div>
      </div>
    </div>
  </div>

  <!-- ----- FEATURES -----  -->
  <div class="sheet-features-display sheet-hidden">
    <div class="sheet-globalonmetcala">
      <div class="sheet-main-categoryfeatures sheet-standardbox sheet-standardbox2">
        <div class="sheet-main-categoryfeatures3 sheet-oneline">
          <h4 class="sheet-left" data-i18n="features-source-filter-label">Features Source Filter</h4>
          <input type="text" placeholder="-" value="" name="attr_features-sections-filter" />
        </div>
      </div>

      <script id="✓ CALC : Features Filter" type="text/worker">
        on("sheet:opened change:features-sections-filter change:repeating_features-traits", function () {
          console.log("=== FILTER UPDATE ===");

          getSectionIDs("repeating_features-traits", function (ids) {
            const attrs = ["features-sections-filter"];

            ids.forEach(id => {
              attrs.push(`repeating_features-traits_${id}_features-source`);
              attrs.push(`repeating_features-traits_${id}_sheet-filter-row`);
            });

            getAttrs(attrs, function (v) {
              const rawFilter = v["features-sections-filter"] || "";
              const filter = rawFilter.trim().toLowerCase();

              console.log("Filter value:", rawFilter, "| cleaned:", filter);
              console.log("Rows IDs:", ids);

              const updates = {};

              ids.forEach(id => {
                const sourceKey = `repeating_features-traits_${id}_features-source`;
                const flagKey   = `repeating_features-traits_${id}_sheet-filter-row`;

                const sourceRaw = v[sourceKey] || "";
                const source    = sourceRaw.trim().toLowerCase();
                const before    = v[flagKey];

                console.log(
                  `Row ${id} | BEFORE sheet-filter-row =`,
                  before,
                  `| Source raw: "${sourceRaw}" | cleaned: "${source}"`
                );

                let newVal;

                if (!filter) {
                  newVal = "0";
                } else {
                  if (source.includes(filter)) {
                    newVal = "0"; // visible
                  } else {
                    newVal = "1"; // caché
                  }
                }

                updates[flagKey] = newVal;

                console.log(
                  `Row ${id} | AFTER sheet-filter-row =`,
                  newVal,
                  filter
                    ? (source.includes(filter)
                        ? `| MATCH: "${source}" includes "${filter}" → visible`
                        : `| NO MATCH: "${source}" does not include "${filter}" → hidden`)
                    : "| No filter → all visible"
                );
              });

              console.log("Final updates sent to setAttrs:", updates);
              setAttrs(updates);
            });
          });
        });
      </script>

      <div class="sheet-main-categoryfeatures sheet-standardbox sheet-standardbox2">
        <h4 class="sheet-minititles2 sheet-main-characterstatusupgrades" data-i18n="features-traits-label">Features & Traits</h4>

        <div class="sheet-standardbox sheet-standardbox1">
          <div class="sheet-oneline">
            <fieldset class="repeating_features-traits">
              <input class="sheet-hidden sheet-filter-row" type="checkbox" value="0" name="attr_sheet-filter-row" />

              <div class="sheet-filter-row-div">
                <input class="sheet-hidden sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />

                <div class="sheet-features-traits sheet-cogs-hideshow-div1">
                  <input class="sheet-left" type="text" placeholder="Name" data-i18n-placeholder="name-placeholder" name="attr_features-names" />
                  <div class="sheet-cogs-container">
                    <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                    <span class="sheet-cogs-icon">y</span>
                  </div>

                  <input style="grid-column: 1/-1" class="sheet-left" type="text" value="-" name="attr_features-source" />
                  <textarea style="grid-column: 1/-1" type="text" value="-" name="attr_features-description"></textarea>
                </div>

                <div class="sheet-features-traits2 sheet-cogs-hideshow-div2">
                  <div class="sheet-button-div-holder">
                    <input class="sheet-cogs-input sheet-description-hideshow" type="checkbox" name="attr_sheet-description-hideshow" />
                    <span class="sheet-left" type="text" placeholder="Name" name="attr_features-names"></span>
                  </div>

                  <div class="sheet-cogs-container sheet-button-div-holder">
                    <button type="roll" class="sheet-button-description" name="roll_features_description" value="@{global-privacy-status} &amp;{template:levelup-description} {{name=@{features-names}}} {{category=Description}} {{source=@{features-source}}} {{description=@{features-description}}}"></button>
                    <span class="sheet-cogs-icon">w</span>
                  </div>

                  <div class="sheet-cogs-container">
                    <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                    <span class="sheet-cogs-icon">y</span>
                  </div>

                  <input class="sheet-hidden sheet-description-hideshow" type="checkbox" name="attr_sheet-description-hideshow" />
                  <span style="grid-column: 1/-1" class="sheet-left" type="text" value="-" name="attr_features-source"></span>
                  <textarea class="sheet-description-hideshow-div" style="grid-column: 1/-1" type="text" value="-" name="attr_features-description" readonly></textarea>
                </div>
              </div>
            </fieldset>
          </div>
        </div>
      </div>
    </div>

    <div class="sheet-globalonmetcala">
      <div class="sheet-standardbox sheet-standardbox2">
        <div class="sheet-main-categoryfeatures2 sheet-oneline">
          <h4 class="sheet-left" data-i18n="class-features-section-label">Class Features Section</h4>
          <input type="number" value="0" name="attr_features-sections-number" />
        </div>
      </div>

      <script id="✓ CALC : Display Features Sections" type="text/worker">
        on("sheet:opened change:features-sections-number", function () {
          getAttrs(["features-sections-number"], function (values) {
            let nb = parseInt(values["features-sections-number"], 10) || 0;

            // bornes de sécurité
            if (nb < 0) nb = 0;
            if (nb > 5) nb = 5;

            for (let i = 1; i <= 5; i++) {
              const element = $20(`.sheet-main-classfeature${i}`);
              if (i <= nb) {
                element.removeClass("sheet-hidden");
              } else {
                element.addClass("sheet-hidden");
              }
            }
          });
        });
      </script>

      <!-- ----- CLASS FEATURES 1 -----  -->
      <div class="sheet-main-classfeature1 sheet-standardbox sheet-standardbox2">
        <input type="text" value="Class Feature I" class="sheet-minititles2 sheet-main-titlestatistics" />
        <div class="sheet-oneline" style="margin-top: 10px !important">
          <!-- FIELDSET CLASS FEATURES 1 -->
          <fieldset class="repeating_classfeature1">
            <div class="sheet-inventaire">
              <input class="sheet-left" type="text" style="grid-column: 1/-1" placeholder="Class Feature I Name" data-i18n-placeholder="class-feature-i-name-placeholder" name="attr_classfeature_name" />
            </div>
          </fieldset>
        </div>
      </div>

      <!-- ----- CLASS FEATURES II -----  -->
      <div class="sheet-main-classfeature2 sheet-standardbox sheet-standardbox2">
        <input type="text" value="Class Feature II" class="sheet-minititles2 sheet-main-titlestatistics" />
        <div class="sheet-oneline" style="margin-top: 10px !important">
          <!-- FIELDSET CLASS FEATURES 2 -->
          <fieldset class="repeating_classfeature2">
            <div class="sheet-inventaire">
              <input class="sheet-left" type="text" style="grid-column: 1/-1" placeholder="Class Feature II Name" data-i18n-placeholder="class-feature-ii-name-placeholder" name="attr_classfeature2_name" />
            </div>
          </fieldset>
        </div>
      </div>

      <!-- ----- CLASS FEATURES III -----  -->
      <div class="sheet-main-classfeature3 sheet-standardbox sheet-standardbox2">
        <input type="text" value="Class Feature III" class="sheet-minititles2 sheet-main-titlestatistics" />
        <div class="sheet-oneline" style="margin-top: 10px !important">
          <!-- FIELDSET CLASS FEATURES 3 -->
          <fieldset class="repeating_classfeature3">
            <div class="sheet-inventaire">
              <input class="sheet-left" type="text" style="grid-column: 1/-1" placeholder="Class Feature III Name" data-i18n-placeholder="class-feature-iii-name-placeholder" name="attr_classfeature3_name" />
            </div>
          </fieldset>
        </div>
      </div>

      <!-- ----- CLASS FEATURES IV -----  -->
      <div class="sheet-main-classfeature4 sheet-standardbox sheet-standardbox2">
        <input type="text" value="Class Feature IV" class="sheet-minititles2 sheet-main-titlestatistics" />
        <div class="sheet-oneline" style="margin-top: 10px !important">
          <!-- FIELDSET CLASS FEATURES 4 -->
          <fieldset class="repeating_classfeature4">
            <div class="sheet-inventaire">
              <input class="sheet-left" type="text" style="grid-column: 1/-1" placeholder="Class Feature IV Name" data-i18n-placeholder="class-feature-iv-name-placeholder" name="attr_classfeature4_name" />
            </div>
          </fieldset>
        </div>
      </div>

      <!-- ----- CLASS FEATURES V -----  -->
      <div class="sheet-main-classfeature5 sheet-standardbox sheet-standardbox2">
        <input type="text" value="Class Feature V" class="sheet-minititles2 sheet-main-titlestatistics" />
        <div class="sheet-oneline" style="margin-top: 10px !important">
          <!-- FIELDSET CLASS FEATURES 5 -->
          <fieldset class="repeating_classfeature5">
            <div class="sheet-inventaire">
              <input class="sheet-left" type="text" style="grid-column: 1/-1" placeholder="Class Feature V Name" data-i18n-placeholder="class-feature-v-name-placeholder" name="attr_classfeature5_name" />
            </div>
          </fieldset>
        </div>
      </div>
    </div>
  </div>

  <!-- ----- INVENTAIRE -----  -->
  <div class="sheet-inventaire-display sheet-hidden">
    <div class="sheet-section-separator">
      <!-- ----- INVENTAIRE -----  -->
      <div class="sheet-main-inventaire sheet-standardbox sheet-standardbox2">
        <h4 class="sheet-minititles2 sheet-main-titlestatistics" data-i18n="items-label">Items</h4>
        <div class="sheet-oneline">
          <div class="sheet-inventaire">
            <h4 class="sheet-left" data-i18n="item-name-label">Item Name</h4>
            <h4 data-i18n="nmb-label">NMB</h4>
            <h4 data-i18n="wgt-label">WGT</h4>
          </div>

          <!-- FIELDSET INVENTAIRE -->
          <fieldset class="repeating_item-inventory">
            <div class="sheet-inventaire">
              <input class="sheet-left" type="text" placeholder="Item Name" data-i18n-placeholder="item-name-placeholder" name="attr_inventaire_name" />
              <input type="number" step="0.01" placeholder="0" data-i18n-placeholder="0-placeholder" value="1" name="attr_inventaire_quantity" />
              <input type="number" step="0.01" placeholder="0" data-i18n-placeholder="0-placeholder" value="0" name="attr_inventaire_weight" />
            </div>
          </fieldset>
        </div>
      </div>

      <!-- ----- BULKY ITEM -----  -->
      <div class="sheet-main-bulkyitem sheet-standardbox sheet-standardbox2">
        <h4 class="sheet-minititles2 sheet-main-titlestatistics" data-i18n="bulky-items-label">Bulky Items</h4>
        <div class="sheet-oneline" style="margin-top: 10px !important">
          <!-- FIELDSET BULKY ITEMS -->
          <fieldset class="repeating_bulkyitems">
            <div class="sheet-inventaire">
              <input class="sheet-left" type="text" style="grid-column: 1/-1" placeholder="Bulky Item Name" data-i18n-placeholder="bulky-item-name-placeholder" name="attr_bulkyitems_name" />
            </div>
          </fieldset>
        </div>
      </div>

      <script id="INVENTORY : BULKY ITEMS COUNT" type="text/worker">
        const recalcBulkyItems = () => {
          getSectionIDs("bulkyitems", ids => {
            setAttrs({
              currentbulkyitems: ids.length
            });
          });
        };

        on(
          "change:repeating_bulkyitems " +
          "remove:repeating_bulkyitems " +
          "sheet:opened",
          () => {
            recalcBulkyItems();
          }
        );
      </script>
    </div>

    <div class="sheet-section-separator">
      <!-- ----- WEAPONS -----  -->
      <div class="sheet-main-inventaire sheet-standardbox sheet-standardbox2">
        <h4 class="sheet-minititles2 sheet-main-titlestatistics" data-i18n="weapons-label">Weapons</h4>
        <div class="sheet-oneline">
          <div class="sheet-inventaire">
            <h4 class="sheet-left" data-i18n="weapon-name-label">Weapon Name</h4>
            <h4 data-i18n="nmb-label">NMB</h4>
            <h4 data-i18n="wgt-label">WGT</h4>
          </div>

          <!-- FIELDSET INVENTAIRE -->
          <fieldset class="repeating_item-weapon">
            <div class="sheet-inventaire">
              <input class="sheet-left" type="text" placeholder="Item Name" data-i18n-placeholder="item-name-placeholder" name="attr_inventaire_name" />
              <input type="number" step="0.01" placeholder="0" data-i18n-placeholder="0-placeholder" value="1" name="attr_inventaire_quantity" />
              <input type="number" step="0.01" placeholder="0" data-i18n-placeholder="0-placeholder" value="0" name="attr_inventaire_weight" />
            </div>
          </fieldset>
        </div>
      </div>

      <!-- ----- EQUIPMENT -----  -->
      <div class="sheet-main-inventaire sheet-standardbox sheet-standardbox2">
        <h4 class="sheet-minititles2 sheet-main-titlestatistics" data-i18n="equipments-label">Equipments</h4>
        <div class="sheet-oneline">
          <div class="sheet-inventaire">
            <h4 class="sheet-left" data-i18n="equipments-name-label">Equipments Name</h4>
            <h4 data-i18n="nmb-label">NMB</h4>
            <h4 data-i18n="wgt-label">WGT</h4>
          </div>

          <!-- FIELDSET INVENTAIRE -->
          <fieldset class="repeating_item-equipment">
            <div class="sheet-inventaire">
              <input class="sheet-left" type="text" placeholder="Item Name" data-i18n-placeholder="item-name-placeholder" name="attr_inventaire_name" />
              <input type="number" step="0.01" placeholder="0" data-i18n-placeholder="0-placeholder" value="1" name="attr_inventaire_quantity" />
              <input type="number" step="0.01" placeholder="0" data-i18n-placeholder="0-placeholder" value="0" name="attr_inventaire_weight" />
            </div>
          </fieldset>
        </div>
      </div>
    </div>

    <div class="sheet-section-separator">
      <!-- ----- MONEY -----  -->
      <div class="sheet-main-money sheet-standardbox sheet-standardbox2">
        <div class="sheet-oneline sheet-coin-menu">
          <!-- Copper -->
          <div class="sheet-coin">
            <h3 class="sheet-label">CP&nbsp;&nbsp;<img src="https://app.roll20.net/images/dndstyling/copper.png" alt="Copper" /></h3>
            <input class="sheet-inputchar2" type="number" value="0" step="1" name="attr_cp" />
          </div>

          <!-- Silver -->
          <div class="sheet-coin">
            <h3 class="sheet-label">SP&nbsp;&nbsp;<img src="https://app.roll20.net/images/dndstyling/silver.png" alt="Silver" /></h3>
            <input class="sheet-inputchar2" type="number" value="0" step="1" name="attr_sp" />
          </div>

          <!-- Electrum -->
          <div class="sheet-coin">
            <h3 class="sheet-label">EP&nbsp;&nbsp;<img src="https://app.roll20.net/images/dndstyling/electrum.png" alt="Electrum" /></h3>
            <input class="sheet-inputchar2" type="number" value="0" step="1" name="attr_ep" />
          </div>

          <!-- Gold -->
          <div class="sheet-coin">
            <h3 class="sheet-label">GP&nbsp;&nbsp;<img src="https://app.roll20.net/images/dndstyling/gold.png" alt="Gold" /></h3>
            <input class="sheet-inputchar2" type="number" value="0" step="1" name="attr_gp" />
          </div>

          <!-- Platinum -->
          <div class="sheet-coin">
            <h3 class="sheet-label">PP&nbsp;&nbsp;<img src="https://app.roll20.net/images/dndstyling/platnum.png" alt="Platinum" /></h3>
            <input class="sheet-inputchar2" type="number" value="0" step="1" name="attr_pp" />
          </div>

          <input class="sheet-hidden" type="number" value="0" step="1" name="attr_totalcoins" />

          <script id="INVENTORY : TOTAL COINS CALCULATION" type="text/worker">
            const toNum = v => {
              const n = parseInt(v, 10);
              return isNaN(n) ? 0 : n;
            };

            const recalcTotalCoins = () => {
              getAttrs(["pp", "gp", "ep", "sp", "cp"], v => {
                const totalcoins =
                  toNum(v.pp) +
                  toNum(v.gp) +
                  toNum(v.ep) +
                  toNum(v.sp) +
                  toNum(v.cp);

                setAttrs({ totalcoins });
              });
            };

            on(
              "change:pp change:gp change:ep change:sp change:cp sheet:opened",
              () => {
                recalcTotalCoins();
              }
            );
          </script>
        </div>
      </div>

      <!-- ----- WEIGHT -----  -->
      <div class="sheet-main-inventaire sheet-standardbox sheet-standardbox2">
        <div class="sheet-oneline">
          <div class="sheet-triplecolumn">
            <div class="sheet-standardbox sheet-standardbox1">
              <div class="sheet-oneline">
                <div style="grid-template-columns: 1fr; width: 100% !important" class="sheet-equipment2">
                  <h4 style="line-height: 9px" data-i18n="supply-label">Supply</h4>
                  <div class="sheet-sololine" style="width: 100% !important">
                    <input class="sheet-vanilla sheet-inputchar sheet-totalweight" type="number" step="1" value="0" name="attr_current-supply" />
                    <div class="sheet-online">
                      <input type="number" step="1" value="0" name="attr_max-supply" class="sheet-specialborder" />
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="sheet-standardbox sheet-standardbox1">
              <div class="sheet-oneline">
                <div style="grid-template-columns: 1fr" class="sheet-equipment2">
                  <h4 style="line-height: 9px" data-i18n="weight-label">Weight</h4>
                  <input class="sheet-vanilla sheet-inputchar sheet-totalweight" type="number" step="0.01" value="0" name="attr_totalweight" readonly />
                  <div class="sheet-online">
                    <input type="number" step="0.01" value="0" name="attr_totalweight_max" readonly class="sheet-specialborder" />
                  </div>
                </div>
              </div>
            </div>

            <div class="sheet-standardbox sheet-standardbox1">
              <div class="sheet-oneline">
                <div style="grid-template-columns: 1fr" class="sheet-equipment2">
                  <h4 style="line-height: 9px" data-i18n="max-bulky-label">Max Bulky</h4>
                  <div class="sheet-sololine">
                    <input class="sheet-vanilla sheet-inputchar sheet-totalweight" type="number" step="1" value="0" name="attr_currentbulkyitems" readonly />
                    <div class="sheet-online">
                      <input type="number" step="1" value="0" name="attr_maxbulkyitems" class="sheet-specialborder" readonly />
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <script id="INVENTORY : TOTAL WEIGHT CALCULATION" type="text/worker">
        const weightSections = ["item-weapon","item-inventory","item-equipment"];

        const clampMin = (n, min) => Math.max(min, n);
        const toNum = v => {
          const n = parseFloat(v);
          return isNaN(n) ? 0 : n;
        };

        const isChecked = v => {
          const s = String(v).toLowerCase();
          return s === "1" || s === "on" || s === "true";
        };

        const recalcTotalWeight = () => {
          const allAttrs = [];
          let pending = weightSections.length;
          if (!pending) return;

          weightSections.forEach(section => {
            getSectionIDs(section, ids => {
              ids.forEach(id => {
                allAttrs.push(`repeating_${section}_${id}_inventaire_totalweight`);
              });

              pending -= 1;

              if (pending === 0) {
                getAttrs(
                  allAttrs.concat([
                    "weightofcoins",
                    "totalcoins",
                    "strength",
                    "strength-bonus"
                  ]),
                  v => {
                    let t = 0;
                    allAttrs.forEach(a => (t += toNum(v[a])));

                    if (isChecked(v.weightofcoins)) {
                      const coinsSum = toNum(v.totalcoins);
                      const coinsWeight = Math.floor(coinsSum / 50);
                      t += coinsWeight;
                    }

                    const str = toNum(v.strength);
                    const strBonus = toNum(v["strength-bonus"]);

                    setAttrs({
                      totalweight: t,
                      totalweight_max: str * 15,
                      maxbulkyitems: clampMin(1 + strBonus, 1)
                    });
                  }
                );
              }
            });
          });
        };

        on(
          "change:repeating_item-weapon:inventaire_quantity " +
          "change:repeating_item-weapon:inventaire_weight " +
          "change:repeating_item-inventory:inventaire_quantity " +
          "change:repeating_item-inventory:inventaire_weight " +
          "change:repeating_item-equipment:inventaire_quantity " +
          "change:repeating_item-equipment:inventaire_weight",
          eventInfo => {
            const parts = eventInfo.sourceAttribute.split("_");
            const section = parts[1];
            const id = parts[2];
            const p = `repeating_${section}_${id}_`;

            getAttrs([`${p}inventaire_quantity`, `${p}inventaire_weight`], v => {
              setAttrs({
                [`${p}inventaire_totalweight`]:
                  toNum(v[`${p}inventaire_quantity`]) *
                  toNum(v[`${p}inventaire_weight`])
              });
              recalcTotalWeight();
            });
          }
        );

        on(
          "change:repeating_item-weapon:inventaire_totalweight " +
          "change:repeating_item-inventory:inventaire_totalweight " +
          "change:repeating_item-equipment:inventaire_totalweight " +
          "remove:repeating_item-weapon " +
          "remove:repeating_item-inventory " +
          "remove:repeating_item-equipment " +
          "change:weightofcoins " +
          "change:totalcoins " +
          "change:strength change:strength-bonus " +
          "sheet:opened",
          () => {
            recalcTotalWeight();
          }
        );
      </script>

      <!-- ----- TREASURE -----  -->
      <div class="sheet-main-treasure sheet-standardbox sheet-standardbox2">
        <h4 class="sheet-minititles2 sheet-main-titlestatistics" data-i18n="treasures-label">Treasures</h4>
        <div class="sheet-oneline" style="margin-top: 10px !important">
          <!-- FIELDSET TREASURE -->
          <fieldset class="repeating_treasure">
            <div class="sheet-inventaire">
              <input class="sheet-left" type="text" style="grid-column: 1/-1" placeholder="Treasure Name" data-i18n-placeholder="treasure-name-placeholder" name="attr_treasure_name" />
            </div>
          </fieldset>
        </div>
      </div>
    </div>
  </div>

<script id="✓ CALC : A&S Damages Button Links" type="text/worker">
  const section = "attacksandspells";
  const rep = `repeating_${section}`;

  const updateButtons = () => {
    getSectionIDs(section, ids => {
      const updates = {};
      ids.forEach(id => {
        updates[`${rep}_${id}_attacksorspell-button`] = `[Damages](~${id}__show-attackorspell-damages)`;
        updates[`${rep}_${id}_attacksorspell-crit-button`] = `[C](~${id}__show-attackorspell-crit-damages)`;
      });
      setAttrs(updates, { silent: true });
    });
  };

  on(`sheet:opened change:${rep} remove:${rep}`, updateButtons);
</script>


  <!-- ----- COMBAT -----  -->
  <div class="sheet-combats-display sheet-hidden">
    <div class="sheet-mainsection-combat1">
      <!-- ----- ATTACK & SPELLCASTING -----  -->
      <div class="sheet-standardbox sheet-standardbox2">
        <h4 class="sheet-minititles2 sheet-main-titlestatistics" data-i18n="attacks-spells-label">Attacks & Spells</h4>
        <div class="sheet-oneline">
          <div class="sheet-attacksandspells">
            <h4 data-i18n="nbsp-label">&nbsp;</h4>
            <h4 class="sheet-left" style="grid-column: 2/4" data-i18n="name-label">Name</h4>
            <h4 data-i18n="atk-b-label">ATK B.</h4>
            <h4 data-i18n="dmg-label">DMG</h4>
            <h4 data-i18n="dmg-type-label">DMG Type</h4>
            <h4 data-i18n="nbsp-label">&nbsp;</h4>
          </div>

          <!-- FIELDSET ATTACKS AND SPELLCASTINGS -->
          <fieldset class="repeating_attacksandspells">
            <input class="sheet-hidden sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />

            <div class="sheet-attacksandspells">
              <button style="max-height: 18px !important" type="roll" class="sheet-button-attack" name="roll_talent" value="@{global-privacy-status} &{template:levelup} {{name=@{attacksorspell-name}}} {{charactername=@{character_name}}} {{category=A&S}} {{@{attacks_toogle}=1}} {{@{global-advantage-status}=1}} {{roll=[[1d20cs@{criticalrange}+@{attacksorspell-atkb}+[[@{attacks_expertisedice}]]]]}} {{roll1=[[1d20cs@{criticalrange}+@{attacksorspell-atkb}+[[@{attacks_expertisedice}]]]]}} {{roll2=[[1d20cs@{criticalrange}+@{attacksorspell-atkb}+[[@{attacks_expertisedice}]]]]}} {{description=@{attacksorspell-description}}} {{buttoncrit=@{attacksorspell-crit-button}}} {{button=@{attacksorspell-button}}} {{desc=1}} {{dmg1=[[@{attacksorspell-dmg}]]}} {{dmg1crit=[[@{attacksorspell-dmg}]]}} {{dmg1type=@{attacksorspell-type}}} {{dmg2=[[@{attacksorspell-dmg2}]]}} {{dmg2crit=[[@{attacksorspell-dmg2}]]}} {{dmg2type=@{attacksorspell-type2}}}"></button>
              <input style="grid-column: 1/-1" class="sheet-hidden" type="text" value="[Damages](~show-attackorspell-damages)" name="attr_attacksorspell-button" />
              <input style="grid-column: 1/-1" class="sheet-hidden" type="text" value="[C](~show-attackorspell-crit-damages)" name="attr_attacksorspell-crit-button" />
               <button type="roll" class="sheet-hidden" name="roll_show-attackorspell-damages" value="@{global-privacy-status} &{template:levelup} {{name=Damages}} {{charactername=@{attacksorspell-name}}} {{category=A&S}} {{dmgonly=1}} {{critical=[[0]]}} {{dmg1=[[@{attacksorspell-dmg}]]}} {{dmg1type=@{attacksorspell-type}}} {{dmg2=[[@{attacksorspell-dmg2}]]}} {{dmg2type=@{attacksorspell-type2}}}"></button>
              <button type="roll" class="sheet-hidden" name="roll_show-attackorspell-crit-damages" value="@{global-privacy-status} &{template:levelup} {{name=Critical Damages}} {{charactername=@{attacksorspell-name}}} {{category=A&S}} {{dmgonly=1}} {{critical=[[1]]}} {{dmg1=[[@{attacksorspell-dmg}]]}} {{dmg1crit=[[@{attacksorspell-dmg}]]}} {{dmg1type=@{attacksorspell-type}}} {{dmg2=[[@{attacksorspell-dmg2}]]}} {{dmg2crit=[[@{attacksorspell-dmg2}]]}} {{dmg2type=@{attacksorspell-type2}}}"></button>
             
              <input class="sheet-left" type="text" placeholder="Name" data-i18n-placeholder="name-placeholder" name="attr_attacksorspell-name" style="grid-column: 2/4" />
              <input type="number" step="1" value="0" name="attr_attacksorspell-atkb" />

              <input type="text" value="0" value="" name="attr_attacksorspell-dmg" />
              <input type="text" placeholder="-" name="attr_attacksorspell-type" />

              <div class="sheet-cogs-container">
                <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                <span class="sheet-cogs-icon">y</span>
              </div>
            </div>

            <div class="sheet-attacksandspells" style="margin-top: -2px !important; margin-bottom: 8px !important">
              <h4 data-i18n="nbsp-label">&nbsp;</h4>

              <input class="sheet-left" type="text" placeholder="-" name="attr_attacksorspell-globaltype" />

              <select name="attr_attacks_toogle">
                <option value="standard" selected data-i18n="standard-option">Standard</option>
                <option value="nodmg" data-i18n="no-dmg-option">No DMG</option>
                <option value="dmgonly" data-i18n="dmg-only-option">DMG Only</option>
              </select>

              <select name="attr_attacks_expertisedice">
                <option value="0" selected="">-</option>
                <option value="1d4">d4</option>
                <option value="1d6">d6</option>
                <option value="1d8">d8</option>
                <option value="1d10">d10</option>
                <option value="1d12">d12</option>
                <option value="1d20">d20</option>
              </select>
              <input type="text" value="0" name="attr_attacksorspell-dmg2" />
              <input type="text" placeholder="-" name="attr_attacksorspell-type2" />
            </div>

            <div class="sheet-attacksandspells sheet-cogs-hideshow-div1" style="margin-top: -10px">
              <h4 data-i18n="nbsp-label">&nbsp;</h4>
              <h4 class="sheet-left" data-i18n="action-type-label">Action Type</h4>
              <h4 data-i18n="roll-type-label">Roll Type</h4>
              <h4 data-i18n="exp-label">EXP</h4>
              <h4 data-i18n="dmg-label">DMG</h4>
              <h4 data-i18n="dmg-type-label">DMG Type</h4>
              <h4 data-i18n="nbsp-label">&nbsp;</h4>
            </div>

            <textarea class="sheet-cogs-hideshow-div1" type="text" placeholder="Description" data-i18n-placeholder="description-placeholder" name="attr_attacksorspell-description"></textarea>
          </fieldset>
        </div>
      </div>

      <!-- ----- ACTIONS -----  -->
      <div class="sheet-standardbox sheet-standardbox2">
        <h4 class="sheet-minititles2 sheet-main-titlestatistics" data-i18n="actions-label">Actions</h4>
        <div class="sheet-oneline">
          <div class="sheet-actions">
            <h4 data-i18n="type-label">Type</h4>
            <h4 class="sheet-left" data-i18n="name-label">Name</h4>
            <h4 data-i18n="nbsp-label">&nbsp;</h4>
          </div>

          <!-- FIELDSET ACTIONS -->
          <fieldset class="repeating_actions">
            <input class="sheet-hidden sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />

            <div class="sheet-actions">
              <input type="text" placeholder="-" name="attr_attacksorspell-globaltype" style="border: none" />
              <input class="sheet-left" type="text" placeholder="Name" data-i18n-placeholder="name-placeholder" name="attr_attacksorspell-name" />

              <div class="sheet-cogs-container">
                <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                <span class="sheet-cogs-icon">y</span>
              </div>
            </div>

            <textarea class="sheet-cogs-hideshow-div1" type="text" placeholder="Description" data-i18n-placeholder="description-placeholder" name="attr_attacksorspell-description"></textarea>
          </fieldset>
        </div>
      </div>
    </div>

    <div class="sheet-mainsection-combat2">
      <!-- ----- STATISTIQUES -----  -->
      <div class="sheet-standardbox sheet-standardbox2">
        <h4 class="sheet-minititles2" data-i18n="hit-points-label">Hit Points</h4>

        <div class="sheet-oneline" style="gap: 5px !important">
          <div class="sheet-doublecolumn">
            <!-- ----- VITALITE ----- -->
            <div class="sheet-main-current sheet-standardbox sheet-standardbox1">
              <div class="sheet-oneline2">
                <h4 data-i18n="current-label">Current</h4>
                <div class="sheet-main-statistics-vitesse sheet-general-hideshow-div1">
                  <input class="sheet-maincolor sheet-inputchar" type="number" step="1" value="0" name="attr_hp" />
                </div>
                <div class="sheet-doublecolumn sheet-inputchar33">
                  <h4 data-i18n="temp-label">TEMP.</h4>
                  <input type="number" step="1" value="0" name="attr_hp_current-mod" />
                </div>
              </div>
            </div>

            <!-- ----- MAX HP ----- -->
            <div class="sheet-main-hp sheet-standardbox sheet-standardbox1">
              <div class="sheet-oneline2">
                <h4 data-i18n="maximum-label">Maximum</h4>
                <div class="sheet-main-statistics-maxhp sheet-general-hideshow-div1">
                  <input class="sheet-maincolor sheet-inputchar" type="number" step="1" value="0" name="attr_hp_max-display" />
                </div>
                <input class="sheet-hidden" type="number" step="1" value="0" name="attr_hp_max" />
                <div class="sheet-doublecolumn sheet-inputchar33">
                  <h4 data-i18n="mod-label">MOD.</h4>
                  <input type="number" step="1" value="0" name="attr_hp_max-mod" />
                </div>
              </div>
            </div>

            <script id="HP : MAX CALC" type="text/worker">
              on("sheet:opened change:hp_max-display change:hp_max-mod",()=>{
                getAttrs(["hp_max-display","hp_max-mod"],v=>{
                  const base = parseInt(v["hp_max-display"]||0,10);
                  const mod  = parseInt(v["hp_max-mod"]||0,10);
                  setAttrs({"hp_max": base + mod});
                });
              });
            </script>
          </div>

          <div class="sheet-progress-container-bar-menu" style="grid-column: 1/-1">
            <div class="sheet-progress-bars-menu sheet-barhp">
              <input type="number" step="0.01" value="0" name="attr_hp" readonly />
              <h4>/</h4>
              <input type="number" step="0.01" value="0" name="attr_hp_max" readonly />
            </div>
            <div class="sheet-progress-bar sheet-barhp-display"></div>
          </div>

          <script id="✓ - DISPLAY : HP Bar Progression" type="text/worker">
            const attr = "hp";
            const selector = ".sheet-barhp-display";

            function updateHPBar() {
              getAttrs([attr, `${attr}_max`], v => {
                const current = parseInt(v[attr], 10) || 0;
                const max     = parseInt(v[`${attr}_max`], 10) || 0;

                let percent = max > 0 ? Math.round((current / max) * 100) : 0;
                percent = Math.min(Math.max(percent, 0), 100);

                const bar = $20(selector);

                for (let i = 0; i <= 100; i++) {
                  bar.removeClass(`sheet-bar${i}`);
                }

                bar.addClass(`sheet-bar${percent}`);
              });
            }

            on("sheet:opened change:hp change:hp_max", updateHPBar);
          </script>

          <div class="sheet-doublecolumn-x3">
            <h4 style="text-align: left !important" data-i18n="massive-damages-label">Massive Damages :</h4>
            <!-- ----- Massive DMG ----- -->
            <input type="number" step="1" value="0" name="attr_hp_massive-damage" readonly />

            <script id="HP : MASSIVE DAMAGE CALC" type="text/worker">
              on("sheet:opened change:level",()=>{
                getAttrs(["level"],v=>{
                  const lvl=parseInt(v.level||0,10);
                  setAttrs({"hp_massive-damage":20+(lvl*3)});
                });
              });
            </script>
          </div>
          <input class="sheet-inputchar2" style="grid-column: 1/-1; max-width: none" type="text" placeholder="Armor Type" data-i18n-placeholder="armor-type-placeholder" name="attr_armor-type" style="max-width: none" />
        </div>
      </div>

      <!-- ----- INITIATIVE -----  -->
      <div class="sheet-main-initiative sheet-standardbox sheet-standardbox2">
        <div class="sheet-oneline">
          <div class="sheet-button-div-holder">
            <button type="roll" class="sheet-button-description" name="roll_initiative" value="@{global-privacy-status} &{template:levelup} {{name=Initiative}} {{roll=[[1d20+@{initiative-total}&{tracker}]]}} {{charactername=@{character_name}}} {{standard=1}} {{category=Ability}}"></button>
            <h3 data-i18n="initiative-label">Initiative</h3>
          </div>
          <input type="number" value="0" name="attr_initiative-total" readonly />
          <h3 style="text-align: center">=</h3>
          <select name="attr_initiative_selector">
            <option value="" selected="">-</option>
            <option value="STR">STR</option>
            <option value="DEX">DEX</option>
            <option value="CON">CON</option>
            <option value="INT">INT</option>
            <option value="WIS">WIS</option>
            <option value="CHA">CHA</option>
          </select>
          <h3 style="text-align: center">+</h3>
          <input type="number" value="0" name="attr_initiative-mod" />
        </div>
      </div>

      <script id="STATS : INITIATIVE TOTAL CALCULATION" type="text/worker">
        const map = {
          STR: "strength-bonus",
          DEX: "dexterity-bonus",
          CON: "constitution-bonus",
          INT: "intelligence-bonus",
          WIS: "wisdom-bonus",
          CHA: "charisma-bonus"
        };

        const fields = [
          "initiative_selector",
          "initiative-mod",
          "strength-bonus",
          "dexterity-bonus",
          "constitution-bonus",
          "intelligence-bonus",
          "wisdom-bonus",
          "charisma-bonus"
        ];

        on(fields.map(f => "change:" + f).join(" ") + " sheet:opened", () => {
          getAttrs(fields, v => {
            const sel = v.initiative_selector || "";
            const statBonus = sel ? parseInt(v[map[sel]] || 0, 10) : 0;
            const mod = parseInt(v["initiative-mod"] || 0, 10);
            setAttrs({ "initiative-total": statBonus + mod });
          });
        });
      </script>

      <!-- ----- RESOURCES -----  -->
      <div class="sheet-standardbox sheet-standardbox2">
        <h4 class="sheet-minititles2 sheet-main-titlestatistics" data-i18n="resources-label">Resources</h4>
        <div class="sheet-oneline" style="margin-top: 10px !important; width: 90% !important">
          <!-- FIELDSET RESOURCES -->
          <fieldset class="repeating_resources-tracker">
            <div class="sheet-doublecolumn">
              <div class="sheet-resource-element sheet-standardbox sheet-standardbox1">
                <div class="sheet-oneline">
                  <input type="text" class="sheet-vanilla sheet-vanilla2 sheet-inputchar" style="grid-column: 1/-1; border-radius: 0px !important" value="Name" name="attr_resource-tracker-name1" />
                  <input type="text" class="sheet-maincolor sheet-inputchar" style="grid-column: 1/-1" placeholder="-" name="attr_ressource-tracker1" />
                  <select class="sheet-vanilla sheet-vanilla2 sheet-inputchar" name="attr_ressource-tracker-resetselector1">
                    <option value="0" selected>-</option>
                    <option value="short" data-i18n="short-option">Short</option>
                    <option value="Long" data-i18n="long-option">Long</option>
                  </select>
                  <input type="text" class="sheet-vanilla sheet-vanilla2 sheet-inputchar" value="" name="attr_resource-tracker-max1" />
                </div>
              </div>

              <div class="sheet-resource-element sheet-standardbox sheet-standardbox1">
                <div class="sheet-oneline">
                  <input type="text" class="sheet-vanilla sheet-vanilla2 sheet-inputchar" style="grid-column: 1/-1; border-radius: 0px !important" value="Name" name="attr_resource-tracker-name2" />
                  <input type="text" class="sheet-maincolor sheet-inputchar" style="grid-column: 1/-1" placeholder="-" name="attr_ressource-tracker2" />
                  <select class="sheet-vanilla sheet-vanilla2 sheet-inputchar" name="attr_ressource-tracker-resetselector2">
                    <option value="0" selected>-</option>
                    <option value="short" data-i18n="short-option">Short</option>
                    <option value="Long" data-i18n="long-option">Long</option>
                  </select>
                  <input type="text" class="sheet-vanilla sheet-vanilla2 sheet-inputchar" value="" name="attr_resource-tracker-max2" />
                </div>
              </div>
            </div>
          </fieldset>
        </div>
      </div>

      <script id="REST : REST & RESOURCES" type="text/worker">
        const updateResourcesOnRest = (restType) => {
          getSectionIDs("resources-tracker", (ids) => {
            if (!ids || !ids.length) return;

            const attrs = [];
            ids.forEach((id) => {
              const prefix = `repeating_resources-tracker_${id}_`;
              attrs.push(
                `${prefix}ressource-tracker-resetselector1`,
                `${prefix}ressource-tracker-resetselector2`,
                `${prefix}resource-tracker-max1`,
                `${prefix}resource-tracker-max2`
              );
            });

            getAttrs(attrs, (v) => {
              const updates = {};

              ids.forEach((id) => {
                const prefix = `repeating_resources-tracker_${id}_`;

                const selector1 = v[`${prefix}ressource-tracker-resetselector1`] || "";
                const selector2 = v[`${prefix}ressource-tracker-resetselector2`] || "";
                const max1      = v[`${prefix}resource-tracker-max1`] || "";
                const max2      = v[`${prefix}resource-tracker-max2`] || "";

                if (selector1 === restType) {
                  updates[`${prefix}ressource-tracker1`] = max1;
                }

                if (selector2 === restType) {
                  updates[`${prefix}ressource-tracker2`] = max2;
                }
              });

              if (Object.keys(updates).length) {
                setAttrs(updates);
              }
            });
          });
        };

        on("clicked:short_rest", () => {
          updateResourcesOnRest("short");
        });

        on("clicked:long_rest", () => {
          updateResourcesOnRest("Long");
        });
      </script>

      <!-- ----- DEATH SAVES ----- -->
      <div class="sheet-main-deathsaves sheet-standardbox sheet-standardbox2">
        <div class="sheet-button-div-holder">
          <button type="roll" class="sheet-button-description" name="roll_save_death" value="/w gm &{template:levelup} {{name=Death Save}} {{deathsave=1}} {{roll=[[1d20]]}} {{roll1=[[1d20]]}} {{roll2=[[1d20]]}} {{charactername=@{character_name}}} {{standard=1}} {{category=Misc.}}"></button>
          <h4 class="sheet-minititles2 sheet-main-titlestatistics" data-i18n="death-saves-label">Death Saves</h4>
        </div>

        <div class="sheet-oneline3" style="width: 95% !important">
          <div class="sheet-triplecolumn">
            <h4 class="sheet-left" data-i18n="sucesses-label">Sucesses</h4>
            <input type="checkbox" value="1" name="attr_sucesses-1" />
            <input type="checkbox" value="1" name="attr_sucesses-2" />
            <input type="checkbox" value="1" name="attr_sucesses-3" />

            <h4 class="sheet-left" data-i18n="failures-label">Failures</h4>
            <input type="checkbox" value="1" name="attr_failures-1" />
            <input type="checkbox" value="1" name="attr_failures-2" />
            <input type="checkbox" value="1" name="attr_failures-3" />
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ----- AREA -----  -->
  <div class="sheet-maingrid-area sheet-character-display sheet-hidden">
    <!-- ----- BLOC LEFT-----  -->
    <div class="sheet-maingrid-area-left">
      <!-- ----- LEFT BLOC FIRST BLOC -----  -->
      <div class="sheet-maingrid-area-firstbloc-left">
        <!-- ----- ABI8LITIES -----  -->
        <div class="sheet-main-mainblocstat sheet-standardbox sheet-standardbox2">
          <div class="sheet-oneline" style="gap: 11px !important">
            <!-- STR -->
            <div class="sheet-main-body sheet-standardbox sheet-standardbox1">
              <div class="sheet-oneline sheet-oneline2">
                <div class="sheet-button-div-holder">
                  <button type="roll" class="sheet-button-description" name="roll_str" value="@{global-privacy-status} &{template:levelup} {{name=Strength}} {{roll=[[1d20+@{strength-bonus}+@{global-ability-bonus}+@{strength-ability-bonus}]]}} {{roll1=[[1d20+@{strength-bonus}+@{global-ability-bonus}+@{strength-ability-bonus}]]}} {{roll2=[[1d20+@{strength-bonus}+@{global-ability-bonus}+@{strength-ability-bonus}]]}} {{charactername=@{character_name}}} {{@{global-advantage-status}=1}} {{category=Ability}}"></button>
                  <h4 data-i18n="str-label">STR</h4>
                </div>
                <div class="sheet-main-statistics-strength sheet-general-hideshow-div1">
                  <input class="sheet-maincolor sheet-inputchar" type="number" value="10" name="attr_strength" />
                </div>
                <input class="sheet-inputchar2" type="number" value="0" name="attr_strength-bonus" readonly />
              </div>
            </div>

            <!-- DEX -->
            <div class="sheet-main-body sheet-standardbox sheet-standardbox1">
              <div class="sheet-oneline sheet-oneline2">
                <div class="sheet-button-div-holder">
                  <button type="roll" class="sheet-button-description" name="roll_dex" value="@{global-privacy-status} &{template:levelup} {{name=Dexterity}} {{roll=[[1d20+@{dexterity-bonus}+@{global-ability-bonus}+@{dexterity-ability-bonus}]]}} {{roll1=[[1d20+@{dexterity-bonus}+@{global-ability-bonus}+@{dexterity-ability-bonus}]]}} {{roll2=[[1d20+@{dexterity-bonus}+@{global-ability-bonus}+@{dexterity-ability-bonus}]]}} {{charactername=@{character_name}}} {{@{global-advantage-status}=1}} {{category=Ability}}"></button>
                  <h4 data-i18n="dex-label">DEX</h4>
                </div>
                <div class="sheet-main-statistics-dexterity sheet-general-hideshow-div1">
                  <input class="sheet-maincolor sheet-inputchar" type="number" value="10" name="attr_dexterity" />
                </div>
                <input class="sheet-inputchar2" type="number" value="0" name="attr_dexterity-bonus" readonly />
              </div>
            </div>

            <!-- CON -->
            <div class="sheet-main-body sheet-standardbox sheet-standardbox1">
              <div class="sheet-oneline sheet-oneline2">
                <div class="sheet-button-div-holder">
                  <button type="roll" class="sheet-button-description" name="roll_con" value="@{global-privacy-status} &{template:levelup} {{name=Constitution}} {{roll=[[1d20+@{constitution-bonus}+@{global-ability-bonus}+@{constitution-ability-bonus}]]}} {{roll1=[[1d20+@{constitution-bonus}+@{global-ability-bonus}+@{constitution-ability-bonus}]]}} {{roll2=[[1d20+@{constitution-bonus}+@{global-ability-bonus}+@{constitution-ability-bonus}]]}} {{charactername=@{character_name}}} {{@{global-advantage-status}=1}} {{category=Ability}}"></button>
                  <h4 data-i18n="con-label">CON</h4>
                </div>
                <div class="sheet-main-statistics-constitution sheet-general-hideshow-div1">
                  <input class="sheet-maincolor sheet-inputchar" type="number" value="10" name="attr_constitution" />
                </div>
                <input class="sheet-inputchar2" type="number" value="0" name="attr_constitution-bonus" readonly />
              </div>
            </div>

            <!-- INT -->
            <div class="sheet-main-body sheet-standardbox sheet-standardbox1">
              <div class="sheet-oneline sheet-oneline2">
                <div class="sheet-button-div-holder">
                  <button type="roll" class="sheet-button-description" name="roll_int" value="@{global-privacy-status} &{template:levelup} {{name=Intelligence}} {{roll=[[1d20+@{intelligence-bonus}+@{global-ability-bonus}+@{intelligence-ability-bonus}]]}} {{roll1=[[1d20+@{intelligence-bonus}+@{global-ability-bonus}+@{intelligence-ability-bonus}]]}} {{roll2=[[1d20+@{intelligence-bonus}+@{global-ability-bonus}+@{intelligence-ability-bonus}]]}} {{charactername=@{character_name}}} {{@{global-advantage-status}=1}} {{category=Ability}}"></button>
                  <h4 data-i18n="int-label">INT</h4>
                </div>
                <div class="sheet-main-statistics-intelligence sheet-general-hideshow-div1">
                  <input class="sheet-maincolor sheet-inputchar" type="number" value="10" name="attr_intelligence" />
                </div>
                <input class="sheet-inputchar2" type="number" value="0" name="attr_intelligence-bonus" readonly />
              </div>
            </div>

            <!-- WIS -->
            <div class="sheet-main-body sheet-standardbox sheet-standardbox1">
              <div class="sheet-oneline sheet-oneline2">
                <div class="sheet-button-div-holder">
                  <button type="roll" class="sheet-button-description" name="roll_wis" value="@{global-privacy-status} &{template:levelup} {{name=Wisdom}} {{roll=[[1d20+@{wisdom-bonus}+@{global-ability-bonus}+@{wisdom-ability-bonus}]]}} {{roll1=[[1d20+@{wisdom-bonus}+@{global-ability-bonus}+@{wisdom-ability-bonus}]]}} {{roll2=[[1d20+@{wisdom-bonus}+@{global-ability-bonus}+@{wisdom-ability-bonus}]]}} {{charactername=@{character_name}}} {{@{global-advantage-status}=1}} {{category=Ability}}"></button>
                  <h4 data-i18n="wis-label">WIS</h4>
                </div>
                <div class="sheet-main-statistics-wisdom sheet-general-hideshow-div1">
                  <input class="sheet-maincolor sheet-inputchar" type="number" value="10" name="attr_wisdom" />
                </div>
                <input class="sheet-inputchar2" type="number" value="0" name="attr_wisdom-bonus" readonly />
              </div>
            </div>

            <!-- CHA -->
            <div class="sheet-main-body sheet-standardbox sheet-standardbox1">
              <div class="sheet-oneline sheet-oneline2">
                <div class="sheet-button-div-holder">
                  <button type="roll" class="sheet-button-description" name="roll_cha" value="@{global-privacy-status} &{template:levelup} {{name=Charisma}} {{roll=[[1d20+@{charisma-bonus}+@{global-ability-bonus}+@{charisma-ability-bonus}]]}} {{roll1=[[1d20+@{charisma-bonus}+@{global-ability-bonus}+@{charisma-ability-bonus}]]}} {{roll2=[[1d20+@{charisma-bonus}+@{global-ability-bonus}+@{charisma-ability-bonus}]]}} {{charactername=@{character_name}}} {{@{global-advantage-status}=1}} {{category=Ability}}"></button>
                  <h4 data-i18n="cha-label">CHA</h4>
                </div>
                <div class="sheet-main-statistics-charisma sheet-general-hideshow-div1">
                  <input class="sheet-maincolor sheet-inputchar" type="number" value="10" name="attr_charisma" />
                </div>
                <input class="sheet-inputchar2" type="number" value="0" name="attr_charisma-bonus" readonly />
              </div>
            </div>
          </div>
        </div>

        <script id="STATS : ABILITY MODIFIERS CALCULATION" type="text/worker">
          const stats = ["strength","dexterity","constitution","intelligence","wisdom","charisma"];
          const calcMod = v => Math.floor(((parseInt(v,10)||0)-10)/2);

          on("change:strength change:dexterity change:constitution change:intelligence change:wisdom change:charisma sheet:opened", () => {
            getAttrs(stats, v => {
              const up = {};
              stats.forEach(s => up[`${s}-bonus`] = calcMod(v[s]));
              setAttrs(up);
            });
          });
        </script>

        <!-- ----- PROFICIENCIES BONUS -----  -->
        <div class="sheet-main-proficiencybonus sheet-standardbox sheet-standardbox2">
          <div class="sheet-oneline">
            <h3 data-i18n="proficency-bonus-label">Proficency Bonus</h3>
            <input type="number" value="0" name="attr_pb" readonly />
          </div>
        </div>

        <script id="STATS : PROFICIENCY BONUS CALCULATION" type="text/worker">
          const calcPB = lvl => {
            lvl = parseInt(lvl,10) || 0;
            return Math.floor((lvl - 1) / 4) + 2;
          };

          on("change:level sheet:opened", () => {
            getAttrs(["level"], v => {
              setAttrs({ pb: calcPB(v.level) });
            });
          });
        </script>

        <!-- ----- INSPIRATION -----  -->
        <div class="sheet-main-inspiration sheet-standardbox sheet-standardbox2">
          <div class="sheet-oneline">
            <h3 style="text-align: left" data-i18n="inspiration-label">Inspiration</h3>
            <input type="checkbox" value="1" name="attr_inspiration" />
          </div>
        </div>

        <!-- ----- SAVING THROWS -----  -->
        <div class="sheet-main-savingthrows sheet-standardbox sheet-standardbox2">
          <h4 class="sheet-minititles2 sheet-main-titlestatistics" data-i18n="saving-throw-label">Saving Throw</h4>

          <div class="sheet-oneline">
            <!-- STR -->
            <div class="sheet-main-savingthrows-str">
              <input type="checkbox" value="1" name="attr_saving_str_active" />
              <input type="number" step="1" value="0" name="attr_saving_str_value" readonly />
              <div class="sheet-button-div-holder">
                <button type="roll" class="sheet-button-description" name="roll_save_str" value="@{global-privacy-status} &{template:levelup} {{name=Strength Save}} {{roll=[[1d20+@{saving_str_value}+@{savestrength_expertisedice}]]}} {{roll1=[[1d20+@{saving_str_value}+@{savestrength_expertisedice}]]}} {{roll2=[[1d20+@{saving_str_value}+@{savestrength_expertisedice}]]}} {{charactername=@{character_name}}} {{@{global-advantage-status}=1}} {{category=Ability}}"></button>
                <h4 data-i18n="savenbspstrength-label">Save&nbsp;Strength</h4>
              </div>
              <select name="attr_savestrength_expertisedice">
                <option value="0" selected>-</option>
                <option value="1d4">d4</option>
                <option value="1d6">d6</option>
                <option value="1d8">d8</option>
                <option value="1d10">d10</option>
                <option value="1d12">d12</option>
                <option value="1d20">d20</option>
              </select>
            </div>

            <!-- DEX -->
            <div class="sheet-main-savingthrows-dex">
              <input type="checkbox" value="1" name="attr_saving_dex_active" />
              <input type="number" step="1" value="0" name="attr_saving_dex_value" readonly />
              <div class="sheet-button-div-holder">
                <button type="roll" class="sheet-button-description" name="roll_save_dex" value="@{global-privacy-status} &{template:levelup} {{name=Dexterity Save}} {{roll=[[1d20+@{saving_dex_value}+@{savedexterity_expertisedice}]]}} {{roll1=[[1d20+@{saving_dex_value}+@{savedexterity_expertisedice}]]}} {{roll2=[[1d20+@{saving_dex_value}+@{savedexterity_expertisedice}]]}} {{charactername=@{character_name}}} {{@{global-advantage-status}=1}} {{category=Ability}}"></button>
                <h4 data-i18n="savenbspdexterity-label">Save&nbsp;Dexterity</h4>
              </div>
              <select name="attr_savedexterity_expertisedice">
                <option value="0" selected>-</option>
                <option value="1d4">d4</option>
                <option value="1d6">d6</option>
                <option value="1d8">d8</option>
                <option value="1d10">d10</option>
                <option value="1d12">d12</option>
                <option value="1d20">d20</option>
              </select>
            </div>

            <!-- CON -->
            <div class="sheet-main-savingthrows-con">
              <input type="checkbox" value="1" name="attr_saving_con_active" />
              <input type="number" step="1" value="0" name="attr_saving_con_value" readonly />
              <div class="sheet-button-div-holder">
                <button type="roll" class="sheet-button-description" name="roll_save_con" value="@{global-privacy-status} &{template:levelup} {{name=Constitution Save}} {{roll=[[1d20+@{saving_con_value}+@{saveconstitution_expertisedice}]]}} {{roll1=[[1d20+@{saving_con_value}+@{saveconstitution_expertisedice}]]}} {{roll2=[[1d20+@{saving_con_value}+@{saveconstitution_expertisedice}]]}} {{charactername=@{character_name}}} {{@{global-advantage-status}=1}} {{category=Ability}}"></button>
                <h4 data-i18n="savenbspconstitution-label">Save&nbsp;Constitution</h4>
              </div>
              <select name="attr_saveconstitution_expertisedice">
                <option value="0" selected>-</option>
                <option value="1d4">d4</option>
                <option value="1d6">d6</option>
                <option value="1d8">d8</option>
                <option value="1d10">d10</option>
                <option value="1d12">d12</option>
                <option value="1d20">d20</option>
              </select>
            </div>

            <!-- INT -->
            <div class="sheet-main-savingthrows-int">
              <input type="checkbox" value="1" name="attr_saving_int_active" />
              <input type="number" step="1" value="0" name="attr_saving_int_value" readonly />
              <div class="sheet-button-div-holder">
                <button type="roll" class="sheet-button-description" name="roll_save_int" value="@{global-privacy-status} &{template:levelup} {{name=Intelligence Save}} {{roll=[[1d20+@{saving_int_value}+@{saveintelligence_expertisedice}]]}} {{roll1=[[1d20+@{saving_int_value}+@{saveintelligence_expertisedice}]]}} {{roll2=[[1d20+@{saving_int_value}+@{saveintelligence_expertisedice}]]}} {{charactername=@{character_name}}} {{@{global-advantage-status}=1}} {{category=Ability}}"></button>
                <h4 data-i18n="savenbspintelligence-label">Save&nbsp;Intelligence</h4>
              </div>
              <select name="attr_saveintelligence_expertisedice">
                <option value="0" selected>-</option>
                <option value="1d4">d4</option>
                <option value="1d6">d6</option>
                <option value="1d8">d8</option>
                <option value="1d10">d10</option>
                <option value="1d12">d12</option>
                <option value="1d20">d20</option>
              </select>
            </div>

            <!-- WIS -->
            <div class="sheet-main-savingthrows-wis">
              <input type="checkbox" value="1" name="attr_saving_wis_active" />
              <input type="number" step="1" value="0" name="attr_saving_wis_value" readonly />
              <div class="sheet-button-div-holder">
                <button type="roll" class="sheet-button-description" name="roll_save_wis" value="@{global-privacy-status} &{template:levelup} {{name=Wisdom Save}} {{roll=[[1d20+@{saving_wis_value}+@{savewisdom_expertisedice}]]}} {{roll1=[[1d20+@{saving_wis_value}+@{savewisdom_expertisedice}]]}} {{roll2=[[1d20+@{saving_wis_value}+@{savewisdom_expertisedice}]]}} {{charactername=@{character_name}}} {{@{global-advantage-status}=1}} {{category=Ability}}"></button>
                <h4 data-i18n="savenbspwisdom-label">Save&nbsp;Wisdom</h4>
              </div>
              <select name="attr_savewisdom_expertisedice">
                <option value="0" selected>-</option>
                <option value="1d4">d4</option>
                <option value="1d6">d6</option>
                <option value="1d8">d8</option>
                <option value="1d10">d10</option>
                <option value="1d12">d12</option>
                <option value="1d20">d20</option>
              </select>
            </div>

            <!-- CHA -->
            <div class="sheet-main-savingthrows-cha">
              <input type="checkbox" value="1" name="attr_saving_cha_active" />
              <input type="number" step="1" value="0" name="attr_saving_cha_value" readonly />
              <div class="sheet-button-div-holder">
                <button type="roll" class="sheet-button-description" name="roll_save_cha" value="@{global-privacy-status} &{template:levelup} {{name=Charisma Save}} {{roll=[[1d20+@{saving_cha_value}+@{savecharisma_expertisedice}]]}} {{roll1=[[1d20+@{saving_cha_value}+@{savecharisma_expertisedice}]]}} {{roll2=[[1d20+@{saving_cha_value}+@{savecharisma_expertisedice}]]}} {{charactername=@{character_name}}} {{@{global-advantage-status}=1}} {{category=Ability}}"></button>
                <h4 data-i18n="savenbspcharisma-label">Save&nbsp;Charisma</h4>
              </div>
              <select name="attr_savecharisma_expertisedice">
                <option value="0" selected>-</option>
                <option value="1d4">d4</option>
                <option value="1d6">d6</option>
                <option value="1d8">d8</option>
                <option value="1d10">d10</option>
                <option value="1d12">d12</option>
                <option value="1d20">d20</option>
              </select>
            </div>
          </div>
        </div>

        <script id="STATS : SAVING THROWS FULL CALCULATION" type="text/worker">
          const stats = [
            { short: "str", bonus: "strength-bonus" },
            { short: "dex", bonus: "dexterity-bonus" },
            { short: "con", bonus: "constitution-bonus" },
            { short: "int", bonus: "intelligence-bonus" },
            { short: "wis", bonus: "wisdom-bonus" },
            { short: "cha", bonus: "charisma-bonus" }
          ];

          const fields = ["pb", "global-save-bonus"];
          stats.forEach(s => {
            fields.push(s.bonus);
            fields.push(`saving_${s.short}_active`);
          });

          on(fields.map(f => "change:" + f).join(" ") + " sheet:opened", () => {
            getAttrs(fields, v => {
              const up = {};
              const pb   = parseInt(v.pb || 0, 10);
              const gsb  = parseInt(v["global-save-bonus"] || 0, 10);

              stats.forEach(s => {
                const bonus  = parseInt(v[s.bonus] || 0, 10);
                const active = parseInt(v[`saving_${s.short}_active`] || 0, 10) ? pb : 0;
                up[`saving_${s.short}_value`] = bonus + active + gsb;
              });

              setAttrs(up);
            });
          });
        </script>

        <!-- ----- PASSIVES -----  -->
        <div class="sheet-main-passives sheet-standardbox sheet-standardbox2">
          <h4 class="sheet-minititles2 sheet-main-titlestatistics" data-i18n="passives-label">Passives</h4>
          <div class="sheet-oneline">
            <h3 data-i18n="passives-stealth-label">Passives Stealth</h3>
            <input type="number" value="0" name="attr_passive-stealth" readonly />
            <h3 data-i18n="passives-insight-label">Passives Insight</h3>
            <input type="number" value="0" name="attr_passive-insight" readonly />
            <h3 data-i18n="passives-perception-label">Passives Perception</h3>
            <input type="number" value="0" name="attr_passive-perception" readonly />
            <input type="text" value="Passive ..." name="attr_passive-customtext" />
            <input type="number" value="0" name="attr_passive-custom" />
          </div>
        </div>

        <script id="SKILL : PASSIVE SKILLS CALCULATION" type="text/worker">
          const skills = [
            { key: "stealth",     ability: "dexterity-bonus" },
            { key: "insight",     ability: "wisdom-bonus"    },
            { key: "perception",  ability: "wisdom-bonus"    }
          ];

          const fields = [
            "dexterity-bonus",
            "wisdom-bonus",
            "global-passive-bonus",
            "pb"
          ];

          skills.forEach(s => {
            fields.push(`${s.key}_active`);
            fields.push(`${s.key}_text`);
          });

          on(fields.map(f => "change:" + f).join(" ") + " sheet:opened", () => {
            getAttrs(fields, v => {
              const up    = {};
              const pb    = parseInt(v.pb || 0, 10);
              const global = parseInt(v["global-passive-bonus"] || 0, 10);

              skills.forEach(s => {
                const ability = parseInt(v[s.ability] || 0, 10);
                const active  = parseInt(v[`${s.key}_active`] || 0, 10) ? pb : 0;
                const expert  = (v[`${s.key}_text`] || "").trim() !== "" ? 3 : 0;

                const total = 10 + ability + global + active + expert;
                up[`passive-${s.key}`] = total;
              });

              setAttrs(up);
            });
          });
        </script>

        <!-- ----- FATIGUE & STRIFE ----- -->
        <div class="sheet-main-fatigue sheet-standardbox sheet-standardbox2">
          <h4 class="sheet-minititles2 sheet-main-titlestatistics" data-i18n="tracked-conditions-label">Tracked Conditions</h4>
          <div class="sheet-oneline" style="line-height: 18px !important">
            <h3 class="sheet-left" data-i18n="fatigue-label">Fatigue</h3>
            <div class="sheet-cogs-container">
              <input class="sheet-cogs-input sheet-cogs-hideshow-fatigue" type="checkbox" name="attr_sheet-cogs-hideshow-fatigue" />
              <span class="sheet-cogs-icon">?</span>
            </div>
            <input type="number" step="1" value="0" name="attr_fatigue" />
            <input class="sheet-hidden sheet-cogs-hideshow-fatigue" type="checkbox" name="attr_sheet-cogs-hideshow-fatigue" />
            <textarea style="grid-column: 1/-1; height: 60px !important; text-align: left !important" class="sheet-cogs-hideshow-fatigue-div1" placeholder="Description" data-i18n-placeholder="description-placeholder" name="attr_fatigue-description"></textarea>
            <h3 class="sheet-left" data-i18n="strife-label">Strife</h3>
            <div class="sheet-cogs-container">
              <input class="sheet-cogs-input sheet-cogs-hideshow-strife" type="checkbox" name="attr_sheet-cogs-hideshow-strife" />
              <span class="sheet-cogs-icon">?</span>
            </div>
            <input type="number" step="1" value="0" name="attr_strife" />
            <input class="sheet-hidden sheet-cogs-hideshow-strife" type="checkbox" name="attr_sheet-cogs-hideshow-strife" />
            <textarea style="grid-column: 1/-1; height: 60px !important; text-align: left !important" class="sheet-cogs-hideshow-strife-div1" placeholder="Description" data-i18n-placeholder="description-placeholder" name="attr_strife-description"></textarea>
          </div>
        </div>

        <script id="CALC : Fatigue & Strife Effects" type="text/worker">
          const NO_DATA_MSG = "No data beyond level 7.";

          const FATIGUE_EFFECTS = {
            0: "",
            1: "Cannot Sprint or Dash.",
            2: "Disadvantage on Strength, Dexterity, and Constitution checks.",
            3: "Speed halved and unable to maintain a fast travel pace.",
            4: "Disadvantage on attack rolls and saving throws using Strength, Dexterity, or Constitution, and unable to maintain a normal travel pace.",
            5: "Hit Dice halved.",
            6: "Speed reduced to 5 ft. and unable to maintain a slow travel pace.",
            7: "Doomed."
          };

          const STRIFE_EFFECTS = {
            0: "",
            1: "Disadvantage on Intelligence, Wisdom, and Charisma checks.",
            2: "Disadvantage on concentration checks.",
            3: "Can only take a bonus action or action each turn (not both).",
            4: "Disadvantage on attack rolls and saving throws using Intelligence, Wisdom, and Charisma.",
            5: "Suffer the effects of a randomly determined short-term mental stress effect.",
            6: "Cannot cast spells (but can cast cantrips).",
            7: "Suffer the effects of a randomly determined long-term mental stress effect."
          };

          const updateFatigueDescription = () => {
            getAttrs(["fatigue"], (v) => {
              const level = parseInt(v.fatigue || 0, 10) || 0;
              const desc =
                level > 7 ? NO_DATA_MSG : (FATIGUE_EFFECTS[level] || "");
              setAttrs({ "fatigue-description": desc });
            });
          };

          const updateStrifeDescription = () => {
            getAttrs(["strife"], (v) => {
              const level = parseInt(v.strife || 0, 10) || 0;
              const desc =
                level > 7 ? NO_DATA_MSG : (STRIFE_EFFECTS[level] || "");
              setAttrs({ "strife-description": desc });
            });
          };

          on("change:fatigue sheet:opened", updateFatigueDescription);
          on("change:strife sheet:opened", updateStrifeDescription);
        </script>

        <!-- ----- PROFICIENCIES -----  -->
        <div class="sheet-main-proficiencies">
          <div class="sheet-standardbox sheet-standardbox2">
            <h4 class="sheet-minititles2" data-i18n="proficiencies-label">Proficiencies</h4>
            <div class="sheet-oneline">
              <fieldset class="repeating_proficiencies">
                <input class="sheet-hidden sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                <div class="sheet-proficiencies1 sheet-cogs-hideshow-div1">
                  <input class="sheet-left" type="text" placeholder="Source" data-i18n-placeholder="source-placeholder" name="attr_proficiency-source" />
                  <input class="sheet-left" type="text" placeholder="Name" data-i18n-placeholder="name-placeholder" name="attr_proficiency-name" />
                  <div class="sheet-cogs-container">
                    <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                    <span class="sheet-cogs-icon">y</span>
                  </div>
                </div>

                <div class="sheet-proficiencies2 sheet-cogs-hideshow-div2">
                  <input class="sheet-hidden sheet-description-hideshow" type="checkbox" name="attr_sheet-description-hideshow" checked />

                  <span type="text" name="attr_proficiency-source"></span>
                  <span type="text" name="attr_proficiency-name"></span>

                  <div class="sheet-cogs-container sheet-button-div-holder">
                    <button type="roll" class="sheet-button-description" name="roll_proficiency" value="@{global-privacy-status} &{template:levelup-description} {{name=@{proficiency-source}}} {{charactername=@{character_name}}} {{category=Proficiencies}} {{source=@{proficiency-name}}}"></button>
                    <span class="sheet-cogs-icon">w</span>
                  </div>

                  <div class="sheet-cogs-container">
                    <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                    <span class="sheet-cogs-icon">y</span>
                  </div>
                </div>
              </fieldset>
            </div>
          </div>
        </div>

        <!-- ----- TOOLS -----  -->
        <div class="sheet-main-tools">
          <div class="sheet-standardbox sheet-standardbox2">
            <h4 class="sheet-minititles2" data-i18n="tools-label">Tools</h4>
            <div class="sheet-oneline">
              <fieldset class="repeating_tools">
                <input class="sheet-hidden sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                <div class="sheet-proficiencies4 sheet-cogs-hideshow-div1">
                  <input class="sheet-left" type="text" value="Tools" name="attr_proficiency-source" />
                  <input class="sheet-left" type="text" placeholder="Name" data-i18n-placeholder="name-placeholder" name="attr_proficiency-name" />
                  <select name="attr_proficiency_expertisedice">
                    <option value="0" selected="">-</option>
                    <option value="1d4">d4</option>
                    <option value="1d6">d6</option>
                    <option value="1d8">d8</option>
                    <option value="1d10">d10</option>
                    <option value="1d12">d12</option>
                    <option value="1d20">d20</option>
                  </select>
                  <select name="attr_proficiency-stat">
                    <option value="" selected>-</option>
                    <option value="STR">STR</option>
                    <option value="DEX">DEX</option>
                    <option value="CON">CON</option>
                    <option value="INT">INT</option>
                    <option value="WIS">WIS</option>
                    <option value="CHA">CHA</option>
                  </select>
                  <div class="sheet-cogs-container">
                    <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                    <span class="sheet-cogs-icon">y</span>
                  </div>
                </div>

                <div class="sheet-proficiencies3 sheet-cogs-hideshow-div2">
                  <input class="sheet-hidden sheet-description-hideshow" type="checkbox" name="attr_sheet-description-hideshow" checked />

                  <span type="text" name="attr_proficiency-source"></span>
                  <span type="text" name="attr_proficiency-name"></span>
                  <span type="text" name="attr_proficiency-value"></span>
                  <select name="attr_proficiency_expertisedice" style="border: none">
                    <option value="0" selected="">-</option>
                    <option value="1d4">d4</option>
                    <option value="1d6">d6</option>
                    <option value="1d8">d8</option>
                    <option value="1d10">d10</option>
                    <option value="1d12">d12</option>
                    <option value="1d20">d20</option>
                  </select>
                  <input type="text" class="sheet-hidden" name="attr_proficiency-value" />

                  <div class="sheet-cogs-container sheet-button-div-holder">
                    <button type="roll" class="sheet-button-hammer" name="roll_tools" value="@{global-privacy-status} &{template:levelup} {{name=@{proficiency-name}}} {{roll=[[1d20+@{proficiency-value}+@{proficiency_expertisedice}]]}} {{roll1=[[1d20+@{proficiency-value}+@{proficiency_expertisedice}]]}} {{roll2=[[1d20+@{proficiency-value}+@{proficiency_expertisedice}]]}} {{charactername=@{character_name}}} {{@{global-advantage-status}=1}} {{category=Tools}}"></button>
                    <span class="sheet-cogs-icon">x</span>
                  </div>

                  <div class="sheet-cogs-container">
                    <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                    <span class="sheet-cogs-icon">y</span>
                  </div>
                </div>
              </fieldset>
            </div>
          </div>
        </div>

        <script id="TOOLS : PROFICIENCY CALC" type="text/worker">
          const recalcToolProficiencies = () => {
            getSectionIDs("tools", (ids) => {
              if (!ids || !ids.length) return;

              const baseAttrs = [
                "strength-bonus",
                "dexterity-bonus",
                "constitution-bonus",
                "intelligence-bonus",
                "wisdom-bonus",
                "charisma-bonus"
              ];

              const attrs = [...baseAttrs];

              ids.forEach((id) => {
                const prefix = `repeating_tools_${id}_`;
                attrs.push(
                  `${prefix}proficiency-stat`
                );
              });

              getAttrs(attrs, (v) => {
                const abilityAttrMap = {
                  STR: "strength-bonus",
                  DEX: "dexterity-bonus",
                  CON: "constitution-bonus",
                  INT: "intelligence-bonus",
                  WIS: "wisdom-bonus",
                  CHA: "charisma-bonus"
                };

                const updates = {};

                ids.forEach((id) => {
                  const prefix = `repeating_tools_${id}_`;
                  const stat   = v[`${prefix}proficiency-stat`] || "";

                  const abilityAttr = abilityAttrMap[stat] || null;
                  const baseBonus   = abilityAttr ? parseInt(v[abilityAttr] || 0, 10) || 0 : 0;

                  // On reporte uniquement la valeur de l'ability
                  updates[`${prefix}proficiency-value`] = baseBonus;
                });

                if (Object.keys(updates).length) setAttrs(updates);
              });
            });
          };

          on(
            "change:strength-bonus change:dexterity-bonus change:constitution-bonus " +
            "change:intelligence-bonus change:wisdom-bonus change:charisma-bonus " +
            "change:repeating_tools:proficiency-stat",
            recalcToolProficiencies
          );

          on("sheet:opened", recalcToolProficiencies);
        </script>
      </div>
    </div>

    <!-- ----- BLOC MID-----  -->
    <div class="sheet-maingrid-area-mid">
      <div class="sheet-maingrid-area-midleft">
        <!-- ----- STATISTIQUES -----  -->
        <div class="sheet-standardbox sheet-standardbox2">
          <h4 class="sheet-minititles2" data-i18n="hit-points-label">Hit Points</h4>

          <div class="sheet-oneline" style="gap: 5px !important">
            <div class="sheet-doublecolumn">
              <!-- ----- VITALITE ----- -->
              <div class="sheet-main-current sheet-standardbox sheet-standardbox1">
                <div class="sheet-oneline2">
                  <h4 data-i18n="current-label">Current</h4>
                  <div class="sheet-main-statistics-vitesse sheet-general-hideshow-div1">
                    <input class="sheet-maincolor sheet-inputchar" type="number" step="1" value="0" name="attr_hp" />
                  </div>
                  <div class="sheet-doublecolumn sheet-inputchar33">
                    <h4 data-i18n="temp-label">TEMP.</h4>
                    <input type="number" step="1" value="0" name="attr_hp_current-mod" />
                  </div>
                </div>
              </div>

              <!-- ----- MAX HP ----- -->
              <div class="sheet-main-hp sheet-standardbox sheet-standardbox1">
                <div class="sheet-oneline2">
                  <h4 data-i18n="maximum-label">Maximum</h4>
                  <div class="sheet-main-statistics-maxhp sheet-general-hideshow-div1">
                    <input class="sheet-maincolor sheet-inputchar" type="number" step="1" value="0" name="attr_hp_max-display" />
                  </div>
                  <input class="sheet-hidden" type="number" step="1" value="0" name="attr_hp_max" />
                  <div class="sheet-doublecolumn sheet-inputchar33">
                    <h4 data-i18n="mod-label">MOD.</h4>
                    <input type="number" step="1" value="0" name="attr_hp_max-mod" />
                  </div>
                </div>
              </div>

              <script id="HP : MAX CALC" type="text/worker">
                on("sheet:opened change:hp_max-display change:hp_max-mod",()=>{
                  getAttrs(["hp_max-display","hp_max-mod"],v=>{
                    const base = parseInt(v["hp_max-display"]||0,10);
                    const mod  = parseInt(v["hp_max-mod"]||0,10);
                    setAttrs({"hp_max": base + mod});
                  });
                });
              </script>
            </div>

            <div class="sheet-progress-container-bar-menu" style="grid-column: 1/-1">
              <div class="sheet-progress-bars-menu sheet-barhp">
                <input type="number" step="0.01" value="0" name="attr_hp" readonly />
                <h4>/</h4>
                <input type="number" step="0.01" value="0" name="attr_hp_max" readonly />
              </div>
              <div class="sheet-progress-bar sheet-barhp-display"></div>
            </div>

            <script id="✓ - DISPLAY : HP Bar Progression" type="text/worker">
              const attr = "hp";
              const selector = ".sheet-barhp-display";

              function updateHPBar() {
                getAttrs([attr, `${attr}_max`], v => {
                  const current = parseInt(v[attr], 10) || 0;
                  const max     = parseInt(v[`${attr}_max`], 10) || 0;

                  let percent = max > 0 ? Math.round((current / max) * 100) : 0;
                  percent = Math.min(Math.max(percent, 0), 100);

                  const bar = $20(selector);

                  for (let i = 0; i <= 100; i++) {
                    bar.removeClass(`sheet-bar${i}`);
                  }

                  bar.addClass(`sheet-bar${percent}`);
                });
              }

              on("sheet:opened change:hp change:hp_max", updateHPBar);
            </script>

            <div class="sheet-doublecolumn-x3">
              <h4 style="text-align: left !important" data-i18n="massive-damages-label">Massive Damages :</h4>
              <!-- ----- Massive DMG ----- -->
              <input type="number" step="1" value="0" name="attr_hp_massive-damage" readonly />

              <script id="HP : MASSIVE DAMAGE CALC" type="text/worker">
                on("sheet:opened change:level",()=>{
                  getAttrs(["level"],v=>{
                    const lvl=parseInt(v.level||0,10);
                    setAttrs({"hp_massive-damage":20+(lvl*3)});
                  });
                });
              </script>
            </div>
            <input class="sheet-inputchar2" style="grid-column: 1/-1; max-width: none" type="text" placeholder="Armor Type" data-i18n-placeholder="armor-type-placeholder" name="attr_armor-type" style="max-width: none" />
          </div>
        </div>

        <!-- ----- REST BUTTONS ----- -->
        <div class="sheet-main-rest sheet-standardbox sheet-standardbox2">
          <div class="sheet-oneline sheet-doublecolumn">
            <!-- Short Rest -->
            <div class="sheet-rest-button">
              <button type="action" name="act_short_rest" class="sheet-button-rest">Short Rest</button>
            </div>

            <!-- Long Rest -->
            <div class="sheet-rest-button">
              <button type="action" name="act_long_rest" class="sheet-button-rest">Long Rest</button>
            </div>
          </div>
        </div>

        <script id="REST : LONG REST HEAL" type="text/worker">
          on("clicked:long_rest", () => {
            getAttrs(["hp_max"], v => {
              setAttrs({ hp: parseInt(v.hp_max || 0, 10) });
            });
          });
        </script>
        <!-- ----- HITDICES -----  -->
        <div class="sheet-main-secondaryblocstat sheet-standardbox sheet-standardbox2">
          <h4 class="sheet-minititles2 sheet-main-titlestatistics" data-i18n="hit-dices-label">Hit Dices</h4>
          <div class="sheet-oneline">
            <!-- ----- HIT DICES ----- -->
            <div class="sheet-multiclass-doublecolumn">
              <!-- CLASS 1 -->
              <div class="sheet-main-hitdie">
                <!-- FIELDSET HIT DICES -->
                <div class="sheet-sololine2" style="width: 100% !important">
                  <div class="sheet-doublecolumn">
                    <!-- COLUMN 1 -->
                    <div class="sheet-standardbox sheet-standardbox1 sheet-class1">
                      <div class="sheet-oneline" style="grid-template-rows: 14px 1fr 18px">
                        <div class="sheet-button-div-holder">
                          <button type="roll" class="sheet-button-description" name="roll_hitdice1" value=""></button>
                          <input type="text" class="sheet-hidden" name="attr_whattoroll1" value="@{global-privacy-status} &{template:levelup} {{name=Hit Dice}} {{roll=[[@{hitdice1}]]}} {{roll1=[[@{hitdice1}]]}} {{roll2=[[@{hitdice1}]]}} {{charactername=@{character_name}}} {{@{global-advantage-status}=1}} {{category=@{class1}}}" />
                          <span class="sheet-classdisplay" name="attr_class1"></span>
                        </div>

                        <input class="sheet-vanilla sheet-inputchar" type="number" value="0" name="attr_current-dices1" />
                        <div class="sheet-doublecolumn" style="width: 75%; gap: 0px !important; line-height: 18px !important; align-items: center !important">
                          <input type="number" value="0" name="attr_max-dices1" />
                          <span class="sheet-dicedisplay" name="attr_hitdice1"></span>
                        </div>
                      </div>
                    </div>
                    <!-- COLUMN 2 -->
                    <div class="sheet-standardbox sheet-standardbox1 sheet-class2">
                      <div class="sheet-oneline" style="grid-template-rows: 14px 1fr 18px">
                        <div class="sheet-button-div-holder">
                          <button type="roll" class="sheet-button-description" name="roll_hitdice2" value=""></button>
                          <input type="text" class="sheet-hidden" name="attr_whattoroll2" value="@{global-privacy-status} &{template:levelup} {{name=Hit Dice}} {{roll=[[@{hitdice2}]]}} {{roll1=[[@{hitdice2}]]}} {{roll2=[[@{hitdice2}]]}} {{charactername=@{character_name}}} {{@{global-advantage-status}=1}} {{category=@{class2}}}" />
                          <span class="sheet-classdisplay" name="attr_class2"></span>
                        </div>

                        <input class="sheet-vanilla sheet-inputchar" type="number" value="0" name="attr_current-dices2" />
                        <div class="sheet-doublecolumn" style="width: 75%; gap: 0px !important; line-height: 18px !important; align-items: center !important">
                          <input type="number" value="0" name="attr_max-dices2" />
                          <span class="sheet-dicedisplay" name="attr_hitdice2"></span>
                        </div>
                      </div>
                    </div>
                    <!-- COLUMN 3 -->
                    <div class="sheet-standardbox sheet-standardbox1 sheet-class3">
                      <div class="sheet-oneline" style="grid-template-rows: 14px 1fr 18px">
                        <div class="sheet-button-div-holder">
                          <button type="roll" class="sheet-button-description" name="roll_hitdice3" value=""></button>
                          <input type="text" class="sheet-hidden" name="attr_whattoroll3" value="@{global-privacy-status} &{template:levelup} {{name=Hit Dice}} {{roll=[[@{hitdice3}]]}} {{roll1=[[@{hitdice3}]]}} {{roll2=[[@{hitdice3}]]}} {{charactername=@{character_name}}} {{@{global-advantage-status}=1}} {{category=@{class3}}}" />
                          <span class="sheet-classdisplay" name="attr_class3"></span>
                        </div>

                        <input class="sheet-vanilla sheet-inputchar" type="number" value="0" name="attr_current-dices3" />
                        <div class="sheet-doublecolumn" style="width: 75%; gap: 0px !important; line-height: 18px !important; align-items: center !important">
                          <input type="number" value="0" name="attr_max-dices3" />
                          <span class="sheet-dicedisplay" name="attr_hitdice3"></span>
                        </div>
                      </div>
                    </div>
                    <!-- COLUMN 4 -->
                    <div class="sheet-standardbox sheet-standardbox1 sheet-class4">
                      <div class="sheet-oneline" style="grid-template-rows: 14px 1fr 18px">
                        <div class="sheet-button-div-holder">
                          <button type="roll" class="sheet-button-description" name="roll_hitdice4" value=""></button>
                          <input type="text" class="sheet-hidden" name="attr_whattoroll4" value="@{global-privacy-status} &{template:levelup} {{name=Hit Dice}} {{roll=[[@{hitdice4}]]}} {{roll1=[[@{hitdice4}]]}} {{roll2=[[@{hitdice4}]]}} {{charactername=@{character_name}}} {{@{global-advantage-status}=1}} {{category=@{class4}}}" />
                          <span class="sheet-classdisplay" name="attr_class4"></span>
                        </div>

                        <input class="sheet-vanilla sheet-inputchar" type="number" value="0" name="attr_current-dices4" />
                        <div class="sheet-doublecolumn" style="width: 75%; gap: 0px !important; line-height: 18px !important; align-items: center !important">
                          <input type="number" value="0" name="attr_max-dices4" />
                          <span class="sheet-dicedisplay" name="attr_hitdice4"></span>
                        </div>
                      </div>
                    </div>
                    <!-- COLUMN 5 -->
                    <div class="sheet-standardbox sheet-standardbox1 sheet-class5">
                      <div class="sheet-oneline" style="grid-template-rows: 14px 1fr 18px">
                        <div class="sheet-button-div-holder">
                          <button type="roll" class="sheet-button-description" name="roll_hitdice5" value=""></button>
                          <input type="text" class="sheet-hidden" name="attr_whattoroll5" value="@{global-privacy-status} &{template:levelup} {{name=Hit Dice}} {{roll=[[@{hitdice5}]]}} {{roll1=[[@{hitdice5}]]}} {{roll2=[[@{hitdice5}]]}} {{charactername=@{character_name}}} {{@{global-advantage-status}=1}} {{category=@{class5}}}" />
                          <span class="sheet-classdisplay" name="attr_class5"></span>
                        </div>

                        <input class="sheet-vanilla sheet-inputchar" type="number" value="0" name="attr_current-dices5" />
                        <div class="sheet-doublecolumn" style="width: 75%; gap: 0px !important; line-height: 18px !important; align-items: center !important">
                          <input type="number" value="0" name="attr_max-dices5" />
                          <span class="sheet-dicedisplay" name="attr_hitdice5"></span>
                        </div>
                      </div>
                    </div>
                    <!-- COLUMN 6 -->
                    <div class="sheet-standardbox sheet-standardbox1 sheet-class6">
                      <div class="sheet-oneline" style="grid-template-rows: 14px 1fr 18px">
                        <div class="sheet-button-div-holder">
                          <button type="roll" class="sheet-button-description" name="roll_hitdice6" value=""></button>
                          <input type="text" class="sheet-hidden" name="attr_whattoroll6" value="@{global-privacy-status} &{template:levelup} {{name=Hit Dice}} {{roll=[[@{hitdice6}]]}} {{roll1=[[@{hitdice6}]]}} {{roll2=[[@{hitdice6}]]}} {{charactername=@{character_name}}} {{@{global-advantage-status}=1}} {{category=@{class6}}}" />
                          <span class="sheet-classdisplay" name="attr_class6"></span>
                        </div>

                        <input class="sheet-vanilla sheet-inputchar" type="number" value="0" name="attr_current-dices6" />
                        <div class="sheet-doublecolumn" style="width: 75%; gap: 0px !important; line-height: 18px !important; align-items: center !important">
                          <input type="number" value="0" name="attr_max-dices6" />
                          <span class="sheet-dicedisplay" name="attr_hitdice6"></span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <script id="✓ CALC : Map Repeating Classes to Hit Dice Columns" type="text/worker">
          const abbrev3 = (s) => String(s || "").trim().slice(0, 3).toUpperCase();

          on(
            "sheet:opened change:repeating_classarchetype remove:repeating_classarchetype",
            () => {
              getSectionIDs("repeating_classarchetype", ids => {

                const maxSlots = 6;
                const attrsToGet = [];

                ids.forEach(id => {
                  attrsToGet.push(
                    `repeating_classarchetype_${id}_class`,
                    `repeating_classarchetype_${id}_hitdice`,
                    `repeating_classarchetype_${id}_level`
                  );
                });

                getAttrs(attrsToGet, values => {
                  const updates = {};

                  // Reset all columns
                  for (let i = 1; i <= maxSlots; i++) {
                    updates[`class${i}`] = "";
                    updates[`hitdice${i}`] = "";
                    updates[`max-dices${i}`] = 0;
                  }

                  // Fill from repeating rows
                  ids.slice(0, maxSlots).forEach((id, index) => {
                    const slot = index + 1;

                    updates[`class${slot}`] =
                      abbrev3(values[`repeating_classarchetype_${id}_class`]);

                    updates[`hitdice${slot}`] =
                      values[`repeating_classarchetype_${id}_hitdice`] || "";

                    updates[`max-dices${slot}`] =
                      parseInt(values[`repeating_classarchetype_${id}_level`] || 0, 10);
                  });

                  setAttrs(updates, { silent: true });

                  /* ---- DISPLAY / HIDE COLUMNS ---- */
                  for (let i = 1; i <= maxSlots; i++) {
                    const el = $20(`.sheet-class${i}`);
                    if (i <= ids.length) {
                      el.removeClass("sheet-hidden");
                    } else {
                      el.addClass("sheet-hidden");
                    }
                  }
                });
              });
            }
          );
        </script>

        <!-- ----- CONDITIONS -----  -->
        <div class="sheet-main-conditions">
          <div class="sheet-standardbox sheet-standardbox2">
            <h4 class="sheet-minititles2" data-i18n="conditions-label">Conditions</h4>
            <div class="sheet-oneline">
              <fieldset class="repeating_conditions">
                <input class="sheet-hidden sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />

                <div class="sheet-conditions1 sheet-cogs-hideshow-div2">
                  <select class="sheet-left" name="attr_conditions-source">
                    <option value="">-</option>
                    <option value="Agonized" data-i18n="agonized-option">Agonized</option>
                    <option value="Amnesiac" data-i18n="amnesiac-option">Amnesiac</option>
                    <option value="Blinded" data-i18n="blinded-option">Blinded</option>
                    <option value="Bloodied" data-i18n="bloodied-option">Bloodied</option>
                    <option value="Charmed" data-i18n="charmed-option">Charmed</option>
                    <option value="Confused" data-i18n="confused-option">Confused</option>
                    <option value="Deafened" data-i18n="deafened-option">Deafened</option>
                    <option value="Doomed" data-i18n="doomed-option">Doomed</option>
                    <option value="Encumbered" data-i18n="encumbered-option">Encumbered</option>
                    <option value="Enervated" data-i18n="enervated-option">Enervated</option>
                    <option value="Enraged" data-i18n="enraged-option">Enraged</option>
                    <option value="Frightened" data-i18n="frightened-option">Frightened</option>
                    <option value="Fixated" data-i18n="fixated-option">Fixated</option>
                    <option value="Grappled" data-i18n="grappled-option">Grappled</option>
                    <option value="Incapacitated" data-i18n="incapacitated-option">Incapacitated</option>
                    <option value="Invisible" data-i18n="invisible-option">Invisible</option>
                    <option value="Manic" data-i18n="manic-option">Manic</option>
                    <option value="Paralyzed" data-i18n="paralyzed-option">Paralyzed</option>
                    <option value="Petrified" data-i18n="petrified-option">Petrified</option>
                    <option value="Placid" data-i18n="placid-option">Placid</option>
                    <option value="Poisoned" data-i18n="poisoned-option">Poisoned</option>
                    <option value="Prone" data-i18n="prone-option">Prone</option>
                    <option value="Rattled" data-i18n="rattled-option">Rattled</option>
                    <option value="Restrained" data-i18n="restrained-option">Restrained</option>
                    <option value="Slowed" data-i18n="slowed-option">Slowed</option>
                    <option value="Stunned" data-i18n="stunned-option">Stunned</option>
                    <option value="Unconscious" data-i18n="unconscious-option">Unconscious</option>
                  </select>
                  <div class="sheet-cogs-container">
                    <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                    <span class="sheet-cogs-icon">?</span>
                  </div>

                  <textarea style="grid-column: 1/-1; height: 175px !important; text-align: left !important" class="sheet-cogs-hideshow-div1" placeholder="Description" data-i18n-placeholder="description-placeholder" name="attr_conditions-description"></textarea>
                </div>

                <div class="sheet-conditions2 sheet-cogs-hideshow-div1">
                  <input class="sheet-hidden sheet-description-hideshow" type="checkbox" name="attr_sheet-description-hideshow" checked />

                  <span type="text" name="attr_conditions-source"></span>

                  <div class="sheet-cogs-container sheet-button-div-holder">
                    <button type="roll" class="sheet-button-description" name="roll_condition" value="@{global-privacy-status} &{template:levelup-description} {{name=@{conditions-source}}} {{category=Proficiencies}} {{source=Condition}} {{description=@{conditions-description}}}"></button>
                    <span class="sheet-cogs-icon">w</span>
                  </div>

                  <div class="sheet-cogs-container">
                    <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                    <span class="sheet-cogs-icon">?</span>
                  </div>
                </div>
              </fieldset>
            </div>
          </div>
        </div>

        <script id="CALC : Conditions Description" type="text/worker">
          const CONDITIONS_DESCRIPTIONS = {
            Agonized: [
              "An agonized creature has disadvantage on Strength, Dexterity, and Constitution ability checks.",
              "An agonized creature is unable to maintain concentration, and automatically fails ability checks made to do so.",
              "A creature immune to the rattled condition is immune to the agonized condition."
            ],
            Amnesiac: [
              "An amnesiac creature cannot apply their proficiency bonus to any skill or tool checks, or communicate in or understand languages other than its primary language.",
              "A creature immune to the confused condition is immune to the amnesiac condition."
            ],
            Blinded: [
              "A blinded creature can't see and it automatically fails ability checks that require sight.",
              "Attack rolls against a blinded creature are made with advantage, and the creature's attack rolls are made with disadvantage."
            ],
            Bloodied: [
              "A creature is bloodied when reduced to half its hit points or less."
            ],
            Charmed: [
              "A charmed creature can't take any hostile action against the charmer.",
              "Ability checks the charmer makes to socially interact with the charmed creature have advantage."
            ],
            Confused: [
              "A confused creature can't take reactions.",
              "On its turn a confused creature rolls a d8 to determine what it does.",
              "On a 1 to 4, a confused creature does nothing.",
              "On a 5 or 6, a confused creature takes no action or bonus action and uses all its movement to move in a randomly determined direction.",
              "On a 7 or 8, a confused creature makes a melee attack against a randomly determined creature within its reach or does nothing if it can't make such an attack."
            ],
            Deafened: [
              "A deafened creature can't hear and automatically fails ability checks that require hearing."
            ],
            Doomed: [
              "A doomed creature dies at a time determined by the Narrator, or within 13 (2d12) hours.",
              "A doomed creature continues to be doomed even after it dies.",
              "Magic equivalent to a 7th-level or higher spell can remove the doomed condition (such as regenerate cast on a living creature, resurrection, true resurrection, or wish)."
            ],
            Encumbered: [
              "An encumbered creature's Speed is reduced to 5 ft."
            ],
            Enervated: [
              "An enervated creature can’t use psionic powers or features that require psionic points.",
              "An enervated creature suffers a –2 penalty on all ability checks, saving throws, and attacks."
            ],
            Enraged: [
              "If an enraged creature can see or hear any enemies within 60 feet, it must move directly towards the closest. If it is in reach of an enemy, it must attack that enemy.",
              "An enraged creature has disadvantage on Intelligence, Wisdom, and Charisma checks.",
              "An enraged creature is unaffected by the frightened condition or the placid condition.",
              "A creature immune to the charmed condition is immune to the enraged condition."
            ],
            Frightened: [
              "A frightened creature has disadvantage on ability checks and attack rolls while it is able to see the source of its fear.",
              "A frightened creature can't willingly move closer to the source of its fear."
            ],
            Fixated: [
              "A fixated creature has disadvantage on Investigation and Perception checks to perceive or examine creatures or objects other than the source of its fixation.",
              "A fixated creature must spend 2 feet of movement for every 1 foot of movement away from the source of its fixation.",
              "A creature that is immune to being charmed is also immune to being fixated."
            ],
            Grappled: [
              "A grappled creature's Speed becomes 0, and it can't benefit from bonuses to movement speeds.",
              "If the grappler becomes incapacitated the condition ends.",
              "If an effect removes the grappled creature from the reach of the grappler or grappling effect the condition ends."
            ],
            Incapacitated: [
              "An incapacitated creature can’t take actions, bonus actions, or reactions."
            ],
            Invisible: [
              "An invisible creature is impossible to see without the aid of magic or a special sense (it gains no benefits from this condition against creatures still able to see it).",
              "An invisible creature is heavily obscured for the purpose of hiding.",
              "An invisible creature's location can be detected by noises it makes or tracks it leaves.",
              "Attack rolls against an invisible creature are made with disadvantage.",
              "An invisible creature makes attack rolls with advantage."
            ],
            Manic: [
              "A manic creature is convulsed with laughter and can only take an action or a move on its turn.",
              "A creature immune to the charmed condition is immune to the manic condition."
            ],
            Paralyzed: [
              "A paralyzed creature is incapacitated and can't move or speak.",
              "A paralyzed creature automatically fails Strength and Dexterity saving throws.",
              "Attack rolls against a paralyzed creature have advantage.",
              "Any attack that hits a paralyzed creature is a critical hit if the attacker is within 5 feet."
            ],
            Petrified: [
              "A petrified creature (and all of its mundane possessions) is transformed into a solid inanimate substance (usually stone).",
              "A petrified creature’s weight is increased by a factor of ten and it ceases aging.",
              "A petrified creature is incapacitated, can't move or speak, and is unaware of its surroundings.",
              "A petrified creature automatically fails Strength and Dexterity saving throws.",
              "A petrified creature has resistance to all damage.",
              "A petrified creature is immune to poison and disease (time spent petrified does not affect the duration of a poison or disease already in its system)."
            ],
            Placid: [
              "A placid creature cannot take hostile or aggressive actions.",
              "A creature immune to the frightened condition is immune to the placid condition."
            ],
            Poisoned: [
              "A poisoned creature has disadvantage on attack rolls and ability checks."
            ],
            Prone: [
              "A prone creature's only movement option is to crawl (every 1 foot of movement while crawling costs 1 extra foot) until it stands up.",
              "Standing up requires half a creature’s movement.",
              "A prone creature makes melee attack rolls with disadvantage.",
              "An attack roll against a prone creature is made with advantage if the attacker is within 5 feet. Otherwise, the attack roll is made with disadvantage."
            ],
            Rattled: [
              "A rattled creature cannot benefit from expertise dice.",
              "A creature that is immune to being stunned is immune to being rattled.",
              "A rattled creature cannot take reactions."
            ],
            Restrained: [
              "A restrained creature's Speed becomes 0, and it can't benefit from bonuses to speed.",
              "Attack rolls against a restrained creature are made with advantage.",
              "A restrained creature makes attack rolls with disadvantage.",
              "The restrained creature has disadvantage on Dexterity saving throws."
            ],
            Slowed: [
              "A slowed creature's Speed is halved.",
              "A slowed creature takes a −2 penalty to AC and Dexterity saving throws.",
              "A slowed creature cannot take reactions.",
              "On its turn, a slowed creature can take either an action or a bonus action, not both. In addition, it can't make more than one melee or ranged attack during its turn."
            ],
            Stunned: [
              "A stunned creature is incapacitated, can't move, and can speak only falteringly.",
              "The creature automatically fails Strength and Dexterity saving throws.",
              "Attack rolls against the creature have advantage.",
              "A creature that is immune to being stunned is immune to being rattled."
            ],
            Unconscious: [
              "An unconscious creature is incapacitated, can't move or speak, and is unaware of its surroundings.",
              "An unconscious creature drops whatever it's holding and falls prone.",
              "An unconscious creature automatically fails Strength and Dexterity saving throws.",
              "Attack rolls against an unconscious creature are made with advantage.",
              "Any attack that hits an unconscious creature is a critical hit if the attacker is within 5 feet."
            ]
          };

          const buildConditionDescription = (name) => {
            const lines = CONDITIONS_DESCRIPTIONS[name] || [];
            if (!lines.length) return "";
            return lines.map(line => `. ${line}`).join("\n");
          };

          const updateConditionsDescriptions = () => {
            getSectionIDs("conditions", (ids) => {
              if (!ids || !ids.length) return;

              const attrs = [];
              ids.forEach((id) => {
                attrs.push(`repeating_conditions_${id}_conditions-source`);
              });

              getAttrs(attrs, (v) => {
                const updates = {};

                ids.forEach((id) => {
                  const prefix = `repeating_conditions_${id}_`;
                  const source = v[`${prefix}conditions-source`] || "";
                  const desc   = buildConditionDescription(source);
                  updates[`${prefix}conditions-description`] = desc;
                });

                if (Object.keys(updates).length) {
                  setAttrs(updates);
                }
              });
            });
          };

          on("change:repeating_conditions:conditions-source sheet:opened", updateConditionsDescriptions);
        </script>
      </div>

      <div class="sheet-maingrid-area-midright">
        <!-- ----- SKILLS ----- -->
        <div class="sheet-main-skills sheet-standardbox sheet-standardbox2">
          <h4 class="sheet-minititles2" data-i18n="skills-label">Skills</h4>
          <div class="sheet-oneline">
            <!-- Acrobatics -->
            <div class="sheet-main-skills-acrobatics">
              <input type="checkbox" value="1" name="attr_acrobatics_active" />
              <select name="attr_acrobatics_proficiency_selector">
                <option value="" selected>-</option>
                <option value="STR">STR</option>
                <option value="DEX">DEX</option>
                <option value="CON">CON</option>
                <option value="INT">INT</option>
                <option value="WIS">WIS</option>
                <option value="CHA">CHA</option>
              </select>
              <input type="number" step="1" value="1" name="attr_acrobatics_value" readonly />
              <div class="sheet-button-div-holder">
                <button type="roll" class="sheet-button-description" name="roll_acrobatics" value="@{global-privacy-status} {{@{global-advantage-status}=1}} &{template:levelup} {{name=Acrobatics}} {{roll=[[1d20+@{acrobatics_value}+@{acrobatics_expertisedice}]]}} {{roll1=[[1d20+@{acrobatics_value}+@{acrobatics_expertisedice}]]}} {{roll2=[[1d20+@{acrobatics_value}+@{acrobatics_expertisedice}]]}} {{charactername=@{character_name}}} {{category=Skill}}"></button>
                <h4 data-i18n="acrobatics-label">Acrobatics</h4>
              </div>
              <input type="text" value="" name="attr_acrobatics_text" />
              <select name="attr_acrobatics_expertisedice">
                <option value="0" selected>-</option>
                <option value="1d4">d4</option>
                <option value="1d6">d6</option>
                <option value="1d8">d8</option>
                <option value="1d10">d10</option>
                <option value="1d12">d12</option>
                <option value="1d20">d20</option>
              </select>
            </div>

            <!-- Animal Handling -->
            <div class="sheet-main-skills-animalhandling">
              <input type="checkbox" value="1" name="attr_animalhandling_active" />
              <select name="attr_animalhandling_proficiency_selector">
                <option value="" selected>-</option>
                <option value="STR">STR</option>
                <option value="DEX">DEX</option>
                <option value="CON">CON</option>
                <option value="INT">INT</option>
                <option value="WIS">WIS</option>
                <option value="CHA">CHA</option>
              </select>
              <input type="number" step="0.01" value="1" name="attr_animalhandling_value" readonly />
              <div class="sheet-button-div-holder">
                <button type="roll" class="sheet-button-description" name="roll_animalhandling" value="@{global-privacy-status} {{@{global-advantage-status}=1}} &{template:levelup} {{name=Animal Handling}} {{roll=[[1d20+@{animalhandling_value}+@{animalhandling_expertisedice}]]}} {{roll1=[[1d20+@{animalhandling_value}+@{animalhandling_expertisedice}]]}} {{roll2=[[1d20+@{animalhandling_value}+@{animalhandling_expertisedice}]]}} {{charactername=@{character_name}}} {{category=Skill}}"></button>
                <h4 data-i18n="animal-handling-label">Animal Handling</h4>
              </div>
              <input type="text" value="" name="attr_animalhandling_text" />
              <select name="attr_animalhandling_expertisedice">
                <option value="0" selected>-</option>
                <option value="1d4">d4</option>
                <option value="1d6">d6</option>
                <option value="1d8">d8</option>
                <option value="1d10">d10</option>
                <option value="1d12">d12</option>
                <option value="1d20">d20</option>
              </select>
            </div>

            <!-- Arcana -->
            <div class="sheet-main-skills-arcana">
              <input type="checkbox" value="1" name="attr_arcana_active" />
              <select name="attr_arcana_proficiency_selector">
                <option value="" selected>-</option>
                <option value="STR">STR</option>
                <option value="DEX">DEX</option>
                <option value="CON">CON</option>
                <option value="INT">INT</option>
                <option value="WIS">WIS</option>
                <option value="CHA">CHA</option>
              </select>
              <input type="number" step="0.01" value="1" name="attr_arcana_value" readonly />
              <div class="sheet-button-div-holder">
                <button type="roll" class="sheet-button-description" name="roll_arcana" value="@{global-privacy-status} {{@{global-advantage-status}=1}} &{template:levelup} {{name=Arcana}} {{roll=[[1d20+@{arcana_value}+@{arcana_expertisedice}]]}} {{roll1=[[1d20+@{arcana_value}+@{arcana_expertisedice}]]}} {{roll2=[[1d20+@{arcana_value}+@{arcana_expertisedice}]]}} {{charactername=@{character_name}}} {{category=Skill}}"></button>
                <h4 data-i18n="arcana-label">Arcana</h4>
              </div>
              <input type="text" value="" name="attr_arcana_text" />
              <select name="attr_arcana_expertisedice">
                <option value="0" selected>-</option>
                <option value="1d4">d4</option>
                <option value="1d6">d6</option>
                <option value="1d8">d8</option>
                <option value="1d10">d10</option>
                <option value="1d12">d12</option>
                <option value="1d20">d20</option>
              </select>
            </div>

            <!-- Athletics -->
            <div class="sheet-main-skills-athletics">
              <input type="checkbox" value="1" name="attr_athletics_active" />
              <select name="attr_athletics_proficiency_selector">
                <option value="" selected>-</option>
                <option value="STR">STR</option>
                <option value="DEX">DEX</option>
                <option value="CON">CON</option>
                <option value="INT">INT</option>
                <option value="WIS">WIS</option>
                <option value="CHA">CHA</option>
              </select>
              <input type="number" step="0.01" value="1" name="attr_athletics_value" readonly />
              <div class="sheet-button-div-holder">
                <button type="roll" class="sheet-button-description" name="roll_athletics" value="@{global-privacy-status} {{@{global-advantage-status}=1}} &{template:levelup} {{name=Athletics}} {{roll=[[1d20+@{athletics_value}+@{athletics_expertisedice}]]}} {{roll1=[[1d20+@{athletics_value}+@{athletics_expertisedice}]]}} {{roll2=[[1d20+@{athletics_value}+@{athletics_expertisedice}]]}} {{charactername=@{character_name}}} {{category=Skill}}"></button>
                <h4 data-i18n="athletics-label">Athletics</h4>
              </div>
              <input type="text" value="" name="attr_athletics_text" />
              <select name="attr_athletics_expertisedice">
                <option value="0" selected>-</option>
                <option value="1d4">d4</option>
                <option value="1d6">d6</option>
                <option value="1d8">d8</option>
                <option value="1d10">d10</option>
                <option value="1d12">d12</option>
                <option value="1d20">d20</option>
              </select>
            </div>

            <!-- Culture -->
            <div class="sheet-main-skills-culture">
              <input type="checkbox" value="1" name="attr_culture_active" />
              <select name="attr_culture_proficiency_selector">
                <option value="" selected>-</option>
                <option value="STR">STR</option>
                <option value="DEX">DEX</option>
                <option value="CON">CON</option>
                <option value="INT">INT</option>
                <option value="WIS">WIS</option>
                <option value="CHA">CHA</option>
              </select>
              <input type="number" step="0.01" value="1" name="attr_culture_value" readonly />
              <div class="sheet-button-div-holder">
                <button type="roll" class="sheet-button-description" name="roll_culture" value="@{global-privacy-status} {{@{global-advantage-status}=1}} &{template:levelup} {{name=Culture}} {{roll=[[1d20+@{culture_value}+@{culture_expertisedice}]]}} {{roll1=[[1d20+@{culture_value}+@{culture_expertisedice}]]}} {{roll2=[[1d20+@{culture_value}+@{culture_expertisedice}]]}} {{charactername=@{character_name}}} {{category=Skill}}"></button>
                <h4 data-i18n="culture-label">Culture</h4>
              </div>
              <input type="text" value="" name="attr_culture_text" />
              <select name="attr_culture_expertisedice">
                <option value="0" selected>-</option>
                <option value="1d4">d4</option>
                <option value="1d6">d6</option>
                <option value="1d8">d8</option>
                <option value="1d10">d10</option>
                <option value="1d12">d12</option>
                <option value="1d20">d20</option>
              </select>
            </div>

            <!-- Deception -->
            <div class="sheet-main-skills-deception">
              <input type="checkbox" value="1" name="attr_deception_active" />
              <select name="attr_deception_proficiency_selector">
                <option value="" selected>-</option>
                <option value="STR">STR</option>
                <option value="DEX">DEX</option>
                <option value="CON">CON</option>
                <option value="INT">INT</option>
                <option value="WIS">WIS</option>
                <option value="CHA">CHA</option>
              </select>
              <input type="number" step="0.01" value="1" name="attr_deception_value" readonly />
              <div class="sheet-button-div-holder">
                <button type="roll" class="sheet-button-description" name="roll_deception" value="@{global-privacy-status} {{@{global-advantage-status}=1}} &{template:levelup} {{name=Deception}} {{roll=[[1d20+@{deception_value}+@{deception_expertisedice}]]}} {{roll1=[[1d20+@{deception_value}+@{deception_expertisedice}]]}} {{roll2=[[1d20+@{deception_value}+@{deception_expertisedice}]]}} {{charactername=@{character_name}}} {{category=Skill}}"></button>
                <h4 data-i18n="deception-label">Deception</h4>
              </div>
              <input type="text" value="" name="attr_deception_text" />
              <select name="attr_deception_expertisedice">
                <option value="0" selected>-</option>
                <option value="1d4">d4</option>
                <option value="1d6">d6</option>
                <option value="1d8">d8</option>
                <option value="1d10">d10</option>
                <option value="1d12">d12</option>
                <option value="1d20">d20</option>
              </select>
            </div>

            <!-- Engineering -->
            <div class="sheet-main-skills-engineering">
              <input type="checkbox" value="1" name="attr_engineering_active" />
              <select name="attr_engineering_proficiency_selector">
                <option value="" selected>-</option>
                <option value="STR">STR</option>
                <option value="DEX">DEX</option>
                <option value="CON">CON</option>
                <option value="INT">INT</option>
                <option value="WIS">WIS</option>
                <option value="CHA">CHA</option>
              </select>
              <input type="number" step="0.01" value="1" name="attr_engineering_value" readonly />
              <div class="sheet-button-div-holder">
                <button type="roll" class="sheet-button-description" name="roll_engineering" value="@{global-privacy-status} {{@{global-advantage-status}=1}} &{template:levelup} {{name=Engineering}} {{roll=[[1d20+@{engineering_value}+@{engineering_expertisedice}]]}} {{roll1=[[1d20+@{engineering_value}+@{engineering_expertisedice}]]}} {{roll2=[[1d20+@{engineering_value}+@{engineering_expertisedice}]]}} {{charactername=@{character_name}}} {{category=Skill}}"></button>
                <h4 data-i18n="engineering-label">Engineering</h4>
              </div>
              <input type="text" value="" name="attr_engineering_text" />
              <select name="attr_engineering_expertisedice">
                <option value="0" selected>-</option>
                <option value="1d4">d4</option>
                <option value="1d6">d6</option>
                <option value="1d8">d8</option>
                <option value="1d10">d10</option>
                <option value="1d12">d12</option>
                <option value="1d20">d20</option>
              </select>
            </div>

            <!-- History -->
            <div class="sheet-main-skills-history">
              <input type="checkbox" value="1" name="attr_history_active" />
              <select name="attr_history_proficiency_selector">
                <option value="" selected>-</option>
                <option value="STR">STR</option>
                <option value="DEX">DEX</option>
                <option value="CON">CON</option>
                <option value="INT">INT</option>
                <option value="WIS">WIS</option>
                <option value="CHA">CHA</option>
              </select>
              <input type="number" step="0.01" value="1" name="attr_history_value" readonly />
              <div class="sheet-button-div-holder">
                <button type="roll" class="sheet-button-description" name="roll_history" value="@{global-privacy-status} {{@{global-advantage-status}=1}} &{template:levelup} {{name=History}} {{roll=[[1d20+@{history_value}+@{history_expertisedice}]]}} {{roll1=[[1d20+@{history_value}+@{history_expertisedice}]]}} {{roll2=[[1d20+@{history_value}+@{history_expertisedice}]]}} {{charactername=@{character_name}}} {{category=Skill}}"></button>
                <h4 data-i18n="history-label">History</h4>
              </div>
              <input type="text" value="" name="attr_history_text" />
              <select name="attr_history_expertisedice">
                <option value="0" selected>-</option>
                <option value="1d4">d4</option>
                <option value="1d6">d6</option>
                <option value="1d8">d8</option>
                <option value="1d10">d10</option>
                <option value="1d12">d12</option>
                <option value="1d20">d20</option>
              </select>
            </div>

            <!-- Insight -->
            <div class="sheet-main-skills-insight">
              <input type="checkbox" value="1" name="attr_insight_active" />
              <select name="attr_insight_proficiency_selector">
                <option value="" selected>-</option>
                <option value="STR">STR</option>
                <option value="DEX">DEX</option>
                <option value="CON">CON</option>
                <option value="INT">INT</option>
                <option value="WIS">WIS</option>
                <option value="CHA">CHA</option>
              </select>
              <input type="number" step="0.01" value="1" name="attr_insight_value" readonly />
              <div class="sheet-button-div-holder">
                <button type="roll" class="sheet-button-description" name="roll_insight" value="@{global-privacy-status} {{@{global-advantage-status}=1}} &{template:levelup} {{name=Insight}} {{roll=[[1d20+@{insight_value}+@{insight_expertisedice}]]}} {{roll1=[[1d20+@{insight_value}+@{insight_expertisedice}]]}} {{roll2=[[1d20+@{insight_value}+@{insight_expertisedice}]]}} {{charactername=@{character_name}}} {{category=Skill}}"></button>
                <h4 data-i18n="insight-label">Insight</h4>
              </div>
              <input type="text" value="" name="attr_insight_text" />
              <select name="attr_insight_expertisedice">
                <option value="0" selected>-</option>
                <option value="1d4">d4</option>
                <option value="1d6">d6</option>
                <option value="1d8">d8</option>
                <option value="1d10">d10</option>
                <option value="1d12">d12</option>
                <option value="1d20">d20</option>
              </select>
            </div>

            <!-- Intimidation -->
            <div class="sheet-main-skills-intimidation">
              <input type="checkbox" value="1" name="attr_intimidation_active" />
              <select name="attr_intimidation_proficiency_selector">
                <option value="" selected>-</option>
                <option value="STR">STR</option>
                <option value="DEX">DEX</option>
                <option value="CON">CON</option>
                <option value="INT">INT</option>
                <option value="WIS">WIS</option>
                <option value="CHA">CHA</option>
              </select>
              <input type="number" step="0.01" value="1" name="attr_intimidation_value" readonly />
              <div class="sheet-button-div-holder">
                <button type="roll" class="sheet-button-description" name="roll_intimidation" value="@{global-privacy-status} {{@{global-advantage-status}=1}} &{template:levelup} {{name=Intimidation}} {{roll=[[1d20+@{intimidation_value}+@{intimidation_expertisedice}]]}} {{roll1=[[1d20+@{intimidation_value}+@{intimidation_expertisedice}]]}} {{roll2=[[1d20+@{intimidation_value}+@{intimidation_expertisedice}]]}} {{charactername=@{character_name}}} {{category=Skill}}"></button>
                <h4 data-i18n="intimidation-label">Intimidation</h4>
              </div>
              <input type="text" value="" name="attr_intimidation_text" />
              <select name="attr_intimidation_expertisedice">
                <option value="0" selected>-</option>
                <option value="1d4">d4</option>
                <option value="1d6">d6</option>
                <option value="1d8">d8</option>
                <option value="1d10">d10</option>
                <option value="1d12">d12</option>
                <option value="1d20">d20</option>
              </select>
            </div>

            <!-- Investigation -->
            <div class="sheet-main-skills-investigation">
              <input type="checkbox" value="1" name="attr_investigation_active" />
              <select name="attr_investigation_proficiency_selector">
                <option value="" selected>-</option>
                <option value="STR">STR</option>
                <option value="DEX">DEX</option>
                <option value="CON">CON</option>
                <option value="INT">INT</option>
                <option value="WIS">WIS</option>
                <option value="CHA">CHA</option>
              </select>
              <input type="number" step="0.01" value="1" name="attr_investigation_value" readonly />
              <div class="sheet-button-div-holder">
                <button type="roll" class="sheet-button-description" name="roll_investigation" value="@{global-privacy-status} {{@{global-advantage-status}=1}} &{template:levelup} {{name=Investigation}} {{roll=[[1d20+@{investigation_value}+@{investigation_expertisedice}]]}} {{roll1=[[1d20+@{investigation_value}+@{investigation_expertisedice}]]}} {{roll2=[[1d20+@{investigation_value}+@{investigation_expertisedice}]]}} {{charactername=@{character_name}}} {{category=Skill}}"></button>
                <h4 data-i18n="investigation-label">Investigation</h4>
              </div>
              <input type="text" value="" name="attr_investigation_text" />
              <select name="attr_investigation_expertisedice">
                <option value="0" selected>-</option>
                <option value="1d4">d4</option>
                <option value="1d6">d6</option>
                <option value="1d8">d8</option>
                <option value="1d10">d10</option>
                <option value="1d12">d12</option>
                <option value="1d20">d20</option>
              </select>
            </div>

            <!-- Medicine -->
            <div class="sheet-main-skills-medicine">
              <input type="checkbox" value="1" name="attr_medicine_active" />
              <select name="attr_medicine_proficiency_selector">
                <option value="" selected>-</option>
                <option value="STR">STR</option>
                <option value="DEX">DEX</option>
                <option value="CON">CON</option>
                <option value="INT">INT</option>
                <option value="WIS">WIS</option>
                <option value="CHA">CHA</option>
              </select>
              <input type="number" step="0.01" value="1" name="attr_medicine_value" readonly />
              <div class="sheet-button-div-holder">
                <button type="roll" class="sheet-button-description" name="roll_medicine" value="@{global-privacy-status} {{@{global-advantage-status}=1}} &{template:levelup} {{name=Medicine}} {{roll=[[1d20+@{medicine_value}+@{medicine_expertisedice}]]}} {{roll1=[[1d20+@{medicine_value}+@{medicine_expertisedice}]]}} {{roll2=[[1d20+@{medicine_value}+@{medicine_expertisedice}]]}} {{charactername=@{character_name}}} {{category=Skill}}"></button>
                <h4 data-i18n="medicine-label">Medicine</h4>
              </div>
              <input type="text" value="" name="attr_medicine_text" />
              <select name="attr_medicine_expertisedice">
                <option value="0" selected>-</option>
                <option value="1d4">d4</option>
                <option value="1d6">d6</option>
                <option value="1d8">d8</option>
                <option value="1d10">d10</option>
                <option value="1d12">d12</option>
                <option value="1d20">d20</option>
              </select>
            </div>

            <!-- Nature -->
            <div class="sheet-main-skills-nature">
              <input type="checkbox" value="1" name="attr_nature_active" />
              <select name="attr_nature_proficiency_selector">
                <option value="" selected>-</option>
                <option value="STR">STR</option>
                <option value="DEX">DEX</option>
                <option value="CON">CON</option>
                <option value="INT">INT</option>
                <option value="WIS">WIS</option>
                <option value="CHA">CHA</option>
              </select>
              <input type="number" step="0.01" value="1" name="attr_nature_value" readonly />
              <div class="sheet-button-div-holder">
                <button type="roll" class="sheet-button-description" name="roll_nature" value="@{global-privacy-status} {{@{global-advantage-status}=1}} &{template:levelup} {{name=Nature}} {{roll=[[1d20+@{nature_value}+@{nature_expertisedice}]]}} {{roll1=[[1d20+@{nature_value}+@{nature_expertisedice}]]}} {{roll2=[[1d20+@{nature_value}+@{nature_expertisedice}]]}} {{charactername=@{character_name}}} {{category=Skill}}"></button>
                <h4 data-i18n="nature-label">Nature</h4>
              </div>
              <input type="text" value="" name="attr_nature_text" />
              <select name="attr_nature_expertisedice">
                <option value="0" selected>-</option>
                <option value="1d4">d4</option>
                <option value="1d6">d6</option>
                <option value="1d8">d8</option>
                <option value="1d10">d10</option>
                <option value="1d12">d12</option>
                <option value="1d20">d20</option>
              </select>
            </div>

            <!-- Perception -->
            <div class="sheet-main-skills-perception">
              <input type="checkbox" value="1" name="attr_perception_active" />
              <select name="attr_perception_proficiency_selector">
                <option value="" selected>-</option>
                <option value="STR">STR</option>
                <option value="DEX">DEX</option>
                <option value="CON">CON</option>
                <option value="INT">INT</option>
                <option value="WIS">WIS</option>
                <option value="CHA">CHA</option>
              </select>
              <input type="number" step="0.01" value="1" name="attr_perception_value" readonly />
              <div class="sheet-button-div-holder">
                <button type="roll" class="sheet-button-description" name="roll_perception" value="@{global-privacy-status} {{@{global-advantage-status}=1}} &{template:levelup} {{name=Perception}} {{roll=[[1d20+@{perception_value}+@{perception_expertisedice}]]}} {{roll1=[[1d20+@{perception_value}+@{perception_expertisedice}]]}} {{roll2=[[1d20+@{perception_value}+@{perception_expertisedice}]]}} {{charactername=@{character_name}}} {{category=Skill}}"></button>
                <h4 data-i18n="perception-label">Perception</h4>
              </div>
              <input type="text" value="" name="attr_perception_text" />
              <select name="attr_perception_expertisedice">
                <option value="0" selected>-</option>
                <option value="1d4">d4</option>
                <option value="1d6">d6</option>
                <option value="1d8">d8</option>
                <option value="1d10">d10</option>
                <option value="1d12">d12</option>
                <option value="1d20">d20</option>
              </select>
            </div>

            <!-- Performance -->
            <div class="sheet-main-skills-performance">
              <input type="checkbox" value="1" name="attr_performance_active" />
              <select name="attr_performance_proficiency_selector">
                <option value="" selected>-</option>
                <option value="STR">STR</option>
                <option value="DEX">DEX</option>
                <option value="CON">CON</option>
                <option value="INT">INT</option>
                <option value="WIS">WIS</option>
                <option value="CHA">CHA</option>
              </select>
              <input type="number" step="0.01" value="1" name="attr_performance_value" readonly />
              <div class="sheet-button-div-holder">
                <button type="roll" class="sheet-button-description" name="roll_performance" value="@{global-privacy-status} {{@{global-advantage-status}=1}} &{template:levelup} {{name=Performance}} {{roll=[[1d20+@{performance_value}+@{performance_expertisedice}]]}} {{roll1=[[1d20+@{performance_value}+@{performance_expertisedice}]]}} {{roll2=[[1d20+@{performance_value}+@{performance_expertisedice}]]}} {{charactername=@{character_name}}} {{category=Skill}}"></button>
                <h4 data-i18n="performance-label">Performance</h4>
              </div>
              <input type="text" value="" name="attr_performance_text" />
              <select name="attr_performance_expertisedice">
                <option value="0" selected>-</option>
                <option value="1d4">d4</option>
                <option value="1d6">d6</option>
                <option value="1d8">d8</option>
                <option value="1d10">d10</option>
                <option value="1d12">d12</option>
                <option value="1d20">d20</option>
              </select>
            </div>

            <!-- Persuasion -->
            <div class="sheet-main-skills-persuasion">
              <input type="checkbox" value="1" name="attr_persuasion_active" />
              <select name="attr_persuasion_proficiency_selector">
                <option value="" selected>-</option>
                <option value="STR">STR</option>
                <option value="DEX">DEX</option>
                <option value="CON">CON</option>
                <option value="INT">INT</option>
                <option value="WIS">WIS</option>
                <option value="CHA">CHA</option>
              </select>
              <input type="number" step="0.01" value="1" name="attr_persuasion_value" readonly />
              <div class="sheet-button-div-holder">
                <button type="roll" class="sheet-button-description" name="roll_persuasion" value="@{global-privacy-status} {{@{global-advantage-status}=1}} &{template:levelup} {{name=Persuasion}} {{roll=[[1d20+@{persuasion_value}+@{persuasion_expertisedice}]]}} {{roll1=[[1d20+@{persuasion_value}+@{persuasion_expertisedice}]]}} {{roll2=[[1d20+@{persuasion_value}+@{persuasion_expertisedice}]]}} {{charactername=@{character_name}}} {{category=Skill}}"></button>
                <h4 data-i18n="persuasion-label">Persuasion</h4>
              </div>
              <input type="text" value="" name="attr_persuasion_text" />
              <select name="attr_persuasion_expertisedice">
                <option value="0" selected>-</option>
                <option value="1d4">d4</option>
                <option value="1d6">d6</option>
                <option value="1d8">d8</option>
                <option value="1d10">d10</option>
                <option value="1d12">d12</option>
                <option value="1d20">d20</option>
              </select>
            </div>

            <!-- Religion -->
            <div class="sheet-main-skills-religion">
              <input type="checkbox" value="1" name="attr_religion_active" />
              <select name="attr_religion_proficiency_selector">
                <option value="" selected>-</option>
                <option value="STR">STR</option>
                <option value="DEX">DEX</option>
                <option value="CON">CON</option>
                <option value="INT">INT</option>
                <option value="WIS">WIS</option>
                <option value="CHA">CHA</option>
              </select>
              <input type="number" step="0.01" value="1" name="attr_religion_value" readonly />
              <div class="sheet-button-div-holder">
                <button type="roll" class="sheet-button-description" name="roll_religion" value="@{global-privacy-status} {{@{global-advantage-status}=1}} &{template:levelup} {{name=Religion}} {{roll=[[1d20+@{religion_value}+@{religion_expertisedice}]]}} {{roll1=[[1d20+@{religion_value}+@{religion_expertisedice}]]}} {{roll2=[[1d20+@{religion_value}+@{religion_expertisedice}]]}} {{charactername=@{character_name}}} {{category=Skill}}"></button>
                <h4 data-i18n="religion-label">Religion</h4>
              </div>
              <input type="text" value="" name="attr_religion_text" />
              <select name="attr_religion_expertisedice">
                <option value="0" selected>-</option>
                <option value="1d4">d4</option>
                <option value="1d6">d6</option>
                <option value="1d8">d8</option>
                <option value="1d10">d10</option>
                <option value="1d12">d12</option>
                <option value="1d20">d20</option>
              </select>
            </div>

            <!-- Sleight of Hand -->
            <div class="sheet-main-skills-sleightofhand">
              <input type="checkbox" value="1" name="attr_sleightofhand_active" />
              <select name="attr_sleightofhand_proficiency_selector">
                <option value="" selected>-</option>
                <option value="STR">STR</option>
                <option value="DEX">DEX</option>
                <option value="CON">CON</option>
                <option value="INT">INT</option>
                <option value="WIS">WIS</option>
                <option value="CHA">CHA</option>
              </select>
              <input type="number" step="0.01" value="1" name="attr_sleightofhand_value" readonly />
              <div class="sheet-button-div-holder">
                <button type="roll" class="sheet-button-description" name="roll_sleightofhand" value="@{global-privacy-status} {{@{global-advantage-status}=1}} &{template:levelup} {{name=Sleight of Hand}} {{roll=[[1d20+@{sleightofhand_value}+@{sleightofhand_expertisedice}]]}} {{roll1=[[1d20+@{sleightofhand_value}+@{sleightofhand_expertisedice}]]}} {{roll2=[[1d20+@{sleightofhand_value}+@{sleightofhand_expertisedice}]]}} {{charactername=@{character_name}}} {{category=Skill}}"></button>
                <h4 data-i18n="sleight-of-hand-label">Sleight of Hand</h4>
              </div>
              <input type="text" value="" name="attr_sleightofhand_text" />
              <select name="attr_sleightofhand_expertisedice">
                <option value="0" selected>-</option>
                <option value="1d4">d4</option>
                <option value="1d6">d6</option>
                <option value="1d8">d8</option>
                <option value="1d10">d10</option>
                <option value="1d12">d12</option>
                <option value="1d20">d20</option>
              </select>
            </div>

            <!-- Stealth -->
            <div class="sheet-main-skills-stealth">
              <input type="checkbox" value="1" name="attr_stealth_active" />
              <select name="attr_stealth_proficiency_selector">
                <option value="" selected>-</option>
                <option value="STR">STR</option>
                <option value="DEX">DEX</option>
                <option value="CON">CON</option>
                <option value="INT">INT</option>
                <option value="WIS">WIS</option>
                <option value="CHA">CHA</option>
              </select>
              <input type="number" step="0.01" value="1" name="attr_stealth_value" readonly />
              <div class="sheet-button-div-holder">
                <button type="roll" class="sheet-button-description" name="roll_survival" value="@{global-privacy-status} {{@{global-advantage-status}=1}} &{template:levelup} {{name=Survival}} {{roll=[[1d20+@{survival_value}+@{survival_expertisedice}]]}} {{roll1=[[1d20+@{survival_value}+@{survival_expertisedice}]]}} {{roll2=[[1d20+@{survival_value}+@{survival_expertisedice}]]}} {{charactername=@{character_name}}} {{category=Skill}}"></button>
                <h4 data-i18n="stealth-label">Stealth</h4>
              </div>
              <input type="text" value="" name="attr_stealth_text" />
              <select name="attr_stealth_expertisedice">
                <option value="0" selected>-</option>
                <option value="1d4">d4</option>
                <option value="1d6">d6</option>
                <option value="1d8">d8</option>
                <option value="1d10">d10</option>
                <option value="1d12">d12</option>
                <option value="1d20">d20</option>
              </select>
            </div>

            <!-- Survival -->
            <div class="sheet-main-skills-survival">
              <input type="checkbox" value="1" name="attr_survival_active" />
              <select name="attr_survival_proficiency_selector">
                <option value="" selected>-</option>
                <option value="STR">STR</option>
                <option value="DEX">DEX</option>
                <option value="CON">CON</option>
                <option value="INT">INT</option>
                <option value="WIS">WIS</option>
                <option value="CHA">CHA</option>
              </select>
              <input type="number" step="0.01" value="1" name="attr_survival_value" readonly />
              <div class="sheet-button-div-holder">
                <button type="roll" class="sheet-button-description" name="roll_survival" value="@{global-privacy-status} {{@{global-advantage-status}=1}} &{template:levelup} {{name=Survival}} {{roll=[[1d20+@{survival_value}+@{survival_expertisedice}]]}} {{roll1=[[1d20+@{survival_value}+@{survival_expertisedice}]]}} {{roll2=[[1d20+@{survival_value}+@{survival_expertisedice}]]}} {{charactername=@{character_name}}} {{category=Skill}}"></button>
                <h4 data-i18n="survival-label">Survival</h4>
              </div>
              <input type="text" value="" name="attr_survival_text" />
              <select name="attr_survival_expertisedice">
                <option value="0" selected>-</option>
                <option value="1d4">d4</option>
                <option value="1d6">d6</option>
                <option value="1d8">d8</option>
                <option value="1d10">d10</option>
                <option value="1d12">d12</option>
                <option value="1d20">d20</option>
              </select>
            </div>

            <!-- Vehicles -->
            <div class="sheet-main-skills-vehicles">
              <input type="checkbox" value="1" name="attr_vehicles_active" />
              <select name="attr_vehicles_proficiency_selector">
                <option value="0" selected>-</option>
                <option value="STR">STR</option>
                <option value="DEX">DEX</option>
                <option value="CON">CON</option>
                <option value="INT">INT</option>
                <option value="WIS">WIS</option>
                <option value="CHA">CHA</option>
              </select>
              <input type="number" step="1" value="1" name="attr_vehicles_value" readonly />
              <div class="sheet-button-div-holder">
                <button type="roll" class="sheet-button-description" name="roll_vehicles" value="@{global-privacy-status} {{@{global-advantage-status}=1}} &{template:levelup} {{name=Vehicles}} {{roll=[[1d20+@{vehicles_value}+@{vehicles_expertisedice}]]}} {{roll1=[[1d20+@{vehicles_value}+@{vehicles_expertisedice}]]}} {{roll2=[[1d20+@{vehicles_value}+@{vehicles_expertisedice}]]}} {{charactername=@{character_name}}} {{category=Skill}}"></button>
                <h4 data-i18n="vehicles-label">Vehicles</h4>
              </div>
              <input type="text" value="" name="attr_vehicles_text" />
              <select name="attr_vehicles_expertisedice">
                <option value="0" selected>-</option>
                <option value="1d4">d4</option>
                <option value="1d6">d6</option>
                <option value="1d8">d8</option>
                <option value="1d10">d10</option>
                <option value="1d12">d12</option>
                <option value="1d20">d20</option>
              </select>
            </div>
          </div>
        </div>

        <script id="✓ CALC : Skill Values" type="text/worker">
          const STATMAP={
            "STR":"strength-bonus",
            "DEX":"dexterity-bonus",
            "CON":"constitution-bonus",
            "INT":"intelligence-bonus",
            "WIS":"wisdom-bonus",
            "CHA":"charisma-bonus"
          };

          const SKILLS=[
            "acrobatics","animalhandling","arcana","athletics","culture","deception","engineering","history",
            "insight","intimidation","investigation","medicine","nature","perception","performance","persuasion",
            "religion","sleightofhand","stealth","survival","vehicles"
          ];

          const STATS=[
            "strength-bonus","dexterity-bonus","constitution-bonus",
            "intelligence-bonus","wisdom-bonus","charisma-bonus",
            "pb","global-skill-bonus"
          ];

          SKILLS.forEach(skill=>{
            const selector=`${skill}_proficiency_selector`;
            const active=`${skill}_active`;
            const text=`${skill}_text`;
            const bonus=`${skill}_bonus`;
            const value=`${skill}_value`;

            on(
              `sheet:opened change:${selector} change:${active} change:${text} change:${bonus} ` +
              STATS.map(s=>`change:${s}`).join(" "),
              function(){
                const attributes=[selector,active,text,bonus,...STATS];
                getAttrs(attributes,function(v){
                  const stat=v[selector];
                  const base=STATMAP[stat] ? parseInt(v[STATMAP[stat]])||0 : 0;
                  const activeBonus = parseInt(v[active]||0,10) ? parseInt(v.pb||0,10) : 0;
                  const adminBonus  = parseInt(v[bonus]||0);
                  const globalBonus = parseInt(v["global-skill-bonus"]||0);

                  const total = base + activeBonus + adminBonus + globalBonus;

                  setAttrs({ [value]: total });
                });
              }
            );
          });
        </script>
      </div>
    </div>
  </div>

  <!-- ----- SPELLS -----  -->
  <div class="sheet-spells-display sheet-hidden">
    <div class="sheet-maingrid-area-talents">
      <div class="sheet-talent-headersection sheet-talent-headersection1">
        <!-- ----- SPELLCASTING CLASS -----  -->
        <div class="sheet-talent-savedc">
          <div class="sheet-standardbox sheet-standardbox2">
            <div class="sheet-oneline">
              <input class="sheet-inputchar" type="text" placeholder="Class Name" data-i18n-placeholder="class-name-placeholder" name="attr_class" />
            </div>
          </div>
          <h4 data-i18n="sc-class-label">SC Class</h4>
        </div>

        <!-- ----- SPELLCASTING ABILITY -----  -->
        <div class="sheet-talent-ability">
          <div class="sheet-standardbox sheet-standardbox2">
            <div class="sheet-oneline">
              <select class="sheet-inputchar" name="attr_spell_ability">
                <option selected value="0">-</option>
                <option value="str">STR</option>
                <option value="dex">DEX</option>
                <option value="con">CON</option>
                <option value="int">INT</option>
                <option value="wis">WIS</option>
                <option value="cha">CHA</option>
              </select>
            </div>
          </div>
          <h4 data-i18n="sc-ability-label">SC Ability</h4>
        </div>

        <!-- ----- SPELLCASTING SAVE DC -----  -->
        <div class="sheet-talent-savedc">
          <div class="sheet-standardbox sheet-standardbox2">
            <div class="sheet-oneline">
              <input class="sheet-inputchar" type="number" step="1" value="0" name="attr_spell-save-dc" readonly />
              <input class="sheet-inputchar3" type="number" step="1" value="0" name="attr_spell-save-dc-mod" />
            </div>
          </div>
          <h4 data-i18n="sc-save-dc-label">SC Save DC</h4>
        </div>

        <!-- ----- SPELLCASTING ATTACK BONUS -----  -->
        <div class="sheet-talent-attackbonus">
          <div class="sheet-standardbox sheet-standardbox2">
            <div class="sheet-oneline">
              <input class="sheet-inputchar" type="number" step="0.01" value="0" name="attr_spell-attackbonus" readonly />
              <input class="sheet-inputchar3" type="number" step="1" value="0" name="attr_spell-attackbonus-mod" />
            </div>
          </div>
          <h4 data-i18n="sc-attack-bonus-label">SC Attack Bonus</h4>
        </div>

        <script id="SPELLS : SAVE DC & ATTACK BONUS CALC" type="text/worker">
          const SPELLSTAT={
            str:"strength-bonus",
            dex:"dexterity-bonus",
            con:"constitution-bonus",
            int:"intelligence-bonus",
            wis:"wisdom-bonus",
            cha:"charisma-bonus"
          };

          const FIELDS=[
            "spell_ability",
            "pb",
            "strength-bonus",
            "dexterity-bonus",
            "constitution-bonus",
            "intelligence-bonus",
            "wisdom-bonus",
            "charisma-bonus",
            "spell-save-dc-mod",
            "spell-attackbonus-mod"
          ];

          on("sheet:opened "+FIELDS.map(f=>"change:"+f).join(" "),()=>{
            getAttrs(FIELDS,v=>{
              const key=v.spell_ability||"0";
              const statAttr=SPELLSTAT[key];
              const statMod=statAttr?parseInt(v[statAttr]||0,10):0;
              const pb=parseInt(v.pb||0,10);
              const dcMod=parseInt(v["spell-save-dc-mod"]||0,10);
              const atkMod=parseInt(v["spell-attackbonus-mod"]||0,10);

              setAttrs({
                "spell-save-dc":8+pb+statMod+dcMod,
                "spell-attackbonus":pb+statMod+atkMod
              });
            });
          });
        </script>

        <!-- ----- SPELL POINTS -----  -->
        <div class="sheet-talent-spellpoints">
          <div class="sheet-standardbox sheet-standardbox2">
            <div class="sheet-oneline">
              <input class="sheet-inputchar" type="number" step="1" value="0" name="attr_talent-spellpoints" readonly />
              <input class="sheet-inputchar3" type="number" step="1" value="0" name="attr_talent-spellpoints-mod" />
            </div>
          </div>
          <h4 data-i18n="spell-points-label">Spell Points</h4>
        </div>
      </div>

      <script id="TALENTS : HEADER SWITCH" type="text/worker">
        on("sheet:opened change:class1 change:class2 change:class3",()=>{
          getAttrs(["class1","class2","class3"],v=>{
            const c1=v.class1||"";
            const c2=v.class2||"";
            const c3=v.class3||"";

            const isCaster =
              c1==="Warlock" || c1==="Sorcerer" ||
              c2==="Warlock" || c2==="Sorcerer" ||
              c3==="Warlock" || c3==="Sorcerer";

            const head=$20(".sheet-talent-headersection");
            head.removeClass("sheet-talent-headersection1 sheet-talent-headersection2");
            head.addClass(isCaster ? "sheet-talent-headersection1" : "sheet-talent-headersection2");

            const box=$20(".sheet-talent-spellpoints");
            if(isCaster) box.removeClass("sheet-hidden");
            else box.addClass("sheet-hidden");
          });
        });
      </script>

      <script id="✓ CALC : Spell Button Links" type="text/worker">
        const spellSections = [
          "repeating_atwill",
          "repeating_level1",
          "repeating_level2",
          "repeating_level3",
          "repeating_level4",
          "repeating_level5",
          "repeating_level6",
          "repeating_level7",
          "repeating_level8",
          "repeating_level9"
        ];

        spellSections.forEach(section => {
          on(`sheet:opened change:${section} remove:${section}`, () => {
            getSectionIDs(section, ids => {
              const updates = {};
              ids.forEach(id => {
                updates[`${section}_${id}_talent-button`] = `[Description](~${id}__show-description)`;
              });
              setAttrs(updates, { silent: true });
            });
          });
        });
      </script>

      <script id="✓ CALC : Talent Details Toggle" type="text/worker">
        const sections = [
          "repeating_atwill",
          "repeating_level1", "repeating_level2", "repeating_level3",
          "repeating_level4", "repeating_level5", "repeating_level6",
          "repeating_level7", "repeating_level8", "repeating_level9"
        ];

        const fieldsToCheck = [
          "talent-usetime",
          "talent-duration",
          "talent-range",
          "talent-target",
          "talent-charges"
        ];

        const autoFillFields = [
          "talent-dmg1",
          "talent-dmg2"
        ];

        const generateTriggers = () =>
          sections.flatMap(section =>
            [...fieldsToCheck, ...autoFillFields].map(field => `change:${section}:${field}`)
          ).join(" ");

        on(`sheet:opened ${generateTriggers()}`, () => {
          sections.forEach(section => {
            getSectionIDs(section, ids => {
              if (!ids.length) return;

              const attrs = ids.flatMap(id =>
                [...fieldsToCheck, ...autoFillFields].map(field => `${section}_${id}_${field}`)
              );

              getAttrs(attrs, values => {
                const updates = {};

                ids.forEach(id => {
                  const detailCheck = fieldsToCheck.some(field => {
                    const val = values[`${section}_${id}_${field}`] || "";
                    return val.trim() !== "";
                  });

                  updates[`${section}_${id}_talent-details`] = detailCheck ? "1" : "0";

                  // Auto-fill DMG fields
                  autoFillFields.forEach(field => {
                    const key = `${section}_${id}_${field}`;
                    if (!values[key] || values[key].trim() === "") {
                      updates[key] = "0";
                    }
                  });
                });

                if (Object.keys(updates).length) {
                  setAttrs(updates, { silent: true });
                }
              });
            });
          });
        });
      </script>

      <script id="✓ - CALC : Talent Save & Attack Bonus" type="text/worker">
        const sections = [
          "repeating_atwill",
          "repeating_level1", "repeating_level2", "repeating_level3",
          "repeating_level4", "repeating_level5", "repeating_level6",
          "repeating_level7", "repeating_level8", "repeating_level9"
        ];

        const abilityBonusMap = {
          "Strength": "strength-bonus",
          "Dexterity": "dexterity-bonus",
          "Constitution": "constitution-bonus",
          "Intelligence": "intelligence-bonus",
          "Wisdom": "wisdom-bonus",
          "Charisma": "charisma-bonus"
        };

        const triggers = sections.map(section =>
          `change:${section}:talent_ability change:${section}:talent-save-ability`
        ).join(" ");

        on(`sheet:opened change:pb ${triggers} change:strength-bonus change:dexterity-bonus change:constitution-bonus change:intelligence-bonus change:wisdom-bonus change:charisma-bonus`,
          function(eventInfo) {

            const match = eventInfo.sourceAttribute.match(/(repeating_[^_]+)_([a-zA-Z0-9\-]+)_/);
            if (!match) return;

            const section = match[1];
            const rowId = match[2];
            const prefix = `${section}_${rowId}_`;

            const attrs = [
              "pb",
              `${prefix}talent_ability`,
              `${prefix}talent-save-ability`
            ];

            // Ajouter tous les bonus
            Object.values(abilityBonusMap).forEach(b => attrs.push(b));

            getAttrs(attrs, values => {
              const pb = parseInt(values.pb || 0, 10);

              const abilityLabel = values[`${prefix}talent_ability`];
              const saveLabel    = values[`${prefix}talent-save-ability`];

              const abilityBonusAttr = abilityBonusMap[abilityLabel];
              const saveBonusAttr    = abilityBonusMap[saveLabel];

              const setObj = {};

              if (abilityBonusAttr) {
                const mod = parseInt(values[abilityBonusAttr] || 0, 10);
                setObj[`${prefix}talent-attackbonus`] = pb + mod;
              }

              if (saveLabel !== "Custom" && saveBonusAttr) {
                const smod = parseInt(values[saveBonusAttr] || 0, 10);
                setObj[`${prefix}talent-save`] = 8 + pb + smod;
              }

              setAttrs(setObj);
            });
          }
        );
      </script>

      <div class="sheet-triplecolumn">
        <div class="sheet-talent-leftcolumn">
          <!-- ----- SPELLS AT WILL -----  -->
          <div class="sheet-talent-atwill-talents sheet-talent-section">
            <div class="sheet-standardbox sheet-standardbox2">
              <h4 class="sheet-minititles2" data-i18n="cantrips-label">Cantrips</h4>

              <div class="sheet-oneline">
                <fieldset class="repeating_atwill">
                  <input class="sheet-hidden sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                  <div class="sheet-talent-card sheet-cogs-hideshow-div1">
                    <div class="sheet-talent-card-line5">
                      <h4 data-i18n="name-label-2">Name:</h4>
                      <input type="text" placeholder="Name" data-i18n-placeholder="name-placeholder" name="attr_talent-name" />
                      <div class="sheet-cogs-container">
                        <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                        <span class="sheet-cogs-icon">y</span>
                      </div>
                    </div>

                    <div class="sheet-talent-card-line6">
                      <h4 data-i18n="source-label">Source:</h4>
                      <input type="text" placeholder="Source" data-i18n-placeholder="source-placeholder" name="attr_talent-source" />
                      <input class="sheet-concentration" type="checkbox" value="1" name="attr_talent-concentration" />
                      <input class="sheet-ritual" type="checkbox" value="1" name="attr_talent-ritual" />
                    </div>

                    <div class="sheet-talent-card-line3">
                      <h4 data-i18n="ability-label">Ability:</h4>
                      <select name="attr_talent_ability">
                        <option selected value="0">-</option>
                        <option value="Strength" data-i18n="strength-option">Strength</option>
                        <option value="Dexterity" data-i18n="dexterity-option">Dexterity</option>
                        <option value="Constitution" data-i18n="constitution-option">Constitution</option>
                        <option value="Intelligence" data-i18n="intelligence-option">Intelligence</option>
                        <option value="Wisdom" data-i18n="wisdom-option">Wisdom</option>
                        <option value="Charisma" data-i18n="charisma-option">Charisma</option>
                      </select>
                      <input style="text-align: center !important" type="number" value="0" name="attr_talent-attackbonus" readonly />
                    </div>

                    <div class="sheet-talent-card-line0">
                      <h4 data-i18n="usage-label">Usage:</h4>
                      <input type="text" placeholder="Usage" data-i18n-placeholder="usage-placeholder" name="attr_talent-usetime" />
                      <h4 data-i18n="duration-label">Duration:</h4>
                      <input type="text" placeholder="Duration" data-i18n-placeholder="duration-placeholder" name="attr_talent-duration" />
                      <h4 data-i18n="range-label">Range:</h4>
                      <input type="text" placeholder="Range" data-i18n-placeholder="range-placeholder" name="attr_talent-range" />
                      <h4 data-i18n="target-label">Target:</h4>
                      <input type="text" placeholder="Target" data-i18n-placeholder="target-placeholder" name="attr_talent-target" />
                      <h4 data-i18n="charges-label">Charges:</h4>
                      <input type="text" placeholder="-" name="attr_talent-charges" />
                      <input class="sheet-hidden" type="number" value="0" name="attr_talent-details" />
                    </div>

                    <div class="sheet-talent-card-line2">
                      <h4 data-i18n="dmg-1-label">DMG 1:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg1" />
                      <h4 data-i18n="type-label-2">Type:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg1-type" />
                      <h4 data-i18n="dmg-2-label">DMG 2:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg2" />
                      <h4 data-i18n="type-label-2">Type:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg2-type" />
                    </div>

                    <div class="sheet-talent-card-line3">
                      <h4 data-i18n="save-ability-label">Save Ability:</h4>
                      <select name="attr_talent-save-ability">
                        <option selected value="0">-</option>
                        <option value="Strength" data-i18n="strength-option">Strength</option>
                        <option value="Dexterity" data-i18n="dexterity-option">Dexterity</option>
                        <option value="Constitution" data-i18n="constitution-option">Constitution</option>
                        <option value="Intelligence" data-i18n="intelligence-option">Intelligence</option>
                        <option value="Wisdom" data-i18n="wisdom-option">Wisdom</option>
                        <option value="Charisma" data-i18n="charisma-option">Charisma</option>
                        <option value="Custom" data-i18n="custom-option">Custom</option>
                      </select>
                      <input style="text-align: center !important" type="number" value="0" name="attr_talent-save" />
                    </div>

                    <div class="sheet-talent-card-line0">
                      <h4 data-i18n="save-effect-label">Save Effect:</h4>
                      <textarea placeholder="e.g. 1/2 of normal damages" data-i18n-placeholder="eg-1-2-of-normal-damages-placeholder" name="attr_talent-saveeffects"></textarea>
                    </div>

                    <div class="sheet-talent-card-line0" style="grid-template-columns: 71px 1fr;">
                       <h4 data-i18n="roll-type-label-2">Roll Type:</h4>
                    <select name="attr_attacks_tooglespell">
                <option value="withroll" data-i18n="with-roll-option">With Roll</option>
                <option value="norollnodamage" data-i18n="only-desc-option">Only Desc.</option>
                <option value="withdmg" selected data-i18n="dmg-only-option">DMG Only</option>
              </select>
               </div>

                    <div class="sheet-talent-card-line0">
                      <h4 data-i18n="description-label">Description:</h4>
                      <textarea placeholder="Description" data-i18n-placeholder="description-placeholder" name="attr_talent-description"></textarea>
                    </div>
                  </div>

                  <div class="sheet-talent-card sheet-cogs-hideshow-div2">
                    <div class="sheet-talent-card2">
                      <input class="sheet-checkbox-active" type="checkbox" value="1" name="attr_talent-active" />

                      <div class="sheet-talent-card-line4 sheet-button-div-holder">
                        <button type="roll" class="sheet-button-description" name="roll_talent" value="@{global-privacy-status} &{template:levelup} {{@{attacks_tooglespell}=1}} {{critical=[[0]]}} {{details=[[@{talent-details}]]}} {{name=@{talent-name}}} {{charactername=@{character_name}}} {{category=Cantrips}} {{@{global-advantage-status}=1}} {{roll=[[1d20+@{talent-attackbonus}]]}} {{roll1=[[1d20+@{talent-attackbonus}]]}} {{roll2=[[1d20+@{talent-attackbonus}]]}} {{usage=@{talent-usetime}}} {{duration=@{talent-duration}}} {{range=@{talent-range}}} {{target=@{talent-target}}} {{charge=@{talent-charges}}} {{dmg1=[[@{talent-dmg1}]]}} {{dmg1crit=[[@{talent-dmg1}]]}} {{dmg2=[[@{talent-dmg2}]]}} {{dmg2crit=[[@{talent-dmg2}]]}} {{dmg1type=@{talent-dmg1-type}}} {{dmg2type=@{talent-dmg2-type}}} {{save=[[@{talent-save}]]}} {{savecomp=@{talent-save-ability}}} {{saveeffect=@{talent-saveeffects}}} {{button=@{talent-button}}} {{desc=@{talent-description}}} {{description=@{talent-description}}}"></button>
                        <input style="grid-column: 1/-1" class="sheet-hidden" type="text" value="" name="attr_talent-button" />
                        <button type="roll" class="sheet-hidden" name="roll_show-description" value="@{global-privacy-status} &{template:levelup-description} {{name=Description}} {{description=@{talent-description}}}"></button>

                        <span class="sheet-talent-name" style="text-align: left !important" name="attr_talent-name"></span>

                        <input class="sheet-hidden sheet-concentration" type="checkbox" value="1" name="attr_talent-concentration" />
                        <span class="sheet-isconcentration" style="text-align: left !important" name="attr_talent-concentration-display">C</span>

                        <input class="sheet-hidden sheet-ritual" type="checkbox" value="1" name="attr_talent-ritual" />
                        <span class="sheet-isritual" style="text-align: left !important" name="attr_talent-ritual-display">R</span>
                      </div>

                      <div class="sheet-cogs-container sheet-button-div-holder">
                        <input class="sheet-cogs-input sheet-description-hideshow" type="checkbox" name="attr_sheet-description-hideshow" />
                        <span class="sheet-cogs-icon">w</span>
                      </div>

                      <div class="sheet-cogs-container">
                        <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                        <span class="sheet-cogs-icon">y</span>
                      </div>

                      <input class="sheet-hidden sheet-description-hideshow" type="checkbox" name="attr_sheet-description-hideshow" />
                      <span class="sheet-talent-source" type="text" name="attr_talent-source"></span>
                      <textarea class="sheet-description-hideshow-div" style="grid-column: 1/-1" type="text" value="-" name="attr_talent-description" readonly></textarea>
                    </div>
                  </div>
                </fieldset>
              </div>
            </div>
          </div>

          <!-- ----- SPELLS LEVEL 1 -----  -->
          <div class="sheet-talent-level1-talents sheet-talent-section">
            <div class="sheet-standardbox sheet-standardbox2">
              <h4 class="sheet-minititles2" data-i18n="level-1-spells-label">LEVEL 1 SPELLS</h4>

              <div class="sheet-oneline">
                <div class="sheet-warlockdisplay-no sheet-spellpresentation">
                  <input type="number" value="0" name="attr_spell1-know" />
                  <input type="number" value="0" name="attr_spell1-slots" />
                  <input type="number" value="0" name="attr_spell1-expended" />
                  <h4 data-i18n="2-label">2</h4>
                  <h4 data-i18n="know-label">Know</h4>
                  <h4 data-i18n="slots-label">Slots</h4>
                  <h4 data-i18n="expended-label">Expended</h4>
                  <h4 data-i18n="sp-label">SP</h4>
                </div>

                <div class="sheet-warlockdisplay-yes sheet-hidden sheet-spellpresentation">
                  <h4 data-i18n="nbsp-label">&nbsp;</h4>
                  <h4 data-i18n="nbsp-label">&nbsp;</h4>
                  <h4 data-i18n="sp-label">SP</h4>
                  <h4 data-i18n="2-label">2</h4>
                </div>

                <fieldset class="repeating_level1">
                  <input class="sheet-hidden sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                  <div class="sheet-talent-card sheet-cogs-hideshow-div1">
                    <div class="sheet-talent-card-line5">
                      <h4 data-i18n="name-label-2">Name:</h4>
                      <input type="text" placeholder="Name" data-i18n-placeholder="name-placeholder" name="attr_talent-name" />
                      <div class="sheet-cogs-container">
                        <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                        <span class="sheet-cogs-icon">y</span>
                      </div>
                    </div>

                    <div class="sheet-talent-card-line6">
                      <h4 data-i18n="source-label">Source:</h4>
                      <input type="text" placeholder="Source" data-i18n-placeholder="source-placeholder" name="attr_talent-source" />
                      <input class="sheet-concentration" type="checkbox" value="1" name="attr_talent-concentration" />
                      <input class="sheet-ritual" type="checkbox" value="1" name="attr_talent-ritual" />
                    </div>

                    <div class="sheet-talent-card-line3">
                      <h4 data-i18n="ability-label">Ability:</h4>
                      <select name="attr_talent_ability">
                        <option selected value="0">-</option>
                        <option value="Strength" data-i18n="strength-option">Strength</option>
                        <option value="Dexterity" data-i18n="dexterity-option">Dexterity</option>
                        <option value="Constitution" data-i18n="constitution-option">Constitution</option>
                        <option value="Intelligence" data-i18n="intelligence-option">Intelligence</option>
                        <option value="Wisdom" data-i18n="wisdom-option">Wisdom</option>
                        <option value="Charisma" data-i18n="charisma-option">Charisma</option>
                      </select>
                      <input style="text-align: center !important" type="number" value="0" name="attr_talent-attackbonus" readonly />
                    </div>

                    <div class="sheet-talent-card-line0">
                      <h4 data-i18n="usage-label">Usage:</h4>
                      <input type="text" placeholder="Usage" data-i18n-placeholder="usage-placeholder" name="attr_talent-usetime" />
                      <h4 data-i18n="duration-label">Duration:</h4>
                      <input type="text" placeholder="Duration" data-i18n-placeholder="duration-placeholder" name="attr_talent-duration" />
                      <h4 data-i18n="range-label">Range:</h4>
                      <input type="text" placeholder="Range" data-i18n-placeholder="range-placeholder" name="attr_talent-range" />
                      <h4 data-i18n="target-label">Target:</h4>
                      <input type="text" placeholder="Target" data-i18n-placeholder="target-placeholder" name="attr_talent-target" />
                      <h4 data-i18n="charges-label">Charges:</h4>
                      <input type="text" placeholder="-" name="attr_talent-charges" />
                      <input class="sheet-hidden" type="number" value="0" name="attr_talent-details" />
                    </div>

                    <div class="sheet-talent-card-line2">
                      <h4 data-i18n="dmg-1-label">DMG 1:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg1" />
                      <h4 data-i18n="type-label-2">Type:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg1-type" />
                      <h4 data-i18n="dmg-2-label">DMG 2:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg2" />
                      <h4 data-i18n="type-label-2">Type:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg2-type" />
                    </div>

                    <div class="sheet-talent-card-line3">
                      <h4 data-i18n="save-ability-label">Save Ability:</h4>
                      <select name="attr_talent-save-ability">
                        <option selected value="0">-</option>
                        <option value="Strength" data-i18n="strength-option">Strength</option>
                        <option value="Dexterity" data-i18n="dexterity-option">Dexterity</option>
                        <option value="Constitution" data-i18n="constitution-option">Constitution</option>
                        <option value="Intelligence" data-i18n="intelligence-option">Intelligence</option>
                        <option value="Wisdom" data-i18n="wisdom-option">Wisdom</option>
                        <option value="Charisma" data-i18n="charisma-option">Charisma</option>
                        <option value="Custom" data-i18n="custom-option">Custom</option>
                      </select>
                      <input style="text-align: center !important" type="number" value="0" name="attr_talent-save" />
                    </div>

                    <div class="sheet-talent-card-line0">
                      <h4 data-i18n="save-effect-label">Save Effect:</h4>
                      <textarea placeholder="e.g. 1/2 of normal damages" data-i18n-placeholder="eg-1-2-of-normal-damages-placeholder" name="attr_talent-saveeffects"></textarea>
                    </div>

                    <div class="sheet-talent-card-line0">
                      <h4 data-i18n="description-label">Description:</h4>
                      <textarea placeholder="Description" data-i18n-placeholder="description-placeholder" name="attr_talent-description"></textarea>
                    </div>
                  </div>

                  <div class="sheet-talent-card sheet-cogs-hideshow-div2">
                    <div class="sheet-talent-card2">
                      <input class="sheet-checkbox-active" type="checkbox" value="1" name="attr_talent-active" />

                      <div class="sheet-talent-card-line4 sheet-button-div-holder">
                        <button type="roll" class="sheet-button-description" name="roll_talent" value="@{global-privacy-status} &{template:levelup} {{details=[[@{talent-details}]]}} {{name=@{talent-name}}} {{charactername=@{character_name}}} {{category=Lvl 1}} {{@{global-advantage-status}=1}} {{roll=[[1d20+@{talent-attackbonus}]]}} {{roll1=[[1d20+@{talent-attackbonus}]]}} {{roll2=[[1d20+@{talent-attackbonus}]]}} {{usage=@{talent-usetime}}} {{duration=@{talent-duration}}} {{range=@{talent-range}}} {{target=@{talent-target}}} {{charge=@{talent-charges}}} {{dmg1=[[@{talent-dmg1}]]}} {{dmg2=[[@{talent-dmg2}]]}} {{dmg1type=@{talent-dmg1-type}}} {{dmg2type=@{talent-dmg2-type}}} {{save=[[@{talent-save}]]}} {{savecomp=@{talent-save-ability}}} {{saveeffect=@{talent-saveeffects}}} {{button=@{talent-button}}} {{desc=@{talent-description}}}"></button>
                        <input style="grid-column: 1/-1" class="sheet-hidden" type="text" value="" name="attr_talent-button" />
                        <button type="roll" class="sheet-hidden" name="roll_show-description" value="@{global-privacy-status} &{template:levelup-description} {{name=Description}} {{description=@{talent-description}}}"></button>

                        <span class="sheet-talent-name" style="text-align: left !important" name="attr_talent-name"></span>

                        <input class="sheet-hidden sheet-concentration" type="checkbox" value="1" name="attr_talent-concentration" />
                        <span class="sheet-isconcentration" style="text-align: left !important" name="attr_talent-concentration-display">C</span>

                        <input class="sheet-hidden sheet-ritual" type="checkbox" value="1" name="attr_talent-ritual" />
                        <span class="sheet-isritual" style="text-align: left !important" name="attr_talent-ritual-display">R</span>
                      </div>

                      <div class="sheet-cogs-container sheet-button-div-holder">
                        <input class="sheet-cogs-input sheet-description-hideshow" type="checkbox" name="attr_sheet-description-hideshow" />
                        <span class="sheet-cogs-icon">w</span>
                      </div>

                      <div class="sheet-cogs-container">
                        <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                        <span class="sheet-cogs-icon">y</span>
                      </div>

                      <input class="sheet-hidden sheet-description-hideshow" type="checkbox" name="attr_sheet-description-hideshow" />
                      <span class="sheet-talent-source" type="text" name="attr_talent-source"></span>
                      <textarea class="sheet-description-hideshow-div" style="grid-column: 1/-1" type="text" value="-" name="attr_talent-description" readonly></textarea>
                    </div>
                  </div>
                </fieldset>
              </div>
            </div>
          </div>

          <!-- ----- SPELLS LEVEL 2 -----  -->
          <div class="sheet-talent-level2-talents sheet-talent-section">
            <div class="sheet-standardbox sheet-standardbox2">
              <h4 class="sheet-minititles2" data-i18n="level-2-spells-label">LEVEL 2 SPELLS</h4>
              <div class="sheet-oneline">
                <div class="sheet-warlockdisplay-no sheet-spellpresentation">
                  <input type="number" value="0" name="attr_spell2-know" />
                  <input type="number" value="0" name="attr_spell2-slots" />
                  <input type="number" value="0" name="attr_spell2-expended" />
                  <h4 data-i18n="3-label">3</h4>
                  <h4 data-i18n="know-label">Know</h4>
                  <h4 data-i18n="slots-label">Slots</h4>
                  <h4 data-i18n="expended-label">Expended</h4>
                  <h4 data-i18n="sp-label">SP</h4>
                </div>

                <div class="sheet-warlockdisplay-yes sheet-hidden sheet-spellpresentation">
                  <h4 data-i18n="nbsp-label">&nbsp;</h4>
                  <h4 data-i18n="nbsp-label">&nbsp;</h4>
                  <h4 data-i18n="sp-label">SP</h4>
                  <h4 data-i18n="3-label">3</h4>
                </div>

                <fieldset class="repeating_level2">
                  <input class="sheet-hidden sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                  <div class="sheet-talent-card sheet-cogs-hideshow-div1">
                    <div class="sheet-talent-card-line5">
                      <h4 data-i18n="name-label-2">Name:</h4>
                      <input type="text" placeholder="Name" data-i18n-placeholder="name-placeholder" name="attr_talent-name" />
                      <div class="sheet-cogs-container">
                        <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                        <span class="sheet-cogs-icon">y</span>
                      </div>
                    </div>

                    <div class="sheet-talent-card-line6">
                      <h4 data-i18n="source-label">Source:</h4>
                      <input type="text" placeholder="Source" data-i18n-placeholder="source-placeholder" name="attr_talent-source" />
                      <input class="sheet-concentration" type="checkbox" value="1" name="attr_talent-concentration" />
                      <input class="sheet-ritual" type="checkbox" value="1" name="attr_talent-ritual" />
                    </div>

                    <div class="sheet-talent-card-line3">
                      <h4 data-i18n="ability-label">Ability:</h4>
                      <select name="attr_talent_ability">
                        <option selected value="0">-</option>
                        <option value="Strength" data-i18n="strength-option">Strength</option>
                        <option value="Dexterity" data-i18n="dexterity-option">Dexterity</option>
                        <option value="Constitution" data-i18n="constitution-option">Constitution</option>
                        <option value="Intelligence" data-i18n="intelligence-option">Intelligence</option>
                        <option value="Wisdom" data-i18n="wisdom-option">Wisdom</option>
                        <option value="Charisma" data-i18n="charisma-option">Charisma</option>
                      </select>
                      <input style="text-align: center !important" type="number" value="0" name="attr_talent-attackbonus" readonly />
                    </div>

                    <div class="sheet-talent-card-line0">
                      <h4 data-i18n="usage-label">Usage:</h4>
                      <input type="text" placeholder="Usage" data-i18n-placeholder="usage-placeholder" name="attr_talent-usetime" />
                      <h4 data-i18n="duration-label">Duration:</h4>
                      <input type="text" placeholder="Duration" data-i18n-placeholder="duration-placeholder" name="attr_talent-duration" />
                      <h4 data-i18n="range-label">Range:</h4>
                      <input type="text" placeholder="Range" data-i18n-placeholder="range-placeholder" name="attr_talent-range" />
                      <h4 data-i18n="target-label">Target:</h4>
                      <input type="text" placeholder="Target" data-i18n-placeholder="target-placeholder" name="attr_talent-target" />
                      <h4 data-i18n="charges-label">Charges:</h4>
                      <input type="text" placeholder="-" name="attr_talent-charges" />
                      <input class="sheet-hidden" type="number" value="0" name="attr_talent-details" />
                    </div>

                    <div class="sheet-talent-card-line2">
                      <h4 data-i18n="dmg-1-label">DMG 1:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg1" />
                      <h4 data-i18n="type-label-2">Type:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg1-type" />
                      <h4 data-i18n="dmg-2-label">DMG 2:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg2" />
                      <h4 data-i18n="type-label-2">Type:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg2-type" />
                    </div>

                    <div class="sheet-talent-card-line3">
                      <h4 data-i18n="save-ability-label">Save Ability:</h4>
                      <select name="attr_talent-save-ability">
                        <option selected value="0">-</option>
                        <option value="Strength" data-i18n="strength-option">Strength</option>
                        <option value="Dexterity" data-i18n="dexterity-option">Dexterity</option>
                        <option value="Constitution" data-i18n="constitution-option">Constitution</option>
                        <option value="Intelligence" data-i18n="intelligence-option">Intelligence</option>
                        <option value="Wisdom" data-i18n="wisdom-option">Wisdom</option>
                        <option value="Charisma" data-i18n="charisma-option">Charisma</option>
                        <option value="Custom" data-i18n="custom-option">Custom</option>
                      </select>
                      <input style="text-align: center !important" type="number" value="0" name="attr_talent-save" />
                    </div>

                    <div class="sheet-talent-card-line0">
                      <h4 data-i18n="save-effect-label">Save Effect:</h4>
                      <textarea placeholder="e.g. 1/2 of normal damages" data-i18n-placeholder="eg-1-2-of-normal-damages-placeholder" name="attr_talent-saveeffects"></textarea>
                    </div>

                    <div class="sheet-talent-card-line0">
                      <h4 data-i18n="description-label">Description:</h4>
                      <textarea placeholder="Description" data-i18n-placeholder="description-placeholder" name="attr_talent-description"></textarea>
                    </div>
                  </div>

                  <div class="sheet-talent-card sheet-cogs-hideshow-div2">
                    <div class="sheet-talent-card2">
                      <input class="sheet-checkbox-active" type="checkbox" value="1" name="attr_talent-active" />

                      <div class="sheet-talent-card-line4 sheet-button-div-holder">
                        <button type="roll" class="sheet-button-description" name="roll_talent" value="@{global-privacy-status} &{template:levelup} {{details=[[@{talent-details}]]}} {{name=@{talent-name}}} {{charactername=@{character_name}}} {{category=Lvl 2}} {{@{global-advantage-status}=1}} {{roll=[[1d20+@{talent-attackbonus}]]}} {{roll1=[[1d20+@{talent-attackbonus}]]}} {{roll2=[[1d20+@{talent-attackbonus}]]}} {{usage=@{talent-usetime}}} {{duration=@{talent-duration}}} {{range=@{talent-range}}} {{target=@{talent-target}}} {{charge=@{talent-charges}}} {{dmg1=[[@{talent-dmg1}]]}} {{dmg2=[[@{talent-dmg2}]]}} {{dmg1type=@{talent-dmg1-type}}} {{dmg2type=@{talent-dmg2-type}}} {{save=[[@{talent-save}]]}} {{savecomp=@{talent-save-ability}}} {{saveeffect=@{talent-saveeffects}}} {{button=@{talent-button}}} {{desc=@{talent-description}}}"></button>
                        <input style="grid-column: 1/-1" class="sheet-hidden" type="text" value="" name="attr_talent-button" />
                        <button type="roll" class="sheet-hidden" name="roll_show-description" value="@{global-privacy-status} &{template:levelup-description} {{name=Description}} {{description=@{talent-description}}}"></button>

                        <span class="sheet-talent-name" style="text-align: left !important" name="attr_talent-name"></span>

                        <input class="sheet-hidden sheet-concentration" type="checkbox" value="1" name="attr_talent-concentration" />
                        <span class="sheet-isconcentration" style="text-align: left !important" name="attr_talent-concentration-display">C</span>

                        <input class="sheet-hidden sheet-ritual" type="checkbox" value="1" name="attr_talent-ritual" />
                        <span class="sheet-isritual" style="text-align: left !important" name="attr_talent-ritual-display">R</span>
                      </div>

                      <div class="sheet-cogs-container sheet-button-div-holder">
                        <input class="sheet-cogs-input sheet-description-hideshow" type="checkbox" name="attr_sheet-description-hideshow" />
                        <span class="sheet-cogs-icon">w</span>
                      </div>

                      <div class="sheet-cogs-container">
                        <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                        <span class="sheet-cogs-icon">y</span>
                      </div>

                      <input class="sheet-hidden sheet-description-hideshow" type="checkbox" name="attr_sheet-description-hideshow" />
                      <span class="sheet-talent-source" type="text" name="attr_talent-source"></span>
                      <textarea class="sheet-description-hideshow-div" style="grid-column: 1/-1" type="text" value="-" name="attr_talent-description" readonly></textarea>
                    </div>
                  </div>
                </fieldset>
              </div>
            </div>
          </div>
        </div>

        <div class="sheet-talent-midcolumn">
          <!-- ----- SPELLS LEVEL 3 -----  -->
          <div class="sheet-talent-level3-talents sheet-talent-section">
            <div class="sheet-standardbox sheet-standardbox2">
              <h4 class="sheet-minititles2" data-i18n="level-3-spells-label">LEVEL 3 SPELLS</h4>
              <div class="sheet-oneline">
                <div class="sheet-warlockdisplay-no sheet-spellpresentation">
                  <input type="number" value="0" name="attr_spell3-know" />
                  <input type="number" value="0" name="attr_spell3-slots" />
                  <input type="number" value="0" name="attr_spell3-expended" />
                  <h4 data-i18n="2-label">2</h4>
                  <h4 data-i18n="know-label">Know</h4>
                  <h4 data-i18n="slots-label">Slots</h4>
                  <h4 data-i18n="expended-label">Expended</h4>
                  <h4 data-i18n="sp-label">SP</h4>
                </div>

                <div class="sheet-warlockdisplay-yes sheet-hidden sheet-spellpresentation">
                  <h4 data-i18n="nbsp-label">&nbsp;</h4>
                  <h4 data-i18n="nbsp-label">&nbsp;</h4>
                  <h4 data-i18n="sp-label">SP</h4>
                  <h4 data-i18n="5-label">5</h4>
                </div>

                <fieldset class="repeating_level3">
                  <input class="sheet-hidden sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                  <div class="sheet-talent-card sheet-cogs-hideshow-div1">
                    <div class="sheet-talent-card-line5">
                      <h4 data-i18n="name-label-2">Name:</h4>
                      <input type="text" placeholder="Name" data-i18n-placeholder="name-placeholder" name="attr_talent-name" />
                      <div class="sheet-cogs-container">
                        <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                        <span class="sheet-cogs-icon">y</span>
                      </div>
                    </div>

                    <div class="sheet-talent-card-line6">
                      <h4 data-i18n="source-label">Source:</h4>
                      <input type="text" placeholder="Source" data-i18n-placeholder="source-placeholder" name="attr_talent-source" />
                      <input class="sheet-concentration" type="checkbox" value="1" name="attr_talent-concentration" />
                      <input class="sheet-ritual" type="checkbox" value="1" name="attr_talent-ritual" />
                    </div>

                    <div class="sheet-talent-card-line3">
                      <h4 data-i18n="ability-label">Ability:</h4>
                      <select name="attr_talent_ability">
                        <option selected value="0">-</option>
                        <option value="Strength" data-i18n="strength-option">Strength</option>
                        <option value="Dexterity" data-i18n="dexterity-option">Dexterity</option>
                        <option value="Constitution" data-i18n="constitution-option">Constitution</option>
                        <option value="Intelligence" data-i18n="intelligence-option">Intelligence</option>
                        <option value="Wisdom" data-i18n="wisdom-option">Wisdom</option>
                        <option value="Charisma" data-i18n="charisma-option">Charisma</option>
                      </select>
                      <input style="text-align: center !important" type="number" value="0" name="attr_talent-attackbonus" readonly />
                    </div>

                    <div class="sheet-talent-card-line0">
                      <h4 data-i18n="usage-label">Usage:</h4>
                      <input type="text" placeholder="Usage" data-i18n-placeholder="usage-placeholder" name="attr_talent-usetime" />
                      <h4 data-i18n="duration-label">Duration:</h4>
                      <input type="text" placeholder="Duration" data-i18n-placeholder="duration-placeholder" name="attr_talent-duration" />
                      <h4 data-i18n="range-label">Range:</h4>
                      <input type="text" placeholder="Range" data-i18n-placeholder="range-placeholder" name="attr_talent-range" />
                      <h4 data-i18n="target-label">Target:</h4>
                      <input type="text" placeholder="Target" data-i18n-placeholder="target-placeholder" name="attr_talent-target" />
                      <h4 data-i18n="charges-label">Charges:</h4>
                      <input type="text" placeholder="-" name="attr_talent-charges" />
                      <input class="sheet-hidden" type="number" value="0" name="attr_talent-details" />
                    </div>

                    <div class="sheet-talent-card-line2">
                      <h4 data-i18n="dmg-1-label">DMG 1:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg1" />
                      <h4 data-i18n="type-label-2">Type:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg1-type" />
                      <h4 data-i18n="dmg-2-label">DMG 2:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg2" />
                      <h4 data-i18n="type-label-2">Type:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg2-type" />
                    </div>

                    <div class="sheet-talent-card-line3">
                      <h4 data-i18n="save-ability-label">Save Ability:</h4>
                      <select name="attr_talent-save-ability">
                        <option selected value="0">-</option>
                        <option value="Strength" data-i18n="strength-option">Strength</option>
                        <option value="Dexterity" data-i18n="dexterity-option">Dexterity</option>
                        <option value="Constitution" data-i18n="constitution-option">Constitution</option>
                        <option value="Intelligence" data-i18n="intelligence-option">Intelligence</option>
                        <option value="Wisdom" data-i18n="wisdom-option">Wisdom</option>
                        <option value="Charisma" data-i18n="charisma-option">Charisma</option>
                        <option value="Custom" data-i18n="custom-option">Custom</option>
                      </select>
                      <input style="text-align: center !important" type="number" value="0" name="attr_talent-save" />
                    </div>

                    <div class="sheet-talent-card-line0">
                      <h4 data-i18n="save-effect-label">Save Effect:</h4>
                      <textarea placeholder="e.g. 1/2 of normal damages" data-i18n-placeholder="eg-1-2-of-normal-damages-placeholder" name="attr_talent-saveeffects"></textarea>
                    </div>

                    <div class="sheet-talent-card-line0">
                      <h4 data-i18n="description-label">Description:</h4>
                      <textarea placeholder="Description" data-i18n-placeholder="description-placeholder" name="attr_talent-description"></textarea>
                    </div>
                  </div>

                  <div class="sheet-talent-card sheet-cogs-hideshow-div2">
                    <div class="sheet-talent-card2">
                      <input class="sheet-checkbox-active" type="checkbox" value="1" name="attr_talent-active" />

                      <div class="sheet-talent-card-line4 sheet-button-div-holder">
                        <button type="roll" class="sheet-button-description" name="roll_talent" value="@{global-privacy-status} &{template:levelup} {{details=[[@{talent-details}]]}} {{name=@{talent-name}}} {{charactername=@{character_name}}} {{category=Lvl 3}} {{@{global-advantage-status}=1}} {{roll=[[1d20+@{talent-attackbonus}]]}} {{roll1=[[1d20+@{talent-attackbonus}]]}} {{roll2=[[1d20+@{talent-attackbonus}]]}} {{usage=@{talent-usetime}}} {{duration=@{talent-duration}}} {{range=@{talent-range}}} {{target=@{talent-target}}} {{charge=@{talent-charges}}} {{dmg1=[[@{talent-dmg1}]]}} {{dmg2=[[@{talent-dmg2}]]}} {{dmg1type=@{talent-dmg1-type}}} {{dmg2type=@{talent-dmg2-type}}} {{save=[[@{talent-save}]]}} {{savecomp=@{talent-save-ability}}} {{saveeffect=@{talent-saveeffects}}} {{button=@{talent-button}}} {{desc=@{talent-description}}}"></button>
                        <input style="grid-column: 1/-1" class="sheet-hidden" type="text" value="" name="attr_talent-button" />
                        <button type="roll" class="sheet-hidden" name="roll_show-description" value="@{global-privacy-status} &{template:levelup-description} {{name=Description}} {{description=@{talent-description}}}"></button>

                        <span class="sheet-talent-name" style="text-align: left !important" name="attr_talent-name"></span>

                        <input class="sheet-hidden sheet-concentration" type="checkbox" value="1" name="attr_talent-concentration" />
                        <span class="sheet-isconcentration" style="text-align: left !important" name="attr_talent-concentration-display">C</span>

                        <input class="sheet-hidden sheet-ritual" type="checkbox" value="1" name="attr_talent-ritual" />
                        <span class="sheet-isritual" style="text-align: left !important" name="attr_talent-ritual-display">R</span>
                      </div>

                      <div class="sheet-cogs-container sheet-button-div-holder">
                        <input class="sheet-cogs-input sheet-description-hideshow" type="checkbox" name="attr_sheet-description-hideshow" />
                        <span class="sheet-cogs-icon">w</span>
                      </div>

                      <div class="sheet-cogs-container">
                        <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                        <span class="sheet-cogs-icon">y</span>
                      </div>

                      <input class="sheet-hidden sheet-description-hideshow" type="checkbox" name="attr_sheet-description-hideshow" />
                      <span class="sheet-talent-source" type="text" name="attr_talent-source"></span>
                      <textarea class="sheet-description-hideshow-div" style="grid-column: 1/-1" type="text" value="-" name="attr_talent-description" readonly></textarea>
                    </div>
                  </div>
                </fieldset>
              </div>
            </div>
          </div>

          <!-- ----- SPELLS LEVEL 4 -----  -->
          <div class="sheet-talent-level4-talents sheet-talent-section">
            <div class="sheet-standardbox sheet-standardbox2">
              <h4 class="sheet-minititles2" data-i18n="level-4-spells-label">LEVEL 4 SPELLS</h4>
              <div class="sheet-oneline">
                <div class="sheet-warlockdisplay-no sheet-spellpresentation">
                  <input type="number" value="0" name="attr_spell4-know" />
                  <input type="number" value="0" name="attr_spell4-slots" />
                  <input type="number" value="0" name="attr_spell4-expended" />
                  <h4 data-i18n="5-label">5</h4>
                  <h4 data-i18n="know-label">Know</h4>
                  <h4 data-i18n="slots-label">Slots</h4>
                  <h4 data-i18n="expended-label">Expended</h4>
                  <h4 data-i18n="sp-label">SP</h4>
                </div>

                <div class="sheet-warlockdisplay-yes sheet-hidden sheet-spellpresentation">
                  <h4 data-i18n="nbsp-label">&nbsp;</h4>
                  <h4 data-i18n="nbsp-label">&nbsp;</h4>
                  <h4 data-i18n="sp-label">SP</h4>
                  <h4 data-i18n="5-label">5</h4>
                </div>

                <fieldset class="repeating_level4">
                  <input class="sheet-hidden sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                  <div class="sheet-talent-card sheet-cogs-hideshow-div1">
                    <div class="sheet-talent-card-line5">
                      <h4 data-i18n="name-label-2">Name:</h4>
                      <input type="text" placeholder="Name" data-i18n-placeholder="name-placeholder" name="attr_talent-name" />
                      <div class="sheet-cogs-container">
                        <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                        <span class="sheet-cogs-icon">y</span>
                      </div>
                    </div>

                    <div class="sheet-talent-card-line6">
                      <h4 data-i18n="source-label">Source:</h4>
                      <input type="text" placeholder="Source" data-i18n-placeholder="source-placeholder" name="attr_talent-source" />
                      <input class="sheet-concentration" type="checkbox" value="1" name="attr_talent-concentration" />
                      <input class="sheet-ritual" type="checkbox" value="1" name="attr_talent-ritual" />
                    </div>

                    <div class="sheet-talent-card-line3">
                      <h4 data-i18n="ability-label">Ability:</h4>
                      <select name="attr_talent_ability">
                        <option selected value="0">-</option>
                        <option value="Strength" data-i18n="strength-option">Strength</option>
                        <option value="Dexterity" data-i18n="dexterity-option">Dexterity</option>
                        <option value="Constitution" data-i18n="constitution-option">Constitution</option>
                        <option value="Intelligence" data-i18n="intelligence-option">Intelligence</option>
                        <option value="Wisdom" data-i18n="wisdom-option">Wisdom</option>
                        <option value="Charisma" data-i18n="charisma-option">Charisma</option>
                      </select>
                      <input style="text-align: center !important" type="number" value="0" name="attr_talent-attackbonus" readonly />
                    </div>

                    <div class="sheet-talent-card-line0">
                      <h4 data-i18n="usage-label">Usage:</h4>
                      <input type="text" placeholder="Usage" data-i18n-placeholder="usage-placeholder" name="attr_talent-usetime" />
                      <h4 data-i18n="duration-label">Duration:</h4>
                      <input type="text" placeholder="Duration" data-i18n-placeholder="duration-placeholder" name="attr_talent-duration" />
                      <h4 data-i18n="range-label">Range:</h4>
                      <input type="text" placeholder="Range" data-i18n-placeholder="range-placeholder" name="attr_talent-range" />
                      <h4 data-i18n="target-label">Target:</h4>
                      <input type="text" placeholder="Target" data-i18n-placeholder="target-placeholder" name="attr_talent-target" />
                      <h4 data-i18n="charges-label">Charges:</h4>
                      <input type="text" placeholder="-" name="attr_talent-charges" />
                      <input class="sheet-hidden" type="number" value="0" name="attr_talent-details" />
                    </div>

                    <div class="sheet-talent-card-line2">
                      <h4 data-i18n="dmg-1-label">DMG 1:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg1" />
                      <h4 data-i18n="type-label-2">Type:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg1-type" />
                      <h4 data-i18n="dmg-2-label">DMG 2:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg2" />
                      <h4 data-i18n="type-label-2">Type:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg2-type" />
                    </div>

                    <div class="sheet-talent-card-line3">
                      <h4 data-i18n="save-ability-label">Save Ability:</h4>
                      <select name="attr_talent-save-ability">
                        <option selected value="0">-</option>
                        <option value="Strength" data-i18n="strength-option">Strength</option>
                        <option value="Dexterity" data-i18n="dexterity-option">Dexterity</option>
                        <option value="Constitution" data-i18n="constitution-option">Constitution</option>
                        <option value="Intelligence" data-i18n="intelligence-option">Intelligence</option>
                        <option value="Wisdom" data-i18n="wisdom-option">Wisdom</option>
                        <option value="Charisma" data-i18n="charisma-option">Charisma</option>
                        <option value="Custom" data-i18n="custom-option">Custom</option>
                      </select>
                      <input style="text-align: center !important" type="number" value="0" name="attr_talent-save" />
                    </div>

                    <div class="sheet-talent-card-line0">
                      <h4 data-i18n="save-effect-label">Save Effect:</h4>
                      <textarea placeholder="e.g. 1/2 of normal damages" data-i18n-placeholder="eg-1-2-of-normal-damages-placeholder" name="attr_talent-saveeffects"></textarea>
                    </div>

                    <div class="sheet-talent-card-line0">
                      <h4 data-i18n="description-label">Description:</h4>
                      <textarea placeholder="Description" data-i18n-placeholder="description-placeholder" name="attr_talent-description"></textarea>
                    </div>
                  </div>

                  <div class="sheet-talent-card sheet-cogs-hideshow-div2">
                    <div class="sheet-talent-card2">
                      <input class="sheet-checkbox-active" type="checkbox" value="1" name="attr_talent-active" />

                      <div class="sheet-talent-card-line4 sheet-button-div-holder">
                        <button type="roll" class="sheet-button-description" name="roll_talent" value="@{global-privacy-status} &{template:levelup} {{details=[[@{talent-details}]]}} {{name=@{talent-name}}} {{charactername=@{character_name}}} {{category=Lvl 4}} {{@{global-advantage-status}=1}} {{roll=[[1d20+@{talent-attackbonus}]]}} {{roll1=[[1d20+@{talent-attackbonus}]]}} {{roll2=[[1d20+@{talent-attackbonus}]]}} {{usage=@{talent-usetime}}} {{duration=@{talent-duration}}} {{range=@{talent-range}}} {{target=@{talent-target}}} {{charge=@{talent-charges}}} {{dmg1=[[@{talent-dmg1}]]}} {{dmg2=[[@{talent-dmg2}]]}} {{dmg1type=@{talent-dmg1-type}}} {{dmg2type=@{talent-dmg2-type}}} {{save=[[@{talent-save}]]}} {{savecomp=@{talent-save-ability}}} {{saveeffect=@{talent-saveeffects}}} {{button=@{talent-button}}} {{desc=@{talent-description}}}"></button>
                        <input style="grid-column: 1/-1" class="sheet-hidden" type="text" value="" name="attr_talent-button" />
                        <button type="roll" class="sheet-hidden" name="roll_show-description" value="@{global-privacy-status} &{template:levelup-description} {{name=Description}} {{description=@{talent-description}}}"></button>

                        <span class="sheet-talent-name" style="text-align: left !important" name="attr_talent-name"></span>

                        <input class="sheet-hidden sheet-concentration" type="checkbox" value="1" name="attr_talent-concentration" />
                        <span class="sheet-isconcentration" style="text-align: left !important" name="attr_talent-concentration-display">C</span>

                        <input class="sheet-hidden sheet-ritual" type="checkbox" value="1" name="attr_talent-ritual" />
                        <span class="sheet-isritual" style="text-align: left !important" name="attr_talent-ritual-display">R</span>
                      </div>

                      <div class="sheet-cogs-container sheet-button-div-holder">
                        <input class="sheet-cogs-input sheet-description-hideshow" type="checkbox" name="attr_sheet-description-hideshow" />
                        <span class="sheet-cogs-icon">w</span>
                      </div>

                      <div class="sheet-cogs-container">
                        <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                        <span class="sheet-cogs-icon">y</span>
                      </div>

                      <input class="sheet-hidden sheet-description-hideshow" type="checkbox" name="attr_sheet-description-hideshow" />
                      <span class="sheet-talent-source" type="text" name="attr_talent-source"></span>
                      <textarea class="sheet-description-hideshow-div" style="grid-column: 1/-1" type="text" value="-" name="attr_talent-description" readonly></textarea>
                    </div>
                  </div>
                </fieldset>
              </div>
            </div>
          </div>

          <!-- ----- SPELLS LEVEL 5 -----  -->
          <div class="sheet-talent-level5-talents sheet-talent-section">
            <div class="sheet-standardbox sheet-standardbox2">
              <h4 class="sheet-minititles2" data-i18n="level-5-spells-label">LEVEL 5 SPELLS</h4>
              <div class="sheet-oneline">
                <div class="sheet-warlockdisplay-no sheet-spellpresentation">
                  <input type="number" value="0" name="attr_spell5-know" />
                  <input type="number" value="0" name="attr_spell5-slots" />
                  <input type="number" value="0" name="attr_spell5-expended" />
                  <h4 data-i18n="7-label">7</h4>
                  <h4 data-i18n="know-label">Know</h4>
                  <h4 data-i18n="slots-label">Slots</h4>
                  <h4 data-i18n="expended-label">Expended</h4>
                  <h4 data-i18n="sp-label">SP</h4>
                </div>

                <div class="sheet-warlockdisplay-yes sheet-hidden sheet-spellpresentation">
                  <h4 data-i18n="nbsp-label">&nbsp;</h4>
                  <h4 data-i18n="nbsp-label">&nbsp;</h4>
                  <h4 data-i18n="sp-label">SP</h4>
                  <h4 data-i18n="7-label">7</h4>
                </div>

                <fieldset class="repeating_level5">
                  <input class="sheet-hidden sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                  <div class="sheet-talent-card sheet-cogs-hideshow-div1">
                    <div class="sheet-talent-card-line5">
                      <h4 data-i18n="name-label-2">Name:</h4>
                      <input type="text" placeholder="Name" data-i18n-placeholder="name-placeholder" name="attr_talent-name" />
                      <div class="sheet-cogs-container">
                        <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                        <span class="sheet-cogs-icon">y</span>
                      </div>
                    </div>

                    <div class="sheet-talent-card-line6">
                      <h4 data-i18n="source-label">Source:</h4>
                      <input type="text" placeholder="Source" data-i18n-placeholder="source-placeholder" name="attr_talent-source" />
                      <input class="sheet-concentration" type="checkbox" value="1" name="attr_talent-concentration" />
                      <input class="sheet-ritual" type="checkbox" value="1" name="attr_talent-ritual" />
                    </div>

                    <div class="sheet-talent-card-line3">
                      <h4 data-i18n="ability-label">Ability:</h4>
                      <select name="attr_talent_ability">
                        <option selected value="0">-</option>
                        <option value="Strength" data-i18n="strength-option">Strength</option>
                        <option value="Dexterity" data-i18n="dexterity-option">Dexterity</option>
                        <option value="Constitution" data-i18n="constitution-option">Constitution</option>
                        <option value="Intelligence" data-i18n="intelligence-option">Intelligence</option>
                        <option value="Wisdom" data-i18n="wisdom-option">Wisdom</option>
                        <option value="Charisma" data-i18n="charisma-option">Charisma</option>
                      </select>
                      <input style="text-align: center !important" type="number" value="0" name="attr_talent-attackbonus" readonly />
                    </div>

                    <div class="sheet-talent-card-line0">
                      <h4 data-i18n="usage-label">Usage:</h4>
                      <input type="text" placeholder="Usage" data-i18n-placeholder="usage-placeholder" name="attr_talent-usetime" />
                      <h4 data-i18n="duration-label">Duration:</h4>
                      <input type="text" placeholder="Duration" data-i18n-placeholder="duration-placeholder" name="attr_talent-duration" />
                      <h4 data-i18n="range-label">Range:</h4>
                      <input type="text" placeholder="Range" data-i18n-placeholder="range-placeholder" name="attr_talent-range" />
                      <h4 data-i18n="target-label">Target:</h4>
                      <input type="text" placeholder="Target" data-i18n-placeholder="target-placeholder" name="attr_talent-target" />
                      <h4 data-i18n="charges-label">Charges:</h4>
                      <input type="text" placeholder="-" name="attr_talent-charges" />
                      <input class="sheet-hidden" type="number" value="0" name="attr_talent-details" />
                    </div>

                    <div class="sheet-talent-card-line2">
                      <h4 data-i18n="dmg-1-label">DMG 1:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg1" />
                      <h4 data-i18n="type-label-2">Type:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg1-type" />
                      <h4 data-i18n="dmg-2-label">DMG 2:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg2" />
                      <h4 data-i18n="type-label-2">Type:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg2-type" />
                    </div>

                    <div class="sheet-talent-card-line3">
                      <h4 data-i18n="save-ability-label">Save Ability:</h4>
                      <select name="attr_talent-save-ability">
                        <option selected value="0">-</option>
                        <option value="Strength" data-i18n="strength-option">Strength</option>
                        <option value="Dexterity" data-i18n="dexterity-option">Dexterity</option>
                        <option value="Constitution" data-i18n="constitution-option">Constitution</option>
                        <option value="Intelligence" data-i18n="intelligence-option">Intelligence</option>
                        <option value="Wisdom" data-i18n="wisdom-option">Wisdom</option>
                        <option value="Charisma" data-i18n="charisma-option">Charisma</option>
                        <option value="Custom" data-i18n="custom-option">Custom</option>
                      </select>
                      <input style="text-align: center !important" type="number" value="0" name="attr_talent-save" />
                    </div>

                    <div class="sheet-talent-card-line0">
                      <h4 data-i18n="save-effect-label">Save Effect:</h4>
                      <textarea placeholder="e.g. 1/2 of normal damages" data-i18n-placeholder="eg-1-2-of-normal-damages-placeholder" name="attr_talent-saveeffects"></textarea>
                    </div>

                    <div class="sheet-talent-card-line0">
                      <h4 data-i18n="description-label">Description:</h4>
                      <textarea placeholder="Description" data-i18n-placeholder="description-placeholder" name="attr_talent-description"></textarea>
                    </div>
                  </div>

                  <div class="sheet-talent-card sheet-cogs-hideshow-div2">
                    <div class="sheet-talent-card2">
                      <input class="sheet-checkbox-active" type="checkbox" value="1" name="attr_talent-active" />

                      <div class="sheet-talent-card-line4 sheet-button-div-holder">
                        <button type="roll" class="sheet-button-description" name="roll_talent" value="@{global-privacy-status} &{template:levelup} {{details=[[@{talent-details}]]}} {{name=@{talent-name}}} {{charactername=@{character_name}}} {{category=Lvl 5}} {{@{global-advantage-status}=1}} {{roll=[[1d20+@{talent-attackbonus}]]}} {{roll1=[[1d20+@{talent-attackbonus}]]}} {{roll2=[[1d20+@{talent-attackbonus}]]}} {{usage=@{talent-usetime}}} {{duration=@{talent-duration}}} {{range=@{talent-range}}} {{target=@{talent-target}}} {{charge=@{talent-charges}}} {{dmg1=[[@{talent-dmg1}]]}} {{dmg2=[[@{talent-dmg2}]]}} {{dmg1type=@{talent-dmg1-type}}} {{dmg2type=@{talent-dmg2-type}}} {{save=[[@{talent-save}]]}} {{savecomp=@{talent-save-ability}}} {{saveeffect=@{talent-saveeffects}}} {{button=@{talent-button}}} {{desc=@{talent-description}}}"></button>
                        <input style="grid-column: 1/-1" class="sheet-hidden" type="text" value="" name="attr_talent-button" />
                        <button type="roll" class="sheet-hidden" name="roll_show-description" value="@{global-privacy-status} &{template:levelup-description} {{name=Description}} {{description=@{talent-description}}}"></button>

                        <span class="sheet-talent-name" style="text-align: left !important" name="attr_talent-name"></span>

                        <input class="sheet-hidden sheet-concentration" type="checkbox" value="1" name="attr_talent-concentration" />
                        <span class="sheet-isconcentration" style="text-align: left !important" name="attr_talent-concentration-display">C</span>

                        <input class="sheet-hidden sheet-ritual" type="checkbox" value="1" name="attr_talent-ritual" />
                        <span class="sheet-isritual" style="text-align: left !important" name="attr_talent-ritual-display">R</span>
                      </div>

                      <div class="sheet-cogs-container sheet-button-div-holder">
                        <input class="sheet-cogs-input sheet-description-hideshow" type="checkbox" name="attr_sheet-description-hideshow" />
                        <span class="sheet-cogs-icon">w</span>
                      </div>

                      <div class="sheet-cogs-container">
                        <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                        <span class="sheet-cogs-icon">y</span>
                      </div>

                      <input class="sheet-hidden sheet-description-hideshow" type="checkbox" name="attr_sheet-description-hideshow" />
                      <span class="sheet-talent-source" type="text" name="attr_talent-source"></span>
                      <textarea class="sheet-description-hideshow-div" style="grid-column: 1/-1" type="text" value="-" name="attr_talent-description" readonly></textarea>
                    </div>
                  </div>
                </fieldset>
              </div>
            </div>
          </div>
        </div>

        <div class="sheet-talent-rightcolumn">
          <!-- ----- SPELLS LEVEL 6 -----  -->
          <div class="sheet-talent-level6-talents sheet-talent-section">
            <div class="sheet-standardbox sheet-standardbox2">
              <h4 class="sheet-minititles2" data-i18n="level-6-spells-label">LEVEL 6 SPELLS</h4>
              <div class="sheet-oneline">
                <div class="sheet-warlockdisplay-no sheet-spellpresentation">
                  <input type="number" value="0" name="attr_spell6-know" />
                  <input type="number" value="0" name="attr_spell6-slots" />
                  <input type="number" value="0" name="attr_spell6-expended" />
                  <h4 data-i18n="nbsp-label">&nbsp;</h4>
                  <h4 data-i18n="know-label">Know</h4>
                  <h4 data-i18n="slots-label">Slots</h4>
                  <h4 data-i18n="expended-label">Expended</h4>
                  <h4 data-i18n="nbsp-label">&nbsp;</h4>
                </div>

                <div class="sheet-warlockdisplay-yes sheet-hidden sheet-spellpresentation"></div>

                <fieldset class="repeating_level6">
                  <input class="sheet-hidden sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                  <div class="sheet-talent-card sheet-cogs-hideshow-div1">
                    <div class="sheet-talent-card-line5">
                      <h4 data-i18n="name-label-2">Name:</h4>
                      <input type="text" placeholder="Name" data-i18n-placeholder="name-placeholder" name="attr_talent-name" />
                      <div class="sheet-cogs-container">
                        <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                        <span class="sheet-cogs-icon">y</span>
                      </div>
                    </div>

                    <div class="sheet-talent-card-line6">
                      <h4 data-i18n="source-label">Source:</h4>
                      <input type="text" placeholder="Source" data-i18n-placeholder="source-placeholder" name="attr_talent-source" />
                      <input class="sheet-concentration" type="checkbox" value="1" name="attr_talent-concentration" />
                      <input class="sheet-ritual" type="checkbox" value="1" name="attr_talent-ritual" />
                    </div>

                    <div class="sheet-talent-card-line3">
                      <h4 data-i18n="ability-label">Ability:</h4>
                      <select name="attr_talent_ability">
                        <option selected value="0">-</option>
                        <option value="Strength" data-i18n="strength-option">Strength</option>
                        <option value="Dexterity" data-i18n="dexterity-option">Dexterity</option>
                        <option value="Constitution" data-i18n="constitution-option">Constitution</option>
                        <option value="Intelligence" data-i18n="intelligence-option">Intelligence</option>
                        <option value="Wisdom" data-i18n="wisdom-option">Wisdom</option>
                        <option value="Charisma" data-i18n="charisma-option">Charisma</option>
                      </select>
                      <input style="text-align: center !important" type="number" value="0" name="attr_talent-attackbonus" readonly />
                    </div>

                    <div class="sheet-talent-card-line0">
                      <h4 data-i18n="usage-label">Usage:</h4>
                      <input type="text" placeholder="Usage" data-i18n-placeholder="usage-placeholder" name="attr_talent-usetime" />
                      <h4 data-i18n="duration-label">Duration:</h4>
                      <input type="text" placeholder="Duration" data-i18n-placeholder="duration-placeholder" name="attr_talent-duration" />
                      <h4 data-i18n="range-label">Range:</h4>
                      <input type="text" placeholder="Range" data-i18n-placeholder="range-placeholder" name="attr_talent-range" />
                      <h4 data-i18n="target-label">Target:</h4>
                      <input type="text" placeholder="Target" data-i18n-placeholder="target-placeholder" name="attr_talent-target" />
                      <h4 data-i18n="charges-label">Charges:</h4>
                      <input type="text" placeholder="-" name="attr_talent-charges" />
                      <input class="sheet-hidden" type="number" value="0" name="attr_talent-details" />
                    </div>

                    <div class="sheet-talent-card-line2">
                      <h4 data-i18n="dmg-1-label">DMG 1:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg1" />
                      <h4 data-i18n="type-label-2">Type:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg1-type" />
                      <h4 data-i18n="dmg-2-label">DMG 2:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg2" />
                      <h4 data-i18n="type-label-2">Type:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg2-type" />
                    </div>

                    <div class="sheet-talent-card-line3">
                      <h4 data-i18n="save-ability-label">Save Ability:</h4>
                      <select name="attr_talent-save-ability">
                        <option selected value="0">-</option>
                        <option value="Strength" data-i18n="strength-option">Strength</option>
                        <option value="Dexterity" data-i18n="dexterity-option">Dexterity</option>
                        <option value="Constitution" data-i18n="constitution-option">Constitution</option>
                        <option value="Intelligence" data-i18n="intelligence-option">Intelligence</option>
                        <option value="Wisdom" data-i18n="wisdom-option">Wisdom</option>
                        <option value="Charisma" data-i18n="charisma-option">Charisma</option>
                        <option value="Custom" data-i18n="custom-option">Custom</option>
                      </select>
                      <input style="text-align: center !important" type="number" value="0" name="attr_talent-save" />
                    </div>

                    <div class="sheet-talent-card-line0">
                      <h4 data-i18n="save-effect-label">Save Effect:</h4>
                      <textarea placeholder="e.g. 1/2 of normal damages" data-i18n-placeholder="eg-1-2-of-normal-damages-placeholder" name="attr_talent-saveeffects"></textarea>
                    </div>

                    <div class="sheet-talent-card-line0">
                      <h4 data-i18n="description-label">Description:</h4>
                      <textarea placeholder="Description" data-i18n-placeholder="description-placeholder" name="attr_talent-description"></textarea>
                    </div>
                  </div>

                  <div class="sheet-talent-card sheet-cogs-hideshow-div2">
                    <div class="sheet-talent-card2">
                      <input class="sheet-checkbox-active" type="checkbox" value="1" name="attr_talent-active" />

                      <div class="sheet-talent-card-line4 sheet-button-div-holder">
                        <button type="roll" class="sheet-button-description" name="roll_talent" value="@{global-privacy-status} &{template:levelup} {{details=[[@{talent-details}]]}} {{name=@{talent-name}}} {{charactername=@{character_name}}} {{category=Lvl 6}} {{@{global-advantage-status}=1}} {{roll=[[1d20+@{talent-attackbonus}]]}} {{roll1=[[1d20+@{talent-attackbonus}]]}} {{roll2=[[1d20+@{talent-attackbonus}]]}} {{usage=@{talent-usetime}}} {{duration=@{talent-duration}}} {{range=@{talent-range}}} {{target=@{talent-target}}} {{charge=@{talent-charges}}} {{dmg1=[[@{talent-dmg1}]]}} {{dmg2=[[@{talent-dmg2}]]}} {{dmg1type=@{talent-dmg1-type}}} {{dmg2type=@{talent-dmg2-type}}} {{save=[[@{talent-save}]]}} {{savecomp=@{talent-save-ability}}} {{saveeffect=@{talent-saveeffects}}} {{button=@{talent-button}}} {{desc=@{talent-description}}}"></button>
                        <input style="grid-column: 1/-1" class="sheet-hidden" type="text" value="" name="attr_talent-button" />
                        <button type="roll" class="sheet-hidden" name="roll_show-description" value="@{global-privacy-status} &{template:levelup-description} {{name=Description}} {{description=@{talent-description}}}"></button>

                        <span class="sheet-talent-name" style="text-align: left !important" name="attr_talent-name"></span>

                        <input class="sheet-hidden sheet-concentration" type="checkbox" value="1" name="attr_talent-concentration" />
                        <span class="sheet-isconcentration" style="text-align: left !important" name="attr_talent-concentration-display">C</span>

                        <input class="sheet-hidden sheet-ritual" type="checkbox" value="1" name="attr_talent-ritual" />
                        <span class="sheet-isritual" style="text-align: left !important" name="attr_talent-ritual-display">R</span>
                      </div>

                      <div class="sheet-cogs-container sheet-button-div-holder">
                        <input class="sheet-cogs-input sheet-description-hideshow" type="checkbox" name="attr_sheet-description-hideshow" />
                        <span class="sheet-cogs-icon">w</span>
                      </div>

                      <div class="sheet-cogs-container">
                        <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                        <span class="sheet-cogs-icon">y</span>
                      </div>

                      <input class="sheet-hidden sheet-description-hideshow" type="checkbox" name="attr_sheet-description-hideshow" />
                      <span class="sheet-talent-source" type="text" name="attr_talent-source"></span>
                      <textarea class="sheet-description-hideshow-div" style="grid-column: 1/-1" type="text" value="-" name="attr_talent-description" readonly></textarea>
                    </div>
                  </div>
                </fieldset>
              </div>
            </div>
          </div>

          <!-- ----- SPELLS LEVEL 7 -----  -->
          <div class="sheet-talent-level7-talents sheet-talent-section">
            <div class="sheet-standardbox sheet-standardbox2">
              <h4 class="sheet-minititles2" data-i18n="level-7-spells-label">LEVEL 7 SPELLS</h4>
              <div class="sheet-oneline">
                <div class="sheet-warlockdisplay-no sheet-spellpresentation">
                  <input type="number" value="0" name="attr_spell7-know" />
                  <input type="number" value="0" name="attr_spell7-slots" />
                  <input type="number" value="0" name="attr_spell7-expended" />
                  <h4 data-i18n="nbsp-label">&nbsp;</h4>
                  <h4 data-i18n="know-label">Know</h4>
                  <h4 data-i18n="slots-label">Slots</h4>
                  <h4 data-i18n="expended-label">Expended</h4>
                  <h4 data-i18n="nbsp-label">&nbsp;</h4>
                </div>

                <div class="sheet-warlockdisplay-yes sheet-hidden sheet-spellpresentation"></div>

                <fieldset class="repeating_level7">
                  <input class="sheet-hidden sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                  <div class="sheet-talent-card sheet-cogs-hideshow-div1">
                    <div class="sheet-talent-card-line5">
                      <h4 data-i18n="name-label-2">Name:</h4>
                      <input type="text" placeholder="Name" data-i18n-placeholder="name-placeholder" name="attr_talent-name" />
                      <div class="sheet-cogs-container">
                        <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                        <span class="sheet-cogs-icon">y</span>
                      </div>
                    </div>

                    <div class="sheet-talent-card-line6">
                      <h4 data-i18n="source-label">Source:</h4>
                      <input type="text" placeholder="Source" data-i18n-placeholder="source-placeholder" name="attr_talent-source" />
                      <input class="sheet-concentration" type="checkbox" value="1" name="attr_talent-concentration" />
                      <input class="sheet-ritual" type="checkbox" value="1" name="attr_talent-ritual" />
                    </div>

                    <div class="sheet-talent-card-line3">
                      <h4 data-i18n="ability-label">Ability:</h4>
                      <select name="attr_talent_ability">
                        <option selected value="0">-</option>
                        <option value="Strength" data-i18n="strength-option">Strength</option>
                        <option value="Dexterity" data-i18n="dexterity-option">Dexterity</option>
                        <option value="Constitution" data-i18n="constitution-option">Constitution</option>
                        <option value="Intelligence" data-i18n="intelligence-option">Intelligence</option>
                        <option value="Wisdom" data-i18n="wisdom-option">Wisdom</option>
                        <option value="Charisma" data-i18n="charisma-option">Charisma</option>
                      </select>
                      <input style="text-align: center !important" type="number" value="0" name="attr_talent-attackbonus" readonly />
                    </div>

                    <div class="sheet-talent-card-line0">
                      <h4 data-i18n="usage-label">Usage:</h4>
                      <input type="text" placeholder="Usage" data-i18n-placeholder="usage-placeholder" name="attr_talent-usetime" />
                      <h4 data-i18n="duration-label">Duration:</h4>
                      <input type="text" placeholder="Duration" data-i18n-placeholder="duration-placeholder" name="attr_talent-duration" />
                      <h4 data-i18n="range-label">Range:</h4>
                      <input type="text" placeholder="Range" data-i18n-placeholder="range-placeholder" name="attr_talent-range" />
                      <h4 data-i18n="target-label">Target:</h4>
                      <input type="text" placeholder="Target" data-i18n-placeholder="target-placeholder" name="attr_talent-target" />
                      <h4 data-i18n="charges-label">Charges:</h4>
                      <input type="text" placeholder="-" name="attr_talent-charges" />
                      <input class="sheet-hidden" type="number" value="0" name="attr_talent-details" />
                    </div>

                    <div class="sheet-talent-card-line2">
                      <h4 data-i18n="dmg-1-label">DMG 1:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg1" />
                      <h4 data-i18n="type-label-2">Type:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg1-type" />
                      <h4 data-i18n="dmg-2-label">DMG 2:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg2" />
                      <h4 data-i18n="type-label-2">Type:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg2-type" />
                    </div>

                    <div class="sheet-talent-card-line3">
                      <h4 data-i18n="save-ability-label">Save Ability:</h4>
                      <select name="attr_talent-save-ability">
                        <option selected value="0">-</option>
                        <option value="Strength" data-i18n="strength-option">Strength</option>
                        <option value="Dexterity" data-i18n="dexterity-option">Dexterity</option>
                        <option value="Constitution" data-i18n="constitution-option">Constitution</option>
                        <option value="Intelligence" data-i18n="intelligence-option">Intelligence</option>
                        <option value="Wisdom" data-i18n="wisdom-option">Wisdom</option>
                        <option value="Charisma" data-i18n="charisma-option">Charisma</option>
                        <option value="Custom" data-i18n="custom-option">Custom</option>
                      </select>
                      <input style="text-align: center !important" type="number" value="0" name="attr_talent-save" />
                    </div>

                    <div class="sheet-talent-card-line0">
                      <h4 data-i18n="save-effect-label">Save Effect:</h4>
                      <textarea placeholder="e.g. 1/2 of normal damages" data-i18n-placeholder="eg-1-2-of-normal-damages-placeholder" name="attr_talent-saveeffects"></textarea>
                    </div>

                    <div class="sheet-talent-card-line0">
                      <h4 data-i18n="description-label">Description:</h4>
                      <textarea placeholder="Description" data-i18n-placeholder="description-placeholder" name="attr_talent-description"></textarea>
                    </div>
                  </div>

                  <div class="sheet-talent-card sheet-cogs-hideshow-div2">
                    <div class="sheet-talent-card2">
                      <input class="sheet-checkbox-active" type="checkbox" value="1" name="attr_talent-active" />

                      <div class="sheet-talent-card-line4 sheet-button-div-holder">
                        <button type="roll" class="sheet-button-description" name="roll_talent" value="@{global-privacy-status} &{template:levelup} {{details=[[@{talent-details}]]}} {{name=@{talent-name}}} {{charactername=@{character_name}}} {{category=Lvl 7}} {{@{global-advantage-status}=1}} {{roll=[[1d20+@{talent-attackbonus}]]}} {{roll1=[[1d20+@{talent-attackbonus}]]}} {{roll2=[[1d20+@{talent-attackbonus}]]}} {{usage=@{talent-usetime}}} {{duration=@{talent-duration}}} {{range=@{talent-range}}} {{target=@{talent-target}}} {{charge=@{talent-charges}}} {{dmg1=[[@{talent-dmg1}]]}} {{dmg2=[[@{talent-dmg2}]]}} {{dmg1type=@{talent-dmg1-type}}} {{dmg2type=@{talent-dmg2-type}}} {{save=[[@{talent-save}]]}} {{savecomp=@{talent-save-ability}}} {{saveeffect=@{talent-saveeffects}}} {{button=@{talent-button}}} {{desc=@{talent-description}}}"></button>
                        <input style="grid-column: 1/-1" class="sheet-hidden" type="text" value="" name="attr_talent-button" />
                        <button type="roll" class="sheet-hidden" name="roll_show-description" value="@{global-privacy-status} &{template:levelup-description} {{name=Description}} {{description=@{talent-description}}}"></button>

                        <span class="sheet-talent-name" style="text-align: left !important" name="attr_talent-name"></span>

                        <input class="sheet-hidden sheet-concentration" type="checkbox" value="1" name="attr_talent-concentration" />
                        <span class="sheet-isconcentration" style="text-align: left !important" name="attr_talent-concentration-display">C</span>

                        <input class="sheet-hidden sheet-ritual" type="checkbox" value="1" name="attr_talent-ritual" />
                        <span class="sheet-isritual" style="text-align: left !important" name="attr_talent-ritual-display">R</span>
                      </div>

                      <div class="sheet-cogs-container sheet-button-div-holder">
                        <input class="sheet-cogs-input sheet-description-hideshow" type="checkbox" name="attr_sheet-description-hideshow" />
                        <span class="sheet-cogs-icon">w</span>
                      </div>

                      <div class="sheet-cogs-container">
                        <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                        <span class="sheet-cogs-icon">y</span>
                      </div>

                      <input class="sheet-hidden sheet-description-hideshow" type="checkbox" name="attr_sheet-description-hideshow" />
                      <span class="sheet-talent-source" type="text" name="attr_talent-source"></span>
                      <textarea class="sheet-description-hideshow-div" style="grid-column: 1/-1" type="text" value="-" name="attr_talent-description" readonly></textarea>
                    </div>
                  </div>
                </fieldset>
              </div>
            </div>
          </div>

          <!-- ----- SPELLS LEVEL 8 -----  -->
          <div class="sheet-talent-level8-talents sheet-talent-section">
            <div class="sheet-standardbox sheet-standardbox2">
              <h4 class="sheet-minititles2" data-i18n="level-8-spells-label">LEVEL 8 SPELLS</h4>
              <div class="sheet-oneline">
                <div class="sheet-warlockdisplay-no sheet-spellpresentation">
                  <input type="number" value="0" name="attr_spell8-know" />
                  <input type="number" value="0" name="attr_spell8-slots" />
                  <input type="number" value="0" name="attr_spell8-expended" />
                  <h4 data-i18n="nbsp-label">&nbsp;</h4>
                  <h4 data-i18n="know-label">Know</h4>
                  <h4 data-i18n="slots-label">Slots</h4>
                  <h4 data-i18n="expended-label">Expended</h4>
                  <h4 data-i18n="nbsp-label">&nbsp;</h4>
                </div>

                <div class="sheet-warlockdisplay-yes sheet-hidden sheet-spellpresentation"></div>

                <fieldset class="repeating_level8">
                  <input class="sheet-hidden sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                  <div class="sheet-talent-card sheet-cogs-hideshow-div1">
                    <div class="sheet-talent-card-line5">
                      <h4 data-i18n="name-label-2">Name:</h4>
                      <input type="text" placeholder="Name" data-i18n-placeholder="name-placeholder" name="attr_talent-name" />
                      <div class="sheet-cogs-container">
                        <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                        <span class="sheet-cogs-icon">y</span>
                      </div>
                    </div>

                    <div class="sheet-talent-card-line6">
                      <h4 data-i18n="source-label">Source:</h4>
                      <input type="text" placeholder="Source" data-i18n-placeholder="source-placeholder" name="attr_talent-source" />
                      <input class="sheet-concentration" type="checkbox" value="1" name="attr_talent-concentration" />
                      <input class="sheet-ritual" type="checkbox" value="1" name="attr_talent-ritual" />
                    </div>

                    <div class="sheet-talent-card-line3">
                      <h4 data-i18n="ability-label">Ability:</h4>
                      <select name="attr_talent_ability">
                        <option selected value="0">-</option>
                        <option value="Strength" data-i18n="strength-option">Strength</option>
                        <option value="Dexterity" data-i18n="dexterity-option">Dexterity</option>
                        <option value="Constitution" data-i18n="constitution-option">Constitution</option>
                        <option value="Intelligence" data-i18n="intelligence-option">Intelligence</option>
                        <option value="Wisdom" data-i18n="wisdom-option">Wisdom</option>
                        <option value="Charisma" data-i18n="charisma-option">Charisma</option>
                      </select>
                      <input style="text-align: center !important" type="number" value="0" name="attr_talent-attackbonus" readonly />
                    </div>

                    <div class="sheet-talent-card-line0">
                      <h4 data-i18n="usage-label">Usage:</h4>
                      <input type="text" placeholder="Usage" data-i18n-placeholder="usage-placeholder" name="attr_talent-usetime" />
                      <h4 data-i18n="duration-label">Duration:</h4>
                      <input type="text" placeholder="Duration" data-i18n-placeholder="duration-placeholder" name="attr_talent-duration" />
                      <h4 data-i18n="range-label">Range:</h4>
                      <input type="text" placeholder="Range" data-i18n-placeholder="range-placeholder" name="attr_talent-range" />
                      <h4 data-i18n="target-label">Target:</h4>
                      <input type="text" placeholder="Target" data-i18n-placeholder="target-placeholder" name="attr_talent-target" />
                      <h4 data-i18n="charges-label">Charges:</h4>
                      <input type="text" placeholder="-" name="attr_talent-charges" />
                      <input class="sheet-hidden" type="number" value="0" name="attr_talent-details" />
                    </div>

                    <div class="sheet-talent-card-line2">
                      <h4 data-i18n="dmg-1-label">DMG 1:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg1" />
                      <h4 data-i18n="type-label-2">Type:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg1-type" />
                      <h4 data-i18n="dmg-2-label">DMG 2:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg2" />
                      <h4 data-i18n="type-label-2">Type:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg2-type" />
                    </div>

                    <div class="sheet-talent-card-line3">
                      <h4 data-i18n="save-ability-label">Save Ability:</h4>
                      <select name="attr_talent-save-ability">
                        <option selected value="0">-</option>
                        <option value="Strength" data-i18n="strength-option">Strength</option>
                        <option value="Dexterity" data-i18n="dexterity-option">Dexterity</option>
                        <option value="Constitution" data-i18n="constitution-option">Constitution</option>
                        <option value="Intelligence" data-i18n="intelligence-option">Intelligence</option>
                        <option value="Wisdom" data-i18n="wisdom-option">Wisdom</option>
                        <option value="Charisma" data-i18n="charisma-option">Charisma</option>
                        <option value="Custom" data-i18n="custom-option">Custom</option>
                      </select>
                      <input style="text-align: center !important" type="number" value="0" name="attr_talent-save" />
                    </div>

                    <div class="sheet-talent-card-line0">
                      <h4 data-i18n="save-effect-label">Save Effect:</h4>
                      <textarea placeholder="e.g. 1/2 of normal damages" data-i18n-placeholder="eg-1-2-of-normal-damages-placeholder" name="attr_talent-saveeffects"></textarea>
                    </div>

                    <div class="sheet-talent-card-line0">
                      <h4 data-i18n="description-label">Description:</h4>
                      <textarea placeholder="Description" data-i18n-placeholder="description-placeholder" name="attr_talent-description"></textarea>
                    </div>
                  </div>

                  <div class="sheet-talent-card sheet-cogs-hideshow-div2">
                    <div class="sheet-talent-card2">
                      <input class="sheet-checkbox-active" type="checkbox" value="1" name="attr_talent-active" />

                      <div class="sheet-talent-card-line4 sheet-button-div-holder">
                        <button type="roll" class="sheet-button-description" name="roll_talent" value="@{global-privacy-status} &{template:levelup} {{details=[[@{talent-details}]]}} {{name=@{talent-name}}} {{charactername=@{character_name}}} {{category=Lvl 8}} {{@{global-advantage-status}=1}} {{roll=[[1d20+@{talent-attackbonus}]]}} {{roll1=[[1d20+@{talent-attackbonus}]]}} {{roll2=[[1d20+@{talent-attackbonus}]]}} {{usage=@{talent-usetime}}} {{duration=@{talent-duration}}} {{range=@{talent-range}}} {{target=@{talent-target}}} {{charge=@{talent-charges}}} {{dmg1=[[@{talent-dmg1}]]}} {{dmg2=[[@{talent-dmg2}]]}} {{dmg1type=@{talent-dmg1-type}}} {{dmg2type=@{talent-dmg2-type}}} {{save=[[@{talent-save}]]}} {{savecomp=@{talent-save-ability}}} {{saveeffect=@{talent-saveeffects}}} {{button=@{talent-button}}} {{desc=@{talent-description}}}"></button>
                        <input style="grid-column: 1/-1" class="sheet-hidden" type="text" value="" name="attr_talent-button" />
                        <button type="roll" class="sheet-hidden" name="roll_show-description" value="@{global-privacy-status} &{template:levelup-description} {{name=Description}} {{description=@{talent-description}}}"></button>

                        <span class="sheet-talent-name" style="text-align: left !important" name="attr_talent-name"></span>

                        <input class="sheet-hidden sheet-concentration" type="checkbox" value="1" name="attr_talent-concentration" />
                        <span class="sheet-isconcentration" style="text-align: left !important" name="attr_talent-concentration-display">C</span>

                        <input class="sheet-hidden sheet-ritual" type="checkbox" value="1" name="attr_talent-ritual" />
                        <span class="sheet-isritual" style="text-align: left !important" name="attr_talent-ritual-display">R</span>
                      </div>

                      <div class="sheet-cogs-container sheet-button-div-holder">
                        <input class="sheet-cogs-input sheet-description-hideshow" type="checkbox" name="attr_sheet-description-hideshow" />
                        <span class="sheet-cogs-icon">w</span>
                      </div>

                      <div class="sheet-cogs-container">
                        <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                        <span class="sheet-cogs-icon">y</span>
                      </div>

                      <input class="sheet-hidden sheet-description-hideshow" type="checkbox" name="attr_sheet-description-hideshow" />
                      <span class="sheet-talent-source" type="text" name="attr_talent-source"></span>
                      <textarea class="sheet-description-hideshow-div" style="grid-column: 1/-1" type="text" value="-" name="attr_talent-description" readonly></textarea>
                    </div>
                  </div>
                </fieldset>
              </div>
            </div>
          </div>

          <!-- ----- SPELLS LEVEL 9 -----  -->
          <div class="sheet-talent-level9-talents sheet-talent-section">
            <div class="sheet-standardbox sheet-standardbox2">
              <h4 class="sheet-minititles2" data-i18n="level-9-spells-label">LEVEL 9 SPELLS</h4>
              <div class="sheet-oneline">
                <div class="sheet-warlockdisplay-no sheet-spellpresentation">
                  <input type="number" value="0" name="attr_spell9-know" />
                  <input type="number" value="0" name="attr_spell9-slots" />
                  <input type="number" value="0" name="attr_spell9-expended" />
                  <h4 data-i18n="nbsp-label">&nbsp;</h4>
                  <h4 data-i18n="know-label">Know</h4>
                  <h4 data-i18n="slots-label">Slots</h4>
                  <h4 data-i18n="expended-label">Expended</h4>
                  <h4 data-i18n="nbsp-label">&nbsp;</h4>
                </div>

                <div class="sheet-warlockdisplay-yes sheet-hidden sheet-spellpresentation"></div>

                <fieldset class="repeating_level9">
                  <input class="sheet-hidden sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                  <div class="sheet-talent-card sheet-cogs-hideshow-div1">
                    <div class="sheet-talent-card-line5">
                      <h4 data-i18n="name-label-2">Name:</h4>
                      <input type="text" placeholder="Name" data-i18n-placeholder="name-placeholder" name="attr_talent-name" />
                      <div class="sheet-cogs-container">
                        <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                        <span class="sheet-cogs-icon">y</span>
                      </div>
                    </div>

                    <div class="sheet-talent-card-line6">
                      <h4 data-i18n="source-label">Source:</h4>
                      <input type="text" placeholder="Source" data-i18n-placeholder="source-placeholder" name="attr_talent-source" />
                      <input class="sheet-concentration" type="checkbox" value="1" name="attr_talent-concentration" />
                      <input class="sheet-ritual" type="checkbox" value="1" name="attr_talent-ritual" />
                    </div>

                    <div class="sheet-talent-card-line3">
                      <h4 data-i18n="ability-label">Ability:</h4>
                      <select name="attr_talent_ability">
                        <option selected value="0">-</option>
                        <option value="Strength" data-i18n="strength-option">Strength</option>
                        <option value="Dexterity" data-i18n="dexterity-option">Dexterity</option>
                        <option value="Constitution" data-i18n="constitution-option">Constitution</option>
                        <option value="Intelligence" data-i18n="intelligence-option">Intelligence</option>
                        <option value="Wisdom" data-i18n="wisdom-option">Wisdom</option>
                        <option value="Charisma" data-i18n="charisma-option">Charisma</option>
                      </select>
                      <input style="text-align: center !important" type="number" value="0" name="attr_talent-attackbonus" readonly />
                    </div>

                    <div class="sheet-talent-card-line0">
                      <h4 data-i18n="usage-label">Usage:</h4>
                      <input type="text" placeholder="Usage" data-i18n-placeholder="usage-placeholder" name="attr_talent-usetime" />
                      <h4 data-i18n="duration-label">Duration:</h4>
                      <input type="text" placeholder="Duration" data-i18n-placeholder="duration-placeholder" name="attr_talent-duration" />
                      <h4 data-i18n="range-label">Range:</h4>
                      <input type="text" placeholder="Range" data-i18n-placeholder="range-placeholder" name="attr_talent-range" />
                      <h4 data-i18n="target-label">Target:</h4>
                      <input type="text" placeholder="Target" data-i18n-placeholder="target-placeholder" name="attr_talent-target" />
                      <h4 data-i18n="charges-label">Charges:</h4>
                      <input type="text" placeholder="-" name="attr_talent-charges" />
                      <input class="sheet-hidden" type="number" value="0" name="attr_talent-details" />
                    </div>

                    <div class="sheet-talent-card-line2">
                      <h4 data-i18n="dmg-1-label">DMG 1:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg1" />
                      <h4 data-i18n="type-label-2">Type:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg1-type" />
                      <h4 data-i18n="dmg-2-label">DMG 2:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg2" />
                      <h4 data-i18n="type-label-2">Type:</h4>
                      <input type="text" placeholder="-" name="attr_talent-dmg2-type" />
                    </div>

                    <div class="sheet-talent-card-line3">
                      <h4 data-i18n="save-ability-label">Save Ability:</h4>
                      <select name="attr_talent-save-ability">
                        <option selected value="0">-</option>
                        <option value="Strength" data-i18n="strength-option">Strength</option>
                        <option value="Dexterity" data-i18n="dexterity-option">Dexterity</option>
                        <option value="Constitution" data-i18n="constitution-option">Constitution</option>
                        <option value="Intelligence" data-i18n="intelligence-option">Intelligence</option>
                        <option value="Wisdom" data-i18n="wisdom-option">Wisdom</option>
                        <option value="Charisma" data-i18n="charisma-option">Charisma</option>
                        <option value="Custom" data-i18n="custom-option">Custom</option>
                      </select>
                      <input style="text-align: center !important" type="number" value="0" name="attr_talent-save" />
                    </div>

                    <div class="sheet-talent-card-line0">
                      <h4 data-i18n="save-effect-label">Save Effect:</h4>
                      <textarea placeholder="e.g. 1/2 of normal damages" data-i18n-placeholder="eg-1-2-of-normal-damages-placeholder" name="attr_talent-saveeffects"></textarea>
                    </div>

                    <div class="sheet-talent-card-line0">
                      <h4 data-i18n="description-label">Description:</h4>
                      <textarea placeholder="Description" data-i18n-placeholder="description-placeholder" name="attr_talent-description"></textarea>
                    </div>
                  </div>

                  <div class="sheet-talent-card sheet-cogs-hideshow-div2">
                    <div class="sheet-talent-card2">
                      <input class="sheet-checkbox-active" type="checkbox" value="1" name="attr_talent-active" />

                      <div class="sheet-talent-card-line4 sheet-button-div-holder">
                        <button type="roll" class="sheet-button-description" name="roll_talent" value="@{global-privacy-status} &{template:levelup} {{details=[[@{talent-details}]]}} {{name=@{talent-name}}} {{charactername=@{character_name}}} {{category=Lvl 9}} {{@{global-advantage-status}=1}} {{roll=[[1d20+@{talent-attackbonus}]]}} {{roll1=[[1d20+@{talent-attackbonus}]]}} {{roll2=[[1d20+@{talent-attackbonus}]]}} {{usage=@{talent-usetime}}} {{duration=@{talent-duration}}} {{range=@{talent-range}}} {{target=@{talent-target}}} {{charge=@{talent-charges}}} {{dmg1=[[@{talent-dmg1}]]}} {{dmg2=[[@{talent-dmg2}]]}} {{dmg1type=@{talent-dmg1-type}}} {{dmg2type=@{talent-dmg2-type}}} {{save=[[@{talent-save}]]}} {{savecomp=@{talent-save-ability}}} {{saveeffect=@{talent-saveeffects}}} {{button=@{talent-button}}} {{desc=@{talent-description}}}"></button>
                        <input style="grid-column: 1/-1" class="sheet-hidden" type="text" value="" name="attr_talent-button" />
                        <button type="roll" class="sheet-hidden" name="roll_show-description" value="@{global-privacy-status} &{template:levelup-description} {{name=Description}} {{description=@{talent-description}}}"></button>

                        <span class="sheet-talent-name" style="text-align: left !important" name="attr_talent-name"></span>

                        <input class="sheet-hidden sheet-concentration" type="checkbox" value="1" name="attr_talent-concentration" />
                        <span class="sheet-isconcentration" style="text-align: left !important" name="attr_talent-concentration-display">C</span>

                        <input class="sheet-hidden sheet-ritual" type="checkbox" value="1" name="attr_talent-ritual" />
                        <span class="sheet-isritual" style="text-align: left !important" name="attr_talent-ritual-display">R</span>
                      </div>

                      <div class="sheet-cogs-container sheet-button-div-holder">
                        <input class="sheet-cogs-input sheet-description-hideshow" type="checkbox" name="attr_sheet-description-hideshow" />
                        <span class="sheet-cogs-icon">w</span>
                      </div>

                      <div class="sheet-cogs-container">
                        <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                        <span class="sheet-cogs-icon">y</span>
                      </div>

                      <input class="sheet-hidden sheet-description-hideshow" type="checkbox" name="attr_sheet-description-hideshow" />
                      <span class="sheet-talent-source" type="text" name="attr_talent-source"></span>
                      <textarea class="sheet-description-hideshow-div" style="grid-column: 1/-1" type="text" value="-" name="attr_talent-description" readonly></textarea>
                    </div>
                  </div>
                </fieldset>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script id="CLASS : WARLOCK DISPLAY SWITCH" type="text/worker">
    on("sheet:opened change:class1 change:class2 change:class3", () => {

      getAttrs(["class1","class2","class3"], v => {
        const classes = [v.class1, v.class2, v.class3].filter(c => c && c !== "-");

        const containsWarlock = classes.includes("Warlock");
        const onlyWarlock = classes.every(c => c === "Warlock");

        const show = $20(".sheet-warlockdisplay-yes");
        const hide = $20(".sheet-warlockdisplay-no");

        if (containsWarlock && onlyWarlock) {
          hide.addClass("sheet-hidden");
          show.removeClass("sheet-hidden");
        } else {
          show.addClass("sheet-hidden");
          hide.removeClass("sheet-hidden");
        }
      });
    });
  </script>

  <!-- ----- MANEUVERS -----  -->
  <div class="sheet-maneuvers-display sheet-hidden">
    <div class="sheet-maingrid-area-talents">
      <div class=".sheet-talent-headersection sheet-talent-headersection3">
        <!-- ----- TRADITIONS KNOW -----  -->
        <div class="sheet-maneuvers-savedc">
          <div class="sheet-standardbox sheet-standardbox2">
            <div class="sheet-oneline">
              <input class="sheet-inputchar" type="text" value="0" name="attr_maneuvers-class" />
            </div>
          </div>
          <h4 data-i18n="traditions-known-label">Traditions Known</h4>
        </div>

        <!-- ----- MANEUVEURS ABILITY -----  -->
        <div class="sheet-maneuvers-ability">
          <div class="sheet-standardbox sheet-standardbox2">
            <div class="sheet-oneline">
              <select class="sheet-inputchar" name="attr_maneuvers_ability">
                <option selected value="0">-</option>
                <option value="str">STR</option>
                <option value="dex">DEX</option>
              </select>
            </div>
          </div>
          <h4 data-i18n="maneuvers-ability-label">maneuvers Ability</h4>
        </div>

        <!-- ----- MANEUVERS SAVE DC -----  -->
        <div class="sheet-maneuvers-savedc">
          <div class="sheet-standardbox sheet-standardbox2">
            <div class="sheet-oneline">
              <input class="sheet-inputchar" type="number" step="1" value="0" name="attr_maneuvers-dc" readonly />
              <input class="sheet-inputchar3" type="number" step="1" value="0" name="attr_maneuvers-dc-mod" />
            </div>
          </div>
          <h4 data-i18n="maneuvers-save-dc-label">Maneuvers Save DC</h4>
        </div>

        <!-- ----- MANEUVERS DEGREE -----  -->
        <div class="sheet-maneuvers-attackbonus">
          <div class="sheet-standardbox sheet-standardbox2">
            <div class="sheet-oneline">
              <input class="sheet-inputchar" type="number" step="1" value="0" name="attr_maneuvers-known" />
            </div>
          </div>
          <h4 data-i18n="maneuvers-known-label">Maneuvers Known</h4>
        </div>

        <!-- ----- MANEUVERS DEGREE -----  -->
        <div class="sheet-maneuvers-attackbonus">
          <div class="sheet-standardbox sheet-standardbox2">
            <div class="sheet-oneline">
              <select class="sheet-inputchar" name="attr_selector-maneuvers-degree">
                <option value="" selected>-</option>
                <option value="1" data-i18n="1st-option">1ST</option>
                <option value="2" data-i18n="2nd-option">2ND</option>
                <option value="3" data-i18n="3rd-option">3RD</option>
                <option value="4" data-i18n="4th-option">4TH</option>
              </select>
            </div>
          </div>
          <h4 data-i18n="maneuvers-degree-label">Maneuvers Degree</h4>
        </div>

        <!-- ----- SPELL POINTS -----  -->
        <div class="sheet-talent-attackbonus">
          <div class="sheet-standardbox sheet-standardbox2">
            <div class="sheet-oneline">
              <input class="sheet-inputchar" type="number" step="1" value="0" name="attr_maneuvers-exertionpoints" readonly />
              <input class="sheet-inputchar3" type="number" step="1" value="0" name="attr_maneuvers-exertionpoints-mod" />
            </div>
          </div>

          <h4 data-i18n="exertion-points-label">Exertion Points</h4>
        </div>
      </div>

      <script id="MANEUVERS : FULL CALC" type="text/worker">
        const MANESTAT={
          str:"strength-bonus",
          dex:"dexterity-bonus"
        };

        const FIELDS=[
          "maneuvers_ability",
          "pb",
          "strength-bonus",
          "dexterity-bonus",
          "maneuvers-exertionpoints-mod",
          "maneuvers-dc-mod"
        ];

        on("sheet:opened "+FIELDS.map(f=>"change:"+f).join(" "),()=>{
          getAttrs(FIELDS,v=>{
            const key=v["maneuvers_ability"]||"0";
            const statAttr=MANESTAT[key];
            const statMod=statAttr?parseInt(v[statAttr]||0,10):0;

            const pb=parseInt(v.pb||0,10);
            const exMod=parseInt(v["maneuvers-exertionpoints-mod"]||0,10);
            const dcMod=parseInt(v["maneuvers-dc-mod"]||0,10);

            setAttrs({
              "maneuvers-dc":8+pb+statMod+dcMod,
              "maneuvers-exertionpoints":pb*2+exMod
            });
          });
        });
      </script>

      <div class="sheet-doublecolumn">
        <div class="sheet-mainleft">
          <!-- ----- BASICS MANEUVERS -----  -->
          <div class="sheet-main-maneuvers sheet-standardbox sheet-standardbox2">
            <h4 class="sheet-minititles2 sheet-main-titlestatistics" data-i18n="basics-maneuvers-label">Basics Maneuvers</h4>
            <div class="sheet-oneline" style="margin-top: 4px !important">
              <div class="sheet-maneuvers-basic">
                <h4 data-i18n="nbsp-label">&nbsp;</h4>
                <h4 class="sheet-left" data-i18n="name-label">Name</h4>
                <h4 data-i18n="type-label">Type</h4>
                <h4 data-i18n="nbsp-label">&nbsp;</h4>
              </div>

              <!-- DISARM -->
              <div class="sheet-maneuvers-basic">
                <button type="roll" class="sheet-button-description" name="roll_basic-disarm" value="@{global-privacy-status} &{template:levelup} {{details=[[0]]}} {{name=Disarm}} {{charactername=Basic Maneuvers}} {{category=Basic}} {{@{global-advantage-status}=1}} {{description=Disarm: force a target to drop an item and deal basic melee damage on a failed STR or DEX save.}}"></button>
                <input class="sheet-left" type="text" value="Disarm" />
                <input type="text" value="A" style="border: none" />
                <div class="sheet-cogs-container">
                  <input class="sheet-cogs-input sheet-cogs-hideshow-bm1" type="checkbox" name="attr_sheet-cogs-hideshow-bm1" checked />
                  <span class="sheet-cogs-icon">y</span>
                </div>
              </div>

              <input class="sheet-hidden sheet-cogs-input sheet-cogs-hideshow-bm1" type="checkbox" name="attr_sheet-cogs-hideshow-bm1" checked />
              <textarea class="sheet-left sheet-cogs-hideshow-bm1-div1" style="grid-column: 1/-1">
You can use the Disarm maneuver to attempt to knock an item or weapon from a creature’s hand. If you are able to make multiple attacks with the Attack action, this maneuver replaces one of them.

The target must be within your reach and be holding an item (either carried or wielded). The target makes a Strength or Dexterity saving throw against your maneuver DC. On a failure, you deal basic melee damage and the target drops the item in its space. The target has advantage if it is larger than you or holding the item with two or more hands, or if the target is smaller than you it has disadvantage.
          </textarea
              >

              <!-- GRAB ON -->
              <div class="sheet-maneuvers-basic">
                <button type="roll" class="sheet-button-description" name="roll_basic-grab-on" value="@{global-privacy-status} &{template:levelup} {{details=[[0]]}} {{name=Grab On}} {{charactername=Basic Maneuvers}} {{category=Basic}} {{@{global-advantage-status}=1}} {{description=Grab On: cling to a much larger creature and gain advantage on attacks while on it.}}"></button>
                <input class="sheet-left" type="text" value="Grab On" />
                <input type="text" value="A" style="border: none" />
                <div class="sheet-cogs-container">
                  <input class="sheet-cogs-input sheet-cogs-hideshow-bm2" type="checkbox" name="attr_sheet-cogs-hideshow-bm2" checked />
                  <span class="sheet-cogs-icon">y</span>
                </div>
              </div>

              <input class="sheet-hidden sheet-cogs-input sheet-cogs-hideshow-bm2" type="checkbox" name="attr_sheet-cogs-hideshow-bm2" checked />
              <textarea class="sheet-left sheet-cogs-hideshow-bm2-div1" style="grid-column: 1/-1">
While you cannot grapple a creature two or more size categories larger than you, you can grab onto it. By jumping onto its back or climbing up a limb, you can make a Strength or Dexterity saving throw against the creature’s maneuver DC to cling to or balance upon its body. On a success, you move into the creature’s space and can move upon its body as if it is difficult terrain.

While grabbing onto a larger creature, you gain advantage on attack rolls against it. The larger creature may be able to attack you as normal, depending on its limbs or attacks. It can also use an action to dislodge you, such as shaking you loose or bashing you against a wall, forcing you to make a Strength or Dexterity saving throw against its maneuver DC or fall prone into the nearest space adjacent to the creature, taking its basic melee damage in the process.

If the creature chooses to roll over in order to dislodge you, it becomes prone, but you have disadvantage on the check to hang on.
          </textarea
              >

              <!-- GRAPPLE -->
              <div class="sheet-maneuvers-basic">
                <button type="roll" class="sheet-button-description" name="roll_basic-grapple" value="@{global-privacy-status} &{template:levelup} {{details=[[0]]}} {{name=Grapple}} {{charactername=Basic Maneuvers}} {{category=Basic}} {{@{global-advantage-status}=1}} {{description=Grapple: restrain a creature within reach on a failed STR or DEX save and deal basic melee damage.}}"></button>
                <input class="sheet-left" type="text" value="Grapple" />
                <input type="text" value="A" style="border: none" />
                <div class="sheet-cogs-container">
                  <input class="sheet-cogs-input sheet-cogs-hideshow-bm3" type="checkbox" name="attr_sheet-cogs-hideshow-bm3" checked />
                  <span class="sheet-cogs-icon">y</span>
                </div>
              </div>

              <input class="sheet-hidden sheet-cogs-input sheet-cogs-hideshow-bm3" type="checkbox" name="attr_sheet-cogs-hideshow-bm3" checked />
              <textarea class="sheet-left sheet-cogs-hideshow-bm3-div1" style="grid-column: 1/-1">
You can use the Grapple maneuver to grab or wrestle a creature. If you are able to make multiple attacks with the Attack action, this maneuver replaces one of them.

You must have at least one free hand to attempt a grapple, your target must be within your reach, and the target must be no more than one size category larger than you. The target makes a Strength or Dexterity saving throw against your maneuver DC. On a failure, you deal basic melee damage and the target becomes grappled. In addition to things that end the condition, you can release the target at any time (no action required).

Escaping a Grapple. While grappled, a creature can use its action to attempt to escape. It must succeed on a Strength or Dexterity saving throw against your maneuver DC.

Moving a Grappled Creature. When you move, you can drag or carry the grappled creature with you. When you do so, your Speed is halved, unless the creature’s weight is within your carrying capacity and you are not encumbered by bulky items.

Freeing a Grappled Creature. You can use the Grapple maneuver to try to free another grappled or restrained creature. The creature grappling or restraining the target makes a Strength saving throw against your maneuver DC. If it fails the saving throw, the grappled or restrained creature is freed. Additionally, you may move the freed creature 5-ft in any direction.
          </textarea
              >

              <!-- KNOCKDOWN -->
              <div class="sheet-maneuvers-basic">
                <button type="roll" class="sheet-button-description" name="roll_basic-knockdown" value="@{global-privacy-status} &{template:levelup} {{details=[[0]]}} {{name=Knockdown}} {{charactername=Basic Maneuvers}} {{category=Basic}} {{@{global-advantage-status}=1}} {{description=Knockdown: knock a creature prone on a failed STR save and deal basic melee damage.}}"></button>
                <input class="sheet-left" type="text" value="Knockdown" />
                <input type="text" value="A" style="border: none" />
                <div class="sheet-cogs-container">
                  <input class="sheet-cogs-input sheet-cogs-hideshow-bm4" type="checkbox" name="attr_sheet-cogs-hideshow-bm4" checked />
                  <span class="sheet-cogs-icon">y</span>
                </div>
              </div>

              <input class="sheet-hidden sheet-cogs-input sheet-cogs-hideshow-bm4" type="checkbox" name="attr_sheet-cogs-hideshow-bm4" checked />
              <textarea class="sheet-left sheet-cogs-hideshow-bm4-div1" style="grid-column: 1/-1">
You can use the Knockdown maneuver to trip or push a creature down. If you are able to make multiple attacks with the Attack action, this maneuver replaces one of them.

The target must be within your reach and be no more than one size category larger than you. The target makes a Strength saving throw against your maneuver DC. On a failure, you deal basic melee damage and knock the target prone.
          </textarea
              >

              <!-- OVERRUN -->
              <div class="sheet-maneuvers-basic">
                <button type="roll" class="sheet-button-description" name="roll_basic-overrun" value="@{global-privacy-status} &{template:levelup} {{details=[[0]]}} {{name=Overrun}} {{charactername=Basic Maneuvers}} {{category=Basic}} {{@{global-advantage-status}=1}} {{description=Overrun: force your way through a hostile creature’s space on a successful STR save and deal basic melee damage.}}"></button>
                <input class="sheet-left" type="text" value="Overrun" />
                <input type="text" value="A/BA" style="border: none" />
                <div class="sheet-cogs-container">
                  <input class="sheet-cogs-input sheet-cogs-hideshow-bm5" type="checkbox" name="attr_sheet-cogs-hideshow-bm5" checked />
                  <span class="sheet-cogs-icon">y</span>
                </div>
              </div>

              <input class="sheet-hidden sheet-cogs-input sheet-cogs-hideshow-bm5" type="checkbox" name="attr_sheet-cogs-hideshow-bm5" checked />
              <textarea class="sheet-left sheet-cogs-hideshow-bm5-div1" style="grid-column: 1/-1">
You can use an action or bonus action to make an Overrun maneuver to move through a hostile creature’s space by forcing your way past. Make a Strength saving throw against the target’s maneuver DC. On a success, you deal basic melee damage and can move through the hostile creature’s space once this turn. The creature can choose to just let you pass instead of rolling. You have advantage if you are larger than the target, or disadvantage if you are smaller. If you are two or more sizes smaller than the target, you can move through the hostile creature’s space without making a save. You still provoke opportunity attacks if you move beyond a creature’s reach.
          </textarea
              >

              <!-- SHOVE -->
              <div class="sheet-maneuvers-basic">
                <button type="roll" class="sheet-button-description" name="roll_basic-shove" value="@{global-privacy-status} &{template:levelup} {{details=[[0]]}} {{name=Shove}} {{charactername=Basic Maneuvers}} {{category=Basic}} {{@{global-advantage-status}=1}} {{description=Shove: push a creature away and deal basic melee damage on a failed STR save.}}"></button>
                <input class="sheet-left" type="text" value="Shove" />
                <input type="text" value="A" style="border: none" />
                <div class="sheet-cogs-container">
                  <input class="sheet-cogs-input sheet-cogs-hideshow-bm6" type="checkbox" name="attr_sheet-cogs-hideshow-bm6" checked />
                  <span class="sheet-cogs-icon">y</span>
                </div>
              </div>

              <input class="sheet-hidden sheet-cogs-input sheet-cogs-hideshow-bm6" type="checkbox" name="attr_sheet-cogs-hideshow-bm6" checked />

              <textarea class="sheet-left sheet-cogs-hideshow-bm6-div1" style="grid-column: 1/-1">
You can use the Shove maneuver to push a creature away. If you are able to make multiple attacks with the Attack action, this maneuver replaces one of them.

The target must be within your reach and be no more than one size category larger than you. The target makes a Strength saving throw against your maneuver DC. On a failure, you deal basic melee damage and push the target a number of feet away from you equal to 5 + 5 for every 5 points it failed its saving throw by. You can move the creature in any direction away from you (to the side, forward, or diagonally away).

A creature that is shoved off of a precipice is propelled off of whatever it is standing on—it does not receive any saving throw or ability check to grab onto something to avoid falling down below.
          </textarea
              >

              <!-- FIELDSET MANEUVERS -->
              <fieldset class="repeating_maneuvers0">
                <input class="sheet-hidden sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" checked />

                <div class="sheet-maneuvers-basic">
                  <button type="roll" class="sheet-button-description" name="roll_maneuvers-roll" value="@{global-privacy-status} &{template:levelup} {{details=[[0]]}} {{name=@{maneuvers-name}}} {{charactername=@{maneuvers-tradition}}} {{category=@{maneuvers-degree} Degree}} {{@{global-advantage-status}=1}} {{description=@{maneuvers-description}}}"></button>
                  <input class="sheet-left" type="text" placeholder="Maneuvers Name" data-i18n-placeholder="maneuvers-name-placeholder" name="attr_maneuvers-name" />
                  <input type="text" placeholder="-" name="attr_maneuvers-type" style="border: none" />
                  <div class="sheet-cogs-container">
                    <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                    <span class="sheet-cogs-icon">y</span>
                  </div>
                </div>

                <textarea class="sheet-cogs-hideshow-div1" style="grid-column: 1/-1" type="text" value="-" name="attr_maneuvers-description"></textarea>
              </fieldset>
            </div>
          </div>

          <!-- ----- 1ST DEGREE MANEUVERS -----  -->
          <div class="sheet-main-maneuvers sheet-standardbox sheet-standardbox2">
            <h4 class="sheet-minititles2 sheet-main-titlestatistics" data-i18n="1st-degree-maneuvers-label">1st Degree Maneuvers</h4>
            <div class="sheet-oneline" style="margin-top: 4px !important">
              <div class="sheet-maneuvers">
                <h4 data-i18n="nbsp-label">&nbsp;</h4>
                <h4 data-i18n="nbsp-label">&nbsp;</h4>
                <h4 class="sheet-left" data-i18n="name-label">Name</h4>
                <h4 data-i18n="pts-label">PTS</h4>
                <h4 data-i18n="tradition-label">Tradition</h4>
                <h4 data-i18n="type-label">Type</h4>
                <h4 data-i18n="nbsp-label">&nbsp;</h4>
              </div>

              <!-- FIELDSET MANEUVERS -->
              <fieldset class="repeating_maneuvers1">
                <input class="sheet-hidden sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" checked />

                <div class="sheet-maneuvers">
                  <button type="roll" class="sheet-button-description" name="roll_maneuvers-roll" value="@{global-privacy-status} &{template:levelup} {{details=[[0]]}} {{name=@{maneuvers-name}}} {{charactername=@{maneuvers-tradition}}} {{category=@{maneuvers-degree} Degree}} {{@{global-advantage-status}=1}} {{description=@{maneuvers-description}}}"></button>
                  <input type="checkbox" value="1" name="attr_maneuvers-active" />
                  <input class="sheet-left" type="text" placeholder="Maneuvers Name" data-i18n-placeholder="maneuvers-name-placeholder" name="attr_maneuvers-name" />
                  <input type="number" value="0" name="attr_maneuvers-points" />
                  <input type="text" placeholder="-" name="attr_maneuvers-tradition" />
                  <input type="text" placeholder="-" name="attr_maneuvers-type" style="border: none" />
                  <div class="sheet-cogs-container">
                    <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                    <span class="sheet-cogs-icon">y</span>
                  </div>
                </div>

                <textarea class="sheet-cogs-hideshow-div1" style="grid-column: 1/-1" type="text" value="-" name="attr_maneuvers-description"></textarea>
              </fieldset>
            </div>
          </div>

          <!-- ----- 2ND DEGREE MANEUVERS -----  -->
          <div class="sheet-main-maneuvers sheet-standardbox sheet-standardbox2">
            <h4 class="sheet-minititles2 sheet-main-titlestatistics" data-i18n="2nd-degree-maneuvers-label">2nd Degree Maneuvers</h4>
            <div class="sheet-oneline" style="margin-top: 4px !important">
              <div class="sheet-maneuvers">
                <h4 data-i18n="nbsp-label">&nbsp;</h4>
                <h4 data-i18n="nbsp-label">&nbsp;</h4>
                <h4 class="sheet-left" data-i18n="name-label">Name</h4>
                <h4 data-i18n="pts-label">PTS</h4>
                <h4 data-i18n="tradition-label">Tradition</h4>
                <h4 data-i18n="type-label">Type</h4>
                <h4 data-i18n="nbsp-label">&nbsp;</h4>
              </div>

              <!-- FIELDSET MANEUVERS -->
              <fieldset class="repeating_maneuvers2">
                <input class="sheet-hidden sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" checked />

                <div class="sheet-maneuvers">
                  <button type="roll" class="sheet-button-description" name="roll_maneuvers-roll" value="@{global-privacy-status} &{template:levelup} {{details=[[0]]}} {{name=@{maneuvers-name}}} {{charactername=@{maneuvers-tradition}}} {{category=@{maneuvers-degree} Degree}} {{@{global-advantage-status}=1}} {{description=@{maneuvers-description}}}"></button>
                  <input type="checkbox" value="1" name="attr_maneuvers-active" />
                  <input class="sheet-left" type="text" placeholder="Maneuvers Name" data-i18n-placeholder="maneuvers-name-placeholder" name="attr_maneuvers-name" />
                  <input type="number" value="0" name="attr_maneuvers-points" />
                  <input type="text" placeholder="-" name="attr_maneuvers-tradition" />
                  <input type="text" placeholder="-" name="attr_maneuvers-type" style="border: none" />
                  <div class="sheet-cogs-container">
                    <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                    <span class="sheet-cogs-icon">y</span>
                  </div>
                </div>

                <textarea class="sheet-cogs-hideshow-div1" style="grid-column: 1/-1" type="text" value="-" name="attr_maneuvers-description"></textarea>
              </fieldset>
            </div>
          </div>
        </div>

        <div class="sheet-mainright">
          <!-- ----- 3RD DEGREE MANEUVERS -----  -->
          <div class="sheet-main-maneuvers sheet-standardbox sheet-standardbox2">
            <h4 class="sheet-minititles2 sheet-main-titlestatistics" data-i18n="3rd-degree-maneuvers-label">3rd Degree Maneuvers</h4>
            <div class="sheet-oneline" style="margin-top: 4px !important">
              <div class="sheet-maneuvers">
                <h4 data-i18n="nbsp-label">&nbsp;</h4>
                <h4 data-i18n="nbsp-label">&nbsp;</h4>
                <h4 class="sheet-left" data-i18n="name-label">Name</h4>
                <h4 data-i18n="pts-label">PTS</h4>
                <h4 data-i18n="tradition-label">Tradition</h4>
                <h4 data-i18n="type-label">Type</h4>
                <h4 data-i18n="nbsp-label">&nbsp;</h4>
              </div>

              <!-- FIELDSET MANEUVERS -->
              <fieldset class="repeating_maneuvers3">
                <input class="sheet-hidden sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" checked />

                <div class="sheet-maneuvers">
                  <button type="roll" class="sheet-button-description" name="roll_maneuvers-roll" value="@{global-privacy-status} &{template:levelup} {{details=[[0]]}} {{name=@{maneuvers-name}}} {{charactername=@{maneuvers-tradition}}} {{category=@{maneuvers-degree} Degree}} {{@{global-advantage-status}=1}} {{description=@{maneuvers-description}}}"></button>
                  <input type="checkbox" value="1" name="attr_maneuvers-active" />
                  <input class="sheet-left" type="text" placeholder="Maneuvers Name" data-i18n-placeholder="maneuvers-name-placeholder" name="attr_maneuvers-name" />
                  <input type="number" value="0" name="attr_maneuvers-points" />
                  <input type="text" placeholder="-" name="attr_maneuvers-tradition" />
                  <input type="text" placeholder="-" name="attr_maneuvers-type" style="border: none" />
                  <div class="sheet-cogs-container">
                    <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                    <span class="sheet-cogs-icon">y</span>
                  </div>
                </div>

                <textarea class="sheet-cogs-hideshow-div1" style="grid-column: 1/-1" type="text" value="-" name="attr_maneuvers-description"></textarea>
              </fieldset>
            </div>
          </div>

          <!-- ----- 4TH DEGREE MANEUVERS -----  -->
          <div class="sheet-main-maneuvers sheet-standardbox sheet-standardbox2">
            <h4 class="sheet-minititles2 sheet-main-titlestatistics" data-i18n="4th-degree-maneuvers-label">4th Degree Maneuvers</h4>
            <div class="sheet-oneline" style="margin-top: 4px !important">
              <div class="sheet-maneuvers">
                <h4 data-i18n="nbsp-label">&nbsp;</h4>
                <h4 data-i18n="nbsp-label">&nbsp;</h4>
                <h4 class="sheet-left" data-i18n="name-label">Name</h4>
                <h4 data-i18n="pts-label">PTS</h4>
                <h4 data-i18n="tradition-label">Tradition</h4>
                <h4 data-i18n="type-label">Type</h4>
                <h4 data-i18n="nbsp-label">&nbsp;</h4>
              </div>

              <!-- FIELDSET MANEUVERS -->
              <fieldset class="repeating_maneuvers4">
                <input class="sheet-hidden sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" checked />

                <div class="sheet-maneuvers">
                  <button type="roll" class="sheet-button-description" name="roll_maneuvers-roll" value="@{global-privacy-status} &{template:levelup} {{details=[[0]]}} {{name=@{maneuvers-name}}} {{charactername=@{maneuvers-tradition}}} {{category=@{maneuvers-degree} Degree}} {{@{global-advantage-status}=1}} {{description=@{maneuvers-description}}}"></button>
                  <input type="checkbox" value="1" name="attr_maneuvers-active" />
                  <input class="sheet-left" type="text" placeholder="Maneuvers Name" data-i18n-placeholder="maneuvers-name-placeholder" name="attr_maneuvers-name" />
                  <input type="number" value="0" name="attr_maneuvers-points" />
                  <input type="text" placeholder="-" name="attr_maneuvers-tradition" />
                  <input type="text" placeholder="-" name="attr_maneuvers-type" style="border: none" />
                  <div class="sheet-cogs-container">
                    <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                    <span class="sheet-cogs-icon">y</span>
                  </div>
                </div>

                <textarea class="sheet-cogs-hideshow-div1" style="grid-column: 1/-1" type="text" value="-" name="attr_maneuvers-description"></textarea>
              </fieldset>
            </div>
          </div>

          <!-- ----- 5TH DEGREE MANEUVERS -----  -->
          <div class="sheet-main-maneuvers sheet-standardbox sheet-standardbox2">
            <h4 class="sheet-minititles2 sheet-main-titlestatistics" data-i18n="5th-degree-maneuvers-label">5th Degree Maneuvers</h4>
            <div class="sheet-oneline" style="margin-top: 4px !important">
              <div class="sheet-maneuvers">
                <h4 data-i18n="nbsp-label">&nbsp;</h4>
                <h4 data-i18n="nbsp-label">&nbsp;</h4>
                <h4 class="sheet-left" data-i18n="name-label">Name</h4>
                <h4 data-i18n="pts-label">PTS</h4>
                <h4 data-i18n="tradition-label">Tradition</h4>
                <h4 data-i18n="type-label">Type</h4>
                <h4 data-i18n="nbsp-label">&nbsp;</h4>
              </div>

              <!-- FIELDSET MANEUVERS -->
              <fieldset class="repeating_maneuvers5">
                <input class="sheet-hidden sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" checked />

                <div class="sheet-maneuvers">
                  <button type="roll" class="sheet-button-description" name="roll_maneuvers-roll" value="@{global-privacy-status} &{template:levelup} {{details=[[0]]}} {{name=@{maneuvers-name}}} {{charactername=@{maneuvers-tradition}}} {{category=@{maneuvers-degree} Degree}} {{@{global-advantage-status}=1}} {{description=@{maneuvers-description}}}"></button>
                  <input type="checkbox" value="1" name="attr_maneuvers-active" />
                  <input class="sheet-left" type="text" placeholder="Maneuvers Name" data-i18n-placeholder="maneuvers-name-placeholder" name="attr_maneuvers-name" />
                  <input type="number" value="0" name="attr_maneuvers-points" />
                  <input type="text" placeholder="-" name="attr_maneuvers-tradition" />
                  <input type="text" placeholder="-" name="attr_maneuvers-type" style="border: none" />
                  <div class="sheet-cogs-container">
                    <input class="sheet-cogs-input sheet-cogs-hideshow" type="checkbox" name="attr_sheet-cogs-hideshow" />
                    <span class="sheet-cogs-icon">y</span>
                  </div>
                </div>

                <textarea class="sheet-cogs-hideshow-div1" style="grid-column: 1/-1" type="text" value="-" name="attr_maneuvers-description"></textarea>
              </fieldset>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ----- BACKGROUND -----  -->
  <div class="sheet-background-display sheet-hidden">
    <!-- ----- BACKGROUND HEADER -----  -->
    <div class="sheet-background-header sheet-standardbox sheet-standardbox2">
      <div class="sheet-oneline">
        <div class="sheet-background-header-line1">
          <h4 data-i18n="age-label">Age</h4>
          <h4 data-i18n="height-label">Height</h4>
          <h4 data-i18n="weight-label">Weight</h4>
          <h4 data-i18n="skin-label">Skin</h4>
          <h4 data-i18n="hair-label">Hair</h4>
          <h4 data-i18n="eye-label">Eye</h4>
          <input type="text" placeholder="-" name="attr_character_age" />
          <input type="text" placeholder="-" name="attr_character_height" />
          <input type="text" placeholder="-" name="attr_character_weight" />
          <input type="text" placeholder="-" name="attr_character_skin" />
          <input type="text" placeholder="-" name="attr_character_hair" />
          <input type="text" placeholder="-" name="attr_character_eye" />
        </div>
      </div>
    </div>

    <!-- ----- INSPIRATION HEADER -----  -->
    <div class="sheet-background-header sheet-standardbox sheet-standardbox2">
      <div class="sheet-oneline">
        <div class="sheet-triplecolumn">
          <h4 data-i18n="source-of-inspiration-label">Source of Inspiration</h4>
          <h4 data-i18n="inspiration-feature-label">Inspiration Feature</h4>
          <h4 data-i18n="fulfillment-feature-label">Fulfillment Feature</h4>
          <input type="text" placeholder="-" name="attr_character_source-inspiration" />
          <input type="text" placeholder="-" name="attr_character_inspiration-feature" />
          <input type="text" placeholder="-" name="attr_character_fulfillment-feature" />
        </div>
      </div>
    </div>

    <div class="sheet-background-area">
      <!--  -->
      <div class="sheet-background-vertical-art">
        <!-- ----- CHARACTER PORTRAITS -----  -->
        <div class="sheet-standardbox sheet-standardbox2">
          <div class="sheet-main-vehicle-name1">
            <h4 class="sheet-main-characterstatusupgrades" data-i18n="character-appearance-label">Character Appearance</h4>
            <div class="sheet-cogs-container">
              <input class="sheet-cogs-input sheet-portrait-hideshow" type="checkbox" name="attr_sheet-portrait-hideshow" />
              <span class="sheet-cogs-icon">y</span>
            </div>
          </div>
          <div class="sheet-oneline">
            <input class="sheet-hidden sheet-portrait-hideshow" type="checkbox" name="attr_sheet-portrait-hideshow" />
            <input class="sheet-portrait-hideshow-div1" type="text" placeholder="(URL) Character Portrait" data-i18n-placeholder="url-character-portrait-placeholder" name="attr_character-portrait" />
            <img name="attr_character-portrait" />
          </div>
        </div>

        <!-- ----- CHARACTER APPEARANCE -----  -->
        <div class="sheet-standardbox sheet-standardbox2">
          <h4 class="sheet-minititles2" data-i18n="character-appearance-label">Character Appearance</h4>
          <div class="sheet-oneline">
            <textarea class="sheet-left" placeholder="-" name="attr_background-characternotes" style="height: 100px"></textarea>
          </div>
        </div>

        <!-- ----- CHARACTER BACKGROUND -----  -->
        <div class="sheet-standardbox sheet-standardbox2">
          <h4 class="sheet-minititles2" data-i18n="character-background-label">Character Background</h4>
          <div class="sheet-oneline">
            <textarea class="sheet-left" placeholder="-" name="attr_background-characterbackground" style="height: 100px"></textarea>
          </div>
        </div>
      </div>

      <!-- ----- GENERAL  NOTES -----  -->
      <div class="sheet-background-generalnotes">
        <div class="sheet-standardbox sheet-standardbox2">
          <h4 class="sheet-minititles2" data-i18n="general-notes-label">General Notes</h4>
          <div class="sheet-oneline">
            <textarea class="sheet-left" name="attr_background-generalnotes"></textarea>
          </div>
        </div>

        <div class="sheet-standardbox sheet-standardbox2">
          <h4 class="sheet-minititles2" data-i18n="allies-organization-label">Allies & Organization</h4>
          <div class="sheet-oneline">
            <textarea class="sheet-left" name="attr_background-alliesetorganization" style="height: 100px !important"></textarea>
          </div>
        </div>
      </div>
      <!--  -->
    </div>
  </div>

  <div class="sheet-bottom-background sheet-hidden"></div>
</div>
