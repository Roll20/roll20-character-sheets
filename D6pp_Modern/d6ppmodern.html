<div class="sheet-d6pp-sheet compendium-drop-target beasts">
  <input accept="character_type" type="hidden" name="attr_character_type" />

  <input type="hidden" name="attr_defaults_set" value="0" />

  <input type="hidden" name="attr_strength_string" />
  <input type="hidden" name="attr_strength_base_string" />
  <input type="hidden" name="attr_strength_adjustment" />
  <input type="hidden" name="attr_strength_rollcode" />
  <input type="hidden" name="attr_strength_conditions" />
  <input type="hidden" name="attr_strength_displayname" value="Strength" />

  <input type="hidden" name="attr_agility_string"/>
  <input type="hidden" name="attr_agility_base_string" />
  <input type="hidden" name="attr_agility_adjustment"/>
  <input type="hidden" name="attr_agility_rollcode" />
  <input type="hidden" name="attr_agility_conditions" />
  <input type="hidden" name="attr_agility_displayname" value="Agility" />

  <input type="hidden" name="attr_health_string" />
  <input type="hidden" name="attr_health_base_string" />
  <input type="hidden" name="attr_health_adjustment" />
  <input type="hidden" name="attr_health_rollcode" />
  <input type="hidden" name="attr_health_conditions" />
  <input type="hidden" name="attr_health_displayname" value="Health" />

  <input type="hidden" name="attr_perception_string" />
  <input type="hidden" name="attr_perception_base_string" />
  <input type="hidden" name="attr_perception_adjustment" />
  <input type="hidden" name="attr_perception_rollcode" />
  <input type="hidden" name="attr_perception_conditions" />
  <input type="hidden" name="attr_perception_displayname" value="Perception" />

  <input type="hidden" name="attr_quickness_string" />
  <input type="hidden" name="attr_quickness_base_string" />
  <input type="hidden" name="attr_quickness_adjustment" />
  <input type="hidden" name="attr_quickness_rollcode" />
  <input type="hidden" name="attr_quickness_conditions" />
  <input type="hidden" name="attr_quickness_displayname" value="Quickness" />

  <input type="hidden" name="attr_willpower_string" />
  <input type="hidden" name="attr_willpower_base_string" />
  <input type="hidden" name="attr_willpower_adjustment" />
  <input type="hidden" name="attr_willpower_rollcode" />
  <input type="hidden" name="attr_willpower_conditions" />
  <input type="hidden" name="attr_willpower_displayname" value="Willpower" />

  <input type="hidden" name="attr_intelligence_string" />
  <input type="hidden" name="attr_intelligence_base_string" />
  <input type="hidden" name="attr_intelligence_adjustment" />
  <input type="hidden" name="attr_intelligence_rollcode" />
  <input type="hidden" name="attr_intelligence_conditions" />
  <input type="hidden" name="attr_intelligence_displayname" value="Intelligence" />

  <input type="hidden" name="attr_manualdex_string" />
  <input type="hidden" name="attr_manualdex_base_string" />
  <input type="hidden" name="attr_manualdex_adjustment" />
  <input type="hidden" name="attr_manualdex_rollcode" />
  <input type="hidden" name="attr_manualdex_conditions" />
  <input type="hidden" name="attr_manualdex_displayname" value="Manual Dex" />

  <input type="hidden" name="attr_charisma_string" />
  <input type="hidden" name="attr_charisma_base_string" />
  <input type="hidden" name="attr_charisma_adjustment" />
  <input type="hidden" name="attr_charisma_rollcode" />
  <input type="hidden" name="attr_charisma_conditions" />
  <input type="hidden" name="attr_charisma_displayname" value="Charisma" />

  <input type="hidden" name="attr_vehicle_drive_string" />
  <input type="hidden" name="attr_vehicle_drive_base_string" />
  <input type="hidden" name="attr_vehicle_drive_adjustment" />
  <input type="hidden" name="attr_vehicle_drive_rollcode" />
  <input type="hidden" name="attr_vehicle_drive_displayname" value="Vehicle_Drive" />

  <input type="hidden" name="attr_core_value" />
  <input type="hidden" name="attr_core_string" />
  <input type="hidden" name="attr_core_min" />
  <input type="hidden" name="attr_core_cost" />
  <input type="hidden" name="attr_core_refund" />

  <input type="hidden" name="attr_social_value" />
  <input type="hidden" name="attr_social_string" />
  <input type="hidden" name="attr_social_min" />
  <input type="hidden" name="attr_social_cost" />
  <input type="hidden" name="attr_social_refund" />

  <input type="hidden" name="attr_performance_value" />
  <input type="hidden" name="attr_performance_string" />
  <input type="hidden" name="attr_performance_min" />
  <input type="hidden" name="attr_performance_cost" />
  <input type="hidden" name="attr_performance_refund" />

  <input type="hidden" name="attr_thievery_value" />
  <input type="hidden" name="attr_thievery_string" />
  <input type="hidden" name="attr_thievery_min" />
  <input type="hidden" name="attr_thievery_cost" />
  <input type="hidden" name="attr_thievery_refund" />

  <input type="hidden" name="attr_animals_value" />
  <input type="hidden" name="attr_animals_string" />
  <input type="hidden" name="attr_animals_min" />
  <input type="hidden" name="attr_animals_cost" />
  <input type="hidden" name="attr_animals_refund" />

  <input type="hidden" name="attr_awareness_value" />
  <input type="hidden" name="attr_awareness_string" />
  <input type="hidden" name="attr_awareness_min" />
  <input type="hidden" name="attr_awareness_cost" />
  <input type="hidden" name="attr_awareness_refund" />

  <input type="hidden" name="attr_survival_value" />
  <input type="hidden" name="attr_survival_string" />
  <input type="hidden" name="attr_survival_min" />
  <input type="hidden" name="attr_survival_cost" />
  <input type="hidden" name="attr_survival_refund" />

  <input type="hidden" name="attr_stealth_value" />
  <input type="hidden" name="attr_stealth_string" />
  <input type="hidden" name="attr_stealth_min" />
  <input type="hidden" name="attr_stealth_cost" />
  <input type="hidden" name="attr_stealth_refund" />

  <input type="hidden" name="attr_physical_value" />
  <input type="hidden" name="attr_physical_string" />
  <input type="hidden" name="attr_physical_min" />
  <input type="hidden" name="attr_physical_cost" />
  <input type="hidden" name="attr_physical_refund" />

  <input type="hidden" name="attr_medical_value" />
  <input type="hidden" name="attr_medical_string" />
  <input type="hidden" name="attr_medical_min" />
  <input type="hidden" name="attr_medical_cost" />
  <input type="hidden" name="attr_medical_refund" />

  <input type="hidden" name="attr_computers_value" />
  <input type="hidden" name="attr_computers_string" />
  <input type="hidden" name="attr_computers_min" />
  <input type="hidden" name="attr_computers_cost" />
  <input type="hidden" name="attr_computers_refund" />

  <input type="hidden" name="attr_technical_value" />
  <input type="hidden" name="attr_technical_string" />
  <input type="hidden" name="attr_technical_min" />
  <input type="hidden" name="attr_technical_cost" />
  <input type="hidden" name="attr_technical_refund" />

  <input type="hidden" name="attr_knowledge_value" />
  <input type="hidden" name="attr_knowledge_string" />
  <input type="hidden" name="attr_knowledge_min" />
  <input type="hidden" name="attr_knowledge_cost" />
  <input type="hidden" name="attr_knowledge_refund" />

  <input type="hidden" name="attr_investigation_value" />
  <input type="hidden" name="attr_investigation_string" />
  <input type="hidden" name="attr_investigation_min" />
  <input type="hidden" name="attr_investigation_cost" />
  <input type="hidden" name="attr_investigation_refund" />

  <input type="hidden" name="attr_military_training_value" />
  <input type="hidden" name="attr_military_training_string" />
  <input type="hidden" name="attr_military_training_min" />
  <input type="hidden" name="attr_military_training_cost" />
  <input type="hidden" name="attr_military_training_refund" />

  <input type="hidden" name="attr_driving_value" />
  <input type="hidden" name="attr_driving_string" />
  <input type="hidden" name="attr_driving_min" />
  <input type="hidden" name="attr_driving_cost" />
  <input type="hidden" name="attr_driving_refund" />

  <input type="hidden" name="attr_aviation_value" />
  <input type="hidden" name="attr_aviation_string" />
  <input type="hidden" name="attr_aviation_min" />
  <input type="hidden" name="attr_aviation_cost" />
  <input type="hidden" name="attr_aviation_refund" />

  <input type="hidden" name="attr_nautical_value" />
  <input type="hidden" name="attr_nautical_string" />
  <input type="hidden" name="attr_nautical_min" />
  <input type="hidden" name="attr_nautical_cost" />
  <input type="hidden" name="attr_nautical_refund" />

  <input type="hidden" name="attr_sidearms_value" />
  <input type="hidden" name="attr_sidearms_string" />
  <input type="hidden" name="attr_sidearms_min" />
  <input type="hidden" name="attr_sidearms_cost" />
  <input type="hidden" name="attr_sidearms_refund" />

  <input type="hidden" name="attr_longarms_value" />
  <input type="hidden" name="attr_longarms_string" />
  <input type="hidden" name="attr_longarms_min" />
  <input type="hidden" name="attr_longarms_cost" />
  <input type="hidden" name="attr_longarms_refund" />

  <input type="hidden" name="attr_unarmed_value" />
  <input type="hidden" name="attr_unarmed_string" />
  <input type="hidden" name="attr_unarmed_min" />
  <input type="hidden" name="attr_unarmed_cost" />
  <input type="hidden" name="attr_unarmed_refund" />

  <input type="hidden" name="attr_armed_value" />
  <input type="hidden" name="attr_armed_string" />
  <input type="hidden" name="attr_armed_min" />
  <input type="hidden" name="attr_armed_cost" />
  <input type="hidden" name="attr_armed_refund" />

  <input type="hidden" name="attr_ranged_value" />
  <input type="hidden" name="attr_ranged_string" />
  <input type="hidden" name="attr_ranged_min" />
  <input type="hidden" name="attr_ranged_cost" />
  <input type="hidden" name="attr_ranged_refund" />

  <input type="hidden" name="attr_initiative_attributes" />
  <input type="hidden" name="attr_initiative_specialized" value="" />
  <input type="hidden" name="attr_initiative_rollcode" />
  <input type="hidden" name="attr_initiative_string" />
  <input type="hidden" name="attr_initiative_skillgroup" />
  <input type="hidden" name="attr_initiative_active" />
  <input type="hidden" name="attr_initiative_displayname" value="Initative" />

  <input type="hidden" name="attr_dodge_attributes" />
  <input type="hidden" name="attr_dodge_specialized" value="" />
  <input type="hidden" name="attr_dodge_rollcode" />
  <input type="hidden" name="attr_dodge_string" />
  <input type="hidden" name="attr_dodge_skillgroup" />
  <input type="hidden" name="attr_dodge_active" />
  <input type="hidden" name="attr_dodge_displayname" value="Dodge" />

  <input type="hidden" name="attr_endure_attributes" />
  <input type="hidden" name="attr_endure_specialized" value="" />
  <input type="hidden" name="attr_endure_rollcode" />
  <input type="hidden" name="attr_endure_string" />
  <input type="hidden" name="attr_endure_skillgroup" />
  <input type="hidden" name="attr_endure_active" />
  <input type="hidden" name="attr_endure_displayname" value="Endure" />

  <input type="hidden" name="attr_avoid_attributes" />
  <input type="hidden" name="attr_avoid_specialized" value="" />
  <input type="hidden" name="attr_avoid_rollcode" />
  <input type="hidden" name="attr_avoid_string" />
  <input type="hidden" name="attr_avoid_skillgroup" />
  <input type="hidden" name="attr_avoid_active" />
  <input type="hidden" name="attr_avoid_displayname" value="Avoid" />

  <input type="hidden" name="attr_defend_attributes" />
  <input type="hidden" name="attr_defend_specialized" value="" />
  <input type="hidden" name="attr_defend_rollcode" />
  <input type="hidden" name="attr_defend_string" />
  <input type="hidden" name="attr_defend_skillgroup" />
  <input type="hidden" name="attr_defend_active" />
  <input type="hidden" name="attr_defend_displayname" value="Defend" />

  <input type="hidden" name="attr_persuade_attributes" />
  <input type="hidden" name="attr_persuade_specialized" value="" />
  <input type="hidden" name="attr_persuade_rollcode" />
  <input type="hidden" name="attr_persuade_string" />
  <input type="hidden" name="attr_persuade_skillgroup" />
  <input type="hidden" name="attr_persuade_active" />
  <input type="hidden" name="attr_persuade_displayname" value="Persuade" />

  <input type="hidden" name="attr_intimidate_attributes" />
  <input type="hidden" name="attr_intimidate_specialized" value="" />
  <input type="hidden" name="attr_intimidate_rollcode" />
  <input type="hidden" name="attr_intimidate_string" />
  <input type="hidden" name="attr_intimidate_skillgroup" />
  <input type="hidden" name="attr_intimidate_active" />
  <input type="hidden" name="attr_intimidate_displayname" value="Intimidate" />

  <input type="hidden" name="attr_deceive_attributes" />
  <input type="hidden" name="attr_deceive_specialized" value="" />
  <input type="hidden" name="attr_deceive_rollcode" />
  <input type="hidden" name="attr_deceive_string" />
  <input type="hidden" name="attr_deceive_skillgroup" />
  <input type="hidden" name="attr_deceive_active" />
  <input type="hidden" name="attr_deceive_displayname" value="Deceive" />

  <input type="hidden" name="attr_negotiate_attributes" />
  <input type="hidden" name="attr_negotiate_specialized" value="" />
  <input type="hidden" name="attr_negotiate_rollcode" />
  <input type="hidden" name="attr_negotiate_string" />
  <input type="hidden" name="attr_negotiate_skillgroup" />
  <input type="hidden" name="attr_negotiate_active" />
  <input type="hidden" name="attr_negotiate_displayname" value="Negotiate" />

  <input type="hidden" name="attr_seduce_attributes" />
  <input type="hidden" name="attr_seduce_specialized" value="" />
  <input type="hidden" name="attr_seduce_rollcode" />
  <input type="hidden" name="attr_seduce_string" />
  <input type="hidden" name="attr_seduce_skillgroup" />
  <input type="hidden" name="attr_seduce_active" />
  <input type="hidden" name="attr_seduce_displayname" value="Seduce" />

  <input type="hidden" name="attr_streetwise_attributes" />
  <input type="hidden" name="attr_streetwise_specialized" value="" />
  <input type="hidden" name="attr_streetwise_rollcode" />
  <input type="hidden" name="attr_streetwise_string" />
  <input type="hidden" name="attr_streetwise_skillgroup" />
  <input type="hidden" name="attr_streetwise_active" />
  <input type="hidden" name="attr_streetwise_displayname" value="Streetwise" />

  <input type="hidden" name="attr_etiquette_attributes" />
  <input type="hidden" name="attr_etiquette_specialized" value="" />
  <input type="hidden" name="attr_etiquette_rollcode" />
  <input type="hidden" name="attr_etiquette_string" />
  <input type="hidden" name="attr_etiquette_skillgroup" />
  <input type="hidden" name="attr_etiquette_active" />
  <input type="hidden" name="attr_etiquette_displayname" value="Etiquette" />

  <input type="hidden" name="attr_bureaucracy_attributes" />
  <input type="hidden" name="attr_bureaucracy_specialized" value="" />
  <input type="hidden" name="attr_bureaucracy_rollcode" />
  <input type="hidden" name="attr_bureaucracy_string" />
  <input type="hidden" name="attr_bureaucracy_skillgroup" />
  <input type="hidden" name="attr_bureaucracy_active" />
  <input type="hidden" name="attr_bureaucracy_displayname" value="Bureaucracy" />

  <input type="hidden" name="attr_dance_attributes" />
  <input type="hidden" name="attr_dance_specialized" value="" />
  <input type="hidden" name="attr_dance_rollcode" />
  <input type="hidden" name="attr_dance_string" />
  <input type="hidden" name="attr_dance_skillgroup" />
  <input type="hidden" name="attr_dance_active" />
  <input type="hidden" name="attr_dance_displayname" value="Dance" />

  <input type="hidden" name="attr_sing_attributes" />
  <input type="hidden" name="attr_sing_specialized" value="" />
  <input type="hidden" name="attr_sing_rollcode" />
  <input type="hidden" name="attr_sing_string" />
  <input type="hidden" name="attr_sing_skillgroup" />
  <input type="hidden" name="attr_sing_active" />
  <input type="hidden" name="attr_sing_displayname" value="Sing" />

  <input type="hidden" name="attr_acting_attributes" />
  <input type="hidden" name="attr_acting_specialized" value="" />
  <input type="hidden" name="attr_acting_rollcode" />
  <input type="hidden" name="attr_acting_string" />
  <input type="hidden" name="attr_acting_skillgroup" />
  <input type="hidden" name="attr_acting_active" />
  <input type="hidden" name="attr_acting_displayname" value="Acting" />

  <input type="hidden" name="attr_art_attributes" />
  <input type="hidden" name="attr_art_specialized" value="" />
  <input type="hidden" name="attr_art_rollcode" />
  <input type="hidden" name="attr_art_string" />
  <input type="hidden" name="attr_art_skillgroup" />
  <input type="hidden" name="attr_art_active" />
  <input type="hidden" name="attr_art_displayname" value="Art" />

  <input type="hidden" name="attr_comedy_attributes" />
  <input type="hidden" name="attr_comedy_specialized" value="" />
  <input type="hidden" name="attr_comedy_rollcode" />
  <input type="hidden" name="attr_comedy_string" />
  <input type="hidden" name="attr_comedy_skillgroup" />
  <input type="hidden" name="attr_comedy_active" />
  <input type="hidden" name="attr_comedy_displayname" value="Comedy" />

  <input type="hidden" name="attr_play_instrument_attributes" />
  <input type="hidden" name="attr_play_instrument_specialized" value="" />
  <input type="hidden" name="attr_play_instrument_rollcode" />
  <input type="hidden" name="attr_play_instrument_string" />
  <input type="hidden" name="attr_play_instrument_skillgroup" />
  <input type="hidden" name="attr_play_instrument_active" />
  <input type="hidden" name="attr_play_instrument_displayname" value="Play Instrument" />

  <input type="hidden" name="attr_disguise_attributes" />
  <input type="hidden" name="attr_disguise_specialized" value="" />
  <input type="hidden" name="attr_disguise_rollcode" />
  <input type="hidden" name="attr_disguise_string" />
  <input type="hidden" name="attr_disguise_skillgroup" />
  <input type="hidden" name="attr_disguise_active" />
  <input type="hidden" name="attr_disguise_displayname" value="Disguise" />

  <input type="hidden" name="attr_gambling_attributes" />
  <input type="hidden" name="attr_gambling_specialized" value="" />
  <input type="hidden" name="attr_gambling_rollcode" />
  <input type="hidden" name="attr_gambling_string" />
  <input type="hidden" name="attr_gambling_skillgroup" />
  <input type="hidden" name="attr_gambling_active" />
  <input type="hidden" name="attr_gambling_displayname" value="Gambling" />

  <input type="hidden" name="attr_showmanship_attributes" />
  <input type="hidden" name="attr_showmanship_specialized" value="" />
  <input type="hidden" name="attr_showmanship_rollcode" />
  <input type="hidden" name="attr_showmanship_string" />
  <input type="hidden" name="attr_showmanship_skillgroup" />
  <input type="hidden" name="attr_showmanship_active" />
  <input type="hidden" name="attr_showmanship_displayname" value="Showmanship" />

  <input type="hidden" name="attr_sleight_of_hand_attributes" />
  <input type="hidden" name="attr_sleight_of_hand_specialized" value="" />
  <input type="hidden" name="attr_sleight_of_hand_rollcode" />
  <input type="hidden" name="attr_sleight_of_hand_string" />
  <input type="hidden" name="attr_sleight_of_hand_skillgroup" />
  <input type="hidden" name="attr_sleight_of_hand_active" />
  <input type="hidden" name="attr_sleight_of_hand_displayname" value="Sleight of Hand" />

  <input type="hidden" name="attr_lockpicking_attributes" />
  <input type="hidden" name="attr_lockpicking_specialized" value="" />
  <input type="hidden" name="attr_lockpicking_rollcode" />
  <input type="hidden" name="attr_lockpicking_string" />
  <input type="hidden" name="attr_lockpicking_skillgroup" />
  <input type="hidden" name="attr_lockpicking_active" />
  <input type="hidden" name="attr_lockpicking_displayname" value="Lockpicking" />

  <input type="hidden" name="attr_forgery_attributes" />
  <input type="hidden" name="attr_forgery_specialized" value="" />
  <input type="hidden" name="attr_forgery_rollcode" />
  <input type="hidden" name="attr_forgery_string" />
  <input type="hidden" name="attr_forgery_skillgroup" />
  <input type="hidden" name="attr_forgery_active" />
  <input type="hidden" name="attr_forgery_displayname" value="Forgery" />

  <input type="hidden" name="attr_cheating_attributes" />
  <input type="hidden" name="attr_cheating_specialized" value="" />
  <input type="hidden" name="attr_cheating_rollcode" />
  <input type="hidden" name="attr_cheating_string" />
  <input type="hidden" name="attr_cheating_skillgroup" />
  <input type="hidden" name="attr_cheating_active" />
  <input type="hidden" name="attr_cheating_displayname" value="Cheating" />

  <input type="hidden" name="attr_animal_training_attributes" />
  <input type="hidden" name="attr_animal_training_specialized" value="" />
  <input type="hidden" name="attr_animal_training_rollcode" />
  <input type="hidden" name="attr_animal_training_string" />
  <input type="hidden" name="attr_animal_training_skillgroup" />
  <input type="hidden" name="attr_animal_training_active" />
  <input type="hidden" name="attr_animal_training_displayname" value="Animal Training" />

  <input type="hidden" name="attr_animal_handling_attributes" />
  <input type="hidden" name="attr_animal_handling_specialized" value="" />
  <input type="hidden" name="attr_animal_handling_rollcode" />
  <input type="hidden" name="attr_animal_handling_string" />
  <input type="hidden" name="attr_animal_handling_skillgroup" />
  <input type="hidden" name="attr_animal_handling_active" />
  <input type="hidden" name="attr_animal_handling_displayname" value="Animal Handling" />

  <input type="hidden" name="attr_animal_care_attributes" />
  <input type="hidden" name="attr_animal_care_specialized" value="" />
  <input type="hidden" name="attr_animal_care_rollcode" />
  <input type="hidden" name="attr_animal_care_string" />
  <input type="hidden" name="attr_animal_care_skillgroup" />
  <input type="hidden" name="attr_animal_care_active" />
  <input type="hidden" name="attr_animal_care_displayname" value="Animal Care" />

  <input type="hidden" name="attr_animal_empathy_attributes" />
  <input type="hidden" name="attr_animal_empathy_specialized" value="" />
  <input type="hidden" name="attr_animal_empathy_rollcode" />
  <input type="hidden" name="attr_animal_empathy_string" />
  <input type="hidden" name="attr_animal_empathy_skillgroup" />
  <input type="hidden" name="attr_animal_empathy_active" />
  <input type="hidden" name="attr_animal_empathy_displayname" value="Animal Empathy" />

  <input type="hidden" name="attr_search_attributes" />
  <input type="hidden" name="attr_search_specialized" value="" />
  <input type="hidden" name="attr_search_rollcode" />
  <input type="hidden" name="attr_search_string" />
  <input type="hidden" name="attr_search_skillgroup" />
  <input type="hidden" name="attr_search_active" />
  <input type="hidden" name="attr_search_displayname" value="Search" />

  <input type="hidden" name="attr_insight_attributes" />
  <input type="hidden" name="attr_insight_specialized" value="" />
  <input type="hidden" name="attr_insight_rollcode" />
  <input type="hidden" name="attr_insight_string" />
  <input type="hidden" name="attr_insight_skillgroup" />
  <input type="hidden" name="attr_insight_active" />
  <input type="hidden" name="attr_insight_displayname" value="Insight" />

  <input type="hidden" name="attr_instinct_attributes" />
  <input type="hidden" name="attr_instinct_specialized" value="" />
  <input type="hidden" name="attr_instinct_rollcode" />
  <input type="hidden" name="attr_instinct_string" />
  <input type="hidden" name="attr_instinct_skillgroup" />
  <input type="hidden" name="attr_instinct_active" />
  <input type="hidden" name="attr_instinct_displayname" value="Instinct" />

  <input type="hidden" name="attr_investigate_attributes" />
  <input type="hidden" name="attr_investigate_specialized" value="" />
  <input type="hidden" name="attr_investigate_rollcode" />
  <input type="hidden" name="attr_investigate_string" />
  <input type="hidden" name="attr_investigate_skillgroup" />
  <input type="hidden" name="attr_investigate_active" />
  <input type="hidden" name="attr_investigate_displayname" value="Investigate" />

  <input type="hidden" name="attr_empathy_attributes" />
  <input type="hidden" name="attr_empathy_specialized" value="" />
  <input type="hidden" name="attr_empathy_rollcode" />
  <input type="hidden" name="attr_empathy_string" />
  <input type="hidden" name="attr_empathy_skillgroup" />
  <input type="hidden" name="attr_empathy_active" />
  <input type="hidden" name="attr_empathy_displayname" value="Empathy" />

  <input type="hidden" name="attr_tracking_attributes" />
  <input type="hidden" name="attr_tracking_specialized" value="" />
  <input type="hidden" name="attr_tracking_rollcode" />
  <input type="hidden" name="attr_tracking_string" />
  <input type="hidden" name="attr_tracking_skillgroup" />
  <input type="hidden" name="attr_tracking_active" />
  <input type="hidden" name="attr_tracking_displayname" value="Tracking" />

  <input type="hidden" name="attr_hunting_attributes" />
  <input type="hidden" name="attr_hunting_specialized" value="" />
  <input type="hidden" name="attr_hunting_rollcode" />
  <input type="hidden" name="attr_hunting_string" />
  <input type="hidden" name="attr_hunting_skillgroup" />
  <input type="hidden" name="attr_hunting_active" />
  <input type="hidden" name="attr_hunting_displayname" value="Hunting" />

  <input type="hidden" name="attr_foraging_attributes" />
  <input type="hidden" name="attr_foraging_specialized" value="" />
  <input type="hidden" name="attr_foraging_rollcode" />
  <input type="hidden" name="attr_foraging_string" />
  <input type="hidden" name="attr_foraging_skillgroup" />
  <input type="hidden" name="attr_foraging_active" />
  <input type="hidden" name="attr_foraging_displayname" value="Foraging" />

  <input type="hidden" name="attr_scavenging_attributes" />
  <input type="hidden" name="attr_scavenging_specialized" value="" />
  <input type="hidden" name="attr_scavenging_rollcode" />
  <input type="hidden" name="attr_scavenging_string" />
  <input type="hidden" name="attr_scavenging_skillgroup" />
  <input type="hidden" name="attr_scavenging_active" />
  <input type="hidden" name="attr_scavenging_displayname" value="Scavenging" />

  <input type="hidden" name="attr_build_attributes" />
  <input type="hidden" name="attr_build_specialized" value="" />
  <input type="hidden" name="attr_build_rollcode" />
  <input type="hidden" name="attr_build_string" />
  <input type="hidden" name="attr_build_skillgroup" />
  <input type="hidden" name="attr_build_active" />
  <input type="hidden" name="attr_build_displayname" value="Build" />

  <input type="hidden" name="attr_jury_rig_attributes" />
  <input type="hidden" name="attr_jury_rig_specialized" value="" />
  <input type="hidden" name="attr_jury_rig_rollcode" />
  <input type="hidden" name="attr_jury_rig_string" />
  <input type="hidden" name="attr_jury_rig_skillgroup" />
  <input type="hidden" name="attr_jury_rig_active" />
  <input type="hidden" name="attr_jury_rig_displayname" value="Jury-Rig" />

  <input type="hidden" name="attr_repair_attributes" />
  <input type="hidden" name="attr_repair_specialized" value="" />
  <input type="hidden" name="attr_repair_rollcode" />
  <input type="hidden" name="attr_repair_string" />
  <input type="hidden" name="attr_repair_skillgroup" />
  <input type="hidden" name="attr_repair_active" />
  <input type="hidden" name="attr_repair_displayname" value="Repair" />

  <input type="hidden" name="attr_cooking_attributes" />
  <input type="hidden" name="attr_cooking_specialized" value="" />
  <input type="hidden" name="attr_cooking_rollcode" />
  <input type="hidden" name="attr_cooking_string" />
  <input type="hidden" name="attr_cooking_skillgroup" />
  <input type="hidden" name="attr_cooking_active" />
  <input type="hidden" name="attr_cooking_displayname" value="Cooking" />

  <input type="hidden" name="attr_interrogation_attributes" />
  <input type="hidden" name="attr_interrogation_specialized" value="" />
  <input type="hidden" name="attr_interrogation_rollcode" />
  <input type="hidden" name="attr_interrogation_string" />
  <input type="hidden" name="attr_interrogation_skillgroup" />
  <input type="hidden" name="attr_interrogation_active" />
  <input type="hidden" name="attr_interrogation_displayname" value="Interrogation" />

  <input type="hidden" name="attr_forensics_attributes" />
  <input type="hidden" name="attr_forensics_specialized" value="" />
  <input type="hidden" name="attr_forensics_rollcode" />
  <input type="hidden" name="attr_forensics_string" />
  <input type="hidden" name="attr_forensics_skillgroup" />
  <input type="hidden" name="attr_forensics_active" />
  <input type="hidden" name="attr_forensics_displayname" value="Forensics" />

  <input type="hidden" name="attr_sneak_attributes" />
  <input type="hidden" name="attr_sneak_specialized" value="" />
  <input type="hidden" name="attr_sneak_rollcode" />
  <input type="hidden" name="attr_sneak_string" />
  <input type="hidden" name="attr_sneak_skillgroup" />
  <input type="hidden" name="attr_sneak_active" />
  <input type="hidden" name="attr_sneak_displayname" value="Sneak" />

  <input type="hidden" name="attr_subtle_attributes" />
  <input type="hidden" name="attr_subtle_specialized" value="" />
  <input type="hidden" name="attr_subtle_rollcode" />
  <input type="hidden" name="attr_subtle_string" />
  <input type="hidden" name="attr_subtle_skillgroup" />
  <input type="hidden" name="attr_subtle_active" />
  <input type="hidden" name="attr_subtle_displayname" value="Subtle" />

  <input type="hidden" name="attr_surveillance_attributes" />
  <input type="hidden" name="attr_surveillance_specialized" value="" />
  <input type="hidden" name="attr_surveillance_rollcode" />
  <input type="hidden" name="attr_surveillance_string" />
  <input type="hidden" name="attr_surveillance_skillgroup" />
  <input type="hidden" name="attr_surveillance_active" />
  <input type="hidden" name="attr_surveillance_displayname" value="Surveillance" />

  <input type="hidden" name="attr_hide_attributes" />
  <input type="hidden" name="attr_hide_specialized" value="" />
  <input type="hidden" name="attr_hide_rollcode" />
  <input type="hidden" name="attr_hide_string" />
  <input type="hidden" name="attr_hide_skillgroup" />
  <input type="hidden" name="attr_hide_active" />
  <input type="hidden" name="attr_hide_displayname" value="Hide" />

  <input type="hidden" name="attr_athletics_attributes" />
  <input type="hidden" name="attr_athletics_specialized" value="" />
  <input type="hidden" name="attr_athletics_rollcode" />
  <input type="hidden" name="attr_athletics_string" />
  <input type="hidden" name="attr_athletics_skillgroup" />
  <input type="hidden" name="attr_athletics_active" />
  <input type="hidden" name="attr_athletics_displayname" value="Athletics" />

  <input type="hidden" name="attr_acrobatics_attributes" />
  <input type="hidden" name="attr_acrobatics_specialized" value="" />
  <input type="hidden" name="attr_acrobatics_rollcode" />
  <input type="hidden" name="attr_acrobatics_string" />
  <input type="hidden" name="attr_acrobatics_skillgroup" />
  <input type="hidden" name="attr_acrobatics_active" />
  <input type="hidden" name="attr_acrobatics_displayname" value="Acrobatics" />

  <input type="hidden" name="attr_climbing_attributes" />
  <input type="hidden" name="attr_climbing_specialized" value="" />
  <input type="hidden" name="attr_climbing_rollcode" />
  <input type="hidden" name="attr_climbing_string" />
  <input type="hidden" name="attr_climbing_skillgroup" />
  <input type="hidden" name="attr_climbing_active" />
  <input type="hidden" name="attr_climbing_displayname" value="Climbing" />

  <input type="hidden" name="attr_swimming_attributes" />
  <input type="hidden" name="attr_swimming_specialized" value="" />
  <input type="hidden" name="attr_swimming_rollcode" />
  <input type="hidden" name="attr_swimming_string" />
  <input type="hidden" name="attr_swimming_skillgroup" />
  <input type="hidden" name="attr_swimming_active" />
  <input type="hidden" name="attr_swimming_displayname" value="Swimming" />

  <input type="hidden" name="attr_lifting_attributes" />
  <input type="hidden" name="attr_lifting_specialized" value="" />
  <input type="hidden" name="attr_lifting_rollcode" />
  <input type="hidden" name="attr_lifting_string" />
  <input type="hidden" name="attr_lifting_skillgroup" />
  <input type="hidden" name="attr_lifting_active" />
  <input type="hidden" name="attr_lifting_displayname" value="Lifting" />

  <input type="hidden" name="attr_jumping_attributes" />
  <input type="hidden" name="attr_jumping_specialized" value="" />
  <input type="hidden" name="attr_jumping_rollcode" />
  <input type="hidden" name="attr_jumping_string" />
  <input type="hidden" name="attr_jumping_skillgroup" />
  <input type="hidden" name="attr_jumping_active" />
  <input type="hidden" name="attr_jumping_displayname" value="Jumping" />

  <input type="hidden" name="attr_first_aid_attributes" />
  <input type="hidden" name="attr_first_aid_specialized" value="" />
  <input type="hidden" name="attr_first_aid_rollcode" />
  <input type="hidden" name="attr_first_aid_string" />
  <input type="hidden" name="attr_first_aid_skillgroup" />
  <input type="hidden" name="attr_first_aid_active" />
  <input type="hidden" name="attr_first_aid_displayname" value="First Aid" />

  <input type="hidden" name="attr_medical_care_attributes" />
  <input type="hidden" name="attr_medical_care_specialized" value="" />
  <input type="hidden" name="attr_medical_care_rollcode" />
  <input type="hidden" name="attr_medical_care_string" />
  <input type="hidden" name="attr_medical_care_skillgroup" />
  <input type="hidden" name="attr_medical_care_active" />
  <input type="hidden" name="attr_medical_care_displayname" value="Medical Care" />

  <input type="hidden" name="attr_surgery_attributes" />
  <input type="hidden" name="attr_surgery_specialized" value="" />
  <input type="hidden" name="attr_surgery_rollcode" />
  <input type="hidden" name="attr_surgery_string" />
  <input type="hidden" name="attr_surgery_skillgroup" />
  <input type="hidden" name="attr_surgery_active" />
  <input type="hidden" name="attr_surgery_displayname" value="Surgery" />

  <input type="hidden" name="attr_psychiatry_attributes" />
  <input type="hidden" name="attr_psychiatry_specialized" value="" />
  <input type="hidden" name="attr_psychiatry_rollcode" />
  <input type="hidden" name="attr_psychiatry_string" />
  <input type="hidden" name="attr_psychiatry_skillgroup" />
  <input type="hidden" name="attr_psychiatry_active" />
  <input type="hidden" name="attr_psychiatry_displayname" value="Psychiatry" />

  <input type="hidden" name="attr_pharmacology_attributes" />
  <input type="hidden" name="attr_pharmacology_specialized" value="" />
  <input type="hidden" name="attr_pharmacology_rollcode" />
  <input type="hidden" name="attr_pharmacology_string" />
  <input type="hidden" name="attr_pharmacology_skillgroup" />
  <input type="hidden" name="attr_pharmacology_active" />
  <input type="hidden" name="attr_pharmacology_displayname" value="Pharmacology" />

  <input type="hidden" name="attr_drive_boat_attributes" />
  <input type="hidden" name="attr_drive_boat_specialized" value="" />
  <input type="hidden" name="attr_drive_boat_rollcode" />
  <input type="hidden" name="attr_drive_boat_string" />
  <input type="hidden" name="attr_drive_boat_skillgroup" />
  <input type="hidden" name="attr_drive_boat_active" />
  <input type="hidden" name="attr_drive_boat_displayname" value="Drive Boat" />

  <input type="hidden" name="attr_fishing_attributes" />
  <input type="hidden" name="attr_fishing_specialized" value="" />
  <input type="hidden" name="attr_fishing_rollcode" />
  <input type="hidden" name="attr_fishing_string" />
  <input type="hidden" name="attr_fishing_skillgroup" />
  <input type="hidden" name="attr_fishing_active" />
  <input type="hidden" name="attr_fishing_displayname" value="Fishing" />

  <input type="hidden" name="attr_sailing_attributes" />
  <input type="hidden" name="attr_sailing_specialized" value="" />
  <input type="hidden" name="attr_sailing_rollcode" />
  <input type="hidden" name="attr_sailing_string" />
  <input type="hidden" name="attr_sailing_skillgroup" />
  <input type="hidden" name="attr_sailing_active" />
  <input type="hidden" name="attr_sailing_displayname" value="Sailing" />

  <input type="hidden" name="attr_sea_navigation_attributes" />
  <input type="hidden" name="attr_sea_navigation_specialized" value="" />
  <input type="hidden" name="attr_sea_navigation_rollcode" />
  <input type="hidden" name="attr_sea_navigation_string" />
  <input type="hidden" name="attr_sea_navigation_skillgroup" />
  <input type="hidden" name="attr_sea_navigation_active" />
  <input type="hidden" name="attr_sea_navigation_displayname" value="Sea Navigation" />

  <input type="hidden" name="attr_diving_attributes" />
  <input type="hidden" name="attr_diving_specialized" value="" />
  <input type="hidden" name="attr_diving_rollcode" />
  <input type="hidden" name="attr_diving_string" />
  <input type="hidden" name="attr_diving_skillgroup" />
  <input type="hidden" name="attr_diving_active" />
  <input type="hidden" name="attr_diving_displayname" value="Diving" />

  <input type="hidden" name="attr_mechanical_attributes" />
  <input type="hidden" name="attr_mechanical_specialized" value="" />
  <input type="hidden" name="attr_mechanical_rollcode" />
  <input type="hidden" name="attr_mechanical_string" />
  <input type="hidden" name="attr_mechanical_skillgroup" />
  <input type="hidden" name="attr_mechanical_active" />
  <input type="hidden" name="attr_mechanical_displayname" value="Mechanical" />

  <input type="hidden" name="attr_welding_attributes" />
  <input type="hidden" name="attr_welding_specialized" value="" />
  <input type="hidden" name="attr_welding_rollcode" />
  <input type="hidden" name="attr_welding_string" />
  <input type="hidden" name="attr_welding_skillgroup" />
  <input type="hidden" name="attr_welding_active" />
  <input type="hidden" name="attr_welding_displayname" value="Welding" />

  <input type="hidden" name="attr_carpentry_attributes" />
  <input type="hidden" name="attr_carpentry_specialized" value="" />
  <input type="hidden" name="attr_carpentry_rollcode" />
  <input type="hidden" name="attr_carpentry_string" />
  <input type="hidden" name="attr_carpentry_skillgroup" />
  <input type="hidden" name="attr_carpentry_active" />
  <input type="hidden" name="attr_carpentry_displayname" value="Carpentry" />

  <input type="hidden" name="attr_explosives_attributes" />
  <input type="hidden" name="attr_explosives_specialized" value="" />
  <input type="hidden" name="attr_explosives_rollcode" />
  <input type="hidden" name="attr_explosives_string" />
  <input type="hidden" name="attr_explosives_skillgroup" />
  <input type="hidden" name="attr_explosives_active" />
  <input type="hidden" name="attr_explosives_displayname" value="Explosives" />

  <input type="hidden" name="attr_electronics_attributes" />
  <input type="hidden" name="attr_electronics_specialized" value="" />
  <input type="hidden" name="attr_electronics_rollcode" />
  <input type="hidden" name="attr_electronics_string" />
  <input type="hidden" name="attr_electronics_skillgroup" />
  <input type="hidden" name="attr_electronics_active" />
  <input type="hidden" name="attr_electronics_displayname" value="Electronics" />

  <input type="hidden" name="attr_gunsmithing_attributes" />
  <input type="hidden" name="attr_gunsmithing_specialized" value="" />
  <input type="hidden" name="attr_gunsmithing_rollcode" />
  <input type="hidden" name="attr_gunsmithing_string" />
  <input type="hidden" name="attr_gunsmithing_skillgroup" />
  <input type="hidden" name="attr_gunsmithing_active" />
  <input type="hidden" name="attr_gunsmithing_displayname" value="Gunsmithing" />

  <input type="hidden" name="attr_education_attributes" />
  <input type="hidden" name="attr_education_specialized" value="" />
  <input type="hidden" name="attr_education_rollcode" />
  <input type="hidden" name="attr_education_string" />
  <input type="hidden" name="attr_education_skillgroup" />
  <input type="hidden" name="attr_education_active" />
  <input type="hidden" name="attr_education_displayname" value="Education" />

  <input type="hidden" name="attr_cartography_attributes" />
  <input type="hidden" name="attr_cartography_specialized" value="" />
  <input type="hidden" name="attr_cartography_rollcode" />
  <input type="hidden" name="attr_cartography_string" />
  <input type="hidden" name="attr_cartography_skillgroup" />
  <input type="hidden" name="attr_cartography_active" />
  <input type="hidden" name="attr_cartography_displayname" value="Cartography" />

  <input type="hidden" name="attr_appraisal_attributes" />
  <input type="hidden" name="attr_appraisal_specialized" value="" />
  <input type="hidden" name="attr_appraisal_rollcode" />
  <input type="hidden" name="attr_appraisal_string" />
  <input type="hidden" name="attr_appraisal_skillgroup" />
  <input type="hidden" name="attr_appraisal_active" />
  <input type="hidden" name="attr_appraisal_displayname" value="Appraisal" />

  <input type="hidden" name="attr_engineering_attributes" />
  <input type="hidden" name="attr_engineering_specialized" value="" />
  <input type="hidden" name="attr_engineering_rollcode" />
  <input type="hidden" name="attr_engineering_string" />
  <input type="hidden" name="attr_engineering_skillgroup" />
  <input type="hidden" name="attr_engineering_active" />
  <input type="hidden" name="attr_engineering_displayname" value="Engineering" />

  <input type="hidden" name="attr_law_attributes" />
  <input type="hidden" name="attr_law_specialized" value="" />
  <input type="hidden" name="attr_law_rollcode" />
  <input type="hidden" name="attr_law_string" />
  <input type="hidden" name="attr_law_skillgroup" />
  <input type="hidden" name="attr_law_active" />
  <input type="hidden" name="attr_law_displayname" value="Law" />

  <input type="hidden" name="attr_writing_attributes" />
  <input type="hidden" name="attr_writing_specialized" value="" />
  <input type="hidden" name="attr_writing_rollcode" />
  <input type="hidden" name="attr_writing_string" />
  <input type="hidden" name="attr_writing_skillgroup" />
  <input type="hidden" name="attr_writing_active" />
  <input type="hidden" name="attr_writing_displayname" value="Writing" />

  <input type="hidden" name="attr_linguistics_attributes" />
  <input type="hidden" name="attr_linguistics_specialized" value="" />
  <input type="hidden" name="attr_linguistics_rollcode" />
  <input type="hidden" name="attr_linguistics_string" />
  <input type="hidden" name="attr_linguistics_skillgroup" />
  <input type="hidden" name="attr_linguistics_active" />
  <input type="hidden" name="attr_linguistics_displayname" value="Linguistics" />

  <input type="hidden" name="attr_astronomy_attributes" />
  <input type="hidden" name="attr_astronomy_specialized" value="" />
  <input type="hidden" name="attr_astronomy_rollcode" />
  <input type="hidden" name="attr_astronomy_string" />
  <input type="hidden" name="attr_astronomy_skillgroup" />
  <input type="hidden" name="attr_astronomy_active" />
  <input type="hidden" name="attr_astronomy_displayname" value="Astronomy" />

  <input type="hidden" name="attr_biology_attributes" />
  <input type="hidden" name="attr_biology_specialized" value="" />
  <input type="hidden" name="attr_biology_rollcode" />
  <input type="hidden" name="attr_biology_string" />
  <input type="hidden" name="attr_biology_skillgroup" />
  <input type="hidden" name="attr_biology_active" />
  <input type="hidden" name="attr_biology_displayname" value="Biology" />

  <input type="hidden" name="attr_mathematics_attributes" />
  <input type="hidden" name="attr_mathematics_specialized" value="" />
  <input type="hidden" name="attr_mathematics_rollcode" />
  <input type="hidden" name="attr_mathematics_string" />
  <input type="hidden" name="attr_mathematics_skillgroup" />
  <input type="hidden" name="attr_mathematics_active" />
  <input type="hidden" name="attr_mathematics_displayname" value="Mathematics" />

  <input type="hidden" name="attr_chemistry_attributes" />
  <input type="hidden" name="attr_chemistry_specialized" value="" />
  <input type="hidden" name="attr_chemistry_rollcode" />
  <input type="hidden" name="attr_chemistry_string" />
  <input type="hidden" name="attr_chemistry_skillgroup" />
  <input type="hidden" name="attr_chemistry_active" />
  <input type="hidden" name="attr_chemistry_displayname" value="Chemistry" />

  <input type="hidden" name="attr_physics_attributes" />
  <input type="hidden" name="attr_physics_specialized" value="" />
  <input type="hidden" name="attr_physics_rollcode" />
  <input type="hidden" name="attr_physics_string" />
  <input type="hidden" name="attr_physics_skillgroup" />
  <input type="hidden" name="attr_physics_active" />
  <input type="hidden" name="attr_physics_displayname" value="Physics" />

  <input type="hidden" name="attr_spycraft_attributes" />
  <input type="hidden" name="attr_spycraft_specialized" value="" />
  <input type="hidden" name="attr_spycraft_rollcode" />
  <input type="hidden" name="attr_spycraft_string" />
  <input type="hidden" name="attr_spycraft_skillgroup" />
  <input type="hidden" name="attr_spycraft_active" />
  <input type="hidden" name="attr_spycraft_displayname" value="Spycraft" />

  <input type="hidden" name="attr_air_navigation_attributes" />
  <input type="hidden" name="attr_air_navigation_specialized" value="" />
  <input type="hidden" name="attr_air_navigation_rollcode" />
  <input type="hidden" name="attr_air_navigation_string" />
  <input type="hidden" name="attr_air_navigation_skillgroup" />
  <input type="hidden" name="attr_air_navigation_active" />
  <input type="hidden" name="attr_air_navigation_displayname" value="Air Navigation" />

  <input type="hidden" name="attr_control_drone_attributes" />
  <input type="hidden" name="attr_control_drone_specialized" value="" />
  <input type="hidden" name="attr_control_drone_rollcode" />
  <input type="hidden" name="attr_control_drone_string" />
  <input type="hidden" name="attr_control_drone_skillgroup" />
  <input type="hidden" name="attr_control_drone_active" />
  <input type="hidden" name="attr_control_drone_displayname" value="Control Drone" />

  <input type="hidden" name="attr_fly_helicopter_attributes" />
  <input type="hidden" name="attr_fly_helicopter_specialized" value="" />
  <input type="hidden" name="attr_fly_helicopter_rollcode" />
  <input type="hidden" name="attr_fly_helicopter_string" />
  <input type="hidden" name="attr_fly_helicopter_skillgroup" />
  <input type="hidden" name="attr_fly_helicopter_active" />
  <input type="hidden" name="attr_fly_helicopter_displayname" value="Fly Helicopter" />

  <input type="hidden" name="attr_fly_plane_attributes" />
  <input type="hidden" name="attr_fly_plane_specialized" value="" />
  <input type="hidden" name="attr_fly_plane_rollcode" />
  <input type="hidden" name="attr_fly_plane_string" />
  <input type="hidden" name="attr_fly_plane_skillgroup" />
  <input type="hidden" name="attr_fly_plane_active" />
  <input type="hidden" name="attr_fly_plane_displayname" value="Fly Plane" />

  <input type="hidden" name="attr_drive_semi_attributes" />
  <input type="hidden" name="attr_drive_semi_specialized" value="" />
  <input type="hidden" name="attr_drive_semi_rollcode" />
  <input type="hidden" name="attr_drive_semi_string" />
  <input type="hidden" name="attr_drive_semi_skillgroup" />
  <input type="hidden" name="attr_drive_semi_active" />
  <input type="hidden" name="attr_drive_semi_displayname" value="Drive Semi" />

  <input type="hidden" name="attr_drive_motorcycle_attributes" />
  <input type="hidden" name="attr_drive_motorcycle_specialized" value="" />
  <input type="hidden" name="attr_drive_motorcycle_rollcode" />
  <input type="hidden" name="attr_drive_motorcycle_string" />
  <input type="hidden" name="attr_drive_motorcycle_skillgroup" />
  <input type="hidden" name="attr_drive_motorcycle_active" />
  <input type="hidden" name="attr_drive_motorcycle_displayname" value="Drive Motorcycle" />

  <input type="hidden" name="attr_drive_car_attributes" />
  <input type="hidden" name="attr_drive_car_specialized" value="" />
  <input type="hidden" name="attr_drive_car_rollcode" />
  <input type="hidden" name="attr_drive_car_string" />
  <input type="hidden" name="attr_drive_car_skillgroup" />
  <input type="hidden" name="attr_drive_car_active" />
  <input type="hidden" name="attr_drive_car_displayname" value="Drive Car" />

  <input type="hidden" name="attr_ride_bicycle_attributes" />
  <input type="hidden" name="attr_ride_bicycle_specialized" value="" />
  <input type="hidden" name="attr_ride_bicycle_rollcode" />
  <input type="hidden" name="attr_ride_bicycle_string" />
  <input type="hidden" name="attr_ride_bicycle_skillgroup" />
  <input type="hidden" name="attr_ride_bicycle_active" />
  <input type="hidden" name="attr_ride_bicycle_displayname" value="Ride Bicycle" />

  <input type="hidden" name="attr_command_attributes" />
  <input type="hidden" name="attr_command_specialized" value="" />
  <input type="hidden" name="attr_command_rollcode" />
  <input type="hidden" name="attr_command_string" />
  <input type="hidden" name="attr_command_skillgroup" />
  <input type="hidden" name="attr_command_active" />
  <input type="hidden" name="attr_command_displayname" value="Command" />

  <input type="hidden" name="attr_hand_signals_attributes" />
  <input type="hidden" name="attr_hand_signals_specialized" value="" />
  <input type="hidden" name="attr_hand_signals_rollcode" />
  <input type="hidden" name="attr_hand_signals_string" />
  <input type="hidden" name="attr_hand_signals_skillgroup" />
  <input type="hidden" name="attr_hand_signals_active" />
  <input type="hidden" name="attr_hand_signals_displayname" value="Hand Signals" />

  <input type="hidden" name="attr_tactics_attributes" />
  <input type="hidden" name="attr_tactics_specialized" value="" />
  <input type="hidden" name="attr_tactics_rollcode" />
  <input type="hidden" name="attr_tactics_string" />
  <input type="hidden" name="attr_tactics_skillgroup" />
  <input type="hidden" name="attr_tactics_active" />
  <input type="hidden" name="attr_tactics_displayname" value="Tactics" />

  <input type="hidden" name="attr_camouflage_attributes" />
  <input type="hidden" name="attr_camouflage_specialized" value="" />
  <input type="hidden" name="attr_camouflage_rollcode" />
  <input type="hidden" name="attr_camouflage_string" />
  <input type="hidden" name="attr_camouflage_skillgroup" />
  <input type="hidden" name="attr_camouflage_active" />
  <input type="hidden" name="attr_camouflage_displayname" value="Camouflage" />

  <input type="hidden" name="attr_hardware_attributes" />
  <input type="hidden" name="attr_hardware_specialized" value="" />
  <input type="hidden" name="attr_hardware_rollcode" />
  <input type="hidden" name="attr_hardware_string" />
  <input type="hidden" name="attr_hardware_skillgroup" />
  <input type="hidden" name="attr_hardware_active" />
  <input type="hidden" name="attr_hardware_displayname" value="Hardware" />

  <input type="hidden" name="attr_hacking_attributes" />
  <input type="hidden" name="attr_hacking_specialized" value="" />
  <input type="hidden" name="attr_hacking_rollcode" />
  <input type="hidden" name="attr_hacking_string" />
  <input type="hidden" name="attr_hacking_skillgroup" />
  <input type="hidden" name="attr_hacking_active" />
  <input type="hidden" name="attr_hacking_displayname" value="Hacking" />

  <input type="hidden" name="attr_programming_attributes" />
  <input type="hidden" name="attr_programming_specialized" value="" />
  <input type="hidden" name="attr_programming_rollcode" />
  <input type="hidden" name="attr_programming_string" />
  <input type="hidden" name="attr_programming_skillgroup" />
  <input type="hidden" name="attr_programming_active" />
  <input type="hidden" name="attr_programming_displayname" value="Programming" />

  <input type="hidden" name="attr_computer_use_attributes" />
  <input type="hidden" name="attr_computer_use_specialized" value="" />
  <input type="hidden" name="attr_computer_use_rollcode" />
  <input type="hidden" name="attr_computer_use_string" />
  <input type="hidden" name="attr_computer_use_skillgroup" />
  <input type="hidden" name="attr_computer_use_active" />
  <input type="hidden" name="attr_computer_use_displayname" value="Computer Use" />

  <input type="hidden" name="attr_handgun_attributes" />
  <input type="hidden" name="attr_handgun_specialized" value="" />
  <input type="hidden" name="attr_handgun_rollcode" />
  <input type="hidden" name="attr_handgun_string" />
  <input type="hidden" name="attr_handgun_skillgroup" />
  <input type="hidden" name="attr_handgun_active" />
  <input type="hidden" name="attr_handgun_displayname" value="Handgun" />

  <input type="hidden" name="attr_automatic_handgun_attributes" />
  <input type="hidden" name="attr_automatic_handgun_specialized" value="" />
  <input type="hidden" name="attr_automatic_handgun_rollcode" />
  <input type="hidden" name="attr_automatic_handgun_string" />
  <input type="hidden" name="attr_automatic_handgun_skillgroup" />
  <input type="hidden" name="attr_automatic_handgun_active" />
  <input type="hidden" name="attr_automatic_handgun_displayname" value="Automatic Handgun" />

  <input type="hidden" name="attr_sawed_off_shotgun_attributes" />
  <input type="hidden" name="attr_sawed_off_shotgun_specialized" value="" />
  <input type="hidden" name="attr_sawed_off_shotgun_rollcode" />
  <input type="hidden" name="attr_sawed_off_shotgun_string" />
  <input type="hidden" name="attr_sawed_off_shotgun_skillgroup" />
  <input type="hidden" name="attr_sawed_off_shotgun_active" />
  <input type="hidden" name="attr_sawed_off_shotgun_displayname" value="Sawed-off Shotgun" />

  <input type="hidden" name="attr_rifle_attributes" />
  <input type="hidden" name="attr_rifle_specialized" value="" />
  <input type="hidden" name="attr_rifle_rollcode" />
  <input type="hidden" name="attr_rifle_string" />
  <input type="hidden" name="attr_rifle_skillgroup" />
  <input type="hidden" name="attr_rifle_active" />
  <input type="hidden" name="attr_rifle_displayname" value="Rifle" />

  <input type="hidden" name="attr_automatic_rifle_attributes" />
  <input type="hidden" name="attr_automatic_rifle_specialized" value="" />
  <input type="hidden" name="attr_automatic_rifle_rollcode" />
  <input type="hidden" name="attr_automatic_rifle_string" />
  <input type="hidden" name="attr_automatic_rifle_skillgroup" />
  <input type="hidden" name="attr_automatic_rifle_active" />
  <input type="hidden" name="attr_automatic_rifle_displayname" value="Automatic Rifle" />

  <input type="hidden" name="attr_sniper_rifle_attributes" />
  <input type="hidden" name="attr_sniper_rifle_specialized" value="" />
  <input type="hidden" name="attr_sniper_rifle_rollcode" />
  <input type="hidden" name="attr_sniper_rifle_string" />
  <input type="hidden" name="attr_sniper_rifle_skillgroup" />
  <input type="hidden" name="attr_sniper_rifle_active" />
  <input type="hidden" name="attr_sniper_rifle_displayname" value="Sniper Rifle" />

  <input type="hidden" name="attr_shotgun_attributes" />
  <input type="hidden" name="attr_shotgun_specialized" value="" />
  <input type="hidden" name="attr_shotgun_rollcode" />
  <input type="hidden" name="attr_shotgun_string" />
  <input type="hidden" name="attr_shotgun_skillgroup" />
  <input type="hidden" name="attr_shotgun_active" />
  <input type="hidden" name="attr_shotgun_displayname" value="Shotgun" />

  <input type="hidden" name="attr_brawling_attributes" />
  <input type="hidden" name="attr_brawling_specialized" value="" />
  <input type="hidden" name="attr_brawling_rollcode" />
  <input type="hidden" name="attr_brawling_string" />
  <input type="hidden" name="attr_brawling_skillgroup" />
  <input type="hidden" name="attr_brawling_active" />
  <input type="hidden" name="attr_brawling_displayname" value="Brawling" />

  <input type="hidden" name="attr_push_attributes" />
  <input type="hidden" name="attr_push_specialized" value="" />
  <input type="hidden" name="attr_push_rollcode" />
  <input type="hidden" name="attr_push_string" />
  <input type="hidden" name="attr_push_skillgroup" />
  <input type="hidden" name="attr_push_active" />
  <input type="hidden" name="attr_push_displayname" value="Push" />

  <input type="hidden" name="attr_wrestling_attributes" />
  <input type="hidden" name="attr_wrestling_specialized" value="" />
  <input type="hidden" name="attr_wrestling_rollcode" />
  <input type="hidden" name="attr_wrestling_string" />
  <input type="hidden" name="attr_wrestling_skillgroup" />
  <input type="hidden" name="attr_wrestling_active" />
  <input type="hidden" name="attr_wrestling_displayname" value="Wrestling" />

  <input type="hidden" name="attr_aikido_attributes" />
  <input type="hidden" name="attr_aikido_specialized" value="" />
  <input type="hidden" name="attr_aikido_rollcode" />
  <input type="hidden" name="attr_aikido_string" />
  <input type="hidden" name="attr_aikido_skillgroup" />
  <input type="hidden" name="attr_aikido_active" />
  <input type="hidden" name="attr_aikido_displayname" value="Aikido" />

  <input type="hidden" name="attr_boxing_attributes" />
  <input type="hidden" name="attr_boxing_specialized" value="" />
  <input type="hidden" name="attr_boxing_rollcode" />
  <input type="hidden" name="attr_boxing_string" />
  <input type="hidden" name="attr_boxing_skillgroup" />
  <input type="hidden" name="attr_boxing_active" />
  <input type="hidden" name="attr_boxing_displayname" value="Boxing" />

  <input type="hidden" name="attr_capoeira_attributes" />
  <input type="hidden" name="attr_capoeira_specialized" value="" />
  <input type="hidden" name="attr_capoeira_rollcode" />
  <input type="hidden" name="attr_capoeira_string" />
  <input type="hidden" name="attr_capoeira_skillgroup" />
  <input type="hidden" name="attr_capoeira_active" />
  <input type="hidden" name="attr_capoeira_displayname" value="Capoeira" />

  <input type="hidden" name="attr_jeet_kune_do_attributes" />
  <input type="hidden" name="attr_jeet_kune_do_specialized" value="" />
  <input type="hidden" name="attr_jeet_kune_do_rollcode" />
  <input type="hidden" name="attr_jeet_kune_do_string" />
  <input type="hidden" name="attr_jeet_kune_do_skillgroup" />
  <input type="hidden" name="attr_jeet_kune_do_active" />
  <input type="hidden" name="attr_jeet_kune_do_displayname" value="Jeet Kune Do" />

  <input type="hidden" name="attr_jiu_jitsu_attributes" />
  <input type="hidden" name="attr_jiu_jitsu_specialized" value="" />
  <input type="hidden" name="attr_jiu_jitsu_rollcode" />
  <input type="hidden" name="attr_jiu_jitsu_string" />
  <input type="hidden" name="attr_jiu_jitsu_skillgroup" />
  <input type="hidden" name="attr_jiu_jitsu_active" />
  <input type="hidden" name="attr_jiu_jitsu_displayname" value="Jiu-Jitsu" />

  <input type="hidden" name="attr_judo_attributes" />
  <input type="hidden" name="attr_judo_specialized" value="" />
  <input type="hidden" name="attr_judo_rollcode" />
  <input type="hidden" name="attr_judo_string" />
  <input type="hidden" name="attr_judo_skillgroup" />
  <input type="hidden" name="attr_judo_active" />
  <input type="hidden" name="attr_judo_displayname" value="Judo" />

  <input type="hidden" name="attr_karate_attributes" />
  <input type="hidden" name="attr_karate_specialized" value="" />
  <input type="hidden" name="attr_karate_rollcode" />
  <input type="hidden" name="attr_karate_string" />
  <input type="hidden" name="attr_karate_skillgroup" />
  <input type="hidden" name="attr_karate_active" />
  <input type="hidden" name="attr_karate_displayname" value="Karate" />

  <input type="hidden" name="attr_krav_maga_attributes" />
  <input type="hidden" name="attr_krav_maga_specialized" value="" />
  <input type="hidden" name="attr_krav_maga_rollcode" />
  <input type="hidden" name="attr_krav_maga_string" />
  <input type="hidden" name="attr_krav_maga_skillgroup" />
  <input type="hidden" name="attr_krav_maga_active" />
  <input type="hidden" name="attr_krav_maga_displayname" value="Krav Maga" />

  <input type="hidden" name="attr_muay_thai_attributes" />
  <input type="hidden" name="attr_muay_thai_specialized" value="" />
  <input type="hidden" name="attr_muay_thai_rollcode" />
  <input type="hidden" name="attr_muay_thai_string" />
  <input type="hidden" name="attr_muay_thai_skillgroup" />
  <input type="hidden" name="attr_muay_thai_active" />
  <input type="hidden" name="attr_muay_thai_displayname" value="Muay Thai" />

  <input type="hidden" name="attr_sambo_attributes" />
  <input type="hidden" name="attr_sambo_specialized" value="" />
  <input type="hidden" name="attr_sambo_rollcode" />
  <input type="hidden" name="attr_sambo_string" />
  <input type="hidden" name="attr_sambo_skillgroup" />
  <input type="hidden" name="attr_sambo_active" />
  <input type="hidden" name="attr_sambo_displayname" value="Sambo" />

  <input type="hidden" name="attr_savate_attributes" />
  <input type="hidden" name="attr_savate_specialized" value="" />
  <input type="hidden" name="attr_savate_rollcode" />
  <input type="hidden" name="attr_savate_string" />
  <input type="hidden" name="attr_savate_skillgroup" />
  <input type="hidden" name="attr_savate_active" />
  <input type="hidden" name="attr_savate_displayname" value="Savate" />

  <input type="hidden" name="attr_taekwondo_attributes" />
  <input type="hidden" name="attr_taekwondo_specialized" value="" />
  <input type="hidden" name="attr_taekwondo_rollcode" />
  <input type="hidden" name="attr_taekwondo_string" />
  <input type="hidden" name="attr_taekwondo_skillgroup" />
  <input type="hidden" name="attr_taekwondo_active" />
  <input type="hidden" name="attr_taekwondo_displayname" value="Taekwondo" />

  <input type="hidden" name="attr_melee_weapon_attributes" />
  <input type="hidden" name="attr_melee_weapon_specialized" value="" />
  <input type="hidden" name="attr_melee_weapon_rollcode" />
  <input type="hidden" name="attr_melee_weapon_string" />
  <input type="hidden" name="attr_melee_weapon_skillgroup" />
  <input type="hidden" name="attr_melee_weapon_active" />
  <input type="hidden" name="attr_melee_weapon_displayname" value="Melee Weapon" />

  <input type="hidden" name="attr_improvised_weapon_attributes" />
  <input type="hidden" name="attr_improvised_weapon_specialized" value="" />
  <input type="hidden" name="attr_improvised_weapon_rollcode" />
  <input type="hidden" name="attr_improvised_weapon_string" />
  <input type="hidden" name="attr_improvised_weapon_skillgroup" />
  <input type="hidden" name="attr_improvised_weapon_active" />
  <input type="hidden" name="attr_improvised_weapon_displayname" value="Improvised Weapon" />

  <input type="hidden" name="attr_electroshock_attributes" />
  <input type="hidden" name="attr_electroshock_specialized" value="" />
  <input type="hidden" name="attr_electroshock_rollcode" />
  <input type="hidden" name="attr_electroshock_string" />
  <input type="hidden" name="attr_electroshock_skillgroup" />
  <input type="hidden" name="attr_electroshock_active" />
  <input type="hidden" name="attr_electroshock_displayname" value="Electroshock" />

  <input type="hidden" name="attr_crossbow_attributes" />
  <input type="hidden" name="attr_crossbow_specialized" value="" />
  <input type="hidden" name="attr_crossbow_rollcode" />
  <input type="hidden" name="attr_crossbow_string" />
  <input type="hidden" name="attr_crossbow_skillgroup" />
  <input type="hidden" name="attr_crossbow_active" />
  <input type="hidden" name="attr_crossbow_displayname" value="Crossbow" />

  <input type="hidden" name="attr_bow_attributes" />
  <input type="hidden" name="attr_bow_specialized" value="" />
  <input type="hidden" name="attr_bow_rollcode" />
  <input type="hidden" name="attr_bow_string" />
  <input type="hidden" name="attr_bow_skillgroup" />
  <input type="hidden" name="attr_bow_active" />
  <input type="hidden" name="attr_bow_displayname" value="Bow" />

  <input type="hidden" name="attr_vehicle_dodge_attributes" />
  <input type="hidden" name="attr_vehicle_dodge_specialized" value="" />
  <input type="hidden" name="attr_vehicle_dodge_rollcode" />
  <input type="hidden" name="attr_vehicle_dodge_string" />
  <input type="hidden" name="attr_vehicle_dodge_skillgroup" />
  <input type="hidden" name="attr_vehicle_dodge_active" />
  <input type="hidden" name="attr_vehicle_dodge_displayname" value="Dodge" />

  <input type="hidden" name="attr_vehicle_avoid_attributes" />
  <input type="hidden" name="attr_vehicle_avoid_specialized" value="" />
  <input type="hidden" name="attr_vehicle_avoid_rollcode" />
  <input type="hidden" name="attr_vehicle_avoid_string" />
  <input type="hidden" name="attr_vehicle_avoid_skillgroup" />
  <input type="hidden" name="attr_vehicle_avoid_active" />
  <input type="hidden" name="attr_vehicle_avoid_displayname" value="Avoid" />

  <input type="hidden" name="attr_vehicle_ram_attributes" />
  <input type="hidden" name="attr_vehicle_ram_specialized" value="" />
  <input type="hidden" name="attr_vehicle_ram_rollcode" />
  <input type="hidden" name="attr_vehicle_ram_string" />
  <input type="hidden" name="attr_vehicle_ram_skillgroup" />
  <input type="hidden" name="attr_vehicle_ram_active" />
  <input type="hidden" name="attr_vehicle_ram_displayname" value="Ram" />

  <input type="hidden" name="attr_vehicle_keep_control_attributes" />
  <input type="hidden" name="attr_vehicle_keep_control_specialized" value="" />
  <input type="hidden" name="attr_vehicle_keep_control_rollcode" />
  <input type="hidden" name="attr_vehicle_keep_control_string" />
  <input type="hidden" name="attr_vehicle_keep_control_skillgroup" />
  <input type="hidden" name="attr_vehicle_keep_control_active" />
  <input type="hidden" name="attr_vehicle_keep_control_displayname" value="Keep Control" />

  <input type="hidden" name="attr_vehicle_impede_attributes" />
  <input type="hidden" name="attr_vehicle_impede_specialized" value="" />
  <input type="hidden" name="attr_vehicle_impede_rollcode" />
  <input type="hidden" name="attr_vehicle_impede_string" />
  <input type="hidden" name="attr_vehicle_impede_skillgroup" />
  <input type="hidden" name="attr_vehicle_impede_active" />
  <input type="hidden" name="attr_vehicle_impede_displayname" value="Impede" />

  <input type="hidden" name="attr_vehicle_obstruct_attributes" />
  <input type="hidden" name="attr_vehicle_obstruct_specialized" value="" />
  <input type="hidden" name="attr_vehicle_obstruct_rollcode" />
  <input type="hidden" name="attr_vehicle_obstruct_string" />
  <input type="hidden" name="attr_vehicle_obstruct_skillgroup" />
  <input type="hidden" name="attr_vehicle_obstruct_active" />
  <input type="hidden" name="attr_vehicle_obstruct_displayname" value="Obstruct" />

  <input type="hidden" name="attr_vehicle_speed_attributes" />
  <input type="hidden" name="attr_vehicle_speed_specialized" value="" />
  <input type="hidden" name="attr_vehicle_speed_rollcode" />
  <input type="hidden" name="attr_vehicle_speed_string" />
  <input type="hidden" name="attr_vehicle_speed_skillgroup" />
  <input type="hidden" name="attr_vehicle_speed_active" />
  <input type="hidden" name="attr_vehicle_speed_displayname" value="Speed" />

  <input type="hidden" name="attr_vehicle_stunt_attributes" />
  <input type="hidden" name="attr_vehicle_stunt_specialized" value="" />
  <input type="hidden" name="attr_vehicle_stunt_rollcode" />
  <input type="hidden" name="attr_vehicle_stunt_string" />
  <input type="hidden" name="attr_vehicle_stunt_skillgroup" />
  <input type="hidden" name="attr_vehicle_stunt_active" />
  <input type="hidden" name="attr_vehicle_stunt_displayname" value="Stunt" />

  <input type="hidden" name="attr_slingshot_attributes" />
  <input type="hidden" name="attr_slingshot_specialized" value="" />
  <input type="hidden" name="attr_slingshot_rollcode" />
  <input type="hidden" name="attr_slingshot_string" />
  <input type="hidden" name="attr_slingshot_skillgroup" />
  <input type="hidden" name="attr_slingshot_active" />
  <input type="hidden" name="attr_slingshot_displayname" value="Slingshot" />

  <input type="hidden" name="attr_thrown_attributes" />
  <input type="hidden" name="attr_thrown_specialized" value="" />
  <input type="hidden" name="attr_thrown_rollcode" />
  <input type="hidden" name="attr_thrown_string" />
  <input type="hidden" name="attr_thrown_skillgroup" />
  <input type="hidden" name="attr_thrown_active" />
  <input type="hidden" name="attr_thrown_displayname" value="Thrown" />

  <input type="hidden" name="attr_firearm1_attr" value="None" />
  <input type="hidden" name="attr_firearm1_weapon" value="None" />
  <input type="hidden" name="attr_firearm1_rollcode" value="0d6"/>
  <input type="hidden" name="attr_firearm1_string" value="0D"/>
  <input type="hidden" name="attr_firearm1_actual" value="0D"/>
  <input type="hidden" name="attr_firearm1_damage" value="0D"/>
  <input type="hidden" name="attr_firearm1_damage_rollcode" value="0d6"/>
  <input type="hidden" name="attr_firearm1_min_damage" />
  <input type="hidden" name="attr_firearm1_ammo" />
  <input type="hidden" name="attr_firearm1_ammo_max" />
  <input type="hidden" name="attr_firearm1_ammo_display" />
  <input type="hidden" name="attr_firearm1_point_blank" />
  <input type="hidden" name="attr_firearm1_short" />
  <input type="hidden" name="attr_firearm1_medium" />
  <input type="hidden" name="attr_firearm1_long" />
  <input type="hidden" name="attr_firearm1_extreme" />
  <input type="hidden" name="attr_firearm1_special" />

  <input type="hidden" name="attr_firearm2_attr" value="None" />
  <input type="hidden" name="attr_firearm2_weapon" value="None" />
  <input type="hidden" name="attr_firearm2_rollcode" value="0d6"/>
  <input type="hidden" name="attr_firearm2_string" value="0D"/>
  <input type="hidden" name="attr_firearm2_actual" value="0D"/>
  <input type="hidden" name="attr_firearm2_damage" value="0D"/>
  <input type="hidden" name="attr_firearm2_damage_rollcode" value="0d6"/>
  <input type="hidden" name="attr_firearm2_min_damage" />
  <input type="hidden" name="attr_firearm2_ammo" />
  <input type="hidden" name="attr_firearm2_ammo_max" />
  <input type="hidden" name="attr_firearm2_ammo_display" />
  <input type="hidden" name="attr_firearm2_point_blank" />
  <input type="hidden" name="attr_firearm2_short" />
  <input type="hidden" name="attr_firearm2_medium" />
  <input type="hidden" name="attr_firearm2_long" />
  <input type="hidden" name="attr_firearm2_extreme" />
  <input type="hidden" name="attr_firearm2_special" />

  <input type="hidden" name="attr_firearm3_attr" value="None" />
  <input type="hidden" name="attr_firearm3_weapon" value="None" />
  <input type="hidden" name="attr_firearm3_rollcode" value="0d6"/>
  <input type="hidden" name="attr_firearm3_string" value="0D"/>
  <input type="hidden" name="attr_firearm3_actual" value="0D"/>
  <input type="hidden" name="attr_firearm3_damage" value="0D"/>
  <input type="hidden" name="attr_firearm3_damage_rollcode" value="0d6"/>
  <input type="hidden" name="attr_firearm3_min_damage" />
  <input type="hidden" name="attr_firearm3_ammo" />
  <input type="hidden" name="attr_firearm3_ammo_max" />
  <input type="hidden" name="attr_firearm3_ammo_display" />
  <input type="hidden" name="attr_firearm3_point_blank" />
  <input type="hidden" name="attr_firearm3_short" />
  <input type="hidden" name="attr_firearm3_medium" />
  <input type="hidden" name="attr_firearm3_long" />
  <input type="hidden" name="attr_firearm3_extreme" />
  <input type="hidden" name="attr_firearm3_special" />

  <input type="hidden" name="attr_ranged_attr" value="None" />
  <input type="hidden" name="attr_ranged_weapon" value="None" />
  <input type="hidden" name="attr_ranged_rollcode" value="0d6"/>
  <input type="hidden" name="attr_ranged_string" value="0D"/>
  <input type="hidden" name="attr_ranged_actual" value="0D"/>
  <input type="hidden" name="attr_ranged_damage" value="0D"/>
  <input type="hidden" name="attr_ranged_damage_rollcode" value="0d6"/>
  <input type="hidden" name="attr_ranged_min_damage" />
  <input type="hidden" name="attr_ranged_point_blank" />
  <input type="hidden" name="attr_ranged_short" />
  <input type="hidden" name="attr_ranged_medium" />
  <input type="hidden" name="attr_ranged_long" />
  <input type="hidden" name="attr_ranged_extreme" />
  <input type="hidden" name="attr_ranged_special" />

  <input type="hidden" name="attr_armed_attr" value="None" />
  <input type="hidden" name="attr_armed_weapon" value="None" />
  <input type="hidden" name="attr_armed_rollcode" value="0d6"/>
  <input type="hidden" name="attr_armed_string" value="0D"/>
  <input type="hidden" name="attr_armed_actual" value="0D"/>
  <input type="hidden" name="attr_armed_damage" value="0D"/>
  <input type="hidden" name="attr_armed_damage_rollcode" value="0d6"/>
  <input type="hidden" name="attr_armed_min_damage" />
  <input type="hidden" name="attr_armed_special" />

  <input type="hidden" name="attr_unarmed_attr" value="None" />
  <input type="hidden" name="attr_unarmed_weapon" value="None" />
  <input type="hidden" name="attr_unarmed_rollcode" value="0d6"/>
  <input type="hidden" name="attr_unarmed_string" value="0D"/>
  <input type="hidden" name="attr_unarmed_actual" value="0D"/>
  <input type="hidden" name="attr_unarmed_damage" value="0D"/>
  <input type="hidden" name="attr_unarmed_damage_rollcode" value="0d6"/>
  <input type="hidden" name="attr_unarmed_min_damage" />
  <input type="hidden" name="attr_unarmed_special" />

  <input type="hidden" name="attr_base_move" value="30"/>
  <input type="hidden" name="attr_base_run" value="30"/>
  <input type="hidden" name="attr_encum_penalty_move" value="0"/>
  <input type="hidden" name="attr_encum_penalty_run" value="0"/>
  <input type="hidden" name="attr_conditions_penalty_move" value="0"/>
  <input type="hidden" name="attr_conditions_penalty_run" value="0"/>
  <input type="hidden" name="attr_current_move" value="30"/>
  <input type="hidden" name="attr_current_run" value="30"/>

  <input type="hidden" name="attr_advantage" value="0"/>
  <input type="hidden" name="attr_whisper_toggle" value="0"/>
  <input type="hidden" name="attr_has_run" value="0"/>
  <input type="hidden" name="attr_has_moved" value="0"/>
  <input type="hidden" name="attr_is_auto_burst" value="0"/>
  <input type="hidden" name="attr_status" value="Conscious"/>

  <input type="hidden" name="attr_equipped_weight_total" value="0"/>
  <input type="hidden" name="attr_character_weight" value="0"/>
  <input type="hidden" name="attr_encumbrance_visible" value="0"/>
  <input type="hidden" name="attr_use_encumbrance" value="1"/>
  <input type="hidden" name="attr_character_wealth" value="1"/>

  <input type="hidden" name="attr_melee_attack_1_name" />
  <input type="hidden" name="attr_melee_attack_1_skill" />
  <input type="hidden" name="attr_melee_attack_1_damage" />
  <input type="hidden" name="attr_attack_1_min_damage" />
  <input type="hidden" name="attr_melee_attack_1_special" />

  <input type="hidden" name="attr_melee_attack_2_name" />
  <input type="hidden" name="attr_melee_attack_2_skill" />
  <input type="hidden" name="attr_melee_attack_2_damage" />
  <input type="hidden" name="attr_attack_2_min_damage" />
  <input type="hidden" name="attr_melee_attack_2_special" />

  <input type="hidden" name="attr_melee_attack_3_name" />
  <input type="hidden" name="attr_melee_attack_3_skill" />
  <input type="hidden" name="attr_melee_attack_3_damage" />
  <input type="hidden" name="attr_attack_3_min_damage" />
  <input type="hidden" name="attr_melee_attack_3_special" />

  <input type="hidden" name="attr_num_declared_actions" value="1" />
  <input type="hidden" name="attr_actions_locked" value="0" />
  <input type="hidden" name="attr_character_immunities"/>

  <input type="hidden" name="attr_armor_bonus" />
  <input type="hidden" name="attr_armor_penalty" />

  <input type="hidden" name="attr_head_armor_bonus" />
  <input type="hidden" name="attr_body_armor_bonus" />
  <input type="hidden" name="attr_shield_bonus" />

  <input type="hidden" name="attr_head_armor_penalty" />
  <input type="hidden" name="attr_body_armor_penalty" />
  <input type="hidden" name="attr_shield_penalty" />

  <input type="hidden" name="attr_blocks2H" />

  <input type="hidden" name="attr_choose_background_activate_aviation" value="0" />
  <input type="hidden" name="attr_choose_background_activate_ma" value="0" />
  <input type="hidden" name="attr_choose_background_activate_science" value="0" />
  <input type="hidden" name="attr_choose_background_activate_knowledge" value="0" />

  <input type="hidden" name="attr_choose_origin_activate_knowledge" value="0" />
  <input type="hidden" name="attr_choose_origin_activate_ma" value="0" />

  <input type="hidden" name="attr_choose_background_specialize_performance" value="0" />
  <input type="hidden" name="attr_choose_background_specialize_physical" value="0" />
  <input type="hidden" name="attr_choose_background_specialize_technical" value="0" />

  <input type="hidden" name="attr_choose_origin_specialize_physical" value="0" />
  <input type="hidden" name="attr_choose_origin_specialize_technical" value="0" />

  <input type="hidden" name="attr_choose_hobby_activate_science" value="0" />
  <input type="hidden" name="attr_choose_hobby_activate_ma" value="0" />

  <input type="hidden" name="attr_choose_hobby_specialize_technical" value="0" />
  <input type="hidden" name="attr_choose_hobby_specialize_performance" value="0" />
  <input type="hidden" name="attr_choose_hobby_specialize_physical" value="0" />
  <input type="hidden" name="attr_choose_hobby_specialize_animals" value="0" />

  <input type="hidden" name="attr_reaction_skill" value="0" />
  <input type="hidden" name="attr_action_skill" value="0" />
  <input type="hidden" name="attr_searched_action_skill" value="0" />
  <input type="hidden" name="attr_searched_skill_specialized" value="0" />
  <input type="hidden" name="attr_combined_action_skill_1" value="0" />
  <input type="hidden" name="attr_combined_skill_specialized_1" value="0" />
  <input type="hidden" name="attr_combined_action_skill_2" value="0" />
  <input type="hidden" name="attr_combined_skill_specialized_2" value="0" />

  <input type="hidden" name="attr_ready_to_advance_background" value="0" />
  <input type="hidden" name="attr_ready_to_advance_training" value="0" />

  <input type="hidden" name="attr_vehicle_type" value="sedan" />

  <input type="hidden" name="attr_view_mode" value="character" />

  <input type="hidden" name="attr_sheet_mode" class="sheet-mode-controller" value="type" />

  <!-- Character Type Selection -->
  <div class="sheet-step sheet-step-type sheet-mode-type">
    <h1>Choose Character Type</h1>
    <div class="spacer-md"></div>
    <button type="action" name="act_type_continue" class="sheet-d6pp type-continue-button">Continue</button>
    <div class="spacer-md"></div>
    <label><input type="radio" class="sheet-tab" name="attr_character_type" value="pc" checked /> Player Character</label>
    <p>The heroes of the story. Fully customizable with access to all attributes, skills, gear, and abilities.</p>
    <div class="spacer-md"></div>
    <label><input type="radio" class="sheet-tab" name="attr_character_type" value="vehicle"/> Vehicle</label>
    <p>A car, truck, plane or boat used by PCs or NPCs.</p>
    <div class="spacer-md"></div>
    <label><input type="radio" class="sheet-tab" name="attr_character_type" value="monster"/> Beast</label>
    <p>A pet or wild animal.</p>
    <div class="spacer-md"></div>
    <div class="sheet-divider"></div>
    <div class="spacer-md"></div>
    <label><input type="radio" class="sheet-tab" name="attr_character_type" value="major_npc" /> Major NPC [GM Only]</label>
    <p>Significant allies or adversaries. Comparable to or stronger than PCs.</p>
    <div class="spacer-md"></div>
    <label><input type="radio" class="sheet-tab" name="attr_character_type" value="npc" /> Standard NPC [GM Only]</label>
    <p>Supporting characters who influence scenes but are not central to the narrative. They get 0 skill points.</p>
    <div class="spacer-md"></div>
    <label><input type="radio" class="sheet-tab" name="attr_character_type" value="quick_npc" /> Quick NPC [GM Only]</label>
    <p>Background characters or disposable extras. Fast to build and play with 2D in all attributes and skills.</p>
  </div> <!-- End Character Type Selection -->

  <!-- Background Selection -->
  <div class="sheet-step sheet-step-background sheet-mode-background">
    <h2>Choose a Profession, Childhood Origin and Hobby</h2>
    <div class="final-button-wrapper">
      <input type="checkbox" name="attr_ready_to_advance_background" class="training-ready-toggle" value="1" style="display: none;" />
      <button type="action" name="act_next_step" class="sheet-d6pp next-step-button">Continue</button>
    </div>
    <div class="spacer-md"></div>
    <h3>Choose a Profession</h3>
    <select name="attr_background_choice" class="background-select sheet-d6pp-select" id="background_choice">
      <option value="">-- Select --</option>
      <option value="Accountant">Accountant</option>
      <option value="Activist">Activist</option>
      <option value="Air Force Pilot">Air Force Pilot</option>
      <option value="Air Smuggler">Air Smuggler</option>
      <option value="Army">Army</option>
      <option value="Bartender">Bartender</option>
      <option value="Bounty Hunter">Bounty Hunter</option>
      <option value="Bureaucrat">Bureaucrat</option>
      <option value="Biker">Biker</option>
      <option value="Bodyguard">Bodyguard</option>
      <option value="C-Level Executive">C-Level Executive</option>
      <option value="Cartel Member">Cartel Member</option>
      <option value="Close Quarters Assassin">Close Quarters Assassin</option>
      <option value="Coroner">Coroner</option>
      <option value="Corp Scientist">Corp Scientist</option>
      <option value="Diver">Diver</option>
      <option value="Doctor">Doctor</option>
      <option value="Engineer">Engineer</option>
      <option value="Entrepreneur">Entrepreneur</option>
      <option value="EOD Tech">EOD Tech</option>
      <option value="Famous Artist">Famous Artist</option>
      <option value="Farmer">Farmer</option>
      <option value="Firefighter">Firefighter</option>
      <option value="Fisherman">Fisherman</option>
      <option value="Gambler">Gambler</option>
      <option value="Gangbanger">Gangbanger</option>
      <option value="Getaway Driver">Getaway Driver</option>
      <option value="Government Agent">Government Agent</option>
      <option value="Government Analyst">Government Analyst</option>
      <option value="Government Operative">Government Operative</option>
      <option value="Grifter">Grifter</option>
      <option value="Homeless">Homeless</option>
      <option value="Influencer">Influencer</option>
      <option value="Interrogator">Interrogator</option>
      <option value="IT Specialist">IT Specialist</option>
      <option value="Journalist">Journalist</option>
      <option value="Lawyer">Lawyer</option>
      <option value="Long-Range Assassin">Long-Range Assassin</option>
      <option value="Mafia">Mafia</option>
      <option value="Military Command">Military Command</option>
      <option value="Military Sniper">Military Sniper</option>
      <option value="Negotiator">Negotiator</option>
      <option value="NSA">NSA</option>
      <option value="Nurse">Nurse</option>
      <option value="Ocean Smuggler">Ocean Smuggler</option>
      <option value="Office Worker">Office Worker</option>
      <option value="Paramedic">Paramedic</option>
      <option value="Pharmacist">Pharmacist</option>
      <option value="Pilot">Pilot</option>
      <option value="Police Detective">Police Detective</option>
      <option value="Police">Police</option>
      <option value="Politician">Politician</option>
      <option value="Priest">Priest</option>
      <option value="Private Detective">Private Detective</option>
      <option value="Private Militia">Private Militia</option>
      <option value="Professional Athlete">Professional Athlete</option>
      <option value="Psychiatrist">Psychiatrist</option>
      <option value="Race Car Driver">Race Car Driver</option>
      <option value="Residence Manager">Residence Manager</option>
      <option value="Retail Worker">Retail Worker</option>
      <option value="Security Guard">Security Guard</option>
      <option value="Spy">Spy</option>
      <option value="Stage Magician">Stage Magician</option>
      <option value="Street Dealer">Street Dealer</option>
      <option value="Street Hustler">Street Hustler</option>
      <option value="Student">Student</option>
      <option value="SWAT">SWAT</option>
      <option value="Teacher">Teacher</option>
      <option value="Tradesman">Tradesman</option>
      <option value="Truck Driver">Truck Driver</option>
      <option value="University Professor">University Professor</option>
      <option value="University Student">University Student</option>
      <option value="Veterinarian">Veterinarian</option>
      <option value="Writer">Writer</option>
    </select>

    <div class="sheet-character-desc-grid">
      <textarea name="attr_background_combined" class="sheet-d6pp" rows="4" readonly></textarea>
      <input type="hidden" name="attr_choose_background_activate_aviation" value="0" />
      <input type="hidden" name="attr_choose_background_activate_ma" value="0" />
      <input type="hidden" name="attr_choose_background_activate_science" value="0" />
      <input type="hidden" name="attr_choose_background_activate_knowledge" value="0" />
      <input type="hidden" name="attr_choose_background_specialize_performance" value="0" />
      <input type="hidden" name="attr_choose_background_specialize_physical" value="0" />
      <input type="hidden" name="attr_choose_background_specialize_technical" value="0" />

      <div class="sheet-show-if-background-aviation">
        <p>Select an Aviation skill to unlock</p>
        <select name="attr_background_unlocked_aviation" class="background-select sheet-d6pp-select" id="unlocked_background_aviation">
          <option value="Fly Plane">Fly Plane</option>
          <option value="Fly Helicopter">Fly Helicopter</option>
        </select>
      </div>

      <div class="sheet-show-if-background-ma">
        <p>Select an martial art to unlock</p>
        <select name="attr_background_unlocked_ma" class="background-select sheet-d6pp-select" id="unlocked_background_ma">
          <option value="Aikido">Aikido</option>
          <option value="Boxing">Boxing</option>
          <option value="Capoeira">Capoeira</option>
          <option value="Jeet Kune Do">Jeet Kune Do</option>
          <option value="Jiu-Jitsu">Jiu-Jitsu</option>
          <option value="Judo">Judo</option>
          <option value="Karate">Karate</option>
          <option value="Krav Maga">Krav Maga</option>
          <option value="Muay Thai">Muay Thai</option>
          <option value="Sambo">Sambo</option>
          <option value="Savate">Savate</option>
          <option value="Taekwondo">Taekwondo</option>
        </select>
      </div>

      <div class="sheet-show-if-background-knowledge">
        <p>Select a Knowledge skill to unlock</p>
        <select name="attr_background_unlocked_knowledge" class="background-select sheet-d6pp-select" id="unlocked_background_knowledge">
          <option value="Astronomy">Astronomy</option>
          <option value="Biology">Biology</option>
          <option value="Chemistry">Chemistry</option>
          <option value="Engineering">Engineering</option>
          <option value="Law">Law</option>
          <option value="Linguistics">Linguistics</option>
          <option value="Mathematics">Mathematics</option>
          <option value="Physics">Physics</option>
        </select>
      </div>

      <div class="sheet-show-if-background-science">
        <p>Select a science skill to unlock</p>
        <select name="attr_background_unlocked_science" class="background-select sheet-d6pp-select" id="unlocked_background_science">
          <option value="Astronomy">Astronomy</option>
          <option value="Biology">Biology</option>
          <option value="Chemistry">Chemistry</option>
          <option value="Linguistics">Linguistics</option>
          <option value="Mathematics">Mathematics</option>
          <option value="Physics">Physics</option>
        </select>
      </div>

      <div class="sheet-show-if-background-performance">
        <p>Select a Performance skill to specialize</p>
        <select name="attr_background_specialize_performance" class="background-select sheet-d6pp-select" id="specialize_background_performance">
          <option value="Acting">Acting</option>
          <option value="Art">Art</option>
          <option value="Comedy">Comedy</option>
          <option value="Dance">Dance</option>
          <option value="Disguise">Disguise</option>
          <option value="Gambling">Gambling</option>
          <option value="Play Instrument">Play Instrument</option>
          <option value="Showmanship">Showmanship</option>
          <option value="Sing">Sing</option>
        </select>
      </div>

      <div class="sheet-show-if-background-physical">
        <p>Select a Physical skill to specialize</p>
        <select name="attr_background_specialize_physical" class="background-select sheet-d6pp-select" id="specialize_background_physical">
          <option value="Acrobatics">Acrobatics</option>
          <option value="Athletics">Athletics</option>
          <option value="Climbing">Climbing</option>
          <option value="Jumping">Jumping</option>
          <option value="Lifting">Lifting</option>
          <option value="Swimming">Swimming</option>
        </select>
      </div>

      <div class="sheet-show-if-background-technical">
        <p>Select a Technical skill to specialize</p>
        <select name="attr_background_specialize_technical" class="background-select sheet-d6pp-select" id="specialize_background_technical">
          <option value="Carpentry">Carpentry</option>
          <option value="Electronics">Electronics</option>
          <option value="Explosives">Explosives</option>
          <option value="Gunsmithing">Gunsmithing</option>
          <option value="Mechanical">Mechanical</option>
          <option value="Welding">Welding</option>
        </select>
      </div>
    </div>

    <h3>Choose a Childhood Origin</h3>
    <select name="attr_origin_choice" class="origin-select sheet-d6pp-select" id="origin_choice">
      <option value="">-- Select --</option>
      <option value="Child of Abuse">Child of Abuse</option>
      <option value="Raised by Academics">Raised by Academics</option>
      <option value="Raised by Activists">Raised by Activists</option>
      <option value="Raised by Bikers">Raised by Bikers</option>
      <option value="Raised by Blue Collar">Raised by Blue Collar</option>
      <option value="Bully as Child">Bully as Child</option>
      <option value="Raised by Cartel">Raised by Cartel</option>
      <option value="Child Actor">Child Actor</option>
      <option value="Raised in the Circus">Raised in the Circus</option>
      <option value="Famous Parents">Famous Parents</option>
      <option value="Farm Raised">Farm Raised</option>
      <option value="Raised by Fishermen">Raised by Fishermen</option>
      <option value="Foster Child">Foster Child</option>
      <option value="Gifted">Gifted</option>
      <option value="Raised by Hippies">Raised by Hippies</option>
      <option value="Immigrant">Immigrant</option>
      <option value="Raised by Isolationists">Raised by Isolationists</option>
      <option value="Raised by Mafia">Raised by Mafia</option>
      <option value="Military Brat">Military Brat</option>
      <option value="Raised by Naturalists">Raised by Naturalists</option>
      <option value="Raised by Nomads">Raised by Nomads</option>
      <option value="Orphan">Orphan</option>
      <option value="Raised by Preppers">Raised by Preppers</option>
      <option value="Raised Religious">Raised Religious</option>
      <option value="Raised by Single Parent">Raised by Single Parent</option>
      <option value="From a Small Town">From a Small Town</option>
      <option value="Born to the Game">Born to the Game</option>
      <option value="Street Kid">Street Kid</option>
      <option value="Street Urchin">Street Urchin</option>
      <option value="Suburban Brat">Suburban Brat</option>
      <option value="Raised by Technophiles">Raised by Technophiles</option>
    </select>
    <div class="sheet-character-desc-grid">
      <textarea name="attr_origin_combined" class="sheet-d6pp" rows="4" readonly></textarea>

      <input type="hidden" name="attr_choose_origin_activate_knowledge" value="0" />
      <input type="hidden" name="attr_choose_origin_activate_ma" value="0" />
      <input type="hidden" name="attr_choose_origin_specialize_physical" value="0" />
      <input type="hidden" name="attr_choose_origin_specialize_technical" value="0" />

      <div class="sheet-show-if-origin-knowledge">
        <p>Select a Knowledge skill to unlock</p>
        <select name="attr_origin_unlocked_knowledge" class="background-select sheet-d6pp-select" id="unlocked_origin_knowledge">
          <option value="Astronomy">Astronomy</option>
          <option value="Biology">Biology</option>
          <option value="Chemistry">Chemistry</option>
          <option value="Engineering">Engineering</option>
          <option value="Law">Law</option>
          <option value="Linguistics">Linguistics</option>
          <option value="Mathematics">Mathematics</option>
          <option value="Physics">Physics</option>
        </select>
      </div>

      <div class="sheet-show-if-origin-ma">
        <p>Select an martial art to unlock</p>
        <select name="attr_origin_unlocked_ma" class="background-select sheet-d6pp-select" id="unlocked_origin_ma">
          <option value="Aikido">Aikido</option>
          <option value="Boxing">Boxing</option>
          <option value="Capoeira">Capoeira</option>
          <option value="Jeet Kune Do">Jeet Kune Do</option>
          <option value="Jiu-Jitsu">Jiu-Jitsu</option>
          <option value="Judo">Judo</option>
          <option value="Karate">Karate</option>
          <option value="Krav Maga">Krav Maga</option>
          <option value="Muay Thai">Muay Thai</option>
          <option value="Sambo">Sambo</option>
          <option value="Savate">Savate</option>
          <option value="Taekwondo">Taekwondo</option>
        </select>
      </div>

      <div class="sheet-show-if-origin-physical">
        <p>Select a Physical skill to specialize</p>
        <select name="attr_origin_specialize_physical" class="background-select sheet-d6pp-select" id="specialize_origin_physical">
          <option value="Acrobatics">Acrobatics</option>
          <option value="Athletics">Athletics</option>
          <option value="Climbing">Climbing</option>
          <option value="Jumping">Jumping</option>
          <option value="Lifting">Lifting</option>
          <option value="Swimming">Swimming</option>
        </select>
      </div>

      <div class="sheet-show-if-origin-technical">
        <p>Select a Technical skill to specialize</p>
        <select name="attr_origin_specialize_technical" class="background-select sheet-d6pp-select" id="specialize_origin_technical">
          <option value="Carpentry">Carpentry</option>
          <option value="Electronics">Electronics</option>
          <option value="Explosives">Explosives</option>
          <option value="Gunsmithing">Gunsmithing</option>
          <option value="Mechanical">Mechanical</option>
          <option value="Welding">Welding</option>
        </select>
      </div>

    </div>

    <h3>Choose a Hobby</h3>
    <select name="attr_hobby_choice" class="hobby-select sheet-d6pp-select" id="hobby_choice">
      <option value="">-- Select --</option>
      <option value="Amateur Militia">Amateur Militia</option>
      <option value="Amateur Pilot">Amateur Pilot</option>
      <option value="Amateur Scientist">Amateur Scientist</option>
      <option value="Animal Enthusiast">Animal Enthusiast</option>
      <option value="Army Reservist">Army Reservist</option>
      <option value="Auto Restoration">Auto Restoration</option>
      <option value="Bow Hunter">Bow Hunter</option>
      <option value="Brawler">Brawler</option>
      <option value="Camper">Camper</option>
      <option value="Conspiracy Theorist">Conspiracy Theorist</option>
      <option value="Cosplay">Cosplay</option>
      <option value="Cyclist">Cyclist</option>
      <option value="DIY">DIY</option>
      <option value="Drone Enthusiast">Drone Enthusiast</option>
      <option value="Genealogist">Genealogist</option>
      <option value="Gamer">Gamer</option>
      <option value="Hacker">Hacker</option>
      <option value="Hunter">Hunter</option>
      <option value="Locksport">Locksport</option>
      <option value="Martial Arts">Martial Arts</option>
      <option value="Motorcycle Enthusiast">Motorcycle Enthusiast</option>
      <option value="Navy Reservist">Navy Reservist</option>
      <option value="Parkour">Parkour</option>
      <option value="Performer">Performer</option>
      <option value="Picker">Picker</option>
      <option value="Pistol Shooting">Pistol Shooting</option>
      <option value="Player">Player</option>
      <option value="Prepper">Prepper</option>
      <option value="Recreational Diver">Recreational Diver</option>
      <option value="Rifle Shooting">Rifle Shooting</option>
      <option value="RPG Enthusiast">RPG Enthusiast</option>
      <option value="Socialite">Socialite</option>
      <option value="Sports">Sports</option>
      <option value="Street Racer">Street Racer</option>
      <option value="Technophile">Technophile</option>
      <option value="Tinkerer">Tinkerer</option>
      <option value="True Crime Fan">True Crime Fan</option>
      <option value="Underground Chemist">Underground Chemist</option>
      <option value="Volunteer Firefighter">Volunteer Firefighter</option>
    </select>
    <div class="sheet-character-desc-grid">
      <textarea name="attr_hobby_combined" class="sheet-d6pp" rows="4" readonly></textarea>

      <input type="hidden" name="attr_choose_hobby_activate_science" value="0" />
      <input type="hidden" name="attr_choose_hobby_specialize_technical" value="0" />
      <input type="hidden" name="attr_choose_hobby_activate_ma" value="0" />
      <input type="hidden" name="attr_choose_hobby_specialize_performance" value="0" />
      <input type="hidden" name="attr_choose_hobby_specialize_physical" value="0" />
      <input type="hidden" name="attr_choose_hobby_specialize_animals" value="0" />

      <div class="sheet-show-if-hobby-science">
        <p>Select a science skill to unlock</p>
        <select name="attr_hobby_unlocked_science" class="background-select sheet-d6pp-select" id="unlocked_hobby_science">
          <option value="Astronomy">Astronomy</option>
          <option value="Biology">Biology</option>
          <option value="Chemistry">Chemistry</option>
          <option value="Linguistics">Linguistics</option>
          <option value="Mathematics">Mathematics</option>
          <option value="Physics">Physics</option>
        </select>
      </div>

      <div class="sheet-show-if-hobby-animals">
        <p>Select a Animals skill to specialize</p>
        <select name="attr_hobby_specialize_animals" class="background-select sheet-d6pp-select" id="specialize_hobby_animals">
          <option value="Animal Care">Animal Care</option>
          <option value="Animal Empathy">Animal Empathy</option>
          <option value="Animal Handling">Animal Handling</option>
          <option value="Animal Training">Animal Training</option>
        </select>
      </div>

      <div class="sheet-show-if-hobby-technical">
        <p>Select a Technical skill to specialize</p>
        <select name="attr_hobby_specialize_technical" class="background-select sheet-d6pp-select" id="specialize_hobby_technical">
          <option value="Carpentry">Carpentry</option>
          <option value="Electronics">Electronics</option>
          <option value="Explosives">Explosives</option>
          <option value="Gunsmithing">Gunsmithing</option>
          <option value="Mechanical">Mechanical</option>
          <option value="Welding">Welding</option>
        </select>
      </div>

      <div class="sheet-show-if-hobby-ma">
        <p>Select an martial art to unlock</p>
        <select name="attr_hobby_unlocked_ma" class="background-select sheet-d6pp-select" id="unlocked_hobby_ma">
          <option value="Aikido">Aikido</option>
          <option value="Boxing">Boxing</option>
          <option value="Capoeira">Capoeira</option>
          <option value="Jeet Kune Do">Jeet Kune Do</option>
          <option value="Jiu-Jitsu">Jiu-Jitsu</option>
          <option value="Judo">Judo</option>
          <option value="Karate">Karate</option>
          <option value="Krav Maga">Krav Maga</option>
          <option value="Muay Thai">Muay Thai</option>
          <option value="Sambo">Sambo</option>
          <option value="Savate">Savate</option>
          <option value="Taekwondo">Taekwondo</option>
        </select>
      </div>

      <div class="sheet-show-if-hobby-performance">
        <p>Select a Performance skill to specialize</p>
        <select name="attr_hobby_specialize_performance" class="background-select sheet-d6pp-select" id="specialize_hobby_performance">
          <option value="Acting">Acting</option>
          <option value="Art">Art</option>
          <option value="Comedy">Comedy</option>
          <option value="Dance">Dance</option>
          <option value="Disguise">Disguise</option>
          <option value="Gambling">Gambling</option>
          <option value="Play Instrument">Play Instrument</option>
          <option value="Showmanship">Showmanship</option>
          <option value="Sing">Sing</option>
        </select>
      </div>

      <div class="sheet-show-if-hobby-physical">
        <p>Select a Physical skill to specialize</p>
        <select name="attr_hobby_specialize_physical" class="background-select sheet-d6pp-select" id="specialize_hobby_physical">
          <option value="Acrobatics">Acrobatics</option>
          <option value="Athletics">Athletics</option>
          <option value="Climbing">Climbing</option>
          <option value="Jumping">Jumping</option>
          <option value="Lifting">Lifting</option>
          <option value="Swimming">Swimming</option>
        </select>
      </div>

    </div>

    <h3>Starting Equipment</h3>
    <div class="sheet-character-desc-grid">
      <textarea name="attr_background_items1" class="sheet-d6pp textarea-ten-lines" readonly rows="5"></textarea>
    </div>
  </div> <!-- End Background Selection -->

  <!-- Vehicle Select -->
  <div class="sheet-step sheet-step-vehicle_select sheet-mode-vehicle_select">
    <h2>Choose a Vehicle Type</h2>
    <div class="finish-button-wrapper">
      <input type="checkbox" name="attr_ready_to_advance_training" class="sheet-ready-toggle" value="1" style="display: none;" />
      <button type="action" name="act_final_vehicle_step" class="sheet-d6pp final-step-button">Finish</button>
    </div>
    <div class="spacer-md"></div>

    <!-- Category select (must appear before the vehicle selectors for the CSS to work) -->
    <select name="attr_vehicle_category" class="sheet-d6pp-select">
      <option value="">-- Select Category --</option>
      <option value="cars">Cars</option>
      <option value="utility">Utility & Heavy</option>
      <option value="specialty">Specialty</option>
      <option value="emergency">Emergency & Security</option>
      <option value="terrain">Special Terrain</option>
      <option value="motorcycles">Motorcycles</option>
      <option value="watercraft">Watercraft</option>
      <option value="aircraft">Aircraft</option>
    </select>

    <!-- Hidden canonical field your sheet already uses -->
    <input type="hidden" name="attr_vehicle_category_val" value="">

    <!-- Cars -->
  <div class="sheet-veh-cars sheet-veh-block">
    <select name="attr_vehicle_choice_cars" class="sheet-d6pp-select">
      <option value="">-- Select Vehicle --</option>
      <option value="convertible">Convertible</option>
      <option value="hatchback">Hatchback</option>
      <option value="luxury_sedan">Luxury Sedan</option>
      <option value="muscle_car">Muscle Car</option>
      <option value="sedan">Sedan</option>
      <option value="sports_car">Sports Car</option>
      <option value="taxi">Taxi</option>
      <option value="vortex_supercar">Vortex Supercar</option>
    </select>
  </div>

  <!-- Utility & Heavy -->
  <div class="sheet-veh-utility sheet-veh-block">
    <select name="attr_vehicle_choice_utility" class="sheet-d6pp-select">
      <option value="">-- Select Vehicle --</option>
      <option value="delivery_van">Delivery Van</option>
      <option value="dump_truck">Dump Truck</option>
      <option value="garbage_truck">Garbage Truck</option>
      <option value="pickup_truck">Pickup Truck</option>
      <option value="semi_truck">Semi-Truck</option>
      <option value="suv">SUV</option>
      <option value="tow_truck">Tow Truck</option>
    </select>
  </div>

  <!-- Specialty -->
  <div class="sheet-veh-specialty sheet-veh-block">
    <select name="attr_vehicle_choice_specialty" class="sheet-d6pp-select">
      <option value="">-- Select Vehicle --</option>
      <option value="hearse">Hearse</option>
      <option value="motorhome">Motorhome</option>
    </select>
  </div>

  <!-- Emergency & Security -->
  <div class="sheet-veh-emergency sheet-veh-block">
    <select name="attr_vehicle_choice_emergency" class="sheet-d6pp-select">
      <option value="">-- Select Vehicle --</option>
      <option value="ambulance">Ambulance</option>
      <option value="armored_truck">Armored Truck</option>
      <option value="fire_truck">Fire Truck</option>
      <option value="police_cruiser">Police Cruiser</option>
    </select>
  </div>

  <!-- Special Terrain -->
  <div class="sheet-veh-terrain sheet-veh-block">
    <select name="attr_vehicle_choice_terrain" class="sheet-d6pp-select">
      <option value="">-- Select Vehicle --</option>
      <option value="dune_buggy">Dune Buggy</option>
      <option value="hovercraft">Hovercraft</option>
      <option value="offroad">Off-Road</option>
      <option value="snowmobile">Snowmobile</option>
    </select>
  </div>

  <!-- Motorcycles -->
  <div class="sheet-veh-motorcycles sheet-veh-block">
    <select name="attr_vehicle_choice_motorcycles" class="sheet-d6pp-select">
      <option value="">-- Select Vehicle --</option>
      <option value="chopper">Chopper</option>
      <option value="dirt_bike">Dirt Bike</option>
      <option value="police_bike">Police Bike</option>
      <option value="street_bike">Street Bike</option>
      <option value="touring_bike">Touring Bike</option>
    </select>
  </div>

  <!-- Watercraft -->
  <div class="sheet-veh-watercraft sheet-veh-block">
    <select name="attr_vehicle_choice_watercraft" class="sheet-d6pp-select">
      <option value="">-- Select Vehicle --</option>
      <option value="ferry">Ferry</option>
      <option value="fishing_boat">Fishing Boat</option>
      <option value="freighter">Freighter</option>
      <option value="jetski">Jet Ski</option>
      <option value="police_boat">Police Boat</option>
      <option value="rib">Rigid Inflatable Boat</option>
      <option value="sailboat">Sailboat</option>
      <option value="speedboat">Speedboat</option>
      <option value="super_yacht">Super Yacht</option>
      <option value="yacht">Yacht</option>
    </select>
  </div>

  <!-- Aircraft -->
  <div class="sheet-veh-aircraft sheet-veh-block">
    <select name="attr_vehicle_choice_aircraft" class="sheet-d6pp-select">
      <option value="">-- Select Vehicle --</option>
      <option value="civilian_drone">Civilian Drone</option>
      <option value="four_seat_plane">Four-Seat Plane</option>
      <option value="glider">Glider</option>
      <option value="helicopter">Helicopter</option>
      <option value="passenger_airliner">Passenger Airliner</option>
      <option value="private_jet">Private Jet</option>
    </select>
  </div>

    <div class="sheet-character-desc-grid">
      <textarea class="sheet-d6pp textarea-two-lines" name="attr_character_description" readonly></textarea>
    </div>

    <div class="sheet-grid-table four-col full-width">
      <div class="grid-header">Strength</div>
      <div class="grid-header">Agility</div>
      <div class="grid-header">Health</div>
      <div class="grid-header">Quickness</div>

      <span name="attr_strength_base_string" class="grid-cell number-cell"></span>
      <span name="attr_agility_base_string" class="grid-cell number-cell"></span>
      <span name="attr_health_base_string" class="grid-cell number-cell"></span>
      <span name="attr_quickness_base_string" class="grid-cell number-cell"></span>
    </div>
  </div> <!-- End Vehicle Select -->

  <!-- Beast Select -->
  <div class="sheet-step sheet-step-beast_select sheet-mode-beast_select">
    <h2>Choose a Beast Type</h2>
    <div class="finish-button-wrapper">
      <input type="checkbox" name="attr_ready_to_advance_training" class="sheet-ready-toggle" value="1" style="display: none;" />
      <button type="action" name="act_final_beast_step" class="sheet-d6pp final-step-button">Finish</button>
    </div>
    <div class="spacer-md"></div>

    <!-- Beast Category -->
    <select name="attr_beast_category" class="sheet-d6pp-select">
      <option value="">-- Select Category --</option>
      <option value="dogs">Dogs</option>
      <option value="primates">Primates</option>
      <option value="flying">Flying Critters</option>
      <option value="wild">Wild Animals</option>
      <option value="burden">Beasts of Burden</option>
      <option value="exotic">Exotic</option>
      <option value="livestock">Livestock</option>
      <option value="insects">Insects</option>
      <option value="cats">Cats</option>
      <option value="snakes">Snakes & Reptiles</option>
      <option value="sea">Sea Creatures</option>
    </select>

    <!-- Hidden canonical field -->
    <input type="hidden" name="attr_beast_category_val" value="">

    <!-- Dogs -->
    <div class="sheet-beast-dogs sheet-beast-block">
      <select name="attr_beast_choice_dogs" class="sheet-d6pp-select">
        <option value="">-- Select Beast --</option>
        <option value="bloodhound">Bloodhound</option>
        <option value="detection_dog">Detection Dog</option>
        <option value="guard_dog">Guard Dog</option>
        <option value="large_pet_dog">Large Pet Dog</option>
        <option value="small_pet_dog">Small Pet Dog</option>
        <option value="police_dog">Police Dog</option>
        <option value="rescue_dog">Rescue Dog</option>
      </select>
    </div>

    <!-- Primates -->
    <div class="sheet-beast-primates sheet-beast-block">
      <select name="attr_beast_choice_primates" class="sheet-d6pp-select">
        <option value="">-- Select Beast --</option>
        <option value="ape">Ape</option>
        <option value="monkey">Monkey</option>
      </select>
    </div>

    <!-- Flying Critters -->
    <div class="sheet-beast-flying sheet-beast-block">
      <select name="attr_beast_choice_flying" class="sheet-d6pp-select">
        <option value="">-- Select Beast --</option>
        <option value="bat">Bat</option>
        <option value="bird">Bird</option>
        <option value="exotic_bird">Exotic Bird</option>
        <option value="hawk">Hawk</option>
      </select>
    </div>

    <!-- Wild Animals -->
    <div class="sheet-beast-wild sheet-beast-block">
      <select name="attr_beast_choice_wild" class="sheet-d6pp-select">
        <option value="">-- Select Beast --</option>
        <option value="bear">Bear</option>
        <option value="boar">Boar</option>
        <option value="coyote">Coyote</option>
        <option value="deer">Deer</option>
        <option value="moose">Moose</option>
        <option value="raccoon">Raccoon</option>
        <option value="rat">Rat</option>
        <option value="wolf">Wolf</option>
      </select>
    </div>

    <!-- Beasts of Burden -->
    <div class="sheet-beast-burden sheet-beast-block">
      <select name="attr_beast_choice_burden" class="sheet-d6pp-select">
        <option value="">-- Select Beast --</option>
        <option value="camel">Camel</option>
        <option value="elephant">Elephant</option>
        <option value="draft_horse">Draft Horse</option>
        <option value="riding_horse">Riding Horse</option>
        <option value="mule">Mule</option>
      </select>
    </div>

    <!-- Exotic -->
    <div class="sheet-beast-exotic sheet-beast-block">
      <select name="attr_beast_choice_exotic" class="sheet-d6pp-select">
        <option value="">-- Select Beast --</option>
        <option value="kangaroo">Kangaroo</option>
        <option value="panda">Panda</option>
      </select>
    </div>

    <!-- Livestock -->
    <div class="sheet-beast-livestock sheet-beast-block">
      <select name="attr_beast_choice_livestock" class="sheet-d6pp-select">
        <option value="">-- Select Beast --</option>
        <option value="bison">Bison</option>
        <option value="cow">Cow</option>
        <option value="goat">Goat</option>
        <option value="pig">Pig</option>
        <option value="sheep">Sheep</option>
      </select>
    </div>

    <!-- Insects -->
    <div class="sheet-beast-insects sheet-beast-block">
      <select name="attr_beast_choice_insects" class="sheet-d6pp-select">
        <option value="">-- Select Beast --</option>
        <option value="scorpion">Scorpion</option>
        <option value="spider">Venomous Spider</option>
      </select>
    </div>

    <!-- Cats -->
    <div class="sheet-beast-cats sheet-beast-block">
      <select name="attr_beast_choice_cats" class="sheet-d6pp-select">
        <option value="">-- Select Beast --</option>
        <option value="cheetah">Cheetah</option>
        <option value="house_cat">House Cat</option>
        <option value="lion">Lion</option>
        <option value="mountain_lion">Mountain Lion</option>
        <option value="tiger">Tiger</option>
      </select>
    </div>

    <!-- Snakes & Reptiles -->
    <div class="sheet-beast-snakes sheet-beast-block">
      <select name="attr_beast_choice_snakes" class="sheet-d6pp-select">
        <option value="">-- Select Beast --</option>
        <option value="alligator">Alligator</option>
        <option value="black_mamba">Black Mamba</option>
        <option value="cobra">Cobra</option>
        <option value="crocodile">Crocodile</option>
        <option value="python">Python</option>
        <option value="rattlesnake">Rattlesnake</option>
      </select>
    </div>

    <!-- Sea Creatures -->
    <div class="sheet-beast-sea sheet-beast-block">
      <select name="attr_beast_choice_sea" class="sheet-d6pp-select">
        <option value="">-- Select Beast --</option>
        <option value="jellyfish">Jellyfish</option>
        <option value="orca">Orca</option>
        <option value="piranha_swarm">Piranha Swarm</option>
        <option value="shark">Shark</option>
      </select>
    </div>

    <div class="sheet-character-desc-grid">
      <textarea class="sheet-d6pp textarea-ten-lines" name="attr_character_description" readonly></textarea>
    </div>
  </div> <!-- End Beast Select -->

  <!-- Skill Training Section -->
  <div class="sheet-step sheet-step-training sheet-mode-training">
    <h2>Training</h2>
    <input type="hidden" name="attr_character_type" value="pc" />
    <span class="show-if-pc">
      <p>Distribute 27 points among Attributes and 60 points among Skill Groups, then click Finish.</p>
    </span>
    <span class="show-if-major">
      <p>This major NPC is a significant character. Customize their stats as needed for story balance.</p>
    </span>
    <span class="show-if-npc">
      <p>This standard NPC. You can adjust their attributes but they don't get any skill points.</p>
    </span>
    <div class="spacer-sm"></div>

    <div class="finish-button-wrapper">
      <input type="checkbox" name="attr_ready_to_advance_training" class="sheet-ready-toggle" value="1" style="display: none;" />
      <button type="action" name="act_final_step" class="sheet-d6pp final-step-button">Finish</button>
    </div>

    <div class="spacer-sm"></div>
    <h2><span name="attr_background_name"></span>:</h2>
    <div class="sheet-character-desc-grid">
      <textarea name="attr_background_combined" class="sheet-d6pp" rows="4" readonly></textarea>
    </div>
    <h2>Attributes</h2>
    <div class="sheet-grid-table two-col">
      <div class="grid-header">Attribute</div>
      <div class="grid-header">Base</div>

      <div class="grid-cell">(S)trength</div>
      <div class="grid-cell"><input type="number" class="sheet-d6pp" name="attr_strength" min="1" max="5" value="1" /></div>

      <div class="grid-cell">(A)gility</div>
      <div class="grid-cell"><input type="number" class="sheet-d6pp" name="attr_agility" min="1" max="5" value="1" /></div>

      <div class="grid-cell">(H)ealth</div>
      <div class="grid-cell"><input type="number" class="sheet-d6pp" name="attr_health" min="1" max="5" value="1" /></div>

      <div class="grid-cell">(P)erception</div>
      <div class="grid-cell"><input type="number" class="sheet-d6pp" name="attr_perception" min="1" max="5" value="1" /></div>

      <div class="grid-cell">(Q)uickness</div>
      <div class="grid-cell"><input type="number" class="sheet-d6pp" name="attr_quickness" min="1" max="5" value="1" /></div>

      <div class="grid-cell">(W)illpower</div>
      <div class="grid-cell"><input type="number" class="sheet-d6pp" name="attr_willpower" min="1" max="5" value="1" /></div>

      <div class="grid-cell">(I)ntelligence</div>
      <div class="grid-cell"><input type="number" class="sheet-d6pp" name="attr_intelligence" min="1" max="5" value="1" /></div>

      <div class="grid-cell">(M)anual Dex</div>
      <div class="grid-cell"><input type="number" class="sheet-d6pp" name="attr_manualdex" min="1" max="5" value="1" /></div>

      <div class="grid-cell">(C)harisma</div>
      <div class="grid-cell"><input type="number" class="sheet-d6pp" name="attr_charisma" min="1" max="5" value="1" /></div>

      <div class="grid-cell grid-total"><strong>Total Assigned</strong></div>
      <div class="grid-cell grid-total"><span name="attr_attribute_total">0</span> / 27</div>
    </div>
    <div class="spacer-md"></div>
    <div class="show-if-not-npc">
      <button type="action" class="sheet-d6pp" name="act_expand_all">Expand All</button>
      <button type="action" class="sheet-d6pp" name="act_collapse_all">Collapse All</button>
      <div class="spacer-md"></div>
      <div class="skill-section-collapsible">
        <input type="checkbox" class="skill-toggle" id="toggle_core_training" name="attr_toggle_core_training" value="1" checked hidden />
        <label class="skill-toggle-label" for="toggle_core_training">Core Skill Group (can't be trained)</label>
        <div class="skill-group-content">
          <div class="sheet-grid-table four-col">
            <!-- Header Row -->
            <div class="grid-header">Skill</div>
            <div class="grid-header">Attr Code</div>
            <div class="grid-header">Dice Code</div>
            <div class="grid-header"></div>

            <!-- Row 1 -->
            <div class="grid-cell"><span name="attr_avoid_displayname"></span><span name="attr_avoid_specialized"></span></div>
            <div class="grid-cell"><span name="attr_avoid_attributes"></span></div>
            <div class="grid-cell"><span name="attr_avoid_string"></span></div>
            <div class="grid-cell">Activated</div>

            <!-- Row 2 -->
            <div class="grid-cell"><span name="attr_defend_displayname"></span><span name="attr_defend_specialized"></span></div>
            <div class="grid-cell"><span name="attr_defend_attributes"></span></div>
            <div class="grid-cell"><span name="attr_defend_string"></span></div>
            <div class="grid-cell">Activated</div>

            <!-- Row 2 -->
            <div class="grid-cell"><span name="attr_dodge_displayname"></span><span name="attr_dodge_specialized"></span></div>
            <div class="grid-cell"><span name="attr_dodge_attributes"></span></div>
            <div class="grid-cell"><span name="attr_dodge_string"></span></div>
            <div class="grid-cell">Activated</div>

            <!-- Row 3 -->
            <div class="grid-cell"><span name="attr_endure_displayname"></span><span name="attr_endure_specialized"></span></div>
            <div class="grid-cell"><span name="attr_endure_attributes"></span></div>
            <div class="grid-cell"><span name="attr_endure_string"></span></div>
            <div class="grid-cell">Activated</div>

            <!-- Row 4 -->
            <div class="grid-cell"><span name="attr_initiative_displayname"></span><span name="attr_initiative_specialized"></span></div>
            <div class="grid-cell"><span name="attr_initiative_attributes"></span></div>
            <div class="grid-cell"><span name="attr_initiative_string"></span></div>
            <div class="grid-cell">Activated</div>
          </div>
        </div>
      </div>
      <h2>Trainable Skill Groups</h2>
      <h3>Non-Combat Skills</h3>
      <div class="spacer-md"></div>

      <!-- Animals Skill Group -->
      <div class="skill-section-collapsible">
        <input type="checkbox" class="skill-toggle" id="toggle_animals_training" name="attr_toggle_animals_training" value="1" checked hidden />
        <label class="skill-toggle-label" for="toggle_animals_training">Animals Skill Group Training = <span name="attr_animals_string"></span></label>
        <div class="skill-group-content">
          <div class="sheet-spendblock">
            <input type="hidden" name="attr_spend_mode" value="0" />
            <div class="spend-mode">
              <button type="action" name="act_add_animals" class="commit-spend-mode">Train (<span name="attr_animals_cost"></span> skill points)</button>
              <button type="action" name="act_refund_animals" class="commit-spend-mode">Refund (<span name="attr_animals_refund"></span> skill points)</button>
              <div class="commit-spend-mode">
                Skill Points Left: <span name="attr_skill_points"></span>
              </div>
            </div>
            <div class="spacer-sm"></div>
          </div>
          <div class="sheet-grid-table four-col">
            <div class="grid-header"></div>
            <div class="grid-header">Attr Code</div>
            <div class="grid-header">Dice Code</div>
            <div class="grid-header"></div>

            <div class="grid-cell"><span name="attr_animal_care_displayname"></span><span name="attr_animal_care_specialized"></span></div>
            <div class="grid-cell"><span name="attr_animal_care_attributes"></span></div>
            <div class="grid-cell"><span name="attr_animal_care_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_animal_empathy_displayname"></span><span name="attr_animal_empathy_specialized"></span></div>
            <div class="grid-cell"><span name="attr_animal_empathy_attributes"></span></div>
            <div class="grid-cell"><span name="attr_animal_empathy_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_animal_handling_displayname"></span><span name="attr_animal_handling_specialized"></span></div>
            <div class="grid-cell"><span name="attr_animal_handling_attributes"></span></div>
            <div class="grid-cell"><span name="attr_animal_handling_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_animal_training_displayname"></span><span name="attr_animal_training_specialized"></span></div>
            <div class="grid-cell"><span name="attr_animal_training_attributes"></span></div>
            <div class="grid-cell"><span name="attr_animal_training_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>
          </div>
        </div>
      </div>

      <!-- Aviation Skill Group -->
      <div class="skill-section-collapsible">
        <input type="checkbox" class="skill-toggle" id="toggle_aviation_training" name="attr_toggle_aviation_training" value="1" checked hidden />
        <label class="skill-toggle-label" for="toggle_aviation_training">Aviation Skill Group Training = <span name="attr_aviation_string"></span></label>
        <div class="skill-group-content">
          <div class="sheet-spendblock">
            <input type="hidden" name="attr_spend_mode" value="0" />
            <div class="spend-mode">
              <button type="action" name="act_add_aviation" class="commit-spend-mode">Train (<span name="attr_aviation_cost"></span> skill points)</button>
              <button type="action" name="act_refund_aviation" class="commit-spend-mode">Refund (<span name="attr_aviation_refund"></span> skill points)</button>
              <div class="commit-spend-mode">
                Skill Points Left: <span name="attr_skill_points"></span>
              </div>
            </div>
            <div class="spacer-sm"></div>
          </div>
          <div class="sheet-grid-table four-col">
            <div class="grid-header"></div>
            <div class="grid-header">Attr Code</div>
            <div class="grid-header">Dice Code</div>
            <div class="grid-header"></div>

            <div class="grid-cell"><span name="attr_air_navigation_displayname"></span><span name="attr_air_navigation_specialized"></span></div>
            <div class="grid-cell"><span name="attr_air_navigation_attributes"></span></div>
            <div class="grid-cell"><span name="attr_air_navigation_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_control_drone_displayname"></span><span name="attr_control_drone_specialized"></span></div>
            <div class="grid-cell"><span name="attr_control_drone_attributes"></span></div>
            <div class="grid-cell"><span name="attr_control_drone_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_fly_helicopter_displayname"></span><span name="attr_fly_helicopter_specialized"></span></div>
            <div class="grid-cell"><span name="attr_fly_helicopter_attributes"></span></div>
            <div class="grid-cell"><span name="attr_fly_helicopter_string"></span></div>
            <div class="grid-cell">
              <input type="hidden" name="attr_fly_helicopter_active" value="2" />
              <div class="skill-roll-buttons">
                <button type="action" name="act_activate_fly_helicopter" class="activate-skill-button">Activate</button>
                <button type="action" name="act_undo_activate_fly_helicopter" class="undo-activate-skill-button">Undo</button>
                <span class="activated-label">Activated</span>
              </div>
            </div>

            <div class="grid-cell"><span name="attr_fly_plane_displayname"></span><span name="attr_fly_plane_specialized"></span></div>
            <div class="grid-cell"><span name="attr_fly_plane_attributes"></span></div>
            <div class="grid-cell"><span name="attr_fly_plane_string"></span></div>
            <div class="grid-cell">
              <input type="hidden" name="attr_fly_plane_active" value="2" />
              <div class="skill-roll-buttons">
                <button type="action" name="act_activate_fly_plane" class="activate-skill-button">Activate</button>
                <button type="action" name="act_undo_activate_fly_plane" class="undo-activate-skill-button">Undo</button>
                <span class="activated-label">Activated</span>
              </div>
            </div>

          </div>
        </div>
      </div>

      <!-- Awareness Skill Group -->
      <div class="skill-section-collapsible">
        <input type="checkbox" class="skill-toggle" id="toggle_awareness_training" name="attr_toggle_awareness_training" value="1" checked hidden />
        <label class="skill-toggle-label" for="toggle_awareness_training">Awareness Skill Group Training = <span name="attr_awareness_string"></span></label>
        <div class="skill-group-content">
          <div class="sheet-spendblock">
            <input type="hidden" name="attr_spend_mode" value="0" />
            <div class="spend-mode">
              <button type="action" name="act_add_awareness" class="commit-spend-mode">Train (<span name="attr_awareness_cost"></span> skill points)</button>
              <button type="action" name="act_refund_awareness" class="commit-spend-mode">Refund (<span name="attr_awareness_refund"></span> skill points)</button>
              <div class="commit-spend-mode">
                Skill Points Left: <span name="attr_skill_points"></span>
              </div>
            </div>
            <div class="spacer-sm"></div>
          </div>
          <div class="sheet-grid-table four-col">
            <div class="grid-header"></div>
            <div class="grid-header">Attr Code</div>
            <div class="grid-header">Dice Code</div>
            <div class="grid-header"></div>

            <div class="grid-cell"><span name="attr_empathy_displayname"></span><span name="attr_empathy_specialized"></span></div>
            <div class="grid-cell"><span name="attr_empathy_attributes"></span></div>
            <div class="grid-cell"><span name="attr_empathy_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_insight_displayname"></span><span name="attr_insight_specialized"></span></div>
            <div class="grid-cell"><span name="attr_insight_attributes"></span></div>
            <div class="grid-cell"><span name="attr_insight_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_instinct_displayname"></span><span name="attr_instinct_specialized"></span></div>
            <div class="grid-cell"><span name="attr_instinct_attributes"></span></div>
            <div class="grid-cell"><span name="attr_instinct_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>
          </div>
        </div>
      </div>

      <!-- Computers Skill Group -->
      <div class="skill-section-collapsible">
        <input type="checkbox" class="skill-toggle" id="toggle_computers_training" name="attr_toggle_computers_training" value="1" checked hidden />
        <label class="skill-toggle-label" for="toggle_computers_training">Computers Skill Group Training = <span name="attr_computers_string"></span></label>
        <div class="skill-group-content">
          <div class="sheet-spendblock">
            <input type="hidden" name="attr_spend_mode" value="0" />
            <div class="spend-mode">
              <button type="action" name="act_add_computers" class="commit-spend-mode">Train (<span name="attr_computers_cost"></span> skill points)</button>
              <button type="action" name="act_refund_computers" class="commit-spend-mode">Refund (<span name="attr_computers_refund"></span> skill points)</button>
              <div class="commit-spend-mode">
                Skill Points Left: <span name="attr_skill_points"></span>
              </div>
            </div>
            <div class="spacer-sm"></div>
          </div>
          <div class="sheet-grid-table four-col">
            <div class="grid-header"></div>
            <div class="grid-header">Attr Code</div>
            <div class="grid-header">Dice Code</div>
            <div class="grid-header"></div>

            <div class="grid-cell"><span name="attr_computer_use_displayname"></span><span name="attr_computer_use_specialized"></span></div>
            <div class="grid-cell"><span name="attr_computer_use_attributes"></span></div>
            <div class="grid-cell"><span name="attr_computer_use_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_hacking_displayname"></span><span name="attr_hacking_specialized"></span></div>
            <div class="grid-cell"><span name="attr_hacking_attributes"></span></div>
            <div class="grid-cell"><span name="attr_hacking_string"></span></div>
            <div class="grid-cell">
              <input type="hidden" name="attr_hacking_active" value="2" />
              <div class="skill-roll-buttons">
                <button type="action" name="act_activate_hacking" class="activate-skill-button">Activate</button>
                <button type="action" name="act_undo_activate_hacking" class="undo-activate-skill-button">Undo</button>
                <span class="activated-label">Activated</span>
              </div>
            </div>

            <div class="grid-cell"><span name="attr_hardware_displayname"></span><span name="attr_hardware_specialized"></span></div>
            <div class="grid-cell"><span name="attr_hardware_attributes"></span></div>
            <div class="grid-cell"><span name="attr_hardware_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_programming_displayname"></span><span name="attr_programming_specialized"></span></div>
            <div class="grid-cell"><span name="attr_programming_attributes"></span></div>
            <div class="grid-cell"><span name="attr_programming_string"></span></div>
            <div class="grid-cell">
              <input type="hidden" name="attr_programming_active" value="2" />
              <div class="skill-roll-buttons">
                <button type="action" name="act_activate_programming" class="activate-skill-button">Activate</button>
                <button type="action" name="act_undo_activate_programming" class="undo-activate-skill-button">Undo</button>
                <span class="activated-label">Activated</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Driving Skill Group -->
      <div class="skill-section-collapsible">
        <input type="checkbox" class="skill-toggle" id="toggle_driving_training" name="attr_toggle_driving_training" value="1" checked hidden />
        <label class="skill-toggle-label" for="toggle_driving_training">Driving Skill Group Training = <span name="attr_driving_string"></span></label>
        <div class="skill-group-content">
          <div class="sheet-spendblock">
            <input type="hidden" name="attr_spend_mode" value="0" />
            <div class="spend-mode">
              <button type="action" name="act_add_driving" class="commit-spend-mode">Train (<span name="attr_driving_cost"></span> skill points)</button>
              <button type="action" name="act_refund_driving" class="commit-spend-mode">Refund (<span name="attr_driving_refund"></span> skill points)</button>
              <div class="commit-spend-mode">
                Skill Points Left: <span name="attr_skill_points"></span>
              </div>
            </div>
            <div class="spacer-sm"></div>
          </div>
          <div class="sheet-grid-table four-col">
            <div class="grid-header"></div>
            <div class="grid-header">Attr Code</div>
            <div class="grid-header">Dice Code</div>
            <div class="grid-header"></div>

            <div class="grid-cell"><span name="attr_drive_car_displayname"></span><span name="attr_drive_car_specialized"></span></div>
            <div class="grid-cell"><span name="attr_drive_car_attributes"></span></div>
            <div class="grid-cell"><span name="attr_drive_car_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_drive_motorcycle_displayname"></span><span name="attr_drive_motorcycle_specialized"></span></div>
            <div class="grid-cell"><span name="attr_drive_motorcycle_attributes"></span></div>
            <div class="grid-cell"><span name="attr_drive_motorcycle_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_drive_semi_displayname"></span><span name="attr_drive_semi_specialized"></span></div>
            <div class="grid-cell"><span name="attr_drive_semi_attributes"></span></div>
            <div class="grid-cell"><span name="attr_drive_semi_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_ride_bicycle_displayname"></span><span name="attr_ride_bicycle_specialized"></span></div>
            <div class="grid-cell"><span name="attr_ride_bicycle_attributes"></span></div>
            <div class="grid-cell"><span name="attr_ride_bicycle_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>
          </div>
        </div>
      </div>

      <!-- Investigation Skill Group -->
      <div class="skill-section-collapsible">
        <input type="checkbox" class="skill-toggle" id="toggle_investigation_training" name="attr_toggle_investigation_training" value="1" checked hidden />
        <label class="skill-toggle-label" for="toggle_investigation_training">Investigation Skill Group Training = <span name="attr_investigation_string"></span></label>
        <div class="skill-group-content">
          <div class="sheet-spendblock">
            <input type="hidden" name="attr_spend_mode" value="0" />
            <div class="spend-mode">
              <button type="action" name="act_add_investigation" class="commit-spend-mode">Train (<span name="attr_investigation_cost"></span> skill points)</button>
              <button type="action" name="act_refund_investigation" class="commit-spend-mode">Refund (<span name="attr_investigation_refund"></span> skill points)</button>
              <div class="commit-spend-mode">
                Skill Points Left: <span name="attr_skill_points"></span>
              </div>
            </div>
            <div class="spacer-sm"></div>
          </div>
          <div class="sheet-grid-table four-col">
            <div class="grid-header"></div>
            <div class="grid-header">Attr Code</div>
            <div class="grid-header">Dice Code</div>
            <div class="grid-header"></div>

            <div class="grid-cell"><span name="attr_forensics_displayname"></span><span name="attr_forensics_specialized"></span></div>
            <div class="grid-cell"><span name="attr_forensics_attributes"></span></div>
            <div class="grid-cell"><span name="attr_forensics_string"></span></div>
            <div class="grid-cell">
              <input type="hidden" name="attr_forensics_active" value="2" />
              <div class="skill-roll-buttons">
                <button type="action" name="act_activate_forensics" class="activate-skill-button">Activate</button>
                <button type="action" name="act_undo_activate_forensics" class="undo-activate-skill-button">Undo</button>
                <span class="activated-label">Activated</span>
              </div>
            </div>

            <div class="grid-cell"><span name="attr_interrogation_displayname"></span><span name="attr_interrogation_specialized"></span></div>
            <div class="grid-cell"><span name="attr_interrogation_attributes"></span></div>
            <div class="grid-cell"><span name="attr_interrogation_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_investigate_displayname"></span><span name="attr_investigate_specialized"></span></div>
            <div class="grid-cell"><span name="attr_investigate_attributes"></span></div>
            <div class="grid-cell"><span name="attr_investigate_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_search_displayname"></span><span name="attr_search_specialized"></span></div>
            <div class="grid-cell"><span name="attr_search_attributes"></span></div>
            <div class="grid-cell"><span name="attr_search_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>
          </div>
        </div>
      </div>

      <!-- Knowledge Skill Group -->
      <div class="skill-section-collapsible">
        <input type="checkbox" class="skill-toggle" id="toggle_knowledge_training" name="attr_toggle_knowledge_training" value="1" checked hidden />
        <label class="skill-toggle-label" for="toggle_knowledge_training">Knowledge Skill Group Training = <span name="attr_knowledge_string"></span></label>
        <div class="skill-group-content">
          <div class="sheet-spendblock">
            <input type="hidden" name="attr_spend_mode" value="0" />
            <div class="spend-mode">
              <button type="action" name="act_add_knowledge" class="commit-spend-mode">Train (<span name="attr_knowledge_cost"></span> skill points)</button>
              <button type="action" name="act_refund_knowledge" class="commit-spend-mode">Refund (<span name="attr_knowledge_refund"></span> skill points)</button>
              <div class="commit-spend-mode">
                Skill Points Left: <span name="attr_skill_points"></span>
              </div>
            </div>
            <div class="spacer-sm"></div>
          </div>
          <div class="sheet-grid-table four-col">
            <div class="grid-header"></div>
            <div class="grid-header">Attr Code</div>
            <div class="grid-header">Dice Code</div>
            <div class="grid-header"></div>

            <div class="grid-cell"><span name="attr_appraisal_displayname"></span><span name="attr_appraisal_specialized"></span></div>
            <div class="grid-cell"><span name="attr_appraisal_attributes"></span></div>
            <div class="grid-cell"><span name="attr_appraisal_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_astronomy_displayname"></span><span name="attr_astronomy_specialized"></span></div>
            <div class="grid-cell"><span name="attr_astronomy_attributes"></span></div>
            <div class="grid-cell"><span name="attr_astronomy_string"></span></div>
            <div class="grid-cell">
              <input type="hidden" name="attr_astronomy_active" value="2" />
              <div class="skill-roll-buttons">
                <button type="action" name="act_activate_astronomy" class="activate-skill-button">Activate</button>
                <button type="action" name="act_undo_activate_astronomy" class="undo-activate-skill-button">Undo</button>
                <span class="activated-label">Activated</span>
              </div>
            </div>

            <div class="grid-cell"><span name="attr_biology_displayname"></span><span name="attr_biology_specialized"></span></div>
            <div class="grid-cell"><span name="attr_biology_attributes"></span></div>
            <div class="grid-cell"><span name="attr_biology_string"></span></div>
            <div class="grid-cell">
              <input type="hidden" name="attr_biology_active" value="2" />
              <div class="skill-roll-buttons">
                <button type="action" name="act_activate_biology" class="activate-skill-button">Activate</button>
                <button type="action" name="act_undo_activate_biology" class="undo-activate-skill-button">Undo</button>
                <span class="activated-label">Activated</span>
              </div>
            </div>

            <div class="grid-cell"><span name="attr_cartography_displayname"></span><span name="attr_cartography_specialized"></span></div>
            <div class="grid-cell"><span name="attr_cartography_attributes"></span></div>
            <div class="grid-cell"><span name="attr_cartography_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_chemistry_displayname"></span><span name="attr_chemistry_specialized"></span></div>
            <div class="grid-cell"><span name="attr_chemistry_attributes"></span></div>
            <div class="grid-cell"><span name="attr_chemistry_string"></span></div>
            <div class="grid-cell">
              <input type="hidden" name="attr_chemistry_active" value="2" />
              <div class="skill-roll-buttons">
                <button type="action" name="act_activate_chemistry" class="activate-skill-button">Activate</button>
                <button type="action" name="act_undo_activate_chemistry" class="undo-activate-skill-button">Undo</button>
                <span class="activated-label">Activated</span>
              </div>
            </div>

            <div class="grid-cell"><span name="attr_education_displayname"></span><span name="attr_education_specialized"></span></div>
            <div class="grid-cell"><span name="attr_education_attributes"></span></div>
            <div class="grid-cell"><span name="attr_education_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_engineering_displayname"></span><span name="attr_engineering_specialized"></span></div>
            <div class="grid-cell"><span name="attr_engineering_attributes"></span></div>
            <div class="grid-cell"><span name="attr_engineering_string"></span></div>
            <div class="grid-cell">
              <input type="hidden" name="attr_engineering_active" value="2" />
              <div class="skill-roll-buttons">
                <button type="action" name="act_activate_engineering" class="activate-skill-button">Activate</button>
                <button type="action" name="act_undo_activate_engineering" class="undo-activate-skill-button">Undo</button>
                <span class="activated-label">Activated</span>
              </div>
            </div>

            <div class="grid-cell"><span name="attr_law_displayname"></span><span name="attr_law_specialized"></span></div>
            <div class="grid-cell"><span name="attr_law_attributes"></span></div>
            <div class="grid-cell"><span name="attr_law_string"></span></div>
            <div class="grid-cell">
              <input type="hidden" name="attr_law_active" value="2" />
              <div class="skill-roll-buttons">
                <button type="action" name="act_activate_law" class="activate-skill-button">Activate</button>
                <button type="action" name="act_undo_activate_law" class="undo-activate-skill-button">Undo</button>
                <span class="activated-label">Activated</span>
              </div>
            </div>

            <div class="grid-cell"><span name="attr_linguistics_displayname"></span><span name="attr_linguistics_specialized"></span></div>
            <div class="grid-cell"><span name="attr_linguistics_attributes"></span></div>
            <div class="grid-cell"><span name="attr_linguistics_string"></span></div>
            <div class="grid-cell">
              <input type="hidden" name="attr_linguistics_active" value="2" />
              <div class="skill-roll-buttons">
                <button type="action" name="act_activate_linguistics" class="activate-skill-button">Activate</button>
                <button type="action" name="act_undo_activate_linguistics" class="undo-activate-skill-button">Undo</button>
                <span class="activated-label">Activated</span>
              </div>
            </div>

            <div class="grid-cell"><span name="attr_mathematics_displayname"></span><span name="attr_mathematics_specialized"></span></div>
            <div class="grid-cell"><span name="attr_mathematics_attributes"></span></div>
            <div class="grid-cell"><span name="attr_mathematics_string"></span></div>
            <div class="grid-cell">
              <input type="hidden" name="attr_mathematics_active" value="2" />
              <div class="skill-roll-buttons">
                <button type="action" name="act_activate_mathematics" class="activate-skill-button">Activate</button>
                <button type="action" name="act_undo_activate_mathematics" class="undo-activate-skill-button">Undo</button>
                <span class="activated-label">Activated</span>
              </div>
            </div>

            <div class="grid-cell"><span name="attr_physics_displayname"></span><span name="attr_physics_specialized"></span></div>
            <div class="grid-cell"><span name="attr_physics_attributes"></span></div>
            <div class="grid-cell"><span name="attr_physics_string"></span></div>
            <div class="grid-cell">
              <input type="hidden" name="attr_physics_active" value="2" />
              <div class="skill-roll-buttons">
                <button type="action" name="act_activate_physics" class="activate-skill-button">Activate</button>
                <button type="action" name="act_undo_activate_physics" class="undo-activate-skill-button">Undo</button>
                <span class="activated-label">Activated</span>
              </div>
            </div>

            <div class="grid-cell"><span name="attr_writing_displayname"></span><span name="attr_writing_specialized"></span></div>
            <div class="grid-cell"><span name="attr_writing_attributes"></span></div>
            <div class="grid-cell"><span name="attr_writing_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>
          </div>
          <span class="small-hint">Activating a skill costs 12 skill points.</span>
        </div>
      </div>

      <!-- Medical Skill Group -->
      <div class="skill-section-collapsible">
        <input type="checkbox" class="skill-toggle" id="toggle_medical_training" name="attr_toggle_medical_training" value="1" checked hidden />
        <label class="skill-toggle-label" for="toggle_medical_training">Medical Skill Group Training = <span name="attr_medical_string"></span></label>
        <div class="skill-group-content">
          <div class="sheet-spendblock">
            <input type="hidden" name="attr_spend_mode" value="0" />
            <div class="spend-mode">
              <button type="action" name="act_add_medical" class="commit-spend-mode">Train (<span name="attr_medical_cost"></span> skill points)</button>
              <button type="action" name="act_refund_medical" class="commit-spend-mode">Refund (<span name="attr_medical_refund"></span> skill points)</button>
              <div class="commit-spend-mode">
                Skill Points Left: <span name="attr_skill_points"></span>
              </div>
            </div>
            <div class="spacer-sm"></div>
          </div>
          <div class="sheet-grid-table four-col">
            <div class="grid-header"></div>
            <div class="grid-header">Attr Code</div>
            <div class="grid-header">Dice Code</div>
            <div class="grid-header"></div>

            <div class="grid-cell"><span name="attr_first_aid_displayname"></span><span name="attr_first_aid_specialized"></span></div>
            <div class="grid-cell"><span name="attr_first_aid_attributes"></span></div>
            <div class="grid-cell"><span name="attr_first_aid_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_medical_care_displayname"></span><span name="attr_medical_care_specialized"></span></div>
            <div class="grid-cell"><span name="attr_medical_care_attributes"></span></div>
            <div class="grid-cell"><span name="attr_medical_care_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_pharmacology_displayname"></span><span name="attr_pharmacology_specialized"></span></div>
            <div class="grid-cell"><span name="attr_pharmacology_attributes"></span></div>
            <div class="grid-cell"><span name="attr_pharmacology_string"></span></div>
            <div class="grid-cell">
              <input type="hidden" name="attr_pharmacology_active" value="2" />
              <div class="skill-roll-buttons">
                <button type="action" name="act_activate_pharmacology" class="activate-skill-button">Activate</button>
                <button type="action" name="act_undo_activate_pharmacology" class="undo-activate-skill-button">Undo</button>
                <span class="activated-label">Activated</span>
              </div>
            </div>

            <div class="grid-cell"><span name="attr_psychiatry_displayname"></span><span name="attr_psychiatry_specialized"></span></div>
            <div class="grid-cell"><span name="attr_psychiatry_attributes"></span></div>
            <div class="grid-cell"><span name="attr_psychiatry_string"></span></div>
            <div class="grid-cell">
              <input type="hidden" name="attr_psychiatry_active" value="2" />
              <div class="skill-roll-buttons">
                <button type="action" name="act_activate_psychiatry" class="activate-skill-button">Activate</button>
                <button type="action" name="act_undo_activate_psychiatry" class="undo-activate-skill-button">Undo</button>
                <span class="activated-label">Activated</span>
              </div>
            </div>

            <div class="grid-cell"><span name="attr_surgery_displayname"></span><span name="attr_surgery_specialized"></span></div>
            <div class="grid-cell"><span name="attr_surgery_attributes"></span></div>
            <div class="grid-cell"><span name="attr_surgery_string"></span></div>
            <div class="grid-cell">
              <input type="hidden" name="attr_surgery_active" value="2" />
              <div class="skill-roll-buttons">
                <button type="action" name="act_activate_surgery" class="activate-skill-button">Activate</button>
                <button type="action" name="act_undo_activate_surgery" class="undo-activate-skill-button">Undo</button>
                <span class="activated-label">Activated</span>
              </div>
            </div>
          </div>
          <span class="small-hint">Activating a skill costs 12 skill points.</span>
        </div>
      </div>

      <!-- Military Training Skill Group -->
      <div class="skill-section-collapsible">
        <input type="checkbox" class="skill-toggle" id="toggle_military_training_training" name="attr_toggle_military_training_training" value="1" checked hidden />
        <label class="skill-toggle-label" for="toggle_military_training_training">Military Training Skill Group Training = <span name="attr_military_training_string"></span></label>
        <div class="skill-group-content">
          <div class="sheet-spendblock">
            <input type="hidden" name="attr_spend_mode" value="0" />
            <div class="spend-mode">
              <button type="action" name="act_add_military_training" class="commit-spend-mode">Train (<span name="attr_military_training_cost"></span> skill points)</button>
              <button type="action" name="act_refund_military_training" class="commit-spend-mode">Refund (<span name="attr_military_training_refund"></span> skill points)</button>
              <div class="commit-spend-mode">
                Skill Points Left: <span name="attr_skill_points"></span>
              </div>
            </div>
            <div class="spacer-sm"></div>
          </div>
          <div class="sheet-grid-table four-col">
            <div class="grid-header"></div>
            <div class="grid-header">Attr Code</div>
            <div class="grid-header">Dice Code</div>
            <div class="grid-header"></div>

            <div class="grid-cell"><span name="attr_camouflage_displayname"></span><span name="attr_camouflage_specialized"></span></div>
            <div class="grid-cell"><span name="attr_camouflage_attributes"></span></div>
            <div class="grid-cell"><span name="attr_camouflage_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_command_displayname"></span><span name="attr_command_specialized"></span></div>
            <div class="grid-cell"><span name="attr_command_attributes"></span></div>
            <div class="grid-cell"><span name="attr_command_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_hand_signals_displayname"></span><span name="attr_hand_signals_specialized"></span></div>
            <div class="grid-cell"><span name="attr_hand_signals_attributes"></span></div>
            <div class="grid-cell"><span name="attr_hand_signals_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_spycraft_displayname"></span><span name="attr_spycraft_specialized"></span></div>
            <div class="grid-cell"><span name="attr_spycraft_attributes"></span></div>
            <div class="grid-cell"><span name="attr_spycraft_string"></span></div>
            <div class="grid-cell">
              <input type="hidden" name="attr_spycraft_active" value="2" />
              <div class="skill-roll-buttons">
                <button type="action" name="act_activate_spycraft" class="activate-skill-button">Activate</button>
                <button type="action" name="act_undo_activate_spycraft" class="undo-activate-skill-button">Undo</button>
                <span class="activated-label">Activated</span>
              </div>
            </div>

            <div class="grid-cell"><span name="attr_tactics_displayname"></span><span name="attr_tactics_specialized"></span></div>
            <div class="grid-cell"><span name="attr_tactics_attributes"></span></div>
            <div class="grid-cell"><span name="attr_tactics_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

          </div>
        </div>
      </div>

      <!-- Performance Skill Group -->
      <div class="skill-section-collapsible">
        <input type="checkbox" class="skill-toggle" id="toggle_performance_training" name="attr_toggle_performance_training" value="1" checked hidden />
        <label class="skill-toggle-label" for="toggle_performance_training">Performance Skill Group Training = <span name="attr_performance_string"></span></label>
        <div class="skill-group-content">
          <div class="sheet-spendblock">
            <input type="hidden" name="attr_spend_mode" value="0" />
            <div class="spend-mode">
              <button type="action" name="act_add_performance" class="commit-spend-mode">Train (<span name="attr_performance_cost"></span> skill points)</button>
              <button type="action" name="act_refund_performance" class="commit-spend-mode">Refund (<span name="attr_performance_refund"></span> skill points)</button>
              <div class="commit-spend-mode">
                Skill Points Left: <span name="attr_skill_points"></span>
              </div>
            </div>
            <div class="spacer-sm"></div>
          </div>
          <div class="sheet-grid-table four-col">
            <div class="grid-header"></div>
            <div class="grid-header">Attr Code</div>
            <div class="grid-header">Dice Code</div>
            <div class="grid-header"></div>

            <div class="grid-cell"><span name="attr_acting_displayname"></span><span name="attr_acting_specialized"></span></div>
            <div class="grid-cell"><span name="attr_acting_attributes"></span></div>
            <div class="grid-cell"><span name="attr_acting_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_art_displayname"></span><span name="attr_art_specialized"></span></div>
            <div class="grid-cell"><span name="attr_art_attributes"></span></div>
            <div class="grid-cell"><span name="attr_art_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_comedy_displayname"></span><span name="attr_comedy_specialized"></span></div>
            <div class="grid-cell"><span name="attr_comedy_attributes"></span></div>
            <div class="grid-cell"><span name="attr_comedy_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_dance_displayname"></span><span name="attr_dance_specialized"></span></div>
            <div class="grid-cell"><span name="attr_dance_attributes"></span></div>
            <div class="grid-cell"><span name="attr_dance_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_disguise_displayname"></span><span name="attr_disguise_specialized"></span></div>
            <div class="grid-cell"><span name="attr_disguise_attributes"></span></div>
            <div class="grid-cell"><span name="attr_disguise_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_gambling_displayname"></span><span name="attr_gambling_specialized"></span></div>
            <div class="grid-cell"><span name="attr_gambling_attributes"></span></div>
            <div class="grid-cell"><span name="attr_gambling_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_play_instrument_displayname"></span><span name="attr_play_instrument_specialized"></span></div>
            <div class="grid-cell"><span name="attr_play_instrument_attributes"></span></div>
            <div class="grid-cell"><span name="attr_play_instrument_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_showmanship_displayname"></span><span name="attr_showmanship_specialized"></span></div>
            <div class="grid-cell"><span name="attr_showmanship_attributes"></span></div>
            <div class="grid-cell"><span name="attr_showmanship_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_sing_displayname"></span><span name="attr_sing_specialized"></span></div>
            <div class="grid-cell"><span name="attr_sing_attributes"></span></div>
            <div class="grid-cell"><span name="attr_sing_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>
          </div>
        </div>
      </div>

      <!-- Physical Skill Group -->
      <div class="skill-section-collapsible">
        <input type="checkbox" class="skill-toggle" id="toggle_physical_training" name="attr_toggle_physical_training" value="1" checked hidden />
        <label class="skill-toggle-label" for="toggle_physical_training">Physical Skill Group Training = <span name="attr_physical_string"></span></label>
        <div class="skill-group-content">
          <div class="sheet-spendblock">
            <input type="hidden" name="attr_spend_mode" value="0" />
            <div class="spend-mode">
              <button type="action" name="act_add_physical" class="commit-spend-mode">Train (<span name="attr_physical_cost"></span> skill points)</button>
              <button type="action" name="act_refund_physical" class="commit-spend-mode">Refund (<span name="attr_physical_refund"></span> skill points)</button>
              <div class="commit-spend-mode">
                Skill Points Left: <span name="attr_skill_points"></span>
              </div>
              <div class="spacer-sm"></div>
            </div>
            <div class="sheet-grid-table four-col">
              <div class="grid-header">Skill</div>
              <div class="grid-header">Attr Code</div>
              <div class="grid-header">Dice Code</div>
              <div class="grid-header">Roll</div>

              <div class="grid-cell"><span name="attr_acrobatics_displayname"></span><span name="attr_acrobatics_specialized"></span></div>
              <div class="grid-cell"><span name="attr_acrobatics_attributes"></span></div>
              <div class="grid-cell"><span name="attr_acrobatics_string"></span></div>
              <div class="grid-cell"><span>Activated</span></div>

              <div class="grid-cell"><span name="attr_athletics_displayname"></span><span name="attr_athletics_specialized"></span></div>
              <div class="grid-cell"><span name="attr_athletics_attributes"></span></div>
              <div class="grid-cell"><span name="attr_athletics_string"></span></div>
              <div class="grid-cell"><span>Activated</span></div>

              <div class="grid-cell"><span name="attr_climbing_displayname"></span><span name="attr_climbing_specialized"></span></div>
              <div class="grid-cell"><span name="attr_climbing_attributes"></span></div>
              <div class="grid-cell"><span name="attr_climbing_string"></span></div>
              <div class="grid-cell"><span>Activated</span></div>

              <div class="grid-cell"><span name="attr_jumping_displayname"></span><span name="attr_jumping_specialized"></span></div>
              <div class="grid-cell"><span name="attr_jumping_attributes"></span></div>
              <div class="grid-cell"><span name="attr_jumping_string"></span></div>
              <div class="grid-cell"><span>Activated</span></div>

              <div class="grid-cell"><span name="attr_lifting_displayname"></span><span name="attr_lifting_specialized"></span></div>
              <div class="grid-cell"><span name="attr_lifting_attributes"></span></div>
              <div class="grid-cell"><span name="attr_lifting_string"></span></div>
              <div class="grid-cell"><span>Activated</span></div>

              <div class="grid-cell"><span name="attr_swimming_displayname"></span><span name="attr_swimming_specialized"></span></div>
              <div class="grid-cell"><span name="attr_swimming_attributes"></span></div>
              <div class="grid-cell"><span name="attr_swimming_string"></span></div>
              <div class="grid-cell"><span>Activated</span></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Social Skill Group -->
      <div class="skill-section-collapsible">
        <input type="checkbox" class="skill-toggle" id="toggle_social_training" name="attr_toggle_social_training" value="1" checked hidden />
        <label class="skill-toggle-label" for="toggle_social_training">Social Skill Group Training = <span name="attr_social_string"></span></label>
        <div class="skill-group-content">
          <div class="sheet-spendblock">
            <input type="hidden" name="attr_spend_mode" value="0" />
            <div class="spend-mode">
              <button type="action" name="act_add_social" class="commit-spend-mode">Train (<span name="attr_social_cost"></span> skill points)</button>
              <button type="action" name="act_refund_social" class="commit-spend-mode">Refund (<span name="attr_social_refund"></span> skill points)</button>
              <div class="commit-spend-mode">
                Skill Points Left: <span name="attr_skill_points"></span>
              </div>
            </div>
            <div class="spacer-sm"></div>
          </div>
          <div class="sheet-grid-table four-col">
            <div class="grid-header">Skill</div>
            <div class="grid-header">Attr Code</div>
            <div class="grid-header">Dice Code</div>
            <div class="grid-header">Roll</div>

            <div class="grid-cell"><span name="attr_bureaucracy_displayname"></span><span name="attr_bureaucracy_specialized"></span></div>
            <div class="grid-cell"><span name="attr_bureaucracy_attributes"></span></div>
            <div class="grid-cell"><span name="attr_bureaucracy_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_deceive_displayname"></span><span name="attr_deceive_specialized"></span></div>
            <div class="grid-cell"><span name="attr_deceive_attributes"></span></div>
            <div class="grid-cell"><span name="attr_deceive_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_etiquette_displayname"></span><span name="attr_etiquette_specialized"></span></div>
            <div class="grid-cell"><span name="attr_etiquette_attributes"></span></div>
            <div class="grid-cell"><span name="attr_etiquette_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_intimidate_displayname"></span><span name="attr_intimidate_specialized"></span></div>
            <div class="grid-cell"><span name="attr_intimidate_attributes"></span></div>
            <div class="grid-cell"><span name="attr_intimidate_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_negotiate_displayname"></span><span name="attr_negotiate_specialized"></span></div>
            <div class="grid-cell"><span name="attr_negotiate_attributes"></span></div>
            <div class="grid-cell"><span name="attr_negotiate_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_persuade_displayname"></span><span name="attr_persuade_specialized"></span></div>
            <div class="grid-cell"><span name="attr_persuade_attributes"></span></div>
            <div class="grid-cell"><span name="attr_persuade_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_seduce_displayname"></span><span name="attr_seduce_specialized"></span></div>
            <div class="grid-cell"><span name="attr_seduce_attributes"></span></div>
            <div class="grid-cell"><span name="attr_seduce_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_streetwise_displayname"></span><span name="attr_streetwise_specialized"></span></div>
            <div class="grid-cell"><span name="attr_streetwise_attributes"></span></div>
            <div class="grid-cell"><span name="attr_streetwise_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>
          </div>
        </div>
      </div>

      <!-- Stealth Skill Group -->
      <div class="skill-section-collapsible">
        <input type="checkbox" class="skill-toggle" id="toggle_stealth_training" name="attr_toggle_stealth_training" value="1" checked hidden />
        <label class="skill-toggle-label" for="toggle_stealth_training">Stealth Skill Group Training = <span name="attr_stealth_string"></span></label>
        <div class="skill-group-content">
          <div class="sheet-spendblock">
            <input type="hidden" name="attr_spend_mode" value="0" />
            <div class="spend-mode">
              <button type="action" name="act_add_stealth" class="commit-spend-mode">Train (<span name="attr_stealth_cost"></span> skill points)</button>
              <button type="action" name="act_refund_stealth" class="commit-spend-mode">Refund (<span name="attr_stealth_refund"></span> skill points)</button>
              <div class="commit-spend-mode">
                Skill Points Left: <span name="attr_skill_points"></span>
              </div>
            </div>
            <div class="spacer-sm"></div>
          </div>
          <div class="sheet-grid-table four-col">
            <div class="grid-header">Skill</div>
            <div class="grid-header">Attr Code</div>
            <div class="grid-header">Dice Code</div>
            <div class="grid-header">Roll</div>

            <div class="grid-cell"><span name="attr_hide_displayname"></span><span name="attr_hide_specialized"></span></div>
            <div class="grid-cell"><span name="attr_hide_attributes"></span></div>
            <div class="grid-cell"><span name="attr_hide_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_sneak_displayname"></span><span name="attr_sneak_specialized"></span></div>
            <div class="grid-cell"><span name="attr_sneak_attributes"></span></div>
            <div class="grid-cell"><span name="attr_sneak_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_subtle_displayname"></span><span name="attr_subtle_specialized"></span></div>
            <div class="grid-cell"><span name="attr_subtle_attributes"></span></div>
            <div class="grid-cell"><span name="attr_subtle_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_surveillance_displayname"></span><span name="attr_surveillance_specialized"></span></div>
            <div class="grid-cell"><span name="attr_surveillance_attributes"></span></div>
            <div class="grid-cell"><span name="attr_surveillance_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>
          </div>
        </div>
      </div>

      <!-- Survival Skill Group -->
      <div class="skill-section-collapsible">
        <input type="checkbox" class="skill-toggle" id="toggle_survival_training" name="attr_toggle_survival_training" value="1" checked hidden />
        <label class="skill-toggle-label" for="toggle_survival_training">Survival Skill Group Training = <span name="attr_survival_string"></span></label>
        <div class="skill-group-content">
          <div class="sheet-spendblock">
            <input type="hidden" name="attr_spend_mode" value="0" />
            <div class="spend-mode">
              <button type="action" name="act_add_survival" class="commit-spend-mode">Train (<span name="attr_survival_cost"></span> skill points)</button>
              <button type="action" name="act_refund_survival" class="commit-spend-mode">Refund (<span name="attr_survival_refund"></span> skill points)</button>
              <div class="commit-spend-mode">
                Skill Points Left: <span name="attr_skill_points"></span>
              </div>
            </div>
            <div class="spacer-sm"></div>
          </div>
          <div class="sheet-grid-table four-col">
            <div class="grid-header">Skill</div>
            <div class="grid-header">Attr Code</div>
            <div class="grid-header">Dice Code</div>
            <div class="grid-header">Roll</div>

            <div class="grid-cell"><span name="attr_cooking_displayname"></span><span name="attr_cooking_specialized"></span></div>
            <div class="grid-cell"><span name="attr_cooking_attributes"></span></div>
            <div class="grid-cell"><span name="attr_cooking_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_foraging_displayname"></span><span name="attr_foraging_specialized"></span></div>
            <div class="grid-cell"><span name="attr_foraging_attributes"></span></div>
            <div class="grid-cell"><span name="attr_foraging_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_hunting_displayname"></span><span name="attr_hunting_specialized"></span></div>
            <div class="grid-cell"><span name="attr_hunting_attributes"></span></div>
            <div class="grid-cell"><span name="attr_hunting_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_scavenging_displayname"></span><span name="attr_scavenging_specialized"></span></div>
            <div class="grid-cell"><span name="attr_scavenging_attributes"></span></div>
            <div class="grid-cell"><span name="attr_scavenging_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_tracking_displayname"></span><span name="attr_tracking_specialized"></span></div>
            <div class="grid-cell"><span name="attr_tracking_attributes"></span></div>
            <div class="grid-cell"><span name="attr_tracking_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>
          </div>
        </div>
      </div>

      <!-- Technical Skill Group -->
      <div class="skill-section-collapsible">
        <input type="checkbox" class="skill-toggle" id="toggle_technical_training" name="attr_toggle_technical_training" value="1" checked hidden />
        <label class="skill-toggle-label" for="toggle_technical_training">Technical Skill Group Training = <span name="attr_technical_string"></span></label>
        <div class="skill-group-content">
          <div class="sheet-spendblock">
            <input type="hidden" name="attr_spend_mode" value="0" />
            <div class="spend-mode">
              <button type="action" name="act_add_technical" class="commit-spend-mode">Train (<span name="attr_technical_cost"></span> skill points)</button>
              <button type="action" name="act_refund_technical" class="commit-spend-mode">Refund (<span name="attr_technical_refund"></span> skill points)</button>
              <div class="commit-spend-mode">
                Skill Points Left: <span name="attr_skill_points"></span>
              </div>
            </div>
            <div class="spacer-sm"></div>
          </div>
          <div class="sheet-grid-table four-col">
            <div class="grid-header">Skill</div>
            <div class="grid-header">Attr Code</div>
            <div class="grid-header">Dice Code</div>
            <div class="grid-header">Roll</div>

            <div class="grid-cell"><span name="attr_build_displayname"></span><span name="attr_build_specialized"></span></div>
            <div class="grid-cell"><span name="attr_build_attributes"></span></div>
            <div class="grid-cell"><span name="attr_build_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_carpentry_displayname"></span><span name="attr_carpentry_specialized"></span></div>
            <div class="grid-cell"><span name="attr_carpentry_attributes"></span></div>
            <div class="grid-cell"><span name="attr_carpentry_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_electronics_displayname"></span><span name="attr_electronics_specialized"></span></div>
            <div class="grid-cell"><span name="attr_electronics_attributes"></span></div>
            <div class="grid-cell"><span name="attr_electronics_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_explosives_displayname"></span><span name="attr_explosives_specialized"></span></div>
            <div class="grid-cell"><span name="attr_explosives_attributes"></span></div>
            <div class="grid-cell"><span name="attr_explosives_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_gunsmithing_displayname"></span><span name="attr_gunsmithing_specialized"></span></div>
            <div class="grid-cell"><span name="attr_gunsmithing_attributes"></span></div>
            <div class="grid-cell"><span name="attr_gunsmithing_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_jury_rig_displayname"></span><span name="attr_jury_rig_specialized"></span></div>
            <div class="grid-cell"><span name="attr_jury_rig_attributes"></span></div>
            <div class="grid-cell"><span name="attr_jury_rig_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_mechanical_displayname"></span><span name="attr_mechanical_specialized"></span></div>
            <div class="grid-cell"><span name="attr_mechanical_attributes"></span></div>
            <div class="grid-cell"><span name="attr_mechanical_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_repair_displayname"></span><span name="attr_repair_specialized"></span></div>
            <div class="grid-cell"><span name="attr_repair_attributes"></span></div>
            <div class="grid-cell"><span name="attr_repair_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_welding_displayname"></span><span name="attr_welding_specialized"></span></div>
            <div class="grid-cell"><span name="attr_welding_attributes"></span></div>
            <div class="grid-cell"><span name="attr_welding_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>
          </div>
        </div>
      </div>

      <!-- Thievery Skill Group -->
      <div class="skill-section-collapsible">
        <input type="checkbox" class="skill-toggle" id="toggle_thievery_training" name="attr_toggle_thievery_training" value="1" checked hidden />
        <label class="skill-toggle-label" for="toggle_thievery_training">Thievery Skill Group Training = <span name="attr_thievery_string"></span></label>
        <div class="skill-group-content">
          <div class="sheet-spendblock">
            <input type="hidden" name="attr_spend_mode" value="0" />
            <div class="spend-mode">
              <button type="action" name="act_add_thievery" class="commit-spend-mode">Train (<span name="attr_thievery_cost"></span> skill points)</button>
              <button type="action" name="act_refund_thievery" class="commit-spend-mode">Refund (<span name="attr_thievery_refund"></span> skill points)</button>
              <div class="commit-spend-mode">
                Skill Points Left: <span name="attr_skill_points"></span>
              </div>
            </div>
            <div class="spacer-sm"></div>
          </div>
          <div class="sheet-grid-table four-col">
            <div class="grid-header">Skill</div>
            <div class="grid-header">Attr Code</div>
            <div class="grid-header">Dice Code</div>
            <div class="grid-header">Roll</div>

            <div class="grid-cell"><span name="attr_cheating_displayname"></span><span name="attr_cheating_specialized"></span></div>
            <div class="grid-cell"><span name="attr_cheating_attributes"></span></div>
            <div class="grid-cell"><span name="attr_cheating_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_forgery_displayname"></span><span name="attr_forgery_specialized"></span></div>
            <div class="grid-cell"><span name="attr_forgery_attributes"></span></div>
            <div class="grid-cell"><span name="attr_forgery_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_lockpicking_displayname"></span><span name="attr_lockpicking_specialized"></span></div>
            <div class="grid-cell"><span name="attr_lockpicking_attributes"></span></div>
            <div class="grid-cell"><span name="attr_lockpicking_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_sleight_of_hand_displayname"></span><span name="attr_sleight_of_hand_specialized"></span></div>
            <div class="grid-cell"><span name="attr_sleight_of_hand_attributes"></span></div>
            <div class="grid-cell"><span name="attr_sleight_of_hand_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>
          </div>
        </div>
      </div>

      <h3>Combat Skills</h3>
      <div class="spacer-md"></div>

      <!-- Armed Skill Group -->
      <div class="skill-section-collapsible">
        <input type="checkbox" class="skill-toggle" id="toggle_armed_training" name="attr_toggle_armed_training" value="1" checked hidden />
        <label class="skill-toggle-label" for="toggle_armed_training">Armed Skill Group Training = <span name="attr_armed_string"></span></label>
        <div class="skill-group-content">
          <div class="sheet-spendblock">
            <input type="hidden" name="attr_spend_mode" value="0" />
            <div class="spend-mode">
              <button type="action" name="act_add_armed" class="commit-spend-mode">Train (<span name="attr_armed_cost"></span> skill points)</button>
              <button type="action" name="act_refund_armed" class="commit-spend-mode">Refund (<span name="attr_armed_refund"></span> skill points)</button>
              <div class="commit-spend-mode">
                Skill Points Left: <span name="attr_skill_points"></span>
              </div>
            </div>
            <div class="spacer-sm"></div>
          </div>
          <div class="sheet-grid-table four-col">
            <div class="grid-header">Skill</div>
            <div class="grid-header">Attr Code</div>
            <div class="grid-header">Dice Code</div>
            <div class="grid-header">Roll</div>

            <div class="grid-cell"><span name="attr_electroshock_displayname"></span><span name="attr_electroshock_specialized"></span></div>
            <div class="grid-cell"><span name="attr_electroshock_attributes"></span></div>
            <div class="grid-cell"><span name="attr_electroshock_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_improvised_weapon_displayname"></span><span name="attr_improvised_weapon_specialized"></span></div>
            <div class="grid-cell"><span name="attr_improvised_weapon_attributes"></span></div>
            <div class="grid-cell"><span name="attr_improvised_weapon_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_melee_weapon_displayname"></span><span name="attr_melee_weapon_specialized"></span></div>
            <div class="grid-cell"><span name="attr_melee_weapon_attributes"></span></div>
            <div class="grid-cell"><span name="attr_melee_weapon_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>
          </div>
        </div>
      </div>

      <!-- Longarms Skill Group -->
      <div class="skill-section-collapsible">
        <input type="checkbox" class="skill-toggle" id="toggle_longarms_training" name="attr_toggle_longarms_training" value="1" checked hidden />
        <label class="skill-toggle-label" for="toggle_longarms_training">Longarms Skill Group Training = <span name="attr_longarms_string"></span></label>
        <div class="skill-group-content">
          <div class="sheet-spendblock">
            <input type="hidden" name="attr_spend_mode" value="0" />
            <div class="spend-mode">
              <button type="action" name="act_add_longarms" class="commit-spend-mode">Train (<span name="attr_longarms_cost"></span> skill points)</button>
              <button type="action" name="act_refund_longarms" class="commit-spend-mode">Refund (<span name="attr_longarms_refund"></span> skill points)</button>
              <div class="commit-spend-mode">
                Skill Points Left: <span name="attr_skill_points"></span>
              </div>
            </div>
            <div class="spacer-sm"></div>
          </div>
          <div class="sheet-grid-table four-col">
            <div class="grid-header">Skill</div>
            <div class="grid-header">Attr Code</div>
            <div class="grid-header">Dice Code</div>
            <div class="grid-header">Roll</div>

            <div class="grid-cell"><span name="attr_automatic_rifle_displayname"></span><span name="attr_automatic_rifle_specialized"></span></div>
            <div class="grid-cell"><span name="attr_automatic_rifle_attributes"></span></div>
            <div class="grid-cell"><span name="attr_automatic_rifle_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_rifle_displayname"></span><span name="attr_rifle_specialized"></span></div>
            <div class="grid-cell"><span name="attr_rifle_attributes"></span></div>
            <div class="grid-cell"><span name="attr_rifle_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_shotgun_displayname"></span><span name="attr_shotgun_specialized"></span></div>
            <div class="grid-cell"><span name="attr_shotgun_attributes"></span></div>
            <div class="grid-cell"><span name="attr_shotgun_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_sniper_rifle_displayname"></span><span name="attr_sniper_rifle_specialized"></span></div>
            <div class="grid-cell"><span name="attr_sniper_rifle_attributes"></span></div>
            <div class="grid-cell"><span name="attr_sniper_rifle_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>
          </div>
        </div>
      </div>

      <!-- Ranged Skill Group -->
      <div class="skill-section-collapsible">
        <input type="checkbox" class="skill-toggle" id="toggle_ranged_training" name="attr_toggle_ranged_training" value="1" checked hidden />
        <label class="skill-toggle-label" for="toggle_ranged_training">Ranged Skill Group Training = <span name="attr_ranged_string"></span></label>
        <div class="skill-group-content">
          <div class="sheet-spendblock">
            <input type="hidden" name="attr_spend_mode" value="0" />
            <div class="spend-mode">
              <button type="action" name="act_add_ranged" class="commit-spend-mode">Train (<span name="attr_ranged_cost"></span> skill points)</button>
              <button type="action" name="act_refund_ranged" class="commit-spend-mode">Refund (<span name="attr_ranged_refund"></span> skill points)</button>
              <div class="commit-spend-mode">
                Skill Points Left: <span name="attr_skill_points"></span>
              </div>
            </div>
            <div class="spacer-sm"></div>
          </div>
          <div class="sheet-grid-table four-col">
            <div class="grid-header">Skill</div>
            <div class="grid-header">Attr Code</div>
            <div class="grid-header">Dice Code</div>
            <div class="grid-header">Roll</div>

            <div class="grid-cell"><span name="attr_bow_displayname"></span><span name="attr_bow_specialized"></span></div>
            <div class="grid-cell"><span name="attr_bow_attributes"></span></div>
            <div class="grid-cell"><span name="attr_bow_string"></span></div>
            <div class="grid-cell">
              <input type="hidden" name="attr_bow_active" value="2" />
              <div class="skill-roll-buttons">
                <button type="action" name="act_activate_bow" class="activate-skill-button">Activate</button>
                <button type="action" name="act_undo_activate_bow" class="undo-activate-skill-button">Undo</button>
                <span class="activated-label">Activated</span>
              </div>
            </div>

            <div class="grid-cell"><span name="attr_crossbow_displayname"></span><span name="attr_crossbow_specialized"></span></div>
            <div class="grid-cell"><span name="attr_crossbow_attributes"></span></div>
            <div class="grid-cell"><span name="attr_crossbow_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_slingshot_displayname"></span><span name="attr_slingshot_specialized"></span></div>
            <div class="grid-cell"><span name="attr_slingshot_attributes"></span></div>
            <div class="grid-cell"><span name="attr_slingshot_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_thrown_displayname"></span><span name="attr_thrown_specialized"></span></div>
            <div class="grid-cell"><span name="attr_thrown_attributes"></span></div>
            <div class="grid-cell"><span name="attr_thrown_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>
          </div>
          <span class="small-hint">Activating a skill costs 12 skill points.</span>
        </div>
      </div>

      <!-- Sidearms Skill Group -->
      <div class="skill-section-collapsible">
        <input type="checkbox" class="skill-toggle" id="toggle_sidearms_training" name="attr_toggle_sidearms_training" value="1" checked hidden />
        <label class="skill-toggle-label" for="toggle_sidearms_training">Sidearms Skill Group Training = <span name="attr_sidearms_string"></span></label>
        <div class="skill-group-content">
          <div class="sheet-spendblock">
            <input type="hidden" name="attr_spend_mode" value="0" />
            <div class="spend-mode">
              <button type="action" name="act_add_sidearms" class="commit-spend-mode">Train (<span name="attr_sidearms_cost"></span> skill points)</button>
              <button type="action" name="act_refund_sidearms" class="commit-spend-mode">Refund (<span name="attr_sidearms_refund"></span> skill points)</button>
              <div class="commit-spend-mode">
                Skill Points Left: <span name="attr_skill_points"></span>
              </div>
            </div>
            <div class="spacer-sm"></div>
          </div>
          <div class="sheet-grid-table four-col">
            <div class="grid-header">Skill</div>
            <div class="grid-header">Attr Code</div>
            <div class="grid-header">Dice Code</div>
            <div class="grid-header">Roll</div>

            <div class="grid-cell"><span name="attr_automatic_handgun_displayname"></span><span name="attr_automatic_handgun_specialized"></span></div>
            <div class="grid-cell"><span name="attr_automatic_handgun_attributes"></span></div>
            <div class="grid-cell"><span name="attr_automatic_handgun_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_handgun_displayname"></span><span name="attr_handgun_specialized"></span></div>
            <div class="grid-cell"><span name="attr_handgun_attributes"></span></div>
            <div class="grid-cell"><span name="attr_handgun_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <div class="grid-cell"><span name="attr_sawed_off_shotgun_displayname"></span><span name="attr_sawed_off_shotgun_specialized"></span></div>
            <div class="grid-cell"><span name="attr_sawed_off_shotgun_attributes"></span></div>
            <div class="grid-cell"><span name="attr_sawed_off_shotgun_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>
          </div>
        </div>
      </div>

      <!-- Unarmed Skill Group -->
      <div class="skill-section-collapsible">
        <input type="checkbox" class="skill-toggle" id="toggle_unarmed_training" name="attr_toggle_unarmed_training" value="1" checked hidden />
        <label class="skill-toggle-label" for="toggle_unarmed_training">Unarmed Skill Group Training = <span name="attr_unarmed_string"></span></label>
        <div class="skill-group-content">
          <div class="sheet-spendblock">
            <input type="hidden" name="attr_spend_mode" value="0" />
            <div class="spend-mode">
              <button type="action" name="act_add_unarmed" class="commit-spend-mode">Train (<span name="attr_unarmed_cost"></span> skill points)</button>
              <button type="action" name="act_refund_unarmed" class="commit-spend-mode">Refund (<span name="attr_unarmed_refund"></span> skill points)</button>
              <div class="commit-spend-mode">Skill Points Left: <span name="attr_skill_points"></span></div>
            </div>
            <div class="spacer-sm"></div>
          </div>

          <div class="sheet-grid-table four-col">
            <div class="grid-header">Skill</div>
            <div class="grid-header">Attr Code</div>
            <div class="grid-header">Dice Code</div>
            <div class="grid-header">Roll</div>

            <!-- Brawling -->
            <div class="grid-cell"><span name="attr_brawling_displayname"></span><span name="attr_brawling_specialized"></span></div>
            <div class="grid-cell"><span name="attr_brawling_attributes"></span></div>
            <div class="grid-cell"><span name="attr_brawling_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <!-- Push -->
            <div class="grid-cell"><span name="attr_push_displayname"></span><span name="attr_push_specialized"></span></div>
            <div class="grid-cell"><span name="attr_push_attributes"></span></div>
            <div class="grid-cell"><span name="attr_push_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <!-- Wrestling -->
            <div class="grid-cell"><span name="attr_wrestling_displayname"></span><span name="attr_wrestling_specialized"></span></div>
            <div class="grid-cell"><span name="attr_wrestling_attributes"></span></div>
            <div class="grid-cell"><span name="attr_wrestling_string"></span></div>
            <div class="grid-cell"><span>Activated</span></div>

            <!-- Aikido -->
            <div class="grid-cell"><span name="attr_aikido_displayname"></span><span name="attr_aikido_specialized"></span></div>
            <div class="grid-cell"><span name="attr_aikido_attributes"></span></div>
            <div class="grid-cell"><span name="attr_aikido_string"></span></div>
            <div class="grid-cell">
              <input type="hidden" name="attr_aikido_active" value="2" />
              <div class="skill-roll-buttons">
                <button type="action" name="act_activate_aikido" class="activate-skill-button">Activate</button>
                <button type="action" name="act_undo_activate_aikido" class="undo-activate-skill-button">Undo</button>
                <span class="activated-label">Activated</span>
              </div>
            </div>

            <!-- Boxing -->
            <div class="grid-cell"><span name="attr_boxing_displayname"></span><span name="attr_boxing_specialized"></span></div>
            <div class="grid-cell"><span name="attr_boxing_attributes"></span></div>
            <div class="grid-cell"><span name="attr_boxing_string"></span></div>
            <div class="grid-cell">
              <input type="hidden" name="attr_boxing_active" value="2" />
              <div class="skill-roll-buttons">
                <button type="action" name="act_activate_boxing" class="activate-skill-button">Activate</button>
                <button type="action" name="act_undo_activate_boxing" class="undo-activate-skill-button">Undo</button>
                <span class="activated-label">Activated</span>
              </div>
            </div>

            <!-- Capoeira -->
            <div class="grid-cell"><span name="attr_capoeira_displayname"></span><span name="attr_capoeira_specialized"></span></div>
            <div class="grid-cell"><span name="attr_capoeira_attributes"></span></div>
            <div class="grid-cell"><span name="attr_capoeira_string"></span></div>
            <div class="grid-cell">
              <input type="hidden" name="attr_capoeira_active" value="2" />
              <div class="skill-roll-buttons">
                <button type="action" name="act_activate_capoeira" class="activate-skill-button">Activate</button>
                <button type="action" name="act_undo_activate_capoeira" class="undo-activate-skill-button">Undo</button>
                <span class="activated-label">Activated</span>
              </div>
            </div>

            <!-- Jeet Kune Do -->
            <div class="grid-cell"><span name="attr_jeet_kune_do_displayname"></span><span name="attr_jeet_kune_do_specialized"></span></div>
            <div class="grid-cell"><span name="attr_jeet_kune_do_attributes"></span></div>
            <div class="grid-cell"><span name="attr_jeet_kune_do_string"></span></div>
            <div class="grid-cell">
              <input type="hidden" name="attr_jeet_kune_do_active" value="2" />
              <div class="skill-roll-buttons">
                <button type="action" name="act_activate_jeet_kune_do" class="activate-skill-button">Activate</button>
                <button type="action" name="act_undo_activate_jeet_kune_do" class="undo-activate-skill-button">Undo</button>
                <span class="activated-label">Activated</span>
              </div>
            </div>

            <!-- Jiu-Jitsu -->
            <div class="grid-cell"><span name="attr_jiu_jitsu_displayname"></span><span name="attr_jiu_jitsu_specialized"></span></div>
            <div class="grid-cell"><span name="attr_jiu_jitsu_attributes"></span></div>
            <div class="grid-cell"><span name="attr_jiu_jitsu_string"></span></div>
            <div class="grid-cell">
              <input type="hidden" name="attr_jiu_jitsu_active" value="2" />
              <div class="skill-roll-buttons">
                <button type="action" name="act_activate_jiu_jitsu" class="activate-skill-button">Activate</button>
                <button type="action" name="act_undo_activate_jiu_jitsu" class="undo-activate-skill-button">Undo</button>
                <span class="activated-label">Activated</span>
              </div>
            </div>

            <!-- Judo -->
            <div class="grid-cell"><span name="attr_judo_displayname"></span><span name="attr_judo_specialized"></span></div>
            <div class="grid-cell"><span name="attr_judo_attributes"></span></div>
            <div class="grid-cell"><span name="attr_judo_string"></span></div>
            <div class="grid-cell">
              <input type="hidden" name="attr_judo_active" value="2" />
              <div class="skill-roll-buttons">
                <button type="action" name="act_activate_judo" class="activate-skill-button">Activate</button>
                <button type="action" name="act_undo_activate_judo" class="undo-activate-skill-button">Undo</button>
                <span class="activated-label">Activated</span>
              </div>
            </div>

            <!-- Karate -->
            <div class="grid-cell"><span name="attr_karate_displayname"></span><span name="attr_karate_specialized"></span></div>
            <div class="grid-cell"><span name="attr_karate_attributes"></span></div>
            <div class="grid-cell"><span name="attr_karate_string"></span></div>
            <div class="grid-cell">
              <input type="hidden" name="attr_karate_active" value="2" />
              <div class="skill-roll-buttons">
                <button type="action" name="act_activate_karate" class="activate-skill-button">Activate</button>
                <button type="action" name="act_undo_activate_karate" class="undo-activate-skill-button">Undo</button>
                <span class="activated-label">Activated</span>
              </div>
            </div>

            <!-- Krav Maga -->
            <div class="grid-cell"><span name="attr_krav_maga_displayname"></span><span name="attr_krav_maga_specialized"></span></div>
            <div class="grid-cell"><span name="attr_krav_maga_attributes"></span></div>
            <div class="grid-cell"><span name="attr_krav_maga_string"></span></div>
            <div class="grid-cell">
              <input type="hidden" name="attr_krav_maga_active" value="2" />
              <div class="skill-roll-buttons">
                <button type="action" name="act_activate_krav_maga" class="activate-skill-button">Activate</button>
                <button type="action" name="act_undo_activate_krav_maga" class="undo-activate-skill-button">Undo</button>
                <span class="activated-label">Activated</span>
              </div>
            </div>

            <!-- Muay Thai -->
            <div class="grid-cell"><span name="attr_muay_thai_displayname"></span><span name="attr_muay_thai_specialized"></span></div>
            <div class="grid-cell"><span name="attr_muay_thai_attributes"></span></div>
            <div class="grid-cell"><span name="attr_muay_thai_string"></span></div>
            <div class="grid-cell">
              <input type="hidden" name="attr_muay_thai_active" value="2" />
              <div class="skill-roll-buttons">
                <button type="action" name="act_activate_muay_thai" class="activate-skill-button">Activate</button>
                <button type="action" name="act_undo_activate_muay_thai" class="undo-activate-skill-button">Undo</button>
                <span class="activated-label">Activated</span>
              </div>
            </div>

            <!-- Sambo -->
            <div class="grid-cell"><span name="attr_sambo_displayname"></span><span name="attr_sambo_specialized"></span></div>
            <div class="grid-cell"><span name="attr_sambo_attributes"></span></div>
            <div class="grid-cell"><span name="attr_sambo_string"></span></div>
            <div class="grid-cell">
              <input type="hidden" name="attr_sambo_active" value="2" />
              <div class="skill-roll-buttons">
                <button type="action" name="act_activate_sambo" class="activate-skill-button">Activate</button>
                <button type="action" name="act_undo_activate_sambo" class="undo-activate-skill-button">Undo</button>
                <span class="activated-label">Activated</span>
              </div>
            </div>

            <!-- Savate -->
            <div class="grid-cell"><span name="attr_savate_displayname"></span><span name="attr_savate_specialized"></span></div>
            <div class="grid-cell"><span name="attr_savate_attributes"></span></div>
            <div class="grid-cell"><span name="attr_savate_string"></span></div>
            <div class="grid-cell">
              <input type="hidden" name="attr_savate_active" value="2" />
              <div class="skill-roll-buttons">
                <button type="action" name="act_activate_savate" class="activate-skill-button">Activate</button>
                <button type="action" name="act_undo_activate_savate" class="undo-activate-skill-button">Undo</button>
                <span class="activated-label">Activated</span>
              </div>
            </div>

            <!-- Taekwondo -->
            <div class="grid-cell"><span name="attr_taekwondo_displayname"></span><span name="attr_taekwondo_specialized"></span></div>
            <div class="grid-cell"><span name="attr_taekwondo_attributes"></span></div>
            <div class="grid-cell"><span name="attr_taekwondo_string"></span></div>
            <div class="grid-cell">
              <input type="hidden" name="attr_taekwondo_active" value="2" />
              <div class="skill-roll-buttons">
                <button type="action" name="act_activate_taekwondo" class="activate-skill-button">Activate</button>
                <button type="action" name="act_undo_activate_taekwondo" class="undo-activate-skill-button">Undo</button>
                <span class="activated-label">Activated</span>
              </div>
            </div>

          </div>

          <span class="small-hint">Activating a skill costs 12 skill points.</span>
        </div>
      </div>

    </div> <!-- End hide for NPCs -->
  </div> <!-- End Training -->

  <!-- PC/Major NPC Character Sheet -->
  <div class="sheet-step sheet-step-sheet sheet-mode-sheet">
      <div class="sheet-view-wrapper">
          <input type="hidden" name="attr_view_mode" value="character" />
          <div class="sheet-view-character">
              <!-- Expand/Collapse and Spend Controls -->
              <div class="sheet-controls-row">
                  <!-- Left: Expand/Collapse -->
                  <div class="sheet-controls-group">
                      <button type="action" class="sheet-d6pp" name="act_expand_all">Expand All</button>
                      <button type="action" class="sheet-d6pp" name="act_collapse_all">Collapse All</button>
                  </div>
                  <!-- Middle: Skill Points + Spend -->
                  <div class="sheet-controls-group">
                      <label for="attr_skill_points" class="sheet-d6pp-label">Skill Points:</label>
                      <input type="number" class="sheet-d6pp" name="attr_skill_points" value="1" id="attr_skill_points" />
                      <div class="sheet-spendblock">
                          <input type="hidden" name="attr_spend_mode" value="0" />
                          <div class="spend-mode">
                              <button type="action" name="act_enter_spend" class="enter-spend-mode">Enter Spend Mode</button>
                              <button type="action" name="act_commit_spend" class="commit-spend-mode">Commit Spend</button>
                          </div>
                      </div>
                  </div>
                  <!-- Right: View Inventory -->
                  <div class="sheet-controls-group">
                      <button type="action" class="sheet-d6pp" name="act_view_inventory">View Inventory</button>
                  </div>
              </div>
              <input type="hidden" name="attr_spend_mode" value="0" />
              <div class="hide-when-spending">
                  <!-- Character Info Grid -->
                  <div class="sheet-section-collapsible">
                      <input type="checkbox" class="skill-toggle" id="toggle_details" name="attr_toggle_details" value="1" checked hidden />
                      <label class="skill-toggle-label" for="toggle_details">Character Details</label>
                      <div class="skill-group-content">
                          <div class="sheet-character-top-grid">
                              <label class="sheet-d6pp-label">Name:</label>
                              <input type="text" class="sheet-d6pp" name="attr_character_name" />
                              <label class="sheet-d6pp-label">Age:</label>
                              <input type="text" class="sheet-d6pp" name="attr_character_age" />
                              <label class="sheet-d6pp-label">Height:</label>
                              <input type="text" class="sheet-d6pp" name="attr_character_height" />
                              <label class="sheet-d6pp-label">Weight:</label>
                              <input type="text" class="sheet-d6pp" name="attr_character_weight" />
                              <label class="sheet-d6pp-label">Gender:</label>
                              <input type="text" class="sheet-d6pp" name="attr_character_gender" />
                          </div>
                          <!-- Background and Description -->
                          <div class="sheet-character-desc-grid">
                              <label for="attr_background_combined" class="sheet-d6pp-label"><span name="attr_background_name"></span>:</label>
                              <label for="character_description" class="sheet-d6pp-label">Description:</label>
                              <textarea name="attr_background_combined" id="attr_background_combined" class="sheet-d6pp" rows="4" readonly></textarea>
                              <textarea class="sheet-d6pp" name="attr_character_description" rows="4" id="character_description"></textarea>
                          </div>
                          <div class="spacer-sm"></div>
                          <!-- GM Whisper + Move/Run/Advantage Row -->
                          <div class="sheet-controls-row" style="justify-content: space-between;">
                              <div class="d6pp-checkbox">
                                  <label class="inline-checkbox-label">
                                  <input type="checkbox" name="attr_whisper_toggle" value="/w gm " />
                                  Whisper to GM
                                  </label>
                              </div>
                              <div style="display: flex; align-items: center; gap: 8px;">
                                  <label class="sheet-d6pp-label">Move:</label>
                                  <input type="text" class="sheet-d6pp sheet-small-input" name="attr_current_move" readonly />
                                  <label class="sheet-d6pp-label">Run:</label>
                                  <input type="text" class="sheet-d6pp sheet-small-input" name="attr_current_run" readonly />
                                  <label class="sheet-d6pp-label">Advantage:</label>
                                  <input type="number" class="sheet-d6pp" name="attr_advantage" />
                              </div>
                          </div>
                      </div>
                  </div>
              </div>
              <!-- hide-when-spending -->
              <input type="hidden" name="attr_spend_mode" value="0" />
              <div class="hide-when-spending">
                    <!-- Quick Skill Finder -->
                  <div class="sheet-section-collapsible">
                      <input type="checkbox" class="skill-toggle" id="toggle_skill_finder" name="attr_toggle_skill_finder" value="1" checked hidden />
                      <label class="skill-toggle-label" for="toggle_skill_finder">Out-of-Combat Actions</label>
                      <div class="skill-group-content">
                        <div class="sheet-grid-table three-col">
                            <!-- Headers -->
                            <div class="grid-header">Skill</div>
                            <div class="grid-header">Skill Code</div>
                            <div class="grid-header">Roll</div>
                            <div class="grid-cell">
                              <select name="attr_searched_skill" class="sheet-d6pp-select">
                                <option value="">None</option>
                                <option value="acrobatics">Acrobatics (AAS)</option>
                                <option value="acting">Acting (CCP)</option>
                                <option value="aikido">Aikido (PIW)</option>
                                <option value="air_navigation">Air Navigation (PII)</option>
                                <option value="animal_care">Animal Care (PCW)</option>
                                <option value="animal_empathy">Animal Empathy (PPC)</option>
                                <option value="animal_handling">Animal Handling (ACP)</option>
                                <option value="animal_training">Animal Training (WPI)</option>
                                <option value="appraisal">Appraisal (PPI)</option>
                                <option value="archery">Bow (AAM)</option>
                                <option value="art">Art (MMP)</option>
                                <option value="astronomy">Astronomy (IIP)</option>
                                <option value="athletics">Athletics (SSA)</option>
                                <option value="automatic_handgun">Automatic Handgun (AAS)</option>
                                <option value="automatic_rifle">Automatic Rifle (AAS)</option>
                                <option value="avoid">Avoid (QPP)</option>
                                <option value="biology">Biology (IPP)</option>
                                <option value="boxing">Boxing (SAQ)</option>
                                <option value="brawling">Brawling (ASS)</option>
                                <option value="build">Build (MMA)</option>
                                <option value="bureaucracy">Bureaucracy (WWW)</option>
                                <option value="camouflage">Camouflage (MPP)</option>
                                <option value="capoeira">Capoeira (APQ)</option>
                                <option value="carpentry">Carpentry (MSW)</option>
                                <option value="cartography">Cartography (IIP)</option>
                                <option value="cheating">Cheating (MPW)</option>
                                <option value="chemistry">Chemistry (IMP)</option>
                                <option value="climbing">Climbing (SSH)</option>
                                <option value="command">Command (CCP)</option>
                                <option value="comedy">Comedy (CPP)</option>
                                <option value="computer_use">Computer Use (IIM)</option>
                                <option value="control_drone">Control Drone (PPM)</option>
                                <option value="cooking">Cooking (IWM)</option>
                                <option value="crossbow">Crossbow (APM)</option>
                                <option value="dance">Dance (CAP)</option>
                                <option value="deceive">Deceive (CPP)</option>
                                <option value="defend">Defend (SQP)</option>
                                <option value="disguise">Disguise (MIP)</option>
                                <option value="diving">Diving (HHW)</option>
                                <option value="dodge">Dodge (QPA)</option>
                                <option value="drive_boat">Drive Boat (AAQ)</option>
                                <option value="drive_car">Drive Car (AAQ)</option>
                                <option value="drive_motorcycle">Drive Motorcycle (AQW)</option>
                                <option value="drive_semi">Drive Semi (SAW)</option>
                                <option value="education">Education (III)</option>
                                <option value="electronics">Electronics (MII)</option>
                                <option value="electroshock">Electroshock (QPW)</option>
                                <option value="empathy">Empathy (PPC)</option>
                                <option value="endure">Endure (HHW)</option>
                                <option value="engineering">Engineering (III)</option>
                                <option value="etiquette">Etiquette (CCW)</option>
                                <option value="explosives">Explosives (MWW)</option>
                                <option value="fishing">Fishing (MWP)</option>
                                <option value="first_aid">First Aid (PWI)</option>
                                <option value="fly_helicopter">Fly Helicopter (PIW)</option>
                                <option value="fly_plane">Fly Plane (PIM)</option>
                                <option value="foraging">Foraging (PIM)</option>
                                <option value="forensics">Forensics (IPW)</option>
                                <option value="forgery">Forgery (MII)</option>
                                <option value="gambling">Gambling (PPI)</option>
                                <option value="gunsmithing">Gunsmithing (MMP)</option>
                                <option value="hacking">Hacking (IPW)</option>
                                <option value="hand_signals">Hand Signals (MMP)</option>
                                <option value="hardware">Hardware (MMI)</option>
                                <option value="hide">Hide (WWI)</option>
                                <option value="hunting">Hunting (PPQ)</option>
                                <option value="improvised_weapon">Improvised Weapon (ASQ)</option>
                                <option value="initiative">Initiative (QQP)</option>
                                <option value="insight">Insight (PPP)</option>
                                <option value="instinct">Instinct (PPW)</option>
                                <option value="intelligence">Intelligence (III)</option>
                                <option value="intimidate">Intimidate (CCS)</option>
                                <option value="interrogation">Interrogation (PWS)</option>
                                <option value="investigate">Investigate (IIP)</option>
                                <option value="jeet_kune_do">Jeet Kune Do (QAW)</option>
                                <option value="jiu_jitsu">Jiu Jitsu (SQI)</option>
                                <option value="judo">Judo (SQW)</option>
                                <option value="jumping">Jumping (AAH)</option>
                                <option value="jury_rig">Jury-Rig (MPW)</option>
                                <option value="karate">Karate (SAW)</option>
                                <option value="krav_maga">Krav Maga (PAW)</option>
                                <option value="law">Law (III)</option>
                                <option value="lifting">Lifting (SSS)</option>
                                <option value="linguistics">Linguistics (IPP)</option>
                                <option value="lockpicking">Lockpicking (MIP)</option>
                                <option value="manualdex">Manual Dexterity (MMM)</option>
                                <option value="mathematics">Mathematics (III)</option>
                                <option value="mechanical">Mechanical (MIW)</option>
                                <option value="medical_care">Medical Care (IIP)</option>
                                <option value="melee_weapon">Melee Weapon (AQQ)</option>
                                <option value="muay_thai">Muay Thai (SAP)</option>
                                <option value="negotiate">Negotiate (CIW)</option>
                                <option value="parmacology">Pharmacology (IWW)</option>
                                <option value="perception">Perception (PPP)</option>
                                <option value="persuade">Persuade (CCI)</option>
                                <option value="physics">Physics (III)</option>
                                <option value="play_instrument">Play Instrument (MMQ)</option>
                                <option value="programming">Programming (III)</option>
                                <option value="psychiatry">Psychiatry (IWC)</option>
                                <option value="push">Push (SSS)</option>
                                <option value="repair">Repair (MPI)</option>
                                <option value="ride_bicycle">Ride Bicycle (HHS)</option>
                                <option value="rifle">Rifle (APW)</option>
                                <option value="sailing">Sailing (MAI)</option>
                                <option value="sambo">Sambo (SSW)</option>
                                <option value="savate">Savate (AAP)</option>
                                <option value="sawed_off_shotgun">Sawed-Off Shotgun (SAW)</option>
                                <option value="scavenging">Scavenging (PPW)</option>
                                <option value="search">Search (PPI)</option>
                                <option value="seduce">Seduce (CCP)</option>
                                <option value="showmanship">Showmanship (CCA)</option>
                                <option value="sing">Sing (CHP)</option>
                                <option value="sleight_of_hand">Sleight of Hand (MMP)</option>
                                <option value="slingshot">Slingshot (AMM)</option>
                                <option value="sneak">Sneak (APW)</option>
                                <option value="sniper_rifle">Sniper Rifle (PIW)</option>
                                <option value="spycraft">Spycraft (WIP)</option>
                                <option value="strength">Strength (SSS)</option>
                                <option value="streetwise">Streetwise (CPI)</option>
                                <option value="subtle">Subtle (QAP)</option>
                                <option value="surveillance">Surveillance (WWP)</option>
                                <option value="surgery">Surgery (MIP)</option>
                                <option value="swimming">Swimming (AHH)</option>
                                <option value="tactics">Tactics (IPW)</option>
                                <option value="taekwondo">Taekwondo (AAQ)</option>
                                <option value="thrown">Thrown (SAM)</option>
                                <option value="tracking">Tracking (PPI)</option>
                                <option value="welding">Welding (MSW)</option>
                                <option value="willpower">Willpower (WWW)</option>
                                <option value="wrestling">Wrestling (SQA)</option>
                                <option value="writing">Writing (CIP)</option>
                              </select>
                              <span name="attr_searched_skill_specialized"></span>
                            </div>
                            <div class="grid-cell number-cell"><span name="attr_searched_action_skill"></span></div>
                            <div class="grid-cell">
                              <button type="action" class="sheet-d6pp" name="act_searched_skill_roll">Roll</button>
                            </div>
                        </div>
                        <div class="spacer-md"></div>
                        <div class="sheet-grid-table five-col full-width">
                            <!-- Headers -->
                            <div class="grid-header">Combined Skill</div>
                            <div class="grid-header">Skill Code</div>
                            <div class="grid-header">Combined Skill</div>
                            <div class="grid-header">Skill Code</div>
                            <div class="grid-header">Roll</div>
                            <div class="grid-cell">
                              <select name="attr_combined_skill_1" class="sheet-d6pp-select">
                                <option value="">None</option>
                                <option value="acrobatics">Acrobatics (AAS)</option>
                                <option value="acting">Acting (CCP)</option>
                                <option value="aikido">Aikido (PIW)</option>
                                <option value="air_navigation">Air Navigation (PII)</option>
                                <option value="animal_care">Animal Care (PCW)</option>
                                <option value="animal_empathy">Animal Empathy (PPC)</option>
                                <option value="animal_handling">Animal Handling (ACP)</option>
                                <option value="animal_training">Animal Training (WPI)</option>
                                <option value="appraisal">Appraisal (PPI)</option>
                                <option value="archery">Bow (AAM)</option>
                                <option value="art">Art (MMP)</option>
                                <option value="astronomy">Astronomy (IIP)</option>
                                <option value="athletics">Athletics (SSA)</option>
                                <option value="automatic_handgun">Automatic Handgun (AAS)</option>
                                <option value="automatic_rifle">Automatic Rifle (AAS)</option>
                                <option value="avoid">Avoid (QPP)</option>
                                <option value="biology">Biology (IPP)</option>
                                <option value="boxing">Boxing (SAQ)</option>
                                <option value="brawling">Brawling (ASS)</option>
                                <option value="build">Build (MMA)</option>
                                <option value="bureaucracy">Bureaucracy (WWW)</option>
                                <option value="camouflage">Camouflage (MPP)</option>
                                <option value="capoeira">Capoeira (APQ)</option>
                                <option value="carpentry">Carpentry (MSW)</option>
                                <option value="cartography">Cartography (IIP)</option>
                                <option value="cheating">Cheating (MPW)</option>
                                <option value="chemistry">Chemistry (IMP)</option>
                                <option value="climbing">Climbing (SSH)</option>
                                <option value="command">Command (CCP)</option>
                                <option value="comedy">Comedy (CPP)</option>
                                <option value="computer_use">Computer Use (IIM)</option>
                                <option value="control_drone">Control Drone (PPM)</option>
                                <option value="cooking">Cooking (IWM)</option>
                                <option value="crossbow">Crossbow (APM)</option>
                                <option value="dance">Dance (CAP)</option>
                                <option value="deceive">Deceive (CPP)</option>
                                <option value="defend">Defend (SQP)</option>
                                <option value="disguise">Disguise (MIP)</option>
                                <option value="diving">Diving (HHW)</option>
                                <option value="dodge">Dodge (QPA)</option>
                                <option value="drive_boat">Drive Boat (AAQ)</option>
                                <option value="drive_car">Drive Car (AAQ)</option>
                                <option value="drive_motorcycle">Drive Motorcycle (AQW)</option>
                                <option value="drive_semi">Drive Semi (SAW)</option>
                                <option value="education">Education (III)</option>
                                <option value="electronics">Electronics (MII)</option>
                                <option value="electroshock">Electroshock (QPW)</option>
                                <option value="empathy">Empathy (PPC)</option>
                                <option value="endure">Endure (HHW)</option>
                                <option value="engineering">Engineering (III)</option>
                                <option value="etiquette">Etiquette (CCW)</option>
                                <option value="explosives">Explosives (MWW)</option>
                                <option value="fishing">Fishing (MWP)</option>
                                <option value="first_aid">First Aid (PWI)</option>
                                <option value="fly_helicopter">Fly Helicopter (PIW)</option>
                                <option value="fly_plane">Fly Plane (PIM)</option>
                                <option value="foraging">Foraging (PIM)</option>
                                <option value="forensics">Forensics (IPW)</option>
                                <option value="forgery">Forgery (MII)</option>
                                <option value="gambling">Gambling (PPI)</option>
                                <option value="gunsmithing">Gunsmithing (MMP)</option>
                                <option value="hacking">Hacking (IPW)</option>
                                <option value="hand_signals">Hand Signals (MMP)</option>
                                <option value="hardware">Hardware (MMI)</option>
                                <option value="hide">Hide (WWI)</option>
                                <option value="hunting">Hunting (PPQ)</option>
                                <option value="improvised_weapon">Improvised Weapon (ASQ)</option>
                                <option value="initiative">Initiative (QQP)</option>
                                <option value="insight">Insight (PPP)</option>
                                <option value="instinct">Instinct (PPW)</option>
                                <option value="intelligence">Intelligence (III)</option>
                                <option value="intimidate">Intimidate (CCS)</option>
                                <option value="interrogation">Interrogation (PWS)</option>
                                <option value="investigate">Investigate (IIP)</option>
                                <option value="jeet_kune_do">Jeet Kune Do (QAW)</option>
                                <option value="jiu_jitsu">Jiu Jitsu (SQI)</option>
                                <option value="judo">Judo (SQW)</option>
                                <option value="jumping">Jumping (AAH)</option>
                                <option value="jury_rig">Jury-Rig (MPW)</option>
                                <option value="karate">Karate (SAW)</option>
                                <option value="krav_maga">Krav Maga (PAW)</option>
                                <option value="law">Law (III)</option>
                                <option value="lifting">Lifting (SSS)</option>
                                <option value="linguistics">Linguistics (IPP)</option>
                                <option value="lockpicking">Lockpicking (MIP)</option>
                                <option value="manualdex">Manual Dexterity (MMM)</option>
                                <option value="mathematics">Mathematics (III)</option>
                                <option value="mechanical">Mechanical (MIW)</option>
                                <option value="medical_care">Medical Care (IIP)</option>
                                <option value="melee_weapon">Melee Weapon (AQQ)</option>
                                <option value="muay_thai">Muay Thai (SAP)</option>
                                <option value="negotiate">Negotiate (CIW)</option>
                                <option value="parmacology">Pharmacology (IWW)</option>
                                <option value="perception">Perception (PPP)</option>
                                <option value="persuade">Persuade (CCI)</option>
                                <option value="physics">Physics (III)</option>
                                <option value="play_instrument">Play Instrument (MMQ)</option>
                                <option value="programming">Programming (III)</option>
                                <option value="psychiatry">Psychiatry (IWC)</option>
                                <option value="push">Push (SSS)</option>
                                <option value="repair">Repair (MPI)</option>
                                <option value="ride_bicycle">Ride Bicycle (HHS)</option>
                                <option value="rifle">Rifle (APW)</option>
                                <option value="sailing">Sailing (MAI)</option>
                                <option value="sambo">Sambo (SSW)</option>
                                <option value="savate">Savate (AAP)</option>
                                <option value="sawed_off_shotgun">Sawed-Off Shotgun (SAW)</option>
                                <option value="scavenging">Scavenging (PPW)</option>
                                <option value="search">Search (PPI)</option>
                                <option value="seduce">Seduce (CCP)</option>
                                <option value="showmanship">Showmanship (CCA)</option>
                                <option value="sing">Sing (CHP)</option>
                                <option value="sleight_of_hand">Sleight of Hand (MMP)</option>
                                <option value="slingshot">Slingshot (AMM)</option>
                                <option value="sneak">Sneak (APW)</option>
                                <option value="sniper_rifle">Sniper Rifle (PIW)</option>
                                <option value="spycraft">Spycraft (WIP)</option>
                                <option value="strength">Strength (SSS)</option>
                                <option value="streetwise">Streetwise (CPI)</option>
                                <option value="subtle">Subtle (QAP)</option>
                                <option value="surveillance">Surveillance (WWP)</option>
                                <option value="surgery">Surgery (MIP)</option>
                                <option value="swimming">Swimming (AHH)</option>
                                <option value="tactics">Tactics (IPW)</option>
                                <option value="taekwondo">Taekwondo (AAQ)</option>
                                <option value="thrown">Thrown (SAM)</option>
                                <option value="tracking">Tracking (PPI)</option>
                                <option value="welding">Welding (MSW)</option>
                                <option value="willpower">Willpower (WWW)</option>
                                <option value="wrestling">Wrestling (SQA)</option>
                                <option value="writing">Writing (CIP)</option>
                              </select>
                              <span name="attr_combined_skill_specialized_1"></span>
                            </div>
                            <div class="grid-cell number-cell"><span name="attr_combined_action_skill_1"></span></div>
                            <div class="grid-cell">
                              <select name="attr_combined_skill_2" class="sheet-d6pp-select">
                                <option value="">None</option>
                                <option value="acrobatics">Acrobatics (AAS)</option>
                                <option value="acting">Acting (CCP)</option>
                                <option value="aikido">Aikido (PIW)</option>
                                <option value="air_navigation">Air Navigation (PII)</option>
                                <option value="animal_care">Animal Care (PCW)</option>
                                <option value="animal_empathy">Animal Empathy (PPC)</option>
                                <option value="animal_handling">Animal Handling (ACP)</option>
                                <option value="animal_training">Animal Training (WPI)</option>
                                <option value="appraisal">Appraisal (PPI)</option>
                                <option value="archery">Bow (AAM)</option>
                                <option value="art">Art (MMP)</option>
                                <option value="astronomy">Astronomy (IIP)</option>
                                <option value="athletics">Athletics (SSA)</option>
                                <option value="automatic_handgun">Automatic Handgun (AAS)</option>
                                <option value="automatic_rifle">Automatic Rifle (AAS)</option>
                                <option value="avoid">Avoid (QPP)</option>
                                <option value="biology">Biology (IPP)</option>
                                <option value="boxing">Boxing (SAQ)</option>
                                <option value="brawling">Brawling (ASS)</option>
                                <option value="build">Build (MMA)</option>
                                <option value="bureaucracy">Bureaucracy (WWW)</option>
                                <option value="camouflage">Camouflage (MPP)</option>
                                <option value="capoeira">Capoeira (APQ)</option>
                                <option value="carpentry">Carpentry (MSW)</option>
                                <option value="cartography">Cartography (IIP)</option>
                                <option value="cheating">Cheating (MPW)</option>
                                <option value="chemistry">Chemistry (IMP)</option>
                                <option value="climbing">Climbing (SSH)</option>
                                <option value="command">Command (CCP)</option>
                                <option value="comedy">Comedy (CPP)</option>
                                <option value="computer_use">Computer Use (IIM)</option>
                                <option value="control_drone">Control Drone (PPM)</option>
                                <option value="cooking">Cooking (IWM)</option>
                                <option value="crossbow">Crossbow (APM)</option>
                                <option value="dance">Dance (CAP)</option>
                                <option value="deceive">Deceive (CPP)</option>
                                <option value="defend">Defend (SQP)</option>
                                <option value="disguise">Disguise (MIP)</option>
                                <option value="diving">Diving (HHW)</option>
                                <option value="dodge">Dodge (QPA)</option>
                                <option value="drive_boat">Drive Boat (AAQ)</option>
                                <option value="drive_car">Drive Car (AAQ)</option>
                                <option value="drive_motorcycle">Drive Motorcycle (AQW)</option>
                                <option value="drive_semi">Drive Semi (SAW)</option>
                                <option value="education">Education (III)</option>
                                <option value="electronics">Electronics (MII)</option>
                                <option value="electroshock">Electroshock (QPW)</option>
                                <option value="empathy">Empathy (PPC)</option>
                                <option value="endure">Endure (HHW)</option>
                                <option value="engineering">Engineering (III)</option>
                                <option value="etiquette">Etiquette (CCW)</option>
                                <option value="explosives">Explosives (MWW)</option>
                                <option value="fishing">Fishing (MWP)</option>
                                <option value="first_aid">First Aid (PWI)</option>
                                <option value="fly_helicopter">Fly Helicopter (PIW)</option>
                                <option value="fly_plane">Fly Plane (PIM)</option>
                                <option value="foraging">Foraging (PIM)</option>
                                <option value="forensics">Forensics (IPW)</option>
                                <option value="forgery">Forgery (MII)</option>
                                <option value="gambling">Gambling (PPI)</option>
                                <option value="gunsmithing">Gunsmithing (MMP)</option>
                                <option value="hacking">Hacking (IPW)</option>
                                <option value="hand_signals">Hand Signals (MMP)</option>
                                <option value="hardware">Hardware (MMI)</option>
                                <option value="hide">Hide (WWI)</option>
                                <option value="hunting">Hunting (PPQ)</option>
                                <option value="improvised_weapon">Improvised Weapon (ASQ)</option>
                                <option value="initiative">Initiative (QQP)</option>
                                <option value="insight">Insight (PPP)</option>
                                <option value="instinct">Instinct (PPW)</option>
                                <option value="intelligence">Intelligence (III)</option>
                                <option value="intimidate">Intimidate (CCS)</option>
                                <option value="interrogation">Interrogation (PWS)</option>
                                <option value="investigate">Investigate (IIP)</option>
                                <option value="jeet_kune_do">Jeet Kune Do (QAW)</option>
                                <option value="jiu_jitsu">Jiu Jitsu (SQI)</option>
                                <option value="judo">Judo (SQW)</option>
                                <option value="jumping">Jumping (AAH)</option>
                                <option value="jury_rig">Jury-Rig (MPW)</option>
                                <option value="karate">Karate (SAW)</option>
                                <option value="krav_maga">Krav Maga (PAW)</option>
                                <option value="law">Law (III)</option>
                                <option value="lifting">Lifting (SSS)</option>
                                <option value="linguistics">Linguistics (IPP)</option>
                                <option value="lockpicking">Lockpicking (MIP)</option>
                                <option value="manualdex">Manual Dexterity (MMM)</option>
                                <option value="mathematics">Mathematics (III)</option>
                                <option value="mechanical">Mechanical (MIW)</option>
                                <option value="medical_care">Medical Care (IIP)</option>
                                <option value="melee_weapon">Melee Weapon (AQQ)</option>
                                <option value="muay_thai">Muay Thai (SAP)</option>
                                <option value="negotiate">Negotiate (CIW)</option>
                                <option value="parmacology">Pharmacology (IWW)</option>
                                <option value="perception">Perception (PPP)</option>
                                <option value="persuade">Persuade (CCI)</option>
                                <option value="physics">Physics (III)</option>
                                <option value="play_instrument">Play Instrument (MMQ)</option>
                                <option value="programming">Programming (III)</option>
                                <option value="psychiatry">Psychiatry (IWC)</option>
                                <option value="push">Push (SSS)</option>
                                <option value="repair">Repair (MPI)</option>
                                <option value="ride_bicycle">Ride Bicycle (HHS)</option>
                                <option value="rifle">Rifle (APW)</option>
                                <option value="sailing">Sailing (MAI)</option>
                                <option value="sambo">Sambo (SSW)</option>
                                <option value="savate">Savate (AAP)</option>
                                <option value="sawed_off_shotgun">Sawed-Off Shotgun (SAW)</option>
                                <option value="scavenging">Scavenging (PPW)</option>
                                <option value="search">Search (PPI)</option>
                                <option value="seduce">Seduce (CCP)</option>
                                <option value="showmanship">Showmanship (CCA)</option>
                                <option value="sing">Sing (CHP)</option>
                                <option value="sleight_of_hand">Sleight of Hand (MMP)</option>
                                <option value="slingshot">Slingshot (AMM)</option>
                                <option value="sneak">Sneak (APW)</option>
                                <option value="sniper_rifle">Sniper Rifle (PIW)</option>
                                <option value="spycraft">Spycraft (WIP)</option>
                                <option value="strength">Strength (SSS)</option>
                                <option value="streetwise">Streetwise (CPI)</option>
                                <option value="subtle">Subtle (QAP)</option>
                                <option value="surveillance">Surveillance (WWP)</option>
                                <option value="surgery">Surgery (MIP)</option>
                                <option value="swimming">Swimming (AHH)</option>
                                <option value="tactics">Tactics (IPW)</option>
                                <option value="taekwondo">Taekwondo (AAQ)</option>
                                <option value="thrown">Thrown (SAM)</option>
                                <option value="tracking">Tracking (PPI)</option>
                                <option value="welding">Welding (MSW)</option>
                                <option value="willpower">Willpower (WWW)</option>
                                <option value="wrestling">Wrestling (SQA)</option>
                                <option value="writing">Writing (CIP)</option>
                              </select>
                              <span name="attr_combined_skill_specialized_2"></span>
                            </div>
                            <div class="grid-cell number-cell"><span name="attr_combined_action_skill_2"></span></div>
                            <div class="grid-cell">
                              <button type="action" class="sheet-d6pp" name="act_combined_skill_roll">Roll</button>
                            </div>
                        </div>
                      </div>
                  </div>
                  <!-- ### Actions Tracker -->
                  <div class="sheet-section-collapsible">
                      <input type="checkbox" class="skill-toggle" id="toggle_actions" name="attr_toggle_actions" value="1" checked hidden />
                      <label class="skill-toggle-label" for="toggle_actions">Combat Actions</label>
                      <div class="skill-group-content">
                          <!-- Left Column -->
                          <div class="sheet-grid-left">
                              <input type="hidden" name="attr_actions_locked" value="0"/>
                              <div class="sheet-editable-actions">
                                  <div class="sheet-controls-row">
                                      <div class="sheet-controls-group">
                                          <label class="sheet-d6pp-label"># Declared Actions:</label>
                                          <input type="number" class="sheet-d6pp" name="attr_num_declared_actions" />
                                      </div>
                                      <div class="sheet-controls-group">
                                          <label class="sheet-d6pp-label">Multi-Action Penalty:</label>
                                          <input type="text" class="sheet-d6pp sheet-small-input" name="attr_actions_penalty" readonly />
                                      </div>
                                      <div class="sheet-controls-group">
                                          <button type="action" class="sheet-d6pp" name="act_start_turn">Start Turn</button>
                                      </div>
                                  </div>
                              </div>
                              <input type="hidden" name="attr_actions_locked" value="0"/>
                              <div class="sheet-readonly-actions">
                                  <div class="sheet-controls-row">
                                      <div class="sheet-controls-group">
                                          <label class="sheet-d6pp-label"># Declared Actions:</label>
                                          <input type="text" class="sheet-d6pp sheet-small-input" name="attr_num_declared_actions" readonly />
                                      </div>

                                      <div class="sheet-controls-group">
                                          <label class="sheet-d6pp-label">Multi-Action Penalty:</label>
                                          <input type="text" class="sheet-d6pp sheet-small-input" name="attr_actions_penalty" readonly />
                                      </div>
                                      <div class="sheet-controls-group">
                                          <button type="action" class="sheet-d6pp" name="act_end_turn">End Turn</button>
                                      </div>
                                  </div>
                                  <div class="sheet-divider"></div>
                                  <div class="spacer-md"></div>
                                  <!-- R3C1: Skill Chooser -->
                                  <div class="sheet-grid-table four-col full-width">
                                      <div class="grid-header">Selected Skill</div>
                                      <div class="grid-header">Skill Code</div>
                                      <div class="grid-header">Adjusted Code</div>
                                      <div class="grid-header">Roll Button</div>
                                      <div class="grid-cell">
                                        <select name="attr_selected_skill" class="sheet-d6pp-select">
                                          <option value="">None</option>
                                          <option value="acrobatics">Acrobatics (AAS)</option>
                                          <option value="acting">Acting (CCP)</option>
                                          <option value="air_navigation">Air Navigation (PII)</option>
                                          <option value="animal_care">Animal Care (PCW)</option>
                                          <option value="animal_empathy">Animal Empathy (PPC)</option>
                                          <option value="animal_handling">Animal Handling (ACP)</option>
                                          <option value="animal_training">Animal Training (WPI)</option>
                                          <option value="appraisal">Appraisal (PPI)</option>
                                          <option value="art">Art (MMP)</option>
                                          <option value="astronomy">Astronomy (IIP)</option>
                                          <option value="biology">Biology (IPP)</option>
                                          <option value="build">Build (MMA)</option>
                                          <option value="bureaucracy">Bureaucracy (WWW)</option>
                                          <option value="camouflage">Camouflage (MPP)</option>
                                          <option value="carpentry">Carpentry (MSW)</option>
                                          <option value="cartography">Cartography (IIP)</option>
                                          <option value="cheating">Cheating (MPW)</option>
                                          <option value="chemistry">Chemistry (IMP)</option>
                                          <option value="climbing">Climbing (SSH)</option>
                                          <option value="command">Command (CCP)</option>
                                          <option value="comedy">Comedy (CPP)</option>
                                          <option value="computer_use">Computer Use (IIM)</option>
                                          <option value="control_drone">Control Drone (PPM)</option>
                                          <option value="cooking">Cooking (IWM)</option>
                                          <option value="dance">Dance (CAP)</option>
                                          <option value="deceive">Deceive (CPP)</option>
                                          <option value="disguise">Disguise (MIP)</option>
                                          <option value="diving">Diving (HHW)</option>
                                          <option value="drive_boat">Drive Boat (AAQ)</option>
                                          <option value="drive_car">Drive Car (AAQ)</option>
                                          <option value="drive_motorcycle">Drive Motorcycle (AQW)</option>
                                          <option value="drive_semi">Drive Semi (SAW)</option>
                                          <option value="education">Education (III)</option>
                                          <option value="electronics">Electronics (MII)</option>
                                          <option value="empathy">Empathy (PPC)</option>
                                          <option value="engineering">Engineering (III)</option>
                                          <option value="etiquette">Etiquette (CCW)</option>
                                          <option value="explosives">Explosives (MWW)</option>
                                          <option value="fishing">Fishing (MWP)</option>
                                          <option value="first_aid">First Aid (PWI)</option>
                                          <option value="fly_helicopter">Fly Helicopter (PIW)</option>
                                          <option value="fly_plane">Fly Plane (PIM)</option>
                                          <option value="foraging">Foraging (PIM)</option>
                                          <option value="forensics">Forensics (IPW)</option>
                                          <option value="forgery">Forgery (MII)</option>
                                          <option value="gambling">Gambling (PPI)</option>
                                          <option value="hand_signals">Hand Signals (MMP)</option>
                                          <option value="hacking">Hacking (IPW)</option>
                                          <option value="hardware">Hardware (MMI)</option>
                                          <option value="hide">Hide (WWI)</option>
                                          <option value="hunting">Hunting (PPQ)</option>
                                          <option value="insight">Insight (PPP)</option>
                                          <option value="instinct">Instinct (PPW)</option>
                                          <option value="intelligence">Intelligence (III)</option>
                                          <option value="interrogation">Interrogation (PWS)</option>
                                          <option value="investigate">Investigate (IIP)</option>
                                          <option value="jumping">Jumping (AAH)</option>
                                          <option value="jury_rig">Jury-Rig (MPW)</option>
                                          <option value="gunsmithing">Gunsmithing (MMP)</option>
                                          <option value="law">Law (III)</option>
                                          <option value="lifting">Lifting (SSS)</option>
                                          <option value="linguistics">Linguistics (IPP)</option>
                                          <option value="lockpicking">Lockpicking (MIP)</option>
                                          <option value="manualdex">Manual Dexterity (MMM)</option>
                                          <option value="mathematics">Mathematics (III)</option>
                                          <option value="mechanical">Mechanical (MIW)</option>
                                          <option value="medical_care">Medical Care (IIP)</option>
                                          <option value="sea_navigation">Sea Navigation (IPP)</option>
                                          <option value="negotiate">Negotiate (CIW)</option>
                                          <option value="parmacology">Pharmacology (IWW)</option>
                                          <option value="perception">Perception (PPP)</option>
                                          <option value="persuade">Persuade (CCI)</option>
                                          <option value="physics">Physics (III)</option>
                                          <option value="play_instrument">Play Instrument (MMQ)</option>
                                          <option value="programming">Programming (III)</option>
                                          <option value="psychiatry">Psychiatry (IWC)</option>
                                          <option value="repair">Repair (MPI)</option>
                                          <option value="ride_bicycle">Ride Bicycle (HHS)</option>
                                          <option value="sailing">Sailing (MAI)</option>
                                          <option value="scavenging">Scavenging (PPW)</option>
                                          <option value="search">Search (PPI)</option>
                                          <option value="seduce">Seduce (CCP)</option>
                                          <option value="showmanship">Showmanship (CCA)</option>
                                          <option value="sing">Sing (CHP)</option>
                                          <option value="sleight_of_hand">Sleight of Hand (MMP)</option>
                                          <option value="sneak">Sneak (APW)</option>
                                          <option value="spycraft">Spycraft (WIP)</option>
                                          <option value="streetwise">Streetwise (CPI)</option>
                                          <option value="strength">Strength (SSS)</option>
                                          <option value="surveillance">Surveillance (WWP)</option>
                                          <option value="surgery">Surgery (MIP)</option>
                                          <option value="tactics">Tactics (IPW)</option>
                                          <option value="tracking">Tracking (PPI)</option>
                                          <option value="welding">Welding (MSW)</option>
                                          <option value="willpower">Willpower (WWW)</option>
                                          <option value="writing">Writing (CIP)</option>
                                        </select>
                                      </div>
                                      <div class="grid-cell"><span class="sheet-d6pp-label" name="attr_action_skill"></span></div>
                                      <div class="grid-cell"><span class="sheet-d6pp-label" name="attr_action_actual"></span></div>
                                      <div class="grid-cell">
                                          <button type="action" name="act_selected_skill_roll" class="sheet-d6pp">Roll Action</button>
                                      </div>
                                      <!-- R5C1: Reactions Section -->
                                      <div class="grid-cell">
                                          <select name="attr_selected_reaction" class="sheet-d6pp-select">
                                              <option value="">None</option>
                                              <option value="dodge">Dodge (QPA)</option>
                                              <option value="defend">Defend (SQP)</option>
                                              <option value="avoid">Avoid (QPP)</option>
                                          </select>
                                      </div>
                                      <div class="grid-cell"><span class="sheet-d6pp-label" name="attr_reaction_skill"></span></div>
                                      <div class="grid-cell"><span>Reactions are not penalized by multi-actions</span></div>
                                      <div class="grid-cell">
                                          <button type="action" name="act_selected_reaction_roll" class="sheet-d6pp">Roll Reaction</button>
                                      </div>
                                  </div>
                                  <div class="spacer-md"></div>
                                  <div class="sheet-divider"></div>
                                  <div class="spacer-md"></div>
                                  <div class="sheet-attack-tabs">
                                      <!-- Radio buttons -->
                                      <input type="radio" name="attr_attack_mode" value="firearms" class="sheet-tab" checked />
                                      <span>Firearms</span>
                                      <input type="radio" name="attr_attack_mode" value="ranged" class="sheet-tab" />
                                      <span>Ranged</span>
                                      <input type="radio" name="attr_attack_mode" value="armed" class="sheet-tab" />
                                      <span>Armed</span>
                                      <input type="radio" name="attr_attack_mode" value="unarmed" class="sheet-tab" />
                                      <span>Unarmed</span>
                                      <div class="spacer-sm"></div>
                                      <div class="sheet-attack-section sheet-firearms">
                                          <!-- Weapon 1 -->
                                          <div class="sheet-grid-attack sheet-grid-firearms full-width">
                                              <!-- Headers -->
                                              <div class="grid-header">Weapon</div>
                                              <div class="grid-header">Dice</div>
                                              <div class="grid-header">Damage</div>
                                              <div class="grid-header">Ammo</div>
                                              <div class="grid-header">Short</div>
                                              <div class="grid-header">Medium</div>
                                              <div class="grid-header">Long</div>
                                              <div class="grid-header">Extreme</div>
                                              <!-- Row 1: Weapon 1 -->
                                              <div class="grid-cell stack-weapon">
                                                  <select name="attr_firearm1_weapon" class="sheet-d6pp-select">
                                                    <option value="None">None</option>
                                                    <option value="Revolver">Revolver (1H)</option>
                                                    <option value="Pistol">Pistol (1H)</option>
                                                    <option value="Subcompact Pistol">Subcompact Pistol (1H)</option>
                                                    <option value="Machine Pistol">Machine Pistol (1H)</option>
                                                    <option value="Automatic Pistol">Automatic Pistol (1H)</option>
                                                    <option value="Assault Rifle">Assault Rifle (2H)</option>
                                                    <option value="Compact Carbine">Compact Carbine (2H)</option>
                                                    <option value="Light Machine Rifle">Light Machine Rifle (2H)</option>
                                                    <option value="Sniper Rifle">Sniper Rifle (2H)</option>
                                                    <option value="Battle Rifle">Battle Rifle (2H)</option>
                                                    <option value="Hunting Rifle">Hunting Rifle (2H)</option>
                                                    <option value="Shotgun">Shotgun (2H)</option>
                                                    <option value="Sawed-off Shotgun">Sawed-off Shotgun (2H)</option>
                                                  </select>
                                                  <div class="weapon-skill">
                                                    <span name="attr_firearm1_attr"></span><span> (</span><span name="attr_firearm1_string"></span><span>)</span>
                                                  </div>
                                              </div>
                                              <div class="grid-cell stack-tight">
                                                  <span name="attr_firearm1_actual"></span>
                                                  <button type="action" name="act_firearm1_attack">Roll</button>
                                              </div>
                                              <div class="grid-cell stack-tight">
                                                  <span name="attr_firearm1_damage"></span>
                                                  <button type="action" name="act_firearm1_damage">Damage</button>
                                              </div>
                                              <div class="grid-cell stack-tight">
                                                  <div class="ammo-button-row">
                                                      <button type="action" name="act_firearm1_ammo_add">+</button>
                                                      <button type="action" name="act_firearm1_ammo_sub"></button>
                                                  </div>
                                                  <button type="action" name="act_firearm1_ammo_reload">Reload</button>
                                              </div>
                                              <div class="grid-cell"><span name="attr_firearm1_short"></span></div>
                                              <div class="grid-cell"><span name="attr_firearm1_medium"></span></div>
                                              <div class="grid-cell"><span name="attr_firearm1_long"></span></div>
                                              <div class="grid-cell"><span name="attr_firearm1_extreme"></span></div>
                                              <!-- Ammo Display Row -->
                                              <div class="grid-cell ammo-display full-row">
                                                  <!-- not grid-span-8 -->
                                                  <span name="attr_firearm1_ammo_display"></span>
                                              </div>
                                          </div>
                                          <!-- Weapon 2 -->
                                          <div class="sheet-grid-attack sheet-grid-firearms full-width">
                                              <!-- Row 1: Weapon 2 -->
                                              <div class="grid-cell stack-weapon">
                                                  <select name="attr_firearm2_weapon" class="sheet-d6pp-select">
                                                    <option value="None">None</option>
                                                    <option value="Revolver">Revolver (1H)</option>
                                                    <option value="Pistol">Pistol (1H)</option>
                                                    <option value="Subcompact Pistol">Subcompact Pistol (1H)</option>
                                                    <option value="Machine Pistol">Machine Pistol (1H)</option>
                                                    <option value="Automatic Pistol">Automatic Pistol (1H)</option>
                                                    <option value="Assault Rifle">Assault Rifle (2H)</option>
                                                    <option value="Compact Carbine">Compact Carbine (2H)</option>
                                                    <option value="Light Machine Rifle">Light Machine Rifle (2H)</option>
                                                    <option value="Sniper Rifle">Sniper Rifle (2H)</option>
                                                    <option value="Battle Rifle">Battle Rifle (2H)</option>
                                                    <option value="Hunting Rifle">Hunting Rifle (2H)</option>
                                                    <option value="Shotgun">Shotgun (2H)</option>
                                                    <option value="Sawed-off Shotgun">Sawed-off Shotgun (2H)</option>
                                                  </select>
                                                  <div class="weapon-skill">
                                                    <span name="attr_firearm2_attr"></span><span> (</span><span name="attr_firearm2_string"></span><span>)</span>
                                                  </div>
                                              </div>
                                              <div class="grid-cell stack-tight">
                                                  <span name="attr_firearm2_actual"></span>
                                                  <button type="action" name="act_firearm2_attack">Roll</button>
                                              </div>
                                              <div class="grid-cell stack-tight">
                                                  <span name="attr_firearm2_damage"></span>
                                                  <button type="action" name="act_firearm2_damage">Damage</button>
                                              </div>
                                              <div class="grid-cell stack-tight">
                                                  <div class="ammo-button-row">
                                                      <button type="action" name="act_firearm2_ammo_add">+</button>
                                                      <button type="action" name="act_firearm2_ammo_sub"></button>
                                                  </div>
                                                  <button type="action" name="act_firearm2_ammo_reload">Reload</button>
                                              </div>
                                              <div class="grid-cell"><span name="attr_firearm2_short"></span></div>
                                              <div class="grid-cell"><span name="attr_firearm2_medium"></span></div>
                                              <div class="grid-cell"><span name="attr_firearm2_long"></span></div>
                                              <div class="grid-cell"><span name="attr_firearm2_extreme"></span></div>
                                              <!-- Ammo Display Row -->
                                              <div class="grid-cell ammo-display full-row">
                                                  <!-- not grid-span-8 -->
                                                  <span name="attr_firearm2_ammo_display"></span>
                                              </div>
                                          </div>
                                          <!-- Weapon 3 -->
                                          <div class="sheet-grid-attack sheet-grid-firearms full-width">
                                              <!-- Row 1: Weapon 3 -->
                                              <div class="grid-cell stack-weapon">
                                                  <select name="attr_firearm3_weapon" class="sheet-d6pp-select">
                                                    <option value="None">None</option>
                                                    <option value="Revolver">Revolver (1H)</option>
                                                    <option value="Pistol">Pistol (1H)</option>
                                                    <option value="Subcompact Pistol">Subcompact Pistol (1H)</option>
                                                    <option value="Machine Pistol">Machine Pistol (1H)</option>
                                                    <option value="Automatic Pistol">Automatic Pistol (1H)</option>
                                                    <option value="Assault Rifle">Assault Rifle (2H)</option>
                                                    <option value="Compact Carbine">Compact Carbine (2H)</option>
                                                    <option value="Light Machine Rifle">Light Machine Rifle (2H)</option>
                                                    <option value="Sniper Rifle">Sniper Rifle (2H)</option>
                                                    <option value="Battle Rifle">Battle Rifle (2H)</option>
                                                    <option value="Hunting Rifle">Hunting Rifle (2H)</option>
                                                    <option value="Shotgun">Shotgun (2H)</option>
                                                    <option value="Sawed-off Shotgun">Sawed-off Shotgun (2H)</option>
                                                  </select>
                                                  <div class="weapon-skill">
                                                    <span name="attr_firearm3_attr"></span><span> (</span><span name="attr_firearm3_string"></span><span>)</span>
                                                  </div>
                                              </div>
                                              <div class="grid-cell stack-tight">
                                                  <span name="attr_firearm3_actual"></span>
                                                  <button type="action" name="act_firearm3_attack">Roll</button>
                                              </div>
                                              <div class="grid-cell stack-tight">
                                                  <span name="attr_firearm3_damage"></span>
                                                  <button type="action" name="act_firearm3_damage">Damage</button>
                                              </div>
                                              <div class="grid-cell stack-tight">
                                                  <div class="ammo-button-row">
                                                      <button type="action" name="act_firearm3_ammo_add">+</button>
                                                      <button type="action" name="act_firearm3_ammo_sub"></button>
                                                  </div>
                                                  <button type="action" name="act_firearm3_ammo_reload">Reload</button>
                                              </div>
                                              <div class="grid-cell"><span name="attr_firearm3_short"></span></div>
                                              <div class="grid-cell"><span name="attr_firearm3_medium"></span></div>
                                              <div class="grid-cell"><span name="attr_firearm3_long"></span></div>
                                              <div class="grid-cell"><span name="attr_firearm3_extreme"></span></div>
                                              <!-- Ammo Display Row -->
                                              <div class="grid-cell ammo-display full-row last-row">
                                                  <span name="attr_firearm3_ammo_display"></span>
                                              </div>
                                          </div>
                                      </div>
                                      <div class="sheet-attack-section sheet-ranged">
                                          <div class="sheet-grid-attack sheet-grid-ranged full-width">
                                              <!-- Headers -->
                                              <div class="grid-header">Weapon</div>
                                              <div class="grid-header">Dice</div>
                                              <div class="grid-header">Damage</div>
                                              <div class="grid-header">Short</div>
                                              <div class="grid-header">Medium</div>
                                              <div class="grid-header">Long</div>
                                              <div class="grid-header">Extreme</div>
                                              <!-- Weapon Row -->
                                              <div class="grid-cell stack-weapon">
                                                  <select name="attr_ranged_weapon" class="sheet-d6pp-select">
                                                    <option value="None">None</option>
                                                    <option value="Bow">Bow (2H)</option>
                                                    <option value="Crossbow">Crossbow (2H)</option>
                                                    <option value="Slingshot">Slingshot (1H)</option>
                                                    <option value="Thrown Medium Weapon">Thrown Medium Weapon (1H)</option>
                                                    <option value="Thrown Light Weapon">Thrown Light Weapon (1H)</option>
                                                    <option value="Improvised Thrown">Improvised Thrown (1H)</option>
                                                  </select>
                                                  <div class="weapon-skill">
                                                    <span name="attr_ranged_attr"></span><span> (</span><span name="attr_ranged_string"></span><span>)</span>
                                                  </div>
                                              </div>
                                              <div class="grid-cell stack-tight">
                                                  <span name="attr_ranged_actual"></span>
                                                  <button type="action" name="act_ranged_attack" class="sheet-d6pp">Roll</button>
                                              </div>
                                              <div class="grid-cell stack-tight">
                                                  <span name="attr_ranged_damage"></span>
                                                  <button type="action" name="act_ranged_damage" class="sheet-d6pp">Damage</button>
                                              </div>
                                              <div class="grid-cell"><span name="attr_ranged_short"></span></div>
                                              <div class="grid-cell"><span name="attr_ranged_medium"></span></div>
                                              <div class="grid-cell"><span name="attr_ranged_long"></span></div>
                                              <div class="grid-cell"><span name="attr_ranged_extreme"></span></div>
                                          </div>
                                      </div>
                                      <div class="sheet-attack-section sheet-armed">
                                          <div class="sheet-grid-attack sheet-grid-melee full-width">
                                              <!-- Headers -->
                                              <div class="grid-header">Weapon</div>
                                              <div class="grid-header">Dice</div>
                                              <div class="grid-header">Damage</div>
                                              <!-- Row: Melee Weapon -->
                                              <div class="grid-cell stack-weapon">
                                                  <select name="attr_armed_weapon" class="sheet-d6pp-select">
                                                    <option value="">None</option>
                                                    <option value="Brass Knuckles">Brass Knuckles (1H)</option>
                                                    <option value="Chainsaw">Chainsaw (2H)</option>
                                                    <option value="Club">Club (1H)</option>
                                                    <option value="Improvised Weapon">Improvised Weapon (1H)</option>
                                                    <option value="Knife">Knife (1H)</option>
                                                    <option value="Machete">Machete (1H)</option>
                                                    <option value="Pepper Spray">Pepper Spray (1H)</option>
                                                    <option value="Pistol Whip">Pistol Whip (1H)</option>
                                                    <option value="Push">Push (1H)</option>
                                                    <option value="Shield Bash">Shield Bash (1H)</option>
                                                    <option value="Stun Baton">Stun Baton (1H)</option>
                                                    <option value="Stun Gun">Stun Gun (1H)</option>
                                                    <option value="Sword">Sword (1H)</option>
                                                    <option value="Tonfa">Tonfa (1H)</option>
                                                  </select>
                                                  <div class="weapon-skill">
                                                    <span name="attr_armed_attr"></span><span> (</span><span name="attr_armed_string"></span><span>)</span>
                                                  </div>
                                              </div>
                                              <div class="grid-cell stack-tight">
                                                  <span name="attr_armed_actual"></span>
                                                  <button type="action" class="sheet-d6pp" name="act_armed_attack">Roll</button>
                                              </div>
                                              <div class="grid-cell stack-tight">
                                                  <span name="attr_armed_damage"></span>
                                                  <button type="action" class="sheet-d6pp" name="act_armed_damage">Damage</button>
                                              </div>
                                          </div>
                                      </div>
                                      <div class="sheet-attack-section sheet-unarmed">
                                          <div class="sheet-grid-attack sheet-grid-melee full-width">
                                              <!-- Headers -->
                                              <div class="grid-header">Weapon</div>
                                              <div class="grid-header">Dice</div>
                                              <div class="grid-header">Damage</div>
                                              <!-- Row: Melee Weapon -->
                                              <div class="grid-cell stack-weapon">
                                                  <select name="attr_unarmed_weapon" class="sheet-d6pp-select">
                                                    <option value="">None</option>
                                                    <option value="Brawling">Brawling (2H)</option>
                                                    <option value="Wrestling">Wrestling (2H)</option>
                                                    <option value="Push">Push (1H)</option>
                                                    <option value="Aikido">Aikido (2H)</option>
                                                    <option value="Boxing">Boxing (2H)</option>
                                                    <option value="Capoeira">Capoeira (2H)</option>
                                                    <option value="Jeet Kune Do">Jeet Kune Do (2H)</option>
                                                    <option value="Jiu-Jitsu">Jiu-Jitsu (2H)</option>
                                                    <option value="Judo">Judo (2H)</option>
                                                    <option value="Karate">Karate (2H)</option>
                                                    <option value="Krav Maga">Krav Maga (2H)</option>
                                                    <option value="Muay Thai">Muay Thai (2H)</option>
                                                    <option value="Sambo">Sambo (2H)</option>
                                                    <option value="Savate">Savate (2H)</option>
                                                    <option value="Taekwondo">Taekwondo (2H)</option>

                                                  </select>
                                                  <div class="weapon-skill">
                                                    <span name="attr_unarmed_attr"></span><span> (</span><span name="attr_unarmed_string"></span><span>)</span>
                                                  </div>
                                              </div>
                                              <div class="grid-cell stack-tight">
                                                  <span name="attr_unarmed_actual"></span>
                                                  <button type="action" class="sheet-d6pp" name="act_unarmed_attack">Roll</button>
                                              </div>
                                              <div class="grid-cell stack-tight">
                                                  <span name="attr_unarmed_damage"></span>
                                                  <button type="action" class="sheet-d6pp" name="act_unarmed_damage">Damage</button>
                                              </div>
                                          </div>
                                      </div>
                                  </div>
                                  <div class="spacer-md"></div>
                                  <div class="sheet-divider"></div>
                                  <div class="spacer-md"></div>
                                  <div class="sheet-skill-select-row">
                                      <label class="sheet-d6pp-label">Static Reactions: </label>
                                      <button type="action" name="act_out_of_turn" class="sheet-d6pp">Out-of-Turn</button>
                                      <button type="action" name="act_switch_targets" class="sheet-d6pp">Switch Targets</button>
                                      <button type="action" name="act_auto_burst" class="sheet-d6pp">Auto Burst</button>
                                      <button type="action" name="act_contest_reaction" class="sheet-d6pp">Resist Contest</button>
                                  </div>
                                  <div class="spacer-md"></div>
                                  <div class="sheet-divider"></div>
                                  <div class="spacer-md"></div>
                                  <div class="sheet-skill-select-row">
                                      <label class="sheet-d6pp-label">Static Actions: </label>
                                      <button type="action" name="act_run" class="sheet-d6pp">Run</button>
                                      <button type="action" name="act_help" class="sheet-d6pp">Help</button>
                                      <button type="action" name="act_aim" class="sheet-d6pp">Aim</button>
                                      <button type="action" name="act_contest_init" class="sheet-d6pp">Initiate Contest</button>
                                  </div>
                                  <div class="spacer-md"></div>
                                  <div class="sheet-divider"></div>
                                  <div class="spacer-md"></div>
                                  <div class="sheet-controls-row">
                                      <div class="sheet-controls-group">
                                          <label class="sheet-d6pp-label">Turn Action Log</label>
                                      </div>
                                      <div class="sheet-controls-group">
                                          <label class="sheet-d6pp-label">Actions Remaining:</label>
                                          <input type="text" class="sheet-d6pp sheet-small-input" name="attr_actions_remaining" readonly />
                                      </div>
                                  </div>
                                  <textarea name="attr_action_log" id="attr_action_log" class="sheet-d6pp" rows="13" readonly></textarea>
                              </div>
                          </div>
                      </div>
                  </div>
                  <!-- Skill Check -->
                  <div class="sheet-section-collapsible">
                      <input type="checkbox" class="skill-toggle" id="toggle_skillcheck" name="attr_toggle_skillcheck" value="1" checked hidden />
                      <label class="skill-toggle-label" for="toggle_skillcheck">Skill Check Target Number</label>
                      <div class="skill-group-content">
                          <div class="sheet-grid-table six-col full-width">
                              <div class="grid-header">Target Number</div>
                              <div class="grid-header">Challenge Rating</div>
                              <div class="grid-header">Modifier</div>
                              <div class="grid-header">Wound Penalty</div>
                              <div class="grid-header">Armor Penalty</div>
                              <div class="grid-header">Driving Penalty</div>
                              <div class="grid-cell target-number-cell"><span name="attr_skill_check_target">0</span></div>
                              <div class="grid-cell">
                                  <select name="attr_skillcheck_cr" class="sheet-d6pp-select">
                                      <option value="0">Trivial</option>
                                      <option value="5">Easy (+5)</option>
                                      <option value="10">Moderate (+10)</option>
                                      <option value="15">Hard (+15)</option>
                                      <option value="20">Very Hard (+20)</option>
                                      <option value="25">Extremely Hard (+25)</option>
                                  </select>
                              </div>
                              <div class="grid-cell"><input type="number" name="attr_skillcheck_modifier" class="sheet-d6pp" value="0" /></div>
                              <div class="grid-cell number-cell"><span name="attr_skillcheck_wound_penalty">0</span></div>
                              <div class="grid-cell number-cell"><span name="attr_armor_penalty">0</span></div>
                              <div class="grid-cell number-cell"><span name="attr_skillcheck_mounted_penalty">0</span></div>
                          </div>
                          <span class="small-hint">Modifier includes Help, Prep, and situational bonuses.</span>
                      </div>
                  </div>
                  <!-- Combat -->
                  <div class="sheet-section-collapsible">
                      <input type="checkbox" class="skill-toggle" id="toggle_combat" name="attr_toggle_combat" value="1" checked hidden />
                      <label class="skill-toggle-label" for="toggle_combat">Attack Target Number</label>
                      <div class="skill-group-content">
                          <div class="sheet-grid-table ten-col full-width">
                              <!-- Headers -->
                              <div class="grid-header">Target Number</div>
                              <div class="grid-header">Range</div>
                              <div class="grid-header">Cover</div>
                              <div class="grid-header">Opponent's Dodge</div>
                              <div class="grid-header">Opponent's Armor</div>
                              <div class="grid-header">Modifier</div>
                              <div class="grid-header">Wound Penalty</div>
                              <div class="grid-header">Armor Penalty</div>
                              <div class="grid-header">Aiming Bonus</div>
                              <div class="grid-header">Driving Penalty</div>
                              <!-- Row values -->
                              <div class="grid-cell target-number-cell"><span name="attr_combat_target">0</span></div>
                              <div class="grid-cell">
                                  <select name="attr_combat_range" class="sheet-d6pp-select">
                                      <option value="5">Point Blank (5)</option>
                                      <option value="10">Short (10)</option>
                                      <option value="15">Medium (15)</option>
                                      <option value="20">Long (20)</option>
                                      <option value="25">Extreme (25)</option>
                                  </select>
                              </div>
                              <div class="grid-cell">
                                  <select name="attr_combat_cover" class="sheet-d6pp-select">
                                      <option value="0">None (0)</option>
                                      <option value="5">Light (5)</option>
                                      <option value="10">Half (10)</option>
                                      <option value="15">Heavy (15)</option>
                                      <option value="30">Full (30)</option>
                                  </select>
                              </div>
                              <div class="grid-cell">
                                  <input type="number" name="attr_combat_opponent_dodge" class="sheet-d6pp" value="0" min="0" />
                              </div>
                              <div class="grid-cell">
                                  <input type="number" name="attr_combat_opponent_armor" class="sheet-d6pp" value="0" min="0" />
                              </div>
                              <div class="grid-cell"><input type="number" name="attr_combat_modifier" class="sheet-d6pp" value="0" /></div>
                              <div class="grid-cell"><span name="attr_skillcheck_wound_penalty">0</span></div>
                              <div class="grid-cell"><span name="attr_armor_penalty">0</span></div>
                              <div class="grid-cell number-cell"><span name="attr_skillcheck_aiming_bonus">0</span></div>
                              <div class="grid-cell"><span name="attr_skillcheck_mounted_penalty">0</span></div>
                          </div>
                          <span class="small-hint">Modifier includes Help, Prep, and situational bonuses.</span>
                          <div class="spacer-md"></div>

                          <div class="spacer-sm"></div>
                          <div class="sheet-controls-row">
                              <!-- Left -->
                              <div class="sheet-controls-group">
                                  <button type="action" class="sheet-d6pp" name="act_initiative">Roll Initiative</button>
                              </div>
                          </div>
                      </div>
                  </div>
                  <!-- Armor -->
                  <div class="sheet-section-collapsible">
                    <input type="checkbox" class="skill-toggle" id="toggle_armor" name="attr_toggle_armor" value="1" checked hidden />
                    <label class="skill-toggle-label" for="toggle_armor">Armor</label>
                    <div class="skill-group-content">

                      <div class="sheet-armor-row">
                        <!-- Helmet -->
                        <div class="sheet-armor-column">
                          <label>Helmet</label>
                          <select name="attr_head_armor" class="sheet-d6pp-select">
                            <option value="None">None</option>
                            <option value="Improvised Helmet">Improvised Helmet</option>
                            <option value="Riot Helmet">Riot Helmet</option>
                            <option value="Full Helmet">Full Helmet</option>
                          </select>
                          <span>+<span name="attr_head_armor_bonus"></span> Bonus</span><br />
                          <span>+<span name="attr_head_armor_penalty"></span> Penalty</span>
                          <div class="spacer-sm"></div>
                          <span name="attr_head_armor_desc"></span>
                        </div>

                        <!-- Body Armor -->
                        <div class="sheet-armor-column">
                          <label>Body</label>
                          <select name="attr_body_armor" class="sheet-d6pp-select">
                            <option value="None">None</option>
                            <option value="Improvised Armor">Improvised Armor</option>
                            <option value="Kevlar Vest">Kevlar Vest</option>
                            <option value="Riot Armor">Riot Armor</option>
                          </select>
                          <span>+<span name="attr_body_armor_bonus"></span> Bonus</span><br />
                          <span>+<span name="attr_body_armor_penalty"></span> Penalty</span>
                          <div class="spacer-sm"></div>
                          <span name="attr_body_armor_desc"></span>
                        </div>

                        <!-- Shield -->
                        <div class="sheet-armor-column">
                          <label>Shield</label>
                          <select name="attr_shield" class="sheet-d6pp-select">
                            <option value="None">None</option>
                            <option value="Improvised Shield">Improvised Shield</option>
                            <option value="Riot Shield">Riot Shield</option>
                          </select>
                          <span>+<span name="attr_shield_bonus"></span> Bonus</span><br />
                          <span>+<span name="attr_shield_penalty"></span> Penalty</span>
                          <div class="spacer-sm"></div>
                          <span name="attr_shield_desc"></span>
                        </div>
                      </div>

                    </div>
                  </div>
                  <!-- Wounds -->
                  <div class="sheet-section-collapsible">
                      <input type="checkbox" class="skill-toggle" id="toggle_wounds" name="attr_toggle_wounds" value="1" checked hidden />
                      <label class="skill-toggle-label" for="toggle_wounds">Wounds</label>
                      <div class="skill-group-content">
                          <div class="sheet-grid-table six-col full-width">
                              <div class="grid-header">First Aid Target Number</div>
                              <div class="grid-header">Wound Points</div>
                              <div class="grid-header">Wounds Ignored</div>
                              <div class="grid-header"># First Aid</div>
                              <div class="grid-header">Unconscious Threshold</div>
                              <div class="grid-header">Death Threshold</div>
                              <div class="grid-cell target-number-cell">
                                  <span name="attr_first_aid_target">0</span>
                              </div>
                              <div class="grid-cell">
                                  <input type="number" name="attr_wounds_total" value="0" min="0" class="sheet-d6pp" />
                              </div>
                              <div class="grid-cell">
                                  <input type="number" name="attr_wounds_ignored" value="0" min="0" class="sheet-d6pp" />
                              </div>
                              <div class="grid-cell">
                                  <input type="number" name="attr_first_aid_count" value="0" min="0" class="sheet-d6pp" />
                              </div>
                              <div class="grid-cell"><span name="attr_unconscious_threshold"></span></div>
                              <div class="grid-cell"><span name="attr_death_threshold"></span></div>
                          </div>
                          <div class="spacer-md"></div>
                          <div class="sheet-controls-row">
                              <!-- Left -->
                              <div class="sheet-controls-group">
                                  <button type="action" class="sheet-d6pp" name="act_endure">Roll Endure</button>
                              </div>
                              <div class="sheet-controls-group">
                                  <label class="sheet-d6pp-label" style="margin: 0; display: inline;">Status:</label>
                                  <input type="text" class="sheet-d6pp" name="attr_status" readonly/>
                                  <div class="d6pp-checkbox">
                                      <label class="inline-checkbox-label">
                                      <input type="checkbox" name="attr_revived_toggle" />
                                      Revived
                                      </label>
                                  </div>
                              </div>
                          </div>
                      </div>
                  </div>
                  <!-- Conditions -->
                  <div class="sheet-section-collapsible">
                      <input type="checkbox" class="skill-toggle" id="toggle_conditions" name="attr_toggle_conditions" value="1" checked hidden />
                      <label class="skill-toggle-label" for="toggle_conditions">Conditions</label>
                      <div class="skill-group-content">
                        <div class="sheet-condition-grid">
                          <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_aiming" /> Aiming</label>
                          <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_blind" /> Blind</label>
                          <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_dehydrated" /> Dehydrated</label>
                          <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_diseased" /> Diseased</label>
                          <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_mounted" /> Driving</label>
                          <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_drunk" /> Drunk</label>
                          <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_exhausted" /> Exhausted</label>
                          <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_frightened" /> Frightened</label>
                          <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_grappled" /> Grappled</label>
                          <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_hyperthermic" /> Hyperthermic</label>
                          <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_hypothermic" /> Hypothermic</label>
                          <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_knockout" /> Knockout</label>
                          <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_poisoned" /> Poisoned</label>
                        </div>
                      </div>
                  </div>
                  <!-- Attributes (not spend mode) -->
                  <div class="sheet-section-collapsible">
                      <input type="checkbox" class="skill-toggle" id="toggle_attributes" name="attr_toggle_attributes" value="1" checked hidden />
                      <label class="skill-toggle-label" for="toggle_attributes">Attributes</label>
                      <div class="skill-group-content">
                          <div class="sheet-grid-table six-col full-width">
                              <!-- Headers -->
                              <div class="grid-header"></div>
                              <div class="grid-header">Base</div>
                              <div class="grid-header">Adjustment</div>
                              <div class="grid-header">Conditions</div>
                              <div class="grid-header">Actual</div>
                              <div class="grid-header">Roll</div>
                              <!-- Row: Strength -->
                              <div class="grid-cell number-cell">(S)trength</div>
                              <div class="grid-cell number-cell"><span name="attr_strength_base_string"></span></div>
                              <div class="grid-cell number-cell"><input type="number" name="attr_strength_adjustment" value="0" class="sheet-d6pp" /></div>
                              <div class="grid-cell number-cell"><span name="attr_strength_conditions"></span></div>
                              <div class="grid-cell number-cell"><span name="attr_strength_string"></span></div>
                              <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_strength">Roll</button></div>
                              <!-- Row: Agility -->
                              <div class="grid-cell number-cell">(A)gility</div>
                              <div class="grid-cell number-cell"><span name="attr_agility_base_string"></span></div>
                              <div class="grid-cell number-cell"><input type="number" name="attr_agility_adjustment" value="0" class="sheet-d6pp" /></div>
                              <div class="grid-cell number-cell"><span name="attr_agility_conditions"></span></div>
                              <div class="grid-cell number-cell"><span name="attr_agility_string"></span></div>
                              <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_agility">Roll</button></div>
                              <!-- Row: Health -->
                              <div class="grid-cell number-cell">(H)ealth</div>
                              <div class="grid-cell number-cell"><span name="attr_health_base_string"></span></div>
                              <div class="grid-cell number-cell"><input type="number" name="attr_health_adjustment" value="0" class="sheet-d6pp" /></div>
                              <div class="grid-cell number-cell"><span name="attr_health_conditions"></span></div>
                              <div class="grid-cell number-cell"><span name="attr_health_string"></span></div>
                              <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_health">Roll</button></div>
                              <!-- Row: Perception -->
                              <div class="grid-cell number-cell">(P)erception</div>
                              <div class="grid-cell number-cell"><span name="attr_perception_base_string"></span></div>
                              <div class="grid-cell number-cell"><input type="number" name="attr_perception_adjustment" value="0" class="sheet-d6pp" /></div>
                              <div class="grid-cell number-cell"><span name="attr_perception_conditions"></span></div>
                              <div class="grid-cell number-cell"><span name="attr_perception_string"></span></div>
                              <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_perception">Roll</button></div>
                              <!-- Row: Quickness -->
                              <div class="grid-cell number-cell">(Q)uickness</div>
                              <div class="grid-cell number-cell"><span name="attr_quickness_base_string"></span></div>
                              <div class="grid-cell number-cell"><input type="number" name="attr_quickness_adjustment" value="0" class="sheet-d6pp" /></div>
                              <div class="grid-cell number-cell"><span name="attr_quickness_conditions"></span></div>
                              <div class="grid-cell number-cell"><span name="attr_quickness_string"></span></div>
                              <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_quickness">Roll</button></div>
                              <!-- Row: Willpower -->
                              <div class="grid-cell number-cell">(W)illpower</div>
                              <div class="grid-cell number-cell"><span name="attr_willpower_base_string"></span></div>
                              <div class="grid-cell number-cell"><input type="number" name="attr_willpower_adjustment" value="0" class="sheet-d6pp" /></div>
                              <div class="grid-cell number-cell"><span name="attr_willpower_conditions"></span></div>
                              <div class="grid-cell number-cell"><span name="attr_willpower_string"></span></div>
                              <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_willpower">Roll</button></div>
                              <!-- Row: Intelligence -->
                              <div class="grid-cell number-cell">(I)ntelligence</div>
                              <div class="grid-cell number-cell"><span name="attr_intelligence_base_string"></span></div>
                              <div class="grid-cell number-cell"><input type="number" name="attr_intelligence_adjustment" value="0" class="sheet-d6pp" /></div>
                              <div class="grid-cell number-cell"><span name="attr_intelligence_conditions"></span></div>
                              <div class="grid-cell number-cell"><span name="attr_intelligence_string"></span></div>
                              <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_intelligence">Roll</button></div>
                              <!-- Row: Manual Dexterity -->
                              <div class="grid-cell number-cell">(M)anual Dex</div>
                              <div class="grid-cell number-cell"><span name="attr_manualdex_base_string"></span></div>
                              <div class="grid-cell number-cell"><input type="number" name="attr_manualdex_adjustment" value="0" class="sheet-d6pp" /></div>
                              <div class="grid-cell number-cell"><span name="attr_manualdex_conditions"></span></div>
                              <div class="grid-cell number-cell"><span name="attr_manualdex_string"></span></div>
                              <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_manualdex">Roll</button></div>
                              <!-- Row: Charisma -->
                              <div class="grid-cell number-cell">(C)harisma</div>
                              <div class="grid-cell number-cell"><span name="attr_charisma_base_string"></span></div>
                              <div class="grid-cell number-cell"><input type="number" name="attr_charisma_adjustment" value="0" class="sheet-d6pp" /></div>
                              <div class="grid-cell number-cell"><span name="attr_charisma_conditions"></span></div>
                              <div class="grid-cell number-cell"><span name="attr_charisma_string"></span></div>
                              <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_charisma">Roll</button></div>
                          </div>
                      </div>
                  </div>
                  <!-- Core Skills -->
                  <div class="skill-section-collapsible">
                      <input type="checkbox" class="skill-toggle" id="toggle_core" name="attr_toggle_core" value="1" checked hidden />
                      <label class="skill-toggle-label" for="toggle_core">Core Skill Group</label>
                      <div class="skill-group-content">
                          <div class="sheet-grid-table four-col">
                              <!-- Headers -->
                              <div class="grid-header">Skill</div>
                              <div class="grid-header">Attr Code</div>
                              <div class="grid-header">Dice Code</div>
                              <div class="grid-header">Roll</div>
                              <!-- Row: Avoid -->
                              <div class="grid-cell grid-skill-name">
                                  <span name="attr_avoid_displayname"></span><span name="attr_avoid_specialized"></span>
                              </div>
                              <div class="grid-cell number-cell"><span name="attr_avoid_attributes"></span></div>
                              <div class="grid-cell number-cell"><span name="attr_avoid_string"></span></div>
                              <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_avoid">Roll</button></div>
                              <!-- Row: Defend -->
                              <div class="grid-cell grid-skill-name">
                                  <span name="attr_defend_displayname"></span><span name="attr_defend_specialized"></span>
                              </div>
                              <div class="grid-cell number-cell"><span name="attr_defend_attributes"></span></div>
                              <div class="grid-cell number-cell"><span name="attr_defend_string"></span></div>
                              <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_defend">Roll</button></div>
                              <!-- Row: Dodge -->
                              <div class="grid-cell grid-skill-name">
                                  <span name="attr_dodge_displayname"></span><span name="attr_dodge_specialized"></span>
                              </div>
                              <div class="grid-cell number-cell"><span name="attr_dodge_attributes"></span></div>
                              <div class="grid-cell number-cell"><span name="attr_dodge_string"></span></div>
                              <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_dodge">Roll</button></div>
                              <!-- Row: Endure -->
                              <div class="grid-cell grid-skill-name">
                                  <span name="attr_endure_displayname"></span><span name="attr_endure_specialized"></span>
                              </div>
                              <div class="grid-cell number-cell"><span name="attr_endure_attributes"></span></div>
                              <div class="grid-cell number-cell"><span name="attr_endure_string"></span></div>
                              <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_endure">Roll</button></div>
                              <!-- Row: Initiative -->
                              <div class="grid-cell grid-skill-name">
                                  <span name="attr_initiative_displayname"></span><span name="attr_initiative_specialized"></span>
                              </div>
                              <div class="grid-cell number-cell"><span name="attr_initiative_attributes"></span></div>
                              <div class="grid-cell number-cell"><span name="attr_initiative_string"></span></div>
                              <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_initiative">Roll</button></div>
                          </div>
                      </div>
                  </div>
              </div>
              <!-- Hide when spending -->
              <input type="hidden" name="attr_spend_mode" value="0" />
              <div class="show-when-spending">
                  <!-- Attribute (spend mode) -->
                  <div class="sheet-section-collapsible">
                      <input type="checkbox" class="skill-toggle" id="toggle_attributes_ro" name="attr_toggle_attributes_ro" value="1" checked hidden />
                      <label class="skill-toggle-label" for="toggle_attributes_ro">Attributes</label>
                      <div class="skill-group-content">
                          <div class="sheet-grid-table two-col">
                              <div class="grid-header"></div>
                              <div class="grid-header">Base</div>
                              <div class="grid-cell number-cell">(S)trength</div>
                              <div class="grid-cell number-cell"><span name="attr_strength_base_string"></span></div>
                              <div class="grid-cell number-cell">(A)gility</div>
                              <div class="grid-cell number-cell"><span name="attr_agility_base_string"></span></div>
                              <div class="grid-cell number-cell">(H)ealth</div>
                              <div class="grid-cell number-cell"><span name="attr_health_base_string"></span></div>
                              <div class="grid-cell number-cell">(P)erception</div>
                              <div class="grid-cell number-cell"><span name="attr_perception_base_string"></span></div>
                              <div class="grid-cell number-cell">(Q)uickness</div>
                              <div class="grid-cell number-cell"><span name="attr_quickness_base_string"></span></div>
                              <div class="grid-cell number-cell">(W)illpower</div>
                              <div class="grid-cell number-cell"><span name="attr_willpower_base_string"></span></div>
                              <div class="grid-cell number-cell">(I)ntelligence</div>
                              <div class="grid-cell number-cell"><span name="attr_intelligence_base_string"></span></div>
                              <div class="grid-cell number-cell">(M)anual Dex</div>
                              <div class="grid-cell number-cell"><span name="attr_manualdex_base_string"></span></div>
                              <div class="grid-cell number-cell">(C)harisma</div>
                              <div class="grid-cell number-cell"><span name="attr_charisma_base_string"></span></div>
                          </div>
                      </div>
                  </div>
              </div>
              <!-- Show when spending -->
              <h3>Non-Combat Skills</h3>
              <div class="spacer-md"></div>
              <!-- Animals Skill Group -->
              <div class="skill-section-collapsible">
                  <input type="checkbox" class="skill-toggle" id="toggle_animals" name="attr_toggle_animals" value="1" checked hidden />
                  <label class="skill-toggle-label" for="toggle_animals">Animals Skill Group Training = <span name="attr_animals_string"></span></label>
                  <div class="skill-group-content">
                      <div class="sheet-spendblock">
                          <input type="hidden" name="attr_spend_mode" value="0" />
                          <div class="spend-mode">
                              <button type="action" name="act_add_animals" class="commit-spend-mode">Train (<span name="attr_animals_cost"></span> skill points)</button>
                              <button type="action" name="act_refund_animals" class="commit-spend-mode">Refund (<span name="attr_animals_refund"></span> skill points)</button>
                              <div class="commit-spend-mode">
                                  Skill Points Left: <span name="attr_skill_points"></span>
                              </div>
                          </div>
                          <div class="spacer-sm"></div>
                      </div>
                      <div class="sheet-grid-table four-col">
                          <div class="grid-header">Skill</div>
                          <div class="grid-header">Attr Code</div>
                          <div class="grid-header">Dice Code</div>
                          <div class="grid-header">Roll</div>

                          <div class="grid-cell number-cell"><span name="attr_animal_care_displayname"></span><span name="attr_animal_care_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_animal_care_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_animal_care_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_animal_care">Roll</button></div>

                          <div class="grid-cell number-cell"><span name="attr_animal_empathy_displayname"></span><span name="attr_animal_empathy_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_animal_empathy_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_animal_empathy_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_animal_empathy">Roll</button></div>

                          <div class="grid-cell number-cell"><span name="attr_animal_handling_displayname"></span><span name="attr_animal_handling_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_animal_handling_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_animal_handling_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_animal_handling">Roll</button></div>

                          <div class="grid-cell number-cell"><span name="attr_animal_training_displayname"></span><span name="attr_animal_training_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_animal_training_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_animal_training_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_animal_training">Roll</button></div>

                      </div>
                  </div>
              </div>
              <!-- Aviation Skill Group -->
              <div class="skill-section-collapsible">
                  <input type="checkbox" class="skill-toggle" id="toggle_aviation" name="attr_toggle_aviation" value="1" checked hidden />
                  <label class="skill-toggle-label" for="toggle_aviation">Aviation Skill Group Training = <span name="attr_aviation_string"></span></label>
                  <div class="skill-group-content">
                      <div class="sheet-spendblock">
                          <input type="hidden" name="attr_spend_mode" value="0" />
                          <div class="spend-mode">
                              <button type="action" name="act_add_aviation" class="commit-spend-mode">Train (<span name="attr_aviation_cost"></span> skill points)</button>
                              <button type="action" name="act_refund_aviation" class="commit-spend-mode">Refund (<span name="attr_aviation_refund"></span> skill points)</button>
                              <div class="commit-spend-mode">
                                  Skill Points Left: <span name="attr_skill_points"></span>
                              </div>
                          </div>
                          <div class="spacer-sm"></div>
                      </div>
                      <div class="sheet-grid-table four-col">
                          <div class="grid-header">Skill</div>
                          <div class="grid-header">Attr Code</div>
                          <div class="grid-header">Dice Code</div>
                          <div class="grid-header">Roll</div>

                          <div class="grid-cell number-cell"><span name="attr_air_navigation_displayname"></span><span name="attr_air_navigation_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_air_navigation_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_air_navigation_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_air_navigation">Roll</button></div>

                          <div class="grid-cell number-cell"><span name="attr_control_drone_displayname"></span><span name="attr_control_drone_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_control_drone_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_control_drone_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_control_drone">Roll</button></div>

                          <div class="grid-cell number-cell"><span name="attr_fly_helicopter_displayname"></span><span name="attr_fly_helicopter_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_fly_helicopter_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_fly_helicopter_string"></span></div>
                          <div class="grid-cell">
                              <input type="hidden" name="attr_fly_helicopter_active" value="2" />
                              <div class="skill-roll-buttons">
                                  <button type="action" name="act_activate_fly_helicopter" class="activate-skill-button" title="Activation costs 12 skill points.">Activate</button>
                                  <button type="action" name="act_undo_activate_fly_helicopter" class="undo-activate-skill-button">Undo</button>
                                  <button type="action" name="act_fly_helicopter" class="roll-skill-button">Roll</button>
                                  <span class="unactivated-label">Not Activated</span>
                              </div>
                          </div>

                          <div class="grid-cell number-cell"><span name="attr_fly_plane_displayname"></span><span name="attr_fly_plane_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_fly_plane_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_fly_plane_string"></span></div>
                          <div class="grid-cell">
                              <input type="hidden" name="attr_fly_plane_active" value="2" />
                              <div class="skill-roll-buttons">
                                  <button type="action" name="act_activate_fly_plane" class="activate-skill-button" title="Activation costs 12 skill points.">Activate</button>
                                  <button type="action" name="act_undo_activate_fly_plane" class="undo-activate-skill-button">Undo</button>
                                  <button type="action" name="act_fly_plane" class="roll-skill-button">Roll</button>
                                  <span class="unactivated-label">Not Activated</span>
                              </div>
                          </div>
                      </div>
                      <span class="small-hint">Activating a skill costs 12 skill points.</span>
                  </div>
              </div>
              <!-- Awareness Skill Group -->
              <div class="skill-section-collapsible">
                  <input type="checkbox" class="skill-toggle" id="toggle_awareness" name="attr_toggle_awareness" value="1" checked hidden />
                  <label class="skill-toggle-label" for="toggle_awareness">Awareness Skill Group Training = <span name="attr_awareness_string"></span></label>
                  <div class="skill-group-content">
                      <div class="sheet-spendblock">
                          <input type="hidden" name="attr_spend_mode" value="0" />
                          <div class="spend-mode">
                              <button type="action" name="act_add_awareness" class="commit-spend-mode">Train (<span name="attr_awareness_cost"></span> skill points)</button>
                              <button type="action" name="act_refund_awareness" class="commit-spend-mode">Refund (<span name="attr_awareness_refund"></span> skill points)</button>
                              <div class="commit-spend-mode">
                                  Skill Points Left: <span name="attr_skill_points"></span>
                              </div>
                          </div>
                          <div class="spacer-sm"></div>
                      </div>
                      <div class="sheet-grid-table four-col">
                          <div class="grid-header">Skill</div>
                          <div class="grid-header">Attr Code</div>
                          <div class="grid-header">Dice Code</div>
                          <div class="grid-header">Roll</div>
                          <div class="grid-cell number-cell"><span name="attr_empathy_displayname"></span><span name="attr_empathy_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_empathy_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_empathy_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_empathy">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_insight_displayname"></span><span name="attr_insight_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_insight_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_insight_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_insight">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_instinct_displayname"></span><span name="attr_instinct_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_instinct_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_instinct_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_instinct">Roll</button></div>
                      </div>
                  </div>
              </div>
              <!-- Computers Skill Group -->
              <div class="skill-section-collapsible">
                  <input type="checkbox" class="skill-toggle" id="toggle_computers" name="attr_toggle_computers" value="1" checked hidden />
                  <label class="skill-toggle-label" for="toggle_computers">Computers Skill Group Training = <span name="attr_computers_string"></span></label>
                  <div class="skill-group-content">
                      <div class="sheet-spendblock">
                          <input type="hidden" name="attr_spend_mode" value="0" />
                          <div class="spend-mode">
                              <button type="action" name="act_add_computers" class="commit-spend-mode">Train (<span name="attr_computers_cost"></span> skill points)</button>
                              <button type="action" name="act_refund_computers" class="commit-spend-mode">Refund (<span name="attr_computers_refund"></span> skill points)</button>
                              <div class="commit-spend-mode">
                                  Skill Points Left: <span name="attr_skill_points"></span>
                              </div>
                          </div>
                          <div class="spacer-sm"></div>
                      </div>
                      <div class="sheet-grid-table four-col">
                          <div class="grid-header">Skill</div>
                          <div class="grid-header">Attr Code</div>
                          <div class="grid-header">Dice Code</div>
                          <div class="grid-header">Roll</div>
                          <div class="grid-cell number-cell"><span name="attr_computer_use_displayname"></span><span name="attr_computer_use_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_computer_use_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_computer_use_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_computer_use">Roll</button></div>

                          <div class="grid-cell number-cell"><span name="attr_hacking_displayname"></span><span name="attr_hacking_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_hacking_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_hacking_string"></span></div>
                          <div class="grid-cell">
                              <input type="hidden" name="attr_hacking_active" value="2" />
                              <div class="skill-roll-buttons">
                                  <button type="action" name="act_activate_hacking" class="activate-skill-button" title="Activation costs 12 skill points.">Activate</button>
                                  <button type="action" name="act_undo_activate_hacking" class="undo-activate-skill-button">Undo</button>
                                  <button type="action" name="act_hacking" class="roll-skill-button">Roll</button>
                                  <span class="unactivated-label">Not Activated</span>
                              </div>
                          </div>

                          <div class="grid-cell number-cell"><span name="attr_hardware_displayname"></span><span name="attr_hardware_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_hardware_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_hardware_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_hardware">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_programming_displayname"></span><span name="attr_programming_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_programming_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_programming_string"></span></div>
                          <div class="grid-cell">
                              <input type="hidden" name="attr_programming_active" value="2" />
                              <div class="skill-roll-buttons">
                                  <button type="action" name="act_activate_programming" class="activate-skill-button" title="Activation costs 12 skill points.">Activate</button>
                                  <button type="action" name="act_undo_activate_programming" class="undo-activate-skill-button">Undo</button>
                                  <button type="action" name="act_programming" class="roll-skill-button">Roll</button>
                                  <span class="unactivated-label">Not Activated</span>
                              </div>
                          </div>
                      </div>
                      <span class="small-hint">Activating a skill costs 12 skill points.</span>
                  </div>
              </div>
              <!-- Driving Skill Group -->
              <div class="skill-section-collapsible">
                  <input type="checkbox" class="skill-toggle" id="toggle_driving" name="attr_toggle_driving" value="1" checked hidden />
                  <label class="skill-toggle-label" for="toggle_driving">Driving Skill Group Training = <span name="attr_driving_string"></span></label>
                  <div class="skill-group-content">
                      <div class="sheet-spendblock">
                          <input type="hidden" name="attr_spend_mode" value="0" />
                          <div class="spend-mode">
                              <button type="action" name="act_add_driving" class="commit-spend-mode">Train (<span name="attr_driving_cost"></span> skill points)</button>
                              <button type="action" name="act_refund_driving" class="commit-spend-mode">Refund (<span name="attr_driving_refund"></span> skill points)</button>
                              <div class="commit-spend-mode">
                                  Skill Points Left: <span name="attr_skill_points"></span>
                              </div>
                          </div>
                          <div class="spacer-sm"></div>
                      </div>
                      <div class="sheet-grid-table four-col">
                          <div class="grid-header">Skill</div>
                          <div class="grid-header">Attr Code</div>
                          <div class="grid-header">Dice Code</div>
                          <div class="grid-header">Roll</div>
                          <div class="grid-cell number-cell"><span name="attr_drive_car_displayname"></span><span name="attr_drive_car_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_drive_car_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_drive_car_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_drive_car">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_drive_motorcycle_displayname"></span><span name="attr_drive_motorcycle_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_drive_motorcycle_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_drive_motorcycle_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_drive_motorcycle">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_drive_semi_displayname"></span><span name="attr_drive_semi_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_drive_semi_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_drive_semi_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_drive_semi">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_ride_bicycle_displayname"></span><span name="attr_ride_bicycle_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_ride_bicycle_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_ride_bicycle_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_ride_bicycle">Roll</button></div>
                      </div>
                  </div>
              </div>
              <!-- Investigation Skill Group -->
              <div class="skill-section-collapsible">
                  <input type="checkbox" class="skill-toggle" id="toggle_investigation" name="attr_toggle_investigation" value="1" checked hidden />
                  <label class="skill-toggle-label" for="toggle_investigation">Investigation Skill Group Training = <span name="attr_investigation_string"></span></label>
                  <div class="skill-group-content">
                      <div class="sheet-spendblock">
                          <input type="hidden" name="attr_spend_mode" value="0" />
                          <div class="spend-mode">
                              <button type="action" name="act_add_investigation" class="commit-spend-mode">Train (<span name="attr_investigation_cost"></span> skill points)</button>
                              <button type="action" name="act_refund_investigation" class="commit-spend-mode">Refund (<span name="attr_investigation_refund"></span> skill points)</button>
                              <div class="commit-spend-mode">
                                  Skill Points Left: <span name="attr_skill_points"></span>
                              </div>
                          </div>
                          <div class="spacer-sm"></div>
                      </div>
                      <div class="sheet-grid-table four-col">
                          <div class="grid-header">Skill</div>
                          <div class="grid-header">Attr Code</div>
                          <div class="grid-header">Dice Code</div>
                          <div class="grid-header">Roll</div>
                          <div class="grid-cell number-cell"><span name="attr_forensics_displayname"></span><span name="attr_forensics_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_forensics_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_forensics_string"></span></div>
                          <div class="grid-cell">
                              <input type="hidden" name="attr_forensics_active" value="2" />
                              <div class="skill-roll-buttons">
                                  <button type="action" name="act_activate_forensics" class="activate-skill-button" title="Activation costs 12 skill points.">Activate</button>
                                  <button type="action" name="act_undo_activate_forensics" class="undo-activate-skill-button">Undo</button>
                                  <button type="action" name="act_forensics" class="roll-skill-button">Roll</button>
                                  <span class="unactivated-label">Not Activated</span>
                              </div>
                          </div>
                          <div class="grid-cell number-cell"><span name="attr_interrogation_displayname"></span><span name="attr_interrogation_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_interrogation_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_interrogation_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_interrogate">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_investigate_displayname"></span><span name="attr_investigate_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_investigate_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_investigate_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_investigate">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_search_displayname"></span><span name="attr_search_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_search_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_search_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_search">Roll</button></div>
                      </div>
                      <span class="small-hint">Activating a skill costs 12 skill points.</span>
                  </div>
              </div>
              <!-- Knowledge Skill Group -->
              <div class="skill-section-collapsible">
                  <input type="checkbox" class="skill-toggle" id="toggle_knowledge" name="attr_toggle_knowledge" value="1" checked hidden />
                  <label class="skill-toggle-label" for="toggle_knowledge">Knowledge Skill Group Training = <span name="attr_knowledge_string"></span></label>
                  <div class="skill-group-content">
                      <div class="sheet-spendblock">
                          <input type="hidden" name="attr_spend_mode" value="0" />
                          <div class="spend-mode">
                              <button type="action" name="act_add_knowledge" class="commit-spend-mode">Train (<span name="attr_knowledge_cost"></span> skill points)</button>
                              <button type="action" name="act_refund_knowledge" class="commit-spend-mode">Refund (<span name="attr_knowledge_refund"></span> skill points)</button>
                              <div class="commit-spend-mode">
                                  Skill Points Left: <span name="attr_skill_points"></span>
                              </div>
                          </div>
                          <div class="spacer-sm"></div>
                      </div>
                      <div class="sheet-grid-table four-col">
                          <div class="grid-header">Skill</div>
                          <div class="grid-header">Attr Code</div>
                          <div class="grid-header">Dice Code</div>
                          <div class="grid-header">Roll</div>
                          <div class="grid-cell number-cell"><span name="attr_appraisal_displayname"></span><span name="attr_appraisal_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_appraisal_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_appraisal_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_appraisal">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_astronomy_displayname"></span><span name="attr_astronomy_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_astronomy_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_astronomy_string"></span></div>
                          <div class="grid-cell">
                              <input type="hidden" name="attr_astronomy_active" value="2" />
                              <div class="skill-roll-buttons">
                                  <button type="action" name="act_activate_astronomy" class="activate-skill-button" title="Activation costs 12 skill points.">Activate</button>
                                  <button type="action" name="act_undo_activate_astronomy" class="undo-activate-skill-button">Undo</button>
                                  <button type="action" name="act_astronomy" class="roll-skill-button">Roll</button>
                                  <span class="unactivated-label">Not Activated</span>
                              </div>
                          </div>
                          <div class="grid-cell number-cell"><span name="attr_biology_displayname"></span><span name="attr_biology_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_biology_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_biology_string"></span></div>
                          <div class="grid-cell">
                              <input type="hidden" name="attr_biology_active" value="2" />
                              <div class="skill-roll-buttons">
                                  <button type="action" name="act_activate_biology" class="activate-skill-button" title="Activation costs 12 skill points.">Activate</button>
                                  <button type="action" name="act_undo_activate_biology" class="undo-activate-skill-button">Undo</button>
                                  <button type="action" name="act_biology" class="roll-skill-button">Roll</button>
                                  <span class="unactivated-label">Not Activated</span>
                              </div>
                          </div>
                          <div class="grid-cell number-cell"><span name="attr_cartography_displayname"></span><span name="attr_cartography_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_cartography_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_cartography_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_cartography">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_chemistry_displayname"></span><span name="attr_chemistry_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_chemistry_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_chemistry_string"></span></div>
                          <div class="grid-cell">
                              <input type="hidden" name="attr_chemistry_active" value="2" />
                              <div class="skill-roll-buttons">
                                  <button type="action" name="act_activate_chemistry" class="activate-skill-button" title="Activation costs 12 skill points.">Activate</button>
                                  <button type="action" name="act_undo_activate_chemistry" class="undo-activate-skill-button">Undo</button>
                                  <button type="action" name="act_chemistry" class="roll-skill-button">Roll</button>
                                  <span class="unactivated-label">Not Activated</span>
                              </div>
                          </div>
                          <div class="grid-cell number-cell"><span name="attr_education_displayname"></span><span name="attr_education_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_education_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_education_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_education">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_engineering_displayname"></span><span name="attr_engineering_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_engineering_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_engineering_string"></span></div>
                          <div class="grid-cell">
                              <input type="hidden" name="attr_engineering_active" value="2" />
                              <div class="skill-roll-buttons">
                                  <button type="action" name="act_activate_engineering" class="activate-skill-button" title="Activation costs 12 skill points.">Activate</button>
                                  <button type="action" name="act_undo_activate_engineering" class="undo-activate-skill-button">Undo</button>
                                  <button type="action" name="act_engineering" class="roll-skill-button">Roll</button>
                                  <span class="unactivated-label">Not Activated</span>
                              </div>
                          </div>
                          <div class="grid-cell number-cell"><span name="attr_law_displayname"></span><span name="attr_law_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_law_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_law_string"></span></div>
                          <div class="grid-cell">
                              <input type="hidden" name="attr_law_active" value="2" />
                              <div class="skill-roll-buttons">
                                  <button type="action" name="act_activate_law" class="activate-skill-button" title="Activation costs 12 skill points.">Activate</button>
                                  <button type="action" name="act_undo_activate_law" class="undo-activate-skill-button">Undo</button>
                                  <button type="action" name="act_law" class="roll-skill-button">Roll</button>
                                  <span class="unactivated-label">Not Activated</span>
                              </div>
                          </div>
                          <div class="grid-cell number-cell"><span name="attr_linguistics_displayname"></span><span name="attr_linguistics_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_linguistics_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_linguistics_string"></span></div>
                          <div class="grid-cell">
                              <input type="hidden" name="attr_linguistics_active" value="2" />
                              <div class="skill-roll-buttons">
                                  <button type="action" name="act_activate_linguistics" class="activate-skill-button" title="Activation costs 12 skill points.">Activate</button>
                                  <button type="action" name="act_undo_activate_linguistics" class="undo-activate-skill-button">Undo</button>
                                  <button type="action" name="act_linguistics" class="roll-skill-button">Roll</button>
                                  <span class="unactivated-label">Not Activated</span>
                              </div>
                          </div>
                          <div class="grid-cell number-cell"><span name="attr_mathematics_displayname"></span><span name="attr_mathematics_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_mathematics_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_mathematics_string"></span></div>
                          <div class="grid-cell">
                              <input type="hidden" name="attr_mathematics_active" value="2" />
                              <div class="skill-roll-buttons">
                                  <button type="action" name="act_activate_mathematics" class="activate-skill-button" title="Activation costs 12 skill points.">Activate</button>
                                  <button type="action" name="act_undo_activate_mathematics" class="undo-activate-skill-button">Undo</button>
                                  <button type="action" name="act_mathematics" class="roll-skill-button">Roll</button>
                                  <span class="unactivated-label">Not Activated</span>
                              </div>
                          </div>
                          <div class="grid-cell number-cell"><span name="attr_physics_displayname"></span><span name="attr_physics_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_physics_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_physics_string"></span></div>
                          <div class="grid-cell">
                              <input type="hidden" name="attr_physics_active" value="2" />
                              <div class="skill-roll-buttons">
                                  <button type="action" name="act_activate_physics" class="activate-skill-button" title="Activation costs 12 skill points.">Activate</button>
                                  <button type="action" name="act_undo_activate_physics" class="undo-activate-skill-button">Undo</button>
                                  <button type="action" name="act_physics" class="roll-skill-button">Roll</button>
                                  <span class="unactivated-label">Not Activated</span>
                              </div>
                          </div>

                          <div class="grid-cell number-cell"><span name="attr_writing_displayname"></span><span name="attr_writing_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_writing_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_writing_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_writing">Roll</button></div>
                      </div>
                      <span class="small-hint">Activating a skill costs 12 skill points.</span>
                  </div>
              </div>
              <!-- Medical Skill Group -->
              <div class="skill-section-collapsible">
                  <input type="checkbox" class="skill-toggle" id="toggle_medical" name="attr_toggle_medical" value="1" checked hidden />
                  <label class="skill-toggle-label" for="toggle_medical">Medical Skill Group Training = <span name="attr_medical_string"></span></label>
                  <div class="skill-group-content">
                      <div class="sheet-spendblock">
                          <input type="hidden" name="attr_spend_mode" value="0" />
                          <div class="spend-mode">
                              <button type="action" name="act_add_medical" class="commit-spend-mode">Train (<span name="attr_medical_cost"></span> skill points)</button>
                              <button type="action" name="act_refund_medical" class="commit-spend-mode">Refund (<span name="attr_medical_refund"></span> skill points)</button>
                              <div class="commit-spend-mode">
                                  Skill Points Left: <span name="attr_skill_points"></span>
                              </div>
                          </div>
                          <div class="spacer-sm"></div>
                      </div>
                      <div class="sheet-grid-table four-col">
                          <div class="grid-header">Skill</div>
                          <div class="grid-header">Attr Code</div>
                          <div class="grid-header">Dice Code</div>
                          <div class="grid-header">Roll</div>
                          <div class="grid-cell number-cell"><span name="attr_first_aid_displayname"></span><span name="attr_first_aid_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_first_aid_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_first_aid_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_first_aid">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_medical_care_displayname"></span><span name="attr_medical_care_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_medical_care_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_medical_care_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_medical_care">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_pharmacology_displayname"></span><span name="attr_pharmacology_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_pharmacology_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_pharmacology_string"></span></div>
                          <div class="grid-cell">
                              <input type="hidden" name="attr_pharmacology_active" value="2" />
                              <div class="skill-roll-buttons">
                                  <button type="action" name="act_activate_pharmacology" class="activate-skill-button" title="Activation costs 12 skill points.">Activate</button>
                                  <button type="action" name="act_undo_activate_pharmacology" class="undo-activate-skill-button">Undo</button>
                                  <button type="action" name="act_pharmacology" class="roll-skill-button">Roll</button>
                                  <span class="unactivated-label">Not Activated</span>
                              </div>
                          </div>
                          <div class="grid-cell number-cell"><span name="attr_psychiatry_displayname"></span><span name="attr_psychiatry_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_psychiatry_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_psychiatry_string"></span></div>
                          <div class="grid-cell">
                              <input type="hidden" name="attr_psychiatry_active" value="2" />
                              <div class="skill-roll-buttons">
                                  <button type="action" name="act_activate_psychiatry" class="activate-skill-button" title="Activation costs 12 skill points.">Activate</button>
                                  <button type="action" name="act_undo_activate_psychiatry" class="undo-activate-skill-button">Undo</button>
                                  <button type="action" name="act_psychiatry" class="roll-skill-button">Roll</button>
                                  <span class="unactivated-label">Not Activated</span>
                              </div>
                          </div>
                          <div class="grid-cell number-cell"><span name="attr_surgery_displayname"></span><span name="attr_surgery_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_surgery_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_surgery_string"></span></div>
                          <div class="grid-cell">
                              <input type="hidden" name="attr_surgery_active" value="2" />
                              <div class="skill-roll-buttons">
                                  <button type="action" name="act_activate_surgery" class="activate-skill-button" title="Activation costs 12 skill points.">Activate</button>
                                  <button type="action" name="act_undo_activate_surgery" class="undo-activate-skill-button">Undo</button>
                                  <button type="action" name="act_surgery" class="roll-skill-button">Roll</button>
                                  <span class="unactivated-label">Not Activated</span>
                              </div>
                          </div>
                      </div>
                      <span class="small-hint">Activating a skill costs 12 skill points.</span>
                  </div>
              </div>
              <!-- Military Training Skill Group -->
              <div class="skill-section-collapsible">
                  <input type="checkbox" class="skill-toggle" id="toggle_military_training" name="attr_toggle_military_training" value="1" checked hidden />
                  <label class="skill-toggle-label" for="toggle_military_training">Military Training Skill Group Training = <span name="attr_military_training_string"></span></label>
                  <div class="skill-group-content">
                      <div class="sheet-spendblock">
                          <input type="hidden" name="attr_spend_mode" value="0" />
                          <div class="spend-mode">
                              <button type="action" name="act_add_military_training" class="commit-spend-mode">Train (<span name="attr_military_training_cost"></span> skill points)</button>
                              <button type="action" name="act_refund_military_training" class="commit-spend-mode">Refund (<span name="attr_military_training_refund"></span> skill points)</button>
                              <div class="commit-spend-mode">
                                  Skill Points Left: <span name="attr_skill_points"></span>
                              </div>
                          </div>
                          <div class="spacer-sm"></div>
                      </div>
                      <div class="sheet-grid-table four-col">
                          <div class="grid-header">Skill</div>
                          <div class="grid-header">Attr Code</div>
                          <div class="grid-header">Dice Code</div>
                          <div class="grid-header">Roll</div>

                          <div class="grid-cell"><span name="attr_camouflage_displayname"></span><span name="attr_camouflage_specialized"></span></div>
                          <div class="grid-cell"><span name="attr_camouflage_attributes"></span></div>
                          <div class="grid-cell"><span name="attr_camouflage_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_camouflage">Roll</button></div>

                          <div class="grid-cell number-cell"><span name="attr_command_displayname"></span><span name="attr_command_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_command_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_command_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_command">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_hand_signals_displayname"></span><span name="attr_hand_signals_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_hand_signals_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_hand_signals_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_hand_signals">Roll</button></div>

                          <div class="grid-cell number-cell"><span name="attr_spycraft_displayname"></span><span name="attr_spycraft_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_spycraft_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_spycraft_string"></span></div>
                          <div class="grid-cell">
                              <input type="hidden" name="attr_spycraft_active" value="2" />
                              <div class="skill-roll-buttons">
                                  <button type="action" name="act_activate_spycraft" class="activate-skill-button" title="Activation costs 12 skill points.">Activate</button>
                                  <button type="action" name="act_undo_activate_spycraft" class="undo-activate-skill-button">Undo</button>
                                  <button type="action" name="act_spycraft" class="roll-skill-button">Roll</button>
                                  <span class="unactivated-label">Not Activated</span>
                              </div>
                          </div>

                          <div class="grid-cell number-cell"><span name="attr_tactics_displayname"></span><span name="attr_tactics_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_tactics_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_tactics_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_tactics">Roll</button></div>
                      </div>
                      <span class="small-hint">Activating a skill costs 12 skill points.</span>
                  </div>
              </div>
              <!-- Nautical Skill Group -->
              <div class="skill-section-collapsible">
                  <input type="checkbox" class="skill-toggle" id="toggle_nautical" name="attr_toggle_nautical" value="1" checked hidden />
                  <label class="skill-toggle-label" for="toggle_nautical">Nautical Skill Group Training = <span name="attr_nautical_string"></span></label>
                  <div class="skill-group-content">
                      <div class="sheet-spendblock">
                          <input type="hidden" name="attr_spend_mode" value="0" />
                          <div class="spend-mode">
                              <button type="action" name="act_add_nautical" class="commit-spend-mode">Train (<span name="attr_nautical_cost"></span> skill points)</button>
                              <button type="action" name="act_refund_nautical" class="commit-spend-mode">Refund (<span name="attr_nautical_refund"></span> skill points)</button>
                              <div class="commit-spend-mode">
                                  Skill Points Left: <span name="attr_skill_points"></span>
                              </div>
                          </div>
                          <div class="spacer-sm"></div>
                      </div>
                      <div class="sheet-grid-table four-col">
                          <div class="grid-header">Skill</div>
                          <div class="grid-header">Attr Code</div>
                          <div class="grid-header">Dice Code</div>
                          <div class="grid-header">Roll</div>
                          <div class="grid-cell number-cell"><span name="attr_diving_displayname"></span><span name="attr_diving_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_diving_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_diving_string"></span></div>
                          <div class="grid-cell">
                              <input type="hidden" name="attr_diving_active" value="2" />
                              <div class="skill-roll-buttons">
                                  <button type="action" name="act_activate_diving" class="activate-skill-button" title="Activation costs 12 skill points.">Activate</button>
                                  <button type="action" name="act_undo_activate_diving" class="undo-activate-skill-button">Undo</button>
                                  <button type="action" name="act_diving" class="roll-skill-button">Roll</button>
                                  <span class="unactivated-label">Not Activated</span>
                              </div>
                          </div>
                          <div class="grid-cell number-cell"><span name="attr_drive_boat_displayname"></span><span name="attr_drive_boat_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_drive_boat_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_drive_boat_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_drive_boat">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_fishing_displayname"></span><span name="attr_fishing_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_fishing_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_fishing_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_fishing">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_sailing_displayname"></span><span name="attr_sailing_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_sailing_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_sailing_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_sailing">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_sea_navigation_displayname"></span><span name="attr_sea_navigation_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_sea_navigation_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_sea_navigation_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_sea_navigation">Roll</button></div>
                      </div>
                      <span class="small-hint">Activating a skill costs 12 skill points.</span>
                  </div>
              </div>
              <!-- Performance Skill Group -->
              <div class="skill-section-collapsible">
                  <input type="checkbox" class="skill-toggle" id="toggle_performance" name="attr_toggle_performance" value="1" checked hidden />
                  <label class="skill-toggle-label" for="toggle_performance">Performance Skill Group Training = <span name="attr_performance_string"></span></label>
                  <div class="skill-group-content">
                      <div class="sheet-spendblock">
                          <input type="hidden" name="attr_spend_mode" value="0" />
                          <div class="spend-mode">
                              <button type="action" name="act_add_performance" class="commit-spend-mode">Train (<span name="attr_performance_cost"></span> skill points)</button>
                              <button type="action" name="act_refund_performance" class="commit-spend-mode">Refund (<span name="attr_performance_refund"></span> skill points)</button>
                              <div class="commit-spend-mode">
                                  Skill Points Left: <span name="attr_skill_points"></span>
                              </div>
                          </div>
                          <div class="spacer-sm"></div>
                      </div>
                      <div class="sheet-grid-table four-col">
                          <div class="grid-header">Skill</div>
                          <div class="grid-header">Attr Code</div>
                          <div class="grid-header">Dice Code</div>
                          <div class="grid-header">Roll</div>
                          <div class="grid-cell number-cell"><span name="attr_acting_displayname"></span><span name="attr_acting_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_acting_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_acting_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_acting">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_art_displayname"></span><span name="attr_art_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_art_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_art_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_art">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_comedy_displayname"></span><span name="attr_comedy_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_comedy_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_comedy_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_comedy">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_dance_displayname"></span><span name="attr_dance_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_dance_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_dance_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_dance">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_disguise_displayname"></span><span name="attr_disguise_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_disguise_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_disguise_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_disguise">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_gambling_displayname"></span><span name="attr_gambling_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_gambling_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_gambling_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_gambling">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_play_instrument_displayname"></span><span name="attr_play_instrument_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_play_instrument_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_play_instrument_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_play_instrument">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_showmanship_displayname"></span><span name="attr_showmanship_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_showmanship_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_showmanship_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_showmanship">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_sing_displayname"></span><span name="attr_sing_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_sing_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_sing_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_sing">Roll</button></div>
                      </div>
                  </div>
              </div>
              <!-- Physical Skill Group -->
              <div class="skill-section-collapsible">
                  <input type="checkbox" class="skill-toggle" id="toggle_physical" name="attr_toggle_physical" value="1" checked hidden />
                  <label class="skill-toggle-label" for="toggle_physical">Physical Skill Group Training = <span name="attr_physical_string"></span></label>
                  <div class="skill-group-content">
                      <div class="sheet-spendblock">
                          <input type="hidden" name="attr_spend_mode" value="0" />
                          <div class="spend-mode">
                              <button type="action" name="act_add_physical" class="commit-spend-mode">Train (<span name="attr_physical_cost"></span> skill points)</button>
                              <button type="action" name="act_refund_physical" class="commit-spend-mode">Refund (<span name="attr_physical_refund"></span> skill points)</button>
                              <div class="commit-spend-mode">
                                  Skill Points Left: <span name="attr_skill_points"></span>
                              </div>
                              <div class="spacer-sm"></div>
                          </div>
                          <div class="sheet-grid-table four-col">
                              <div class="grid-header">Skill</div>
                              <div class="grid-header">Attr Code</div>
                              <div class="grid-header">Dice Code</div>
                              <div class="grid-header">Roll</div>
                              <div class="grid-cell number-cell"><span name="attr_acrobatics_displayname"></span><span name="attr_acrobatics_specialized"></span></div>
                              <div class="grid-cell number-cell"><span name="attr_acrobatics_attributes"></span></div>
                              <div class="grid-cell number-cell"><span name="attr_acrobatics_string"></span></div>
                              <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_acrobatics">Roll</button></div>
                              <div class="grid-cell number-cell"><span name="attr_athletics_displayname"></span><span name="attr_athletics_specialized"></span></div>
                              <div class="grid-cell number-cell"><span name="attr_athletics_attributes"></span></div>
                              <div class="grid-cell number-cell"><span name="attr_athletics_string"></span></div>
                              <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_athletics">Roll</button></div>
                              <div class="grid-cell number-cell"><span name="attr_climbing_displayname"></span><span name="attr_climbing_specialized"></span></div>
                              <div class="grid-cell number-cell"><span name="attr_climbing_attributes"></span></div>
                              <div class="grid-cell number-cell"><span name="attr_climbing_string"></span></div>
                              <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_climbing">Roll</button></div>
                              <div class="grid-cell number-cell"><span name="attr_jumping_displayname"></span><span name="attr_jumping_specialized"></span></div>
                              <div class="grid-cell number-cell"><span name="attr_jumping_attributes"></span></div>
                              <div class="grid-cell number-cell"><span name="attr_jumping_string"></span></div>
                              <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_jumping">Roll</button></div>
                              <div class="grid-cell number-cell"><span name="attr_lifting_displayname"></span><span name="attr_lifting_specialized"></span></div>
                              <div class="grid-cell number-cell"><span name="attr_lifting_attributes"></span></div>
                              <div class="grid-cell number-cell"><span name="attr_lifting_string"></span></div>
                              <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_lifting">Roll</button></div>
                              <div class="grid-cell number-cell"><span name="attr_swimming_displayname"></span><span name="attr_swimming_specialized"></span></div>
                              <div class="grid-cell number-cell"><span name="attr_swimming_attributes"></span></div>
                              <div class="grid-cell number-cell"><span name="attr_swimming_string"></span></div>
                              <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_swimming">Roll</button></div>
                          </div>
                      </div>
                  </div>
              </div>
              <!-- Social Skill Group -->
              <div class="skill-section-collapsible">
                  <input type="checkbox" class="skill-toggle" id="toggle_social" name="attr_toggle_social" value="1" checked hidden />
                  <label class="skill-toggle-label" for="toggle_social">Social Skill Group Training = <span name="attr_social_string"></span></label>
                  <div class="skill-group-content">
                      <div class="sheet-spendblock">
                          <input type="hidden" name="attr_spend_mode" value="0" />
                          <div class="spend-mode">
                              <button type="action" name="act_add_social" class="commit-spend-mode">Train (<span name="attr_social_cost"></span> skill points)</button>
                              <button type="action" name="act_refund_social" class="commit-spend-mode">Refund (<span name="attr_social_refund"></span> skill points)</button>
                              <div class="commit-spend-mode">
                                  Skill Points Left: <span name="attr_skill_points"></span>
                              </div>
                          </div>
                          <div class="spacer-sm"></div>
                      </div>
                      <div class="sheet-grid-table four-col">
                          <div class="grid-header">Skill</div>
                          <div class="grid-header">Attr Code</div>
                          <div class="grid-header">Dice Code</div>
                          <div class="grid-header">Roll</div>
                          <div class="grid-cell number-cell"><span name="attr_bureaucracy_displayname"></span><span name="attr_bureaucracy_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_bureaucracy_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_bureaucracy_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_bureaucracy">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_deceive_displayname"></span><span name="attr_deceive_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_deceive_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_deceive_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_deceive">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_etiquette_displayname"></span><span name="attr_etiquette_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_etiquette_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_etiquette_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_etiquette">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_intimidate_displayname"></span><span name="attr_intimidate_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_intimidate_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_intimidate_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_intimidate">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_negotiate_displayname"></span><span name="attr_negotiate_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_negotiate_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_negotiate_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_negotiate">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_persuade_displayname"></span><span name="attr_persuade_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_persuade_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_persuade_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_persuade">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_seduce_displayname"></span><span name="attr_seduce_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_seduce_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_seduce_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_seduce">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_streetwise_displayname"></span><span name="attr_streetwise_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_streetwise_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_streetwise_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_streetwise">Roll</button></div>
                      </div>
                  </div>
              </div>
              <!-- Stealth Skill Group -->
              <div class="skill-section-collapsible">
                  <input type="checkbox" class="skill-toggle" id="toggle_stealth" name="attr_toggle_stealth" value="1" checked hidden />
                  <label class="skill-toggle-label" for="toggle_stealth">Stealth Skill Group Training = <span name="attr_stealth_string"></span></label>
                  <div class="skill-group-content">
                      <div class="sheet-spendblock">
                          <input type="hidden" name="attr_spend_mode" value="0" />
                          <div class="spend-mode">
                              <button type="action" name="act_add_stealth" class="commit-spend-mode">Train (<span name="attr_stealth_cost"></span> skill points)</button>
                              <button type="action" name="act_refund_stealth" class="commit-spend-mode">Refund (<span name="attr_stealth_refund"></span> skill points)</button>
                              <div class="commit-spend-mode">
                                  Skill Points Left: <span name="attr_skill_points"></span>
                              </div>
                          </div>
                          <div class="spacer-sm"></div>
                      </div>
                      <div class="sheet-grid-table four-col">
                          <div class="grid-header">Skill</div>
                          <div class="grid-header">Attr Code</div>
                          <div class="grid-header">Dice Code</div>
                          <div class="grid-header">Roll</div>
                          <div class="grid-cell number-cell"><span name="attr_hide_displayname"></span><span name="attr_hide_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_hide_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_hide_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_hide">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_sneak_displayname"></span><span name="attr_sneak_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_sneak_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_sneak_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_sneak">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_subtle_displayname"></span><span name="attr_subtle_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_subtle_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_subtle_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_subtle">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_surveillance_displayname"></span><span name="attr_surveillance_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_surveillance_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_surveillance_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_surveillance">Roll</button></div>
                      </div>
                  </div>
              </div>
              <!-- Survival Skill Group -->
              <div class="skill-section-collapsible">
                  <input type="checkbox" class="skill-toggle" id="toggle_survival" name="attr_toggle_survival" value="1" checked hidden />
                  <label class="skill-toggle-label" for="toggle_survival">Survival Skill Group Training = <span name="attr_survival_string"></span></label>
                  <div class="skill-group-content">
                      <div class="sheet-spendblock">
                          <input type="hidden" name="attr_spend_mode" value="0" />
                          <div class="spend-mode">
                              <button type="action" name="act_add_survival" class="commit-spend-mode">Train (<span name="attr_survival_cost"></span> skill points)</button>
                              <button type="action" name="act_refund_survival" class="commit-spend-mode">Refund (<span name="attr_survival_refund"></span> skill points)</button>
                              <div class="commit-spend-mode">
                                  Skill Points Left: <span name="attr_skill_points"></span>
                              </div>
                          </div>
                          <div class="spacer-sm"></div>
                      </div>
                      <div class="sheet-grid-table four-col">
                          <div class="grid-header">Skill</div>
                          <div class="grid-header">Attr Code</div>
                          <div class="grid-header">Dice Code</div>
                          <div class="grid-header">Roll</div>
                          <div class="grid-cell number-cell"><span name="attr_cooking_displayname"></span><span name="attr_cooking_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_cooking_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_cooking_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_cooking">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_foraging_displayname"></span><span name="attr_foraging_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_foraging_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_foraging_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_foraging">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_hunting_displayname"></span><span name="attr_hunting_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_hunting_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_hunting_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_hunting">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_scavenging_displayname"></span><span name="attr_scavenging_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_scavenging_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_scavenging_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_scavenging">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_tracking_displayname"></span><span name="attr_tracking_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_tracking_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_tracking_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_tracking">Roll</button></div>
                      </div>
                  </div>
              </div>
              <!-- Technical Skill Group -->
              <div class="skill-section-collapsible">
                  <input type="checkbox" class="skill-toggle" id="toggle_technical" name="attr_toggle_technical" value="1" checked hidden />
                  <label class="skill-toggle-label" for="toggle_technical">Technical Skill Group Training = <span name="attr_technical_string"></span></label>
                  <div class="skill-group-content">
                      <div class="sheet-spendblock">
                          <input type="hidden" name="attr_spend_mode" value="0" />
                          <div class="spend-mode">
                              <button type="action" name="act_add_technical" class="commit-spend-mode">Train (<span name="attr_technical_cost"></span> skill points)</button>
                              <button type="action" name="act_refund_technical" class="commit-spend-mode">Refund (<span name="attr_technical_refund"></span> skill points)</button>
                              <div class="commit-spend-mode">
                                  Skill Points Left: <span name="attr_skill_points"></span>
                              </div>
                          </div>
                          <div class="spacer-sm"></div>
                      </div>
                      <div class="sheet-grid-table four-col">
                          <div class="grid-header">Skill</div>
                          <div class="grid-header">Attr Code</div>
                          <div class="grid-header">Dice Code</div>
                          <div class="grid-header">Roll</div>

                          <div class="grid-cell number-cell"><span name="attr_build_displayname"></span><span name="attr_build_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_build_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_build_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_build">Roll</button></div>

                          <div class="grid-cell number-cell"><span name="attr_carpentry_displayname"></span><span name="attr_carpentry_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_carpentry_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_carpentry_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_carpentry">Roll</button></div>

                          <div class="grid-cell number-cell"><span name="attr_electronics_displayname"></span><span name="attr_electronics_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_electronics_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_electronics_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_electronics">Roll</button></div>

                          <div class="grid-cell number-cell"><span name="attr_explosives_displayname"></span><span name="attr_explosives_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_explosives_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_explosives_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_explosives">Roll</button></div>

                          <div class="grid-cell number-cell"><span name="attr_gunsmithing_displayname"></span><span name="attr_gunsmithing_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_gunsmithing_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_gunsmithing_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_gunsmithing">Roll</button></div>

                          <div class="grid-cell number-cell"><span name="attr_jury_rig_displayname"></span><span name="attr_jury_rig_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_jury_rig_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_jury_rig_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_jury_rig">Roll</button></div>

                          <div class="grid-cell number-cell"><span name="attr_mechanical_displayname"></span><span name="attr_mechanical_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_mechanical_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_mechanical_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_mechanical">Roll</button></div>

                          <div class="grid-cell number-cell"><span name="attr_repair_displayname"></span><span name="attr_repair_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_repair_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_repair_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_repair">Roll</button></div>

                          <div class="grid-cell number-cell"><span name="attr_welding_displayname"></span><span name="attr_welding_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_welding_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_welding_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_welding">Roll</button></div>
                      </div>
                  </div>
              </div>
              <!-- Thievery Skill Group -->
              <div class="skill-section-collapsible">
                  <input type="checkbox" class="skill-toggle" id="toggle_thievery" name="attr_toggle_thievery" value="1" checked hidden />
                  <label class="skill-toggle-label" for="toggle_thievery">Thievery Skill Group Training = <span name="attr_thievery_string"></span></label>
                  <div class="skill-group-content">
                      <div class="sheet-spendblock">
                          <input type="hidden" name="attr_spend_mode" value="0" />
                          <div class="spend-mode">
                              <button type="action" name="act_add_thievery" class="commit-spend-mode">Train (<span name="attr_thievery_cost"></span> skill points)</button>
                              <button type="action" name="act_refund_thievery" class="commit-spend-mode">Refund (<span name="attr_thievery_refund"></span> skill points)</button>
                              <div class="commit-spend-mode">
                                  Skill Points Left: <span name="attr_skill_points"></span>
                              </div>
                          </div>
                          <div class="spacer-sm"></div>
                      </div>
                      <div class="sheet-grid-table four-col">
                          <div class="grid-header">Skill</div>
                          <div class="grid-header">Attr Code</div>
                          <div class="grid-header">Dice Code</div>
                          <div class="grid-header">Roll</div>
                          <div class="grid-cell number-cell"><span name="attr_cheating_displayname"></span><span name="attr_cheating_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_cheating_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_cheating_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_cheating">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_forgery_displayname"></span><span name="attr_forgery_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_forgery_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_forgery_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_forgery">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_lockpicking_displayname"></span><span name="attr_lockpicking_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_lockpicking_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_lockpicking_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_lockpicking">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_sleight_of_hand_displayname"></span><span name="attr_sleight_of_hand_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_sleight_of_hand_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_sleight_of_hand_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_sleight_of_hand">Roll</button></div>
                      </div>
                  </div>
              </div>
              <h3>Combat Skills</h3>
              <div class="spacer-md"></div>
              <!-- Armed Skill Group -->
              <div class="skill-section-collapsible">
                  <input type="checkbox" class="skill-toggle" id="toggle_armed" name="attr_toggle_armed" value="1" checked hidden />
                  <label class="skill-toggle-label" for="toggle_armed">Armed Skill Group Training = <span name="attr_armed_string"></span></label>
                  <div class="skill-group-content">
                      <div class="sheet-spendblock">
                          <input type="hidden" name="attr_spend_mode" value="0" />
                          <div class="spend-mode">
                              <button type="action" name="act_add_armed" class="commit-spend-mode">Train (<span name="attr_armed_cost"></span> skill points)</button>
                              <button type="action" name="act_refund_armed" class="commit-spend-mode">Refund (<span name="attr_armed_refund"></span> skill points)</button>
                              <div class="commit-spend-mode">
                                  Skill Points Left: <span name="attr_skill_points"></span>
                              </div>
                          </div>
                          <div class="spacer-sm"></div>
                      </div>
                      <div class="sheet-grid-table four-col">
                          <div class="grid-header">Skill</div>
                          <div class="grid-header">Attr Code</div>
                          <div class="grid-header">Dice Code</div>
                          <div class="grid-header">Roll</div>
                          <div class="grid-cell number-cell"><span name="attr_electroshock_displayname"></span><span name="attr_electroshock_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_electroshock_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_electroshock_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_electroshock">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_improvised_weapon_displayname"></span><span name="attr_improvised_weapon_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_improvised_weapon_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_improvised_weapon_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_improvised_weapon">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_melee_weapon_displayname"></span><span name="attr_melee_weapon_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_melee_weapon_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_melee_weapon_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_melee_weapon">Roll</button></div>
                      </div>
                  </div>
              </div>
              <!-- Longarms Skill Group -->
              <div class="skill-section-collapsible">
                  <input type="checkbox" class="skill-toggle" id="toggle_longarms" name="attr_toggle_longarms" value="1" checked hidden />
                  <label class="skill-toggle-label" for="toggle_longarms">Longarms Skill Group Training = <span name="attr_longarms_string"></span></label>
                  <div class="skill-group-content">
                      <div class="sheet-spendblock">
                          <input type="hidden" name="attr_spend_mode" value="0" />
                          <div class="spend-mode">
                              <button type="action" name="act_add_longarms" class="commit-spend-mode">Train (<span name="attr_longarms_cost"></span> skill points)</button>
                              <button type="action" name="act_refund_longarms" class="commit-spend-mode">Refund (<span name="attr_longarms_refund"></span> skill points)</button>
                              <div class="commit-spend-mode">
                                  Skill Points Left: <span name="attr_skill_points"></span>
                              </div>
                          </div>
                          <div class="spacer-sm"></div>
                      </div>
                      <div class="sheet-grid-table four-col">
                          <div class="grid-header">Skill</div>
                          <div class="grid-header">Attr Code</div>
                          <div class="grid-header">Dice Code</div>
                          <div class="grid-header">Roll</div>
                          <div class="grid-cell number-cell"><span name="attr_automatic_rifle_displayname"></span><span name="attr_automatic_rifle_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_automatic_rifle_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_automatic_rifle_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_automatic_rifle">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_rifle_displayname"></span><span name="attr_rifle_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_rifle_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_rifle_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_rifle">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_shotgun_displayname"></span><span name="attr_shotgun_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_shotgun_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_shotgun_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_shotgun">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_sniper_rifle_displayname"></span><span name="attr_sniper_rifle_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_sniper_rifle_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_sniper_rifle_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_sniper_rifle">Roll</button></div>
                      </div>
                  </div>
              </div>
              <!-- Ranged Skill Group -->
              <div class="skill-section-collapsible">
                  <input type="checkbox" class="skill-toggle" id="toggle_ranged" name="attr_toggle_ranged" value="1" checked hidden />
                  <label class="skill-toggle-label" for="toggle_ranged">Ranged Skill Group Training = <span name="attr_ranged_string"></span></label>
                  <div class="skill-group-content">
                      <div class="sheet-spendblock">
                          <input type="hidden" name="attr_spend_mode" value="0" />
                          <div class="spend-mode">
                              <button type="action" name="act_add_range" class="commit-spend-mode">Train (<span name="attr_ranged_cost"></span> skill points)</button>
                              <button type="action" name="act_refund_ranged" class="commit-spend-mode">Refund (<span name="attr_ranged_refund"></span> skill points)</button>
                              <div class="commit-spend-mode">
                                  Skill Points Left: <span name="attr_skill_points"></span>
                              </div>
                          </div>
                          <div class="spacer-sm"></div>
                      </div>
                      <div class="sheet-grid-table four-col">
                          <div class="grid-header">Skill</div>
                          <div class="grid-header">Attr Code</div>
                          <div class="grid-header">Dice Code</div>
                          <div class="grid-header">Roll</div>
                          <div class="grid-cell number-cell"><span name="attr_bow_displayname"></span><span name="attr_bow_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_bow_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_bow_string"></span></div>
                          <div class="grid-cell">
                              <input type="hidden" name="attr_bow_active" value="2" />
                              <div class="skill-roll-buttons">
                                  <button type="action" name="act_activate_bow" class="activate-skill-button" title="Activation costs 12 skill points.">Activate</button>
                                  <button type="action" name="act_undo_activate_bow" class="undo-activate-skill-button">Undo</button>
                                  <button type="action" name="act_bow" class="roll-skill-button">Roll</button>
                                  <span class="unactivated-label">Not Activated</span>
                              </div>
                          </div>
                          <div class="grid-cell number-cell"><span name="attr_crossbow_displayname"></span><span name="attr_crossbow_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_crossbow_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_crossbow_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_crossbow">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_slingshot_displayname"></span><span name="attr_slingshot_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_slingshot_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_slingshot_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_slingshot">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_thrown_displayname"></span><span name="attr_thrown_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_thrown_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_thrown_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_thrown">Roll</button></div>
                      </div>
                      <span class="small-hint">Activating a skill costs 12 skill points.</span>
                  </div>
              </div>
              <!-- Sidearms Skill Group -->
              <div class="skill-section-collapsible">
                  <input type="checkbox" class="skill-toggle" id="toggle_sidearms" name="attr_toggle_sidearms" value="1" checked hidden />
                  <label class="skill-toggle-label" for="toggle_sidearms">Sidearms Skill Group Training = <span name="attr_sidearms_string"></span></label>
                  <div class="skill-group-content">
                      <div class="sheet-spendblock">
                          <input type="hidden" name="attr_spend_mode" value="0" />
                          <div class="spend-mode">
                              <button type="action" name="act_add_sidearms" class="commit-spend-mode">Train (<span name="attr_sidearms_cost"></span> skill points)</button>
                              <button type="action" name="act_refund_sidearms" class="commit-spend-mode">Refund (<span name="attr_sidearms_refund"></span> skill points)</button>
                              <div class="commit-spend-mode">
                                  Skill Points Left: <span name="attr_skill_points"></span>
                              </div>
                          </div>
                          <div class="spacer-sm"></div>
                      </div>
                      <div class="sheet-grid-table four-col">
                          <div class="grid-header">Skill</div>
                          <div class="grid-header">Attr Code</div>
                          <div class="grid-header">Dice Code</div>
                          <div class="grid-header">Roll</div>
                          <div class="grid-cell number-cell"><span name="attr_automatic_handgun_displayname"></span><span name="attr_automatic_handgun_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_automatic_handgun_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_automatic_handgun_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_automatic_handgun">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_handgun_displayname"></span><span name="attr_handgun_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_handgun_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_handgun_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_handgun">Roll</button></div>
                          <div class="grid-cell number-cell"><span name="attr_sawed_off_shotgun_displayname"></span><span name="attr_sawed_off_shotgun_specialized"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_sawed_off_shotgun_attributes"></span></div>
                          <div class="grid-cell number-cell"><span name="attr_sawed_off_shotgun_string"></span></div>
                          <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_sawed_off_shotgun">Roll</button></div>
                      </div>
                  </div>
              </div>
              <!-- Unarmed Skill Group -->
              <div class="skill-section-collapsible">
                <input type="checkbox" class="skill-toggle" id="toggle_unarmed" name="attr_toggle_unarmed" value="1" checked hidden />
                <label class="skill-toggle-label" for="toggle_unarmed">Unarmed Skill Group Training = <span name="attr_unarmed_string"></span></label>
                <div class="skill-group-content">
                  <div class="sheet-spendblock">
                    <input type="hidden" name="attr_spend_mode" value="0" />
                    <div class="spend-mode">
                      <button type="action" name="act_add_unarmed" class="commit-spend-mode">Train (<span name="attr_unarmed_cost"></span> skill points)</button>
                      <button type="action" name="act_refund_unarmed" class="commit-spend-mode">Refund (<span name="attr_unarmed_refund"></span> skill points)</button>
                      <div class="commit-spend-mode">
                        Skill Points Left: <span name="attr_skill_points"></span>
                      </div>
                    </div>
                    <div class="spacer-sm"></div>
                  </div>

                  <div class="sheet-grid-table four-col">
                    <div class="grid-header">Skill</div>
                    <div class="grid-header">Attr Code</div>
                    <div class="grid-header">Dice Code</div>
                    <div class="grid-header">Roll</div>

                    <!-- Brawling -->
                    <div class="grid-cell"><span name="attr_brawling_displayname"></span><span name="attr_brawling_specialized"></span></div>
                    <div class="grid-cell"><span name="attr_brawling_attributes"></span></div>
                    <div class="grid-cell"><span name="attr_brawling_string"></span></div>
                    <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_brawling">Roll</button></div>

                    <!-- Push -->
                    <div class="grid-cell"><span name="attr_push_displayname"></span><span name="attr_push_specialized"></span></div>
                    <div class="grid-cell"><span name="attr_push_attributes"></span></div>
                    <div class="grid-cell"><span name="attr_push_string"></span></div>
                    <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_push">Roll</button></div>

                    <!-- Wrestling -->
                    <div class="grid-cell"><span name="attr_wrestling_displayname"></span><span name="attr_wrestling_specialized"></span></div>
                    <div class="grid-cell"><span name="attr_wrestling_attributes"></span></div>
                    <div class="grid-cell"><span name="attr_wrestling_string"></span></div>
                    <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_wrestling">Roll</button></div>

                    <!-- Aikido -->
                    <div class="grid-cell"><span name="attr_aikido_displayname"></span><span name="attr_aikido_specialized"></span></div>
                    <div class="grid-cell"><span name="attr_aikido_attributes"></span></div>
                    <div class="grid-cell"><span name="attr_aikido_string"></span></div>
                    <div class="grid-cell">
                      <input type="hidden" name="attr_aikido_active" value="2" />
                      <div class="skill-roll-buttons">
                        <button type="action" name="act_activate_aikido" class="activate-skill-button">Activate</button>
                        <button type="action" name="act_undo_activate_aikido" class="undo-activate-skill-button">Undo</button>
                        <button type="action" name="act_aikido" class="roll-skill-button">Roll</button>
                        <span class="unactivated-label">Not Activated</span>
                      </div>
                    </div>

                    <!-- Boxing -->
                    <div class="grid-cell"><span name="attr_boxing_displayname"></span><span name="attr_boxing_specialized"></span></div>
                    <div class="grid-cell"><span name="attr_boxing_attributes"></span></div>
                    <div class="grid-cell"><span name="attr_boxing_string"></span></div>
                    <div class="grid-cell">
                      <input type="hidden" name="attr_boxing_active" value="2" />
                      <div class="skill-roll-buttons">
                        <button type="action" name="act_activate_boxing" class="activate-skill-button">Activate</button>
                        <button type="action" name="act_undo_activate_boxing" class="undo-activate-skill-button">Undo</button>
                        <button type="action" name="act_boxing" class="roll-skill-button">Roll</button>
                        <span class="unactivated-label">Not Activated</span>
                      </div>
                    </div>

                    <!-- Capoeira -->
                    <div class="grid-cell"><span name="attr_capoeira_displayname"></span><span name="attr_capoeira_specialized"></span></div>
                    <div class="grid-cell"><span name="attr_capoeira_attributes"></span></div>
                    <div class="grid-cell"><span name="attr_capoeira_string"></span></div>
                    <div class="grid-cell">
                      <input type="hidden" name="attr_capoeira_active" value="2" />
                      <div class="skill-roll-buttons">
                        <button type="action" name="act_activate_capoeira" class="activate-skill-button">Activate</button>
                        <button type="action" name="act_undo_activate_capoeira" class="undo-activate-skill-button">Undo</button>
                        <button type="action" name="act_capoeira" class="roll-skill-button">Roll</button>
                        <span class="unactivated-label">Not Activated</span>
                      </div>
                    </div>

                    <!-- Jeet Kune Do -->
                    <div class="grid-cell"><span name="attr_jeet_kune_do_displayname"></span><span name="attr_jeet_kune_do_specialized"></span></div>
                    <div class="grid-cell"><span name="attr_jeet_kune_do_attributes"></span></div>
                    <div class="grid-cell"><span name="attr_jeet_kune_do_string"></span></div>
                    <div class="grid-cell">
                      <input type="hidden" name="attr_jeet_kune_do_active" value="2" />
                      <div class="skill-roll-buttons">
                        <button type="action" name="act_activate_jeet_kune_do" class="activate-skill-button">Activate</button>
                        <button type="action" name="act_undo_activate_jeet_kune_do" class="undo-activate-skill-button">Undo</button>
                        <button type="action" name="act_jeet_kune_do" class="roll-skill-button">Roll</button>
                        <span class="unactivated-label">Not Activated</span>
                      </div>
                    </div>

                    <!-- Jiu-Jitsu -->
                    <div class="grid-cell"><span name="attr_jiu_jitsu_displayname"></span><span name="attr_jiu_jitsu_specialized"></span></div>
                    <div class="grid-cell"><span name="attr_jiu_jitsu_attributes"></span></div>
                    <div class="grid-cell"><span name="attr_jiu_jitsu_string"></span></div>
                    <div class="grid-cell">
                      <input type="hidden" name="attr_jiu_jitsu_active" value="2" />
                      <div class="skill-roll-buttons">
                        <button type="action" name="act_activate_jiu_jitsu" class="activate-skill-button">Activate</button>
                        <button type="action" name="act_undo_activate_jiu_jitsu" class="undo-activate-skill-button">Undo</button>
                        <button type="action" name="act_jiu_jitsu" class="roll-skill-button">Roll</button>
                        <span class="unactivated-label">Not Activated</span>
                      </div>
                    </div>

                    <!-- Judo -->
                    <div class="grid-cell"><span name="attr_judo_displayname"></span><span name="attr_judo_specialized"></span></div>
                    <div class="grid-cell"><span name="attr_judo_attributes"></span></div>
                    <div class="grid-cell"><span name="attr_judo_string"></span></div>
                    <div class="grid-cell">
                      <input type="hidden" name="attr_judo_active" value="2" />
                      <div class="skill-roll-buttons">
                        <button type="action" name="act_activate_judo" class="activate-skill-button">Activate</button>
                        <button type="action" name="act_undo_activate_judo" class="undo-activate-skill-button">Undo</button>
                        <button type="action" name="act_judo" class="roll-skill-button">Roll</button>
                        <span class="unactivated-label">Not Activated</span>
                      </div>
                    </div>

                    <!-- Karate -->
                    <div class="grid-cell"><span name="attr_karate_displayname"></span><span name="attr_karate_specialized"></span></div>
                    <div class="grid-cell"><span name="attr_karate_attributes"></span></div>
                    <div class="grid-cell"><span name="attr_karate_string"></span></div>
                    <div class="grid-cell">
                      <input type="hidden" name="attr_karate_active" value="2" />
                      <div class="skill-roll-buttons">
                        <button type="action" name="act_activate_karate" class="activate-skill-button">Activate</button>
                        <button type="action" name="act_undo_activate_karate" class="undo-activate-skill-button">Undo</button>
                        <button type="action" name="act_karate" class="roll-skill-button">Roll</button>
                        <span class="unactivated-label">Not Activated</span>
                      </div>
                    </div>

                    <!-- Krav Maga -->
                    <div class="grid-cell"><span name="attr_krav_maga_displayname"></span><span name="attr_krav_maga_specialized"></span></div>
                    <div class="grid-cell"><span name="attr_krav_maga_attributes"></span></div>
                    <div class="grid-cell"><span name="attr_krav_maga_string"></span></div>
                    <div class="grid-cell">
                      <input type="hidden" name="attr_krav_maga_active" value="2" />
                      <div class="skill-roll-buttons">
                        <button type="action" name="act_activate_krav_maga" class="activate-skill-button">Activate</button>
                        <button type="action" name="act_undo_activate_krav_maga" class="undo-activate-skill-button">Undo</button>
                        <button type="action" name="act_krav_maga" class="roll-skill-button">Roll</button>
                        <span class="unactivated-label">Not Activated</span>
                      </div>
                    </div>

                    <!-- Muay Thai -->
                    <div class="grid-cell"><span name="attr_muay_thai_displayname"></span><span name="attr_muay_thai_specialized"></span></div>
                    <div class="grid-cell"><span name="attr_muay_thai_attributes"></span></div>
                    <div class="grid-cell"><span name="attr_muay_thai_string"></span></div>
                    <div class="grid-cell">
                      <input type="hidden" name="attr_muay_thai_active" value="2" />
                      <div class="skill-roll-buttons">
                        <button type="action" name="act_activate_muay_thai" class="activate-skill-button">Activate</button>
                        <button type="action" name="act_undo_activate_muay_thai" class="undo-activate-skill-button">Undo</button>
                        <button type="action" name="act_muay_thai" class="roll-skill-button">Roll</button>
                        <span class="unactivated-label">Not Activated</span>
                      </div>
                    </div>

                    <!-- Sambo -->
                    <div class="grid-cell"><span name="attr_sambo_displayname"></span><span name="attr_sambo_specialized"></span></div>
                    <div class="grid-cell"><span name="attr_sambo_attributes"></span></div>
                    <div class="grid-cell"><span name="attr_sambo_string"></span></div>
                    <div class="grid-cell">
                      <input type="hidden" name="attr_sambo_active" value="2" />
                      <div class="skill-roll-buttons">
                        <button type="action" name="act_activate_sambo" class="activate-skill-button">Activate</button>
                        <button type="action" name="act_undo_activate_sambo" class="undo-activate-skill-button">Undo</button>
                        <button type="action" name="act_sambo" class="roll-skill-button">Roll</button>
                        <span class="unactivated-label">Not Activated</span>
                      </div>
                    </div>

                    <!-- Savate -->
                    <div class="grid-cell"><span name="attr_savate_displayname"></span><span name="attr_savate_specialized"></span></div>
                    <div class="grid-cell"><span name="attr_savate_attributes"></span></div>
                    <div class="grid-cell"><span name="attr_savate_string"></span></div>
                    <div class="grid-cell">
                      <input type="hidden" name="attr_savate_active" value="2" />
                      <div class="skill-roll-buttons">
                        <button type="action" name="act_activate_savate" class="activate-skill-button">Activate</button>
                        <button type="action" name="act_undo_activate_savate" class="undo-activate-skill-button">Undo</button>
                        <button type="action" name="act_savate" class="roll-skill-button">Roll</button>
                        <span class="unactivated-label">Not Activated</span>
                      </div>
                    </div>

                    <!-- Taekwondo -->
                    <div class="grid-cell"><span name="attr_taekwondo_displayname"></span><span name="attr_taekwondo_specialized"></span></div>
                    <div class="grid-cell"><span name="attr_taekwondo_attributes"></span></div>
                    <div class="grid-cell"><span name="attr_taekwondo_string"></span></div>
                    <div class="grid-cell">
                      <input type="hidden" name="attr_taekwondo_active" value="2" />
                      <div class="skill-roll-buttons">
                        <button type="action" name="act_activate_taekwondo" class="activate-skill-button">Activate</button>
                        <button type="action" name="act_undo_activate_taekwondo" class="undo-activate-skill-button">Undo</button>
                        <button type="action" name="act_taekwondo" class="roll-skill-button">Roll</button>
                        <span class="unactivated-label">Not Activated</span>
                      </div>
                    </div>

                  </div>

                  <span class="small-hint">Activating a skill costs 12 skill points.</span>
                </div>
            </div>
          </div>
          <div class="sheet-view-inventory">
            <div class="sheet-controls-row">
                <!-- Left: Expand/Collapse -->
                <div class="sheet-controls-group">
                    <h3>Inventory & Wealth</h3>
                </div>
                <!-- Middle: Skill Points + Spend -->
                <div class="sheet-controls-group">
                    <label class="sheet-d6pp-label">Move:</label>
                    <input type="text" class="sheet-d6pp sheet-small-input" name="attr_current_move" readonly />
                    <label class="sheet-d6pp-label">Run:</label>
                    <input type="text" class="sheet-d6pp sheet-small-input" name="attr_current_run" readonly />
                </div>
                <!-- Right: View Inventory -->
                <div class="sheet-controls-group">
                    <button type="action" class="sheet-d6pp" name="act_view_character">View Character</button>
                </div>
            </div>
            <!-- Start wealth -->
            <div class="sheet-section-collapsible">
                  <input type="checkbox" class="skill-toggle" id="toggle_wealth" name="attr_toggle_wealth" value="1" checked hidden />
                  <label class="skill-toggle-label" for="toggle_wealth">Wealth</label>
                  <div class="skill-group-content">
                    <div class="sheet-controls-row" style="justify-content: space-between;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <label class="sheet-d6pp-label">Wealth Level:</label>
                            <input type="text" class="sheet-d6pp sheet-small-input" name="attr_character_wealth" readonly />
                            <label class="sheet-d6pp-label">Cash:</label>
                            <input type="text" class="sheet-d6pp" name="attr_character_cash" />
                        </div>
                    </div>
                    <div class="sheet-grid-table six-col full-width">
                      <div class="grid-header">Wealth Target Number</div>
                      <div class="grid-header">Money Needed</div>
                      <div class="grid-header">Scale</div>
                      <div class="grid-header">Daily Roll</div>
                      <div class="grid-header">Weekly Roll</div>
                      <div class="grid-header">Monthly Roll</div>

                      <div class="grid-cell target-number-cell">
                        <span name="attr_wealth_target">0</span>
                      </div>
                      <div class="grid-cell">
                        <input type="number" name="attr_money_needed" value="0" min="0" class="sheet-d6pp" />
                      </div>
                      <div class="grid-cell">
                        <select name="attr_money_scale" class="background-select sheet-d6pp-select" id="money_scale">
                          <option value="1">Dollar</option>
                          <option value="1000">Thousand</option>
                          <option value="1000000">Million</option>
                        </select>
                      </div>
                      <div class="grid-cell">
                        <div class="ammo-button-row">
                          <input type="checkbox" name="attr_used_3Dwealth" class="sheet-toggle" />
                          <button type="action" class="sheet-d6pp sheet-wealth-button" name="act_roll3dWealth">3D</button>
                        </div>
                      </div>
                      <div class="grid-cell">
                        <div class="ammo-button-row">
                          <input type="checkbox" name="attr_used_4Dwealth" class="sheet-toggle" />
                          <button type="action" class="sheet-d6pp sheet-wealth-button" name="act_roll4dWealth">4D</button>
                        </div>
                      </div>
                      <div class="grid-cell">
                        <div class="ammo-button-row">
                          <input type="checkbox" name="attr_used_5Dwealth" class="sheet-toggle" />
                          <button type="action" class="sheet-d6pp sheet-wealth-button" name="act_roll5dWealth">5D</button>
                        </div>
                      </div>
                    <div class="spacer-md"></div>
                  </div>
                  <span class="small-hint">A Target Number of 0 means no roll is required.</span>
            </div> <!-- End wealth -->

              <div class="sheet-controls-row" style="justify-content: space-between;">
                  <div class="d6pp-checkbox">
                      <label class="inline-checkbox-label">
                      <input type="checkbox" name="attr_use_encumbrance" checked />
                      Use Encumbrance
                      </label>
                  </div>
              </div>
              <div class="sheet-view-wrapper">
                  <input type="hidden" name="attr_encumbrance_visible" />
                  <div class="sheet-encumbrance-section">
                      <div class="sheet-section-collapsible">
                          <input type="checkbox" class="skill-toggle" id="toggle_details" name="attr_toggle_details" value="1" checked hidden />
                          <label class="skill-toggle-label" for="toggle_details">Encumbrance Table</label>
                          <div class="skill-group-content">
                              <div class="sheet-grid-table seven-col full-width">
                                  <div class="grid-header"></div>
                                  <div class="grid-header">Capacity (lbs)</div>
                                  <div class="grid-header">-5 Move/Run</div>
                                  <div class="grid-header">-10 Move/Run</div>
                                  <div class="grid-header">-15 Move/Run</div>
                                  <div class="grid-header">-20 Move/Run</div>
                                  <div class="grid-header">-25 Move/Run</div>
                                  <div class="grid-cell"><strong>Character</strong></div>
                                  <div class="grid-cell"><input type="text" class="sheet-d6pp sheet-small-input" name="attr_character_capacity" readonly /></div>
                                  <div class="grid-cell"><input type="text" class="sheet-d6pp sheet-small-input" name="attr_character_enc_5" readonly /></div>
                                  <div class="grid-cell"><input type="text" class="sheet-d6pp sheet-small-input" name="attr_character_enc_10" readonly /></div>
                                  <div class="grid-cell"><input type="text" class="sheet-d6pp sheet-small-input" name="attr_character_enc_15" readonly /></div>
                                  <div class="grid-cell"><input type="text" class="sheet-d6pp sheet-small-input" name="attr_character_enc_20" readonly /></div>
                                  <div class="grid-cell"><input type="text" class="sheet-d6pp sheet-small-input" name="attr_character_enc_25" readonly /></div>
                              </div>
                          </div>
                      </div>
                  </div>
              </div>
              <div class="spacer-sm"></div>
              <div class="sheet-character-inventory-grid">
                  <label class="sheet-d6pp-label">Equipped:</label>
                  <input type="text" class="sheet-d6pp sheet-small-input" name="attr_equipped_weight_total" readonly />
              </div>
              <div class="sheet-view-wrapper">
                  <input type="hidden" name="attr_encumbrance_visible" />
                  <div class="sheet-encumbrance-section">
                      <div class="sheet-character-inventory-grid">
                          <label class="sheet-d6pp-label">Effect:</label>
                          <input type="text" class="sheet-d6pp" name="attr_encumbrance_text" readonly />
                      </div>
                  </div>
              </div>
              <fieldset class="repeating_inventory">
                  <div>
                      <div class="inventory-card">
                          <div class="inventory-card-header">
                              <div class="inventory-field">
                                  <input type="text" name="attr_item_name" class="inventory-item-name"  placeholder="Name"/>
                              </div>
                              <div class="inventory-field">
                                  <label class="inventory-labeled-input">Qty:
                                  <input type="number" name="attr_item_qty" class="sheet-d6pp inventory-input qty-input"/>
                                  </label>
                              </div>
                              <div class="inventory-field">
                                  <label class="inventory-labeled-input">Wt:
                                  <input type="number" step="0.1" name="attr_item_weight" class="sheet-d6pp inventory-input weight-input"/>
                                  </label>
                              </div>
                              <div class="inventory-field">
                                  <select name="attr_item_location" class="inventory-item-location">
                                      <option value="equipped">Equipped</option>
                                      <option value="storage">Storage</option>
                                  </select>
                              </div>
                          </div>
                          <div class="inventory-card-description">
                              <textarea name="attr_item_description" placeholder="Description..."></textarea>
                          </div>
                      </div>
                  </div>
              </fieldset>
              <!-- Drop Zone -->
              <div class="compendium-drop-target" style="opacity:0; height:1px; overflow:hidden; position:absolute;">
                  <p><strong>Drop an item here</strong></p>
                  <input type="text" name="attr_itemdrop_name" accept="item_name" placeholder="Name (hidden)" style="display:none;">
                  <input type="number" name="attr_itemdrop_qty" accept="item_qty" style="display:none;">
                  <input type="number" name="attr_itemdrop_weight" accept="item_weight" style="display:none;">
                  <input type="text" name="attr_itemdrop_location" accept="item_location" placeholder="Location" style="display:none;">
                  <textarea name="attr_itemdrop_description" accept="item_description" style="display:none;"></textarea>
              </div>
              <!-- Control Buttons OUTSIDE the fieldset -->
              <div class="repcontrol" data-groupname="repeating_inventory"></div>
          </div>
      </div>
      </div>
  </div>
  <!-- End PC/Major NPC Sheet -->

  <!-- Monster Character Sheet -->
  <div class="sheet-step sheet-step-monster sheet-mode-monster compendium-drop-target monsters">
    <input accept="character_type" type="hidden" name="attr_character_type" />
    <input accept="character_description" type="hidden" name="attr_character_description" />
    <input accept="monster_type" type="hidden" name="attr_monster_type" />
    <input accept="base_move" type="hidden" name="attr_base_move"/>
    <input accept="base_run" type="hidden" name="attr_base_run" />

    <input accept="strength" type="hidden" name="attr_strength" />
    <input accept="agility" type="hidden" name="attr_agility" />
    <input accept="health" type="hidden" name="attr__health" />
    <input accept="perception" type="hidden" name="attr_perception" />
    <input accept="quickness" type="hidden" name="attr_quickness" />
    <input accept="willpower" type="hidden" name="attr_willpower" />
    <input accept="intelligence" type="hidden" name="attr_intelligence" />
    <input accept="manualdex" type="hidden" name="attr_manualdex" />
    <input accept="charisma" type="hidden" name="attr_charisma" />

    <input accept="skill_1_name" type="hidden" name="attr_skill_1_name" />
    <input accept="skill_1_skill" type="hidden" name="attr_skill_1_skill" />

    <input accept="melee_attack_1_name" type="hidden" name="attr_melee_attack_1_name" />
    <input accept="melee_attack_1_skill" type="hidden" name="attr_melee_attack_1_skill" />
    <input accept="melee_attack_1_damage" type="hidden" name="attr_melee_attack_1_damage" />
    <input accept="melee_attack_1_min_damage" type="hidden" name="attr_melee_attack_1_min_damage" />
    <input accept="melee_attack_1_special" type="hidden" name="attr_melee_attack_1_special" />

    <input accept="melee_attack_2_name" type="hidden" name="attr_melee_attack_2_name" />
    <input accept="melee_attack_2_skill" type="hidden" name="attr_melee_attack_2_skill" />
    <input accept="melee_attack_2_damage" type="hidden" name="attr_melee_attack_2_damage" />
    <input accept="melee_attack_2_min_damage" type="hidden" name="attr_melee_attack_2_min_damage" />
    <input accept="melee_attack_2_special" type="hidden" name="attr_melee_attack_2_special" />

    <input accept="melee_attack_3_name" type="hidden" name="attr_melee_attack_3_name" />
    <input accept="melee_attack_3_skill" type="hidden" name="attr_melee_attack_3_skill" />
    <input accept="melee_attack_3_damage" type="hidden" name="attr_melee_attack_3_damage" />
    <input accept="melee_attack_3_min_damage" type="hidden" name="attr_melee_attack_3_min_damage" />
    <input accept="melee_attack_3_special" type="hidden" name="attr_melee_attack_3_special" />

    <input accept="special_ability_1" type="hidden" name="attr_special_ability_1" />

    <div class="sheet-controls-row" style="justify-content: space-between;">
      <!-- Left: Expand/Collapse -->
      <div>
        <button type="action" class="sheet-d6pp" name="act_expand_all">Expand All</button>
        <button type="action" class="sheet-d6pp" name="act_collapse_all">Collapse All</button>
      </div>
    </div>
    <!-- Monster Details -->
    <div class="sheet-section-collapsible">
      <input type="checkbox" class="skill-toggle" id="toggle_details" name="attr_toggle_details" value="1" checked hidden />
      <label class="skill-toggle-label" for="toggle_details">
        <span>Beast Details</span>
      </label>
      <div class="skill-group-content">
        <div class="sheet-controls-row" style="display: flex; align-items: center; gap: 1rem;">
          <!-- Name (left aligned, fixed) -->
          <div class="sheet-controls-group" style="flex: 0 0 auto; display: flex; align-items: center; gap: 0.25rem;">
            <label class="sheet-d6pp-label">Name:</label>
            <input type="text" class="sheet-d6pp" name="attr_character_name" style="width: 10em;" />
          </div>

          <!-- Type (expand to fill remaining space) -->
          <div class="sheet-controls-group" style="flex: 1; display: flex; align-items: center; gap: 0.25rem;">
            <label class="sheet-d6pp-label">Type:</label>
            <input type="text" class="sheet-d6pp" name="attr_monster_type" readonly style="flex: 1;" />
          </div>
        </div>
        <div class="spacer-sm"></div>
        <label class="sheet-d6pp-label">Description:</label>
        <textarea class="sheet-d6pp textarea-two-lines" name="attr_character_description" readonly></textarea>
        <div class="spacer-sm"></div>
          <!-- GM Whisper + Move/Run/Advantage Row -->
        <div class="sheet-controls-row" style="justify-content: space-between;">
          <div class="d6pp-checkbox">
            <label class="inline-checkbox-label">
              <input type="checkbox" name="attr_whisper_toggle" value="/w gm " />
              Whisper to GM
            </label>
          </div>
          <div style="display: flex; align-items: center; gap: 8px;">
            <label class="sheet-d6pp-label">Move:</label>
            <input type="text" class="sheet-d6pp sheet-small-input" name="attr_current_move" readonly />
            <label class="sheet-d6pp-label">Run:</label>
            <input type="text" class="sheet-d6pp sheet-small-input" name="attr_current_run" readonly />
            <label class="sheet-d6pp-label">Advantage:</label>
            <input type="number" class="sheet-d6pp" name="attr_advantage" />
          </div>
        </div>
      </div>
    </div>

    <!-- Skill Check -->
    <div>
      <input type="hidden" name="attr_skills_active" value="0"/>
      <div class="sheet-section-collapsible section-has-skills">
        <input type="checkbox" class="skill-toggle" id="toggle_skillcheck" name="attr_toggle_skillcheck" value="1" checked hidden />
        <label class="skill-toggle-label" for="toggle_skillcheck">Skill Check</label>
        <div class="skill-group-content">
          <div class="sheet-grid-table five-col full-width">
            <div class="grid-header">Target Number</div>
            <div class="grid-header">Challenge Rating</div>
            <div class="grid-header">Modifier</div>
            <div class="grid-header">Wound Penalty</div>
            <div class="grid-header">Armor Penalty</div>

            <div class="grid-cell target-number-cell"><span name="attr_skill_check_target">0</span></div>
            <div class="grid-cell">
              <select name="attr_skillcheck_cr" class="sheet-d6pp-select">
                <option value="0">Trivial</option>
                <option value="5">Easy (+5)</option>
                <option value="10">Moderate (+10)</option>
                <option value="15">Hard (+15)</option>
                <option value="20">Very Hard (+20)</option>
                <option value="25">Extremely Hard (+25)</option>
              </select>
            </div>
            <div class="grid-cell"><input type="number" name="attr_skillcheck_modifier" class="sheet-d6pp" value="0" /></div>
            <div class="grid-cell number-cell"><span name="attr_skillcheck_wound_penalty">0</span></div>
            <div class="grid-cell number-cell"><span name="attr_armor_penalty">0</span></div>
          </div>
          <div class="spacer-sm"></div>
          <button type="action" name="act_roll_skill_1" class="sheet-d6pp-button"> Roll <span name="attr_skill_1_name"></span></button>
        </div>
      </div>
    </div>

    <!-- Combat -->
    <div class="sheet-section-collapsible">
      <input type="checkbox" class="skill-toggle" id="toggle_combat" name="attr_toggle_combat" value="1" checked hidden />
      <label class="skill-toggle-label" for="toggle_combat">Combat</label>
      <div class="skill-group-content">
        <div class="sheet-grid-table five-col">

          <!-- Headers -->
          <div class="grid-header">Target Number</div>
          <div class="grid-header">Opponent's Dodge</div>
          <div class="grid-header">Opponent's Armor</div>
          <div class="grid-header">Modifier</div>
          <div class="grid-header">Wound Penalty</div>

          <!-- Row values -->
          <div class="grid-cell target-number-cell"><span name="attr_combat_target">0</span></div>
          <div class="grid-cell">
            <input type="number" name="attr_combat_opponent_dodge" class="sheet-d6pp" value="0" min="0" />
          </div>
          <div class="grid-cell">
            <input type="number" name="attr_combat_opponent_armor" class="sheet-d6pp" value="0" min="0" />
          </div>
          <div class="grid-cell"><input type="number" name="attr_combat_modifier" class="sheet-d6pp" value="0" /></div>
          <div class="grid-cell"><span name="attr_skillcheck_wound_penalty">0</span></div>

        </div>

        <div class="spacer-md"></div>
        <!-- Beast Special Text -->

        <input type="hidden" name="attr_num_melee_attack_active" value="0"/>
        <div class="melee-grid-one-row">
          <div class="sheet-grid-attack sheet-grid-melee">
            <!-- Headers -->
            <div class="grid-header">Weapon</div>
            <div class="grid-header">Dice</div>
            <div class="grid-header">Damage</div>

            <!-- First Row -->
            <div class="grid-cell stack-tight target-number-cell">
              <input type="text" name="attr_melee_attack_1_name" style="display:none;" />
              <span name="attr_melee_attack_1_name"></span>
            </div>
            <div class="grid-cell stack-tight">
              <input type="text" name="attr_melee_attack_1_skill" style="display:none;" />
              <span name="attr_melee_attack_1_skill"></span>
              <button type="action" class="sheet-d6pp" name="act_melee_attack_1">Roll</button>
            </div>
            <div class="grid-cell stack-tight">
              <input type="text" name="attr_melee_attack_1_damage" style="display:none;" />
              <span name="attr_melee_attack_1_damage"></span>
              <button type="action" class="sheet-d6pp" name="act_melee_damage_1">Damage</button>
            </div>
          </div>
        </div>

        <div class="melee-grid-two-rows">
          <div class="sheet-grid-attack sheet-grid-melee">
            <!-- Headers -->
            <div class="grid-header">Weapon</div>
            <div class="grid-header">Dice</div>
            <div class="grid-header">Damage</div>

            <!-- First Row -->
            <div class="grid-cell stack-tight target-number-cell">
              <input type="text" name="attr_melee_attack_1_name" style="display:none;" />
              <span name="attr_melee_attack_1_name"></span>
            </div>
            <div class="grid-cell stack-tight">
              <input type="text" name="attr_melee_attack_1_skill" style="display:none;" />
              <span name="attr_melee_attack_1_skill"></span>
              <button type="action" class="sheet-d6pp" name="act_melee_attack_1">Roll</button>
            </div>
            <div class="grid-cell stack-tight">
              <input type="text" name="attr_melee_attack_1_damage" style="display:none;" />
              <span name="attr_melee_attack_1_damage"></span>
              <button type="action" class="sheet-d6pp" name="act_melee_damage_1">Damage</button>
            </div>

            <!-- Second Row -->
            <div class="grid-cell stack-tight target-number-cell">
              <input type="text" name="attr_melee_attack_2_name" style="display:none;" />
              <span name="attr_melee_attack_2_name"></span>
            </div>
            <div class="grid-cell stack-tight">
              <input type="text" name="attr_melee_attack_2_skill" style="display:none;" />
              <span name="attr_melee_attack_2_skill"></span>
              <button type="action" class="sheet-d6pp" name="act_melee_attack_2">Roll</button>
            </div>
            <div class="grid-cell stack-tight">
              <input type="text" name="attr_melee_attack_2_damage" style="display:none;" />
              <span name="attr_melee_attack_2_damage"></span>
              <button type="action" class="sheet-d6pp" name="act_melee_damage_2">Damage</button>
            </div>
          </div>
        </div>

        <div class="melee-grid-three-rows">
          <div class="sheet-grid-attack sheet-grid-melee">
            <!-- Headers -->
            <div class="grid-header">Weapon</div>
            <div class="grid-header">Dice</div>
            <div class="grid-header">Damage</div>

            <!-- First Row -->
            <div class="grid-cell stack-tight target-number-cell">
              <input type="text" name="attr_melee_attack_1_name" style="display:none;" />
              <span name="attr_melee_attack_1_name"></span>
            </div>
            <div class="grid-cell stack-tight">
              <input type="text" name="attr_melee_attack_1_skill" style="display:none;" />
              <span name="attr_melee_attack_1_skill"></span>
              <button type="action" class="sheet-d6pp" name="act_melee_attack_1">Roll</button>
            </div>
            <div class="grid-cell stack-tight">
              <input type="text" name="attr_melee_attack_1_damage" style="display:none;" />
              <span name="attr_melee_attack_1_damage"></span>
              <button type="action" class="sheet-d6pp" name="act_melee_damage_1">Damage</button>
            </div>

            <!-- Second Row -->
            <div class="grid-cell stack-tight target-number-cell">
              <input type="text" name="attr_melee_attack_2_name" style="display:none;" />
              <span name="attr_melee_attack_2_name"></span>
            </div>
            <div class="grid-cell stack-tight">
              <input type="text" name="attr_melee_attack_2_skill" style="display:none;" />
              <span name="attr_melee_attack_2_skill"></span>
              <button type="action" class="sheet-d6pp" name="act_melee_attack_2">Roll</button>
            </div>
            <div class="grid-cell stack-tight">
              <input type="text" name="attr_melee_attack_2_damage" style="display:none;" />
              <span name="attr_melee_attack_2_damage"></span>
              <button type="action" class="sheet-d6pp" name="act_melee_damage_2">Damage</button>
            </div>

            <!-- Third Row -->
            <div class="grid-cell stack-tight target-number-cell">
              <input type="text" name="attr_melee_attack_3_name" style="display:none;" />
              <span name="attr_melee_attack_3_name"></span>
            </div>
            <div class="grid-cell stack-tight">
              <input type="text" name="attr_melee_attack_3_skill" style="display:none;" />
              <span name="attr_melee_attack_3_skill"></span>
              <button type="action" class="sheet-d6pp" name="act_melee_attack_3">Roll</button>
            </div>
            <div class="grid-cell stack-tight">
              <input type="text" name="attr_melee_attack_3_damage" style="display:none;" />
              <span name="attr_melee_attack_3_damage"></span>
              <button type="action" class="sheet-d6pp" name="act_melee_damage_3">Damage</button>
            </div>
          </div>
        </div>

        <div class="spacer-md"></div>
        <input type="hidden" name="attr_special_ability_active" value="0" />
        <div class="section-has-special-ability">
          <label>Special Abilities:</label>
          <span name="attr_special_ability_1"></span>
        </div>

        <div class="spacer-md"></div>
        <div class="sheet-controls-row">
        <!-- Left -->
          <div class="sheet-controls-group">
            <button type="action" class="sheet-d6pp" name="act_initiative">Roll Initiative</button>
            <button type="action" class="sheet-d6pp" name="act_dodge">Roll Dodge</button>
            <button type="action" class="sheet-d6pp" name="act_defend">Roll Defend</button>
            <button type="action" class="sheet-d6pp" name="act_avoid">Roll Avoid</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Wounds -->
    <div class="sheet-section-collapsible">
      <input type="checkbox" class="skill-toggle" id="toggle_wounds" name="attr_toggle_wounds" value="1" checked hidden />
      <label class="skill-toggle-label" for="toggle_wounds">Wounds</label>
      <div class="skill-group-content">
        <div class="sheet-grid-table six-col full-width">
          <div class="grid-header">First Aid Target Number</div>
          <div class="grid-header">Wound Points</div>
          <div class="grid-header">Wounds Ignored</div>
          <div class="grid-header"># First Aid</div>
          <div class="grid-header">Unconscious Threshold</div>
          <div class="grid-header">Death Threshold</div>

          <div class="grid-cell target-number-cell">
            <span name="attr_first_aid_target">0</span>
          </div>
          <div class="grid-cell">
            <input type="number" name="attr_wounds_total" value="0" min="0" class="sheet-d6pp" />
          </div>
          <div class="grid-cell">
            <input type="number" name="attr_wounds_ignored" value="0" min="0" class="sheet-d6pp" />
          </div>
          <div class="grid-cell">
            <input type="number" name="attr_first_aid_count" value="0" min="0" class="sheet-d6pp" />
          </div>
          <div class="grid-cell"><span name="attr_unconscious_threshold"></span></div>
          <div class="grid-cell"><span name="attr_death_threshold"></span></div>
        </div>
        <div class="spacer-md"></div>

        <div class="sheet-controls-row">
          <!-- Left -->
          <div class="sheet-controls-group">
            <button type="action" class="sheet-d6pp" name="act_endure">Roll Endure</button>
          </div>
          <div class="sheet-controls-group">
            <label class="sheet-d6pp-label" style="margin: 0; display: inline;">Status:</label>
            <input type="text" class="sheet-d6pp" name="attr_status" readonly/>
            <div class="d6pp-checkbox">
              <label class="inline-checkbox-label">
                <input type="checkbox" name="attr_revived_toggle" />
                Revived
              </label>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Conditions -->
    <div class="sheet-section-collapsible">
        <input type="checkbox" class="skill-toggle" id="toggle_conditions" name="attr_toggle_conditions" value="1" checked hidden />
        <label class="skill-toggle-label" for="toggle_conditions">Conditions</label>
        <div class="skill-group-content">
          <div class="sheet-condition-grid">
            <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_blind" /> Blind</label>
            <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_dehydrated" /> Dehydrated</label>
            <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_diseased" /> Diseased</label>
            <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_drunk" /> Drunk</label>
            <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_exhausted" /> Exhausted</label>
            <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_frightened" /> Frightened</label>
            <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_grappled" /> Grappled</label>
            <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_hyperthermic" /> Hyperthermic</label>
            <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_hypothermic" /> Hypothermic</label>
            <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_knockout" /> Knockout</label>
            <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_poisoned" /> Poisoned</label>
          </div>
        </div>
    </div>

    <!-- Attributes (not spend mode) -->
    <div class="sheet-section-collapsible">
        <input type="checkbox" class="skill-toggle" id="toggle_attributes" name="attr_toggle_attributes" value="1" checked hidden />
        <label class="skill-toggle-label" for="toggle_attributes">Attributes</label>
        <div class="skill-group-content">
            <div class="sheet-grid-table six-col full-width">
                <!-- Headers -->
                <div class="grid-header"></div>
                <div class="grid-header">Base</div>
                <div class="grid-header">Adjustment</div>
                <div class="grid-header">Conditions</div>
                <div class="grid-header">Actual</div>
                <div class="grid-header">Roll</div>
                <!-- Row: Strength -->
                <div class="grid-cell number-cell">(S)trength</div>
                <div class="grid-cell number-cell"><span name="attr_strength_base_string"></span></div>
                <div class="grid-cell number-cell"><input type="number" name="attr_strength_adjustment" value="0" class="sheet-d6pp" /></div>
                <div class="grid-cell number-cell"><span name="attr_strength_conditions"></span></div>
                <div class="grid-cell number-cell"><span name="attr_strength_string"></span></div>
                <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_strength">Roll</button></div>
                <!-- Row: Agility -->
                <div class="grid-cell number-cell">(A)gility</div>
                <div class="grid-cell number-cell"><span name="attr_agility_base_string"></span></div>
                <div class="grid-cell number-cell"><input type="number" name="attr_agility_adjustment" value="0" class="sheet-d6pp" /></div>
                <div class="grid-cell number-cell"><span name="attr_agility_conditions"></span></div>
                <div class="grid-cell number-cell"><span name="attr_agility_string"></span></div>
                <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_agility">Roll</button></div>
                <!-- Row: Health -->
                <div class="grid-cell number-cell">(H)ealth</div>
                <div class="grid-cell number-cell"><span name="attr_health_base_string"></span></div>
                <div class="grid-cell number-cell"><input type="number" name="attr_health_adjustment" value="0" class="sheet-d6pp" /></div>
                <div class="grid-cell number-cell"><span name="attr_health_conditions"></span></div>
                <div class="grid-cell number-cell"><span name="attr_health_string"></span></div>
                <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_health">Roll</button></div>
                <!-- Row: Perception -->
                <div class="grid-cell number-cell">(P)erception</div>
                <div class="grid-cell number-cell"><span name="attr_perception_base_string"></span></div>
                <div class="grid-cell number-cell"><input type="number" name="attr_perception_adjustment" value="0" class="sheet-d6pp" /></div>
                <div class="grid-cell number-cell"><span name="attr_perception_conditions"></span></div>
                <div class="grid-cell number-cell"><span name="attr_perception_string"></span></div>
                <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_perception">Roll</button></div>
                <!-- Row: Quickness -->
                <div class="grid-cell number-cell">(Q)uickness</div>
                <div class="grid-cell number-cell"><span name="attr_quickness_base_string"></span></div>
                <div class="grid-cell number-cell"><input type="number" name="attr_quickness_adjustment" value="0" class="sheet-d6pp" /></div>
                <div class="grid-cell number-cell"><span name="attr_quickness_conditions"></span></div>
                <div class="grid-cell number-cell"><span name="attr_quickness_string"></span></div>
                <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_quickness">Roll</button></div>
                <!-- Row: Willpower -->
                <div class="grid-cell number-cell">(W)illpower</div>
                <div class="grid-cell number-cell"><span name="attr_willpower_base_string"></span></div>
                <div class="grid-cell number-cell"><input type="number" name="attr_willpower_adjustment" value="0" class="sheet-d6pp" /></div>
                <div class="grid-cell number-cell"><span name="attr_willpower_conditions"></span></div>
                <div class="grid-cell number-cell"><span name="attr_willpower_string"></span></div>
                <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_willpower">Roll</button></div>
                <!-- Row: Intelligence -->
                <div class="grid-cell number-cell">(I)ntelligence</div>
                <div class="grid-cell number-cell"><span name="attr_intelligence_base_string"></span></div>
                <div class="grid-cell number-cell"><input type="number" name="attr_intelligence_adjustment" value="0" class="sheet-d6pp" /></div>
                <div class="grid-cell number-cell"><span name="attr_intelligence_conditions"></span></div>
                <div class="grid-cell number-cell"><span name="attr_intelligence_string"></span></div>
                <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_intelligence">Roll</button></div>
                <!-- Row: Manual Dexterity -->
                <div class="grid-cell number-cell">(M)anual Dex</div>
                <div class="grid-cell number-cell"><span name="attr_manualdex_base_string"></span></div>
                <div class="grid-cell number-cell"><input type="number" name="attr_manualdex_adjustment" value="0" class="sheet-d6pp" /></div>
                <div class="grid-cell number-cell"><span name="attr_manualdex_conditions"></span></div>
                <div class="grid-cell number-cell"><span name="attr_manualdex_string"></span></div>
                <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_manualdex">Roll</button></div>
                <!-- Row: Charisma -->
                <div class="grid-cell number-cell">(C)harisma</div>
                <div class="grid-cell number-cell"><span name="attr_charisma_base_string"></span></div>
                <div class="grid-cell number-cell"><input type="number" name="attr_charisma_adjustment" value="0" class="sheet-d6pp" /></div>
                <div class="grid-cell number-cell"><span name="attr_charisma_conditions"></span></div>
                <div class="grid-cell number-cell"><span name="attr_charisma_string"></span></div>
                <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_charisma">Roll</button></div>
            </div>
        </div>
    </div>

  </div> <!-- Monster Character Sheet -->

  <!-- Vehicle Character Sheet -->
  <div class="sheet-step sheet-step-vehicle sheet-mode-vehicle compendium-drop-target vehicle">
    <input accept="strength" type="hidden" name="attr_strength" />
    <input accept="agility" type="hidden" name="attr_agility" />
    <input accept="health" type="hidden" name="attr__health" />
    <input accept="quickness" type="hidden" name="attr_quickness" />

    <div class="sheet-controls-row" style="justify-content: space-between;">
      <!-- Left: Expand/Collapse -->
      <div>
        <button type="action" class="sheet-d6pp" name="act_expand_all">Expand All</button>
        <button type="action" class="sheet-d6pp" name="act_collapse_all">Collapse All</button>
      </div>
    </div>
    <!-- Vehicle Details -->
    <div class="sheet-section-collapsible">
      <input type="checkbox" class="skill-toggle" id="toggle_details" name="attr_toggle_details" value="1" checked hidden />
      <label class="skill-toggle-label" for="toggle_details">
        <span>Vehicle Details</span>
      </label>
      <div class="skill-group-content">
        <div class="sheet-controls-row" style="display: flex; align-items: center; gap: 1rem;">
          <!-- Name (left aligned, fixed) -->
          <div class="sheet-controls-group" style="flex: 0 0 auto; display: flex; align-items: center; gap: 0.25rem;">
            <label class="sheet-d6pp-label">Name:</label>
            <input type="text" class="sheet-d6pp" name="attr_character_name" style="width: 10em;" />
          </div>

          <!-- Type (expand to fill remaining space) -->
          <div class="sheet-controls-group" style="flex: 1; display: flex; align-items: center; gap: 0.25rem;">
            <label class="sheet-d6pp-label">Type:</label>
            <input type="text" class="sheet-d6pp" name="attr_vehicle_type" readonly style="flex: 1;" />
          </div>
        </div>

        <div class="spacer-sm"></div>
        <label class="sheet-d6pp-label">Description:</label>
        <textarea class="sheet-d6pp textarea-two-lines" name="attr_character_description"></textarea>
        <div class="spacer-sm"></div>
          <!-- GM Whisper + Advantage-->
        <div class="sheet-controls-row" style="justify-content: space-between;">
          <div class="d6pp-checkbox">
            <label class="inline-checkbox-label">
              <input type="checkbox" name="attr_whisper_toggle" value="/w gm " />
              Whisper to GM
            </label>
          </div>
          <div style="display: flex; align-items: center; gap: 8px;">
            <label class="sheet-d6pp-label">Advantage:</label>
            <input type="number" class="sheet-d6pp" name="attr_advantage" />
          </div>
        </div>
      </div>
    </div>

    <!-- ### Actions Tracker -->
    <div class="sheet-section-collapsible">
        <input type="checkbox" class="skill-toggle" id="toggle_actions" name="attr_toggle_actions" value="1" checked hidden />
        <label class="skill-toggle-label" for="toggle_actions">Actions Tracker</label>
        <div class="skill-group-content">
            <!-- Left Column -->
            <div class="sheet-grid-left">
                <input type="hidden" name="attr_actions_locked" value="0"/>
                <div class="sheet-editable-actions">
                    <div class="sheet-controls-row">
                      <!-- Driver's Skill -->
                        <div class="sheet-controls-group" style="flex: 0 0 auto; display: flex; align-items: center; gap: 0.25rem;">
                          <label class="sheet-d6pp-label">(D)river's Skill:</label>
                          <input type="number" class="sheet-d6pp" name="attr_vehicle_drive" style="width: 3em;" />
                          <span class="sheet-d6pp-label">D</span>
                        </div>
                        <div class="d6pp-checkbox">
                          <label class="inline-checkbox-label">
                            <input type="checkbox" name="attr_driver_specialized" />
                            Driver Specialized
                          </label>
                        </div>
                        <div class="sheet-controls-group">
                            <label class="sheet-d6pp-label">Multi-Action Penalty:</label>
                            <input type="text" class="sheet-d6pp sheet-small-input" name="attr_actions_penalty" readonly />
                        </div>
                        <div class="sheet-controls-group">
                            <button type="action" class="sheet-d6pp" name="act_start_turn">Start Turn</button>
                        </div>
                    </div>
                </div>
                <input type="hidden" name="attr_actions_locked" value="0"/>
                <div class="sheet-readonly-actions">
                    <div class="sheet-controls-row">
                        <!-- Driver's Skill -->
                        <div class="sheet-controls-group" style="flex: 0 0 auto; display: flex; align-items: center; gap: 0.25rem;">
                          <label class="sheet-d6pp-label">(D)river's Skill:</label>
                          <input type="number" class="sheet-d6pp" name="attr_vehicle_drive" style="width: 3em;" readonly />
                          <span class="sheet-d6pp-label">D</span>
                        </div>
                        <div class="d6pp-checkbox">
                          <label class="inline-checkbox-label">
                            <input type="checkbox" name="attr_driver_specialized" />
                            Driver Specialized
                          </label>
                        </div>
                        <div class="sheet-controls-group">
                            <label class="sheet-d6pp-label">Multi-Action Penalty:</label>
                            <input type="text" class="sheet-d6pp sheet-small-input" name="attr_actions_penalty" readonly />
                        </div>
                        <div class="sheet-controls-group">
                            <button type="action" class="sheet-d6pp" name="act_end_turn">End Turn</button>
                        </div>
                    </div>
                    <div class="sheet-divider"></div>
                    <div class="spacer-md"></div>
                    <!-- R3C1: Skill Chooser -->
                    <div class="sheet-grid-table three-col full-width">
                        <div class="grid-header">Selected Skill</div>
                        <div class="grid-header">Adjusted Skill Code</div>
                        <div class="grid-header">Roll Button</div>
                        <div class="grid-cell">
                          <select name="attr_selected_skill" class="sheet-d6pp-select">
                            <option value="">None</option>
                            <option value="vehicle_avoid">Avoid (QDD)</option>
                            <option value="vehicle_dodge">Dodge (AAD)</option>
                            <option value="vehicle_impede">Impede (DDD)</option>
                            <option value="vehicle_keep_control">Keep Control (ADD)</option>
                            <option value="vehicle_obstruct">Obstruct (SDD)</option>
                            <option value="vehicle_ram">Ram (AQD)</option>
                            <option value="vehicle_stunt">Stunt (DDD)</option>
                          </select>
                        </div>
                        <div class="grid-cell"><span class="sheet-d6pp-label" name="attr_action_skill"></span></div>
                        <div class="grid-cell">
                            <button type="action" name="act_selected_vehicle_reaction_roll" class="sheet-d6pp">Roll Reaction</button>
                        </div>
                    </div>
                    <div class="spacer-md"></div>
                    <div class="sheet-skill-select-row">
                        <label class="sheet-d6pp-label">Static Reactions: </label>
                        <button type="action" name="act_out_of_turn" class="sheet-d6pp">Out-of-Turn</button>
                        <button type="action" name="act_accelerate" class="sheet-d6pp">Accelerate</button>
                    </div>
                    <div class="spacer-md"></div>
                    <div class="sheet-divider"></div>
                    <div class="spacer-md"></div>
                    <div class="sheet-skill-select-row">
                        <label class="sheet-d6pp-label">Static Actions: </label>
                        <div class="sheet-controls-group">
                          <select name="attr_move_multiplier" class="sheet-d6pp-select">
                            <option value="city">City (10 ft)</option>
                            <option value="highway">Highway (20 ft)</option>
                          </select>
                        </div>
                        <div class="sheet-controls-group">
                          <select name="attr_time_scale" class="sheet-d6pp-select">
                            <option value="3">3 Second Round (Character Rounds)</option>
                            <option value="15">15 Second Round</option>
                            <option value="30">30 Second Round</option>
                          </select>
                        </div>
                        <button type="action" name="act_vehicle_move" class="sheet-d6pp">Move</button>
                    </div>
                    <div class="spacer-md"></div>
                    <div class="sheet-divider"></div>
                    <div class="spacer-md"></div>
                    <div class="sheet-controls-row">
                        <div class="sheet-controls-group">
                            <label class="sheet-d6pp-label">Turn Action Log</label>
                        </div>
                        <div class="sheet-controls-group">
                            <label class="sheet-d6pp-label">Actions Remaining:</label>
                            <input type="text" class="sheet-d6pp sheet-small-input" name="attr_actions_remaining" readonly />
                        </div>
                    </div>
                    <textarea name="attr_action_log" id="attr_action_log" class="sheet-d6pp" rows="13" readonly></textarea>
                </div>
            </div>
        </div>
    </div>

    <!-- Skill Check -->
    <div class="sheet-section-collapsible">
        <input type="checkbox" class="skill-toggle" id="toggle_skillcheck" name="attr_toggle_skillcheck" value="1" checked hidden />
        <label class="skill-toggle-label" for="toggle_skillcheck">Skill Check Target Number</label>
        <div class="skill-group-content">
            <div class="sheet-grid-table five-col full-width">
                <div class="grid-header">Target Number</div>
                <div class="grid-header">Challenge Rating</div>
                <div class="grid-header">Modifier</div>
                <div class="grid-header">Wound Penalty</div>
                <div class="grid-header">Distracted Driving Penalty</div>
                <div class="grid-cell target-number-cell"><span name="attr_skill_check_target">0</span></div>
                <div class="grid-cell">
                    <select name="attr_skillcheck_cr" class="sheet-d6pp-select">
                        <option value="0">Trivial</option>
                        <option value="5">Easy (+5)</option>
                        <option value="10">Moderate (+10)</option>
                        <option value="15">Hard (+15)</option>
                        <option value="20">Very Hard (+20)</option>
                        <option value="25">Extremely Hard (+25)</option>
                    </select>
                </div>
                <div class="grid-cell"><input type="number" name="attr_skillcheck_modifier" class="sheet-d6pp" value="0" /></div>
                <div class="grid-cell number-cell"><span name="attr_skillcheck_wound_penalty">0</span></div>
                <div class="grid-cell number-cell"><span name="attr_skillcheck_mounted_penalty">0</span></div>
            </div>
            <span class="small-hint">Modifier includes situational bonuses.</span>
        </div>
    </div>

    <!-- Wounds -->
    <div class="sheet-section-collapsible">
      <input type="checkbox" class="skill-toggle" id="toggle_wounds" name="attr_toggle_wounds" value="1" checked hidden />
      <label class="skill-toggle-label" for="toggle_wounds">Wounds</label>
      <div class="skill-group-content">
        <div class="sheet-grid-table three-col full-width">
          <div class="grid-header">Wound Points</div>
          <div class="grid-header">Inoperable Threshold</div>
          <div class="grid-header">Totaled Threshold</div>

          <div class="grid-cell">
            <input type="number" name="attr_wounds_total" value="0" min="0" class="sheet-d6pp" />
          </div>
          <div class="grid-cell"><span name="attr_unconscious_threshold"></span></div>
          <div class="grid-cell"><span name="attr_death_threshold"></span></div>
        </div>
        <div class="spacer-md"></div>

        <div class="sheet-controls-row">
          <!-- Left -->
          <div class="sheet-controls-group">
            <button type="action" class="sheet-d6pp" name="act_health">Roll Health</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Conditions -->
    <div class="sheet-section-collapsible">
        <input type="checkbox" class="skill-toggle" id="toggle_conditions" name="attr_toggle_conditions" value="1" checked hidden />
        <label class="skill-toggle-label" for="toggle_conditions">Conditions</label>
        <div class="skill-group-content">
            <div class="sheet-condition-grid">
              <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_mounted" /> Driver Distracted</label>
              <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_flat_tire" /> Flat Tire</label>
              <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_offroad" /> Off-Road</label>
              <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_overheated" /> Overheated</label>
            </div>
        </div>
    </div>

    <!-- Attributes (not spend mode) -->
    <div class="sheet-section-collapsible">
        <input type="checkbox" class="skill-toggle" id="toggle_attributes" name="attr_toggle_attributes" value="1" checked hidden />
        <label class="skill-toggle-label" for="toggle_attributes">Attributes</label>
        <div class="skill-group-content">
            <div class="sheet-grid-table six-col full-width">
                <!-- Headers -->
                <div class="grid-header"></div>
                <div class="grid-header">Base</div>
                <div class="grid-header">Adjustment</div>
                <div class="grid-header">Conditions</div>
                <div class="grid-header">Actual</div>
                <div class="grid-header">Roll</div>
                <!-- Row: Strength -->
                <div class="grid-cell number-cell">(S)trength</div>
                <div class="grid-cell number-cell"><span name="attr_strength_base_string"></span></div>
                <div class="grid-cell number-cell"><input type="number" name="attr_strength_adjustment" value="0" class="sheet-d6pp" /></div>
                <div class="grid-cell number-cell"><span name="attr_strength_conditions"></span></div>
                <div class="grid-cell number-cell"><span name="attr_strength_string"></span></div>
                <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_strength">Roll</button></div>
                <!-- Row: Agility -->
                <div class="grid-cell number-cell">(A)gility</div>
                <div class="grid-cell number-cell"><span name="attr_agility_base_string"></span></div>
                <div class="grid-cell number-cell"><input type="number" name="attr_agility_adjustment" value="0" class="sheet-d6pp" /></div>
                <div class="grid-cell number-cell"><span name="attr_agility_conditions"></span></div>
                <div class="grid-cell number-cell"><span name="attr_agility_string"></span></div>
                <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_agility">Roll</button></div>
                <!-- Row: Health -->
                <div class="grid-cell number-cell">(H)ealth</div>
                <div class="grid-cell number-cell"><span name="attr_health_base_string"></span></div>
                <div class="grid-cell number-cell"><input type="number" name="attr_health_adjustment" value="0" class="sheet-d6pp" /></div>
                <div class="grid-cell number-cell"><span name="attr_health_conditions"></span></div>
                <div class="grid-cell number-cell"><span name="attr_health_string"></span></div>
                <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_health">Roll</button></div>
                <!-- Row: Quickness -->
                <div class="grid-cell number-cell">(Q)uickness</div>
                <div class="grid-cell number-cell"><span name="attr_quickness_base_string"></span></div>
                <div class="grid-cell number-cell"><input type="number" name="attr_quickness_adjustment" value="0" class="sheet-d6pp" /></div>
                <div class="grid-cell number-cell"><span name="attr_quickness_conditions"></span></div>
                <div class="grid-cell number-cell"><span name="attr_quickness_string"></span></div>
                <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_quickness">Roll</button></div>
            </div>
        </div>
    </div>
    <!-- Core Skills -->
    <div class="skill-section-collapsible">
        <input type="checkbox" class="skill-toggle" id="toggle_core" name="attr_toggle_core" value="1" checked hidden />
        <label class="skill-toggle-label" for="toggle_core">Vehicle Skills</label>
        <div class="skill-group-content">
            <div class="sheet-grid-table four-col">
                <!-- Headers -->
                <div class="grid-header">Skill</div>
                <div class="grid-header">Attr Code</div>
                <div class="grid-header">Dice Code</div>
                <div class="grid-header">Roll</div>
                <!-- Row: Avoid -->
                <div class="grid-cell grid-skill-name">
                    <span name="attr_vehicle_avoid_displayname"></span><span name="attr_vehicle_avoid_specialized"></span>
                </div>
                <div class="grid-cell number-cell"><span name="attr_vehicle_avoid_attributes"></span></div>
                <div class="grid-cell number-cell"><span name="attr_vehicle_avoid_string"></span></div>
                <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_vehicle_avoid">Roll</button></div>
                <!-- Row: Dodge -->
                <div class="grid-cell grid-skill-name">
                    <span name="attr_vehicle_dodge_displayname"></span><span name="attr_vehicle_dodge_specialized"></span>
                </div>
                <div class="grid-cell number-cell"><span name="attr_vehicle_dodge_attributes"></span></div>
                <div class="grid-cell number-cell"><span name="attr_vehicle_dodge_string"></span></div>
                <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_vehicle_dodge">Roll</button></div>
                <!-- Row: Impede -->
                <div class="grid-cell grid-skill-name">
                    <span name="attr_vehicle_impede_displayname"></span><span name="attr_vehicle_impede_specialized"></span>
                </div>
                <div class="grid-cell number-cell"><span name="attr_vehicle_impede_attributes"></span></div>
                <div class="grid-cell number-cell"><span name="attr_vehicle_impede_string"></span></div>
                <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_vehicle_impede">Roll</button></div>
                <!-- Row: Keep Control -->
                <div class="grid-cell grid-skill-name">
                    <span name="attr_vehicle_keep_control_displayname"></span><span name="attr_vehicle_keep_control_specialized"></span>
                </div>
                <div class="grid-cell number-cell"><span name="attr_vehicle_keep_control_attributes"></span></div>
                <div class="grid-cell number-cell"><span name="attr_vehicle_keep_control_string"></span></div>
                <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_vehicle_keep_control">Roll</button></div>
                <!-- Row: Obstruct -->
                <div class="grid-cell grid-skill-name">
                    <span name="attr_vehicle_obstruct_displayname"></span><span name="attr_vehicle_obstruct_specialized"></span>
                </div>
                <div class="grid-cell number-cell"><span name="attr_vehicle_obstruct_attributes"></span></div>
                <div class="grid-cell number-cell"><span name="attr_vehicle_obstruct_string"></span></div>
                <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_vehicle_obstruct">Roll</button></div>
                <!-- Row: Ram -->
                <div class="grid-cell grid-skill-name">
                    <span name="attr_vehicle_ram_displayname"></span><span name="attr_vehicle_ram_specialized"></span>
                </div>
                <div class="grid-cell number-cell"><span name="attr_vehicle_ram_attributes"></span></div>
                <div class="grid-cell number-cell"><span name="attr_vehicle_ram_string"></span></div>
                <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_vehicle_ram">Roll</button></div>
                <!-- Row: Speed -->
                <div class="grid-cell grid-skill-name">
                    <span name="attr_vehicle_speed_displayname"></span>
                </div>
                <div class="grid-cell number-cell"><span name="attr_vehicle_speed_attributes"></span></div>
                <div class="grid-cell number-cell"><span name="attr_vehicle_speed_string"></span></div>
                <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_vehicle_speed">Roll</button></div>
            </div>
        </div>
    </div>
  </div> <!-- Vehicle Character Sheet -->

  <!-- Quick NPC Character Sheet -->
  <div class="sheet-step sheet-step-quicknpc sheet-mode-quicknpc">

  <!-- Expand/Collapse and Spend Controls -->
  <div class="sheet-controls-row" style="justify-content: space-between;">
    <!-- Left: Expand/Collapse -->
    <div>
      <button type="action" class="sheet-d6pp" name="act_expand_all">Expand All</button>
      <button type="action" class="sheet-d6pp" name="act_collapse_all">Collapse All</button>
    </div>
  </div>
    <!-- Character Info Grid -->
    <div class="sheet-section-collapsible">
      <input type="checkbox" class="skill-toggle" id="toggle_details" name="attr_toggle_details" value="1" checked hidden />
      <label class="skill-toggle-label" for="toggle_details">Character Details</label>
      <div class="skill-group-content">

        <div class="sheet-controls-row" style="display: flex; align-items: center; gap: 1rem;">
          <!-- Name (left aligned, fixed) -->
          <div class="sheet-controls-group" style="flex: 0 0 auto; display: flex; align-items: center; gap: 0.25rem;">
            <label class="sheet-d6pp-label">Name:</label>
            <input type="text" class="sheet-d6pp" name="attr_character_name" style="width: 10em;" />
          </div>

          <!-- Type (expand to fill remaining space) -->
          <div class="sheet-controls-group" style="flex: 1; display: flex; align-items: center; gap: 0.25rem;">
            <label class="sheet-d6pp-label">Type:</label>
            <input type="text" class="sheet-d6pp" value="Quick NPC" readonly style="flex: 1;" />
          </div>
        </div>
        <div class="spacer-sm"></div>
        <label class="sheet-d6pp-label">Description:</label>
        <textarea class="sheet-d6pp" name="attr_character_description"></textarea>
        <div class="spacer-sm"></div>
          <!-- GM Whisper + Move/Run/Advantage Row -->
        <div class="sheet-controls-row" style="justify-content: space-between;">
          <div class="d6pp-checkbox">
            <label class="inline-checkbox-label">
              <input type="checkbox" name="attr_whisper_toggle" value="/w gm " />
              Whisper to GM
            </label>
          </div>
          <div style="display: flex; align-items: center; gap: 8px;">
            <label class="sheet-d6pp-label">Move:</label>
            <input type="text" class="sheet-d6pp sheet-small-input" name="attr_current_move" readonly />
            <label class="sheet-d6pp-label">Run:</label>
            <input type="text" class="sheet-d6pp sheet-small-input" name="attr_current_run" readonly />
            <label class="sheet-d6pp-label">Advantage:</label>
            <input type="number" class="sheet-d6pp" name="attr_advantage" />
          </div>
        </div>
      </div>
    </div>

    <!-- Skill Check -->
    <div class="sheet-section-collapsible">
      <input type="checkbox" class="skill-toggle" id="toggle_skillcheck" name="attr_toggle_skillcheck" value="1" checked hidden />
      <label class="skill-toggle-label" for="toggle_skillcheck">Skill Check</label>
      <div class="skill-group-content">
        <div class="sheet-grid-table six-col full-width">
          <div class="grid-header">Target Number</div>
          <div class="grid-header">Challenge Rating</div>
          <div class="grid-header">Modifier</div>
          <div class="grid-header">Wound Penalty</div>
          <div class="grid-header">Armor Penalty</div>
          <div class="grid-header">Driving Penalty</div>

          <div class="grid-cell target-number-cell"><span name="attr_skill_check_target">0</span></div>
          <div class="grid-cell">
            <select name="attr_skillcheck_cr" class="sheet-d6pp-select">
              <option value="0">Trivial</option>
              <option value="5">Easy (+5)</option>
              <option value="10">Moderate (+10)</option>
              <option value="15">Hard (+15)</option>
              <option value="20">Very Hard (+20)</option>
              <option value="25">Extremely Hard (+25)</option>
            </select>
          </div>
          <div class="grid-cell"><input type="number" name="attr_skillcheck_modifier" class="sheet-d6pp" value="0" /></div>
          <div class="grid-cell number-cell"><span name="attr_skillcheck_wound_penalty">0</span></div>
          <div class="grid-cell number-cell"><span name="attr_armor_penalty">0</span></div>
          <div class="grid-cell number-cell"><span name="attr_skillcheck_mounted_penalty">0</span></div>
        </div>
        <span class="small-hint">Modifier includes Help, Prep, and situational bonuses.</span>
      </div>
    </div>

    <!-- Combat -->
    <div class="sheet-section-collapsible">
      <input type="checkbox" class="skill-toggle" id="toggle_combat" name="attr_toggle_combat" value="1" checked hidden />
      <label class="skill-toggle-label" for="toggle_combat">Combat</label>
      <div class="skill-group-content">
        <div class="sheet-grid-table nine-col full-width">

          <!-- Headers -->
          <div class="grid-header">Target Number</div>
          <div class="grid-header">Range</div>
          <div class="grid-header">Cover</div>
          <div class="grid-header">Opponent's Dodge</div>
          <div class="grid-header">Opponent's Armor</div>
          <div class="grid-header">Modifier</div>
          <div class="grid-header">Wound Penalty</div>
          <div class="grid-header">Armor Penalty</div>
          <div class="grid-header">Driving Penalty</div>

          <!-- Row values -->
          <div class="grid-cell target-number-cell"><span name="attr_combat_target">0</span></div>
          <div class="grid-cell">
            <select name="attr_combat_range" class="sheet-d6pp-select">
              <option value="5">Point Blank (5)</option>
              <option value="10">Short (10)</option>
              <option value="15">Medium (15)</option>
              <option value="20">Long (20)</option>
              <option value="25">Extreme (25)</option>
            </select>
          </div>
          <div class="grid-cell">
            <select name="attr_combat_cover" class="sheet-d6pp-select">
              <option value="0">None (0)</option>
              <option value="5">Light (5)</option>
              <option value="10">Half (10)</option>
              <option value="15">Heavy (15)</option>
              <option value="30">Full (30)</option>
            </select>
          </div>
          <div class="grid-cell">
            <input type="number" name="attr_combat_opponent_dodge" class="sheet-d6pp" value="0" min="0" />
          </div>
          <div class="grid-cell">
            <input type="number" name="attr_combat_opponent_armor" class="sheet-d6pp" value="0" min="0" />
          </div>
          <div class="grid-cell"><input type="number" name="attr_combat_modifier" class="sheet-d6pp" value="0" /></div>
          <div class="grid-cell"><span name="attr_skillcheck_wound_penalty">0</span></div>
          <div class="grid-cell"><span name="attr_armor_penalty">0</span></div>
          <div class="grid-cell"><span name="attr_skillcheck_mounted_penalty">0</span></div>

        </div>
        <span class="small-hint">Modifier includes Help, Prep, and situational bonuses.</span>
        <div class="spacer-md"></div>
        <label class="sheet-d6pp-label">Select a Form of Attack</label>
        <div class="sheet-attack-tabs">
            <!-- Radio buttons -->
            <input type="radio" name="attr_attack_mode_q" value="firearms" class="sheet-tab" checked />
            <span>Firearms</span>
            <input type="radio" name="attr_attack_mode_q" value="ranged" class="sheet-tab" />
            <span>Ranged</span>
            <input type="radio" name="attr_attack_mode_q" value="armed" class="sheet-tab" />
            <span>Armed</span>
            <input type="radio" name="attr_attack_mode_q" value="unarmed" class="sheet-tab" />
            <span>Unarmed</span>
            <div class="spacer-sm"></div>
            <div class="sheet-attack-section sheet-firearms">
                <!-- Weapon 1 -->
                <div class="sheet-grid-attack sheet-grid-firearms full-width">
                    <!-- Headers -->
                    <div class="grid-header">Weapon</div>
                    <div class="grid-header">Dice</div>
                    <div class="grid-header">Damage</div>
                    <div class="grid-header">Ammo</div>
                    <div class="grid-header">Short</div>
                    <div class="grid-header">Medium</div>
                    <div class="grid-header">Long</div>
                    <div class="grid-header">Extreme</div>
                    <!-- Row 1: Weapon 1 -->
                    <div class="grid-cell stack-weapon">
                        <select name="attr_firearm1_weapon" class="sheet-d6pp-select">
                          <option value="None">None</option>
                          <option value="Revolver">Revolver (1H)</option>
                          <option value="Pistol">Pistol (1H)</option>
                          <option value="Subcompact Pistol">Subcompact Pistol (1H)</option>
                          <option value="Machine Pistol">Machine Pistol (1H)</option>
                          <option value="Automatic Pistol">Automatic Pistol (1H)</option>
                          <option value="Assault Rifle">Assault Rifle (2H)</option>
                          <option value="Compact Carbine">Compact Carbine (2H)</option>
                          <option value="Light Machine Rifle">Light Machine Rifle (2H)</option>
                          <option value="Sniper Rifle">Sniper Rifle (2H)</option>
                          <option value="Battle Rifle">Battle Rifle (2H)</option>
                          <option value="Hunting Rifle">Hunting Rifle (2H)</option>
                          <option value="Shotgun">Shotgun (2H)</option>
                          <option value="Sawed-off Shotgun">Sawed-off Shotgun (2H)</option>
                        </select>
                        <div class="weapon-skill">
                          <span name="attr_firearm1_attr"></span><span> (</span><span name="attr_firearm1_string"></span><span>)</span>
                        </div>
                    </div>
                    <div class="grid-cell stack-tight">
                        <span name="attr_firearm1_actual"></span>
                        <button type="action" name="act_firearm1_attack">Roll</button>
                    </div>
                    <div class="grid-cell stack-tight">
                        <span name="attr_firearm1_damage"></span>
                        <button type="action" name="act_firearm1_damage">Damage</button>
                    </div>
                    <div class="grid-cell stack-tight">
                        <div class="ammo-button-row">
                            <button type="action" name="act_firearm1_ammo_add">+</button>
                            <button type="action" name="act_firearm1_ammo_sub"></button>
                        </div>
                        <button type="action" name="act_firearm1_ammo_reload">Reload</button>
                    </div>
                    <div class="grid-cell"><span name="attr_firearm1_short"></span></div>
                    <div class="grid-cell"><span name="attr_firearm1_medium"></span></div>
                    <div class="grid-cell"><span name="attr_firearm1_long"></span></div>
                    <div class="grid-cell"><span name="attr_firearm1_extreme"></span></div>
                    <!-- Ammo Display Row -->
                    <div class="grid-cell ammo-display full-row">
                        <!-- not grid-span-8 -->
                        <span name="attr_firearm1_ammo_display"></span>
                    </div>
                </div>
                <!-- Weapon 2 -->
                <div class="sheet-grid-attack sheet-grid-firearms full-width">
                    <!-- Row 1: Weapon 2 -->
                    <div class="grid-cell stack-weapon">
                        <select name="attr_firearm2_weapon" class="sheet-d6pp-select">
                          <option value="None">None</option>
                          <option value="Revolver">Revolver (1H)</option>
                          <option value="Pistol">Pistol (1H)</option>
                          <option value="Subcompact Pistol">Subcompact Pistol (1H)</option>
                          <option value="Machine Pistol">Machine Pistol (1H)</option>
                          <option value="Automatic Pistol">Automatic Pistol (1H)</option>
                          <option value="Assault Rifle">Assault Rifle (2H)</option>
                          <option value="Compact Carbine">Compact Carbine (2H)</option>
                          <option value="Light Machine Rifle">Light Machine Rifle (2H)</option>
                          <option value="Sniper Rifle">Sniper Rifle (2H)</option>
                          <option value="Battle Rifle">Battle Rifle (2H)</option>
                          <option value="Hunting Rifle">Hunting Rifle (2H)</option>
                          <option value="Shotgun">Shotgun (2H)</option>
                          <option value="Sawed-off Shotgun">Sawed-off Shotgun (2H)</option>
                        </select>
                        <div class="weapon-skill">
                          <span name="attr_firearm2_attr"></span><span> (</span><span name="attr_firearm2_string"></span><span>)</span>
                        </div>
                    </div>
                    <div class="grid-cell stack-tight">
                        <span name="attr_firearm2_actual"></span>
                        <button type="action" name="act_firearm2_attack">Roll</button>
                    </div>
                    <div class="grid-cell stack-tight">
                        <span name="attr_firearm2_damage"></span>
                        <button type="action" name="act_firearm2_damage">Damage</button>
                    </div>
                    <div class="grid-cell stack-tight">
                        <div class="ammo-button-row">
                            <button type="action" name="act_firearm2_ammo_add">+</button>
                            <button type="action" name="act_firearm2_ammo_sub"></button>
                        </div>
                        <button type="action" name="act_firearm2_ammo_reload">Reload</button>
                    </div>
                    <div class="grid-cell"><span name="attr_firearm2_short"></span></div>
                    <div class="grid-cell"><span name="attr_firearm2_medium"></span></div>
                    <div class="grid-cell"><span name="attr_firearm2_long"></span></div>
                    <div class="grid-cell"><span name="attr_firearm2_extreme"></span></div>
                    <!-- Ammo Display Row -->
                    <div class="grid-cell ammo-display full-row">
                        <!-- not grid-span-8 -->
                        <span name="attr_firearm2_ammo_display"></span>
                    </div>
                </div>
                <!-- Weapon 3 -->
                <div class="sheet-grid-attack sheet-grid-firearms full-width">
                    <!-- Row 1: Weapon 3 -->
                    <div class="grid-cell stack-weapon">
                        <select name="attr_firearm3_weapon" class="sheet-d6pp-select">
                          <option value="None">None</option>
                          <option value="Revolver">Revolver (1H)</option>
                          <option value="Pistol">Pistol (1H)</option>
                          <option value="Subcompact Pistol">Subcompact Pistol (1H)</option>
                          <option value="Machine Pistol">Machine Pistol (1H)</option>
                          <option value="Automatic Pistol">Automatic Pistol (1H)</option>
                          <option value="Assault Rifle">Assault Rifle (2H)</option>
                          <option value="Compact Carbine">Compact Carbine (2H)</option>
                          <option value="Light Machine Rifle">Light Machine Rifle (2H)</option>
                          <option value="Sniper Rifle">Sniper Rifle (2H)</option>
                          <option value="Battle Rifle">Battle Rifle (2H)</option>
                          <option value="Hunting Rifle">Hunting Rifle (2H)</option>
                          <option value="Shotgun">Shotgun (2H)</option>
                          <option value="Sawed-off Shotgun">Sawed-off Shotgun (2H)</option>
                        </select>
                        <div class="weapon-skill">
                          <span name="attr_firearm3_attr"></span><span> (</span><span name="attr_firearm3_string"></span><span>)</span>
                        </div>
                    </div>
                    <div class="grid-cell stack-tight">
                        <span name="attr_firearm3_actual"></span>
                        <button type="action" name="act_firearm3_attack">Roll</button>
                    </div>
                    <div class="grid-cell stack-tight">
                        <span name="attr_firearm3_damage"></span>
                        <button type="action" name="act_firearm3_damage">Damage</button>
                    </div>
                    <div class="grid-cell stack-tight">
                        <div class="ammo-button-row">
                            <button type="action" name="act_firearm3_ammo_add">+</button>
                            <button type="action" name="act_firearm3_ammo_sub"></button>
                        </div>
                        <button type="action" name="act_firearm3_ammo_reload">Reload</button>
                    </div>
                    <div class="grid-cell"><span name="attr_firearm3_short"></span></div>
                    <div class="grid-cell"><span name="attr_firearm3_medium"></span></div>
                    <div class="grid-cell"><span name="attr_firearm3_long"></span></div>
                    <div class="grid-cell"><span name="attr_firearm3_extreme"></span></div>
                    <!-- Ammo Display Row -->
                    <div class="grid-cell ammo-display full-row last-row">
                        <span name="attr_firearm3_ammo_display"></span>
                    </div>
                </div>
            </div>
            <div class="sheet-attack-section sheet-ranged">
                <div class="sheet-grid-attack sheet-grid-ranged full-width">
                    <!-- Headers -->
                    <div class="grid-header">Weapon</div>
                    <div class="grid-header">Dice</div>
                    <div class="grid-header">Damage</div>
                    <div class="grid-header">Short</div>
                    <div class="grid-header">Medium</div>
                    <div class="grid-header">Long</div>
                    <div class="grid-header">Extreme</div>
                    <!-- Weapon Row -->
                    <div class="grid-cell stack-weapon">
                        <select name="attr_ranged_weapon" class="sheet-d6pp-select">
                          <option value="None">None</option>
                          <option value="Crossbow">Crossbow (2H)</option>
                          <option value="Slingshot">Slingshot (1H)</option>
                          <option value="Thrown Medium Weapon">Thrown Medium Weapon (1H)</option>
                          <option value="Thrown Light Weapon">Thrown Light Weapon (1H)</option>
                          <option value="Improvised Thrown">Improvised Thrown (1H)</option>
                        </select>
                        <div class="weapon-skill">
                          <span name="attr_ranged_attr"></span><span> (</span><span name="attr_ranged_string"></span><span>)</span>
                        </div>
                    </div>
                    <div class="grid-cell stack-tight">
                        <span name="attr_ranged_actual"></span>
                        <button type="action" name="act_ranged_attack" class="sheet-d6pp">Roll</button>
                    </div>
                    <div class="grid-cell stack-tight">
                        <span name="attr_ranged_damage"></span>
                        <button type="action" name="act_ranged_damage" class="sheet-d6pp">Damage</button>
                    </div>
                    <div class="grid-cell"><span name="attr_ranged_short"></span></div>
                    <div class="grid-cell"><span name="attr_ranged_medium"></span></div>
                    <div class="grid-cell"><span name="attr_ranged_long"></span></div>
                    <div class="grid-cell"><span name="attr_ranged_extreme"></span></div>
                </div>
            </div>
            <div class="sheet-attack-section sheet-armed">
                <div class="sheet-grid-attack sheet-grid-melee full-width">
                    <!-- Headers -->
                    <div class="grid-header">Weapon</div>
                    <div class="grid-header">Dice</div>
                    <div class="grid-header">Damage</div>
                    <!-- Row: Melee Weapon -->
                    <div class="grid-cell stack-weapon">
                        <select name="attr_armed_weapon" class="sheet-d6pp-select">
                          <option value="">None</option>
                          <option value="Brass Knuckles">Brass Knuckles (1H)</option>
                          <option value="Chainsaw">Chainsaw (2H)</option>
                          <option value="Club">Club (1H)</option>
                          <option value="Improvised Weapon">Improvised Weapon (1H)</option>
                          <option value="Knife">Knife (1H)</option>
                          <option value="Machete">Machete (1H)</option>
                          <option value="Pepper Spray">Pepper Spray (1H)</option>
                          <option value="Pistol Whip">Pistol Whip (1H)</option>
                          <option value="Push">Push (1H)</option>
                          <option value="Shield Bash">Shield Bash (1H)</option>
                          <option value="Stun Baton">Stun Baton (1H)</option>
                          <option value="Stun Gun">Stun Gun (1H)</option>
                          <option value="Sword">Sword (1H)</option>
                          <option value="Tonfa">Tonfa (1H)</option>
                        </select>
                        <div class="weapon-skill">
                          <span name="attr_armed_attr"></span><span> (</span><span name="attr_armed_string"></span><span>)</span>
                        </div>
                    </div>
                    <div class="grid-cell stack-tight">
                        <span name="attr_armed_actual"></span>
                        <button type="action" class="sheet-d6pp" name="act_armed_attack">Roll</button>
                    </div>
                    <div class="grid-cell stack-tight">
                        <span name="attr_armed_damage"></span>
                        <button type="action" class="sheet-d6pp" name="act_armed_damage">Damage</button>
                    </div>
                </div>
            </div>
            <div class="sheet-attack-section sheet-unarmed">
                <div class="sheet-grid-attack sheet-grid-melee full-width">
                    <!-- Headers -->
                    <div class="grid-header">Weapon</div>
                    <div class="grid-header">Dice</div>
                    <div class="grid-header">Damage</div>
                    <!-- Row: Melee Weapon -->
                    <div class="grid-cell stack-weapon">
                        <select name="attr_unarmed_weapon" class="sheet-d6pp-select">
                          <option value="">None</option>
                          <option value="Brawling">Brawling (2H)</option>
                          <option value="Wrestling">Wrestling (2H)</option>
                          <option value="Push">Push (1H)</option>
                        </select>
                        <div class="weapon-skill">
                          <span name="attr_unarmed_attr"></span><span> (</span><span name="attr_unarmed_string"></span><span>)</span>
                        </div>
                    </div>
                    <div class="grid-cell stack-tight">
                        <span name="attr_unarmed_actual"></span>
                        <button type="action" class="sheet-d6pp" name="act_unarmed_attack">Roll</button>
                    </div>
                    <div class="grid-cell stack-tight">
                        <span name="attr_unarmed_damage"></span>
                        <button type="action" class="sheet-d6pp" name="act_unarmed_damage">Damage</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="spacer-md"></div>
        <div class="sheet-controls-group">
            <button type="action" class="sheet-d6pp" name="act_initiative">Roll Initiative</button>
        </div>
      </div>
    </div>
    <!-- Armor -->
    <div class="sheet-section-collapsible">
      <input type="checkbox" class="skill-toggle" id="toggle_armor" name="attr_toggle_armor" value="1" checked hidden />
      <label class="skill-toggle-label" for="toggle_armor">Armor</label>
      <div class="skill-group-content">

        <div class="sheet-armor-row">
          <!-- Helmet -->
          <div class="sheet-armor-column">
            <label>Helmet</label>
            <select name="attr_head_armor" class="sheet-d6pp-select">
              <option value="None">None</option>
              <option value="Improvised Helmet">Improvised Helmet</option>
              <option value="Riot Helmet">Riot Helmet</option>
              <option value="Full Helmet">Full Helmet</option>
            </select>
            <span>+<span name="attr_head_armor_bonus"></span> Bonus</span><br />
            <span>+<span name="attr_head_armor_penalty"></span> Penalty</span>
            <div class="spacer-sm"></div>
            <span name="attr_head_armor_desc"></span>
          </div>

          <!-- Body Armor -->
          <div class="sheet-armor-column">
            <label>Body</label>
            <select name="attr_body_armor" class="sheet-d6pp-select">
              <option value="None">None</option>
              <option value="Improvised Armor">Improvised Armor</option>
              <option value="Kevlar Vest">Kevlar Vest</option>
              <option value="Riot Armor">Riot Armor</option>
            </select>
            <span>+<span name="attr_body_armor_bonus"></span> Bonus</span><br />
            <span>+<span name="attr_body_armor_penalty"></span> Penalty</span>
            <div class="spacer-sm"></div>
            <span name="attr_body_armor_desc"></span>
          </div>

          <!-- Shield -->
          <div class="sheet-armor-column">
            <label>Shield</label>
            <select name="attr_shield" class="sheet-d6pp-select">
              <option value="None">None</option>
              <option value="Improvised Shield">Improvised Shield</option>
              <option value="Riot Shield">Riot Shield</option>
            </select>
            <span>+<span name="attr_shield_bonus"></span> Bonus</span><br />
            <span>+<span name="attr_shield_penalty"></span> Penalty</span>
            <div class="spacer-sm"></div>
            <span name="attr_shield_desc"></span>
          </div>
        </div>

      </div>
    </div>
    <!-- Wounds -->
    <div class="sheet-section-collapsible">
      <input type="checkbox" class="skill-toggle" id="toggle_wounds" name="attr_toggle_wounds" value="1" checked hidden />
      <label class="skill-toggle-label" for="toggle_wounds">Wounds</label>
      <div class="skill-group-content">
        <div class="sheet-grid-table six-col full-width">
          <div class="grid-header">First Aid Target Number</div>
          <div class="grid-header">Wound Points</div>
          <div class="grid-header">Wounds Ignored</div>
          <div class="grid-header"># First Aid</div>
          <div class="grid-header">Unconscious Threshold</div>
          <div class="grid-header">Death Threshold</div>

          <div class="grid-cell target-number-cell">
            <span name="attr_first_aid_target">0</span>
          </div>
          <div class="grid-cell">
            <input type="number" name="attr_wounds_total" value="0" min="0" class="sheet-d6pp" />
          </div>
          <div class="grid-cell">
            <input type="number" name="attr_wounds_ignored" value="0" min="0" class="sheet-d6pp" />
          </div>
          <div class="grid-cell">
            <input type="number" name="attr_first_aid_count" value="0" min="0" class="sheet-d6pp" />
          </div>
          <div class="grid-cell"><span name="attr_unconscious_threshold"></span></div>
          <div class="grid-cell"><span name="attr_death_threshold"></span></div>
        </div>
        <div class="spacer-md"></div>

        <div class="sheet-controls-row">
          <!-- Left -->
          <div class="sheet-controls-group">
            <button type="action" class="sheet-d6pp" name="act_endure">Roll Endure</button>
          </div>
          <div class="sheet-controls-group">
            <label class="sheet-d6pp-label" style="margin: 0; display: inline;">Status:</label>
            <input type="text" class="sheet-d6pp" name="attr_status" readonly/>
            <div class="d6pp-checkbox">
              <label class="inline-checkbox-label">
                <input type="checkbox" name="attr_revived_toggle" />
                Revived
              </label>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Conditions -->
    <div class="sheet-section-collapsible">
        <input type="checkbox" class="skill-toggle" id="toggle_conditions" name="attr_toggle_conditions" value="1" checked hidden />
        <label class="skill-toggle-label" for="toggle_conditions">Conditions</label>
        <div class="skill-group-content">
          <div class="sheet-condition-grid">
            <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_aiming" /> Aiming</label>
            <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_blind" /> Blind</label>
            <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_dehydrated" /> Dehydrated</label>
            <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_diseased" /> Diseased</label>
            <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_mounted" /> Driving</label>
            <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_drunk" /> Drunk</label>
            <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_exhausted" /> Exhausted</label>
            <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_frightened" /> Frightened</label>
            <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_grappled" /> Grappled</label>
            <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_hyperthermic" /> Hyperthermic</label>
            <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_hypothermic" /> Hypothermic</label>
            <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_knockout" /> Knockout</label>
            <label class="d6pp-checkbox"><input type="checkbox" name="attr_condition_poisoned" /> Poisoned</label>
          </div>
        </div>
    </div>

    <!-- Attributes (not spend mode) -->
    <div class="sheet-section-collapsible">
        <input type="checkbox" class="skill-toggle" id="toggle_attributes" name="attr_toggle_attributes" value="1" checked hidden />
        <label class="skill-toggle-label" for="toggle_attributes">Attributes</label>
        <div class="skill-group-content">
            <div class="sheet-grid-table six-col full-width">
                <!-- Headers -->
                <div class="grid-header"></div>
                <div class="grid-header">Base</div>
                <div class="grid-header">Adjustment</div>
                <div class="grid-header">Conditions</div>
                <div class="grid-header">Actual</div>
                <div class="grid-header">Roll</div>
                <!-- Row: Strength -->
                <div class="grid-cell number-cell">(S)trength</div>
                <div class="grid-cell number-cell"><span name="attr_strength_base_string"></span></div>
                <div class="grid-cell number-cell"><input type="number" name="attr_strength_adjustment" value="0" class="sheet-d6pp" /></div>
                <div class="grid-cell number-cell"><span name="attr_strength_conditions"></span></div>
                <div class="grid-cell number-cell"><span name="attr_strength_string"></span></div>
                <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_strength">Roll</button></div>
                <!-- Row: Agility -->
                <div class="grid-cell number-cell">(A)gility</div>
                <div class="grid-cell number-cell"><span name="attr_agility_base_string"></span></div>
                <div class="grid-cell number-cell"><input type="number" name="attr_agility_adjustment" value="0" class="sheet-d6pp" /></div>
                <div class="grid-cell number-cell"><span name="attr_agility_conditions"></span></div>
                <div class="grid-cell number-cell"><span name="attr_agility_string"></span></div>
                <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_agility">Roll</button></div>
                <!-- Row: Health -->
                <div class="grid-cell number-cell">(H)ealth</div>
                <div class="grid-cell number-cell"><span name="attr_health_base_string"></span></div>
                <div class="grid-cell number-cell"><input type="number" name="attr_health_adjustment" value="0" class="sheet-d6pp" /></div>
                <div class="grid-cell number-cell"><span name="attr_health_conditions"></span></div>
                <div class="grid-cell number-cell"><span name="attr_health_string"></span></div>
                <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_health">Roll</button></div>
                <!-- Row: Perception -->
                <div class="grid-cell number-cell">(P)erception</div>
                <div class="grid-cell number-cell"><span name="attr_perception_base_string"></span></div>
                <div class="grid-cell number-cell"><input type="number" name="attr_perception_adjustment" value="0" class="sheet-d6pp" /></div>
                <div class="grid-cell number-cell"><span name="attr_perception_conditions"></span></div>
                <div class="grid-cell number-cell"><span name="attr_perception_string"></span></div>
                <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_perception">Roll</button></div>
                <!-- Row: Quickness -->
                <div class="grid-cell number-cell">(Q)uickness</div>
                <div class="grid-cell number-cell"><span name="attr_quickness_base_string"></span></div>
                <div class="grid-cell number-cell"><input type="number" name="attr_quickness_adjustment" value="0" class="sheet-d6pp" /></div>
                <div class="grid-cell number-cell"><span name="attr_quickness_conditions"></span></div>
                <div class="grid-cell number-cell"><span name="attr_quickness_string"></span></div>
                <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_quickness">Roll</button></div>
                <!-- Row: Willpower -->
                <div class="grid-cell number-cell">(W)illpower</div>
                <div class="grid-cell number-cell"><span name="attr_willpower_base_string"></span></div>
                <div class="grid-cell number-cell"><input type="number" name="attr_willpower_adjustment" value="0" class="sheet-d6pp" /></div>
                <div class="grid-cell number-cell"><span name="attr_willpower_conditions"></span></div>
                <div class="grid-cell number-cell"><span name="attr_willpower_string"></span></div>
                <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_willpower">Roll</button></div>
                <!-- Row: Intelligence -->
                <div class="grid-cell number-cell">(I)ntelligence</div>
                <div class="grid-cell number-cell"><span name="attr_intelligence_base_string"></span></div>
                <div class="grid-cell number-cell"><input type="number" name="attr_intelligence_adjustment" value="0" class="sheet-d6pp" /></div>
                <div class="grid-cell number-cell"><span name="attr_intelligence_conditions"></span></div>
                <div class="grid-cell number-cell"><span name="attr_intelligence_string"></span></div>
                <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_intelligence">Roll</button></div>
                <!-- Row: Manual Dexterity -->
                <div class="grid-cell number-cell">(M)anual Dex</div>
                <div class="grid-cell number-cell"><span name="attr_manualdex_base_string"></span></div>
                <div class="grid-cell number-cell"><input type="number" name="attr_manualdex_adjustment" value="0" class="sheet-d6pp" /></div>
                <div class="grid-cell number-cell"><span name="attr_manualdex_conditions"></span></div>
                <div class="grid-cell number-cell"><span name="attr_manualdex_string"></span></div>
                <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_manualdex">Roll</button></div>
                <!-- Row: Charisma -->
                <div class="grid-cell number-cell">(C)harisma</div>
                <div class="grid-cell number-cell"><span name="attr_charisma_base_string"></span></div>
                <div class="grid-cell number-cell"><input type="number" name="attr_charisma_adjustment" value="0" class="sheet-d6pp" /></div>
                <div class="grid-cell number-cell"><span name="attr_charisma_conditions"></span></div>
                <div class="grid-cell number-cell"><span name="attr_charisma_string"></span></div>
                <div class="grid-cell"><button type="action" class="sheet-d6pp" name="act_charisma">Roll</button></div>
            </div>
        </div>
    </div>
    <div class="sheet-section-collapsible">
        <input type="checkbox" class="skill-toggle" id="toggle_skill_finder" name="attr_toggle_skill_finder" value="1" checked hidden />
        <label class="skill-toggle-label" for="toggle_skill_finder">Out-of-Combat Skill Finder</label>
        <div class="skill-group-content">
          <div class="sheet-grid-table three-col">
              <!-- Headers -->
              <div class="grid-header">Skill</div>
              <div class="grid-header">Skill Code</div>
              <div class="grid-header">Roll</div>
              <!-- Row: Avoid -->
              <div class="grid-cell">
                <select name="attr_searched_skill" class="sheet-d6pp-select">
                  <option value="">None</option>
                  <option value="acrobatics">Acrobatics (AAS)</option>
                  <option value="acting">Acting (CCP)</option>
                  <option value="air_navigation">Air Navigation (PII)</option>
                  <option value="animal_care">Animal Care (PCW)</option>
                  <option value="animal_empathy">Animal Empathy (PPC)</option>
                  <option value="animal_handling">Animal Handling (ACP)</option>
                  <option value="animal_training">Animal Training (WPI)</option>
                  <option value="appraisal">Appraisal (PPI)</option>
                  <option value="art">Art (MMP)</option>
                  <option value="athletics">Athletics (SSA)</option>
                  <option value="automatic_handgun">Automatic Handgun (AAS)</option>
                  <option value="automatic_rifle">Automatic Rifle (AAS)</option>
                  <option value="avoid">Avoid (QPP)</option>
                  <option value="biology">Biology (IPP)</option>
                  <option value="boxing">Boxing (SAQ)</option>
                  <option value="brawling">Brawling (ASS)</option>
                  <option value="build">Build (MMA)</option>
                  <option value="bureaucracy">Bureaucracy (WWW)</option>
                  <option value="camouflage">Camouflage (MPP)</option>
                  <option value="carpentry">Carpentry (MSW)</option>
                  <option value="cartography">Cartography (IIP)</option>
                  <option value="cheating">Cheating (MPW)</option>
                  <option value="climbing">Climbing (SSH)</option>
                  <option value="command">Command (CCP)</option>
                  <option value="comedy">Comedy (CPP)</option>
                  <option value="computer_use">Computer Use (IIM)</option>
                  <option value="control_drone">Control Drone (PPM)</option>
                  <option value="cooking">Cooking (IWM)</option>
                  <option value="crossbow">Crossbow (APM)</option>
                  <option value="dance">Dance (CAP)</option>
                  <option value="deceive">Deceive (CPP)</option>
                  <option value="defend">Defend (SQP)</option>
                  <option value="disguise">Disguise (MIP)</option>
                  <option value="dodge">Dodge (QPA)</option>
                  <option value="drive_boat">Drive Boat (AAQ)</option>
                  <option value="drive_car">Drive Car (AAQ)</option>
                  <option value="drive_motorcycle">Drive Motorcycle (AQW)</option>
                  <option value="drive_semi">Drive Semi (SAW)</option>
                  <option value="education">Education (III)</option>
                  <option value="electronics">Electronics (MII)</option>
                  <option value="electroshock">Electroshock (QPW)</option>
                  <option value="empathy">Empathy (PPC)</option>
                  <option value="endure">Endure (HHW)</option>
                  <option value="etiquette">Etiquette (CCW)</option>
                  <option value="explosives">Explosives (MWW)</option>
                  <option value="fishing">Fishing (MWP)</option>
                  <option value="first_aid">First Aid (PWI)</option>
                  <option value="foraging">Foraging (PIM)</option>
                  <option value="forgery">Forgery (MII)</option>
                  <option value="gambling">Gambling (PPI)</option>
                  <option value="gunsmithing">Gunsmithing (MMP)</option>
                  <option value="hand_signals">Hand Signals (MMP)</option>
                  <option value="hardware">Hardware (MMI)</option>
                  <option value="hide">Hide (WWI)</option>
                  <option value="hunting">Hunting (PPQ)</option>
                  <option value="improvised_weapon">Improvised Weapon (ASQ)</option>
                  <option value="initiative">Initiative (QQP)</option>
                  <option value="insight">Insight (PPP)</option>
                  <option value="instinct">Instinct (PPW)</option>
                  <option value="intelligence">Intelligence (III)</option>
                  <option value="intimidate">Intimidate (CCS)</option>
                  <option value="interrogation">Interrogation (PWS)</option>
                  <option value="investigate">Investigate (IIP)</option>
                  <option value="jumping">Jumping (AAH)</option>
                  <option value="jury_rig">Jury-Rig (MPW)</option>
                  <option value="lifting">Lifting (SSS)</option>
                  <option value="lockpicking">Lockpicking (MIP)</option>
                  <option value="manualdex">Manual Dexterity (MMM)</option>
                  <option value="mechanical">Mechanical (MIW)</option>
                  <option value="medical_care">Medical Care (IIP)</option>
                  <option value="melee_weapon">Melee Weapon (AQQ)</option>
                  <option value="negotiate">Negotiate (CIW)</option>
                  <option value="perception">Perception (PPP)</option>
                  <option value="persuade">Persuade (CCI)</option>
                  <option value="play_instrument">Play Instrument (MMQ)</option>
                  <option value="push">Push (SSS)</option>
                  <option value="repair">Repair (MPI)</option>
                  <option value="ride_bicycle">Ride Bicycle (HHS)</option>
                  <option value="rifle">Rifle (APW)</option>
                  <option value="sailing">Sailing (MAI)</option>
                  <option value="sawed_off_shotgun">Sawed-Off Shotgun (SAW)</option>
                  <option value="scavenging">Scavenging (PPW)</option>
                  <option value="search">Search (PPI)</option>
                  <option value="seduce">Seduce (CCP)</option>
                  <option value="showmanship">Showmanship (CCA)</option>
                  <option value="sing">Sing (CHP)</option>
                  <option value="sleight_of_hand">Sleight of Hand (MMP)</option>
                  <option value="slingshot">Slingshot (AMM)</option>
                  <option value="sneak">Sneak (APW)</option>
                  <option value="sniper_rifle">Sniper Rifle (PIW)</option>
                  <option value="strength">Strength (SSS)</option>
                  <option value="streetwise">Streetwise (CPI)</option>
                  <option value="subtle">Subtle (QAP)</option>
                  <option value="surveillance">Surveillance (WWP)</option>
                  <option value="swimming">Swimming (AHH)</option>
                  <option value="tactics">Tactics (IPW)</option>
                  <option value="thrown">Thrown (SAM)</option>
                  <option value="tracking">Tracking (PPI)</option>
                  <option value="welding">Welding (MSW)</option>
                  <option value="willpower">Willpower (WWW)</option>
                  <option value="wrestling">Wrestling (SQA)</option>
                  <option value="writing">Writing (CIP)</option>
                </select>
                <span name="attr_searched_skill_specialized"></span>
              </div>
              <div class="grid-cell number-cell"><span name="attr_searched_action_skill"></span></div>
              <div class="grid-cell">
                <button type="action" class="sheet-d6pp" name="act_searched_skill_roll">Roll</button>
              </div>
          </div>
        </div>
    </div>
  </div> <!-- End Quick NPC Sheet -->

</div> <!-- End sheet -->

<script type="text/worker">

//********** START: CONSTS

  const ATTRS = [
  "strength",
  "agility",
  "health",
  "perception",
  "quickness",
  "willpower",
  "intelligence",
  "manualdex",
  "charisma",
  "vehicle_drive"
  ];

  const SKILL_STATS = {
    // Core
    initiative: "QQP",
    dodge: "QPA",
    defend: "SQP",
    endure: "HHW",
    avoid: "QPP",

    //vehicle
    vehicle_dodge: "AAD",
    vehicle_ram: "AQD",
    vehicle_keep_control: "ADD",
    vehicle_avoid: "QDD",
    vehicle_speed: "QQD",
    vehicle_stunt: "DDD",
    vehicle_impede: "DDD",
    vehicle_obstruct: "SDD",

    // Social
    persuade: "CCI",
    intimidate: "CCS",
    deceive: "CPP",
    negotiate: "CIW",
    seduce: "CCP",
    streetwise: "CPI",
    etiquette: "CCW",
    bureaucracy: "WWW",

    // Performance
    dance: "CAP",
    sing: "CHP",
    acting: "CCP",
    art: "MMP",
    comedy: "CPP",
    play_instrument: "MMQ",
    disguise: "MIP",
    gambling: "PPI",
    showmanship: "CCA",

    // Thievery
    sleight_of_hand: "MMP",
    lockpicking: "MIP",
    forgery: "MII",
    cheating: "MPW",

    // Investigation
    search: "PPI",
    investigate: "IIP",
    forensics: "IPW",
    interrogation: "PWS",

    // Animals
    animal_training: "WPI",
    animal_handling: "ACP",
    animal_care: "PCW",
    animal_empathy: "PPC",

    // Awareness
    insight: "PPP",
    instinct: "PPW",
    empathy: "PPC",

    //Driving
    drive_car: "AAQ",
    drive_motorcycle: "AQW",
    drive_semi: "SAW",
    ride_bicycle: "HHS",

    // Survival
    tracking: "PPI",
    hunting: "PPQ",
    foraging: "PIM",
    scavenging: "PPW",
    cooking: "IWM",

    // Stealth
    sneak: "APW",
    hide: "WWI",
    subtle: "QAP",
    surveillance: "WWP",

    // Physical
    athletics: "SSA",
    acrobatics: "AAS",
    climbing: "SSH",
    swimming: "AHH",
    lifting: "SSS",
    jumping: "AAH",

    // Medical
    first_aid: "PWI",
    medical_care: "IIP",
    surgery: "MIP",
    pharmacology: "IWW",
    psychiatry: "IWC",

    // Computers
    computer_use: "IIM",
    programming: "III",
    hacking: "IPW",
    hardware: "MMI",

    // Technical
    gunsmithing: "MMP",
    electronics: "MII",
    explosives: "MWW",
    welding: "MSW",
    mechanical: "MIW",
    carpentry: "MSW",
    build: "MMA",
    jury_rig: "MPW",
    repair: "MPI",

    // Knowledge
    education: "III",
    cartography: "IIP",
    appraisal: "PPI",
    writing: "CIP",
    engineering: "III",
    law: "III",
    physics: "III",
    chemistry: "IMP",
    mathematics: "III",
    biology: "IPP",
    astronomy: "IIP",
    linguistics: "IPP",

    //Aviation
    fly_plane: "PIM",
    fly_helicopter: "PIW",
    control_drone: "PPM",
    air_navigation: "PII",

    //Nautical
	  drive_boat: "AAQ",
	  sea_navigation: "IPP",
	  fishing: "MWP",
    sailing: "MAI",
    diving: "HHW",

    // Military Training
    camouflage: "MPP",
    tactics: "IPW",
    hand_signals: "MMP",
    command: "CCP",
    spycraft: "WIP",

    // Sidearms
    handgun: "AAQ",
    sawed_off_shotgun: "SAW",
    automatic_handgun: "AAS",

    // Longarms
    rifle: "APW",
    shotgun: "SAW",
    sniper_rifle: "PIW",
    automatic_rifle: "AAS",

    // Unarmed
    aikido: "PIW",
    boxing: "SAQ",
    brawling: "ASS",
    capoeira: "APQ",
    jeet_kune_do: "QAW",
    jiu_jitsu: "SQI",
    judo: "SQW",
    karate: "SAW",
    krav_maga: "PAW",
    muay_thai: "SAP",
    push: "SSS",
    sambo: "SSW",
    savate: "AAP",
    taekwondo: "AAQ",
    wrestling: "SQA",

    // Armed
    melee_weapon: "AQQ",
    improvised_weapon: "ASQ",
    electroshock: "QPW",

    // Ranged
    bow: "AAM",
    crossbow: "APM",
    slingshot: "AMM",
    thrown: "SAM"
  };

  const LETTER_TO_ATTR = {
    A: "agility",
    S: "strength",
    H: "health",
    P: "perception",
    Q: "quickness",
    W: "willpower",
    I: "intelligence",
    M: "manualdex",
    C: "charisma",
    D: "vehicle_drive"
  };

  const SKILL_GROUPS = {
    // Core
    initiative: "core",
    dodge: "core",
    endure: "core",
    avoid: "core",
    defend: "core",

    // Vehicle
    vehicle_dodge: "vehicle",
    vehicle_avoid: "vehicle",
    vehicle_ram: "vehicle",
    vehicle_keep_control: "vehicle",
    vehicle_speed: "vehicle",
    vehicle_stunt: "vehicle",
    vehicle_impede: "vehicle",
    vehicle_obstruct: "vehicle",

    // Social
    persuade: "social",
    intimidate: "social",
    deceive: "social",
    negotiate: "social",
    seduce: "social",
    streetwise: "social",
    etiquette: "social",
    bureaucracy: "social",

    // Performance
    dance: "performance",
    sing: "performance",
    acting: "performance",
    art: "performance",
    comedy: "performance",
    play_instrument: "performance",
    disguise: "performance",
    gambling: "performance",
    showmanship: "performance",

    // Thievery
    sleight_of_hand: "thievery",
    lockpicking: "thievery",
    forgery: "thievery",
    cheating: "thievery",

    // Investigation
    search: "investigation",
    investigate: "investigation",
    forensics: "investigation",
    interrogation: "investigation",

    // Animals
    animal_training: "animals",
    animal_handling: "animals",
    animal_care: "animals",
    animal_empathy: "animals",

    // Awareness
    insight: "awareness",
    instinct: "awareness",
    empathy: "awareness",

    //Driving
    drive_car: "driving",
    drive_motorcycle: "driving",
    drive_semi: "driving",
    ride_bicycle: "driving",

    // Survival
    tracking: "survival",
    hunting: "survival",
    foraging: "survival",
    scavenging: "survival",
    cooking: "survival",

    // Stealth
    sneak: "stealth",
    hide: "stealth",
    subtle: "stealth",
    surveillance: "stealth",

    // Physical
    athletics: "physical",
    acrobatics: "physical",
    climbing: "physical",
    swimming: "physical",
    lifting: "physical",
    jumping: "physical",

    // Medical
    first_aid: "medical",
    medical_care: "medical",
    surgery: "medical",
    pharmacology: "medical",
    psychiatry: "medical",

    // Computers
    computer_use: "computers",
    programming: "computers",
    hacking: "computers",
    hardware: "computers",

    // Technical
    gunsmithing: "technical",
    electronics: "technical",
    explosives: "technical",
    welding: "technical",
    mechanical: "technical",
    carpentry: "technical",
    build: "technical",
    jury_rig: "technical",
    repair: "technical",

    // Knowledge
    education: "knowledge",
    cartography: "knowledge",
    appraisal: "knowledge",
    writing: "knowledge",
    engineering: "knowledge",
    law: "knowledge",
    physics: "knowledge",
    chemistry: "knowledge",
    mathematics: "knowledge",
    biology: "knowledge",
    astronomy: "knowledge",
    linguistics: "knowledge",

    //Aviation
    fly_plane: "aviation",
    fly_helicopter: "aviation",
    control_drone: "aviation",
    air_navigation: "aviation",

    //Nautical
	  drive_boat: "nautical",
	  sea_navigation: "nautical",
	  fishing: "nautical",
    sailing: "nautical",
    diving: "nautical",

    // Military Training
    camouflage: "military_training",
    tactics: "military_training",
    hand_signals: "military_training",
    command: "military_training",
    spycraft: "military_training",

    // Sidearms
    handgun: "sidearms",
    sawed_off_shotgun: "sidearms",
    automatic_handgun: "sidearms",

    // Longarms
    rifle: "longarms",
    shotgun: "longarms",
    sniper_rifle: "longarms",
    automatic_rifle: "longarms",

    // Unarmed
    aikido: "unarmed",
    boxing: "unarmed",
    brawling: "unarmed",
    capoeira: "unarmed",
    jeet_kune_do: "unarmed",
    jiu_jitsu: "unarmed",
    judo: "unarmed",
    karate: "unarmed",
    krav_maga: "unarmed",
    muay_thai: "unarmed",
    push: "unarmed",
    sambo: "unarmed",
    savate: "unarmed",
    taekwondo: "unarmed",
    wrestling: "unarmed",

    // Armed
    melee_weapon: "armed",
    improvised_weapon: "armed",
    electroshock: "armed",

    // Ranged
    bow: "ranged",
    crossbow: "ranged",
    slingshot: "ranged",
    thrown: "ranged"
  };

  const SKILL_GROUP_LIST = [
    "animals",
    "armed",
    "aviation",
    "awareness",
    "computers",
    "core",
    "driving",
    "investigation",
    "knowledge",
    "longarms",
    "medical",
    "military_training",
    "nautical",
    "performance",
    "physical",
    "ranged",
    "sidearms",
    "social",
    "stealth",
    "survival",
    "technical",
    "thievery",
    "unarmed",
    "vehicle"
  ];

  const ACTIVATABLE_SKILLS = [
    "aikido",
    "astronomy",
    "biology",
    "boxing",
    "bow",
    "capoeira",
    "chemistry",
    "diving",
    "engineering",
    "fly_helicopter",
    "fly_plane",
    "forensics",
    "hacking",
    "jeet_kune_do",
    "jiu_jitsu",
    "judo",
    "karate",
    "krav_maga",
    "law",
    "linguistics",
    "mathematics",
    "muay_thai",
    "pharmacology",
    "physics",
    "programming",
    "psychiatry",
    "sambo",
    "savate",
    "spycraft",
    "surgery",
    "taekwondo",
    "wing_chun"
  ];

  const ATTACK_SKILLS = [
    "electroshock",
    "improvised_weapon",
    "melee_weapon",
    "automatic_rifle",
    "rifle",
    "shotgun",
    "sniper_rifle",
    "bow",
    "crossbow",
    "slingshot",
    "thrown",
    "automatic_handgun",
    "handgun",
    "sawed_off_shotgun",
    "aikido",
    "boxing",
    "brawling",
    "capoeira",
    "jeet_kune_do",
    "jiu_jitsu",
    "judo",
    "karate",
    "krav_maga",
    "muay_thai",
    "push",
    "sambo",
    "savate",
    "taekwondo",
    "wrestling"
  ]

  const RANGES_LOOKUP = {
    "Blank Range": {
      "point_blank": "-",
      "short": "-",
      "medium": "-",
      "long": "-",
      "extreme": "-"
    },
    "Close Range": {
      "point_blank": "05",
      "short": "610",
      "medium": "1120",
      "long": "2130",
      "extreme": "3150"
    },
    "Short Range": {
      "point_blank": "05",
      "short": "620",
      "medium": "21100",
      "long": "101250",
      "extreme": "251500"
    },
    "Medium Range": {
      "point_blank": "05",
      "short": "630",
      "medium": "31200",
      "long": "201800",
      "extreme": "8012000"
    },
    "Long Range": {
      "point_blank": "05",
      "short": "650",
      "medium": "51300",
      "long": "3011500",
      "extreme": "15015000"
    }
  };

  const FIREARMS_LOOKUP = {
    "None": {
      skillCategory: "",
      hands: "",
      damage: "0D",
      minDamage: 0,
      rangeType: "Blank Range",
      ammo: "",
      special: "No weapon selected"
    },

    "Revolver": {
      skillCategory: "handgun",
      hands: "1H",
      damage: "5D",
      minDamage: 1,
      rangeType: "Short Range",
      ammo: 6,
      special: ""
    },
    "Pistol": {
      skillCategory: "handgun",
      hands: "1H",
      damage: "4D",
      minDamage: 1,
      rangeType: "Short Range",
      ammo: 12,
      special: ""
    },
    "Subcompact Pistol": {
      skillCategory: "handgun",
      hands: "1H",
      damage: "3D",
      minDamage: 0,
      rangeType: "Close Range",
      ammo: 9,
      special: ""
    },
    "Machine Pistol": {
      skillCategory: "automatic_handgun",
      hands: "1H",
      damage: "5D",
      minDamage: 1,
      rangeType: "Short Range",
      ammo: 20,
      special: ""
    },
    "Automatic Pistol": {
      skillCategory: "automatic_handgun",
      hands: "1H",
      damage: "4D",
      minDamage: 1,
      rangeType: "Short Range",
      ammo: 15,
      special: ""
    },
    "Assault Rifle": {
      skillCategory: "automatic_rifle",
      hands: "2H",
      damage: "5D",
      minDamage: 2,
      rangeType: "Medium Range",
      ammo: 30,
      special: ""
    },
    "Compact Carbine": {
      skillCategory: "automatic_rifle",
      hands: "2H",
      damage: "4D",
      minDamage: 1,
      rangeType: "Short Range",
      ammo: 25,
      special: ""
    },
    "Light Machine Rifle": {
      skillCategory: "automatic_rifle",
      hands: "2H",
      damage: "5D",
      minDamage: 3,
      rangeType: "Medium Range",
      ammo: 40,
      special: ""
    },

    "Sniper Rifle": {
      skillCategory: "sniper_rifle",
      hands: "2H",
      damage: "5D",
      minDamage: 2,
      rangeType: "Long Range",
      ammo: 5,
      special: ""
    },

    "Battle Rifle": {
      skillCategory: "rifle",
      hands: "2H",
      damage: "5D",
      minDamage: 3,
      rangeType: "Long Range",
      ammo: 20,
      special: ""
    },
    "Hunting Rifle": {
      skillCategory: "rifle",
      hands: "2H",
      damage: "5D",
      minDamage: 2,
      rangeType: "Long Range",
      ammo: 5,
      special: ""
    },

    "Shotgun": {
      skillCategory: "shotgun",
      hands: "2H",
      damage: "4D",
      minDamage: 1,
      rangeType: "Medium Range",
      ammo: 2,
      special: ""
    },
    "Sawed-off Shotgun": {
      skillCategory: "sawed_off_shotgun",
      hands: "2H",
      damage: "5D",
      minDamage: 2,
      rangeType: "Close Range",
      ammo: 2,
      special: ""
    }
  };

  const ARMOR_LOOKUP = {
  // Head Armor
  "Improvised Helmet": {
    description: "Basic protection using a bike helmet, hard hat, or similar item.",
    toBeHitBonus: 2,
    tnPenalty: 1,
    blocks2H: false
  },
  "Riot Helmet": {
    description: "Police-grade helmet with a visor, offering reliable impact protection.",
    toBeHitBonus: 3,
    tnPenalty: 1,
    blocks2H: false
  },
  "Full Helmet": {
    description: "Military ballistic helmet with full head coverage and padding.",
    toBeHitBonus: 5,
    tnPenalty: 3,
    blocks2H: false
  },

  // Body Armor
  "Improvised Armor": {
    description: "Thrown-together protection made from books, metal, or sports gear.",
    toBeHitBonus: 3,
    tnPenalty: 5,
    blocks2H: false
  },
  "Kevlar Vest": {
    description: "Standard bullet-resistant vest, commonly worn by police or bodyguards.",
    toBeHitBonus: 5,
    tnPenalty: 3,
    blocks2H: false
  },
  "Riot Armor": {
    description: "Full tactical suit used in riot control, offering extensive coverage.",
    toBeHitBonus: 8,
    tnPenalty: 5,
    blocks2H: false
  },

  // Shields
  "Improvised Shield": {
    description: "Anything from a trash can lid to a car door. Makeshift but useful. Cannot use 2H weapons.",
    toBeHitBonus: 3,
    tnPenalty: 1,
    blocks2H: true
  },
  "Riot Shield": {
    description: "Transparent, reinforced shield used by riot police. High visibility and coverage. Cannot use 2H weapons.",
    toBeHitBonus: 5,
    tnPenalty: 0,
    blocks2H: true
  },

  // None (for fallback)
  "None": {
    description: "No armor equipped.",
    toBeHitBonus: 0,
    tnPenalty: 0,
    blocks2H: false
  }
};

  const RANGED_LOOKUP = {
    "None": {
      skillCategory: "",
      hands: "",
      damage: "0D",
      minDamage: 0,
      rangeType: "Blank Range",
      special: "No weapon selected"
    },
    "Bow": {
      skillCategory: "bow",
      hands: "2H",
      damage: "5D",
      minDamage: 1,
      rangeType: "Medium Range",
      special: ""
    },
    "Crossbow": {
      skillCategory: "crossbow",
      hands: "2H",
      damage: "4D",
      minDamage: 1,
      rangeType: "Medium Range",
      special: ""
    },
    "Slingshot": {
      skillCategory: "slingshot",
      hands: "1H",
      damage: "2D+2",
      minDamage: 0,
      rangeType: "Close Range",
      special: ""
    },
    "Thrown Medium Weapon": {
      skillCategory: "thrown",
      hands: "1H",
      damage: "3D+1",
      minDamage: 1,
      rangeType: "Close Range",
      special: ""
    },
    "Thrown Light Weapon": {
      skillCategory: "thrown",
      hands: "1H",
      damage: "2D+2",
      minDamage: 0,
      rangeType: "Close Range",
      special: ""
    },
    "Improvised Thrown": {
      skillCategory: "thrown",
      hands: "1H",
      damage: "2D+1",
      minDamage: 0,
      rangeType: "Close Range",
      special: "50% chance of breaking on hit"
    }
  };

  const MELEE_LOOKUP = {
    "None": {
      skillCategory: "",
      hands: "",
      damage: "0D",
      minDamage: 0,
      special: "No weapon selected"
    },

    "Brawling": {
      skillCategory: "brawling",
      hands: "2H",
      damage: "S+1",
      minDamage: 0,
      special: "Knockout Attack"
    },
    "Boxing": {
      skillCategory: "boxing",
      hands: "2H",
      damage: "S+1D+2",
      minDamage: 0,
      special: "Knockout Attack"
    },
    "Muay Thai": {
      skillCategory: "muay_thai",
      hands: "2H",
      damage: "S+2D",
      minDamage: 2,
      special: "Knockout Attack"
    },
    "Krav Maga": {
      skillCategory: "krav_maga",
      hands: "2H",
      damage: "4D",
      minDamage: 2,
      special: "Disarm Attack"
    },
    "Jeet Kune Do": {
      skillCategory: "jeet_kune_do",
      hands: "2H",
      damage: "P+1D+2",
      minDamage: 2,
      special: "Knockout Attack"
    },
    "Karate": {
      skillCategory: "karate",
      hands: "2H",
      damage: "S+1D+1",
      minDamage: 1,
      special: "Knockout Attack"
    },
    "Taekwondo": {
      skillCategory: "taekwondo",
      hands: "2H",
      damage: "S+1D+1",
      minDamage: 1,
      special: "Knockout Attack"
    },
    "Capoeira": {
      skillCategory: "capoeira",
      hands: "2H",
      damage: "A+1D",
      minDamage: 1,
      special: "Grapple, Push, or Prone Attack"
    },
    "Savate": {
      skillCategory: "savate",
      hands: "2H",
      damage: "A+1D",
      minDamage: 1,
      special: "Knockout Attack"
    },
    "Jiu-Jitsu": {
      skillCategory: "jiu_jitsu",
      hands: "2H",
      damage: "S+1",
      minDamage: 0,
      special: "Grapple Attack"
    },
    "Sambo": {
      skillCategory: "sambo",
      hands: "2H",
      damage: "S+1D",
      minDamage: 0,
      special: "Grapple, Push, or Prone Attack"
    },
    "Judo": {
      skillCategory: "judo",
      hands: "2H",
      damage: "S+1",
      minDamage: 0,
      special: "Grapple, Push, or Prone Attack"
    },
    "Aikido": {
      skillCategory: "aikido",
      hands: "2H",
      damage: "P",
      minDamage: 0,
      special: "Disarm Attack"
    },


    "Push": {
      skillCategory: "push",
      hands: "1H",
      damage: "0D",
      minDamage: 0,
      special: "Move target 5ft away from you"
    },
    "Wrestling": {
      skillCategory: "wrestling",
      hands: "2H",
      damage: "S",
      minDamage: 0,
      special: "Grapple Attack"
    },

    "Improvised Weapon": {
      skillCategory: "improvised_weapon",
      hands: "1H",
      damage: "S+1D",
      minDamage: 0,
      special: "50% chance of breaking on hit"
    },
    "Pistol Whip": {
      skillCategory: "improvised_weapon",
      hands: "1H",
      damage: "S+2",
      minDamage: 0,
      special: "Knockout Attack"
    },
    "Stun Gun": {
      skillCategory: "electroshock",
      hands: "1H",
      damage: "4D",
      minDamage: 0,
      special: "Knockout Attack"
    },
    "Stun Baton": {
      skillCategory: "electroshock",
      hands: "1H",
      damage: "5D",
      minDamage: 1,
      special: "Knockout Attack"
    },
    "Knife": {
      skillCategory: "melee_weapon",
      hands: "1H",
      damage: "S+1D+2",
      minDamage: 1,
      special: ""
    },
    "Sword": {
      skillCategory: "melee_weapon",
      hands: "1H",
      damage: "S+2D",
      minDamage: 2,
      special: ""
    },
    "Club": {
      skillCategory: "melee_weapon",
      hands: "1H",
      damage: "S+1D",
      minDamage: 1,
      special: "Knockout Attack"
    },
    "Machete": {
      skillCategory: "melee_weapon",
      hands: "1H",
      damage: "S+1D+2",
      minDamage: 2,
      special: ""
    },
    "Brass Knuckles": {
      skillCategory: "melee_weapon",
      hands: "1H",
      damage: "S+2",
      minDamage: 1,
      special: "Knockout Attack"
    },
    "Chainsaw": {
      skillCategory: "improvised_weapon",
      hands: "2H",
      damage: "5D",
      minDamage: 3,
      special: ""
    },
    "Tonfa": {
      skillCategory: "melee_weapon",
      hands: "1H",
      damage: "S+1D",
      minDamage: 1,
      special: "Disarm Attack"
    },
    "Shield Bash": {
      skillCategory: "improvised_weapon",
      hands: "1H",
      damage: "S",
      minDamage: 0,
      special: "Push Attack"
    },
    "Pepper Spray": {
      skillCategory: "improvised_weapon",
      hands: "1H",
      damage: "0D",
      minDamage: 0,
      special: "Blinding Attack"
    }
  };

  const VALIDATION_RULES = {
    advantage: { min: -10, max:10 },
    skillcheck_modifier: { min: -99 },
    combat_modifier: { min: -99 },
    combat_opponent_dodge: { min: 0 },
    combat_opponent_armor: { min: 0 },
    num_declared_actions: {min: 1},

    wounds_total: { min: 0 },
    wounds_ignored: { min: 0 },
    first_aid_count: { min: 0 },

    strength_adjustment: { min: -99 },
    agility_adjustment: { min: -99 },
    health_adjustment: { min: -99 },
    perception_adjustment: { min: -99 },
    quickness_adjustment: { min: -99 },
    willpower_adjustment: { min: -99 },
    intelligence_adjustment: { min: -99 },
    manualdex_adjustment: { min: -99 },
    charisma_adjustment: { min: -99 },
    drive_adjustment: { min: 0 },

    strength_value: { min: 1, max: 5 },
    agility_value: { min: 1, max: 5 },
    health_value: { min: 1, max: 5 },
    perception_value: { min: 1, max: 5 },
    quickness_value: { min: 1, max: 5 },
    willpower_value: { min: 1, max: 5 },
    intelligence_value: { min: 1, max: 5 },
    manualdex_value: { min: 1, max: 5 },
    charisma_value: { min: 1, max: 5 },

    item_qty: { min: 0 },
    item_weight: { min: 0 },

    character_weight: {min: 0},
  };

  const VEHICLES = {
    // Cars
    hatchback: {
      type: "Hatchback",
      details: "A standard low-end car.",
      strength: 4,
      agility: 3,
      quickness: 3,
      health: 4,
      special: ""
    },
    sedan: {
      type: "Sedan",
      details: "A common mid-size car.",
      strength: 6,
      agility: 2,
      quickness: 3,
      health: 6,
      special: ""
    },
    luxury_sedan: {
      type: "Luxury Sedan",
      details: "A high-end comfortable sedan.",
      strength: 6,
      agility: 3,
      quickness: 3,
      health: 6,
      special: ""
    },
    convertible: {
      type: "Convertible",
      details: "A stylish car with the roof down, made for drivers who want to be seen.",
      strength: 5,
      agility: 3,
      quickness: 4,
      health: 4,
      special: ""
    },
    muscle_car: {
      type: "Muscle Car",
      details: "Raw power and straight-line acceleration.\nSpecialized: Vehicle Ram",
      strength: 8,
      agility: 3,
      quickness: 4,
      health: 7,
      special: "Specialized: Vehicle Ram"
    },
    vortex_supercar: {
      type: "Vortex Supercar",
      details: "An exotic, high-performance supercar built for speed and intimidation.\nSpecialized: Vehicle Impede",
      strength: 7,
      agility: 4,
      quickness: 6,
      health: 5,
      special: "Specialized: Vehicle Impede"
    },
    sports_car: {
      type: "Sports Car",
      details: "High performance, built for speed.\nSpecialized: Vehicle Stunt",
      strength: 6,
      agility: 4,
      quickness: 5,
      health: 4,
      special: "Specialized: Vehicle Stunt"
    },

    // Utility & Heavy
    pickup_truck: {
      type: "Pickup Truck",
      details: "A rugged truck built for utility.\nSpecialized: Vehicle Ram",
      strength: 8,
      agility: 2,
      quickness: 2,
      health: 8,
      special: "Specialized: Vehicle Ram"
    },
    suv: {
      type: "SUV",
      details: "A sport utility vehicle.",
      strength: 8,
      agility: 2,
      quickness: 3,
      health: 8,
      special: ""
    },
    delivery_van: {
      type: "Delivery Van",
      details: "A basic commercial van.",
      strength: 8,
      agility: 2,
      quickness: 2,
      health: 8,
      special: ""
    },
    semi_truck: {
      type: "Semi-Truck",
      details: "A large transport truck.\nSpecialized: Vehicle Ram",
      strength: 12,
      agility: 1,
      quickness: 1,
      health: 12,
      special: "Specialized: Vehicle Ram"
    },
    tow_truck: {
      type: "Tow Truck",
      details: "Heavy vehicle built to haul.\nSpecialized: Vehicle Obstruct",
      strength: 9,
      agility: 2,
      quickness: 2,
      health: 9,
      special: "Specialized: Vehicle Obstruct"
    },
    dump_truck: {
      type: "Dump Truck",
      details: "Massive construction-site workhorse.",
      strength: 10,
      agility: 2,
      quickness: 2,
      health: 10,
      special: ""
    },
    garbage_truck: {
      type: "Garbage Truck",
      details: "Reinforced sanitation truck, slow but unstoppable.\nSpecialized: Vehicle Obstruct",
      strength: 10,
      agility: 1,
      quickness: 2,
      health: 10,
      special: "Specialized: Vehicle Obstruct"
    },

    // Specialty
    motorhome: {
      type: "Motorhome",
      details: "Large RV with living quarters, spacious but heavy.",
      strength: 9,
      agility: 1,
      quickness: 2,
      health: 9,
      special: ""
    },
    hearse: {
      type: "Hearse",
      details: "Long, heavy vehicle used in funerals  or eccentric getaways.",
      strength: 6,
      agility: 2,
      quickness: 2,
      health: 6,
      special: ""
    },
    taxi: {
      type: "Taxi",
      details: "Iconic yellow cab or rideshare sedan.",
      strength: 6,
      agility: 2,
      quickness: 3,
      health: 6,
      special: ""
    },

    // Emergency & Security
    police_cruiser: {
      type: "Police Cruiser",
      details: "Reinforced law enforcement vehicle.\nSpecialized: Vehicle Ram",
      strength: 8,
      agility: 3,
      quickness: 4,
      health: 8,
      special: "Specialized: Vehicle Ram"
    },
    ambulance: {
      type: "Ambulance",
      details: "Emergency medical vehicle, reinforced for rescue.\nSpecialized: Vehicle Avoid",
      strength: 8,
      agility: 2,
      quickness: 3,
      health: 8,
      special: "Specialized: Vehicle Avoid"
    },
    fire_truck: {
      type: "Fire Truck",
      details: "Large emergency vehicle with ladders and hoses.\nSpecialized: Vehicle Obstruct",
      strength: 10,
      agility: 1,
      quickness: 2,
      health: 10,
      special: "Specialized: Vehicle Obstruct"
    },
    armored_truck: {
      type: "Armored Truck",
      details: "Heavily reinforced security vehicle for valuables.\nSpecialized: Vehicle Keep Control",
      strength: 10,
      agility: 2,
      quickness: 2,
      health: 10,
      special: "Specialized: Vehicle Keep Control"
    },

    // Special Terrain
    offroad: {
      type: "Off-Road",
      details: "Rugged vehicles like Jeeps or Land Cruisers.\nImmune to Off-Road",
      strength: 7,
      agility: 3,
      quickness: 4,
      health: 6,
      special: "Immune to Off-Road"
    },
    snowmobile: {
      type: "Snowmobile",
      details: "Small, fast vehicle for snow and ice.\nImmune to Off-Road",
      strength: 2,
      agility: 4,
      quickness: 4,
      health: 2,
      special: "Immune to Off-Road"
    },
    dune_buggy: {
      type: "Dune Buggy",
      details: "Lightweight frame built for sand and desert runs.\nImmune to Off-Road",
      strength: 4,
      agility: 4,
      quickness: 5,
      health: 3,
      special: "Immune to Off-Road"
    },
    hovercraft: {
      type: "Hovercraft",
      details: "Can drive on land and water.\nImmune to Off-Road",
      strength: 5,
      agility: 3,
      quickness: 4,
      health: 5,
      special: "Immune to Off-Road"
    },

    // Motorcycles
    street_bike: {
      type: "Street Bike",
      details: "Fast and reckless road motorcycle.",
      strength: 2,
      agility: 4,
      quickness: 4,
      health: 2,
      special: ""
    },
    chopper: {
      type: "Chopper",
      details: "Heavy, low-slung motorcycle built for style.",
      strength: 3,
      agility: 3,
      quickness: 3,
      health: 3,
      special: ""
    },
    dirt_bike: {
      type: "Dirt Bike",
      details: "Lightweight and agile motorcycle for trails and mud.\nImmune to Off-Road",
      strength: 2,
      agility: 5,
      quickness: 4,
      health: 2,
      special: "Immune to Off-Road"
    },
    touring_bike: {
      type: "Touring Bike",
      details: "Large, comfortable motorcycle for long trips.",
      strength: 3,
      agility: 2,
      quickness: 2,
      health: 4,
      special: ""
    },
    police_bike: {
      type: "Police Bike",
      details: "Fast pursuit motorcycle with lights and sirens.\nSpecialized: Vehicle Avoid",
      strength: 3,
      agility: 4,
      quickness: 4,
      health: 3,
      special: "Specialized: Vehicle Avoid"
    },

    // Watercraft
    jetski: {
      type: "Jet Ski",
      details: "Small personal watercraft, agile but fragile.",
      strength: 2,
      agility: 4,
      quickness: 4,
      health: 2,
      special: ""
    },
    speedboat: {
      type: "Speedboat",
      details: "High-performance watercraft.",
      strength: 6,
      agility: 3,
      quickness: 4,
      health: 6,
      special: ""
    },
    fishing_boat: {
      type: "Fishing Boat",
      details: "Durable utility craft, not built for speed.",
      strength: 6,
      agility: 2,
      quickness: 2,
      health: 6,
      special: ""
    },
    super_yacht: {
      type: "Super Yacht",
      details: "Floating fortress of wealth and excess.\nSpecialized: Vehicle Keep Control",
      strength: 10,
      agility: 2,
      quickness: 2,
      health: 12,
      special: "Specialized: Vehicle Keep Control"
    },
    rib: {
      type: "Rigid Inflatable Boat",
      details: "Light, portable, and very fast, but fragile.\nSpecialized: Vehicle Stunt",
      strength: 3,
      agility: 4,
      quickness: 5,
      health: 3,
      special: "Specialized: Vehicle Stunt"
    },
    sailboat: {
      type: "Sailboat",
      details: "Quiet and stealthy, powered by wind.\nSpecialized: Vehicle Avoid",
      strength: 5,
      agility: 3,
      quickness: 2,
      health: 5,
      special: "Specialized: Vehicle Avoid"
    },
    ferry: {
      type: "Ferry",
      details: "Massive passenger and vehicle carrier.",
      strength: 10,
      agility: 1,
      quickness: 2,
      health: 12,
      special: ""
    },
    police_boat: {
      type: "Police Boat",
      details: "Fast, maneuverable law enforcement vessel.\nSpecialized: Vehicle Ram",
      strength: 7,
      agility: 3,
      quickness: 4,
      health: 7,
      special: "Specialized: Vehicle Ram"
    },
    freighter: {
      type: "Freighter",
      details: "Steel giant cargo ship, ponderous but durable.\nSpecialized: Vehicle Keep Control",
      strength: 12,
      agility: 1,
      quickness: 1,
      health: 14,
      special: "Specialized: Vehicle Keep Control"
    },
    yacht: {
      type: "Yacht",
      details: "Luxurious and extravagant floating palace.",
      strength: 7,
      agility: 2,
      quickness: 2,
      health: 8,
      special: ""
    },

    // Air
    helicopter: {
      type: "Helicopter",
      details: "Light utility helicopter.",
      strength: 6,
      agility: 3,
      quickness: 5,
      health: 6,
      special: ""
    },
    four_seat_plane: {
      type: "Four-Seat Plane",
      details: "Small private aircraft.",
      strength: 6,
      agility: 3,
      quickness: 4,
      health: 6,
      special: ""
    },
    private_jet: {
      type: "Private Jet",
      details: "Luxurious, fast business aircraft.",
      strength: 6,
      agility: 3,
      quickness: 8,
      health: 6,
      special: ""
    },
    civilian_drone: {
      type: "Civilian Drone",
      details: "Small quadcopter used for photography or scouting.",
      strength: 1,
      agility: 4,
      quickness: 3,
      health: 1,
      special: ""
    },
    passenger_airliner: {
      type: "Passenger Airliner",
      details: "Massive, durable civilian transport.",
      strength: 12,
      agility: 1,
      quickness: 3,
      health: 12,
      special: ""
    },
    glider: {
      type: "Glider",
      details: "Silent, fragile aircraft carried by wind.",
      strength: 2,
      agility: 3,
      quickness: 3,
      health: 2,
      special: ""
    }
  };

  const BEASTS = {
    ape: {
     type: "Ape",
     details: "Large, intelligent, and incredibly strong, apes such as chimpanzees and gorillas are formidable creatures. Though they are often gentle within their social groups, apes can become violently territorial when threatened. Their dexterous hands allow tool use and simple problem solving, and they are known to mimic human behavior with eerie accuracy.",
     strength: 7,
     agility: 3,
     health: 5,
     perception: 3,
     quickness: 3,
     willpower: 3,
     intelligence: 3,
     manualdex: 1,
     charisma: 0,
     base_move: 30,
     base_run: 45,
     attacks: [
       { name: "Claw", skill: 5, damage: 7, minDamage: 1, special: "" },
       { name: "Grapple", skill: 5, damage: 6, minDamage: 1, special: "Grapple Attack" },
       { name: "Pound", skill: 5, damage: 6, minDamage: 1, special: "Knockout Attack" }
     ]
   },

   monkey: {
     type: "Monkey",
     details: "Agile, clever, and endlessly curious, monkeys are small primates known for their dexterity and mischief. Often found in tropical regions or kept as exotic pets, monkeys use their prehensile hands (and sometimes tails) to climb, steal, or manipulate tools.",
     strength: 2,
     agility: 4,
     health: 2,
     perception: 4,
     quickness: 4,
     willpower: 2,
     intelligence: 2,
     manualdex: 1,
     charisma: 0,
     base_move: 30,
     base_run: 50,
     attacks: [
       { name: "Scratch", skill: 3, damage: 2, minDamage: 0, special: "" }
     ]
   },

   // Flying Critters
   bat: {
     type: "Bat",
     details: "Small, nocturnal, and surprisingly agile, bats use echolocation to navigate in darkness. While generally harmless, their sudden appearance in confined spaces can cause panic.",
     strength: 1,
     agility: 4,
     health: 1,
     perception: 3,
     quickness: 5,
     willpower: 1,
     intelligence: 0,
     manualdex: 0,
     charisma: 0,
     base_move: 40,
     base_run: 60,
     attacks: [
       { name: "Bite", skill: 2, damage: 1, minDamage: 0, special: "Disease Attack (TN 10)" }
     ]
   },

   bird: {
     type: "Bird",
     details: "From sparrows and crows to gulls and hawks, wild birds are ubiquitous and varied. Most are skittish and harmless, though some may dive at intruders near their nests.",
     strength: 1,
     agility: 3,
     health: 1,
     perception: 3,
     quickness: 5,
     willpower: 1,
     intelligence: 1,
     manualdex: 0,
     charisma: 0,
     base_move: 40,
     base_run: 60,
     attacks: [
       { name: "Peck", skill: 2, damage: 1, minDamage: 0, special: "" }
     ]
   },

   exotic_bird: {
     type: "Exotic Bird",
     details: "Brilliantly colored and often highly intelligent, exotic birds like parrots or cockatoos are prized pets. Known for mimicry, expressive personalities, and striking plumage.",
     strength: 1,
     agility: 3,
     health: 1,
     perception: 3,
     quickness: 5,
     willpower: 2,
     intelligence: 3,
     manualdex: 1,
     charisma: 0,
     base_move: 25,
     base_run: 30,
     special: "Mimic  can repeat simple phrases it has heard before.",
     attacks: [
       { name: "Peck", skill: 2, damage: 1, minDamage: 0, special: "" }
     ]
   },

   hawk: {
     type: "Hawk",
     details: "Keen-eyed predators of the skies, hawks embody sharp vision and sudden strikes. They serve as messengers, companions, or aerial hazards in RPGs.",
     strength: 1,
     agility: 4,
     health: 1,
     perception: 5,
     quickness: 4,
     willpower: 2,
     intelligence: 1,
     manualdex: 0,
     charisma: 0,
     base_move: 40,
     base_run: 70,
     attacks: [
       { name: "Claw", skill: 3, damage: 3, minDamage: 0, special: "" }
     ]
   },

   // Wild Animals
   bear: {
     type: "Bear",
     details: "A massive predator of the wilds, immensely strong and relentless when provoked. Thick hide and endurance make it hard to bring down.",
     strength: 8,
     agility: 2,
     health: 5,
     perception: 2,
     quickness: 2,
     willpower: 2,
     intelligence: 0,
     manualdex: 1,
     charisma: 0,
     base_move: 30,
     base_run: 40,
     special: "Applies Frightened condition. Willpower check (TN 15).",
     attacks: [
       { name: "Claw", skill: 5, damage: 8, minDamage: 1, special: "" },
       { name: "Maul", skill: 5, damage: 6, minDamage: 1, special: "Grapple Attack" }
     ]
   },

   boar: {
     type: "Boar",
     details: "Broad-shouldered and bristling with coarse hair, the wild boar is a compact bundle of muscle and aggression.",
     strength: 4,
     agility: 2,
     health: 3,
     perception: 2,
     quickness: 2,
     willpower: 1,
     intelligence: 0,
     manualdex: 0,
     charisma: 0,
     base_move: 25,
     base_run: 35,
     special: "Gains -5 TN to attack rolls when wounded.",
     attacks: [
       { name: "Gore", skill: 4, damage: 5, minDamage: 1, special: "" }
     ]
   },

   coyote: {
     type: "Coyote",
     details: "Lean, wary, and cunning, coyotes thrive on the edges of human settlements and in open wilderness. Smaller and more solitary than wolves.",
     strength: 3,
     agility: 4,
     health: 2,
     perception: 3,
     quickness: 4,
     willpower: 2,
     intelligence: 1,
     manualdex: 0,
     charisma: 0,
     base_move: 35,
     base_run: 55,
     attacks: [
       { name: "Bite", skill: 3, damage: 4, minDamage: 0, special: "" }
     ]
   },

   deer: {
     type: "Deer",
     details: "Graceful and alert, deer are swift herbivores found in forests and plains. Naturally skittish, they flee at the first sign of danger.",
     strength: 3,
     agility: 4,
     health: 2,
     perception: 3,
     quickness: 5,
     willpower: 2,
     intelligence: 1,
     manualdex: 0,
     charisma: 0,
     base_move: 40,
     base_run: 65,
     attacks: [
       { name: "Kick", skill: 3, damage: 3, minDamage: 0, special: "Push Attack" }
     ]
   },

   moose: {
     type: "Moose",
     details: "Towering giants of the northern forests, moose are unpredictable and dangerous when provoked. A charging moose can overturn carts or crush foes.",
     strength: 7,
     agility: 2,
     health: 5,
     perception: 3,
     quickness: 2,
     willpower: 3,
     intelligence: 1,
     manualdex: 0,
     charisma: 0,
     base_move: 25,
     base_run: 40,
     attacks: [
       { name: "Kick", skill: 5, damage: 6, minDamage: 1, special: "" },
       { name: "Charge", skill: 6, damage: 7, minDamage: 1, special: "Push Attack, Prone Attack" }
     ]
   },

   raccoon: {
     type: "Raccoon",
     details: "Curious, clever, and highly adaptable, raccoons are nocturnal scavengers known for their dexterous paws and mischievous behavior.",
     strength: 2,
     agility: 4,
     health: 2,
     perception: 3,
     quickness: 3,
     willpower: 2,
     intelligence: 2,
     manualdex: 1,
     charisma: 0,
     base_move: 25,
     base_run: 40,
     attacks: [
       { name: "Scratch", skill: 3, damage: 2, minDamage: 0, special: "Disarm Attack" }
     ]
   },

   rat: {
     type: "Rat",
     details: "Small, adaptable, and often unwelcome, rats thrive in urban, rural, and subterranean environments.",
     strength: 1,
     agility: 3,
     health: 1,
     perception: 3,
     quickness: 4,
     willpower: 1,
     intelligence: 1,
     manualdex: 0,
     charisma: 0,
     base_move: 15,
     base_run: 30,
     attacks: [
       { name: "Bite", skill: 2, damage: 1, minDamage: 0, special: "Disease Attack (TN 10)" }
     ]
   },

   wolf: {
     type: "Wolf",
     details: "Lean, cunning predators that hunt in organized packs. Intelligent and coordinated, they use teamwork to bring down larger prey.",
     strength: 4,
     agility: 4,
     health: 2,
     perception: 3,
     quickness: 4,
     willpower: 2,
     intelligence: 1,
     manualdex: 0,
     charisma: 0,
     base_move: 35,
     base_run: 55,
     special: "-5 TN to attack when adjacent to another wolf.",
     attacks: [
       { name: "Bite", skill: 4, damage: 5, minDamage: 0, special: "" }
     ]
   },

   // Beasts of Burden
   camel: {
     type: "Camel",
     details: "Hardy and resilient, camels are built for endurance in extreme conditions. They can carry heavy loads across deserts with minimal water.",
     strength: 5,
     agility: 2,
     health: 4,
     perception: 2,
     quickness: 2,
     willpower: 4,
     intelligence: 1,
     manualdex: 0,
     charisma: 0,
     base_move: 25,
     base_run: 35,
     skills: [
       { name: "Lifting", skill: 5 }
     ],
     special: "The camel's spit does not damage, but is disgusting.",
     attacks: [
       { name: "Kick", skill: 3, damage: 5, minDamage: 0, special: "Knockout Attack" },
       { name: "Spit", skill: 6, damage: 0, minDamage: 0, special: "No effect, just disgusting" }
     ]
   },

   elephant: {
     type: "Elephant",
     details: "Towering, intelligent, and immensely strong, elephants are rarely aggressive but become terrifying when threatened.",
     strength: 10,
     agility: 1,
     health: 8,
     perception: 3,
     quickness: 1,
     willpower: 4,
     intelligence: 1,
     manualdex: 0,
     charisma: 0,
     base_move: 20,
     base_run: 30,
     skills: [
       { name: "Lifting", skill: 10 }
     ],
     attacks: [
       { name: "Trample", skill: 6, damage: 10, minDamage: 1, special: "Knockout Attack, Prone Attack" },
       { name: "Tusk Gore", skill: 5, damage: 8, minDamage: 1, special: "Push Attack" }
     ]
   },

   draft_horse: {
     type: "Draft Horse",
     details: "A massive work animal bred for endurance and raw strength. Steady, dependable, and built for hauling heavy loads or pulling wagons.",
     strength: 6,
     agility: 1,
     health: 4,
     perception: 2,
     quickness: 1,
     willpower: 2,
     intelligence: 1,
     manualdex: 0,
     charisma: 0,
     base_move: 30,
     base_run: 45,
     attacks: [
       { name: "Kick", skill: 3, damage: 6, minDamage: 0, special: "Knockout Attack" }
     ]
   },

   riding_horse: {
     type: "Riding Horse",
     details: "A strong and steady riding horse, trained for carrying a rider across long distances. Calm temperament, best for travel not combat.",
     strength: 5,
     agility: 2,
     health: 3,
     perception: 2,
     quickness: 2,
     willpower: 1,
     intelligence: 1,
     manualdex: 0,
     charisma: 0,
     base_move: 40,
     base_run: 60,
     attacks: [
       { name: "Kick", skill: 4, damage: 5, minDamage: 0, special: "Knockout Attack" }
     ]
   },

   mule: {
     type: "Mule",
     details: "A hardy and sure-footed beast of burden, prized for its endurance and resilience. Favored by prospectors and traders for rough terrain.",
     strength: 5,
     agility: 2,
     health: 3,
     perception: 2,
     quickness: 2,
     willpower: 4,
     intelligence: 1,
     manualdex: 0,
     charisma: 0,
     base_move: 20,
     base_run: 30,
     attacks: [
       { name: "Kick", skill: 4, damage: 5, minDamage: 0, special: "Knockout Attack" }
     ]
   },

 // Exotic
 kangaroo: {
   type: "Kangaroo",
   details: "Tall, muscular, and surprisingly fast, kangaroos move by powerful leaps and can deliver devastating kicks. Fierce when agitated.",
   strength: 5,
   agility: 4,
   health: 3,
   perception: 3,
   quickness: 4,
   willpower: 2,
   intelligence: 1,
   manualdex: 0,
   charisma: 0,
   base_move: 40,
   base_run: 60,
   attacks: [
     { name: "Kick", skill: 5, damage: 6, minDamage: 0, special: "Knockout Attack, Push Attack" }
   ]
 },

 panda: {
   type: "Panda",
   details: "Gentle giants native to bamboo forests, pandas are docile but possess surprising strength. Dangerous when defending young.",
   strength: 7,
   agility: 2,
   health: 5,
   perception: 3,
   quickness: 2,
   willpower: 3,
   intelligence: 2,
   manualdex: 0,
   charisma: 0,
   base_move: 20,
   base_run: 30,
   attacks: [
     { name: "Claw", skill: 4, damage: 6, minDamage: 0, special: "" },
     { name: "Grapple", skill: 3, damage: 5, minDamage: 0, special: "Grapple Attack" }
   ]
 },
    // Dogs
    bloodhound: {
      type: "Bloodhound",
      details: "The bloodhound is a powerful scent-tracking dog, prized for its unmatched ability to follow trails across miles of rugged terrain. Gentle-natured and loyal to its handler, the bloodhound is rarely aggressive, though it will defend itself if cornered. Used by lawmen, hunters, and sometimes criminals, this breed excels at pursuit, making escape nearly impossible once it has your scent. Its baying howl carries for long distances, warning both quarry and master of its findings.",
      strength: 2,
      agility: 2,
      health: 2,
      perception: 2,
      quickness: 3,
      willpower: 1,
      intelligence: 1,
      manualdex: 0,
      charisma: 0,
      base_move: 30,
      base_run: 45,
      skills: [
        { name: "Tracking", skill: 8 }
      ],
      attacks: [
        {
          name: "Bite",
          skill: 2,
          damage: 3,
          minDamage: 0,
          special: ""
        }
      ]
    },

    detection_dog: {
      type: "Detection Dog",
      details: "Specially trained to locate drugs and contraband by scent, detection dogs are highly disciplined working animals. Unlike guard or police dogs, they are not trained for aggression  their focus is on finding and alerting their handler to the presence of narcotics. Friendly and approachable when off duty, they are laser-focused when working, often ignoring distractions that would sidetrack untrained animals. Their incredible noses and conditioning make them invaluable to law enforcement, customs, and security forces.",
      strength: 3,
      agility: 3,
      health: 3,
      perception: 4,
      quickness: 4,
      willpower: 3,
      intelligence: 2,
      manualdex: 0,
      charisma: 0,
      base_move: 30,
      base_run: 45,
      skills: [
        { name: "Search", skill: 8 }
      ],
      attacks: [
        {
          name: "Bite",
          skill: 3,
          damage: 3,
          minDamage: 0,
          special: ""
        }
      ]
    },

    guard_dog: {
      type: "Guard Dog",
      details: "Loyal, alert, and trained to protect, the guard dog is a constant companion to ranchers, merchants, and those in need of a four-legged sentinel. It patrols territory with an acute sense of smell and hearing, and will bark loudly at unfamiliar scents or sudden movements. When danger strikes, it doesnt hesitatelunging to bite, bark, and hold attackers at bay. Guard dogs are commonly used to defend homes, camps, and livestock, and they rarely back down when defending their charges. Their intimidating presence is often enough to ward off would-be thieves before a fight even begins.",
      strength: 3,
      agility: 3,
      health: 3,
      perception: 3,
      quickness: 3,
      willpower: 2,
      intelligence: 1,
      manualdex: 0,
      charisma: 0,
      base_move: 30,
      base_run: 45,
      special: "Applies Frightened condition. Willpower check (TN 10).",
      attacks: [
        {
          name: "Bite",
          skill: 4,
          damage: 4,
          minDamage: 0,
          special: ""
        }
      ]
    },

    large_pet_dog: {
      type: "Large Pet Dog",
      details: "Loyal, friendly, and protective, large pet dogs like Labradors, Golden Retrievers, or mixed-breed mutts are common companions across towns and homesteads. Though not trained for battle, their bark may ward off intruders and their presence brings comfort. With basic training, they can follow commands, retrieve items, or guard an area. If treated with kindness, theyll follow their owner anywheresometimes even into danger.",
      strength: 3,
      agility: 2,
      health: 2,
      perception: 2,
      quickness: 3,
      willpower: 2,
      intelligence: 1,
      manualdex: 0,
      charisma: 0,
      base_move: 30,
      base_run: 45,
      attacks: [
        {
          name: "Bite",
          skill: 3,
          damage: 4,
          minDamage: 0,
          special: ""
        }
      ]
    },

    small_pet_dog: {
      type: "Small Pet Dog",
      details: "Small pet dogslike terriers, pugs, or chihuahuasare beloved for their loyalty, big personalities, and surprising awareness of their surroundings. Though not strong or dangerous in a fight, they make excellent early-warning systems and steadfast companions. Their barking can foil sneaky intruders, and their alertness makes them ideal for guarding camps, homes, or wagons at night. Treated well, theyll fearlessly stand up to threats many times their size.",
      strength: 1,
      agility: 3,
      health: 2,
      perception: 2,
      quickness: 4,
      willpower: 2,
      intelligence: 1,
      manualdex: 0,
      charisma: 0,
      base_move: 25,
      base_run: 35,
      attacks: [
        {
          name: "Bite",
          skill: 2,
          damage: 2,
          minDamage: 0,
          special: ""
        }
      ]
    },

    police_dog: {
      type: "Police Dog",
      details: "Trained for obedience, detection, and controlled aggression, police dogs are elite canines used by law enforcement and security forces. Typically German Shepherds, Belgian Malinois, or similar breeds, they are intelligent, disciplined, and fearless. Police dogs can detect drugs, explosives, or fugitives with uncanny precision, and subdue threats without lethal force. Loyal to their handlers and relentless in pursuit, they are both partner and weapon. Their presence alone can deter resistanceand when commanded, they strike with precision.",
      strength: 3,
      agility: 4,
      health: 3,
      perception: 4,
      quickness: 4,
      willpower: 3,
      intelligence: 2,
      manualdex: 0,
      charisma: 0,
      base_move: 35,
      base_run: 50,
      special: "Applies Frightened condition. Willpower check (TN 10).",
      attacks: [
        {
          name: "Bite",
          skill: 5,
          damage: 5,
          minDamage: 0,
          special: "Grapple Attack"
        }
      ]
    },

    rescue_dog: {
      type: "Rescue Dog",
      details: "Bred and trained for lifesaving work, rescue dogs excel in avalanche zones, disaster sites, and wilderness search operations. St. Bernards, Newfoundlands, and similar breeds use their strength, endurance, and keen noses to locate trapped or lost individuals. Unlike guard or police dogs, rescue dogs are non-aggressive  their focus is comfort, loyalty, and recovery. Their presence inspires hope as much as their skills save lives.",
      strength: 4,
      agility: 2,
      health: 3,
      perception: 4,
      quickness: 4,
      willpower: 3,
      intelligence: 2,
      manualdex: 0,
      charisma: 0,
      base_move: 30,
      base_run: 45,
      special: "",
      skills: [
        { name: "Survival", skill: 4 }
      ],
      attacks: [
        {
          name: "Bite",
          skill: 2,
          damage: 3,
          minDamage: 0,
          special: ""
        }
      ]
    },
    // Livestock
    cow: {
      type: "Cow",
      details: "A slow, placid herd animal raised for milk, meat, and hides. Cows are generally docile and prefer to flee rather than fight, though they can lash out with a kick if cornered or startled. Their bulk makes them resilient but not agile, and they are poorly suited for travel or combat. Common on ranches and farms, cows are more valuable as resources than companions, though their presence often defines the frontier landscape.",
      strength: 5,
      agility: 1,
      quickness: 1,
      health: 3,
      perception: 1,
      willpower: 1,
      intelligence: 0,
      manualdex: 0,
      charisma: 0,
      base_move: 20,
      base_run: 40,
      attacks: [
        {
          name: "Kick",
          skill: 3,
          damage: 4,
          minDamage: 1,
          special: "Knockout Attack"
        }
      ]
    },

    bison: {
      type: "Bison",
      details: "Massive and shaggy, bison are iconic herd animals of the plains. They roam in great numbers, grazing peacefully, but can become dangerously aggressive when threatened or provoked. A charging bison can smash through riders, wagons, or predators with unstoppable force, using its sheer bulk and horns to devastating effect. Despite their size, bison are surprisingly fast and resilient, making them difficult to bring down once enraged.",
      strength: 6,
      agility: 1,
      quickness: 1,
      health: 4,
      perception: 2,
      willpower: 2,
      intelligence: 0,
      manualdex: 0,
      charisma: 0,
      base_move: 25,
      base_run: 40,
      attacks: [
        {
          name: "Charge",
          skill: 6,
          damage: 7,
          minDamage: 1,
          special: "Knockout Attack, Prone Attack"
        }
      ]
    },

    goat: {
      type: "Goat",
      details: "Hardy, nimble, and stubborn, goats are common livestock known for their ability to traverse steep or rocky terrain with ease. Theyre naturally curious, often chewing on anything within reachincluding gear, clothing, and important documents. Though not aggressive, a goat may butt or kick when startled or asserting dominance.",
      strength: 3,
      agility: 3,
      quickness: 3,
      health: 2,
      perception: 2,
      willpower: 2,
      intelligence: 1,
      manualdex: 0,
      charisma: 0,
      base_move: 25,
      base_run: 35,
      attacks: [
        {
          name: "Headbutt",
          skill: 3,
          damage: 3,
          minDamage: 1,
          special: "Prone Attack"
        }
      ]
    },

    pig: {
      type: "Pig",
      details: "Domesticated and widespread, pigs are intelligent, hardy animals valued for meat and hides. On farms, they are generally docile and curious, rooting through soil for food with their strong snouts. However, when startled or defending their young, pigs can become aggressive  charging with surprising speed and using their tusks to bite or gore.",
      strength: 4,
      agility: 2,
      quickness: 3,
      health: 3,
      perception: 2,
      willpower: 2,
      intelligence: 1,
      manualdex: 0,
      charisma: 0,
      base_move: 20,
      base_run: 30,
      attacks: [
        {
          name: "Bite",
          skill: 3,
          damage: 4,
          minDamage: 1,
          special: ""
        },
        {
          name: "Charge",
          skill: 4,
          damage: 5,
          minDamage: 1,
          special: "Push Attack"
        }
      ]
    },

    sheep: {
      type: "Sheep",
      details: "Woolly, timid, and highly social, sheep are among the most common livestock in pastoral and frontier communities. They provide wool, meat, and milk, but rely heavily on herding instincts and protection from shepherds or dogs. Naturally skittish, sheep tend to panic and flee at sudden noises or threats, moving as a flock. A startled ram may lower its head and charge.",
      strength: 2,
      agility: 2,
      quickness: 3,
      health: 2,
      perception: 2,
      willpower: 2,
      intelligence: 0,
      manualdex: 0,
      charisma: 0,
      base_move: 20,
      base_run: 30,
      attacks: [
        {
          name: "Headbutt",
          skill: 3,
          damage: 3,
          minDamage: 1,
          special: "Prone Attack"
        }
      ]
    },
    // Insects
    scorpion: {
      type: "Scorpion",
      details: "Armored and menacing, scorpions are nocturnal predators found in deserts, caves, and ruins. They rely on stealth, crawling silently until they strike with pincers to grasp prey and a venomous stinger to deliver a crippling blow. Though small compared to larger beasts, their venom makes them disproportionately dangerous. Most species are no larger than a hand, but in RPGs, both mundane and giant-sized scorpions may appear as threats. Their presence often symbolizes danger lurking unseen, waiting for the careless to stumble too close.",
      strength: 2,
      agility: 3,
      health: 2,
      perception: 3,
      quickness: 4,
      willpower: 2,
      intelligence: 0,
      manualdex: 0,
      charisma: 0,
      base_move: 15,
      base_run: 25,
      attacks: [
        {
          name: "Sting",
          skill: 3,
          damage: 3,
          minDamage: 0,
          special: "Poison Attack (TN 15)"
        }
      ]
    },

    venomous_spider: {
      type: "Venomous Spider",
      details: "Creeping in shadows and tight spaces, venomous spiders range from palm-sized hunters to larger, more menacing species. They rely on stealth and patience, lurking in webs, burrows, or dark corners until prey wanders too close. Their bite delivers potent venom, which may paralyze, weaken, or kill depending on the species. Though fragile in direct combat, spiders use surprise and poison to deadly effect. In RPGs, they serve as unsettling hazards in caves, ruins, and villain lairs, where even a small bite can sow panic among adventurers.",
      strength: 1,
      agility: 4,
      health: 1,
      perception: 3,
      quickness: 5,
      willpower: 1,
      intelligence: 0,
      manualdex: 0,
      charisma: 0,
      base_move: 15,
      base_run: 25,
      attacks: [
        {
          name: "Bite",
          skill: 3,
          damage: 2,
          minDamage: 0,
          special: "Poison Attack (TN 15)"
        }
      ]
    },

    // Cats
    cheetah: {
      type: "Cheetah",
      details: "The fastest land animal, the cheetah is built for bursts of incredible speed rather than endurance. Sleek and graceful, it stalks prey with patience before exploding into a lightning-fast sprint to bring it down. Unlike lions or tigers, cheetahs avoid direct conflict, relying on their agility and precision rather than brute strength.",
      strength: 5,
      agility: 5,
      health: 3,
      perception: 3,
      quickness: 5,
      willpower: 2,
      intelligence: 2,
      manualdex: 0,
      charisma: 0,
      base_move: 50,
      base_run: 80,
      attacks: [
        { name: "Claw", skill: 5, damage: 5, minDamage: 0, special: "" },
        { name: "Pounce", skill: 5, damage: 5, minDamage: 0, special: "Grapple Attack" }
      ]
    },

    house_cat: {
      type: "House Cat",
      details: "Independent and agile, the common house cat is a quiet observer of its domain. It slips through tight spaces, perches in high places, and often seems to vanish at will. Though generally disinterested in human affairs, cats are quick to react to sudden movements and unfamiliar sounds.",
      strength: 1,
      agility: 3,
      health: 1,
      perception: 3,
      quickness: 3,
      willpower: 1,
      intelligence: 1,
      manualdex: 0,
      charisma: 0,
      base_move: 25,
      base_run: 40,
      attacks: [
        { name: "Scratch", skill: 2, damage: 1, minDamage: 0, special: "" }
      ]
    },

    lion: {
      type: "Lion",
      details: "The lion is a powerful apex predator, known for its majestic mane and commanding roar. Lions are both feared and reveredsymbols of strength, dominance, and danger. When agitated or hungry, they are swift to act with claws and fangs, making them a dire threat in close quarters.",
      strength: 6,
      agility: 3,
      health: 4,
      perception: 3,
      quickness: 4,
      willpower: 2,
      intelligence: 2,
      manualdex: 0,
      charisma: 0,
      base_move: 35,
      base_run: 55,
      special: "Applies Frightened condition. Willpower check (TN 15).",
      attacks: [
        { name: "Claw", skill: 5, damage: 6, minDamage: 0, special: "" },
        { name: "Bite", skill: 4, damage: 7, minDamage: 0, special: "" },
        { name: "Pounce", skill: 5, damage: 6, minDamage: 0, special: "Grapple Attack" }
      ]
    },

    mountain_lion: {
      type: "Mountain Lion",
      details: "A solitary and stealthy predator, the mountain lion is a master of ambush. It strikes from cover with sudden leaps, using powerful claws and fangs to drag prey to the ground. Fiercely territorial, it avoids humans when possible, but will attack if provoked or cornered.",
      strength: 4,
      agility: 4,
      health: 2,
      perception: 3,
      quickness: 4,
      willpower: 2,
      intelligence: 1,
      manualdex: 0,
      charisma: 0,
      base_move: 35,
      base_run: 55,
      special: "Applies Frightened condition. Willpower check (TN 10).",
      attacks: [
        { name: "Claw", skill: 5, damage: 5, minDamage: 0, special: "" },
        { name: "Pounce", skill: 5, damage: 6, minDamage: 0, special: "Grapple Attack" }
      ]
    },

    tiger: {
      type: "Tiger",
      details: "The tiger is the largest of the big cats, known for its immense strength, lightning-fast reflexes, and striped camouflage. Tigers hunt alone, stalking prey with eerie silence before striking with overwhelming force.",
      strength: 7,
      agility: 3,
      health: 4,
      perception: 3,
      quickness: 4,
      willpower: 3,
      intelligence: 2,
      manualdex: 0,
      charisma: 0,
      base_move: 35,
      base_run: 55,
      special: "Applies Frightened condition. Willpower check (TN 15).",
      attacks: [
        { name: "Claw", skill: 6, damage: 6, minDamage: 0, special: "" },
        { name: "Bite", skill: 5, damage: 7, minDamage: 0, special: "" },
        { name: "Pounce", skill: 6, damage: 6, minDamage: 0, special: "Grapple Attack" }
      ]
    },

    // Snakes & Reptiles
    alligator: {
      type: "Alligator",
      details: "Powerful and patient, the alligator is a semi-aquatic ambush predator. It lurks in swamps, rivers, and bayousstill as driftwood until it strikes with explosive speed.",
      strength: 6,
      agility: 1,
      health: 5,
      perception: 3,
      quickness: 1,
      willpower: 2,
      intelligence: 0,
      manualdex: 0,
      charisma: 0,
      base_move: 15,
      base_run: 35,
      attacks: [
        { name: "Bite", skill: 5, damage: 6, minDamage: 0, special: "Grapple Attack" }
      ]
    },

    black_mamba: {
      type: "Black Mamba",
      details: "One of the deadliest snakes in the world, the Black Mamba is fast, aggressive when cornered, and extremely venomous. Its bite delivers a neurotoxin that can incapacitate a person within minutes.",
      strength: 1,
      agility: 4,
      health: 2,
      perception: 3,
      quickness: 5,
      willpower: 2,
      intelligence: 0,
      manualdex: 0,
      charisma: 0,
      base_move: 30,
      base_run: 35,
      special: "Applies Frightened condition. Willpower check (TN 10).",
      attacks: [
        { name: "Bite", skill: 4, damage: 4, minDamage: 0, special: "Poison Attack (TN 20)" }
      ]
    },

    cobra: {
      type: "Cobra",
      details: "Sleek and intimidating, cobras are venomous snakes recognized by their dramatic hood display when threatened. They use this display to ward off attackers, but will strike with lightning speed if provoked.",
      strength: 1,
      agility: 4,
      health: 2,
      perception: 3,
      quickness: 5,
      willpower: 2,
      intelligence: 0,
      manualdex: 0,
      charisma: 0,
      base_move: 20,
      base_run: 30,
      special: "Applies Frightened condition. Willpower check (TN 10).",
      attacks: [
        { name: "Bite", skill: 4, damage: 4, minDamage: 0, special: "Poison Attack (TN 15)" }
      ]
    },

    crocodile: {
      type: "Crocodile",
      details: "Ancient and fearsome, crocodiles are apex predators of rivers, swamps, and deltas. Larger and more aggressive than their alligator cousins, they strike with explosive power, dragging prey underwater in a deadly death roll.",
      strength: 7,
      agility: 1,
      health: 6,
      perception: 3,
      quickness: 2,
      willpower: 3,
      intelligence: 0,
      manualdex: 0,
      charisma: 0,
      base_move: 15,
      base_run: 35,
      attacks: [
        { name: "Bite", skill: 6, damage: 7, minDamage: 0, special: "Grapple Attack" }
      ]
    },

    python: {
      type: "Python",
      details: "Pythons are large, non-venomous constrictor snakes that rely on stealth and strength. They ambush prey with sudden strikes and coil tightly to suffocate their target.",
      strength: 4,
      agility: 2,
      health: 4,
      perception: 2,
      quickness: 1,
      willpower: 1,
      intelligence: 0,
      manualdex: 0,
      charisma: 0,
      base_move: 10,
      base_run: 10,
      attacks: [
        { name: "Constrict", skill: 5, damage: 6, minDamage: 0, special: "Grapple Attack" }
      ]
    },

    rattlesnake: {
      type: "Rattlesnake",
      details: "A venomous serpent common to arid regions and grasslands, easily identified by the distinctive rattle at the end of its tail. Rattlesnakes prefer to avoid confrontation, warning threats away with their rattle, but will strike with deadly speed if cornered or startled.",
      strength: 1,
      agility: 3,
      health: 2,
      perception: 2,
      quickness: 5,
      willpower: 1,
      intelligence: 0,
      manualdex: 0,
      charisma: 0,
      base_move: 20,
      base_run: 20,
      special: "Applies Frightened condition. Willpower check (TN 10).",
      attacks: [
        { name: "Bite", skill: 3, damage: 4, minDamage: 0, special: "Poison Attack (TN 15)" }
      ]
    },

    // Sea Creatures
    jellyfish: {
      type: "Jellyfish",
      details: "Drifting silently with the currents, jellyfish are more hazard than predator. Their translucent bodies conceal long, stinging tentacles that deliver venom painful enough to incapacitate or even kill the unwary.",
      strength: 0,
      agility: 1,
      health: 1,
      perception: 1,
      quickness: 3,
      willpower: 0,
      intelligence: 0,
      manualdex: 0,
      charisma: 0,
      base_move: 10,
      base_run: 10,
      special: "Does not attack, but if touched applies damage and poison.",
      attacks: [
        { name: "Touch", skill: 0, damage: 1, minDamage: 0, special: "Poison Attack (TN 10)" }
      ]
    },

    orca: {
      type: "Orca",
      details: "Intelligent, powerful, and social hunters, orcas are apex predators of the ocean. They hunt in pods, working together to trap prey, ram boats, or drag victims beneath the surface.",
      strength: 9,
      agility: 3,
      health: 7,
      perception: 3,
      quickness: 3,
      willpower: 4,
      intelligence: 3,
      manualdex: 0,
      charisma: 0,
      base_move: 40,
      base_run: 40,
      attacks: [
        { name: "Bite", skill: 6, damage: 8, minDamage: 0, special: "" },
        { name: "Charge", skill: 6, damage: 7, minDamage: 0, special: "Push Attack" }
      ]
    },

    piranha_swarm: {
      type: "Piranha Swarm",
      details: "Small, aggressive freshwater fish, piranhas are relatively harmless alone but terrifying in numbers. They attack in frenzied schools, stripping flesh in moments with their razor-edged teeth.",
      strength: 1,
      agility: 3,
      health: 1,
      perception: 3,
      quickness: 5,
      willpower: 1,
      intelligence: 0,
      manualdex: 0,
      charisma: 0,
      base_move: 20,
      base_run: 20,
      attacks: [
        { name: "Swarm Bite", skill: 8, damage: 3, minDamage: 0, special: "" }
      ]
    },

    shark: {
      type: "Shark",
      details: "Silent hunters of the deep, sharks strike fear into anyone who ventures into their waters. Their sleek bodies and powerful tails propel them with speed and agility, while rows of razor-sharp teeth deliver devastating bites.",
      strength: 6,
      agility: 3,
      health: 5,
      perception: 3,
      quickness: 3,
      willpower: 2,
      intelligence: 0,
      manualdex: 0,
      charisma: 0,
      base_move: 40,
      base_run: 40,
      special: "Applies Frightened condition. Willpower check (TN 15).",
      attacks: [
        { name: "Bite", skill: 5, damage: 7, minDamage: 0, special: "Grapple Attack" }
      ]
    }

  };

  const ITEMS = {
    sedan: {
      name: "Sedan",
      qty: 1,
      weight: 3000,
      location: "storage",
      description: "A basic passenger car.",
      cost: "$12,000"
    },

    modest_home: {
      name: "Modest Home",
      qty: 1,
      weight: 100000,
      location: "storage",
      description: "This can be a basic apartment, townhouse, or small detached home.",
      cost: "$180,000"
    },

    smartphone: {
      name: "Smartphone",
      qty: 1,
      weight: 1,
      location: "equipped",
      description: "Phone, camera, data, GPS.",
      cost: "$600"
    },

    hatchback: {
      name: "Hatchback",
      qty: 1,
      weight: 2600,
      location: "storage",
      description: "A lower-end economy car.",
      cost: "$9,000"
    },

    upscale_home: {
      name: "Upscale Home",
      qty: 1,
      weight: 300000,
      location: "storage",
      description: "A large multi-bedroom house, or a penthouse apartment.",
      cost: "$750,000"
    },

    luxury_sedan: {
      name: "Luxury Sedan",
      qty: 1,
      weight: 5000,
      location: "storage",
      description: "A premium high-performance vehicle offering comfort and power.",
      cost: "$55,000"
    },

    pistol: {
      name: "Pistol",
      qty: 1,
      weight: 2,
      location: "equipped",
      description: "Standard 15 round sidearm.",
      cost: "$500"
    },

    suv: {
      name: "SUV",
      qty: 1,
      weight: 5500,
      location: "storage",
      description: "Large passenger vehicle, capable of off-road travel, with high clearance and ample cargo space.",
      cost: "$35,000"
    },

    laptop: {
      name: "Laptop",
      qty: 1,
      weight: 4,
      location: "equipped",
      description: "Portable computer.",
      cost: "$1,200"
    },

    no_fixed_address: {
      name: "No Fixed Address",
      qty: 1,
      weight: 0,
      location: "storage",
      description: "You rarely stay in one place, preferring hotels or motels over a permanent residence.",
      cost: "$0"
    },

    shared_apartment: {
      name: "Shared Apartment",
      qty: 1,
      weight: 50000,
      location: "storage",
      description: "You share a place with roommates, offering little in the way of privacy.",
      cost: "$1,200/month"
    },

    desktop_computer: {
      name: "Desktop Computer",
      qty: 1,
      weight: 30,
      location: "storage",
      description: "A non-portable computer including monitors.",
      cost: "$900"
    },

    burner_phone: {
      name: "Burner Phone",
      qty: 1,
      weight: 3,
      location: "equipped",
      description: "Cheap, prepaid phone with limited features, often used anonymously and discarded after short-term use.",
      cost: "$40"
    },

    sportscar: {
      name: "Sports Car",
      qty: 1,
      weight: 3800,
      location: "storage",
      description: "Fast, stylish two-door vehicle built for speed and handling, not comfort or cargo.",
      cost: "$30,000"
    },

    bicycle: {
      name: "Bicycle",
      qty: 1,
      weight: 30,
      location: "storage",
      description: "Lightweight, two-wheeled vehicle powered by pedaling; ideal for quiet, fast travel with no fuel required.",
      cost: "$500"
    },

    motorcycle: {
      name: "Street Bike",
      qty: 1,
      weight: 500,
      location: "storage",
      description: "Fast and reckless road motorcycle.",
      cost: "$6,000"
    },

    four_seat_plane: {
      name: "Four-Seat Plane",
      qty: 1,
      weight: 1800,
      location: "storage",
      description: "Small aircraft with limited cargo space, used for personal travel or light transport; short range, high speed.",
      cost: "$250,000"
    },

    compound: {
      name: "Compound",
      qty: 1,
      weight: 130000,
      location: "storage",
      description: "You live in a secured compoundgang hideout or cartel basewhere space is shared and movement is often restricted.",
      cost: "$2,500,000"
    },

    truck: {
      name: "Pickup Truck",
      qty: 1,
      weight: 5000,
      location: "storage",
      description: "Large, powerful vehicle built for hauling cargo or equipment; durable, with off-road and towing capability.",
      cost: "$45,000"
    },

    toolbox: {
      name: "Toolbox",
      qty: 1,
      weight: 20,
      location: "equipped",
      description: "A sturdy case filled with essential hand tools for repairs, maintenance, or emergencies; compact but heavy.",
      cost: "$150"
    },

    red_stapler: {
      name: "Red Stapler",
      qty: 1,
      weight: 1,
      location: "equipped",
      description: "A highly coveted piece of office equipment.",
      cost: "$12"
    },

    small_apartment: {
      name: "Small Apartment",
      qty: 1,
      weight: 60000,
      location: "storage",
      description: "A one or two bedroom apartment with a single bath. Not luxury, but livable.",
      cost: "$100,000"
    },

    barracks: {
      name: "Barracks",
      qty: 1,
      weight: 120000,
      location: "storage",
      description: "A military housing unit.",
      cost: "$0"
    },

    fishing_boat: {
      name: "Fishing Boat",
      qty: 1,
      weight: 2000,
      location: "storage",
      description: "A small motorized watercraft used for travel or fishing.",
      cost: "$12,000"
    },

    sniper_rifle: {
      name: "Sniper Rifle",
      qty: 1,
      weight: 15,
      location: "equipped",
      description: "High-powered, long-range firearm with precision optics; designed for accuracy over distance, not close combat.",
      cost: "$2,000"
    },

    assault_rifle: {
      name: "Assault Rifle",
      qty: 1,
      weight: 9,
      location: "equipped",
      description: "Selective-fire rifle chambered for intermediate cartridges. Reliable at medium to long ranges, commonly used by military forces worldwide.",
      cost: "$1,500"
    },

    bow: {
      name: "Bow",
      qty: 1,
      weight: 2,
      location: "equipped",
      description: "Traditional ranged weapon using tensioned limbs and string to launch arrows. Silent, reliable, and effective at medium range.",
      cost: "$150"
    },

    camping_gear: {
      name: "Camping Gear",
      qty: 1,
      weight: 12,
      location: "storage",
      description: "A basic kit with tent, sleeping bag, mess kit, and fire-starting tools. Provides shelter and essentials for outdoor living.",
      cost: "$200"
    },

    cosplay_outfits: {
      name: "Cosplay Outfits",
      qty: 1,
      weight: 10,
      location: "storage",
      description: "An assortment of character costumes and accessories. Flashy, recognizable, and often bulky  ideal for conventions or themed events.",
      cost: "$300"
    },

    civilian_drone: {
      name: "Civilian Drone",
      qty: 1,
      weight: 3,
      location: "storage",
      description: "Small quadcopter drone with camera, rechargeable batteries, and remote control. Useful for short-range scouting or recreational flight.",
      cost: "$500"
    },

    hunting_rifle: {
      name: "Hunting Rifle",
      qty: 1,
      weight: 7,
      location: "storage",
      description: "Bolt-action rifle chambered for common hunting calibers. Accurate and effective at long range, commonly used for big game.",
      cost: "$800"
    },

    lockpick_set: {
      name: "Lockpick Set",
      qty: 1,
      weight: 1,
      location: "equipped",
      description: "A compact pouch of tension wrenches and picks for bypassing simple locks. Illegal to possess without proper authorization.",
      cost: "$100"
    },

    scuba_kit: {
      name: "SCUBA Kit",
      qty: 1,
      weight: 35,
      location: "storage",
      description: "Self-contained underwater breathing apparatus with tank, regulator, mask, fins, and wetsuit. Provides about an hour of dive time under normal conditions.",
      cost: "$1,200"
    },

    sports_gear: {
      name: "Sports Gear",
      qty: 1,
      weight: 6,
      location: "storage",
      description: "A bag of athletic equipment such as shoes, pads, balls, or a racket. Represents the essentials for casual play or training in a chosen sport.",
      cost: "$150"
    },

    semi_truck: {
      name: "Semi Truck",
      qty: 1,
      weight: 18000,
      location: "storage",
      description: "A heavy-duty tractor unit capable of hauling large trailers. Common in freight transport, powerful but difficult to maneuver in tight spaces.",
      cost: "$120,000"
    },

    magic_kit: {
      name: "Magic Kit",
      qty: 1,
      weight: 4,
      location: "equipped",
      description: "A case of props for performing illusions and sleight-of-hand tricks. Includes cards, coins, scarves, a wand, and secret gimmicks.",
      cost: "$75"
    },

    tonfa: {
      name: "Tonfa",
      qty: 1,
      weight: 2,
      location: "equipped",
      description: "A hardwood side-handled baton, traditionally used in martial arts and adapted for law enforcement. Effective for blocks, joint locks, and close combat strikes.",
      cost: "$50"
    },

    medical_bag: {
      name: "Medical Bag",
      qty: 1,
      weight: 6,
      location: "equipped",
      description: "A stocked first-aid kit with bandages, antiseptics, splints, gloves, and basic instruments. Suitable for treating common injuries but not a full surgical kit.",
      cost: "$250"
    },

    handcuffs: {
      name: "Handcuffs",
      qty: 1,
      weight: 1,
      location: "carried",
      description: "Standard metal restraints with a locking mechanism and chain links. Used by law enforcement to detain individuals; requires a key or skill to remove.",
      cost: "$30"
    },

  };

  const BACKGROUND_DETAILS = {
    "Accountant": {
      details: "+2D Knowledge\nSpecialized: Appraisal\n+2 Wealth",
      cash: "$400.00",
      items: [
        ITEMS.sedan,
        ITEMS.modest_home,
        ITEMS.smartphone,
        ITEMS.laptop,
        ITEMS.desktop_computer
      ]
    },

    "Activist": {
      details: "+2D Social\nSpecialized: Persuade",
      cash: "$30.00",
      items: [
        ITEMS.bicycle,
        ITEMS.shared_apartment,
        ITEMS.smartphone,
        ITEMS.laptop
      ]
    },

    "Air Force Pilot": {
      details: "+2D Aviation\nActivate: Any locked Aviation skill\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.truck,
        ITEMS.barracks,
        ITEMS.smartphone
      ]
    },

    "Air Smuggler": {
      details: "+2D Aviation\nActivate: Any locked Aviation skill\n+2 Wealth",
      cash: "$400.00",
      items: [
        ITEMS.suv,
        ITEMS.four_seat_plane,
        ITEMS.no_fixed_address,
        ITEMS.smartphone,
        ITEMS.burner_phone,
        ITEMS.pistol
      ]
    },

    "Army": {
      details: "+2D Longarms\n+1D Sidearms\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.truck,
        ITEMS.barracks,
        ITEMS.smartphone,
        ITEMS.pistol
      ]
    },

    "Bartender": {
      details: "+2D Social\nSpecialized: Seduce\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.hatchback,
        ITEMS.shared_apartment,
        ITEMS.smartphone
      ]
    },

    "Bounty Hunter": {
      details: "+2D Investigation\nSpecialized: Tracking\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.truck,
        ITEMS.modest_home,
        ITEMS.smartphone,
        ITEMS.pistol,
        ITEMS.handcuffs
      ]
    },

    "Bureaucrat": {
      details: "+2D Social\nSpecialized: Bureaucracy\n+2 Wealth",
      cash: "$400.00",
      items: [
        ITEMS.sedan,
        ITEMS.modest_home,
        ITEMS.smartphone
      ]
    },

    "Biker": {
      details: "+2D Unarmed\nSpecialized: Intimidation\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.motorcycle,
        ITEMS.compound,
        ITEMS.smartphone,
        ITEMS.burner_phone,
        ITEMS.pistol
      ]
    },

    "Bodyguard": {
      details: "+2D Unarmed\nSpecialized: Wrestling\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.suv,
        ITEMS.small_apartment,
        ITEMS.smartphone,
        ITEMS.pistol
      ]
    },

    "C-Level Executive": {
      details: "+2D Social\n+1D Performance\n+3 Wealth",
      cash: "$1000.00",
      items: [
        ITEMS.luxury_sedan,
        ITEMS.upscale_home,
        ITEMS.smartphone,
        ITEMS.laptop,
        ITEMS.desktop_computer
      ]
    },
    "Cartel Member": {
      details: "+2D Sidearms\nSpecialized: Handgun\n+3 Wealth",
      cash: "$1000.00",
      items: [
        ITEMS.suv,
        ITEMS.compound,
        ITEMS.smartphone,
        ITEMS.burner_phone,
        ITEMS.pistol
      ]
    },

    "Government Agent": {
      details: "+2D Investigation\n+1D Sidearms\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.sedan,
        ITEMS.modest_home,
        ITEMS.smartphone,
        ITEMS.pistol
      ]
    },

    "Government Analyst": {
      details: "+2D Knowledge\nSpecialized: Investigate\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.sedan,
        ITEMS.modest_home,
        ITEMS.smartphone,
        ITEMS.pistol
      ]
    },

    "Government Operative": {
      details: "+2D Military Training\nActivate: Spycraft\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.sedan,
        ITEMS.modest_home,
        ITEMS.smartphone,
        ITEMS.pistol
      ]
    },

    "Close Quarters Assassin": {
      details: "+2D Unarmed\nActivate: One martial art\n+3 Wealth",
      cash: "$1000.00",
      items: [
        ITEMS.motorcycle,
        ITEMS.no_fixed_address,
        ITEMS.smartphone,
        ITEMS.pistol
      ]
    },

    "Coroner": {
      details: "+2D Investigation\nActivate: Forensics\n+2 Wealth",
      cash: "$400.00",
      items: [
        ITEMS.luxury_sedan,
        ITEMS.upscale_home,
        ITEMS.smartphone,
        ITEMS.medical_bag
      ]
    },

    "Corp Scientist": {
      details: "+2D Knowledge\nActivate: Any science skill\n+2 Wealth",
      cash: "$400.00",
      items: [
        ITEMS.luxury_sedan,
        ITEMS.upscale_home,
        ITEMS.smartphone,
        ITEMS.desktop_computer
      ]
    },

    "Diver": {
      details: "+2D Nautical\nActivate: Diving\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.truck,
        ITEMS.small_apartment,
        ITEMS.smartphone,
        ITEMS.scuba_kit
      ]
    },

    "Doctor": {
      details: "+2D Medical\nActivate: Surgery\n+3 Wealth",
      cash: "$1000.00",
      items: [
        ITEMS.luxury_sedan,
        ITEMS.upscale_home,
        ITEMS.smartphone,
        ITEMS.medical_bag
      ]
    },

    "Engineer": {
      details: "+2D Knowledge\nActivate: Engineering\n+2 Wealth",
      cash: "$400.00",
      items: [
        ITEMS.suv,
        ITEMS.modest_home,
        ITEMS.smartphone,
        ITEMS.toolbox
      ]
    },

    "Entrepreneur": {
      details: "+2D Social\nActivate: Any science skill\n+3 Wealth",
      cash: "$1000.00",
      items: [
        ITEMS.luxury_sedan,
        ITEMS.upscale_home,
        ITEMS.smartphone
      ]
    },

    "EOD Tech": {
      details: "+2D Technical\nSpecialized: Explosives\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.truck,
        ITEMS.barracks,
        ITEMS.smartphone
      ]
    },

    "Famous Artist": {
      details: "+2D Performance\nSpecialized: Any Performance skill\n+3 Wealth",
      cash: "$1000.00",
      items: [
        ITEMS.sportscar,
        ITEMS.upscale_home,
        ITEMS.smartphone
      ]
    },

    "Farmer": {
      details: "+2D Physical\n+1D Animal\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.truck,
        ITEMS.modest_home,
        ITEMS.smartphone,
        ITEMS.toolbox
      ]
    },

    "Firefighter": {
      details: "+2D Technical\n+1D Driving\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.truck,
        ITEMS.modest_home,
        ITEMS.smartphone,
        ITEMS.toolbox
      ]
    },

    "Fisherman": {
      details: "+2D Nautical\nSpecialized: Drive Boat\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.truck,
        ITEMS.fishing_boat,
        ITEMS.modest_home,
        ITEMS.smartphone,
        ITEMS.toolbox
      ]
    },

    "Gambler": {
      details: "+2D Social\nSpecialized: Gambling",
      cash: "$1000.00",
      items: [
        ITEMS.luxury_sedan,
        ITEMS.no_fixed_address,
        ITEMS.smartphone
      ]
    },

    "Gangbanger": {
      details: "+2D Sidearms\n+1D Thievery\n+1 Wealth",
      cash: "$1000.00",
      items: [
        ITEMS.suv,
        ITEMS.compound,
        ITEMS.smartphone,
        ITEMS.burner_phone,
        ITEMS.pistol
      ]
    },

    "Getaway Driver": {
      details: "+2D Driving\n+1D Thievery\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.sportscar,
        ITEMS.small_apartment,
        ITEMS.smartphone,
        ITEMS.burner_phone,
        ITEMS.pistol
      ]
    },

    "Grifter": {
      details: "+2D Social\nSpecialized: Deception",
      cash: "$150.00",
      items: [
        ITEMS.sedan,
        ITEMS.no_fixed_address,
        ITEMS.smartphone,
        ITEMS.burner_phone
      ]
    },

    "Homeless": {
      details: "+2D Survival\n+1D Stealth",
      cash: "$5.00",
      items: [
        ITEMS.no_fixed_address
      ]
    },

    "Influencer": {
      details: "+2D Social\n+1D Computers\n+2 Wealth",
      cash: "$400.00",
      items: [
        ITEMS.sportscar,
        ITEMS.upscale_home,
        ITEMS.smartphone,
        ITEMS.laptop
      ]
    },

    "Interrogator": {
      details: "+2D Investigation\nSpecialized: Interrogation\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.sedan,
        ITEMS.modest_home,
        ITEMS.smartphone,
        ITEMS.laptop
      ]
    },

    "IT Specialist": {
      details: "+2D Computers\nActivate: Programming\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.hatchback,
        ITEMS.small_apartment,
        ITEMS.smartphone,
        ITEMS.laptop,
        ITEMS.desktop_computer
      ]
    },

    "Journalist": {
      details: "+2D Awareness\n+1D Investigation\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.sedan,
        ITEMS.modest_home,
        ITEMS.smartphone,
        ITEMS.laptop
      ]
    },

    "Lawyer": {
      details: "+2D Knowledge\nActivate: Law\n+3 Wealth",
      cash: "$1000.00",
      items: [
        ITEMS.luxury_sedan,
        ITEMS.upscale_home,
        ITEMS.smartphone,
        ITEMS.laptop
      ]
    },

    "Long-Range Assassin": {
      details: "+2D Longarms\nSpecialized: Sniper Rifle\n+3 Wealth",
      cash: "$1000.00",
      items: [
        ITEMS.suv,
        ITEMS.no_fixed_address,
        ITEMS.smartphone,
        ITEMS.sniper_rifle
      ]
    },

    "Mafia": {
      details: "+2D Sidearms\n+1D Thievery\n+3 Wealth",
      cash: "$1000.00",
      items: [
        ITEMS.suv,
        ITEMS.upscale_home,
        ITEMS.smartphone,
        ITEMS.burner_phone,
        ITEMS.pistol
      ]
    },

    "Military Command": {
      details: "+2D Military Training\n+1D Sidearms\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.suv,
        ITEMS.barracks,
        ITEMS.smartphone,
        ITEMS.pistol
      ]
    },

    "Military Sniper": {
      details: "+2D Longarms\nSpecialized: Sniper Rifle\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.suv,
        ITEMS.barracks,
        ITEMS.smartphone,
        ITEMS.sniper_rifle
      ]
    },

    "Negotiator": {
      details: "+2D Social\nSpecialized: Negotiate\n+2 Wealth",
      cash: "$400.00",
      items: [
        ITEMS.luxury_sedan,
        ITEMS.upscale_home,
        ITEMS.smartphone,
        ITEMS.laptop
      ]
    },

    "NSA": {
      details: "+2D Computers\nSpecialized: Surveillance\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.sedan,
        ITEMS.modest_home,
        ITEMS.smartphone,
        ITEMS.laptop,
        ITEMS.desktop_computer
      ]
    },

    "Nurse": {
      details: "+2D Medical\nSpecialized: Medical Care\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.hatchback,
        ITEMS.modest_home,
        ITEMS.smartphone,
        ITEMS.medical_bag
      ]
    },

    "Ocean Smuggler": {
      details: "+2D Nautical\nSpecialized: Hide\n+2 Wealth",
      cash: "$400.00",
      items: [
        ITEMS.suv,
        ITEMS.boat,
        ITEMS.no_fixed_address,
        ITEMS.smartphone,
        ITEMS.burner_phone,
        ITEMS.pistol
      ]
    },

    "Office Worker": {
      details: "+2D Computers\n+1D Social\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.hatchback,
        ITEMS.modest_home,
        ITEMS.smartphone,
        ITEMS.red_stapler
      ]
    },

    "Paramedic": {
      details: "+2D Medical\nSpecialized: First Aid\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.hatchback,
        ITEMS.modest_home,
        ITEMS.smartphone,
        ITEMS.medical_bag
      ]
    },

    "Pharmacist": {
      details: "+2D Medical\nActivate: Pharmacology\n+2 Wealth",
      cash: "$400.00",
      items: [
        ITEMS.sedan,
        ITEMS.modest_home,
        ITEMS.smartphone,
        ITEMS.medical_bag
      ]
    },

    "Pilot": {
      details: "+2D Aviation\nActivate: Fly Plane\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.sedan,
        ITEMS.modest_home,
        ITEMS.smartphone,
        ITEMS.four_seat_plane
      ]
    },

    "Police Detective": {
      details: "+2D Investigation\nSpecialized: Investigate\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.sedan,
        ITEMS.modest_home,
        ITEMS.smartphone,
        ITEMS.pistol,
        ITEMS.handcuffs
      ]
    },

    "Police": {
      details: "+2D Armed\n+1D Sidearms\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.sedan,
        ITEMS.modest_home,
        ITEMS.smartphone,
        ITEMS.pistol,
        ITEMS.tonfa,
        ITEMS.handcuffs
      ]
    },

    "Politician": {
      details: "+2D Social\nSpecialized: Deceive\n+3 Wealth",
      cash: "$1000.00",
      items: [
        ITEMS.luxury_sedan,
        ITEMS.upscale_home,
        ITEMS.smartphone
      ]
    },

    "Priest": {
      details: "+2D Social\n+1D Performance\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.hatchback,
        ITEMS.barracks,
        ITEMS.smartphone
      ]
    },

    "Private Detective": {
      details: "+2D Investigation\nSpecialized: Search\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.sedan,
        ITEMS.small_apartment,
        ITEMS.smartphone,
        ITEMS.laptop,
        ITEMS.pistol
      ]
    },

    "Private Militia": {
      details: "+2D Sidearms\n+1D Longarms\n+2 Wealth",
      cash: "$400.00",
      items: [
        ITEMS.suv,
        ITEMS.no_fixed_address,
        ITEMS.smartphone,
        ITEMS.assault_rifle
      ]
    },

    "Professional Athlete": {
      details: "+2D Physical\nSpecialized: Any Physical skill\n+3 Wealth",
      cash: "$1000.00",
      items: [
        ITEMS.suv,
        ITEMS.upscale_home,
        ITEMS.smartphone,
        ITEMS.sports_gear
      ]
    },

    "Psychiatrist": {
      details: "+2D Medical\nSpecialized: Psychiatry\n+2 Wealth",
      cash: "$400.00",
      items: [
        ITEMS.luxury_sedan,
        ITEMS.upscale_home,
        ITEMS.smartphone,
        ITEMS.laptop
      ]
    },

    "Race Car Driver": {
      details: "+2D Driving\nSpecialized: Driving Car\n+3 Wealth",
      cash: "$1000.00",
      items: [
        ITEMS.sportscar,
        ITEMS.upscale_home,
        ITEMS.smartphone
      ]
    },

    "Residence Manager": {
      details: "+2D Survival\nSpecialized: Cooking",
      cash: "$30.00",
      items: [
        ITEMS.hatchback,
        ITEMS.modest_home,
        ITEMS.smartphone
      ]
    },

    "Retail Worker": {
      details: "+2D Social\nSpecialized: Persuade\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.bicycle,
        ITEMS.shared_apartment,
        ITEMS.smartphone
      ]
    },

    "Security Guard": {
      details: "+2D Awareness\n+1D Armed\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.hatchback,
        ITEMS.small_apartment,
        ITEMS.smartphone,
        ITEMS.tonfa
      ]
    },

    "Spy": {
      details: "+2D Stealth\nActivate: Spycraft\n+2 Wealth",
      cash: "$400.00",
      items: [
        ITEMS.sportscar,
        ITEMS.no_fixed_address,
        ITEMS.smartphone,
        ITEMS.pistol
      ]
    },

    "Stage Magician": {
      details: "+2D Performance\nSpecialized: Sleight of Hand\n+2 Wealth",
      cash: "$400.00",
      items: [
        ITEMS.luxury_sedan,
        ITEMS.upscale_home,
        ITEMS.smartphone,
        ITEMS.magic_kit
      ]
    },

    "Street Dealer": {
      details: "+2D Thievery\nSpecialized: Hide\n+1 Wealth",
      cash: "$1000.00",
      items: [
        ITEMS.hatchback,
        ITEMS.shared_apartment,
        ITEMS.smartphone,
        ITEMS.burner_phone,
        ITEMS.pistol
      ]
    },

    "Street Hustler": {
      details: "+2D Performance\n+1D Social\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.shared_apartment,
        ITEMS.smartphone
      ]
    },

    "Student": {
      details: "+2D Knowledge\nSpecialized: Education",
      cash: "$50.00",
      items: [
        ITEMS.bicycle,
        ITEMS.modest_home,
        ITEMS.smartphone
      ]
    },

    "SWAT": {
      details: "+2D Longarms\n+1D Military Training\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.suv,
        ITEMS.modest_home,
        ITEMS.smartphone,
        ITEMS.assault_rifle
      ]
    },

    "Teacher": {
      details: "+2D Knowledge\nSpecialized: Education\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.hatchback,
        ITEMS.modest_home,
        ITEMS.smartphone
      ]
    },

    "Tradesman": {
      details: "+2D Technical\nSpecialized: Any Technical skill\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.truck,
        ITEMS.modest_home,
        ITEMS.smartphone,
        ITEMS.toolbox
      ]
    },

    "Truck Driver": {
      details: "+2D Driving\nSpecialized: Drive Semi\n+1 Wealth",
      cash: "$150.00",
      items: [
        ITEMS.semi_truck,
        ITEMS.no_fixed_address,
        ITEMS.smartphone
      ]
    },

    "University Professor": {
      details: "+2D Knowledge\nActivate: Any locked Knowledge skill\n+2 Wealth",
      cash: "$400.00",
      items: [
        ITEMS.sedan,
        ITEMS.modest_home,
        ITEMS.smartphone,
        ITEMS.laptop,
        ITEMS.desktop_computer
      ]
    },

    "University Student": {
      details: "+2D Knowledge\nActivate: Any locked Knowledge skill",
      cash: "$50.00",
      items: [
        ITEMS.bicycle,
        ITEMS.shared_apartment,
        ITEMS.smartphone,
        ITEMS.laptop
      ]
    },

    "Veterinarian": {
      details: "+2D Medical\n+1D Animals\n+2 Wealth",
      cash: "$400.00",
      items: [
        ITEMS.suv,
        ITEMS.upscale_home,
        ITEMS.smartphone,
        ITEMS.laptop
      ]
    },

    "Writer": {
      details: "+2D Knowledge\nSpecialized: Writing\n+2 Wealth",
      cash: "$400.00",
      items: [
        ITEMS.sedan,
        ITEMS.modest_home,
        ITEMS.smartphone,
        ITEMS.laptop,
        ITEMS.desktop_computer
      ]
    }
  };

  const ORIGIN_DETAILS = {
    "Child of Abuse": {
      details: "5 extra move on Run Action\n+2D Medical\nSpecialized: First Aid",
      cash: "$0.00",
      items: []
    },

    "Raised by Academics": {
      details: "+2D Knowledge\nActivate: Any locked Knowledge skill\n+1 Wealth",
      cash: "$0.00",
      items: []
    },

    "Raised by Activists": {
      details: "5 extra move on Run Action\n+2D Performance\nSpecialized: Showmanship",
      cash: "$0.00",
      items: []
    },

    "Raised by Bikers": {
      details: "No Penalty when Driving\n+2D Driving\nSpecialized: Drive Motorcycle",
      cash: "$0.00",
      items: []
    },

    "Raised by Blue Collar": {
      details: "+2D Technical\n+1D Physical\nSpecialized: Any Technical skill",
      cash: "$0.00",
      items: []
    },

    "Bully as Child": {
      details: "Immune to Knockout\n+2D Unarmed\nSpecialized: Push",
      cash: "$0.00",
      items: []
    },

    "Raised by Cartel": {
      details: "+2D Sidearms\nSpecialized: Handgun\n+2 Wealth",
      cash: "$0.00",
      items: []
    },

    "Child Actor": {
      details: "+2D Performance\nSpecialized: Acting\n+2 Wealth",
      cash: "$0.00",
      items: []
    },

    "Raised in the Circus": {
      details: "+2D Performance\n+1D Physical\nSpecialized: Showmanship",
      cash: "$0.00",
      items: []
    },

    "Famous Parents": {
      details: "+2D Social\nSpecialized: Seduce\n+2 Wealth",
      cash: "$0.00",
      items: []
    },

    "Farm Raised": {
      details: "+2D Animals\n+1D Physical\nSpecialized: Animal Handling",
      cash: "$0.00",
      items: []
    },

    "Raised by Fishermen": {
      details: "+2D Nautical\n+1D Physical\nSpecialized: Fishing",
      cash: "$0.00",
      items: []
    },

    "Foster Child": {
      details: "5 extra move on Run Action\n+2D Awareness\nSpecialized: Empathy",
      cash: "$0.00",
      items: []
    },

    "Street Kid": {
      details: "+2D Unarmed\n+1D Armed\nSpecialized: Melee Weapon",
      cash: "$0.00",
      items: []
    },

    "Gifted": {
      details: "+2D Knowledge\n+1D Computers\nActivate: Any locked Knowledge skill",
      cash: "$0.00",
      items: []
    },

    "Raised by Hippies": {
      details: "+2D Performance\n+1D Social\nSpecialized: Play Instrument",
      cash: "$0.00",
      items: []
    },

    "Immigrant": {
      details: "5 extra move on Run Action\n+2D Awareness\nSpecialized: Instinct",
      cash: "$0.00",
      items: []
    },

    "Raised by Isolationists": {
      details: "+2D Survival\n+1D Stealth\nSpecialized: Hide",
      cash: "$0.00",
      items: []
    },

    "Raised by Mafia": {
      details: "+2D Thievery\nSpecialized: Intimidation\n+2 Wealth",
      cash: "$0.00",
      items: []
    },

    "Military Brat": {
      details: "+2D Physical\n+1D Military Training\nActivate: One martial art",
      cash: "$0.00",
      items: []
    },

    "Raised by Naturalists": {
      details: "Immune to Poisoned\n+2D Survival\nSpecialized: Foraging",
      cash: "$0.00",
      items: []
    },

    "Raised by Nomads": {
      details: "+2D Awareness\n+1D Survival\nSpecialized: Insight",
      cash: "$0.00",
      items: []
    },

    "Orphan": {
      details: "5 extra move on Run Action\n+2D Thievery\nSpecialized: Lock Picking",
      cash: "$0.00",
      items: []
    },

    "Raised by Preppers": {
      details: "+2D Survival\n+1D Military Training\nSpecialized: Scavenging",
      cash: "$0.00",
      items: []
    },

    "Raised Religious": {
      details: "+2D Social\n+1D Performance\nSpecialized: Singing",
      cash: "$0.00",
      items: []
    },

    "Raised by Single Parent": {
      details: "+2D Survival\n+1D Awareness\nSpecialized: Cooking",
      cash: "$0.00",
      items: []
    },

    "From a Small Town": {
      details: "+2D Stealth\n+1D Thievery\nSpecialized: Sleight of Hand",
      cash: "$0.00",
      items: []
    },

    "Born to the Game": {
      details: "5 extra move on Run Action\n+2D Physical\nSpecialized: Any Physical skill",
      cash: "$0.00",
      items: []
    },

    "Street Urchin": {
      details: "5 extra move on Run Action\n+2D Stealth\nSpecialized: Subtle",
      cash: "$0.00",
      items: []
    },

    "Suburban Brat": {
      details: "+2D Social\nSpecialized: Persuade\n+1 Wealth",
      cash: "$0.00",
      items: []
    },

    "Raised by Technophiles": {
      details: "+2D Computers\nSpecialized: Computer Use\n+1 Wealth",
      cash: "$0.00",
      items: []
    }
  };

  const HOBBY_DETAILS = {
    "Amateur Militia": {
      details: "+2D Longarms\nSpecialized: Automatic Rifle",
      cash: "$0.00",
      items: [
        ITEMS.assault_rifle
      ]
    },

    "Amateur Pilot": {
      details: "+2D Aviation\nActivate: Fly Plane",
      cash: "$0.00",
      items: [
        ITEMS.four_seat_plane
      ]
    },

    "Amateur Scientist": {
      details: "+2D Knowledge\nActivate: Any science skill",
      cash: "$0.00",
      items: []
    },

    "Animal Enthusiast": {
      details: "+2D Animals\nSpecialized: Any Animals skill",
      cash: "$0.00",
      items: []
    },

    "Army Reservist": {
      details: "+2D Longarms\n+1D Sidearms",
      cash: "$0.00",
      items: []
    },

    "Auto Restoration": {
      details: "+2D Technical\nSpecialized: Mechanical",
      cash: "$0.00",
      items: [
        ITEMS.toolbox
      ]
    },

    "Bow Hunter": {
      details: "+2D Ranged\nActivate: Bow",
      cash: "$0.00",
      items: [
        ITEMS.bow
      ]
    },

    "Brawler": {
      details: "+2D Unarmed\nSpecialized: Brawling",
      cash: "$0.00",
      items: []
    },

    "Camper": {
      details: "+2D Survival\nSpecialized: Foraging",
      cash: "$0.00",
      items: [
        ITEMS.camping_gear
      ]
    },

    "Conspiracy Theorist": {
      details: "+2D Investigation\nSpecialized: Deception",
      cash: "$0.00",
      items: []
    },

    "Cyclist": {
      details: "+2D Physical\nSpecialized: Ride Bicycle",
      cash: "$0.00",
      items: [
        ITEMS.bicycle
      ]
    },

    "Cosplay": {
      details: "+2D Performance\nSpecialized: Disguise",
      cash: "$0.00",
      items: [
        ITEMS.cosplay_outfits
      ]
    },

    "DIY": {
      details: "+2D Technical\nSpecialized: Any Technical skill",
      cash: "$0.00",
      items: [
        ITEMS.toolbox
      ]
    },

    "Drone Enthusiast": {
      details: "+2D Aviation\nSpecialized: Control Drone",
      cash: "$0.00",
      items: [
        ITEMS.civilian_drone
      ]
    },

    "Gamer": {
      details: "+2D Computers\nSpecialized: Computer Use",
      cash: "$0.00",
      items: [
        ITEMS.desktop_computer
      ]
    },

    "Genealogist": {
      details: "+2D Investigation\nSpecialized: Investigate",
      cash: "$0.00",
      items: []
    },

    "Hacker": {
      details: "+2D Computers\nActivate: Hacking",
      cash: "$0.00",
      items: [
        ITEMS.laptop
      ]
    },

    "Hunter": {
      details: "+2D Survival\nSpecialized: Hunting",
      cash: "$0.00",
      items: [
        ITEMS.hunting_rifle
      ]
    },

    "Locksport": {
      details: "+2D Thievery\nSpecialized: Lockpicking",
      cash: "$0.00",
      items: [
        ITEMS.lockpick_set
      ]
    },

    "Martial Arts": {
      details: "+2D Unarmed\nActivate: One martial art",
      cash: "$0.00",
      items: []
    },

    "Motorcycle Enthusiast": {
      details: "+2D Driving\nSpecialized: Drive Motorcycle",
      cash: "$0.00",
      items: [
        ITEMS.motorcycle
      ]
    },

    "Navy Reservist": {
      details: "+2D Nautical\nSpecialized: Drive Boat",
      cash: "$0.00",
      items: []
    },

    "Parkour": {
      details: "+2D Physical\nSpecialized: Acrobatics",
      cash: "$0.00",
      items: []
    },

    "Performer": {
      details: "+2D Performance\nSpecialized: Any Performance skill",
      cash: "$0.00",
      items: []
    },

    "Picker": {
      details: "+2D Knowledge\nSpecialized: Appraisal",
      cash: "$0.00",
      items: []
    },

    "Pistol Shooting": {
      details: "+2D Sidearms\nSpecialized: Handgun",
      cash: "$0.00",
      items: [
        ITEMS.pistol
      ]
    },

    "Player": {
      details: "+2D Social\nSpecialized: Seduce",
      cash: "$0.00",
      items: []
    },

    "Prepper": {
      details: "+2D Survival\nSpecialized: Scavenging",
      cash: "$0.00",
      items: [
        ITEMS.camping_gear
      ]
    },

    "Recreational Diver": {
      details: "+2D Physical\nActivate: Diving",
      cash: "$0.00",
      items: [
        ITEMS.scuba_kit
      ]
    },

    "Rifle Shooting": {
      details: "+2D Longarms\nSpecialized: Rifle",
      cash: "$0.00",
      items: [
        ITEMS.hunting_rifle
      ]
    },

    "RPG Enthusiast": {
      details: "+2D Knowledge\n+1D Military Training",
      cash: "$0.00",
      items: []
    },

    "Socialite": {
      details: "+2D Social\nSpecialized: Etiquette",
      cash: "$0.00",
      items: []
    },

    "Sports": {
      details: "+2D Physical\nSpecialized: Any Physical skill",
      cash: "$0.00",
      items: [
        ITEMS.sports_gear
      ]
    },

    "Street Racer": {
      details: "+2D Driving\nSpecialized: Drive Car",
      cash: "$0.00",
      items: [
        ITEMS.sportscar
      ]
    },

    "Technophile": {
      details: "+2D Computers\nSpecialized: Hardware",
      cash: "$0.00",
      items: [
        ITEMS.laptop
      ]
    },

    "Tinkerer": {
      details: "+2D Technical\nSpecialized: Hardware",
      cash: "$0.00",
      items: [
        ITEMS.toolbox
      ]
    },

    "True Crime Fan": {
      details: "+2D Investigation\nSpecialized: Investigate",
      cash: "$0.00",
      items: []
    },

    "Underground Chemist": {
      details: "+2D Thievery\nActivate: Chemistry",
      cash: "$0.00",
      items: [
        ITEMS.motorhome
      ]
    },

    "Volunteer Firefighter": {
      details: "+2D Technical\nSpecialized: Climbing",
      cash: "$0.00",
      items: [
        ITEMS.truck
      ]
    }
  };

  const SECTIONS = [
    "actions",
    "wounds",
    "attributes",
    "attributes_ro",
    "combat",
    "armor",
    "conditions",
    "skillcheck",
    "details",
    "skill_finder",
    "inventory",

    "core", "core_training",
    "unarmed", "unarmed_training",
    "armed", "armed_training",
    "sidearms", "sidearms_training",
    "longarms", "longarms_training",
    "ranged", "ranged_training",

    "awareness", "awareness_training",
    "animals", "animals_training",
    "medical", "medical_training",
    "performance", "performance_training",
    "physical", "physical_training",
    "stealth", "stealth_training",
    "survival", "survival_training",
    "thievery", "thievery_training",
    "computers", "computers_training",
    "investigation", "investigation_training",
    "military_training", "military_training_training",
    "knowledge", "knowledge_training",
    "social", "social_training",
    "technical", "technical_training",
    "driving", "driving_training",
    "aviation", "aviation_training",
    "nautical", "nautical_training"
  ];

//********** END: CONSTS

  function initSkillGroupsIfUnset() {
    const attrsToCheck = [];

    SKILL_GROUP_LIST.forEach(group => {
      attrsToCheck.push(`${group}_value`, `${group}_string`);
    });

    getAttrs(attrsToCheck, function(values) {
      const updates = {};

      SKILL_GROUP_LIST.forEach(group => {
        if (!values[`${group}_value`]) {
          updates[`${group}_value`] = 0;
        }
        if (!values[`${group}_string`]) {
          updates[`${group}_string`] = "0D + 0";
        }
      });

      if (Object.keys(updates).length > 0) {
        setAttrs(updates);
      }
    });
  }

  function getTypeDefaults(character_type) {
    if (character_type === "major_npc") {
      return { skill_points: 600 };
    }
    if (character_type === "npc") {
      return { skill_points: 0 };
    }
    return { skill_points: 60 };
  }

  function getDefaults() {
    return {
      sheet_mode: "sheet",

      core_value: 0, core_string: "0D", core_min: 0, core_cost: 1, core_refund: 0,
      social_value: 0, social_string: "0D", social_min: 0, social_cost: 1, social_refund: 0,
      performance_value: 0, performance_string: "0D", performance_min: 0, performance_cost: 1, performance_refund: 0,
      thievery_value: 0, thievery_string: "0D", thievery_min: 0, thievery_cost: 1, thievery_refund: 0,
      military_training_value: 0, military_training_string: "0D", military_training_min: 0, military_training_cost: 1, military_training_refund: 0,
      awareness_value: 0, awareness_string: "0D", awareness_min: 0, awareness_cost: 1, awareness_refund: 0,
      survival_value: 0, survival_string: "0D", survival_min: 0, survival_cost: 1, survival_refund: 0,
      stealth_value: 0, stealth_string: "0D", stealth_min: 0, stealth_cost: 1, stealth_refund: 0,
      physical_value: 0, physical_string: "0D", physical_min: 0, physical_cost: 1, physical_refund: 0,
      medical_value: 0, medical_string: "0D", medical_min: 0, medical_cost: 1, medical_refund: 0,
      aviation_value: 0, aviation_string: "0D", aviation_min: 0, aviation_cost: 1, aviation_refund: 0,
      technical_value: 0, technical_string: "0D", technical_min: 0, technical_cost: 1, technical_refund: 0,
      knowledge_value: 0, knowledge_string: "0D", knowledge_min: 0, knowledge_cost: 1, knowledge_refund: 0,
      nautical_value: 0, nautical_string: "0D", nautical_min: 0, nautical_cost: 1, nautical_refund: 0,
      sidearms_value: 0, sidearms_string: "0D", sidearms_min: 0, sidearms_cost: 1, sidearms_refund: 0,
      longarms_value: 0, longarms_string: "0D", longarms_min: 0, longarms_cost: 1, longarms_refund: 0,
      unarmed_value: 0, unarmed_string: "0D", unarmed_min: 0, unarmed_cost: 1, unarmed_refund: 0,
      armed_value: 0, armed_string: "0D", armed_min: 0, armed_cost: 1, armed_refund: 0,
      ranged_value: 0, ranged_string: "0D", ranged_min: 0, ranged_cost: 1, ranged_refund: 0,
      computers_value: 0, computers_string: "0D", computers_min: 0, computers_cost: 1, computers_refund: 0,
      investigation_value: 0, investigation_string: "0D", investigation_min: 0, investigation_cost: 1, investigation_refund: 0,
      animals_value: 0, animals_string: "0D", animals_min: 0, animals_cost: 1, animals_refund: 0,
      driving_value: 0, driving_string: "0D", driving_min: 0, driving_cost: 1, driving_refund: 0,

      law_active: 0,
      engineering_active: 0,
      surgery_active: 0,
      bow_active: 0,
      pharmacology_active: 0,
      pyschiatry_active: 0,
      hacking_active: 0,
      programming_active: 0,
      forensics_active: 0,
      linguistics_active: 0,
      astronomy_active: 0,
      biology_active: 0,
      mathematics_active: 0,
      chemistry_active: 0,
      physics_active: 0,
      spycraft_active: 0,
      fly_plane_active: 0,
      fly_helicopter_active: 0,
      diving_active: 0,

      aikido_active: 0,
      boxing_active: 0,
      capoeira_active: 0,
      jeet_kune_do_active: 0,
      jiu_jitsu_active: 0,
      judo_active: 0,
      karate_active: 0,
      krav_maga_active: 0,
      muay_thai_active: 0,
      sambo_active: 0,
      savate_active: 0,
      taekwondo_active: 0,
      wing_chun_active: 0,

      base_move: 30,
      base_run: 30,
      current_move: 30,
      current_run: 30,

      strength: 3,
      agility: 3,
      health: 3,
      perception: 3,
      quickness: 3,
      willpower: 3,
      intelligence: 3,
      manualdex: 3,
      charisma: 3,

      advantage: 0,
      defaults_set: 1,
      attribute_total: 27,
      spend_mode: 1,
      status: "Conscious",
      encumbrance_visible: 0,
      use_encumbrance: 0,
      num_declared_actions: 1
    };
  }

  function setSkillAttributeCodes() {
    const updates = {};

    Object.keys(SKILL_STATS).forEach(skill => {
      updates[`${skill}_attributes`] = SKILL_STATS[skill];
    });
    setAttrs(updates);
  };

  function setSkillGroups() {
    const updates = {};

    Object.keys(SKILL_GROUPS).forEach(skill => {
      updates[`${skill}_skillgroup`] = SKILL_GROUPS[skill];
    });
    setAttrs(updates);
  };

//********** START: ARMOR

  const updateArmorStats = () => {
    getAttrs(["head_armor", "body_armor", "shield"], (values) => {
      const head = ARMOR_LOOKUP[values.head_armor] || ARMOR_LOOKUP["None"];
      const body = ARMOR_LOOKUP[values.body_armor] || ARMOR_LOOKUP["None"];
      const shield = ARMOR_LOOKUP[values.shield] || ARMOR_LOOKUP["None"];

      const totalBonus = head.toBeHitBonus + body.toBeHitBonus + shield.toBeHitBonus;
      const totalPenalty = head.tnPenalty + body.tnPenalty + shield.tnPenalty;
      const blocks2H = (head.blocks2H || body.blocks2H || shield.blocks2H) ? "Yes" : "No";

      const updates = {
        head_armor_desc: head.description,
        body_armor_desc: body.description,
        shield_desc: shield.description,

        head_armor_bonus: head.toBeHitBonus,
        body_armor_bonus: body.toBeHitBonus,
        shield_bonus: shield.toBeHitBonus,

        head_armor_penalty: head.tnPenalty,
        body_armor_penalty: body.tnPenalty,
        shield_penalty: shield.tnPenalty,

        armor_bonus: totalBonus,
        armor_penalty: totalPenalty,
        blocks2H: blocks2H
      };

      setAttrs(updates);
    });
  };

  ["head_armor", "body_armor", "shield"].forEach(slot => {
    on(`change:${slot}`, updateArmorStats);
  });

//********* END: ARMOR

  function updateActual(attrName) {
    const baseAttr = attrName;
    const adjAttr = `${attrName}_adjustment`;
    const actual = `${attrName}_rollcode`;
    const conditions = `${attrName}_conditions`;
    const actualStringAttr = `${attrName}_string`;

    getAttrs([baseAttr, adjAttr, conditions], function(values) {
      const base = parseInt(values[baseAttr]) || 0;
      const adj = parseInt(values[adjAttr]) || 0;
      const conditionPenalty = parseInt(values[conditions]) || 0;

      let total = base + adj + conditionPenalty;

      if(total < 0) {
        total = 0;
      }

      let rollcode = total;
      let displaycode = total;
      if(rollcode < 0) {
        displaycode = 0;
      }
      let actualString = `${displaycode}D`;

      setAttrs({
        [actual]: rollcode + "d6",
        [actualStringAttr]: actualString
      });
    });
  }

  function updateSkillFromStats(skill) {
    const code = SKILL_STATS[skill];
    const letters = code.split("");
    const stats = letters.map(letter => LETTER_TO_ATTR[letter]);
    const actualStats = stats.map(stat => `${stat}_rollcode`);
    const skillgroupAttr = `${skill}_skillgroup`;
    const skillActiveAttr = `${skill}_active`;

    const attrsToFetch = [
      ...actualStats,
      skillgroupAttr,
      skillActiveAttr,
      "selected_skill",
      "searched_skill",
      "combined_skill_1",
      "combined_skill_2",
      "selected_reaction"
    ];

    getAttrs(attrsToFetch, function(values) {
      const group = values[skillgroupAttr];
      const groupValueAttr = `${group}_value`;

      getAttrs([groupValueAttr], function(groupValues) {
        const baseTotal = actualStats.reduce((sum, stat) => sum + (parseInt(values[stat]) || 0), 0);
        const groupValue = parseInt(groupValues[groupValueAttr]) || 0;

        const total = baseTotal + groupValue;
        const dicecode = pipsToDiceCode(total, "D");
        const rollcode = pipsToDiceCode(total, "d6");

        const updates = {
          [`${skill}_string`]: dicecode,
          [`${skill}_rollcode`]: rollcode
        };

        if (values.selected_skill === skill) {
          updates["action_skill"] = dicecode;
        }

        if (values.searched_skill === skill) {
          updates["searched_action_skill"] = dicecode;
        }

        if (values.selected_reaction === skill) {
          updates["reaction_skill"] = dicecode;
        }

        if (values.combined_skill_1 === skill) {
          updates["combined_action_skill_1"] = dicecode;
        }

        if (values.combined_skill_2 === skill) {
          updates["combined_action_skill_2"] = dicecode;
        }

        setAttrs(updates, updateActionCodes);
      });
    });
  }

  function handleTraining(group) {
    const groupValueAttr = `${group}_value`;
    const groupStringAttr = `${group}_string`;
    const groupCost = `${group}_cost`;
    const groupRefund = `${group}_refund`;

    getAttrs(["skill_points", groupValueAttr], function(values) {
      let skillPoints = parseInt(values.skill_points) || 0;
      let pips = parseInt(values[groupValueAttr]) || 0;

      const cost = Math.floor(pips / 3) + 1;

      if (skillPoints >= cost) {
        skillPoints -= cost;
        pips += 1;
        const dicecode = pipsToDiceCode(pips, "D");
        const nextCost = Math.floor(pips / 3) + 1;

        setAttrs({
          skill_points: skillPoints,
          [groupValueAttr]: pips,
          [groupStringAttr]: dicecode,
          [groupCost]: nextCost,
          [groupRefund]: cost,
        });

        getSkillsByGroup(group).forEach(updateSkillFromStats);
      } else {
        rollErrorMessage(` ${capitalize(group)} Training Failed: Not enough skill points (need ${cost})`);
        return;
      }
    });
  }

  function handleUndo(group) {
    const groupValueAttr = `${group}_value`;
    const groupStringAttr = `${group}_string`;
    const groupCost = `${group}_cost`;
    const groupMin = `${group}_min`;
    const groupRefund = `${group}_refund`;

    getAttrs(["skill_points", groupValueAttr, groupRefund, groupMin], function(values) {
      let skillPoints = parseInt(values.skill_points) || 0;
      let pips = parseInt(values[groupValueAttr]) || 0;
      let refund = parseInt(values[groupRefund]) || 0;
      let min = parseInt(values[groupMin]) || 0;

      if (pips <= 0 || refund <= 0) return;

      pips -= 1;
      skillPoints += refund;
      const dicecode = pipsToDiceCode(pips, "D");
      const nextCost = refund;
      const nextRefund = pips>min ? Math.floor((pips - 1) / 3) + 1 : 0;

      setAttrs({
        skill_points: skillPoints,
        [groupValueAttr]: pips,
        [groupStringAttr]: dicecode,
        [groupCost]: nextCost,
        [groupRefund]: nextRefund,
      });

      getSkillsByGroup(group).forEach(updateSkillFromStats);
    });
  }

  function capitalize(str) {
    return str.charAt(0).toUpperCase() + str.slice(1);
  }

  function getSkillsByGroup(group) {
    return Object.entries(SKILL_GROUPS)
    .filter(([, skillGroup]) => skillGroup === group)
    .map(([skill]) => skill);
  }

  function pipsToDiceCode(pips, letter = "D") {
    const dice = Math.floor(pips / 3);
    const remainder = pips % 3;

    return remainder > 0 ? `${dice}${letter} + ${remainder}` : `${dice}${letter}`;
  }

  function diceCodeToPips(diceCode) {
    const match = diceCode.match(/^(\d+)[dD](?:\s*\+\s*(\d+))?$/);
    if (!match) return 0;

    const dice = parseInt(match[1], 10);
    const remainder = parseInt(match[2] || "0", 10);
    return dice * 3 + remainder;
  }

  function enterSpendMode() {
    const attrsToGet = ["spend_mode"];

    // Gather all active skill attributes to check
    ACTIVATABLE_SKILLS.forEach(skill => {
      attrsToGet.push(`${skill}_active`);
    });

    getAttrs(attrsToGet, function(values) {
      const updates = {
        spend_mode: "1"
      };

      ACTIVATABLE_SKILLS.forEach(skill => {
        const active = parseInt(values[`${skill}_active`], 10) || 0;

        if (active < 3) {
          updates[`${skill}_active`] = "1";
        }
      });

      setAttrs(updates);
    });
  }

  function commitSpend() {
    const attrsToGet = [];

    SKILL_GROUP_LIST.forEach(group => {
      attrsToGet.push(`${group}_value`);
    });

    ACTIVATABLE_SKILLS.forEach(skill => {
      attrsToGet.push(`${skill}_active`);
    });

    getAttrs(attrsToGet, function(values) {
      const updates = {};

      // Update skill group minimums and reset refunds
      SKILL_GROUP_LIST.forEach(group => {
        const value = parseInt(values[`${group}_value`] || "0", 10);
        updates[`${group}_min`] = value;
        updates[`${group}_refund`] = 0;
      });

      // Update activatable skills from "2" (activated) to "3" (committed)
      ACTIVATABLE_SKILLS.forEach(skill => {
        const activeVal = String(values[`${skill}_active`] || "0");

        if (activeVal === "2" || activeVal === "3") {
          updates[`${skill}_active`] = "3";
        } else {
          updates[`${skill}_active`] = "0";
        }
      });

      updates.spend_mode = "0";

      setAttrs(updates);
    });
  }

  function blockIfAiming(next) {
    getAttrs(["condition_aiming"], (values) => {
      const aiming = values.condition_aiming === "on"; // or however you store it
      if (aiming) {
        rollErrorMessage(" You cannot react while you have the Aiming condition.");
        return;
      }
      next(); // continue if not aiming
    });
  }

  function renderAmmoDisplay(currentAmmo, maxAmmo) {
    let output = "";
    for (let i = 0; i < maxAmmo; i++) {
      output += i < currentAmmo ? "" : "";
    }
    return output;
  }

  function handleFirearmAttack(slot) {
    const attrs = [
      `${slot}_ammo`,
      `${slot}_rollcode`,
      `${slot}_weapon`,
      "character_name",
      "is_auto_burst"
    ];

    getAttrs(attrs, function(values) {
      let ammo = parseInt(values[`${slot}_ammo`], 10) || 0;
      const weaponName = values[`${slot}_weapon`] || "Weapon";

      if (ammo <= 0) {
        rollErrorMessage(" Out of Ammo: Reload before firing!");
        return;
      }

      const weaponData = FIREARMS_LOOKUP[weaponName] || {};
      const isBurst = parseInt(values.is_auto_burst, 10) === 1;
      const isAutomatic = (weaponData.skillCategory || "").toLowerCase().includes("automatic");

      const doAttack = () => {
        hasActionsRemaining((actionsRemaining) => {
          const newActionsRemaining = actionsRemaining - 1;

          // Plan shots, but don't cap  we will STOP mid-burst if we run out.
          let plannedShots = 1;
          if (isBurst && isAutomatic) plannedShots = 3;

          let shotsFired = 0;

          for (let i = 0; i < plannedShots; i++) {
            if (ammo <= 0) {
              rollErrorMessage(" Out of Ammo: Burst interrupted!");
              break;
            }
            rollSkill(slot);
            ammo--;
            shotsFired++;
          }

          adjustAmmo(slot, -shotsFired);

          appendToActionLog(
            `  Action: ${weaponName}\n\tActions remaining decreased by one: ${newActionsRemaining}`
          );
          setAttrs({
            actions_remaining: newActionsRemaining,
            is_auto_burst: 0,
          });

        });
      };

      if (weaponData.hands === "2H") {
        canUse2HWeapon(doAttack); // Will block if shield prevents 2H
      } else {
        doAttack();
      }
    });
  }

  function updateAmmo(slot, delta) {
    const ammoAttr = `${slot}_ammo`;
    const maxAttr = `${slot}_ammo_max`;

    getAttrs([ammoAttr, maxAttr], function(values) {
      const current = parseInt(values[ammoAttr], 10) || 0;
      const max = parseInt(values[maxAttr], 10) || 0;

      let updated = current + delta;
      if (updated > max) updated = max;
      if (updated < 0) updated = 0;

      setAttrs({ [ammoAttr]: updated });
      adjustAmmo(slot, 0);
    });
  }

  function canUse2HWeapon(callback) {
    getAttrs(["blocks2H"], function(values) {
      const blocked = values.blocks2H === "Yes"; // or "true" if you're using that instead
      if (blocked) {
        rollErrorMessage(" You cannot use a 2H weapon with a shield.");
        return;
      }
      callback();
    });
  }

  function hasActionsRemaining(callback) {
    getAttrs(["actions_remaining"], function(values) {
      const remaining = parseInt(values.actions_remaining, 10) || 0;

      if (remaining <= 0) {
        rollErrorMessage(" You have no actions remaining this round.");
        return;
      }

      //  pass two values
      callback(remaining);
    });
  }

  function reloadAmmo(slot) {
    const maxAttr = `${slot}_ammo_max`;
    const ammoAttr = `${slot}_ammo`;
    const weaponAttr = `${slot}_weapon`;

    getAttrs([maxAttr, weaponAttr, "character_name", "whisper_toggle"], function(values) {
      const max = parseInt(values[maxAttr], 10) || 0;
      const weaponName = values[weaponAttr] || "Weapon";
      const characterName = values.character_name || "Character";
      const whisper = values.whisper_toggle || "";

      hasActionsRemaining((actionsRemaining) => {
        const newActionsRemaining = actionsRemaining - 1;

        setAttrs({
          [ammoAttr]: max,
          actions_remaining: newActionsRemaining
        }, () => {
          adjustAmmo(slot, 0);

          const messageRoll =
            `${whisper} &{template:d6plus-message} ` +
            `{{name=${characterName}}} ` +
            `{{message=Reloaded **${weaponName}**.}}`;

          startRoll(messageRoll, (results) => finishRoll(results.rollId));

          appendToActionLog(`  Action: Reload ${weaponName}\n\tActions remaining decreased by one: ${newActionsRemaining}`);
        });
      });
    });
  }

  function adjustAmmo(slot, delta) {
    const ammoAttr = `${slot}_ammo`;
    const maxAttr = `${slot}_ammo_max`;
    const displayAttr = `${slot}_ammo_display`;

    getAttrs([ammoAttr, maxAttr], function(values) {
      let ammo = parseInt(values[ammoAttr], 10) || 0;
      const maxAmmo = parseInt(values[maxAttr], 10) || 0;

      // Apply delta
      ammo += delta;

      // Clamp within 0 and maxAmmo
      if (ammo < 0) ammo = 0;
      if (ammo > maxAmmo) ammo = maxAmmo;

      const display = renderAmmoDisplay(ammo, maxAmmo);

      const updates = {};
      updates[ammoAttr] = ammo;
      updates[displayAttr] = display;

      setAttrs(updates);
    });
  }

  function adjustDiceByAttackCount(baseString, count) {
    const basePips = diceCodeToPips(baseString);
    const adjustedPips = Math.max(0, basePips - 3 * count);

    return {
      actual: pipsToDiceCode(adjustedPips, "D"),
      rollcode: pipsToDiceCode(adjustedPips, "d6")
    };
  }

  function updateWeapon({
    values,
    weaponAttr,
    lookupTable,
    prefix,
    extra = () => ({})
  }) {
    const weapon = values[weaponAttr] || "None";
    const updates = {};
    const weaponData = lookupTable[weapon];

    if (!weaponData) {
      return setAttrs({
        [`${prefix}attr`]: `${weapon} not found`,
        [`${prefix}string`]: "0D",
        [`${prefix}actual`]: "0D",
        [`${prefix}rollcode`]: "0d6",
        [`${prefix}damage`]: "0D",
        [`${prefix}damage_rollcode`]: "0d6",
        [`${prefix}min_damage`]: "-",
        [`${prefix}special`]: `${weapon} not found`
      });
    }

    const skillCategory = weaponData.skillCategory?.toLowerCase().replace(/\s+/g, "") || "";

    const displayDice = values[`${skillCategory}_string`] || "0D";
    const displayName = values[`${skillCategory}_displayname`] || weapon;

    const totalPenalty = parseInt(values.actions_penalty, 10) || 0;
    const result = adjustDiceByAttackCount(displayDice, totalPenalty);

    const damage = weaponData.damage || "-";
    const rollcode = damage.replace(/D/g, "d6").replace(/(\d+)d6/g, "$1d6kh$1cs0cf0");

    Object.assign(updates, {
      [`${prefix}attr`]: displayName,
      [`${prefix}string`]: displayDice,
      [`${prefix}actual`]: result.actual || "0D",
      [`${prefix}rollcode`]: result.rollcode || "0d6",
      [`${prefix}damage`]: damage,
      [`${prefix}damage_rollcode`]: rollcode,
      [`${prefix}min_damage`]: weaponData.minDamage || "-",
      [`${prefix}special`]: weaponData.special || "",
      [`${prefix}weapon`]: weapon,
      ...extra(values, weaponData)
    });

    const rangeCategory = weaponData.rangeType || "blank_range";
    const rangeData = RANGES_LOOKUP[rangeCategory] || {};

    ["point_blank", "short", "medium", "long", "extreme"].forEach(range => {
      const label = range.replace(/_/g, " ");
      const value = rangeData[label] || "-";
      const attrName = `${prefix}${range}`;
      updates[attrName] = value;
    });

    if (weaponData.ammo) {
      const maxAmmo = parseInt(weaponData.ammo, 10);
      const bulletString = renderAmmoDisplay(maxAmmo, maxAmmo);
      updates[`${prefix}ammo`] = maxAmmo;
      updates[`${prefix}ammo_max`] = maxAmmo;
      updates[`${prefix}ammo_display`] = bulletString;
    }

    setAttrs(updates);
  }

  function rollWeaponDamage(key) {
    const fields = [
      'character_name',
      'whisper_toggle',
      'revived_toggle',
      'condition_knockout',
      'character_immunities',
      'status',
      `${key}_weapon`,
      `${key}_damage_rollcode`,
      `${key}_min_damage`,
      `${key}_special`
    ];

    getAttrs(fields, function(values) {

      if (isKnockedOut(values)) {
        rollErrorMessage(" You are knocked out and cannot attack.");
        return;
      }

      if (!isConscious(values)) {
        rollErrorMessage(" You are not conscious and cannot act.");
        return;
      }

      const character = values.character_name || '';
      const weapon = values[`${key}_weapon`] || '';
      const rollcode = values[`${key}_damage_rollcode`] || '0';
      const minDamage = values[`${key}_min_damage`] || '0';
      const special = values[`${key}_special`] || '';
      const whisper = values.whisper_toggle || '';
      const diceCode = rollCodeToDiceCode(rollcode);

      const roll =
        `${whisper} ` +
        `&{template:d6damage} ` +
        `{{character=${character}}} ` +
        `{{weapon=${weapon}}} ` +
        `{{damage_roll=[[ ${rollcode} ]]}} ` +
        `{{minimum_damage=${minDamage}}} ` +
        `{{special=${special}}}`;

      startRoll(roll, (results) => {
        finishRoll(results.rollId);
      });
    });
  }

  function rollMonsterDamage(key) {
    const fields = [
      'character_name',
      'whisper_toggle',
      'revived_toggle',
      'condition_knockout',
      'character_immunities',
      'status',
      `${key}_name`,
      `${key}_damage`,
      `${key}_min_damage`,
      `${key}_special`
    ];

    getAttrs(fields, function(values) {

      if (isKnockedOut(values)) {
        rollErrorMessage(" You are knocked out and cannot attack.");
        return;
      }

      if (!isConscious(values)) {
        rollErrorMessage(" You are not conscious and cannot act.");
        return;
      }

      const character = values.character_name || '';
      const weapon = values[`${key}_name`] || '';
      const rawDamage = values[`${key}_damage`] || '0';
      const rollcode = rawDamage.replace(/D/g, 'd6');
      const safeRollcode = makeSafeRollcode(rollcode);
      const minDamage = values[`${key}_min_damage`] || '0';
      const special = values[`${key}_special`] || '';
      const whisper = values.whisper_toggle || '';

      const roll =
        `${whisper} ` +
        `&{template:d6damage} ` +
        `{{character=${character}}} ` +
        `{{weapon=${weapon}}} ` +
        `{{damage_roll=[[ ${safeRollcode} ]]}} ` +
        `{{minimum_damage=${minDamage}}} ` +
        `{{special=${special}}}`;

      startRoll(roll, (results) => {
        finishRoll(results.rollId);
      });
    });
  }

  function isKnockedOut(values) {
    return values.condition_knockout === "on" && !values.character_immunities.includes("Knockout");
  }

  function isConscious(values) {
    return values.status === "Conscious" || values.revived_toggle === "on";
  }

  function canAct(values) {
    if (isKnockedOut(values)) {
      //rollErrorMessage(" You are knocked out and cannot act.");
      return false;
    }
    if (!isConscious(values)) {
      //rollErrorMessage(" You are not conscious and cannot act.");
      return false;
    }
    return true;
  }

  function rollCodeToDiceCode(rollExpr) {
    // Match "Xd6" with optional spaces and +pips
    const match = rollExpr.match(/(\d+)d6(?:\s*\+\s*(\d+))?/i);
    if (!match) return "0D"; // fallback

    const dice = match[1];
    const pips = match[2] ? ` + ${match[2]}` : "";

    return `${dice}D${pips}`;
  }

  function rollErrorMessage(message) {
    getAttrs(["character_name", "whisper_toggle"], function(values) {
      const name = values.character_name || "Character";
      const whisper = values.whisper_toggle || "";

      const errorRoll =
        `${whisper} &{template:d6plus-error} ` +
        `{{name=${name}}} ` +
        `{{message=${message}}}`;

      startRoll(errorRoll, (results) => finishRoll(results.rollId));
    });
  }

  function rollInitiative(name, rollcode, diceCode, whisper) {
    const roll =
      `${whisper} &{template:d6plus-initiative} ` +
      `{{character=${name}}} ` +
      `{{dice_code=${diceCode}}} ` +
      `{{roll=[[ ${rollcode} &{tracker} ]]}}`;
    startRoll(roll, (results) => finishRoll(results.rollId));
  }

  function rollFixedND(n, label = "Fixed nD Roll") {
    getAttrs([
      "character_name",
      "whisper_toggle",
      "revived_toggle",
      "status",
      "condition_knockout",
      "character_immunities"
    ], function (values) {
      const name = values.character_name || "Character";
      const whisper = values.whisper_toggle || "";

      if (isKnockedOut(values)) {
        rollErrorMessage(" You are knocked out and cannot act.");
        return;
      }

      if (!isConscious(values)) {
        rollErrorMessage(" You are not conscious and cannot act.");
        return;
      }

      const safeRollcode = `${n}d6kh${n}cs0cf0`;

      const roll =
        `${whisper} &{template:d6plus-no-openend} ` +
        `{{character=${name}}} ` +
        `{{name=${label}}} ` +
        `{{dice_code=${n}D}} ` +
        `{{roll=[[ ${safeRollcode} ]]}} `;

      startRoll(roll, (results) => finishRoll(results.rollId));
    });
  }

  function getOpenEndRolls(advantage) {
    const rolls = [];
    let roll = Math.floor(Math.random() * 20) + 1;

    while (roll >= 20-advantage || roll == 20) {
      rolls.push(roll);
      roll = Math.floor(Math.random() * 20) + 1;
    }

    rolls.push(roll);
    return rolls;
  }

  function rollSkill(skill, actualRollCode, prefix = "", isSpecialized = false) {
    const attrs = [
      "character_name",
      `${skill}_rollcode`,
      `${skill}_displayname`,
      "advantage",
      `${skill}_specialized`,
      "whisper_toggle",
      "revived_toggle",
      "status",
      "condition_knockout",
      "character_immunities",
      "initiative_rollcode",
      "character_type",
      "driver_specialized"
    ];

    getAttrs(attrs, values => {
      const skillName = getDisplayName(skill, values);
      let displayName = prefix ? `${prefix} ${skillName}` : skillName;

      const ableToAct = canAct(values);

      //  Check Endure against the raw name
      if (skillName === "Endure" && !ableToAct) {
        rollErrorMessage(" Since you are not conscious you are defenceless. Your Endure roll is 3.");
        return;
      }

      if (!ableToAct) {
        if (values.character_type === "vehicle" && skillName === "Health") {
          //  Allow vehicle Health rolls even if inoperable
        } else if (values.character_type === "vehicle") {
          rollErrorMessage(" This vehicle is inoperable and cannot act.");
          return;
        } else {
          rollErrorMessage(" You are not conscious and cannot act.");
          return;
        }
      }

      const name = values.character_name || "Character";
      const whisper = values.whisper_toggle || "";

      const rollcode = actualRollCode || getRollcode(skill, values);
      const safeRollcode = makeSafeRollcode(rollcode);
      const diceCode = rollCodeToDiceCode(rollcode);

      //  specialization bonus depends on skill type
      let delta = 0;
      if (isSpecialized || values[`${skill}_specialized`] === "(specialized)") {
        delta = ATTACK_SKILLS.includes(skill) ? 1 : 3;
      }
      if(values.character_type === "vehicle" && values.driver_specialized === "on") {
        delta += 3;
      }

      const advantage = parseInt(values.advantage, 10) || 0;
      const d20s = getOpenEndRolls(advantage + delta);
      const numOpenEnd = d20s.length - 1;

      if (skill === "initiative") {
        rollInitiative(name, safeRollcode, diceCode, whisper);
        return;
      }

      if (d20s.length === 1) {
        if (delta <= 0 && d20s[0] <= 1 - advantage) {
          rollMishapTemplate({ name, displayName, diceCode, safeRollcode, whisper, d20s });
        } else {
          rollStandardTemplate({ name, displayName, diceCode, safeRollcode, whisper, d20s });
        }
      } else {
        rollOpenEndedTemplate({ name, displayName, diceCode, safeRollcode, numOpenEnd, whisper, d20s });
      }
    });
  }

  function rollCombinedSkills(skill1, skill2, prefix = "", specialized1 = false, specialized2 = false) {
    const attrs = [
      "character_name",
      `${skill1}_rollcode`, `${skill1}_displayname`, `${skill1}_specialized`, `${skill1}_active`,
      `${skill2}_rollcode`, `${skill2}_displayname`, `${skill2}_specialized`, `${skill2}_active`,
      "advantage", "whisper_toggle", "revived_toggle", "status",
      "condition_knockout", "character_immunities",
      "initiative_rollcode", "character_type", "driver_specialized"
    ];

    getAttrs(attrs, values => {
      const ableToAct = canAct(values);
      if (!ableToAct) {
        rollErrorMessage(" You are not conscious and cannot act.");
        return;
      }

      const name = values.character_name || "Character";
      const whisper = values.whisper_toggle || "";

      // ---- Skill 1 ----
      const skillName1 = getDisplayName(skill1, values);
      const displayName1 = prefix ? `${prefix} ${skillName1}` : skillName1;
      const rollcode1 = getRollcode(skill1, values);
      const safeRollcode1 = makeSafeRollcode(rollcode1);
      const diceCode1 = rollCodeToDiceCode(rollcode1);

      let delta1 = 0;
      if (specialized1 || values[`${skill1}_specialized`] === "(specialized)") {
        delta1 = ATTACK_SKILLS.includes(skill1) ? 1 : 3;
      }

      // ---- Skill 2 ----
      const skillName2 = getDisplayName(skill2, values);
      const displayName2 = prefix ? `${prefix} ${skillName2}` : skillName2;
      const rollcode2 = getRollcode(skill2, values);
      const safeRollcode2 = makeSafeRollcode(rollcode2);
      const diceCode2 = rollCodeToDiceCode(rollcode2);

      let delta2 = 0;
      if (specialized2 || values[`${skill2}_specialized`] === "(specialized)") {
        delta2 = ATTACK_SKILLS.includes(skill2) ? 1 : 3;
      }

      // ---- Shared bonuses ----
      const advantage = parseInt(values.advantage, 10) || 0;
      const delta = Math.max(delta1, delta2);
      const d20s = getOpenEndRolls(advantage + delta);
      const numOpenEnd = d20s.length - 1;

      if (d20s.length === 1) {
        if (delta <= 0 && d20s[0] <= 1 - advantage) {
          rollCombinedMishapTemplate({ name, displayName1, displayName2, diceCode1, diceCode2, safeRollcode1, safeRollcode2, whisper, d20s });
        } else {
          rollCombinedStandardTemplate({ name, displayName1, displayName2, diceCode1, diceCode2, safeRollcode1, safeRollcode2, whisper, d20s });
        }
      } else {
        rollCombinedOpenEndedTemplate({ name, displayName1, displayName2, diceCode1, diceCode2, safeRollcode1, safeRollcode2, numOpenEnd, whisper, d20s });
      }
    });
  }

  function rollMonsterSkill(skill) {
    const attrs = [
      "character_name",
      `${skill}_skill`,
      `${skill}_name`,
      "advantage",
      "whisper_toggle",
      "revived_toggle",
      "status",
      "condition_knockout",
      "character_immunities"
    ];

    getAttrs(attrs, values => {
      if (!canAct(values)) {
        rollErrorMessage(" You are not conscious and cannot act.");
        return;
      }

      const name = values.character_name || "Character";
      const whisper = values.whisper_toggle || "";
      const displayName = values[`${skill}_name`] || skill;
      const rollcode = (values[`${skill}_skill`] || "0D").replace(/D/g, "d6");
      const safeRollcode = makeSafeRollcode(rollcode);
      const diceCode = rollCodeToDiceCode(rollcode);
      const advantage = parseInt(values.advantage, 10) || 0;
      const d20s = getOpenEndRolls(advantage);
      const numOpenEnd = d20s.length - 1;

      if (d20s.length === 1) {
        if (d20s[0] <= 1-advantage) {
          rollMishapTemplate({ name, displayName, diceCode, safeRollcode, advantage, delta, whisper, d20s });
        } else {
          rollStandardTemplate({ name, displayName, diceCode, safeRollcode, whisper, d20s });
        }
      } else {
        rollOpenEndedTemplate({ name, displayName, diceCode, safeRollcode, numOpenEnd, whisper, d20s });
      }
    });
  }

  function getDisplayName(skill, values) {
    if (["firearm1", "firearm2", "firearm3", "ranged", "armed", "unarmed"].includes(skill)) {
      return `@{${skill}_weapon}`;
    }
    return values[`${skill}_displayname`] || skill;
  }

  function getRollcode(skill, values) {
    return values[`${skill}_rollcode`] || "0d6";
  }

  function makeSafeRollcode(rollcode) {
    return rollcode.replace(/(\d+)d6/g, "$1d6kh$1cs0cf0");
  }

  function diceToRollCode(input) {
    if (!input) return "0d6";

    // remove spaces and uppercase everything
    let cleaned = input.replace(/\s+/g, "").toUpperCase();

    // match dice code: Xd with optional +Y
    const match = cleaned.match(/^(\d+)D(?:\+(\d+))?$/);
    if (!match) return "0d6";

    const diceCount = parseInt(match[1], 10);
    const pips = match[2] ? `+${match[2]}` : "";

    return `${diceCount}d6${pips}`;
  }

  function toggleAllSections(expand = false) {
    const updates = {};
    SECTIONS.forEach(section => {
      updates[`toggle_${section}`] = expand ? "1" : "0";
    });
    setAttrs(updates);
  }

  function updateCharacterEncumbrance(force = false) {
    getAttrs([
      "equipped_weight_total",
      "character_enc_5",
      "character_enc_10",
      "character_enc_15",
      "character_enc_20",
      "character_enc_25",
      "encumbrance_visible"
    ], function(values) {
      if (values.encumbrance_visible !== "1" && !force) return;

      let totalPenalty = 0;
      let encumbranceText = "Not Encumbered";
      const weight = parseInt(values.equipped_weight_total) || 0;

      const thresholds = [
        { limit: parseInt(values.character_enc_5), penalty: 5, text: "-5 Move/Run" },
        { limit: parseInt(values.character_enc_10), penalty: 10, text: "-10 Move/Run" },
        { limit: parseInt(values.character_enc_15), penalty: 15, text: "-15 Move/Run" },
        { limit: parseInt(values.character_enc_20), penalty: 20, text: "-20 Move/Run" },
        { limit: parseInt(values.character_enc_25), penalty: 25, text: "-25 Move/Run" }
      ];

      for (let i = 0; i < thresholds.length; i++) {
        if (weight > thresholds[i].limit) {
          encumbranceText = thresholds[i].text;
          totalPenalty = thresholds[i].penalty;
        }
      }

      setAttrs({
        encumbrance_text: encumbranceText,
        encum_penalty_move: totalPenalty,
        encum_penalty_run: totalPenalty
      });
    });
  }

  function isSkillActive(value) {
    return value === undefined || value === "" || parseInt(value, 10) === 3;
  }

//********** START: ROLL TEMPLATES

  function rollStandardTemplate({ name, displayName, diceCode, safeRollcode, whisper, d20s }) {
    const d20 = d20s?.[0] || 0;

    const roll =
      `${whisper} &{template:d6plus} ` +
      `{{character=${name}}} ` +
      `{{name=${displayName}}} ` +
      `{{dice_code=${diceCode}}} ` +
      `{{roll=[[ ${safeRollcode} ]]}} ` +
      `{{d20=${d20}}}`;

    startRoll(roll, (results) => {
      const resultValue = results.results.roll.result || 0;

      if (displayName === "Dodge") {
        setAttrs({ dodge_value: resultValue });
      }

      finishRoll(results.rollId);
    });
  }

  function rollStandardTemplate({ name, displayName, diceCode, safeRollcode, whisper, d20s }) {
    const d20 = d20s?.[0] || 0;

    const roll =
      `${whisper} &{template:d6plus} ` +
      `{{character=${name}}} ` +
      `{{name=${displayName}}} ` +
      `{{dice_code=${diceCode}}} ` +
      `{{roll=[[ ${safeRollcode} ]]}} ` +
      `{{d20=${d20}}}`;

    startRoll(roll, (results) => {
      const resultValue = results.results.roll.result || 0;

      if (displayName === "Dodge") {
        setAttrs({ dodge_value: resultValue });
      }

      finishRoll(results.rollId);
    });
  }

  function rollCombinedStandardTemplate({ name, displayName1, displayName2, diceCode1, diceCode2, safeRollcode1, safeRollcode2, whisper, d20s }) {
    const d20 = d20s?.[0] || 0;

    const safeRollcode = `ceil(((${safeRollcode1}) + (${safeRollcode2})) / 2)`;

    const roll =
      `${whisper} &{template:combined} ` +
      `{{character=${name}}} ` +
      `{{name=Combined Skill Roll}} ` +
      `{{skill_1=${displayName1}}} ` +
      `{{dice_code_1=${diceCode1}}} ` +
      `{{skill_2=${displayName2}}} ` +
      `{{dice_code_2=${diceCode2}}} ` +
      `{{roll=[[ ${safeRollcode} ]]}} ` +
      `{{d20=${d20}}}`;

      startRoll(roll, (results) => {
        finishRoll(results.rollId);
      });
  }

  function rollMishapTemplate({ name, displayName, diceCode, safeRollcode, whisper, d20s }) {
    const roll =
      `${whisper} &{template:d6plus-mishap} ` +
      `{{character=${name}}} ` +
      `{{name=${displayName}}} ` +
      `{{dice_code=${diceCode}}} ` +
      `{{roll=[[ ${safeRollcode} ]]}} ` +
      `{{d20=${d20s[0]}}}`;

    startRoll(roll, (results) => finishRoll(results.rollId));
  }

  function rollCombinedMishapTemplate({
    name,
    displayName1,
    displayName2,
    diceCode1,
    diceCode2,
    safeRollcode1,
    safeRollcode2,
    whisper,
    d20s
  }) {
    const d20 = d20s?.[0] || 0;

    // Average with ceiling (same as combined standard)
    const safeRollcode = `ceil(((${safeRollcode1}) + (${safeRollcode2})) / 2)`;

    const roll =
      `${whisper} &{template:combined-mishap} ` +
      `{{character=${name}}} ` +
      `{{name=Combined Skill Roll}} ` +
      `{{skill_1=${displayName1}}} ` +
      `{{dice_code_1=${diceCode1}}} ` +
      `{{skill_2=${displayName2}}} ` +
      `{{dice_code_2=${diceCode2}}} ` +
      `{{roll=[[ ${safeRollcode} ]]}} ` +
      `{{d20=${d20}}}`;

    startRoll(roll, (results) => finishRoll(results.rollId));
  }

  function rollOpenEndedTemplate({ name, displayName, diceCode, safeRollcode, numOpenEnd, whisper, d20s }) {
    const fullExpression = Array(numOpenEnd + 1).fill(safeRollcode).join(" + ");
    const d20List = d20s.join(", ");

    const roll = `${whisper} &{template:d6plus-openend} ` +
      `{{character=${name}}} ` +
      `{{name=${displayName}}} ` +
      `{{dice_code=${diceCode}}} ` +
      `{{openends=${numOpenEnd}}} ` +
      `{{rolls=[[ ${fullExpression} ]]}} ` +
      `{{d20s=${d20List}}}`;

    startRoll(roll, results => finishRoll(results.rollId));
  }

  function rollCombinedOpenEndedTemplate({
    name,
    displayName1,
    displayName2,
    diceCode1,
    diceCode2,
    safeRollcode1,
    safeRollcode2,
    numOpenEnd,
    whisper,
    d20s
  }) {
    const d20List = d20s.join(", ");

    const baseRollcode = `ceil(((${safeRollcode1}) + (${safeRollcode2})) / 2)`;

    const safeNumOpenEnd = Math.max(0, parseInt(numOpenEnd, 10) || 0);
    const fullExpression = Array(safeNumOpenEnd + 1).fill(baseRollcode).join(" + ");

    const roll =
      `${whisper} &{template:combined-openend} ` +
      `{{character=${name}}} ` +
      `{{name=Combined Skill Roll}} ` +
      `{{skill_1=${displayName1}}} ` +
      `{{dice_code_1=${diceCode1}}} ` +
      `{{skill_2=${displayName2}}} ` +
      `{{dice_code_2=${diceCode2}}} ` +
      `{{openends=${safeNumOpenEnd}}} ` +
      `{{rolls=[[ ${fullExpression} ]]}} ` +
      `{{d20s=${d20List}}}`;

    startRoll(roll, results => finishRoll(results.rollId));
  }

//********** END: ROLL TEMPLATES

//********** START: CHARACTER BUILDING

  function getSkillBonuses(details) {
    const matches = [...details.matchAll(/\+(\d+)D\s+([^\n]+)/g)];
    const bonuses = {};
    const counts = {};

    matches.forEach(match => {
      const dice = parseInt(match[1], 10); // Number of dice
      const skill = match[2].trim().toLowerCase().replace(/\s+/g, "_");

      counts[skill] = (counts[skill] || 0) + dice;
    });

    Object.entries(counts).forEach(([skill, totalDice]) => {
      const dieValue = totalDice * 3;
      const cost = totalDice + 1;
      bonuses[`${skill}_value`] = dieValue;
      bonuses[`${skill}_string`] = `${totalDice}D`;
      bonuses[`${skill}_min`] = dieValue;
      bonuses[`${skill}_cost`] = cost;
      bonuses[`${skill}_refund`] = 0;
    });

    return bonuses;
  }

  function showBackgroundChoiceActivations(backgroundDetails) {
    const updates = {};

    const aviationPattern = /Activate: Any locked Aviation skill/i;
    updates.choose_background_activate_aviation = aviationPattern.test(backgroundDetails) ? 1 : 0;

    const maPattern = /Activate: One martial art/i;
    updates.choose_background_activate_ma = maPattern.test(backgroundDetails) ? 1 : 0;

    const sciencePattern = /Activate: Any science skill/i;
    updates.choose_background_activate_science = sciencePattern.test(backgroundDetails) ? 1 : 0;

    const knowledgePattern = /Activate: Any locked Knowledge skill/i;
    updates.choose_background_activate_knowledge = knowledgePattern.test(backgroundDetails) ? 1 : 0;

    const performancePattern = /Specialized: Any Performance skill/i;
    updates.choose_background_specialize_performance = performancePattern.test(backgroundDetails) ? 1 : 0;

    const physicalPattern = /Specialized: Any Physical skill/i;
    updates.choose_background_specialize_physical = physicalPattern.test(backgroundDetails) ? 1 : 0;

    const technicalPattern = /Specialized: Any Technical skill/i;
    updates.choose_background_specialize_technical = technicalPattern.test(backgroundDetails) ? 1 : 0;

    setAttrs(updates);
  }

  function showOriginChoiceActivations(originDetails) {
    const updates = {};

    //const aviationPattern = /Activate: Any locked Aviation skill/i;
    //updates.choose_origin_activate_aviation = aviationPattern.test(backgroundDetails) ? 1 : 0;

    const maPattern = /Activate: One martial art/i;
    updates.choose_origin_activate_ma = maPattern.test(originDetails) ? 1 : 0;

    //const sciencePattern = /Activate: Any science skill/i;
    //updates.choose_origin_activate_science = sciencePattern.test(backgroundDetails) ? 1 : 0;

    const knowledgePattern = /Activate: Any locked Knowledge skill/i;
    updates.choose_origin_activate_knowledge = knowledgePattern.test(originDetails) ? 1 : 0;

    //const performancePattern = /Specialized:\s*Any Performance skill/i;
    //updates.choose_origin_specialize_performance = performancePattern.test(backgroundDetails) ? 1 : 0;

    const physicalPattern = /Specialized: Any Physical skill/i;
    updates.choose_origin_specialize_physical = physicalPattern.test(originDetails) ? 1 : 0;

    const technicalPattern = /Specialized: Any Technical skill/i;
    updates.choose_origin_specialize_technical = technicalPattern.test(originDetails) ? 1 : 0;

    setAttrs(updates);
  }

  function showHobbyChoiceActivations(details) {
    const updates = {};

    const sciencePattern = /Activate: Any science skill/i;
    updates.choose_hobby_activate_science = sciencePattern.test(details) ? 1 : 0;

    const technicalPattern = /Specialized: Any Technical skill/i;
    updates.choose_hobby_specialize_technical = technicalPattern.test(details) ? 1 : 0;

    const maPattern = /Activate: One martial art/i;
    updates.choose_hobby_activate_ma = maPattern.test(details) ? 1 : 0;

    const performancePattern = /Specialized: Any Performance skill/i;
    updates.choose_hobby_specialize_performance = performancePattern.test(details) ? 1 : 0;

    const physicalPattern = /Specialized: Any Physical skill/i;
    updates.choose_hobby_specialize_physical = physicalPattern.test(details) ? 1 : 0;

    const animalsPattern = /Specialized: Any Animals skill/i;
    updates.choose_hobby_specialize_animals = animalsPattern.test(details) ? 1 : 0;

    setAttrs(updates);
  }

  function assignWealthBonuses(details) {
    const regex = /\+(\d+)\s+Wealth/gi;
    let totalWealth = 0;

    const matches = [...details.matchAll(regex)];
    matches.forEach(match => {
      const amount = parseInt(match[1], 10);
      if (!isNaN(amount)) {
        totalWealth += amount;
      }
    });

    setAttrs({ character_wealth: totalWealth });
  }

  function assignImmunities(details) {
    const matches = [...details.matchAll(/Immune to ([^\n]+)/gi)];
    const immunities = matches.map(match => match[1].trim());

    setAttrs({
      character_immunities: immunities.join(", ")
    });
  }

  function getSpecializations(details) {
    const matches = [...details.matchAll(/Specialized:\s*(.+)/gi)];

    if (matches.length === 0) return {};

    const result = {};
    for (const match of matches) {
      const skill = match[1].trim().toLowerCase().replace(/[\s-]+/g, "_");
      result[`${skill}_specialized`] = "(specialized)";
    }

    return result;
  }

  function getMovementBonus(details) {
    if (/5 extra move on Run Action/i.test(details)) {
      return {
        base_run: 35,
        current_run: 35
      };
    }
    return {};
  }

  function getActivatableSkills(details) {
    const updates = {};

    ACTIVATABLE_SKILLS.forEach(skill => {
      const readableName = skill.replace(/_/g, " ");
      const pattern = new RegExp(`Activate:\\s+${readableName}`, "gi");

      const matches = [...details.matchAll(pattern)];
      if (matches.length > 0) {
        updates[`${skill}_active`] = 3;
      }
    });

    return updates;
  }

  function addMultipleInventoryItems(items) {
    const all = {};
    items.forEach(({ name, qty = 1, weight = 0, location = "equipped", description = "" }) => {
      const rowId = generateRowID();
      const prefix = `repeating_inventory_${rowId}_`;

      all[`${prefix}item_name`] = name;
      all[`${prefix}item_qty`] = qty;
      all[`${prefix}item_weight`] = weight;
      all[`${prefix}item_location`] = location;
      all[`${prefix}item_description`] = description;
    });

    setAttrs(all, () => {
      updateCharacterEncumbrance(true);
    });
  }

  function updateActivationLine(combined, selection, matchString) {
    if (!selection || !matchString) return combined;

    // Escape special regex characters in matchString
    const escaped = matchString.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");

    // Match the line exactly (case-insensitive, trim optional newline)
    const pattern = new RegExp(escaped + "(?:\\r?\\n)?", "i");

    return combined.replace(pattern, `Activate: ${selection}\n`);
  }

  function updateSpecializeLine(combined, selection, matchString) {
    if (!selection || !matchString) return combined;

    // Escape special regex characters in matchString
    const escaped = matchString.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");

    // Match the line exactly (case-insensitive, trim optional newline)
    const pattern = new RegExp(escaped + "(?:\\r?\\n)?", "i");

    return combined.replace(pattern, `Specialized: ${selection}\n`);
  }

  function setupQuickNPC() {
    const updates = {
      base_move: 30,
      base_run: 30,
      current_move: 30,
      current_run: 30,
      advantage: 0,
      defaults_set: 1,
      spend_mode: 0,
      status: "Conscious",

      strength: 2,
      agility: 2,
      health: 2,
      perception: 2,
      quickness: 2,
      willpower: 2,
      intelligence: 2,
      manualdex: 2,
      charisma: 2,
    };

    setAttrs(updates, () => {
      getAttrs([...ATTRS], function (values) {
        const baseUpdates = {};

        ATTRS.forEach(attr => {
          const base = values[attr] || 0;
          baseUpdates[`${attr}_base_string`] = `${base}D`;
          baseUpdates[`${attr}_string`] = `${base}D`;
          baseUpdates[`${attr}_rollcode`] = `${base}d6`;
          baseUpdates[`${attr}_adjustment`] = 0;
          baseUpdates[`${attr}_conditions`] = 0;
        });

        setAttrs(baseUpdates);
      });
    });
  }

//********** END: CHARACTER BUILDING

//********** START: ACTION LOG

  function appendToActionLog(newLine, lock = null) {
  getAttrs(["action_log"], function(values) {
    const currentLog = values.action_log?.trim() || "";
    const updatedLog = currentLog ? `${currentLog}\n${newLine}` : newLine;

    const updates = { action_log: updatedLog };
    if (lock !== null) updates.actions_locked = lock;

    setAttrs(updates);
  });
}

  function clearActionLog() {
  setAttrs({ action_log: "" });
}

//********** END: ACTION LOG

  function updateActionCodes() {
    getAttrs([
      "actions_penalty",
      "action_skill",
      "reaction_skill"
    ], function(values) {
      const totalPenalty = parseInt(values.actions_penalty, 10) || 0;

      const updates = {};

      const actionSkill = values.action_skill;
      const reactionSkill = values.reaction_skill;

      if (actionSkill) {
        const adjusted = adjustDiceByAttackCount(actionSkill, totalPenalty);
        updates["action_actual"] = adjusted.actual;
      }

      setAttrs(updates);
    });
  }

  function adjustedByAttackCount(diceCode, callback) {
    getAttrs(["actions_penalty"], (values) => {
      const totalPenalty = parseInt(values.actions_penalty, 10) || 0;
      const adjusted = adjustDiceByAttackCount(diceCode, totalPenalty);

      callback(adjusted); // send it back to whoever called this
    });
  }

  function rollWeaponSkillIfActionsRemain(skill) {
  hasActionsRemaining((actionsRemaining) => {
    const newActionsRemaining = actionsRemaining - 1;

    const weaponAttr = skill === "ranged" ? "ranged_weapon" :
                        skill === "armed" ? "armed_weapon" :
                        skill === "unarmed"  ? "unarmed_weapon" : null;

    const lookupTable = skill === "ranged" ? RANGED_LOOKUP :
                        skill === "unarmed" ? MELEE_LOOKUP :
                        skill === "armed"  ? MELEE_LOOKUP  : null;

    if (weaponAttr && lookupTable) {
      getAttrs([weaponAttr, "shield"], values => {
        const weaponName = values[weaponAttr] || "Weapon";
        const shieldEquipped = values.shield || "None";
        const weaponData = lookupTable[weaponName] || {};

        // Special check: Shield Bash requires a shield equipped
        if (weaponName === "Shield Bash" && shieldEquipped === "None") {
          rollErrorMessage(" You must have a shield equipped to use Shield Bash.");
          return;
        }

        const doAction = () => {
          rollSkill(skill);


          appendToActionLog(
            `  Action: ${weaponName}\n\tActions remaining decreased by one: ${newActionsRemaining}`
          );
          setAttrs({ actions_remaining: newActionsRemaining});

        };

        if (weaponData.hands === "2H") {
          canUse2HWeapon(doAction); // Only allowed if not blocked
        } else {
          doAction();
        }
      });
    }
  });
}

//********** START: CONTESTS

  function chooseContestSkill(callback) {
  getAttrs(
    [
      "character_name",
      "whisper_toggle",

      "strength_string",
      "agility_string",
      "willpower_string",
      "quickness_string",

      // Disarm-related
      "athletics_string",
      "aikido_active", "aikido_string",
      "krav_maga_active", "krav_maga_string",

      // Grapple-related
      "wrestling_string",
      "capoeira_active", "capoeira_string",
      "jiu_jitsu_active", "jiu_jitsu_string",
      "savate_active", "savate_string",
      "judo_active", "judo_string"
    ],
    (values) => {
      const name = values.character_name || "Character";
      const whisper = values.whisper_toggle || "";

      const messageRoll =
        `${whisper} &{template:d6plus-message} ` +
        `{{name=${name}}} ` +
        `{{message=Contest Roll}} ` +
        `{{roll=[[0d0+?{Choose Contest Type|Strength,0|Agility,1|Willpower,2|Quickness,3|Break Grapple,4|Disarm,5}]]}}`;

      startRoll(messageRoll, (results) => {
        const choice = results.results.roll.result;

        let chosenSkill = "Unknown";
        let diceCode = "0D"; // fallback dice string

        switch (choice) {
          case 0:
            chosenSkill = "Strength";
            diceCode = values.strength_string || "0D";
            break;
          case 1:
            chosenSkill = "Agility";
            diceCode = values.agility_string || "0D";
            break;
          case 2:
            chosenSkill = "Willpower";
            diceCode = values.willpower_string || "0D";
            break;
          case 3:
            chosenSkill = "Quickness";
            diceCode = values.quickness_string || "0D";
            break;

          case 4: { // Grapple
            const totalPenalty = parseInt(values.actions_penalty, 10) || 0;

            const skills = [];

            // Wrestling is always available
            skills.push({
              name: "Wrestling",
              dice: adjustDiceByAttackCount(values.wrestling_string, totalPenalty).actual
            });

            if (isSkillActive(values.capoeira_active)) {
              skills.push({
                name: "Capoeira",
                dice: adjustDiceByAttackCount(values.capoeira_string, totalPenalty).actual
              });
            }
            if (isSkillActive(values.jiu_jitsu_active)) {
              skills.push({
                name: "Jiu-Jitsu",
                dice: adjustDiceByAttackCount(values.jiu_jitsu_string, totalPenalty).actual
              });
            }
            if (isSkillActive(values.savate_active)) {
              skills.push({
                name: "Savate",
                dice: adjustDiceByAttackCount(values.savate_string, totalPenalty).actual
              });
            }
            if (isSkillActive(values.judo_active)) {
              skills.push({
                name: "Judo",
                dice: adjustDiceByAttackCount(values.judo_string, totalPenalty).actual
              });
            }

            // Pick the best by comparing expected pip values
            skills.sort((a, b) => diceCodeToPips(b.dice) - diceCodeToPips(a.dice));

            chosenSkill = skills[0].name;
            diceCode   = skills[0].dice;
            break;
          }

          case 5: { // Disarm
            const totalPenalty = parseInt(values.actions_penalty, 10) || 0; // already available in your attrs

            const skills = [];

            // Athletics is always available
            skills.push({
              name: "Athletics",
              dice: adjustDiceByAttackCount(values.athletics_string, totalPenalty).actual
            });
            if (isSkillActive(values.aikido_active)) {
              skills.push({
                name: "Aikido",
                dice: adjustDiceByAttackCount(values.aikido_string, totalPenalty).actual
              });
            }
            if (isSkillActive(values.krav_maga_active)) {
              skills.push({
                name: "Krav Maga",
                dice: adjustDiceByAttackCount(values.krav_maga_string, totalPenalty).actual
              });
            }

            skills.sort((a, b) => diceCodeToPips(b.dice) - diceCodeToPips(a.dice));

            chosenSkill = skills[0].name;
            diceCode = skills[0].dice;
            break;
          }

          default:
            chosenSkill = "Unknown";
            diceCode = "0D";
            break;
        }
        finishRoll(results.rollId, {});
        callback({ name: chosenSkill, dice: diceToRollCode(diceCode) });
      });
    }
  );
}

//********** END: CONTESTS

  ATTRS.forEach(attrName => {
    on(`change:${attrName}_adjustment`, () => updateActual(attrName));
    on(`change:${attrName}_conditions`, () => updateActual(attrName));
    on(`change:${attrName}`, () => updateActual(attrName));
  });

  ATTRS.forEach(attr => {
    on(`clicked:${attr}`, () => rollSkill(attr));
  });

  Object.keys(SKILL_STATS).forEach(skill => {
    const code = SKILL_STATS[skill];
    const stats = [...new Set(code.split(""))]; // Remove duplicates like "AAS"
    const actualStats = stats.map(letter => `change:${LETTER_TO_ATTR[letter]}_rollcode`);
    const eventString = actualStats.join(" ");

    on(eventString, () => updateSkillFromStats(skill));
  });

  SKILL_GROUP_LIST.forEach(group => {

    on(`clicked:add_${group}`, () => handleTraining(group));
    on(`clicked:refund_${group}`, () => handleUndo(group));

    const skills = getSkillsByGroup(group);
    skills.forEach(skill => {
      on(`clicked:${skill}`, () => rollSkill(skill));
      //on(`clicked:qualified_${skill}`, () => rollQualifiedSkill(skill));
    });
  });

  ACTIVATABLE_SKILLS.forEach(skillName => {
    on(`clicked:activate_${skillName}`, function() {
      getAttrs(["skill_points", `${skillName}_active`], function(values) {
        const skillPoints = parseInt(values.skill_points, 10) || 0;
        const skillActive = values[`${skillName}_active`] === "3";

        if (skillActive) {
          // Already active, no need to do anything
          return;
        }

        if (skillPoints < 12) {
          const skillTitle = skillName.charAt(0).toUpperCase() + skillName.slice(1);
          rollErrorMessage(` Activate ${skillTitle} Failed: Not enough skill points (need 12)`);
          return;
        }

        // Enough points - activate the skill
        const update = {};
        update[`${skillName}_active`] = "2";
        update["skill_points"] = skillPoints - 12;

        setAttrs(update, function() {
          updateSkillFromStats(skillName);
        });
      });
    });

    on(`clicked:undo_activate_${skillName}`, function() {
      getAttrs(["skill_points"], function(values) {
        const skillPoints = parseInt(values.skill_points, 10) || 0;

        // Refund skill points and reset to Not Activated (0)
        const update = {};
        update[`${skillName}_active`] = "1";
        update["skill_points"] = skillPoints + 12;

        setAttrs(update, function() {
          updateSkillFromStats(skillName);
        });
      });
    });
  });

  on("sheet:opened", function() {
    setSkillAttributeCodes();
    setSkillGroups();
    initSkillGroupsIfUnset();

    ATTRS.forEach(attr => updateActual(attr));
    Object.keys(SKILL_STATS).forEach(updateSkillFromStats);
  });

  on("clicked:enter_spend", function() {
    enterSpendMode();
  });

  on("clicked:commit_spend", function() {
    commitSpend();
  });

  on("clicked:end_turn", function() {
    clearActionLog();

    const updates = {
      num_declared_actions: 1,
      actions_locked: "0",
      actions_penalty: 0
    };

    setAttrs(updates, function() {
      clearActionLog();
    });
  });

  on("change:num_declared_actions", function() {
    getAttrs(["num_declared_actions"], function(values) {
      const num = parseInt(values.num_declared_actions, 10) || 0;

      const updates = {
        actions_penalty: (num - 1) + "D"
      };

      setAttrs(updates);
    });
  });

  on("clicked:start_turn", function() {
    getAttrs(["num_declared_actions", "has_run", "has_moved", "is_auto_burst", "vehicle_drive_adjustment"], function(values) {
      const num = parseInt(values.num_declared_actions, 10) || 0;
      const multiActionPenalty = (num - 1) + "D";

      const updates = {
        has_run: "0",
        has_moved: "0",
        is_auto_burst: "0",
        vehicle_drive_adjustment: "0",
        actions_locked: "1",
        actions_remaining: num,
        actions_penalty: multiActionPenalty
      };

      setAttrs(updates, function() {
        let log = `START OF ROUND\n  ${num} declared action(s)\n\tMulti-action penalty starts at: ${multiActionPenalty}`;
        appendToActionLog(log);
      });

      updateActionCodes();
      updateSkillFromStats("vehicle_speed");
      updateSkillFromStats("vehicle_dodge");
      updateSkillFromStats("vehicle_avoid");
      updateSkillFromStats("vehicle_keep_control");
      updateSkillFromStats("vehicle_stunt");
      updateSkillFromStats("vehicle_impede");
      updateSkillFromStats("vehicle_obstruct");
    });
  });

  on("change:selected_reaction", function(eventInfo) {
    const skill = eventInfo.newValue;

    if (!skill) {
      setAttrs({
        reaction_skill: " "
      });
      return;
    }

    const rollAttr = `${skill}_string`;
    const activeAttr = `${skill}_active`;

    getAttrs([rollAttr, activeAttr], values => {
      const isActive = isSkillActive(values[activeAttr]);
      const skillValue = isActive ? values[rollAttr] : "Not Active";

      setAttrs({
        reaction_skill: skillValue
      });
    });
  });

  on("change:selected_skill", function(eventInfo) {
    const skill = eventInfo.newValue;

    if (!skill) {
      setAttrs({
        action_actual: " ",
        action_skill: " "
       });
      return;
    }

    const rollAttr = `${skill}_string`;
    const activeAttr = `${skill}_active`;

    getAttrs([rollAttr, activeAttr], values => {
      const isActive = isSkillActive(values[activeAttr]);
      const skillValue = isActive ? values[rollAttr] : "Not Active";

      setAttrs({ action_skill: skillValue });
      updateActionCodes();
    });
  });

  on("change:searched_skill", function(eventInfo) {
    const skill = eventInfo.newValue;

    if (!skill) {
      setAttrs({
        searched_action_skill: " ",
        searched_skill_specialized: ""
      });
      return;
    }

    const rollAttr = `${skill}_string`;
    const activeAttr = `${skill}_active`;
    const specializedAttr = `${skill}_specialized`;

    getAttrs([rollAttr, activeAttr, specializedAttr], values => {
      const isActive = isSkillActive(values[activeAttr]);
      const skillValue = isActive ? values[rollAttr] : "Not Active";

      const specializedValue =
        values[specializedAttr] === "(specialized)" ? "(specialized)" : " ";

      setAttrs({
        searched_action_skill: skillValue,
        searched_skill_specialized: specializedValue
      });
    });
  });

  on("change:combined_skill_1", function(eventInfo) {
    const skill = eventInfo.newValue;

    if (!skill) {
      setAttrs({
        combined_action_skill_1: " ",
        combined_skill_specialized_1: ""
      });
      return;
    }

    const rollAttr = `${skill}_string`;
    const activeAttr = `${skill}_active`;
    const specializedAttr = `${skill}_specialized`;

    getAttrs([rollAttr, activeAttr, specializedAttr], values => {
      const isActive = isSkillActive(values[activeAttr]);
      const skillValue = isActive ? values[rollAttr] : "Not Active";

      const specializedValue =
        values[specializedAttr] === "(specialized)" ? "(specialized)" : " ";

      setAttrs({
        combined_action_skill_1: skillValue,
        combined_skill_specialized_1: specializedValue
      });
    });
  });

  on("change:combined_skill_2", function(eventInfo) {
    const skill = eventInfo.newValue;

    if (!skill) {
      setAttrs({
        combined_action_skill_2: " ",
        combined_skill_specialized_2: ""
      });
      return;
    }

    const rollAttr = `${skill}_string`;
    const activeAttr = `${skill}_active`;
    const specializedAttr = `${skill}_specialized`;

    getAttrs([rollAttr, activeAttr, specializedAttr], values => {
      const isActive = isSkillActive(values[activeAttr]);
      const skillValue = isActive ? values[rollAttr] : "Not Active";

      const specializedValue =
        values[specializedAttr] === "(specialized)" ? "(specialized)" : " ";

      setAttrs({
        combined_action_skill_2: skillValue,
        combined_skill_specialized_2: specializedValue
      });
    });
  });

  on("clicked:selected_skill_roll", () => {
    getAttrs(["selected_skill"], ({ selected_skill: skill }) => {
      if (!skill) return;

      const activeAttr = `${skill}_active`;
      const displayNameAttr = `${skill}_displayname`;

      getAttrs([activeAttr, displayNameAttr, "action_actual"], values => {
        const isActive = isSkillActive(values[activeAttr]);
        if (!isActive) return;

        const skillDisplayName = values[displayNameAttr] || skill;
        const rollCode = (values.action_actual || "").replace(/D/g, "d6");

        hasActionsRemaining((actionsRemaining) => {
          const newActionsRemaining = actionsRemaining - 1;

          rollSkill(skill, rollCode);
          appendToActionLog(
            `  Action: ${skillDisplayName}\n\tActions remaining decreased by one: ${newActionsRemaining}`
          );

          setAttrs({ actions_remaining: newActionsRemaining});
        });
      });
    });
  });

  on("clicked:searched_skill_roll", () => {
    getAttrs(["searched_skill"], ({ searched_skill: skill }) => {
      if (!skill) return;

      const activeAttr = `${skill}_active`;
      const displayNameAttr = `${skill}_displayname`;

      getAttrs([activeAttr, displayNameAttr, "searched_action_skill"], values => {
        const isActive = isSkillActive(values[activeAttr]);
        if (!isActive) return;

        const skillDisplayName = values[displayNameAttr] || skill;
        const rollCode = (values.searched_action_skill || "").replace(/D/g, "d6");

        rollSkill(skill, rollCode);
      });
    });
  });

  on("clicked:combined_skill_roll", () => {
    getAttrs(["combined_skill_1", "combined_skill_2"], ({ combined_skill_1, combined_skill_2 }) => {
      if (!combined_skill_1 || !combined_skill_2) return;

      const activeAttr1 = `${combined_skill_1}_active`;
      const displayNameAttr1 = `${combined_skill_1}_displayname`;
      const actionSkillAttr1 = "combined_action_skill_1";

      const activeAttr2 = `${combined_skill_2}_active`;
      const displayNameAttr2 = `${combined_skill_2}_displayname`;
      const actionSkillAttr2 = "combined_action_skill_2";

      getAttrs(
        [activeAttr1, displayNameAttr1, actionSkillAttr1,
         activeAttr2, displayNameAttr2, actionSkillAttr2],
        values => {
          const isActive1 = isSkillActive(values[activeAttr1]);
          const isActive2 = isSkillActive(values[activeAttr2]);
          if (!isActive1 || !isActive2) return;

          const skillDisplayName1 = values[displayNameAttr1] || combined_skill_1;
          const skillDisplayName2 = values[displayNameAttr2] || combined_skill_2;

          const rollCode1 = (values[actionSkillAttr1] || "").replace(/D/g, "d6");
          const rollCode2 = (values[actionSkillAttr2] || "").replace(/D/g, "d6");

          rollCombinedSkills(combined_skill_1, combined_skill_2);
        }
      );
    });
  });

  on("clicked:selected_vehicle_reaction_roll", () => {
    getAttrs(["selected_skill"], values => {
      const skill = values.selected_skill;
      if (!skill) return;

      blockIfAiming(() => {   //  guard reactions if Aiming is active
        const activeAttr = `${skill}_active`;

        getAttrs([activeAttr, "actions_penalty", "action_skill"], subvalues => {
          if (isSkillActive(subvalues[activeAttr])) {
            const rollCode = (subvalues.action_skill || "").replace(/D/g, "d6");
            rollSkill(skill, rollCode);
          }

          const currentPenalty = parseInt(subvalues.actions_penalty, 10) || 0;
          const newPenalty = currentPenalty + 1;

          appendToActionLog(
            `  Reaction: ${skill}\n\tMulti-action penalty increased by one: ${newPenalty}D`
          );

          setAttrs({ actions_penalty: newPenalty }, updateActionCodes);
        });
      });
    });
  });

  on("clicked:selected_reaction_roll", () => {
    getAttrs(["selected_reaction"], values => {
      const skill = values.selected_reaction;
      if (!skill) return;

      blockIfAiming(() => {   //  guard reactions if Aiming is active
        const activeAttr = `${skill}_active`;

        getAttrs([activeAttr, "actions_penalty", "reaction_skill"], subvalues => {
          if (isSkillActive(subvalues[activeAttr])) {
            const rollCode = (subvalues.reaction_skill || "").replace(/D/g, "d6");
            rollSkill(skill, rollCode);
          }

          const currentPenalty = parseInt(subvalues.actions_penalty, 10) || 0;
          const newPenalty = currentPenalty + 1;

          appendToActionLog(
            `  Reaction: ${skill}\n\tMulti-action penalty increased by one: ${newPenalty}D`
          );

          setAttrs({ actions_penalty: newPenalty }, updateActionCodes);
        });
      });
    });
  });

  on("clicked:run", () => {
    getAttrs(["actions_remaining", "character_name", "whisper_toggle", "has_run"], subvalues => {
      const actionsRemaining = parseInt(subvalues.actions_remaining, 10) || 0;
      const hasRun = parseInt(subvalues.has_run, 10) || 0;

      if (actionsRemaining <= 0) {
        rollErrorMessage(" You have no actions remaining this round.");
        return;
      }
      if(hasRun) {
        rollErrorMessage(" You can only run once per round.");
        return;
      }
      const newActionsRemaining = actionsRemaining - 1;

      const name = subvalues.character_name || "Character";
      const whisper = subvalues.whisper_toggle || "";

      // Chat log message
      const messageRoll =
        `${whisper} &{template:d6plus-message} ` +
        `{{name=${name}}} ` +
        `{{message=You can move up to your Run Code.}}`;

      startRoll(messageRoll, (results) => finishRoll(results.rollId));

      appendToActionLog(`  Action: Run\n\tActions remaining decreased by one: ${newActionsRemaining}`);
      setAttrs({
        has_run: "1",
        actions_remaining: newActionsRemaining.toString()
      });
    });
  });

  on("clicked:vehicle_move", () => {
    getAttrs(
      [
        "actions_remaining",
        "character_name",
        "whisper_toggle",
        "has_moved",
        "vehicle_speed_string",
        "status",
        "move_multiplier",
        "time_scale"
      ],
      (values) => {
        const actionsRemaining = parseInt(values.actions_remaining, 10) || 0;
        const hasMoved = parseInt(values.has_moved, 10) || 0;
        const ableToAct = canAct(values);

        if (!ableToAct) {
          rollErrorMessage(" This vehicle is inoperable and cannot act.");
          return;
        }

        if (hasMoved) {
          rollErrorMessage(" You can only move once per round.");
          return;
        }

        const name = values.character_name || "Character";
        const whisper = values.whisper_toggle || "";
        const speedString = values.vehicle_speed_string || "0D";

        // Convert "3D+1"  "3d6+1"
        const rollExpr = makeSafeRollcode(
          (speedString || "0D").replace(/D/g, "d6")
        );

        const diceCode = speedString;
        let baseMult = (values.move_multiplier === "city") ? 10 : 20;

        // scale factor from time_scale
        const timeScale = parseInt(values.time_scale, 10) || 3;
        let scaleFactor = 1;
        if (timeScale === 15) scaleFactor = 5;
        else if (timeScale === 30) scaleFactor = 10;

        // final multiplier
        const moveMult = baseMult * scaleFactor;

        const tpl =
          `${whisper} &{template:speed} ` +
          `{{character=${name}}} ` +
          `{{move_type=Move}} ` +
          `{{dice_code=${diceCode}}} ` +
          `{{move_code=[[ floor( (${rollExpr}) * ${moveMult} ) ]]}}`;
        startRoll(tpl, (r) => finishRoll(r.rollId));

        const newActionsRemaining = actionsRemaining - 1;

        appendToActionLog(`  Action: Move\n\tActions remaining decreased by one: ${newActionsRemaining}`);
        setAttrs({
          has_moved: "1",
          actions_remaining: newActionsRemaining.toString()
        });
      }
    );
  });

  on("clicked:accelerate", () => {
    getAttrs(
      [
        "actions_penalty",
        "character_name",
        "whisper_toggle",
        "has_run",
        "vehicle_speed_string",
        "status",
        "move_multiplier",
        "time_scale"
      ],
      (values) => {
        const hasRun = parseInt(values.has_run, 10) || 0;
        const ableToAct = canAct(values);

        if (!ableToAct) {
          rollErrorMessage(" This vehicle is inoperable and cannot act.");
          return;
        }

        if (hasRun) {
          rollErrorMessage(" You can only accelerate once per round.");
          return;
        }

        const name = values.character_name || "Character";
        const whisper = values.whisper_toggle || "";
        const speedString = values.vehicle_speed_string || "0D";

        // Convert "3D+1"  "3d6+1"
        const rollExpr = makeSafeRollcode(
          (speedString || "0D").replace(/D/g, "d6")
        );

        const diceCode = speedString;
        let baseMult = (values.move_multiplier === "city") ? 10 : 20;

        // scale factor from time_scale
        const timeScale = parseInt(values.time_scale, 10) || 3;
        let scaleFactor = 1;
        if (timeScale === 15) scaleFactor = 5;
        else if (timeScale === 30) scaleFactor = 10;

        // final multiplier
        const moveMult = baseMult * scaleFactor;

        const tpl =
          `${whisper} &{template:speed} ` +
          `{{character=${name}}} ` +
          `{{move_type=Accelerate}} ` +
          `{{dice_code=${diceCode}}} ` +
          `{{move_code=[[ floor( (${rollExpr}) * ${moveMult} ) ]]}}`;
        startRoll(tpl, (r) => finishRoll(r.rollId));

        const currentPenalty = parseInt(values.actions_penalty, 10) || 0;
        const newPenalty = currentPenalty + 1;

        appendToActionLog(
          `  Action: Accelerate\n\tMulti-action penalty increased by one: ${newPenalty}D`
        );

        setAttrs({
          has_run: "1",
          actions_penalty: newPenalty
        });
      }
    );
  });

  on("clicked:help", () => {
    getAttrs(["actions_remaining", "character_name", "whisper_toggle"], subvalues => {
      const actionsRemaining = parseInt(subvalues.actions_remaining, 10) || 0;

      if (actionsRemaining <= 0) {
        rollErrorMessage(" You have no actions remaining this round.");
        return;
      }
      const newActionsRemaining = actionsRemaining - 1;

      const name = subvalues.character_name || "Character";
      const whisper = subvalues.whisper_toggle || "";

      // Chat log message
      const messageRoll =
        `${whisper} &{template:d6plus-message} ` +
        `{{name=${name}}} ` +
        `{{message=You can add pips-of-dice to another character's skill check.}}`;

      startRoll(messageRoll, (results) => finishRoll(results.rollId));

      appendToActionLog(`  Action: Help\n\tActions remaining decreased by one: ${newActionsRemaining}`);
      setAttrs({
        actions_remaining: newActionsRemaining.toString()
      });
    });
  });

  on("clicked:contest_init", () => {
    getAttrs(["actions_remaining", "actions_penalty"], (values) => {
      let actionsRemaining = parseInt(values.actions_remaining, 10) || 0;

      if (actionsRemaining <= 0) {
        rollErrorMessage(" You have no actions remaining this round.");
        return;
      }

      //  Now ask for contest skill
      chooseContestSkill(({ name, dice }) => {
        const newActionsRemaining = actionsRemaining - 1;

        rollSkill(name, dice);
        appendToActionLog(
          `  Action: Initiate Contest (${name})\n\tActions remaining decreased by one: ${newActionsRemaining}`
        );

        setAttrs({ actions_remaining: newActionsRemaining }, updateActionCodes);
      });
    });
  });

  on("clicked:aim", () => {
    getAttrs(["actions_penalty", "actions_remaining", "character_name", "whisper_toggle"], subvalues => {
      const actionsRemaining = parseInt(subvalues.actions_remaining, 10) || 0;
      const actionPenalty = parseInt(subvalues.actions_penalty, 10) || 0;

      if (actionsRemaining != 1 || actionPenalty > 0) {
        rollErrorMessage(" You cannot aim unless it is all you do this round.");
        return;
      }
      const newActionsRemaining = actionsRemaining - 1;

      const name = subvalues.character_name || "Character";
      const whisper = subvalues.whisper_toggle || "";

      // Chat log message
      const messageRoll =
        `${whisper} &{template:d6plus-message} ` +
        `{{name=${name}}} ` +
        `{{message=You have gained the Aiming condition. You cannot not move or react until you turn it off.}}`;

      startRoll(messageRoll, (results) => finishRoll(results.rollId));

      appendToActionLog(`  Action: Aiming, ranged TN reduced by 5\n\tActions remaining decreased by one: ${newActionsRemaining}`);
      setAttrs({
        actions_remaining: newActionsRemaining.toString(),
        condition_aiming: "on"
      });
    });
  });

  on("clicked:out_of_turn", () => {
    blockIfAiming(() => {   //  guard against Aiming condition
      getAttrs(
        ["actions_penalty", "actions_remaining", "character_name", "whisper_toggle"],
        (subvalues) => {
          const actionsRemaining = parseInt(subvalues.actions_remaining, 10) || 0;

          if (actionsRemaining <= 0) {
            rollErrorMessage(" You have no actions remaining this round.");
            return;
          }

          const currentPenalty = parseInt(subvalues.actions_penalty, 10) || 0;
          const newPenalty = currentPenalty + 1;
          const name = subvalues.character_name || "Character";
          const whisper = subvalues.whisper_toggle || "";

          // Chat log message
          const messageRoll =
            `${whisper} &{template:d6plus-message} ` +
            `{{name=${name}}} ` +
            `{{message=Your next action this round can happen outside your own turn.}}`;

          startRoll(messageRoll, (results) => finishRoll(results.rollId));

          appendToActionLog(
            `  Your next action this round can happen outside your own turn\n\tMulti-action penalty increased by one: ${newPenalty}D`
          );

          setAttrs({ actions_penalty: newPenalty }, updateActionCodes);
        }
      );
    });
  });

  on("clicked:check_wealth", () => {
    const attrs = [
      "character_name",
      "whisper_toggle",
      "character_wealth"
    ];

    getAttrs(attrs, values => {
      const wealth = values.character_wealth || "0";
      const name = values.character_name || "Character";
      const whisper = values.whisper_toggle || "";
      const displayName = "Wealth";

      let dice = parseInt(wealth, 10);
      if (isNaN(dice) || dice <= 0) {
        dice = 0;
      }

      const rollcode = `${dice}d6`;
      const safeRollcode = makeSafeRollcode(rollcode);
      const diceCode = rollCodeToDiceCode(rollcode);

      const d20s = getOpenEndRolls(0);
      const numOpenEnd = d20s.length - 1;

      if (d20s.length === 1) {
        if (d20s[0] <= 1 - advantage) {
          rollMishapTemplate({ name, displayName, diceCode, safeRollcode, advantage, delta, whisper, d20s });
        } else {
          rollStandardTemplate({ name, displayName, diceCode, safeRollcode, whisper, d20s });
        }
      } else {
        rollOpenEndedTemplate({ name, displayName, diceCode, safeRollcode, numOpenEnd, whisper, d20s });
      }
    });
  });

  on("clicked:switch_targets", () => {
    blockIfAiming(() => {   //  prevent switching targets if Aiming is active
      getAttrs(
        ["actions_penalty", "actions_remaining", "character_name", "whisper_toggle"],
        (subvalues) => {
          const actionsRemaining = parseInt(subvalues.actions_remaining, 10) || 0;

          if (actionsRemaining <= 0) {
            rollErrorMessage(" You have no actions remaining this round.");
            return;
          }

          const currentPenalty = parseInt(subvalues.actions_penalty, 10) || 0;
          const newPenalty = currentPenalty + 1;
          const name = subvalues.character_name || "Character";
          const whisper = subvalues.whisper_toggle || "";

          const messageRoll =
            `${whisper} &{template:d6plus-message} ` +
            `{{name=${name}}} ` +
            `{{message=Your next attack this round can be against a new target.}}`;

          startRoll(messageRoll, (results) => finishRoll(results.rollId));

          appendToActionLog(
            `  Your next attack this round can be against a new target\n\tMulti-action penalty increased by one: ${newPenalty}D`
          );

          setAttrs({ actions_penalty: newPenalty }, updateActionCodes);
        }
      );
    });
  });

  on("clicked:contest_reaction", () => {
    blockIfAiming(() => {
      chooseContestSkill(({ name, dice }) => {
        getAttrs(["actions_penalty"], (values) => {
          const currentPenalty = parseInt(values.actions_penalty, 10) || 0;
          const newPenalty = currentPenalty + 1;

          rollSkill(name, dice);
          appendToActionLog(
            `  Reaction: Resist Contest (${name})\n\tMulti-action penalty increased by one: ${newPenalty}D`
          );

          setAttrs(
            { actions_penalty: newPenalty },
            updateActionCodes
          );
        });
      });
    });
  });

  on("clicked:auto_burst", () => {
    blockIfAiming(() => {   //  block burst reaction if Aiming is active
      getAttrs(
        ["actions_penalty", "actions_remaining", "character_name", "whisper_toggle", "is_auto_burst"],
        (subvalues) => {
          const actionsRemaining = parseInt(subvalues.actions_remaining, 10) || 0;

          if (actionsRemaining <= 0) {
            rollErrorMessage(" You have no actions remaining this round.");
            return;
          }

          const currentPenalty = parseInt(subvalues.actions_penalty, 10) || 0;
          const newPenalty = currentPenalty + 1;
          const name = subvalues.character_name || "Character";
          const whisper = subvalues.whisper_toggle || "";

          const messageRoll =
            `${whisper} &{template:d6plus-message} ` +
            `{{name=${name}}} ` +
            `{{message=If your next attack this round is an automatic weapon, it will be a 3-bullet burst.}}`;

          startRoll(messageRoll, (results) => finishRoll(results.rollId));

          appendToActionLog(
            `  If your next attack this round is an automatic weapon, it will be a 3-bullet burst.` +
            `\n\tMulti-action penalty increased by one: ${newPenalty}D`
          );

          setAttrs(
            {
              actions_penalty: newPenalty,
              is_auto_burst: 1
            },
            updateActionCodes // run update after setAttrs
          );
        }
      );
    });
  });

  on("change:wounds_total change:first_aid_count change:health_string", function () {
    getAttrs(["wounds_total", "first_aid_count", "health_string"], function (values) {
      const woundsTotal = parseInt(values.wounds_total) || 0;
      const firstAidCount = parseInt(values.first_aid_count) || 0;
      const healthString = values.health_string || "0D";

      const healthMatch = healthString.match(/^(\d+)D/i);
      const health = healthMatch ? parseInt(healthMatch[1], 10) : 0;

      const targetNumber = woundsTotal + (5 * firstAidCount);

      const death_threshold = 10 + 6 * health;
      const uncons_threshold = 10 + 3 * health; // <-- remove fallback here, it's redundant

      let status = "Conscious";
      if (woundsTotal >= death_threshold) {
        status = "Dead";
      } else if (woundsTotal >= uncons_threshold) {
        status = "Unconscious";
      }

      setAttrs({
        first_aid_target: targetNumber,
        status: status,
        death_threshold: death_threshold,
        unconscious_threshold: uncons_threshold,
      });
    });
  });

  on("change:wounds_total change:wounds_ignored", function() {
    getAttrs(["wounds_total", "wounds_ignored"], function(values) {
      const total = parseInt(values.wounds_total) || 0;
      let ignored = parseInt(values.wounds_ignored) || 0;

      // Enforce that wounds_ignored cannot exceed wounds_total
      if (ignored > total) {
        ignored = total;
      }

      const penalty = Math.max(total - ignored, 0);
      const woundPenalty = Math.ceil(penalty/3);

      setAttrs({
        wounds_ignored: ignored,
        skillcheck_wound_penalty: woundPenalty
      });
    });
  });

  on("clicked:end_combat", function() {
    setAttrs({
      wounds_ignored: 0,
      first_aid_count: 0
    });
  });

  on("clicked:revive", function () {
    getAttrs(["status"], function (values) {
      if (values.status !== "Dead") {
        setAttrs({ status: "Conscious" });
      }
    });
  });

  on("change:condition_mounted", function() {
    getAttrs(["condition_mounted", "no_mounted_penalty"], function(values) {
      if(values.no_mounted_penalty) {
        return;
      }
      const checked = values.condition_mounted === "on";
      let penalty = 0;
      if(checked) {
        penalty = 5;
      }

      setAttrs({
        skillcheck_mounted_penalty: penalty
      });
    });
  });

  on("change:condition_aiming", (eventInfo) => {
    if (eventInfo.newValue === "on" && eventInfo.sourceType === "player") {
      // Block manual enabling
      setAttrs({
        condition_aiming: eventInfo.previousValue || "",  // reset to empty, not "0"
        skillcheck_aiming_bonus: 0
      });
      rollErrorMessage(" You cannot manually enable the Aiming condition. It must be enabled as a combat action.");
      return;
    }

    if (eventInfo.newValue === "on") {
      setAttrs({ skillcheck_aiming_bonus: -5 });
    } else {
      setAttrs({ skillcheck_aiming_bonus: 0 });
    }
  });

  on("change:skillcheck_cr change:skillcheck_modifier change:skillcheck_wound_penalty change:skillcheck_mounted_penalty change:armor_penalty", function() {
    getAttrs(["skillcheck_cr", "skillcheck_modifier", "skillcheck_help", "skillcheck_wound_penalty", "skillcheck_mounted_penalty", "armor_penalty"], function(values) {
      const cr = parseInt(values.skillcheck_cr) || 0;
      const modifier = parseInt(values.skillcheck_modifier) || 0;
      const woundPenalty = parseInt(values.skillcheck_wound_penalty) || 0;
      const armorPenalty = parseInt(values.armor_penalty) || 0;
      const mountedPenalty = parseInt(values.skillcheck_mounted_penalty) || 0;

      let target = cr + modifier + woundPenalty + armorPenalty + mountedPenalty;
      if(target <0) {
        target = 0;
      }

      setAttrs({
        skill_check_target: target
      });
    });
  });

  on("change:combat_range change:combat_cover change:combat_opponent_dodge change:combat_opponent_armor change:combat_unaware change:combat_modifier change:skillcheck_wound_penalty change:armor_penalty change:skillcheck_mounted_penalty, change:skillcheck_aiming_bonus", function() {
    getAttrs([
      "combat_range", "combat_cover", "combat_opponent_dodge", "combat_opponent_armor", "combat_unaware", "combat_modifier",
      "skillcheck_wound_penalty", "skillcheck_mounted_penalty", "skillcheck_aiming_bonus", "armor_penalty"
    ], function(values) {
      const range = parseInt(values.combat_range) || 0;
      const cover = parseInt(values.combat_cover) || 0;
      const opponentDodge = parseInt(values.combat_opponent_dodge) || 0;
      const opponentArmor = parseInt(values.combat_opponent_armor) || 0;
      const unaware = values.combat_unaware === "5" ? 5 : 0;
      const modifier = parseInt(values.combat_modifier) || 0;
      const woundPenalty = parseInt(values.skillcheck_wound_penalty) || 0;
      const armorPenalty = parseInt(values.armor_penalty) || 0;
      const mountedPenalty = parseInt(values.skillcheck_mounted_penalty) || 0;
      const aimingBonus = parseInt(values.skillcheck_aiming_bonus) || 0;

      let target = range + cover + opponentDodge + opponentArmor - unaware + modifier + woundPenalty + armorPenalty + mountedPenalty + aimingBonus;
      if(target <0) {
        target = 0;
      }

      setAttrs({
        combat_target: target
      });
    });
  });

  on("clicked:firearm1_attack", () => handleFirearmAttack("firearm1"));
  on("clicked:firearm2_attack", () => handleFirearmAttack("firearm2"));
  on("clicked:firearm3_attack", () => handleFirearmAttack("firearm3"));

  on("clicked:firearm1_ammo_add", () => updateAmmo("firearm1", 1));
  on("clicked:firearm1_ammo_sub", () => updateAmmo("firearm1", -1));
  on("clicked:firearm1_ammo_reload", () => reloadAmmo("firearm1"));

  on("clicked:firearm2_ammo_add", () => updateAmmo("firearm2", 1));
  on("clicked:firearm2_ammo_sub", () => updateAmmo("firearm2", -1));
  on("clicked:firearm2_ammo_reload", () => reloadAmmo("firearm2"));

  on("clicked:firearm3_ammo_add", () => updateAmmo("firearm3", 1));
  on("clicked:firearm3_ammo_sub", () => updateAmmo("firearm3", -1));
  on("clicked:firearm3_ammo_reload", () => reloadAmmo("firearm3"));

  ["firearm1", "firearm2", "firearm3"].forEach(slot => {
    on(`change:${slot}_weapon`, () => {
      const weaponAttr = `${slot}_weapon`;

      getAttrs([
      weaponAttr,

      "handgun_string",
      "automatic_handgun_string",
      "sawed_off_shotgun_string",

      "automatic_rifle_string",
      "rifle_string",
      "shotgun_string",
      "sniper_rifle_string",

      "handgun_displayname",
      "automatic_handgun_displayname",
      "sawed_off_shotgun_displayname",

      "automatic_rifle_displayname",
      "rifle_displayname",
      "shotgun_displayname",
      "sniper_rifle_displayname",

      "actions_penalty",
      ], values => {
        updateWeapon({
          values,
          weaponAttr,
          lookupTable: FIREARMS_LOOKUP,
          prefix: `${slot}_`
        });
      });
    });
  });

  on("change:ranged_weapon", () => {
    getAttrs([
    "ranged_weapon", "bow_active",
    "bow_string", "slingshot_string", "thrown_string", "crossbow_string",
    "bow_displayname", "slingshot_displayname", "thrown_displayname", "crossbow_displayname", "actions_penalty"
    ], values => {
      if (values.ranged_weapon === "Bow" && parseInt(values.bow_active, 10) !== 3) {
        return setAttrs({
          ranged_attr: "Bow skill not activated",
          ranged_string: "0D",
          ranged_actual: "0D",
          ranged_rollcode: "0d6",
          ranged_damage: "0D",
          ranged_damage_rollcode: "0d6",
          ranged_min_damage: "-",
          ranged_special: "Bow skill not activated"
        });
      }

      updateWeapon({
        values,
        weaponAttr: "ranged_weapon",
        lookupTable: RANGED_LOOKUP,
        prefix: "ranged_"
      });
    });
  });

  on("change:unarmed_weapon", () => {
    getAttrs([
      "actions_penalty",
      "unarmed_weapon", "strength_string", "agility_string", "perception_string",

      // Core unarmed
      "brawling_string", "brawling_displayname", "brawling_active",
      "wrestling_string", "wrestling_displayname", "wrestling_active",
      "push_string", "push_displayname", "push_active",

      // Activatable martial arts
      "aikido_string", "aikido_displayname", "aikido_active",
      "boxing_string", "boxing_displayname", "boxing_active",
      "jiu_jitsu_string", "jiu_jitsu_displayname", "jiu_jitsu_active",
      "taekwondo_string", "taekwondo_displayname", "taekwondo_active",
      "jeet_kune_do_string", "jeet_kune_do_displayname", "jeet_kune_do_active",
      "sambo_string", "sambo_displayname", "sambo_active",
      "savate_string", "savate_displayname", "savate_active",
      "capoeira_string", "capoeira_displayname", "capoeira_active",
      "judo_string", "judo_displayname", "judo_active",
      "karate_string", "karate_displayname", "karate_active",
      "krav_maga_string", "krav_maga_displayname", "krav_maga_active",
      "muay_thai_string", "muay_thai_displayname", "muay_thai_active"
    ], values => {
      const martialArtsMap = {
        "Boxing":      { activeKey: "boxing_active",      display: "Boxing",      special: "Knockout Attack" },
        "Aikido":      { activeKey: "aikido_active",      display: "Aikido",      special: "Disarm Attack" },
        "Jiu-Jitsu":   { activeKey: "jiu_jitsu_active",   display: "Jiu-Jitsu",   special: "Grapple Attack" },
        "Taekwondo":   { activeKey: "taekwondo_active",   display: "Taekwondo",   special: "Knockout Attack" },
        "Jeet Kune Do":{ activeKey: "jeet_kune_do_active",display: "Jeet Kune Do",special: "Knockout Attack" },
        "Sambo":       { activeKey: "sambo_active",       display: "Sambo",       special: "Grapple, Push, or Prone Attack" },
        "Savate":      { activeKey: "savate_active",      display: "Savate",      special: "Knockout Attack" },
        "Capoeira":    { activeKey: "capoeira_active",    display: "Capoeira",    special: "Grapple, Push, or Prone Attack" },
        "Judo":        { activeKey: "judo_active",        display: "Judo",        special: "Grapple, Push, or Prone Attack" },
        "Karate":      { activeKey: "karate_active",      display: "Karate",      special: "Knockout Attack" },
        "Krav Maga":   { activeKey: "krav_maga_active",   display: "Krav Maga",   special: "Disarm Attack" },
        "Muay Thai":   { activeKey: "muay_thai_active",   display: "Muay Thai",   special: "Knockout Attack" }
      };

      const selected = values.unarmed_weapon;
      const maInfo = martialArtsMap[selected];

      if (maInfo) {
        const isActive = parseInt(values[maInfo.activeKey], 10) === 3;

        if (!isActive) {
          return setAttrs({
            unarmed_attr: `${maInfo.display} skill not activated`,
            unarmed_string: "0D",
            unarmed_actual: "0D",
            unarmed_rollcode: "0d6",
            unarmed_damage: "0D",
            unarmed_damage_rollcode: "0d6",
            unarmed_min_damage: "-",
            unarmed_special: `${maInfo.display} skill not activated`
          });
        }
      }

      updateWeapon({
        values,
        weaponAttr: "unarmed_weapon",
        lookupTable: MELEE_LOOKUP,
        prefix: "unarmed_",
        extra: (values, weaponData) => {
          const str = values.strength_string || "0D";
          const agi = values.agility_string || "0D";
          const per = values.perception_string || "0D";

          const replaced = (weaponData.damage || "-")
            .replace(/S/g, str)
            .replace(/A/g, agi)
            .replace(/P/g, per)
            .replace(/D/g, "d6")
            .replace(/(\d+)d6/g, "$1d6kh$1cs0cf0");

          return {
            unarmed_damage_rollcode: replaced
          };
        }
      });
    });
  });

  on("change:armed_weapon", () => {
    getAttrs([
      "actions_penalty",
      "armed_weapon", "strength_string", "agility_string", "perception_string",

      // Armed skills
      "melee_weapon_string", "melee_weapon_displayname",
      "improvised_weapon_string", "improvised_weapon_displayname",
      "electroshock_string", "electroshock_displayname",
    ], values => {

      const selected = values.armed_weapon;
      updateWeapon({
        values,
        weaponAttr: "armed_weapon",
        lookupTable: MELEE_LOOKUP,
        prefix: "armed_",
        extra: (values, weaponData) => {
          const str = values.strength_string || "0D";
          const agi = values.agility_string || "0D";
          const per = values.perception_string || "0D";

          const replaced = (weaponData.damage || "-")
            .replace(/S/g, str)
            .replace(/A/g, agi)
            .replace(/P/g, per)
            .replace(/D/g, "d6")
            .replace(/(\d+)d6/g, "$1d6kh$1cs0cf0");

          return {
            armed_damage_rollcode: replaced
          };
        }
      });
    });
  });

  on("change:bow_rollcode change:slingshot_rollcode change:thrown_rollcode change:crossbow_rollcode", function () {
    getAttrs([
    "ranged_weapon",
    "bow_string", "slingshot_string", "thrown_string", "crossbow_string",
    "bow_active"
    ], function (values) {
      const bowActive = parseInt(values.bow_active, 10) || 0;
      if (values.ranged_weapon === "Bow" && bowActive !== 3) return;

      updateWeapon({
        values,
        weaponAttr: "ranged_weapon",
        lookupTable: RANGED_LOOKUP,
        prefix: "ranged_"
      });
    });
  });

  on("change:handgun_rollcode change:automatic_handgun_rollcode change:rifle_rollcode change:sniper_rifle_rollcode change:automatic_rifle_rollcode change:shotgun_rollcode change:sawed_off_shotgun_rollcode", function () {
    getAttrs([
    "firearm1_weapon", "firearm2_weapon", "firearm3_weapon",

    "handgun_string",
    "automatic_handgun_string",
    "sawed_off_shotgun_string",

    "automatic_rifle_string",
    "rifle_string",
    "shotgun_string",
    "sniper_rifle_string",

    "actions_penalty",
    ], function (values) {
      updateWeapon({
        values,
        weaponAttr: "firearm1_weapon",
        lookupTable: FIREARMS_LOOKUP,
        prefix: "firearm1_"
      });

      updateWeapon({
        values,
        weaponAttr: "firearm2_weapon",
        lookupTable: FIREARMS_LOOKUP,
        prefix: "firearm2_"
      });

      updateWeapon({
        values,
        weaponAttr: "firearm3_weapon",
        lookupTable: FIREARMS_LOOKUP,
        prefix: "firearm3_"
      });
    });
  });

  on("change:armed_weapon_rollcode change:unarmed_weapon_rollcode change:power_strike change:improvised_weapon_rollcode change:brawling_rollcode change:push_rollcode change:wrestling_rollcode change:judo_rollcode change:karate_rollcode change:taekwondo_rollcode change:muay_thai_rollcode change:krav_maga_rollcode change:capoeira_rollcode change:jeet_kune_do_rollcode change:savate_rollcode change:sambo_rollcode change:jiu_jitsu_rollcode change:boxing_rollcode change:aikido_rollcode change:attr_strength_rollcode change:attr_agility_rollcode change:attr_perception_rollcode", function () {
    getAttrs([
      "armed_weapon",
      "armed_weapon_string",
      "unarmed_weapon",
      "unarmed_weapon_string",
      "improvised_weapon_string",
      "brawling_string",
      "push_string",
      "wrestling_string",
      "judo_string",
      "karate_string",
      "taekwondo_string",
      "muay_thai_string",
      "krav_maga_string",
      "capoeira_string",
      "jeet_kune_do_string",
      "savate_string",
      "sambo_string",
      "jiu_jitsu_string",
      "aikido_string",
      "boxing_string",
      "strength_string",
      "agility_string",
      "perception_string"
    ], function (values) {
      const martialArtsSkills = [
        "aikido", "boxing", "jiu_jitsu", "taekwondo", "jeet_kune_do", "sambo",
        "savate", "capoeira", "judo", "karate", "krav_maga", "muay_thai"
      ];

      const selectedMA = values.unarmed_weapon;
      const isMartialArt = martialArtsSkills.includes(selectedMA);
      const maActive = parseInt(values[`${selectedMA}_active`] || "0", 10);

      if (isMartialArt && maActive !== 3) { return; }

      updateWeapon({
        values,
        weaponAttr: "armed_weapon",
        lookupTable: MELEE_LOOKUP,
        prefix: "armed_",
        extra: (vals, weaponData) => {
          const strengthDice = vals["strength_string"] || "0D";
          const agilityDice = vals["agility_string"] || "0D";
          const perceptionDice = vals["perception_string"] || "0D";

          let fullDamageRoll = weaponData.damage || "-";

          if (fullDamageRoll.includes("S")) {
            fullDamageRoll = fullDamageRoll.replace(/S/g, strengthDice);
          }
          if (fullDamageRoll.includes("A")) {
            fullDamageRoll = fullDamageRoll.replace(/A/g, agilityDice);
          }
          if (fullDamageRoll.includes("P")) {
            fullDamageRoll = fullDamageRoll.replace(/P/g, perceptionDice);
          }

          return {
            armed_damage_rollcode: fullDamageRoll.replace(/D/g, "d6")
          };
        }
      });
    });
  });

  on('clicked:firearm1_damage', function() {rollWeaponDamage('firearm1');});
  on('clicked:firearm2_damage', function() {rollWeaponDamage('firearm2');});
  on('clicked:firearm3_damage', function() {rollWeaponDamage('firearm3');});
  on('clicked:ranged_damage', function() {rollWeaponDamage('ranged');});
  on('clicked:armed_damage', function() {rollWeaponDamage('armed');});
  on('clicked:unarmed_damage', function() {rollWeaponDamage('unarmed');});

  on('clicked:ranged_attack', function() {rollWeaponSkillIfActionsRemain('ranged');});
  on('clicked:armed_attack', function() {rollWeaponSkillIfActionsRemain('armed');});
  on('clicked:unarmed_attack', function() {rollWeaponSkillIfActionsRemain('unarmed');});

  on('clicked:melee_attack_1', function() {rollMonsterSkill('melee_attack_1');});
  on('clicked:melee_damage_1', function() {rollMonsterDamage('melee_attack_1');});
  on('clicked:melee_attack_2', function() {rollMonsterSkill('melee_attack_2');});
  on('clicked:melee_damage_2', function() {rollMonsterDamage('melee_attack_2');});
  on('clicked:roll_skill_1', function() {rollMonsterSkill('skill_1');});

  on("change:condition_flat_tire change:condition_overheated change:condition_offroad", function () {
    getAttrs([
      "condition_flat_tire",
      "condition_overheated",
      "condition_offroad",
      "character_immunities"
    ], function (values) {
      const adjustments = {
        strength: 0,
        agility: 0,
        health: 0,
        quickness: 0,
      };

      if (values.condition_flat_tire === "on") {
        adjustments.agility -= 3;
        adjustments.quickness -= 3;
      }

      if (values.condition_overheated === "on") {
        adjustments.quickness -= 3;
      }

      if (values.condition_offroad === "on" && !values.character_immunities.includes("Off-Road")) {
        adjustments.agility -= 2;     // steering, control on rough ground
        adjustments.quickness -= 2;   // speed drops without proper traction
      }

      setAttrs({
        strength_conditions: adjustments.strength,
        agility_conditions: adjustments.agility,
        health_conditions: adjustments.health,
        quickness_conditions: adjustments.quickness
      });
    });
  });

  on("change:condition_aiming change:condition_blind change:condition_drunk change:condition_exhausted change:condition_dehydrated change:condition_hypothermic change:condition_hyperthermic change:condition_knockout change:condition_frightened change:condition_diseased change:condition_poisoned change:condition_grappled", function () {
    getAttrs([
      "condition_aiming", "condition_drunk", "condition_blind", "condition_exhausted", "condition_dehydrated", "condition_hypothermic", "condition_hyperthermic", "condition_knockout",
      "condition_frightened", "condition_diseased", "condition_poisoned", "condition_grappled",
      "base_move", "base_run", "encum_penalty_move", "encum_penalty_run", "character_immunities"
    ], function (values) {
      const adjustments = {
        strength: 0,
        agility: 0,
        health: 0,
        perception: 0,
        quickness: 0,
        willpower: 0,
        intelligence: 0,
        manualdex: 0,
        charisma: 0,
        move: 0,
        run: 0
      };

      if (values.condition_drunk === "on" && !values.character_immunities.includes("Drunk")) {
        adjustments.agility -= 1;
        adjustments.perception -= 1;
        adjustments.willpower += 1;
      }

      if (values.condition_blind === "on" && !values.character_immunities.includes("Blind")) {
        adjustments.agility -= 2;
        adjustments.perception -= 5;
        adjustments.run -= 15;
        adjustments.move -= 15;
      }

      if (values.condition_exhausted === "on" && !values.character_immunities.includes("Exhausted")) {
        adjustments.strength -= 1;
        adjustments.quickness -= 1;
        adjustments.willpower -= 1;
        adjustments.run -= 10;
        adjustments.move -= 10;
      }

      if (values.condition_dehydrated === "on" && !values.character_immunities.includes("Dehydrated")) {
        adjustments.health -= 1;
        adjustments.strength -= 1;
        adjustments.run -= 5;
        adjustments.move -= 5;
      }

      if (values.condition_hypothermic === "on" && !values.character_immunities.includes("Hypothermic")) {
        adjustments.intelligence -= 1;
        adjustments.health -= 1;
      }

      if (values.condition_hyperthermic === "on" && !values.character_immunities.includes("Hyperthermic")) {
        adjustments.strength -= 1;
        adjustments.willpower -= 1;
        adjustments.run -= 5;
        adjustments.move -= 5;
      }

      if (values.condition_frightened === "on" && !values.character_immunities.includes("Frightened")) {
        adjustments.willpower -= 1;
        adjustments.charisma -= 1;
        adjustments.run += 5;
      }

      if (values.condition_diseased === "on" && !values.character_immunities.includes("Diseased")) {
        adjustments.health -= 1;
        adjustments.strength -= 1;
        adjustments.run -= 5;
        adjustments.move -= 5;
      }

      if (values.condition_poisoned === "on" && !values.character_immunities.includes("Poisoned")) {
        adjustments.health -= 1;
        adjustments.quickness -= 1;
        adjustments.run -= 5;
        adjustments.move -= 5;
      }

      if (
        (values.condition_grappled === "on" && !values.character_immunities.includes("Grappled")) ||
        (values.condition_grappled === "on" && !values.character_immunities.includes("Aiming")) ||
        (values.condition_knockout === "on" && !values.character_immunities.includes("Knockout")) ||
        (values.condition_aiming === "on")
      ) {
        adjustments.run -= 500;
        adjustments.move -= 500;
      }

      setAttrs({
        strength_conditions: adjustments.strength,
        agility_conditions: adjustments.agility,
        health_conditions: adjustments.health,
        perception_conditions: adjustments.perception,
        quickness_conditions: adjustments.quickness,
        willpower_conditions: adjustments.willpower,
        intelligence_conditions: adjustments.intelligence,
        manualdex_conditions: adjustments.manualdex,
        charisma_conditions: adjustments.charisma,
        conditions_penalty_move: adjustments.move,
        conditions_penalty_run: adjustments.run
      });
    });
  });

  on(`change:${Object.keys(VALIDATION_RULES).join(" change:")}`, function() {
    getAttrs(Object.keys(VALIDATION_RULES), function(values) {
      const updates = {};

      for (let attr in VALIDATION_RULES) {
        const rule = VALIDATION_RULES[attr];
        const value = parseInt(values[attr], 10);

        if (isNaN(value)) {
          updates[attr] = rule.min || 0;
        } else if (typeof rule.min === "number" && value < rule.min) {
          updates[attr] = rule.min;
        } else if (typeof rule.max === "number" && value > rule.max) {
          updates[attr] = rule.max;
        }
      }

      if (Object.keys(updates).length > 0) {
        setAttrs(updates);
      }
    });
  });

  on("change:repeating_inventory:item_qty change:repeating_inventory:item_weight", function(eventInfo) {
    const rowPrefix = eventInfo.sourceAttribute.replace(/(item_qty|item_weight)$/, "");
    getAttrs([`${rowPrefix}item_qty`, `${rowPrefix}item_weight`], function(values) {
      const updates = {};

      const qty = parseInt(values[`${rowPrefix}item_qty`], 10);
      const weight = parseFloat(values[`${rowPrefix}item_weight`]);

      if (isNaN(qty) || qty < 1) {
        updates[`${rowPrefix}item_qty`] = 1;
      }

      if (isNaN(weight) || weight < 0) {
        updates[`${rowPrefix}item_weight`] = 0;
      }

      if (Object.keys(updates).length > 0) {
        setAttrs(updates);
      }
    });
  });

  on("clicked:type_continue", function () {
    getAttrs(["character_type"], function (values) {
      const type = values.character_type;
      let sheet_mode = "background"; // Default fallback

      switch (type) {
        case "pc":
        case "major_npc":
        case "standard_npc":
          sheet_mode = "background";
          break;
        case "quick_npc":
          setupQuickNPC();
          sheet_mode = "quicknpc";
          break;
        case "beast":
          sheet_mode = "sheet";
          break;
        case "vehicle":
          sheet_mode = "vehicle_select";
          break;
        case "monster":
          sheet_mode = "beast_select";
          break;
      }

      setAttrs({ sheet_mode });
    });
  });

  on("change:vehicle_choice", () => {
    getAttrs(["vehicle_choice"], (values) => {
      const vehicleSelect = values.vehicle_choice;
      const selected = VEHICLES[vehicleSelect];

      if (!selected) {
        // Clear details and attributes if invalid
        const resetUpdates = {
          character_description: "",
          vehicle_special: ""   // clear stored special
        };
        ATTRS.forEach(attr => {
          resetUpdates[`${attr}_base_string`] = "0D";
          resetUpdates[`${attr}_string`] = "0D";
          resetUpdates[`${attr}_rollcode`] = "0d6";
          resetUpdates[`${attr}_adjustment`] = 0;
        });
        setAttrs(resetUpdates);
        return;
      }

      // Populate details + name
      const baseUpdates = {
        character_description: selected.details,
        vehicle_type: selected.type,
        vehicle_special: selected.special || "" // store the special
      };

      // Map VEHICLES keys -> your ATTRS
      const mapping = {
        strength: selected.strength,
        agility: selected.agility,
        quickness: selected.quickness,
        health: selected.health
      };

      ATTRS.forEach(attr => {
        const base = mapping[attr] || 0;
        baseUpdates[`${attr}`] = `${base}`;
        baseUpdates[`${attr}_base_string`] = `${base}D`;
        baseUpdates[`${attr}_string`] = `${base}D`;
        baseUpdates[`${attr}_rollcode`] = `${base}d6`;
        baseUpdates[`${attr}_adjustment`] = 0;
      });

      setAttrs(baseUpdates);
    });
  });

  on("clicked:final_vehicle_step", () => {
    getAttrs(["vehicle_choice"], (values) => {
      const vehicleKey = values.vehicle_choice || "";
      const selected = VEHICLES[vehicleKey] || {};

      if (!selected.type) {
        setAttrs({
          sheet_mode: "vehicle",
          character_description: "",
        });
        return;
      }

      const updates = {
        vehicle_type: selected.type,
        vehicle_special: selected.special || ""
      };

      //  Only parse the special field
      Object.assign(updates, getSkillBonuses(selected.special || ""));
      Object.assign(updates, getSpecializations(selected.special || ""));
      Object.assign(updates, getActivatableSkills(selected.special || ""));
      assignImmunities(selected.special || "");

      //  Base stats
      ATTRS.forEach(attr => {
        const base = selected[attr] || 0;
        updates[`${attr}`] = `${base}`;
        updates[`${attr}_base_string`] = `${base}D`;
        updates[`${attr}_string`] = `${base}D`;
        updates[`${attr}_rollcode`] = `${base}d6`;
        updates[`${attr}_adjustment`] = 0;
        updates[`${attr}_conditions`] = 0;
      });

      setAttrs(updates, () => {
        setAttrs({
          sheet_mode: "vehicle",
          advantage: 0,
          num_declared_actions: 1
        }, () => {
          ATTRS.forEach(attr => updateActual(attr));
        });
      });
    });
  });

  on("clicked:next_step", function () {
    getAttrs([
      "background_choice",
      "origin_choice",
      "hobby_choice",
      "character_type",
      "background_combined",
      "origin_combined",
      "hobby_combined",
      "choose_background_activate_aviation",
      "choose_background_activate_ma",
      "choose_origin_activate_ma",
      "choose_hobby_activate_ma",
      "choose_background_activate_science",
      "choose_hobby_activate_science",
      "choose_background_activate_knowledge",
      "choose_origin_activate_knowledge",
      "choose_background_specialize_performance",
      "choose_background_hobby_performance",
      "choose_background_specialize_physical",
      "choose_origin_specialize_physical",
      "choose_hobby_specialize_physical",
      "choose_origin_specialize_technical",
      "choose_background_specialize_technical",
      "choose_hobby_specialize_technical",
      "choose_hobby_specialize_animals",
      "background_unlocked_aviation",
      "background_unlocked_ma",
      "background_unlocked_science",
      "hobby_unlocked_science",
      "background_unlocked_knowledge",
      "origin_unlocked_knowledge",
      "origin_unlocked_ma",
      "hobby_unlocked_ma",
      "background_specialize_performance",
      "hobby_specialize_performance",
      "background_specialize_physical",
      "origin_specialize_physical",
      "hobby_specialize_physical",
      "origin_specialize_technical",
      "background_specialize_technical",
      "hobby_specialize_technical",
      "hobby_specialize_animals"
    ], function (values) {
      const name = values.background_choice || "";
      const origin = values.origin_choice || "";
      const hobby = values.hobby_choice || "";

      const entry = BACKGROUND_DETAILS[name] || {};
      let details = entry.details || "";
      const cash = entry.cash || "$0.00";

      details = updateActivationLine(details, values.background_unlocked_aviation || "", "Activate: Any locked Aviation Skill");
      details = updateActivationLine(details, values.background_unlocked_ma || "", "Activate: One martial art");
      details = updateActivationLine(details, values.background_unlocked_science || "", "Activate: Any science skill");
      details = updateActivationLine(details, values.background_unlocked_knowledge || "", "Activate: Any locked Knowledge skill");

      details = updateSpecializeLine(details, values.background_specialize_performance || "", "Specialized: Any Performance skill");
      details = updateSpecializeLine(details, values.background_specialize_physical || "", "Specialized: Any Physical skill");
      details = updateSpecializeLine(details, values.background_specialize_technical || "", "Specialized: Any Technical skill");

      const backgroundDetails = details;

      let originDetails = values.origin_combined || "";
      originDetails = updateActivationLine(originDetails, values.origin_unlocked_knowledge || "", "Activate: Any locked Knowledge skill");
      originDetails = updateActivationLine(originDetails, values.origin_unlocked_ma || "", "Activate: One martial art");

      originDetails = updateSpecializeLine(originDetails, values.origin_specialize_physical || "", "Specialized: Any Physical skill");
      originDetails = updateSpecializeLine(originDetails, values.origin_specialize_technical || "", "Specialized: Any Technical skill");

      let hobbyDetails = values.hobby_combined || "";
      hobbyDetails = updateActivationLine(hobbyDetails, values.hobby_unlocked_science || "", "Activate: Any science skill");
      hobbyDetails = updateSpecializeLine(hobbyDetails, values.hobby_specialize_technical || "", "Specialized: Any Technical skill");
      hobbyDetails = updateActivationLine(hobbyDetails, values.hobby_unlocked_ma || "", "Activate: One martial art");
      hobbyDetails = updateSpecializeLine(hobbyDetails, values.hobby_specialize_performance || "", "Specialized: Any Performance skill");
      hobbyDetails = updateSpecializeLine(hobbyDetails, values.hobby_specialize_physical || "", "Specialized: Any Physical skill");
      hobbyDetails = updateSpecializeLine(hobbyDetails, values.hobby_specialize_animals || "", "Specialized: Any Animals skill");

      const combinedDetails = [
        name ? `Profession: ${name}\n\t${backgroundDetails.replace(/\n/g, "\n\t")}` : "",
        origin ? `Childhood Origin: ${origin}\n\t${originDetails.replace(/\n/g, "\n\t")}` : "",
        hobby ? `Hobby: ${hobby}\n\t${hobbyDetails.replace(/\n/g, "\n\t")}` : ""
      ].filter(Boolean).join("\n\n");

      const updates = {
        background_name: `${name}`,
        background_combined: combinedDetails,
        character_cash: cash,
        no_mounted_penalty: /No Penalty when Driving/i.test(combinedDetails) ? 1 : 0
      };

      Object.assign(updates, getDefaults());
      Object.assign(updates, getTypeDefaults(values.character_type));
      Object.assign(updates, getSkillBonuses(combinedDetails));
      Object.assign(updates, getSpecializations(combinedDetails));
      Object.assign(updates, getMovementBonus(combinedDetails));
      Object.assign(updates, getActivatableSkills(combinedDetails));

      assignWealthBonuses(combinedDetails);
      assignImmunities(combinedDetails);

      //  Collect items from all three sources
      const backgroundEntry = BACKGROUND_DETAILS[name] || {};
      const originEntry = ORIGIN_DETAILS[origin] || {};
      const hobbyEntry = HOBBY_DETAILS[hobby] || {};

      const allItems = [
        ...(backgroundEntry.items || []),
        ...(originEntry.items || []),
        ...(hobbyEntry.items || [])
      ];

      //  Deduplicate by item name
      const uniqueItems = allItems.filter(
        (item, index, self) =>
          index === self.findIndex((t) => t.name === item.name)
      );
      addMultipleInventoryItems(uniqueItems);

      setAttrs(updates, () => {
        enterSpendMode();
        setAttrs({ sheet_mode: "training" });
      });
    });
  });

  on("clicked:final_step", function () {
    getAttrs(["sheet_mode", ...ATTRS], function (values) {
      const updates = {
        sheet_mode: "sheet",
        spend_mode: "0"
      };

      ATTRS.forEach(attr => {
        updates[`${attr}_base_string`] = `${values[attr] || 0}D`;
        updates[`${attr}_conditions`] = 0;
      });

      commitSpend();
      setAttrs(updates);
      toggleAllSections(true);
    });
  });

  on("change:background_choice change:origin_choice change:hobby_choice", function () {
    getAttrs([
      "background_choice",
      "origin_choice",
      "hobby_choice"
    ], function (values) {
      const background = values.background_choice?.trim() || "";
      const origin = values.origin_choice?.trim() || "";
      const hobby = values.hobby_choice?.trim() || "";

      const backgroundEntry = BACKGROUND_DETAILS[background] || {};
      const originEntry = ORIGIN_DETAILS[origin] || {};
      const hobbyEntry = HOBBY_DETAILS[hobby] || {};

      let backgroundDetails = backgroundEntry.details || "";
      const originDetails = originEntry.details || "";
      const hobbyDetails = hobbyEntry.details || "";

      const backgroundItems = (backgroundEntry.items || [])
        .concat(originEntry.items || [])
        .concat(hobbyEntry.items || []);

      const cash = backgroundEntry.cash || "$0.00";

      const itemList = [...new Set(backgroundItems.map(item => ` ${item.name}`))];
      const part1 = [`Cash: ${cash}`, ...itemList.slice(0, 9)].join("\n").trim();
      const part2 = itemList.slice(9).join("\n").trim();

      const ready = background && origin && hobby;

      showBackgroundChoiceActivations(backgroundDetails);
      showOriginChoiceActivations(originDetails);
      showHobbyChoiceActivations(hobbyDetails);

      setAttrs({
        background_combined: backgroundDetails,
        origin_combined: originDetails,
        hobby_combined: hobbyDetails,
        background_items1: part1,
        background_items2: part2,
        ready_to_advance_background: ready ? "1" : "0"
      });
    });
  });

  on(`change:${ATTRS.join(' change:')} change:skill_points change:sheet_mode`, function () {
    getAttrs([...ATTRS, 'skill_points', 'sheet_mode', 'character_type'], function (values) {
      if (values.sheet_mode !== "training") return;

      let total = 0;
      ATTRS.forEach(attr => {
        const val = parseInt(values[attr], 10);
        if (!isNaN(val)) total += val;
      });

      const skillPoints = parseInt(values.skill_points, 10);
      let isReady = total === 27 && skillPoints === 0 ? "1" : "0";

      if (values.character_type === "major_npc") {
        isReady = "1";
      }

      setAttrs({
        attribute_total: total,
        ready_to_advance_training: isReady
      });
    });
  });

  on("change:actions_penalty", function() {
    const weapons = ["firearm1", "firearm2", "firearm3", "ranged", "armed", "unarmed"];
    const attrsToGet = ["vehicle_drive_adjustment", "vehicle_drive", "actions_penalty", ...weapons.map(w => `${w}_string`)];

    getAttrs(attrsToGet, function(values) {
      const count = parseInt(values.actions_penalty, 10) || 0;
      const drive = parseInt(values.vehicle_drive, 10) || 0;
      const adj = Math.min(count, drive);

      const updates = {
        vehicle_drive_adjustment: -adj
      };

      weapons.forEach(weapon => {
        const baseString = values[`${weapon}_string`] || "0D";
        const result = adjustDiceByAttackCount(baseString, count);

        updates[`${weapon}_actual`] = result.actual;
        updates[`${weapon}_rollcode`] = result.rollcode;
      });

      setAttrs(updates);
    });
  });

  on("clicked:collapse_all", () => toggleAllSections(false));
  on("clicked:expand_all", () => toggleAllSections(true));

  on("clicked:roll3dWealth", () => rollFixedND(3, "Daily Wealth Check"));
  on("clicked:roll4dWealth", () => rollFixedND(4, "Weekly Wealth Check"));
  on("clicked:roll5dWealth", () => rollFixedND(5, "Monthly Wealth Check"));

  on("clicked:2droll", () => rollFixedND(2, "2D Roll"));
  on("clicked:2dinit", function () {
    getAttrs(["character_name", "whisper_toggle"], function (values) {
      const name = values.character_name || "Character";
      const whisper = values.whisper_toggle || "";
      const rollcode = "2d6";

      rollInitiative(name, rollcode, "2D", whisper);
    });
  });

  on("clicked:view_inventory", function () {
    setAttrs({ view_mode: "inventory" });
  });

  on("clicked:view_character", function () {
    setAttrs({ view_mode: "character" });
  });

  on(
  "change:repeating_inventory:item_qty change:repeating_inventory:item_weight change:repeating_inventory:item_location remove:repeating_inventory add:repeating_inventory change:character_weight",
    function () {
      getSectionIDs("repeating_inventory", function (ids) {
        const fields = [];
        ids.forEach((id) => {
          fields.push(`repeating_inventory_${id}_item_qty`);
          fields.push(`repeating_inventory_${id}_item_weight`);
          fields.push(`repeating_inventory_${id}_item_location`);
        });

        getAttrs(fields, function (values) {
          let equippedTotal = 0;

          ids.forEach((id) => {
            const qty = parseInt(values[`repeating_inventory_${id}_item_qty`], 10) || 0;
            const weight = parseFloat(values[`repeating_inventory_${id}_item_weight`]) || 0;
            const location = values[`repeating_inventory_${id}_item_location`] || "";

            const total = qty * weight;
            if (location === "equipped") {
              equippedTotal += total;
            }
          });

          setAttrs({
            equipped_weight_total: equippedTotal,
          });
        });
      });
    }
  );

  on("change:strength_string", function() {
    getAttrs(["strength_string"], function(values) {
      const str = parseInt(values.strength_string, 10) || 0;
        // Base capacity = 30  Strength
      const capacity = str * 30;

      // Each step increases by 10%
      const enc_5  = Math.ceil(capacity * 1.1);
      const enc_10 = Math.ceil(capacity * 1.2);
      const enc_15 = Math.ceil(capacity * 1.3);
      const enc_20 = Math.ceil(capacity * 1.4);
      const enc_25 = Math.ceil(capacity * 1.5);

      setAttrs({
        character_capacity: capacity,
        character_enc_5: enc_5,
        character_enc_10: enc_10,
        character_enc_15: enc_15,
        character_enc_20: enc_20,
        character_enc_25: enc_25,
      });
    });
  });

  on("change:equipped_weight_total change:character_enc_5 change:encumbrance_visible", updateCharacterEncumbrance);

  on("change:base_move change:base_run change:encum_penalty_move change:encum_penalty_run change:conditions_penalty_move change:conditions_penalty_run", function() {
    getAttrs([
      "base_move", "base_run",
      "encum_penalty_move", "encum_penalty_run",
      "conditions_penalty_move", "conditions_penalty_run"
    ], function(values) {
      const baseMove = parseInt(values.base_move, 10) || 0;
      const baseRun = parseInt(values.base_run, 10) || 0;
      const encMove = parseInt(values.encum_penalty_move, 10) || 0;
      const encRun = parseInt(values.encum_penalty_run, 10) || 0;
      const condMove = parseInt(values.conditions_penalty_move, 10) || 0;
      const condRun = parseInt(values.conditions_penalty_run, 10) || 0;

      const currentMove = Math.max(0, baseMove - encMove + condMove);
      const currentRun = Math.max(0, baseRun - encRun + condRun);

      setAttrs({
        current_move: currentMove,
        current_run: currentRun
      });
    });
  });

  on("change:use_encumbrance", function() {
    getAttrs(["use_encumbrance"], function(values) {
      const isEnabled = values.use_encumbrance === "on";
      const updates = {
        encumbrance_visible: isEnabled ? "1" : "0"
      };

      // If disabling encumbrance, clear penalties and text
      if (!isEnabled) {
        updates.encumbrance_text = "";
        updates.encum_penalty_move = 0;
        updates.encum_penalty_run = 0;
      }

      setAttrs(updates);
    });
  });

  on("change:itemdrop_name", function() {
    getAttrs([
      "itemdrop_name", "itemdrop_qty", "itemdrop_weight", "itemdrop_location","itemdrop_description"
    ], function(values) {

    const name = values.itemdrop_name;
    if (!name) return; // skip if nothing dropped

    const rowId = generateRowID();
    const prefix = `repeating_inventory_${rowId}_`;

    const all = {};
    all[`${prefix}item_name`] = values.itemdrop_name || "";
    all[`${prefix}item_qty`] = values.itemdrop_qty || "";
    all[`${prefix}item_weight`] = values.itemdrop_weight || "";
    all[`${prefix}item_location`] = values.itemdrop_location || "";
    all[`${prefix}item_description`] = values.itemdrop_description || "";

      // Clear the drop zone
      all["itemdrop_name"] = "";
      all["itemdrop_qty"] = "";
      all["itemdrop_weight"] = "";
      all["itemdrop_location"] = "";
      all["itemdrop_description"] = "";

      setAttrs(all);
    });
  });

  function getWealthTN(moneyNeeded, wealthLevel) {
    // --- Anchors (TN0, TN20) for each WL ---
    const anchors = {
      0: { base: 10, max: 250 },
      1: { base: 200, max: 5000 },
      2: { base: 600, max: 15000 },
      3: { base: 1800, max: 60000 },
      4: { base: 6000, max: 180000 },
      5: { base: 100000, max: 5000000 },
      6: { base: 1000000, max: 25000000 }
    };

    const { base, max } = anchors[wealthLevel] || anchors[0];

    //  base  TN = 0
    if (moneyNeeded <= base) return 0;

    // Between base and max  log curve
    if (moneyNeeded < max) {
      const tnFloat =
        20 * Math.log(moneyNeeded / base) / Math.log(max / base);
      return Math.ceil(tnFloat);
    }

    //  max  add +5 TN per additional "max" interval
    const over = moneyNeeded - max;
    const steps = Math.ceil(over / max);
    return 20 + steps * 5;
  }

  on("change:money_needed change:money_scale change:character_wealth", () => {
    getAttrs(["money_needed", "money_scale", "character_wealth"], (values) => {
      const moneyNeeded = parseFloat(values.money_needed) || 0;
      const moneyScale  = parseFloat(values.money_scale) || 1;
      const wealthLevel = parseInt(values.character_wealth, 10) || 0;

      // Apply the scale
      const totalMoney = moneyNeeded * moneyScale;

      const wealthTarget = getWealthTN(totalMoney, wealthLevel);

      setAttrs({ wealth_target: wealthTarget });
    });
  });

  // When category changes, clear canonical choice and all category-specific selects
  on('change:vehicle_category', () => {
    getAttrs(['vehicle_category'], function(values) {
      const category = values.vehicle_category || '';
      const updates = {
        vehicle_category_val: category,
        vehicle_choice: '',
        ready_to_advance_training: '0' // reset when switching category
      };

      // Clear all per-category selects when switching category
      [
        'vehicle_choice_cars',
        'vehicle_choice_utility',
        'vehicle_choice_specialty',
        'vehicle_choice_emergency',
        'vehicle_choice_terrain',
        'vehicle_choice_motorcycles',
        'vehicle_choice_watercraft',
        'vehicle_choice_aircraft'
      ].forEach(function(name) {
        updates[name] = '';
      });

      setAttrs(updates);
    });
  });

  on('change:beast_category', () => {
    getAttrs(['beast_category'], function(values) {
      const category = values.beast_category || '';
      const updates = {
        beast_category_val: category,
        beast_choice: '',
        ready_to_advance_training: '0' // reset when switching category
      };

      // Clear all per-category selects when switching category
      [
        'beast_choice_dogs',
        'beast_choice_primates',
        'beast_choice_flying',
        'beast_choice_wild',
        'beast_choice_burden',
        'beast_choice_exotic',
        'beast_choice_livestock',
        'beast_choice_insects',
        'beast_choice_cats',
        'beast_choice_snakes',
        'beast_choice_sea'
      ].forEach(function(name) {
        updates[name] = '';
      });

      setAttrs(updates);
    });
  });

  on('change:vehicle_choice_cars change:vehicle_choice_utility change:vehicle_choice_specialty change:vehicle_choice_emergency change:vehicle_choice_terrain change:vehicle_choice_motorcycles change:vehicle_choice_watercraft change:vehicle_choice_aircraft', function(eventInfo) {
    const sourceAttribute = eventInfo.sourceAttribute;

    getAttrs([sourceAttribute], function(values) {
      const selectedVehicle = values[sourceAttribute] || '';
      const updates = {
        vehicle_choice: selectedVehicle,
        ready_to_advance_training: selectedVehicle ? '1' : '0'
      };

      setAttrs(updates);
    });
  });

  on(
  'change:beast_choice_dogs change:beast_choice_primates change:beast_choice_flying change:beast_choice_wild change:beast_choice_burden change:beast_choice_exotic change:beast_choice_livestock change:beast_choice_insects change:beast_choice_cats change:beast_choice_snakes change:beast_choice_sea',
  function(eventInfo) {
    const sourceAttribute = eventInfo.sourceAttribute;

    getAttrs([sourceAttribute], function(values) {
      const selectedBeast = values[sourceAttribute] || '';
      const updates = {
        beast_choice: selectedBeast,
        ready_to_advance_training: selectedBeast ? '1' : '0'
      };

      setAttrs(updates);
    });
  }
);

on('change:beast_choice', function(eventInfo) {
  const sourceAttribute = eventInfo.sourceAttribute;

  getAttrs([sourceAttribute], function(values) {
    const selectedBeast = values[sourceAttribute] || '';
    const beast = BEASTS[selectedBeast];

    const updates = {
      beast_choice: selectedBeast,
      ready_to_advance_training: selectedBeast ? '1' : '0',
      character_description: beast ? beast.details : '' // <-- populate description
    };

    setAttrs(updates);
  });
});

on("clicked:final_beast_step", () => {
  getAttrs(["beast_choice"], (values) => {
    const beastSelect = values.beast_choice;
    const selected = BEASTS[beastSelect];

    if (!selected) {
      // Clear details and attributes if invalid
      const resetUpdates = {
        character_description: "",
        monster_type: "",
        base_move: 0,
        base_run: 0,
        current_move: 0,
        current_run: 0,
        melee_attack_1_name: "",
        melee_attack_1_skill: "",
        melee_attack_1_damage: "",
        melee_attack_1_min_damage: "",
        melee_attack_1_special: "",
        melee_attack_2_name: "",
        melee_attack_2_skill: "",
        melee_attack_2_damage: "",
        melee_attack_2_min_damage: "",
        melee_attack_2_special: "",
        melee_attack_3_name: "",
        melee_attack_3_skill: "",
        melee_attack_3_damage: "",
        melee_attack_3_min_damage: "",
        melee_attack_3_special: "",
        special_ability_1: "",
        skill_1_name: "",
        num_melee_attack_active: "0",
        skill_1_skill: ""
      };
      const beastAttrs = [
        "strength","agility","health","perception","quickness",
        "willpower","intelligence","manualdex","charisma"
      ];
      beastAttrs.forEach(attr => {
        resetUpdates[attr] = 0;
        resetUpdates[`${attr}_base_string`] = "0D";
        resetUpdates[`${attr}_string`] = "0D";
        resetUpdates[`${attr}_rollcode`] = "0d6";
        resetUpdates[`${attr}_adjustment`] = 0;
        resetUpdates[`${attr}_condtions`] = 0;
      });
      setAttrs(resetUpdates);
      return;
    }

    // Populate details + name
    const baseUpdates = {
      character_type: "monster",
      sheet_mode: "monster",
      character_description: selected.details,
      monster_type: selected.type,
      base_move: selected.base_move || 0,
      base_run: selected.base_run || 0,
      current_move: selected.base_move || 0,
      current_run: selected.base_run || 0,
      num_melee_attack_active: "0",
      advantage: 0
    };

    // Map BEAST attributes
    const beastAttrs = [
      "strength","agility","health","perception","quickness",
      "willpower","intelligence","manualdex","charisma"
    ];
    beastAttrs.forEach(attr => {
      const base = selected[attr] || 0;
      baseUpdates[attr] = base;
      baseUpdates[`${attr}_base_string`] = `${base}D`;
      baseUpdates[`${attr}_string`] = `${base}D`;
      baseUpdates[`${attr}_rollcode`] = `${base}d6`;
      baseUpdates[`${attr}_adjustment`] = 0;
      baseUpdates[`${attr}_conditions`] = 0;
    });

    // Handle up to two attacks
    if (selected.attacks && selected.attacks.length > 0) {
      const atk1 = selected.attacks[0];
      baseUpdates["melee_attack_1_name"] = atk1.name || "";
      baseUpdates["melee_attack_1_skill"] = atk1.skill ? `${atk1.skill}D` : "";
      baseUpdates["melee_attack_1_damage"] = atk1.damage ? `${atk1.damage}D` : "";
      baseUpdates["melee_attack_1_min_damage"] = atk1.minDamage || 0;
      baseUpdates["melee_attack_1_special"] = atk1.special || "";

      baseUpdates["num_melee_attack_active"] = "1";
    }
    if (selected.attacks && selected.attacks.length > 1) {
      const atk2 = selected.attacks[1];
      baseUpdates["melee_attack_2_name"] = atk2.name || "";
      baseUpdates["melee_attack_2_skill"] = atk2.skill ? `${atk2.skill}D` : "";
      baseUpdates["melee_attack_2_damage"] = atk2.damage ? `${atk2.damage}D` : "";
      baseUpdates["melee_attack_2_min_damage"] = atk2.minDamage || 0;
      baseUpdates["melee_attack_2_special"] = atk2.special || "";

      baseUpdates["num_melee_attack_active"] = "2";
    }
    if (selected.attacks && selected.attacks.length > 2) {
      const atk3 = selected.attacks[2];
      baseUpdates["melee_attack_3_name"] = atk3.name || "";
      baseUpdates["melee_attack_3_skill"] = atk3.skill ? `${atk3.skill}D` : "";
      baseUpdates["melee_attack_3_damage"] = atk3.damage ? `${atk3.damage}D` : "";
      baseUpdates["melee_attack_3_min_damage"] = atk3.minDamage || 0;
      baseUpdates["melee_attack_3_special"] = atk3.special || "";

      baseUpdates["num_melee_attack_active"] = "3";
    }

    // Handle skill_1 (special non-combat skill like Tracking/Search/Survival)
    if (selected.skills && selected.skills.length > 0) {
      const firstSkill = selected.skills[0];
      baseUpdates["skills_active"] = "1";   // show Skill Check section
      baseUpdates["skill_1_name"] = firstSkill.name || "";
      baseUpdates["skill_1_skill"] = firstSkill.skill ? `${firstSkill.skill}D` : "";
    } else {
      baseUpdates["skills_active"] = "0";   // hide Skill Check section
      baseUpdates["skill_1_name"] = "";
      baseUpdates["skill_1_skill"] = "";
    }

    // Special abilities
    if (selected.special && selected.special.trim() !== "") {
      baseUpdates["special_ability_1"] = selected.special;
      baseUpdates["special_ability_active"] = "1";
    } else {
      baseUpdates["special_ability_1"] = "";
      baseUpdates["special_ability_active"] = "0";
    }

    setAttrs(baseUpdates);
  });
});

</script>

<rolltemplate class="sheet-rolltemplate-d6plus">
  <div class="sheet-template-container">
    <div>{{character}}</div>
    <h3>{{name}}</h3>
    <div><strong>Dice Code:</strong> {{dice_code}}</div>
    <div><strong>Total:</strong> {{roll}}</div>
    <div><strong>Open Ended D20:</strong> {{d20}}</div>
  </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-combined">
  <div class="sheet-template-container">
    <div>{{character}}</div>
    <h3>{{name}}</h3>
    <div><strong>{{skill_1}}</strong> {{dice_code_1}}</div>
    <div><strong>{{skill_2}}</strong> {{dice_code_2}}</div>
    <h3></h3>
    <div><strong>Total:</strong> {{roll}}</div>
    <div><strong>Open Ended D20:</strong> {{d20}}</div>
  </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-d6plus-no-openend">
  <div class="sheet-template-container">
    <div>{{character}}</div>
    <h3>{{name}}</h3>
    <div><strong>Dice Code:</strong> {{dice_code}}</div>
    <div><strong>Total:</strong> {{roll}}</div>
  </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-d6plus-message">
  <div class="sheet-template-container">
    <h3>{{name}}</h3>
    <div>{{message}}</div
  </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-d6plus-initiative">
  <div class="sheet-template-container">
    <div>{{character}}</div>
    <h3>Initiative Roll</h3>
    <div><strong>Dice Code:</strong> {{dice_code}}</div>
    <div><strong>Total:</strong> {{roll}}</div>
  </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-d6damage">
  <div class="sheet-template-container">
    <div>{{character}}</div>
    <h3>{{weapon}} Damage</h3>
    <div><strong>Damage Total:</strong> {{damage_roll}}</div>
    <div><strong>Minimum Damage:</strong> {{minimum_damage}}</div>
    {{#special}}
    <div><strong>Special:</strong> {{special}}</div>
    {{/special}}
  </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-d6plus-error">
  <div class="error-template">
    <h3>{{name}}</h3>
    <div>{{message}}</div>
  </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-d6plus-openend">
  <div class="sheet-template-container">
    <div>{{character}}</div>
    <h3>{{name}}</h3>
    <div><strong>Dice Code:</strong> {{dice_code}}</div>
    <div><strong>Total:</strong> {{rolls}}</div>
    <div style="color: green;"><strong>Open Ended D20s:</strong> {{d20s}}</div>
  </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-combined-openend">
  <div class="sheet-template-container">
    <div>{{character}}</div>
    <h3>{{name}}</h3>
    <div><strong>{{skill_1}}</strong> {{dice_code_1}}</div>
    <div><strong>{{skill_2}}</strong> {{dice_code_2}}</div>
    <h3></h3>
    <div><strong>Total:</strong> {{rolls}}</div>
    <div style="color: green;"><strong>Open Ended D20s:</strong> {{d20s}}</div>
  </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-d6plus-mishap">
  <div class="sheet-template-container">
    <div>{{character}}</div>
    <h3>{{name}}</h3>
    <div><strong>Dice Code:</strong> {{dice_code}}</div>
    <div><strong>Total:</strong> {{roll}}</div>
    <div><strong>Open Ended D20:</strong> {{d20}}</div>
    <div style="color: red;"><strong>Mishap!!</strong></div>
  </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-combined-mishap">
  <div class="sheet-template-container">
    <div>{{character}}</div>
    <h3>{{name}}</h3>
    <div><strong>{{skill_1}}</strong> {{dice_code_1}}</div>
    <div><strong>{{skill_2}}</strong> {{dice_code_2}}</div>
    <h3></h3>
    <div><strong>Total:</strong> {{roll}}</div>
    <div><strong>Open Ended D20:</strong> {{d20}}</div>
    <div style="color: red;"><strong>Mishap!!</strong></div>
  </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-speed">
  <div class="sheet-template-container">
    <div>{{character}}</div>
    <h3>{{move_type}}</h3>
    <div><strong>Dice Code:</strong> {{dice_code}}</div>
    <div><strong>Move Code:</strong> {{move_code}} ft</div>
  </div>
</rolltemplate>
