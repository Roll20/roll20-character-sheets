<div class="sheet-wrapper">
    <table>
        <tr>
            <td class="sheet-box_alternate_row"><span>Karaktärsnamn</span></td>
            <td><input class="sheet-fardighetstabell_large" type="text" name="attr_character_name"></td>
        </tr>
    </table>
    <div>
        <h1>Grundegenskaper</h1>
        <input type="checkbox" class="sheet-arrow" name="attr_arrow_grund"><span></span>
        <div class="sheet-body">
            <div class="sheet-5colrow">
                <div class="sheet-col">
                    <table>
                        <tr>
                            <td><button class="sheet-roll_alternate3" type="roll" style="width: 50px; height: 45px; font-weight: bolder; font-size: 32;" name="roll_styr" value="&{template:DoDFardighet} {{name=Styrka}} {{slag=[[1d20]]}} {{fardighet=[[@{sty}+?{Övrig modifierare|0}]]}} {{text=hej mitt vinterland, nu är jag här. hej mitt vinterland, nu är jag här.}} {{text2=hej mitt vinterland, nu är jag här. hej mitt vinterland, nu är jag här.}}">STY</button></td>
                            <td><input type="number" style="width: 50px; height: 50px; font-weight: bolder; font-size: 20px; text-align: center" min="0" name="attr_sty" class="sheet-grundegenskapstabell"></td>
                            <td><button class="sheet-roll_alternate3" type="roll" style="width: 50px; height: 45px; font-weight: bolder; font-size: 32;" name="roll_fysr" value="&{template:DoDFardighet} {{name=Fysik}} {{slag=[[1d20]]}} {{fardighet=[[@{fys}+?{Övrig modifierare|0}]]}}">FYS</button></td>
                            <td><input type="number" style="width: 50px; height: 50px; font-weight: bolder; font-size: 20px; text-align: center" min="0" name="attr_fys" class="sheet-grundegenskapstabell"></td>
                            <td><button class="sheet-roll_alternate3" type="roll" style="width: 50px; height: 45px; font-weight: bolder; font-size: 32;" name="roll_smir" value="&{template:DoDFardighet} {{name=Smidighet}} {{slag=[[1d20]]}} {{fardighet=[[@{smi}+?{Övrig modifierare|0}]]}}">SMI</button></td>
                            <td><input type="number" style="width: 50px; height: 50px; font-weight: bolder; font-size: 20px; text-align: center" min="0" name="attr_smi" class="sheet-grundegenskapstabell"></td>
                        </tr>
                        <tr>
                            <td><button class="sheet-roll_alternate3" type="roll" style="width: 50px; height: 45px; font-weight: bolder; font-size: 32;" name="roll_stor" value="&{template:DoDFardighet} {{name=Storlek}} {{slag=[[1d20]]}} {{fardighet=[[@{sto}+?{Övrig modifierare|0}]]}}">STO</button></td>
                            <td><input type="number" style="width: 50px; height: 50px; font-weight: bolder; font-size: 20px; text-align: center" min="0" name="attr_sto" class="sheet-grundegenskapstabell"></td>
                            <td><button class="sheet-roll_alternate3" type="roll" style="width: 50px; height: 45px; font-weight: bolder; font-size: 32;" name="roll_intr" value="&{template:DoDFardighet} {{name=Intelligens}} {{slag=[[1d20]]}} {{fardighet=[[@{int}+?{Övrig modifierare|0}]]}}">INT</button></td>
                            <td><input type="number" style="width: 50px; height: 50px; font-weight: bolder; font-size: 20px; text-align: center" min="0" name="attr_int" class="sheet-grundegenskapstabell"></td>
                            <td><button class="sheet-roll_alternate3" type="roll" style="width: 50px; height: 45px; font-weight: bolder; font-size: 32;" name="roll_perr" value="&{template:DoDFardighet} {{name=Perception}} {{slag=[[1d20]]}} {{fardighet=[[@{per}+?{Övrig modifierare|0}]]}}">PER</button></td>
                            <td><input type="number" style="width: 50px; height: 50px; font-weight: bolder; font-size: 20px; text-align: center" min="0" name="attr_per" class="sheet-grundegenskapstabell"></td>
                        </tr>
                        <tr>
                            <td><button class="sheet-roll_alternate3" type="roll" style="width: 50px; height: 45px; font-weight: bolder; font-size: 32;" name="roll_psyr" value="&{template:DoDFardighet} {{name=Psyke}} {{slag=[[1d20]]}} {{fardighet=[[@{psy}+?{Övrig modifierare|0}]]}}">PSY</button></td>
                            <td><input type="number" style="width: 50px; height: 50px; font-weight: bolder; font-size: 20px; text-align: center" min="0" name="attr_psy" class="sheet-grundegenskapstabell"></td>
                            <td><button class="sheet-roll_alternate3" type="roll" style="width: 50px; height: 45px; font-weight: bolder; font-size: 32;" name="roll_spir" value="&{template:DoDFardighet} {{name=Spiritus}} {{slag=[[1d20]]}} {{fardighet=[[@{spi}+?{Övrig modifierare|0}]]}}">SPI</button></td>
                            <td><input type="number" style="width: 50px; height: 50px; font-weight: bolder; font-size: 20px; text-align: center" min="0" name="attr_spi" class="sheet-grundegenskapstabell"></td>
                            <td><button class="sheet-roll_alternate3" type="roll" style="width: 50px; height: 45px; font-weight: bolder; font-size: 32;" name="roll_karr" value="&{template:DoDFardighet} {{name=Karisma}} {{slag=[[1d20]]}} {{fardighet=[[@{kar}+?{Övrig modifierare|0}]]}}">KAR</button></td>
                            <td><input type="number" style="width: 50px; height: 50px; font-weight: bolder; font-size: 20px; text-align: center" min="0" name="attr_kar" class="sheet-grundegenskapstabell"></td>
                        </tr>
                    </table>
                </div>
                <div class="sheet-col">
                    <table>
                        <thead>
                            <tr>
                                <td class="sheet-box_alternate">Förmåga</td>
                                <td class="sheet-box_alternate">Beskrivning</td>
                            </tr>
                            <tr>
                                <td><input type="text" name="attr_formagabesk_display" class="sheet-fardighetstabell"></td>
                                <td><input type="text" name="attr_formaga_display" class="sheet-formagatabell"></td>
                            </tr>
                        </thead>
                    </table>
                    <fieldset class="repeating_formaga">
                        <table>
                            <tr>
                                <td><input type="text" name="attr_formagabesk" class="sheet-fardighetstabell"></td>
                                <td><input type="text" name="attr_formaga" class="sheet-formagatabell"></td>
                            </tr>
                        </table>
                    </fieldset>
                </div>
            </div>
            <div>
                <h3>Sekundära egenskaper</h3>
                <input type="checkbox" class="sheet-arrow" name="attr_arrow_sekundara"><span></span>
                <div class="sheet-body">
                    <div class="sheet-5colrow">
                        <div class="sheet-col">
                            <table>
                                <tr>
                                    <td class="sheet-box_alternate_row"><span>Nattsyn</span></td>
                                    <td><input type=text class="sheet-fardighetstabell_half" name="attr_synljus"></td>
                                </tr>
                                <tr>
                                    <td class="sheet-box_alternate_row"><span>Mörkersyn</span></td>
                                    <td><input type=text class="sheet-fardighetstabell_half" name="attr_synmork"></td>
                                </tr>
                            </table>
                        </div>
                        <div class="sheet-col">
                            <table>
                                <tr>
                                    <td class="sheet-box_alternate_row"><span>Förflyttning</span></td>
                                    <td><input type=text class="sheet-fardighetstabell_small" name="attr_forf"></td>
                                </tr>
                                <tr>
                                    <td class="sheet-box_alternate_row"><span>Läkning</span></td>
                                    <td><input type=text class="sheet-fardighetstabell_small" name="attr_lkn"></td>
                                </tr>
                            </table>
                        </div>
                        <div class="sheet-col">
                            <table>
                                <tr>
                                    <td><button class="sheet-roll_alternate4" type="roll" name="roll_skrackmod" value="&{template:DoDText} {{name=Skräck}} {{text=[[1d20+@{skrack}+?{Övrig modifierare|0}]]}}">Skräck</button></td>
                                    <td><input type=text class="sheet-fardighetstabell_small" name="attr_skrack"></td>
                                </tr>
                                <tr>
                                    <td><button class="sheet-roll_alternate4" type="roll" name="roll_initiative" value="&{template:DoDText} {{name=Initiativ}} {{subtags=@{selected|token_name} slår initiativ!}} {{text=[[1d10+?{Initiativ|@{im}}&{tracker}]]}}" >Initiativ</button></td>
                                    <td><input type=text class="sheet-fardighetstabell_small" name="attr_im"></td>
                                </tr>
                            </table>
                        </div>
                        <div class="sheet-col">
                            <table>
                                <tr>
                                    <td class="sheet-box_alternate_row"><span>SB</span></td>
                                    <td><input type=text class="sheet-fardighetstabell_small" name="attr_sb" value="0"></td>
                                </tr>
                                <tr>
                                    <td class="sheet-box_alternate_row"><span>CLB</span></td>
                                    <td><input type=text class="sheet-fardighetstabell_small" name="attr_clb"></td>
                                </tr>
                            </table>
                        </div>
                        <div class="sheet-col">
                            <table>
                                <tr>
                                    <td class="sheet-box_alternate_row"><span>KP-mod.</span></td>
                                    <td><input type=text class="sheet-fardighetstabell_small" name="attr_kpm"></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <div>
                <h3>Personlig information</h3>
                <input type="checkbox" class="sheet-arrow" name="attr_arrow_personliginfo"><span></span>
                <div class="sheet-body">
                    <div class="sheet-5colrow">
                        <div class="sheet-col">
                            <table>
                                <tr>
                                    <td class="sheet-box_alternate_row"><span>Ras</span></td>
                                    <td><input class="sheet-fardighetstabell_half" type="text" name="attr_ras"></td>
                                </tr>
                                <tr>
                                    <td class="sheet-box_alternate_row"><span>Folkslag</span></td>
                                    <td><input class="sheet-fardighetstabell_half" type="text" name="attr_folkslag"></td>
                                </tr>
                                <tr>
                                    <td class="sheet-box_alternate_row"><span>Religion</span></td>
                                    <td><input class="sheet-fardighetstabell_half" type="text" name="attr_religion"></td>
                                </tr>
                                <tr>
                                    <td class="sheet-box_alternate_row"><span>Socialt stånd</span></td>
                                    <td><input class="sheet-fardighetstabell_half" type="text" name="attr_socialtstand"></td>
                                </tr>
                                <tr>
                                    <td class="sheet-box_alternate_row"><span>Vapenhand</span></td>
                                    <td><input class="sheet-fardighetstabell_half" type="text" name="attr_vapenhand"></td>
                                </tr>
                                <tr>
                                    <td class="sheet-box_alternate_row"><span>Kön</span></td>
                                    <td><input class="sheet-fardighetstabell_half" type="text" name="attr_kon"></td>
                                </tr>
                                <tr>
                                    <td class="sheet-box_alternate_row"><span>Ålder</span></td>
                                    <td><input class="sheet-fardighetstabell_half" type="text" name="attr_alder"></td>
                                </tr>
                                <tr>
                                    <td class="sheet-box_alternate_row"><span>Längd</span></td>
                                    <td><input class="sheet-fardighetstabell_half" type="text" name="attr_langd"></td>
                                </tr>
                                <tr>
                                    <td class="sheet-box_alternate_row"><span>Vikt</span></td>
                                    <td><input class="sheet-fardighetstabell_half" type="text" name="attr_vikt"></td>
                                </tr>
                            </table>
                        </div>
                        <div class="sheet-col">
                            <table>
                                <tr>
                                    <th class="sheet-box_alternate2">Övrig information</th>
                                </tr>
                                <tr>
                                    <td><textarea name="attr_ovriginfo" style="width: 600px; height: 220px"></textarea></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div>
        <h1>Färdigheter</h1>
        <input type="checkbox" class="sheet-arrow" name="attr_arrow_fardigheter"><span></span>
        <div class="sheet-body">
            <div class="sheet-row">
                <table>
                    <tr>
                        <td class="sheet-box_alternate_row"><span>Total FP</span></td>
                        <td><input type="number" name="attr_fptot" min="0" class="sheet-fardighetstabell"></td>
                        <td class="sheet-box_alternate_row"><span>FP kvar</span></td>
                        <td><input type="number" name="attr_fpkvar" min="0" class="sheet-fardighetstabell"></td>
                    </tr>
                </table>
            </div>
            <div>
                <h3>Kärnfärdigheter</h3>
                <input type="checkbox" class="sheet-arrow" name="attr_arrow_karn"><span></span>
                <div class="sheet-body">
                    <div class="sheet-colrow">
                        <table>
                            <tr>
                                <td class="sheet-box_alternate"><span>Namn</span></td>
                                <td class="sheet-box_alternate"><span>Bas</span></td>
                                <td class="sheet-box_alternate"><span>Kost.</span></td>
                                <td class="sheet-box_alternate"><span>FV</span></td>
                                <td class="sheet-box_alternate"><span>Krit.</span></td>
                            </tr>
                            <tr>
                                <td><input type="text" name="attr_karnnamn_display" class="sheet-fardighetstabell"></td>
                                <td><input type="text" name="attr_karnbas_display" class="sheet-fardighetstabell"></td>
                                <td><input type="number" name="attr_karnkost_display" class="sheet-fardighetstabell"></td>
                                <td><input type="number" name="attr_karnfv_display" class="sheet-fardighetstabell"></td>
                                <td><input type="number" name="attr_karncrit_display" class="sheet-fardighetstabell"></td>
                                <td><button type="roll" name="roll_karn_display" value="&{template:DoDFardighet} {{name=@{karnnamn_display}}} {{slag=[[1d20]]}} {{fardighet=[[@{karnfv_display}+?{Modifierare|0}]]}}" class="sheet-tarningstabell"></button></td>
                            </tr>
                        </table>
                        <fieldset class="repeating_karn">
                            <table>
                                <tr>
                                    <td><input type="text" name="attr_karnnamn" class="sheet-fardighetstabell"></td>
                                    <td><input type="text" name="attr_karnbas" class="sheet-fardighetstabell"></td>
                                    <td><input type="number" name="attr_karnkost" class="sheet-fardighetstabell"></td>
                                    <td><input type="number" name="attr_karnfv" class="sheet-fardighetstabell"></td>
                                    <td><input type="number" name="attr_karncrit" class="sheet-fardighetstabell"></td>
                                    <td><button type="roll" name="roll_karn" value="&{template:DoDFardighet} {{name=@{karnnamn}}} {{slag=[[1d20]]}} {{fardighet=[[@{karnfv}+?{Modifierare|0}]]}}" class="sheet-tarningstabell"></button></td>
                                </tr>
                            </table>
                        </fieldset>
                    </div>
                </div>
            </div>
            <div>
                <h3>Yrkesfärdigheter</h3>
                <input type="checkbox" class="sheet-arrow" name="attr_arrow_yrkes"><span></span>
                <div class="sheet-body">
                    <div class="sheet-colrow">
                        <table>
                            <tr>
                                <td class="sheet-box_alternate"><span>Namn</span></td>
                                <td class="sheet-box_alternate"><span>Bas</span></td>
                                <td class="sheet-box_alternate"><span>Kost.</span></td>
                                <td class="sheet-box_alternate"><span>FV</span></td>
                                <td class="sheet-box_alternate"><span>Krit.</span></td>
                            </tr>
                            <tr>
                                <td><input type="text" name="attr_yrkesnamn_display" class="sheet-fardighetstabell"></td>
                                <td><input type="text" name="attr_yrkesbas_display" class="sheet-fardighetstabell"></td>
                                <td><input type="number" name="attr_yrkeskost_display" class="sheet-fardighetstabell"></td>
                                <td><input type="number" name="attr_yrkesfv_display" class="sheet-fardighetstabell"></td>
                                <td><input type="number" name="attr_yrkescrit_display" class="sheet-fardighetstabell"></td>
                                <td><button type="roll" name="roll_yrkes_display" value="&{template:DoDFardighet} {{name=@{yrkesnamn_display}}} {{slag=[[1d20]]}} {{fardighet=[[@{yrkesfv_display}+?{Modifierare|0}]]}}" class="sheet-tarningstabell"></button></td>
                            </tr>
                        </table>
                        <fieldset class="repeating_yrkes">
                            <table>
                                <tr>
                                    <td><input type="text" name="attr_yrkesnamn" class="sheet-fardighetstabell"></td>
                                    <td><input type="text" name="attr_yrkesbas" class="sheet-fardighetstabell"></td>
                                    <td><input type="number" name="attr_yrkeskost" class="sheet-fardighetstabell"></td>
                                    <td><input type="number" name="attr_yrkesfv" class="sheet-fardighetstabell"></td>
                                    <td><input type="number" name="attr_yrkescrit" class="sheet-fardighetstabell"></td>
                                    <td><button type="roll" name="roll_yrkes" value="&{template:DoDFardighet} {{name=@{yrkesnamn}}} {{slag=[[1d20]]}} {{fardighet=[[@{yrkesfv}+?{Modifierare|0}]]}}" class="sheet-tarningstabell"></button></td>
                                </tr>
                            </table>
                        </fieldset>
                    </div>
                </div>
            </div>
            <div>
                <h3>Allmänna färdigheter</h3>
                <input type="checkbox" class="sheet-arrow" name="attr_arrow_allmann"><span></span>
                <div class="sheet-body">
                        <div class="sheet-colrow">
                            <table>
                                <tr>
                                    <td class="sheet-box_alternate"><span>Namn</span></td>
                                    <td class="sheet-box_alternate"><span>Bas</span></td>
                                    <td class="sheet-box_alternate"><span>Kost.</span></td>
                                    <td class="sheet-box_alternate"><span>FV</span></td>
                                    <td class="sheet-box_alternate"><span>Krit.</span></td>
                                </tr>
                                <tr>
                                    <td><input type="text" name="attr_allmannamn_display" class="sheet-fardighetstabell"></td>
                                    <td><input type="text" name="attr_allmanbas_display" class="sheet-fardighetstabell"></td>
                                    <td><input type="number" name="attr_allmankost_display" class="sheet-fardighetstabell"></td>
                                    <td><input type="number" name="attr_allmanfv_display" class="sheet-fardighetstabell"></td>
                                    <td><input type="number" name="attr_allmancrit_display" class="sheet-fardighetstabell"></td>
                                    <td><button type="roll" name="roll_allman_display" value="&{template:DoDFardighet} {{name=@{allmannamn_display}}} {{slag=[[1d20]]}} {{fardighet=[[@{allmanfv_display}+?{Modifierare|0}]]}}" class="sheet-tarningstabell"></button></td>
                                </tr>
                            </table>
                            <fieldset class="repeating_allman">
                                <table>
                                    <tr>
                                        <td><input type="text" name="attr_allmannamn" class="sheet-fardighetstabell"></td>
                                        <td><input type="text" name="attr_allmanbas" class="sheet-fardighetstabell"></td>
                                        <td><input type="number" name="attr_allmankost" class="sheet-fardighetstabell"></td>
                                        <td><input type="number" name="attr_allmanfv" class="sheet-fardighetstabell"></td>
                                        <td><input type="number" name="attr_allmancrit" class="sheet-fardighetstabell"></td>
                                        <td><button type="roll" name="roll_allman" value="&{template:DoDFardighet} {{name=@{allmannamn}}} {{slag=[[1d20]]}} {{fardighet=[[@{allmanfv}+?{Modifierare|0}]]}}" class="sheet-tarningstabell"></button></td>
                                    </tr>
                                </table>
                            </fieldset>
                        </div>
                </div>
            </div>
        </div>
    </div>
    <div>
        <h1>Magi</h1>
        <input type="checkbox" class="sheet-arrow" name="attr_arrow_magi"><span></span>
        <div class="sheet-body">
            <div class="sheet-row">
                <table>
                    <tr>
                        <td class="sheet-box_alternate_row"><span>Max SPI-poäng</span></td>
                        <td><input type="number" name="attr_maxspip" min="0" class="sheet-fardighetstabell"></td>
                        <td class="sheet-box_alternate_row"><span>SPI-poäng kvar</span></td>
                        <td><input type="number" name="attr_spipkvar" min="0" class="sheet-fardighetstabell"></td>
                    </tr>
                </table>
            </div>
            <div>
                <h3>Besvärjelser</h3>
                <input type="checkbox" class="sheet-arrow" name="attr_arrow_besvarjelser"><span></span>
                <div class="sheet-body">
                    <div class="sheet-colrow">
                        <table>
                            <tr>
                                <td class="sheet-box_alternate"><span>Namn</span></td>
                                <td class="sheet-box_alternate"><span>FV</span></td>
                                <td class="sheet-box_alternate"><span>Mod</span></td>
                                <td class="sheet-box_alternate"><span>Kost.</span></td>
                            </tr>
                            <tr>
                                <td><input type="text" name="attr_maginamn_display" class="sheet-fardighetstabell"></td>
                                <td><input type="number" name="attr_magifv_display" class="sheet-fardighetstabell"></td>
                                <td><input type="number" name="attr_magimod_display" class="sheet-fardighetstabell"></td>
                                <td><input type="number" name="attr_magikost_display" class="sheet-fardighetstabell"></td>
                                <td><button type="roll" name="roll_magi_display" value="&{template:DoDFardighet} {{name=@{maginamn_display}}} {{slag=[[1d20]]}} {{fardighet=[[@{magifv_display}+?{Modifierare|@{magimod_display}}]]}} {{text=@{magibesk_display}}}" class="sheet-tarningstabell"></button></td>
                            </tr>
                        </table>
                        <tr>
                            <td><textarea class="sheet-textarea_wide" style="Width: 400px" name="attr_magibesk_display"></textarea></td>
                        </tr>
                        <fieldset class="repeating_magi">
                            <table>
                                    <tr>
                                        <td class="sheet-box_alternate"><span>Namn</span></td>
                                        <td class="sheet-box_alternate"><span>FV</span></td>
                                        <td class="sheet-box_alternate"><span>Mod</span></td>
                                        <td class="sheet-box_alternate"><span>Kost.</span></td>
                                    </tr>
                                    <tr>
                                        <td><input type="text" name="attr_maginamn" class="sheet-fardighetstabell"></td>
                                        <td><input type="number" name="attr_magifv" class="sheet-fardighetstabell"></td>
                                        <td><input type="number" name="attr_magimod" class="sheet-fardighetstabell"></td>
                                        <td><input type="number" name="attr_magikost" class="sheet-fardighetstabell"></td>
                                        <td><button type="roll" name="roll_magi" value="&{template:DoDFardighet} {{name=@{maginamn}}} {{slag=[[1d20]]}} {{fardighet=[[@{magifv}+?{Modifierare|@{magimod}}]]}} {{text=@{magibesk}}}" class="sheet-tarningstabell"></button></td>
                                    </tr>
                            </table>
                            <tr>
                                <td><textarea class="sheet-textarea_wide" style="Width: 400px" name="attr_magibesk"></textarea></td>
                            </tr>
                        </fieldset>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div>
        <h1>Strid</h1>
        <input type="checkbox" class="sheet-arrow" name="attr_arrow_strid"><span></span>
        <div class="sheet-body">
            <div class="sheet-row">
                <table>
                    <tr>
                        <td class="sheet-box_alternate_row"><span>Grundstridskapacitet</span></td>
                        <td><input class="sheet-fardighetstabell" type="number" name ="attr_stridskapg" disabled="true" value="round((@{STY}+@{FYS}+@{SMI})/3)"></td>
                    </tr>
                </table>
            </div>
            <div>
                <h3>Kroppspoäng och rustning</h3>
                <input type="checkbox" class="sheet-arrow" name="attr_arrow_kprv"><span></span>
                <div class="sheet-body">
                    <div class="sheet-colrow">
                        <table>
                            <tr>
                                <td class="sheet-box_alternate_row2"><span></span></td>
                                <td class="sheet-box_alternate_row2"><span>KP-tot</span></td>
                                <td class="sheet-box_alternate_row2"><span>KP</span></td>
                                <td class="sheet-box_alternate_row2"><span>RV</span></td>
                                <td class="sheet-box_alternate_row2"><span>Vikt</span></td>
                                <td class="sheet-box_alternate_row2"><span>Skador</span></td>
                                <td class="sheet-box_alternate_row2"><span>Övrigt</span></td>
                            </tr>
                            <tr>
                                <td class="sheet-box_alternate_row2"><span>Huvud (1-2)</span></td>
                                <td><input class="sheet-fardighetstabell" type="number" min="0" disabled="true" name="attr_totkphuvud" value="round(@{totkp}/4)"></td>
                                <td><input class="sheet-fardighetstabell" type="number" name="attr_nukphuvud"></td>
                                <td><input class="sheet-fardighetstabell" type="number" name="attr_rvhuvud"></td>
                                <td><input class="sheet-fardighetstabell" type="number" min="0" value="0" step="any" name="attr_vikthuvud"></td>
                                <td><input class="sheet-fardighetstabell" type="number" min="0" value="0" name="attr_sarhuvud"></td>
                                <td><input class="sheet-fardighetstabell" type="text" name="attr_ovrigthuvud"></td>
                            </tr>
                            <tr>
                                <td class="sheet-box_alternate_row2"><span>Höger arm (3-4)</span></td>
                                <td><input class="sheet-fardighetstabell" type="number" min="0" disabled="true" name="attr_totkphogerarm" value="round(@{totkp}/4)"></td>
                                <td><input class="sheet-fardighetstabell" type="number" name="attr_nukphogerarm"></td>
                                <td><input class="sheet-fardighetstabell" type="number" name="attr_rvhogerarm"></td>
                                <td><input class="sheet-fardighetstabell" type="number" min="0" value="0" step="any" name="attr_vikthogerarm"></td>
                                <td><input class="sheet-fardighetstabell" type="number" min="0" value="0" name="attr_sarhogerarm"></td>
                                <td><input class="sheet-fardighetstabell" type="text" name="attr_ovrigthogerarm"></td>
                            </tr>
                            <tr>
                                <td class="sheet-box_alternate_row2"><span>Vänster arm (5-6)</span></td>
                                <td><input class="sheet-fardighetstabell" type="number" min="0" disabled="true" name="attr_totkpvansterarm" value="round(@{totkp}/4)"></td>
                                <td><input class="sheet-fardighetstabell" type="number" name="attr_nukpvansterarm"></td>
                                <td><input class="sheet-fardighetstabell" type="number" name="attr_rvvansterarm"></td>
                                <td><input class="sheet-fardighetstabell" type="number" min="0" value="0" step="any" name="attr_viktvansterarm"></td>
                                <td><input class="sheet-fardighetstabell" type="number" min="0" value="0" name="attr_sarvansterarm"></td>
                                <td><input class="sheet-fardighetstabell" type="text" name="attr_ovrigtvansterarm"></td>
                            </tr>
                            <tr>
                                <td class="sheet-box_alternate_row2"><span>Bröstkorg (7-11)</span></td>
                                <td><input class="sheet-fardighetstabell" type="number" min="0" disabled="true" name="attr_totkpbrost" value="round(@{totkp}/2)"></td>
                                <td><input class="sheet-fardighetstabell" type="number" name="attr_nukpbrost"></td>
                                <td><input class="sheet-fardighetstabell" type="number" name="attr_rvbrost"></td>
                                <td><input class="sheet-fardighetstabell" type="number" min="0" value="0" step="any" name="attr_viktbrost"></td>
                                <td><input class="sheet-fardighetstabell" type="number" min="0" value="0" name="attr_sarbrost"></td>
                                <td><input class="sheet-fardighetstabell" type="text" name="attr_ovrigtbrost"></td>
                            </tr>
                            <tr>
                                <td class="sheet-box_alternate_row2"><span>Mage (12-14)</span></td>
                                <td><input class="sheet-fardighetstabell" type="number" min="0" disabled="true" name="attr_totkpmage" value="round(@{totkp}/3)"></td>
                                <td><input class="sheet-fardighetstabell" type="number" name="attr_nukpmage"></td>
                                <td><input class="sheet-fardighetstabell" type="number" name="attr_rvmage"></td>
                                <td><input class="sheet-fardighetstabell" type="number" min="0" value="0" step="any" name="attr_viktmage"></td>
                                <td><input class="sheet-fardighetstabell" type="number" min="0" value="0" name="attr_sarmage"></td>
                                <td><input class="sheet-fardighetstabell" type="text" name="attr_ovrigtmage"></td>
                            </tr>
                            <tr>
                                <td class="sheet-box_alternate_row2"><span>Höger ben (15-17)</span></td>
                                <td><input class="sheet-fardighetstabell" type="number" min="0" disabled="true" name="attr_totkphogerben" value="round(@{totkp}/3)"></td>
                                <td><input class="sheet-fardighetstabell" type="number" name="attr_nukphogerben"></td>
                                <td><input class="sheet-fardighetstabell" type="number" name="attr_rvhogerben"></td>
                                <td><input class="sheet-fardighetstabell" type="number" min="0" value="0" step="any" name="attr_vikthogerben"></td>
                                <td><input class="sheet-fardighetstabell" type="number" min="0" value="0" name="attr_sarhogerben"></td>
                                <td><input class="sheet-fardighetstabell" type="text" name="attr_ovrigthogerben"></td>
                            </tr>
                            <tr>
                                <td class="sheet-box_alternate_row2"><span>Vänster ben (18-20)</span></td>
                                <td><input class="sheet-fardighetstabell" type="number" min="0" disabled="true" name="attr_totkpvansterben" value="round(@{totkp}/3)"></td>
                                <td><input class="sheet-fardighetstabell" type="number" name="attr_nukpvansterben"></td>
                                <td><input class="sheet-fardighetstabell" type="number" name="attr_rvvansterben"></td>
                                <td><input class="sheet-fardighetstabell" type="number" min="0" value="0" step="any" name="attr_viktvansterben"></td>
                                <td><input class="sheet-fardighetstabell" type="number" min="0" value="0" name="attr_sarvansterben"></td>
                                <td><input class="sheet-fardighetstabell" type="text" name="attr_ovrigtvansterben"></td>
                            </tr>
                            <tr>
                                <td class="sheet-box_alternate_row2"><span>Totalt</span></td>
                                <td><input class="sheet-fardighetstabell" type="number" min="0" value="12" name="attr_totkp"></td>
                                <td><input class="sheet-fardighetstabell" type="number" min="0" name="attr_nutotkp"></td>
                                <td><span></span></td>
                                <td><input class="sheet-fardighetstabell" type="number" min="0" disabled="true" name="attr_totviktrustning" value="(@{vikthuvud}+@{vikthogerarm}+@{viktvansterarm}+@{viktbrost}+@{viktmage}+@{vikthogerben}+@{viktvansterben})"></td>
                                <td><input class="sheet-fardighetstabell" type="number" min="0" disabled="true" name="attr_totsar" value="(@{sarhuvud}+@{sarhogerarm}+@{sarvansterarm}+@{sarbrost}+@{sarmage}+@{sarhogerben}+@{sarvansterben})"></td>
                                <td><input class="sheet-fardighetstabell" type="text" name="attr_ovrigttot"></td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
            <div>
                <h3>Stridskapacitet</h3>
                <input type="checkbox" class="sheet-arrow" name="attr_arrow_stridskap"><span></span>
                <div class="sheet-body">
                    <div class="sheet-colrow">
                        <table>
                            <tr>
                                <td class="sheet-box_alternate"><span>Vapen</span></td>
                                <td class="sheet-box_alternate2"><span>FV</span></td>
                                <td class="sheet-box_alternate2"><span>Total</span></td>
                                <td class="sheet-box_alternate2"><span>BV</span></td>
                                <td class="sheet-box_alternate2"><span>IM</span></td>
                            </tr>
                            <tr>
                                <td><input class="sheet-fardighetstabell" type="text" name="attr_stridskapvapennamn_display"></td>
                                <td><input class="sheet-fardighetstabell" type="number" name="attr_stridskapvapenfv_display" value="0"></td>
                                <td><input class="sheet-fardighetstabell" type="number" name="attr_stridskapvapentot_display" disabled="true" value="@{stridskapg}+@{stridskapvapenfv_display}"></td>
                                <td><input class="sheet-fardighetstabell" type="number" name="attr_stridskapbv_display"></td>
                                <td><input class="sheet-fardighetstabell" type="number" name="attr_stridskapim_display"></td>
                                <td><button class="sheet-tarningstabell" type="roll" name="roll_stridskaprim_display" value="&{template:DoDText} {{name=Initiativ}} {{subtags=@{selected|token_name} slår initiativ!}} {{text=[[1d10+@{im}+@{stridskapim_display}&{tracker}]]}}"></button></td>
                            </tr>
                        </table>
                            <fieldset class="repeating_stridskap">
                                    <table>
                                        <tr>
                                            <td><input class="sheet-fardighetstabell" type="text" name="attr_stridskapvapennamn"></td>
                                            <td><input class="sheet-fardighetstabell" type="number" name="attr_stridskapvapenfv" value="0"></td>
                                            <td><input class="sheet-fardighetstabell" type="number" name="attr_stridskapvapentot" disabled="true" value="@{stridskapg}+@{stridskapvapenfv}"></td>
                                            <td><input class="sheet-fardighetstabell" type="number" name="attr_stridskapbv"></td>
                                            <td><input class="sheet-fardighetstabell" type="number" name="attr_stridskapim"></td>
                                            <td><button class="sheet-tarningstabell" type="roll" name="roll_stridskaprim" value="&{template:DoDText} {{name=Initiativ}} {{subtags=@{selected|token_name} slår initiativ!}} {{text=[[1d10+@{im}+@{stridskapim}&{tracker}]]}}"></button></td>
                                        </tr>
                                </table>
                            </fieldset>
                    </div>
                </div>
            </div>
            <div>
                <h3>Attack och försvar</h3>
                <input type="checkbox" class="sheet-arrow" name="attr_arrow_attackforsvar"><span></span>
                <div class="sheet-body">
                    <div class="sheet-colrow">
                            <table>
                                <tr>
                                    <td><button class="sheet-roll_alternate" type="roll" name="roll_vapenvisa_display" value="&{template:DoDText} {{name=Attack/Försvar}} {{subtags=@{vapennamn_display}}} {{titel=Attack: }} {{text=@{vapenatk1_display}/@{vapenatk2_display}/@{vapenatk3_display}/@{vapenatk4_display}/@{vapenatk5_display}}} {{titel2=Försvar: }} {{text2=@{vapenfor1_display}/@{vapenfor2_display}/@{vapenfor3_display}/@{vapenfor4_display}/@{vapenfor5_display}}}">Vapen</button></td>
                                    <td><button class="sheet-roll_alternate2" type="roll" name="roll_vapenskada_display" value="&{template:DoDText} {{name=@{vapennamn_display}}} {{subtags=Skada}} {{text=[[@{vapenskada_display}+@{vapensb_display}]]}}">Skada</button></td>
                                </tr>
                                <tr>
                                    <td><input class="sheet-fardighetstabell" type="text" name="attr_vapennamn_display"></td>
                                    <td><input class="sheet-fardighetstabell" type="text" name="attr_vapenskada_display"></td>
                                </tr>
                            </table>
                            <table>
                                <tr>
                                    <td class="sheet-box_alternate_row">Attack</td>
                                    <td><input class="sheet-fardighetstabell" type="number" value="0" name="attr_vapenatk1_display"></td>
                                    <td><button class="sheet-tarningstabell" type="roll" value="&{template:DoDAttack} {{name=@{vapennamn_display}}} {{subtags=Attack}} {{slag=[[1d20]]}} {{fardighet=@{vapenatk1_display}}} {{traff=[[1d20]]}} {{skada=[[@{vapenskada_display}+@{vapensb_display}]]}}" name="roll_vapenatk1_display"></button></td>
                                    <td><input class="sheet-fardighetstabell" type="number" value="0" name="attr_vapenatk2_display"></td>
                                    <td><button class="sheet-tarningstabell" type="roll" value="&{template:DoDAttack} {{name=@{vapennamn_display}}} {{subtags=Attack}} {{slag=[[1d20]]}} {{fardighet=@{vapenatk2_display}}} {{traff=[[1d20]]}} {{skada=[[@{vapenskada_display}+@{vapensb_display}]]}}" name="roll_vapenatk2_display"></button></td>
                                    <td><input class="sheet-fardighetstabell" type="number" value="0" name="attr_vapenatk3_display"></td>
                                    <td><button class="sheet-tarningstabell" type="roll" value="&{template:DoDAttack} {{name=@{vapennamn_display}}} {{subtags=Attack}} {{slag=[[1d20]]}} {{fardighet=@{vapenatk3_display}}} {{traff=[[1d20]]}} {{skada=[[@{vapenskada_display}+@{vapensb_display}]]}}" name="roll_vapenatk3_display"></button></td>
                                    <td><input class="sheet-fardighetstabell" type="number" value="0" name="attr_vapenatk4_display"></td>
                                    <td><button class="sheet-tarningstabell" type="roll" value="&{template:DoDAttack} {{name=@{vapennamn_display}}} {{subtags=Attack}} {{slag=[[1d20]]}} {{fardighet=@{vapenatk4_display}}} {{traff=[[1d20]]}} {{skada=[[@{vapenskada_display}+@{vapensb_display}]]}}" name="roll_vapenatk4_display"></button></td>
                                    <td><input class="sheet-fardighetstabell" type="number" value="0" name="attr_vapenatk5_display"></td>
                                    <td><button class="sheet-tarningstabell" type="roll" value="&{template:DoDAttack} {{name=@{vapennamn_display}}} {{subtags=Attack}} {{slag=[[1d20]]}} {{fardighet=@{vapenatk5_display}}} {{traff=[[1d20]]}} {{skada=[[@{vapenskada_display}+@{vapensb_display}]]}}" name="roll_vapenatk5_display"></button></td>
                                </tr>
                                <tr>
                                    <td class="sheet-box_alternate_row">Försvar</td>
                                    <td><input class="sheet-fardighetstabell" type="number" value="0" name="attr_vapenfor1_display"></td>
                                    <td><button class="sheet-tarningstabell" type="roll" value="&{template:DoDFardighet} {{name=@{vapennamn_display}}} {{subtags=Försvar}} {{slag=[[1d20]]}} {{fardighet=@{vapenfor1_display}}}" name="roll_vapenfor1_display"></button></td>
                                    <td><input class="sheet-fardighetstabell" type="number" value="0" name="attr_vapenfor2_display"></td>
                                    <td><button class="sheet-tarningstabell" type="roll" value="&{template:DoDFardighet} {{name=@{vapennamn_display}}} {{subtags=Försvar}} {{slag=[[1d20]]}} {{fardighet=@{vapenfor2_display}}}" name="roll_vapenfor2_display"></button></td>
                                    <td><input class="sheet-fardighetstabell" type="number" value="0" name="attr_vapenfor3_display"></td>
                                    <td><button class="sheet-tarningstabell" type="roll" value="&{template:DoDFardighet} {{name=@{vapennamn_display}}} {{subtags=Försvar}} {{slag=[[1d20]]}} {{fardighet=@{vapenfor3_display}}}" name="roll_vapenfor3_display"></button></td>
                                    <td><input class="sheet-fardighetstabell" type="number" value="0" name="attr_vapenfor4_display"></td>
                                    <td><button class="sheet-tarningstabell" type="roll" value="&{template:DoDFardighet} {{name=@{vapennamn_display}}} {{subtags=Försvar}} {{slag=[[1d20]]}} {{fardighet=@{vapenfor4_display}}}" name="roll_vapenfor4_display"></button></td>
                                    <td><input class="sheet-fardighetstabell" type="number" value="0" name="attr_vapenfor5_display"></td>
                                    <td><button class="sheet-tarningstabell" type="roll" value="&{template:DoDFardighet} {{name=@{vapennamn_display}}} {{subtags=Försvar}} {{slag=[[1d20]]}} {{fardighet=@{vapenfor5_display}}}" name="roll_vapenfor5_display"></button></td>
                                </tr>
                            </table>
                            <table>
                                <tr>
                                    <td class="sheet-box_alternate_row">Övrigt</td>
                                    <td><input class="sheet-fardighetstabell" type="text" name="attr_vapenovrigt_display"></td>
                                    <td class="sheet-box_alternate_row"><span>Skadebonus</span></td>
                                    <td><input class="sheet-checkboxbutton" type="checkbox" name="attr_vapensb_display" value="@{SB}" checked="false"></td>
                                </tr>
                            </table>
                            <fieldset class="repeating_attackforsvar">
                                <table>
                                    <tr>
                                        <h4></h4>
                                    </tr>
                                    <tr>
                                        <td><button class="sheet-roll_alternate" type="roll" name="roll_vapenvisa" value="&{template:DoDText} {{name=Attack/Försvar}} {{subtags=@{vapennamn}}} {{titel=Attack: }} {{text=@{vapenatk1}/@{vapenatk2}/@{vapenatk3}/@{vapenatk4}/@{vapenatk5}}} {{titel2=Försvar: }} {{text2=@{vapenfor1}/@{vapenfor2}/@{vapenfor3}/@{vapenfor4}/@{vapenfor5}}}">Vapen</button></td>
                                        <td><button class="sheet-roll_alternate2" type="roll" name="roll_vapenskada" value="&{template:DoDText} {{name=@{vapennamn}}} {{subtags=Skada}} {{text=[[@{vapenskada}+@{vapensb]]}}">Skada</button></td>
                                    </tr>
                                    <tr>
                                        <td><input class="sheet-fardighetstabell" type="text" name="attr_vapennamn"></td>
                                        <td><input class="sheet-fardighetstabell" type="text" name="attr_vapenskada"></td>
                                    </tr>
                                </table>
                                <table>
                                    <tr>
                                        <td class="sheet-box_alternate_row">Attack</td>
                                        <td><input class="sheet-fardighetstabell" type="number" value="0" name="attr_vapenatk1"></td>
                                        <td><button class="sheet-tarningstabell" type="roll" value="&{template:DoDAttack} {{name=@{vapennamn}}} {{subtags=Attack}} {{slag=[[1d20]]}} {{fardighet=@{vapenatk1}}} {{traff=[[1d20]]}} {{skada=[[@{vapenskada}+@{vapensb}]]}}" name="roll_vapenatk1"></button></td>
                                        <td><input class="sheet-fardighetstabell" type="number" value="0" name="attr_vapenatk2"></td>
                                        <td><button class="sheet-tarningstabell" type="roll" value="&{template:DoDAttack} {{name=@{vapennamn}}} {{subtags=Attack}} {{slag=[[1d20]]}} {{fardighet=@{vapenatk2}}} {{traff=[[1d20]]}} {{skada=[[@{vapenskada}+@{vapensb}]]}}" name="roll_vapenatk2"></button></td>
                                        <td><input class="sheet-fardighetstabell" type="number" value="0" name="attr_vapenatk3"></td>
                                        <td><button class="sheet-tarningstabell" type="roll" value="&{template:DoDAttack} {{name=@{vapennamn}}} {{subtags=Attack}} {{slag=[[1d20]]}} {{fardighet=@{vapenatk3}}} {{traff=[[1d20]]}} {{skada=[[@{vapenskada}+@{vapensb}]]}}" name="roll_vapenatk3"></button></td>
                                        <td><input class="sheet-fardighetstabell" type="number" value="0" name="attr_vapenatk4"></td>
                                        <td><button class="sheet-tarningstabell" type="roll" value="&{template:DoDAttack} {{name=@{vapennamn}}} {{subtags=Attack}} {{slag=[[1d20]]}} {{fardighet=@{vapenatk4}}} {{traff=[[1d20]]}} {{skada=[[@{vapenskada}+@{vapensb}]]}}" name="roll_vapenatk4"></button></td>
                                        <td><input class="sheet-fardighetstabell" type="number" value="0" name="attr_vapenatk5"></td>
                                        <td><button class="sheet-tarningstabell" type="roll" value="&{template:DoDAttack} {{name=@{vapennamn}}} {{subtags=Attack}} {{slag=[[1d20]]}} {{fardighet=@{vapenatk5}}} {{traff=[[1d20]]}} {{skada=[[@{vapenskada}+@{vapensb}]]}}" name="roll_vapenatk5"></button></td>
                                    </tr>
                                    <tr>
                                        <td class="sheet-box_alternate_row">Försvar</td>
                                        <td><input class="sheet-fardighetstabell" type="number" value="0" name="attr_vapenfor1"></td>
                                        <td><button class="sheet-tarningstabell" type="roll" value="&{template:DoDFardighet} {{name=@{vapennamn}}} {{subtags=Försvar}} {{slag=[[1d20]]}} {{fardighet=@{vapenfor1}}}" name="roll_vapenfor1"></button></td>
                                        <td><input class="sheet-fardighetstabell" type="number" value="0" name="attr_vapenfor2"></td>
                                        <td><button class="sheet-tarningstabell" type="roll" value="&{template:DoDFardighet} {{name=@{vapennamn}}} {{subtags=Försvar}} {{slag=[[1d20]]}} {{fardighet=@{vapenfor2}}}" name="roll_vapenfor2"></button></td>
                                        <td><input class="sheet-fardighetstabell" type="number" value="0" name="attr_vapenfor3"></td>
                                        <td><button class="sheet-tarningstabell" type="roll" value="&{template:DoDFardighet} {{name=@{vapennamn}}} {{subtags=Försvar}} {{slag=[[1d20]]}} {{fardighet=@{vapenfor3}}}" name="roll_vapenfor3"></button></td>
                                        <td><input class="sheet-fardighetstabell" type="number" value="0" name="attr_vapenfor4"></td>
                                        <td><button class="sheet-tarningstabell" type="roll" value="&{template:DoDFardighet} {{name=@{vapennamn}}} {{subtags=Försvar}} {{slag=[[1d20]]}} {{fardighet=@{vapenfor4}}}" name="roll_vapenfor4"></button></td>
                                        <td><input class="sheet-fardighetstabell" type="number" value="0" name="attr_vapenfor5"></td>
                                        <td><button class="sheet-tarningstabell" type="roll" value="&{template:DoDFardighet} {{name=@{vapennamn}}} {{subtags=Försvar}} {{slag=[[1d20]]}} {{fardighet=@{vapenfor5}}}" name="roll_vapenfor5"></button></td>
                                    </tr>
                                </table>
                                <table>
                                    <tr>
                                        <td class="sheet-box_alternate_row">Övrigt</td>
                                        <td><input class="sheet-fardighetstabell" type="text" name="attr_vapenovrigt"></td>
                                        <td class="sheet-box_alternate_row"><span>Skadebonus</span></td>
                                        <td><input class="sheet-checkboxbutton" type="checkbox" name="attr_vapensb" value="@{SB}" checked="false"></td>
                                    </tr>
                                </table>
                            </fieldset>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div>
        <h1>Utrustning och värdesaker</h1>
        <input type="checkbox" class="sheet-arrow" name="attr_arrow_utrustningvarde"><span></span>
        <div class="sheet-body">
            <div class="sheet-5colrow">
                <div class="sheet-col">
                    <table>
                        <tr>
                            <th class="sheet-box_alternate2">Mynt</th>
                            <th class="sheet-box_alternate2">1</th>
                            <th class="sheet-box_alternate2">5</th>
                            <th class="sheet-box_alternate2">10</th>
                        </tr>
                        <tr>
                            <td class="sheet-box_alternate_row">Koppar</td>
                            <td><input class="sheet-fardighetstabell" type="number" min="0" value="0" name="attr_kopparmynt1"></td>
                            <td><input class="sheet-fardighetstabell" type="number" min="0" value="0" name="attr_kopparmynt5"></td>
                            <td><input class="sheet-fardighetstabell" type="number" min="0" value="0" name="attr_kopparmynt10"></td>
                        </tr>
                        <tr>
                            <td class="sheet-box_alternate_row">Silver</td>
                            <td><input class="sheet-fardighetstabell" type="number" min="0" value="0" name="attr_silvermynt1"></td>
                            <td><input class="sheet-fardighetstabell" type="number" min="0" value="0" name="attr_silvermynt5"></td>
                            <td><input class="sheet-fardighetstabell" type="number" min="0" value="0" name="attr_silvermynt10"></td>
                        </tr>
                        <tr>
                            <td class="sheet-box_alternate_row">Guld</td>
                            <td><input class="sheet-fardighetstabell" type="number" min="0" value="0" name="attr_guldmynt1"></td>
                            <td><input class="sheet-fardighetstabell" type="number" min="0" value="0" name="attr_guldmynt5"></td>
                            <td><input class="sheet-fardighetstabell" type="number" min="0" value="0" name="attr_guldmynt10"></td>
                        </tr>
                        <tr>
                            <td colspan="4"><h4></h4></td>
                        </tr>
                    </table>
                    <table>
                        <thead>
                            <tr>
                                <th class="sheet-box_alternate2" colspan="2">Totalt antal mynt</th>
                            </tr>
                        </thead>
                        <tr>
                            <td><input type="number" name="attr_mynttot" disabled="true" min="0" value="@{kopparmynt1}+@{kopparmynt5}+@{kopparmynt10}+@{silvermynt1}+@{silvermynt5}+@{silvermynt10}+@{guldmynt1}+@{guldmynt5}+@{guldmynt10}"> st</td>
                            <td><input type="number" name="attr_mynttot" disabled="true" min="0" value="floor((@{kopparmynt1}+@{kopparmynt5}+@{kopparmynt10}+@{silvermynt1}+@{silvermynt5}+@{silvermynt10}+@{guldmynt1}+@{guldmynt5}+@{guldmynt10})/200)"> kg</td>
                        </tr>
                    </table>
                </div>
                <div class="sheet-col">
                        <table>
                            <tr>
                                <th class="sheet-box_alternate2">Övriga värdesaker</th>
                            </tr>
                            <tr>
                                <td><textarea name="attr_vardesaker" style="width: 500px"></textarea></td>
                            </tr>
                        </table>
                </div>
            </div>
            <div>
                <h3>Utrustning</h3>
                <input type="checkbox" class="sheet-arrow" name="attr_arrow_utrustning"><span></span>
                <div class="sheet-body">
                    <div class="sheet-colrow">
                        <table>
                            <thead>
                                <tr>
                                    <td class="sheet-box_alternate">Typ</td>
                                    <td class="sheet-box_alternate">Beskrivning</td>
                                    <td class="sheet-box_alternate">Antal</td>
                                    <td class="sheet-box_alternate">Vikt</td>
                                </tr>
                            </thead>
                            <tr>
                                <td><input class="sheet-fardighetstabell" type="text" name="attr_utrustningtyp_display" style="width: 180px"></td>
                                <td><input class="sheet-fardighetstabell" type="text" name="attr_utrustningbesk_display" style="width: 350px"></td>
                                <td><input class="sheet-fardighetstabell" type="number" min="0" value="0" step="any" name="attr_utrustningantal_display"></td>
                                <td><input class="sheet-fardighetstabell" type="number" min="0" value="0" step="any" name="attr_utrustningvikt_display"></td>
                            </tr>
                        </table>
                        <fieldset class="repeating_utrustning">
                                <table>
                                    <tr>
                                        <td><input class="sheet-fardighetstabell" type="text" name="attr_utrustningtyp" style="width: 180px"></td>
                                        <td><input class="sheet-fardighetstabell" type="text" name="attr_utrustningbesk" style="width: 350px"></td>
                                        <td><input class="sheet-fardighetstabell" type="number" min="0" value="0" step="any" name="attr_utrustningantal"></td>
                                        <td><input class="sheet-fardighetstabell" type="number" min="0" value="0" step="any" name="attr_utrustningvikt"></td>
                                    </tr>
                                </table>
                        </fieldset>
                        <table>
                            <tr>
                                <td style="width: 458px"></td>
                                <td class="sheet-box_alternate_row">Total vikt</td>
                                <td><input class="sheet-fardighetstabell" type="text" style="width: 50%; text-align: right" name="attr_utrustningtotalla"></td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
            <div>
                <h3>Börda</h3>
                <input type="checkbox" class="sheet-arrow" name="attr_arrow_borda"><span></span>
                <div class="sheet-body">
                    <div class="sheet-5colrow">
                        <table>
                            <thead>
                                <tr>
                                    <th colspan="3" class="sheet-box_alternate2"><span>Börda (kg)</span></th>
                                    <th class="sheet-box_alternate2"><span>Mod.</span></th>
                                    <th class="sheet-box_alternate2"><span> Övrig information</span></th>
                                </tr>
                                <tr>
                                    <td><input class="sheet-fardighetstabell" type="number" name="attr_bordamin1" value="0" disabled="true"></td>
                                    <td><span>-</span></td>
                                    <td><input class="sheet-fardighetstabell" type="number" name="attr_bordamax1" value="@{sty}" disabled="true"></td>
                                    <td><input class="sheet-fardighetstabell_small" type="text" value="x1" disabled="true"></td>
                                    <td><input class="sheet-fardighetstabell_large" type="text" value="-" disabled="true"></td>
                                </tr>
                                <tr>
                                    <td><input class="sheet-fardighetstabell" type="number" name="attr_bordamin2" value="@{sty}" disabled="true"></td>
                                    <td><span>-</span></td>
                                    <td><input class="sheet-fardighetstabell" type="number" name="attr_bordamax2" value="@{sty}*2" disabled="true"></td>
                                    <td><input class="sheet-fardighetstabell_small" type="text" value="x0.8" disabled="true"></td>
                                    <td><input class="sheet-fardighetstabell_large" type="text" value="Kan ej sprinta, springa eller simma" disabled="true"></td>
                                </tr>
                                <tr>
                                    <td><input class="sheet-fardighetstabell" type="number" name="attr_bordamin3" value="@{sty}*2"  disabled="true"></td>
                                    <td><span>-</span></td>
                                    <td><input class="sheet-fardighetstabell" type="number" name="attr_bordamax3" value="@{sty}*3" disabled="true"></td>
                                    <td><input class="sheet-fardighetstabell_small" type="text" value="x0.6" disabled="true"></td>
                                    <td><input class="sheet-fardighetstabell_large" type="text" value="Kan ej sprinta, springa eller simma" disabled="true"></td>
                                </tr>
                                <tr>
                                    <td><input class="sheet-fardighetstabell" type="number" name="attr_bordamin4" value="@{sty}*3" disabled="true"></td>
                                    <td><span>-</span></td>
                                    <td><input class="sheet-fardighetstabell" type="number" name="attr_bordamax4" value="@{sty}*4" disabled="true"></td>
                                    <td><input class="sheet-fardighetstabell_small" type="text" value="x0.4" disabled="true"></td>
                                    <td><input class="sheet-fardighetstabell_large" type="text" value="Kan ej sprinta, springa eller simma" disabled="true"></td>
                                </tr>
                                <tr>
                                    <td><input class="sheet-fardighetstabell" type="number" name="attr_bordamin5" value="@{sty}*4" disabled="true"></td>
                                    <td><span>-</span></td>
                                    <td><input class="sheet-fardighetstabell" type="number" name="attr_bordamax5" value="@{sty}*5" disabled="true"></td>
                                    <td><input class="sheet-fardighetstabell_small" type="text" value="x0.2" disabled="true"></td>
                                    <td><input class="sheet-fardighetstabell_large" type="text" value="Kan ej sprinta, springa, simma eller använda SMI-färdigheter" disabled="true"></td>
                                </tr>
                                <tr>
                                    <td><input class="sheet-fardighetstabell" type="number" name="attr_bordamin6" value="@{sty}*5" disabled="true"></td>
                                    <td><span>-</span></td>
                                    <td><input class="sheet-fardighetstabell" type="number" name="attr_bordamax6" value="@{sty}*6" disabled="true"></td>
                                    <td><input class="sheet-fardighetstabell_small" type="text" value="x0.1" disabled="true"></td>
                                    <td><input class="sheet-fardighetstabell_large" type="text" value="Kan ej sprinta, springa, simma eller använda SMI-färdigheter" disabled="true"></td>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="sheet-row">
        <div class="sheet-col sheet-dod-min">Version 2.0</div>
    </div>
</div>

<script type="text/worker">
    /* ===== PARAMETERS ==========
    destination = the name of the attribute that stores the total quantity
    section = name of repeating fieldset, without the repeating_
    fields = the name of the attribute field to be summed
          can be a single attribute: 'weight'
          or an array of attributes: ['weight','number','equipped']
    multiplier (optional) = a multiplier to to entire fieldset total. For instance, if summing coins of weight 0.02, might want to multiply the final total by 0.02.
    */
    const beraknaVikt = (destination, section, fields, multiplier = 1) => {
        if (!Array.isArray(fields)) fields = [fields];
        getSectionIDs(`repeating_${section}`, idArray => {
            const attrArray = idArray.reduce( (m,id) => [...m, ...(fields.map(field => `repeating_${section}_${id}_${field}`))],[]);
            getAttrs(attrArray, v => {
                console.log("===== values of v: "+ JSON.stringify(v) +" =====");
                     // getValue: if not a number, returns 1 if it is 'on' (checkbox), otherwise returns 0..
                const getValue = (section, id,field) => parseFloat(v[`repeating_${section}_${id}_${field}`], 10) || (v[`repeating_${section}_${id}_${field}`] === 'on' ? 1 : 0); 
                const sumTotal = idArray.reduce((total, id) => total + fields.reduce((subtotal,field) => subtotal * getValue(section, id,field),1),0);

                getAttrs(["UTRUSTNINGANTAL_DISPLAY","UTRUSTNINGVIKT_DISPLAY", "VIKTHUVUD", "VIKTHOGERARM", "VIKTVANSTERARM", "VIKTBROST", "VIKTMAGE", "VIKTHOGERBEN", "VIKTVANSTERBEN", "KOPPARMYNT1", "KOPPARMYNT5", "KOPPARMYNT10", "SILVERMYNT1", "SILVERMYNT5", "SILVERMYNT10", "GULDMYNT1", "GULDMYNT5", "GULDMYNT10"], function(values) {
                    let antal = parseFloat(values.UTRUSTNINGANTAL_DISPLAY,10)||0;
                    let vikt = parseFloat(values.UTRUSTNINGVIKT_DISPLAY,10)||0;

                    let huvud = parseFloat(values.VIKTHUVUD,10)||0;
                    let hogerarm = parseFloat(values.VIKTHOGERARM,10)||0;
                    let vansterarm = parseFloat(values.VIKTVANSTERARM,10)||0;
                    let brost = parseFloat(values.VIKTBROST,10)||0;
                    let mage = parseFloat(values.VIKTMAGE,10)||0;
                    let hogerben = parseFloat(values.VIKTHOGERBEN,10)||0;
                    let vansterben = parseFloat(values.VIKTVANSTERBEN,10)||0;

                    let koppar1 = parseFloat(values.KOPPARMYNT1,10)||0;
                    let koppar5 = parseFloat(values.KOPPARMYNT5,10)||0;
                    let koppar10 = parseFloat(values.KOPPARMYNT10,10)||0;
                    let silver1 =  parseFloat(values.SILVERMYNT1,10)||0;
                    let silver5 = parseFloat(values.SILVERMYNT5,10)||0;
                    let silver10 = parseFloat(values.SILVERMYNT10,10)||0;
                    let guld1 = parseFloat(values.GULDMYNT1,10)||0;
                    let guld5 = parseFloat(values.GULDMYNT5,10)||0;
                    let guld10 = parseFloat(values.GULDMYNT10,10)||0;

                    let totviktmynt = (koppar1 + koppar5 + koppar10 + silver1 + silver5 + silver10 + guld1 + guld5 + guld10)/200;

                    let totvikt = sumTotal * multiplier + antal * vikt + huvud + vansterarm + hogerarm + brost + mage + vansterben + hogerben + totviktmynt;

                    let avrundad = totvikt.toFixed(2);

                    setAttrs({[destination]: avrundad});
                });
            });
        });
    };
    
    on('change:repeating_utrustning remove:repeating_utrustning change:totviktrustning change:utrustningantal_display change:utrustningvikt_display change:mynttot', function() {
        beraknaVikt("utrustningtotalla","utrustning",["utrustningvikt","utrustningantal"]);
    });
</script>

<rolltemplate class="sheet-rolltemplate-DoDFardighet">
    <div class="container">
        <div><h1>{{name}}</h1></div>
        <div><span class="subheader">{{subtags}}</span></div>
        <div class="arrow-container"><div class="line"></div></div>
        <div class="rowcolor"><span class="tcat"></span>{{slag}} vs {{fardighet}}</div>
        {{#text}}
        <div class="arrow-container"><div class="line"></div></div>
        <div class="rowcolor"><span class="tcat"></span>{{text}}</div>
        {{/text}}
        {{#text2}}
        <div class="arrow-container"><div class="line"></div></div>
        <div class="rowcolor"><span class="tcat"></span>{{text2}}</div>
        {{/text2}}
    </div>
</rolltemplate>
<rolltemplate class="sheet-rolltemplate-DoDText">
    <div class="container">
        <div><h1>{{name}}</h1></div>
        <div><span class="subheader">{{subtags}}</span></div>
        <div class="arrow-container"><div class="line"></div></div>
        <div class="rowcolor"><span class="tcat">{{#titel}}{{titel}}{{/titel}}</span>{{text}}</div>
        {{#text2}}
        <div class="arrow-container"><div class="line"></div></div>
        <div class="rowcolor"><span class="tcat">{{#titel2}}{{titel2}}{{/titel2}}</span>{{text2}}</div>
        {{/text2}}
    </div>
</rolltemplate>
<rolltemplate class="sheet-rolltemplate-DoDAttack">
    <div class="container">
        <div><h1>{{name}}</h1></div>
        <div><span class="subheader">{{subtags}}</span></div>
        <div class="arrow-container"><div class="line"></div></div>
        <div class="rowcolor"><span class="tcat"></span>{{slag}} vs {{fardighet}}</div>
        {{#traff}}
        <div class="rowcolor"><span class="tcat">Träff: </span>{{traff}}</div>
        {{/traff}}
        {{#skada}}
        <div class="rowcolor"><span class="tcat">Skada: </span>{{skada}}</div>
        {{/skada}}
    </div>
</rolltemplate>