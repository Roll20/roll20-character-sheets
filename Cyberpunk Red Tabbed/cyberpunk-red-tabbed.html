<!--
  Greetings source-viewers. If you're interested in making a change to
  this character sheet please DO NOT DO IT as a pull request against
  the main Roll20 Character sheet repository. This sheet is built using
  a webpack toolkit and the actual (pre-compilation) source code lives
  in the respository available here...

    https://github.com/mraichelson/cyberpunk-red-tabbed

  ...any pull requests should be made against that repository and then
  can be passed on to Roll20.
-->
<div class="cyberpunk-red">
  <div class="tabbed">
    <!-- tab controls -->
    <input type="radio" name="selecttab" value="1" class="tab tab1" checked />
    <span class="tab accent-font">Character</span>
    <input type="radio" name="selecttab" value="2" class="tab tab2" />
    <span class="tab accent-font">Skills</span>
    <input type="radio" name="selecttab" value="3" class="tab tab3" />
    <span class="tab accent-font">Combat</span>
    <input type="radio" name="selecttab" value="4" class="tab tab4" />
    <span class="tab accent-font">Gear</span>
    <input type="radio" name="selecttab" value="5" class="tab tab5" />
    <span class="tab accent-font">Cyberware</span>
    <input type="radio" name="selecttab" value="6" class="tab tab6" />
    <span class="tab accent-font">Lifepath</span>

    <div class="tab-content tab1">
      <div>
        <div class="character-info">
          <div class="columns">
            <div class="column">
              <h4 class="clipped-corner">Handle</h4>
              <input type="text" name="attr_character_name" />
            </div>
            <div class="column">
              <h4 class="clipped-corner">Role</h4>
              <select name="attr_role">
                <option value="--Choose One--">--Choose One--</option>
                <option value="Exec">Exec</option>
                <option value="Fixer">Fixer</option>
                <option value="Lawman">Lawman</option>
                <option value="Media">Media</option>
                <option value="Medtech">Medtech</option>
                <option value="Netrunner">Netrunner</option>
                <option value="Nomad">Nomad</option>
                <option value="Rockerboy">Rockerboy</option>
                <option value="Solo">Solo</option>
                <option value="Tech">Tech</option>
              </select>
            </div>
          </div>
        </div>
      </div>
      <div>
        <div class="section-attributes">
          <div class="columns">
            <div class="column clipped-corner">
              <strong class="accent-font">
                <button
                  class="button-plain"
                  type="roll"
                  value="&{template:minimal}{{charactername=@{character_name}}}{{label=INT}}{{roll=[[1d10 + @{stat_int} + @{finalmodifier}]]}}"
                >
                  INT
                </button>
              </strong>
              <input type="number" name="attr_stat_int" />
            </div>

            <div class="column clipped-corner">
              <strong class="accent-font">
                <button
                  class="button-plain"
                  type="roll"
                  value="&{template:minimal}{{charactername=@{character_name}}}{{label=REF}}{{roll=[[1d10 + @{stat_ref} + @{finalmodifier}]]}}"
                >
                  REF
                </button>
              </strong>
              <input type="number" name="attr_stat_ref" />
            </div>

            <div class="column clipped-corner">
              <strong class="accent-font">
                <button
                  class="button-plain"
                  type="roll"
                  value="&{template:minimal}{{charactername=@{character_name}}}{{label=DEX}}{{roll=[[1d10 + @{stat_dex} + @{finalmodifier}]]}}"
                >
                  DEX
                </button>
              </strong>
              <input type="number" name="attr_stat_dex" />
            </div>

            <div class="column clipped-corner">
              <strong class="accent-font">
                <button
                  class="button-plain"
                  type="roll"
                  value="&{template:minimal}{{charactername=@{character_name}}}{{label=TECH}}{{roll=[[1d10 + @{stat_tech} + @{finalmodifier}]]}}"
                >
                  TECH
                </button>
              </strong>
              <input type="number" name="attr_stat_tech" />
            </div>

            <div class="column clipped-corner">
              <strong class="accent-font">
                <button
                  class="button-plain"
                  type="roll"
                  value="&{template:minimal}{{charactername=@{character_name}}}{{label=COOL}}{{roll=[[1d10 + @{stat_cool} + @{finalmodifier}]]}}"
                >
                  COOL
                </button>
              </strong>
              <input type="number" name="attr_stat_cool" />
            </div>

            <div class="column clipped-corner">
              <strong class="accent-font">
                <button
                  class="button-plain"
                  type="roll"
                  value="&{template:minimal}{{charactername=@{character_name}}}{{label=WILL}}{{roll=[[1d10 + @{stat_will} + @{finalmodifier}]]}}"
                >
                  WILL
                </button>
              </strong>
              <input type="number" name="attr_stat_will" />
            </div>

            <div class="column clipped-corner">
              <strong class="accent-font">
                <button
                  class="button-plain"
                  type="roll"
                  value="&{template:minimal}{{charactername=@{character_name}}}{{label=LUCK}}{{roll=[[1d10 + @{stat_luck} + @{finalmodifier}]]}}"
                >
                  LUCK
                </button>
              </strong>
              <input type="number" name="attr_stat_luck" />
            </div>

            <div class="column clipped-corner">
              <strong class="accent-font">
                <button
                  class="button-plain"
                  type="roll"
                  value="&{template:minimal}{{charactername=@{character_name}}}{{label=MOVE}}{{roll=[[1d10 + @{stat_move} + @{finalmodifier}]]}}"
                >
                  MOVE
                </button>
              </strong>
              <input type="number" name="attr_stat_move" />
            </div>

            <div class="column clipped-corner">
              <strong class="accent-font">
                <button
                  class="button-plain"
                  type="roll"
                  value="&{template:minimal}{{charactername=@{character_name}}}{{label=BODY}}{{roll=[[1d10 + @{stat_body} + @{finalmodifier}]]}}"
                >
                  BODY
                </button>
              </strong>
              <input type="number" name="attr_stat_body" />
            </div>

            <div class="column clipped-corner">
              <strong class="accent-font">
                <button
                  class="button-plain"
                  type="roll"
                  value="&{template:minimal}{{charactername=@{character_name}}}{{label=EMP}}{{roll=[[1d10 + @{empathy} + @{finalmodifier}]]}}{{message=Roll made using Effective Empathy score.}}"
                >
                  EMP
                </button>
              </strong>
              <input type="number" name="attr_stat_emp" />
            </div>
          </div>
        </div>
      </div>
      <div class="columns">
        <div class="column">
          <div class="section-empathy">
            <h4 class="clipped-corner">Effective Empathy</h4>
            <div class="field-wrapper center">
              <strong><span name="attr_empathy"></span></strong> of
              <span name="attr_stat_emp"></span>
            </div>
          </div>
          <script type="text/worker">
            function updateEmpathy() {
              getAttrs(['stat_emp'], function(values) {
                var empathy = Number(values.stat_emp);
                setAttrs({
                  empathy: empathy,
                  empathy_max: empathy
                })
              });
            }
            on('change:stat_emp', function() {
              updateEmpathy();
            });
          </script>
        </div>
        <div class="column">
          <div class="section-humanity">
            <h4 class="clipped-corner">Humanity</h4>
            <div class="field-wrapper center">
              <input type="number" name="attr_humanity" /> of
              <input type="number" name="attr_humanity_max" />
              <span style="font-size: 1rem">MAX</span>
            </div>
          </div>
          <script type="text/worker">
            function updateHumanity() {
              getAttrs(['stat_emp'], function(values) {
                var empathy = Number(values.stat_emp);
                setAttrs({
                  humanity: empathy * 10,
                  humanity_max: empathy * 10
                })
              });
            }
            on('change:stat_emp', function() {
              updateHumanity();
            });
            function updateEmpathyFromHumanity() {
              getAttrs(['humanity'], function(values){
                var humanity = Number(values.humanity);
                setAttrs({
                  empathy: Math.floor(humanity / 10)
                });
              });
            }
            on('change:humanity', function() {
              updateEmpathyFromHumanity();
            });
          </script>
        </div>
        <div class="column">
          <div class="section-luck">
            <h4 class="clipped-corner">
              Luck
              <button type="action" name="act_resetluck">Reset</button>
            </h4>
            <div class="field-wrapper center">
              <input type="number" name="attr_luck" />
              of <span name="attr_luck_max"></span>
            </div>
          </div>
          <script type="text/worker">
            function updateLuck() {
              getAttrs(['stat_luck'], function(values) {
                var luck = Number(values.stat_luck);
                setAttrs({
                  luck: luck,
                  luck_max: luck
                })
              });
            }
            on('change:stat_luck', function() {
              updateLuck();
            });
            /**
             * Reset luck pool button
             */
            on('clicked:resetluck', function () {
              updateLuck();
            });
          </script>
        </div>
        <div class="column">
          <div class="section-hit-points">
            <input type="hidden" name="attr_deathsavehack" />
            <h4 class="clipped-corner">
              <!-- hidden fields for controlling the display of conditional elements. -->
              <input
                class="seriously-wounded"
                type="hidden"
                name="attr_damageserious"
              />
              <input
                class="death-save"
                type="hidden"
                name="attr_damagemortal"
              />
              <span class="seriously-wounded">!</span>
              Hit Points
              <button class="reset-hp" type="action" name="act_resethp">
                Reset
              </button>
              <button
                class="death-save button-plain"
                type="roll"
                value="&{template:deathsave}{{charactername=@{character_name}}}{{target=@{deathsave}}}{{roll=[[1d10cs<@{deathsavehack}cf10]]}}"
              >
                Death Save (<span name="attr_deathsave"></span>)
              </button>
            </h4>
            <div class="field-wrapper center">
              <input type="number" name="attr_hp" />
              of <span name="attr_hp_max"></span>
            </div>
          </div>
          <script type="text/worker">
            function updateHitPoints() {
              getAttrs(['stat_body', 'stat_will'], function (values) {
                var body = Number(values.stat_body);
                var will = Number(values.stat_will);
                var maxHp = ((Math.ceil((body + will) / 2)) * 5) + 10;
                var halfHp = Math.ceil(maxHp / 2);
                var deathSave = body;
                setAttrs({
                  hp: maxHp,
                  hp_max: maxHp,
                  seriouslywounded: halfHp,
                  deathsave: deathSave,
                  deathsavehack: deathSave -  1
                });
              });
            }
            on('change:stat_body change:stat_will', function() {
              updateHitPoints();
            });
            /**
             * Automatically apply "seriously wounded" and "mortally wounded"
             * modifiers based on HP value.
             */
            function updateHpModifiers() {
              getAttrs(['hp', 'seriouslywounded'], function (values) {
                var hp = Number(values.hp);
                var threshold = Number(values.seriouslywounded);
                var damageserious = 0;
                var damagemortal = 0;
                if (hp < threshold) {
                  damageserious = 'on'
                }
                if (hp < 1) {
                  damagemortal = 'on'
                }
                setAttrs({
                  damageserious: damageserious,
                  damagemortal: damagemortal
                });
              });
            }
            on('change:hp', function() {
              updateHpModifiers();
            });
            /**
             * Unified button to reset HP
             */
            on('clicked:resethp', function() {
              updateHitPoints();
            });
          </script>
        </div>
      </div>
      <div>
        <div class="section-role">
          <input type="hidden" name="attr_role" />
          <div class="role-pane role-exec">
            <h4 class="clipped-corner">Exec</h4>
            <div class="role-ability">
              Exec role ability: Teamwork
              <input type="number" name="attr_role_exec" value="0" min="0" />
              <div class="rulebook-reference">See full rules on p.153-157</div>
            </div>
            <div class="subdivider">
              <h5>TEAM MEMBERS</h5>
              <fieldset class="repeating_teammembers">
                <div class="columns">
                  <div class="column column-2">
                    <input
                      type="text"
                      name="attr_execteamname"
                      style="width: 100%"
                    />
                  </div>
                  <div class="column column-2">
                    <select name="attr_execteamrole" style="width: 100%">
                      <option value="Bodyguard">Bodyguard</option>
                      <option value="Covert Operative">Covert Operative</option>
                      <option value="Driver">Driver</option>
                      <option value="Netrunner">Netrunner</option>
                      <option value="Technician">Technician</option>
                    </select>
                  </div>
                  <div class="column">
                    Loyalty <input type="number" name="attr_execteamloyalty" />
                  </div>
                </div>
              </fieldset>
            </div>
          </div>
          <div class="role-pane role-fixer">
            <h4 class="clipped-corner">Fixer</h4>
            <div class="role-ability">
              Fixer role ability: Operator
              <input type="number" name="attr_role_fixer" value="0" min="0" />
              <div class="rulebook-reference">See full rules on p.159-161</div>
            </div>
            <div class="subdivider">
              <div class="columns">
                <div class="column column-4">
                  <div class="fixer-grease">
                    <h5>GREASE</h5>
                    <fieldset class="repeating_fixergrease">
                      <textarea
                        name="attr_fixergrease"
                        placeholder="Group or culture"
                      ></textarea>
                    </fieldset>
                  </div>
                </div>
                <div class="column column-4">
                  <div class="fixer-contacts">
                    <h5>CONTACTS</h5>
                    <fieldset class="repeating_fixercontacts">
                      <textarea
                        name="attr_fixercontact"
                        placeholder="Contact name and description"
                      ></textarea>
                    </fieldset>
                  </div>
                </div>
                <div class="column column-2 center">
                  <button
                    type="roll"
                    class="role-button"
                    value="&{template:roleability}{{charactername=@{character_name}}} {{rolename=Fixer}} {{abilityname=Haggle}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{role_fixer} + @{stat_cool} + @{skill_trading} + @{finalmodifier}]]}} {{critroll=[[1d10]]}}"
                  >
                    Haggle
                  </button>
                </div>
              </div>
            </div>
          </div>
          <div class="role-pane role-lawman">
            <h4 class="clipped-corner">Lawman</h4>
            <div class="role-ability">
              Lawman role ability: Backup
              <input type="number" name="attr_role_lawman" value="0" min="0" />
              <div class="rulebook-reference">See full rules on p.158-159</div>
            </div>
            <div class="subdivider">
              <div class="columns">
                <div class="column center">
                  <div style="margin-bottom: 1rem">
                    <button
                      class="role-button"
                      type="roll"
                      value="&{template:minimal}{{charactername=@{character_name}}}{{label=Backup}}{{message=Roll must be less than or equal to Backup score (@{role_lawman}).}}{{roll=[[1d10cs<@{role_lawman}cf15]]}}"
                    >
                      Call backup
                    </button>
                  </div>
                  <div>
                    <button
                      class="role-button"
                      type="roll"
                      value="&{template:minimal}{{charactername=@{character_name}}}{{label=Backup arrival time}}{{message=Check p.158 for special outcome on a roll of 6.}}{{roll=[[1d6cs6cf0]]}}"
                    >
                      Arrival time
                    </button>
                  </div>
                </div>
                <div class="column column-4">
                  <h5>BACKUP</h5>
                  <fieldset class="repeating_backup">
                    <div class="lawman-backup">
                      <div class="columns">
                        <div class="column column-2">
                          <button
                            class="role-button"
                            type="roll"
                            value="&{template:attack}{{charactername=@{character_name}}}{{weapon=Backup}}{{roll=[[1d10+@{role_lawmanbackupcn}]]}}{{critroll=[[1d10]]}}"
                          >
                            Combat Number
                          </button>
                          <input
                            type="number"
                            name="attr_role_lawmanbackupcn"
                          />
                        </div>
                        <div class="column column-2">
                          Armor SP
                          <input
                            type="number"
                            name="attr_role_lawmanbackupsp"
                          />
                        </div>
                        <div class="column column-2">
                          HP
                          <input
                            type="number"
                            name="attr_role_lawmanbackuphp"
                          />
                          of
                          <input
                            type="number"
                            name="attr_role_lawmanbackuphp_max"
                          />
                        </div>
                      </div>
                      <div class="columns">
                        <div class="column column-2">
                          Move/Body
                          <input
                            type="number"
                            name="attr_role_lawmanbackupbody"
                          />
                        </div>
                        <div class="column column-4">
                          <input
                            type="text"
                            name="attr_role_lawmanbackupdesc"
                            style="width: 100%"
                            placeholder="Description"
                          />
                        </div>
                      </div>
                    </div>
                  </fieldset>
                </div>
              </div>
            </div>
          </div>
          <div class="role-pane role-media">
            <h4 class="clipped-corner">Media</h4>
            <div class="role-ability">
              Media role ability: Credibility
              <input type="number" name="attr_role_media" value="0" min="0" />
              <div style="padding-top: 1rem">
                <button
                  type="roll"
                  class="role-button"
                  value="&{template:roleability}{{charactername=@{character_name}}} {{rolename=Media}} {{abilityname=Rumors (Passive)}} {{roll=[[1d10 + @{role_media}]]}} {{critroll=[[1d10]]}}"
                >
                  Rumors (Passive)
                </button>
              </div>
              <div class="rulebook-reference">See full rules on p.151-153</div>
            </div>
          </div>
          <div class="role-pane role-medtech">
            <h4 class="clipped-corner">Medtech</h4>
            <div class="role-ability">
              Medtech role ability: Medicine
              <input type="number" name="attr_role_medtech" value="0" min="0" />
              <div class="rulebook-reference">
                (Track Surgery as the full skill rating, not as the number of
                upgrades applied)<br />
                See full rules on p.149-150
              </div>
            </div>
            <div class="subdivider">
              <div class="columns">
                <div class="column center">
                  <button
                    type="roll"
                    class="role-button"
                    value="&{template:skill}{{charactername=@{character_name}}} {{skillname=Medicine: Surgery}} {{skillvalue=@{role_medtech_surgery}}} {{statname=tech}} {{statvalue=@{stat_tech}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{role_medtech_surgery} + @{stat_tech} + @{finalmodifier}]]}} {{critroll=[[1d10]]}}"
                  >
                    Surgery
                  </button>
                  <input
                    type="number"
                    name="attr_role_medtech_surgery"
                    value="0"
                    min="0"
                  />
                </div>
                <div class="column center">
                  <button
                    type="roll"
                    class="role-button"
                    value="&{template:skill}{{charactername=@{character_name}}} {{skillname=Medicine: Pharmaceuticals}} {{skillvalue=@{role_medtech_pharmaceuticals}}} {{statname=tech}} {{statvalue=@{stat_tech}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{role_medtech_pharmaceuticals} + @{stat_tech} + @{finalmodifier}]]}} {{critroll=[[1d10]]}}"
                  >
                    Pharmaceuticals
                  </button>
                  <input
                    type="number"
                    name="attr_role_medtech_pharmaceuticals"
                    value="0"
                    min="0"
                  />
                </div>
                <div class="column center">
                  <button
                    type="roll"
                    class="role-button"
                    value="&{template:skill}{{charactername=@{character_name}}} {{skillname=Medicine: Cryosystems}} {{skillvalue=@{role_medtech_cryosystem}}} {{statname=tech}} {{statvalue=@{stat_tech}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{role_medtech_cryosystem} + @{stat_tech} + @{finalmodifier}]]}} {{critroll=[[1d10]]}}"
                  >
                    Cryosystem Operation
                  </button>
                  <input
                    type="number"
                    name="attr_role_medtech_cryosystem"
                    value="0"
                    min="0"
                  />
                </div>
              </div>
            </div>
          </div>
          <div class="role-pane role-netrunner">
            <h4 class="clipped-corner">Netrunner</h4>
            <div class="role-ability">
              Netrunner role ability:
              <button
                class="role-button"
                type="roll"
                value="&{template:roleability}{{charactername=@{character_name}}} {{rolename=Netrunner}} {{abilityname=Interface}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{role_netrunner} + @{finalmodifier}]]}} {{critroll=[[1d10]]}}"
              >
                Interface
              </button>
              <input
                type="number"
                name="attr_role_netrunner"
                value="0"
                min="0"
              />
              <div class="rulebook-reference">See full rules on p.147</div>
            </div>
          </div>
          <div class="role-pane role-nomad">
            <h4 class="clipped-corner">Nomad</h4>
            <div class="role-ability">
              Nomad role ability: Moto
              <input type="number" name="attr_role_nomad" value="0" min="0" />
              <div>
                This value is automatically added to all rolls for Drive Land
                Vehicle, Pilot Air Vehicle, Pilot Sea Vehicle, Air Vehicle Tech,
                Land Vehicle Tech, and Sea Vehicle Tech.
              </div>
              <div class="rulebook-reference">See full rules on p.161-165</div>
            </div>
          </div>
          <div class="role-pane role-rockerboy">
            <h4 class="clipped-corner">Rockerboy</h4>
            <div class="role-ability">
              Rockerboy role ability:
              <button
                class="role-button"
                type="roll"
                value="&{template:roleability} {{charactername=@{character_name}}} {{rolename=Rockerboy}} {{abilityname=Charismatic Impact}} {{roll=[[1d10 + @{role_rocker} + @{finalmodifier}]]}} {{critroll=[[1d10]]}}"
              >
                Charismatic Impact
              </button>
              <input type="number" name="attr_role_rocker" value="0" min="0" />
              <div class="rulebook-reference">See full rules on p.144-145</div>
            </div>
          </div>
          <div class="role-pane role-solo">
            <h4 class="clipped-corner">Solo</h4>
            <div class="role-ability">
              Solo role ability: Combat Awareness
              <input
                type="number"
                name="attr_role_solo"
                value="0"
                min="0"
              /><br />
              <input
                type="number"
                name="attr_role_solo_available"
                style="display: none"
              />
              Available to spend: <span name="attr_role_solo_available"></span>
              <div class="rulebook-reference">See full rules on p.146</div>
            </div>
            <div class="subdivider">
              <div class="columns">
                <div class="column center">
                  <input
                    type="hidden"
                    name="attr_role_solo_damagedeflection_calc"
                  />
                  Damage Deflection (+<span
                    name="attr_role_solo_damagedeflection_calc"
                  ></span
                  >)<br />
                  <input
                    type="number"
                    name="attr_role_solo_damagedeflection"
                    value="0"
                    min="0"
                  />
                  (x2)
                  <div class="rulebook-reference" style="margin-bottom: 1rem">
                    Reduces the first Damage you suffer in a round by
                    <span name="attr_role_solo_damagedeflection_calc"></span>.
                    (This must be tracked manually.)
                  </div>
                </div>
                <div class="column center">
                  <input
                    type="hidden"
                    name="attr_role_solo_fumblerecovery_calc"
                  />
                  Fumble Recovery (+<span
                    name="attr_role_solo_fumblerecovery_calc"
                  ></span
                  >)<br />
                  <input
                    type="number"
                    name="attr_role_solo_fumblerecovery"
                    value="0"
                    min="0"
                  />
                  (x4)
                  <div class="rulebook-reference" style="margin-bottom: 1rem">
                    Ignore critical failures on attacks and treat them as a
                    normal roll of 1.
                  </div>
                </div>
                <div class="column center">
                  Initiative Reaction (+<span
                    name="attr_role_solo_initiativereaction"
                  ></span
                  >)<br />
                  <input
                    type="number"
                    name="attr_role_solo_initiativereaction"
                    value="0"
                    min="0"
                  />
                  <div class="rulebook-reference" style="margin-bottom: 1rem">
                    Adds
                    <span name="attr_role_solo_initiativereaction"></span> when
                    using the Initiative button.
                  </div>
                </div>
              </div>
              <div class="columns">
                <div class="column center">
                  <input
                    type="hidden"
                    name="attr_role_solo_precisionattack_calc"
                    value="0"
                  />
                  Precision Attack (+<span
                    name="attr_role_solo_precisionattack_calc"
                  ></span
                  >)<br />
                  <input
                    type="number"
                    name="attr_role_solo_precisionattack"
                    value="0"
                    min="0"
                  />
                  (x3)
                  <div class="rulebook-reference" style="margin-bottom: 1rem">
                    Adds
                    <span name="attr_role_solo_precisionattack_calc"></span> to
                    attacks.
                  </div>
                </div>
                <div class="column center">
                  Spot Weakness (+<span
                    name="attr_role_solo_spotweakness"
                  ></span
                  >)<br />
                  <input
                    type="number"
                    name="attr_role_solo_spotweakness"
                    value="0"
                    min="0"
                  />
                  <div class="rulebook-reference" style="margin-bottom: 1rem">
                    Adds <span name="attr_role_solo_spotweakness"></span> damage
                    to first successful attack each round. (This must be done
                    manually.)
                  </div>
                </div>
                <div class="column center">
                  Threat Detection (+<span
                    name="attr_role_solo_threatdetection"
                  ></span
                  >)<br />
                  <input
                    type="number"
                    name="attr_role_solo_threatdetection"
                    value="0"
                    min="0"
                  />
                  <div class="rulebook-reference" style="margin-bottom: 1rem">
                    Adds <span name="attr_role_solo_threatdetection"></span> to
                    Perception checks.
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="role-pane role-tech">
            <h4 class="clipped-corner">Tech</h4>
            <div class="role-ability">
              Tech role ability: Maker
              <input type="number" name="attr_role_tech" value="0" min="0" />
              <div class="rulebook-reference">See full rules on p.147-149</div>
            </div>
            <div class="subdivider">
              <div class="columns">
                <div class="column">
                  <div class="columns">
                    <div class="column column-3">
                      <button
                        class="role-button"
                        type="roll"
                        value="&{template:skill} {{charactername=@{character_name}}} {{skillname=Maker: Field Expertise}} {{skillvalue=@{role_tech_field}}} {{statname=tech}} {{statvalue=@{stat_tech}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{role_tech_field} + @{role_tech_field_skill} + @{stat_tech} + @{finalmodifier}]]}} {{critroll=[[1d10]]}}"
                      >
                        Field Expertise
                      </button>
                    </div>
                    <div class="column">
                      <input
                        type="number"
                        name="attr_role_tech_field"
                        value="0"
                        min="0"
                      />
                    </div>
                  </div>
                  <div>
                    <select name="attr_role_tech_field_skill">
                      <option value="@{skill_airvehicletech}">
                        Air Vehicle Tech
                      </option>
                      <option value="@{skill_basictech}">Basic Tech</option>
                      <option value="@{skill_cybertech}">Cybertech</option>
                      <option value="@{skill_electronicssecurity}">
                        Electronics/Security Tech
                      </option>
                      <option value="@{skill_landvehicletech}">
                        Land Vehicle Tech
                      </option>
                      <option value="@{skill_seavehicletech}">
                        Sea Vehicle Tech
                      </option>
                      <option value="@{skill_weaponstech}">Weaponstech</option>
                    </select>
                  </div>
                </div>
                <div class="column">
                  <div class="columns">
                    <div class="column column-3">
                      <button
                        class="role-button"
                        type="roll"
                        value="&{template:skill} {{charactername=@{character_name}}} {{skillname=Maker: Upgrade Expertise}} {{skillvalue=@{role_tech_upgrade}}} {{statname=tech}} {{statvalue=@{stat_tech}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{role_tech_upgrade} + @{role_tech_upgrade_skill} + @{stat_tech} + @{finalmodifier}]]}} {{critroll=[[1d10]]}}"
                      >
                        Upgrade Expertise
                      </button>
                    </div>
                    <div class="column">
                      <input
                        type="number"
                        name="attr_role_tech_upgrade"
                        value="0"
                        min="0"
                      />
                    </div>
                  </div>
                  <div>
                    <select name="attr_role_tech_upgrade_skill">
                      <option value="@{skill_airvehicletech}">
                        Air Vehicle Tech
                      </option>
                      <option value="@{skill_basictech}">Basic Tech</option>
                      <option value="@{skill_cybertech}">Cybertech</option>
                      <option value="@{skill_electronicssecurity}">
                        Electronics/Security Tech
                      </option>
                      <option value="@{skill_landvehicletech}">
                        Land Vehicle Tech
                      </option>
                      <option value="@{skill_seavehicletech}">
                        Sea Vehicle Tech
                      </option>
                      <option value="@{skill_weaponstech}">Weaponstech</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class="columns">
                <div class="column">
                  <div class="columns">
                    <div class="column column-3">
                      <button
                        class="role-button"
                        type="roll"
                        value="&{template:skill} {{charactername=@{character_name}}} {{skillname=Maker: Fabrication Expertise}} {{skillvalue=@{role_tech_fabrication}}} {{statname=tech}} {{statvalue=@{stat_tech}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{role_tech_fabrication} + @{role_tech_fabrication_skill} + @{stat_tech} + @{finalmodifier}]]}} {{critroll=[[1d10]]}}"
                      >
                        Fabrication Expertise
                      </button>
                    </div>
                    <div class="column">
                      <input
                        type="number"
                        name="attr_role_tech_fabrication"
                        value="0"
                        min="0"
                      />
                    </div>
                  </div>
                  <div>
                    <select name="attr_role_tech_fabrication_skill">
                      <option value="@{skill_airvehicletech}">
                        Air Vehicle Tech
                      </option>
                      <option value="@{skill_basictech}">Basic Tech</option>
                      <option value="@{skill_cybertech}">Cybertech</option>
                      <option value="@{skill_electronicssecurity}">
                        Electronics/Security Tech
                      </option>
                      <option value="@{skill_landvehicletech}">
                        Land Vehicle Tech
                      </option>
                      <option value="@{skill_seavehicletech}">
                        Sea Vehicle Tech
                      </option>
                      <option value="@{skill_weaponstech}">Weaponstech</option>
                    </select>
                  </div>
                </div>
                <div class="column">
                  <div class="columns">
                    <div class="column column-3">
                      <button
                        class="role-button"
                        type="roll"
                        value="&{template:skill} {{charactername=@{character_name}}} {{skillname=Maker: Invention Expertise}} {{skillvalue=@{role_tech_invention}}} {{statname=tech}} {{statvalue=@{stat_tech}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{role_tech_invention} + @{role_tech_invention_skill} + @{stat_tech} + @{finalmodifier}]]}} {{critroll=[[1d10]]}}"
                      >
                        Invention Expertise
                      </button>
                    </div>
                    <div class="column">
                      <input
                        type="number"
                        name="attr_role_tech_invention"
                        value="0"
                        min="0"
                      />
                    </div>
                  </div>
                  <div>
                    <select name="attr_role_tech_invention_skill">
                      <option value="@{skill_airvehicletech}">
                        Air Vehicle Tech
                      </option>
                      <option value="@{skill_basictech}">Basic Tech</option>
                      <option value="@{skill_cybertech}">Cybertech</option>
                      <option value="@{skill_electronicssecurity}">
                        Electronics/Security Tech
                      </option>
                      <option value="@{skill_landvehicletech}">
                        Land Vehicle Tech
                      </option>
                      <option value="@{skill_seavehicletech}">
                        Sea Vehicle Tech
                      </option>
                      <option value="@{skill_weaponstech}">Weaponstech</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <script type="text/worker">
          function updateRoleSoloAvailable() {
            getAttrs(['role_solo', 'role_solo_damagedeflection', 'role_solo_fumblerecovery', 'role_solo_initiativereaction', 'role_solo_precisionattack', 'role_solo_spotweakness', 'role_solo_threatdetection'], function(values){
              var roleSoloAvailable = Number(values.role_solo)
              var fields = ['role_solo_damagedeflection', 'role_solo_fumblerecovery', 'role_solo_initiativereaction', 'role_solo_precisionattack', 'role_solo_spotweakness', 'role_solo_threatdetection']
              for (var i = 0; i<fields.length; i++) {
                roleSoloAvailable -= Number(values[fields[i]])
              }
              setAttrs({
                role_solo_available: roleSoloAvailable
              })
            });
          }
          on('change:role_solo change:role_solo_damagedeflection change:role_solo_fumblerecovery change:role_solo_initiativereaction change:role_solo_precisionattack change:role_solo_spotweakness change:role_solo_threatdetection', function() {
            updateRoleSoloAvailable()
          });
          // Calculate the modifiers for SOLO abilities that do not work on
          // a 1:1 spend basis.
          // DAMAGE DEFLECTION: 2pts/level
          on('change:role_solo_damagedeflection', function() {
            getAttrs(['role_solo_damagedeflection'], function(values){
              var calc = Math.floor(Number(values.role_solo_damagedeflection) / 2)
              setAttrs({
                role_solo_damagedeflection_calc: calc
              })
            });
          });
          // FUMBLE RECOVERY: 4pts to enable
          on('change:role_solo_fumblerecovery', function() {
            getAttrs(['role_solo_fumblerecovery'], function(values){
              var calc = Math.floor(Number(values.role_solo_fumblerecovery) / 4)
              setAttrs({
                role_solo_fumblerecovery_calc: calc
              })
            });
          });
          // PRECISION ATTACK: 3pts/level
          on('change:role_solo_precisionattack', function() {
            getAttrs(['role_solo_precisionattack'], function(values){
              var calc = Math.floor(Number(values.role_solo_precisionattack) / 3)
              setAttrs({
                role_solo_precisionattack_calc: calc
              })
            });
          });
        </script>
      </div>
      <div>
        <div class="columns">
          <div class="column">
            <div class="section-ip">
              <h4 class="clipped-corner">
                Improvement Points
                <input
                  type="number"
                  name="attr_ip"
                  value="0"
                  style="width: 7.5rem"
                />
              </h4>
              <div class="field-wrapper center">
                <div style="min-height: 28px">
                  Show IP log?
                  <input type="checkbox" value="0" class="show-next-div" />
                  <div style="text-align: left">
                    <fieldset class="repeating_ip">
                      <div class="columns">
                        <div class="column column-3">
                          <input
                            type="text"
                            name="attr_ipsource"
                            placeholder="Notes..."
                          />
                        </div>
                        <div class="column">
                          <input type="number" name="attr_ipnumber" />
                        </div>
                      </div>
                    </fieldset>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="column">
            <div class="section-reputation">
              <h4 class="clipped-corner">Reputation</h4>
              <div class="field-wrapper center">
                <input type="number" name="attr_reputation" value="0" />
                <button
                  type="roll"
                  value="&{template:minimal}{{charactername=@{character_name}}}{{label=Facedown}}{{message=See full rules on p.194}}{{roll=[[1d10 + @{stat_cool} + @{reputation} + @{finalmodifier}]]}}"
                >
                  Facedown
                </button>
              </div>
            </div>
          </div>
          <div class="column">
            <div class="section-cash">
              <h4 class="clipped-corner">
                Cash
                <input
                  type="number"
                  name="attr_cash"
                  value="0"
                  style="width: 7.5rem"
                /><span class="pageref">EB</span>
              </h4>
              <div class="field-wrapper center">
                <div style="min-height: 28px">
                  Show cash log?
                  <input type="checkbox" value="0" class="show-next-div" />
                  <div style="text-align: left">
                    <fieldset class="repeating_cash">
                      <div class="columns">
                        <div class="column column-3">
                          <input
                            type="text"
                            name="attr_cashsource"
                            placeholder="Notes..."
                          />
                        </div>
                        <div class="column">
                          <input type="number" name="attr_cashnumber" />
                        </div>
                      </div>
                    </fieldset>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div>
        <div class="section-dice-roller">
          Show Dice Rollers?
          <input type="checkbox" value="0" class="show-next-div" />
          <div class="dice-roller-pane">
            <div class="columns">
              <div class="column">
                <button
                  type="roll"
                  name="roll_1d10"
                  value="&{template:basic}{{charactername=@{character_name}}}{{dice=1d10}}{{roll=[[1d10]]}}"
                >
                  Roll 1d10
                </button>
              </div>
              <div class="column">
                <select name="attr_rollnd6" style="width: 5rem">
                  <option value="1">1</option>
                  <option value="2">2</option>
                  <option value="3">3</option>
                  <option value="4">4</option>
                  <option value="5">5</option>
                  <option value="6">6</option>
                  <option value="7">7</option>
                  <option value="8">8</option>
                  <option value="9">9</option>
                  <option value="10">10</option>
                </select>
                <button
                  type="roll"
                  name="roll_d6"
                  value="&{template:basic}{{charactername=@{character_name}}}{{dice=@{rollnd6}d6}}{{roll=[[@{rollnd6}d6]]}}"
                >
                  Roll <span name="attr_rollnd6"></span>d6
                </button>
              </div>
              <div class="column">
                <button
                  type="roll"
                  name="roll_1d100"
                  value="&{template:basic}{{charactername=@{character_name}}}{{dice=1d100}}{{roll=[[1d100]]}}"
                >
                  Roll 1d100
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="tab-content tab2">
      <!-- modifiers controller component -->
      <div class="section-modifiers">
        <div class="modifiers">
          <input type="hidden" name="attr_finalmodifier" />
          <h4 class="clipped-corner">
            Modifiers
            <span name="attr_finalmodifierdisplay"></span>
            <button type="action" name="act_resetmodifiers">Reset</button>
          </h4>
          <div class="modifiers-body">
            Show Modifiers?
            <input
              type="checkbox"
              name="attr_hidemodifiers"
              class="show-next-div"
            />
            <div class="toggle-container">
              <div class="columns">
                <div class="column">
                  <input type="checkbox" name="attr_damageserious" />
                  Damage: Serious
                  <small
                    >(HP&lt;<span name="attr_seriouslywounded"></span>)</small
                  >
                </div>
                <div class="column">
                  <input type="checkbox" name="attr_damagemortal" />
                  Damage: Mortal
                  <small>(HP&lt;1)</small>
                </div>
                <div class="column">
                  <input type="checkbox" name="attr_understress" /> Under stress
                </div>
                <div class="column">
                  <input type="checkbox" name="attr_neverdonebefore" /> Never
                  done before
                </div>
              </div>
              <div class="columns">
                <div class="column">
                  <input type="checkbox" name="attr_nightorlowlight" /> Night or
                  low light
                </div>
                <div class="column">
                  <input type="checkbox" name="attr_obscured" /> Obscured by
                  smoke or darkness
                </div>
                <div class="column">
                  <input type="checkbox" name="attr_complextask" /> Complex task
                </div>
                <div class="column">
                  <input type="checkbox" name="attr_wrongtoolsorparts" /> Wrong
                  tools or parts
                </div>
              </div>
              <div class="columns">
                <div class="column">
                  <input type="checkbox" name="attr_drunkdrugged" /> Drunk or
                  Drugged
                </div>
                <div class="column">
                  <input type="checkbox" name="attr_secretly" /> Attempting
                  secretly
                </div>
                <div class="column">
                  <input type="checkbox" name="attr_lostfacedown" /> Lost
                  facedown
                </div>
                <div class="column">
                  <input type="checkbox" name="attr_aimedshot" /> Aimed shot
                </div>
              </div>
              <div class="columns">
                <div class="column">
                  <input type="checkbox" name="attr_complimentaryskill" />
                  Complimentary skill
                </div>
                <div class="column">
                  <input type="checkbox" name="attr_extratime" /> Spend extra
                  time
                </div>
                <div class="column">
                  Other/custom
                  <input type="number" name="attr_custommod" />
                </div>
                <div class="column">
                  Luck points spent
                  <select name="attr_luckmod">
                    <option value="0">0</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                  </select>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- skills component -->
      <div class="section-skills">
        <div class="skills-list-grouped">
          <div class="skill-group">
            <h4>Awareness Skills</h4>
            <ul class="list-plain">
              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Conceal/Reveal Object}} {{skillname=Conceal/Reveal Object}} {{skillvalue=@{skill_concealrevealobject}}} {{statname=int}} {{statvalue=@{stat_int}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_concealrevealobject} + @{stat_int} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Conceal/Reveal Object

                    <span class="skill-meta"
                      >(int <span name="attr_stat_int"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_concealrevealobject"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Concentration}} {{skillname=Concentration}} {{skillvalue=@{skill_concentration}}} {{statname=will}} {{statvalue=@{stat_will}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_concentration} + @{stat_will} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    <strong>Concentration*</strong>

                    <span class="skill-meta"
                      >(will <span name="attr_stat_will"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="2"
                    name="attr_skill_concentration"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Lip Reading}} {{skillname=Lip Reading}} {{skillvalue=@{skill_lipreading}}} {{statname=int}} {{statvalue=@{stat_int}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_lipreading} + @{stat_int} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Lip Reading

                    <span class="skill-meta"
                      >(int <span name="attr_stat_int"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_lipreading"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Perception}} {{skillname=Perception}} {{skillvalue=@{skill_perception}}} {{statname=int}} {{statvalue=@{stat_int}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_perception} + @{stat_int} + @{finalmodifier}  + @{role_solo_threatdetection} ]]}} {{critroll=[[1d10]]}}"
                  >
                    <strong>Perception*</strong>

                    <span class="skill-meta"
                      >(int
                      <span name="attr_stat_int"></span>
                      <input
                        class="skill-solo-flag"
                        type="hidden"
                        name="attr_role_solo_threatdetection"
                      /><span class="skill-solo-flag"
                        >+ Threat Detection
                        <span
                          name="attr_role_solo_threatdetection"
                        ></span></span
                      >)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="2"
                    name="attr_skill_perception"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Tracking}} {{skillname=Tracking}} {{skillvalue=@{skill_tracking}}} {{statname=int}} {{statvalue=@{stat_int}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_tracking} + @{stat_int} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Tracking

                    <span class="skill-meta"
                      >(int <span name="attr_stat_int"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_tracking"
                  />
                </div>
              </li>
            </ul>
          </div>

          <div class="skill-group">
            <h4>Body Skills</h4>
            <ul class="list-plain">
              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Athletics}} {{skillname=Athletics}} {{skillvalue=@{skill_athletics}}} {{statname=dex}} {{statvalue=@{stat_dex}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_athletics} + @{stat_dex} + @{armor_penalty} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    <strong>Athletics*</strong>

                    <span class="skill-meta"
                      >(dex <span name="attr_stat_dex"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="2"
                    name="attr_skill_athletics"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Contrortionist}} {{skillname=Contrortionist}} {{skillvalue=@{skill_contrortionist}}} {{statname=dex}} {{statvalue=@{stat_dex}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_contrortionist} + @{stat_dex} + @{armor_penalty} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Contrortionist

                    <span class="skill-meta"
                      >(dex <span name="attr_stat_dex"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_contrortionist"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Dance}} {{skillname=Dance}} {{skillvalue=@{skill_dance}}} {{statname=dex}} {{statvalue=@{stat_dex}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_dance} + @{stat_dex} + @{armor_penalty} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Dance

                    <span class="skill-meta"
                      >(dex <span name="attr_stat_dex"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_dance"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Endurance}} {{skillname=Endurance}} {{skillvalue=@{skill_endurance}}} {{statname=will}} {{statvalue=@{stat_will}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_endurance} + @{stat_will} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Endurance

                    <span class="skill-meta"
                      >(will <span name="attr_stat_will"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_endurance"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Resist Torture/Drugs}} {{skillname=Resist Torture/Drugs}} {{skillvalue=@{skill_resisttorturedrugs}}} {{statname=will}} {{statvalue=@{stat_will}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_resisttorturedrugs} + @{stat_will} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Resist Torture/Drugs

                    <span class="skill-meta"
                      >(will <span name="attr_stat_will"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_resisttorturedrugs"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Stealth}} {{skillname=Stealth}} {{skillvalue=@{skill_stealth}}} {{statname=dex}} {{statvalue=@{stat_dex}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_stealth} + @{stat_dex} + @{armor_penalty} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    <strong>Stealth*</strong>

                    <span class="skill-meta"
                      >(dex <span name="attr_stat_dex"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="2"
                    name="attr_skill_stealth"
                  />
                </div>
              </li>
            </ul>
          </div>

          <div class="skill-group">
            <h4>Control Skills</h4>
            <ul class="list-plain">
              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Drive Land Vehicle}} {{skillname=Drive Land Vehicle}} {{skillvalue=@{skill_landvehicle}}} {{statname=ref}} {{statvalue=@{stat_ref}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_landvehicle} + @{stat_ref} + @{role_nomad} + @{armor_penalty} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Drive Land Vehicle

                    <span class="skill-meta"
                      >(ref <span name="attr_stat_ref"></span
                      ><input
                        class="skill-moto-flag"
                        type="hidden"
                        name="attr_role_nomad"
                      /><span class="skill-moto-flag">
                        + MOTO <span name="attr_role_nomad"></span></span
                      >)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_landvehicle"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Pilot Air Vehicle (x2)}} {{skillname=Pilot Air Vehicle}} {{skillvalue=@{skill_airvehicle}}} {{statname=ref}} {{statvalue=@{stat_ref}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_airvehicle} + @{stat_ref} + @{role_nomad} + @{armor_penalty} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Pilot Air Vehicle (x2)

                    <span class="skill-meta"
                      >(ref <span name="attr_stat_ref"></span
                      ><input
                        class="skill-moto-flag"
                        type="hidden"
                        name="attr_role_nomad"
                      /><span class="skill-moto-flag">
                        + MOTO <span name="attr_role_nomad"></span></span
                      >)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_airvehicle"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Pilot Sea Vehicle}} {{skillname=Pilot Sea Vehicle}} {{skillvalue=@{skill_seavehicle}}} {{statname=ref}} {{statvalue=@{stat_ref}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_seavehicle} + @{stat_ref} + @{role_nomad} + @{armor_penalty} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Pilot Sea Vehicle

                    <span class="skill-meta"
                      >(ref <span name="attr_stat_ref"></span
                      ><input
                        class="skill-moto-flag"
                        type="hidden"
                        name="attr_role_nomad"
                      /><span class="skill-moto-flag">
                        + MOTO <span name="attr_role_nomad"></span></span
                      >)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_seavehicle"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Riding}} {{skillname=Riding}} {{skillvalue=@{skill_riding}}} {{statname=ref}} {{statvalue=@{stat_ref}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_riding} + @{stat_ref} + @{armor_penalty} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Riding

                    <span class="skill-meta"
                      >(ref <span name="attr_stat_ref"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_riding"
                  />
                </div>
              </li>
            </ul>
          </div>

          <div class="skill-group">
            <h4>Education Skills</h4>
            <ul class="list-plain">
              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Accounting}} {{skillname=Accounting}} {{skillvalue=@{skill_accounting}}} {{statname=int}} {{statvalue=@{stat_int}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_accounting} + @{stat_int} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Accounting

                    <span class="skill-meta"
                      >(int <span name="attr_stat_int"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_accounting"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Animal Handling}} {{skillname=Animal Handling}} {{skillvalue=@{skill_animalhandling}}} {{statname=int}} {{statvalue=@{stat_int}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_animalhandling} + @{stat_int} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Animal Handling

                    <span class="skill-meta"
                      >(int <span name="attr_stat_int"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_animalhandling"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Bureaucracy}} {{skillname=Bureaucracy}} {{skillvalue=@{skill_bureaucracy}}} {{statname=int}} {{statvalue=@{stat_int}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_bureaucracy} + @{stat_int} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Bureaucracy

                    <span class="skill-meta"
                      >(int <span name="attr_stat_int"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_bureaucracy"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Business}} {{skillname=Business}} {{skillvalue=@{skill_business}}} {{statname=int}} {{statvalue=@{stat_int}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_business} + @{stat_int} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Business

                    <span class="skill-meta"
                      >(int <span name="attr_stat_int"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_business"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Composition}} {{skillname=Composition}} {{skillvalue=@{skill_composition}}} {{statname=int}} {{statvalue=@{stat_int}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_composition} + @{stat_int} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Composition

                    <span class="skill-meta"
                      >(int <span name="attr_stat_int"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_composition"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Criminology}} {{skillname=Criminology}} {{skillvalue=@{skill_criminology}}} {{statname=int}} {{statvalue=@{stat_int}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_criminology} + @{stat_int} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Criminology

                    <span class="skill-meta"
                      >(int <span name="attr_stat_int"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_criminology"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Cryptography}} {{skillname=Cryptography}} {{skillvalue=@{skill_cryptography}}} {{statname=int}} {{statvalue=@{stat_int}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_cryptography} + @{stat_int} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Cryptography

                    <span class="skill-meta"
                      >(int <span name="attr_stat_int"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_cryptography"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Deduction}} {{skillname=Deduction}} {{skillvalue=@{skill_deduction}}} {{statname=int}} {{statvalue=@{stat_int}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_deduction} + @{stat_int} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Deduction

                    <span class="skill-meta"
                      >(int <span name="attr_stat_int"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_deduction"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Education}} {{skillname=Education}} {{skillvalue=@{skill_education}}} {{statname=int}} {{statvalue=@{stat_int}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_education} + @{stat_int} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    <strong>Education*</strong>

                    <span class="skill-meta"
                      >(int <span name="attr_stat_int"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="2"
                    name="attr_skill_education"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Gamble}} {{skillname=Gamble}} {{skillvalue=@{skill_gamble}}} {{statname=int}} {{statvalue=@{stat_int}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_gamble} + @{stat_int} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Gamble

                    <span class="skill-meta"
                      >(int <span name="attr_stat_int"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_gamble"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Library Search}} {{skillname=Library Search}} {{skillvalue=@{skill_librarysearch}}} {{statname=int}} {{statvalue=@{stat_int}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_librarysearch} + @{stat_int} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Library Search

                    <span class="skill-meta"
                      >(int <span name="attr_stat_int"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_librarysearch"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Tactics}} {{skillname=Tactics}} {{skillvalue=@{skill_tactics}}} {{statname=int}} {{statvalue=@{stat_int}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_tactics} + @{stat_int} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Tactics

                    <span class="skill-meta"
                      >(int <span name="attr_stat_int"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_tactics"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Wilderness Survival}} {{skillname=Wilderness Survival}} {{skillvalue=@{skill_wildernesssurvival}}} {{statname=int}} {{statvalue=@{stat_int}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_wildernesssurvival} + @{stat_int} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Wilderness Survival

                    <span class="skill-meta"
                      >(int <span name="attr_stat_int"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_wildernesssurvival"
                  />
                </div>
              </li>

              <li>
                <h5 class="accent-font">
                  Languages*
                  <span class="skill-meta"
                    >(int <span name="attr_stat_int"></span>)</span
                  >
                </h5>
                <fieldset class="repeating_languages">
                  <div class="skill">
                    <span class="skill-indent-icon">&#8627;</span>
                    <button
                      class="button-plain"
                      type="roll"
                      value="&{template:skill}{{charactername=@{character_name}}} {{skillname=Languages: @{skillname}}} {{skillvalue=@{skillvalue}}} {{statname=int}} {{statvalue=@{stat_int}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skillvalue} + @{stat_int} + @{finalmodifier}]]}} {{critroll=[[1d10]]}}"
                    ></button>
                    <input
                      class="skill-name"
                      type="text"
                      name="attr_skillname"
                    />
                    <input
                      class="skill-value"
                      type="number"
                      value="0"
                      name="attr_skillvalue"
                    />
                  </div>
                </fieldset>
              </li>

              <li>
                <h5 class="accent-font">
                  Local Expert*
                  <span class="skill-meta"
                    >(int <span name="attr_stat_int"></span>)</span
                  >
                </h5>
                <fieldset class="repeating_localexperts">
                  <div class="skill">
                    <span class="skill-indent-icon">&#8627;</span>
                    <button
                      class="button-plain"
                      type="roll"
                      value="&{template:skill}{{charactername=@{character_name}}} {{skillname=Local Expert: @{skillname}}} {{skillvalue=@{skillvalue}}} {{statname=int}} {{statvalue=@{stat_int}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skillvalue} + @{stat_int} + @{finalmodifier}]]}} {{critroll=[[1d10]]}}"
                    ></button>
                    <input
                      class="skill-name"
                      type="text"
                      name="attr_skillname"
                    />
                    <input
                      class="skill-value"
                      type="number"
                      value="0"
                      name="attr_skillvalue"
                    />
                  </div>
                </fieldset>
              </li>

              <li>
                <h5 class="accent-font">
                  Science
                  <span class="skill-meta"
                    >(int <span name="attr_stat_int"></span>)</span
                  >
                </h5>
                <fieldset class="repeating_sciences">
                  <div class="skill">
                    <span class="skill-indent-icon">&#8627;</span>
                    <button
                      class="button-plain"
                      type="roll"
                      value="&{template:skill}{{charactername=@{character_name}}} {{skillname=Science: @{skillname}}} {{skillvalue=@{skillvalue}}} {{statname=int}} {{statvalue=@{stat_int}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skillvalue} + @{stat_int} + @{finalmodifier}]]}} {{critroll=[[1d10]]}}"
                    ></button>
                    <input
                      class="skill-name"
                      type="text"
                      name="attr_skillname"
                    />
                    <input
                      class="skill-value"
                      type="number"
                      value="0"
                      name="attr_skillvalue"
                    />
                  </div>
                </fieldset>
              </li>
            </ul>
          </div>

          <div class="skill-group">
            <h4>Fighting Skills</h4>
            <ul class="list-plain">
              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Brawling}} {{skillname=Brawling}} {{skillvalue=@{skill_brawling}}} {{statname=dex}} {{statvalue=@{stat_dex}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_brawling} + @{stat_dex} + @{armor_penalty} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    <strong>Brawling*</strong>

                    <span class="skill-meta"
                      >(dex <span name="attr_stat_dex"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="2"
                    name="attr_skill_brawling"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Evasion}} {{skillname=Evasion}} {{skillvalue=@{skill_evasion}}} {{statname=dex}} {{statvalue=@{stat_dex}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_evasion} + @{stat_dex} + @{armor_penalty} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    <strong>Evasion*</strong>

                    <span class="skill-meta"
                      >(dex <span name="attr_stat_dex"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="2"
                    name="attr_skill_evasion"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Melee Weapon}} {{skillname=Melee Weapon}} {{skillvalue=@{skill_meleeweapon}}} {{statname=dex}} {{statvalue=@{stat_dex}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_meleeweapon} + @{stat_dex} + @{armor_penalty} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Melee Weapon

                    <span class="skill-meta"
                      >(dex <span name="attr_stat_dex"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_meleeweapon"
                  />
                </div>
              </li>

              <li>
                <h5 class="accent-font">
                  Martial Arts (x2)
                  <span class="skill-meta"
                    >(dex <span name="attr_stat_dex"></span>)</span
                  >
                </h5>
                <fieldset class="repeating_martialarts">
                  <div class="skill">
                    <span class="skill-indent-icon">&#8627;</span>
                    <button
                      class="button-plain"
                      type="roll"
                      value="&{template:skill}{{charactername=@{character_name}}} {{skillname=Martial Arts: @{skillname}}} {{skillvalue=@{skillvalue}}} {{statname=dex}} {{statvalue=@{stat_dex}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skillvalue} + @{stat_dex} + @{armor_penalty} + @{finalmodifier}]]}} {{critroll=[[1d10]]}}"
                    ></button>
                    <input
                      class="skill-name"
                      type="text"
                      name="attr_skillname"
                    />
                    <input
                      class="skill-value"
                      type="number"
                      value="0"
                      name="attr_skillvalue"
                    />
                  </div>
                </fieldset>
              </li>
            </ul>
          </div>

          <div class="skill-group">
            <h4>Performance Skills</h4>
            <ul class="list-plain">
              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Acting}} {{skillname=Acting}} {{skillvalue=@{skill_acting}}} {{statname=cool}} {{statvalue=@{stat_cool}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_acting} + @{stat_cool} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Acting

                    <span class="skill-meta"
                      >(cool <span name="attr_stat_cool"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_acting"
                  />
                </div>
              </li>

              <li>
                <h5 class="accent-font">
                  Play Instrument
                  <span class="skill-meta"
                    >(tech <span name="attr_stat_tech"></span>)</span
                  >
                </h5>
                <fieldset class="repeating_playinstrument">
                  <div class="skill">
                    <span class="skill-indent-icon">&#8627;</span>
                    <button
                      class="button-plain"
                      type="roll"
                      value="&{template:skill}{{charactername=@{character_name}}} {{skillname=Play Instrument: @{skillname}}} {{skillvalue=@{skillvalue}}} {{statname=tech}} {{statvalue=@{stat_tech}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skillvalue} + @{stat_tech} + @{finalmodifier}]]}} {{critroll=[[1d10]]}}"
                    ></button>
                    <input
                      class="skill-name"
                      type="text"
                      name="attr_skillname"
                    />
                    <input
                      class="skill-value"
                      type="number"
                      value="0"
                      name="attr_skillvalue"
                    />
                  </div>
                </fieldset>
              </li>
            </ul>
          </div>

          <div class="skill-group">
            <h4>Ranged Weapon Skills</h4>
            <ul class="list-plain">
              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Archery}} {{skillname=Archery}} {{skillvalue=@{skill_archery}}} {{statname=ref}} {{statvalue=@{stat_ref}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_archery} + @{stat_ref} + @{armor_penalty} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Archery

                    <span class="skill-meta"
                      >(ref <span name="attr_stat_ref"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_archery"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Autofire (x2)}} {{skillname=Autofire}} {{skillvalue=@{skill_autofire}}} {{statname=ref}} {{statvalue=@{stat_ref}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_autofire} + @{stat_ref} + @{armor_penalty} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Autofire (x2)

                    <span class="skill-meta"
                      >(ref <span name="attr_stat_ref"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_autofire"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Handgun}} {{skillname=Handgun}} {{skillvalue=@{skill_handgun}}} {{statname=ref}} {{statvalue=@{stat_ref}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_handgun} + @{stat_ref} + @{armor_penalty} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Handgun

                    <span class="skill-meta"
                      >(ref <span name="attr_stat_ref"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_handgun"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Heavy Weapons}} {{skillname=Heavy Weapons}} {{skillvalue=@{skill_heavyweapons}}} {{statname=ref}} {{statvalue=@{stat_ref}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_heavyweapons} + @{stat_ref} + @{armor_penalty} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Heavy Weapons

                    <span class="skill-meta"
                      >(ref <span name="attr_stat_ref"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_heavyweapons"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Shoulder Arms}} {{skillname=Shoulder Arms}} {{skillvalue=@{skill_shoulderarms}}} {{statname=ref}} {{statvalue=@{stat_ref}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_shoulderarms} + @{stat_ref} + @{armor_penalty} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Shoulder Arms

                    <span class="skill-meta"
                      >(ref <span name="attr_stat_ref"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_shoulderarms"
                  />
                </div>
              </li>
            </ul>
          </div>

          <div class="skill-group">
            <h4>Social Skills</h4>
            <ul class="list-plain">
              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Bribery}} {{skillname=Bribery}} {{skillvalue=@{skill_bribery}}} {{statname=cool}} {{statvalue=@{stat_cool}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_bribery} + @{stat_cool} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Bribery

                    <span class="skill-meta"
                      >(cool <span name="attr_stat_cool"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_bribery"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Conversation}} {{skillname=Conversation}} {{skillvalue=@{skill_conversation}}} {{statname=emp}} {{statvalue=@{empathy}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_conversation} + @{empathy} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    <strong>Conversation*</strong>

                    <span class="skill-meta"
                      >(emp <span name="attr_empathy"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="2"
                    name="attr_skill_conversation"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Human Perception}} {{skillname=Human Perception}} {{skillvalue=@{skill_humanperception}}} {{statname=emp}} {{statvalue=@{empathy}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_humanperception} + @{empathy} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    <strong>Human Perception*</strong>

                    <span class="skill-meta"
                      >(emp <span name="attr_empathy"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="2"
                    name="attr_skill_humanperception"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Interrogation}} {{skillname=Interrogation}} {{skillvalue=@{skill_interrogation}}} {{statname=cool}} {{statvalue=@{stat_cool}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_interrogation} + @{stat_cool} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Interrogation

                    <span class="skill-meta"
                      >(cool <span name="attr_stat_cool"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_interrogation"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Personal Grooming}} {{skillname=Personal Grooming}} {{skillvalue=@{skill_personalgrooming}}} {{statname=cool}} {{statvalue=@{stat_cool}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_personalgrooming} + @{stat_cool} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Personal Grooming

                    <span class="skill-meta"
                      >(cool <span name="attr_stat_cool"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_personalgrooming"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Persuasion}} {{skillname=Persuasion}} {{skillvalue=@{skill_persuasion}}} {{statname=cool}} {{statvalue=@{stat_cool}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_persuasion} + @{stat_cool} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    <strong>Persuasion*</strong>

                    <span class="skill-meta"
                      >(cool <span name="attr_stat_cool"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="2"
                    name="attr_skill_persuasion"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Streetwise}} {{skillname=Streetwise}} {{skillvalue=@{skill_streetwise}}} {{statname=cool}} {{statvalue=@{stat_cool}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_streetwise} + @{stat_cool} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Streetwise

                    <span class="skill-meta"
                      >(cool <span name="attr_stat_cool"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_streetwise"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Trading}} {{skillname=Trading}} {{skillvalue=@{skill_trading}}} {{statname=cool}} {{statvalue=@{stat_cool}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_trading} + @{stat_cool} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Trading

                    <span class="skill-meta"
                      >(cool <span name="attr_stat_cool"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_trading"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Wardrobe & Style}} {{skillname=Wardrobe & Style}} {{skillvalue=@{skill_wardrobestyle}}} {{statname=cool}} {{statvalue=@{stat_cool}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_wardrobestyle} + @{stat_cool} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Wardrobe & Style

                    <span class="skill-meta"
                      >(cool <span name="attr_stat_cool"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_wardrobestyle"
                  />
                </div>
              </li>
            </ul>
          </div>

          <div class="skill-group">
            <h4>Technique Skills</h4>
            <ul class="list-plain">
              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Air Vehicle Tech}} {{skillname=Air Vehicle Tech}} {{skillvalue=@{skill_airvehicletech}}} {{statname=tech}} {{statvalue=@{stat_tech}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_airvehicletech} + @{stat_tech} + @{role_nomad} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Air Vehicle Tech

                    <span class="skill-meta"
                      >(tech <span name="attr_stat_tech"></span
                      ><input
                        class="skill-moto-flag"
                        type="hidden"
                        name="attr_role_nomad"
                      /><span class="skill-moto-flag">
                        + MOTO <span name="attr_role_nomad"></span></span
                      >)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_airvehicletech"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Basic Tech}} {{skillname=Basic Tech}} {{skillvalue=@{skill_basictech}}} {{statname=tech}} {{statvalue=@{stat_tech}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_basictech} + @{stat_tech} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Basic Tech

                    <span class="skill-meta"
                      >(tech <span name="attr_stat_tech"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_basictech"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Cybertech}} {{skillname=Cybertech}} {{skillvalue=@{skill_cybertech}}} {{statname=tech}} {{statvalue=@{stat_tech}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_cybertech} + @{stat_tech} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Cybertech

                    <span class="skill-meta"
                      >(tech <span name="attr_stat_tech"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_cybertech"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Demolitions (x2)}} {{skillname=Demolitions}} {{skillvalue=@{skill_demolitions}}} {{statname=tech}} {{statvalue=@{stat_tech}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_demolitions} + @{stat_tech} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Demolitions (x2)

                    <span class="skill-meta"
                      >(tech <span name="attr_stat_tech"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_demolitions"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Electronics/Security Tech (x2)}} {{skillname=Electronics/Security Tech}} {{skillvalue=@{skill_electronicssecurity}}} {{statname=tech}} {{statvalue=@{stat_tech}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_electronicssecurity} + @{stat_tech} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Electronics/Security Tech (x2)

                    <span class="skill-meta"
                      >(tech <span name="attr_stat_tech"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_electronicssecurity"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=First Aid}} {{skillname=First Aid}} {{skillvalue=@{skill_firstaid}}} {{statname=tech}} {{statvalue=@{stat_tech}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_firstaid} + @{stat_tech} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    <strong>First Aid*</strong>

                    <span class="skill-meta"
                      >(tech <span name="attr_stat_tech"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="2"
                    name="attr_skill_firstaid"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Forgery}} {{skillname=Forgery}} {{skillvalue=@{skill_forgery}}} {{statname=tech}} {{statvalue=@{stat_tech}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_forgery} + @{stat_tech} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Forgery

                    <span class="skill-meta"
                      >(tech <span name="attr_stat_tech"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_forgery"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Land Vehicle Tech}} {{skillname=Land Vehicle Tech}} {{skillvalue=@{skill_landvehicletech}}} {{statname=tech}} {{statvalue=@{stat_tech}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_landvehicletech} + @{stat_tech} + @{role_nomad} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Land Vehicle Tech

                    <span class="skill-meta"
                      >(tech <span name="attr_stat_tech"></span
                      ><input
                        class="skill-moto-flag"
                        type="hidden"
                        name="attr_role_nomad"
                      /><span class="skill-moto-flag">
                        + MOTO <span name="attr_role_nomad"></span></span
                      >)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_landvehicletech"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Paint/Draw/Sculpt}} {{skillname=Paint/Draw/Sculpt}} {{skillvalue=@{skill_paintdrawsculpt}}} {{statname=tech}} {{statvalue=@{stat_tech}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_paintdrawsculpt} + @{stat_tech} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Paint/Draw/Sculpt

                    <span class="skill-meta"
                      >(tech <span name="attr_stat_tech"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_paintdrawsculpt"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Paramedic (x2)}} {{skillname=Paramedic}} {{skillvalue=@{skill_paramedic}}} {{statname=tech}} {{statvalue=@{stat_tech}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_paramedic} + @{stat_tech} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Paramedic (x2)

                    <span class="skill-meta"
                      >(tech <span name="attr_stat_tech"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_paramedic"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Photography/Film}} {{skillname=Photography/Film}} {{skillvalue=@{skill_photographyfilm}}} {{statname=tech}} {{statvalue=@{stat_tech}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_photographyfilm} + @{stat_tech} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Photography/Film

                    <span class="skill-meta"
                      >(tech <span name="attr_stat_tech"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_photographyfilm"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Pick Lock}} {{skillname=Pick Lock}} {{skillvalue=@{skill_picklock}}} {{statname=tech}} {{statvalue=@{stat_tech}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_picklock} + @{stat_tech} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Pick Lock

                    <span class="skill-meta"
                      >(tech <span name="attr_stat_tech"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_picklock"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Pick Pocket}} {{skillname=Pick Pocket}} {{skillvalue=@{skill_pickpocket}}} {{statname=tech}} {{statvalue=@{stat_tech}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_pickpocket} + @{stat_tech} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Pick Pocket

                    <span class="skill-meta"
                      >(tech <span name="attr_stat_tech"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_pickpocket"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Sea Vehicle Tech}} {{skillname=Sea Vehicle Tech}} {{skillvalue=@{skill_seavehicletech}}} {{statname=tech}} {{statvalue=@{stat_tech}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_seavehicletech} + @{stat_tech} + @{role_nomad} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Sea Vehicle Tech

                    <span class="skill-meta"
                      >(tech <span name="attr_stat_tech"></span
                      ><input
                        class="skill-moto-flag"
                        type="hidden"
                        name="attr_role_nomad"
                      /><span class="skill-moto-flag">
                        + MOTO <span name="attr_role_nomad"></span></span
                      >)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_seavehicletech"
                  />
                </div>
              </li>

              <li>
                <div class="skill">
                  <button
                    class="button-plain"
                    type="roll"
                    value="&{template:skill}{{charactername=@{character_name}}} {{header=Weaponstech}} {{skillname=Weaponstech}} {{skillvalue=@{skill_weaponstech}}} {{statname=tech}} {{statvalue=@{stat_tech}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_weaponstech} + @{stat_tech} + @{finalmodifier} ]]}} {{critroll=[[1d10]]}}"
                  >
                    Weaponstech

                    <span class="skill-meta"
                      >(tech <span name="attr_stat_tech"></span>)
                    </span>
                  </button>
                  <input
                    class="skill-value"
                    type="number"
                    value="0"
                    name="attr_skill_weaponstech"
                  />
                </div>
              </li>
            </ul>
          </div>
        </div>
        <div class="center" style="color: #fff; font-size: 1.2rem">
          * These skills are required
        </div>
      </div>
    </div>
    <div class="tab-content tab3">
      <!-- modifiers controller component -->
      <div class="section-modifiers">
        <div class="modifiers">
          <input type="hidden" name="attr_finalmodifier" />
          <h4 class="clipped-corner">
            Modifiers
            <span name="attr_finalmodifierdisplay"></span>
            <button type="action" name="act_resetmodifiers">Reset</button>
          </h4>
          <div class="modifiers-body">
            Show Modifiers?
            <input
              type="checkbox"
              name="attr_hidemodifiers"
              class="show-next-div"
            />
            <div class="toggle-container">
              <div class="columns">
                <div class="column">
                  <input type="checkbox" name="attr_damageserious" />
                  Damage: Serious
                  <small
                    >(HP&lt;<span name="attr_seriouslywounded"></span>)</small
                  >
                </div>
                <div class="column">
                  <input type="checkbox" name="attr_damagemortal" />
                  Damage: Mortal
                  <small>(HP&lt;1)</small>
                </div>
                <div class="column">
                  <input type="checkbox" name="attr_understress" /> Under stress
                </div>
                <div class="column">
                  <input type="checkbox" name="attr_neverdonebefore" /> Never
                  done before
                </div>
              </div>
              <div class="columns">
                <div class="column">
                  <input type="checkbox" name="attr_nightorlowlight" /> Night or
                  low light
                </div>
                <div class="column">
                  <input type="checkbox" name="attr_obscured" /> Obscured by
                  smoke or darkness
                </div>
                <div class="column">
                  <input type="checkbox" name="attr_complextask" /> Complex task
                </div>
                <div class="column">
                  <input type="checkbox" name="attr_wrongtoolsorparts" /> Wrong
                  tools or parts
                </div>
              </div>
              <div class="columns">
                <div class="column">
                  <input type="checkbox" name="attr_drunkdrugged" /> Drunk or
                  Drugged
                </div>
                <div class="column">
                  <input type="checkbox" name="attr_secretly" /> Attempting
                  secretly
                </div>
                <div class="column">
                  <input type="checkbox" name="attr_lostfacedown" /> Lost
                  facedown
                </div>
                <div class="column">
                  <input type="checkbox" name="attr_aimedshot" /> Aimed shot
                </div>
              </div>
              <div class="columns">
                <div class="column">
                  <input type="checkbox" name="attr_complimentaryskill" />
                  Complimentary skill
                </div>
                <div class="column">
                  <input type="checkbox" name="attr_extratime" /> Spend extra
                  time
                </div>
                <div class="column">
                  Other/custom
                  <input type="number" name="attr_custommod" />
                </div>
                <div class="column">
                  Luck points spent
                  <select name="attr_luckmod">
                    <option value="0">0</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                  </select>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- main combat component (weapons and attacks/damage) -->
      <div class="section-combat">
        <div class="combat-misc">
          <div class="columns">
            <div class="column center">
              <h4>Evasion</h4>
              <div class="field-wrapper">
                Modifier
                <input type="number" value="0" name="attr_evasionmodifier" />
                <button
                  type="roll"
                  value="&{template:skill}{{charactername=@{character_name}}} {{skillname=Evasion}} {{skillvalue=@{skill_evasion}}} {{statname=DEX}} {{statvalue=@{stat_dex}}} {{finalmodifier=@{finalmodifier}}} {{roll=[[1d10 + @{skill_evasion} + @{stat_dex} + @{armor_penalty} + @{finalmodifier} + @{evasionmodifier}]]}} {{critroll=[[1d10]]}}"
                >
                  Evasion
                </button>
              </div>
            </div>
            <div class="column center">
              <div class="initiative">
                <h4>Initiative</h4>
                <div class="field-wrapper">
                  Modifier
                  <input
                    type="number"
                    value="0"
                    name="attr_initiativemodifier"
                  />
                  <button
                    type="roll"
                    value="&{template:initiative} {{charactername=@{character_name}}} {{roll=[[1d10+@{selected|stat_ref}+@{role_solo_initiativereaction}+@{initiativemodifier} &{tracker}]]}}"
                  >
                    Initiative
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="combat-weapons">
          <h4 class="accent-font">Weapons</h4>
          <fieldset class="repeating_weapons">
            <div class="weapon">
              <div class="columns">
                <div class="column">
                  <div class="accent-font">Name</div>
                  <input type="text" name="attr_weaponname" />
                </div>
                <div class="column">
                  <div class="accent-font">Skill</div>
                  <select name="attr_weaponskill">
                    <optgroup label="Melee">
                      <option value="@{skill_brawling}+@{stat_dex}">
                        Brawling
                      </option>
                      <option value="@{skill_meleeweapon}+@{stat_dex}">
                        Melee Weapon
                      </option>
                    </optgroup>
                    <optgroup label="Ranged">
                      <option value="@{skill_archery}+@{stat_ref}">
                        Archery
                      </option>
                      <option value="@{skill_handgun}+@{stat_ref}">
                        Handgun
                      </option>
                      <option value="@{skill_heavyweapons}+@{stat_ref}">
                        Heavy Weapons
                      </option>
                      <option value="@{skill_shoulderarms}+@{stat_ref}">
                        Shoulder Arms
                      </option>
                    </optgroup>
                    <optgroup label="Thrown">
                      <option value="@{skill_athletics}+@{stat_dex}">
                        Thrown (Athletics)
                      </option>
                    </optgroup>
                  </select>
                </div>
                <div class="column">
                  <div class="accent-font">Damage</div>
                  <select class="narrow" name="attr_weapondamage">
                    <option value="1">1d6</option>
                    <option value="2">2d6</option>
                    <option value="3">3d6</option>
                    <option value="4">4d6</option>
                    <option value="5">5d6</option>
                    <option value="6">6d6</option>
                    <option value="7">7d6</option>
                    <option value="8">8d6</option>
                    <option value="9">9d6</option>
                    <option value="10">10d6</option>
                  </select>
                </div>
                <div class="column">
                  <div class="accent-font">Magazine</div>
                  <input
                    class="narrow"
                    type="text"
                    name="attr_weaponmagazine"
                  />
                </div>
                <div class="column">
                  <div class="accent-font">
                    <abbr title="Rate of Fire">RoF</abbr>
                  </div>
                  <select class="narrow" name="attr_weaponrof">
                    <option value="1">1</option>
                    <option value="2">2</option>
                  </select>
                </div>
              </div>
              <div class="columns">
                <div class="column">
                  <div class="weapon-ammotype">
                    <span class="accent-font">Ammo Type</span>
                    <input type="text" name="attr_weaponammotype" />
                  </div>
                  <div class="weapon-custommods">
                    <div>
                      <input
                        name="attr_weaponshowmodifiers"
                        type="checkbox"
                        class="show-next-div"
                      />
                      Custom Modifiers
                      <div>
                        <div class="columns">
                          <div class="column">
                            <div class="accent-font">Attack Modifier</div>
                            <input
                              type="number"
                              name="attr_weaponmodifier"
                              value="0"
                            />
                          </div>
                          <div class="column">
                            <div class="accent-font">Damage Modifier</div>
                            <input
                              type="number"
                              name="attr_weapondamagemod"
                              class="narrow"
                              value="0"
                            />
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="column column-3" style="margin-bottom: 1rem">
                  <div class="accent-font">Notes</div>
                  <textarea name="attr_weaponnotes" rows="3"></textarea>
                  <div class="columns">
                    <div class="column">
                      <input type="checkbox" name="attr_weaponconcealable" />
                      Concealable
                    </div>
                    <div class="column">
                      <input type="checkbox" name="attr_weaponautofire" />
                      Autofire
                    </div>
                    <div class="column">
                      <input type="checkbox" name="attr_weaponsuppress" />
                      Suppressing Fire
                    </div>
                  </div>
                </div>
              </div>
              <div class="actions">
                <input
                  class="autofiretoggle"
                  type="hidden"
                  name="attr_weaponautofire"
                />
                <button
                  class="autofirebutton"
                  type="roll"
                  name="roll_autofire"
                  value="&{template:attack}{{charactername=@{character_name}}}{{weapon=@{weaponname} (Autofire)}}{{specialrule=See full Autofire rules on p.173}}{{roll=[[1d10+@{skill_autofire}+@{stat_ref}+@{armor_penalty}+@{weaponmodifier}+@{role_solo_precisionattack_calc}+@{finalmodifier}]]}}{{critroll=[[1d10]]}}"
                >
                  Autofire
                </button>
                <input
                  class="suppfiretoggle"
                  type="hidden"
                  name="attr_weaponsuppress"
                />
                <button
                  class="suppfirebutton"
                  type="roll"
                  name="roll_suppfire"
                  value="&{template:attack}{{charactername=@{character_name}}}{{weapon=@{weaponname} (Suppressing Fire)}}{{specialrule=Opponents need to make a Concentration check. (See p.174)}}{{roll=[[1d10+@{skill_autofire}+@{stat_ref}+@{armor_penalty}+@{weaponmodifier}+@{role_solo_precisionattack_calc}+@{finalmodifier}]]}}{{critroll=[[1d10]]}}"
                >
                  Suppressing Fire
                </button>
                <button
                  type="roll"
                  name="roll_attack"
                  value="&{template:attack}{{charactername=@{character_name}}}{{weapon=@{weaponname}}}{{roll=[[1d10+@{weaponskill}+@{armor_penalty}+@{weaponmodifier}+@{role_solo_precisionattack_calc}+@{finalmodifier}]]}}{{critroll=[[1d10]]}}"
                >
                  Attack
                </button>
                <button
                  type="roll"
                  name="roll_damage"
                  value="&{template:damage}{{charactername=@{character_name}}}{{weaponname=@{weaponname}}}{{weapondamage=@{weapondamage}d6+@{weapondamagemod}}}{{roll=[[@{weapondamage}d6s+@{weapondamagemod}]]}}"
                >
                  Damage
                </button>
              </div>
            </div>
          </fieldset>
        </div>
        <div class="combat-martialarts">
          Show Martial Arts Attacks
          <input
            type="checkbox"
            class="show-next-div"
            name="attr_showmartialarts"
          />
          <div class="combat-martialarts-pane">
            <h4 class="accent-font">
              Martial Arts
              <small>(DEX <span name="attr_stat_dex"></span>)</small>
            </h4>
            <fieldset class="repeating_martialarts">
              <div class="martialart">
                <div class="columns">
                  <div class="column">
                    <div style="display: none">
                      <input type="text" name="attr_skillname" />
                      <input type="number" name="attr_skillvalue" />
                    </div>
                    <strong><span name="attr_skillname"></span></strong>
                    (Skill <span name="attr_skillvalue"></span>)
                  </div>
                  <div class="column">
                    Hit Modifier
                    <input type="number" name="attr_mamodifier" min="0" />
                  </div>
                  <div class="column">
                    Damage
                    <select class="narrow" name="attr_madamage">
                      <option value="1">1d6</option>
                      <option value="2">2d6</option>
                      <option value="3">3d6</option>
                      <option value="4">4d6</option>
                      <option value="5">5d6</option>
                      <option value="6">6d6</option>
                      <option value="7">7d6</option>
                      <option value="8">8d6</option>
                      <option value="9">9d6</option>
                      <option value="10">10d6</option>
                    </select>
                  </div>
                  <div class="column">
                    Damage Modifier
                    <input type="number" name="attr_madamagemod" />
                  </div>
                </div>
                <div class="columns">
                  <div class="column">Description</div>
                  <div class="column column-3">
                    <textarea name="attr_martialartsdesc"></textarea>
                  </div>
                </div>
                <div class="actions">
                  <button
                    type="roll"
                    name="roll_attack"
                    value="&{template:attack}{{charactername=@{character_name}}}{{weapon=Martial Arts: @{skillname}}}{{roll=[[1d10+@{skillvalue}+@{stat_dex}+@{armor_penalty}+@{mamodifier}+@{finalmodifier}]]}}{{critroll=[[1d10]]}}"
                  >
                    Attack
                  </button>
                  <button
                    type="roll"
                    name="roll_damage"
                    value="&{template:damage}{{charactername=@{character_name}}}{{weaponname=Martial Arts: @{skillname}}}{{weapondamage=@{madamage}d6+@{madamagemod}}}{{roll=[[@{madamage}d6s+@{madamagemod}]]}}"
                  >
                    Damage
                  </button>
                </div>
              </div>
            </fieldset>
          </div>
        </div>
        <div class="columns">
          <div class="column">
            <div class="armor">
              <div class="columns armor-headers">
                <div class="column column-5">
                  <h4>Armor</h4>
                </div>
                <div class="column">
                  <h4>SP</h4>
                </div>
                <div class="column">
                  <h4>(Max)</h4>
                </div>
                <div class="column">
                  <h4>
                    <div style="width: 5.5rem">Mod</div>
                  </h4>
                </div>
              </div>
              <div class="armor-items">
                <div class="columns">
                  <div class="column">Body</div>
                  <div class="column column-4">
                    <input type="text" name="attr_armorname" />
                  </div>
                  <div class="column">
                    <input type="number" name="attr_armor" />
                  </div>
                  <div class="column">
                    <input type="number" name="attr_armor_max" />
                  </div>
                  <div class="column">
                    <select name="attr_armor_penalty">
                      <option value="0" selected="selected">0</option>
                      <option value="-2">-2</option>
                      <option value="-4">-4</option>
                    </select>
                  </div>
                </div>
                <div class="columns">
                  <div class="column">Head</div>
                  <div class="column column-4">
                    <input type="text" name="attr_armorheadname" />
                  </div>
                  <div class="column">
                    <input type="number" name="attr_armorhead" />
                  </div>
                  <div class="column">
                    <input type="number" name="attr_armorhead_max" />
                  </div>
                  <div class="column">&nbsp;</div>
                </div>
                <div class="columns">
                  <div class="column">Shield</div>
                  <div class="column column-4">
                    <input type="text" name="attr_armorshieldname" />
                  </div>
                  <div class="column">
                    <input type="number" name="attr_armorshield" />
                  </div>
                  <div class="column">
                    <input type="number" name="attr_armorshield_max" />
                  </div>
                  <div class="column">&nbsp;</div>
                </div>
              </div>
            </div>
          </div>
          <div class="column">
            <div class="ammo">
              <div class="columns ammo-headers">
                <div class="column column-5">
                  <h4>Ammo</h4>
                </div>
                <div class="column">
                  <h4>Qty</h4>
                </div>
              </div>
              <div class="ammo-items">
                <fieldset class="repeating_ammo">
                  <div class="columns">
                    <div class="column column-5">
                      <input type="text" name="attr_ammoname" />
                    </div>
                    <div class="column">
                      <input type="number" name="attr_ammoquantity" />
                    </div>
                  </div>
                </fieldset>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="tab-content tab4">
      <div class="section-gear">
        <div class="gear">
          <div class="gear-headers columns">
            <div class="column">
              <h4>Gear</h4>
            </div>
            <div class="column column-3">
              <h4>Notes</h4>
            </div>
          </div>
          <div class="gear-items">
            <fieldset class="repeating_gear">
              <div class="columns">
                <div class="column">
                  <input type="text" name="attr_gear_name" />
                </div>
                <div class="column column-3">
                  <textarea name="attr_gear_desc"></textarea>
                </div>
              </div>
            </fieldset>
          </div>
        </div>
        <div class="gear-cyberdeck gear-toggle">
          Show Cyberdeck?
          <input
            type="checkbox"
            name="attr_showcyberdeck"
            class="show-next-div"
          />
          <div class="gear-cyberdeck-pane gear-toggle-pane">
            <h4>Cyberdeck</h4>
            <div class="cyberdeck-wrapper">
              <div class="columns cyberdeck-main">
                <div class="column">
                  <div>Name</div>
                  <input type="text" name="attr_cyberdeck_name" />
                </div>
                <div class="column">
                  <div>Type</div>
                  <select name="attr_cyberdeck_type">
                    <option value="poor">Poor Quality (5 slots)</option>
                    <option value="standard">Standard Quality (7 slots)</option>
                    <option value="excellent">
                      Excellent Quality (9 slots)
                    </option>
                  </select>
                </div>
              </div>
              <h5>Programs and Hardware</h5>
              <div class="cyberdeck-slots" style="padding-bottom: 1rem">
                <fieldset class="repeating_cyberdeck">
                  <div class="columns">
                    <div class="column">
                      Name
                      <input type="text" name="attr_cyberdeck_program" />
                    </div>
                    <div class="column">
                      Type
                      <select name="attr_cyberdeck_class">
                        <option value="booster">Booster</option>
                        <option value="attack">Attack</option>
                        <option value="defender">Defender</option>
                      </select>
                    </div>
                    <div class="column">
                      ATK
                      <input type="number" name="attr_cyberdeck_atk" />
                    </div>
                    <div class="column">
                      DEF
                      <input type="number" name="attr_cyberdeck_def" />
                    </div>
                    <div class="column">
                      REZ
                      <input type="number" name="attr_cyberdeck_rez" />
                    </div>
                    <div class="column column-3">
                      Icon
                      <input type="text" name="attr_cyberdeck_icon" />
                    </div>
                  </div>
                  <div class="columns">
                    <div class="column">
                      Effect
                      <textarea name="attr_cyberdeck_effect"></textarea>
                    </div>
                  </div>
                </fieldset>
              </div>
            </div>
          </div>
        </div>
        <div class="gear-vehicles gear-toggle">
          Show Vehicles?
          <input
            type="checkbox"
            name="attr_showvehicles"
            class="show-next-div"
          />
          <div class="gear-vehicle-pane gear-toggle-pane">
            <h4>Vehicles</h4>
            <div class="field-wrapper">
              <fieldset class="repeating_vehicles">
                <div class="columns">
                  <div class="column">
                    Vehicle
                    <input
                      type="text"
                      name="attr_vehicle_name"
                      style="width: 100%"
                    />
                  </div>
                  <div class="column">
                    SDP
                    <input
                      type="text"
                      name="attr_vehicle_sdp"
                      style="width: 100%"
                    />
                  </div>
                  <div class="column">
                    Seats
                    <input
                      type="number"
                      name="attr_vehicle_seats"
                      style="width: 100%"
                    />
                  </div>
                  <div class="column">
                    Speed (Move)
                    <input
                      type="number"
                      name="attr_vehicle_speed"
                      style="width: 100%"
                    />
                  </div>
                  <div class="column">
                    Speed (Narrative)
                    <input
                      type="text"
                      name="attr_vehicle_narrative"
                      style="width: 100%"
                    />
                  </div>
                </div>
                <div class="columns">
                  <div class="column">
                    Description/Notes
                    <textarea name="attr_vehicle_desc"></textarea>
                  </div>
                </div>
              </fieldset>
            </div>
          </div>
        </div>
        <div class="gear-meta">
          <div class="columns end-of-page">
            <div class="column">
              <h4>Lifestyle <span class="pageref">see p.377</span></h4>
              <div class="gear-meta-wrapper center" style="padding-bottom: 0">
                <select name="attr_lifestyle">
                  <option value="1">Kibble</option>
                  <option value="2">Generic Prepak</option>
                  <option value="3">Good Prepak</option>
                  <option value="4">Fresh Food</option>
                </select>
              </div>
            </div>
            <div class="column">
              <h4>Housing <span class="pageref">see p.377-380</span></h4>
              <div class="gear-meta-wrapper center" style="padding-bottom: 0">
                <select name="attr_rent">
                  <option value="1">Street</option>
                  <option value="2">Vehicle</option>
                  <option value="3">Cube Hotel</option>
                  <option value="4">Cargo Container</option>
                  <option value="5">Studio Apartment</option>
                  <option value="6">Two-Bedroom Apartment</option>
                  <option value="7">Corporate Conapt</option>
                  <option value="8">Upscale Conapt</option>
                  <option value="9">Luxury Penthouse</option>
                  <option value="10">Corporate Beaverville House</option>
                  <option value="11">Corporate Beaverville McMansion</option>
                </select>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="tab-content tab5">
      <div class="section-cyberware">
        <div class="columns">
          <div class="column">
            <div class="cyberware-group">
              <h4>Cyberaudio</h4>
              <fieldset class="repeating_cyberaudio">
                <div class="columns">
                  <div class="column label">Name</div>
                  <div class="column column-5">
                    <input type="text" name="attr_cyberwarename" />
                  </div>
                </div>
                <div class="columns">
                  <div class="column label">Data</div>
                  <div class="column column-5">
                    <textarea name="attr_cyberwaredesc"></textarea>
                  </div>
                </div>
              </fieldset>
            </div>
            <div class="cyberware-group">
              <h4>Right Cybereye</h4>
              <fieldset class="repeating_cybereyeright">
                <div class="columns">
                  <div class="column label">Name</div>
                  <div class="column column-5">
                    <input type="text" name="attr_cyberwarename" />
                  </div>
                </div>
                <div class="columns">
                  <div class="column label">Data</div>
                  <div class="column column-5">
                    <textarea name="attr_cyberwaredesc"></textarea>
                  </div>
                </div>
              </fieldset>
            </div>
            <div class="cyberware-group">
              <h4>Left Cybereye</h4>
              <fieldset class="repeating_cybereyeleft">
                <div class="columns">
                  <div class="column label">Name</div>
                  <div class="column column-5">
                    <input type="text" name="attr_cyberwarename" />
                  </div>
                </div>
                <div class="columns">
                  <div class="column label">Data</div>
                  <div class="column column-5">
                    <textarea name="attr_cyberwaredesc"></textarea>
                  </div>
                </div>
              </fieldset>
            </div>
            <div class="cyberware-group">
              <h4>Right Cyberarm</h4>
              <fieldset class="repeating_cyberarmright">
                <div class="columns">
                  <div class="column label">Name</div>
                  <div class="column column-5">
                    <input type="text" name="attr_cyberwarename" />
                  </div>
                </div>
                <div class="columns">
                  <div class="column label">Data</div>
                  <div class="column column-5">
                    <textarea name="attr_cyberwaredesc"></textarea>
                  </div>
                </div>
              </fieldset>
            </div>
            <div class="cyberware-group">
              <h4>Left Cyberarm</h4>
              <fieldset class="repeating_cyberarmleft">
                <div class="columns">
                  <div class="column label">Name</div>
                  <div class="column column-5">
                    <input type="text" name="attr_cyberwarename" />
                  </div>
                </div>
                <div class="columns">
                  <div class="column label">Data</div>
                  <div class="column column-5">
                    <textarea name="attr_cyberwaredesc"></textarea>
                  </div>
                </div>
              </fieldset>
            </div>
            <div class="cyberware-group">
              <h4>Neural Link</h4>
              <fieldset class="repeating_cyberneurallink">
                <div class="columns">
                  <div class="column label">Name</div>
                  <div class="column column-5">
                    <input type="text" name="attr_cyberwarename" />
                  </div>
                </div>
                <div class="columns">
                  <div class="column label">Data</div>
                  <div class="column column-5">
                    <textarea name="attr_cyberwaredesc"></textarea>
                  </div>
                </div>
              </fieldset>
            </div>
            <div class="cyberware-group">
              <h4>Right Cyberleg</h4>
              <fieldset class="repeating_cyberlegright">
                <div class="columns">
                  <div class="column label">Name</div>
                  <div class="column column-5">
                    <input type="text" name="attr_cyberwarename" />
                  </div>
                </div>
                <div class="columns">
                  <div class="column label">Data</div>
                  <div class="column column-5">
                    <textarea name="attr_cyberwaredesc"></textarea>
                  </div>
                </div>
              </fieldset>
            </div>
            <div class="cyberware-group">
              <h4>Left Cyberleg</h4>
              <fieldset class="repeating_cyberlegleft">
                <div class="columns">
                  <div class="column label">Name</div>
                  <div class="column column-5">
                    <input type="text" name="attr_cyberwarename" />
                  </div>
                </div>
                <div class="columns">
                  <div class="column label">Data</div>
                  <div class="column column-5">
                    <textarea name="attr_cyberwaredesc"></textarea>
                  </div>
                </div>
              </fieldset>
            </div>
          </div>
          <div class="column">
            <div class="cyberware-group">
              <h4>Internal Cyberware</h4>
              <fieldset class="repeating_cyberinternal">
                <div class="columns">
                  <div class="column label">Name</div>
                  <div class="column column-5">
                    <input type="text" name="attr_cyberwarename" />
                  </div>
                </div>
                <div class="columns">
                  <div class="column label">Data</div>
                  <div class="column column-5">
                    <textarea name="attr_cyberwaredesc"></textarea>
                  </div>
                </div>
              </fieldset>
            </div>
            <div class="cyberware-group">
              <h4>External Cyberware</h4>
              <fieldset class="repeating_cyberexternal">
                <div class="columns">
                  <div class="column label">Name</div>
                  <div class="column column-5">
                    <input type="text" name="attr_cyberwarename" />
                  </div>
                </div>
                <div class="columns">
                  <div class="column label">Data</div>
                  <div class="column column-5">
                    <textarea name="attr_cyberwaredesc"></textarea>
                  </div>
                </div>
              </fieldset>
            </div>
            <div class="cyberware-group">
              <h4>Fashionware</h4>
              <fieldset class="repeating_cyberfashion">
                <div class="columns">
                  <div class="column label">Name</div>
                  <div class="column column-5">
                    <input type="text" name="attr_cyberwarename" />
                  </div>
                </div>
                <div class="columns">
                  <div class="column label">Data</div>
                  <div class="column column-5">
                    <textarea name="attr_cyberwaredesc"></textarea>
                  </div>
                </div>
              </fieldset>
            </div>
            <div class="cyberware-group">
              <h4>Borgware</h4>
              <fieldset class="repeating_cyberborg">
                <div class="columns">
                  <div class="column label">Name</div>
                  <div class="column column-5">
                    <input type="text" name="attr_cyberwarename" />
                  </div>
                </div>
                <div class="columns">
                  <div class="column label">Data</div>
                  <div class="column column-5">
                    <textarea name="attr_cyberwaredesc"></textarea>
                  </div>
                </div>
              </fieldset>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="tab-content tab6">
      <div class="section-lifepath">
        <div class="lifepath-role">
          <input type="hidden" name="attr_role" />
          <div class="lp lp-exec">
            <h4>Exec Lifepath</h4>
            <div class="field-wrapper">
              <textarea name="attr_lp_exec"></textarea>
            </div>
          </div>
          <div class="lp lp-fixer">
            <h4>Fixer Lifepath</h4>
            <div class="field-wrapper">
              <textarea name="attr_lp_fixer"></textarea>
            </div>
          </div>
          <div class="lp lp-lawman">
            <h4>Lawman Lifepath</h4>
            <div class="field-wrapper">
              <textarea name="attr_lp_lawman"></textarea>
            </div>
          </div>
          <div class="lp lp-media">
            <h4>Media Lifepath</h4>
            <div class="field-wrapper">
              <textarea name="attr_lp_media"></textarea>
            </div>
          </div>
          <div class="lp lp-medtech">
            <h4>Medtech Lifepath</h4>
            <div class="field-wrapper">
              <textarea name="attr_lp_medtech"></textarea>
            </div>
          </div>
          <div class="lp lp-netrunner">
            <h4>Netrunner Lifepath</h4>
            <div class="field-wrapper">
              <textarea name="attr_lp_netrunner"></textarea>
            </div>
          </div>
          <div class="lp lp-nomad">
            <h4>Nomad Lifepath</h4>
            <div class="field-wrapper">
              <textarea name="attr_lp_nomad"></textarea>
            </div>
          </div>
          <div class="lp lp-rockerboy">
            <h4>Rockerboy Lifepath</h4>
            <div class="field-wrapper">
              <textarea name="attr_lp_rockerboy"></textarea>
            </div>
          </div>
          <div class="lp lp-solo">
            <h4>Solo Lifepath</h4>
            <div class="field-wrapper">
              <textarea name="attr_lp_solo"></textarea>
            </div>
          </div>
          <div class="lp lp-tech">
            <h4>Tech Lifepath</h4>
            <div class="field-wrapper">
              <textarea name="attr_lp_tech"></textarea>
            </div>
          </div>
        </div>
        <div class="columns">
          <div class="column">
            <div class="lifepath-group">
              <h4>Cultural Origins</h4>
              <textarea name="attr_lp_culture"></textarea>
            </div>
            <div class="lifepath-group">
              <h4>Clothing Style</h4>
              <textarea name="attr_lp_clothing"></textarea>
            </div>
            <div class="lifepath-group">
              <h4>What do you value most?</h4>
              <textarea name="attr_lp_whatdoyouvalue"></textarea>
            </div>
            <div class="lifepath-group">
              <h4>Most valued person</h4>
              <textarea name="attr_lp_mostvaluedperson"></textarea>
            </div>
            <div class="lifepath-group">
              <h4>Family Background</h4>
              <textarea name="attr_lp_familybackground"></textarea>
            </div>
            <div class="lifepath-group">
              <h4>Family Crisis</h4>
              <textarea name="attr_lp_familycrisis"></textarea>
            </div>
          </div>
          <div class="column">
            <div class="lifepath-group">
              <h4>Personality</h4>
              <textarea name="attr_lp_personality"></textarea>
            </div>
            <div class="lifepath-group">
              <h4>Hairstyle</h4>
              <textarea name="attr_lp_hairstyle"></textarea>
            </div>
            <div class="lifepath-group">
              <h4>Feelings about people</h4>
              <textarea name="attr_lp_feelingsaboutpeople"></textarea>
            </div>
            <div class="lifepath-group">
              <h4>Most valued possession</h4>
              <textarea name="attr_lp_mostvaluedpossession"></textarea>
            </div>
            <div class="lifepath-group">
              <h4>Childhood environment</h4>
              <textarea name="attr_lp_childhoodenv"></textarea>
            </div>
            <div class="lifepath-group">
              <h4>Life Goals</h4>
              <textarea name="attr_lp_lifegoals"></textarea>
            </div>
          </div>
        </div>
        <div class="columns">
          <div class="column">
            <h4 class="accent-font">Friends</h4>
            <fieldset class="repeating_friends">
              <textarea name="attr_lp_friend"></textarea>
            </fieldset>
          </div>
          <div class="column">
            <h4 class="accent-font">Tragic Love Affairs</h4>
            <fieldset class="repeating_loveaffairs">
              <textarea name="attr_lp_loveaffair"></textarea>
            </fieldset>
          </div>
        </div>
        <div>
          <h4>Enemies</h4>
          <div class="columns enemy-headers">
            <div class="column">Who are they?</div>
            <div class="column">What caused it?</div>
            <div class="column">What can they throw at you?</div>
            <div class="column">What's gonna happen?</div>
          </div>
          <fieldset class="repeating_enemies">
            <div class="enemy">
              <div class="columns">
                <div class="column">
                  <textarea name="attr_lp_enemywho"></textarea>
                </div>
                <div class="column">
                  <textarea name="attr_lp_enemycause"></textarea>
                </div>
                <div class="column">
                  <textarea name="attr_lp_enemythrow"></textarea>
                </div>
                <div class="column">
                  <textarea name="attr_lp_enemyhappen"></textarea>
                </div>
              </div>
            </div>
          </fieldset>
        </div>
      </div>
    </div>
  </div>

  <!-- The "modifiers" component is included twice but only needs one set of JS -->
  <script type="text/worker">
    /**
     * Convert from Roll20's handling of checkbox values to
     * Boolean values for control flows.
     */
    function getCheckboxAsBoolean(val) {
      // Additional logic to handle the custommod and luckmod fields
      if (Number(val) && Number(val) !== 0) {
        return true;
      }
      return val === 'on' ? true : false;
    }
    /**
     * A list of modifiers that we can iterate through with a
     * name that matches an ATTR value stored by the sheet and
     * the actual numerical modifier to be applied to die rolls.
     */
    function modifiersList() {
      return [
        { name: 'nightorlowlight', value: -1 },
        { name: 'neverdonebefore', value: -1 },
        { name: 'complextask', value: -2 },
        { name: 'wrongtoolsorparts', value: -2 },
        { name: 'understress', value: -2 },
        { name: 'drunkdrugged', value: -4 },
        { name: 'secretly', value: -4 },
        { name: 'obscured', value: -4 },
        { name: 'damageserious', value: -2 },
        { name: 'damagemortal', value: -4 },
        { name: 'lostfacedown', value: -2 },
        { name: 'complimentaryskill', value: 1 },
        { name: 'extratime', value: 1 },
        { name: 'aimedshot', value: -8 },
        { name: 'luckmod', value: 'luckmod' },
        { name: 'custommod', value: 'custommod' }
      ];
    }
    /**
     * Get modifiers as an array of names as Strings.
     */
    function getModifierNames() {
      var modifiers = modifiersList();
      var modifierNames = [];
      modifiers.forEach((modifier) => {
        modifierNames.push(modifier.name);
      });
      return modifierNames;
    }
    /**
     * Given the namme of a modifier return the numerical modifier
     * to be applied to die rolls.
     */
    function getModifierValueByName(name) {
      // LUCK and CUSTOM are special cases that map directly
      // to attr values stored in the sheet.
      if (name === 'luckmod' || name === 'custommod') {
        getAttrs([name], function (values) {
          return values[name];
        });
      }
      // MOST MODIFIERS are static numbers that have their values
      // stored as part of the data structure in modifiersList().
      var modifiers = modifiersList();
      return modifiers.find((modifier) => modifier.name === name).value;
    }
    /**
     * Calculate the final modifier...
     */
    function calculateFinalModifier() {
      var calculatedFinalModifier = 0;
      getAttrs(getModifierNames(), function (values) {
        for (var [key, value] of Object.entries(values)) {
          if (getCheckboxAsBoolean(value)) {
            if (key === 'luckmod' || key === 'custommod') {
              calculatedFinalModifier += Number(values[key]);
            } else {
              calculatedFinalModifier += Number(getModifierValueByName(key));
            }
          }
        }
        if (calculatedFinalModifier === 0) {
          calculatedFinalModifier = '0';
        }
        setAttrs({
          finalmodifier: calculatedFinalModifier
        });
      });
    }
    // Get the (formatted) list of modifier fields to monitor for changes
    function eventsModifiers() {
      var modifiers = getModifierNames();
      var modifiersList = '';
      modifiers.forEach((modifier) => {
        modifiersList += 'change:' + modifier + ' ';
      });
      return modifiersList;
    }
    /**
     * When a modifier checkbox changes, trigger the re-calculation of
     * the finalmodifier.
     */
    on(eventsModifiers(), function () {
      calculateFinalModifier();
    });
    /**
     * When the finalmodifier changes re-write the display version of
     * the calculated modifier
     */
    on('change:finalmodifier', function () {
      getAttrs(['finalmodifier', 'finalmodifierdisplay'], function (values) {
        var modifier = Number(values.finalmodifier);
        var formattedmodifier = ' ';
        if (modifier > 0) {
          formattedmodifier = '(+' + modifier + ')';
        }
        if (modifier < 0) {
          formattedmodifier = '(' + modifier + ')';
        }
        setAttrs({
          finalmodifierdisplay: formattedmodifier
        });
      });
    });
    /**
     * Single function to reset all modifiers
     */
    function resetAllModifiers() {
      var modifiers = getModifierNames();
      var attrsToSet = {};
      getAttrs(modifiers, function (values) {
        for (var [key, value] of Object.entries(values)) {
          attrsToSet[key] = '0';
        }
        setAttrs(attrsToSet);
      });
    }
    /**
     * Event handler to trigger reset of all modifiers
     */
    on('clicked:resetmodifiers', function () {
      resetAllModifiers();
    });
  </script>

  <!-- Roll templates... -->
  <!-- attack rolls -->
  <rolltemplate class="sheet-rolltemplate-attack">
    <div class="cpredroll">
      <h4>{{ charactername }}</h4>
      <h5>Attack</h5>
      <table>
        <tbody>
          <tr>
            <th scope="row">Weapon</th>
            <td>{{ weapon }}</td>
          </tr>
          <!-- Special stuff -->
          {{#specialmodifier}}
          <tr>
            <th scope="row">{{ specialname }}</th>
            <td>{{ specialmodifier }}</td>
          </tr>
          {{/specialmodifier}}
          <!-- modifiers -->
          {{#finalmodifier}}
          <tr>
            <th scope="row">Modifiers</th>
            <td>{{ finalmodifier }}</td>
          </tr>
          {{/finalmodifier}}
        </tbody>
        <tfoot>
          <!-- Roll -->
          <tr class="outcome">
            <th scope="row">Roll</th>
            <td>{{ roll }}</td>
          </tr>
          <!-- CRIT Success -->
          {{#rollWasCrit() roll}}
          <tr class="crit">
            <th scope="row">Critical Success</th>
            <td>Add {{ critroll }} to roll</td>
          </tr>
          {{/rollWasCrit() roll}}
          <!-- CRIT Fail -->
          {{#rollWasFumble() roll}}
          <tr class="crit">
            <th scope="row">Critical Failure</th>
            <td>Subtract {{ critroll }} from roll</td>
          </tr>
          {{/rollWasFumble() roll}} {{#specialrule}}
          <tr class="crit">
            <td colspan="2">{{ specialrule }}</td>
          </tr>
          {{/specialrule}}
        </tfoot>
      </table>
    </div>
  </rolltemplate>

  <!-- basic rolls -->
  <rolltemplate class="sheet-rolltemplate-basic">
    <div class="cpredroll">
      <h4>{{ charactername }}</h4>
      <table>
        <tbody>
          <tr>
            <th scope="row">Rolls {{ dice }}</th>
            <td>{{ roll }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </rolltemplate>

  <!-- damage rolls -->
  <rolltemplate class="sheet-rolltemplate-damage">
    <div class="cpredroll">
      <h4>{{ charactername }}</h4>
      <h5>Damage</h5>
      <table>
        <tbody>
          <tr>
            <th>Weapon</th>
            <td>{{ weaponname }}</td>
          </tr>
          <tr>
            <th>Damage</th>
            <td>{{ weapondamage }}</td>
          </tr>
        </tbody>
        <tfoot>
          <tr>
            <th>Damage</th>
            <td>{{ roll }}</td>
          </tr>
        </tfoot>
      </table>
    </div>
  </rolltemplate>

  <!-- skill rolls -->
  <rolltemplate class="sheet-rolltemplate-skill">
    <div class="cpredroll">
      <h4>{{ charactername }}</h4>
      <h5>Skill Check</h5>
      <table>
        <tbody>
          <!-- skill -->
          <tr>
            <th scope="row">{{ skillname }}</th>
            <td>{{ skillvalue }}</td>
          </tr>
          <!-- stat -->
          <tr>
            <th scope="row">
              <span style="text-transform: uppercase">{{ statname }}</span>
            </th>
            <td>{{ statvalue }}</td>
          </tr>
          <!-- Special stuff -->
          {{#specialmodifier}}
          <tr>
            <th scope="row">{{ specialname }}</th>
            <td>{{ specialmodifier }}</td>
          </tr>
          {{/specialmodifier}}
          <!-- modifiers -->
          {{#finalmodifier}}
          <tr>
            <th scope="row">Modifiers</th>
            <td>{{ finalmodifier }}</td>
          </tr>
          {{/finalmodifier}}
        </tbody>
        <tfoot>
          <!-- Roll -->
          <tr class="outcome">
            <th scope="row">Outcome</th>
            <td>{{ roll }}</td>
          </tr>
          <!-- CRIT Success -->
          {{#rollWasCrit() roll}}
          <tr class="crit">
            <th scope="row">Critical Success</th>
            <td>Add {{ critroll }} to roll</td>
          </tr>
          {{/rollWasCrit() roll}}
          <!-- CRIT Fail -->
          {{#rollWasFumble() roll}}
          <tr class="crit">
            <th scope="row">Critical Failure</th>
            <td>Subtract {{ critroll }} from roll</td>
          </tr>
          {{/rollWasFumble() roll}}
        </tfoot>
      </table>
    </div>
  </rolltemplate>

  <!-- death saves -->
  <rolltemplate class="sheet-rolltemplate-deathsave">
    <div class="cpredroll">
      <h4>{{ charactername }}</h4>
      <h5>Death Save</h5>
      <table>
        <tbody>
          <tr>
            <th scope="row">Target</th>
            <td>Below {{ target }}</td>
          </tr>
          <tr>
            <th scope="row">Roll</th>
            <td>{{ roll }}</td>
          </tr>
        </tbody>
        <tfoot>
          <tr>
            <td colspan="2">
              <strong
                >Add 1 to the roll for each Death Save made after the initial
                save.</strong
              >
              <br />See full rules for Death Saves on p.188.
            </td>
          </tr>
        </tfoot>
      </table>
    </div>
  </rolltemplate>

  <!-- role abilities -->
  <rolltemplate class="sheet-rolltemplate-roleability">
    <div class="cpredroll">
      <h4>{{ charactername }}</h4>
      <table>
        <tbody>
          <tr>
            <th scope="row">Role</th>
            <td>{{ rolename }}</td>
          </tr>
          <tr>
            <th scope="row">Role Ability</th>
            <td>{{ abilityname }}</td>
          </tr>
        </tbody>
        <tfoot>
          <!-- Roll -->
          <tr class="outcome">
            <th scope="row">Outcome</th>
            <td>{{ roll }}</td>
          </tr>
          <!-- CRIT Success -->
          {{#rollWasCrit() roll}}
          <tr class="crit">
            <th scope="row">Critical Success</th>
            <td>Add {{ critroll }} to roll</td>
          </tr>
          {{/rollWasCrit() roll}}
          <!-- CRIT Fail -->
          {{#rollWasFumble() roll}}
          <tr class="crit">
            <th scope="row">Critical Failure</th>
            <td>Subtract {{ critroll }} from roll</td>
          </tr>
          {{/rollWasFumble() roll}}
        </tfoot>
      </table>
    </div>
  </rolltemplate>

  <!-- fallback super minimal option -->
  <rolltemplate class="sheet-rolltemplate-minimal">
    <div class="cpredroll">
      <h4>{{ charactername }}</h4>
      <table>
        <tbody>
          <tr>
            <th scope="row">{{ label }}</th>
            <td>{{ roll }}</td>
          </tr>
        </tbody>
        {{#message}}
        <tfoot>
          <tr>
            <td colspan="2">{{ message }}</td>
          </tr>
        </tfoot>
        {{/message}}
      </table>
    </div>
  </rolltemplate>

  <!-- initiative -->
  <rolltemplate class="sheet-rolltemplate-initiative">
    <div class="cpredroll">
      <h4>{{ charactername }}</h4>
      <table>
        <tbody>
          <tr>
            <th scope="row">Initiative</th>
            <td>{{ roll }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </rolltemplate>
</div>




