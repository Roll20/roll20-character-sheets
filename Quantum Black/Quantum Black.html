<div>
    
</div>
<input type="hidden" class="sheet-tabstoggle" name="attr_sheetTab"  value="character"  />

<div class="sheet-character">
	
	
	<div class="sheet-char-tools">
		<div class="sheet-icon">&nbsp;</div>
		<div style="flex-grow:1;">&nbsp;</div>
		<div class="sheet-rollmod">
			<input type="hidden" class="sheet-rollmod-value" name="attr_rollmod">
			<div class="sheet-rollmod-label">Roll Modifier</div>
			<input type="number" name="attr_rollmod" value="0" style="text-align:center;">
		</div>
		<button type="action" name="act_configuration">Configuration</button>
	</div>
	
	<div class="sheet-char-main">
		<div class="sheet-char-left">
			
			<div class="sheet-section-header">Primary Attributes</div>

			<div class="sheet-stat-grid">
				<button type="roll" name="roll_body" 
					value="&{template:skill} {{name=@{character_name}}} {{skill=Body}} {{result=[[(2*@{body}+@{rollmod})d6cf<0cs>7>4]]}}">
					Body
				</button>					
				<span class="sheet-stat-value" name="attr_body">0</span>
				<button type="roll" name="roll_charisma" 
					value="&{template:skill} {{name=@{character_name}}} {{skill=Charisma}} {{result=[[(2*@{charisma}+@{rollmod})d6cf<0cs>7>4]]}}">
					Charisma
				</button>
				<span class="sheet-stat-value" name="attr_charisma">0</span>

				<button type="roll" name="roll_dexterity" 
					value="&{template:skill} {{name=@{character_name}}} {{skill=Dexterity}} {{result=[[(2*@{dexterity}+@{rollmod})d6cf<0cs>7>4]]}}">
					Dexterity
				</button>					
				<span class="sheet-stat-value" name="attr_dexterity">0</span>
				<button type="roll" name="roll_intelligence" 
					value="&{template:skill} {{name=@{character_name}}} {{skill=Intelligence}} {{result=[[(2*@{intelligence}+@{rollmod})d6cf<0cs>7>4]]}}">
					Intelligence
				</button>
				<span class="sheet-stat-value" name="attr_intelligence">0</span>

				<button type="roll" name="roll_strength" 
					value="&{template:skill} {{name=@{character_name}}} {{skill=Strength}} {{result=[[(2*@{strength}+@{rollmod})d6cf<0cs>7>4]]}}">
					Strength
				</button>					
				<span class="sheet-stat-value" name="attr_strength">0</span>
				<button type="roll" name="roll_willpower" 
					value="&{template:skill} {{name=@{character_name}}} {{skill=Willpower}} {{result=[[(2*@{willpower}+@{rollmod})d6cf<0cs>7>4]]}}">
					Willpower
				</button>
				<span class="sheet-stat-value" name="attr_willpower">0</span>
			</div>
		
			<div class="sheet-section-header">Secondary Attributes</div>
				
			<div class="sheet-stat-grid">
				<span class="sheet-state-label">Size</span>
				<span class="sheet-stat-value" name="attr_size">0</span>
				<button type="roll" name="roll_initiative" 
					value="&{template:skill} {{name=@{character_name}}} {{skill=Initiative}} {{result=[[(@{initiative}+@{rollmod})d6cf<0cs>7>4]]}}">
					Initiative
				</button>
				<span class="sheet-stat-value" name="attr_initiative">0</span>

				<span class="sheet-stat-label">Move</span>
				<span class="sheet-stat-value" name="attr_move">0</span>
				<button type="roll" name="roll_defense" 
					value="&{template:skill} {{name=@{character_name}}} {{skill=Defense}} {{result=[[(@{defense}+@{rollmod})d6cf<0cs>7>4]]}}">
					Defense
				</button>	
				<span class="sheet-stat-value" name="attr_defense">0</span>

				<button type="roll" name="roll_perception" 
					value="&{template:skill} {{name=@{character_name}}} {{skill=Perception}} {{result=[[(@{perception}+@{rollmod})d6cf<0cs>7>4]]}}">
					Perception
				</button>
				<span class="sheet-stat-value" name="attr_perception">0</span>
				<span class="sheet-state-label">Stun</span>
				<span class="sheet-stat-value" name="attr_stun">0</span>

				<button type="roll" name="roll_resilience" 
					value="&{template:skill} {{name=@{character_name}}} {{skill=Resilience}} {{result=[[(@{resilience}+@{rollmod})d6cf<0cs>7>4]]}}">
					Resilience
				</button>
				<span class="sheet-stat-value" name="attr_resilience">0</span>
			</div>	

			<div class="sheet-section-header">Skills</div>

			<input type="hidden" name="attr_academics_level" class="sheet-skill-level">
			<input type="hidden" name="attr_acrobatics_level" class="sheet-skill-level">
			<input type="hidden" name="attr_administration_level" class="sheet-skill-level">
			<input type="hidden" name="attr_archery_level" class="sheet-skill-level">
			<input type="hidden" name="attr_art_level" class="sheet-skill-level">
			<input type="hidden" name="attr_athletics_level" class="sheet-skill-level">
			<input type="hidden" name="attr_brawl_level" class="sheet-skill-level">
			<input type="hidden" name="attr_computers_level" class="sheet-skill-level">
			<input type="hidden" name="attr_con_level" class="sheet-skill-level">
			<input type="hidden" name="attr_craft_level" class="sheet-skill-level">
			<input type="hidden" name="attr_demolitions_level" class="sheet-skill-level">
			<input type="hidden" name="attr_diplomacy_level" class="sheet-skill-level">
			<input type="hidden" name="attr_drive_level" class="sheet-skill-level">
			<input type="hidden" name="attr_electronics_level" class="sheet-skill-level">
			<input type="hidden" name="attr_empathy_level" class="sheet-skill-level">
			<input type="hidden" name="attr_firearms_level" class="sheet-skill-level">
			<input type="hidden" name="attr_gambling_level" class="sheet-skill-level">
			<input type="hidden" name="attr_gunnery_level" class="sheet-skill-level">
			<input type="hidden" name="attr_intimidation_level" class="sheet-skill-level">
			<input type="hidden" name="attr_investigation_level" class="sheet-skill-level">
			<input type="hidden" name="attr_larceny_level" class="sheet-skill-level">
			<input type="hidden" name="attr_linguistics_level" class="sheet-skill-level">
			<input type="hidden" name="attr_medicine_level" class="sheet-skill-level">
			<input type="hidden" name="attr_melee_level" class="sheet-skill-level">
			<input type="hidden" name="attr_performance_level" class="sheet-skill-level">
			<input type="hidden" name="attr_pilot_level" class="sheet-skill-level">
			<input type="hidden" name="attr_ride_level" class="sheet-skill-level">
			<input type="hidden" name="attr_ritualmagic_level" class="sheet-skill-level">
			<input type="hidden" name="attr_science_level" class="sheet-skill-level">
			<input type="hidden" name="attr_stealth_level" class="sheet-skill-level">
			<input type="hidden" name="attr_streetwise_level" class="sheet-skill-level">
			<input type="hidden" name="attr_supernaturallore_level" class="sheet-skill-level">
			<input type="hidden" name="attr_survival_level" class="sheet-skill-level">

			<div class="sheet-skill-grid">
				<span class="sheet-skill-header sheet-skill-label">Skill</span>			
				<span class="sheet-skill-header">Base</span>			
				<span class="sheet-skill-header">Levels</span>			
				<span class="sheet-skill-header">Rating</span>			
				<span class="sheet-skill-header">(Avg.)</span>

				<button class="sheet-academics-row sheet-skill-label" type="roll" name="roll_academics" 
					value="&{template:skill} {{name=@{character_name}}} {{skill=Academics*}} {{spec=@{academics_spec}}} {{result=[[(@{academics_rating}+@{rollmod})d6cf<0cs>7>4]]}}">
					Academics*
					<input type="hidden" class="sheet-spec-test" name="attr_academics_spec">
					<span class="sheet-skill-spec"> (<span name="attr_academics_spec"></span>)</span>
				</button>
				<span class="sheet-academics-row sheet-skill-value" name="attr_academics_base"></span>
				<span class="sheet-academics-row sheet-skill-value" name="attr_academics_level"></span>
				<span class="sheet-academics-row sheet-skill-value" name="attr_academics_rating"></span>
				<span class="sheet-academics-row sheet-skill-value">(<button type="roll" name="roll_academicsavg" value="&{template:skill} {{name=@{character_name}}} {{skill=Academics*}} {{spec=@{academics_spec}}} {{result=[[floor((@{academics_rating}+@{rollmod})/2) + ((@{academics_rating}+@{rollmod})%2)d6cf<0cs>7>4]]}}"><span name="attr_academics_avg"></span></button>)</span>

				<span class="sheet-acrobatics-row sheet-skill-label">
					<button type="roll" name="roll_acrobatics" 
						value="&{template:skill} {{name=@{character_name}}} {{skill=Acrobatics}} {{result=[[(@{acrobatics_rating}+@{rollmod})d6cf<0cs>7>4]]}}">
						Acrobatics</button>
					<input type="hidden" class="sheet-spec-test" name="attr_acrobatics_spec">
					<span class="sheet-skill-spec">(<button type="roll" name="roll_acrobaticsspec" value="&{template:skill} {{name=@{character_name}}} {{skill=Acrobatics}} {{spec=@{acrobatics_spec}}} {{result=[[(@{acrobatics_rating}+1+@{rollmod})d6cf<0cs>7>4]]}}"><span name="attr_acrobatics_spec"></span></button>)</span>
				</span>
				<span class="sheet-acrobatics-row sheet-skill-value" name="attr_acrobatics_base"></span>
				<span class="sheet-acrobatics-row sheet-skill-value" name="attr_acrobatics_level"></span>
				<span class="sheet-acrobatics-row sheet-skill-value" name="attr_acrobatics_rating"></span>
				<span class="sheet-acrobatics-row sheet-skill-value">(<button type="roll" name="roll_acrobaticsavg" value="&{template:skill} {{name=@{character_name}}} {{skill=Acrobatics}} {{result=[[floor((@{academics_rating}+@{rollmod})/2) + ((@{academics_rating}+@{rollmod})%2)d6cf<0cs>7>4]]}}"><span name="attr_acrobatics_avg"></span></button>)</span>

				<span class="sheet-administration-row sheet-skill-label">
					<button type="roll" name="roll_administration" 
						value="&{template:skill} {{name=@{character_name}}} {{skill=Administration}} {{result=[[(@{administration_rating}+@{rollmod})d6cf<0cs>7>4]]}}">
						Administration</button>
					<input type="hidden" class="sheet-spec-test" name="attr_administration_spec">
					<span class="sheet-skill-spec">(<button type="roll" name="roll_administrationspec" value="&{template:skill} {{name=@{character_name}}} {{skill=Administration}} {{spec=@{administration_spec}}} {{result=[[(@{administration_rating}+1+@{rollmod})d6cf<0cs>7>4]]}}"><span name="attr_administration_spec"></span></button>)</span>
				</span>
				<span class="sheet-administration-row sheet-skill-value" name="attr_administration_base"></span>
				<span class="sheet-administration-row sheet-skill-value" name="attr_administration_level"></span>
				<span class="sheet-administration-row sheet-skill-value" name="attr_administration_rating"></span>
				<span class="sheet-administration-row sheet-skill-value">(<button type="roll" name="roll_administrationavg" value="&{template:skill} {{name=@{character_name}}} {{skill=Administration}} {{result=[[floor((@{academics_rating}+@{rollmod})/2) + ((@{academics_rating}+@{rollmod})%2)d6cf<0cs>7>4]]}}"><span name="attr_administration_avg"></span></button>)</span>

				<span class="sheet-archery-row sheet-skill-label">
					<button type="roll" name="roll_archery" 
						value="&{template:skill} {{name=@{character_name}}} {{skill=Archery}} {{result=[[(@{archery_rating}+@{rollmod})d6cf<0cs>7>4]]}}">
						Archery</button>
					<input type="hidden" class="sheet-spec-test" name="attr_archery_spec">
					<span class="sheet-skill-spec">(<button type="roll" name="roll_archeryspec" value="&{template:skill} {{name=@{character_name}}} {{skill=Archery}} {{spec=@{archery_spec}}} {{result=[[(@{archery_rating}+1+@{rollmod})d6cf<0cs>7>4]]}}"><span name="attr_archery_spec"></span></button>)</span>
				</span>
				<span class="sheet-archery-row sheet-skill-value" name="attr_archery_base"></span>
				<span class="sheet-archery-row sheet-skill-value" name="attr_archery_level"></span>
				<span class="sheet-archery-row sheet-skill-value" name="attr_archery_rating"></span>
				<span class="sheet-archery-row sheet-skill-value">(<button type="roll" name="roll_archeryavg" value="&{template:skill} {{name=@{character_name}}} {{skill=Archery}} {{result=[[floor((@{academics_rating}+@{rollmod})/2) + ((@{academics_rating}+@{rollmod})%2)d6cf<0cs>7>4]]}}"><span name="attr_archery_avg"></span></button>)</span>

				<button class="sheet-art-row sheet-skill-label" type="roll" name="roll_art" 
					value="&{template:skill} {{name=@{character_name}}} {{skill=Art*}} {{spec=@{art_spec}}} {{result=[[(@{art_rating}+@{rollmod})d6cf<0cs>7>4]]}}">
					Art*
					<input type="hidden" class="sheet-spec-test" name="attr_art_spec">
					<span class="sheet-skill-spec"> (<span name="attr_art_spec"></span>)</span>
				</button>
				<span class="sheet-art-row sheet-skill-value" name="attr_art_base"></span>
				<span class="sheet-art-row sheet-skill-value" name="attr_art_level"></span>
				<span class="sheet-art-row sheet-skill-value" name="attr_art_rating"></span>
				<span class="sheet-art-row sheet-skill-value">(<button type="roll" name="roll_artavg" value="&{template:skill} {{name=@{character_name}}} {{skill=Art*}} {{spec=@{art_spec}}} {{result=[[floor((@{academics_rating}+@{rollmod})/2) + ((@{academics_rating}+@{rollmod})%2)d6cf<0cs>7>4]]}}"><span name="attr_art_avg"></span></button>)</span>

				<span class="sheet-athletics-row sheet-skill-label">
					<button type="roll" name="roll_athletics" 
						value="&{template:skill} {{name=@{character_name}}} {{skill=Athletics}} {{result=[[(@{athletics_rating}+@{rollmod})d6cf<0cs>7>4]]}}">
						Athletics</button>
					<input type="hidden" class="sheet-spec-test" name="attr_athletics_spec">
					<span class="sheet-skill-spec">(<button type="roll" name="roll_athleticsspec" value="&{template:skill} {{name=@{character_name}}} {{skill=Athletics}} {{spec=@{athletics_spec}}} {{result=[[(@{athletics_rating}+1+@{rollmod})d6cf<0cs>7>4]]}}"><span name="attr_athletics_spec"></span></button>)</span>
				</span>
				<span class="sheet-athletics-row sheet-skill-value" name="attr_athletics_base"></span>
				<span class="sheet-athletics-row sheet-skill-value" name="attr_athletics_level"></span>
				<span class="sheet-athletics-row sheet-skill-value" name="attr_athletics_rating"></span>
				<span class="sheet-athletics-row sheet-skill-value">(<button type="roll" name="roll_athleticsavg" value="&{template:skill} {{name=@{character_name}}} {{skill=Athletics}} {{result=[[floor((@{academics_rating}+@{rollmod})/2) + ((@{academics_rating}+@{rollmod})%2)d6cf<0cs>7>4]]}}"><span name="attr_athletics_avg"></span></button>)</span>

				<span class="sheet-brawl-row sheet-skill-label">
					<button type="roll" name="roll_brawl" 
						value="&{template:skill} {{name=@{character_name}}} {{skill=Brawl}} {{result=[[(@{brawl_rating}+@{rollmod})d6cf<0cs>7>4]]}}">
						Brawl</button>
					<input type="hidden" class="sheet-spec-test" name="attr_brawl_spec">
					<span class="sheet-skill-spec">(<button type="roll" name="roll_brawlspec" value="&{template:skill} {{name=@{character_name}}} {{skill=Brawl}} {{spec=@{brawl_spec}}} {{result=[[(@{brawl_rating}+1+@{rollmod})d6cf<0cs>7>4]]}}"><span name="attr_brawl_spec"></span></button>)</span>
				</span>
				<span class="sheet-brawl-row sheet-skill-value" name="attr_brawl_base"></span>
				<span class="sheet-brawl-row sheet-skill-value" name="attr_brawl_level"></span>
				<span class="sheet-brawl-row sheet-skill-value" name="attr_brawl_rating"></span>
				<span class="sheet-brawl-row sheet-skill-value">(<button type="roll" name="roll_brawlavg" value="&{template:skill} {{name=@{character_name}}} {{skill=Brawl}} {{result=[[floor((@{academics_rating}+@{rollmod})/2) + ((@{academics_rating}+@{rollmod})%2)d6cf<0cs>7>4]]}}"><span name="attr_brawl_avg"></span></button>)</span>

				<span class="sheet-computers-row sheet-skill-label">
					<button type="roll" name="roll_computers" 
						value="&{template:skill} {{name=@{character_name}}} {{skill=Computers}} {{result=[[(@{computers_rating}+@{rollmod})d6cf<0cs>7>4]]}}">
						Computers</button>
					<input type="hidden" class="sheet-spec-test" name="attr_computers_spec">
					<span class="sheet-skill-spec">(<button type="roll" name="roll_computersspec" value="&{template:skill} {{name=@{character_name}}} {{skill=Computers}} {{spec=@{computers_spec}}} {{result=[[(@{computers_rating}+1+@{rollmod})d6cf<0cs>7>4]]}}"><span name="attr_computers_spec"></span></button>)</span>
				</span>
				<span class="sheet-computers-row sheet-skill-value" name="attr_computers_base"></span>
				<span class="sheet-computers-row sheet-skill-value" name="attr_computers_level"></span>
				<span class="sheet-computers-row sheet-skill-value" name="attr_computers_rating"></span>
				<span class="sheet-computers-row sheet-skill-value">(<button type="roll" name="roll_computersavg" value="&{template:skill} {{name=@{character_name}}} {{skill=Computers}} {{result=[[floor((@{academics_rating}+@{rollmod})/2) + ((@{academics_rating}+@{rollmod})%2)d6cf<0cs>7>4]]}}"><span name="attr_computers_avg"></span></button>)</span>

				<span class="sheet-con-row sheet-skill-label">
					<button type="roll" name="roll_con" 
						value="&{template:skill} {{name=@{character_name}}} {{skill=Con}} {{result=[[(@{con_rating}+@{rollmod})d6cf<0cs>7>4]]}}">
						Con</button>
					<input type="hidden" class="sheet-spec-test" name="attr_con_spec">
					<span class="sheet-skill-spec">(<button type="roll" name="roll_conspec" value="&{template:skill} {{name=@{character_name}}} {{skill=Con}} {{spec=@{con_spec}}} {{result=[[(@{con_rating}+1+@{rollmod})d6cf<0cs>7>4]]}}"><span name="attr_con_spec"></span></button>)</span>
				</span>
				<span class="sheet-con-row sheet-skill-value" name="attr_con_base"></span>
				<span class="sheet-con-row sheet-skill-value" name="attr_con_level"></span>
				<span class="sheet-con-row sheet-skill-value" name="attr_con_rating"></span>
				<span class="sheet-con-row sheet-skill-value">(<button type="roll" name="roll_conavg" value="&{template:skill} {{name=@{character_name}}} {{skill=Con}} {{result=[[floor((@{academics_rating}+@{rollmod})/2) + ((@{academics_rating}+@{rollmod})%2)d6cf<0cs>7>4]]}}"><span name="attr_con_avg"></span></button>)</span>

				<button class="sheet-craft-row sheet-skill-label" type="roll" name="roll_craft" 
					value="&{template:skill} {{name=@{character_name}}} {{skill=Craft*}} {{spec=@{craft_spec}}} {{result=[[(@{craft_rating}+@{rollmod})d6cf<0cs>7>4]]}}">
					Craft*
					<input type="hidden" class="sheet-spec-test" name="attr_craft_spec">
					<span class="sheet-skill-spec"> (<span name="attr_craft_spec"></span>)</span>
				</button>
				<span class="sheet-craft-row sheet-skill-value" name="attr_craft_base"></span>
				<span class="sheet-craft-row sheet-skill-value" name="attr_craft_level"></span>
				<span class="sheet-craft-row sheet-skill-value" name="attr_craft_rating"></span>
				<span class="sheet-craft-row sheet-skill-value">(<button type="roll" name="roll_craftavg" value="&{template:skill} {{name=@{character_name}}} {{skill=Craft*}} {{spec=@{craft_spec}}} {{result=[[floor((@{academics_rating}+@{rollmod})/2) + ((@{academics_rating}+@{rollmod})%2)d6cf<0cs>7>4]]}}"><span name="attr_craft_avg"></span></button>)</span>

				<span class="sheet-demolitions-row sheet-skill-label">
					<button type="roll" name="roll_demolitions" 
						value="&{template:skill} {{name=@{character_name}}} {{skill=Demolitions}} {{result=[[(@{demolitions_rating}+@{rollmod})d6cf<0cs>7>4]]}}">
						Demolitions</button>
					<input type="hidden" class="sheet-spec-test" name="attr_demolitions_spec">
					<span class="sheet-skill-spec">(<button type="roll" name="roll_demolitionsspec" value="&{template:skill} {{name=@{character_name}}} {{skill=Demolitions}} {{spec=@{demolitions_spec}}} {{result=[[(@{demolitions_rating}+1+@{rollmod})d6cf<0cs>7>4]]}}"><span name="attr_demolitions_spec"></span></button>)</span>
				</span>
				<span class="sheet-demolitions-row sheet-skill-value" name="attr_demolitions_base"></span>
				<span class="sheet-demolitions-row sheet-skill-value" name="attr_demolitions_level"></span>
				<span class="sheet-demolitions-row sheet-skill-value" name="attr_demolitions_rating"></span>
				<span class="sheet-demolitions-row sheet-skill-value">(<button type="roll" name="roll_demolitionsavg" value="&{template:skill} {{name=@{character_name}}} {{skill=Demolitions}} {{result=[[floor((@{academics_rating}+@{rollmod})/2) + ((@{academics_rating}+@{rollmod})%2)d6cf<0cs>7>4]]}}"><span name="attr_demolitions_avg"></span></button>)</span>

				<span class="sheet-diplomacy-row sheet-skill-label">
					<button type="roll" name="roll_diplomacy" 
						value="&{template:skill} {{name=@{character_name}}} {{skill=Diplomacy}} {{result=[[(@{diplomacy_rating}+@{rollmod})d6cf<0cs>7>4]]}}">
						Diplomacy</button>
					<input type="hidden" class="sheet-spec-test" name="attr_diplomacy_spec">
					<span class="sheet-skill-spec">(<button type="roll" name="roll_diplomacyspec" value="&{template:skill} {{name=@{character_name}}} {{skill=Diplomacy}} {{spec=@{diplomacy_spec}}} {{result=[[(@{diplomacy_rating}+1+@{rollmod})d6cf<0cs>7>4]]}}"><span name="attr_diplomacy_spec"></span></button>)</span>
				</span>
				<span class="sheet-diplomacy-row sheet-skill-value" name="attr_diplomacy_base"></span>
				<span class="sheet-diplomacy-row sheet-skill-value" name="attr_diplomacy_level"></span>
				<span class="sheet-diplomacy-row sheet-skill-value" name="attr_diplomacy_rating"></span>
				<span class="sheet-diplomacy-row sheet-skill-value">(<button type="roll" name="roll_diplomacyavg" value="&{template:skill} {{name=@{character_name}}} {{skill=Diplomacy}} {{result=[[floor((@{academics_rating}+@{rollmod})/2) + ((@{academics_rating}+@{rollmod})%2)d6cf<0cs>7>4]]}}"><span name="attr_diplomacy_avg"></span></button>)</span>

				<span class="sheet-drive-row sheet-skill-label">
					<button type="roll" name="roll_drive" 
						value="&{template:skill} {{name=@{character_name}}} {{skill=Drive}} {{result=[[(@{drive_rating}+@{rollmod})d6cf<0cs>7>4]]}}">
						Drive</button>
					<input type="hidden" class="sheet-spec-test" name="attr_drive_spec">
					<span class="sheet-skill-spec">(<button type="roll" name="roll_drivespec" value="&{template:skill} {{name=@{character_name}}} {{skill=Drive}} {{spec=@{drive_spec}}} {{result=[[(@{drive_rating}+1+@{rollmod})d6cf<0cs>7>4]]}}"><span name="attr_drive_spec"></span></button>)</span>
				</span>
				<span class="sheet-drive-row sheet-skill-value" name="attr_drive_base"></span>
				<span class="sheet-drive-row sheet-skill-value" name="attr_drive_level"></span>
				<span class="sheet-drive-row sheet-skill-value" name="attr_drive_rating"></span>
				<span class="sheet-drive-row sheet-skill-value">(<button type="roll" name="roll_driveavg" value="&{template:skill} {{name=@{character_name}}} {{skill=Drive}} {{result=[[floor((@{academics_rating}+@{rollmod})/2) + ((@{academics_rating}+@{rollmod})%2)d6cf<0cs>7>4]]}}"><span name="attr_drive_avg"></span></button>)</span>

				<span class="sheet-electronics-row sheet-skill-label">
					<button type="roll" name="roll_electronics" 
						value="&{template:skill} {{name=@{character_name}}} {{skill=Electronics}} {{result=[[(@{electronics_rating}+@{rollmod})d6cf<0cs>7>4]]}}">
						Electronics</button>
					<input type="hidden" class="sheet-spec-test" name="attr_electronics_spec">
					<span class="sheet-skill-spec">(<button type="roll" name="roll_electronicsspec" value="&{template:skill} {{name=@{character_name}}} {{skill=Electronics}} {{spec=@{electronics_spec}}} {{result=[[(@{electronics_rating}+1+@{rollmod})d6cf<0cs>7>4]]}}"><span name="attr_electronics_spec"></span></button>)</span>
				</span>
				<span class="sheet-electronics-row sheet-skill-value" name="attr_electronics_base"></span>
				<span class="sheet-electronics-row sheet-skill-value" name="attr_electronics_level"></span>
				<span class="sheet-electronics-row sheet-skill-value" name="attr_electronics_rating"></span>
				<span class="sheet-electronics-row sheet-skill-value">(<button type="roll" name="roll_electronicsavg" value="&{template:skill} {{name=@{character_name}}} {{skill=Electronics}} {{result=[[floor((@{academics_rating}+@{rollmod})/2) + ((@{academics_rating}+@{rollmod})%2)d6cf<0cs>7>4]]}}"><span name="attr_electronics_avg"></span></button>)</span>

				<span class="sheet-empathy-row sheet-skill-label">
					<button type="roll" name="roll_empathy" 
						value="&{template:skill} {{name=@{character_name}}} {{skill=Empathy}} {{result=[[(@{empathy_rating}+@{rollmod})d6cf<0cs>7>4]]}}">
						Empathy</button>
					<input type="hidden" class="sheet-spec-test" name="attr_empathy_spec">
					<span class="sheet-skill-spec">(<button type="roll" name="roll_empathyspec" value="&{template:skill} {{name=@{character_name}}} {{skill=Empathy}} {{spec=@{empathy_spec}}} {{result=[[(@{empathy_rating}+1+@{rollmod})d6cf<0cs>7>4]]}}"><span name="attr_empathy_spec"></span></button>)</span>
				</span>
				<span class="sheet-empathy-row sheet-skill-value" name="attr_empathy_base"></span>
				<span class="sheet-empathy-row sheet-skill-value" name="attr_empathy_level"></span>
				<span class="sheet-empathy-row sheet-skill-value" name="attr_empathy_rating"></span>
				<span class="sheet-empathy-row sheet-skill-value">(<button type="roll" name="roll_empathyavg" value="&{template:skill} {{name=@{character_name}}} {{skill=Empathy}} {{result=[[floor((@{academics_rating}+@{rollmod})/2) + ((@{academics_rating}+@{rollmod})%2)d6cf<0cs>7>4]]}}"><span name="attr_empathy_avg"></span></button>)</span>

				<span class="sheet-firearms-row sheet-skill-label">
					<button type="roll" name="roll_firearms" 
						value="&{template:skill} {{name=@{character_name}}} {{skill=Firearms}} {{result=[[(@{firearms_rating}+@{rollmod})d6cf<0cs>7>4]]}}">
						Firearms</button>
					<input type="hidden" class="sheet-spec-test" name="attr_firearms_spec">
					<span class="sheet-skill-spec">(<button type="roll" name="roll_firearmsspec" value="&{template:skill} {{name=@{character_name}}} {{skill=Firearms}} {{spec=@{firearms_spec}}} {{result=[[(@{firearms_rating}+1+@{rollmod})d6cf<0cs>7>4]]}}"><span name="attr_firearms_spec"></span></button>)</span>
				</span>
				<span class="sheet-firearms-row sheet-skill-value" name="attr_firearms_base"></span>
				<span class="sheet-firearms-row sheet-skill-value" name="attr_firearms_level"></span>
				<span class="sheet-firearms-row sheet-skill-value" name="attr_firearms_rating"></span>
				<span class="sheet-firearms-row sheet-skill-value">(<button type="roll" name="roll_firearmsavg" value="&{template:skill} {{name=@{character_name}}} {{skill=Firearms}} {{result=[[floor((@{academics_rating}+@{rollmod})/2) + ((@{academics_rating}+@{rollmod})%2)d6cf<0cs>7>4]]}}"><span name="attr_firearms_avg"></span></button>)</span>

				<span class="sheet-gambling-row sheet-skill-label">
					<button type="roll" name="roll_gambling" 
						value="&{template:skill} {{name=@{character_name}}} {{skill=Gambling}} {{result=[[(@{gambling_rating}+@{rollmod})d6cf<0cs>7>4]]}}">
						Gambling</button>
					<input type="hidden" class="sheet-spec-test" name="attr_gambling_spec">
					<span class="sheet-skill-spec">(<button type="roll" name="roll_gamblingspec" value="&{template:skill} {{name=@{character_name}}} {{skill=Gambling}} {{spec=@{gambling_spec}}} {{result=[[(@{gambling_rating}+1+@{rollmod})d6cf<0cs>7>4]]}}"><span name="attr_gambling_spec"></span></button>)</span>
				</span>
				<span class="sheet-gambling-row sheet-skill-value" name="attr_gambling_base"></span>
				<span class="sheet-gambling-row sheet-skill-value" name="attr_gambling_level"></span>
				<span class="sheet-gambling-row sheet-skill-value" name="attr_gambling_rating"></span>
				<span class="sheet-gambling-row sheet-skill-value">(<button type="roll" name="roll_gamblingavg" value="&{template:skill} {{name=@{character_name}}} {{skill=Gambling}} {{result=[[floor((@{academics_rating}+@{rollmod})/2) + ((@{academics_rating}+@{rollmod})%2)d6cf<0cs>7>4]]}}"><span name="attr_gambling_avg"></span></button>)</span>

				<span class="sheet-gunnery-row sheet-skill-label">
					<button type="roll" name="roll_gunnery" 
						value="&{template:skill} {{name=@{character_name}}} {{skill=Gunnery}} {{result=[[(@{gunnery_rating}+@{rollmod})d6cf<0cs>7>4]]}}">
						Gunnery</button>
					<input type="hidden" class="sheet-spec-test" name="attr_gunnery_spec">
					<span class="sheet-skill-spec">(<button type="roll" name="roll_gunneryspec" value="&{template:skill} {{name=@{character_name}}} {{skill=Gunnery}} {{spec=@{gunnery_spec}}} {{result=[[(@{gunnery_rating}+1+@{rollmod})d6cf<0cs>7>4]]}}"><span name="attr_gunnery_spec"></span></button>)</span>
				</span>
				<span class="sheet-gunnery-row sheet-skill-value" name="attr_gunnery_base"></span>
				<span class="sheet-gunnery-row sheet-skill-value" name="attr_gunnery_level"></span>
				<span class="sheet-gunnery-row sheet-skill-value" name="attr_gunnery_rating"></span>
				<span class="sheet-gunnery-row sheet-skill-value">(<button type="roll" name="roll_gunneryavg" value="&{template:skill} {{name=@{character_name}}} {{skill=Gunnery}} {{result=[[floor((@{academics_rating}+@{rollmod})/2) + ((@{academics_rating}+@{rollmod})%2)d6cf<0cs>7>4]]}}"><span name="attr_gunnery_avg"></span></button>)</span>

				<span class="sheet-intimidation-row sheet-skill-label">
					<button type="roll" name="roll_intimidation" 
						value="&{template:skill} {{name=@{character_name}}} {{skill=Intimidation}} {{result=[[(@{intimidation_rating}+@{rollmod})d6cf<0cs>7>4]]}}">
						Intimidation</button>
					<input type="hidden" class="sheet-spec-test" name="attr_intimidation_spec">
					<span class="sheet-skill-spec">(<button type="roll" name="roll_intimidationspec" value="&{template:skill} {{name=@{character_name}}} {{skill=Intimidation}} {{spec=@{intimidation_spec}}} {{result=[[(@{intimidation_rating}+1+@{rollmod})d6cf<0cs>7>4]]}}"><span name="attr_intimidation_spec"></span></button>)</span>
				</span>
				<span class="sheet-intimidation-row sheet-skill-value" name="attr_intimidation_base"></span>
				<span class="sheet-intimidation-row sheet-skill-value" name="attr_intimidation_level"></span>
				<span class="sheet-intimidation-row sheet-skill-value" name="attr_intimidation_rating"></span>
				<span class="sheet-intimidation-row sheet-skill-value">(<button type="roll" name="roll_intimidationavg" value="&{template:skill} {{name=@{character_name}}} {{skill=Intimidation}} {{result=[[floor((@{academics_rating}+@{rollmod})/2) + ((@{academics_rating}+@{rollmod})%2)d6cf<0cs>7>4]]}}"><span name="attr_intimidation_avg"></span></button>)</span>

				<span class="sheet-investigation-row sheet-skill-label">
					<button type="roll" name="roll_investigation" 
						value="&{template:skill} {{name=@{character_name}}} {{skill=Investigation}} {{result=[[(@{investigation_rating}+@{rollmod})d6cf<0cs>7>4]]}}">
						Investigation</button>
					<input type="hidden" class="sheet-spec-test" name="attr_investigation_spec">
					<span class="sheet-skill-spec">(<button type="roll" name="roll_investigationspec" value="&{template:skill} {{name=@{character_name}}} {{skill=Investigation}} {{spec=@{investigation_spec}}} {{result=[[(@{investigation_rating}+1+@{rollmod})d6cf<0cs>7>4]]}}"><span name="attr_investigation_spec"></span></button>)</span>
				</span>
				<span class="sheet-investigation-row sheet-skill-value" name="attr_investigation_base"></span>
				<span class="sheet-investigation-row sheet-skill-value" name="attr_investigation_level"></span>
				<span class="sheet-investigation-row sheet-skill-value" name="attr_investigation_rating"></span>
				<span class="sheet-investigation-row sheet-skill-value">(<button type="roll" name="roll_investigationavg" value="&{template:skill} {{name=@{character_name}}} {{skill=Investigation}} {{result=[[floor((@{academics_rating}+@{rollmod})/2) + ((@{academics_rating}+@{rollmod})%2)d6cf<0cs>7>4]]}}"><span name="attr_investigation_avg"></span></button>)</span>

				<span class="sheet-larceny-row sheet-skill-label">
					<button type="roll" name="roll_larceny" 
						value="&{template:skill} {{name=@{character_name}}} {{skill=Larceny}} {{result=[[(@{larceny_rating}+@{rollmod})d6cf<0cs>7>4]]}}">
						Larceny</button>
					<input type="hidden" class="sheet-spec-test" name="attr_larceny_spec">
					<span class="sheet-skill-spec">(<button type="roll" name="roll_larcenyspec" value="&{template:skill} {{name=@{character_name}}} {{skill=Larceny}} {{spec=@{larceny_spec}}} {{result=[[(@{larceny_rating}+1+@{rollmod})d6cf<0cs>7>4]]}}"><span name="attr_larceny_spec"></span></button>)</span>
				</span>
				<span class="sheet-larceny-row sheet-skill-value" name="attr_larceny_base"></span>
				<span class="sheet-larceny-row sheet-skill-value" name="attr_larceny_level"></span>
				<span class="sheet-larceny-row sheet-skill-value" name="attr_larceny_rating"></span>
				<span class="sheet-larceny-row sheet-skill-value">(<button type="roll" name="roll_larcenyavg" value="&{template:skill} {{name=@{character_name}}} {{skill=Larceny}} {{result=[[floor((@{academics_rating}+@{rollmod})/2) + ((@{academics_rating}+@{rollmod})%2)d6cf<0cs>7>4]]}}"><span name="attr_larceny_avg"></span></button>)</span>

				<span class="sheet-linguistics-row sheet-skill-label">
					<button type="roll" name="roll_linguistics" 
						value="&{template:skill} {{name=@{character_name}}} {{skill=Linguistics}} {{result=[[(@{linguistics_rating}+@{rollmod})d6cf<0cs>7>4]]}}">
						Linguistics</button>
					<input type="hidden" class="sheet-spec-test" name="attr_linguistics_spec">
					<span class="sheet-skill-spec">(<button type="roll" name="roll_linguisticsspec" value="&{template:skill} {{name=@{character_name}}} {{skill=Linguistics}} {{spec=@{linguistics_spec}}} {{result=[[(@{linguistics_rating}+1+@{rollmod})d6cf<0cs>7>4]]}}"><span name="attr_linguistics_spec"></span></button>)</span>
				</span>
				<span class="sheet-linguistics-row sheet-skill-value" name="attr_linguistics_base"></span>
				<span class="sheet-linguistics-row sheet-skill-value" name="attr_linguistics_level"></span>
				<span class="sheet-linguistics-row sheet-skill-value" name="attr_linguistics_rating"></span>
				<span class="sheet-linguistics-row sheet-skill-value">(<button type="roll" name="roll_linguisticsavg" value="&{template:skill} {{name=@{character_name}}} {{skill=Linguistics}} {{result=[[floor((@{academics_rating}+@{rollmod})/2) + ((@{academics_rating}+@{rollmod})%2)d6cf<0cs>7>4]]}}"><span name="attr_linguistics_avg"></span></button>)</span>

				<span class="sheet-medicine-row sheet-skill-label">
					<button type="roll" name="roll_medicine" 
						value="&{template:skill} {{name=@{character_name}}} {{skill=Medicine}} {{result=[[(@{medicine_rating}+@{rollmod})d6cf<0cs>7>4]]}}">
						Medicine</button>
					<input type="hidden" class="sheet-spec-test" name="attr_medicine_spec">
					<span class="sheet-skill-spec">(<button type="roll" name="roll_medicinespec" value="&{template:skill} {{name=@{character_name}}} {{skill=Medicine}} {{spec=@{medicine_spec}}} {{result=[[(@{medicine_rating}+1+@{rollmod})d6cf<0cs>7>4]]}}"><span name="attr_medicine_spec"></span></button>)</span>
				</span>
				<span class="sheet-medicine-row sheet-skill-value" name="attr_medicine_base"></span>
				<span class="sheet-medicine-row sheet-skill-value" name="attr_medicine_level"></span>
				<span class="sheet-medicine-row sheet-skill-value" name="attr_medicine_rating"></span>
				<span class="sheet-medicine-row sheet-skill-value">(<button type="roll" name="roll_medicineavg" value="&{template:skill} {{name=@{character_name}}} {{skill=Medicine}} {{result=[[floor((@{academics_rating}+@{rollmod})/2) + ((@{academics_rating}+@{rollmod})%2)d6cf<0cs>7>4]]}}"><span name="attr_medicine_avg"></span></button>)</span>

				<span class="sheet-melee-row sheet-skill-label">
					<button type="roll" name="roll_melee" 
						value="&{template:skill} {{name=@{character_name}}} {{skill=Melee}} {{result=[[(@{melee_rating}+@{rollmod})d6cf<0cs>7>4]]}}">
						Melee</button>
					<input type="hidden" class="sheet-spec-test" name="attr_melee_spec">
					<span class="sheet-skill-spec">(<button type="roll" name="roll_meleespec" value="&{template:skill} {{name=@{character_name}}} {{skill=Melee}} {{spec=@{melee_spec}}} {{result=[[(@{melee_rating}+1+@{rollmod})d6cf<0cs>7>4]]}}"><span name="attr_melee_spec"></span></button>)</span>
				</span>
				<span class="sheet-melee-row sheet-skill-value" name="attr_melee_base"></span>
				<span class="sheet-melee-row sheet-skill-value" name="attr_melee_level"></span>
				<span class="sheet-melee-row sheet-skill-value" name="attr_melee_rating"></span>
				<span class="sheet-melee-row sheet-skill-value">(<button type="roll" name="roll_meleeavg" value="&{template:skill} {{name=@{character_name}}} {{skill=Melee}} {{result=[[floor((@{academics_rating}+@{rollmod})/2) + ((@{academics_rating}+@{rollmod})%2)d6cf<0cs>7>4]]}}"><span name="attr_melee_avg"></span></button>)</span>

				<button class="sheet-performance-row sheet-skill-label" type="roll" name="roll_performance" 
					value="&{template:skill} {{name=@{character_name}}} {{skill=Performance*}} {{spec=@{performance_spec}}} {{result=[[(@{performance_rating}+@{rollmod})d6cf<0cs>7>4]]}}">
					Performance*
					<input type="hidden" class="sheet-spec-test" name="attr_performance_spec">
					<span class="sheet-skill-spec"> (<span name="attr_performance_spec"></span>)</span>
				</button>
				<span class="sheet-performance-row sheet-skill-value" name="attr_performance_base"></span>
				<span class="sheet-performance-row sheet-skill-value" name="attr_performance_level"></span>
				<span class="sheet-performance-row sheet-skill-value" name="attr_performance_rating"></span>
				<span class="sheet-performance-row sheet-skill-value">(<button type="roll" name="roll_performanceavg" value="&{template:skill} {{name=@{character_name}}} {{skill=Performance*}} {{spec=@{performance_spec}}} {{result=[[floor((@{academics_rating}+@{rollmod})/2) + ((@{academics_rating}+@{rollmod})%2)d6cf<0cs>7>4]]}}"><span name="attr_performance_avg"></span></button>)</span>

				<button class="sheet-pilot-row sheet-skill-label" type="roll" name="roll_pilot" 
					value="&{template:skill} {{name=@{character_name}}} {{skill=Pilot*}} {{spec=@{pilot_spec}}} {{result=[[(@{pilot_rating}+@{rollmod})d6cf<0cs>7>4]]}}">
					Pilot*
					<input type="hidden" class="sheet-spec-test" name="attr_pilot_spec">
					<span class="sheet-skill-spec"> (<span name="attr_pilot_spec"></span>)</span>
				</button>
				<span class="sheet-pilot-row sheet-skill-value" name="attr_pilot_base"></span>
				<span class="sheet-pilot-row sheet-skill-value" name="attr_pilot_level"></span>
				<span class="sheet-pilot-row sheet-skill-value" name="attr_pilot_rating"></span>
				<span class="sheet-pilot-row sheet-skill-value">(<button type="roll" name="roll_pilotavg" value="&{template:skill} {{name=@{character_name}}} {{skill=Pilot*}} {{spec=@{pilot_spec}}} {{result=[[floor((@{academics_rating}+@{rollmod})/2) + ((@{academics_rating}+@{rollmod})%2)d6cf<0cs>7>4]]}}"><span name="attr_pilot_avg"></span></button>)</span>

				<span class="sheet-ride-row sheet-skill-label">
					<button type="roll" name="roll_ride" 
						value="&{template:skill} {{name=@{character_name}}} {{skill=Ride}} {{result=[[(@{ride_rating}+@{rollmod})d6cf<0cs>7>4]]}}">
						Ride</button>
					<input type="hidden" class="sheet-spec-test" name="attr_ride_spec">
					<span class="sheet-skill-spec">(<button type="roll" name="roll_ridespec" value="&{template:skill} {{name=@{character_name}}} {{skill=Ride}} {{spec=@{ride_spec}}} {{result=[[(@{ride_rating}+1+@{rollmod})d6cf<0cs>7>4]]}}"><span name="attr_ride_spec"></span></button>)</span>
				</span>
				<span class="sheet-ride-row sheet-skill-value" name="attr_ride_base"></span>
				<span class="sheet-ride-row sheet-skill-value" name="attr_ride_level"></span>
				<span class="sheet-ride-row sheet-skill-value" name="attr_ride_rating"></span>
				<span class="sheet-ride-row sheet-skill-value">(<button type="roll" name="roll_rideavg" value="&{template:skill} {{name=@{character_name}}} {{skill=Ride}} {{result=[[floor((@{academics_rating}+@{rollmod})/2) + ((@{academics_rating}+@{rollmod})%2)d6cf<0cs>7>4]]}}"><span name="attr_ride_avg"></span></button>)</span>

				<span class="sheet-ritualmagic-row sheet-skill-label">
					<button type="roll" name="roll_ritualmagic" 
						value="&{template:skill} {{name=@{character_name}}} {{skill=Ritual Magic}} {{result=[[(@{ritualmagic_rating}+@{rollmod})d6cf<0cs>7>4]]}}">
						Ritual Magic</button>
					<input type="hidden" class="sheet-spec-test" name="attr_ritualmagic_spec">
					<span class="sheet-skill-spec">(<button type="roll" name="roll_ritualmagicspec" value="&{template:skill} {{name=@{character_name}}} {{skill=Ritual Magic}} {{spec=@{ritualmagic_spec}}} {{result=[[(@{ritualmagic_rating}+1+@{rollmod})d6cf<0cs>7>4]]}}"><span name="attr_ritualmagic_spec"></span></button>)</span>
				</span>
				<span class="sheet-ritualmagic-row sheet-skill-value" name="attr_ritualmagic_base"></span>
				<span class="sheet-ritualmagic-row sheet-skill-value" name="attr_ritualmagic_level"></span>
				<span class="sheet-ritualmagic-row sheet-skill-value" name="attr_ritualmagic_rating"></span>
				<span class="sheet-ritualmagic-row sheet-skill-value">(<button type="roll" name="roll_ritualmagicavg" value="&{template:skill} {{name=@{character_name}}} {{skill=Ritual Magic}} {{result=[[floor((@{academics_rating}+@{rollmod})/2) + ((@{academics_rating}+@{rollmod})%2)d6cf<0cs>7>4]]}}"><span name="attr_ritualmagic_avg"></span></button>)</span>

				<button class="sheet-science-row sheet-skill-label" type="roll" name="roll_science" 
					value="&{template:skill} {{name=@{character_name}}} {{skill=Science*}} {{spec=@{science_spec}}} {{result=[[(@{science_rating}+@{rollmod})d6cf<0cs>7>4]]}}">
					Science*
					<input type="hidden" class="sheet-spec-test" name="attr_science_spec">
					<span class="sheet-skill-spec"> (<span name="attr_science_spec"></span>)</span>
				</button>
				<span class="sheet-science-row sheet-skill-value" name="attr_science_base"></span>
				<span class="sheet-science-row sheet-skill-value" name="attr_science_level"></span>
				<span class="sheet-science-row sheet-skill-value" name="attr_science_rating"></span>
				<span class="sheet-science-row sheet-skill-value">(<button type="roll" name="roll_scienceavg" value="&{template:skill} {{name=@{character_name}}} {{skill=Science*}} {{spec=@{science_spec}}} {{result=[[floor((@{academics_rating}+@{rollmod})/2) + ((@{academics_rating}+@{rollmod})%2)d6cf<0cs>7>4]]}}"><span name="attr_science_avg"></span></button>)</span>

				<span class="sheet-stealth-row sheet-skill-label">
					<button type="roll" name="roll_stealth" 
						value="&{template:skill} {{name=@{character_name}}} {{skill=Stealth}} {{result=[[(@{stealth_rating}+@{rollmod})d6cf<0cs>7>4]]}}">
						Stealth</button>
					<input type="hidden" class="sheet-spec-test" name="attr_stealth_spec">
					<span class="sheet-skill-spec">(<button type="roll" name="roll_stealthspec" value="&{template:skill} {{name=@{character_name}}} {{skill=Stealth}} {{spec=@{stealth_spec}}} {{result=[[(@{stealth_rating}+1+@{rollmod})d6cf<0cs>7>4]]}}"><span name="attr_stealth_spec"></span></button>)</span>
				</span>
				<span class="sheet-stealth-row sheet-skill-value" name="attr_stealth_base"></span>
				<span class="sheet-stealth-row sheet-skill-value" name="attr_stealth_level"></span>
				<span class="sheet-stealth-row sheet-skill-value" name="attr_stealth_rating"></span>
				<span class="sheet-stealth-row sheet-skill-value">(<button type="roll" name="roll_stealthavg" value="&{template:skill} {{name=@{character_name}}} {{skill=Stealth}} {{result=[[floor((@{academics_rating}+@{rollmod})/2) + ((@{academics_rating}+@{rollmod})%2)d6cf<0cs>7>4]]}}"><span name="attr_stealth_avg"></span></button>)</span>

				<span class="sheet-streetwise-row sheet-skill-label">
					<button type="roll" name="roll_streetwise" 
						value="&{template:skill} {{name=@{character_name}}} {{skill=Streetwise}} {{result=[[(@{streetwise_rating}+@{rollmod})d6cf<0cs>7>4]]}}">
						Streetwise</button>
					<input type="hidden" class="sheet-spec-test" name="attr_streetwise_spec">
					<span class="sheet-skill-spec">(<button type="roll" name="roll_streetwisespec" value="&{template:skill} {{name=@{character_name}}} {{skill=Streetwise}} {{spec=@{streetwise_spec}}} {{result=[[(@{streetwise_rating}+1+@{rollmod})d6cf<0cs>7>4]]}}"><span name="attr_streetwise_spec"></span></button>)</span>
				</span>
				<span class="sheet-streetwise-row sheet-skill-value" name="attr_streetwise_base"></span>
				<span class="sheet-streetwise-row sheet-skill-value" name="attr_streetwise_level"></span>
				<span class="sheet-streetwise-row sheet-skill-value" name="attr_streetwise_rating"></span>
				<span class="sheet-streetwise-row sheet-skill-value">(<button type="roll" name="roll_streetwiseavg" value="&{template:skill} {{name=@{character_name}}} {{skill=Streetwise}} {{result=[[floor((@{academics_rating}+@{rollmod})/2) + ((@{academics_rating}+@{rollmod})%2)d6cf<0cs>7>4]]}}"><span name="attr_streetwise_avg"></span></button>)</span>

				<button class="sheet-supernaturallore-row sheet-skill-label" type="roll" name="roll_supernaturallore" 
					value="&{template:skill} {{name=@{character_name}}} {{skill=Supernatural Lore*}} {{spec=@{supernaturallore_spec}}} {{result=[[(@{supernaturallore_rating}+@{rollmod})d6cf<0cs>7>4]]}}">
					Supernatural Lore*
					<input type="hidden" class="sheet-spec-test" name="attr_supernaturallore_spec">
					<span class="sheet-skill-spec"> (<span name="attr_supernaturallore_spec"></span>)</span>
				</button>
				<span class="sheet-supernaturallore-row sheet-skill-value" name="attr_supernaturallore_base"></span>
				<span class="sheet-supernaturallore-row sheet-skill-value" name="attr_supernaturallore_level"></span>
				<span class="sheet-supernaturallore-row sheet-skill-value" name="attr_supernaturallore_rating"></span>
				<span class="sheet-supernaturallore-row sheet-skill-value">(<button type="roll" name="roll_supernaturalloreavg" value="&{template:skill} {{name=@{character_name}}} {{skill=Supernatural Lore*}} {{spec=@{supernaturallore_spec}}} {{result=[[floor((@{academics_rating}+@{rollmod})/2) + ((@{academics_rating}+@{rollmod})%2)d6cf<0cs>7>4]]}}"><span name="attr_supernaturallore_avg"></span></button>)</span>

				<span class="sheet-survival-row sheet-skill-label">
					<button type="roll" name="roll_survival" 
						value="&{template:skill} {{name=@{character_name}}} {{skill=Survival}} {{result=[[(@{survival_rating}+@{rollmod})d6cf<0cs>7>4]]}}">
						Survival</button>
					<input type="hidden" class="sheet-spec-test" name="attr_survival_spec">
					<span class="sheet-skill-spec">(<button type="roll" name="roll_survivalspec" value="&{template:skill} {{name=@{character_name}}} {{skill=Survival}} {{spec=@{survival_spec}}} {{result=[[(@{survival_rating}+1+@{rollmod})d6cf<0cs>7>4]]}}"><span name="attr_survival_spec"></span></button>)</span>
				</span>
				<span class="sheet-survival-row sheet-skill-value" name="attr_survival_base"></span>
				<span class="sheet-survival-row sheet-skill-value" name="attr_survival_level"></span>
				<span class="sheet-survival-row sheet-skill-value" name="attr_survival_rating"></span>
				<span class="sheet-survival-row sheet-skill-value">(<button type="roll" name="roll_survivalavg" value="&{template:skill} {{name=@{character_name}}} {{skill=Survival}} {{result=[[floor((@{academics_rating}+@{rollmod})/2) + ((@{academics_rating}+@{rollmod})%2)d6cf<0cs>7>4]]}}"><span name="attr_survival_avg"></span></button>)</span>
			</div>
		</div>
	
		<div class="sheet-char-right">
			
			<div class="sheet-section-header">Wellbeing</div>
			
			<div class="sheet-wellbeing-grid">
				<span class="sheet-wellbeing-label">Style</span>
				<span class="sheet-wellbeing-label">Health</span>
				<span class="sheet-wellbeing-label">Sanity</span>
				<span class="sheet-wellbeing-label">Eldritch Pool</span>
			
				<span class="sheet-wellbeing-content">
					<input type="number" class="sheet-wellbeing-input" name="attr_style" value="0"/>
				</span>
				<span class="sheet-wellbeing-content">
					<input type="number" class="sheet-wellbeing-input" name="attr_current_health" value="0"/> / 
					<span name="attr_health" class="sheet-wellbeing-value"></span>
				</span>
				<span class="sheet-wellbeing-content">
					<input type="number" class="sheet-wellbeing-input" name="attr_current_sanity" value="0"/> / 
					<span name="attr_sanity" class="sheet-wellbeing-value"></span>
				</span>
				<span class="sheet-wellbeing-content">
					<input type="number" class="sheet-wellbeing-input" name="attr_current_eldritch_pool" value="0"/> / 
					<span name="attr_eldritch_pool" class="sheet-wellbeing-value"></span>
				</span>
			</div>
		
			<div class="sheet-section-header">Biographical Information</div>

			<div class="sheet-bio-grid">
				<span class="sheet-bio-label">Team Role</span>
				<span class="sheet-bio-label">Archetype</span>
				<span class="sheet-bio-value" name="attr_role">none</span>
				<span class="sheet-bio-value" name="attr_archetype">none</span>
				<span class="sheet-bio-label">Motivation</span>
				<span class="sheet-bio-label">Flaw</span>
				<span class="sheet-bio-value" name="attr_motivation">none</span>
				<span class="sheet-bio-value" name="attr_flaw">none</span>
			</div>
		
			<div class="sheet-section-header">Talents</div>
			
			<span name="attr_talent_list"></span>
		
			<div class="sheet-section-header">Resources</div>

			<span name="attr_resource_list"></span>
			
			<div class="sheet-section-header">Weapons</div>

			<div style="font-size:0.8em;font-weight:600;">
				<div style="display:inline-block;width:150px;">Weapon</div>
				<div style="display:inline-block;width:55px;text-align:center;">Rating</div>
				<div style="display:inline-block;width:55px;text-align:center;">Size</div>
				<div style="display:inline-block;width:55px;text-align:center;">Attack</div>
				<div style="display:inline-block;width:55px;text-align:center;">Average</div>
			</div>

			<fieldset class="repeating_weapons">
				<!-- the attrs have to be present in input elements for the buttons to work. I don't know why. -->
				<input type="hidden" name="attr_weapon_name">
				<input type="hidden" name="attr_weapon_attack">

				<span style="display:inline-block;width:150px;">
					<button type="roll" name="roll_@{weapon_name}" 
						value="&{template:skill} {{name=@{character_name}}} {{skill=@{weapon_name}}} {{result=[[(@{weapon_attack}+@{rollmod})d6cf<0cs>7>4]]}}">
						<span name="attr_weapon_name">
					</button>
				</span>
				<span style="display:inline-block;width:55px;text-align:center;">
					<span name="attr_weapon_rating">0</span>
					<span name="attr_weapon_type">N</span>
				</span>				
				<span name="attr_weapon_size" style="display:inline-block;width:55px;text-align:center;"></span>
				<span style="display:inline-block;width:55px;text-align:center;">
					<span name="attr_weapon_attack">0</span>
					<span name="attr_weapon_type">N</span>
				</span>
				<span style="display:inline-block;width:60px;text-align:center;">
					(<button type="roll" name="roll_@{weapon_name}avg" value="&{template:skill} {{name=@{character_name}}} {{skill=@{weapon_name}}} {{result=[[floor((@{weapon_attack}+@{rollmod})/2) + ((@{weapon_attack}+@{rollmod})%2)d6cf<0cs>7>4]]}}"><span name="attr_weapon_avg"></span></button>)					
					<span name="attr_weapon_type">N</span>
				</span>
			</fieldset>
		</div>
	</div>
	
	<div class="sheet-section-header">Notes</div>
	<span name="attr_notes" class="sheet-notes">&nbsp;</span>	
</div>

<div class="sheet-config">

	<div class="sheet-char-tools">
		<div class="sheet-icon">&nbsp;</div>
		<div style="flex-grow:1;">&nbsp;</div>
		<button type="action" name="act_character" style="margin-top:5px">Character</button>
	</div>

	<div class="sheet-char-main">
		<div class="sheet-char-left">
			
			<div class="sheet-section-header">Biographical Information</div>
			
			<div class="sheet-bio-grid">
				<span class="sheet-bio-label">Team Role</span>
				<span class="sheet-bio-label">Archetype</span>
				<select class="sheet-bio-input" name="attr_role">
					<option>Academic Knowledge/Research Expert</option>
					<option>Close Combatant</option>
					<option>Covert Operative</option>
					<option>Face</option>
					<option>Healing/Medical Specialist</option>
					<option>Investigator</option>
					<option>Leader</option>
					<option>Outdoor Expert</option>
					<option>Ranged Combatant</option>
					<option>Science/Technical Expert</option>
					<option>Supernatural Specialist</option>
				</select>
				<select class="sheet-bio-input" name="attr_archetype">
					<option>Academic</option>
					<option>Celebrity</option>
					<option>Company Man</option>
					<option>Criminal</option>
					<option>Detective</option>
					<option>Doctor</option>
					<option>Drifter</option>
					<option>Engineer</option>
					<option>Occultist</option>
					<option>Public Relations Expert</option>
					<option>Reporter</option>
					<option>Scientist</option>
					<option>Soldier</option>
					<option>Survivor</option>
					<option>Technician</option>
					<option>The Zeppo</option>
				</select>
				<span class="sheet-bio-label">Motivation</span>
				<span class="sheet-bio-label">Flaw</span>
				<select class="sheet-bio-input" name="attr_motivation">
					<option>Belonging</option>
					<option>Competence</option>
					<option>Competition</option>
					<option>Deception</option>
					<option>Duty</option>
					<option>Faith</option>
					<option>Greed</option>
					<option>Love</option>
					<option>Manipulation</option>
					<option>Power</option>
					<option>Protection</option>
					<option>Redemption</option>
					<option>Revenge</option>
					<option>Survival</option>
					<option>Thrill Seeker</option>
					<option>Truth</option>
				</select>
				<select class="sheet-bio-input" name="attr_flaw">
					<option>No Flaw</option>
					<optgroup label="Mental Flaws">
						<option>Absent-Minded</option>
						<option>Addiction</option>
						<option>Amnesia</option>
						<option>Bloodthirsty</option>
						<option>Bully</option>
						<option>Coward</option>
						<option>Illiterate</option>
						<option>Impulsive</option>
						<option>Inherently Unstable</option>
						<option>Jealous</option>
						<option>Lazy</option>
						<option>Non-Believer</option>
						<option>Obsession</option>
						<option>Overconfident</option>
						<option>Paranoia</option>
						<option>Phobia</option>
						<option>Voices</option>
					</optgroup>
					<optgroup label="Miscellaneous Flaws">
						<option>Danger Magnet</option>
						<option>Mundane</option>
						<option>Mystery Box!</option>
						<option>Primitive</option>
						<option>Susceptible</option>
						<option>Unlucky</option>
						<option>Unnatural</option>
					</optgroup>
					<optgroup label="Physical Flaws">
						<option>Blind</option>
						<option>Deaf</option>
						<option>Dwarf</option>
						<option>Dying</option>
						<option>Hard of Hearing</option>
						<option>Lame</option>
						<option>Mute</option>
						<option>One Arm</option>
						<option>One Eye</option>
						<option>Poor Vision</option>
					</optgroup>
					<optgroup label="Social Flaws">
						<option>Callous</option>
						<option>Condescending</option>
						<option>Criminal</option>
						<option>Disfigured</option>
						<option>Intolerant</option>
						<option>Pacifist</option>
						<option>Secret</option>
						<option>Shy</option>
						<option>Speech Impediment</option>
					</optgroup>
				</select>
			</div>
			
			<div class="sheet-section-header">Primary Attributes</div>

			<div class="sheet-stat-grid">
				<span class="sheet-stat-label">Body</span>
				<input type="number" class="sheet-stat-input" name="attr_body" value="0">
				<span class="sheet-stat-label">Charisma</span>
				<input type="number" class="sheet-stat-input" name="attr_charisma" value="0">

				<span class="sheet-stat-label">Dexterity</span>
				<input type="number" class="sheet-stat-input" name="attr_dexterity" value="0">
				<span class="sheet-stat-label">Intelligence</span>
				<input type="number" class="sheet-stat-input" name="attr_intelligence" value="0">

				<span class="sheet-stat-label">Strength</span>
				<input type="number" class="sheet-stat-input" name="attr_strength" value="0">
				<span class="sheet-stat-label">Willpower</span>
				<input type="number" class="sheet-stat-input" name="attr_willpower" value="0">
			</div>

			<div style="display:flex;margin-top:5px;align-items:center;">
				<span class="sheet-stat-label" style="margin-right:10px;">Eldritch Pool</span>
				<select class="sheet-stat-input" style="margin:0;" name="attr_eldritch_pool_stat">
					<option value="body">Body</option>
					<option value="dexterity">Dexterity</option>
					<option value="strength">Strength</option>
					<option value="charisma">Charisma</option>
					<option value="intelligence">Intelligence</option>
					<option value="willpower">Willpower</option>
				</select>
			</div>

			<div class="sheet-section-header">Skills</div>

			<div class="sheet-config-skill-grid">
				<span class="sheet-skill-label">Academics*</span>
				<select class="sheet-skill-input" name="attr_academics_spec">
					<option>Economics</option>
					<option>History</option>
					<option>Law</option>
					<option>Literature</option>
					<option>Philosophy</option>
					<option>Political Science</option>
					<option>Psychology</option>
					<option>Religion</option>
					<option>Sociology </option>
				</select>
				<input type="number" class="sheet-skill-input" name="attr_academics_level">

				<span class="sheet-skill-label">Acrobatics</span>
				<select class="sheet-skill-input" name="attr_acrobatics_spec">
					<option>Balance</option>
					<option>Breakfall</option>
					<option>Contortion</option>
					<option>Juggling</option>
					<option>Tumbling</option>
				</select>
				<input type="number" class="sheet-skill-input" name="attr_acrobatics_level">

				<span class="sheet-skill-label">Administration</span>
				<select class="sheet-skill-input" name="attr_administration_spec">
					<option>Academic</option>
					<option>Business</option>
					<option>Government</option>
					<option>Legal</option>
					<option>Military</option>
				</select>
				<input type="number" class="sheet-skill-input" name="attr_administration_level">

				<span class="sheet-skill-label">Archery</span>
				<select class="sheet-skill-input" name="attr_archery_spec">
					<option>Blowguns</option>
					<option>Bows</option>
					<option>Crossbows</option>
					<option>Nets</option>
					<option>Slings</option>
				</select>
				<input type="number" class="sheet-skill-input" name="attr_archery_level">

				<span class="sheet-skill-label">Art*</span>
				<select class="sheet-skill-input" name="attr_art_spec">
					<option>Animation</option>
					<option>Music</option>
					<option>Painting</option>
					<option>Photography</option>
					<option>Sculpture</option>
					<option>Video</option>
					<option>Writing </option>
				</select>
				<input type="number" class="sheet-skill-input" name="attr_art_level">

				<span class="sheet-skill-label">Athletics</span>
				<select class="sheet-skill-input" name="attr_athletics_spec">
					<option>Climbing</option>
					<option>Jumping</option>
					<option>Running</option>
					<option>Swimming</option>
					<option>Throwing</option>
				</select>
				<input type="number" class="sheet-skill-input" name="attr_athletics_level">

				<span class="sheet-skill-label">Brawl</span>
				<select class="sheet-skill-input" name="attr_brawl_spec">
					<option>Dirty Tricks</option>
					<option>Grappling</option>
					<option>Kicking</option>
					<option>Punching</option>
					<option>Throws</option>
				</select>
				<input type="number" class="sheet-skill-input" name="attr_brawl_level">

				<span class="sheet-skill-label">Computers</span>
				<select class="sheet-skill-input" name="attr_computers_spec">
					<option>Analysis</option>
					<option>Data Collection</option>
					<option>Networking</option>
					<option>Programming</option>
					<option>Security </option>
				</select>
				<input type="number" class="sheet-skill-input" name="attr_computers_level">

				<span class="sheet-skill-label">Con</span>
				<select class="sheet-skill-input" name="attr_con_spec">
					<option>Bluff</option>
					<option>Fast Talk</option>
					<option>Grift</option>
					<option>Lying</option>
					<option>Seduction</option>
				</select>
				<input type="number" class="sheet-skill-input" name="attr_con_level">

				<span class="sheet-skill-label">Craft*</span>
				<select class="sheet-skill-input" name="attr_craft_spec">
					<option>Carpentry</option>
					<option>Chemistry</option>
					<option>Electronics</option>
					<option>Mechanics</option>
					<option>Medicines </option>
				</select>
				<input type="number" class="sheet-skill-input" name="attr_craft_level">

				<span class="sheet-skill-label">Demolitions</span>
				<select class="sheet-skill-input" name="attr_demolitions_spec">
					<option>Defusing</option>
					<option>Dynamite</option>
					<option>Gunpowder</option>
					<option>Improvised Incendiary</option>
					<option>Plastic </option>
				</select>
				<input type="number" class="sheet-skill-input" name="attr_demolitions_level">

				<span class="sheet-skill-label">Diplomacy</span>
				<select class="sheet-skill-input" name="attr_diplomacy_spec">
					<option>Etiquette</option>
					<option>Leadership</option>
					<option>Negotiation</option>
					<option>Persuasion</option>
					<option>Politics</option>
				</select>
				<input type="number" class="sheet-skill-input" name="attr_diplomacy_level">

				<span class="sheet-skill-label">Drive</span>
				<select class="sheet-skill-input" name="attr_drive_spec">
					<option>Buses</option>
					<option>Cars</option>
					<option>Motorcycles</option>
					<option>Remotes</option>
					<option>Tanks</option>
					<option>Trucks</option>
				</select>
				<input type="number" class="sheet-skill-input" name="attr_drive_level">

				<span class="sheet-skill-label">Electronics</span>
				<select class="sheet-skill-input" name="attr_electronics_spec">
					<option>Sensors</option>
					<option>Surveillance</option>
					<option>Wireless</option>
				</select>
				<input type="number" class="sheet-skill-input" name="attr_electronics_level">

				<span class="sheet-skill-label">Empathy</span>
				<select class="sheet-skill-input" name="attr_empathy_spec">
					<option>Body Language</option>
					<option>Emotions</option>
					<option>Intuitions</option>
					<option>Lies</option>
					<option>Motives</option>
				</select>
				<input type="number" class="sheet-skill-input" name="attr_empathy_level">

				<span class="sheet-skill-label">Firearms</span>
				<select class="sheet-skill-input" name="attr_firearms_spec">
					<option>Archaic</option>
					<option>Pistol</option>
					<option>Rifle</option>
					<option>Shotgun</option>
					<option>Submachine Gun</option>
				</select>
				<input type="number" class="sheet-skill-input" name="attr_firearms_level">

				<span class="sheet-skill-label">Gambling</span>
				<select class="sheet-skill-input" name="attr_gambling_spec">
					<option>Cheating</option>
					<option>Blackjack</option>
					<option>Craps</option>
					<option>Poker</option>
					<option>Roulette</option>
				</select>
				<input type="number" class="sheet-skill-input" name="attr_gambling_level">

				<span class="sheet-skill-label">Gunnery</span>
				<select class="sheet-skill-input" name="attr_gunnery_spec">
					<option>Artillery</option>
					<option>Bombs</option>
					<option>Cannons</option>
					<option>Machine Guns</option>
					<option>Rockets </option>
				</select>
				<input type="number" class="sheet-skill-input" name="attr_gunnery_level">

				<span class="sheet-skill-label">Intimidation</span>
				<select class="sheet-skill-input" name="attr_intimidation_spec">
					<option>Interrogation</option>
					<option>Orders</option>
					<option>Staredown</option>
					<option>Threats</option>
					<option>Torture</option>
				</select>
				<input type="number" class="sheet-skill-input" name="attr_intimidation_level">

				<span class="sheet-skill-label">Investigation</span>
				<select class="sheet-skill-input" name="attr_investigation_spec">
					<option>Crimes</option>
					<option>Enigmas</option>
					<option>Interview</option>
					<option>Research</option>
					<option>Search</option>
				</select>
				<input type="number" class="sheet-skill-input" name="attr_investigation_level">

				<span class="sheet-skill-label">Larceny</span>
				<select class="sheet-skill-input" name="attr_larceny_spec">
					<option>Lockpicking</option>
					<option>Pickpocket</option>
					<option>Safecracking</option>
					<option>Security</option>
					<option>Sleight of Hand </option>
				</select>
				<input type="number" class="sheet-skill-input" name="attr_larceny_level">

				<span class="sheet-skill-label">Linguistics</span>
				<select class="sheet-skill-input" name="attr_linguistics_spec">
					<option>Codes</option>
					<option>Deciphering</option>
					<option>Gestures</option>
					<option>Lip Reading</option>
					<option>Translation </option>
				</select>
				<input type="number" class="sheet-skill-input" name="attr_linguistics_level">

				<span class="sheet-skill-label">Medicine</span>
				<select class="sheet-skill-input" name="attr_medicine_spec">
					<option>Diagnosis</option>
					<option>Diseases</option>
					<option>First Aid</option>
					<option>Veterinary</option>
					<option>Xeno-Medicine</option>
				</select>
				<input type="number" class="sheet-skill-input" name="attr_medicine_level">

				<span class="sheet-skill-label">Melee</span>
				<select class="sheet-skill-input" name="attr_melee_spec">
					<option>Axes</option>
					<option>Clubs</option>
					<option>Knives</option>
					<option>Spears</option>
					<option>Swords</option>
				</select>
				<input type="number" class="sheet-skill-input" name="attr_melee_level">

				<span class="sheet-skill-label">Performance*</span>
				<select class="sheet-skill-input" name="attr_performance_spec">
					<option>Acting</option>
					<option>Comedy</option>
					<option>Dancing</option>
					<option>Musical Instrument</option>
					<option>Oratory</option>
					<option>Singing </option>
				</select>
				<input type="number" class="sheet-skill-input" name="attr_performance_level">

				<span class="sheet-skill-label">Pilot*</span>
				<select class="sheet-skill-input" name="attr_pilot_spec">
					<option>Aircraft</option>
					<option>Balloons</option>
					<option>Drones</option>
					<option>Ships</option>
					<option>Submarines</option>
				</select>
				<input type="number" class="sheet-skill-input" name="attr_pilot_level">

				<span class="sheet-skill-label">Ride</span>
				<select class="sheet-skill-input" name="attr_ride_spec">
					<option>Bulls</option>
					<option>Camels</option>
					<option>Elephants</option>
					<option>Horses</option>
					<option>Mules</option>
				</select>
				<input type="number" class="sheet-skill-input" name="attr_ride_level">

				<span class="sheet-skill-label">Ritual Magic</span>
				<select class="sheet-skill-input" name="attr_ritualmagic_spec">
					<option>Divination</option>
					<option>Occult Geography</option>
					<option>Protection</option>
					<option>Summoning</option>
				</select>
				<input type="number" class="sheet-skill-input" name="attr_ritualmagic_level">

				<span class="sheet-skill-label">Science*</span>
				<select class="sheet-skill-input" name="attr_science_spec">
					<option>Biology</option>
					<option>Chemistry</option>
					<option>Engineering</option>
					<option>Geology</option>
					<option>Physics</option>
					<option>Xenobiology </option>
				</select>
				<input type="number" class="sheet-skill-input" name="attr_science_level">

				<span class="sheet-skill-label">Stealth</span>
				<select class="sheet-skill-input" name="attr_stealth_spec">
					<option>Camouflage</option>
					<option>Disguise</option>
					<option>Hiding</option>
					<option>Shadowing</option>
					<option>Sneaking</option>
				</select>
				<input type="number" class="sheet-skill-input" name="attr_stealth_level">

				<span class="sheet-skill-label">Streetwise</span>
				<select class="sheet-skill-input" name="attr_streetwise_spec">
					<option>Black Market</option>
					<option>Carousing</option>
					<option>haggling</option>
					<option>Rumors</option>
					<option>Scrounging</option>
				</select>
				<input type="number" class="sheet-skill-input" name="attr_streetwise_level">

				<span class="sheet-skill-label">Supernatural Lore*</span>
				<select class="sheet-skill-input" name="attr_supernaturallore_spec">
					<option>Fey</option>
					<option>Lycanthropes</option>
					<option>cosmic</option>
					<option>Pagan</option>
					<option>Spirits</option>
					<option>Undead</option>
				</select>
				<input type="number" class="sheet-skill-input" name="attr_supernaturallore_level">

				<span class="sheet-skill-label">Survival</span>
				<select class="sheet-skill-input" name="attr_survival_spec">
					<option>Foraging</option>
					<option>Hunting</option>
					<option>Navigation</option>
					<option>Shelter</option>
					<option>Tacking</option>
				</select>
				<input type="number" class="sheet-skill-input" name="attr_survival_level">
			</div>

			<div class="sheet-section-header">Weapons</div>

			<div style="display:flex;font-size:0.8em;font-weight:600;">
				<div style="width:140px;">Weapon</div>
				<div style="width:43px;text-align:center;">Rating</div>
				<div style="width:55px;text-align:center;">Type</div>
				<div style="width:47px;text-align:center;">Size</div>
				<div style="width:85px;">Skill</div>
				<div style="width:30px;text-align:center;">Spec?</div>
			</div>

			<fieldset class="repeating_weapons">
				<input type="hidden" name="attr_weapon_attack" value="0">
				<input type="hidden" name="attr_weapon_avg" value="0">
				<input type="text" name="attr_weapon_name" value="">
				<input type="number" name="attr_weapon_rating" value="0">
				<select name="attr_weapon_type">
					<option>L</option>
					<option>N</option>
					<option>S</soption>
				</select>
				<input type="number" name="attr_weapon_size" value="0">
				<select name="attr_weapon_skill">
					<option value="archery">Archery</option>
					<option value="athletics">Athletics</option>
					<option value="firearms">Firearms</option>
					<option value="melee">Melee</option>
					<option value="unarmed">Unarmed</option>
				</select>
				<span style="display:inline-block;width:30px;text-align:center;"><input type="checkbox" name="attr_weapon_spec" value="1"></span>
			</fieldset>

		</div>

		<div class="sheet-char-right">
		
			<div class="sheet-section-header">Talents</div>

			<div class="sheet-talent-grid">
				<span><input type="checkbox" name="attr_talent_accuracy" value="1"> Accuracy</span>
				<span><input type="checkbox" name="attr_talent_agile" value="1"> Agile</span>

				<span><input type="checkbox" name="attr_talent_alertness" value="1"> Alertness</span>
				<span><input type="checkbox" name="attr_talent_attractive" value="1"> Attractive</span>

				<span><input type="checkbox" name="attr_talent_autofire" value="1"> Autofire</span>
				<span><input type="checkbox" name="attr_talent_blindfight" value="1"> Blind Fight</span>

				<span><input type="checkbox" name="attr_talent_block" value="1"> Block</span>
				<span><input type="checkbox" name="attr_talent_bluntstrike" value="1"> Blunt Strike</span>

				<span><input type="checkbox" name="attr_talent_boldattack" value="1"> Bold Attack</span>
				<span><input type="checkbox" name="attr_talent_bolddefense" value="1"> Bold Defense</span>

				<select name="attr_talent_boldattack_skill">
					<option value="archery">Archery</option>
					<option value="athletics">Athletics</option>
					<option value="brawl">Brawl</option>
					<option value="firearms">Firearms</option>
					<option value="melee">Melee</option>
				</select>
				<span><input type="checkbox" name="attr_talent_calculatedattack" value="1"> Calculated Attack</span>

				<span><input type="checkbox" name="attr_talent_calculateddefense" value="1"> Calculated Defense</span>
				<select name="attr_talent_calculatedattack_skill">
					<option value="archery">Archery</option>
					<option value="athletics">Athletics</option>
					<option value="brawl">Brawl</option>
					<option value="firearms">Firearms</option>
					<option value="melee">Melee</option>
				</select>

				<span><input type="checkbox" name="attr_talent_charismatic" value="1"> Charismatic</span>
				<span><input type="checkbox" name="attr_talent_climb" value="1"> Climb</span>

				<span><input type="checkbox" name="attr_talent_combataptitude" value="1"> Combat Aptitude</span>
				<span><input type="checkbox" name="attr_talent_combatskill" value="1"> Combat Skill</span>

				<span><input type="checkbox" name="attr_talent_cosmicsensitive" value="1"> Cosmic Sensitive</span>
				<select name="attr_talent_combatskill_skill">
					<option value="academics">Academics</option>
					<option value="acrobatics">Acrobatics</option>
					<option value="administration">Administration</option>
					<option value="art">Art</option>
					<option value="computers">Computers</option>
					<option value="con">Con</option>
					<option value="craft">Craft</option>
					<option value="demolitions">Demolitions</option>
					<option value="diplomacy">Diplomacy</option>
					<option value="drive">Drive</option>
					<option value="electronics">Electronics</option>
					<option value="empathy">Empathy</option>
					<option value="gambling">Gambling</option>
					<option value="intimidation">Intimidation</option>
					<option value="investigation">Investigation</option>
					<option value="larceny">Larceny</option>
					<option value="linguistics">Linguistics</option>
					<option value="medicine">Medicine</option>
					<option value="performance">Performance</option>
					<option value="pilot">Pilot</option>
					<option value="ride">Ride</option>
					<option value="ritualmagic">Ritual Magic</option>
					<option value="science">Science</option>
					<option value="stealth">Stealth</option>
					<option value="streetwise">Streetwise</option>
					<option value="supernaturallore">Supernatural Lore</option>
					<option value="survival">Survival</option>
				</select>

				<span><input type="checkbox" name="attr_talent_dangersense" value="1"> Danger Sense</span>
				<span><input type="checkbox" name="attr_talent_diehard" value="1"> Diehard</span>

				<span><input type="checkbox" name="attr_talent_directionsense" value="1"> Direction Sense</span>
				<span><input type="checkbox" name="attr_talent_dodge" value="1"> Dodge</span>

				<span><input type="checkbox" name="attr_talent_dualwield" value="1"> Dual Wield</span>
				<span><input type="checkbox" name="attr_talent_eldritchadept" value="1"> Eldritch Adept</span>
				
				<span><input type="checkbox" name="attr_talent_eldritchprodigy" value="1"> Eldritch Prodigy</span>				
				<span><input type="checkbox" name="attr_talent_fearsome" value="1"> Fearsome</span>

				<span><input type="checkbox" name="attr_talent_finesseattack" value="1"> Finesse Attack</span>
				<span><input type="checkbox" name="attr_talent_flurry" value="1"> Flurry</span>

				<select name="attr_talent_finesseattack_skill">
					<option value="athletics">Athletics</option>
					<option value="brawl">Brawl</option>
					<option value="melee">Melee</option>
				</select>
				<span><input type="checkbox" name="attr_talent_focusedattack" value="1"> Focused Attack</span>

				<span><input type="checkbox" name="attr_talent_focuseddefense" value="1"> Focused Defense</span>
				<select name="attr_talent_focusedattack_skill">
					<option value="archery">Archery</option>
					<option value="athletics">Athletics</option>
					<option value="brawl">Brawl</option>
					<option value="firearms">Firearms</option>
					<option value="melee">Melee</option>
				</select>

				<span><input type="checkbox" name="attr_talent_giant" value="1"> Giant</span>
				<span><input type="checkbox" name="attr_talent_guardian" value="1"> Guardian</span>

				<span><input type="checkbox" name="attr_talent_headstrong" value="1"> Headstrong</span>
				<span><input type="checkbox" name="attr_talent_highpaintolerance" value="1"> High Pain Tolerance</span>

				<span><input type="checkbox" name="attr_talent_inspire" value="1"> Inspire</span>
				<span><input type="checkbox" name="attr_talent_instantreload" value="1"> Instant Reload</span>

				<span><input type="checkbox" name="attr_talent_intelligent" value="1"> Intelligent</span>
				<span><input type="checkbox" name="attr_talent_ironjaw" value="1"> Iron Jaw</span>

				<span><input type="checkbox" name="attr_talent_ironwill" value="1"> Iron Will</span>
				<span><input type="checkbox" name="attr_talent_jump" value="1"> Jump</span>

				<span><input type="checkbox" name="attr_talent_keensense" value="1"> Keen Sense</span>
				<span><input type="checkbox" name="attr_talent_kipup" value="1"> Kip Up</span>

				<select name="attr_talent_keensense_skill">
					<option value="vision">Vision</option>
					<option value="hearing">Hearing</option>
					<option value="touch">Touch</option>
					<option value="taste">Taste</option>
					<option value="smell">Smell</option>
				</select>
				<span><input type="checkbox" name="attr_talent_knockoutblow" value="1"> Knockout Blow</span>

				<span><input type="checkbox" name="attr_talent_lethalblow" value="1"> Lethal Blow</span>
				<span><input type="checkbox" name="attr_talent_lifesaver" value="1"> Lifesaver</span>

				<span><input type="checkbox" name="attr_talent_longshot" value="1"> Long Shot</span>
				<span><input type="checkbox" name="attr_talent_lucky" value="1"> Lucky</span>

				<span><input type="checkbox" name="attr_talent_mobileattack" value="1"> Mobile Attack</span>
				<span><input type="checkbox" name="attr_talent_parry" value="1"> Parry</span>

				<span><input type="checkbox" name="attr_talent_provoke" value="1"> Provoke</span>
				<span><input type="checkbox" name="attr_talent_quickdraw" value="1"> Quick Draw</span>

				<span><input type="checkbox" name="attr_talent_quickhealer" value="1"> Quick Healer</span>
				<span><input type="checkbox" name="attr_talent_quickreflexes" value="1"> Quick Reflexes</span>

				<span><input type="checkbox" name="attr_talent_rapidshot" value="1"> Rapid Shot</span>
				<span><input type="checkbox" name="attr_talent_resolute" value="1"> Resolute</span>

				<span><input type="checkbox" name="attr_talent_robust" value="1"> Robust</span>
				<span><input type="checkbox" name="attr_talent_rockofstability" value="1"> Rock of Stability</span>

				<span><input type="checkbox" name="attr_talent_run" value="1"> Run</span>
				<span><input type="checkbox" name="attr_talent_skillaptitude" value="1"> Skill Aptitude</span>

				<span><input type="checkbox" name="attr_talent_skillmastery" value="1"> Skill Mastery</span>
				<select name="attr_talent_skillaptitude_skill">
					<option value="academics">Academics</option>
					<option value="acrobatics">Acrobatics</option>
					<option value="administration">Administration</option>
					<option value="archery">Archery</option>
					<option value="art">Art</option>
					<option value="athletics">Athletics</option>
					<option value="brawl">Brawl</option>
					<option value="computers">Computers</option>
					<option value="con">Con</option>
					<option value="craft">Craft</option>
					<option value="demolitions">Demolitions</option>
					<option value="diplomacy">Diplomacy</option>
					<option value="drive">Drive</option>
					<option value="electronics">Electronics</option>
					<option value="empathy">Empathy</option>
					<option value="firearms">Firearms</option>
					<option value="gambling">Gambling</option>
					<option value="gunnery">Gunnery</option>
					<option value="intimidation">Intimidation</option>
					<option value="investigation">Investigation</option>
					<option value="larceny">Larceny</option>
					<option value="linguistics">Linguistics</option>
					<option value="medicine">Medicine</option>
					<option value="melee">Melee</option>
					<option value="performance">Performance</option>
					<option value="pilot">Pilot</option>
					<option value="ride">Ride</option>
					<option value="ritualmagic">Ritual Magic</option>
					<option value="science">Science</option>
					<option value="stealth">Stealth</option>
					<option value="streetwise">Streetwise</option>
					<option value="supernaturallore">Supernatural Lore</option>
					<option value="survival">Survival</option>
				</select>

				<select name="attr_talent_skillmastery_skill">
					<option value="academics">Academics</option>
					<option value="art">Art</option>
					<option value="craft">Craft</option>
					<option value="pilot">Pilot</option>
					<option value="science">Science</option>
				</select>
				<span><input type="checkbox" name="attr_talent_staggeringblow" value="1"> Staggering Blow</span>

				<span><input type="checkbox" name="attr_talent_strafe" value="1"> Strafe</span>
				<span><input type="checkbox" name="attr_talent_strong" value="1"> Strong</span>

				<span><input type="checkbox" name="attr_talent_strongattack" value="1"> Strong Attack</span>
				<span><input type="checkbox" name="attr_talent_strongdefense" value="1"> Strong Defense</span>

				<select name="attr_talent_strongattack_skill">
					<option value="archery">Archery</option>
					<option value="firearms">Firearms</option>
				</select>
				<span><input type="checkbox" name="attr_talent_swim" value="1"> Swim</span>

				<span><input type="checkbox" name="attr_talent_teamplayer" value="1"> Team Player</span>
				<span><input type="checkbox" name="attr_talent_timesense" value="1"> Time Sense</span>

				<span><input type="checkbox" name="attr_talent_totaldefense" value="1"> Total Defense</span>
				<span><input type="checkbox" name="attr_talent_totalrecall" value="1"> Total Recall</span>

				<span><input type="checkbox" name="attr_talent_tough" value="1"> Tough</span>
				<span><input type="checkbox" name="attr_talent_toughattack" value="1"> Tough Attack</span>

				<span><input type="checkbox" name="attr_talent_vigorousdefense" value="1"> Vigorous Defense</span>
				<span><input type="checkbox" name="attr_talent_" value="1"> </span>

				<span><input type="checkbox" name="attr_talent_zeroed" value="1"> Zeroed</span>
			</div>

			<div class="sheet-section-header">Resources</div>

			<input type="hidden" name="attr_res_allies" class="sheet-res-level" value="0">
			<input type="hidden" name="attr_res_alternateidentity" class="sheet-res-level" value="0">
			<input type="hidden" name="attr_res_arcanelibrary" class="sheet-res-level" value="0">
			<input type="hidden" name="attr_res_artifact" class="sheet-res-level" value="0">
			<input type="hidden" name="attr_res_contacts" class="sheet-res-level" value="0">
			<input type="hidden" name="attr_res_fame" class="sheet-res-level" value="0">
			<input type="hidden" name="attr_res_followers" class="sheet-res-level" value="0">
			<input type="hidden" name="attr_res_gadget" class="sheet-res-level" value="0">
			<input type="hidden" name="attr_res_grimoire" class="sheet-res-level" value="0">
			<input type="hidden" name="attr_res_mentor" class="sheet-res-level" value="0">
			<input type="hidden" name="attr_res_rank" class="sheet-res-level" value="0">
			<input type="hidden" name="attr_res_refuge" class="sheet-res-level" value="0">
			<input type="hidden" name="attr_res_status" class="sheet-res-level" value="0">
			<input type="hidden" name="attr_res_wealth" class="sheet-res-level" value="0">
		
			<div class="sheet-resource-grid">
				<span class="sheet-resource-label">Allies</span>
				<span class="sheet-resource-input">
					<input type="radio" name="attr_res_allies" value="0" checked>0
					<input type="radio" name="attr_res_allies" value="1">1
					<input type="radio" name="attr_res_allies" value="2">2
					<input type="radio" name="attr_res_allies" value="3">3
					<input type="radio" name="attr_res_allies" value="4">4
					<input type="radio" name="attr_res_allies" value="5">5
				</span>
				<span class="sheet-resource-details sheet-resource-details-allies">
					<div class="sheet-resource-label">Details</div>
					<input type="text" name="attr_res_allies_details">
				</span>

				<span class="sheet-resource-label">Alternate Identity</span>
				<span class="sheet-resource-input">
					<input type="radio" name="attr_res_alternateidentity" value="0" checked>0
					<input type="radio" name="attr_res_alternateidentity" value="1">1
					<input type="radio" name="attr_res_alternateidentity" value="2">2
					<input type="radio" name="attr_res_alternateidentity" value="3">3
					<input type="radio" name="attr_res_alternateidentity" value="4">4
					<input type="radio" name="attr_res_alternateidentity" value="5">5
				</span>
				<span class="sheet-resource-details sheet-resource-details-alternateidentity">
					<div class="sheet-resource-label">Details</div>
					<input type="text" class="sheet-resource-input" name="attr_res_alternateidentity_details">
				</span>

				<span class="sheet-resource-label">Arcane Library</span>
				<span class="sheet-resource-input">
					<input type="radio" name="attr_res_arcanelibrary" value="0" checked>0
					<input type="radio" name="attr_res_arcanelibrary" value="1">1
					<input type="radio" name="attr_res_arcanelibrary" value="2">2
					<input type="radio" name="attr_res_arcanelibrary" value="3">3
					<input type="radio" name="attr_res_arcanelibrary" value="4">4
					<input type="radio" name="attr_res_arcanelibrary" value="5">5
				</span>
				<span class="sheet-resource-details sheet-resource-details-arcanelibrary">
					<div class="sheet-resource-label">Details</div>
					<input type="text" class="sheet-resource-input" name="attr_res_arcanelibrary_details">
				</span>

				<span class="sheet-resource-label">Artifact</span>
				<span class="sheet-resource-input">
					<input type="radio" name="attr_res_artifact" value="0" checked>0
					<input type="radio" name="attr_res_artifact" value="1">1
					<input type="radio" name="attr_res_artifact" value="2">2
					<input type="radio" name="attr_res_artifact" value="3">3
					<input type="radio" name="attr_res_artifact" value="4">4
					<input type="radio" name="attr_res_artifact" value="5">5
				</span>
				<span class="sheet-resource-details sheet-resource-details-artifact">
					<div class="sheet-resource-label">Details</div>
					<input type="text" class="sheet-resource-input" name="attr_res_artifact_details">
				</span>

				<span class="sheet-resource-label">Contacts</span>
				<span class="sheet-resource-input">
					<input type="radio" name="attr_res_contacts" value="0" checked>0
					<input type="radio" name="attr_res_contacts" value="1">1
					<input type="radio" name="attr_res_contacts" value="2">2
					<input type="radio" name="attr_res_contacts" value="3">3
					<input type="radio" name="attr_res_contacts" value="4">4
					<input type="radio" name="attr_res_contacts" value="5">5
				</span>
				<span class="sheet-resource-details sheet-resource-details-contacts">
					<div class="sheet-resource-label">Details</div>
					<input type="text" class="sheet-resource-input" name="attr_res_contacts_details">
				</span>

				<span class="sheet-resource-label">Fame</span>
				<span class="sheet-resource-input">
					<input type="radio" name="attr_res_fame" value="0" checked>0
					<input type="radio" name="attr_res_fame" value="1">1
					<input type="radio" name="attr_res_fame" value="2">2
					<input type="radio" name="attr_res_fame" value="3">3
					<input type="radio" name="attr_res_fame" value="4">4
					<input type="radio" name="attr_res_fame" value="5">5
				</span>
				<span class="sheet-resource-details sheet-resource-details-fame">
					<div class="sheet-resource-label">Details</div>
					<input type="text" class="sheet-resource-input" name="attr_res_fame_details">
				</span>

				<span class="sheet-resource-label">Followers</span>
				<span class="sheet-resource-input">
					<input type="radio" name="attr_res_followers" value="0" checked>0
					<input type="radio" name="attr_res_followers" value="1">1
					<input type="radio" name="attr_res_followers" value="2">2
					<input type="radio" name="attr_res_followers" value="3">3
					<input type="radio" name="attr_res_followers" value="4">4
					<input type="radio" name="attr_res_followers" value="5">5
				</span>
				<span class="sheet-resource-details sheet-resource-details-followers">
					<div class="sheet-resource-label">Details</div>
					<input type="text" class="sheet-resource-input" name="attr_res_followers_details">
				</span>

				<span class="sheet-resource-label">Gadget</span>
				<span class="sheet-resource-input">
					<input type="radio" name="attr_res_gadget" value="0" checked>0
					<input type="radio" name="attr_res_gadget" value="1">1
					<input type="radio" name="attr_res_gadget" value="2">2
					<input type="radio" name="attr_res_gadget" value="3">3
					<input type="radio" name="attr_res_gadget" value="4">4
					<input type="radio" name="attr_res_gadget" value="5">5
				</span>
				<span class="sheet-resource-details sheet-resource-details-gadget">
					<div class="sheet-resource-label">Details</div>
					<input type="text" class="sheet-resource-input" name="attr_res_gadget_details">
				</span>

				<span class="sheet-resource-label">Grimoire</span>
				<span class="sheet-resource-input">
					<input type="radio" name="attr_res_grimoire" value="0" checked>0
					<input type="radio" name="attr_res_grimoire" value="1">1
					<input type="radio" name="attr_res_grimoire" value="2">2
					<input type="radio" name="attr_res_grimoire" value="3">3
					<input type="radio" name="attr_res_grimoire" value="4">4
					<input type="radio" name="attr_res_grimoire" value="5">5
				</span>
				<span class="sheet-resource-details sheet-resource-details-grimoire">
					<div class="sheet-resource-label">Details</div>
					<input type="text" class="sheet-resource-input" name="attr_res_grimoire_details">
				</span>

				<span class="sheet-resource-label">Mentor</span>
				<span class="sheet-resource-input">
					<input type="radio" name="attr_res_mentor" value="0" checked>0
					<input type="radio" name="attr_res_mentor" value="1">1
					<input type="radio" name="attr_res_mentor" value="2">2
					<input type="radio" name="attr_res_mentor" value="3">3
					<input type="radio" name="attr_res_mentor" value="4">4
					<input type="radio" name="attr_res_mentor" value="5">5
				</span>
				<span class="sheet-resource-details sheet-resource-details-mentor">
					<div class="sheet-resource-label">Details</div>
					<input type="text" class="sheet-resource-input" name="attr_res_mentor_details">
				</span>

				<span class="sheet-resource-label">Rank</span>
				<span class="sheet-resource-input">
					<input type="radio" name="attr_res_rank" value="0" checked>0
					<input type="radio" name="attr_res_rank" value="1">1
					<input type="radio" name="attr_res_rank" value="2">2
					<input type="radio" name="attr_res_rank" value="3">3
					<input type="radio" name="attr_res_rank" value="4">4
					<input type="radio" name="attr_res_rank" value="5">5
				</span>
				<span class="sheet-resource-details sheet-resource-details-rank">
					<div class="sheet-resource-label">Details</div>
					<input type="text" class="sheet-resource-input" name="attr_res_rank_details">
				</span>

				<span class="sheet-resource-label">Refuge</span>
				<span class="sheet-resource-input">
					<input type="radio" name="attr_res_refuge" value="0" checked>0
					<input type="radio" name="attr_res_refuge" value="1">1
					<input type="radio" name="attr_res_refuge" value="2">2
					<input type="radio" name="attr_res_refuge" value="3">3
					<input type="radio" name="attr_res_refuge" value="4">4
					<input type="radio" name="attr_res_refuge" value="5">5
				</span>
				<span class="sheet-resource-details sheet-resource-details-refuge">
					<div class="sheet-resource-label">Details</div>
					<input type="text" class="sheet-resource-input" name="attr_res_refuge_details">
				</span>

				<span class="sheet-resource-label">Status</span>
				<span class="sheet-resource-input">
					<input type="radio" name="attr_res_status" value="0" checked>0
					<input type="radio" name="attr_res_status" value="1">1
					<input type="radio" name="attr_res_status" value="2">2
					<input type="radio" name="attr_res_status" value="3">3
					<input type="radio" name="attr_res_status" value="4">4
					<input type="radio" name="attr_res_status" value="5">5
				</span>
				<span class="sheet-resource-details sheet-resource-details-status">
					<div class="sheet-resource-label">Details</div>
					<input type="text" class="sheet-resource-input" name="attr_res_status_details">
				</span>

				<span class="sheet-resource-label">Wealth</span>
				<span class="sheet-resource-input">
					<input type="radio" name="attr_res_wealth" value="0" checked>0
					<input type="radio" name="attr_res_wealth" value="1">1
					<input type="radio" name="attr_res_wealth" value="2">2
					<input type="radio" name="attr_res_wealth" value="3">3
					<input type="radio" name="attr_res_wealth" value="4">4
					<input type="radio" name="attr_res_wealth" value="5">5
				</span>
				<span class="sheet-resource-details sheet-resource-details-wealth">
					<div class="sheet-resource-label">Details</div>
					<input type="text" class="sheet-resource-input" name="attr_res_wealth_details">
				</span>
			</div>

			<div class="sheet-section-header">Notes</div>
			<textarea name="attr_notes" class="sheet-notes-textarea"></textarea>
		
		</div>
	</div>
</div>

<script type="text/worker">
    const buttonlist = ["character","configuration"];
    buttonlist.forEach(button => {
        on(`clicked:${button}`, function() {
            setAttrs({
                sheetTab: button
            });
        });
    });
    
    const primaries = ['body','dexterity','strength','intelligence','charisma','willpower'];
    const skills = ['academics','acrobatics','administration','archery','art','athletics','brawl','computers','con','craft','demolitions','diplomacy','drive','electronics','empathy','firearms','gambling','gunnery','intimidation','investigation','larceny','linguistics','medicine','melee','performance','pilot','ride','ritualmagic','science','stealth','streetwise','supernaturallore','survival'];
	const talents = ['accuracy','agile','alertness','attractive','autofire','blindfight','block','bluntstrike','boldattack','bolddefense','calculatedattack','calculateddefense','charismatic','climb','combataptitude','combatskill','cosmicsensitive','dangersense','diehard','directionsense','dodge','dualwield','eldritchadept','eldritchprodigy','fearsome','finesseattack','flurry','focusedattack','focuseddefense','giant','guardian','headstrong','highpaintolerance','inspire','instantreload','intelligent','ironjaw','ironwill','jump','keensense','kipup','knockoutblow','lethalblow','lifesaver','longshot','lucky','mobileattack','parry','provoke','quickdraw','quickhealer','quickreflexes','rapidshot','resolute','robust','rockofstability','run','skillaptitude','skillmastery','staggeringblow','strafe','strong','strongattack','strongdefense','swift','swim','teamplayer','timesense','totaldefense','totalrecall','tough','toughattack','vigorousdefense','zeroed'];
	const resources = ['allies','alternateidentity','arcanelibrary','artifact','contacts','fame','followers','gadget','grimoire','mentor','rank','refuge','status','wealth'];

	const skillSpecs = skills.map(x => x + '_spec');
	const skillBases = skills.map(x => x + '_base');
	const skillLevels = skills.map(x => x + '_level');
	const talentAttrs = talents.map(x => 'talent_' + x);
	const talentSkillAttrs = talents.map(x => 'talent_' + x + '_skill');
	const resourceAttrs = resources.map(x => 'res_' + x);
	const resourceDetailsAttrs = resources.map(x => 'res_' + x + '_details');

	const skillNameMap = {'academics':'Academics', 'acrobatics':'Acrobatics', 'administration':'Administration', 'archery':'Archery', 'art':'Art', 'athletics':'Athletics', 'brawl':'Brawl', 'computers':'Computers', 'con':'Con', 'craft':'Craft', 'demolitions':'Demolitions', 'diplomacy':'Diplomacy', 'drive':'Drive', 'electronics':'Electronics', 'empathy':'Empathy', 'firearms':'Firearms', 'gambling':'Gambling', 'gunnery':'Gunnery', 'intimidation':'Intimidation', 'investigation':'Investigation', 'larceny':'Larceny', 'linguistics':'Linguistics', 'medicine':'Medicine', 'melee':'Melee', 'performance':'Performance', 'pilot':'Pilot', 'ride':'Ride', 'ritualmagic':'Ritual Magic', 'science':'Science', 'stealth':'Stealth', 'streetwise':'Streetwise', 'supernaturallore':'Supernatural Lore', 'survival':'Survival'};
	const skillStatMap = {'academics':'intelligence', 'acrobatics':'dexterity', 'administration':'intelligence', 'archery':'dexterity', 'art':'intelligence', 'athletics':'strength', 'brawl':'strength', 'computers':'intelligence', 'con':'charisma', 'craft':'intelligence', 'demolitions':'intelligence', 'diplomacy':'charisma', 'drive':'dexterity', 'electronics':'intelligence', 'empathy':'intelligence', 'firearms':'dexterity', 'gambling':'intelligence', 'gunnery':'intelligence', 'intimidation':'charisma', 'investigation':'intelligence', 'larceny':'dexterity', 'linguistics':'intelligence', 'medicine':'intelligence', 'melee':'strength', 'performance':'charisma', 'pilot':'dexterity', 'ride':'dexterity', 'ritualmagic':'intelligence', 'science':'intelligence', 'stealth':'dexterity', 'streetwise':'charisma', 'supernaturallore':'intelligence', 'survival':'intelligence'};
	const talentNameMap = {'talent_accuracy':'Accuracy','talent_agile':'Agile','talent_alertness':'Alertness','talent_attractive':'Attractive','talent_autofire':'Autofire','talent_blindfight':'Blind Fight','talent_block':'Block','talent_bluntstrike':'Blunt Strike','talent_boldattack':'Bold Attack','talent_bolddefense':'Bold Defense','talent_calculatedattack':'Calculated Attack','talent_calculateddefense':'Calculated Defense','talent_charismatic':'Charismatic','talent_climb':'Climb','talent_combataptitude':'Combat Aptitude','talent_combatskill':'Combat Skill','talent_cosmicsensitive':'Cosmic Sensitive','talent_dangersense':'Danger Sense','talent_diehard':'Diehard','talent_directionsense':'Direction Sense','talent_dodge':'Dodge','talent_dualwield':'Dual Wield','talent_eldritchadept':'Eldritch Adept','talent_eldritchprodigy':'Eldritch Prodigy','talent_fearsome':'Fearsome','talent_finesseattack':'Finesse Attack','talent_flurry':'Flurry','talent_focusedattack':'Focused Attack','talent_focuseddefense':'Focused Defense','talent_giant':'Giant','talent_guardian':'Guardian','talent_headstrong':'Headstrong','talent_highpaintolerance':'High Pain Tolerance','talent_inspire':'Inspire','talent_instantreload':'Instant Reload','talent_intelligent':'Intelligent','talent_ironjaw':'Iron Jaw','talent_ironwill':'Iron Will','talent_jump':'Jump','talent_keensense':'Keen Sense','talent_kipup':'Kip Up','talent_knockoutblow':'Knockout Blow','talent_lethalblow':'Lethal Blow','talent_lifesaver':'Lifesaver','talent_longshot':'Long Shot','talent_lucky':'Lucky','talent_mobileattack':'Mobile Attack','talent_parry':'Parry','talent_provoke':'Provoke','talent_quickdraw':'Quick Draw','talent_quickhealer':'Quick Healer','talent_quickreflexes':'Quick Reflexes','talent_rapidshot':'Rapid Shot','talent_resolute':'Resolute','talent_robust':'Robust','talent_rockofstability':'Rock of Stability','talent_run':'Run','talent_skillaptitude':'Skill Aptitude','talent_skillmastery':'Skill Mastery','talent_staggeringblow':'Staggering Blow','talent_strafe':'Strafe','talent_strong':'Strong','talent_strongattack':'Strong Attack','talent_strongdefense':'Strong Defense','talent_swift':'Swift','talent_swim':'Swim','talent_teamplayer':'Team Player','talent_timesense':'Time Sense','talent_totaldefense':'Total Defense','talent_totalrecall':'Total Recall','talent_tough':'Tough','talent_toughattack':'Tough Attack','talent_vigorousdefense':'Vigorous Defense','talent_zeroed':'Zeroed'};
	const resourceNameMap = {'res_allies':'Allies','res_alternateidentity':'Alternate Identity','res_arcanelibrary':'Arcane Library','res_artifact':'Artifact','res_contacts':'Contacts','res_fame':'Fame','res_followers':'Followers','res_gadget':'Gadget','res_grimoire':'Grimoire','res_mentor':'Mentor','res_rank':'Rank','res_refuge':'Refuge','res_status':'Status','res_wealth':'Wealth'};
	
    function setSecondaryAttributes(callback) {
    	getAttrs(primaries, function(pVals) {
    		getAttrs(talentAttrs, function(tVals) {
    			getAttrs(['flaw','eldritch_pool_stat','notes'], function(mVals) {
					let eldritchPoolStat = mVals['eldritch_pool_stat'];
					let flaw = mVals['flaw'];
					let notes = mVals['notes'];
					
					for(let i in pVals) 
						if(pVals.hasOwnProperty(i)) 
							pVals[i] = parseInt(pVals[i] || 0);

					let activeDef, passiveDef;
					if(tVals['talent_bolddefense'] == 1) 
						activeDef = pVals['strength'];
					else if(tVals['talent_calculateddefense'] == 1) 
						activeDef = pVals['intelligence'];
					else 
						activeDef = pVals['dexterity'];

					if(tVals['talent_focuseddefense'] == 1)
						passiveDef = pVals['willpower'];
					else if(tVals['talent_strongdefense'] == 1)
						passiveDef = pVals['strength'];
					else
						passiveDef = pVals['body'];

					setAttrs({
						['size']: (tVals['talent_giant'] == 1 ? 1 : 0) + (flaw==='Dwarf' == 1 ? -1 : 0),
						['move']: pVals['dexterity'] + pVals['strength'] + (flaw=='Lame' == 1 ? -2 : 0),
						['perception']: pVals['intelligence'] + pVals['willpower'] + (tVals['talent_alertness']==1?2:0),
						['initiative']: pVals['dexterity'] + pVals['intelligence'] + (tVals['talent_quickreflexes']==1?2:0),
						['defense']: activeDef + passiveDef,
						['health']: pVals['body'] + pVals['willpower'] + (tVals['talent_robust']==1?2:0),
						['stun']: (tVals['talent_headstrong']==1 ? pVals['willpower'] : pVals['body']) + (tVals['talent_ironjaw']==1?1:0),
						['sanity']: pVals['willpower'] + pVals['charisma'] + (tVals['talent_rockofstability']==1?2:0),
						['resilience']: pVals['willpower'] + pVals['charisma'] + (tVals['talent_resolute']==1?2:0),
						['eldritch_pool']: (tVals['talent_eldritchadept']==1 || tVals['talent_eldritchprodigy']==1 ? pVals[eldritchPoolStat||'body'] * 2 : 0),
						['notes']: notes || '<i>no notes</i>'
					});
				});
			});
		});
		if(typeof callback == 'function') callback();
    } //setSecondaryAttributes//

	function setSkillRatings(callback) {
		getAttrs(primaries, function(pVals) {
			getAttrs(skillLevels, function(sVals) {
				getAttrs(talentAttrs, function(tVals) {
					getAttrs(talentSkillAttrs, function(tsVals) {
						for(let i=0; i<skills.length; i++) {
							let skill = skills[i];
							let base = skillStatMap[skill];
							
							if(tVals['attr_boldattack']==1 && tVals['attr_boldattack_skill']==skill)
								base = 'charisma';
							else if(tVals['attr_calculatedattack']==1 && tVals['attr_calculatedattack_skill']==skill)
								base = 'intelligence';
							else if(tVals['attr_finesseattack']==1 && tVals['attr_finesseattack_skill']==skill)
								base = 'dexterity';
							else if(tVals['attr_focusedattack']==1 && tVals['attr_focusedattack_skill']==skill)
								base = 'willpower';
							else if(tVals['attr_strongattack']==1 && tVals['attr_strongattack_skill']==skill)
								base = 'strength';
							base = parseInt(pVals[base] || 0);

							let level = sVals[skill+'_level'];
							let rating = base + parseInt(level||0);
							let average = Math.floor(rating/2) + (rating%2==1?'+':'');					

							setAttrs({[`${skill}_rating`]:rating,[`${skill}_avg`]:average,[`${skill}_base`]:base});
						} //for//
					});
				});
			});
		});
		if(typeof callback == 'function') callback();
	} //setSkillRatings//
	
	function setTalentList(callback) {
		getAttrs(talentAttrs,function(tVals) {
			getAttrs(talentSkillAttrs,function(sVals) {
				let result = '';
				for(let i=0; i<talentAttrs.length; i++) {
					if(tVals[talentAttrs[i]] == 1) {
						let skill = sVals[talentAttrs[i]+'_skill'];
						result += (result==''?'':', ') + talentNameMap[talentAttrs[i]] + (skill?' ('+skillNameMap[skill]+')':'');
					} //if//
				} //for//

				if(result == '') result = 'no talents';
				setAttrs({['talent_list']:result});
			});
		});
		if(typeof callback == 'function') callback();
	} //setTalentList//
	
	function setResourceList(callback) {
		getAttrs(resourceAttrs,function(rVals) {
			getAttrs(resourceDetailsAttrs,function(dVals) {
				let result = '';

				for(let i=0; i<resourceAttrs.length; i++) {
					let level = parseInt(rVals[resourceAttrs[i]]||0);
					let details = dVals[resourceAttrs[i]+'_details'];
					if(level > 0)
						result += (result==''?'':', ') + resourceNameMap[resourceAttrs[i]] + ' ' + level + (details?' ('+details+')':'');
				} //for//
				if(result == '') result = 'no resources';
				setAttrs({['resource_list']:result});
			});
		});
		if(typeof callback == 'function') callback();
	} //setResourceList//

	function setWeaponValues(callback) {	
		getAttrs(['archery_rating','athletics_rating','firearms_rating','melee_rating','unarmed_rating'], function(sVals) {
			getSectionIDs('weapons', function(ids) {
				for(var i=0; i < ids.length; i++) {
					let id = ids[i];
					getAttrs(
						['repeating_weapons_'+id+'_weapon_rating','repeating_weapons_'+id+'_weapon_skill','repeating_weapons_'+id+'_weapon_spec'],
						function(wVals) {
							let rating = parseInt(wVals['repeating_weapons_'+id+'_weapon_rating'] || 0);
							let spec = wVals['repeating_weapons_'+id+'_weapon_spec'] == 1;
							let skill = wVals['repeating_weapons_'+id+'_weapon_skill'];
							let skillRating = parseInt(sVals[skill+'_rating'] || 0);

							let attack = rating + skillRating + (spec ? 1 : 0);
							let average = Math.floor(attack/2) + (rating%2==0?'':'+');
							setAttrs({
								['repeating_weapons_'+id+'_weapon_attack']:attack,
								['repeating_weapons_'+id+'_weapon_avg']:average
							});
						}
					);
				} //for//
			})
		});
		if(typeof callback == 'function') callback();
	} //setWeaponValues//
	
	on('sheet:opened',function() {
		setSecondaryAttributes(setSkillRatings(setTalentList(setResourceList(setWeaponValues()))));

		getAttrs(skillSpecs,function(values) { setAttrs(values); });
		getAttrs(skillLevels,function(values) { 
			for(let i in values)
				if(values.hasOwnProperty(i))
					values[i] = isNaN(values[i]) ? 0 : parseInt(values[i] || 0);
			setAttrs(values); 
		});
	});
    
    primaries.forEach(function(attr) { 
    	on(`change:${attr}`, function() {
    		setSecondaryAttributes(setSkillRatings(setWeaponValues()));
    	})
    });

    on('change:flaw change:eldritch_pool_stat change:notes', function() {
    	setSecondaryAttributes(setSkillRatings(setWeaponValues()));
    });

    skillLevels.forEach(function(attr) { 
    	on(`change:${attr}`, function() {
    		setSkillRatings(setWeaponValues());
    	})
    });
   
   	talentAttrs.forEach(function(attr) { 
    	on(`change:${attr}`, function() {
    		setSecondaryAttributes(setSkillRatings(setTalentList(setWeaponValues())));
    	})
    });

   	resourceAttrs.forEach(function(attr) { 
    	on(`change:${attr}`, function() {
    		setResourceList();
    	})
    });

   	resourceDetailsAttrs.forEach(function(attr) { 
    	on(`change:${attr}`, function() {
    		setResourceList();
    	})
    });

	on("change:repeating_weapons:weapon_rating change:repeating_weapons:weapon_skill change:repeating_weapons:weapon_spec", setWeaponValues);


    
</script>

<rolltemplate class="sheet-rolltemplate-skill">
    <div class="sheet-template-container">
		<div class="sheet-template-header">{{name}}</div>
		<div class="sheet-template-body">
			<span class="sheet-template-skill">{{skill}}</span>
			{{#spec}}<span class="sheet-template-spec">&nbsp;({{spec}})</span>{{/spec}} 
			<span class="sheet-template-result">{{result}}</span>
		</div>
	</div>
</rolltemplate>

