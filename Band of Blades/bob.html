<div class="sheet-topholder">
	<div class="sheet-settings-checkbox-holder"><input type="checkbox" name="attr_show_settings" class="sheet-settings-checkbox"/><span>y</span>
  </div>
</div>

<input type="checkbox" name="attr_show_settings" class="sheet-hidden"/>
<div class="sheet-settings">
	<div class="sheet-col100 sheet-version-text"><span>Type name of the Playbook in the appropriate area to populate appropriate ratings/abilities/gear.</span></div>
	<div class="sheet-col100">
    <select name="attr_generate_source" title="Choose source">
           <option value="heavy">Heavy</option>
           <option value="medic">Medic</option>
           <option value="scout">Scout</option>
           <option value="sniper">Sniper</option>
           <option value="officer">Officer</option>
           <option value="soldier">Soldier</option>
           <option value="rookie">Rookie</option>
       </select>
       <input type="checkbox" class="sheet-generatebutton" name="attr_generate_abilities"/><span>Add abilities</span>
   </div>
   <div class="sheet-col50"><input type="checkbox" name="attr_setting_extra_stress1" class="sheet-checkbox sheet-squarebox"/><span></span><span>Show an extra 2 stress boxes</span></div>
   <div class="sheet-col50"><input type="checkbox" name="attr_setting_extra_stress2" class="sheet-checkbox sheet-squarebox"/><span></span><span>Show another 2 stress boxes</span></div>
   <div class="sheet-col50"><input type="checkbox" name="attr_setting_extra_trauma" class="sheet-checkbox sheet-squarebox"/><span></span><span>Show an extra trauma box</span></div>
   <div class="sheet-col50"><input type="checkbox" name="attr_setting_extra_trauma2" class="sheet-checkbox sheet-squarebox"/><span></span><span>Show an extra trauma box</span></div>
   <div class="sheet-col50"><input type="checkbox" name="attr_setting_extra_xp" class="sheet-checkbox sheet-squarebox"/><span></span><span>Show an extra xp condition</span></div>
   <div class="sheet-col50"><input type="checkbox" name="attr_setting_showitem_0" class="sheet-checkbox sheet-squarebox" checked/><span></span><span>Show playbook item 0</span></div>
   <div class="sheet-col50"><input type="checkbox" name="attr_setting_showitem_1" class="sheet-checkbox sheet-squarebox" checked/><span></span><span>Show playbook item 1</span></div>
   <div class="sheet-col50"><input type="checkbox" name="attr_setting_showitem_2" class="sheet-checkbox sheet-squarebox" checked/><span></span><span>Show playbook item 2</span></div>
   <div class="sheet-col50"><input type="checkbox" name="attr_setting_showitem_3" class="sheet-checkbox sheet-squarebox" checked/><span></span><span>Show playbook item 3</span></div>
   <div class="sheet-col50"><input type="checkbox" name="attr_setting_showitem_4" class="sheet-checkbox sheet-squarebox" checked/><span></span><span>Show playbook item 4</span></div>
   <div class="sheet-col50"><input type="checkbox" name="attr_setting_showitem_5" class="sheet-checkbox sheet-squarebox" checked/><span></span><span>Show playbook item 5</span></div>
   <div class="sheet-col50"><input type="checkbox" name="attr_setting_showitem_6" class="sheet-checkbox sheet-squarebox" checked/><span></span><span>Show playbook item 6</span></div>
   <div class="sheet-col50"><input type="checkbox" name="attr_setting_showitem_7" class="sheet-checkbox sheet-squarebox" checked/><span></span><span>Show playbook item 7</span></div>
   <div class="sheet-col50"><input type="checkbox" name="attr_setting_showitem_8" class="sheet-checkbox sheet-squarebox" checked/><span></span><span>Show playbook item 8</span></div>
   <div class="sheet-col50"><input type="checkbox" name="attr_setting_showitem_9" class="sheet-checkbox sheet-squarebox" checked/><span></span><span>Show playbook item 9</span></div>
   <div class="sheet-col50"><input type="checkbox" name="attr_setting_showitem_10" class="sheet-checkbox sheet-squarebox" checked/><span></span><span>Show playbook item 10</span></div>
   <div class="sheet-col50"><input type="checkbox" name="attr_setting_showitem_11" class="sheet-checkbox sheet-squarebox" checked/><span></span><span>Show playbook item 11</span></div>
   <div class="sheet-col50"><input type="checkbox" name="attr_setting_showitem_12" class="sheet-checkbox sheet-squarebox" checked/><span></span><span>Show playbook item 12</span></div>
   <div class="sheet-col50"><input type="checkbox" name="attr_setting_showitem_13" class="sheet-checkbox sheet-squarebox" checked/><span></span><span>Show playbook item 13</span></div>
   <div class="sheet-col50"><input type="checkbox" name="attr_setting_showitem_14" class="sheet-checkbox sheet-squarebox" checked/><span></span><span>Show playbook item 14</span></div>
   <div class="sheet-col50"><input type="checkbox" name="attr_setting_showitem_15" class="sheet-checkbox sheet-squarebox" checked/><span></span><span>Show playbook item 15</span></div>
   <div class="sheet-col50"><input type="checkbox" name="attr_setting_showitem_16" class="sheet-checkbox sheet-squarebox" checked/><span></span><span>Show playbook item 16</span></div>
   <div class="sheet-col50"><input type="checkbox" name="attr_setting_showitem_17" class="sheet-checkbox sheet-squarebox" checked/><span></span><span>Show playbook item 17</span></div>
   <div class="sheet-col50"><input type="text" name="attr_setting_stress_label" value="Stress"/><span></span><span>Label to use for Stress</span></div>
   <div class="sheet-col50"><input type="text" name="attr_setting_trauma_label" value="Trauma"/><span></span><span>Label to use for Trauma</span></div>
   <div class="sheet-col50"><input type="text" name="attr_setting_corruption_label" value="Corruption"/><span></span><span>Label to use for Corruption</span></div>
   <div class="sheet-col50"><input type="text" name="attr_setting_blight_label" value="Blight"/><span></span><span>Label to use for Blight</span></div>
   <div class="sheet-settings-load sheet-col100">
        <input type="checkbox" name="attr_character" class="sheet-text-input sheet-isLegionaire"/><span>Legionaire</span>
        <input type="checkbox" name="attr_commander" class="sheet-text-input sheet-isCommander"/><span>Commander</span>
        <input type="checkbox" name="attr_quartermaster" class="sheet-text-input sheet-isQuartermaster"/><span>Quartermaster</span>
        <input type="checkbox" name="attr_marshal" class="sheet-text-input sheet-isMarshal"/><span>Marshall</span>
    </div>
    <div class="sheet-settings-load sheet-col100">
       <span>Load: </span>
       <input type="number" name="attr_setting_load_l" value="3"/><span> light</span>
       <input type="number" name="attr_setting_load_n" value="5"/><span> normal</span>
       <input type="number" name="attr_setting_load_h" value="7"/><span> heavy</span>
   </div>
   <div class="sheet-col100 sheet-version-text"><span>Original by Tim Denee & Jakob Oesinghaus </span></div>
</div>

<!-- CHARACTER SHEET START-->
<div class="sheet-type-character sheet-container">
	<div class="sheet-col55">
       <div class="sheet-logoholder">
           <div class="sheet-scumlogo"></div>
       </div>
    </div>
    <div class="sheet-playbook">
        <div class="sheet-playbook-title">
            <input type="text" name="attr_playbook" class="sheet-label" placeholder="playbook"/>
        </div>
        <div class="sheet-playbook-desc">
            <textarea spellcheck="false" name="attr_playbook_description" class="sheet-label" placeholder="A short playbook description"></textarea>
        </div>
    </div>
    <div class="sheet-col55">
        <div class="sheet-col100 sheet-header">
            <div class="sheet-col55">
                <input type="text" name="attr_name"/><label>Name</label>
                <input type="text" name="attr_look"/><label>Look</label>
                <input type="text" name="attr_heritage"/><label>Heritage</label>
            </div>

            <div class="sheet-col45">
                <div class="sheet-traumata">
                    <div>
                        <input type="text" name="attr_heritage"/>
                        <input type="checkbox" name="attr_bartan" class="sheet-text-input sheet-isBartan"/><span>Bartan</span>
                        <input type="checkbox" name="attr_panyar" class="sheet-text-input sheet-isPanyar"/><span>Pany√£r</span>
                        <input type="checkbox" name="attr_orite" class="sheet-text-input sheet-isOrite"/><span>Orite</span>
                        <input type="checkbox" name="attr_zemyati" class="sheet-text-input sheet-last sheet-isZemyati"/><span>Zemyati</span><br/>
                        <div class="sheet-regularitems sheet-col100 sheet-bartan">
                            <div class="sheet-item"><input type="checkbox" name="attr_bartan_2_check" class="sheet-checkbox sheet-squarebox"/><span></span><input type="text" value="Warm: +1 consort (max 2)." name="attr_bartan_2_desc"/></div>
                            <div class="sheet-item"><input type="checkbox" name="attr_bartan_1_check" class="sheet-checkbox sheet-squarebox"/><span></span><input type="text" value="Pious: Always equip a Reliquary." name="attr_bartan_1_desc"/></div>
                            <div class="sheet-item"><input type="checkbox" name="attr_bartan_3_check" class="sheet-checkbox sheet-squarebox"/><span></span><input type="text" value="Stoic: +1d to prowess resist." name="attr_bartan_3_desc"/></div>
                            <div class="sheet-item"><input type="checkbox" name="attr_bartan_4_check" class="sheet-checkbox sheet-squarebox"/><span></span><input type="text" value="Educated: +1 research (max 2)." name="attr_bartan_4_desc"/></div>
                        </div>
                        <div class="sheet-regularitems sheet-col100 sheet-panyar">
                            <div class="sheet-item"><input type="checkbox" name="attr_panyar_1_check" class="sheet-checkbox sheet-squarebox"/><span></span><input type="text" value="Artisan: You can have up to 4 rig." name="attr_panyar_1_desc"/></div>
                            <div class="sheet-item"><input type="checkbox" name="attr_panyar_2_check" class="sheet-checkbox sheet-squarebox"/><span></span><input type="text" value="Traveller: Fast and quiet in normal load." name="attr_panyar_2_desc"/></div>
                            <div class="sheet-item"><input type="checkbox" name="attr_panyar_3_check" class="sheet-checkbox sheet-squarebox"/><span></span><input type="text" value="Shrewd: +1d to insight resist." name="attr_panyar_3_desc"/></div>
                            <div class="sheet-item"><input type="checkbox" name="attr_panyar_4_check" class="sheet-checkbox sheet-squarebox"/><span></span><input type="text" value="Marked: +2d to resist corruption." name="attr_panyar_4_desc"/></div>
                        </div>
                        <div class="sheet-regularitems sheet-col100 sheet-orite">
                            <div class="sheet-item"><input type="checkbox" name="attr_orite_1_check" class="sheet-checkbox sheet-squarebox"/><span></span><input type="text" value="Noble: Boost one campaign action for you." name="attr_orite_1_desc"/></div>
                            <div class="sheet-item"><input type="checkbox" name="attr_orite_2_check" class="sheet-checkbox sheet-squarebox"/><span></span><input type="text" value="Connected: +1 sway (max 3)." name="attr_orite_2_desc"/></div>
                            <div class="sheet-item"><input type="checkbox" name="attr_orite_3_check" class="sheet-checkbox sheet-squarebox"/><span></span><input type="text" value="Vengeful: potency when harm penalized." name="attr_orite_3_desc"/></div>
                            <div class="sheet-item"><input type="checkbox" name="attr_orite_4_check" class="sheet-checkbox sheet-squarebox"/><span></span><input type="text" value="Stern: +1 discipline (max 2)." name="attr_orite_4_desc"/></div>
                        </div>
                        <div class="sheet-regularitems sheet-col100 sheet-zemyati">
                            <div class="sheet-item"><input type="checkbox" name="attr_zemyati_1_check" class="sheet-checkbox sheet-squarebox"/><span></span><input type="text" value="Tough: ignore lvl 1 harm penalties." name="attr_zemyati_1_desc"/></div>
                            <div class="sheet-item"><input type="checkbox" name="attr_zemyati_2_check" class="sheet-checkbox sheet-squarebox"/><span></span><input type="text" value="Bold: +1d to resist on desparate actions." name="attr_zemyati_2_desc"/></div>
                            <div class="sheet-item"><input type="checkbox" name="attr_zemyati_3_check" class="sheet-checkbox sheet-squarebox"/><span></span><input type="text" value="Loyal: +1d in group actions." name="attr_zemyati_3_desc"/></div>
                            <div class="sheet-item"><input type="checkbox" name="attr_zemyati_4_check" class="sheet-checkbox sheet-squarebox"/><span></span><input type="text" value="Stubborn: +1d to resolve resist." name="attr_zemyati_4_desc"/></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="sheet-col100 sheet-stress sheet-def-margin">
            <div class="sheet-blackheader sheet-stress1">
                <div class="sheet-label">
                    <span class="sheet-inherit" name="attr_setting_stress_label"></span>
                </div>
                <div class="sheet-zeroholder">
                    <input type="radio" value="0" name="attr_stress" class="sheet-zero" checked/><span></span>
                </div>
            </div>


            <!-- STRESS DON'T SPACE OUT -->
            <div class="sheet-blackheader sheet-stress2 ">
               <input type="checkbox" name="attr_setting_extra_stress1" class="sheet-hidden"/><input type="checkbox" name="attr_setting_extra_stress2" class="sheet-hidden"/><input type="checkbox" name="attr_setting_extra_stress3" class="sheet-hidden"/><input type="checkbox" name="attr_setting_extra_stress4" class="sheet-hidden"/><input type="checkbox" value="0" name="attr_stress" class="sheet-tooth sheet-xptooth sheet-hidden" checked/><input type="radio" value="1" name="attr_stress" class="sheet-tooth sheet-xptooth"/><span></span><input type="radio" value="2" name="attr_stress" class="sheet-tooth sheet-tooth sheet-xptooth"/><span></span><input type="radio" value="3" name="attr_stress" class="sheet-tooth sheet-tooth sheet-xptooth"/><span></span><input type="radio" value="4" name="attr_stress" class="sheet-tooth sheet-tooth sheet-xptooth"/><span></span><input type="radio" value="5" name="attr_stress" class="sheet-tooth sheet-tooth sheet-xptooth"/><span></span><input type="radio" value="6" name="attr_stress" class="sheet-tooth sheet-tooth sheet-xptooth"/><span></span><input type="checkbox" name="attr_setting_extra_stress1" class="sheet-hidden sheet-toothhider"/><input type="radio" value="7" name="attr_stress" class="sheet-tooth sheet-tooth sheet-xptooth"/><span></span><input type="checkbox" name="attr_setting_extra_stress1" class="sheet-hidden sheet-toothhider"/><input type="radio" value="8" name="attr_stress" class="sheet-tooth sheet-tooth sheet-xptooth"/><span></span><input type="checkbox" name="attr_setting_extra_stress2" class="sheet-hidden sheet-toothhider"/><input type="radio" value="9" name="attr_stress" class="sheet-tooth sheet-tooth sheet-xptooth"/><span></span><input type="checkbox" name="attr_setting_extra_stress2" class="sheet-hidden sheet-toothhider"/><input type="radio" value="10" name="attr_stress" class="sheet-tooth sheet-tooth sheet-xptooth"/><span></span>
            </div>
            <div class="sheet-stress3">
                <div class="sheet-blackheader">
                    <div class="sheet-label"><span name="attr_setting_trauma_label" class="sheet-inherit"></span></div>
                </div>
                <div class="sheet-zeroholder">
                    <input type="radio" value="0" name="attr_trauma" class="sheet-zero" checked/><span></span>
                </div>
                <!-- TRAUMA DON'T SPACE OUT -->
                <div class="sheet-traumaholder">
                    <input type="checkbox" value="0" name="attr_trauma" class="sheet-regulartooth sheet-hidden" checked/><input type="radio" value="1" name="attr_trauma" class="sheet-tooth sheet-regulartooth"/><span></span><input type="radio" value="2" name="attr_trauma" class="sheet-tooth sheet-regulartooth"/><span></span><input type="checkbox" name="attr_setting_extra_trauma" class="sheet-hidden sheet-toothhider"/><input type="radio" value="3" name="attr_trauma" class="sheet-tooth sheet-regulartooth"/><span></span><input type="checkbox" name="attr_setting_extra_trauma2" class="sheet-hidden sheet-toothhider"/><input type="radio" value="4" name="attr_trauma" class="sheet-tooth sheet-regulartooth"/><span></span>
                </div>
            </div>
            <div class="sheet-traumata sheet-stress4 sheet-blackborder">
                <input type="checkbox" class="sheet-hidden sheet-hidediv" name="attr_setting_traumata_set" value="normal" checked/>
                <div>
                    <input type="checkbox" name="attr_cold" class="sheet-text-input"/><span>Cold</span>
                    <input type="checkbox" name="attr_haunted" class="sheet-text-input"/><span>Haunted</span>
                    <input type="checkbox" name="attr_obsessed" class="sheet-text-input"/><span>Obsessed</span>
                    <input type="checkbox" name="attr_paranoid" class="sheet-text-input sheet-last"/><span>Paranoid</span><br/>
                    <input type="checkbox" name="attr_reckless" class="sheet-text-input sheet-traumarow2"/><span>Reckless</span>
                    <input type="checkbox" name="attr_soft" class="sheet-text-input sheet-traumarow2"/><span>Soft</span>
                    <input type="checkbox" name="attr_unstable" class="sheet-text-input sheet-traumarow2"/><span>Unstable</span>
                    <input type="checkbox" name="attr_vicious" class="sheet-text-input sheet-last sheet-traumarow2"/><span>Vicious</span>
                </div>
            </div>
        </div>

        <div class="sheet-col100 sheet-stress sheet-def-margin">
            <div class="sheet-blackheader sheet-corruption1">
                <div class="sheet-label">
                    <span class="sheet-inherit" name="attr_setting_corruption_label"></span>
                </div>
                <div class="sheet-zeroholder">
                    <input type="radio" value="0" name="attr_corruption" class="sheet-zero" checked/><span></span>
                </div>
            </div>

            <!-- CORRUPTION DON'T SPACE OUT -->
            <div class="sheet-blackheader sheet-corruption2 ">
                <input type="checkbox" value="0" name="attr_corruption" class="sheet-tooth sheet-xptooth sheet-hidden" checked/><input type="radio" value="1" name="attr_corruption" class="sheet-tooth sheet-xptooth"/><span></span><input type="radio" value="2" name="attr_corruption" class="sheet-tooth sheet-tooth sheet-xptooth"/><span></span><input type="radio" value="3" name="attr_corruption" class="sheet-tooth sheet-tooth sheet-xptooth"/><span></span><input type="radio" value="4" name="attr_corruption" class="sheet-tooth sheet-tooth sheet-xptooth"/><span></span><input type="radio" value="5" name="attr_corruption" class="sheet-tooth sheet-tooth sheet-xptooth"/><span></span><input type="radio" value="6" name="attr_corruption" class="sheet-tooth sheet-tooth sheet-xptooth"/><span></span>
            </div>
            <div class="sheet-stress3">
                <div class="sheet-blackheader">
                    <div class="sheet-label">
                        <span name="attr_setting_blight_label" class="sheet-inherit"></span>
                    </div>
                </div>
                <div class="sheet-zeroholder">
                    <input type="radio" value="0" name="attr_blight" class="sheet-zero" checked/><span></span>
                </div>
                <!-- BLIGHT DON'T SPACE OUT -->
                <div class="sheet-traumaholder">
                    <input type="checkbox" value="0" name="attr_blight" class="sheet-regulartooth sheet-hidden" checked/><input type="radio" value="1" name="attr_blight" class="sheet-tooth sheet-regulartooth"/><span></span><input type="radio" value="2" name="attr_blight" class="sheet-tooth sheet-regulartooth"/><span></span><input type="radio" value="3" name="attr_blight" class="sheet-tooth sheet-regulartooth"/><span></span><input type="radio" value="4" name="attr_blight" class="sheet-tooth sheet-regulartooth"/><span></span>
                </div>
            </div>
            <div class="sheet-traumata sheet-stress4 sheet-blackborder">
                <input type="checkbox" class="sheet-hidden sheet-hidediv" name="attr_setting_corruptions_set" value="normal" checked/>
                <div>
                    <input type="checkbox" name="attr_anathema" class="sheet-text-input"/><span>Anathema</span>
                    <input type="checkbox" name="attr_host" class="sheet-text-input"/><span>Host</span>
                    <input type="checkbox" name="attr_hunger" class="sheet-text-input"/><span>Hunger</span>
                    <input type="checkbox" name="attr_miasma" class="sheet-text-input sheet-last"/><span>Miasma</span><br/>
                    <input type="checkbox" name="attr_mutation" class="sheet-text-input sheet-traumarow2"/><span>Mutation</span>
                    <input type="checkbox" name="attr_rage" class="sheet-text-input sheet-traumarow2"/><span>Rage</span>
                    <input type="checkbox" name="attr_rot" class="sheet-text-input sheet-traumarow2"/><span>Rot</span>
                    <input type="checkbox" name="attr_visions" class="sheet-text-input sheet-last sheet-traumarow2"/><span>Visions</span>
                </div>
            </div>
        </div>
        <div class="sheet-col100 sheet-def-margin">
           <!-- HARM -->
           <div class="sheet-harm sheet-col68">
               <div class="sheet-blackheader sheet-harmheader sheet-col100">
                   <div class="sheet-label">Harm</div>
               </div>
               <div class="sheet-harm-grid sheet-col100">
                   <div class="sheet-label sheet-harm-three sheet-harmrow">3</div>
                   <div class="sheet-harm-descriptionthree sheet-harmrow">
                       <input type="text" name="attr_harm3"/>
                   </div>
                   <div class="sheet-harm-checksthree sheet-harmrow">
                        <div><input type="checkbox" name="attr_harm_3_check_1" class="sheet-checkbox sheet-squarebox-small"/><span></span></div><div><input type="checkbox" name="attr_harm_3_check_2" class="sheet-checkbox sheet-squarebox-small"/><span></span></div><div><input type="checkbox" name="attr_harm_3_check_3" class="sheet-checkbox sheet-squarebox-small"/><span></span></div>
                   </div>
                   <div class="sheet-label sheet-harm-labelthree sheet-harmrow">Need Help</div>
                   <div class="sheet-label sheet-harm-two sheet-harmrow">2</div>
                   <div class="sheet-harm-descriptiontwoa sheet-harmrow">
                       <input type="text" name="attr_harm2_1"/>
                   </div>
                   <div class="sheet-harm-descriptiontwob sheet-harmrow">
                       <input type="text" name="attr_harm2_2"/>
                   </div>
                   <div class="sheet-harm-checkstwo sheet-harmrow">
                        <div><input type="checkbox" name="attr_harm_2_check_1" class="sheet-checkbox sheet-squarebox-small"/><span></span></div><div><input type="checkbox" name="attr_harm_2_check_2" class="sheet-checkbox sheet-squarebox-small"/><span></span></div>
                   </div>
                   <div class="sheet-label sheet-harm-labeltwo sheet-harmrow">-1D</div>
                   <div class="sheet-label sheet-harm-one sheet-harmrow">1</div>
                   <div class="sheet-harm-descriptiononea sheet-harmrow">
                       <input type="text" name="attr_harm1_1"/>
                   </div>
                   <div class="sheet-harm-descriptiononeb sheet-harmrow">
                       <input type="text" name="attr_harm1_2"/>
                   </div>
                   <div class="sheet-harm-checksone sheet-harmrow">
                        <div><input type="checkbox" name="attr_harm_1_check_1" class="sheet-checkbox sheet-squarebox-small"/><span></span></div>
                   </div>
                   <div class="sheet-label sheet-harm-labelone sheet-harmrow">Less Effect</div>
               </div>
           </div>

           <div class="sheet-col30 sheet-armorholder">
               <!-- ARMOR -->
               <div class="sheet-armor sheet-col100">
                   <div class="sheet-attribute-title sheet-col100">
                      <div class="sheet-label">Armor</div>
                      <div class="sheet-armor-tick-box"><input type="radio" value="0" name="attr_armor" class="sheet-zero" checked/><span></span><input type="checkbox" value="0" name="attr_armor" class="sheet-hidden sheet-xptooth" checked/><input type="radio" value="1" name="attr_armor" class="sheet-tooth sheet-xptooth"/><span></span></div>
                  </div><br clear="all" />

                   <div class="sheet-attribute-title sheet-col100">
                      <div class="sheet-label">Shield</div>
                      <div class="sheet-armor-tick-box"><input type="radio" value="0" name="attr_shield" class="sheet-zero" checked/><span></span><input type="checkbox" value="0" name="attr_shield" class="sheet-hidden sheet-xptooth" checked/><input type="radio" value="1" name="attr_shield" class="sheet-tooth sheet-xptooth"/><span></span></div>
                  </div><br clear="all" />

                  <div class="sheet-attribute-title sheet-col00">
                    <div class="sheet-label sheet-specialarmorlabel"><input type="text" placeholder="Special" name="attr_special_armor1"/></div>
                    <div class="sheet-armor-tick-box"><input type="radio" value="0" name="attr_armor_special" class="sheet-zero" checked/><span></span><input type="checkbox" value="0" name="attr_armor_special" class="sheet-hidden sheet-xptooth" checked/><input type="radio" value="1" name="attr_armor_special" class="sheet-tooth sheet-xptooth"/><span></span><input type="radio" value="2" name="attr_armor_special" class="sheet-tooth sheet-xptooth"/><span></span></div>
                </div><br clear="all" />
                <div class="sheet-attribute-title sheet-col00">
                    <div class="sheet-label sheet-specialarmorlabel"><input type="text" placeholder="Other" name="attr_special_armor2"/></div>
                    <div class="sheet-armor-tick-box"><input type="radio" value="0" name="attr_armor_special2" class="sheet-zero" checked/><span></span><input type="checkbox" value="0" name="attr_armor_special2" class="sheet-hidden sheet-xptooth" checked/><input type="radio" value="1" name="attr_armor_special2" class="sheet-tooth sheet-xptooth"/><span></span></div>
                </div>
            </div>
        </div>
    </div>

    <!-- SPECIAL ABILITIES -->
    <div class="sheet-col100 sheet-def-margin">
        <div class="sheet-specialheader sheet-col100 sheet-label">Special Abilities</div>
        <div class="sheet-greyholder sheet-col100">
            <fieldset class="repeating_ability">
                <div class="sheet-specialability sheet-rep-block">
                   <input type="checkbox" name="attr_check" class="sheet-checkbox sheet-circlebox"/><span></span>
                   <textarea spellcheck="false" class="sheet-abilityname" name="attr_name" placeholder="Ability Name"></textarea>
                   <textarea spellcheck="false" class="sheet-abilitydesc" name="attr_description" placeholder="Ability description"></textarea>
               </div>
           </fieldset>
        </div>
    </div>
    <!-- ADVANCEMENT -->
    <div class="sheet-col100 sheet-advancement">
       <div class="sheet-advancement-header sheet-blackheader">
           <div class="sheet-advancement-markxp sheet-label">Mark XP:</div>
           <div class="sheet-advancement-tracker">
               <div class="sheet-advancement-xpholder">
                <!-- XP DO NOT SPACE -->
                <input type="radio" value="0" name="attr_playbook_xp" class="sheet-zero" checked/><span></span>
                <input type="checkbox" value="0" name="attr_playbook_xp" class="sheet-xptooth sheet-hidden" checked/><input type="radio" value="1" name="attr_playbook_xp" class="sheet-tooth sheet-xptooth"/><span></span><input type="radio" value="2" name="attr_playbook_xp" class="sheet-tooth sheet-xptooth"/><span></span><input type="radio" value="3" name="attr_playbook_xp" class="sheet-tooth sheet-xptooth"/><span></span><input type="radio" value="4" name="attr_playbook_xp" class="sheet-tooth sheet-xptooth"/><span></span><input type="radio" value="5" name="attr_playbook_xp" class="sheet-tooth sheet-xptooth"/><span></span><input type="radio" value="6" name="attr_playbook_xp" class="sheet-tooth sheet-xptooth"/><span></span><input type="radio" value="7" name="attr_playbook_xp" class="sheet-tooth sheet-xptooth"/><span></span><input type="radio" value="8" name="attr_playbook_xp" class="sheet-tooth sheet-xptooth"/><span></span><input type="checkbox" name="attr_setting_vampirexp" class="sheet-hidden sheet-toothhider"/><input type="radio" value="9" name="attr_playbook_xp" class="sheet-tooth sheet-xptooth"/><span></span><input type="checkbox" name="attr_setting_vampirexp" class="sheet-hidden sheet-toothhider"/><input type="radio" value="10" name="attr_playbook_xp" class="sheet-tooth sheet-xptooth"/><span></span>
            </div>
            <div class="sheet-advancement-label sheet-label">Playbook Advancement </div>
        </div>
    </div>
    <!-- XP TRIGGERS -->
    <div class="sheet-advancement-desc">
       <ul>
           <li>Every time you roll a desperate action, mark xp in that action's attribute.</li>
           <li class="sheet-nondot">At the end of each mission mark 1xp (in your playbook or an attribute)...</li>
           <li><input type="text" value="You survived the mission." name="attr_xp_condition0"/></li>
           <li><input type="text" placeholder="Enter your playbook's specific way to mark XP here." name="attr_xp_condition"/></li>
           <input type="checkbox" name="attr_setting_extra_xp" class="sheet-hidden sheet-xp-hider"/><li><input type="text" placeholder="Enter another specific way to mark XP here." name="attr_xp_condition_extra"/></li>
           <li><input type="text" value="You brought into play your heritage, or traumas. (2xp if you did both)" name="attr_xp_condition2"/></li>
           <li><input type="text" value="Per highest Threat of opponent faced." name="attr_xp_condition3"/></li>
       </ul>
    </div>
    </div>
</div>
<!-- LOAD -->
<div class="sheet-col45">
	<div class="sheet-col50b">
        <div class="sheet-loadheader sheet-col100">
            <span class="sheet-label">Load</span>
            <div class="sheet-loadcheckholder"><div class="sheet-loadboxholder"><input type="checkbox" name="attr_load" value="light" class="sheet-loadbox"/><span></span></div><span class="sheet-loadnumber" name="attr_setting_load_l"></span><span>Light</span></div><div class="sheet-loadcheckholder"><div class="sheet-loadboxholder"><input type="checkbox" name="attr_load" value="normal" class="sheet-loadbox"/><span></span></div><span class="sheet-loadnumber" name="attr_setting_load_n"></span><span>Normal</span></div><div class="sheet-loadcheckholder"><div class="sheet-loadboxholder"><input type="checkbox" name="attr_load" value="heavy" class="sheet-loadbox sheet-isHeavy"/><span></span></div><span class="sheet-loadnumber" name="attr_setting_load_h"></span><span>Heavy</span></div></div>
            <div class="sheet-loadheader2 sheet-col100">
                <span class="sheet-label">Items</span>
                <span>* = assigned on every mission
            </div>
            <!-- PLAYBOOK ITEMS -->
            <div class="sheet-itemholder sheet-white-repcontrol sheet-col100 sheet-items">
                <div class="sheet-playbookitems sheet-col100">
                    <input type="checkbox" name="attr_load" value="light" class="sheet-loadbox sheet-isLight"/>
                    <input type="checkbox" name="attr_load" value="normal" class="sheet-loadbox sheet-isNormal"/>
                    <input type="checkbox" name="attr_load" value="heavy" class="sheet-loadbox sheet-isHeavy"/>
                    <div class="sheet-light sheet-load-hidable">
                    <!-- Default Item 1 --><input type="checkbox" name="attr_setting_showitem_0" class="sheet-hidden sheet-itemhider" checked/><div class="sheet-item"><input type="checkbox" name="attr_item_0_check" class="sheet-checkbox sheet-squarebox" checked/><span></span><input type="text" placeholder="Item 0" name="attr_item_0_desc"/></div>
                    <!-- Default Item 2 --><input type="checkbox" name="attr_setting_showitem_1" class="sheet-hidden sheet-itemhider" checked/><div class="sheet-item"><input type="checkbox" name="attr_item_1_check" class="sheet-checkbox sheet-squarebox" checked/><span></span><input type="text" placeholder="Item 1" name="attr_item_1_desc"/></div>
                    <!-- Default Item 3 --><input type="checkbox" name="attr_setting_showitem_2" class="sheet-hidden sheet-itemhider" checked/><div class="sheet-item"><input type="checkbox" name="attr_item_2_check" class="sheet-checkbox sheet-squarebox" checked/><span></span><input type="text" placeholder="Item 2" name="attr_item_2_desc"/></div>
                    <!-- Default Item 4 --><input type="checkbox" name="attr_setting_showitem_3" class="sheet-hidden sheet-itemhider" checked/><div class="sheet-item"><input type="checkbox" name="attr_item_3_check" class="sheet-checkbox sheet-squarebox" checked/><span></span><input type="text" placeholder="Item 3" name="attr_item_3_desc"/></div>
                    <!-- Default Item 5 --><input type="checkbox" name="attr_setting_showitem_4" class="sheet-hidden sheet-itemhider" checked/><div class="sheet-item"><input type="checkbox" name="attr_item_4_check" class="sheet-checkbox sheet-squarebox" checked/><span></span><input type="text" placeholder="Item 4" name="attr_item_4_desc"/></div>
                    <!-- Choose --><input type="checkbox" name="attr_setting_showitem_6" class="sheet-hidden sheet-itemhider" checked/><div class="sheet-item"><input type="text" placeholder="CHOOSE" name="attr_item_choose_5_or_6"/></div>
                    <!-- Optional Item 1 --><input type="checkbox" name="attr_setting_showitem_5" class="sheet-hidden sheet-itemhider" checked/><div class="sheet-item"><input type="checkbox" name="attr_item_5_check" class="sheet-checkbox sheet-squarebox"/><span></span><input type="text" placeholder="Fine one-slot item" name="attr_item_5_desc"/></div>
                    <!-- Or --><input type="checkbox" name="attr_setting_showitem_6" class="sheet-hidden sheet-itemhider" checked/><div class="sheet-item"><input type="text" placeholder="-OR-" name="attr_item_5_or_6"/></div>
                    <!-- Optional Item 2 --><input type="checkbox" name="attr_setting_showitem_6" class="sheet-hidden sheet-itemhider" checked/><div class="sheet-item"><input type="checkbox" name="attr_item_6_check" class="sheet-checkbox sheet-squarebox"/><span></span><input type="text" placeholder="Fine one-slot item" name="attr_item_6_desc"/></div>
                    </div>
                    <div class="sheet-normal sheet-load-hidable">
                    <!-- Default Item 1 --><input type="checkbox" name="attr_setting_showitem_7" class="sheet-hidden sheet-itemhider" checked/><div class="sheet-item"><input type="checkbox" name="attr_item_7_check" class="sheet-checkbox sheet-squarebox" checked/><span></span><input type="text" placeholder="Item 7" name="attr_item_7_desc"/></div>
                    <!-- Default Item 2 --><input type="checkbox" name="attr_setting_showitem_8" class="sheet-hidden sheet-itemhider" checked/><div class="sheet-item"><input type="checkbox" name="attr_item_8_check" class="sheet-checkbox sheet-squarebox" checked/><span></span><input type="text" placeholder="Item 8" name="attr_item_8_desc"/></div>
                    <!-- Default Item 3 --><input type="checkbox" name="attr_setting_showitem_9" class="sheet-hidden sheet-itemhider" checked/><div class="sheet-item"><input type="checkbox" name="attr_item_9_check" class="sheet-checkbox sheet-squarebox" checked/><span></span><input type="text" placeholder="Item 9" name="attr_item_9_desc"/></div>
                    <!-- Default Item 4 --><input type="checkbox" name="attr_setting_showitem_10" class="sheet-hidden sheet-itemhider" checked/><div class="sheet-item"><input type="checkbox" name="attr_item_10_check" class="sheet-checkbox sheet-squarebox" checked/><span></span><input type="text" placeholder="Item 10" name="attr_item_10_desc"/></div>
                    <!-- Choose --><input type="checkbox" name="attr_setting_showitem_12" class="sheet-hidden sheet-itemhider" checked/><div class="sheet-item"><input type="text" placeholder="CHOOSE" name="attr_item_choose_11_or_12"/></div>
                    <!-- Optional Item 1 --><input type="checkbox" name="attr_setting_showitem_11" class="sheet-hidden sheet-itemhider" checked/><div class="sheet-item"><input type="checkbox" name="attr_item_11_check" class="sheet-checkbox sheet-squarebox"/><span></span><input type="text" placeholder="Item 11" name="attr_item_11_desc"/></div>
                    <!-- Or --><input type="checkbox" name="attr_setting_showitem_12" class="sheet-hidden sheet-itemhider" checked/><div class="sheet-item"><input type="text" placeholder="-OR-" name="attr_item_11_or_12"/></div>
                    <!-- Optional Item 2 --><input type="checkbox" name="attr_setting_showitem_12" class="sheet-hidden sheet-itemhider" checked/><div class="sheet-item"><input type="checkbox" name="attr_item_12_check" class="sheet-checkbox sheet-squarebox"/><span></span><input type="text" placeholder="Item 12" name="attr_item_12_desc"/></div>                    
                    </div>
                    <div class="sheet-heavy sheet-load-hidable">
                    <!-- Choose --><input type="checkbox" name="attr_setting_showitem_14" class="sheet-hidden sheet-itemhider" checked/><div class="sheet-item"><input type="text" placeholder="CHOOSE" name="attr_item_choose_13_or_14"/></div>
                    <!-- Optional Item 1 --><input type="checkbox" name="attr_setting_showitem_13" class="sheet-hidden sheet-itemhider" checked/><div class="sheet-item"><input type="checkbox" name="attr_item_13_check" class="sheet-checkbox sheet-squarebox"/><span></span><input type="text" placeholder="Item 13" name="attr_item_13_desc"/></div>
                    <!-- Or --><input type="checkbox" name="attr_setting_showitem_14" class="sheet-hidden sheet-itemhider" checked/><div class="sheet-item"><input type="text" placeholder="-OR-" name="attr_item_13_or_14"/></div>
                    <!-- Optional Item 2 --><input type="checkbox" name="attr_setting_showitem_14" class="sheet-hidden sheet-itemhider" checked/><div class="sheet-item"><input type="checkbox" name="attr_item_14_check" class="sheet-checkbox sheet-squarebox"/><span></span><input type="text" placeholder="Item 14" name="attr_item_14_desc"/></div>
                    <!-- Default Item 1 --><input type="checkbox" name="attr_setting_showitem_15" class="sheet-hidden sheet-itemhider" checked/><div class="sheet-item"><input type="checkbox" name="attr_item_15_check" class="sheet-checkbox sheet-squarebox" checked/><span></span><input type="text" placeholder="Item 15" name="attr_item_15_desc"/></div>
                    <!-- Default Item 2 --><input type="checkbox" name="attr_setting_showitem_16" class="sheet-hidden sheet-itemhider" checked/><div class="sheet-item"><input type="checkbox" name="attr_item_16_check" class="sheet-checkbox sheet-squarebox" checked/><span></span><input type="text" placeholder="Itme 16" name="attr_item_16_desc"/></div>
                    <!-- Default Item 3 --><input type="checkbox" name="attr_setting_showitem_17" class="sheet-hidden sheet-itemhider" checked/><div class="sheet-item"><input type="checkbox" name="attr_item_17_check" class="sheet-checkbox sheet-squarebox" checked/><span></span><input type="text" placeholder="Item 17" name="attr_item_17_desc"/></div>
                    </div>
                </div>
                <!-- REGULAR ITEMS-->
                <span>Utility (Choose 2)</span>   
                <div class="sheet-regularitems sheet-col100">
                    <div class="sheet-item"><input type="checkbox" name="attr_item_18_check" class="sheet-checkbox sheet-squarebox"/><span></span><input type="text" value="Winter Clothing" name="attr_item_18_desc"/></div>
                    <div class="sheet-item"><input type="checkbox" name="attr_item_19_check" class="sheet-checkbox sheet-squarebox"/><span></span><input type="text" value="Supplies (5 days)" name="attr_item_19_desc"/></div>
                    <div class="sheet-item"><input type="checkbox" name="attr_item_20_check" class="sheet-checkbox sheet-squarebox"/><span></span><input type="text" placeholder="Item 20" name="attr_item_20_desc"/></div>
                    <div class="sheet-item"><input type="checkbox" name="attr_item_21_check" class="sheet-checkbox sheet-squarebox"/><span></span><input type="text" placeholder="Item 21" name="attr_item_21_desc"/></div>
                    <div class="sheet-item"><input type="checkbox" name="attr_item_22_check" class="sheet-checkbox sheet-squarebox"/><span></span><input type="text" placeholder="Item 22" name="attr_item_22_desc"/></div>
                    <div class="sheet-item"><input type="checkbox" name="attr_item_23_check" class="sheet-checkbox sheet-squarebox"/><span></span><input type="text" placeholder="Item 23" name="attr_item_23_desc"/></div>
                    <div class="sheet-item sheet-item2box"><input type="checkbox" name="attr_item_24_check" class="sheet-checkbox sheet-squarebox"/><span></span><span class="sheet-floatingbar"></span><input type="checkbox" name="attr_item_24_check" class="sheet-checkbox sheet-squarebox"/><span></span><input type="text" value="Blackshot (3 shots)" name="attr_item_24_desc"/></div>
                    <div class="sheet-item sheet-item2box"><input type="checkbox" name="attr_item_25_check" class="sheet-checkbox sheet-squarebox"/><span></span><span class="sheet-floatingbar"></span><input type="checkbox" name="attr_item_25_check" class="sheet-checkbox sheet-squarebox"/><span></span><input type="text" value="Reliquary" name="attr_item_25_desc"/></div>
                    <div class="sheet-item"><input type="checkbox" name="attr_item_26_check" class="sheet-checkbox sheet-squarebox"/><span></span><input type="text" placeholder="Item 26" name="attr_item_26_desc"/></div>
                    <div class="sheet-item"><input type="checkbox" name="attr_item_27_check" class="sheet-checkbox sheet-squarebox"/><span></span><input type="text" placeholder="Item 27" name="attr_item_27_desc"/></div>
                    <fieldset class="repeating_item"><div class="sheet-item sheet-item2box"><input type="checkbox" name="attr_check" class="sheet-checkbox sheet-squarebox"/><span></span><span class="sheet-floatingbar"></span><input type="checkbox" name="attr_check_b" class="sheet-checkbox sheet-squarebox"/><span></span><input type="text" placeholder="Something Else?" name="attr_desc"/></div></fieldset>

               </div>
            </div>
        </div>
           
        <!-- Attributes columns -->
        <div class="sheet-col50a">
            <div class="sheet-attribute sheet-col100">
                <div class="sheet-attribute-title sheet-col100">
                    <!-- Resist with Insight -->
                    <div><button type="roll" name="roll_insight" class="sheet-rollbutton sheet-attributebutton" value='&{template:bitd}{{resist=1}}{{subtitle=resist a consequence with}}{{charname=@{character_name}}}{{rolltypeimage=https://s3-us-west-2.amazonaws.com/bob-roll20-sheet-images/insight.png}}{{rolltypetext=Insight}}{{bonusdice=[[?{Bonus dice|0|1|2|3|4|5|6|-1|-2|-3}]]}}{{roll1=[[[[{@{insight1},@{insight1}+?{Bonus dice}}kl1]]d6]]}}{{roll2=[[[[{@{insight2},@{insight2}+?{Bonus dice}+1}kl1]]d6]]}}{{roll3=[[[[{@{insight3},@{insight3}+?{Bonus dice}+2}kl1]]d6]]}}{{roll4=[[@{insight4}d6]]}}{{bonus1=[[[[{?{Bonus dice},1}kl1]]d6]]}}{{bonus2=[[[[{?{Bonus dice}-1,1}kl1]]d6]]}}{{bonus3=[[[[{?{Bonus dice}-2,1}kl1]]d6]]}}{{bonus4=[[[[{?{Bonus dice}-3,1}kl1]]d6]]}}{{bonus5=[[[[{?{Bonus dice}-4,1}kl1]]d6]]}}{{bonus6=[[[[{?{Bonus dice}-5,1}kl1]]d6]]}}{{zerodice=[[[[{-@{insight1}-@{insight2}-@{insight3}-@{insight4}-(?{Bonus dice})+1,1}kl1]]d6]], [[[[{-@{insight1}-@{insight2}-@{insight3}-@{insight4}-(?{Bonus dice})+1,1}kl1]]d6]]}}'>Insight</button></div>
                    <!--Insight XP -->
                    <div class="sheet-attribute-xp-box"><input type="radio" value="0" name="attr_insight_xp" class="sheet-zero" checked/><span></span><input type="checkbox" value="0" name="attr_insight_xp" class="sheet-hidden sheet-xptooth" checked/><input type="radio" value="1" name="attr_insight_xp" class="sheet-tooth sheet-xptooth"/><span></span><input type="radio" value="2" name="attr_insight_xp" class="sheet-tooth sheet-xptooth"/><span></span><input type="radio" value="3" name="attr_insight_xp" class="sheet-tooth sheet-xptooth"/><span></span><input type="radio" value="4" name="attr_insight_xp" class="sheet-tooth sheet-xptooth"/><span></span><input type="radio" value="5" name="attr_insight_xp" class="sheet-tooth sheet-xptooth"/><span></span><input type="radio" value="6" name="attr_insight_xp" class="sheet-tooth sheet-xptooth"/><span></span><input type="checkbox" name="attr_setting_vampirexp" class="sheet-hidden sheet-toothhider"/><input type="radio" value="7" name="attr_insight_xp" class="sheet-tooth sheet-xptooth"/><span></span><input type="checkbox" name="attr_setting_vampirexp" class="sheet-hidden sheet-toothhider"/><input type="radio" value="8" name="attr_insight_xp" class="sheet-tooth sheet-xptooth"/><span></span></div></div>
                    <!-- SPECIAL -->
                    <div class="sheet-actions sheet-col100"><div class="sheet-action sheet-col100"><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_special1"/><span></span></div><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_special2"/><span></span></div><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_special3"/><span></span></div><button type="roll" name="roll_special" class="sheet-rollbutton sheet-actionbutton" value='&{template:bitd}{{action=1}}{{subtitle=Rolls}}{{charname=@{character_name}}}{{rolltypeimage=http://s3-us-west-2.amazonaws.com/bob-roll20-sheet-images/special.png}}{{rolltypetext=Special}}{{position=?{Position|Risky|Controlled|Desperate}}}{{effect=?{Effect|Standard|Limited|Great|Extreme}}}{{bonusdice=[[?{Bonus dice|0|1|2|3|4|5|6|-1|-2|-3}]]}}{{roll1=[[[[{@{special1},@{special1}+?{Bonus dice}}kl1]]d6]]}}{{roll2=[[[[{@{special2},@{special2}+?{Bonus dice}+1}kl1]]d6]]}}{{roll3=[[[[{@{special3},@{special3}+?{Bonus dice}+2}kl1]]d6]]}}{{bonus1=[[[[{?{Bonus dice},1}kl1]]d6]]}}{{bonus2=[[[[{?{Bonus dice}-1,1}kl1]]d6]]}}{{bonus3=[[[[{?{Bonus dice}-2,1}kl1]]d6]]}}{{bonus4=[[[[{?{Bonus dice}-3,1}kl1]]d6]]}}{{bonus5=[[[[{?{Bonus dice}-4,1}kl1]]d6]]}}{{bonus6=[[[[{?{Bonus dice}-5,1}kl1]]d6]]}}{{zerodice=[[[[{-@{special1}-@{special2}-@{special3}-(?{Bonus dice})+1,1}kl1]]d6]], [[[[{-@{special1}-@{special2}-@{special3}-(?{Bonus dice})+1,1}kl1]]d6]]}}'><div class="tooltip"><div class="sheet-label sheet-specialskilllabel"><input type="text" placeholder="Special" class="sheet-specialactionbutton" name="attr_special_skill"/></div><span class="tooltiptext">Your Specialist skill</span></div></button></div>                    <!-- RESEARCH -->
                    <div class="sheet-action sheet-col100"><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_research1"/><span></span></div><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_research2"/><span></span></div><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_research3"/><span></span></div><button type="roll" name="roll_research" class="sheet-rollbutton sheet-actionbutton" value='&{template:bitd}{{action=1}}{{subtitle=Rolls}}{{charname=@{character_name}}}{{rolltypeimage=https://s3-us-west-2.amazonaws.com/bob-roll20-sheet-images/research.png}}{{rolltypetext=research}}{{position=?{Position|Risky|Controlled|Desperate}}}{{effect=?{Effect|Standard|Limited|Great|Extreme}}}{{bonusdice=[[?{Bonus dice|0|1|2|3|4|5|6|-1|-2|-3}]]}}{{roll1=[[[[{@{research1},@{research1}+?{Bonus dice}}kl1]]d6]]}}{{roll2=[[[[{@{research2},@{research2}+?{Bonus dice}+1}kl1]]d6]]}}{{roll3=[[[[{@{research3},@{research3}+?{Bonus dice}+2}kl1]]d6]]}}{{bonus1=[[[[{?{Bonus dice},1}kl1]]d6]]}}{{bonus2=[[[[{?{Bonus dice}-1,1}kl1]]d6]]}}{{bonus3=[[[[{?{Bonus dice}-2,1}kl1]]d6]]}}{{bonus4=[[[[{?{Bonus dice}-3,1}kl1]]d6]]}}{{bonus5=[[[[{?{Bonus dice}-4,1}kl1]]d6]]}}{{bonus6=[[[[{?{Bonus dice}-5,1}kl1]]d6]]}}{{zerodice=[[[[{-@{research1}-@{research2}-@{research3}-(?{Bonus dice})+1,1}kl1]]d6]], [[[[{-@{research1}-@{research2}-@{research3}-(?{Bonus dice})+1,1}kl1]]d6]]}}'><div class="tooltip">Research<span class="tooltiptext">Research a person, document, or item with close scrutiny to gather information and apply knowledge; gain a deeper understanding.</span></div></button></div>
                    <!-- RIG -->
                    <div class="sheet-action sheet-col100"><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_rig1"/><span></span></div><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_rig2"/><span></span></div><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_rig3"/><span></span></div><button type="roll" name="roll_rig" class="sheet-rollbutton sheet-actionbutton" value='&{template:bitd}{{action=1}}{{subtitle=Rolls}}{{charname=@{character_name}}}{{rolltypeimage=https://s3-us-west-2.amazonaws.com/bob-roll20-sheet-images/tinker.png}}{{rolltypetext=rig}}{{position=?{Position|Risky|Controlled|Desperate}}}{{effect=?{Effect|Standard|Limited|Great|Extreme}}}{{bonusdice=[[?{Bonus dice|0|1|2|3|4|5|6|-1|-2|-3}]]}}{{roll1=[[[[{@{rig1},@{rig1}+?{Bonus dice}}kl1]]d6]]}}{{roll2=[[[[{@{rig2},@{rig2}+?{Bonus dice}+1}kl1]]d6]]}}{{roll3=[[[[{@{rig3},@{rig3}+?{Bonus dice}+2}kl1]]d6]]}}{{bonus1=[[[[{?{Bonus dice},1}kl1]]d6]]}}{{bonus2=[[[[{?{Bonus dice}-1,1}kl1]]d6]]}}{{bonus3=[[[[{?{Bonus dice}-2,1}kl1]]d6]]}}{{bonus4=[[[[{?{Bonus dice}-3,1}kl1]]d6]]}}{{bonus5=[[[[{?{Bonus dice}-4,1}kl1]]d6]]}}{{bonus6=[[[[{?{Bonus dice}-5,1}kl1]]d6]]}}{{zerodice=[[[[{-@{rig1}-@{rig2}-@{rig3}-(?{Bonus dice})+1,1}kl1]]d6]], [[[[{-@{rig1}-@{rig2}-@{rig3}-(?{Bonus dice})+1,1}kl1]]d6]]}}'><div class="tooltip">Rig<span class="tooltiptext">Rig together mechanical solutions; disable, repair, or create mechanisms; disable a trap, pick a lock; build fortifications; repair siege weapons.</span></div></button></div>
                    <!-- SCOUT -->
                    <div class="sheet-action sheet-col100"><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_scout1"/><span></span></div><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_scout2"/><span></span></div><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_scout3"/><span></span></div><button type="roll" name="roll_scout" class="sheet-rollbutton sheet-actionbutton" value='&{template:bitd}{{action=1}}{{subtitle=Rolls}}{{charname=@{character_name}}}{{rolltypeimage=https://s3-us-west-2.amazonaws.com/bob-roll20-sheet-images/scout.png}}{{rolltypetext=scout}}{{position=?{Position|Risky|Controlled|Desperate}}}{{effect=?{Effect|Standard|Limited|Great|Extreme}}}{{bonusdice=[[?{Bonus dice|0|1|2|3|4|5|6|-1|-2|-3}]]}}{{roll1=[[[[{@{scout1},@{scout1}+?{Bonus dice}}kl1]]d6]]}}{{roll2=[[[[{@{scout2},@{scout2}+?{Bonus dice}+1}kl1]]d6]]}}{{roll3=[[[[{@{scout3},@{scout3}+?{Bonus dice}+2}kl1]]d6]]}}{{bonus1=[[[[{?{Bonus dice},1}kl1]]d6]]}}{{bonus2=[[[[{?{Bonus dice}-1,1}kl1]]d6]]}}{{bonus3=[[[[{?{Bonus dice}-2,1}kl1]]d6]]}}{{bonus4=[[[[{?{Bonus dice}-3,1}kl1]]d6]]}}{{bonus5=[[[[{?{Bonus dice}-4,1}kl1]]d6]]}}{{bonus6=[[[[{?{Bonus dice}-5,1}kl1]]d6]]}}{{zerodice=[[[[{-@{scout1}-@{scout2}-@{scout3}-(?{Bonus dice})+1,1}kl1]]d6]], [[[[{-@{scout1}-@{scout2}-@{scout3}-(?{Bonus dice})+1,1}kl1]]d6]]}}'><div class="tooltip">Scout<span class="tooltiptext">Scout a location or situation to gather information; sense trouble before it happens; move unseen; detect weaknesses or exploits if there are any</span></div></button></div></div></div>
                    <!-- PROWESS -->
                    <div class="sheet-attribute sheet-col100"><div class="sheet-attribute-title sheet-col100"><div><button type="roll" name="roll_prowess" class="sheet-rollbutton sheet-attributebutton" value='&{template:bitd}{{resist=1}}{{subtitle=resist a consequence with}}{{charname=@{character_name}}}{{rolltypeimage=https://s3-us-west-2.amazonaws.com/bob-roll20-sheet-images/prowess.png}}{{rolltypetext=Prowess}}{{bonusdice=[[?{Bonus dice|0|1|2|3|4|5|6|-1|-2|-3}]]}}{{roll1=[[[[{@{prowess1},@{prowess1}+?{Bonus dice}}kl1]]d6]]}}{{roll2=[[[[{@{prowess2},@{prowess2}+?{Bonus dice}+1}kl1]]d6]]}}{{roll3=[[[[{@{prowess3},@{prowess3}+?{Bonus dice}+2}kl1]]d6]]}}{{roll4=[[@{prowess4}d6]]}}{{bonus1=[[[[{?{Bonus dice},1}kl1]]d6]]}}{{bonus2=[[[[{?{Bonus dice}-1,1}kl1]]d6]]}}{{bonus3=[[[[{?{Bonus dice}-2,1}kl1]]d6]]}}{{bonus4=[[[[{?{Bonus dice}-3,1}kl1]]d6]]}}{{bonus5=[[[[{?{Bonus dice}-4,1}kl1]]d6]]}}{{bonus6=[[[[{?{Bonus dice}-5,1}kl1]]d6]]}}{{zerodice=[[[[{-@{prowess1}-@{prowess2}-@{prowess3}-@{prowess4}-(?{Bonus dice})+1,1}kl1]]d6]], [[[[{-@{prowess1}-@{prowess2}-@{prowess3}-@{prowess4}-(?{Bonus dice})+1,1}kl1]]d6]]}}'>Prowess</button></div>
                    <!-- PROWESS XP -->
                    <div class="sheet-attribute-xp-box"><input type="radio" value="0" name="attr_prowess_xp" class="sheet-zero" checked/><span></span><input type="checkbox" value="0" name="attr_prowess_xp" class="sheet-hidden sheet-xptooth" checked/><input type="radio" value="1" name="attr_prowess_xp" class="sheet-tooth sheet-xptooth"/><span></span><input type="radio" value="2" name="attr_prowess_xp" class="sheet-tooth sheet-xptooth"/><span></span><input type="radio" value="3" name="attr_prowess_xp" class="sheet-tooth sheet-xptooth"/><span></span><input type="radio" value="4" name="attr_prowess_xp" class="sheet-tooth sheet-xptooth"/><span></span><input type="radio" value="5" name="attr_prowess_xp" class="sheet-tooth sheet-xptooth"/><span></span><input type="radio" value="6" name="attr_prowess_xp" class="sheet-tooth sheet-xptooth"/><span></span><input type="checkbox" name="attr_setting_vampirexp" class="sheet-hidden sheet-toothhider"/><input type="radio" value="7" name="attr_prowess_xp" class="sheet-tooth sheet-xptooth"/><span></span><input type="checkbox" name="attr_setting_vampirexp" class="sheet-hidden sheet-toothhider"/><input type="radio" value="8" name="attr_prowess_xp" class="sheet-tooth sheet-xptooth"/><span></span></div></div>
                    <!-- MANEUVER -->
                    <div class="sheet-actions sheet-col100"><div class="sheet-action sheet-col100"><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_maneuver1"/><span></span></div><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_maneuver2"/><span></span></div><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_maneuver3"/><span></span></div><button type="roll" name="roll_maneuver" class="sheet-rollbutton sheet-actionbutton" value='&{template:bitd}{{action=1}}{{subtitle=Rolls}}{{charname=@{character_name}}}{{rolltypeimage=https://s3-us-west-2.amazonaws.com/bob-roll20-sheet-images/maneuver.png}}{{rolltypetext=maneuver}}{{position=?{Position|Risky|Controlled|Desperate}}}{{effect=?{Effect|Standard|Limited|Great|Extreme}}}{{bonusdice=[[?{Bonus dice|0|1|2|3|4|5|6|-1|-2|-3}]]}}{{roll1=[[[[{@{maneuver1},@{maneuver1}+?{Bonus dice}}kl1]]d6]]}}{{roll2=[[[[{@{maneuver2},@{maneuver2}+?{Bonus dice}+1}kl1]]d6]]}}{{roll3=[[[[{@{maneuver3},@{maneuver3}+?{Bonus dice}+2}kl1]]d6]]}}{{bonus1=[[[[{?{Bonus dice},1}kl1]]d6]]}}{{bonus2=[[[[{?{Bonus dice}-1,1}kl1]]d6]]}}{{bonus3=[[[[{?{Bonus dice}-2,1}kl1]]d6]]}}{{bonus4=[[[[{?{Bonus dice}-3,1}kl1]]d6]]}}{{bonus5=[[[[{?{Bonus dice}-4,1}kl1]]d6]]}}{{bonus6=[[[[{?{Bonus dice}-5,1}kl1]]d6]]}}{{zerodice=[[[[{-@{maneuver1}-@{maneuver2}-@{maneuver3}-(?{Bonus dice})+1,1}kl1]]d6]], [[[[{-@{maneuver1}-@{maneuver2}-@{maneuver3}-(?{Bonus dice})+1,1}kl1]]d6]]}}'><div class="tooltip">Maneuver<span class="tooltiptext">Maneuver into position and traverse obstacles; climb, swim, run, jump, and tumble; handle a pack animal; ride a mount.</span></div></button></div>
                    <!-- SHOOT -->
                    <div class="sheet-action sheet-col100"><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_shoot1"/><span></span></div><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_shoot2"/><span></span></div><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_shoot3"/><span></span></div><button type="roll" name="roll_shoot" class="sheet-rollbutton sheet-actionbutton" value='&{template:bitd}{{action=1}}{{subtitle=Rolls}}{{charname=@{character_name}}}{{rolltypeimage=https://s3-us-west-2.amazonaws.com/bob-roll20-sheet-images/shoot.png}}{{rolltypetext=shoot}}{{position=?{Position|Risky|Controlled|Desperate}}}{{effect=?{Effect|Standard|Limited|Great|Extreme}}}{{bonusdice=[[?{Bonus dice|0|1|2|3|4|5|6|-1|-2|-3}]]}}{{roll1=[[[[{@{shoot1},@{shoot1}+?{Bonus dice}}kl1]]d6]]}}{{roll2=[[[[{@{shoot2},@{shoot2}+?{Bonus dice}+1}kl1]]d6]]}}{{roll3=[[[[{@{shoot3},@{shoot3}+?{Bonus dice}+2}kl1]]d6]]}}{{bonus1=[[[[{?{Bonus dice},1}kl1]]d6]]}}{{bonus2=[[[[{?{Bonus dice}-1,1}kl1]]d6]]}}{{bonus3=[[[[{?{Bonus dice}-2,1}kl1]]d6]]}}{{bonus4=[[[[{?{Bonus dice}-3,1}kl1]]d6]]}}{{bonus5=[[[[{?{Bonus dice}-4,1}kl1]]d6]]}}{{bonus6=[[[[{?{Bonus dice}-5,1}kl1]]d6]]}}{{zerodice=[[[[{-@{shoot1}-@{shoot2}-@{shoot3}-(?{Bonus dice})+1,1}kl1]]d6]], [[[[{-@{shoot1}-@{shoot2}-@{shoot3}-(?{Bonus dice})+1,1}kl1]]d6]]}}'><div class="tooltip">Shoot<span class="tooltiptext">Shoot a target with precision from a distance; find a perch with clear lines of fire; make trick shots; repair and maintain firearms.</span></div></button></div>
                    <!-- SKIRMISH -->
                    <div class="sheet-action sheet-col100"><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_skirmish1"/><span></span></div><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_skirmish2"/><span></span></div><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_skirmish3"/><span></span></div><button type="roll" name="roll_skirmish" class="sheet-rollbutton sheet-actionbutton" value='&{template:bitd}{{action=1}}{{subtitle=Rolls}}{{charname=@{character_name}}}{{rolltypeimage=https://s3-us-west-2.amazonaws.com/bob-roll20-sheet-images/skirmish.png}}{{rolltypetext=skirmish}}{{position=?{Position|Risky|Controlled|Desperate}}}{{effect=?{Effect|Standard|Limited|Great|Extreme}}}{{bonusdice=[[?{Bonus dice|0|1|2|3|4|5|6|-1|-2|-3}]]}}{{roll1=[[[[{@{skirmish1},@{skirmish1}+?{Bonus dice}}kl1]]d6]]}}{{roll2=[[[[{@{skirmish2},@{skirmish2}+?{Bonus dice}+1}kl1]]d6]]}}{{roll3=[[[[{@{skirmish3},@{skirmish3}+?{Bonus dice}+2}kl1]]d6]]}}{{bonus1=[[[[{?{Bonus dice},1}kl1]]d6]]}}{{bonus2=[[[[{?{Bonus dice}-1,1}kl1]]d6]]}}{{bonus3=[[[[{?{Bonus dice}-2,1}kl1]]d6]]}}{{bonus4=[[[[{?{Bonus dice}-3,1}kl1]]d6]]}}{{bonus5=[[[[{?{Bonus dice}-4,1}kl1]]d6]]}}{{bonus6=[[[[{?{Bonus dice}-5,1}kl1]]d6]]}}{{zerodice=[[[[{-@{skirmish1}-@{skirmish2}-@{skirmish3}-(?{Bonus dice})+1,1}kl1]]d6]], [[[[{-@{skirmish1}-@{skirmish2}-@{skirmish3}-(?{Bonus dice})+1,1}kl1]]d6]]}}'><div class="tooltip">Skirmish<span class="tooltiptext">Skirmish with an opponent in close combat; assault or hold a position; brawl and wrestle.</span></div></button></div>
                    <!-- WRECK -->
                    <div class="sheet-action sheet-col100"><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_wreck1"/><span></span></div><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_wreck2"/><span></span></div><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_wreck3"/><span></span></div><button type="roll" name="roll_wreck" class="sheet-rollbutton sheet-actionbutton" value='&{template:bitd}{{action=1}}{{subtitle=Rolls}}{{charname=@{character_name}}}{{rolltypeimage=https://s3-us-west-2.amazonaws.com/bob-roll20-sheet-images/wreck.png}}{{rolltypetext=wreck}}{{position=?{Position|Risky|Controlled|Desperate}}}{{effect=?{Effect|Standard|Limited|Great|Extreme}}}{{bonusdice=[[?{Bonus dice|0|1|2|3|4|5|6|-1|-2|-3}]]}}{{roll1=[[[[{@{wreck1},@{wreck1}+?{Bonus dice}}kl1]]d6]]}}{{roll2=[[[[{@{wreck2},@{wreck2}+?{Bonus dice}+1}kl1]]d6]]}}{{roll3=[[[[{@{wreck3},@{wreck3}+?{Bonus dice}+2}kl1]]d6]]}}{{bonus1=[[[[{?{Bonus dice},1}kl1]]d6]]}}{{bonus2=[[[[{?{Bonus dice}-1,1}kl1]]d6]]}}{{bonus3=[[[[{?{Bonus dice}-2,1}kl1]]d6]]}}{{bonus4=[[[[{?{Bonus dice}-3,1}kl1]]d6]]}}{{bonus5=[[[[{?{Bonus dice}-4,1}kl1]]d6]]}}{{bonus6=[[[[{?{Bonus dice}-5,1}kl1]]d6]]}}{{zerodice=[[[[{-@{wreck1}-@{wreck2}-@{wreck3}-(?{Bonus dice})+1,1}kl1]]d6]], [[[[{-@{wreck1}-@{wreck2}-@{wreck3}-(?{Bonus dice})+1,1}kl1]]d6]]}}'><div class="tooltip">Wreck<span class="tooltiptext">Wreck a place, item, or obstacle with savage force or careful sabotage; distract and sew chaos; breach defenses with force; use, throw or plant explosives or alchemicals; use siege weapons.</span></div></button></div></div></div>
                    <!-- RESOLVE -->
                    <div class="sheet-attribute sheet-col100"><div class="sheet-attribute-title sheet-col100"><div><button type="roll" name="roll_resolve" class="sheet-rollbutton sheet-attributebutton" value='&{template:bitd}{{resist=1}}{{subtitle=resists a consequence with}}{{charname=@{character_name}}}{{rolltypeimage=https://s3-us-west-2.amazonaws.com/bob-roll20-sheet-images/resolve.png}}{{rolltypetext=Resolve}}{{bonusdice=[[?{Bonus dice|0|1|2|3|4|5|6|-1|-2|-3}]]}}{{roll1=[[[[{@{resolve1},@{resolve1}+?{Bonus dice}}kl1]]d6]]}}{{roll2=[[[[{@{resolve2},@{resolve2}+?{Bonus dice}+1}kl1]]d6]]}}{{roll3=[[[[{@{resolve3},@{resolve3}+?{Bonus dice}+2}kl1]]d6]]}}{{roll4=[[@{resolve4}d6]]}}{{bonus1=[[[[{?{Bonus dice},1}kl1]]d6]]}}{{bonus2=[[[[{?{Bonus dice}-1,1}kl1]]d6]]}}{{bonus3=[[[[{?{Bonus dice}-2,1}kl1]]d6]]}}{{bonus4=[[[[{?{Bonus dice}-3,1}kl1]]d6]]}}{{bonus5=[[[[{?{Bonus dice}-4,1}kl1]]d6]]}}{{bonus6=[[[[{?{Bonus dice}-5,1}kl1]]d6]]}}{{zerodice=[[[[{-@{resolve1}-@{resolve2}-@{resolve3}-@{resolve4}-(?{Bonus dice})+1,1}kl1]]d6]], [[[[{-@{resolve1}-@{resolve2}-@{resolve3}-@{resolve4}-(?{Bonus dice})+1,1}kl1]]d6]]}}'>Resolve</button></div>
                    <!-- RESOLVE XP -->
                    <div class="sheet-attribute-xp-box"><input type="radio" value="0" name="attr_resolve_xp" class="sheet-zero" checked/><span></span><input type="checkbox" value="0" name="attr_resolve_xp" class="sheet-hidden sheet-xptooth" checked/><input type="radio" value="1" name="attr_resolve_xp" class="sheet-tooth sheet-xptooth"/><span></span><input type="radio" value="2" name="attr_resolve_xp" class="sheet-tooth sheet-xptooth"/><span></span><input type="radio" value="3" name="attr_resolve_xp" class="sheet-tooth sheet-xptooth"/><span></span><input type="radio" value="4" name="attr_resolve_xp" class="sheet-tooth sheet-xptooth"/><span></span><input type="radio" value="5" name="attr_resolve_xp" class="sheet-tooth sheet-xptooth"/><span></span><input type="radio" value="6" name="attr_resolve_xp" class="sheet-tooth sheet-xptooth"/><span></span><input type="checkbox" name="attr_setting_vampirexp" class="sheet-hidden sheet-toothhider"/><input type="radio" value="7" name="attr_resolve_xp" class="sheet-tooth sheet-xptooth"/><span></span><input type="checkbox" name="attr_setting_vampirexp" class="sheet-hidden sheet-toothhider"/><input type="radio" value="8" name="attr_resolve_xp" class="sheet-tooth sheet-xptooth"/><span></span></div></div>
                    <!-- CONSORT -->
                    <div class="sheet-actions sheet-col100"><div class="sheet-action sheet-col100"><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_consort1"/><span></span></div><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_consort2"/><span></span></div><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_consort3"/><span></span></div><button type="roll" name="roll_consort" class="sheet-rollbutton sheet-actionbutton" value='&{template:bitd}{{action=1}}{{subtitle=Rolls}}{{charname=@{character_name}}}{{rolltypeimage=https://s3-us-west-2.amazonaws.com/bob-roll20-sheet-images/consort.png}}{{rolltypetext=consort}}{{position=?{Position|Risky|Controlled|Desperate}}}{{effect=?{Effect|Standard|Limited|Great|Extreme}}}{{bonusdice=[[?{Bonus dice|0|1|2|3|4|5|6|-1|-2|-3}]]}}{{roll1=[[[[{@{consort1},@{consort1}+?{Bonus dice}}kl1]]d6]]}}{{roll2=[[[[{@{consort2},@{consort2}+?{Bonus dice}+1}kl1]]d6]]}}{{roll3=[[[[{@{consort3},@{consort3}+?{Bonus dice}+2}kl1]]d6]]}}{{bonus1=[[[[{?{Bonus dice},1}kl1]]d6]]}}{{bonus2=[[[[{?{Bonus dice}-1,1}kl1]]d6]]}}{{bonus3=[[[[{?{Bonus dice}-2,1}kl1]]d6]]}}{{bonus4=[[[[{?{Bonus dice}-3,1}kl1]]d6]]}}{{bonus5=[[[[{?{Bonus dice}-4,1}kl1]]d6]]}}{{bonus6=[[[[{?{Bonus dice}-5,1}kl1]]d6]]}}{{zerodice=[[[[{-@{consort1}-@{consort2}-@{consort3}-(?{Bonus dice})+1,1}kl1]]d6]], [[[[{-@{consort1}-@{consort2}-@{consort3}-(?{Bonus dice})+1,1}kl1]]d6]]}}'><div class="tooltip">Consort<span class="tooltiptext">Consort with connections from your heritage, background, friends, or rivals to gain access to resources, information, people, or places.</span></div></button></div>
                    <!-- DISCIPLINE -->
                    <div class="sheet-action sheet-col100"><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_discipline1"/><span></span></div><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_discipline2"/><span></span></div><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_discipline3"/><span></span></div><button type="roll" name="roll_discipline" class="sheet-rollbutton sheet-actionbutton" value='&{template:bitd}{{action=1}}{{subtitle=Rolls}}{{charname=@{character_name}}}{{rolltypeimage=https://s3-us-west-2.amazonaws.com/bob-roll20-sheet-images/discipline.png}}{{rolltypetext=discipline}}{{position=?{Position|Risky|Controlled|Desperate}}}{{effect=?{Effect|Standard|Limited|Great|Extreme}}}{{bonusdice=[[?{Bonus dice|0|1|2|3|4|5|6|-1|-2|-3}]]}}{{roll1=[[[[{@{discipline1},@{discipline1}+?{Bonus dice}}kl1]]d6]]}}{{roll2=[[[[{@{discipline2},@{discipline2}+?{Bonus dice}+1}kl1]]d6]]}}{{roll3=[[[[{@{discipline3},@{discipline3}+?{Bonus dice}+2}kl1]]d6]]}}{{bonus1=[[[[{?{Bonus dice},1}kl1]]d6]]}}{{bonus2=[[[[{?{Bonus dice}-1,1}kl1]]d6]]}}{{bonus3=[[[[{?{Bonus dice}-2,1}kl1]]d6]]}}{{bonus4=[[[[{?{Bonus dice}-3,1}kl1]]d6]]}}{{bonus5=[[[[{?{Bonus dice}-4,1}kl1]]d6]]}}{{bonus6=[[[[{?{Bonus dice}-5,1}kl1]]d6]]}}{{zerodice=[[[[{-@{discipline1}-@{discipline2}-@{discipline3}-(?{Bonus dice})+1,1}kl1]]d6]], [[[[{-@{discipline1}-@{discipline2}-@{discipline3}-(?{Bonus dice})+1,1}kl1]]d6]]}}'><div class="tooltip">Discipline<span class="tooltiptext">Discipline a fellow soldier; command obedience with your force of personality; intimidate or threaten.</span></div></button></div>
                    <!-- MARSHALL -->
                    <div class="sheet-action sheet-col100"><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_marshall1"/><span></span></div><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_marshall2"/><span></span></div><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_marshall3"/><span></span></div><button type="roll" name="roll_marshall" class="sheet-rollbutton sheet-actionbutton" value='&{template:bitd}{{action=1}}{{subtitle=Rolls}}{{charname=@{character_name}}}{{rolltypeimage=https://s3-us-west-2.amazonaws.com/bob-roll20-sheet-images/marshall.png}}{{rolltypetext=marshall}}{{position=?{Position|Risky|Controlled|Desperate}}}{{effect=?{Effect|Standard|Limited|Great|Extreme}}}{{bonusdice=[[?{Bonus dice|0|1|2|3|4|5|6|-1|-2|-3}]]}}{{roll1=[[[[{@{marshall1},@{marshall1}+?{Bonus dice}}kl1]]d6]]}}{{roll2=[[[[{@{marshall2},@{marshall2}+?{Bonus dice}+1}kl1]]d6]]}}{{roll3=[[[[{@{marshall3},@{marshall3}+?{Bonus dice}+2}kl1]]d6]]}}{{bonus1=[[[[{?{Bonus dice},1}kl1]]d6]]}}{{bonus2=[[[[{?{Bonus dice}-1,1}kl1]]d6]]}}{{bonus3=[[[[{?{Bonus dice}-2,1}kl1]]d6]]}}{{bonus4=[[[[{?{Bonus dice}-3,1}kl1]]d6]]}}{{bonus5=[[[[{?{Bonus dice}-4,1}kl1]]d6]]}}{{bonus6=[[[[{?{Bonus dice}-5,1}kl1]]d6]]}}{{zerodice=[[[[{-@{marshall1}-@{marshall2}-@{marshall3}-(?{Bonus dice})+1,1}kl1]]d6]], [[[[{-@{marshall1}-@{marshall2}-@{marshall3}-(?{Bonus dice})+1,1}kl1]]d6]]}}'><div class="tooltip">Marshall<span class="tooltiptext">Marshal a squad or larger group to action; command attention amidst chaos; lift morale in the field; stretch resources.</span></div></button></div>
                    <!-- SWAY -->
                    <div class="sheet-action sheet-col100"><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_sway1"/><span></span></div><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_sway2"/><span></span></div><div><input type="checkbox" class="sheet-checkbox sheet-circlebox" value="1" name="attr_sway3"/><span></span></div><button type="roll" name="roll_sway" class="sheet-rollbutton sheet-actionbutton" value='&{template:bitd}{{action=1}}{{subtitle=Rolls}}{{charname=@{character_name}}}{{rolltypeimage=https://s3-us-west-2.amazonaws.com/bob-roll20-sheet-images/sway.png}}{{rolltypetext=sway}}{{position=?{Position|Risky|Controlled|Desperate}}}{{effect=?{Effect|Standard|Limited|Great|Extreme}}}{{bonusdice=[[?{Bonus dice|0|1|2|3|4|5|6|-1|-2|-3}]]}}{{roll1=[[[[{@{sway1},@{sway1}+?{Bonus dice}}kl1]]d6]]}}{{roll2=[[[[{@{sway2},@{sway2}+?{Bonus dice}+1}kl1]]d6]]}}{{roll3=[[[[{@{sway3},@{sway3}+?{Bonus dice}+2}kl1]]d6]]}}{{bonus1=[[[[{?{Bonus dice},1}kl1]]d6]]}}{{bonus2=[[[[{?{Bonus dice}-1,1}kl1]]d6]]}}{{bonus3=[[[[{?{Bonus dice}-2,1}kl1]]d6]]}}{{bonus4=[[[[{?{Bonus dice}-3,1}kl1]]d6]]}}{{bonus5=[[[[{?{Bonus dice}-4,1}kl1]]d6]]}}{{bonus6=[[[[{?{Bonus dice}-5,1}kl1]]d6]]}}{{zerodice=[[[[{-@{sway1}-@{sway2}-@{sway3}-(?{Bonus dice})+1,1}kl1]]d6]], [[[[{-@{sway1}-@{sway2}-@{sway3}-(?{Bonus dice})+1,1}kl1]]d6]]}}'><div class="tooltip">Sway<span class="tooltiptext">Sway someone with charm, logic, deception, disguise, or bluff; change attitudes or behavior with manipulation or seduction.</span></div></button></div>
                </div>
            </div>
        <!-- BONUS DICE -->
        <div class="sheet-bonusdie sheet-col100">
            <div class="sheet-label sheet-col100">Bonus Dice</div>

            <div class="sheet-col100">
                <div class="sheet-bonusdieplus sheet-pushplus">+</div>
                <div class="sheet-bonusdietext sheet-pushtext">
                    <span class="sheet-smallcaps">Push yourself</span><span> (take 2 <span name="attr_setting_stress_label" class="sheet-inherit"></span>) -or- accept a </span><span class="sheet-smallcaps">Devil's Bargain</span>
                </div>
            </div>

            <div class="sheet-col100">
                <div class="sheet-bonusdieplus sheet-assistplus">+</div>
                <div class="sheet-bonusdietext sheet-assisttext">
                    <span class="sheet-smallcaps">Assist</span><span> (They take 1 <span name="attr_setting_stress_label" class="sheet-inherit"></span>)</span>
                </div>
            </div>    
        </div>

        <button type="roll" name="roll_fortune" class="sheet-fortunebutton" value='&{template:bitd}{{charname=@{character_name}}}{{fortune=1}}{{subtitle=Rolls}}{{rolltypeimage=https://s3-us-west-2.amazonaws.com/bob-roll20-sheet-images/fortune.png}}{{rolltypetext=Fortune}}{{notes=?{Notes|}}}{{bonusdice=[[?{Number of dice|0|1|2|3|4|5|6}]]}}{{bonus1=[[[[{?{Number of dice},1}kl1]]d6]]}}{{bonus2=[[[[{?{Number of dice}-1,1}kl1]]d6]]}}{{bonus3=[[[[{?{Number of dice}-2,1}kl1]]d6]]}}{{bonus4=[[[[{?{Number of dice}-3,1}kl1]]d6]]}}{{bonus5=[[[[{?{Number of dice}-4,1}kl1]]d6]]}}{{bonus6=[[[[{?{Number of dice}-5,1}kl1]]d6]]}}{{zerodice=[[[[{1-(?{Number of dice}),1}kl1]]d6]], [[[[{1-(?{Number of dice}),1}kl1]]d6]]}}'>Roll Fortune</button>
    </div>
    <div class="sheet-col97 sheet-clocks">
        <div class="sheet-specialheader sheet-col100 sheet-label">Clocks</div>
        <fieldset class="repeating_clock">
            <div class="sheet-clock">
                <input type="text" placeholder="Clock Name" name="attr_name" class="sheet-label"/>
                <div class="sheet-clockprogress">
                    <span>Size</span>
                    <input type="radio" name="attr_size" class="sheet-text-input sheet-longoption" value="4" checked/>
                    <span>4-segment</span>
                    <input type="radio" name="attr_size" class="sheet-text-input sheet-longoption" value="6"/>
                    <span>6-segment</span>
                    <input type="radio" name="attr_size" class="sheet-text-input sheet-longoption" value="8"/>
                    <span>8-segment</span>
                    <input type="radio" name="attr_size" class="sheet-text-input sheet-last sheet-longoption" value="12"/>
                    <span>12-segment</span>
                    <div class="sheet-4clock">
                        <span>Progress</span>
                        <input type="radio" name="attr_clock1" class="sheet-text-input" value="0" checked/><span>0</span>
                        <input type="radio" name="attr_clock1" class="sheet-text-input" value="1"/><span>1</span>
                        <input type="radio" name="attr_clock1" class="sheet-text-input" value="2"/><span>2</span>
                        <input type="radio" name="attr_clock1" class="sheet-text-input" value="3"/><span>3</span>
                        <input type="radio" name="attr_clock1" class="sheet-text-input sheet-last" value="4"/><span>4</span>
                        <div class="sheet-clockpicture"></div>
                    </div>
                    <div class="sheet-6clock">
                        <span>Progress</span>
                        <input type="radio" name="attr_clock2" class="sheet-text-input" value="0" checked/><span>0</span>
                        <input type="radio" name="attr_clock2" class="sheet-text-input" value="1"/><span>1</span>
                        <input type="radio" name="attr_clock2" class="sheet-text-input" value="2"/><span>2</span>
                        <input type="radio" name="attr_clock2" class="sheet-text-input" value="3"/><span>3</span>
                        <input type="radio" name="attr_clock2" class="sheet-text-input" value="4"/><span>4</span>
                        <input type="radio" name="attr_clock2" class="sheet-text-input" value="5"/><span>5</span>
                        <input type="radio" name="attr_clock2" class="sheet-text-input sheet-last" value="6"/><span>6</span>
                        <div class="sheet-clockpicture"></div>
                    </div>
                    <div class="sheet-8clock">
                        <span>Progress</span>
                        <input type="radio" name="attr_clock3" class="sheet-text-input" value="0" checked/><span>0</span>
                        <input type="radio" name="attr_clock3" class="sheet-text-input" value="1"/><span>1</span>
                        <input type="radio" name="attr_clock3" class="sheet-text-input" value="2"/><span>2</span>
                        <input type="radio" name="attr_clock3" class="sheet-text-input" value="3"/><span>3</span>
                        <input type="radio" name="attr_clock3" class="sheet-text-input" value="4"/><span>4</span>
                        <input type="radio" name="attr_clock3" class="sheet-text-input" value="5"/><span>5</span>
                        <input type="radio" name="attr_clock3" class="sheet-text-input" value="6"/><span>6</span>
                        <input type="radio" name="attr_clock3" class="sheet-text-input" value="7"/><span>7</span>
                        <input type="radio" name="attr_clock3" class="sheet-text-input sheet-last" value="8"/><span>8</span>
                        <div class="sheet-clockpicture"></div>
                    </div>
                    <div class="sheet-12clock">
                        <span>Progress</span>
                        <input type="radio" name="attr_clock4" class="sheet-text-input" value="0" checked/><span>0</span>
                        <input type="radio" name="attr_clock4" class="sheet-text-input" value="1"/><span>1</span>
                        <input type="radio" name="attr_clock4" class="sheet-text-input" value="2"/><span>2</span>
                        <input type="radio" name="attr_clock4" class="sheet-text-input" value="3"/><span>3</span>
                        <input type="radio" name="attr_clock4" class="sheet-text-input" value="4"/><span>4</span>
                        <input type="radio" name="attr_clock4" class="sheet-text-input" value="5"/><span>5</span>
                        <input type="radio" name="attr_clock4" class="sheet-text-input" value="6"/><span>6</span>
                        <input type="radio" name="attr_clock4" class="sheet-text-input" value="7"/><span>7</span>
                        <input type="radio" name="attr_clock4" class="sheet-text-input" value="8"/><span>8</span>
                        <input type="radio" name="attr_clock4" class="sheet-text-input" value="9"/><span>9</span>
                        <input type="radio" name="attr_clock4" class="sheet-text-input" value="10"/><span>10</span>
                        <input type="radio" name="attr_clock4" class="sheet-text-input" value="11"/><span>11</span>
                        <input type="radio" name="attr_clock4" class="sheet-text-input sheet-last" value="12"/><span>12</span>
                        <div class="sheet-clockpicture"></div>
                    </div>
                </div>
            </div>
        </fieldset>
    </div>
    <textarea spellcheck="false" class="sheet-notes" name="attr_notes" placeholder="Notes"></textarea>
</div>
<br clear="all" />
</div>

<rolltemplate class="sheet-rolltemplate-bitd">
    <div class="sheet-roll-holder{{#action}} sheet-roll-action{{/action}}{{#resist}} sheet-roll-resist{{/resist}}{{#fortune}} sheet-roll-fortune{{/fortune}}">
        <div class="sheet-roll-name">{{charname}}</div>
        <div class="sheet-roll-subtitle">{{subtitle}}</div>
        <div class="sheet-roll-title">[{{rolltypetext}}]({{rolltypeimage}})</div>
        <div class="sheet-roll-dice">
            {{#rollGreater() roll1 0}}{{roll1}}<span class="sheet-comma">, </span>{{/rollGreater() roll1 0}}{{#rollGreater() roll2 0}}{{roll2}}<span class="sheet-comma">, </span>{{/rollGreater() roll2 0}}{{#rollGreater() roll3 0}}{{roll3}}<span class="sheet-comma">, </span>{{/rollGreater() roll3 0}}{{#rollGreater() roll4 0}}{{roll4}}<span class="sheet-comma">, </span>{{/rollGreater() roll4 0}}{{#rollGreater() roll5 0}}{{roll5}}<span class="sheet-comma">, </span>{{/rollGreater() roll5 0}}{{#rollGreater() bonusdice 0}}{{bonus1}}<span class="sheet-comma">, </span>{{/rollGreater() bonusdice 0}}{{#rollGreater() bonusdice 1}}{{bonus2}}<span class="sheet-comma">, </span>{{/rollGreater() bonusdice 1}}{{#rollGreater() bonusdice 2}}{{bonus3}}<span class="sheet-comma">, </span>{{/rollGreater() bonusdice 2}}{{#rollGreater() bonusdice 3}}{{bonus4}}<span class="sheet-comma">, </span>{{/rollGreater() bonusdice 3}}{{#rollGreater() bonusdice 4}}{{bonus5}}<span class="sheet-comma">, </span>{{/rollGreater() bonusdice 4}}{{#rollGreater() bonusdice 5}}{{bonus6}}<span class="sheet-comma">, </span>{{/rollGreater() bonusdice 5}}{{#rollGreater() zerodice 0}}<div class="sheet-zerodice1">{{zerodice}}</div>
            <div class="sheet-zerodice2">Zero Dice - take the lowest result above</div>{{/rollGreater() zerodice 0}}
        </div>
        {{#position}}<div class="sheet-roll-position">{{position}}</div>{{/position}}{{#effect}}<div class="sheet-roll-effect">{{effect}}</div>{{/effect}}
        {{#resist}}<div class="sheet-roll-instructions">Suffer <em>6 stress minus the highest die result.</em> When you roll a critical on resistance, clear 1 stress.</div>{{/resist}}
        {{#notes}}<div class="sheet-roll-notes">{{notes}}</div>{{/notes}}
    </div>
</rolltemplate>

<!-- AUTO FILL DATA -->
<script type="text/worker">
    "use strict";
    const sheetVersion = "0.2";
    const sheetName = "Band of Blades";
    const playbookData = {
        heavy: {
          abilities: [{
            name: "Bulwark",
            description: "You can spend ANCHOR uses as special armour against consequences to a squad you are defending."
          },
          {
            name: "Backup",
            description: "When you protect a squadmate, resist with +1d. When you assist someone, their pushes only cost 1 stress."
          },
          {
            name: "Tenacious",
            description: "Penalties from harm are one level less severe (though level 4 harm is still fatal)."
          },
          {
            name: "Vanguard",
            description: "You're known as a Weaponmaster even outside the Legion. When you push yourself, you also gain potency in melee combat."
          },
          {
            name: "War Machine",
            description: "When you push yourself you can do one of the following: perform a feat of physical force that verges on the superhuman ‚Äî reduce the Threat level of all the enemies you're facing by one."
          },
          {
            name: "Vigorous",
            description: "When you check wounds during rest and recovery, place one free check. When you take harm, clear 1 stress."
          },
          {
            name: "Against the Darkness",
            description: "You and all squadmates that can see you gain +1d to resist fear and corruption."
          }
          ],
          base: {
            item_0_desc: "Flare Gun (4 shots)*",
            item_1_desc: "Fine Armour*",
            item_2_desc: "Fine Hand Weapon*",
            item_7_desc: "Fine Fitted Heavy Plate (replaces Armour)*",
            item_11_desc: "Fine Shield",
            item_12_desc: "Fine Heavy Weapon",
            item_16_desc: "Fine Wrecking Kit*",
            item_17_desc: "Fine Tower Shield (replaces Shield)*",
            item_20_desc: "Hand Weapon",
            item_21_desc: "Heavy Weapon",
            item_22_desc: "Shield",
            item_23_desc: "Oil (3 uses)",
            item_26_desc: "Medic Kit (3 uses)",
            item_27_desc: "Wrecking Kit",
            playbook_description: "Bulwark\nof the\nLegion",
            skirmish1: "1",
            skirmish2: "1",
            special1: "1",
            wreck1: "1",
            setting_showitem_3: "0",
            setting_showitem_4: "0",
            setting_showitem_5: "0",
            setting_showitem_6: "0",
            setting_showitem_8: "0",
            setting_showitem_9: "0",
            setting_showitem_10: "0",
            setting_showitem_13: "0",
            setting_showitem_14: "0",
            setting_showitem_15: "0",
            special_armor1: "Heavy Armour",
            special_skill: "ANCHOR",
            xp_condition: "You helped your squad through might or fortitude."
          }
        },
        medic: {
          abilities: [{
            name: "Attach√©",
            description: "You may deploy on any mission even outside the usual Specialist caps. Gain this ability for free when you become a medic."
          },
          {
            name: "First Aid",
            description: "You can spend 1 use of Tonics to remove appropriate level 1 harm on any person on your mission."
          },
          {
            name: "Not Today",
            description: "You may spend a DOCTOR use immediately afer a soldier takes level 4 harm on a mission, but you must do so quickly before they die. You treat them and reduce the wound to level 3 harm instead."
          },
          {
            name: "Doctor Feelgood",
            description: "Expend 1 load of Tonics to grant one person potency for a physical action."
          },
          {
            name: "Field Dressing",
            description: "At the end of a mission you may expend remaining DOCTOR uses to add 1 check to a Legionnaire's level 2 or 3 harm, once per person."
          },
          {
            name: "Chemist",
            description: "You have training in Orite Alchemical Medicine. You may equip a Alchemical Bandolier on each mission. It holds charges of chemicals you may use. (I recommend you add them to your notes from the PDF handout.)"
          },
          {
            name: "Moral Support",
            description: "You know how to keep troop spirits up. Once a mission, if you tell a funny, personal, or meaningful story when the squad is resting, anyone listening may clear 1 stress."
          }
          ],
          base: {
            special1: "1",
            research1: "1",
            research2: "1",
            sway1: "1",
            maneuver1: "1",
            discipline1: "1",
            item_0_desc: "Fine Medic Kit (3 uses)*",
            item_1_desc: "Tonics*",
            item_2_desc: "Holy Symbol of Mercy*",
            item_5_desc: "Mark of the Healing God",
            item_7_desc: "Fine Pistol*",
            item_8_desc: "Ammo (5)*",
            item_9_desc: "Armour*",
            item_10_desc: "Tonics*",
            item_16_desc: "Tonics*",
            item_17_desc: "Tonics*",
            item_20_desc: "Hand Weapon",
            item_21_desc: "Bandolier (requires Chemist)",
            item_22_desc: "Shield",
            item_23_desc: "Oil (3 uses)",
            item_26_desc: "Repair Kit (3 uses)",
            item_27_desc: "Books and Scrolls (2 uses)",
            playbook_description: "Field Surgeon\nand\nLife Saver",
            setting_showitem_3: "0",
            setting_showitem_4: "0",
            setting_showitem_6: "0",
            setting_showitem_11: "0",
            setting_showitem_12: "0",
            setting_showitem_13: "0",
            setting_showitem_14: "0",
            setting_showitem_15: "0",
            special_armor1: "Heavy Armour",
            special_skill: "DOCTOR",
            xp_condition: "If you helped your squad through medical knowledge or emotional comfort."
          }
        },
        scout: {
          abilities: [{
            name: "Ghost",
            description: "You can spend SCROUNGE uses as special armor against traps or detection."
          },
          {
            name: "Panther Like Grace",
            description: "When carrying no armor, and under light load, any harm you take starts as 1 level lower."
          },
          {
            name: "Like the Wind",
            description: "Whenever there's a question of who goes first, the answer is you. Also take +1d when dodging attacks with PROWESS"
          },
          {
            name: "Infiltrator",
            description: "When you gather info through clandestine observation, or attempt to bypass traps and security measures gain potency."
          },
          {
            name: "Sixth Sense",
            description: "You just know when there are undead nearby. You always know what the highest threat level of undead is in the area. You can gather info on them with RESOLVE."
          },
          {
            name: "Ready for Anything",
            description: "When being ambushed, your fashbacks cost 0 stress and you gain potency to all actions during those fashbacks. You also take 1 level of harm lower when you're a specialist on secondary missions."
          },
          {
            name: "Daredevil",
            description: "When you make a desperate roll gain +1d."
          }
          ],
          base: {
            scout1: "1",
            scout2: "1",
            maneuver1: "1",
            special1: "1",
            item_0_desc: "Fine Compass and Maps*",
            item_1_desc: "Fine Bow and Arrows*",
            item_2_desc: "Black Arrows (3)*",
            item_7_desc: "Climbing Kit*",
            item_8_desc: "Fine Lenses*",
            item_9_desc: "Fine Reliquary (3 uses)*",
            item_16_desc: "Fine Armour*",
            item_17_desc: "Camo Gear*",
            item_20_desc: "Hand Weapon",
            item_21_desc: "Large Weapon",
            item_22_desc: "Pistol",
            item_23_desc: "Ammo (5 shots)",
            item_26_desc: "Flare Gun (3 uses)",
            item_27_desc: "Soldier's Kit",
            playbook_description: "Infiltration\nand\nEvasion",
            setting_showitem_3: "0",
            setting_showitem_4: "0",
            setting_showitem_5: "0",
            setting_showitem_6: "0",
            setting_showitem_10: "0",
            setting_showitem_11: "0",
            setting_showitem_12: "0",
            setting_showitem_13: "0",
            setting_showitem_14: "0",
            setting_showitem_15: "0",
            special_armor1: "Heavy Armour",
            special_skill: "SCROUNGE",
            xp_condition: "If you helped your squad through stealth or foresight."
          }
        },
        sniper: {
          abilities: [{
            name: "One Eye",
            description: "You've replaced an eye with an alchemical construct. You can see invisible targets clearly and identify supernatural forces."
          },
          {
            name: "Ambush",
            description: "When you attack from hiding or spring a trap, you get +1d."
          },
          {
            name: "Akimbo",
            description: "When dueling in close range with two pistols, gain potency."
          },
          {
            name: "Notches",
            description: "If you land the killing blow on a Threat 2 or higher opponent mark 1 xp (any category)."
          },
          {
            name: "Sharpshooter",
            description: "You can push yourself to do one of the following: make a ranged attack at extreme distance, beyond what's normal for the weapon - unleash of barrage of rapid fire to suppress the enemy."
          },
          {
            name: "Cover Fire",
            description: "If you set up someone with shoot or provide covering fire they gain potency on their next action."
          },
          {
            name: "Crimson Shot",
            description: "You're authorized to bring one Crimson Seeker Shell on missions. Firing it counts as a Threat 4 attack, and you must mark a Trauma."
          }
          ],
          base: {
            shoot1: "1",
            shoot2: "1",
            special1: "1",
            scout1: "1",
            item_0_desc: "Black Shot (3)*",
            item_2_desc: "Ammo (5)*",
            item_5_desc: "Fine Long Rifle",
            item_6_desc: "Two Fine Pistols",
            item_7_desc: "Gun Maintenance Kit*",
            item_8_desc: "Fine Armour*",
            item_13_desc: "Two Fine Pistols",
            item_14_desc: "Fine Long Rifle",
            item_20_desc: "Hand Weapon",
            item_21_desc: "Crimson Shot (requires Crimson Shot ability)",
            item_22_desc: "Pistol",
            item_23_desc: "Ammo (5 shots)",
            item_26_desc: "Oil (3 uses)",
            item_27_desc: "Soldier's Kit",
            playbook_description: "Ranged weapon\nSpecialist",
            setting_showitem_1: "0",
            setting_showitem_3: "0",
            setting_showitem_4: "0",
            setting_showitem_9: "0",
            setting_showitem_10: "0",
            setting_showitem_11: "0",
            setting_showitem_12: "0",
            setting_showitem_15: "0",
            setting_showitem_16: "0",
            setting_showitem_17: "0",
            special_armor1: "Heavy Armour",
            special_skill: "AIM",
            xp_condition: "You helped your squad through keen observation or key shots."
          }
        },
        officer: {
          abilities: [{
            name: "Tactician",
            description: "You anticipate problems others would never see coming. When you lead a group action you may suffer at most 1 stress."
          },
          {
            name: "Lead From The Front",
            description: "Whenever you lead a group action, improve scale up or down one level (for example: a small group  counts as a medium group or an individual). If you lead a group action in combat, you may count multiple 6s from different rolls as a critical."
          },
          {
            name: "Logistical Support",
            description: "CHANNELS uses can be spent to assist a squadmate. Tell us how your preparation or supplies help them against this threat or obstacle."
          },
          {
            name: "Mission First",
            description: "Add the following to 'at the end of the mission' xp triggers: If anyone died under your command."
          },
          {
            name: "Obedience",
            description: "An NPC squadmate sacrifices themselves, on your orders. They die, and absorb all the harm for you or another Specialist from one attack. Remember that the Legion takes -1 morale each time this occurs."
          },
          {
            name: "Strategist",
            description: "You gain +1d to sway when acquiring assets for a mission via CHANNELS uses. You also get +1d to the engagement roll for a mission."
          },
          {
            name: "Officer School",
            description: "You're well educated and know arcane esoterica. Gain +1d when gathering info through research. You also gain +1d when resisting with insight."
          }
          ],
          base: {
            item_0_desc: "Flare Gun (4 shots)*",
            item_1_desc: "Fine Armour*",
            item_2_desc: "Fine Hand Weapon*",
            item_5_desc: "Fine Ornate Cloak",
            item_7_desc: "Fine Luxury Item*",
            item_11_desc: "Fine Shield",
            item_12_desc: "Fine Pistol (5 shots)",
            item_15_desc: "Battlefield Banner*",
            item_16_desc: "Fine Heavy Armour (replaces Armour)*",
            item_20_desc: "Hand Weapon",
            item_21_desc: "Large Weapon",
            item_22_desc: "Shield",
            item_23_desc: "Compass and Maps",
            item_26_desc: "Oil (3 uses)",
            item_27_desc: "Lenses",
            playbook_description: "Leader\nand\nTactician",
            consort1: "1",
            consort2: "1",
            discipline1: "1",
            special1: "1",
            setting_showitem_3: "0",
            setting_showitem_4: "0",
            setting_showitem_6: "0",
            setting_showitem_8: "0",
            setting_showitem_9: "0",
            setting_showitem_10: "0",
            setting_showitem_13: "0",
            setting_showitem_14: "0",
            setting_showitem_17: "0",
            special_armor1: "Heavy Armour",
            special_skill: "CHANNELS",
            xp_condition: "You helped your squad through enforcing discipline or strategic planning."
          }
        },
        soldier: {
          abilities: [{
            name: "Relentless",
            description: "You may spend GRIT uses (1‚Äîfor‚Äî1) to push yourself."
          },
          {
            name: "Over the Top",
            description: "When you charge into the teeth of an enemy that outnumbers or outguns you, clear 1 stress and take +1d to maneuver."
          },
          {
            name: "Iron Will",
            description: "You can spend GRIT uses can act as special armour vs fear, paralasys, corruption, and fatigue."
          },
          {
            name: "Loaded for Bear",
            description: "When selecting load you may select 4 utility load instead of 2."
          },
          {
            name: "Eat Iron, Shit Nails",
            description: "When you push yourself you may ignore all harm penalties. Also take +1d to resist the consequences of any roll you pushed yourself on."
          },
          {
            name: "Grenadier",
            description: "You have had explosives training and can bring a grenade (1 load) or explosive charges (2 load) as part of your light load."
          },
          {
            name: "Cavalry",
            description: "If the Quartermaster has any Horses available, all members of your squad start missions with mounts. You gain +1d to maneuver while mounted"
          },
          {
            name: "Specialist Training",
            description: "You can promote to a Specialist(Heavy, Medic, Officer, Scout, or Sniper). Gain 1 special ability, and starting Specialist action (if applicable)."
          }
          ],
          base: {
            maneuver1: "1",
            skirmish1: "1",
            sway1: "1",
            special1: "1",
            item_0_desc: "Fine Armour*",
            item_2_desc: "A Momento of Home*",
            item_5_desc: "Fine Hand Weapon",
            item_6_desc: "Fine Heavy Weapon",
            item_7_desc: "Fine Shield*",
            item_8_desc: "+2 Utility (see Below)*",
            item_9_desc: "Fine Kit (Medic, Climbing, Cooking, Repair, Soldier's, or Wrecking)*",
            item_15_desc: "+1 Utility (see Below)*",
            item_16_desc: "Fine Heavy Armour (replaces Armour)*",
            item_20_desc: "Musket",
            item_21_desc: "Medic Kit (3 uses)",
            item_22_desc: "Pistol",
            item_23_desc: "Ammo (5 shots)",
            item_26_desc: "Oil (3 uses)",
            item_27_desc: "Soldier's Kit",
            playbook_description: "Veteran\nGrunt",
            setting_showitem_1: "0",
            setting_showitem_3: "0",
            setting_showitem_4: "0",
            setting_showitem_10: "0",
            setting_showitem_11: "0",
            setting_showitem_12: "0",
            setting_showitem_13: "0",
            setting_showitem_14: "0",
            setting_showitem_17: "0",
            special_armor1: "Heavy Armour",
            special_skill: "GRIT",
            xp_condition: "You helped your squad through courage or determination."
          }
        },
        rookie: {
          abilities: [{
            name: "Devil's Own Luck",
            description: "You gain +1d to all resistance rolls. This ability cannot be taken as a Veteran advance."
          },
          {
            name: "Every Inch A...",
            description: "You start with all the traits from your heritage. If taken as a Veteran advance, this must be taken as your first ability."
          },
          {
            name: "Hard Knocks",
            description: "Mark 2 xp (any category) at the end of any mission where you took level 2 harm or higher. This ability cannot be taken as a Veteran advance."
          },
          {
            name: "Just a Kid",
            description: "Whenever someone suffers harm when protecting you, they may mark an xp. When you promote choose a second special ability from your new playbook to replace this one. This ability cannot be taken as a Veteran advance."
          },
          {
            name: "Gotta Make it Out Alive",
            description: "You can take 1 additional trauma before dying. When you promote replace this ability with a level of Survivor.This ability cannot be taken as a Veteran advance."
          },
          {
            name: "Home Cooking",
            description: "If a mission takes multiple days, expend your Fresh Food. Say what you cook. Everyone in the squad that partakes clears 1 stress. This ability cannot be taken as a Veteran advance."
          },
          {
            name: "Jack of all Trades",
            description: "Increase 2 zero-ranked skills to rank 1. This ability cannot be taken as a Veteran advance."
          },
          {
            name: "Not A Rookie Anymore",
            description: "YOU MAY NOT TAKE THIS AS YOUR STARTING ABILITY. You are promoted! You become a Soldier. Gain one special ability and 1 rank of your specialist action. YOU MUST SPECIALIZE AS YOUR FIRST PLAYBOOK ADVANCE. This ability cannot be taken as a Veteran advance."
          }
          ],
          base: {
            maneuver1: "1",
            skirmish1: "1",
            sway1: "1",
            item_0_desc: "Naive Hope*",
            item_1_desc: "Memento of Home*",
            item_2_desc: "Soldier's Kit*",
            item_3_desc: "Musket*",
            item_4_desc: "Ammo (5 shots)*",
            item_8_desc: "Family Weapon*",
            item_11_desc: "Tents and Camping Gear",
            item_12_desc: "Cooking Kit and Fresh Food",
            item_15_desc: "Armour*",
            item_16_desc: "Shield*",
            item_20_desc: "Armour",
            item_21_desc: "Hand Weapon",
            item_22_desc: "Shield",
            item_23_desc: "Medic Kit (3 uses)",
            item_26_desc: "Oil (3 uses)",
            item_27_desc: "Climbing Kit",
            playbook_description: "Fresh Faced\nRecruit",
            setting_showitem_5: "0",
            setting_showitem_6: "0",
            setting_showitem_7: "0",
            setting_showitem_9: "0",
            setting_showitem_10: "0",
            setting_showitem_13: "0",
            setting_showitem_14: "0",
            setting_showitem_17: "0",
            special_armor1: "Heavy Armour",
            special_skill: "-",
            xp_condition: "You helped your squad by staying out of the way and surviving despite the odds."
          }
        }
      },
      actionData = {
        insight: ["special", "research", "scout", "rig"],
        prowess: ["wreck", "skirmish", "shoot", "maneuver"],
        resolve: ["marshall", "discipline", "consort", "sway"]
      };
    
    const setDiceFromTotal = function (name, numDice) {
        const setting = {};
        setting[`${name}1`] = (numDice > 0) ? "1" : "0";
        setting[`${name}2`] = (numDice > 1) ? "1" : "0";
        setting[`${name}3`] = (numDice > 2) ? "1" : "0";
        setting[`${name}4`] = (numDice > 3) ? "1" : "0";
        setAttrs(setting);
      },
      fillRepeatingSectionFromData = (sectionName, dataList) => {
        getSectionIDs(`repeating_${sectionName}`, idList => {
          getAttrs(idList.map(id => `repeating_${sectionName}_${id}_name`), v => {
            const existingRowNames = idList.map(id => v[`repeating_${sectionName}_${id}_name`]),
              createdIDs = [],
              setting = dataList.filter(o => !existingRowNames.includes(o.name))
                .map(o => {
                  let rowID;
                  while (!rowID) {
                    let newID = generateRowID();
                    if (!createdIDs.includes(newID)) {
                      rowID = newID;
                      createdIDs.push(rowID);
                    }
                  }
                  return Object.keys(o).reduce((m, key) => {
                    m[`repeating_${sectionName}_${rowID}_${key}`] = o[key];
                    return m;
                  }, {});
                })
                .reduce((m, o) => Object.assign(m, o), {});
            setAttrs(setting);
          });
        });
      },
      emptyFirstRowIfUnnamed = function (sectionName) {
        getSectionIDs(`repeating_${sectionName}`, function (idList) {
          let id = idList[0];
          getAttrs([`repeating_${sectionName}_${id}_name`], function (v) {
            if (!v[`repeating_${sectionName}_${id}_name`]) {
              removeRepeatingRow(`repeating_${sectionName}_${id}`);
            }
          });
        });
      },
      calculateResistance = (name) => {
        getAttrs(actionData[name].map(x => `${x}1`), v => {
          const numDice = Object.values(v).reduce((s, v) => s + parseInt(v || 0), 0);
          setDiceFromTotal(name, numDice);
        });
      },
      handleFourBoxesFill = (name) => {
        on(`change:${name}1 change:${name}2 change:${name}3 change:${name}4`, (event) => {
          getAttrs([event.sourceAttribute], (v) => {
            const setting = {},
              rName = event.sourceAttribute.slice(0, -1);
            if (v[event.sourceAttribute] === "1") {
              switch (event.sourceAttribute.slice(-1)) {
              case "4":
                setting[`${rName}3`] = "1";
                /* falls through */
              case "3":
                setting[`${rName}2`] = "1";
                /* falls through */
              case "2":
                setting[`${rName}1`] = "1";
              }
            }
            if (v[event.sourceAttribute] === "0") {
              switch (event.sourceAttribute.slice(-1)) {
              case "1":
                setting[`${rName}2`] = "0";
                /* falls through */
              case "2":
                setting[`${rName}3`] = "0";
                /* falls through */
              case "3":
                setting[`${rName}4`] = "0";
              }
            }
            setAttrs(setting);
          });
        });
      };
    
    const actionsFlat = Object.values(actionData).reduce((m, a) => m.concat(a), []),
      playbookAttributes = [...new Set([].concat(...Object.keys(playbookData).map(x => Object.keys(playbookData[x].base))))];
    
    on("change:playbook", () => {
      getAttrs(["playbook", "changed_attributes"], v => {
        const changedAttributes = (v.changed_attributes || "").split(",");
        const source = playbookData[v.playbook.toLowerCase()];
    
        if (source) {
          const finalSettings = Object.entries(source.base).reduce((settings, [name, value]) => {
            if (!changedAttributes.includes(name)) settings[name] = value;
            return settings;
          }, playbookAttributes.reduce((settings, name) => {
            if (!changedAttributes.includes(name)) settings[name] = "";
            return settings;
          }, {}));
          setAttrs(finalSettings);
        }
      });
    });
    
    playbookAttributes.forEach((name) => {
      on(`change:${name}`, (eventInfo) => {
        if (eventInfo.sourceType === "player") {
          getAttrs(["changed_attributes"], (v) => {
            const changedAttributes = [...new Set((v.changed_attributes || "").split(",").concat([name]))].join(",");
            setAttrs({
              changed_attributes: changedAttributes
            });
          });
        }
      });
    });
    
    Object.entries(actionData).forEach(([attribute, actions]) => {
      actions.forEach((actionName) => on(`change:${actionName}1`, () => calculateResistance(attribute)));
    });
    
    actionsFlat.forEach(handleFourBoxesFill);
    
    on("change:generate_abilities", () => {
      getAttrs(["generate_source"], (v) => {
        emptyFirstRowIfUnnamed("ability");
        fillRepeatingSectionFromData("ability", playbookData[v.generate_source].abilities);
      });
    });
    
    on("sheet:opened", () => {
      const initialRows = ["ability"];
      getAttrs(["version"], (v) => {
        const upgradeSheet = version => {
          const [major, minor, patch] = version && version.split(".").map(x => parseInt(x, 10));
          console.log(`Found version ${version}`);
          if (major === 0 && minor < 2) updateToV0_2();
        };
        const initialiseSheet = () => {
          const setting = initialRows.reduce((memo, sectionName) => {
            memo[`repeating_${sectionName}_${generateRowID()}_dummy`] = 1;
            return memo;
          }, {});
          setAttrs(setting);
        };
        const updateToV0_2 = () => {
          console.log('Updating to version 0.2');
          getAttrs(["tinker1", "tinker2", "tinker3"], (v) => {
            if (v.tinker1) setAttrs({ rig1: v.tinker1 });
            if (v.tinker2) setAttrs({ rig2: v.tinker2 });
            if (v.tinker3) setAttrs({ rig3: v.tinker3 });
          });
        };
        if (v.version) upgradeSheet(v.version);
        else initialiseSheet();
        setAttrs({
          version: sheetVersion,
          character_sheet: `${sheetName} v${sheetVersion}`
        });
      });
    });
</script>
