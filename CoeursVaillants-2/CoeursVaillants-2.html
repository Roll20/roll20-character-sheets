<!-- ------------------------ -->
<!-- Version mangement script -->
<!-- ------------------------ -->
<input name="attr_sheet_version" type="hidden" />
<input name="attr_pvmax" type="hidden" />
<input name="attr_aventureMax" type="hidden" />
<script type="text/worker">
// Version update for new or modified attributes
on("sheet:opened", function() {
    getAttrs(["pvmax","aventureMax","sheet_version"], function(values) {
        const sheet_version = parseInt(values.sheet_version) || 0;
        var attrs = {};

        // get attribute updates for each version until the sheet has completed all steps
        // NOTE: to maintain backwards compatibility with sheets predating the version attribute, all steps will be performed for new sheets
        if (sheet_version < 1) {
            attrs["sheet_version"] = 1;
            attrs["pv_max"] = values.pvmax;
            attrs["aventure_max"] = values.aventureMax;
        }
        
        /*
        * if (sheet_version < 2) {
        *     attrs["sheet_version"] = 2;
        * }
        */

        if (Object.keys(attrs).length) {
            setAttrs(attrs);
        }
    });
});
</script>

<!-- -------------- -->
<!-- Sélecteur type -->
<!-- -------------- -->
<input name="attr_type_fiche" type="hidden" value="personnage"/>
<div style="text-align: left;">
  <select class="sheet-block_switch" name="attr_type_fiche">
    <option selected="selected" value="personnage">Personnage</option>
    <option value="bestiaire">Bestiaire</option>
  </select>
</div>

<!-- ----------- -->
<!-- Écran PJ -->
<!-- ----------- -->
<div class="sheet-main sheet-block_a">
    <!-- Entête -->
	<div class="sheet-ligne sheet-borderBottom">
		<div class="sheet-ligne" style="text-align: center;">
			<img title="Version 2.0 - 02/07/2022" src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/CoeursVaillants-2/images/Logo.png" width="30%" />
		</div>
        <!-- Cadre infos -->
		<div class="sheet-mycolbrd" style="width: 71%;">
			<div class="sheet-mycol" style="width: 49%;">
				<div class="sheet-ligne" style="margin-bottom: 3px;">
					<div class="sheet-libel2" style="width: 65px;">Nom</div>
					<input type="text" class="sheet-biginp" name="attr_character_name" />
					<div class="sheet-libel1" style="margin-bottom: 0px;">Origine</div>
					<input type="text" style="margin-bottom: 0px;" name="attr_peuple" />
					<div class="sheet-libel1" style="margin-bottom: 0px">Métiers</div>
					<input type="text" name="attr_classe" />
				</div>
			</div>
			<div class="sheet-mycol" style="vertical-align: top; width: 49%;">
				<div class="sheet-ligne" style="margin-top: 11px;">
					<div class="sheet-libel1" style="margin: 0px; padding: 0px;">Description</div>
					<textarea name="attr_charDesc" style='margin: 0px; width: 285px; height: 45px;'></textarea>
				</div>
			</div>
      <div class="sheet-ligne" style="margin-top: 5px;">
        <div class="sheet-libel1" style="width: 65px; height: 45px; vertical-align: top; margin: 0px; padding: 0px;">Histor.</div>
        <textarea name="attr_historique" style='margin: 0px; width: 512px; height: 45px;'></textarea>
      </div>
    </div>
    <!-- Cadre niveau -->
		<div class="sheet-mycolbrd" style="width: 28%;">
			<div class="sheet-ligne" style="vertical-align: top; text-align: right;">
				<div class="sheet-libel2" style="margin-right: 2px;">Niv</div>
				<input type="number" name="attr_niveau" class='sheet-inpnum2cbig' style="width: 38px; margin-right: 5px;" value='1' min="1" max="7">
				<div class="sheet-libel1" style="width: 18px; margin-right: 2px;">XP</div>
				<input type="number" name="attr_xp" class='sheet-inpnum2c' style="width: 38px;" value='0' min="0">
        <div class="sheet-infoDesc" style="vertical-align: middle; margin: 0px;">/</div>
        <input type="number" name="attr_xpTotal" class='sheet-inpnum2c' style="width: 45px;" value='0' min="0">
			</div>
			<div class="sheet-ligne" style="margin-top: 3px; margin-bottom: 20px;">
				<div class="sheet-libeldesc">1XP : relancer avec Avantage</div>
				<div class="sheet-libeldesc">3XP × Niveau : gain de niveau</div>
				<div class="sheet-libeldesc">6XP : acheter une Capacité de classe</div>
			</div>
      <div>
				<button type='roll' name='roll_testDemiNiv' class="sheet-btRoll20deminiv sheet-btMid" style="width: 105px; margin-right: 10px;" value='&{template:jet} {{characterName=@{character_name}}} {{rollname=1D20 + ½Niv}} {{rollResult1=[[1d20+[[floor(@{niveau}/2)]][Bonus]]]}} {{rollResult2=[[1d20+[[floor(@{niveau}/2)]][Bonus]]]}}'>D20+½Niv</button>
				<button type='roll' name='roll_testvig' class="sheet-btRoll20niv sheet-btMid" style="width: 90px;" value='&{template:jet} {{characterName=@{character_name}}} {{rollname=1D20 + Niv}} {{rollResult1=[[1d20+@{niveau}[Bonus]]]}} {{rollResult2=[[1d20+@{niveau}[Bonus]]]}}'>D20+Niv</button>
      </div>
		</div>
	</div>
  <!-- Données chiffrées -->
	<div class="sheet-ligne sheet-borderBottom">
    <!-- Cadre caracs -->
		<div class="sheet-mycolbrd sheet-borderRight" style="width: 33%; height: 270px; text-align: left;">
			<div class="sheet-ligne" style="margin-bottom: 8px;">
				<button type='roll' name='roll_testfor' title='Tirer une nouvelle série de caracs' class="sheet-btRoll6 sheet-btSmall" value='&{template:jet} {{characterName=@{character_name}}} {{rollname=Tirage de Caractéristiques}} {{tSerie1=[[3d6]] [[3d6]] [[3d6]] [[3d6]]}} {{tSerie2=[[3d6]] [[3d6]] [[3d6]] [[3d6]]}} {{tRollDesc=Plus c’est bas mieux c’est !}}'>Carac.</button>
			</div>
      <!-- Ligne vig -->
			<div class="sheet-ligne">
				<button type='roll' name='roll_testvig' class="sheet-btRoll20deminiv sheet-btBig" value='&{template:jet} {{characterName=@{character_name}}} {{rollname=Test de Vigueur}} {{carac=[[@{vig}]]}} {{rollResult1=[[1d20+[[floor((@{niveau}+@{niveau}*@{CompVig})/2)]][Bonus]]]}} {{rollResult2=[[1d20+[[floor((@{niveau}+@{niveau}*@{CompVig})/2)]][Bonus]]]}}'>Vig</button>
				<input type="number" name="attr_vig" class='sheet-inpnum2cbig' style="margin-right: 10px; width: 45px" value='10' min="0" max="20" />
        <input type="checkbox" class="check-button check-buttonComp" id="checkCompVig" value="1" name="attr_CompVig"/>
        <label for="checkCompVig">Comp.</label>
			</div>
			<div class="sheet-infoDesc sheet-marginCarac">Vigueur</div>
      <!-- LIGNE DEX -->
			<div class="sheet-ligne">
				<button type='roll' name='roll_testDex' class="sheet-btRoll20deminiv sheet-btBig" value='&{template:jet} {{characterName=@{character_name}}} {{rollname=Test de Dextérité (½Niveau)}} {{carac=[[@{dex}]]}} {{rollResult1=[[1d20+[[floor((@{niveau}+@{niveau}*@{CompDex})/2)]][Bonus]]]}} {{rollResult2=[[1d20+[[floor((@{niveau}+@{niveau}*@{CompDex})/2)]][Bonus]]]}}'>Dex</button>
				<input type="number" name="attr_dex" class='sheet-inpnum2cbig' style="margin-right: 10px; width: 45px" value='10' min="0" max="20" />
        <input type="checkbox" class="check-button check-buttonComp" id="checkCompDex" value="1" name="attr_CompDex"/>
        <label for="checkCompDex">Comp.</label>
			</div>
			<div class="sheet-infoDesc sheet-marginCarac">Dextérité</div>
			<!-- LIGNE INT -->
      <div class="sheet-ligne">
				<button type='roll' name='roll_testInt' class="sheet-btRoll20deminiv sheet-btBig" value='&{template:jet} {{characterName=@{character_name}}} {{rollname=Test d’Intelligence (½Niveau)}} {{carac=[[@{int}]]}} {{rollResult1=[[1d20+[[floor((@{niveau}+@{niveau}*@{CompInt})/2)]][Bonus]]]}} {{rollResult2=[[1d20+[[floor((@{niveau}+@{niveau}*@{CompInt})/2)]][Bonus]]]}}'>Int</button>
				<input type="number" name="attr_int" class='sheet-inpnum2cbig' style="margin-right: 10px; width: 45px" value='10' min="0" max="20" />
        <input type="checkbox" class="check-button check-buttonComp" id="checkCompInt" value="1" name="attr_CompInt"/>
        <label for="checkCompInt">Comp.</label>
			</div>
			<div class="sheet-infoDesc sheet-marginCarac">Intelligence</div>
			<!-- LIGNE CHA -->
      <div class="sheet-ligne">
				<button type='roll' name='roll_testCha' class="sheet-btRoll20deminiv sheet-btBig" value='&{template:jet} {{characterName=@{character_name}}} {{rollname=Test de Charisme (½Niveau)}} {{carac=[[@{cha}]]}} {{rollResult1=[[1d20+[[floor((@{niveau}+@{niveau}*@{CompCha})/2)]][Bonus]]]}} {{rollResult2=[[1d20+[[floor((@{niveau}+@{niveau}*@{CompCha})/2)]][Bonus]]]}}'>Cha</button>
				<input type="number" name="attr_cha" class='sheet-inpnum2cbig' style="margin-right: 10px; width: 45px" value='10' min="0" max="20" />
        <input type="checkbox" class="check-button check-buttonComp" id="checkCompCha" value="1" name="attr_CompCha"/>
        <label for="checkCompCha">Comp.</label>
			</div>
			<div class="sheet-infoDesc sheet-marginCarac">Charisme</div>
			<div class="sheet-libel1" style="margin: 10px 0px 0px 0px; padding: 0px;">Compensations</div>
			<textarea name="attr_compensations" style='margin: 0px; width: 270px; height: 40px;'></textarea>
		</div>
    <!-- Partie droite -->
		<div class="sheet-mycol" style="width: 66%;">
    <!-- Ligne du haut -->
			<div class="sheet-ligne sheet-borderBottom">
        <!-- CADRE PV -->
				<div class="sheet-mycolbrd sheet-borderRight" style="width: 49%;">
					<div class="sheet-ligne" style="text-align: center;">
						<div class="sheet-libel3" style="width: 190px;">Points de Vie</div>
					</div>
					<div class="sheet-ligne" style="text-align: center; margin-bottom: 8px;">
						<input type="number" name="attr_pv" class='sheet-inpnum2cbig' style="width: 53px; vertical-align: bottom;" value='0'>
            <div class="sheet-libel1" style="width:10px; vertical-align: bottom;">/</div>
            <input type="number" name="attr_pv_max" class='sheet-inpnum2c' style="width: 45px; margin-right: 20px; vertical-align: bottom" value='0' />
            <div class="sheet-mycol">
              <div class="sheet-infoDesc" style="display: block;">Temp.</div>
              <input type="number" name="attr_pvTemp" class='sheet-inpnum2c' style="width:40px;" value='0'/>
            </div>
            <div class="sheet-mycol">
              <div class="sheet-infoDesc" style="display: block;">Aggr.</div>
              <input type="number" name="attr_pvAggr" class='sheet-inpnum2c' style="width:40px;" value='0'/>
            </div>
					</div>
					<div class="sheet-ligne" style="margin-bottom: 5px; text-align: center;">
						<button type='roll' name='roll_jetdv' class="sheet-btRoll8 sheet-btMid" style="width: 105px;" value='&{template:jet} {{characterName=@{character_name}}} {{rollname=Nouveaux PV}} {{rollResult1=[[@{niveau}d8+@{bonusPv}]]}}'>Jet PV max</button>
						<div class="sheet-libel1" style="width:10px">+</div>
						<input type="text" name="attr_bonusPv" style="width: 35px; text-align: center;" value='8' />
					</div>
					<div class="sheet-ligne" style="margin-bottom: 8px; text-align: center;">
            <button type='roll' name='roll_testRepit' class="sheet-btRoll4 sheet-btMid" style="width: 60px;" value='&{template:jet} {{characterName=@{character_name}}} {{rollname=Récupération - répit}} {{rollResult1=[[@{niveau}d4]] PV}}'>Répit</button>
            <button type='roll' name='roll_testSecSouffle' class="sheet-btRoll8 sheet-btMid" style="width: 105px;" value='&{template:jet} {{characterName=@{character_name}}} {{rollname=Second souffle}} {{rollResult1=[[@{niveau}d8]] PV}}'>2nd souffle</button>
					</div>
				</div>
        <!-- CADRE PA -->
				<div class="sheet-mycolbrd" style="width: 49%;">
					<div class="sheet-ligne" style="margin-bottom: 0px; text-align: center;">
						<div class="sheet-libel3" style="width: 200px;">Points d'Aventure</div>
					</div>
					<div class="sheet-ligne" style="margin-bottom: 0px; text-align: center;">
						<input type="number" name="attr_aventure" class='sheet-inpnum2cbig' style="width: 40px; margin-right: 0px;" value='1' min="0">
            <div class="sheet-libel1" style="width: 5px; margin: 0px;">/</div>
            <input type="number" name="attr_aventure_max" class='sheet-inpnum2c' style="width: 35px; margin-right: 0px;" value='1' min="0"/>
					</div>
					<div class="sheet-ligne" style="margin-top: 5px; text-align: right;">
						<div class="sheet-libeldesc">Jet avec avantage</div>
						<div class="sheet-libeldesc">Une seconde action en combat</div>
						<button type='roll' name='roll_testAvPV' class="sheet-btRoll8 sheet-btSmall" style="width: 162px; height: 15px;" value='&{template:jet} {{characterName=@{character_name}}} {{rollname=Regain de PV}} {{rollResult1=[[1d8+@{niveau}]]}}'>Récupérer 1d8 + niveau PV</button>
						<div class="sheet-libeldesc">Sortir un objet exeptionnel de son sac</div>
						<div class="sheet-libeldesc">Autre… selon univers</div>
					</div>
				</div>
			</div>
      <!-- Ligne du bas -->
			<div class="sheet-ligne">
        <!-- CADRE DEF -->
				<div class="sheet-mycolbrd sheet-borderRight" style="width: 49%;">
					<div class="sheet-ligne" style="text-align: center;">
						<div class="sheet-libel3" style="width: 80px; margin-bottom: 3px;">Défense</div>
					</div>
					<div class="sheet-ligne" style="text-align: center; margin-bottom: 10px;">
						<div class="sheet-mycol">
							<div class="sheet-ligne">
								<div class="sheet-libel1" style="width: 55px; text-align: right;">Base</div>
								<input type="number" name="attr_defBase" class='sheet-inpnum2c' style="width: 35px;" value='10' min="0" max="40" />
							</div>
							<div class="sheet-ligne">
								<div class="sheet-libel1" style="width: 55px; text-align: right;">Armure</div>
								<input type="number" name="attr_bonusArmu" class='sheet-inpnum2c' style="width: 35px;" value='0' min="0" max="40" />
							</div>
						</div>
						<input type="number" name="attr_ca" class='sheet-inpnum2cbig' style="width: 45px; margin-left: 15px; margin-top: 5px;" value='10' min="0" max="40" />
					</div>
					<div class="sheet-ligne" style="margin-bottom: 20px; text-align: center;">
						<button type='roll' name='roll_testMan' class="sheet-btRoll20deminiv sheet-btMid"  style="width: 110px;" value='&{template:jet} {{characterName=@{character_name}}} {{rollname=Jet de Mouvement}} {{carac=[[@{mouvement}]]}} {{rollResult1=[[1d20+[[floor((@{niveau}+@{niveau}*@{CompMou})/2)]][Bonus]]]}} {{rollResult2=[[1d20+[[floor((@{niveau}+@{niveau}*@{CompMou})/2)]][Bonus]]]}}'>Mouvement</button>
						<input type="number" name="attr_mouvement" class='sheet-inpnum2c' style="width: 35px; margin-right: 10px;" value='10' />
            <input type="checkbox" class="check-button check-buttonComp" id="checkCompMou" value="1" name="attr_CompMou"/>
            <label for="checkCompMou">Comp.</label>
					</div>
				</div>
        <!-- CADRE SAUVEGARDES -->
				<div class="sheet-mycolbrd" style="width: 49%;">
					<div class="sheet-ligne" style="padding-top: 8px; margin-bottom: 5px; text-align: center;">
						<button type='roll' name='roll_testSave' class="sheet-btRoll20niv sheet-btBig" style="width: 170px;" value='&{template:jet} {{characterName=@{character_name}}} {{rollname=Sauvegarde}} {{carac=[[@{svg}]]}} {{rollResult1=[[1d20+@{niveau}]]}} {{rollResult2=[[1d20+@{niveau}]]}}'>Sauvegarde</button>
						<input type="number" name="attr_svg" class='sheet-inpnum2cbig' style="width: 45px" title='Seuil' value='15'>
					</div>
					<div class="sheet-ligne" style="padding-top: 5px; margin-bottom: 5px; text-align: center;">
						<button type='roll' name='roll_testChance' class="sheet-btRoll8 sheet-btBig" style="width: 195px;" value='&{template:jet} {{characterName=@{character_name}}} {{rollname=Jet de Chance}} {{jetChance=[[1d8]]}}'>Jet de Chance</button>
					</div>
					<div class="sheet-ligne" style="padding-top: 5px; margin-bottom: 5px; text-align: center;">
						<input type="checkbox" class="check-button check-buttonExalt" id="checkExalt" value="exalte" name="attr_exalte"/>
						<label for="checkExalt">Exalté</label>
					</div>
				</div>
			</div>
		</div>
  </div>
  <!-- Cadre Combat -->
  <div class="sheet-mycolbrd sheet-borderBottom" style="width: 100%;">
		<div class="sheet-ligne">
			<div class="sheet-libel2" style="width: 80px; margin-right: 50px;">Combat</div>
      <span class="sheet-infoDesc">Bonus aux jets de combat</span>
      <input type="number" name="attr_bonusCombat" class='sheet-inpnum2c' value='0' />
		</div>
    <div class="sheet-ligne" style="text-align: left; margin-bottom: 10px;">
      <div class="sheet-mycol" style="margin-right: 30px;">
        <button type='roll' name='roll_testinit' class="sheet-btRoll8 sheet-btMid" style="width: 90px;" value='&{template:jet} {{characterName=@{character_name}}} {{rollname=Jet d’Initiative}} {{rollResult1=[[@{initiative}+@{niveau} &{tracker}]]}}'>Initiative</button>
        <input type="text" name="attr_initiative" style="width: 45px; text-align: center;" value='1d8' />
        <span class="sheet-infoDesc">+Niv</span>
      </div>
      <div class="sheet-mycol" style="margin-right: 30px;">
        <button type='roll' name='roll_testtruc' class="sheet-btRoll20niv sheet-btMid" style="width: 140px;" value='&{template:jet} {{characterName=@{character_name}}} {{rollname=Truc de combat}} {{carac=[[?{Carac|Vigueur,@{vig}|Dextérité,@{dex}|Intelligence,@{int}|Charisme,@{cha}}]]}} {{rollResult1=[[1d20+@{niveau}[Niveau]+@{bonusCombat}[Bonus de combat]]]}} {{rollResult2=[[1d20+@{niveau}[Niveau]+@{bonusCombat}[Bonus de combat]]]}}'>Truc de combat</button>
      </div>
      <div class="sheet-mycol">
        <div class="sheet-libel1" style="width: 50px; margin-right: 5px;">Vitesse</div>
        <input type="number" name="attr_mvt" class='sheet-inpnum2c' value='6' />
        <span class="sheet-infoDesc">pas</span>
      </div>
      <div class="sheet-mycol">
        <div class="sheet-libeldesc" style="text-align: left; display: block;">Moitié : +1 attaque ou Déf</div>
        <div class="sheet-libeldesc" style="text-align: left; display: block;">Double : -2 Déf</div>
      </div>
    </div>
		<div class="sheet-ligne">
      <span class="sheet-infoDesc" style="margin-right: 192px;">Arme</span>
      <span class="sheet-infoDesc" style="margin-right: 5px;">Bonus</span>
      <span class="sheet-infoDesc" style="margin-right: 53px;">Dégâts</span>
      <span class="sheet-infoDesc">Description</span>
    </div>
		<div class="sheet-ligne">
			<fieldset class='repeating_inventory'>
				<button type='roll' name='roll_testcombat1' class="sheet-btRoll20niv sheet-btBig" style="width: 25px; padding: 2px 2px 0 2px;" value='&{template:jet} {{characterName=@{character_name}}} {{arme=@{invArme1}}} {{rollResult1=[[1d20[D20]+@{niveau}[Niveau]+@{bonusCombat}[Bonus de combat]+@{bonusArme1}[Bonus arme]]]}} {{rollResult2=[[1d20[D20]+@{niveau}[Niveau]+@{bonusCombat}[Bonus de combat]+@{bonusArme1}[Bonus arme]]]}} {{coup=[[@{dmgArme1}]]}} {{desdegats=@{dmgArme1}}} {{tRollDesc=@{armDesc1}}}'></button>
				<input type="text" name="attr_invArme1" class="sheet-biginp" style="width: 195px;" placeholder="Arme/Attaque" />
				<input type="number" name="attr_bonusArme1" class="sheet-inpnum2c" style="border: 1px solid;" value="0" title="Bonus à l’attaque" min="0" />
				<input type="text" name="attr_dmgArme1" style="width: 100px; text-align: center;" placeholder="1d8" title="Dés de dégâts" />
				<input type="text" name="attr_armDesc1" style="width: 445px;" placeholder="Description" />
			</fieldset>
		</div>
  </div>
  <!-- Cadre Capacités -->
  <div class="sheet-mycolbrd sheet-borderBottom" style="width: 100%;">
		<div class="sheet-ligne">
			<div class="sheet-libel2">Origine</div>
		</div>
		<div class="sheet-ligne sheet-borderBottom" style="text-align: left;">
      <input type="text" name="attr_orig_name" class="sheet-biginp" style="width: 300px" placeholder="Nom de l’origine" />
      <textarea name="attr_orig_atour" style='margin: 0px; width: 100%; height: 63px; display: block;' placeholder="Atour"></textarea>
      <textarea type="text" name="attr_orig_prouesse" style='margin: 0px; width: 100%; height: 63px; display: block;' placeholder="Prouesse"></textarea>
      <div class="sheet-libel1" style="width: 15%; height: 45px; vertical-align: top; margin: 0px; padding: 0px;">Don de naissance</div>
      <textarea name="attr_donNaiss" style='margin: 0px; width: 84%; height: 45px; display: inline;'></textarea>
    </div>
		<div class="sheet-ligne">
			<div class="sheet-libel2">Métiers</div>
		</div>
		<div class="sheet-ligne" style="text-align: left;">
			<fieldset class='repeating_capacite'>
        <div class="sheet-borderBottom" style="text-align: left; margin-bottom: 5px; padding-bottom: 5px;">
          <input type="text" name="attr_capaName" class="sheet-biginp" style="width: 300px" placeholder="Nom du métier" />
          <textarea name="attr_capaAtour" style='margin: 0px; width: 100%; height: 63px; display: block;' placeholder="Atour"></textarea>
          <textarea name="attr_capaUsuel" style='margin: 0px; width: 350px; height: 63px; display: inline;' placeholder="Usuel"></textarea>
          <div class="sheet-mycol">
            <div class="sheet-ligne" style="margin-bottom: 5px;">
              <input type="number" name="attr_utilRest" class="sheet-inpnum2c" style="border: 1px solid;" value="0" min="0" />
              <span class="sheet-infoDesc">/</span>
              <input type="number" name="attr_utilMax" class="sheet-inpnum2c" style="border: 1px solid;" value="0" min="0" />
            </div>
            <input type="text" name="attr_macroCapa" style="width: 90px; text-align: center;" placeholder="(macro)" title="Macro" />
            <button type='roll' name='roll_testCapa' class="sheet-btRoll20deminiv" value='&{template:jet} {{characterName=@{character_name}}} {{rollname=@{capaName}}} {{rollResult1=[[@{macroCapa}]]}}'></button>
          </div>
          <textarea type="text" name="attr_capaProuesse" style='margin: 0px; width: 350px; height: 63px; display: inline;' placeholder="Prouesse"></textarea>
        </div>
			</fieldset>
		</div>
  </div>
  <!-- Cadre Équipements et Talents -->
  <div class="sheet-mycolbrd" style="width: 100%;">
		<div class="sheet-mycol" style="width: 49%;">
			<div class="sheet-ligne">
				<div class="sheet-libel3" style="width: 100%;">Inventaire</div>
			</div>
			<div class="sheet-ligne">
				<textarea name="attr_equip" class='sheet-text2col'>Équipement :
Consommables :
Autres :</textarea>
			</div>
			<div class="sheet-ligne">
				<div class="sheet-mycol">
					<div class="sheet-libel1" style="text-align: left; width: 200px;">Points de trésor (commun)</div>
					<input type="text" name="attr_po" style="width: 40px; text-align: center;" value="0"/>
				</div>
			</div>
		</div>
		<div class="sheet-mycol" style="width: 49%;">
			<div class="sheet-ligne">
				<div class="sheet-libel3" style="width: 100%;">Langues, Talents</div>
			</div>
			<div class="sheet-ligne">
				<textarea name="attr_bonus" class='sheet-text2col'>Langues :
Talents :</textarea>
			</div>
		</div>
    </div>
</div>

<!-- ----------- -->
<!-- FICHE PNJ -->
<!-- ----------- -->
<div class="sheet-main sheet-block_b">
  <!-- NOM -->
    <div class="sheet-ligne">
      <div class="sheet-libel2" style="width: 65px;">Nom</div><input type="text" name="attr_character_name" class='sheet-long'>
    </div>
    <!-- Données chiffrées 1 -->
    <div class="sheet-ligne">
      <div class="sheet-libel1" style="width: 30px;">Niv</div><input type="number" name="attr_pnjNiv" class="sheet-inpnum2cbig" style="width: 45px;" value='1' min="0">
      <div class="sheet-libel1" style="width: 30px;">PV+</div><input type="number" name="attr_pnjPvBonus" class='sheet-short' value='0' min="0">
      <button type='roll' name='roll_jetpvpnj' class="sheet-btRoll8" value='@{jetCache} &{template:jet} {{characterName=@{character_name}}} {{rollname=PV du PNJ}} {{rollResult1=[[{@{pnjNiv}d8,1d4}kh1+@{pnjPvBonus}]]}}'></button>
      <div class="sheet-libel1" style="width: 20px;">PV</div><input type="number" name="attr_pnjpv" class='sheet-extrashort' value='0'> / <input type="number" name="attr_pnjpv_max" class='sheet-extrashort' value='0'>
      <select name="attr_jetCache" id="attr_jetCache" style="width: 110px; margin-left: 15px;">
        <option value="/w gm ">Jets cachés</option>
        <option value=" ">Jets publics</option>
      </select>
    </div>
    <!-- Données chiffrées 2 -->
    <div class="sheet-ligne" style="margin-bottom: 10px;">
      <div class="sheet-libel1" style="width: 30px;">Déf</div><input type="number" name="attr_pnjDef" class='sheet-short' value='10'>
      <div class="sheet-libel1" style="width: 35px;">Vit</div><input type="text" name="attr_pnjVts" class='sheet-medium' value='6'>
      <div class="sheet-libel1" style="width: 40px; margin-left: 5px;">Svg</div><input type="number" name="attr_pnjsvg" class='sheet-short' value='18'>
      <button type='roll' name='roll_jetsvgpnj' class="sheet-btRoll20niv" value='@{jetCache} &{template:jet} {{characterName=@{character_name}}} {{rollname=Sauvegarde PNJ}} {{carac=[[@{pnjsvg}]]}} {{rollResult1=[[1d20+@{pnjNiv}]]}} {{rollResult2=[[1d20+@{pnjNiv}]]}}'></button>
      <div class="sheet-libel1" style="width: 75px;">Initiative</div><input type="text" name="attr_initiative" class='sheet-short' value="1d8">
      <button type='roll' name='roll_testinit' class="sheet-btRoll8" value='@{jetCache} &{template:jet} {{characterName=@{character_name}}} {{rollname=Initiative PNJ}} {{rollResult1=[[@{initiative}+[[{ {@{pnjNiv}}, {12}}kl1]] &{tracker}]]}}'></button>
    </div>
    <div class="sheet-ligne">
      <div class="sheet-libel2">ACTIONS</div>
    </div>
    <div class="sheet-ligne">
      <input type="text" name="attr_pnjarm1" style="width: 30%;" placeholder="Arme/Attaque">
      <input type="text" name="attr_pnjdmgarm1" placeholder="1d8" class='sheet-medium'>
      <button type='roll' name='roll_testpnjcombat1' class="sheet-btRoll20niv" value='@{jetCache} &{template:jet} {{characterName=@{character_name}}} {{arme=@{pnjarm1}}} {{rollResult1=[[1d20[D20]+[[{ {@{pnjNiv}}, {12}}kl1]]]]}} {{rollResult2=[[1d20[D20]+[[{ {@{pnjNiv}}, {12}}kl1]]]]}} {{coup=[[@{pnjdmgarm1}]]}} {{desdegats=@{pnjdmgarm1}}} {{tRollDesc=@{pnjArmDesc1}}}'></button>
      <input type="text" name="attr_pnjArmDesc1" style="width: 50%;" placeholder="Description" />
    </div>
    <div class="sheet-ligne">
      <input type="text" name="attr_pnjarm2" style="width: 30%;" placeholder="Arme/Attaque">
      <input type="text" name="attr_pnjdmgarm2" placeholder="1d8" class='sheet-medium'>
      <button type='roll' name='roll_testpnjcombat2' class="sheet-btRoll20niv" value='@{jetCache} &{template:jet} {{characterName=@{character_name}}} {{arme=@{pnjarm2}}} {{rollResult1=[[1d20[D20]+[[{ {@{pnjNiv}}, {12}}kl1]]]]}} {{rollResult2=[[1d20[D20]+[[{ {@{pnjNiv}}, {12}}kl1]]]]}} {{coup=[[@{pnjdmgarm2}]]}} {{desdegats=@{pnjdmgarm2}}} {{tRollDesc=@{pnjArmDesc2}}}'></button>
      <input type="text" name="attr_pnjArmDesc2" style="width: 50%;" placeholder="Description" />
    </div>
    <div class="sheet-ligne">
      <input type="text" name="attr_pnjarm4" style="width: 30%;" placeholder="Arme/Attaque">
      <input type="text" name="attr_pnjdmgarm4" placeholder="1d8" class='sheet-medium'>
      <button type='roll' name='roll_testpnjcombat4' class="sheet-btRoll20niv" value='@{jetCache} &{template:jet} {{characterName=@{character_name}}} {{arme=@{pnjarm4}}} {{rollResult1=[[1d20[D20]+[[{ {@{pnjNiv}}, {12}}kl1]]]]}} {{rollResult2=[[1d20[D20]+[[{ {@{pnjNiv}}, {12}}kl1]]]]}} {{coup=[[@{pnjdmgarm4}]]}} {{desdegats=@{pnjdmgarm4}}} {{tRollDesc=@{pnjArmDesc4}}}'></button>
      <input type="text" name="attr_pnjArmDesc4" style="width: 50%;" placeholder="Description" />
    </div>
    <div class="sheet-ligne">
      <input type="text" name="attr_pnjarm3" style="width: 30%;" placeholder="Autre action">
      <input type="text" name="attr_pnjdmgarm3" placeholder="macro" class='sheet-medium'>
      <button type='roll' name='roll_testpnjcombat3' class="sheet-btRoll20niv" value='@{jetCache} &{template:jet} {{characterName=@{character_name}}} {{rollname=@{pnjarm3}}} {{rollResult1=[[@{pnjdmgarm3}]]}} {{tRollDesc=@{pnjArmDesc3}}}'></button>
      <input type="text" name="attr_pnjArmDesc3" style="width: 50%;" placeholder="Description" />
    </div>
    <div class="sheet-ligne">
      <div class="sheet-libel2">Capacités</div>
      <textarea name="attr_pnjPermanent" class="sheet-text3col" style="resize: vertical; height: 300px;" placeholder="Capacités"></textarea>
    </div>
</div>

<!-- ----------- -->
<!-- Roll Templates -->
<!-- ----------- -->
<rolltemplate class="sheet-rolltemplate-jet">
  <div class="sheet-template-main">
    <div class="sheet-template-charName">{{characterName}}</div>
    {{#rollname}}
        <div class="sheet-template-title">{{rollname}}</div>
    {{/rollname}}
    {{#tSerie1}}{{#tSerie2}}
      <div class="sheet-noCrit">Série 1 : {{tSerie1}}</div>
      <div class="sheet-noCrit">Série 2 : {{tSerie2}}</div>
    {{/tSerie2}}{{/tSerie1}}
    {{^carac}}{{^arme}}
      {{#rollResult1}}{{^rollResult2}}
        <div class="sheet-noCrit">Résultat : {{rollResult1}}</div>
      {{/rollResult2}}{{/rollResult1}}
      {{#rollResult1}}{{#rollResult2}}
        <div class="sheet-enableCrit">Résultat : {{rollResult1}} | {{rollResult2}}</div>
      {{/rollResult2}}{{/rollResult1}}
      {{#jetChance}}
        {{#rollGreater() jetChance 4}}
          <div class="sheet-noCrit">Résultat : <span class="sheet-template-success">{{jetChance}}, Oui !</span></div>
        {{/rollGreater() jetChance 4}}
        {{#rollLess() jetChance 5}}
          <div class="sheet-noCrit">Résultat : <span class="sheet-template-failure">{{jetChance}}, Non !</span></div>
        {{/rollLess() jetChance 5}}
      {{/jetChance}}
    {{/arme}}{{/carac}}
    {{#carac}}
      <div>Seuil : {{carac}}+</div>
      <div class="sheet-enableCrit">Jet : 
        {{#rollGreater() rollResult1 carac}}
          <span class="sheet-template-success">{{rollResult1}}</span>
        {{/rollGreater() rollResult1 carac}}

        {{#rollLess() rollResult1 carac}}
          <span class="sheet-template-failure">{{rollResult1}}</span>
        {{/rollLess() rollResult1 carac}}

        {{#rollTotal() rollResult1 carac}}
          <span class="sheet-template-success">{{rollResult1}}</span>
        {{/rollTotal() rollResult1 carac}}
        <span> | </span>
        {{#rollGreater() rollResult2 carac}}
          <span class="sheet-template-success">{{rollResult2}}</span>
        {{/rollGreater() rollResult2 carac}}

        {{#rollLess() rollResult2 carac}}
          <span class="sheet-template-failure">{{rollResult2}}</span>
        {{/rollLess() rollResult2 carac}}

        {{#rollTotal() rollResult2 carac}}
          <span class="sheet-template-success">{{rollResult2}}</span>
        {{/rollTotal() rollResult2 carac}}
      </div>	
    {{/carac}}
    {{#arme}}
      <div class="sheet-template-title">Attaque avec {{arme}}</div>
      <div class="sheet-enableCrit">Touche une défense de {{rollResult1}} | {{rollResult2}}</div>
      {{#coup}}{{#desdegats}}
        <div class="sheet-noCrit">Pour {{desdegats}} dégâts : {{coup}}</div>
      {{/desdegats}}{{/coup}}
    {{/arme}}
    {{#tRollDesc}}
      <div class="sheet-template-rollDesc">{{tRollDesc}}</div>
    {{/tRollDesc}}
  </div>
</rolltemplate>




