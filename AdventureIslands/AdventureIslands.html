
<!-- ROLLTEMPLATE – darf unterhalb der .sheet-ai stehen -->
<rolltemplate class="sheet-rolltemplate-ai-probe">
  <div class="sheet-template">
    <div class="sheet-header">{{name}} – {{fertigkeit}}</div>
    <div class="sheet-row"><span>Pool:</span> <span>{{pool}}</span></div>
    <div class="sheet-row"><span>Wurf (2W20+Mod):</span> <span>{{wurf}}</span></div>
    <div class="sheet-row"><span>Erfolgsdifferenz:</span> <span>{{erfolg}}</span></div>
  </div>
</rolltemplate>

<!-- Sheet-Worker können wir später wieder dranhängen -->
<!-- ===== Adventure Islands – V2 mit Tabs (HTML) ===== -->

<div class="sheet-ai2">

  <!-- Tabs (einfache Radios, funktionieren ohne JS) -->
  <input type="radio" name="attr_ai2_tab" class="sheet-ai2-tab sheet-ai2-tab1" checked> Char 1 - Attribute
  <input type="radio" name="attr_ai2_tab" class="sheet-ai2-tab sheet-ai2-tab2"> Char 2 - Kampf
  <input type="radio" name="attr_ai2_tab" class="sheet-ai2-tab sheet-ai2-tab3"> Char 3 - Gaia
  <input type="radio" name="attr_ai2_tab" class="sheet-ai2-tab sheet-ai2-tab4"> Schiff
  <input type="radio" name="attr_ai2_tab" class="sheet-ai2-tab sheet-ai2-tab5"> Tierbegleiter

  <hr>

  <!-- ================== SEITE 1 – Attribute & Fertigkeiten ================== -->
  <div class="sheet-ai2-page sheet-ai2-page1">
    <h1>Adventure Islands – Charakterbogen</h1>

    <!-- Charakterdaten -->
    <div class="sheet-ai2-block">
      <div class="sheet-ai2-block-title">Charakterdaten</div>
      <div class="sheet-ai2-grid2">
        <div>
          <label>Name
            <input type="text" name="attr_character_name">
          </label>
          <label>Spezies
            <input type="text" name="attr_spezies">
          </label>
          <label>Fraktion
            <input type="text" name="attr_fraktion">
          </label>
          <label>Alter
            <input type="number" name="attr_alter">
          </label>
        </div>
        <div>
          <label>Geschlecht
            <input type="text" name="attr_geschlecht">
          </label>
          <label>Größe, Gewicht &amp; Statur
            <input type="text" name="attr_groesse_gewicht_statur">
          </label>
          <label>Geburtsort
            <input type="text" name="attr_geburtsort">
          </label>
        </div>
      </div>

      <label>Haarfarbe, Augenfarbe &amp; Körpermerkmale
        <input type="text" name="attr_hair_eyes_features">
      </label>

      <div class="sheet-ai2-grid3">
        <label>Gesamte Abenteuerpunkte
          <input type="number" name="attr_ap_gesamt">
        </label>
        <label>Freie Abenteuerpunkte
          <input type="number" name="attr_ap_frei">
        </label>
        <label>Schulden
          <input type="text" name="attr_schulden">
        </label>
      </div>
    </div>

    <!-- Attribute -->
    <div class="sheet-ai2-grid3">
      <div class="sheet-ai2-block">
        <div class="sheet-ai2-block-title">Körperliche Attribute</div>
        <label>Belastbarkeit
          <input type="number" name="attr_belastbarkeit">
        </label>
        <label>Kraft
          <input type="number" name="attr_kraft">
        </label>
        <label>Schnelligkeit
          <input type="number" name="attr_schnelligkeit">
        </label>
        <label>Wendigkeit
          <input type="number" name="attr_wendigkeit">
        </label>
      </div>

      <div class="sheet-ai2-block">
        <div class="sheet-ai2-block-title">Spezialattribute</div>
        <label>Reflexe
          <input type="number" name="attr_reflexe">
        </label>
        <label>Verteidigung
          <input type="number" name="attr_verteidigung">
        </label>
        <label>Bewegung
          <input type="number" name="attr_bewegung">
        </label>
        <label>Gaiavorrat
          <input type="number" name="attr_gaiavorrat">
        </label>
        <label>Lebenskraft
          <input type="number" name="attr_lebenskraft">
        </label>
      </div>

      <div class="sheet-ai2-block">
        <div class="sheet-ai2-block-title">Geistige Attribute</div>
        <label>Psyche
          <input type="number" name="attr_psyche">
        </label>
        <label>Bildung
          <input type="number" name="attr_bildung">
        </label>
        <label>Ausstrahlung
          <input type="number" name="attr_ausstrahlung">
        </label>
        <label>Gespür
          <input type="number" name="attr_gespuer">
        </label>
      </div>
    </div>

    <!-- Ansehen / Gaben / Handicaps / Freunde & Feinde -->
    <div class="sheet-ai2-grid4">
      <div class="sheet-ai2-block">
        <div class="sheet-ai2-block-title">Ansehen</div>
        <fieldset class="repeating_ansehen">
          <div class="sheet-ai2-grid2">
            <input type="text" name="attr_an_fraktion" placeholder="Fraktion">
            <input type="number" name="attr_an_stufe" placeholder="Stufe">
          </div>
        </fieldset>
      </div>

      <div class="sheet-ai2-block">
        <div class="sheet-ai2-block-title">Gaben</div>
        <fieldset class="repeating_gaben">
          <div class="sheet-ai2-grid3">
            <input type="text" name="attr_gabe_name" placeholder="Gabe">
            <input type="number" name="attr_gabe_stufe" placeholder="Stufe">
            <input type="text" name="attr_gabe_beschreibung" placeholder="Beschreibung / Effekt der Gabe">
          </div>
        </fieldset>
      </div>


      <div class="sheet-ai2-block">
        <div class="sheet-ai2-block-title">Handicaps</div>
        <fieldset class="repeating_handicaps">
          <div class="sheet-ai2-grid3">
            <input type="text" name="attr_handicap_name" placeholder="Handicap">
            <input type="number" name="attr_handicap_stufe" placeholder="Stufe">
            <input type="text" name="attr_handicap_beschreibung" placeholder="Beschreibung / Effekt des Handicaps">
          </div>
        </fieldset>
      </div>


      <div class="sheet-ai2-block">
        <div class="sheet-ai2-block-title">Freunde &amp; Feinde</div>
        <fieldset class="repeating_freunde">
          <div class="sheet-ai2-grid3">
            <input type="text" name="attr_ff_name_typ" placeholder="Name/Typ">
            <input type="text" name="attr_ff_beziehung" placeholder="Beziehung">
            <input type="text" name="attr_ff_macht" placeholder="Macht">
          </div>
        </fieldset>
      </div>
    </div>

    <!-- Grundfertigkeiten -->
    <div class="sheet-ai2-block">
      <div class="sheet-ai2-block-title">Grundfertigkeiten</div>
      <div class="sheet-ai2-table">
        <div class="sheet-ai2-row sheet-ai2-header">
          <span>Fertigkeit</span>
          <span>Attribut</span>
          <span>Stufe / Pool</span>
          <span>Probe</span>
        </div>

        <!-- Beherrschen -->
        <div class="sheet-ai2-row">
          <span>Beherrschen</span>
          <span>Belastbarkeit</span>
          <span>
            <input type="number" name="attr_fert_beherrschen_stufe" style="width:48%;" title="Stufe">
            <input type="number" name="attr_fert_beherrschen_pool" style="width:48%;" readonly title="Pool">
          </span>
          <span>
            <button type="roll" name="roll_fert_beherrschen"
              value="&{template:default} [[ [[@{fert_beherrschen_pool}]] - [[2d20+?{Modifikator|0}]] ]] {{name=@{character_name}}} {{Fertigkeit=Beherrschen}} {{Pool=$[[0]]}} {{Wurf=$[[1]]}} {{Erfolg=$[[2]]}}">
              Probe
            </button>
          </span>
        </div>

        <!-- Kochen -->
        <div class="sheet-ai2-row">
          <span>Kochen</span>
          <span>Gespür</span>
          <span>
            <input type="number" name="attr_fert_kochen_stufe" style="width:48%;" title="Stufe">
            <input type="number" name="attr_fert_kochen_pool" style="width:48%;" readonly title="Pool">
          </span>
          <span>
            <button type="roll" name="roll_fert_kochen"
              value="&{template:default} [[ [[@{fert_kochen_pool}]] - [[2d20+?{Modifikator|0}]] ]] {{name=@{character_name}}} {{Fertigkeit=Kochen}} {{Pool=$[[0]]}} {{Wurf=$[[1]]}} {{Erfolg=$[[2]]}}">
              Probe
            </button>
          </span>
        </div>

        <!-- Krafthandlung -->
        <div class="sheet-ai2-row">
          <span>Krafthandlung</span>
          <span>Kraft</span>
          <span>
            <input type="number" name="attr_fert_krafthandlung_stufe" style="width:48%;" title="Stufe">
            <input type="number" name="attr_fert_krafthandlung_pool" style="width:48%;" readonly title="Pool">
          </span>
          <span>
            <button type="roll" name="roll_fert_krafthandlung"
              value="&{template:default} [[ [[@{fert_krafthandlung_pool}]] - [[2d20+?{Modifikator|0}]] ]] {{name=@{character_name}}} {{Fertigkeit=Krafthandlung}} {{Pool=$[[0]]}} {{Wurf=$[[1]]}} {{Erfolg=$[[2]]}}">
              Probe
            </button>
          </span>
        </div>

        <!-- Prügeln -->
        <div class="sheet-ai2-row">
          <span>Prügeln</span>
          <span>Kraft</span>
          <span>
            <input type="number" name="attr_fert_pruegeln_stufe" style="width:48%;" title="Stufe">
            <input type="number" name="attr_fert_pruegeln_pool" style="width:48%;" readonly title="Pool">
          </span>
          <span>
            <button type="roll" name="roll_fert_pruegeln"
              value="&{template:default} [[ [[@{fert_pruegeln_pool}]] - [[2d20+?{Modifikator|0}]] ]] {{name=@{character_name}}} {{Fertigkeit=Prügeln}} {{Pool=$[[0]]}} {{Wurf=$[[1]]}} {{Erfolg=$[[2]]}}">
              Probe
            </button>
          </span>
        </div>

        <!-- Sitten & Gebräuche -->
        <div class="sheet-ai2-row">
          <span>Sitten &amp; Gebräuche</span>
          <span>Gespür</span>
          <span>
            <input type="number" name="attr_fert_sitten_stufe" style="width:48%;" title="Stufe">
            <input type="number" name="attr_fert_sitten_pool" style="width:48%;" readonly title="Pool">
          </span>
          <span>
            <button type="roll" name="roll_fert_sitten"
              value="&{template:default} [[ [[@{fert_sitten_pool}]] - [[2d20+?{Modifikator|0}]] ]] {{name=@{character_name}}} {{Fertigkeit=Sitten &amp; Gebräuche}} {{Pool=$[[0]]}} {{Wurf=$[[1]]}} {{Erfolg=$[[2]]}}">
              Probe
            </button>
          </span>
        </div>

        <!-- Überleben -->
        <div class="sheet-ai2-row">
          <span>Überleben</span>
          <span>Belastbarkeit</span>
          <span>
            <input type="number" name="attr_fert_ueberleben_stufe" style="width:48%;" title="Stufe">
            <input type="number" name="attr_fert_ueberleben_pool" style="width:48%;" readonly title="Pool">
          </span>
          <span>
            <button type="roll" name="roll_fert_ueberleben"
              value="&{template:default} [[ [[@{fert_ueberleben_pool}]] - [[2d20+?{Modifikator|0}]] ]] {{name=@{character_name}}} {{Fertigkeit=Überleben}} {{Pool=$[[0]]}} {{Wurf=$[[1]]}} {{Erfolg=$[[2]]}}">
              Probe
            </button>
          </span>
        </div>

        <!-- Verstand -->
        <div class="sheet-ai2-row">
          <span>Verstand</span>
          <span>Bildung</span>
          <span>
            <input type="number" name="attr_fert_verstand_stufe" style="width:48%;" title="Stufe">
            <input type="number" name="attr_fert_verstand_pool" style="width:48%;" readonly title="Pool">
          </span>
          <span>
            <button type="roll" name="roll_fert_verstand"
              value="&{template:default} [[ [[@{fert_verstand_pool}]] - [[2d20+?{Modifikator|0}]] ]] {{name=@{character_name}}} {{Fertigkeit=Verstand}} {{Pool=$[[0]]}} {{Wurf=$[[1]]}} {{Erfolg=$[[2]]}}">
              Probe
            </button>
          </span>
        </div>

        <!-- Wahrnehmung -->
        <div class="sheet-ai2-row">
          <span>Wahrnehmung</span>
          <span>Gespür</span>
          <span>
            <input type="number" name="attr_fert_wahrnehmung_stufe" style="width:48%;" title="Stufe">
            <input type="number" name="attr_fert_wahrnehmung_pool" style="width:48%;" readonly title="Pool">
          </span>
          <span>
            <button type="roll" name="roll_fert_wahrnehmung"
              value="&{template:default} [[ [[@{fert_wahrnehmung_pool}]] - [[2d20+?{Modifikator|0}]] ]] {{name=@{character_name}}} {{Fertigkeit=Wahrnehmung}} {{Pool=$[[0]]}} {{Wurf=$[[1]]}} {{Erfolg=$[[2]]}}">
              Probe
            </button>
          </span>
        </div>

        <!-- Willenskraft -->
        <div class="sheet-ai2-row">
          <span>Willenskraft</span>
          <span>Psyche</span>
          <span>
            <input type="number" name="attr_fert_willenskraft_stufe" style="width:48%;" title="Stufe">
            <input type="number" name="attr_fert_willenskraft_pool" style="width:48%;" readonly title="Pool">
          </span>
          <span>
            <button type="roll" name="roll_fert_willenskraft"
              value="&{template:default} [[ [[@{fert_willenskraft_pool}]] - [[2d20+?{Modifikator|0}]] ]] {{name=@{character_name}}} {{Fertigkeit=Willenskraft}} {{Pool=$[[0]]}} {{Wurf=$[[1]]}} {{Erfolg=$[[2]]}}">
              Probe
            </button>
          </span>
        </div>

      </div>
    </div>


<!-- Weitere Fertigkeiten (repeating – mit Pool & Wurf) -->
<div class="sheet-ai2-block">
  <div class="sheet-ai2-block-title">Weitere Fertigkeiten</div>
  <div class="sheet-ai2-row sheet-ai2-header">
    <span>Name</span><span>Attribut</span><span>Stufe</span><span>Pool</span><span>Wurf</span>
  </div>

  <fieldset class="repeating_fertigkeiten">
    <div class="sheet-ai2-row">
      <!-- Name der Fertigkeit -->
      <span>
        <input type="text" name="attr_fert_name" placeholder="Fertigkeit">
      </span>

      <!-- Welches Basisattribut? (wird zur Berechnung benutzt) -->
      <span>
        <select name="attr_fert_attr">
          <option value="belastbarkeit">Belastbarkeit</option>
          <option value="kraft">Kraft</option>
          <option value="schnelligkeit">Schnelligkeit</option>
          <option value="wendigkeit">Wendigkeit</option>
          <option value="psyche">Psyche</option>
          <option value="bildung">Bildung</option>
          <option value="ausstrahlung">Ausstrahlung</option>
          <option value="gespuer">Gespür</option>
        </select>
      </span>

      <!-- Stufe der Fertigkeit -->
      <span>
        <input type="number" name="attr_fert_stufe" value="0">
      </span>

      <!-- Pool = Attribut + Stufe (wird per Sheet-Worker gesetzt) -->
      <span>
        <input type="number" name="attr_fert_pool" value="0" readonly>
      </span>

      <!-- Wurf: nutzt den berechneten Pool -->
      <span>
        <button type="roll" name="roll_fertigkeit"
  value="&{template:default} [[ [[@{fert_pool}]] - [[2d20+?{Modifikator|0}]] ]] {{name=@{character_name}}} {{Fertigkeit=@{fert_name}}} {{Pool=$[[0]]}} {{Wurf=$[[1]]}} {{Erfolg=$[[2]]}}">
  Probe
</button>
      </span>
    </div>
  </fieldset>
</div>


    <!-- Sprachen, Flagge, Schriften -->
    <div class="sheet-ai2-grid3">
      <div class="sheet-ai2-block">
        <div class="sheet-ai2-block-title">Sprachen</div>
        <fieldset class="repeating_sprachen">
          <input type="text" name="attr_sprache_name">
        </fieldset>
      </div>

<div class="sheet-ai2-block">
  <div class="sheet-ai2-block-title">Deine Flagge</div>

  <label>Bild-URL deiner Flagge
    <input type="text" name="attr_flagge_url" placeholder="https://...">
  </label>

  <div class="sheet-flag-preview">
    <!-- zeigt das Bild, dessen URL oben eingetragen ist -->
    <img src="@{flagge_url}" alt="Flagge" />
  </div>
</div>


      <div class="sheet-ai2-block">
        <div class="sheet-ai2-block-title">Schriften</div>
        <fieldset class="repeating_schriften">
          <input type="text" name="attr_schrift_name">
        </fieldset>
      </div>
    </div>

  </div><!-- Ende Seite 1 -->


  <!-- ================== Platzhalter-Seiten ================== -->

<div class="sheet-ai2-page sheet-ai2-page2">
  <h1>Charakterbogen – Kampf &amp; Ausrüstung</h1>

  <!-- ================== RÜSTUNGEN ================== -->
  <div class="sheet-ai2-block">
    <div class="sheet-ai2-block-title">Rüstungen</div>
    <div class="sheet-ai2-table">
      <div class="sheet-ai2-row sheet-ai2-header">
        <span>Zone</span>
        <span>Rüstungsteil</span>
        <span>Reflexmod.</span>
        <span>RB (W)</span>
        <span>RB (K)</span>
        <span>RB (S)</span>
        <span>Gewicht</span>
        <span>Haltbarkeit</span>
        <span>Qualität</span>
      </div>

      <!-- Kopf -->
      <div class="sheet-ai2-row">
        <span>Kopf</span>
        <span><input type="text" name="attr_ruestung_kopf_name"></span>
        <span><input type="number" name="attr_ruestung_kopf_reflexmod"></span>
        <span><input type="number" name="attr_ruestung_kopf_rb_w"></span>
        <span><input type="number" name="attr_ruestung_kopf_rb_k"></span>
        <span><input type="number" name="attr_ruestung_kopf_rb_s"></span>
        <span><input type="number" name="attr_ruestung_kopf_gewicht" step="0.1"></span>
        <span><input type="number" name="attr_ruestung_kopf_haltbarkeit"></span>
        <span><input type="text" name="attr_ruestung_kopf_qualitaet"></span>
      </div>

      <!-- Torso 1 -->
      <div class="sheet-ai2-row">
        <span>Torso 1</span>
        <span><input type="text" name="attr_ruestung_torso1_name"></span>
        <span><input type="number" name="attr_ruestung_torso1_reflexmod"></span>
        <span><input type="number" name="attr_ruestung_torso1_rb_w"></span>
        <span><input type="number" name="attr_ruestung_torso1_rb_k"></span>
        <span><input type="number" name="attr_ruestung_torso1_rb_s"></span>
        <span><input type="number" name="attr_ruestung_torso1_gewicht" step="0.1"></span>
        <span><input type="number" name="attr_ruestung_torso1_haltbarkeit"></span>
        <span><input type="text" name="attr_ruestung_torso1_qualitaet"></span>
      </div>

      <!-- Torso 2 -->
      <div class="sheet-ai2-row">
        <span>Torso 2</span>
        <span><input type="text" name="attr_ruestung_torso2_name"></span>
        <span><input type="number" name="attr_ruestung_torso2_reflexmod"></span>
        <span><input type="number" name="attr_ruestung_torso2_rb_w"></span>
        <span><input type="number" name="attr_ruestung_torso2_rb_k"></span>
        <span><input type="number" name="attr_ruestung_torso2_rb_s"></span>
        <span><input type="number" name="attr_ruestung_torso2_gewicht" step="0.1"></span>
        <span><input type="number" name="attr_ruestung_torso2_haltbarkeit"></span>
        <span><input type="text" name="attr_ruestung_torso2_qualitaet"></span>
      </div>

           <!-- Gesamt Torso (automatisch aus Torso 1 + Torso 2) -->
      <div class="sheet-ai2-row">
        <span>Gesamt Torso</span>
        <span>Summe</span>
        <span></span>
        <span><input type="number" name="attr_ruestung_torso_gesamt_rb_w" readonly></span>
        <span><input type="number" name="attr_ruestung_torso_gesamt_rb_k" readonly></span>
        <span><input type="number" name="attr_ruestung_torso_gesamt_rb_s" readonly></span>
        <span></span>
        <span></span>
        <span></span>
      </div>

      <!-- Arme -->
      <div class="sheet-ai2-row">
        <span>Arme</span>
        <span><input type="text" name="attr_ruestung_arme_name"></span>
        <span><input type="number" name="attr_ruestung_arme_reflexmod"></span>
        <span><input type="number" name="attr_ruestung_arme_rb_w"></span>
        <span><input type="number" name="attr_ruestung_arme_rb_k"></span>
        <span><input type="number" name="attr_ruestung_arme_rb_s"></span>
        <span><input type="number" name="attr_ruestung_arme_gewicht" step="0.1"></span>
        <span><input type="number" name="attr_ruestung_arme_haltbarkeit"></span>
        <span><input type="text" name="attr_ruestung_arme_qualitaet"></span>
      </div>

      <!-- Beine -->
      <div class="sheet-ai2-row">
        <span>Beine</span>
        <span><input type="text" name="attr_ruestung_beine_name"></span>
        <span><input type="number" name="attr_ruestung_beine_reflexmod"></span>
        <span><input type="number" name="attr_ruestung_beine_rb_w"></span>
        <span><input type="number" name="attr_ruestung_beine_rb_k"></span>
        <span><input type="number" name="attr_ruestung_beine_rb_s"></span>
        <span><input type="number" name="attr_ruestung_beine_gewicht" step="0.1"></span>
        <span><input type="number" name="attr_ruestung_beine_haltbarkeit"></span>
        <span><input type="text" name="attr_ruestung_beine_qualitaet"></span>
      </div>

      <!-- Füße -->
      <div class="sheet-ai2-row">
        <span>Füße</span>
        <span><input type="text" name="attr_ruestung_fuesse_name"></span>
        <span><input type="number" name="attr_ruestung_fuesse_reflexmod"></span>
        <span><input type="number" name="attr_ruestung_fuesse_rb_w"></span>
        <span><input type="number" name="attr_ruestung_fuesse_rb_k"></span>
        <span><input type="number" name="attr_ruestung_fuesse_rb_s"></span>
        <span><input type="number" name="attr_ruestung_fuesse_gewicht" step="0.1"></span>
        <span><input type="number" name="attr_ruestung_fuesse_haltbarkeit"></span>
        <span><input type="text" name="attr_ruestung_fuesse_qualitaet"></span>
      </div>
    </div>
  </div>

  <!-- ================== WAFFEN ================== -->
  <div class="sheet-ai2-grid2">

    <!-- Nahkampfwaffen -->
    <div class="sheet-ai2-block">
      <div class="sheet-ai2-block-title">Nahkampfwaffen</div>
      <div class="sheet-ai2-row sheet-ai2-header">
        <span>Name</span><span>Art</span><span>Schaden</span><span>Pool</span><span>Wurf</span>
      </div>
      <fieldset class="repeating_nahkampf">
        <div class="sheet-ai2-row">
          <span><input type="text" name="attr_melee_name"></span>
          <span><input type="text" name="attr_melee_art" placeholder="z.B. Hieb, Stich"></span>
          <span><input type="text" name="attr_melee_schaden" placeholder="z.B. +2, 1W6+2"></span>
          <span><input type="number" name="attr_melee_pool" value="0"></span>
          <span>
            <button type="roll" name="roll_melee_attack"
  value="&{template:default} [[ [[@{melee_pool}]] - [[2d20+?{Modifikator|0}]] ]] {{name=@{character_name}}} {{Aktion=Nahkampfangriff}} {{Waffe=@{melee_name}}} {{Pool=$[[0]]}} {{Wurf=$[[1]]}} {{Erfolg=$[[2]]}}">
  Angriff
</button>

          </span>
        </div>
      </fieldset>
    </div>

    <!-- Fernkampfwaffen -->
    <div class="sheet-ai2-block">
      <div class="sheet-ai2-block-title">Fernkampfwaffen</div>
      <div class="sheet-ai2-row sheet-ai2-header">
        <span>Name</span><span>Art / Reichweite</span><span>Schaden</span><span>Pool</span><span>Wurf</span>
      </div>
      <fieldset class="repeating_fernkampf">
        <div class="sheet-ai2-row">
          <span><input type="text" name="attr_ranged_name"></span>
          <span><input type="text" name="attr_ranged_art" placeholder="z.B. Bogen, 30 m"></span>
          <span><input type="text" name="attr_ranged_schaden" placeholder="z.B. +2, 1W8+1"></span>
          <span><input type="number" name="attr_ranged_pool" value="0"></span>
          <span>
            <button type="roll" name="roll_ranged_attack"
  value="&{template:default} [[ [[@{ranged_pool}]] - [[2d20+?{Modifikator|0}]] ]] {{name=@{character_name}}} {{Aktion=Fernkampfangriff}} {{Waffe=@{ranged_name}}} {{Pool=$[[0]]}} {{Wurf=$[[1]]}} {{Erfolg=$[[2]]}}">
  Angriff
</button>

          </span>
        </div>
      </fieldset>
    </div>

  </div><!-- Ende Waffen -->

  <!-- ================== KAMPFMANÖVER & AUSRÜSTUNG ================== -->
  <div class="sheet-ai2-grid2">

    <!-- Kampfmanöver -->
    <div class="sheet-ai2-block">
      <div class="sheet-ai2-block-title">Kampfmanöver</div>
      <div class="sheet-ai2-row sheet-ai2-header">
        <span>Name</span><span>Art / Kategorie</span><span>Stufe</span><span>Beschreibung</span>
      </div>
      <fieldset class="repeating_kampfmanoever">
        <div class="sheet-ai2-row">
          <span><input type="text" name="attr_km_name"></span>
          <span><input type="text" name="attr_km_art" placeholder="z.B. Nahkampf, Fernkampf"></span>
          <span><input type="number" name="attr_km_stufe" value="0"></span>
          <span><input type="text" name="attr_km_beschreibung"></span>
        </div>
      </fieldset>
    </div>

    <!-- Ausrüstung -->
    <div class="sheet-ai2-block">
      <div class="sheet-ai2-block-title">Ausrüstung</div>
      <div class="sheet-ai2-row sheet-ai2-header">
        <span>Gegenstand</span>
        <span>Menge</span>
        <span>Stufe</span>
        <span>Gewicht</span>
        <span>Ort</span>
        <span>Notizen</span>
      </div>
      <fieldset class="repeating_ausruestung">
        <div class="sheet-ai2-row">
          <span><input type="text"   name="attr_item_name"></span>
          <span><input type="number" name="attr_item_menge" value="1"></span>
          <span><input type="number" name="attr_item_stufe" value="0"></span>
          <span><input type="number" name="attr_item_gewicht" step="0.1"></span>
          <span><input type="text"   name="attr_item_ort" placeholder="am Körper / Gepäck"></span>
          <span><input type="text"   name="attr_item_notizen"></span>
        </div>
      </fieldset>
    </div>


  </div><!-- Ende Kampfmanöver & Ausrüstung -->

  <!-- ================== VERMÖGEN & BELASTUNG ================== -->
  <div class="sheet-ai2-block">
    <div class="sheet-ai2-block-title">Vermögen &amp; Belastung</div>
    <div class="sheet-ai2-grid2">

           <!-- Geld -->
      <div>
        <div class="sheet-ai2-table">
          <div class="sheet-ai2-row sheet-ai2-header">
            <span>Währung</span><span>Menge</span>
          </div>

          <div class="sheet-ai2-row">
            <span>Reales</span>
            <span><input type="number" name="attr_money_reales" value="0" step="0.1"></span>
          </div>
          <div class="sheet-ai2-row">
            <span>Ezreal</span>
            <span><input type="number" name="attr_money_ezreal" value="0" step="0.1"></span>
          </div>

          <div class="sheet-ai2-row">
            <span>Dinari</span>
            <span><input type="number" name="attr_money_dinari" value="0" step="0.1"></span>
          </div>
          <div class="sheet-ai2-row">
            <span>Deliat</span>
            <span><input type="number" name="attr_money_deliat" value="0" step="0.1"></span>
          </div>
          <div class="sheet-ai2-row">
            <span>Dollar</span>
            <span><input type="number" name="attr_money_dollar" value="0" step="0.1"></span>
          </div>
          <div class="sheet-ai2-row">
            <span>Edge</span>
            <span><input type="number" name="attr_money_edge" value="0" step="0.1"></span>
          </div>
          <div class="sheet-ai2-row">
            <span>Goldtaler</span>
            <span><input type="number" name="attr_money_goldtaler" value="0" step="0.1"></span>
          </div>
          <div class="sheet-ai2-row">
            <span>Silbertaler</span>
            <span><input type="number" name="attr_money_silbertaler" value="0" step="0.1"></span>
          </div>
        </div>
      </div>

      <!-- Belastung / Tauchen / Regeneration -->
      <div>
        <div class="sheet-ai2-table">
          <div class="sheet-ai2-row sheet-ai2-header">
            <span>Wert</span><span>Ergebnis</span>
          </div>
          <div class="sheet-ai2-row">
            <span>Kampfbelastung (2 × Belastbarkeit RP)</span>
            <span><input type="number" name="attr_kampfbelastung" readonly></span>
          </div>
          <div class="sheet-ai2-row">
            <span>Tragen / Heben (2,5 × Kraft kg)</span>
            <span><input type="text" name="attr_tragen_heben" readonly></span>
          </div>
          <div class="sheet-ai2-row">
            <span>Tauchdauer (Belastbarkeit RP)</span>
            <span><input type="number" name="attr_tauchdauer" readonly></span>
          </div>
          <div class="sheet-ai2-row">
            <span>Regeneration LP / RP</span>
            <span><input type="text" name="attr_regen_lp" readonly></span>
          </div>
          <div class="sheet-ai2-row">
            <span>Regeneration Gaiavorrat / RP</span>
            <span><input type="text" name="attr_regen_gv" readonly></span>
          </div>
        </div>
      </div>

    </div>
  </div>

</div><!-- Ende Seite 2 -->

<!-- ========================= -->
<!--   CHAR 3 – GAIABOGEN     -->
<!-- ========================= -->

<div class="sheet-ai2-page sheet-ai2-page3">
  <h1>Gaiabogen</h1>

  <!-- ZAUBER, RITUALE & BESCHWÖRUNGEN -->
  <div class="sheet-ai2-block">
    <div class="sheet-ai2-block-title">Zauber, Rituale &amp; Beschwörungen</div>

    <div class="sheet-ai2-table">
      <div class="sheet-ai2-row sheet-ai2-header">
        <span>Name</span>
        <span>Art</span>
        <span>Attribut</span>
        <span>Stufe</span>
        <span>Pool</span>
        <span>Spruchdauer</span>
        <span>Reichweite</span>
        <span>Wirkdauer</span>
        <span>Kosten</span>
        <span>Wurf</span>
      </div>

      <fieldset class="repeating_spells">
        <div class="sheet-ai2-row">
          <!-- Name -->
          <span>
            <input type="text" name="attr_spell_name" placeholder="Zauber / Ritual / Beschwörung">
          </span>

          <!-- Art -->
          <span>
            <select name="attr_spell_type">
              <option value="Zauber">Zauber</option>
              <option value="Ritual">Ritual</option>
              <option value="Beschwoerung">Beschwörung</option>
            </select>
          </span>

          <!-- Attribut für Pool -->
          <span>
            <select name="attr_spell_attr">
              <option value="belastbarkeit">Belastbarkeit</option>
              <option value="kraft">Kraft</option>
              <option value="schnelligkeit">Schnelligkeit</option>
              <option value="wendigkeit">Wendigkeit</option>
              <option value="psyche">Psyche</option>
              <option value="bildung">Bildung</option>
              <option value="ausstrahlung">Ausstrahlung</option>
              <option value="gespuer">Gespür</option>
            </select>
          </span>

          <!-- Stufe -->
          <span>
            <input type="number" name="attr_spell_stufe" value="0">
          </span>

          <!-- Pool (Attribut + Stufe, automatisch) -->
          <span>
            <input type="number" name="attr_spell_pool" value="0" readonly>
          </span>

          <!-- Dauer / Reichweite / Wirkdauer / Kosten -->
          <span>
            <input type="text" name="attr_spell_dauer" placeholder="Dauer">
          </span>
          <span>
            <input type="text" name="attr_spell_reichweite" placeholder="RW">
          </span>
          <span>
            <input type="text" name="attr_spell_wirkdauer" placeholder="Wirkdauer">
          </span>
          <span>
            <input type="text" name="attr_spell_kosten" placeholder="Kosten">
          </span>

          <!-- Wurf -->
          <span>
           <button type="roll" name="roll_spell"
  value="&{template:default} [[ [[@{spell_pool}]] - [[2d20+?{Modifikator|0}]] ]] {{name=@{character_name}}} {{Fertigkeit=@{spell_name}}} {{Art=@{spell_type}}} {{Pool=$[[0]]}} {{Wurf=$[[1]]}} {{Erfolg=$[[2]]}}">
  Probe
</button>

          </span>
        </div>
      </fieldset>
    </div>
  </div>

  <!-- UNTERER BEREICH: PERMANENTER GOLEM & BESCHWORENER GEIST -->
  <div class="sheet-ai2-grid2">

    <!-- Permanenter Golem -->
    <div class="sheet-ai2-block">
      <div class="sheet-ai2-block-title">Permanenter Golem</div>

      <label>Name
        <input type="text" name="attr_golem_name">
      </label>
      <label>Art
        <input type="text" name="attr_golem_art">
      </label>
      <label>Größe / Gewicht
        <input type="text" name="attr_golem_groesse_gewicht">
      </label>

      <div class="sheet-ai2-grid2">
        <div>
          <strong>Körperliche Attribute</strong>
          <label>Belastbarkeit
            <input type="number" name="attr_golem_belastbarkeit">
          </label>
          <label>Kraft
            <input type="number" name="attr_golem_kraft">
          </label>
          <label>Schnelligkeit
            <input type="number" name="attr_golem_schnelligkeit">
          </label>
          <label>Wendigkeit
            <input type="number" name="attr_golem_wendigkeit">
          </label>
        </div>
        <div>
          <strong>Geistige Attribute</strong>
          <label>Psyche
            <input type="number" name="attr_golem_psyche">
          </label>
          <label>Bildung
            <input type="number" name="attr_golem_bildung">
          </label>
          <label>Ausstrahlung
            <input type="number" name="attr_golem_ausstrahlung">
          </label>
          <label>Gespür
            <input type="number" name="attr_golem_gespuer">
          </label>
        </div>
      </div>

      <div class="sheet-ai2-grid2">
        <div>
          <label>Reflexe
            <input type="number" name="attr_golem_reflexe">
          </label>
          <label>Lebenskraft
            <input type="number" name="attr_golem_lebenskraft">
          </label>
          <label>Gaiavorrat
            <input type="number" name="attr_golem_gaiavorrat">
          </label>
        </div>
        <div>
          <label>Schaden
            <input type="text" name="attr_golem_schaden">
          </label>
          <label>Bewegung
            <input type="number" name="attr_golem_bewegung">
          </label>
          <label>Verteidigung
            <input type="number" name="attr_golem_verteidigung">
          </label>
          <label>Tagesdienstpunkte
            <input type="number" name="attr_golem_dienstpunkte">
          </label>
        </div>
      </div>

      <strong>Golem-Fertigkeiten</strong>
      <div class="sheet-ai2-table">
        <div class="sheet-ai2-row sheet-ai2-header">
          <span>Fertigkeit</span><span>Stufe</span><span>Pool</span>
        </div>
        <fieldset class="repeating_golem_fertigkeiten">
          <div class="sheet-ai2-row">
            <span><input type="text" name="attr_golem_fert_name"></span>
            <span><input type="number" name="attr_golem_fert_stufe"></span>
            <span><input type="number" name="attr_golem_fert_pool"></span>
          </div>
        </fieldset>
      </div>
    </div>

    <!-- Beschworener Geist -->
    <div class="sheet-ai2-block">
      <div class="sheet-ai2-block-title">Beschworener Geist</div>

      <label>Name
        <input type="text" name="attr_geist_name">
      </label>
      <label>Art
        <input type="text" name="attr_geist_art">
      </label>
      <label>Größe / Gewicht
        <input type="text" name="attr_geist_groesse_gewicht">
      </label>

      <div class="sheet-ai2-grid2">
        <div>
          <label>Totenkraft
            <input type="number" name="attr_geist_totenkraft">
          </label>
          <label>Dienstpunkte
            <input type="number" name="attr_geist_dienstpunkte">
          </label>
        </div>
        <div>
          <label>Reflexe
            <input type="number" name="attr_geist_reflexe">
          </label>
          <label>Rüstbonus
            <input type="number" name="attr_geist_ruestbonus">
          </label>
          <label>Bewegung
            <input type="number" name="attr_geist_bewegung">
          </label>
          <label>Verteidigung
            <input type="number" name="attr_geist_verteidigung">
          </label>
        </div>
      </div>

      <strong>Zauber des Geistes</strong>
      <div class="sheet-ai2-table">
        <div class="sheet-ai2-row sheet-ai2-header">
          <span>Zauber</span><span>Stufe</span><span>Pool</span>
        </div>
        <fieldset class="repeating_geist_zauber">
          <div class="sheet-ai2-row">
            <span><input type="text" name="attr_geist_zauber_name"></span>
            <span><input type="number" name="attr_geist_zauber_stufe"></span>
            <span><input type="number" name="attr_geist_zauber_pool"></span>
          </div>
        </fieldset>
      </div>

      <strong>Gaiakräfte</strong>
      <div class="sheet-ai2-table">
        <div class="sheet-ai2-row sheet-ai2-header">
          <span>Gaiakraft</span><span>Stufe</span><span>Pool</span>
        </div>
        <fieldset class="repeating_geist_gaiakraefte">
          <div class="sheet-ai2-row">
            <span><input type="text" name="attr_geist_gk_name"></span>
            <span><input type="number" name="attr_geist_gk_stufe"></span>
            <span><input type="number" name="attr_geist_gk_pool"></span>
          </div>
        </fieldset>
      </div>
    </div>

  </div><!-- /sheet-ai2-grid2 -->

</div><!-- Ende Gaiabogen -->

<div class="sheet-ai2-page sheet-ai2-page4">
  <h1>Schiffsbogen</h1>

  <!-- ================== SCHIFFSDATEN ================== -->
  <div class="sheet-ai2-block">
    <div class="sheet-ai2-block-title">Schiffsdaten</div>

    <div class="sheet-ai2-grid3">
      <!-- Basisinformationen -->
      <div>
        <label>Schiffstyp
          <input type="text" name="attr_ship_type">
        </label>
        <label>Mastaufbau
          <input type="text" name="attr_ship_mastaufbau">
        </label>
        <label>Schiffsname
          <input type="text" name="attr_ship_name">
        </label>
      </div>

      <!-- Kernwerte -->
      <div>
        <div class="sheet-ai2-table">
          <div class="sheet-ai2-row sheet-ai2-header">
            <span>Strukturpunkte</span>
            <span>Härte</span>
            <span>Wendigkeit</span>
          </div>
          <div class="sheet-ai2-row">
            <span><input type="number" name="attr_ship_strukturpunkte"></span>
            <span><input type="number" name="attr_ship_haerte"></span>
            <span><input type="number" name="attr_ship_wendigkeit"></span>
          </div>
        </div>

        <div class="sheet-ai2-table">
          <div class="sheet-ai2-row sheet-ai2-header">
            <span>Geschwindigkeit</span>
            <span>Tiefgang</span>
            <span>Laderaum</span>
          </div>
          <div class="sheet-ai2-row">
            <span><input type="text" name="attr_ship_geschwindigkeit" placeholder="z. B. 14 m/R"></span>
            <span><input type="text" name="attr_ship_tiefgang" placeholder="z. B. 3,5 m"></span>
            <span><input type="text" name="attr_ship_laderaum" placeholder="z. B. 35 Last"></span>
          </div>
        </div>
      </div>

      <!-- Schaden & Bewaffnung kurz -->
      <div>
        <div class="sheet-ai2-table">
             <div class="sheet-ai2-block-title">Waffenschaden</div>
          <div class="sheet-ai2-row sheet-ai2-header">
            <span>Breitseite</span>
            <span>Drehbasse</span>
            <span>Bug</span>
            <span>Achtern</span>
            <span>Harpune</span>
          </div>
          <div class="sheet-ai2-row">
            <span><input type="text" name="attr_ship_schaden_breitseite" placeholder="…"></span>
            <span><input type="text" name="attr_ship_schaden_drehbasse" placeholder="…"></span>
            <span><input type="text" name="attr_ship_schaden_bug" placeholder="…"></span>
            <span><input type="text" name="attr_ship_schaden_achtern" placeholder="…"></span>
            <span><input type="text" name="attr_ship_schaden_harpune" placeholder="…"></span>
          </div>
        </div>
      </div>
    </div>

    <div class="sheet-ai2-grid2" style="margin-top:4px;">
      <div>
        <div class="sheet-ai2-block-title">Besonderheiten (Schiff)</div>
        <textarea name="attr_ship_besonderheiten" rows="4"></textarea>
      </div>
      <div>
        <div class="sheet-ai2-block-title">Bewaffnung (Details)</div>
        <textarea name="attr_ship_bewaffnung" rows="4"></textarea>
      </div>
    </div>
  </div>

  <!-- ================== MANNSCHAFT ================== -->
  <div class="sheet-ai2-grid2">

    <!-- Mannschaftsgrößen -->
    <div class="sheet-ai2-block">
      <div class="sheet-ai2-block-title">Mannschaftsübersicht</div>
      <div class="sheet-ai2-table">
        <div class="sheet-ai2-row sheet-ai2-header">
          <span>Kategorie</span><span>Anzahl</span>
        </div>
        <div class="sheet-ai2-row">
          <span>Gesamt (Mannschaftsgröße)</span>
          <span><input type="number" name="attr_ship_crew_total"></span>
        </div>
        <div class="sheet-ai2-row">
          <span>Leichtmatrosen</span>
          <span><input type="number" name="attr_ship_crew_leichtmatrosen"></span>
        </div>
        <div class="sheet-ai2-row">
          <span>Vollmatrosen</span>
          <span><input type="number" name="attr_ship_crew_vollmatrosen"></span>
        </div>
        <div class="sheet-ai2-row">
          <span>Maate</span>
          <span><input type="number" name="attr_ship_crew_maate"></span>
        </div>
        <div class="sheet-ai2-row">
          <span>Seekadetten</span>
          <span><input type="number" name="attr_ship_crew_seekadetten"></span>
        </div>
        <div class="sheet-ai2-row">
          <span>Kapitän(e)</span>
          <span><input type="number" name="attr_ship_crew_kapitaene" value="1"></span>
        </div>
      </div>
    </div>

    <!-- Durchschnittswerte -->
    <div class="sheet-ai2-block">
      <div class="sheet-ai2-block-title">Durchschnittswerte der Mannschaft</div>

      <div class="sheet-ai2-table">
        <div class="sheet-ai2-row sheet-ai2-header">
          <span>Ø-LK</span>
          <span>Ø-GV</span>
          <span>Ø-Reflexe</span>
          <span>Ø-Nahkampfpool</span>
        </div>
        <div class="sheet-ai2-row">
          <span><input type="number" name="attr_ship_avg_lk"></span>
          <span><input type="number" name="attr_ship_avg_gv"></span>
          <span><input type="number" name="attr_ship_avg_reflexe"></span>
          <span><input type="number" name="attr_ship_avg_meleepool"></span>
        </div>
      </div>

      <div class="sheet-ai2-table">
        <div class="sheet-ai2-row sheet-ai2-header">
          <span>Ø-Verteidigung</span>
          <span>Ø-Rüstbonus</span>
          <span>Ø-Schaden</span>
          <span>Ø-Fertigkeitspool</span>
        </div>
        <div class="sheet-ai2-row">
          <span><input type="number" name="attr_ship_avg_vw"></span>
          <span><input type="number" name="attr_ship_avg_rb"></span>
          <span><input type="number" name="attr_ship_avg_schaden"></span>
          <span><input type="number" name="attr_ship_avg_skillpool"></span>
        </div>
      </div>

      <!-- Globale Erleichterung für Schiffsproben -->
      <div class="sheet-ai2-table">
        <div class="sheet-ai2-row sheet-ai2-header">
          <span>Erleichterung (gesamt)</span>
          <span></span>
          <span></span>
          <span></span>
        </div>
        <div class="sheet-ai2-row">
          <span><input type="number" name="attr_ship_erl_gesamt" value="0"></span>
          <span></span>
          <span></span>
          <span></span>
        </div>
      </div>
    </div>


  </div>

  <!-- ================== SCHIFFSPROBEN & NSC-POOLS ================== -->
  <div class="sheet-ai2-block">
    <div class="sheet-ai2-block-title">Schiffsproben &amp; NSC-Pools</div>
    <div class="sheet-ai2-table">
      <div class="sheet-ai2-row sheet-ai2-header">
        <span>Bereich</span>
        <span>NSC-Pool</span>
        <span>Wurf</span>
        <span></span>
      </div>

      <div class="sheet-ai2-row">
        <span>Schiff steuern</span>
        <span><input type="number" name="attr_ship_steuern_pool"></span>
        <span>
          <button type="roll" name="roll_ship_steuern"
            value="&{template:default} [[ [[@{ship_steuern_pool}+@{ship_erl_gesamt}]] - [[2d20+?{Modifikator|0}]] ]] {{name=@{character_name}}} {{Bereich=Schiff steuern}} {{NSC-Pool=$[[0]]}} {{Wurf=$[[1]]}} {{Erfolg=$[[2]]}}">
            Probe
          </button>
        </span>
        <span></span>
      </div>

      <div class="sheet-ai2-row">
        <span>Kanonen</span>
        <span><input type="number" name="attr_ship_kanonen_pool"></span>
        <span>
          <button type="roll" name="roll_ship_kanonen"
            value="&{template:default} [[ [[@{ship_kanonen_pool}+@{ship_erl_gesamt}]] - [[2d20+?{Modifikator|0}]] ]] {{name=@{character_name}}} {{Bereich=Kanonen}} {{NSC-Pool=$[[0]]}} {{Wurf=$[[1]]}} {{Erfolg=$[[2]]}}">
            Probe
          </button>
        </span>
        <span></span>
      </div>

      <div class="sheet-ai2-row">
        <span>Holzbau</span>
        <span><input type="number" name="attr_ship_holzbau_pool"></span>
        <span>
          <button type="roll" name="roll_ship_holzbau"
            value="&{template:default} [[ [[@{ship_holzbau_pool}+@{ship_erl_gesamt}]] - [[2d20+?{Modifikator|0}]] ]] {{name=@{character_name}}} {{Bereich=Holzbau}} {{NSC-Pool=$[[0]]}} {{Wurf=$[[1]]}} {{Erfolg=$[[2]]}}">
            Probe
          </button>
        </span>
        <span></span>
      </div>

      <div class="sheet-ai2-row">
        <span>Handeln</span>
        <span><input type="number" name="attr_ship_handeln_pool"></span>
        <span>
          <button type="roll" name="roll_ship_handeln"
            value="&{template:default} [[ [[@{ship_handeln_pool}+@{ship_erl_gesamt}]] - [[2d20+?{Modifikator|0}]] ]] {{name=@{character_name}}} {{Bereich=Handeln}} {{NSC-Pool=$[[0]]}} {{Wurf=$[[1]]}} {{Erfolg=$[[2]]}}">
            Probe
          </button>
        </span>
        <span></span>
      </div>

      <div class="sheet-ai2-row">
        <span>Führen</span>
        <span><input type="number" name="attr_ship_fuehren_pool"></span>
        <span>
          <button type="roll" name="roll_ship_fuehren"
            value="&{template:default} [[ [[@{ship_fuehren_pool}+@{ship_erl_gesamt}]] - [[2d20+?{Modifikator|0}]] ]] {{name=@{character_name}}} {{Bereich=Führen}} {{NSC-Pool=$[[0]]}} {{Wurf=$[[1]]}} {{Erfolg=$[[2]]}}">
            Probe
          </button>
        </span>
        <span></span>
      </div>
    </div>
  </div>


  <!-- ================== PRISE / HEUER ================== -->
  <div class="sheet-ai2-block">
    <div class="sheet-ai2-block-title">Prise / Heuer</div>

    <div class="sheet-ai2-table">
      <div class="sheet-ai2-row sheet-ai2-header">
        <span>Kategorie</span>
        <span>Gesamtanteile</span>
        <span>Feste Heuer / Notizen</span>
      </div>
      <div class="sheet-ai2-row">
        <span>Leichtmatrosen</span>
        <span><input type="text" name="attr_ship_prise_leichtmatrosen_anteile"></span>
        <span><input type="text" name="attr_ship_prise_leichtmatrosen_heuer"></span>
      </div>
      <div class="sheet-ai2-row">
        <span>Vollmatrosen</span>
        <span><input type="text" name="attr_ship_prise_vollmatrosen_anteile"></span>
        <span><input type="text" name="attr_ship_prise_vollmatrosen_heuer"></span>
      </div>
      <div class="sheet-ai2-row">
        <span>Maate</span>
        <span><input type="text" name="attr_ship_prise_maate_anteile"></span>
        <span><input type="text" name="attr_ship_prise_maate_heuer"></span>
      </div>
      <div class="sheet-ai2-row">
        <span>Seekadetten</span>
        <span><input type="text" name="attr_ship_prise_seekadetten_anteile"></span>
        <span><input type="text" name="attr_ship_prise_seekadetten_heuer"></span>
      </div>
      <div class="sheet-ai2-row">
        <span>Kapitän</span>
        <span><input type="text" name="attr_ship_prise_kapitaen_anteile"></span>
        <span><input type="text" name="attr_ship_prise_kapitaen_heuer"></span>
      </div>
      <div class="sheet-ai2-row">
        <span>Schiff (Rücklagen)</span>
        <span><input type="text" name="attr_ship_prise_schiff_anteile"></span>
        <span><input type="text" name="attr_ship_prise_schiff_heuer"></span>
      </div>
    </div>
  </div>

  <!-- ================== KAJÜTEN, SCHÄTZE, INSELN ================== -->
  <div class="sheet-ai2-grid2">
    <div class="sheet-ai2-block">
      <div class="sheet-ai2-block-title">Kajütenaufteilung</div>
      <textarea name="attr_ship_kajueten" rows="4"></textarea>
    </div>

    <div class="sheet-ai2-block">
      <div class="sheet-ai2-block-title">Besonderheiten (Mannschaft / Disziplin)</div>
      <textarea name="attr_ship_besonderheiten_mannschaft" rows="4"></textarea>
    </div>
  </div>

  <div class="sheet-ai2-grid2">
    <div class="sheet-ai2-block">
      <div class="sheet-ai2-block-title">Gelagerte Schätze</div>
      <textarea name="attr_ship_schaetze" rows="4"></textarea>
    </div>

    <div class="sheet-ai2-block">
      <div class="sheet-ai2-block-title">Besuchte Inseln</div>
      <textarea name="attr_ship_inseln" rows="4"></textarea>
    </div>
  </div>

  <!-- ================== MANNSCHAFTSMORAL ================== -->
  <div class="sheet-ai2-block">
    <div class="sheet-ai2-block-title">Mannschaftsmoral</div>
    <div class="sheet-ai2-table">
      <div class="sheet-ai2-row">
        <span>-10 = Meuterei &nbsp;&nbsp; … &nbsp;&nbsp; +10 = Beste Laune</span>
        <span><input type="number" name="attr_ship_moral" min="-10" max="10" value="0"></span>
      </div>
    </div>
  </div>

</div><!-- Ende Schiffsbogen -->


<div class="sheet-ai2-page sheet-ai2-page5">
  <h1>Tierbegleiter</h1>

  <!-- ================== BASISDATEN ================== -->
  <div class="sheet-ai2-block">
    <div class="sheet-ai2-block-title">Basisdaten des Tierbegleiters</div>

    <div class="sheet-ai2-grid2">
      <div>
        <label>Name
          <input type="text" name="attr_comp_name">
        </label>
        <label>Tierart / Rasse
          <input type="text" name="attr_comp_tierart" placeholder="z. B. Reisepferd, Greif, Riesenkrabbe">
        </label>
        <label>Unterart
          <input type="text" name="attr_comp_spezies" placeholder="z. B. bestimmte Züchtung">
        </label>
        <label>Größe / Gewicht / Statur
          <input type="text" name="attr_comp_groesse_gewicht">
        </label>
        <label>Aussehen
          <input type="text" name="attr_comp_aussehen" placeholder="Fellfarbe, Muster, Augenfarbe">
        </label>
      </div>

      <div>
        <label>Besitzer / Gefährte
          <input type="text" name="attr_comp_besitzer" placeholder="Name des SC">
        </label>
        <label>Rolle in der Gruppe
          <input type="text" name="attr_comp_rolle" placeholder="z. B. Reittier, Spürhund, Wachtier">
        </label>
        <label>Alter
          <input type="number" name="attr_comp_alter">
        </label>
        <label>Geschlecht
          <input type="text" name="attr_comp_geschlecht">
        </label>
      </div>
    </div>

    <div class="sheet-ai2-grid2">
      <div>
        <label>Folgsamkeit
          <input type="number" name="attr_comp_folgsamkeit" min="-10" max="10" value="0">
        </label>
        <label>Folgsamkeit-Pool
          <input type="number" name="attr_comp_folgsamkeit_pool" readonly>
        </label>
        <button type="roll" name="roll_comp_folgsamkeit"
          value="&{template:default} [[ [[@{comp_folgsamkeit_pool}]] - [[2d20+?{Modifikator|0}]] ]] {{name=@{character_name}}} {{Fertigkeit=Folgsamkeit (Tier)}} {{Pool=$[[0]]}} {{Wurf=$[[1]]}} {{Erfolg=$[[2]]}}">
          Probe
        </button>
      </div>
      <div>
        <label>Aktuelle Stimmung / Verhalten
          <input type="text" name="attr_comp_stimmung" placeholder="z. B. nervös, verspielt, aggressiv">
        </label>
      </div>
    </div>

  <!-- ================== ATTRIBUTE ================== -->
  <div class="sheet-ai2-grid3">

    <!-- Körperliche Attribute -->
    <div class="sheet-ai2-block">
      <div class="sheet-ai2-block-title">Körperliche Attribute (Tier)</div>
      <label>Belastbarkeit
        <input type="number" name="attr_comp_belastbarkeit">
      </label>
      <label>Kraft
        <input type="number" name="attr_comp_kraft">
      </label>
      <label>Schnelligkeit
        <input type="number" name="attr_comp_schnelligkeit">
      </label>
      <label>Wendigkeit
        <input type="number" name="attr_comp_wendigkeit">
      </label>
    </div>

        <!-- Spezialattribute -->
    <div class="sheet-ai2-block">
      <div class="sheet-ai2-block-title">Spezialattribute</div>
      <label>Reflexe
        <input type="number" name="attr_comp_reflexe">
      </label>
      <label>Verteidigung
        <input type="number" name="attr_comp_verteidigung">
      </label>
      <label>Bewegung
        <input type="number" name="attr_comp_bewegung">
      </label>
      <label>Rüstbonus
  <input type="text" name="attr_comp_ruestbonus" placeholder="z. B. 4/4/2">
</label>
      </label>
      <label>Rüstart
        <input type="text" name="attr_comp_ruestart" placeholder="z. B. Lederharnisch, Schuppen, Panzer">
      </label>
    </div>

    <!-- Geistige Attribute -->
    <div class="sheet-ai2-block">
      <div class="sheet-ai2-block-title">Geistige Attribute (Tier)</div>
      <label>Psyche
        <input type="number" name="attr_comp_psyche">
      </label>
      <label>Bildung
        <input type="number" name="attr_comp_bildung">
      </label>
      <label>Ausstrahlung
        <input type="number" name="attr_comp_ausstrahlung">
      </label>
      <label>Gespür
        <input type="number" name="attr_comp_gespuer">
      </label>
    </div>

  </div>

  <!-- ================== LEBENSKRAFT & GAIAVORRAT ================== -->
  <div class="sheet-ai2-grid2">
    <div class="sheet-ai2-block">
      <div class="sheet-ai2-block-title">Lebenskraft &amp; Gaiavorrat</div>
      <div class="sheet-ai2-table">
        <div class="sheet-ai2-row sheet-ai2-header">
          <span>Wert</span><span>Aktuell</span><span>Maximum</span>
        </div>
        <div class="sheet-ai2-row">
          <span>Lebenskraft</span>
          <span><input type="number" name="attr_comp_lk_aktuell"></span>
          <span><input type="number" name="attr_comp_lk_max"></span>
        </div>
        <div class="sheet-ai2-row">
          <span>Gaiavorrat</span>
          <span><input type="number" name="attr_comp_gv_aktuell"></span>
          <span><input type="number" name="attr_comp_gv_max"></span>
        </div>
      </div>
    </div>

    <div class="sheet-ai2-block">
      <div class="sheet-ai2-block-title">Sinne &amp; Bewegung</div>
      <div class="sheet-ai2-table">
        <div class="sheet-ai2-row sheet-ai2-header">
          <span>Aspekt</span><span>Wert / Notiz</span>
        </div>
        <div class="sheet-ai2-row">
          <span>Sicht</span>
          <span><input type="text" name="attr_comp_sicht" placeholder="z. B. gute Nachtsicht"></span>
        </div>
        <div class="sheet-ai2-row">
          <span>Gehör</span>
          <span><input type="text" name="attr_comp_gehoer" placeholder="z. B. empfindlich"></span>
        </div>
        <div class="sheet-ai2-row">
          <span>Geruch</span>
          <span><input type="text" name="attr_comp_geruch" placeholder="z. B. Fährtensuche"></span>
        </div>
        <div class="sheet-ai2-row">
          <span>Besondere Bewegung</span>
          <span><input type="text" name="attr_comp_bewegungsarten" placeholder="z. B. Klettern, Schwimmen, Fliegen"></span>
        </div>
      </div>
    </div>
  </div>

  <!-- ================== ANGRIFFE ================== -->
    <div class="sheet-ai2-block">
    <div class="sheet-ai2-block-title">Angriffe des Tierbegleiters</div>
    <div class="sheet-ai2-row sheet-ai2-header">
      <span>Name</span>
      <span>Art</span>
      <span>Schaden</span>
      <span>Pool</span>
      <span>Wurf</span>
    </div>

    <fieldset class="repeating_comp_angriffe">
      <div class="sheet-ai2-row">
        <span>
          <input type="text" name="attr_comp_atk_name" placeholder="z. B. Biss, Krallen, Tritt">
        </span>
        <span>
          <input type="text" name="attr_comp_atk_art" placeholder="z. B. Nahkampf, Spezial">
        </span>
        <span>
          <input type="text" name="attr_comp_atk_schaden" placeholder="z. B. +2, 1W6+2">
        </span>
        <span>
          <input type="number" name="attr_comp_atk_pool" value="0">
        </span>
        <span>
          <button type="roll" name="roll_comp_attack"
            value="&{template:default} [[ [[@{comp_atk_pool}]] - [[2d20+?{Modifikator|0}]] ]] {{name=@{character_name}}} {{Aktion=Tierangriff}} {{Angriff=@{comp_atk_name}}} {{Pool=$[[0]]}} {{Wurf=$[[1]]}} {{Erfolg=$[[2]]}}">
            Angriff
          </button>
        </span>
      </div>
    </fieldset>
  </div>


  <!-- ================== FERTIGKEITEN DES TIERBEGLEITERS ================== -->
  <div class="sheet-ai2-block">
    <div class="sheet-ai2-block-title">Fertigkeiten des Tierbegleiters</div>
    <div class="sheet-ai2-row sheet-ai2-header">
      <span>Name</span>
      <span>Attribut</span>
      <span>Stufe</span>
      <span>Pool</span>
      <span>Wurf</span>
    </div>

    <fieldset class="repeating_comp_fertigkeiten">
      <div class="sheet-ai2-row">
        <span>
          <input type="text" name="attr_comp_skill_name" placeholder="z. B. Spuren lesen, Einschüchtern">
        </span>
        <span>
          <select name="attr_comp_skill_attr">
            <option value="comp_belastbarkeit">Belastbarkeit</option>
            <option value="comp_kraft">Kraft</option>
            <option value="comp_schnelligkeit">Schnelligkeit</option>
            <option value="comp_wendigkeit">Wendigkeit</option>
            <option value="comp_psyche">Psyche</option>
            <option value="comp_bildung">Bildung</option>
            <option value="comp_ausstrahlung">Ausstrahlung</option>
            <option value="comp_gespuer">Gespür</option>
          </select>
        </span>
        <span>
          <input type="number" name="attr_comp_skill_stufe" value="0">
        </span>
        <span>
          <input type="number" name="attr_comp_skill_pool" value="0">
        </span>
        <span>
          <button type="roll" name="roll_comp_skill"
            value="&{template:default} {{name=@{character_name}}} {{Fertigkeit=@{comp_skill_name}}} {{Pool=[[@{comp_skill_pool}]]}} {{Wurf=[[2d20+?{Modifikator|0}]]}} {{Erfolg=[[ $[[0]] - $[[1]] ]]}}">
            Probe
          </button>
        </span>
      </div>
    </fieldset>
  </div>

  <!-- ================== BESONDERE FÄHIGKEITEN & NOTIZEN ================== -->
  <div class="sheet-ai2-grid2">
    <div class="sheet-ai2-block">
      <div class="sheet-ai2-block-title">Kommandos, Instinkte &amp; Besonderheiten</div>
      <textarea name="attr_comp_gaben" rows="5" placeholder="Kommandos, Instinkte, Dressur, Gaiakräfte des Tiers"></textarea>
    </div>

    <div class="sheet-ai2-block">
      <div class="sheet-ai2-block-title">Notizen &amp; Geschichte</div>
      <textarea name="attr_comp_notizen" rows="5" placeholder="Herkunft, prägende Ereignisse, Beziehung zum Besitzer"></textarea>
    </div>
  </div>

</div><!-- Ende Tierbegleiter-Seite -->


</div>
<script type="text/worker">
/* Zahl konvertieren */
const ai2_int = (v) => parseInt(v, 10) || 0;

/* ---------- 1. Spezialattribute + Belastung / Tauchen / Regeneration ---------- */
on("change:belastbarkeit change:kraft change:schnelligkeit change:wendigkeit change:psyche change:bildung change:ausstrahlung change:gespuer change:spezies", () => {
  getAttrs([
    "belastbarkeit","kraft","schnelligkeit","wendigkeit",
    "psyche","bildung","ausstrahlung","gespuer","spezies"
  ], (v) => {
    const be = ai2_int(v.belastbarkeit);
    const kr = ai2_int(v.kraft);
    const sc = ai2_int(v.schnelligkeit);
    const we = ai2_int(v.wendigkeit);
    const ps = ai2_int(v.psyche);
    const bi = ai2_int(v.bildung);
    const ge = ai2_int(v.gespuer);
    const species = (v.spezies || "").toLowerCase();

    /* Reflexe = Schnelligkeit + Wendigkeit, min 10, max 40 */
    let reflexe = sc + we;
    if (reflexe < 10) reflexe = 10;
    if (reflexe > 40) reflexe = 40;

    /* Lebenskraft = 2 * Belastbarkeit + 10 */
    const lebenskraft = 2 * be + 10;

    /* Gaiavorrat = Psyche + Gespür + Bildung */
    const gaiavorrat = ps + ge + bi;

    /* Verteidigungswert = halbe Wendigkeit (abgerundet), min 3, max 10 */
    let verteidigung = Math.floor(we / 2);
    if (verteidigung < 3) verteidigung = 3;
    if (verteidigung > 10) verteidigung = 10;

    /* Bewegung – Grundbewegung nach Spezies + Schnelligkeits-Bonus */
    let bewegung_base = 6; // Menschen/Orks
    if (species.includes("elf")) bewegung_base = 7;
    if (species.includes("zwerg") || species.includes("goblin")) bewegung_base = 5;

    let bewegung = bewegung_base;
    if (sc >= 16) bewegung += 1;
    if (sc >= 20) bewegung += 1;

    /* Kampfbelastung / Tragen / Tauchen / Regeneration */
    const kampfbelastung = 2 * be;       // RP
    const tragen_heben   = kr * 2.5;     // kg
    const tauchdauer     = be;           // RP
    const regen_lp       = be / 2;       // LP / RP
    const regen_gv       = ps / 2;       // Gaiavorrat / RP

    setAttrs({
      reflexe,
      lebenskraft,
      gaiavorrat,
      verteidigung,
      bewegung,
      kampfbelastung,
      tragen_heben: tragen_heben.toFixed(1),
      tauchdauer,
      regen_lp: regen_lp.toFixed(1),
      regen_gv: regen_gv.toFixed(1)
    });
  });
});

/* ---------- 2. Pools für „Weitere Fertigkeiten“ (repeating_fertigkeiten) ---------- */

const ai2_baseAttrs = [
  "belastbarkeit","kraft","schnelligkeit","wendigkeit",
  "psyche","bildung","ausstrahlung","gespuer"
];

function ai2_recalc_all_fert_pools() {
  getSectionIDs("repeating_fertigkeiten", (ids) => {
    if (!ids.length) return;

    const attrList = [...ai2_baseAttrs];
    ids.forEach(id => {
      attrList.push(
        `repeating_fertigkeiten_${id}_fert_attr`,
        `repeating_fertigkeiten_${id}_fert_stufe`
      );
    });

    getAttrs(attrList, (v) => {
      const out = {};
      ids.forEach(id => {
        const prefix = `repeating_fertigkeiten_${id}_`;
        const key   = v[`${prefix}fert_attr`] || "";   // z.B. "kraft"
        const stufe = ai2_int(v[`${prefix}fert_stufe`]);
        const base  = ai2_int(v[key] || 0);            // liest z.B. v["kraft"]
        out[`${prefix}fert_pool`] = base + stufe;
      });
      setAttrs(out);
    });
  });
}

/* Basisattribute ändern -> alle Fertigkeitspools neu */
on("change:belastbarkeit change:kraft change:schnelligkeit change:wendigkeit change:psyche change:bildung change:ausstrahlung change:gespuer", ai2_recalc_all_fert_pools);

/* Zeilen in „Weitere Fertigkeiten“ ändern -> Pools neu */
on("change:repeating_fertigkeiten:fert_attr change:repeating_fertigkeiten:fert_stufe remove:repeating_fertigkeiten", ai2_recalc_all_fert_pools);

/* ---------- 3. Pools für Zauber (repeating_spells) ---------- */

on("change:repeating_spells:spell_attr change:repeating_spells:spell_stufe", (eventInfo) => {
  const parts  = eventInfo.sourceAttribute.split("_");
  const rowId  = parts[2];
  const prefix = `repeating_spells_${rowId}_`;

  getAttrs([
    `${prefix}spell_attr`,
    `${prefix}spell_stufe`,
    "belastbarkeit","kraft","schnelligkeit","wendigkeit",
    "psyche","bildung","ausstrahlung","gespuer"
  ], (v) => {
    const attrKey = v[`${prefix}spell_attr`] || "";
    const rank    = ai2_int(v[`${prefix}spell_stufe`]);
    const base    = ai2_int(v[attrKey] || 0);
    const pool    = base + rank;

    const out = {};
    out[`${prefix}spell_pool`] = pool;
    setAttrs(out);
  });
});

/* ---------- 4. Pools für Grundfertigkeiten ---------- */

function ai2_recalc_grundfertigkeiten() {
  getAttrs([
    "belastbarkeit","kraft","bildung","gespuer","psyche",
    "fert_beherrschen_stufe","fert_kochen_stufe","fert_krafthandlung_stufe",
    "fert_pruegeln_stufe","fert_sitten_stufe","fert_ueberleben_stufe",
    "fert_verstand_stufe","fert_wahrnehmung_stufe","fert_willenskraft_stufe"
  ], (v) => {
    const be = ai2_int(v.belastbarkeit);
    const kr = ai2_int(v.kraft);
    const bi = ai2_int(v.bildung);
    const ge = ai2_int(v.gespuer);
    const ps = ai2_int(v.psyche);

    setAttrs({
      fert_beherrschen_pool:   be + ai2_int(v.fert_beherrschen_stufe),
      fert_kochen_pool:        ge + ai2_int(v.fert_kochen_stufe),
      fert_krafthandlung_pool: kr + ai2_int(v.fert_krafthandlung_stufe),
      fert_pruegeln_pool:      kr + ai2_int(v.fert_pruegeln_stufe),
      fert_sitten_pool:        ge + ai2_int(v.fert_sitten_stufe),
      fert_ueberleben_pool:    be + ai2_int(v.fert_ueberleben_stufe),
      fert_verstand_pool:      bi + ai2_int(v.fert_verstand_stufe),
      fert_wahrnehmung_pool:   ge + ai2_int(v.fert_wahrnehmung_stufe),
      fert_willenskraft_pool:  ps + ai2_int(v.fert_willenskraft_stufe)
    });
  });
}

on(
  "change:belastbarkeit " +
  "change:kraft " +
  "change:bildung " +
  "change:gespuer " +
  "change:psyche " +
  "change:fert_beherrschen_stufe " +
  "change:fert_kochen_stufe " +
  "change:fert_krafthandlung_stufe " +
  "change:fert_pruegeln_stufe " +
  "change:fert_sitten_stufe " +
  "change:fert_ueberleben_stufe " +
  "change:fert_verstand_stufe " +
  "change:fert_wahrnehmung_stufe " +
  "change:fert_willenskraft_stufe",
  ai2_recalc_grundfertigkeiten
);
/* ---------- 5. Rüstung: Gesamt Torso RB (Torso 1 + Torso 2) ---------- */

function ai2_recalc_ruestung_torso() {
  getAttrs([
    "ruestung_torso1_rb_w",
    "ruestung_torso1_rb_k",
    "ruestung_torso1_rb_s",
    "ruestung_torso2_rb_w",
    "ruestung_torso2_rb_k",
    "ruestung_torso2_rb_s"
  ], (v) => {
    const t1w = ai2_int(v.ruestung_torso1_rb_w);
    const t1k = ai2_int(v.ruestung_torso1_rb_k);
    const t1s = ai2_int(v.ruestung_torso1_rb_s);

    const t2w = ai2_int(v.ruestung_torso2_rb_w);
    const t2k = ai2_int(v.ruestung_torso2_rb_k);
    const t2s = ai2_int(v.ruestung_torso2_rb_s);

    setAttrs({
      ruestung_torso_gesamt_rb_w: t1w + t2w,
      ruestung_torso_gesamt_rb_k: t1k + t2k,
      ruestung_torso_gesamt_rb_s: t1s + t2s
    });
  });
}

on(
  "change:ruestung_torso1_rb_w " +
  "change:ruestung_torso1_rb_k " +
  "change:ruestung_torso1_rb_s " +
  "change:ruestung_torso2_rb_w " +
  "change:ruestung_torso2_rb_k " +
  "change:ruestung_torso2_rb_s " +
  "sheet:opened",
  ai2_recalc_ruestung_torso
);
/* ---------- 6. Tierbegleiter: Folgsamkeit-Pool ---------- */

function ai2_recalc_comp_folgsamkeit() {
  getAttrs(["comp_folgsamkeit", "gespuer"], (v) => {
    const fs = ai2_int(v.comp_folgsamkeit);
    const ge = ai2_int(v.gespuer);
    setAttrs({
      comp_folgsamkeit_pool: fs + ge
    });
  });
}

on("sheet:opened change:comp_folgsamkeit change:gespuer", ai2_recalc_comp_folgsamkeit);


</script>



<!-- ===== Ende Adventure Islands – V2 (HTML) ===== -->
