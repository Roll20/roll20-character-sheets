<input type="radio" id="tab-main" name="attr_tab" class="sheet-tab-button sheet-tab1" value="1" checked/>
<input type="radio" id="tab-bg" name="attr_tab" class="sheet-tab-button sheet-tab2" value="2"/>
<input type="radio" id="tab-abil" name="attr_tab" class="sheet-tab-button sheet-tab3" value="3"/>
<input type="checkbox" id="edit-mode" name="attr_edit_mode" value="1" checked/>
<input type="checkbox" id="settings-mode" name="attr_settings_mode" value="1"/>
<input type="radio" id="sheet-type-character" name="attr_sheet_type" value="Character" checked/>
<input type="radio" id="sheet-type-team" name="attr_sheet_type" value="Team"/>
<input type="radio" id="sheet-type-monster" name="attr_sheet_type" value="Monster"/>
<input type="checkbox" id="coins-enabled" name="attr_coins_enabled" value="1"/>
<input type="checkbox" id="reputation-enabled" name="attr_reputations_enabled" value="1"/>

<div class="sheet-mode-controls">
    <label class="sheet-edit-toggle" for="edit-mode"><span>Edit Mode</span></label>
    <label class="sheet-settings-toggle" for="settings-mode"><span>âš™</span></label>
</div>

<div class="sheet-settings-panel sheet-section">
    <h2>Settings</h2>

    <div class="sheet-settings-row">
        <label class="sheet-settings-label">Sheet Type</label>
        <div class="sheet-settings-options">
            <label class="sheet-radio-type-character" for="sheet-type-character">
                <span>Character</span>
            </label>
            <label class="sheet-radio-type-character" for="sheet-type-team">
                <span>Team</span>
            </label>
            <label class="sheet-radio-type-character" for="sheet-type-monster">
                <span>Monster</span>
            </label>
        </div>
    </div>

    <h3>Home rules. Wealth and Renown progress bar. 1 Coin and 1 Rep per 3 Victories. Like "Blades in the Darkness" game.</h3>
    <div class="sheet-settings-row">
        <label class="sheet-settings-label">Coins</label>
        <label class="sheet-coins-toggle" for="coins-enabled">
            <span>Enable Coins (Character)</span>
        </label>
    </div>

    <div class="sheet-settings-row">
        <label class="sheet-settings-label">Reputation</label>
        <label class="sheet-coins-toggle" for="reputation-enabled">
            <span>Enable Reputation (Team)</span>
        </label>
    </div>
</div>

<div class="sheet-tab-navigation">
    <label for="tab-main" class="sheet-tab-label">Main</label>
    <label for="tab-bg" class="sheet-tab-label">Features</label>
    <label for="tab-abil" class="sheet-tab-label">Abilities</label>
</div>

<div class="sheet-tab-content">
    <div class="sheet-tab-pane sheet-tab1-content">
        <div class="sheet-top-container">
            <div class="sheet-section sheet-combined-info">
                <h2>Character Information & Progress</h2>

                <div class="sheet-combined-content">
                    <div class="sheet-info-left">
                        <h3>Character Info</h3>
                        <label>Character Name:</label>
                        <input type="text" name="attr_character_name" class="sheet-lockable"/>

                        <label>Ancestry:</label>
                        <input type="text" name="attr_ancestry" class="sheet-lockable"/>

                        <label>Class:</label>
                        <input type="text" name="attr_class" class="sheet-lockable"/>

                        <label>Subclass:</label>
                        <input type="text" name="attr_subclass" class="sheet-lockable"/>
                    </div>

                    <div class="sheet-info-right">
                        <div class="sheet-victories-container">
                            <h3>Victories</h3>
                            <div class="sheet-victories-boxes">
                                <input type="checkbox" name="attr_victory1" value="1"/>
                                <input type="checkbox" name="attr_victory2" value="1"/>
                                <input type="checkbox" name="attr_victory3" value="1"/>
                                <input type="checkbox" name="attr_victory4" value="1"/>
                                <input type="checkbox" name="attr_victory5" value="1"/>
                                <input type="checkbox" name="attr_victory6" value="1"/>
                                <input type="checkbox" name="attr_victory7" value="1"/>
                                <input type="checkbox" name="attr_victory8" value="1"/>
                                <input type="checkbox" name="attr_victory9" value="1"/>
                                <input type="checkbox" name="attr_victory10" value="1"/>
                                <input type="checkbox" name="attr_victory11" value="1"/>
                                <input type="checkbox" name="attr_victory12" value="1"/>
                                <input type="checkbox" name="attr_victory13" value="1"/>
                                <input type="checkbox" name="attr_victory14" value="1"/>
                                <input type="checkbox" name="attr_victory15" value="1"/>
                            </div>
                        </div>

                        <div class="sheet-basic-resources">
                            <div class="sheet-mod-item">
                                <label>Level</label>
                                <div class="sheet-param-item">
                                    <input type="number" name="attr_level" value="1" min="1" class="sheet-lockable"/>
                                </div>
                            </div>

                            <div class="sheet-mod-item">
                                <label>Wealth</label>
                                <div class="sheet-param-item">
                                    <input type="number" name="attr_wealth" value="1" min="0" class="sheet-lockable"/>
                                </div>
                            </div>

                            <div class="sheet-mod-item">
                                <label>Renown</label>
                                <div class="sheet-param-item">
                                    <input type="number" name="attr_renown" value="0" min="0" class="sheet-lockable"/>
                                </div>
                            </div>

                            <div class="sheet-mod-item">
                                <label>XP</label>
                                <div class="sheet-param-item">
                                    <input type="number" name="attr_xp" value="0" min="0" class="sheet-lockable"/>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="sheet-coins-block">
                    <h3>Coins</h3>
                    <div class="sheet-coins-boxes">
                        <input type="checkbox" name="attr_coin_1" value="1"/>
                        <input type="checkbox" name="attr_coin_2" value="1"/>
                        <input type="checkbox" name="attr_coin_3" value="1"/>
                        <input type="checkbox" name="attr_coin_4" value="1"/>
                        <input type="checkbox" name="attr_coin_5" value="1"/>
                        <input type="checkbox" name="attr_coin_6" value="1"/>
                        <input type="checkbox" name="attr_coin_7" value="1"/>
                        <input type="checkbox" name="attr_coin_8" value="1"/>
                        <input type="checkbox" name="attr_coin_9" value="1"/>
                        <input type="checkbox" name="attr_coin_10" value="1"/>
                    </div>
                </div>
            </div>
        </div>

        <div class="sheet-section">
            <h2>Characteristics</h2>
            <div class="sheet-char-grid">
                <div class="sheet-char-item">
                    <label>Might</label>
                    <input type="number" name="attr_might" value="0" class="sheet-lockable"/>
                    <div class="sheet-button-group">
                        <button type="roll" name="roll_power" value="&{template:drawsteel} {{title=Power Roll by @{character_name}}} {{subtitle=Might}} {{roll=Power Roll = [[[[2d10]]+@{might}[Might]+?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                            Roll
                        </button>
                        <button class="sheet-whisper-btn" type="roll" name="roll_power_whisper" value="/w gm &{template:drawsteel} {{title=Power Roll by @{character_name}}} {{subtitle=Might}} {{roll=Power Roll = [[[[2d10]]+@{might}[Might]+?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                            GM
                        </button>
                    </div>
                </div>

                <div class="sheet-char-item">
                    <label>Agility</label>
                    <input type="number" name="attr_agility" value="0" class="sheet-lockable"/>
                    <div class="sheet-button-group">
                        <button type="roll" name="roll_power" value="&{template:drawsteel} {{title=Power Roll by @{character_name}}} {{subtitle=Agility}} {{roll=Power Roll = [[[[2d10]]+@{agility}[Agility]+?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                            Roll
                        </button>
                        <button class="sheet-whisper-btn" type="roll" name="roll_power_whisper" value="/w gm &{template:drawsteel} {{title=Power Roll by @{character_name}}} {{subtitle=Agility}} {{roll=Power Roll = [[[[2d10]]+@{agility}[Agility]+?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                            GM
                        </button>
                    </div>
                </div>

                <div class="sheet-char-item">
                    <label>Reason</label>
                    <input type="number" name="attr_reason" value="0" class="sheet-lockable"/>
                    <div class="sheet-button-group">
                        <button type="roll" name="roll_power" value="&{template:drawsteel} {{title=Power Roll by @{character_name}}} {{subtitle=Reason}} {{roll=Power Roll = [[[[2d10]]+@{reason}[Reason]+?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                            Roll
                        </button>
                        <button class="sheet-whisper-btn" type="roll" name="roll_power_whisper" value="/w gm &{template:drawsteel} {{title=Power Roll by @{character_name}}} {{subtitle=Reason}} {{roll=Power Roll = [[[[2d10]]+@{reason}[Reason]+?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                            GM
                        </button>
                    </div>
                </div>

                <div class="sheet-char-item">
                    <label>Intuition</label>
                    <input type="number" name="attr_intuition" value="0" class="sheet-lockable"/>
                    <div class="sheet-button-group">
                        <button type="roll" name="roll_power" value="&{template:drawsteel} {{title=Power Roll by @{character_name}}} {{subtitle=Intuition}} {{roll=Power Roll = [[[[2d10]]+@{intuition}[Intuition]+?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                            Roll
                        </button>
                        <button class="sheet-whisper-btn" type="roll" name="roll_power_whisper" value="/w gm &{template:drawsteel} {{title=Power Roll by @{character_name}}} {{subtitle=Intuition}} {{roll=Power Roll = [[[[2d10]]+@{intuition}[Intuition]+?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                            GM
                        </button>
                    </div>
                </div>

                <div class="sheet-char-item">
                    <label>Presence</label>
                    <input type="number" name="attr_presence" value="0" class="sheet-lockable"/>
                    <div class="sheet-button-group">
                        <button type="roll" name="roll_power" value="&{template:drawsteel} {{title=Power Roll by @{character_name}}} {{subtitle=Presence}} {{roll=Power Roll = [[[[2d10]]+@{presence}[Presence]+?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                            Roll
                        </button>
                        <button class="sheet-whisper-btn" type="roll" name="roll_power_whisper" value="/w gm &{template:drawsteel} {{title=Power Roll by @{character_name}}} {{subtitle=Presence}} {{roll=Power Roll = [[[[2d10]]+@{presence}[Presence]+?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                            GM
                        </button>
                    </div>
                </div>
            </div>

            <div class="sheet-char-other-rolls-grid">
                <div class="sheet-roll-option">
                    <span class="sheet-roll-label">d10</span>
                    <div class="sheet-button-group">
                        <button class="sheet-d10-dice" type="roll" name="roll_d10" value="&{template:drawsteel} {{title=Simple Roll by @{character_name}}} {{roll=Roll d10 = [[[[1d10]]+?{Modifier|0}]]}} {{raw=Raw = $[[0]]}}">
                            Roll
                        </button>
                        <button class="sheet-whisper-btn" type="roll" name="roll_d10_whisper" value="/w gm &{template:drawsteel} {{title=Simple Roll by @{character_name}}} {{roll=Roll d10 = [[[[1d10]]+?{Modifier|0}]]}} {{raw=Raw = $[[0]]}}">
                            GM
                        </button>
                    </div>
                </div>

                <div class="sheet-roll-option">
                    <span class="sheet-roll-label">2d6</span>
                    <div class="sheet-button-group">
                        <button class="sheet-2d6-dice" type="roll" name="roll_2d6" value="&{template:drawsteel} {{title=Simple Roll by @{character_name}}} {{roll=Roll 2d6 = [[[[2d6]]+?{Modifier|0}]]}} {{raw=Raw = $[[0]]}}">
                            Roll
                        </button>
                        <button class="sheet-whisper-btn" type="roll" name="roll_2d6_whisper" value="/w gm &{template:drawsteel} {{title=Simple Roll by @{character_name}}} {{roll=Roll 2d6 = [[[[2d6]]+?{Modifier|0}]]}} {{raw=Raw = $[[0]]}}">
                            GM
                        </button>
                    </div>
                </div>

                <div class="sheet-roll-option">
                    <span class="sheet-roll-label">d6</span>
                    <div class="sheet-button-group">
                        <button class="sheet-d6-dice" type="roll" name="roll_d6" value="&{template:drawsteel} {{title=Simple Roll by @{character_name}}} {{roll=Roll d6 = [[[[1d6]]+?{Modifier|0}]]}} {{raw=Raw = $[[0]]}}">
                            Roll
                        </button>
                        <button class="sheet-whisper-btn" type="roll" name="roll_d6_whisper" value="/w gm &{template:drawsteel} {{title=Simple Roll by @{character_name}}} {{roll=Roll d6 = [[[[1d6]]+?{Modifier|0}]]}} {{raw=Raw = $[[0]]}}">
                            GM
                        </button>
                    </div>
                </div>

                <div class="sheet-roll-option">
                    <span class="sheet-roll-label">d3</span>
                    <div class="sheet-button-group">
                        <button class="sheet-d3-dice" type="roll" name="roll_d3" value="&{template:drawsteel} {{title=Simple Roll by @{character_name}}} {{roll=Roll d3 = [[[[1d3]]+?{Modifier|0}]]}} {{raw=Raw = $[[0]]}}">
                            Roll
                        </button>
                        <button class="sheet-whisper-btn" type="roll" name="roll_d3_whisper" value="/w gm &{template:drawsteel} {{title=Simple Roll by @{character_name}}} {{roll=Roll d3 = [[[[1d3]]+?{Modifier|0}]]}} {{raw=Raw = $[[0]]}}">
                            GM
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="sheet-section">
            <h2>Other Parameters</h2>
            <div class="sheet-params-grid">
                <div class="sheet-additional-param-item">
                    <label>Size:</label>
                    <select name="attr_size" class="sheet-lockable">
                        <option value="1T">1T</option>
                        <option value="1S">1S</option>
                        <option value="1M" selected>1M</option>
                        <option value="1L"> 1L</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                    </select>
                </div>
                <div class="sheet-additional-param-item">
                    <label>Speed</label>
                    <input type="number" name="attr_speed" value="5" min="0" class="sheet-lockable"/>
                </div>
                <div class="sheet-additional-param-item">
                    <label>Disengage</label>
                    <input type="number" name="attr_disengage" value="1" min="0" class="sheet-lockable"/>
                </div>
                <div class="sheet-additional-param-item">
                    <label>Stability</label>
                    <input type="number" name="attr_stability" value="0" min="0" class="sheet-lockable"/>
                </div>
                <div class="sheet-additional-param-item">
                    <label>Weak</label>
                    <input type="number" name="attr_potency_weak" class="sheet-lockable" value="0"/>
                </div>
                <div class="sheet-additional-param-item">
                    <label>Average</label>
                    <input type="number" name="attr_potency_average" class="sheet-lockable" value="1"/>
                </div>
                <div class="sheet-additional-param-item">
                    <label>Strong</label>
                    <input type="number" name="attr_potency_strong" class="sheet-lockable" value="2"/>
                </div>
            </div>
        </div>

        <div class="sheet-section sheet-skills">
            <h2>Skills</h2>

            <div class="sheet-skills-container">
                <div class="sheet-skill-category">
                    <h3>Crafting</h3>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_alchemy" value="1" class="sheet-lockable"/> Alchemy</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_fletching" value="1" class="sheet-lockable"/>
                        Fletching</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_architecture" value="1" class="sheet-lockable"/>
                        Architecture</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_forgery" value="1" class="sheet-lockable"/> Forgery</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_blacksmithing" value="1" class="sheet-lockable"/>
                        Blacksmithing</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_jewelry" value="1" class="sheet-lockable"/> Jewelry</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_carpentry" value="1" class="sheet-lockable"/>
                        Carpentry</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_mechanics" value="1" class="sheet-lockable"/>
                        Mechanics</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_cooking" value="1" class="sheet-lockable"/> Cooking</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_tailoring" value="1" class="sheet-lockable"/>
                        Tailoring</label>

                    <div class="sheet-custom-skill-row">
                        <input type="checkbox" name="attr_skill_custom1_crafting" value="1" class="sheet-lockable"/>
                        <input type="text" name="attr_skill_custom1_crafting_name" placeholder="Custom Skill" class="sheet-custom-skill-name sheet-lockable-like-text"/>
                    </div>
                    <div class="sheet-custom-skill-row">
                        <input type="checkbox" name="attr_skill_custom2_crafting" value="1" class="sheet-lockable"/>
                        <input type="text" name="attr_skill_custom2_crafting_name" placeholder="Custom Skill" class="sheet-custom-skill-name sheet-lockable-like-text"/>
                    </div>

                </div>

                <div class="sheet-skill-category">
                    <h3>Exploration</h3>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_climb" value="1" class="sheet-lockable"/> Climb</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_jump" value="1" class="sheet-lockable"/> Jump</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_drive" value="1" class="sheet-lockable"/> Drive</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_lift" value="1" class="sheet-lockable"/> Lift</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_endurance" value="1" class="sheet-lockable"/>
                        Endurance</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_navigate" value="1" class="sheet-lockable"/> Navigate</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_gymnastics" value="1" class="sheet-lockable"/>
                        Gymnastics</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_ride" value="1" class="sheet-lockable"/> Ride</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_heal" value="1" class="sheet-lockable"/> Heal</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_swim" value="1" class="sheet-lockable"/> Swim</label>

                    <div class="sheet-custom-skill-row">
                        <input type="checkbox" name="attr_skill_custom1_exploration" value="1" class="sheet-lockable"/>
                        <input type="text" name="attr_skill_custom1_exploration_name" placeholder="Custom Skill" class="sheet-custom-skill-name sheet-lockable-like-text"/>
                    </div>
                    <div class="sheet-custom-skill-row">
                        <input type="checkbox" name="attr_skill_custom2_exploration" value="1" class="sheet-lockable"/>
                        <input type="text" name="attr_skill_custom2_exploration_name" placeholder="Custom Skill" class="sheet-custom-skill-name sheet-lockable-like-text"/>
                    </div>

                </div>

                <div class="sheet-skill-category">
                    <h3>Interpersonal</h3>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_brag" value="1" class="sheet-lockable"/> Brag</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_lead" value="1" class="sheet-lockable"/> Lead</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_empathize" value="1" class="sheet-lockable"/>
                        Empathize</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_lie" value="1" class="sheet-lockable"/> Lie</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_flirt" value="1" class="sheet-lockable"/> Flirt</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_music" value="1" class="sheet-lockable"/> Music</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_gamble" value="1" class="sheet-lockable"/> Gamble</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_performance" value="1" class="sheet-lockable"/>
                        Performance</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_handle_animals" value="1" class="sheet-lockable"/> Handle
                                                                                                                                                        Animals</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_persuade" value="1" class="sheet-lockable"/> Persuade</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_interrogate" value="1" class="sheet-lockable"/>
                        Interrogate</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_read_person" value="1" class="sheet-lockable"/> Read
                                                                                                                                                     Person</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_intimidate" value="1" class="sheet-lockable"/>
                        Intimidate</label>

                    <div class="sheet-custom-skill-row">
                        <input type="checkbox" name="attr_skill_custom1_interpersonal" value="1" class="sheet-lockable"/>
                        <input type="text" name="attr_skill_custom1_interpersonal_name" placeholder="Custom Skill" class="sheet-custom-skill-name sheet-lockable-like-text"/>
                    </div>
                    <div class="sheet-custom-skill-row">
                        <input type="checkbox" name="attr_skill_custom2_interpersonal" value="1" class="sheet-lockable"/>
                        <input type="text" name="attr_skill_custom2_interpersonal_name" placeholder="Custom Skill" class="sheet-custom-skill-name sheet-lockable-like-text"/>
                    </div>

                </div>

                <div class="sheet-skill-category">
                    <h3>Intrigue</h3>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_alertness" value="1" class="sheet-lockable"/>
                        Alertness</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_pick_lock" value="1" class="sheet-lockable"/> Pick
                                                                                                                                                   Lock</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_conceal_object" value="1" class="sheet-lockable"/> Conceal
                                                                                                                                                        Object</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_pick_pocket" value="1" class="sheet-lockable"/> Pick
                                                                                                                                                     Pocket</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_disguise" value="1" class="sheet-lockable"/> Disguise</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_sabotage" value="1" class="sheet-lockable"/> Sabotage</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_eavesdrop" value="1" class="sheet-lockable"/>
                        Eavesdrop</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_search" value="1" class="sheet-lockable"/> Search</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_escape_artist" value="1" class="sheet-lockable"/> Escape
                                                                                                                                                       Artist</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_sneak" value="1" class="sheet-lockable"/> Sneak</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_hide" value="1" class="sheet-lockable"/> Hide</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_track" value="1" class="sheet-lockable"/> Track</label>

                    <div class="sheet-custom-skill-row">
                        <input type="checkbox" name="attr_skill_custom1_intrigue" value="1" class="sheet-lockable"/>
                        <input type="text" name="attr_skill_custom1_intrigue_name" placeholder="Custom Skill" class="sheet-custom-skill-name sheet-lockable-like-text"/>
                    </div>
                    <div class="sheet-custom-skill-row">
                        <input type="checkbox" name="attr_skill_custom2_intrigue" value="1" class="sheet-lockable"/>
                        <input type="text" name="attr_skill_custom2_intrigue_name" placeholder="Custom Skill" class="sheet-custom-skill-name sheet-lockable-like-text"/>
                    </div>

                </div>

                <div class="sheet-skill-category">
                    <h3>Lore</h3>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_culture" value="1" class="sheet-lockable"/> Culture</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_psionics" value="1" class="sheet-lockable"/> Psionics</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_criminal_underworld" value="1" class="sheet-lockable"/> Criminal
                                                                                                                                                             Underworld</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_religion" value="1" class="sheet-lockable"/> Religion</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_history" value="1" class="sheet-lockable"/> History</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_rumors" value="1" class="sheet-lockable"/> Rumors</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_magic" value="1" class="sheet-lockable"/> Magic</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_society" value="1" class="sheet-lockable"/> Society</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_monsters" value="1" class="sheet-lockable"/> Monsters</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_strategy" value="1" class="sheet-lockable"/> Strategy</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_nature" value="1" class="sheet-lockable"/> Nature</label>
                    <label class="sheet-lockable-like-text"> <input type="checkbox" name="attr_skill_timescape" value="1" class="sheet-lockable"/>
                        Timescape</label>

                    <div class="sheet-custom-skill-row">
                        <input type="checkbox" name="attr_skill_custom1_lore" value="1" class="sheet-lockable"/>
                        <input type="text" name="attr_skill_custom1_lore_name" placeholder="Custom Skill" class="sheet-custom-skill-name sheet-lockable-like-text"/>
                    </div>
                    <div class="sheet-custom-skill-row">
                        <input type="checkbox" name="attr_skill_custom2_lore" value="1" class="sheet-lockable"/>
                        <input type="text" name="attr_skill_custom2_lore_name" placeholder="Custom Skill" class="sheet-custom-skill-name sheet-lockable-like-text"/>
                    </div>

                </div>
            </div>
        </div>

        <div class="sheet-middle-container">
            <div class="sheet-section sheet-stamina">
                <h2>Stamina</h2>
                <h3>Values</h3>

                <div class="sheet-stamina-grid">
                    <label>Current Stamina:</label>
                    <div class="sheet-param-item"><input type="number" name="attr_stamina" value="0"/>
                    </div>

                    <label>Temporary Stamina:</label>
                    <div class="sheet-param-item"><input type="number" name="attr_stamina_temp" value="0" min="0"/>
                    </div>

                    <label>Max Stamina:</label>
                    <div class="sheet-param-item"><input type="number" name="attr_stamina_max" value="0" class="sheet-lockable"/>
                    </div>

                    <label>Winded Threshold:</label>
                    <div class="sheet-param-item"><input type="number" name="attr_stamina_winded" value="0" class="sheet-lockable"/>
                    </div>

                    <label>Dying Threshold:</label>
                    <div class="sheet-param-item"><input type="number" name="attr_stamina_dying" value="0" class="sheet-lockable"/>
                    </div>

                    <label>Death Threshold:</label>
                    <div class="sheet-param-item"><input type="number" name="attr_stamina_death" value="0" class="sheet-lockable"/>
                    </div>
                </div>

                <h3>Actions</h3>
                <div class="sheet-stamina-actions-grid">
                    <input type="number" name="attr_stam_heal_input" value="0" min="0"/>
                    <button type="action" name="act_stam_heal">Heal</button>

                    <input type="number" name="attr_stam_damage_input" value="0" min="0"/>
                    <button type="action" name="act_stam_damage">Damage</button>

                    <input type="number" name="attr_stam_temp_gain_input" value="0" min="0"/>
                    <button type="action" name="act_stam_temp_gain">Add Temp</button>
                </div>

                <div class="sheet-stamina-grid">
                    <button type="action" name="act_stam_temp_clear">Clear Temp</button>
                    <button type="action" name="act_stam_full_heal" class="sheet-restore-btn">Full Restore</button>
                </div>

                <h3>Character Status</h3>
                <div class="sheet-status-checks">
                    <label title="Auto-set by sheet logic"><input type="checkbox" name="attr_status_winded" value="1"/>Winded</label>
                    <label title="Auto-set by sheet logic"><input type="checkbox" name="attr_status_dying" value="1"/>Dying</label>
                    <label title="Auto-set by sheet logic"><input type="checkbox" name="attr_status_dead" value="1"/>Dead</label>
                </div>
            </div>

            <div class="sheet-section sheet-conditions">
                <h2>Conditions</h2>
                <div class="sheet-conditions-grid">
                    <div class="sheet-condition-header">
                        <span>Condition</span><span>End of Turn</span><span>Save Ends</span>
                    </div>
                    <div class="sheet-condition-row">
                        <span>Bleeding</span><input type="checkbox" name="attr_condition_bleeding_eot" value="1"/><input type="checkbox" name="attr_condition_bleeding_save" value="1"/>
                    </div>
                    <div class="sheet-condition-row">
                        <span>Dazed</span><input type="checkbox" name="attr_condition_dazed_eot" value="1"/><input type="checkbox" name="attr_condition_dazed_save" value="1"/>
                    </div>
                    <div class="sheet-condition-row">
                        <span>Frightened</span><input type="checkbox" name="attr_condition_frightened_eot" value="1"/><input type="checkbox" name="attr_condition_frightened_save" value="1"/>
                    </div>
                    <div class="sheet-condition-row">
                        <span>Grabbed</span><input type="checkbox" name="attr_condition_grabbed_eot" value="1"/><input type="checkbox" name="attr_condition_grabbed_save" value="1"/>
                    </div>
                    <div class="sheet-condition-row">
                        <span>Prone</span><input type="checkbox" name="attr_condition_prone_eot" value="1"/><input type="checkbox" name="attr_condition_prone_save" value="1"/>
                    </div>
                    <div class="sheet-condition-row">
                        <span>Restrained</span><input type="checkbox" name="attr_condition_restrained_eot" value="1"/><input type="checkbox" name="attr_condition_restrained_save" value="1"/>
                    </div>
                    <div class="sheet-condition-row">
                        <span>Slowed</span><input type="checkbox" name="attr_condition_slowed_eot" value="1"/><input type="checkbox" name="attr_condition_slowed_save" value="1"/>
                    </div>
                    <div class="sheet-condition-row">
                        <span>Taunted</span><input type="checkbox" name="attr_condition_taunted_eot" value="1"/><input type="checkbox" name="attr_condition_taunted_save" value="1"/>
                    </div>
                    <div class="sheet-condition-row">
                        <span>Weakened</span><input type="checkbox" name="attr_condition_weakened_eot" value="1"/><input type="checkbox" name="attr_condition_weakened_save" value="1"/>
                    </div>

                    <div class="sheet-condition-row">
                        <input type="text" name="attr_condition_custom1_name" placeholder="Custom" class="sheet-custom-condition-name sheet-lockable-condition"/>
                        <input type="checkbox" name="attr_condition_custom1_eot" value="1"/>
                        <input type="checkbox" name="attr_condition_custom1_save" value="1"/>
                    </div>
                    <div class="sheet-condition-row">
                        <input type="text" name="attr_condition_custom2_name" placeholder="Custom" class="sheet-custom-condition-name sheet-lockable-condition"/>
                        <input type="checkbox" name="attr_condition_custom2_eot" value="1"/>
                        <input type="checkbox" name="attr_condition_custom2_save" value="1"/>
                    </div>

                </div>
                <label>Notes:</label>
                <textarea name="attr_condition_notes" class="sheet-textarea-medium"></textarea>
            </div>

            <div class="sheet-section sheet-damage-types">
                <h2>Immunity & Weakness</h2>
                <fieldset class="repeating_damagetypes">
                    <div class="sheet-damage-type-row">
                        <input type="text" name="attr_damage_type" placeholder="Fire" class="sheet-damage-type-input sheet-lockable"/>
                        <input type="number" name="attr_damage_value" value="0" class="sheet-damage-value-input sheet-lockable"/>
                    </div>
                </fieldset>
            </div>
        </div>

        <div class="sheet-resources-container">
            <div class="sheet-section sheet-surges">
                <h2>Surges</h2>
                <div class="sheet-surges-counter">
                    <div class="sheet-param-item"><input type="number" name="attr_surges" value="0"/></div>
                </div>
                <div class="sheet-surge-actions-grid">
                    <button type="action" name="act_surges_gain">Add</button>
                    <button type="action" name="act_surges_spend">Spend</button>
                    <button type="action" name="act_surges_clear">Clear</button>
                </div>
            </div>

            <div class="sheet-section sheet-heroic">
                <h2>Heroic Resource</h2>
                <div class="sheet-resource-grid">
                    <input type="text" name="attr_heroic_resource_name" placeholder="Rage" class="sheet-lockable"/>
                    <div class="sheet-param-item"><input type="number" name="attr_heroic_resource" value="0"/></div>
                </div>
                <div class="sheet-surge-actions-grid">
                    <button type="action" name="act_heroic_gain">Add</button>
                    <button type="action" name="act_heroic_spend">Spend</button>
                    <button type="action" name="act_heroic_clear">Clear</button>
                </div>
                <textarea name="attr_heroic_resource_source" placeholder="How to gain this resource" class="sheet-resource-source sheet-lockable sheet-hide-when-empty"></textarea>
            </div>

            <div class="sheet-section sheet-recovery">
                <h2>Recovery</h2>
                <div class="sheet-recoveries-grid">
                    <label>Current Recoveries:</label>
                    <div class="sheet-param-item"><input type="number" name="attr_recoveries" value="8" min="0"/></div>

                    <label>Stamina Recovery:</label>
                    <div class="sheet-param-item"><input type="number" name="attr_stamina_per_recovery" value="0" min="0" class="sheet-lockable"/>
                    </div>

                    <label>Max Recoveries:</label>
                    <div class="sheet-param-item"><input type="number" name="attr_recoveries_max" value="8" min="0" class="sheet-lockable"/>
                    </div>
                </div>
                <div class="sheet-recovery-buttons-grid">
                    <button type="action" name="act_recovery_spend">Spend One</button>
                    <button type="action" name="act_recoveries_restore_all" class="sheet-restore-recovery-btn">
                        Restore
                        All
                    </button>
                </div>
            </div>
        </div>

        <div class="sheet-bottom-container">
            <div class="sheet-section sheet-modifiers">
                <h2>Modifiers</h2>
                <div class="sheet-mod-types-grid">
                    <label class="sheet-lockable"><input type="checkbox" name="attr_mod_kit" value="1" class="sheet-lockable"/> Kit</label>
                    <label class="sheet-lockable"><input type="checkbox" name="attr_mod_augmentation" value="1" class="sheet-lockable"/> Augmentation</label>
                    <label class="sheet-lockable"><input type="checkbox" name="attr_mod_enchantment" value="1" class="sheet-lockable"/> Enchantment</label>
                    <label class="sheet-lockable"><input type="checkbox" name="attr_mod_prayer" value="1" class="sheet-lockable"/> Prayer</label>
                    <label class="sheet-lockable"><input type="checkbox" name="attr_mod_ward" value="1" class="sheet-lockable"/> Ward</label>
                </div>

                <label>Name:</label>
                <input type="text" name="attr_modifier_name" class="sheet-full-width sheet-lockable"/>

                <div class="sheet-mod-equipment sheet-mod-equipment-kit-only">
                    <div class="sheet-mod-item">
                        <label>Weapon / Implement</label>
                        <input type="text" name="attr_weapon_implement" class="sheet-lockable"/>
                    </div>
                    <div class="sheet-mod-item">
                        <label>Speed</label>
                        <div class="sheet-param-item"><input type="number" name="attr_mod_speed" class="sheet-lockable" value="0"/>
                        </div>
                    </div>
                    <div class="sheet-mod-item">
                        <label>Melee</label>
                        <div class="sheet-param-item"><input type="number" name="attr_mod_melee" class="sheet-lockable" value="0"/>
                        </div>
                    </div>
                    <div class="sheet-mod-item">
                        <label>Ranged</label>
                        <div class="sheet-param-item"><input type="number" name="attr_mod_ranged" class="sheet-lockable" value="0"/>
                        </div>
                    </div>
                </div>

                <div class="sheet-mod-defense sheet-mod-equipment-kit-only">
                    <div class="sheet-mod-item">
                        <label>Armor</label>
                        <input type="text" name="attr_armor" class="sheet-lockable"/>
                    </div>
                    <div class="sheet-mod-item">
                        <label>Disengage</label>
                        <div class="sheet-param-item"><input type="number" name="attr_mod_disengage" class="sheet-lockable" value="0"/>
                        </div>
                    </div>
                    <div class="sheet-mod-item">
                        <label>Stability</label>
                        <div class="sheet-param-item"><input type="number" name="attr_mod_stability" class="sheet-lockable" value="0"/>
                        </div>
                    </div>
                    <div class="sheet-mod-item">
                        <label>Stamina</label>
                        <div class="sheet-param-item"><input type="number" name="attr_mod_stamina" class="sheet-lockable" value="0"/>
                        </div>
                    </div>
                </div>

                <div class="sheet-damage-tables sheet-mod-equipment-kit-only">
                    <div class="sheet-damage-column">
                        <h3>Melee Weapon Damage</h3>
                        <div class="sheet-damage-column-grid">
                            <label>Tier 1</label>
                            <label>Tier 2</label>
                            <label>Tier 3</label>
                            <input type="number" name="attr_melee_damage_11" value="0" class="sheet-lockable"/>
                            <input type="number" name="attr_melee_damage_12_16" value="0" class="sheet-lockable"/>
                            <input type="number" name="attr_melee_damage_17" value="0" class="sheet-lockable"/>
                        </div>
                    </div>

                    <div class="sheet-damage-column">
                        <h3>Ranged Weapon Damage</h3>
                        <div class="sheet-damage-column-grid">
                            <label>Tier 1</label>
                            <label>Tier 2</label>
                            <label>Tier 3</label>
                            <input type="number" name="attr_ranged_damage_11" value="0" class=" sheet-lockable"/>
                            <input type="number" name="attr_ranged_damage_12_16" value="0" class="sheet-lockable"/>
                            <input type="number" name="attr_ranged_damage_17" value="0" class="sheet-lockable"/>
                        </div>
                    </div>
                </div>

                <label>Benefits:</label>
                <textarea name="attr_modifier_benefits" class="sheet-textarea-medium sheet-lockable"></textarea>
            </div>
        </div>

        <div class="sheet-section sheet-notes">
            <h2>Notes</h2>
            <textarea name="attr_notes" class="sheet-textarea-notes" placeholder="Enter your notes here..."></textarea>
        </div>
    </div>

    <div class="sheet-tab-pane sheet-tab2-content">
        <div class="sheet-features-container">
            <div class="sheet-section sheet-classfeatures">
                <h2>Class Features</h2>
                <fieldset class="repeating_classfeatures">
                    <div class="sheet-double-ability-row">
                        <div class="sheet-ability-block">
                            <input type="text" name="attr_classfeature_name" placeholder="Feature Name" class="sheet-ability-name sheet-lockable sheet-hide-when-empty"/>
                            <textarea name="attr_classfeature_desc" placeholder="" class="sheet-textarea-medium sheet-lockable sheet-hide-when-empty"></textarea>
                        </div>
                        <div class="sheet-ability-block">
                            <input type="text" name="attr_classfeature2_name" placeholder="Feature Name" class="sheet-ability-name sheet-lockable sheet-hide-when-empty"/>
                            <textarea name="attr_classfeature2_desc" placeholder="" class="sheet-textarea-medium sheet-lockable sheet-hide-when-empty"></textarea>
                        </div>
                    </div>
                </fieldset>
            </div>

            <div class="sheet-section sheet-ancestrytraits">
                <h2>Ancestry Traits</h2>
                <fieldset class="repeating_ancestrytraits">
                    <div class="sheet-double-ability-row">
                        <div class="sheet-ability-block sheet-hide-when-empty">
                            <input type="text" name="attr_ancestrytrait_name" placeholder="Trait Name" class="sheet-ability-name sheet-lockable sheet-hide-when-empty"/>
                            <textarea name="attr_ancestrytrait_desc" placeholder="" class="sheet-textarea-medium sheet-lockable sheet-hide-when-empty"></textarea>
                        </div>
                        <div class="sheet-ability-block sheet-hide-when-empty">
                            <input type="text" name="attr_ancestrytrait2_name" placeholder="Trait Name" class="sheet-ability-name sheet-lockable sheet-hide-when-empty"/>
                            <textarea name="attr_ancestrytrait2_desc" placeholder="" class="sheet-textarea-medium sheet-lockable sheet-hide-when-empty"></textarea>
                        </div>
                    </div>
                </fieldset>
            </div>

            <div class="sheet-section sheet-perks">
                <h2>Perks</h2>
                <fieldset class="repeating_perks">
                    <div class="sheet-double-ability-row">
                        <div class="sheet-ability-block sheet-hide-when-empty">
                            <input type="text" name="attr_perk_name" placeholder="Perk Name" class="sheet-ability-name sheet-lockable sheet-hide-when-empty"/>
                            <textarea name="attr_perk_desc" placeholder="" class="sheet-textarea-medium sheet-lockable sheet-hide-when-empty"></textarea>
                        </div>
                        <div class="sheet-ability-block sheet-hide-when-empty">
                            <input type="text" name="attr_perk2_name" placeholder="Perk Name" class="sheet-ability-name sheet-lockable sheet-hide-when-empty"/>
                            <textarea name="attr_perk2_desc" placeholder="" class="sheet-textarea-medium sheet-lockable sheet-hide-when-empty"></textarea>
                        </div>
                    </div>
                </fieldset>
            </div>

            <div class="sheet-section sheet-othereffects">
                <h2>Other Effects</h2>
                <fieldset class="repeating_othereffects">
                    <div class="sheet-double-ability-row sheet-hide-when-empty">
                        <div class="sheet-ability-block">
                            <input type="text" name="attr_othereffect_name" placeholder="Effect Name" class="sheet-ability-name sheet-lockable sheet-hide-when-empty"/>
                            <textarea name="attr_othereffect_desc" placeholder="" class="sheet-textarea-medium sheet-lockable sheet-hide-when-empty"></textarea>
                        </div>
                        <div class="sheet-ability-block">
                            <input type="text" name="attr_othereffect2_name" placeholder="Effect Name" class="sheet-ability-name sheet-lockable sheet-hide-when-empty"/>
                            <textarea name="attr_othereffect2_desc" placeholder="" class="sheet-textarea-medium sheet-lockable sheet-hide-when-empty"></textarea>
                        </div>
                    </div>
                </fieldset>
            </div>
        </div>

        <div class="sheet-background-container">
            <div class="sheet-section sheet-career">
                <h2>Career</h2>
                <textarea name="attr_career_details" class="sheet-textarea-large sheet-lockable"></textarea>
            </div>

            <div class="sheet-section sheet-titles">
                <h2>Titles</h2>
                <textarea name="attr_titles" class="sheet-textarea-large sheet-lockable"></textarea>
            </div>

            <div class="sheet-section sheet-complication">
                <h2>Complication</h2>
                <textarea name="attr_complication" class="sheet-textarea-large sheet-lockable"></textarea>
            </div>

            <div class="sheet-section sheet-culture">
                <h2>Culture</h2>
                <div class="sheet-recoveries-grid">
                    <label>Environment:</label><input type="text" name="attr_culture_environment" class="sheet-lockable"/>
                    <label>Organization:</label><input type="text" name="attr_culture_organization" class="sheet-lockable"/>
                    <label>Upbringing:</label><input type="text" name="attr_culture_upbringing" class="sheet-lockable"/>
                    <label>Languages:</label><textarea name="attr_languages" class="sheet-textarea-small sheet-lockable"></textarea>
                </div>
            </div>
        </div>

        <div class="sheet-section sheet-projects">
            <h2>Projects</h2>
            <div class="sheet-project-grid">
                <div class="sheet-project-row">
                    <input type="text" name="attr_project1_name" placeholder="Project Name" class="sheet-project-name"/>
                    <input type="text" name="attr_project1_hero" placeholder="Assigned Hero/Follower" class="sheet-project-hero"/>
                    <input type="text" name="attr_project1_characteristic" placeholder="Roll Characteristic" class="sheet-project-char"/>
                    <input type="number" name="attr_project1_goal" value="0"/>
                    <span>/</span>
                    <input type="number" name="attr_project1_goal_max" value="0"/>
                </div>
                <div class="sheet-project-row">
                    <input type="text" name="attr_project2_name" placeholder="Project Name" class="sheet-project-name"/>
                    <input type="text" name="attr_project2_hero" placeholder="Assigned Hero/Follower" class="sheet-project-hero"/>
                    <input type="text" name="attr_project2_characteristic" placeholder="Roll Characteristic" class="sheet-project-char"/>
                    <input type="number" name="attr_project2_goal" value="0"/>
                    <span>/</span>
                    <input type="number" name="attr_project2_goal_max" value="0"/>
                </div>
                <div class="sheet-project-row">
                    <input type="text" name="attr_project3_name" placeholder="Project Name" class="sheet-project-name"/>
                    <input type="text" name="attr_project3_hero" placeholder="Assigned Hero/Follower" class="sheet-project-hero"/>
                    <input type="text" name="attr_project3_characteristic" placeholder="Roll Characteristic" class="sheet-project-char"/>
                    <input type="number" name="attr_project3_goal" value="0"/>
                    <span>/</span>
                    <input type="number" name="attr_project3_goal_max" value="0"/>
                </div>
                <div class="sheet-project-row">
                    <input type="text" name="attr_project4_name" placeholder="Project Name" class="sheet-project-name"/>
                    <input type="text" name="attr_project4_hero" placeholder="Assigned Hero/Follower" class="sheet-project-hero"/>
                    <input type="text" name="attr_project4_characteristic" placeholder="Roll Characteristic" class="sheet-project-char"/>
                    <input type="number" name="attr_project4_goal" value="0"/>
                    <span>/</span>
                    <input type="number" name="attr_project4_goal_max" value="0"/>
                </div>
                <div class="sheet-project-row">
                    <input type="text" name="attr_project5_name" placeholder="Project Name" class="sheet-project-name"/>
                    <input type="text" name="attr_project5_hero" placeholder="Assigned Hero/Follower" class="sheet-project-hero"/>
                    <input type="text" name="attr_project5_characteristic" placeholder="Roll Characteristic" class="sheet-project-char"/>
                    <input type="number" name="attr_project5_goal" value="0"/>
                    <span>/</span>
                    <input type="number" name="attr_project5_goal_max" value="0"/>
                </div>
            </div>
        </div>
    </div>

    <div class="sheet-tab-pane sheet-tab3-content">
        <div class="sheet-section sheet-abilities">
            <h2>Base Abilities</h2>
            <div class="sheet-base-abilities-grid">
                <div class="sheet-ability-block">
                    <h3>Melee Free Strike</h3>
                    <input type="text" name="attr_melee_free_strike_name" placeholder="Ability Name" class="sheet-ability-name sheet-lockable sheet-hide-when-empty"/>
                    <div class="sheet-ability-grid">
                        <label>Keywords:</label><input type="text" name="attr_melee_free_strike_keywords" value="Charge, Melee, Strike, Weapon" class="sheet-lockable"/>
                        <label>Type:</label><input type="text" name="attr_melee_free_strike_type" value="Main Action" class="sheet-lockable"/>
                        <label>Distance (1+Kit):</label><input type="text" name="attr_melee_free_strike_distance" placeholder="Melee 1" class="sheet-lockable"/>
                        <label>Target:</label><input type="text" name="attr_melee_free_strike_target" value="One Creature or Object" class="sheet-lockable"/>
                        <label>Power Roll +</label>
                        <div class="sheet-power-row">
                            <input type="number" name="attr_melee_free_strike_modifier" placeholder="Mod" class="sheet-lockable"/>
                            <button type="roll" name="roll_melee_free" class="sheet-power-roll-btn" value="&{template:drawsteel} {{title=Power Roll by @{character_name}}} {{subtitle=Melee Free Strike}} {{roll=Power Roll = [[[[2d10]] + @{melee_free_strike_modifier}[Characteristic] + ?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                                Roll
                            </button>
                            <button type="roll" name="roll_melee_free_gm" class="sheet-power-roll-btn sheet-whisper-btn" value="/w gm &{template:drawsteel} {{title=Power Roll by @{character_name}}} \{{subtitle=Melee Free Strike}} {{roll=Power Roll = [[[[2d10]] + @{melee_free_strike_modifier}[Characteristic] + ?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                                GM
                            </button>
                        </div>
                        <label>Tier 1:</label><input type="text" name="attr_melee_free_strike_tier1" placeholder="= 2 + Might or Agility Damage" class="sheet-lockable"/>
                        <label>Tier 2:</label><input type="text" name="attr_melee_free_strike_tier2" placeholder="= 5 + Might or Agility Damage" class="sheet-lockable"/>
                        <label>Tier 3:</label><input type="text" name="attr_melee_free_strike_tier3" placeholder="= 7 + Might or Agility Damage" class="sheet-lockable"/>
                    </div>
                    <textarea name="attr_melee_free_strike_effect" placeholder="Effect" class="sheet-textarea-small sheet-lockable sheet-hide-when-empty"></textarea>
                </div>

                <div class="sheet-ability-block">
                    <h3>Ranged Free Strike</h3>
                    <input type="text" name="attr_ranged_free_strike_name" placeholder="Ability Name" class="sheet-ability-name sheet-lockable sheet-hide-when-empty"/>
                    <div class="sheet-ability-grid">
                        <label>Keywords:</label><input type="text" name="attr_ranged_free_strike_keywords" value="Ranged, Strike, Weapon" class="sheet-lockable"/>
                        <label>Type:</label><input type="text" name="attr_ranged_free_strike_type" value="Main Action" class="sheet-lockable"/>
                        <label>Distance (5+Kit):</label><input type="text" name="attr_ranged_free_strike_distance" placeholder="Ranged 5" class="sheet-lockable"/>
                        <label>Target:</label><input type="text" name="attr_ranged_free_strike_target" value="One Creature or Object" class="sheet-lockable"/>
                        <label>Power Roll +</label>
                        <div class="sheet-power-row">
                            <input type="number" name="attr_ranged_free_strike_modifier" placeholder="Mod" class="sheet-lockable"/>
                            <button type="roll" name="roll_ranged_free" class="sheet-power-roll-btn" value="&{template:drawsteel} {{title=Power Roll by @{character_name}}} {{subtitle=Ranged Free Strike}} {{roll=Power Roll = [[[[2d10]] + @{ranged_free_strike_modifier}[Characteristic] + ?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                                Roll
                            </button>
                            <button type="roll" name="roll_ranged_free_gm" class="sheet-power-roll-btn sheet-whisper-btn" value="/w gm &{template:drawsteel} {{title=Power Roll by @{character_name}}} {{subtitle=Ranged Free Strike}} {{roll=Power Roll = [[[[2d10]] + @{ranged_free_strike_modifier}[Characteristic] + ?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                                GM
                            </button>
                        </div>
                        <label>Tier 1:</label><input type="text" name="attr_ranged_free_strike_tier1" placeholder="= 2 + Might or Agility Damage" class="sheet-lockable"/>
                        <label>Tier 2:</label><input type="text" name="attr_ranged_free_strike_tier2" placeholder="= 4 + Might or Agility Damage" class="sheet-lockable"/>
                        <label>Tier 3:</label><input type="text" name="attr_ranged_free_strike_tier3" placeholder="= 6 + Might or Agility Damage" class="sheet-lockable"/>
                    </div>
                    <textarea name="attr_ranged_free_strike_effect" placeholder="Effect" class="sheet-textarea-small sheet-lockable sheet-hide-when-empty"></textarea>
                </div>

                <div class="sheet-ability-block">
                    <h3>Signature Ability 1</h3>
                    <input type="text" name="attr_signature1_name" placeholder="Ability Name" class="sheet-ability-name sheet-lockable"/>
                    <div class="sheet-ability-grid">
                        <label>Keywords:</label><input type="text" name="attr_signature1_keywords" placeholder="Keywords" class="sheet-lockable"/>
                        <label>Type:</label><input type="text" name="attr_signature1_type" placeholder="Main Action" class="sheet-lockable"/>
                        <label>Distance (5+Kit):</label><input type="text" name="attr_signature1_distance" placeholder="Distance" class="sheet-lockable"/>
                        <label>Target:</label><input type="text" name="attr_signature1_target" placeholder="Target" class="sheet-lockable"/>
                        <label>Power Roll +</label>
                        <div class="sheet-power-row">
                            <input type="number" name="attr_signature1_modifier" placeholder="Mod" class="sheet-lockable"/>
                            <button type="roll" name="roll_a1_signature" class="sheet-power-roll-btn" value="&{template:drawsteel} {{title=Power Roll by @{character_name}}} {{subtitle=@{signature1_name}}} {{roll=Power Roll = [[[[2d10]] + @{signature1_modifier}[Characteristic] + ?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                                Roll
                            </button>
                            <button type="roll" name="roll_a1_signature_gm" class="sheet-power-roll-btn sheet-whisper-btn" value="/w gm &{template:drawsteel} {{title=Power Roll by @{character_name}}} {{subtitle=@{signature1_name}}} {{roll=Power Roll = [[[[2d10]] + @{signature1_modifier}[Characteristic] + ?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                                GM
                            </button>
                        </div>
                        <label>Tier 1:</label><input type="text" name="attr_signature1_tier1" placeholder="Tier 1 Effect" class="sheet-lockable"/>
                        <label>Tier 2:</label><input type="text" name="attr_signature1_tier2" placeholder="Tier 2 Effect" class="sheet-lockable"/>
                        <label>Tier 3:</label><input type="text" name="attr_signature1_tier3" placeholder="Tier 3 Effect" class="sheet-lockable"/>
                    </div>
                    <textarea name="attr_signature1_effect" placeholder="Effect" class="sheet-textarea-small sheet-lockable sheet-hide-when-empty"></textarea>
                </div>

                <div class="sheet-ability-block">
                    <h3>Signature Ability 2</h3>
                    <input type="text" name="attr_signature2_name" placeholder="Ability Name" class="sheet-ability-name sheet-lockable"/>
                    <div class="sheet-ability-grid">
                        <label>Keywords:</label><input type="text" name="attr_signature2_keywords" placeholder="Keywords" class="sheet-lockable"/>
                        <label>Type:</label><input type="text" name="attr_signature2_type" placeholder="Main Action" class="sheet-lockable"/>
                        <label>Distance (5+Kit):</label><input type="text" name="attr_signature2_distance" placeholder="Distance" class="sheet-lockable"/>
                        <label>Target:</label><input type="text" name="attr_signature2_target" placeholder="Target" class="sheet-lockable"/>
                        <label>Power Roll +</label>
                        <div class="sheet-power-row">
                            <input type="number" name="attr_signature2_modifier" placeholder="Mod" class="sheet-lockable"/>
                            <button type="roll" name="roll_a2_signature" class="sheet-power-roll-btn" value="&{template:drawsteel} {{title=Power Roll by @{character_name}}} {{subtitle=@{signature2_name}}} {{roll=Power Roll = [[[[2d10]] + @{signature2_modifier}[Characteristic] + ?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                                Roll
                            </button>
                            <button type="roll" name="roll_a2_signature_gm" class="sheet-power-roll-btn sheet-whisper-btn" value="/w gm &{template:drawsteel} {{title=Power Roll by @{character_name}}} {{subtitle=@{signature2_name}}} {{roll=Power Roll = [[[[2d10]] + @{signature2_modifier}[Characteristic] + ?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                                GM
                            </button>
                        </div>
                        <label>Tier 1:</label><input type="text" name="attr_signature2_tier1" placeholder="Tier 1 Effect" class="sheet-lockable"/>
                        <label>Tier 2:</label><input type="text" name="attr_signature2_tier2" placeholder="Tier 2 Effect" class="sheet-lockable"/>
                        <label>Tier 3:</label><input type="text" name="attr_signature2_tier3" placeholder="Tier 3 Effect" class="sheet-lockable"/>
                    </div>
                    <textarea name="attr_signature2_effect" placeholder="Effect" class="sheet-textarea-small sheet-lockable sheet-hide-when-empty"></textarea>
                </div>
            </div>
        </div>

        <div class="sheet-repeating-abilities-container">
            <div class="sheet-section sheet-repeating-abilities">
                <h2>Abilities</h2>
                <fieldset class="repeating_abilities">
                    <div class="sheet-double-ability-row">
                        <div class="sheet-ability-block">
                            <input type="text" name="attr_ability1_name" placeholder="Ability Name" class="sheet-ability-name sheet-lockable sheet-hide-when-empty"/>
                            <div class="sheet-ability-grid">
                                <label class="sheet-hide-when-empty">Keywords:</label><input type="text" name="attr_ability1_keywords" placeholder="Keywords" class="sheet-lockable sheet-hide-when-empty"/>
                                <label class="sheet-hide-when-empty">Type:</label><input type="text" name="attr_ability1_type" placeholder="Main Action" class="sheet-lockable sheet-hide-when-empty"/>
                                <label class="sheet-hide-when-empty">Distance:</label><input type="text" name="attr_ability1_distance" placeholder="Distance" class="sheet-lockable sheet-hide-when-empty"/>
                                <label class="sheet-hide-when-empty">Target:</label><input type="text" name="attr_ability1_target" placeholder="Target" class="sheet-lockable sheet-hide-when-empty"/>
                                <label class="sheet-hide-when-empty">Power Roll +</label>
                                <div class="sheet-power-row">
                                    <input type="number" name="attr_ability1_modifier" placeholder="Mod" class="sheet-lockable sheet-hide-when-empty"/>
                                    <button type="roll" name="roll_a1_power" class="sheet-power-roll-btn" value="&{template:drawsteel} {{title=Power Roll by @{character_name}}} {{subtitle=@{ability1_name}}} {{roll=Power Roll = [[[[2d10]] + @{ability1_modifier}[Characteristic] + ?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                                        Roll
                                    </button>
                                    <button type="roll" name="roll_a1_power_gm" class="sheet-power-roll-btn sheet-whisper-btn" value="/w gm &{template:drawsteel}{{title=Power Roll by @{character_name}}} {{subtitle=@{ability1_name}}} {{roll=Power Roll = [[[[2d10]] + @{ability1_modifier}[Characteristic] + ?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                                        GM
                                    </button>
                                </div>
                                <label class="sheet-hide-when-empty">Tier 1:</label><input type="text" name="attr_ability1_tier1" placeholder="Tier 1 Effect" class="sheet-lockable sheet-hide-when-empty"/>
                                <label class="sheet-hide-when-empty">Tier 2:</label><input type="text" name="attr_ability1_tier2" placeholder="Tier 2 Effect" class="sheet-lockable sheet-hide-when-empty"/>
                                <label class="sheet-hide-when-empty">Tier 3:</label><input type="text" name="attr_ability1_tier3" placeholder="Tier 3 Effect" class="sheet-lockable sheet-hide-when-empty"/>
                            </div>
                            <textarea name="attr_ability1_effect" placeholder="Effect" class="sheet-textarea-small sheet-lockable sheet-hide-when-empty"></textarea>
                        </div>

                        <div class="sheet-ability-block">
                            <input type="text" name="attr_ability2_name" placeholder="Ability Name" class="sheet-ability-name sheet-lockable sheet-hide-when-empty"/>
                            <div class="sheet-ability-grid">
                                <label class="sheet-hide-when-empty">Keywords:</label><input type="text" name="attr_ability2_keywords" placeholder="Keywords" class="sheet-lockable sheet-hide-when-empty"/>
                                <label class="sheet-hide-when-empty">Type:</label><input type="text" name="attr_ability2_type" placeholder="Main Action" class="sheet-lockable sheet-hide-when-empty"/>
                                <label class="sheet-hide-when-empty">Distance:</label><input type="text" name="attr_ability2_distance" placeholder="Distance" class="sheet-lockable sheet-hide-when-empty"/>
                                <label class="sheet-hide-when-empty">Target:</label><input type="text" name="attr_ability2_target" placeholder="Target" class="sheet-lockable sheet-hide-when-empty"/>
                                <label class="sheet-hide-when-empty">Power Roll +</label>
                                <div class="sheet-power-row">
                                    <input type="number" name="attr_ability2_modifier" placeholder="Mod" class="sheet-lockable sheet-hide-when-empty"/>
                                    <button type="roll" name="roll_a2_power" class="sheet-power-roll-btn" value="&{template:drawsteel} {{title=Power Roll by @{character_name}}} {{subtitle=@{ability2_name}}} {{roll=Power Roll = [[[[2d10]] + @{ability2_modifier}[Characteristic] + ?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                                        Roll
                                    </button>
                                    <button type="roll" name="roll_a2_power_gm" class="sheet-power-roll-btn sheet-whisper-btn" value="/w gm &{template:drawsteel} {{title=Power Roll by @{character_name}}} {{subtitle=@{ability2_name}}} {{roll=Power Roll = [[[[2d10]] + @{ability2_modifier}[Characteristic] + ?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                                        GM
                                    </button>
                                </div>
                                <label class="sheet-hide-when-empty">Tier 1:</label><input type="text" name="attr_ability2_tier1" placeholder="Tier 1 Effect" class="sheet-lockable sheet-hide-when-empty"/>
                                <label class="sheet-hide-when-empty">Tier 2:</label><input type="text" name="attr_ability2_tier2" placeholder="Tier 2 Effect" class="sheet-lockable sheet-hide-when-empty"/>
                                <label class="sheet-hide-when-empty">Tier 3:</label><input type="text" name="attr_ability2_tier3" placeholder="Tier 3 Effect" class="sheet-lockable sheet-hide-when-empty"/>
                            </div>
                            <textarea name="attr_ability2_effect" placeholder="Effect" class="sheet-textarea-small sheet-lockable sheet-hide-when-empty"></textarea>
                        </div>
                    </div>
                </fieldset>
            </div>

            <div class="sheet-section sheet-repeating-heroic-abilities">
                <h2>Heroic Abilities</h2>
                <fieldset class="repeating_heroic">
                    <div class="sheet-double-ability-row">
                        <div class="sheet-ability-block">
                            <input type="text" name="attr_heroic1_name" placeholder="Heroic Ability Name" class="sheet-ability-name sheet-lockable sheet-hide-when-empty"/>
                            <div class="sheet-ability-grid">
                                <label>Cost:</label>
                                <div class="sheet-heroic-cost-row">
                                    <input type="number" name="attr_heroic1_cost" placeholder="3" min="0" class="sheet-lockable"/>
                                    <label>from</label>
                                    <span name="attr_heroic_resource_copy" class="sheet-heroic-current"></span>
                                    <button type="action" name="act_spend1" class="sheet-heroic-spend-btn">Spend</button>
                                </div>
                                <label class="sheet-hide-when-empty">Keywords:</label><input type="text" name="attr_heroic1_keywords" placeholder="Keywords" class="sheet-lockable sheet-hide-when-empty"/>
                                <label class="sheet-hide-when-empty">Type:</label><input type="text" name="attr_heroic1_type" placeholder="Main Action" class="sheet-lockable sheet-hide-when-empty"/>
                                <label class="sheet-hide-when-empty">Distance:</label><input type="text" name="attr_heroic1_distance" placeholder="Distance" class="sheet-lockable sheet-hide-when-empty"/>
                                <label class="sheet-hide-when-empty">Target:</label><input type="text" name="attr_heroic1_target" placeholder="Target" class="sheet-lockable sheet-hide-when-empty"/>
                                <label class="sheet-hide-when-empty">Power Roll +</label>
                                <div class="sheet-power-row">
                                    <input type="number" name="attr_heroic1_modifier" placeholder="Mod" class="sheet-lockable sheet-hide-when-empty"/>
                                    <button type="roll" name="roll_h1_power" class="sheet-power-roll-btn" value="&{template:drawsteel} {{title=Power Roll by @{character_name}}} {{subtitle=@{heroic1_name}}} {{roll=Power Roll = [[[[2d10]]+@{heroic1_modifier}[Characteristic]+?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                                        Roll
                                    </button>
                                    <button type="roll" name="roll_h1_power_gm" class="sheet-power-roll-btn sheet-whisper-btn" value="/w gm &{template:drawsteel}{{title=Power Roll by @{character_name}}} {{subtitle=@{heroic1_name}}} {{roll=Power Roll = [[[[2d10]]+@{heroic1_modifier}[Characteristic]+?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                                        GM
                                    </button>
                                </div>
                                <label class="sheet-hide-when-empty">Tier 1:</label><input type="text" name="attr_heroic1_tier1" placeholder="Tier 1 Effect" class="sheet-lockable sheet-hide-when-empty"/>
                                <label class="sheet-hide-when-empty">Tier 2:</label><input type="text" name="attr_heroic1_tier2" placeholder="Tier 2 Effect" class="sheet-lockable sheet-hide-when-empty"/>
                                <label class="sheet-hide-when-empty">Tier 3:</label><input type="text" name="attr_heroic1_tier3" placeholder="Tier 3 Effect" class="sheet-lockable sheet-hide-when-empty"/>
                            </div>
                            <textarea name="attr_heroic1_effect" placeholder="Effect" class="sheet-textarea-small sheet-lockable sheet-hide-when-empty"></textarea>
                        </div>

                        <div class="sheet-ability-block">
                            <input type="text" name="attr_heroic2_name" placeholder="Heroic Ability Name" class="sheet-ability-name sheet-lockable sheet-hide-when-empty"/>
                            <div class="sheet-ability-grid">
                                <label>Cost:</label>
                                <div class="sheet-heroic-cost-row">
                                    <input type="number" name="attr_heroic2_cost" placeholder="5" min="0" class="sheet-lockable"/>
                                    <label>from</label>
                                    <span name="attr_heroic_resource_copy" class="sheet-heroic-current"></span>
                                    <button type="action" name="act_spend2" class="sheet-heroic-spend-btn">Spend</button>
                                </div>
                                <label class="sheet-hide-when-empty">Keywords:</label><input type="text" name="attr_heroic2_keywords" placeholder="Keywords" class="sheet-lockable sheet-hide-when-empty"/>
                                <label class="sheet-hide-when-empty">Type:</label><input type="text" name="attr_heroic2_type" placeholder="Main Action" class="sheet-lockable sheet-hide-when-empty"/>
                                <label class="sheet-hide-when-empty">Distance:</label><input type="text" name="attr_heroic2_distance" placeholder="Distance" class="sheet-lockable sheet-hide-when-empty"/>
                                <label class="sheet-hide-when-empty">Target:</label><input type="text" name="attr_heroic2_target" placeholder="Target" class="sheet-lockable sheet-hide-when-empty"/>
                                <label class="sheet-hide-when-empty">Power Roll +</label>
                                <div class="sheet-power-row">
                                    <input type="number" name="attr_heroic2_modifier" placeholder="Mod" class="sheet-lockable sheet-hide-when-empty"/>
                                    <button type="roll" name="roll_h2_power" class="sheet-power-roll-btn" value="&{template:drawsteel} {{title=Power Roll by @{character_name}}} {{subtitle=@{heroic2_name}}} {{roll=Power Roll = [[[[2d10]]+@{heroic2_modifier}[Characteristic]+?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                                        Roll
                                    </button>
                                    <button type="roll" name="roll_h2_power_gm" class="sheet-power-roll-btn sheet-whisper-btn" value="/w gm &{template:drawsteel}{{title=Power Roll by @{character_name}}} {{subtitle=@{heroic2_name}}} {{roll=Power Roll = [[[[2d10]]+@{heroic2_modifier}[Characteristic]+?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                                        GM
                                    </button>
                                </div>
                                <label class="sheet-hide-when-empty">Tier 1:</label><input type="text" name="attr_heroic2_tier1" placeholder="Tier 1 Effect" class="sheet-lockable sheet-hide-when-empty"/>
                                <label class="sheet-hide-when-empty">Tier 2:</label><input type="text" name="attr_heroic2_tier2" placeholder="Tier 2 Effect" class="sheet-lockable sheet-hide-when-empty"/>
                                <label class="sheet-hide-when-empty">Tier 3:</label><input type="text" name="attr_heroic2_tier3" placeholder="Tier 3 Effect" class="sheet-lockable sheet-hide-when-empty"/>
                            </div>
                            <textarea name="attr_heroic2_effect" placeholder="Effect" class="sheet-textarea-small sheet-lockable sheet-hide-when-empty"></textarea>
                        </div>
                    </div>
                </fieldset>
            </div>
        </div>

        <div class="sheet-section sheet-repeating_triggered">
            <h2>Triggered Actions</h2>
            <fieldset class="repeating_triggered">
                <div class="sheet-double-ability-row">
                    <div class="sheet-ability-block">
                        <input type="text" name="attr_triggered1_name" placeholder="Triggered Action Name" class="sheet-ability-name sheet-lockable sheet-hide-when-empty"/>
                        <div class="sheet-ability-grid">
                            <label class="sheet-hide-when-empty">Keywords:</label><input type="text" name="attr_triggered1_keywords" placeholder="Keywords" class="sheet-lockable sheet-hide-when-empty"/>
                            <label class="sheet-hide-when-empty">Type:</label><input type="text" name="attr_triggered1_type" placeholder="Triggered" class="sheet-lockable sheet-hide-when-empty"/>
                            <label class="sheet-hide-when-empty">Distance:</label><input type="text" name="attr_triggered1_distance" placeholder="Distance" class="sheet-lockable sheet-hide-when-empty"/>
                            <label class="sheet-hide-when-empty">Target:</label><input type="text" name="attr_triggered1_target" placeholder="Target" class="sheet-lockable sheet-hide-when-empty"/>
                        </div>
                        <textarea name="attr_triggered1_trigger" placeholder="Trigger" class="sheet-textarea-small sheet-lockable sheet-hide-when-empty"></textarea>
                        <textarea name="attr_triggered1_effect" placeholder="Effect" class="sheet-textarea-small sheet-lockable sheet-hide-when-empty"></textarea>
                    </div>

                    <div class="sheet-ability-block">
                        <input type="text" name="attr_triggered2_name" placeholder="Triggered Action Name" class="sheet-ability-name sheet-lockable sheet-hide-when-empty"/>
                        <div class="sheet-ability-grid">
                            <label class="sheet-hide-when-empty">Keywords:</label><input type="text" name="attr_triggered2_keywords" placeholder="Keywords" class="sheet-lockable sheet-hide-when-empty"/>
                            <label class="sheet-hide-when-empty">Type:</label><input type="text" name="attr_triggered2_type" placeholder="Triggered" class="sheet-lockable sheet-hide-when-empty"/>
                            <label class="sheet-hide-when-empty">Distance:</label><input type="text" name="attr_triggered2_distance" placeholder="Distance" class="sheet-lockable sheet-hide-when-empty"/>
                            <label class="sheet-hide-when-empty">Target:</label><input type="text" name="attr_triggered2_target" placeholder="Target" class="sheet-lockable sheet-hide-when-empty"/>
                        </div>
                        <textarea name="attr_triggered2_trigger" placeholder="Trigger" class="sheet-textarea-small sheet-lockable sheet-hide-when-empty"></textarea>
                        <textarea name="attr_triggered2_effect" placeholder="Effect" class="sheet-textarea-small sheet-lockable sheet-hide-when-empty"></textarea>
                    </div>
                </div>
            </fieldset>
        </div>
    </div>
</div>

<div class="sheet-party-view">
    <div class="sheet-section sheet-team-info">
        <h2>Team</h2>

        <div class="sheet-team-name-row">
            <label>Team Name:</label>
            <input type="text" name="attr_character_name" class="sheet-lockable sheet-team-name-input"/>
        </div>

        <div class="sheet-team-resources">
            <div class="sheet-hero-tokens">
                <h3>Hero Tokens</h3>
                <div class="sheet-hero-token-counter">
                    <div class="sheet-param-item">
                        <input type="number" name="attr_hero_tokens" value="0" min="0"/>
                    </div>
                </div>
                <div class="sheet-hero-token-actions">
                    <button type="action" name="act_hero_tokens_gain">Add</button>
                    <button type="action" name="act_hero_tokens_spend">Spend</button>
                    <button type="action" name="act_hero_tokens_clear">Clear</button>
                </div>
            </div>

            <div class="sheet-team-reputation">
                <h3>Team Reputation</h3>
                <div class="sheet-reputation-boxes">
                    <input type="checkbox" name="attr_team_rep_1" value="1"/>
                    <input type="checkbox" name="attr_team_rep_2" value="1"/>
                    <input type="checkbox" name="attr_team_rep_3" value="1"/>
                    <input type="checkbox" name="attr_team_rep_4" value="1"/>
                    <input type="checkbox" name="attr_team_rep_5" value="1"/>
                </div>
            </div>
        </div>
    </div>

    <div class="sheet-section sheet-faction-relations">
        <h2>Faction Relations</h2>
        <fieldset class="repeating_factions">
            <div class="sheet-faction-item">
                <div class="sheet-faction-header">
                    <input type="text" name="attr_faction_name" placeholder="Faction Name" class="sheet-faction-name sheet-lockable"/>
                    <select name="attr_faction_reputation" class="sheet-faction-rep sheet-lockable">
                        <option value="3">+3: Allies</option>
                        <option value="2">+2: Friendly</option>
                        <option value="1">+1: Helpful</option>
                        <option value="0" selected>0: Neutral</option>
                        <option value="-1">-1: Interfering</option>
                        <option value="-2">-2: Hostile</option>
                        <option value="-3">-3: War</option>
                    </select>
                </div>
                <textarea name="attr_faction_notes" placeholder="Notes about this faction..." class="sheet-faction-notes sheet-lockable"></textarea>
            </div>
        </fieldset>
    </div>

    <div class="sheet-section sheet-team-notes">
        <h2>Team Notes</h2>
        <textarea name="attr_team_notes" class="sheet-textarea-notes" placeholder="Enter team notes here..."></textarea>
    </div>
</div>

<input type="checkbox" id="minion-block-visible" name="attr_minion_block_visible" value="1" style="display: none;"/>
<div class="sheet-monster-view">
    <div class="sheet-monster-main-container">
        <div class="sheet-section sheet-monster-info">
            <h2>Monster Information</h2>
            <div class="sheet-monster-info-grid">
                <div class="sheet-monster-basic">
                    <label>Name:</label>
                    <input type="text" name="attr_character_name" class="sheet-monster-information-element sheet-lockable"/>

                    <label>Level:</label>
                    <input type="number" name="attr_monster_level" value="1" min="0" class=" sheet-monster-information-element sheet-lockable"/>

                    <label>EV:</label>
                    <input type="number" name="attr_encounter_value" value="0" min="0" class="sheet-monster-information-element sheet-lockable"/>
                </div>

                <div class="sheet-monster-role">
                    <label>Role Type:</label>
                    <select name="attr_role_type" class="sheet-monster-information-element sheet-lockable">
                        <option value="None">None</option>
                        <option value="Ambusher">Ambusher</option>
                        <option value="Artillery">Artillery</option>
                        <option value="Brute">Brute</option>
                        <option value="Controller">Controller</option>
                        <option value="Defender">Defender</option>
                        <option value="Harrier">Harrier</option>
                        <option value="Hexer">Hexer</option>
                        <option value="Mount">Mount</option>
                        <option value="Support">Support</option>
                    </select>

                    <label>Organization:</label>
                    <select name="attr_organization" class="sheet-monster-information-element sheet-lockable">
                        <option value="Minion">Minion</option>
                        <option value="Horde">Horde</option>
                        <option value="Platoon">Platoon</option>
                        <option value="Elite">Elite</option>
                        <option value="Leader">Leader</option>
                        <option value="Solo">Solo</option>
                    </select>

                    <label>Keywords:</label>
                    <input type="text" name="attr_monster_keywords" placeholder="Undead" class="sheet-monster-information-element sheet-lockable"/>
                </div>
            </div>
        </div>

        <div class="sheet-section sheet-monster-characteristics">
            <h2>Characteristics</h2>
            <div class="sheet-char-grid">
                <div class="sheet-char-item">
                    <label>Might</label>
                    <input type="number" name="attr_monster_might" value="0" class="sheet-lockable"/>
                    <div class="sheet-button-group">
                        <button type="roll" name="roll_monster_might" value="&{template:drawsteel} {{title=Power Roll by @{character_name}}} {{subtitle=Monster Power Roll}} {{roll=Power Roll = [[[[2d10]]+@{monster_might}[Characteristic]+?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                            Roll
                        </button>
                        <button class="sheet-whisper-btn" type="roll" name="roll_monster_might_whisper" value="/w gm &{template:drawsteel} {{title=Power Roll by @{character_name}}} {{subtitle=Might}} {{roll=Power Roll = [[[[2d10]]+@{monster_might}[Might]+?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                            GM
                        </button>
                    </div>
                </div>

                <div class="sheet-char-item">
                    <label>Agility</label>
                    <input type="number" name="attr_monster_agility" value="0" class="sheet-lockable"/>
                    <div class="sheet-button-group">
                        <button type="roll" name="roll_monster_agility" value="&{template:drawsteel} {{title=Power Roll by @{character_name}}}                        {{subtitle=Monster Power Roll}} {{roll=Power Roll = [[[[2d10]]+@{monster_agility}[Characteristic]+?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                            Roll
                        </button>
                        <button class="sheet-whisper-btn" type="roll" name="roll_monster_agility_whisper" value="/w gm &{template:drawsteel} {{title=Power Roll by @{character_name}}} {{subtitle=Agility}} {{roll=Power Roll = [[[[2d10]]+@{monster_agility}[Agility]+?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                            GM
                        </button>
                    </div>
                </div>

                <div class="sheet-char-item">
                    <label>Reason</label>
                    <input type="number" name="attr_monster_reason" value="0" class="sheet-lockable"/>
                    <div class="sheet-button-group">
                        <button type="roll" name="roll_monster_reason" value="&{template:drawsteel} {{title=Power Roll by @{character_name}}} {{subtitle=Monster Power Roll}} {{roll=Power Roll = [[[[2d10]]+@{monster_reason}[Characteristic]+?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                            Roll
                        </button>
                        <button class="sheet-whisper-btn" type="roll" name="roll_monster_reason_whisper" value="/w gm &{template:drawsteel} {{title=Power Roll by @{character_name}}} {{subtitle=Reason}} {{roll=Power Roll = [[[[2d10]]+@{monster_reason}[Reason]+?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                            GM
                        </button>
                    </div>
                </div>

                <div class="sheet-char-item">
                    <label>Intuition</label>
                    <input type="number" name="attr_monster_intuition" value="0" class="sheet-lockable"/>
                    <div class="sheet-button-group">
                        <button type="roll" name="roll_monster_intuition" value="&{template:drawsteel}{{title=Power Roll by @{character_name}}} {{subtitle=Monster Power Roll}} {{roll=Power Roll = [[[[2d10]]+@{monster_intuition}[Characteristic]+?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                            Roll
                        </button>
                        <button class="sheet-whisper-btn" type="roll" name="roll_monster_intuition_whisper" value="/w gm &{template:drawsteel} {{title=Power Roll by @{character_name}}} {{subtitle=Intuition}} {{roll=Power Roll = [[[[2d10]]+@{monster_intuition}[Intuition]+?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                            GM
                        </button>
                    </div>
                </div>

                <div class="sheet-char-item">
                    <label>Presence</label>
                    <input type="number" name="attr_monster_presence" value="0" class="sheet-lockable"/>
                    <div class="sheet-button-group">
                        <button type="roll" name="roll_monster_presence" value="&{template:drawsteel}{{title=Power Roll by @{character_name}}} {{subtitle=Monster Power Roll}} {{roll=Power Roll = [[[[2d10]]+@{monster_presence}[Characteristic]+?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                            Roll
                        </button>
                        <button class="sheet-whisper-btn" type="roll" name="roll_monster_presence_whisper" value="/w gm &{template:drawsteel} {{title=Power Roll by @{character_name}}} {{subtitle=Presence}} {{roll=Power Roll = [[[[2d10]]+@{monster_presence}[Presence]+?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                            GM
                        </button>
                    </div>
                </div>
            </div>

            <div class="sheet-char-other-rolls-grid">
                <div class="sheet-roll-option">
                    <span class="sheet-roll-label">d10</span>
                    <div class="sheet-button-group">
                        <button class="sheet-d10-dice" type="roll" name="roll_monster_d10" value="&{template:drawsteel}{{title=Simple Roll by @{character_name}}} {{roll=Roll d10 = [[[[1d10]]+?{Modifier|0}]]}} {{raw=Raw = $[[0]]}}">
                            Roll
                        </button>
                        <button class="sheet-whisper-btn" type="roll" name="roll_monster_d10_whisper" value="/w gm &{template:drawsteel} {{title=Simple Roll by @{character_name}}} {{roll=Roll d10 = [[[[1d10]]+?{Modifier|0}]]}} {{raw=Raw = $[[0]]}}">
                            GM
                        </button>
                    </div>
                </div>

                <div class="sheet-roll-option">
                    <span class="sheet-roll-label">2d6</span>
                    <div class="sheet-button-group">
                        <button class="sheet-2d6-dice" type="roll" name="roll_monster_2d6" value="&{template:drawsteel}{{title=Simple Roll by @{character_name}}} {{roll=Roll 2d6 = [[[[2d6]]+?{Modifier|0}]]}} {{raw=Raw = $[[0]]}}">
                            Roll
                        </button>
                        <button class="sheet-whisper-btn" type="roll" name="roll_monster_2d6_whisper" value="/w gm &{template:drawsteel}{{title=Simple Roll by @{character_name}}} {{roll=Roll 2d6 = [[[[2d6]]+?{Modifier|0}]]}} {{raw=Raw = $[[0]]}}">
                            GM
                        </button>
                    </div>
                </div>

                <div class="sheet-roll-option">
                    <span class="sheet-roll-label">d6</span>
                    <div class="sheet-button-group">
                        <button class="sheet-d6-dice" type="roll" name="roll_monster_d6" value="&{template:drawsteel} {{title=Simple Roll by @{character_name}}} {{roll=Roll d6 = [[[[1d6]]+?{Modifier|0}]]}} {{raw=Raw = $[[0]]}}">
                            Roll
                        </button>
                        <button class="sheet-whisper-btn" type="roll" name="roll_monster_d6_whisper" value="/w gm &{template:drawsteel}{{title=Simple Roll by @{character_name}}} {{roll=Roll d6 = [[[[1d6]]+?{Modifier|0}]]}} {{raw=Raw = $[[0]]}}">
                            GM
                        </button>
                    </div>
                </div>

                <div class="sheet-roll-option">
                    <span class="sheet-roll-label">d3</span>
                    <div class="sheet-button-group">
                        <button class="sheet-d3-dice" type="roll" name="roll_monster_d3" value="&{template:drawsteel} {{title=Simple Roll by @{character_name}}} {{roll=Roll d3 = [[[[1d3]]+?{Modifier|0}]]}} {{raw=Raw = $[[0]]}}">
                            Roll
                        </button>
                        <button class="sheet-whisper-btn" type="roll" name="roll_monster_d3_whisper" value="/w gm &{template:drawsteel}{{title=Simple Roll by @{character_name}}} {{roll=Roll d3 = [[[[1d3]]+?{Modifier|0}]]}} {{raw=Raw = $[[0]]}}">
                            GM
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="sheet-monster-stats-container">
            <div class="sheet-section sheet-monster-combat">
                <h2>Combat Stats</h2>
                <div class="sheet-monster-combat-grid">
                    <div class="sheet-combat-stat">
                        <label>Size:</label>
                        <select name="attr_size" class="sheet-lockable">
                            <option value="1T">1T</option>
                            <option value="1S">1S</option>
                            <option value="1M" selected>1M</option>
                            <option value="1L"> 1L</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                        </select>
                    </div>

                    <div class="sheet-combat-stat">
                        <label>Speed:</label>
                        <input type="number" name="attr_speed" value="5" min="0" class="sheet-lockable"/>
                    </div>

                    <div class="sheet-combat-stat">
                        <label>Movement:</label>
                        <input type="text" name="attr_monster_movement" placeholder="Fly" class="sheet-lockable"/>
                    </div>

                    <div class="sheet-combat-stat">
                        <label>Max Stamina:</label>
                        <input type="number" name="attr_stamina_max" value="0" min="0" class="sheet-lockable"/>
                    </div>

                    <div class="sheet-combat-stat">
                        <label>Stability:</label>
                        <input type="number" name="attr_stability" value="0" min="0" class="sheet-lockable"/>
                    </div>

                    <div class="sheet-combat-stat">
                        <label>Free Strike:</label>
                        <input type="number" name="attr_monster_free_strike" value="0" min="0" class="sheet-lockable"/>
                    </div>
                </div>

                <div class="sheet-monster-minion-block">
                    <label>With Captain Bonus:</label>
                    <input type="text" name="attr_with_captain" placeholder="+5 bonus to ranged distance" class="sheet-lockable sheet-full-width"/>
                </div>
            </div>

            <div class="sheet-section sheet-damage-types">
                <h2>Immunity & Weakness</h2>
                <fieldset class="repeating_damagetypes">
                    <div class="sheet-damage-type-row">
                        <input type="text" name="attr_damage_type" placeholder="Fire" class="sheet-damage-type-input sheet-lockable"/>
                        <input type="number" name="attr_damage_value" value="0" class="sheet-damage-value-input sheet-lockable"/>
                    </div>
                </fieldset>
            </div>
        </div>

        <div class="sheet-section sheet-monster-abilities">
            <h2>Abilities</h2>
            <fieldset class="repeating_monsterabilities">
                <div class="sheet-double-ability-row">
                    <div class="sheet-ability-block">
                        <input type="text" name="attr_ability1_name" placeholder="Ability Name" class="sheet-ability-name sheet-lockable sheet-hide-when-empty"/>

                        <div class="sheet-ability-grid">
                            <label class="sheet-hide-when-empty">Type:</label>
                            <input type="text" name="attr_ability1_type" placeholder="Main Action" class="sheet-lockable sheet-hide-when-empty"/>

                            <label class="sheet-hide-when-empty">Keywords:</label>
                            <input type="text" name="attr_ability1_keywords" placeholder="Melee, Strike, Weapon" class="sheet-lockable sheet-hide-when-empty"/>

                            <label class="sheet-hide-when-empty">Distance:</label>
                            <input type="text" name="attr_ability1_distance" placeholder="Melee 1 or Ranged 10" class="sheet-lockable sheet-hide-when-empty"/>

                            <label class="sheet-hide-when-empty">Target:</label>
                            <input type="text" name="attr_ability1_target" placeholder="One creature" class="sheet-lockable sheet-hide-when-empty"/>

                            <label class="sheet-hide-when-empty">Cost:</label>
                            <input type="text" name="attr_ability1_cost" placeholder="3 Malice" class="sheet-lockable sheet-hide-when-empty"/>

                            <label class="sheet-hide-when-empty">Power Roll:</label>
                            <div class="sheet-power-row">
                                <input type="number" name="attr_ability1_bonus" placeholder="+5" class="sheet-lockable sheet-hide-when-empty"/>
                                <button type="roll" name="roll_monster_ability1" class="sheet-power-roll-btn" value="&{template:drawsteel}{{title=@{character_name}}} {{subtitle=Monster Power Roll}} {{roll=Power Roll = [[[[2d10]]+@{ability1_bonus}[Characteristic]+?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                                    Roll
                                </button>
                                <button type="roll" name="roll_monster_ability1_gm" class="sheet-power-roll-btn sheet-whisper-btn" value="/w gm &{template:drawsteel}{{title=@{character_name}}} {{subtitle=@{ability1_name}}} {{roll=Power Roll = [[[[2d10]]+@{ability1_bonus}[Characteristic]+?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                                    GM
                                </button>
                            </div>

                            <label class="sheet-hide-when-empty">Tier 1:</label>
                            <input type="text" name="attr_ability1_tier1" placeholder="7 damage" class="sheet-lockable sheet-hide-when-empty"/>

                            <label class="sheet-hide-when-empty">Tier 2:</label>
                            <input type="text" name="attr_ability1_tier2" placeholder="10 damage" class="sheet-lockable sheet-hide-when-empty"/>

                            <label class="sheet-hide-when-empty">Tier 3:</label>
                            <input type="text" name="attr_ability1_tier3" placeholder="13 damage" class="sheet-lockable sheet-hide-when-empty"/>
                        </div>

                        <textarea name="attr_ability1_effect" placeholder="Effect description or trigger condition" class="sheet-textarea-medium sheet-lockable sheet-hide-when-empty"></textarea>
                    </div>

                    <div class="sheet-ability-block">
                        <input type="text" name="attr_ability2_name" placeholder="Ability Name" class="sheet-ability-name sheet-lockable sheet-hide-when-empty"/>

                        <div class="sheet-ability-grid">
                            <label class="sheet-hide-when-empty">Type:</label>
                            <input type="text" name="attr_ability2_type" placeholder="Main Action" class="sheet-lockable sheet-hide-when-empty"/>

                            <label class="sheet-hide-when-empty">Keywords:</label>
                            <input type="text" name="attr_ability2_keywords" placeholder="Melee, Strike, Weapon" class="sheet-lockable sheet-hide-when-empty"/>

                            <label class="sheet-hide-when-empty">Distance:</label>
                            <input type="text" name="attr_ability2_distance" placeholder="Melee 1 or Ranged 10" class="sheet-lockable sheet-hide-when-empty"/>

                            <label class="sheet-hide-when-empty">Target:</label>
                            <input type="text" name="attr_ability2_target" placeholder="One creature" class="sheet-lockable sheet-hide-when-empty"/>

                            <label class="sheet-hide-when-empty">Cost:</label>
                            <input type="text" name="attr_ability2_cost" placeholder="3 Malice" class="sheet-lockable sheet-hide-when-empty"/>

                            <label class="sheet-hide-when-empty">Power Roll:</label>
                            <div class="sheet-power-row">
                                <input type="number" name="attr_ability2_bonus" placeholder="+5" class="sheet-lockable sheet-hide-when-empty"/>
                                <button type="roll" name="roll_monster_ability2" class="sheet-power-roll-btn" value="&{template:drawsteel}{{title=@{character_name}}} {{subtitle=Monster Power Roll}} {{roll=Power Roll = [[[[2d10]]+@{ability2_bonus}[Characteristic]+?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                                    Roll
                                </button>
                                <button type="roll" name="roll_monster_ability2_gm" class="sheet-power-roll-btn sheet-whisper-btn" value="/w gm &{template:drawsteel} {{title=@{character_name}}} {{subtitle=@{ability2_name}}} {{roll=Power Roll = [[[[2d10]]+@{ability2_bonus}[Characteristic]+?{Modifier|0}[Modifier]]]}} {{raw=Raw = $[[0]]}}">
                                    GM
                                </button>
                            </div>

                            <label class="sheet-hide-when-empty">Tier 1:</label>
                            <input type="text" name="attr_ability2_tier1" placeholder="7 damage" class="sheet-lockable sheet-hide-when-empty"/>

                            <label class="sheet-hide-when-empty">Tier 2:</label>
                            <input type="text" name="attr_ability2_tier2" placeholder="10 damage" class="sheet-lockable sheet-hide-when-empty"/>

                            <label class="sheet-hide-when-empty">Tier 3:</label>
                            <input type="text" name="attr_ability2_tier3" placeholder="13 damage" class="sheet-lockable sheet-hide-when-empty"/>
                        </div>

                        <textarea name="attr_ability2_effect" placeholder="Effect description or trigger condition" class="sheet-textarea-medium sheet-lockable sheet-hide-when-empty"></textarea>
                    </div>
                </div>
            </fieldset>
        </div>

        <div class="sheet-section sheet-monster-features">
            <h2>Features & Traits</h2>
            <fieldset class="repeating_monsterfeatures">
                <div class="sheet-double-ability-row">
                    <div class="sheet-ability-block">
                        <input type="text" name="attr_feature1_name" placeholder="Feature Name" class="sheet-ability-name sheet-lockable sheet-hide-when-empty"/>
                        <textarea name="attr_feature1_description" placeholder="Feature description" class="sheet-textarea-medium sheet-lockable sheet-hide-when-empty"></textarea>
                    </div>
                    <div class="sheet-ability-block">
                        <input type="text" name="attr_feature2_name" placeholder="Feature Name" class="sheet-ability-name sheet-lockable sheet-hide-when-empty"/>
                        <textarea name="attr_feature2_description" placeholder="Feature description" class="sheet-textarea-medium sheet-lockable sheet-hide-when-empty"></textarea>
                    </div>
                </div>
            </fieldset>
        </div>

        <div class="sheet-section sheet-monster-notes">
            <h2>Notes</h2>
            <textarea name="attr_monster_notes" class="sheet-textarea-notes" placeholder="Monster notes..."></textarea>
        </div>
    </div>
</div>

<div class="sheet-info">This Draw Steel character sheet for Roll20 is an independent product published under the DRAW STEEL Creator License and is not affiliated with MCDM Productions, LLC. DRAW STEEL Â© 2024 MCDM Productions, LLC.
    <br>
    <br>v1.0 | daniilqero@gmail.com | qero via discord
</div>

<script type="text/worker">
    const N = v => parseInt(v, 10) || 0;
    const setActionMsg = (a, b) => {
        const text = (typeof b === "string") ? b : a;
        setAttrs({ last_action: text }, { silent: true });
    };
    
    on("change:stamina", function () {
        getAttrs(["stamina", "stamina_max"], function (v) {
            const cur = N(v.stamina);
            const max = N(v.stamina_max);
            if (max >= 0 && cur > max) {
                setAttrs({ stamina: max }, {}, recomputeStatuses);
            } else {
                recomputeStatuses();
            }
        });
    });
    
    const recomputeStatuses = () => {
        getAttrs(
            [
                "stamina", "stamina_temp",
                "stamina_winded", "stamina_dying", "stamina_death",
                "status_winded", "status_dying", "status_dead",
                "status_ready", "character_name",
                "status_suppress_announce"
            ],
            function (v) {
                const total = N(v.stamina);
                const windedT = N(v.stamina_winded);
                const dyingT = N(v.stamina_dying);
                const deathT = N(v.stamina_death);
    
                const next = { status_winded: "0", status_dying: "0", status_dead: "0" };
                if (total <= deathT) {
                    next.status_dead = "1";
                    next.status_dying = "1";
                    next.status_winded = "1";
                } else if (total <= dyingT) {
                    next.status_dying = "1";
                    next.status_winded = "1";
                } else if (total <= windedT) {
                    next.status_winded = "1";
                }
    
                const prev = {
                    status_winded: v.status_winded || "0",
                    status_dying: v.status_dying || "0",
                    status_dead: v.status_dead || "0",
                };
    
                const who = v.character_name || "Character";
                const ready = v.status_ready === "1";
                const suppress = v.status_suppress_announce === "1";
                const msgs = [];
    
                if (prev.status_dead !== next.status_dead) {
                    msgs.push(next.status_dead === "1" ? `is Dead` : `is no longer Dead`);
                }
                if (prev.status_dying !== next.status_dying) {
                    msgs.push(next.status_dying === "1" ? `is Dying` : `is no longer Dying`);
                }
                if (prev.status_winded !== next.status_winded) {
                    msgs.push(next.status_winded === "1" ? `is Winded` : `is no longer Winded`);
                }
    
                setAttrs(next, { silent: true }, () => {
                    if (ready && msgs.length && !suppress) {
                        setActionMsg(msgs.join(", "));
                    }
                    if (suppress) setAttrs({ status_suppress_announce: "0" }, { silent: true });
                });
            }
        );
    };
    
    on("change:status_winded change:status_dying change:status_dead", function () {
        setAttrs({ status_suppress_announce: "1" }, { silent: true }, recomputeStatuses);
    });
    
    on("change:recoveries change:recoveries_max", function () {
        getAttrs(["recoveries", "recoveries_max"], function (v) {
            const cur = N(v.recoveries), max = N(v.recoveries_max);
            const up = {};
            if (cur > max) up.recoveries = max;
            if (cur < 0) up.recoveries = 0;
            if (Object.keys(up).length) setAttrs(up);
        });
    });
    
    on("change:stamina_winded change:stamina_dying change:stamina_death", function () {
        getAttrs(["stamina_winded", "stamina_dying", "stamina_death"], v => {
            const w = N(v.stamina_winded);
            const d = N(v.stamina_dying);
            const de = N(v.stamina_death);
    
            let nw = w, nd = d, nde = de;
            if (nde > nd) nd = nde;
            if (nd > nw) nw = nd;
    
            const up = {};
            if (nw !== w) up.stamina_winded = nw;
            if (nd !== d) up.stamina_dying = nd;
            if (Object.keys(up).length) setAttrs(up, {}, recomputeStatuses);
            else recomputeStatuses();
        });
    });
    
    on("sheet:opened", function () {
        getAttrs(["stamina_max", "stamina_winded", "stamina", "status_ready"], function (v) {
            const max = N(v.stamina_max);
            const winded = N(v.stamina_winded);
            const up = {};
            if (max && !winded) up.stamina_winded = Math.floor(max / 2);
            if (max >= 0 && N(v.stamina) > max) up.stamina = max;
    
            const after = () => {
                if (v.status_ready !== "1") setAttrs({ status_ready: "1" }, { silent: true });
                recomputeStatuses();
            };
    
            if (Object.keys(up).length) setAttrs(up, {}, after);
            else after();
        });
    });
    
    on('clicked:stam_heal', function () {
        getAttrs(['character_name', 'stam_heal_input', 'stamina', 'stamina_max'], v => {
            const who = v.character_name || 'Character';
            const amt = Math.max(0, N(v.stam_heal_input));
            if (amt <= 0) {
                setAttrs({ stam_heal_input: 0 }, { silent: true });
                return;
            }
            const before = N(v.stamina);
            const after = Math.min(before + amt, N(v.stamina_max));
            setAttrs({ stamina: after, stam_heal_input: 0 }, {}, () => {
                setActionMsg(who, ` healed ${amt} (${before} â†’ ${after})`);
                recomputeStatuses();
            });
        });
    });
    
    
    on('clicked:stam_damage', function () {
        getAttrs(['character_name', 'stam_damage_input', 'stamina', 'stamina_temp'], v => {
            const who = v.character_name || 'Character';
            let dmg = Math.max(0, N(v.stam_damage_input));
            if (dmg <= 0) {
                setAttrs({ stam_damage_input: 0 }, { silent: true });
                return;
            }
            let temp = N(v.stamina_temp);
            let cur = N(v.stamina);
            const t0 = temp, s0 = cur;
    
            if (dmg <= temp) {
                temp -= dmg;
                dmg = 0;
            } else {
                dmg -= temp;
                temp = 0;
                cur -= dmg;
            }
            setAttrs({ stamina_temp: Math.max(0, temp), stamina: cur, stam_damage_input: 0 }, {}, () => {
                setActionMsg(who, ` took damage ${N(v.stam_damage_input)} (temp ${t0} â†’ ${temp}, stam ${s0} â†’ ${cur})`);
                recomputeStatuses();
            });
        });
    });
    
    on('clicked:stam_temp_gain', function () {
        getAttrs(['character_name', 'stam_temp_gain_input', 'stamina_temp'], v => {
            const who = v.character_name || 'Character';
            const gain = Math.max(0, N(v.stam_temp_gain_input));
            const cur = N(v.stamina_temp);
            const next = gain > cur ? gain : cur;
            setAttrs({ stamina_temp: next, stam_temp_gain_input: 0 }, {}, () => {
                setActionMsg(who, ` gained temp stamina ${cur} â†’ ${next}`);
                recomputeStatuses();
            });
        });
    });
    
    on('clicked:stam_temp_clear', function () {
        getAttrs(['character_name', 'stamina_temp'], v => {
            const who = v.character_name || 'Character';
            const was = N(v.stamina_temp);
            setAttrs({ stamina_temp: 0 }, {}, () => {
                setActionMsg(who, ` cleared temp stamina (${was} â†’ 0)`);
                recomputeStatuses();
            });
        });
    });
    
    on('clicked:stam_full_heal', function () {
        getAttrs(['character_name', 'stamina', 'stamina_max', 'stamina_temp'], v => {
            const who = v.character_name || 'Character';
            const before = N(v.stamina), beforeT = N(v.stamina_temp);
            setAttrs({ stamina: N(v.stamina_max), stamina_temp: 0 }, {}, () => {
                setActionMsg(who, ` full restore (stamina ${before} â†’ ${N(v.stamina_max)}, temp ${beforeT} â†’ 0)`);
                recomputeStatuses();
            });
        });
    });
    
    on('clicked:recovery_spend', function () {
        getAttrs(['character_name', 'recoveries', 'stamina', 'stamina_max', 'stamina_per_recovery'], v => {
            const who = v.character_name || 'Character';
            const rec = N(v.recoveries);
            if (rec > 0) {
                const healed = N(v.stamina) + N(v.stamina_per_recovery);
                const newSta = Math.min(healed, N(v.stamina_max));
                setAttrs({ recoveries: rec - 1, stamina: newSta }, {}, () => {
                    setActionMsg(who, ` spent Recovery (stamina â†’ ${newSta}, left: ${rec - 1})`);
                    recomputeStatuses();
                });
            } else {
                setActionMsg(who, ` tried to spend Recovery, but none left`);
            }
        });
    });
    
    on('clicked:recoveries_restore_all', function () {
        getAttrs(['character_name', 'recoveries_max'], v => {
            const who = v.character_name || 'Character';
            const max = N(v.recoveries_max);
            setAttrs({ recoveries: max }, {}, () => setActionMsg(who, ` restored all Recoveries (${max})`));
        });
    });
    
    on('clicked:heroic_gain', function () {
        getAttrs(['character_name', 'heroic_resource'], v => {
            const who = v.character_name || 'Character';
            const add = 1;
            const cur = N(v.heroic_resource);
            setAttrs({ heroic_resource: cur + add }, {}, () =>
                setActionMsg(who, ` gained heroic +${add} (${cur} â†’ ${cur + add})`)
            );
        });
    });
    
    on('clicked:heroic_spend', function () {
        getAttrs(['character_name', 'heroic_resource'], v => {
            const who = v.character_name || 'Character';
            const sub = 1;
            const cur = N(v.heroic_resource);
            const next = cur - sub;
            setAttrs({ heroic_resource: next }, {}, () =>
                setActionMsg(who, ` spent heroic ${sub} (${cur} â†’ ${next})`)
            );
        });
    });
    
    on('clicked:heroic_clear', function () {
        getAttrs(['character_name', 'heroic_resource'], v => {
            const who = v.character_name || 'Character';
            const was = N(v.heroic_resource);
            setAttrs({ heroic_resource: 0 }, {}, () =>
                setActionMsg(who, ` cleared heroic (${was} â†’ 0)`)
            );
        });
    });
    
    on('clicked:surges_gain', function () {
        getAttrs(['character_name', 'surges'], v => {
            const who = v.character_name || 'Character';
            const add = 1;
            const cur = N(v.surges);
            setAttrs({ surges: cur + add }, {}, () =>
                setActionMsg(who, ` gained surges +${add} (${cur} â†’ ${cur + add})`)
            );
        });
    });
    
    on('clicked:surges_spend', function () {
        getAttrs(['character_name', 'surges'], v => {
            const who = v.character_name || 'Character';
            const sub = 1;
            const cur = N(v.surges);
            const next = Math.max(0, cur - sub);
            setAttrs({ surges: next }, {}, () =>
                setActionMsg(who, ` spent surges ${sub} (${cur} â†’ ${next})`)
            );
        });
    });
    
    on('clicked:surges_clear', function () {
        getAttrs(['character_name', 'surges'], v => {
            const who = v.character_name || 'Character';
            const was = N(v.surges);
            setAttrs({ surges: 0 }, {}, () =>
                setActionMsg(who, ` cleared surges (${was} â†’ 0)`)
            );
        });
    });
    
    on('clicked:hero_tokens_gain', function () {
        getAttrs(['character_name', 'hero_tokens'], v => {
            const teamName = v.character_name || 'Team';
            const current = N(v.hero_tokens);
            const newValue = current + 1;
            setAttrs({ hero_tokens: newValue }, {}, () =>
                setActionMsg(`${teamName} gained 1 Hero Token (${current} â†’ ${newValue})`)
            );
        });
    });
    
    on('clicked:hero_tokens_spend', function () {
        getAttrs(['character_name', 'hero_tokens'], v => {
            const teamName = v.character_name || 'Team';
            const current = N(v.hero_tokens);
            if (current > 0) {
                const newValue = current - 1;
                setAttrs({ hero_tokens: newValue }, {}, () =>
                    setActionMsg(`${teamName} spent 1 Hero Token (${current} â†’ ${newValue})`)
                );
            }
        });
    });
    
    on('clicked:hero_tokens_clear', function () {
        getAttrs(['character_name', 'hero_tokens'], v => {
            const teamName = v.character_name || 'Team';
            const was = N(v.hero_tokens);
            setAttrs({ hero_tokens: 0 }, {}, () =>
                setActionMsg(`${teamName} cleared Hero Tokens (${was} â†’ 0)`)
            );
        });
    });
    
    const toNum = v => {
        const n = parseFloat(v);
        return Number.isFinite(n) ? n : 0;
    };
    
    function getRowIdFromEvent(e, section) {
        if (e && e.sourceAttribute) {
            const m = e.sourceAttribute.match(new RegExp(`repeating_${section}_([^_]+)_`));
            if (m) return m[1];
        }
        if (e && e.sourceSection) {
            const m = e.sourceSection.match(new RegExp(`repeating_${section}_([^_]+)`));
            if (m) return m[1];
        }
        return getActiveRowID(`repeating_${section}`);
    }
    
    function mirrorHeroicResource(val) {
        getSectionIDs('repeating_heroic', ids => {
            const out = {};
            ids.forEach(id => {
                out[`repeating_heroic_${id}_heroic_resource_copy`] = val;
            });
            setAttrs(out, { silent: true });
        });
    }
    
    on('sheet:opened change:heroic_resource', () => {
        getAttrs(['heroic_resource'], v => {
            const have = (v.heroic_resource === undefined || v.heroic_resource === '')
                ? 0 : toNum(v.heroic_resource);
            setAttrs({ heroic_resource: have }, { silent: true });
            mirrorHeroicResource(have);
        });
    });
    
    on('clicked:repeating_heroic:spend1', (e) => {
        const rowid = getRowIdFromEvent(e, 'heroic');
        if (!rowid) return;
        const costAttr = `repeating_heroic_${rowid}_heroic1_cost`;
    
        getAttrs([costAttr, 'heroic_resource'], v => {
            const cost = toNum(v[costAttr]);
            const have = toNum(v.heroic_resource);
            const next = have - cost;
            setAttrs({ heroic_resource: next }, { silent: true });
            mirrorHeroicResource(next);
        });
    });
    
    on('clicked:repeating_heroic:spend2', (e) => {
        const rowid = getRowIdFromEvent(e, 'heroic');
        if (!rowid) return;
        const costAttr = `repeating_heroic_${rowid}_heroic2_cost`;
    
        getAttrs([costAttr, 'heroic_resource'], v => {
            const cost = toNum(v[costAttr]);
            const have = toNum(v.heroic_resource);
            const next = have - cost;
            setAttrs({ heroic_resource: next }, { silent: true });
            mirrorHeroicResource(next);
        });
    });
    
    on("change:organization", function() {
        getAttrs(["organization"], function(values) {
            const isMinion = values.organization === "Minion";
            setAttrs({
                minion_block_visible: isMinion ? "1" : "0"
            });
        });
    });
    
    on("sheet:opened", function() {
        getAttrs(["organization"], function(values) {
            const isMinion = values.organization === "Minion";
            setAttrs({
                minion_block_visible: isMinion ? "1" : "0"
            });
        });
    });
</script>

<rolltemplate class="sheet-rolltemplate-drawsteel">
    <div class="sheet-template-container">
        {{#title}}
        <div class="sheet-template-header">{{title}}</div>
        {{/title}}

        {{#subtitle}}
        <div class="sheet-template-subtitle">{{subtitle}}</div>
        {{/subtitle}}

        {{#roll}}
        <div class="sheet-template-roll">{{roll}}</div>
        {{/roll}}

        {{#raw}}
        <div class="sheet-template-raw">{{raw}}</div>
        {{/raw}}
    </div>
</rolltemplate>