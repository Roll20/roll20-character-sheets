
<link rel="stylesheet" type="text/css" href="selenim-legende.css">
<!------------------------------------ Begin custom sheet here ------------------------------------------->
<!------------------------------------ Tabs for magical choices ------------------------------------------->
<div class="sheet-first-annonce">Le personnage pratique : </div>
<input type="checkbox" id="practice_necromancie" name="attr_practice_necromancie" class="sheet-checkbox-tab sheet-practice-mag"><label for="practice_necromancie" class="sheet-bla">La Nécromancie</label>
<input type="checkbox" id="practice_kabb" name="attr_practice_kabbN" class="sheet-checkbox-tab sheet-practice-kabbN"><label for="practice_kabb" class="sheet-bla">La Kabbale Noire</label>
<input type="checkbox" id="practice_imago" name="attr_practice_imago" class="sheet-checkbox-tab sheet-practice-imago"><label for="practice_imago" class="sheet-bla">Imago</label>

<div></div>
<!------------------------------------ Generic tabs ------------------------------------------->
<div class="sheet-first-annonce">Accès rapides : </div>
<input type="radio" name="attr_tab" class="sheet-tab sheet-tab1" value="1" checked="checked" /><span title="Selenim"></span>
<input type="radio" name="attr_tab" class="sheet-tab sheet-tab2" value="2" /><span title="Vécus"></span>
<input type="radio" name="attr_tab" class="sheet-tab sheet-tab3" value="3" /><span title="Materiel"></span>
<input type="radio" name="attr_tab" class="sheet-tab sheet-tab4 sheet-tab-optionnal sheet-tab-optionnal4" value="4" /><span class="sheet-tab-optionnal sheet-tab-optionnal4" title="Nécromancie"></span>
<input type="radio" name="attr_tab" class="sheet-tab sheet-tab5 sheet-tab-optionnal sheet-tab-optionnal5" value="5" /><span class="sheet-tab-optionnal sheet-tab-optionnal5" title="Kabbale Noire"></span>
<input type="radio" name="attr_tab" class="sheet-tab sheet-tab6 sheet-tab-optionnal sheet-tab-optionnal6" value="6" /><span class="sheet-tab-optionnal sheet-tab-optionnal6" title="Imago"></span>



<div class="sheet-test"></div>


<!------------------------------------------- Page 1 - Selenim ------------------------------------------->
<div class="sheet-tab-content sheet-tab1">
    <div class="sheet-main">

        <div class="sheet-box sheet-charact">
            <div class="sheet-attrib">
                <div class="sheet-bigtext">Nom : </div> <input type="text" name="attr_character_name" class="sheet-name" />
            </div>
            <div class="sheet-main sheet-attrib">
                <textarea rows="3" name="attr_sel_une_phrase" placeholder="Votre Selenim en quelques phrases....."></textarea>

            </div>
            <div class="sheet-main sheet-attrib">
				<div class="sheet-bigtext">Votre Royaume : </div>
                <textarea rows="3" name="attr_roy_une_phrase"></textarea>

            </div>
            <div class="sheet-main sheet-attrib">
				<div class="sheet-bigtext">Vos Sans Repos : </div>
                <textarea rows="3" name="attr_sans_repos"></textarea>

            </div>
        </div>
		
        <div class="sheet-box">
			<div class="sheet-elements-selenim">
				<div class="sheet-kalunenoire">
					<input class="sheet-rond sheet-ka" type="number" name="attr_kalunenoire" />
					<button type="roll" class="sheet-karoll" style="color:white" name="karolllunenoire" value="&{template:ka} {{perso= @{character_name} }} {{nom_ka=Ka Lune Noire}} {{jet=[[ 1d100 ]] }}{{seuil=[[(?{Bonus / malus ?|0}[ Bonus, malus, vécus, etc. ]+@{kalunenoire}[ Ka Lune Noire ])*10 ]] }} ">Noyau</button>
				</div>
				
				<div class="sheet-reserve">
					<input class="sheet-rond sheet-ka" type="number" name="attr_reserve" />
					<button class="sheet-karoll" style="color:white" name="reservemax">Réserve Max</button>
				</div>
				
			</div>
			<div class="sheet-header"><img src="https://raw.githubusercontent.com/roll20/roll20-character-sheets/master/Nephilim-Legende/images/nephilim.png"/></div>
		</div>

        <div class="sheet-box">

            <div class="sheet-attrib">
                <div class="sheet-bigtext">Points de sapience : </div><input class="sheet-carre" name="attr_sapience" type="number" />

            </div>
            <div class="sheet-box sheet-attrib">
                <h1>Chutes</h1>
                <div class="sheet-details-chutes">
                    <span class="sheet-petit">Ashavérus</span>
                    <input type="number" class="sheet-carre sheet-floatright" name="attr_asha">
                    <div class="sheet-right">
                        <input type="radio" class="sheet-compteur sheet-zero" name="attr_asha" value="0" /><span></span>
                        <input type="radio" class="sheet-compteur" name="attr_asha" value="1" /><span></span>
                        <input type="radio" class="sheet-compteur" name="attr_asha" value="2" /><span></span>
                        <input type="radio" class="sheet-compteur" name="attr_asha" value="3" /><span></span>
                        <input type="radio" class="sheet-compteur" name="attr_asha" value="4" /><span></span>
                        <input type="radio" class="sheet-compteur" name="attr_asha" value="5" /><span></span>
                        <input type="radio" class="sheet-compteur" name="attr_asha" value="6" /><span></span>
                        <input type="radio" class="sheet-compteur" name="attr_asha" value="7" /><span></span>
                        <input type="radio" class="sheet-compteur" name="attr_asha" value="8" /><span></span>
                        <input type="radio" class="sheet-compteur" name="attr_asha" value="9" /><span></span>
                        <input type="radio" class="sheet-compteur" name="attr_asha" value="10" /><span></span>
                    </div>
                </div>
            </div>

            <div class="sheet-attrib sheet-main">
                <h1 style="display:inline-block">Pavane</h1>
                <div class="sheet-pavane">
                    <input class="sheet-carre" name="attr_simu-attr_pavane_degre" type="number" /><button type="roll" class="sheet-rolldice btn ui-draggable" name="sheet-simu-roll-pavane" style="color: rgb( 51 , 87 , 88 )" value="&amp;{template:pavane} {{perso= @{character_name} }} {{jet=[[ 1d100 ]] }}{{seuil=[[(?{ Bonus / malus ?|0}[ Bonus, malus, vécus, etc. ]+@{simu-attr_pavane_degre}[ Pavane ])*10 ]] }} "></button>
                </div>
            </div>

            <div class="sheet-attrib sheet-main">
                <h1 style="display:inline-block">Réserve courante</h1>
                <div class="sheet-pavane">
                    <input class="sheet-carre" name="attr_simu-attr_reserve-degre" type="number" />
                </div>
            </div>
			
            </div>

        </div>
    </div>
</div>



<!------------------------------------------- Page 2 - Vécus & Simulacre ------------------------------------------->

<div class="sheet-tab-content sheet-tab2">
    
    <div class="sheet-main sheet-attrib sheet-incarnation">
        <h3>Simulacre</h3>
        <div class="sheet-simu-attrib">
            <div class="sheet-bigtext">Ka soleil : </div>
            <input class="sheet-carre" name="attr_simu-kasoleil" type="number" />
        </div>
        <div class="sheet-simu-attrib">
            <div class="sheet-bigtext">Nom : </div>
            <input type="text" name="attr_simu_name" placeholder="Nom" />
            <div class="sheet-bigtext">Âge : </div>
            <input type="text" name="attr_simu_age" placeholder="Âge" />
        </div>
        <div class="sheet-simu-attrib">
            <div class="sheet-bigtext">Genre : </div>
            <input type="text" name="attr_simu_genre" placeholder="Genre" />
            <div class="sheet-bigtext">Vécu : </div>
            <input type="text" name="attr_simu_vecu" value="Changement de peau" readonly/>
            <input class="sheet-carre" name="attr_simu-vecu-nbr" type="number" />
            <button type="roll" class="sheet-rolldice btn ui-draggable" name="sheet-simu-roll-vecu" style="color: rgb( 51 , 87 , 88 )" value="&amp;{template:vecu} {{perso= @{character_name} }} {{nom_vecu= @{simu_vecu} }} {{jet=[[ 1d100 ]] }}{{seuil=[[(?{ Bonus / malus ?|0}[ Bonus, malus, vécus, etc. ]+@{simu-vecu-nbr}[ Vécu ])*10 ]] }} "></button>
        </div>
        <div class="sheet-simu-attrib">
            <div class="sheet-bigtext sheet-text-top">Description : </div>
            <textarea rows="4" name="attr_simu-descr" placeholder="Description du simulacre"></textarea>
            <div class="sheet-bigtext sheet-text-top">Ressources : </div>
            <textarea rows="4" name="attr_simu-ress" placeholder="Ressources du simulacre"></textarea>
        </div>
    </div>

    <div class="sheet-main sheet-attrib sheet-incarnation">
        <h3>Vécus</h3>
        <fieldset class="repeating_epoques-incarnation">
            <div class="sheet-box sheet-col">
                <input type="text" name="attr_vecus-passe1" type="text" /><input class="sheet-carre" name="attr_degres_vecu_passe1" type="number" />
                <button type="roll" class="sheet-rolldice btn ui-draggable" name="sheet-simu-roll-vecu" style="color: rgb( 51 , 87 , 88 )" value="&amp;{template:vecu} {{perso= @{character_name} }} {{nom_vecu= @{vecus-passe1} }} {{jet=[[ 1d100 ]] }}{{seuil=[[(?{ Bonus / malus ?|0}[ Bonus, malus, vécus, etc. ]+@{degres_vecu_passe1}[ Vécu ])*10 ]] }} "></button>
            </div>
            <div class="sheet-box sheet-col">
                <input type="text" name="attr_vecus-passe2" type="text" /><input class="sheet-carre" name="attr_degres_vecu_passe2" type="number" />
                <button type="roll" class="sheet-rolldice btn ui-draggable" name="sheet-simu-roll-vecu" style="color: rgb( 51 , 87 , 88 )" value="&amp;{template:vecu} {{perso= @{character_name} }} {{nom_vecu= @{vecus-passe2} }} {{jet=[[ 1d100 ]] }}{{seuil=[[(?{ Bonus / malus ?|0}[ Bonus, malus, vécus, etc. ]+@{degres_vecu_passe2}[ Vécu ])*10 ]] }} "></button>
            </div>
        </fieldset>
    </div>

    <div class="sheet-main sheet-attrib sheet-quetes-savoirs">
        <h3>Savoirs esotériques</h3>
        <fieldset class="repeating_savoir-eso">
            <div class="sheet-box sheet-col">
                <select class="sheet-large sheet-epoques-incarnation" name="attr_savoir_eso1">
                    <option value="0">-- Savoir --</option>
                    <option value="666">666</option>
                    <option value="akasha">Akasha</option>
                    <option value="ar-kaim">Ar-Kaïm</option>
                    <option value="arcanes-majeur">Arcanes majeurs</option>
                    <option value="bohemiens">Bohémiens</option>
                    <option value="champs-magiques">Champs magiques</option>
                    <option value="cousins">Cousins</option>
                    <option value="drakaon">Drakaon</option>
                    <option value="effets-dragons">Effets-dragons</option>
                    <option value="histoire-invisible">Histoire invisible</option>
                    <option value="kaim">Kaïm</option>
                    <option value="lune-noire">Lune Noire</option>
                    <option value="mystères">Mystères</option>
                    <option value="nephilim">Nephilim</option>
                    <option value="orichalque">Orichalque</option>
                    <option value="révélation">Révélation</option>
                    <option value="rose-croix">Rose+Croix</option>
                    <option value="sciences-occultes">Sciences-occultes</option>
                    <option value="selenim">Selenim</option>
                    <option value="synarchie">Synarchie</option>
                    <option value="templiers">Templiers</option>
                </select>
                <input class="sheet-carre" name="attr_savoir_eso_degres1" title="degres" type="number" />
                <button type="roll" class="sheet-rolldice btn ui-draggable" name="sheet-simu-roll-vecu" style="color: rgb( 51 , 87 , 88 )" value="&amp;{template:vecu} {{perso= @{character_name} }} {{nom_vecu= @{savoir_eso1} }} {{jet=[[ 1d100 ]] }}{{seuil=[[(?{ Bonus / malus ?|0}[ Bonus, malus, vécus, etc. ]+@{savoir_eso_degres1}[ Savoir ])*10 ]] }} "></button>
			</div>
            <div class="sheet-box sheet-col">
                <select class="sheet-large sheet-epoques-incarnation" name="attr_savoir_eso2">
                    <option value="0">-- Savoir --</option>
                    <option value="666">666</option>
                    <option value="akasha">Akasha</option>
                    <option value="ar-kaim">Ar-Kaïm</option>
                    <option value="arcanes-majeur">Arcanes majeurs</option>
                    <option value="bohemiens">Bohémiens</option>
                    <option value="champs-magiques">Champs magiques</option>
                    <option value="cousins">Cousins</option>
                    <option value="drakaon">Drakaon</option>
                    <option value="effets-dragons">Effets-dragons</option>
                    <option value="histoire-invisible">Histoire invisible</option>
                    <option value="kaim">Kaïm</option>
                    <option value="lune-noire">Lune Noire</option>
                    <option value="mystères">Mystères</option>
                    <option value="nephilim">Nephilim</option>
                    <option value="orichalque">Orichalque</option>
                    <option value="révélation">Révélation</option>
                    <option value="rose-croix">Rose+Croix</option>
                    <option value="sciences-occultes">Sciences-occultes</option>
                    <option value="selenim">Selenim</option>
                    <option value="synarchie">Synarchie</option>
                    <option value="templiers">Templiers</option>
                </select>
                <input class="sheet-carre" name="attr_savoir_eso_degres2" title="degres" type="number" />
                <button type="roll" class="sheet-rolldice btn ui-draggable" name="sheet-simu-roll-vecu" style="color: rgb( 51 , 87 , 88 )" value="&amp;{template:vecu} {{perso= @{character_name} }} {{nom_vecu= @{savoir_eso2} }} {{jet=[[ 1d100 ]] }}{{seuil=[[(?{ Bonus / malus ?|0}[ Bonus, malus, vécus, etc. ]+@{savoir_eso_degres2}[ Savoir ])*10 ]] }} "></button>
			</div>
        </fieldset>
    </div>
</div>



<!------------------------------------------- Page 3 - Attributs & Dommages ------------------------------------------->

<div class="sheet-tab-content sheet-tab3">

    <div class="sheet-main sheet-attributes">
        <div class="sheet-col sheet-carac">
            <h2>Actions et attributs</h2>
            <div class="sheet-attrib">
                <div class="sheet-bigtext sheet-longtext">Initiative</div><input type="hidden" name="attr_foo_init" value="0" />
                <input type="number" name="attr_init" class="sheet-carre" title="KLN" value="@{foo_init}" disabled="true"/>
            </div>
            <div class="sheet-attrib">
                <div class="sheet-bigtext sheet-longtext">Mouvement</div><input type="hidden" name="attr_foo_mouv" value="0" />
                <input type="number" name="attr_mouv" class="sheet-carre" title="KLN" value="@{foo_mouv}" disabled="true"/>
            </div>
            <div class="sheet-attrib">
                <div class="sheet-bigtext sheet-longtext">Perspicacité</div><input type="hidden" name="attr_foo_persp" value="0" />
                <input type="number" name="attr_persp" class="sheet-carre" title="11 - KLN" value="@{foo_persp}" disabled="true" />
            </div>
            <div class="sheet-attrib">
                <div class="sheet-bigtext sheet-longtext">Récupération</div><input type="hidden" name="attr_foo_recup" value="0" />
                <input type="number" name="attr_recup" class="sheet-carre" title="11 - KLN" value="@{foo_recup}" disabled="true" />
            </div>
            <div class="sheet-attrib">
                <div class="sheet-bigtext sheet-longtext">Bonus de dommages</div><input type="hidden" name="attr_foo_bonus-dom" value="0" />
                <input type="number" name="attr_bonus-dom" class="sheet-carre" title="(KLN>10 =+1)(+1 par tranche de 10 KLN)" value="@{foo_bonus-dom}" disabled="true" />
            </div>
        </div>

        <div class="sheet-col sheet-main">
            <h2>Dommages</h2>
            <div class="sheet-attrib">
                <div class="sheet-dommages-physiques">
                    <div class="sheet-bigtext">Physiques</div>
                    <input type="number" class="sheet-carre sheet-floatright" name="attr_dom" />
                    <div class="sheet-right">
                        <input class="sheet-foo-dom-phys1" type="hidden" name="attr_foo_dom_phys1" value="0" />
                        <input class="sheet-foo-dom-phys2" type="hidden" name="attr_foo_dom_phys2" value="0" />
                        <input type="radio" class="sheet-compteur sheet-zero" name="attr_dom" value="0" readonly/><span></span>
                        <input type="radio" class="sheet-compteur" name="attr_dom" value="1" readonly /><span></span>
                        <input type="radio" class="sheet-compteur" name="attr_dom" value="2" readonly/><span></span>
                        <input type="radio" class="sheet-compteur" name="attr_dom" value="3" readonly/><span></span>
                        <input type="radio" class="sheet-compteur sheet-input-dom-phys-level4" name="attr_dom" value="4" readonly/><span class="sheet-dom-phys-level4"></span>
                        <input type="radio" class="sheet-compteur sheet-input-dom-phys-level5" name="attr_dom" value="5" readonly/><span class="sheet-dom-phys-level5"></span>
                    </div>
                </div>
            </div>

            <div class="sheet-attrib sheet-consequence">
                <div><div class="sheet-bigtext">Conséquences</div></div>
                <div class="sheet-line ">
                    <div class="sheet-bigtext sheet-100">Mineur</div><div class="sheet-bigtext sheet-modif">-2</div>
                    <label class="sheet-checkbox-label">
                        <input type="checkbox" name="attr_cons-min" class="sheet-checkbox-check">
                        <i class="sheet-checkbox-img"></i>
                    </label>
                    <input type="text" class="sheet-right" name="attr_cons-min-desc" /></span>
                </div>
                <div class="sheet-line ">
                    <div class="sheet-bigtext sheet-100">Sérieuse</div><div class="sheet-bigtext sheet-modif">-4</div>
                    <label class="sheet-checkbox-label">
                        <input type="checkbox" name="attr_cons-ser" class="sheet-checkbox-check">
                        <i class="sheet-checkbox-img"></i>
                    </label>
                    <input type="text" name="attr_cons-ser-desc" />
                </div>
                <div class="sheet-line ">
                    <div class="sheet-bigtext sheet-100">Grave</div><div class="sheet-bigtext sheet-modif">-6</div>
                    <label class="sheet-checkbox-label">
                        <input type="checkbox" name="attr_cons-gra" class="sheet-checkbox-check">
                        <i class="sheet-checkbox-img"></i>
                    </label>
                    <input type="text" name="attr_cons-gra-desc" />
                </div>
            </div>
        </div>

        <div class="sheet-col sheet-main">
            <h2>Dommages</h2>

            <div class="sheet-attrib">
                <div class="sheet-dommages-magiques">
                    <div class="sheet-bigtext">Magiques</div>
                    <input type="number" class="sheet-carre sheet-floatright" name="attr_dom-mag" />
                    <div class="sheet-right">
                        <input type="radio" class="sheet-compteur sheet-zero" name="attr_dom-mag" value="0" readonly/><span></span>
                        <input type="radio" class="sheet-compteur" name="attr_dom-mag" value="1" readonly/><span></span>
                        <input type="radio" class="sheet-compteur" name="attr_dom-mag" value="2" readonly/><span></span>
                        <input type="radio" class="sheet-compteur" name="attr_dom-mag" value="3" readonly/><span></span>
                    </div>
                </div>
            </div>

            <div class="sheet-attrib sheet-consequence">
                <div><div class="sheet-bigtext">Conséquences</div></div>
                <div class="sheet-line ">
                    <div class="sheet-bigtext sheet-100">Mineur</div><div class="sheet-bigtext sheet-modif">-2</div>
                    <label class="sheet-checkbox-label">
                        <input type="checkbox" name="attr_cons-mag-min" class="sheet-checkbox-check">
                        <i class="sheet-checkbox-img"></i>
                    </label>
                    <input type="text" name="attr_cons-mag-min-desc" />
                </div>
                <div class="sheet-line">
                    <div class="sheet-bigtext sheet-100">Sérieuse</div><div class="sheet-bigtext sheet-modif">-4</div>
                    <label class="sheet-checkbox-label">
                        <input type="checkbox" name="attr_cons-mag-ser" class="sheet-checkbox-check">
                        <i class="sheet-checkbox-img"></i>
                    </label>
                    <input type="text" name="attr_cons-mag-ser-desc" />
                </div>
                <div class="sheet-line">
                    <div class="sheet-bigtext sheet-100">Grave</div><div class="sheet-bigtext sheet-modif">-6</div>
                    <label class="sheet-checkbox-label">
                        <input type="checkbox" name="attr_cons-mag-gra" class="sheet-checkbox-check">
                        <i class="sheet-checkbox-img"></i>
                    </label>
                    <input type="text" name="attr_cons-mag-gra-desc" />
                </div>
            </div>
            <input type="hidden" name="attr_total-malus" />
        </div>
    </div>
    
    <div class="sheet-main sheet-attrib">
        <h2>Possessions</h2>

        <div class="sheet-box sheet-attrib sheet-posses">
            <div><div class="sheet-bigtext">Armes</div></div>
            <fieldset class="repeating_poss-arme">
                <input type="text" name="attr_poss-arme-nom" placeholder="Nom de l'arme"/>
                <input class="sheet-carre sheet-floatright" name="attr_poss-arme-degre" type="number" />
            </fieldset>
        </div>

        <div class="sheet-box sheet-attrib sheet-posses">
            <div><div class="sheet-bigtext">Protections</div></div>
            <fieldset class="repeating_poss-protec">
                <input type="text" name="attr_poss-protec-nom" placeholder="Nom de la protection"/>
                <input class="sheet-carre sheet-floatright" name="attr_poss-protec-degre" type="number" />
            </fieldset>
        </div>

        <div class="sheet-box sheet-attrib sheet-posses sheet-posses-artef">
            <div><div class="sheet-bigtext">Artefacts</div></div>
            <fieldset class="repeating_posse-artefact-eso">
                <input type="text" name="attr_poss-artefact-name" placeholder="Nom de l'artefact"/>
                <select class="sheet-poss-artef-ka" name="attr_poss-artefact-ka">
                    <option value="0">-- Ka-élément --</option>
                    <option value="kaair">Air</option>
                    <option value="kaeau">Eau</option>
                    <option value="kafeu">Feu</option>
                    <option value="kalune">Lune</option>
                    <option value="katerre">Terre</option>
                </select>
                <input class="sheet-carre sheet-floatright" name="attr_poss-artefact-score" type="number" />
                <textarea name="attr_poss-artefact-def" placeholder="Description de l'artefact"></textarea>
            </fieldset>
        </div>
    </div>
</div>

<!------------------------------------------- Page 4 - necromancie ------------------------------------------->
<div class="sheet-tab-content sheet-tab4">
    <div class="sheet-main sheet-attrib sheet-necromancie-main">
        <h2>necromancie</h2>
        <div class="sheet-ligne">
            <div class="sheet-bigtext">Nécromancie</div><input type="number" name="attr_necr-degre" class="sheet-carre" />
        </div>
    </div>
    <div class="sheet-main sheet-attrib sheet-necromancie-main">
        <h2>Liste de sorts</h2>
        <fieldset class="repeating_mag-sort">
            <div class="sheet-necr-sort-spec">
                <div class="sheet-ligne">
                    <div class="sheet-bigtext">Nom : </div><input type="text" class="sheet-longinputtext sheet-firstinput" name="attr_necr-sort-nom" /> <button type="roll" class="sheet-rolldice btn ui-draggable" name="sheet-simu-roll-vecu" style="color: rgb( 51 , 87 , 88 )" value="&amp;{template:sort} {{perso= @{character_name} }} {{nom_sort= @{necr-sort-nom} }} {{descrip_sort= @{necr-sort-desc} }} {{cout_sort= @{necr-sort-cout} }} {{duree_sort= @{necr-sort-duree} }} {{jet=[[ 1d100 ]] }}{{seuil=[[(?{Bonus / malus ?|0}[ Bonus, malus, vécus, etc. ]+@{necr-degre}[ nécromancie ])*10 ]] }} "></button>
                </div>   
                <div class="sheet-ligne">
                    <div class="sheet-bigtext">Cout : </div><input type="text" class="sheet-longinputtext" name="attr_necr-sort-cout" />
                    <div class="sheet-bigtext">Durée : </div><input type="text" class="sheet-longinputtext" name="attr_necr-sort-duree" />
                </div>
                <div class="sheet-ligne sheet-last-line">
                    <div class="sheet-bigtext">Description : </div>
                    <textarea name="attr_necr-sort-desc"></textarea>
                </div>
            </div>
        </fieldset>        
    </div>
</div>


<!------------------------------------- Page 5 : Kabbale Noire ------------------------------------->
<div class="sheet-tab-content sheet-tab5">
    <div class="sheet-main sheet-attrib sheet-kabbN-main">
        <h2>Kabbale Noire</h2>
        <div class="sheet-ligne">
            <div class="sheet-bigtext">Kabbale Noire</div><input type="number" name="attr_kabbN-degre" class="sheet-carre" />
        </div>
    </div>
    <div class="sheet-main sheet-attrib">
        <h2>Liste des invocations</h2>
        <fieldset class="repeating_kabbN-invoc">
            <div class="sheet-kabbN-invoc-spec">
                <div class="sheet-ligne">
                    <div class="sheet-bigtext">Nom : </div><input type="text" class="sheet-longinputtext sheet-firstinput" name="attr_kabbN-invoc-nom" /> <button type="roll" class="sheet-rolldice btn ui-draggable" name="sheet-simu-roll-vecu" style="color: rgb( 51 , 87 , 88 )" value="&amp;{template:invoc} {{perso= @{character_name} }} {{nom_creature= @{kabbN-invoc-nom} }} {{descrip_sort= @{kabbN-invoc-desc} }} {{cout_sort= @{kabbN-invoc-cout} }} {{entropie_sort= @{kabbN-invoc-entropie} }} {{controle_sort= @{kabbN-invoc-controle} }} {{dommage_sort= @{kabbN-invoc-dommage} }} {{protection_sort= @{kabbN-invoc-protection} }} {{jet=[[ 1d100 ]] }}{{seuil=[[(?{Bonus / malus ?|0}[ Bonus, malus, vécus, etc. ]+@{kabbN-degre}[ Kabbale Noire ])*10 ]] }} "></button><button type="roll" class="sheet-rollsword btn ui-draggable" name="sheet-simu-roll-opposition" style="color: rgb( 51 , 87 , 88 )" value="&amp;{template:opposition} {{perso= @{character_name} }} {{nom_creature= @{kabbN-invoc-nom} }} {{jet=[[ 1d100 ]] }} {{seuil=[[(?{Bonus / malus ?|0}[Bonus, malus, vécus, etc. ]+@{kalunenoire}[ Ka Lune Noire ]+@{simu-attr_reserve-degre}[ Réserve ])*10 ]] }} {{jet_degre=[[ 1d100 ]] }} {{niv-degre=[[@{kabbN-invoc-cout}[ Degré ]*10 ]] }}"></button>
                </div>
                <div class="sheet-ligne">
                    <div class="sheet-bigtext">Controle : </div>
                    <label class="sheet-checkbox-label">
                        <input type="checkbox" name="attr_kabbN-invoc-controle" class="sheet-checkbox-check">
                        <i class="sheet-checkbox-img"></i>
                    </label>
                </div>        
                <div class="sheet-ligne">
                    <div class="sheet-bigtext">Ka-Lune Noire : </div><input type="number" name="attr_kabbN-invoc-cout" class="sheet-carre" />
                    <div class="sheet-bigtext">Entropie : </div><input type="text" class="sheet-longinputtext" name="attr_kabbN-invoc-entropie" />
                </div>
                <div class="sheet-ligne sheet-mag-number">
                    <div class="sheet-bigtext">Dommages : </div><input type="number" name="attr_kabbN-invoc-dommage" class="sheet-carre" />
                    <div class="sheet-bigtext">Protection : </div><input type="number" name="attr_kabbN-invoc-protection" class="sheet-carre" />
                </div>
                <div class="sheet-ligne sheet-last-line">
                    <div class="sheet-bigtext">Description : </div>
                    <textarea name="attr_kabbN-invoc-desc"></textarea>
                </div>
            </div>
        </fieldset>
    </div>
</div>

<!------------------------------------- Page 6 : Imago ------------------------------------->
<div class="sheet-tab-content sheet-tab6">
    <div class="sheet-main sheet-attrib sheet-imago-main">
        <h2>Aspect de L'imago</h2>
        <fieldset class="repeating_imago-aspect">
            <div class="sheet-imago-aspect-spec">
                <div class="sheet-ligne">
                    <div class="sheet-bigtext">Nom : </div><input type="text" class="sheet-longinputtext sheet-firstinput" name="attr_imago-aspect-nom" /> <button type="roll" class="sheet-rolldice btn ui-draggable" name="sheet-simu-roll-vecu" style="color: rgb( 51 , 87 , 88 )" value="&amp;{template:imago} {{perso= @{character_name} }} {{nom_aspect= @{imago-aspect-nom} }} {{cout_aspect= @{imago-cout-mat} }} {{duree_aspect= @{imago-aspect-duree} }} {{descrip_aspect= @{imago-aspect-desc} }} {{jet= [[ @{imago-aspect-investi} ]] }} {{seuil= [[ @{imago-aspect-total} ]] }} "></button>
                </div>
                <div class="sheet-ligne">
                    <div class="sheet-bigtext">Cout investi : </div><input type="text" class="sheet-longinputtext" name="attr_imago-aspect-investi" />
                    <div class="sheet-bigtext">Cout total : </div><input type="text" class="sheet-longinputtext" name="attr_imago-aspect-total" />
                </div>
                <div class="sheet-ligne sheet-mag-number">
                    <div class="sheet-bigtext">Durée : </div><input type="text" class="sheet-longinputtext" name="attr_imago-aspect-duree"/>
					<input type="hidden" value="1" name="attr_imago-cout-mat">
                </div>
                <div class="sheet-ligne sheet-last-line">
                    <div class="sheet-bigtext">Description : </div>
                    <textarea name="attr_imago-aspect-desc"></textarea>
                </div>
            </div>
        </fieldset>        
    </div>
</div>

<!------------------------------------- End HTML Page ------------------------------------->




<!------------------------------------- Begin Roll Templates ------------------------------------->
<!------------------------------------- Ka-Roll Template ------------------------------------->

<rolltemplate class="sheet-rolltemplate-ka">
    <div class="sheet-dice-box sheet-bg-ka">
        <h1>{{perso}}</h1>
        <div class="sheet-dice-subheader">Utilisation du {{nom_ka}}</div>
        <div class="sheet-dice-main">
            <div class="sheet-dice-roll">Résultat du jet :<br />{{jet}} ( {{seuil}} )</div>
        
            {{#rollLess() seuil jet}}
                    <div class="sheet-dice-result-ko">Echec</div>
            {{/rollLess() seuil jet}}
            
            {{#rollGreater() seuil jet}}
                    <div class="sheet-dice-result-ok">Réussite</div>
            {{/rollGreater() seuil jet}}
            {{#rollTotal() seuil jet}}
                    <div class="sheet-dice-result-ok">Réussite</div>
            {{/rollTotal() seuil jet}}
		</div>
    </div>
</rolltemplate>

<!------------------------------------- Vecu-Roll Template ------------------------------------->
<rolltemplate class="sheet-rolltemplate-vecu">
    <div class="sheet-dice-box sheet-bg-vecu">
        <h1>{{perso}}</h1>
        <div class="sheet-dice-subheader">
            <div>Mobilise son expérience de :</div>
            <div><span class="sheet-dice-bold">{{nom_vecu}}</span></div>
        </div>
        <div class="sheet-dice-main">
            <div class="sheet-dice-roll">
                <div>Résultat du jet :</div>
                <div>{{jet}} ( {{seuil}} )</div>
            </div>
        
            {{#rollLess() seuil jet}}
                    <div class="sheet-dice-result-ko">Echec</div>
            {{/rollLess() seuil jet}}
            
            {{#rollGreater() seuil jet}}
                    <div class="sheet-dice-result-ok">Réussite</div>
            {{/rollGreater() seuil jet}}
            {{#rollTotal() seuil jet}}
                    <div class="sheet-dice-result-ok">Réussite</div>
            {{/rollTotal() seuil jet}}
        </div>
    </div>
</rolltemplate>

<!------------------------------------- Ka-Roll Template ------------------------------------->
<rolltemplate class="sheet-rolltemplate-ka">
    <div class="sheet-dice-box sheet-bg-ka">
        <h1>{{perso}}</h1>
        <div class="sheet-dice-subheader">
            <div>Utilise son :</div>
            <div><span class="sheet-dice-bold">{{nom_ka}}</span></div>
        </div>
        <div class="sheet-dice-main">
            <div class="sheet-dice-roll">
                <div>Résultat du jet :</div>
                <div>{{jet}} ( {{seuil}} )</div>
            </div>
        
            {{#rollLess() seuil jet}}
                    <div class="sheet-dice-result-ko">Echec</div>
            {{/rollLess() seuil jet}}
            
            {{#rollGreater() seuil jet}}
                    <div class="sheet-dice-result-ok">Réussite</div>
            {{/rollGreater() seuil jet}}
            {{#rollTotal() seuil jet}}
                    <div class="sheet-dice-result-ok">Réussite</div>
            {{/rollTotal() seuil jet}}
        </div>
    </div>
</rolltemplate>

<!------------------------------------- Sort-Roll Template ------------------------------------->
<rolltemplate class="sheet-rolltemplate-sort">
    <div class="sheet-dice-box sheet-bg-sort">
        <h1>{{perso}}</h1>
        <div class="sheet-dice-subheader">
            <div>Lance le sort : </div>
            <div><span class="sheet-dice-bold">{{nom_sort}}</span></div>
        </div>

        <div class="sheet-dice-main">
            <div class="sheet-dice-roll">
                <div>Résultat du jet :</div>
                <div>{{jet}} ( {{seuil}} )</div>
            </div>
        
            {{#rollLess() seuil jet}}
                    <div class="sheet-dice-result-ko">Echec</div>
                    <div class="sheet-dice-effect">
                        <div><span class="sheet-dice-bold">Cout : </span>{{cout_sort}}</div>
                    </div>
            {{/rollLess() seuil jet}}
            
            {{#rollGreater() seuil jet}}
                    <div class="sheet-dice-result-ok">Réussite</div>
                    <div class="sheet-dice-effect">
                        <div><span class="sheet-dice-bold">Cout : </span>{{cout_sort}}</div>
                        <div><span class="sheet-dice-bold">Effet : </span>{{descrip_sort}}</div>
                    </div>
            {{/rollGreater() seuil jet}}
            {{#rollTotal() seuil jet}}
                    <div class="sheet-dice-result-ok">Réussite</div>
                    <div class="sheet-dice-effect">
                        <div><span class="sheet-dice-bold">Cout : </span>{{cout_sort}}</div>
                        <div><span class="sheet-dice-bold">Effet : </span>{{descrip_sort}}</div>
                    </div>
            {{/rollTotal() seuil jet}}
        </div>
    </div>
</rolltemplate>

<!------------------------------------- Pavane-Roll Template ------------------------------------->
<rolltemplate class="sheet-rolltemplate-pavane">
    <div class="sheet-dice-box sheet-bg-pavane">
        <h1>{{perso}}</h1>
        <div class="sheet-dice-subheader">
            <div>Ecoute la Pavane : </div>
        </div>

        <div class="sheet-dice-main">
            <div class="sheet-dice-roll">
                <div>Résultat du jet :</div>
                <div>{{jet}} ( {{seuil}} )</div>
            </div>
        
            {{#rollLess() seuil jet}}
                    <div class="sheet-dice-result-ko">Echec</div>
            {{/rollLess() seuil jet}}
            
            {{#rollGreater() seuil jet}}
                    <div class="sheet-dice-result-ok">Réussite</div>
            {{/rollGreater() seuil jet}}
            {{#rollTotal() seuil jet}}
                    <div class="sheet-dice-result-ok">Réussite</div>
            {{/rollTotal() seuil jet}}
        </div>
    </div>
</rolltemplate>

<!------------------------------------- Invocation-Roll Template ------------------------------------->
<rolltemplate class="sheet-rolltemplate-invoc">
    <div class="sheet-dice-box sheet-bg-invoc">
        <h1>{{perso}}</h1>
        <div class="sheet-dice-subheader">
            <div>Invoque la créature : </div>
            <div><span class="sheet-dice-bold">{{nom_creature}}</span></div>
        </div>

        <div class="sheet-dice-main">
            <div class="sheet-dice-roll">
                <div>Résultat du jet :</div>
                <div>{{jet}} ( {{seuil}} )</div>
            </div>
        
            {{#rollLess() seuil jet}}
                    <div class="sheet-dice-result-ko">Echec</div>
                    <div class="sheet-dice-effect">
                        <div><span class="sheet-dice-bold">Cout : </span>{{cout_sort}}</div>
                    </div>
            {{/rollLess() seuil jet}}
            
            {{#rollGreater() seuil jet}}
                    <div class="sheet-dice-result-ok">Réussite</div>
                    <div class="sheet-dice-effect">
                        <div><span class="sheet-dice-bold">Cout : </span>{{cout_sort}}</div>
                        <div><span class="sheet-dice-bold">Durée : </span>{{duree_sort}}</div>
                        <div><span class="sheet-dice-bold">Entropie : </span>{{entropie_sort}}</div>
                        <div><span class="sheet-dice-bold">Dommage : </span>{{dommage_sort}}</div>
                        <div><span class="sheet-dice-bold">Controle : </span>{{controle_sort}}</div>
                        <div><span class="sheet-dice-bold">Effet : </span>{{descrip_sort}}</div>
                    </div>
            {{/rollGreater() seuil jet}}
            {{#rollTotal() seuil jet}}
                    <div class="sheet-dice-result-ok">Réussite</div>
                    <div class="sheet-dice-effect">
                        <div><span class="sheet-dice-bold">Cout : </span>{{cout_sort}}</div>
                        <div><span class="sheet-dice-bold">Durée : </span>{{duree_sort}}</div>
                        <div><span class="sheet-dice-bold">Entropie : </span>{{entropie_sort}}</div>
                        <div><span class="sheet-dice-bold">Dommage : </span>{{dommage_sort}}</div>
                        <div><span class="sheet-dice-bold">Controle : </span>{{controle_sort}}</div>
                        <div><span class="sheet-dice-bold">Effet : </span>{{descrip_sort}}</div>
                    </div>
            {{/rollTotal() seuil jet}}
        </div>
    </div>
</rolltemplate>

<!------------------------------------- Opposition-Roll Template ------------------------------------->
<rolltemplate class="sheet-rolltemplate-opposition">
    <div class="sheet-dice-box sheet-bg-opposition">
        <h1>{{perso}}</h1>
        <div class="sheet-dice-subheader">
            <div>Essaye de controler : </div>
            <div><span class="sheet-dice-bold">{{nom_creature}}</span></div>
        </div>
        <div class="sheet-dice-main">

            <!------ Personnage ------>
            <div class="sheet-dice-col2">
                <div class="sheet-dice-ligne">{{perso}}</div>
                <div class="sheet-dice-ligne">{{jet}}</div>
                <div class="sheet-dice-ligne">
                    {{#rollLess() seuil jet}}
                            <div class="sheet-dice-result-ko">Echec</div>
                    {{/rollLess() seuil jet}}
                    
                    {{#rollGreater() seuil jet}}
                            <div class="sheet-dice-result-ok">Réussite</div>
                    {{/rollGreater() seuil jet}}

                    {{#rollTotal() seuil jet}}
                            <div class="sheet-dice-result-ok">Réussite</div>
                    {{/rollTotal() seuil jet}}
                </div>
            </div>

            <div class="sheet-dice-col-inter"><span class="sheet-dice-bold">VS</span></div>
            
            <!------ Creature ------>
            <div class="sheet-dice-col2">
                <div class="sheet-dice-ligne">{{nom_creature}}</div>
                <div class="sheet-dice-ligne">{{jet_degre}}</div>
                <div class="sheet-dice-ligne">
                    {{#rollLess() niv-degre jet_degre}}
                            <div class="sheet-dice-result-ko">Echec</div>
                    {{/rollLess() niv-degre jet_degre}}
                    
                    {{#rollGreater() niv-degre jet_degre}}
                            <div class="sheet-dice-result-ok">Réussite</div>
                    {{/rollGreater() niv-degre jet_degre}}

                    {{#rollTotal() niv-degre jet_degre}}
                            <div class="sheet-dice-result-ok">Réussite</div>
                    {{/rollTotal() niv-degre jet_degre}}
                </div>
            </div>
        </div>
    </div>
</rolltemplate>

<!------------------------------------- Imago-Roll Template ------------------------------------->
<rolltemplate class="sheet-rolltemplate-imago">
    <div class="sheet-dice-box sheet-bg-imago">
        <h1>{{perso}}</h1>
        <div class="sheet-dice-subheader">
            <div>Matérialise l'aspect de son imago : </div>
            <div><span class="sheet-dice-bold">{{nom_aspect}}</span></div>
        </div>

        <div class="sheet-dice-main">
            <div class="sheet-dice-roll">
                <div>Cout payé :</div>
                <div>{{jet}} ( {{seuil}} )</div>
            </div>
        
            {{#rollLess() seuil jet}}
                    <div class="sheet-dice-result-ok">Réussite</div>
                    <div class="sheet-dice-effect">
                        <div><span class="sheet-dice-bold">Cout : </span>{{cout_aspect}}</div>
                        <div><span class="sheet-dice-bold">Durée : </span>{{duree_aspect}}</div>
                        <div><span class="sheet-dice-bold">Effet : </span>{{descrip_aspect}}</div>
                    </div>
            {{/rollLess() seuil jet}}
            
            {{#rollGreater() seuil jet}}
                    <div class="sheet-dice-result-ko">Echec</div>
            {{/rollGreater() seuil jet}}
            {{#rollTotal() seuil jet}}
                    <div class="sheet-dice-result-ok">Réussite</div>
                    <div class="sheet-dice-effect">
                        <div><span class="sheet-dice-bold">Cout : </span>{{cout_aspect}}</div>
                        <div><span class="sheet-dice-bold">Durée : </span>{{duree_aspect}}</div>
                        <div><span class="sheet-dice-bold">Effet : </span>{{descrip_aspect}}</div>
                    </div>
            {{/rollTotal() seuil jet}}
        </div>
    </div>
</rolltemplate>

<!------------------------------------- End Roll Templates ------------------------------------->


<!------------------------------------- End custom sheet here ------------------------------------->

 

<!------------------------------------- Begin Sheet Workers ------------------------------------->
 <script type="text/worker">

    /********************** Calculs lors des MaJ des Ka-Elements **********************/
    on("change:kalunenoire", function() {
        getAttrs([ "kalunenoire", ], function(values) {
            const kalunenoire = parseInt(values.kalunenoire);

            const output = {};

            // Mise à jour des caractéristiques généralles
            output['foo_init'] = kalunenoire;
            output['foo_mouv'] = kalunenoire;
			if( kalunenoire < 11 ) {
				output['foo_persp'] = 11 - kalunenoire;
				output['foo_recup'] = 11 - kalunenoire;
			} else {
				output['foo_persp'] = 1;
				output['foo_recup'] = 1;			
			}


            // Bonus dommages
            output['foo_bonus-dom'] = Math.floor(( kalunenoire - 1 )/ 10);

            // mise à jour des champs
            if(output) setAttrs(output);
        });
    });

    /********************** Calculs lors des Dommages magiques et physiques **********************/
    on("change:cons-min change:cons-ser change:cons-gra change:cons-mag-min change:cons-mag-ser change:cons-mag-gra", function() {
        getAttrs(["cons-min", "cons-ser", "cons-gra", "cons-mag-min", "cons-mag-ser", "cons-mag-gra"], function(values) {
            const output = {};
            output['total-malus'] = 0;

            // Si check alors cons_min = "on", on ajoute +2
            if (isNaN(parseInt(values["cons-min"]))) {
                output['total-malus'] += 2;
            }

            if (isNaN(parseInt(values["cons-ser"]))) {
                output['total-malus'] += 4;
            }

            if (isNaN(parseInt(values["cons-gra"]))) {
                output['total-malus'] += 6;
            }

            if (isNaN(parseInt(values["cons-mag-min"]))) {
                output['total-malus'] += 2;
            }

            if (isNaN(parseInt(values["cons-mag-ser"]))) {
                output['total-malus'] += 4;
            }

            if (isNaN(parseInt(values["cons-mag-gra"]))) {
                output['total-malus'] += 6;
            }

            // mise à jour des champs
            if(output) setAttrs(output);

        });
    });

    /********************** Calcul des invocation de Kabbale Noire à l'update des invocations **********************/

    on("change:repeating_kabb-invoc:kabb-invoc-ka change:repeating_kabb-invoc:kabb-invoc-sephira", function() {
        getAttrs([
        "repeating_kabb-invoc_kabb-invoc-ka", "repeating_kabb-invoc_kabb-invoc-sephira",
        "kaeau", "kafeu", "katerre", "kaair", "kalune", 
        "malkut", "yesod", "hod", "netzah", "tiphereth", "chesed", "geburah", "binah", "hokmah", "kheter"
        ], function(values) {

            var ka_element = values["repeating_kabb-invoc_kabb-invoc-ka"];
            var ka_element_value = getIntValue(values[ka_element]);

            var kabb_sephira = values["repeating_kabb-invoc_kabb-invoc-sephira"];
            var kabb_sephira_value = getIntValue(values[kabb_sephira]);

            var total = (ka_element_value + kabb_sephira_value);

            setAttrs({'repeating_kabb-invoc_kabb-invoc-current': total});
        });
    });

    /********************** Définition des fonctions génériques **********************/
    /**
    *  Fonction qui renvoie une valeur sous forme d'integer
    *  Return un entier ou 0
    **/
    function getIntValue(value) {
        if (!isEmpty(value)) {
            output = parseInt(value);
        } else {
            output = parseInt(0);
        }
        return output;
    }

    /**
    *  Fonction de vérification de variable undefined OU vide
    *  Return true si empty
    **/
    function isEmpty(str) {
        return (!str || 0 === str.length);
    }
    
</script>




