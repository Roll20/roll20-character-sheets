<html>
<link type="text/css" rel="stylesheet" href="arkadiumsheet.css">
<link type="text/javascript" href="arkadiumsheet.js">
<input type="hidden" class="sheet-tabstoggle" name="attr_sheetTab" value="character" />
<div>
   <button class="tabs" type="action" name="act_character">Character</button>
   <button class="tabs" type="action" name="act_spell">Spell</button>
   <button class="tabs" type="action" name="act_features"> Features</button>
   <button class="tabs" type="action" name="act_equipment"> Equipment</button>

</div>
<!--Inizio Chararacter Sheet-->
<div class="sheet-character">
   <span>

      <div class="sheet-header">
         <div class=" sheet-logo-header">
            <span>
               <img src="https://i.ibb.co/8xm64xb/logo-Arkadium.png" alt=""></span>
         </div>
         <div class="sheet-profile">
            <div class="sheet-stat-charbox">
               <legend> MAX HP:</legend> <input type="number" data-i18n="max_hp" name="attr_max_hp" id="max_hp"
                  title="@max_hp" value="0" placeholder="0" style="width:80px; color: green"></button>
               <legend> SPEED:</legend> <input type="number" name="attr_speed" title="@speed" id="speed"
                  value="{@speed}" style="width:40px; color: black"></button>
               <legend> B.COMP:</legend> <input type="number" name="attr_pb" title="@pb" id="pb" value="{@pb}"
                  style="width:40px; color: black"></button>
               <button class="iniziative" type="roll" name="roll_initiative"
                  value="&{template:custom} {{Title=Initiative}} {{Save=[[d20+@{dex_mod} &{tracker}]]}}">
                  Iniziative</button>


            </div>
            <div class="sheet-token">
               <img name="attr_character_token">
            </div>
            <button class="level_button" type="action" name="act_add" max_value="20">+</button>

            <span style="position:sticky;display: flex; top:45px;left: 200px;">
               <label for="sheetname">Name<input data-i18n="character_name" type="text" title="charater_name"
                     name="attr_character_name" placeholder="Name" id="sheetname" value=""
                     style="width: 125px;"></span></label>
            <span>

               <label for="sheetname">Class<input title="Class" type="text" name="attr_class" id="class"
                     placeholder="Class" value="" style="width: 75px;position: relative;">

            </span></label>
            <span>
               <span>

                  <label for="sheetname">Background<input title="Background" type="text" name="attr_Background"
                        id="Background" placeholder="Background" value="" style="width: 95px;position: relative;">


               </span></label>
               <span>

                  <label for="sheetname">Race/Subrace<input title="Race/Subrace" type="text" name="attr_race" id="race"
                        placeholder="Race" value="" style="width: 95px;position: relative;">


               </span></label>
               <span>

                  <label for="sheetname">Level<input type="number" name="attr_level" id="lv" placeholder="1" value="1"
                        min="1" max="20">
                     <legend> AC:</legend> <input type="number" name="attr_ac" title="@ac" id="ac" value="{@ac}"
                        style="width:40px; color: purple"></button>
                     <legend>HP:</legend> <input type="number" name="attr_hp" title="@hp" value="{@con}" id="hp"
                        style="color:green;"></button>
                     <legend> TEMP HP:</legend> <input type="number" name="attr_temphp" title="@temphphp" value=""
                        id="temphp" style="color:rgb(141, 237, 141);"></button>
               </span></label>
               <div class="sheet-ka-charbox">
                  <span class="sheet-karma-points"><label for="karma-points">Karma Point<input type="number"
                           name="attr_karma" id="karma-points" min="0" max="100" value="0"
                           style="width: 50px ; border-radius: 10%; right: 73px; top: 25px; border: none; font-size: 14px;">
                     </label></span>


               </div>

         </div>

      </div>
   </span>

   <div class="insp-prof-container">
      <div class="value">
         <input class="dragon" type="checkbox" checked  id="round" style="width: 40px;height: 40px;border: 3px solid black;position: relative;left: 5px; top:5px;
         " name="attr_inspiration"><label for="round"
            class="ispirationdragon">Inspiration</label>
      </div>
   </div>
   <div class="sheet-gamestat">
      <div class="containerstat1">
         <label class="labelstat" style="width:50px;"><button type="roll" class="statbutton"
               style="position: relative; left: 12px;top: 3.3px;"
               value="&{template:custom} {{Name= Strenght}} {{Roll=[[1d20 + @{str_mod}]]}}">Str</button><input
               name="attr_str" id="str" type="text" min="0" max="30" title="@{str}" placeholder="0" value=""
               style="width:40px; height:40px;border-top-left-radius: 20px;border-top-right-radius: 20px; border-top: 3px double black; border-right: 3px double black;border-left: 3px double black;border-bottom: none; font-size: 12px; align-items: center;position: relative; left: 5px; top: 3px;"></label>
         <input class="mod" name="attr_str_mod" type="text" value="2 + 2" title="@str_mod" id="str_mod"
            style="height: 10px; position: relative; top: 70.5px;left: -50px;">
         <label class="labelstat" style="width:50px;"><button type="roll" class="statbutton"
               style="position: relative; left: 12px;top: 3.3px;">Dex</button><input name="attr_dex" id="dex"
               type="number" min="0" max="30" title="@{Dex}" placeholder="0" value="10"
               style="width:40px; height:40px;border-top-left-radius: 20px;border-top-right-radius: 20px; border-top: 3px double black; border-right: 3px double black;border-left: 3px double black;border-bottom: none; font-size: 12px; align-items: center;position: relative; left: 5px; top: 3px;"></label>
         <input class="mod" name="attr_dex_mod" type="text" value="0" title="@dex_mod" id="dex_mod"
            style="height: 10px;position: relative; top: 70.5px;left: -50px;">
         <label class="labelstat" style="width:50px;"><button type="roll" class="statbutton"
               style="position: relative; left: 12px;top: 3.3px;">Con</button><input name="attr_con" id="con"
               type="number" min="0" max="30" title="@{Con}" placeholder="0" value="10"
               style="width:40px; height:40px;border-top-left-radius: 20px;border-top-right-radius: 20px; border-top: 3px double black; border-right: 3px double black;border-left: 3px double black;border-bottom: none; font-size: 12px; align-items: center;position: relative; left: 5px; top: 3px;"></label>
         <input class="mod" name="attr_con_mod" type="text" value="0" title="@con_mod" id="con_mod"
            style="height: 10px;position: relative; top: 70.5px;left: -50px;">
         <label class="labelstat" style="width:50px;"><button type="roll" class="statbutton"
               style="position: relative; left: 12px;top: 3.3px;">Int</button><input name="attr_int" id="int"
               type="number" min="0" max="30" title="@{Int}" placeholder="0" value="10"
               style="width:40px; height:40px;border-top-left-radius: 20px;border-top-right-radius: 20px; border-top: 3px double black; border-right: 3px double black;border-left: 3px double black;border-bottom: none; font-size: 12px; align-items: center;position: relative; left: 5px; top: 3px;"></label>
         <input class="mod" name="attr_int_mod" type="text" value="0" title="@int_mod" id="int_mod"
            style="height:10px;position: relative; top: 70.5px;left: -50px;">
         <label class="labelstat" style="width:50px;"><button type="roll" class="statbutton"
               style="position: relative; left: 12px;top: 3.3px;">Wis</button><input name="attr_wis" id="str"
               type="number" min="0" max="30" title="@{Wis}" placeholder="0" value="10"
               style="width:40px; height:40px;border-top-left-radius: 20px;border-top-right-radius: 20px; border-top: 3px double black; border-right: 3px double black;border-left: 3px double black;border-bottom: none; font-size: 12px; align-items: center;position: relative; left: 5px; top: 3px;"></label>
         <input class="mod" name="attr_wis_mod" type="text" value="0" title="@wis_mod" id="wis_mod"
            style="height: 10px;position: relative; top: 70.5px;left: -50px;">
         <label class="labelstat" style="width:50px;"><button type="roll" class="statbutton"
               style="position: relative; left: 12px;top: 3.3px;">Cha</button><input name="attr_cha" id="cha"
               type="number" min="0" max="30" title="@{Cha}" placeholder="0" value="10"
               style="width:40px; height:40px;border-top-left-radius: 20px;border-top-right-radius: 20px; border-top: 3px double black; border-right: 3px double black;border-left: 3px double black;border-bottom: none; font-size: 12px; align-items: center;position: relative; left: 5px; top: 3px;"></label>
         <input class="mod" name="attr_cha_mod" type="text" value="0" title="@cha_mod" id="cha_mod"
            style="height: 10px;position: relative; top: 70.5px;left: -50px;">

      </div>
      <div class="deadthrown">
         <button class="iniziative" type="roll" name="attr_deadsavingthrown"
            value="&{template:custom} {{Title= Dead Saving Thrown}} {{Roll=[[1d20]]}}"> <img
               src="https://svgsilh.com/svg/30325.svg" alt=""></button>
         <label class="form-check-label">
            Fail
            <input type="checkbox" class="form-check-input" id="dead" value="checkedValue">
            <input type="checkbox" class="form-check-input" id="dead" value="checkedValue">
            <input type="checkbox" class="form-check-input" id="dead" value="checkedValue">
         </label>

         <label class="form-check-label">
            Save
            <input type="checkbox" class="form-check-input" id="save" value="checkedValue">
            <input type="checkbox" class="form-check-input" id="save" value="checkedValue">
            <input type="checkbox" class="form-check-input" id="save" value="checkedValue">
         </label>

      </div>
   </div>


</div>

<!--Inizio spellpage!-->

<div class="sheet-spell">
   <h2>Spell</h2>

</div>

<!--fine spellpage!-->

<div class="sheet-equipment">
   <h2>Equipment</h2>

</div>


<script type="text/worker">


   const buttonlist = ["character","spell","features","equipment"];
   buttonlist.forEach(button => {
       on(`clicked:${button}`, function() {
           setAttrs({
               sheetTab: button
           });
       });
   });
   on('clicked:add', function() {
      getAttrs(['level','newlevel'], function(values) {
          // get the level stat, and coerce into a numerical value.
          const level = +values.level || 0; 
          // increase by 1
          const newlevel = level +1; 
      
   
          // save the updated attribute to the sheet
          setAttrs({
             level: newlevel
            
          });

     });
  });

      $20('button.roll').on('click', async (e) => {
          const roll = e.altKey ? '/w gm [[1d20]]' : '[[1d20]]';
          const results = await startRoll(roll);
          finishRoll(results.rollId);
      });
  <rolltemplate class="sheet-rolltemplate-custom">
   <div class="sheet-container sheet-color-{{color}}">
     <div class="sheet-header">
       {{#title}}<div class="sheet-title">{{title}}</div>{{/title}}
       {{#subtitle}}<div class="sheet-subtitle">{{subtitle}}</div>{{/subtitle}}
     </div>
     <div class="sheet-content">
       {{#allprops() title subtitle desc color}}
       <div class="sheet-key">{{key}}</div>
       <div class="sheet-value">{{value}}</div>
       {{/allprops() title subtitle desc color}}
       {{#desc}}<div class="sheet-desc">{{desc}}</div>{{/desc}}
     </div>
   </div>
 </rolltemplate>



 const stats = ['str','dex','con','int','wis','cha'];
 stats.forEach(stat => {
     on(`change:${stat} sheet:opened`, () => {
         getAttrs([stat], values => {
             const stat_score = parseInt(values[stat])||0;
             const stat_modifier = Math.floor(stat_score/2) -5;
             setAttrs({
                 [`${stat}_mod`]: stat_modifier 
             });
         });
     });
 });
 on("change:siz change:con sheet:opened", function() {
   //sheetworker triggers on any changes to the "siz" or "con" attribute, or when sheet is opened.
	getAttrs(["hp","con_mod"], function(values) {
            //get the values for the two attributes, so they can used.
		let hp = parseInt(values.SIZ)||10;
		let mod_con = parseInt(values.mod_con)||0;
                   //saves the current values of the two attributes on two temporary variables, which then can be used easily in calculations.
		let max_hp = hp + mod_con;
                    // defines new variable, based on the sum of the two attributes
		setAttrs({                            
			hitpoints: max_hp
                           // changes the "hitpoints" sheet attribute to be the value of our temporary variable "hp"
		});
	});
});


 
  
   
</script>



</html>