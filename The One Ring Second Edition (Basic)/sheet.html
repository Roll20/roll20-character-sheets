
<input type="hidden" name="attr_sheetversion" value="2.00" />
<input type="hidden" name="attr_version" value="0" />
<input type="hidden" name="attr_newchar" value="1" />
<input type="checkbox" name="attr_parsedrolls" value="1" class="hidden config-parsed-rolls" hidden readonly />

<div class="sheet-pc sheetgrid-main">
	<div class="sheetgrid-1col row1 cols1-2 top-pane">
		<div class="name">
			<span class="label name red">Name</span>
			<input type="text" name="attr_character_name" style="width: 100%;">
		</div>
	</div>
	<div class="sheetgrid-1col col1 sheetgrid-col1 left-pane">
		<div class="sheetgrid-3cols row2 info">
			<div class="sheet-col col1 row1">
				<span class="label">Heroic Culture</span>
				<input type="text" name="attr_culture" style="width: 100%;">
				<span class="label">Cultural Blessing</span>
				<input type="text" name="attr_cultural_blessing">
				<span class="label">Calling</span>
				<input type="text" name="attr_calling">
			</div>
			<div class="sheet-col col2 row1">
				<span class="label oneq age">Age</span>
				<span class="label threeq livingstandard">Standard of Living</span>
				<input type="number" name="attr_age" class="oneq age">
				<input type="text" name="attr_standard_of_living" class="threeq livingstandard">				
				<span class="label">Patron</span>
				<input type="text" name="attr_patron">
				<span class="label">Shadow Path</span>
				<input type="text" name="attr_shadow_weakness">
			</div>
			<div class="sheet-col col3 row1">
				<span class="label">Distinctive Features</span>
				<!-- <textarea name="attr_distinctive_features" style="width: 100%;"/> -->				
				<input type="text" name="attr_distinctive_features">	
				<span class="">&nbsp;</span>		
				<input type="text" name="attr_distinctive_features2">			
				<!-- <input type="text" name="attr_distinctive_features3"> -->			
				<span class="label">Flaws</span>
				<input type="text" name="attr_flaws">
			</div>
		</div>
		<div class="sheetgrid-5cols-mid row3">
			<div class="sheetgrid-1col col1 row1 strength-column">
				<div class="sheet-col col1 row1 attribute-row strength-box">
					<div class="sheet-row">
						<!-- <button type="action" class="parsed-rolls" name="act_strength" id="roll_strength"></button> -->
						<h2>Strength</h2>
<!-- 						<div class="sheet-hover-info">A character with a high Strength score can be tough and fit, or tall and agile, or even attractive or imposing. Every aspect of a character that relies on vigour or physical well-being is represented in the game by Strength.</div>
 -->				</div>
					<div class="sheet-row attribute">
						<span class="label row2 col1 label-strength-tn">TN</span>
						<span class="attribute row1 col2">
							<input name="attr_strengthtn" class="attribute" type="number" value="0">
						</span>
						<span class="secondary-attribute secondary-attribute-top row1 col3">
							<input name="attr_strength" class="secondary-attribute input-strength-rating" type="number" value="0">
						</span>
						<span class="label row1 col3 label-strength-rating">Rating</span>
						<span class="secondary-attribute row2 col3">
							<input name="attr_endurance" class="secondary-attribute input-strength-endurance" value="0" type="number">
						</span>
						<span class="label row2 col3 label-strength-endurance">Endurance</span>
					</div>
				</div>
				<div class="sheet-col col1 row2 skill-header vertical-redbg"></div>
				<div class="sheet-col col1 row3 skills-row strength-skills">						
					<div class="sheet-row">
						<button type="roll" class="table-rolls" value="/me rolls for Awe against Strength TN (@{strengthtn}) .\n/roll @{favorill} + (@{awe}+?{Bonus Dice|0})t[@{wearytype}]" name="roll_awecheck"></button>
						<!-- <button type="roll" class="table-rolls" value="&{template:default} {{title=Awe}} {{subtitle=@{character_name}}} {{feat=[[1d12+@{awe}D6]]}} {{fav=[[2d12kh1+@{awe}D6]]}} {{ill=[[2d12kl1+@{awe}D6]]}} {{Target=@{strengthtn}}} {{Normal=feat-Target}}" name="roll_awecheck2"></button> -->
						<button type="action" class="parsed-rolls" name="act_awe" id="roll_awe"></button>
						<input type="checkbox" value="1" name="attr_awe_favoured">
						<label for="roll_awecheck" class="label table-rolls" data-i18n="awe">Awe</label>
						<label for="roll_awe" class="label parsed-rolls" data-i18n="awe">Awe</label>
						<div class="sheet-hover-info">This skill measures a hero’s capacity to provoke respect in onlookers, and determines the impression a hero makes on someone he meets for the first time. Depending on the circumstances and the hero’s intentions or disposition, it can be used to instil wonderment, admiration, or even fear. <span class='sheet-strong'>Awe</span> arises from a character’s native charisma, but can also be engineered with a dramatic entrance or impressive attire.<br><br>A successful use of the skill provokes the chosen effect. A failure fails to have any impact, or can even lead to the opposite result! Achieving a great success means that the hero has won the hearts of the onlookers, or cowed them into silent submission. An extraordinary success may produce open reverence, or panic.</div>
						<div class="sheet-dots">
							<input type="radio" name="attr_awe" value="0" checked="checked" /><span></span>
							<input type="radio" name="attr_awe" value="1" /><span></span>
							<input type="radio" name="attr_awe" value="2" /><span></span>
							<input type="radio" name="attr_awe" value="3" /><span></span>
							<input type="radio" name="attr_awe" value="4" /><span></span>
							<input type="radio" name="attr_awe" value="5" /><span></span>
							<input type="radio" name="attr_awe" value="6" /><span></span>
						</div>
					</div>
				
					<div class="sheet-row">
						<button type="roll" class="table-rolls" value="/me rolls for Athletics against Strength TN (@{strengthtn}) .\n/roll @{favorill} + (@{athletics}+?{Bonus Dice|0})t[@{wearytype}]" id="roll_athleticscheck" name="roll_athleticscheck"></button>
						<button type="action" class="parsed-rolls" name="act_athletics" id="roll_athletics"></button>
						<input type="checkbox" name="attr_athletics_favoured">
						<label for="roll_athleticscheck" class="label table-rolls" data-i18n="athletics">Athletics</label>
						<label for="roll_athletics" class="label parsed-rolls" data-i18n="athletics">Athletics</label>
						<div class="sheet-hover-info" data-i18n="athletics-description"><span class='sheet-strong'>Athletics</span> is a broad skill, covering most of the physical activities that a hero might undertake while adventuring, including r unning, leaping, climbing, swimming and throwing stones or other small objects. Heroes with high <span class='sheet-strong'>Athletics</span> skill scores exhibit a winning combination of physical prowess, grace and control, generally gained through continuous exercise and daily exertion.<br><br>A successful <span class='sheet-strong'>Athletics</span> roll produces a satisfactory outcome in the physical activity, while a failed roll might even lead to serious harm, depending on the circumstances. A great or extraordinary result suggests a spectacular achievement.</div>
						<div class="sheet-dots">
							<input type="radio" name="attr_athletics" value="0" checked="checked" /><span></span>
							<input type="radio" name="attr_athletics" value="1" /><span></span>
							<input type="radio" name="attr_athletics" value="2" /><span></span>
							<input type="radio" name="attr_athletics" value="3" /><span></span>
							<input type="radio" name="attr_athletics" value="4" /><span></span>
							<input type="radio" name="attr_athletics" value="5" /><span></span>
							<input type="radio" name="attr_athletics" value="6" /><span></span>
						</div>
					</div>

					<div class="sheet-row">
						<button type="roll" class="table-rolls" value="/me rolls for Awareness against Strength TN (@{strengthtn}) .\n/roll @{favorill} + (@{awareness}+?{Bonus Dice|0})t[@{wearytype}]" name="roll_awarenesscheck"></button>
						<button type="action" class="parsed-rolls" name="act_awareness" id="roll_awareness"></button>
						<input type="checkbox" name="attr_awareness_favoured">
						<label for="roll_awarenesscheck" class="label table-rolls" data-i18n="awareness">Awareness</label>
						<label for="roll_awareness" class="label parsed-rolls" data-i18n="awareness">Awareness</label>
						<div class="sheet-hover-info" data-i18n="awareness-description">The <span class='sheet-strong'>Awareness</span> skill represents a hero's readiness to react and his ability to notice something unexpected, out of the ordinary, or difficult to detect. High skill reflects both keen senses and the experience to understand what you see and hear.<br><br>A high <span class='sheet-strong'>Awareness</span> rating expresses an extraordinar y watchfulness, and is extremely useful to a companion who ser ves as a look-out for the company.</div>
						<div class="sheet-dots">
							<input type="radio" name="attr_awareness" value="0" checked="checked" /><span></span>
							<input type="radio" name="attr_awareness" value="1" /><span></span>
							<input type="radio" name="attr_awareness" value="2" /><span></span>
							<input type="radio" name="attr_awareness" value="3" /><span></span>
							<input type="radio" name="attr_awareness" value="4" /><span></span>
							<input type="radio" name="attr_awareness" value="5" /><span></span>
							<input type="radio" name="attr_awareness" value="6" /><span></span>
						</div>
					</div>

					<div class="sheet-row">
						<button type="roll" class="table-rolls" value="/me rolls for Hunting against Strength TN (@{strengthtn}) .\n/roll @{favorill} + (@{hunting}+?{Bonus Dice|0})t[@{wearytype}]" name="roll_huntingcheck"></button>
						<button type="action" class="parsed-rolls" name="act_hunting" id="roll_hunting"></button>
						<input type="checkbox" name="attr_hunting_favoured">
						<label for="roll_huntingcheck" class="label table-rolls" data-i18n="hunting">Hunting</label>
						<label for="roll_hunting" class="label parsed-rolls" data-i18n="hunting">Hunting</label>
						<div class="sheet-hover-info" data-i18n="hunting-description">Knowing how to hunt is a fundamental skill common in much of Middle-earth. A <span class='sheet-strong'>Hunting</span> roll may be required when pursuing a creature through wild areas, or to locate tracks and follow them, or to identify a quarry by its spoor. The skill also covers preparing traps and the training and use of hunting dogs or birds. In wilder areas, hunters learn to apply their trade to more dangerous quarry, such as Orcs, Spiders or Wargs, or else risk becoming the prey.</div>
						<div class="sheet-dots">
							<input type="radio" name="attr_hunting" value="0" checked="checked" /><span></span>
							<input type="radio" name="attr_hunting" value="1" /><span></span>
							<input type="radio" name="attr_hunting" value="2" /><span></span>
							<input type="radio" name="attr_hunting" value="3" /><span></span>
							<input type="radio" name="attr_hunting" value="4" /><span></span>
							<input type="radio" name="attr_hunting" value="5" /><span></span>
							<input type="radio" name="attr_hunting" value="6" /><span></span>
						</div>
					</div>

					<div class="sheet-row">
						<button type="roll" class="table-rolls" value="/me rolls for Song against Strength TN (@{strengthtn}) .\n/roll @{favorill} + (@{song}+?{Bonus Dice|0})t[@{wearytype}]" name="roll_songcheck"></button>
						<button type="action" class="parsed-rolls" name="act_song" id="roll_song"></button>
						<input type="checkbox" name="attr_song_favoured">
						<label for="roll_songcheck" class="label table-rolls" data-i18n="song">Song</label>
						<label for="roll_song" class="label parsed-rolls" data-i18n="song">Song</label>
						<div class="sheet-hover-info" data-i18n="song-description">Hobbits and Men, Elves and Dwarves, even Goblins and maybe Orcs: all the creatures of Middle-earth celebrate by playing music and singing songs. Great deeds and grim misfortunes are remembered in verse, and pleasant or even comic stories are told to ease spirits and find comfort.<br><br><span class='sheet-strong'>Song</span> is used to recite poems, sing songs or play instruments suitable to the character's culture. It can also be used to learn new works or create original compositions.</div>
						<div class="sheet-dots">
							<input type="radio" name="attr_song" value="0" checked="checked" /><span></span>
							<input type="radio" name="attr_song" value="1" /><span></span>
							<input type="radio" name="attr_song" value="2" /><span></span>
							<input type="radio" name="attr_song" value="3" /><span></span>
							<input type="radio" name="attr_song" value="4" /><span></span>
							<input type="radio" name="attr_song" value="5" /><span></span>
							<input type="radio" name="attr_song" value="6" /><span></span>
						</div>
					</div>

					<div class="sheet-row">
						<button type="roll" class="table-rolls" value="/me rolls for Craft against Strength TN (@{strengthtn}) .\n/roll @{favorill} + (@{craft}+?{Bonus Dice|0})t[@{wearytype}]" name="roll_craftcheck"></button>
						<button type="action" class="parsed-rolls" name="act_craft" id="roll_craft"></button>
						<input type="checkbox" name="attr_craft_favoured">
						<label for="roll_craftcheck" class="label table-rolls" data-i18n="craft">Craft</label>
						<label for="roll_craft" class="label parsed-rolls" data-i18n="craft">Craft</label>
						<div class="sheet-hover-info" data-i18n="craft-description">The <span class='sheet-strong'>Craft</span> skill doesn't really cover the whole range of abilities of smiths, wrights and other artisans, but reflects the talent of a character for making or mending things by hand, although Traits like Smithcraft or Woodwright can be used to reflect proficiency in a specific craft. Craft could be used to attempt to repair the wheel of a cart, or construct an improvised raft with wood found on a river shore, or even when trying to start a fire on a windy hill.<br><br>A high <span class='sheet-strong'>Craft</span> score may indicate that the hero was a craftsman before starting his life of adventure. Some races, such as the Dwar ves and Noldor Elves, revere crafts as the highest expression of creativity.</div>
						<div class="sheet-dots">
							<input type="radio" name="attr_craft" value="0" checked="checked" /><span></span>
							<input type="radio" name="attr_craft" value="1" /><span></span>
							<input type="radio" name="attr_craft" value="2" /><span></span>
							<input type="radio" name="attr_craft" value="3" /><span></span>
							<input type="radio" name="attr_craft" value="4" /><span></span>
							<input type="radio" name="attr_craft" value="5" /><span></span>
							<input type="radio" name="attr_craft" value="6" /><span></span>
						</div>
					</div>

				</div>
				<div class="sheet-col col1 row4 skill-header vertical-redbg"></div>
				<div class="sheet-col col1 row5 additional-row combatprofs strength-combat">
					<div class="sheet-row">
						<h3>Combat Proficencies</h3>
					</div>
		
					<div class="sheet-row">
						<button type="roll" class="table-rolls" value="/me rolls for Axes against Strength TN (@{strengthtn}) .\n/roll @{favorill} + (@{axes}+?{Bonus Dice|0})t[@{wearytype}]" name="roll_axescheck"></button>
						<button type="action" class="parsed-rolls" name="act_axes" id="roll_axes"></button>
						<label for="roll_axescheck" class="label table-rolls" data-i18n="axes">Axes</label>
						<label for="roll_axes" class="label parsed-rolls" data-i18n="axes">Axes</label>
						<div class="sheet-hover-info" data-i18n="axes-description">Axes and other bashing weapons are often preferred to swords by warriors who favour a more brutal approach to fighting. Historically, the axe is the weapon of choice for most Dwarves, and for their folk it surpasses the sword in both nobility and respect. Dwarven weaponsmiths apply their cunning to making axes of many different shapes and uses, and from metals of various colours. The AXES Combat Proficiency allows a Player-hero to use an axe, a great axe, a long-hafted axe, but also bashing weapons like a club or a mattock.</div>
						<div class="sheet-dots">
							<input type="radio" name="attr_axes" value="0" checked="checked" /><span></span>
							<input type="radio" name="attr_axes" value="1" /><span></span>
							<input type="radio" name="attr_axes" value="2" /><span></span>
							<input type="radio" name="attr_axes" value="3" /><span></span>
							<input type="radio" name="attr_axes" value="4" /><span></span>
							<input type="radio" name="attr_axes" value="5" /><span></span>
							<input type="radio" name="attr_axes" value="6" /><span></span>
						</div>
					</div>
		
					<div class="sheet-row">
						<button type="roll" class="table-rolls" value="/me rolls for Bows against Strength TN (@{strengthtn}) .\n/roll @{favorill} + (@{bows}+?{Bonus Dice|0})t[@{wearytype}]" name="roll_bowscheck"></button>
						<button type="action" class="parsed-rolls" name="act_bows" id="roll_bows"></button>
						<label for="roll_bowscheck" class="label table-rolls" data-i18n="bows">Bows</label>
						<label for="roll_bows" class="label parsed-rolls" data-i18n="bows">Bows</label>
						<div class="sheet-hover-info" data-i18n="bows-description">A traditional hunting weapon, the bow is also commonly used in warfare. Made from a single piece of wood, or from a composition  of wood, horn, or even metal, bows are a versatile weapon. They can be used during sieges, from horseback, in dense woodland, or in the open field. Archers usually carry another weapon to draw when the enemy gets closer; they seldom carry shields, as they can’t use them when shooting a bow. The BOWS Combat Proficiency enables a Player-hero to make ranged attacks using a bow or a great bow.</div>
						<div class="sheet-dots">
							<input type="radio" name="attr_bows" value="0" checked="checked" /><span></span>
							<input type="radio" name="attr_bows" value="1" /><span></span>
							<input type="radio" name="attr_bows" value="2" /><span></span>
							<input type="radio" name="attr_bows" value="3" /><span></span>
							<input type="radio" name="attr_bows" value="4" /><span></span>
							<input type="radio" name="attr_bows" value="5" /><span></span>
							<input type="radio" name="attr_bows" value="6" /><span></span>
						</div>
					</div>
		
					<div class="sheet-row">
						<button type="roll" class="table-rolls" value="/me rolls for Spears against Strength TN (@{strengthtn}) .\n/roll @{favorill} + (@{spears}+?{Bonus Dice|0})t[@{wearytype}]" name="roll_spearscheck"></button>
						<button type="action" class="parsed-rolls" name="act_spears" id="roll_spears"></button>
						<label for="roll_spearscheck" class="label table-rolls" data-i18n="spears">Spears</label>
						<label for="roll_spears" class="label parsed-rolls" data-i18n="spears">Spears</label>
						<div class="sheet-hover-info" data-i18n="spears-description">The spear is arguably the most widespread weapon across Middle-earth, arming kings and soldiers, riders and infantry. It is often no more than a long wooden shaft, tipped by a leaf-shaped metal head, but some spears are works of majestic artisanship, valuable heirlooms of noble households. The length of a spear varies according to the use it is designed for. Spears can be wielded one or two-handed to thrust and lunge, cast to pierce from a distance, or used from horseback as lances. Warriors equipped with a spear typically use it in conjunction with a shield, and they usually carry an additional weapon, such as a sword or axe. The SPEARS Combat Proficiency allows a hero to make ranged and close combat attacks using a short spear or a spear, or to fight in close combat using a great spear.</div> 
						<div class="sheet-dots">
							<input type="radio" name="attr_spears" value="0" checked="checked" /><span></span>
							<input type="radio" name="attr_spears" value="1" /><span></span>
							<input type="radio" name="attr_spears" value="2" /><span></span>
							<input type="radio" name="attr_spears" value="3" /><span></span>
							<input type="radio" name="attr_spears" value="4" /><span></span>
							<input type="radio" name="attr_spears" value="5" /><span></span>
							<input type="radio" name="attr_spears" value="6" /><span></span>
						</div>
					</div>
		
					<div class="sheet-row">
						<button type="roll" class="table-rolls" value="/me rolls for Swords against Strength TN (@{strengthtn}) .\n/roll @{favorill} + (@{swords}+?{Bonus Dice|0})t[@{wearytype}]" name="roll_swordscheck"></button>
						<button type="action" class="parsed-rolls" name="act_swords" id="roll_swords"></button>
						<label for="roll_swordscheck" class="label table-rolls" data-i18n="swords">Swords</label>
						<label for="roll_swords" class="label parsed-rolls" data-i18n="swords">Swords</label>
						<div class="sheet-hover-info" data-i18n="swords-description">The sword with a straight blade has always been the weapon of choice among free Men and Elves. A mark of nobility or rank, swords of superior make are passed down by generations of warriors, and arms of ancient lineage are often imbued with spells and curses, the bane of the servants of the Shadow. Swords vary in size, shape, and quality as diverse as the folks that craft them. Many malevolent creatures have devised swords after their own fashion, usually crude counterfeits of those made by Men and Elves. The SWORDS Combat Proficiency enables a Player-hero to attack in close combat using short swords, swords, and long swords.</div> 
						<div class="sheet-dots">
							<input type="radio" name="attr_swords" value="0" checked="checked" /><span></span>
							<input type="radio" name="attr_swords" value="1" /><span></span>
							<input type="radio" name="attr_swords" value="2" /><span></span>
							<input type="radio" name="attr_swords" value="3" /><span></span>
							<input type="radio" name="attr_swords" value="4" /><span></span>
							<input type="radio" name="attr_swords" value="5" /><span></span>
							<input type="radio" name="attr_swords" value="6" /><span></span>
						</div>
					</div>
				</div>
			</div>
			<!-- <div class="mid-pane-hspacer col2 row1"></div> -->
			<div class="sheetgrid-1col col2 row1 heart-column">
				<div class="sheet-col col1 row1 attribute-row heart-box">
					<div class="sheet-row">
						<h2>Heart</h2>
<!-- 						<div class="sheet-hover-info" data-i18n="heart-description">Measures a character's capacity for emotion, energy and enthusiasm. A hero with a high Heart score can be fiery, intense, and hard to demoralise. Activities that benefit from a passionate or energetic temper may be influenced by a character's Heart score.</div>
 -->					</div>
					<div class="sheet-row attribute">
						<span class="label row2 col1 label-heart-tn">TN</span>
						<span class="attribute row1 col2">
							<input name="attr_hearttn" class="attribute" type="number" value="0">
						</span>
						<span class="secondary-attribute secondary-attribute-top row1 col3">
							<input name="attr_heart" class="secondary-attribute input-heart-rating" type="number" value="0">
						</span>
						<span class="label row1 col3 label-heart-rating">Rating</span>
						<span class="secondary-attribute row2 col3">
							<input name="attr_hope" class="secondary-attribute input-heart-hope" value="0" type="number">
						</span>
						<span class="label row2 col3 label-heart-hope">Hope</span>
					</div>
				</div>
				<div class="sheet-col col1 row2 skill-header">
					<span class="vertical-redbg">&nbsp;</span>
					<h3 class="center red whitebg">Skills</h3>
					<span class="vertical-redbg">&nbsp;</span>
				</div>
				<div class="sheet-col col1 row3 skills-row heart-skills">				
					<div class="sheet-row">
						<button type="roll" class="table-rolls" value="/me rolls for Enhearten against Heart TN (@{hearttn}) .\n/roll @{favorill} + (@{enhearten}+?{Bonus Dice|0})t[@{wearytype}]" name="roll_enheartencheck"></button>
						<button type="action" class="parsed-rolls" name="act_enhearten" id="roll_enhearten"></button>
						<input type="checkbox" name="attr_enhearten_favoured">
						<label for="roll_enheartencheck" class="label table-rolls" data-i18n="enhearten">Enhearten</label>
						<label for="roll_enhearten" class="label parsed-rolls" data-i18n="enhearten">Enhearten</label>
						<div class="sheet-hover-info" data-i18n="enhearten-description">Player-heroes can use the ENHEARTEN Skill to instil positive feelings in others, urging them to act on the matter at hand. They achieve this mainly through example, charisma, and personal conviction, rather than through the effective use of words (which falls under PERSUADE below). This Skill can be used on individuals, but is particularly effective in influencing crowds. Player-heroes with high ENHEARTEN ratings can be forceful orators, passionate agitators, and well-loved leaders. A successful ENHEARTEN roll awakens a chosen feeling in the subject, as long as it is not in opposition to their current mood. A superior success is enough to influence wholly disinterested individuals, or turn rivals into supporters.</div> 
						<div class="sheet-dots">
							<input type="radio" name="attr_enhearten" value="0" checked="checked" /><span></span>
							<input type="radio" name="attr_enhearten" value="1" /><span></span>
							<input type="radio" name="attr_enhearten" value="2" /><span></span>
							<input type="radio" name="attr_enhearten" value="3" /><span></span>
							<input type="radio" name="attr_enhearten" value="4" /><span></span>
							<input type="radio" name="attr_enhearten" value="5" /><span></span>
							<input type="radio" name="attr_enhearten" value="6" /><span></span>
						</div>
					</div>


					<div class="sheet-row">
						<button type="roll" class="table-rolls" value="/me rolls for Travel against Heart TN (@{hearttn}) .\n/roll @{favorill} + (@{travel}+?{Bonus Dice|0})t[@{wearytype}]" name="roll_travelcheck"></button>
						<button type="action" class="parsed-rolls" name="act_travel" id="roll_travel"></button>
						<input type="checkbox" name="attr_travel_favoured">
						<label for="roll_travelcheck" class="label table-rolls" data-i18n="travel">Travel</label>
						<label for="roll_travel" class="label parsed-rolls" data-i18n="travel">Travel</label>
						<div class="sheet-hover-info">In the Third Age, the cities, villages and towns of Middle- earth are often separated by many leagues of wild or deserted areas. Roads that used to lead safely to distant realms now end in broken trails that go nowhere.<br><br>When the company needs to cover a distance across uncertain territory, including by boat, every companion is required to perform one or more tests using the <span class='sheet-strong'>Travel</span> skill to avoid becoming weary too soon. While certainly the product of exper ience, the use of Travel benef its mostly from a hero's strength of spirit.</div>
						<div class="sheet-dots">
							<input type="radio" name="attr_travel" value="0" checked="checked" /><span></span>
							<input type="radio" name="attr_travel" value="1" /><span></span>
							<input type="radio" name="attr_travel" value="2" /><span></span>
							<input type="radio" name="attr_travel" value="3" /><span></span>
							<input type="radio" name="attr_travel" value="4" /><span></span>
							<input type="radio" name="attr_travel" value="5" /><span></span>
							<input type="radio" name="attr_travel" value="6" /><span></span>
						</div>
					</div>

					<div class="sheet-row">
						<button type="roll" class="table-rolls" value="/me rolls for Insight against Heart TN (@{hearttn}) .\n/roll @{favorill} + (@{insight}+?{Bonus Dice|0})t[@{wearytype}]" name="roll_insightcheck"></button>
						<button type="action" class="parsed-rolls" name="act_insight" id="roll_insight"></button>
						<input type="checkbox" name="attr_insight_favoured">
						<label for="roll_insightcheck" class="label table-rolls" data-i18n="insight">Insight</label>
						<label for="roll_insight" class="label parsed-rolls" data-i18n="insight">Insight</label>
						<div class="sheet-hover-info" data-i18n="insight-description"><span class='sheet-strong'>Insight</span> is the ability of a hero to see beyond appearances, recognising people's hidden thoughts and beliefs. Heroes with <span class='sheet-strong'>Insight</span> can recognise when someone is lying, and can draw useful conclusions about people's motives. A hero with a high <span class='sheet-strong'>Insight</span> score is often recognised as being a sensible and discerning individual, and many might seek his counsel. A successful <span class='sheet-strong'>Insight</span> roll provides the hero with a faithful, if partial, portrait of the character observed. A great or extraordinary success reveals truths about an individual of which he himself is ignorant. <span class='sheet-strong'>Insight</span> tests may be rolled in opposition to an adversary using <span class='sheet-strong'>Persuade</span> or another Personality skill.</div>
						<div class="sheet-dots">
							<input type="radio" name="attr_insight" value="0" checked="checked" /><span></span>
							<input type="radio" name="attr_insight" value="1" /><span></span>
							<input type="radio" name="attr_insight" value="2" /><span></span>
							<input type="radio" name="attr_insight" value="3" /><span></span>
							<input type="radio" name="attr_insight" value="4" /><span></span>
							<input type="radio" name="attr_insight" value="5" /><span></span>
							<input type="radio" name="attr_insight" value="6" /><span></span>
						</div>
					</div>

					<div class="sheet-row">
						<button type="roll" class="table-rolls" value="/me rolls for Healing against Heart TN (@{hearttn}) .\n/roll @{favorill} + (@{healing}+?{Bonus Dice|0})t[@{wearytype}]" name="roll_healingcheck"></button>
						<button type="action" class="parsed-rolls" name="act_healing" id="roll_healing"></button>
						<input type="checkbox" name="attr_healing_favoured">
						<label for="roll_healingcheck" class="label table-rolls" data-i18n="healing">Healing</label>
						<label for="roll_healing" class="label parsed-rolls" data-i18n="healing">Healing</label>
						<div class="sheet-hover-info" data-i18n="healing-description">The knowledge of how to relieve pain and apply remedies to restore health to the suffering is an ancient one, and treatments differ from culture to culture. Almost all traditions, however, agree on the treatment of serious injuries, which must be immediately tended to keep from worsening.<br><br>The <span class='sheet-strong'>Healing</span> skill includes bone setting and the use of herbs or salves, but the outcome relies on the ability of the healer to understand what ails the sufferer and determine what should be done.</div>
						<div class="sheet-dots">
							<input type="radio" name="attr_healing" value="0" checked="checked" /><span></span>
							<input type="radio" name="attr_healing" value="1" /><span></span>
							<input type="radio" name="attr_healing" value="2" /><span></span>
							<input type="radio" name="attr_healing" value="3" /><span></span>
							<input type="radio" name="attr_healing" value="4" /><span></span>
							<input type="radio" name="attr_healing" value="5" /><span></span>
							<input type="radio" name="attr_healing" value="6" /><span></span>
						</div>
					</div>

					<div class="sheet-row">
						<button type="roll" class="table-rolls" value="/me rolls for Courtesy against Heart TN (@{hearttn}) .\n/roll @{favorill} + (@{courtesy}+?{Bonus Dice|0})t[@{wearytype}]" name="roll_courtesycheck"></button>
						<button type="action" class="parsed-rolls" name="act_courtesy" id="roll_courtesy"></button>
						<input type="checkbox" name="attr_courtesy_favoured">
						<label for="roll_courtesycheck" class="label table-rolls" data-i18n="courtesy">Courtesy</label>
						<label for="roll_courtesy" class="label parsed-rolls" data-i18n="courtesy">Courtesy</label>
						<div class="sheet-hover-info" data-i18n="courtesy-description">The Free Peoples recognise common norms of decency and ancient conventions of behaviour. Observing these traditions demonstrates respect and is a way of quickly establishing a friendly footing even with complete strangers.<br><br>A hero succeeding in a <span class='sheet-strong'>Courtesy</span> roll knows what to say at the right moment to make a good impression with their host, or is mindful of his manners when receiving guests.</div>
						<div class="sheet-dots">
							<input type="radio" name="attr_courtesy" value="0" checked="checked" /><span></span>
							<input type="radio" name="attr_courtesy" value="1" /><span></span>
							<input type="radio" name="attr_courtesy" value="2" /><span></span>
							<input type="radio" name="attr_courtesy" value="3" /><span></span>
							<input type="radio" name="attr_courtesy" value="4" /><span></span>
							<input type="radio" name="attr_courtesy" value="5" /><span></span>
							<input type="radio" name="attr_courtesy" value="6" /><span></span>
						</div>
					</div>

					<div class="sheet-row">
						<button type="roll" class="table-rolls" value="/me rolls for Battle against Heart TN (@{hearttn}) .\n/roll @{favorill} + (@{battle}+?{Bonus Dice|0})t[@{wearytype}]" name="roll_battlecheck"></button>
						<button type="action" class="parsed-rolls" name="act_battle" id="roll_battle"></button>
						<input type="checkbox" name="attr_battle_favoured">
						<label for="roll_battlecheck" class="label table-rolls" data-i18n="battle">Battle</label>
						<label for="roll_battle" class="label parsed-rolls" data-i18n="battle">Battle</label>
						<div class="sheet-hover-info" data-i18n="battle-description">A hero's proficiency in this skill shows his grasp of the rules of battle, and his ability to keep his head when involved in a violent confrontation. The <span class='sheet-strong'>Battle</span> skill can be used to gain an advantage when involved in a fight with a group of foes, or to lead a company of men in open battle and maintain order in the midst of chaos (combat itself is covered by Weapon skills).</div>
						<div class="sheet-dots">
							<input type="radio" name="attr_battle" value="0" checked="checked" /><span></span>
							<input type="radio" name="attr_battle" value="1" /><span></span>
							<input type="radio" name="attr_battle" value="2" /><span></span>
							<input type="radio" name="attr_battle" value="3" /><span></span>
							<input type="radio" name="attr_battle" value="4" /><span></span>
							<input type="radio" name="attr_battle" value="5" /><span></span>
							<input type="radio" name="attr_battle" value="6" /><span></span>
						</div>
					</div>
				</div>
				<div class="sheet-col col1 row4 skill-header vertical-redbg"></div>
				<div class="sheet-col col1 row5 additional-row rewards heart-rewards">
					<div class="sheet-row">
						<h3>Rewards</h3>
					</div>	
					<div class="sheet-row rewards">
						<button type="roll" class="table-rolls" value="/me rolls for Valour against Heart TN (@{hearttn}) .\n/roll @{favorill} + (@{valour}+?{Bonus Dice|0})t[@{wearytype}]" name="roll_valourcheck"></button>
						<button type="action" class="parsed-rolls" name="act_valour" id="roll_valour"></button>
						<input type="checkbox" name="attr_valour_favoured">
						<label for="roll_valourcheck" class="label table-rolls" data-i18n="valour">Valour</label>
						<label for="roll_valour" class="label parsed-rolls" data-i18n="valour">Valour</label>
						<div class="sheet-hover-info" data-i18n="valour-description">Valour is a measure of a character’s courage, as tempered by dangerous deeds. A man of valour is willing to place himself in danger for the safety of others. In a time where new threats arise each day, courage is highly prized, and a valiant adventurer is often esteemed above all other individuals. For this reason, a hero’s rank in Valour also reflects the level of renown he attained as a doer of great deeds.<br><br>When a player decides to favour Valour over Wisdom, his hero’s actions, not his judgement, will tend to prove his status in the eyes of others. From the lowliest start as a wandering adventurer, a hero might one day equal the repute and respect earned by a famous champion or king.</div>
						<input id="valour-input" name="attr_valour" value="0" type="number" min=1 max=6>
					</div>
					<div class="sheet-row">
						<textarea name="attr_rewards" style="width: 100%;"></textarea>
					</div>
				</div>
			</div>
			<!-- <div class="mid-pane-hspacer col4 row1"></div> -->
			<div class="sheetgrid-1col col3 row1 wits-column">
				<div class="sheet-col col1 row1 attribute-row wits-box">
					<div class="sheet-row">
						<h2>Wits</h2>
<!-- 						<div class="sheet-hover-info" data-i18n="wits-description">A hero with a high Wits rating can be clever, attentive and strong-willed. A sharp-witted person is a quick thinker, and probably alert and vigilant, so any action that calls upon these qualities benefits from a hero's Wits score.</div>
 -->					</div>
					<div class="sheet-row attribute">
						<span class="label row2 col1 label-wits-tn">TN</span>
						<span class="attribute row1 col2">
							<input name="attr_witstn" class="attribute" type="number" value="0">
						</span>
						<span class="secondary-attribute secondary-attribute-top row1 col3">
							<input name="attr_wits" class="secondary-attribute input-wits-rating" type="number" value="0">
						</span>
						<span class="label row1 col3 label-wits-rating">Rating</span>
						<span class="secondary-attribute row2 col3">
							<input name="attr_parry" class="secondary-attribute input-wits-parry" value="0" type="number">
						</span>
						<span class="label row2 col3 label-wits-parry">Parry</span>
					</div>
				</div>
				<div class="sheet-col col1 row2 skill-header vertical-redbg">
				</div>
				<div class="sheet-col col1 row3 skills-row wits-skills">
					<div class="sheet-row">
						<button type="roll" class="table-rolls" value="/me rolls for Persuade against Wits TN (@{witstn}) .\n/roll @{favorill} + (@{persuade}+?{Bonus Dice|0})t[@{wearytype}]" name="roll_persuadecheck"></button>
						<button type="action" class="parsed-rolls" name="act_persuade" id="roll_persuade"></button>
						<input type="checkbox" name="attr_persuade_favoured">
						<label for="roll_persuadecheck" class="label table-rolls" data-i18n="persuade">Persuade</label>
						<label for="roll_persuade" class="label parsed-rolls" data-i18n="persuade">Persuade</label>
						<div class="sheet-hover-info" data-i18n="persuade-description">This skill allows a hero to apply his or her reasoning to convince another individual of an idea or course of action. It can be used to influence small groups of listeners, but only if used in an appropriate context, such as a common hall. An attempt at persuasion requires more time than other Personality skills, but can have a more lasting impact on other characters' actions. A high <span class='sheet-strong'>Persuade</span> score denotes an uncommon eloquence, a love of speech and knowledge of its proper use and its effect on listeners. Wise men, advisors to chieftains and kings and their messengers all share this passion for the spoken word.<br><br>The successful use of the skill lets the hero convince his audience of the flaws in their current position. A great success convinces the subject of the quality of the hero's stance, while an extraordinary success may turn the subject into an ardent believer.</div>
						<div class="sheet-dots">
							<input type="radio" name="attr_persuade" value="0" checked="checked" /><span></span>
							<input type="radio" name="attr_persuade" value="1" /><span></span>
							<input type="radio" name="attr_persuade" value="2" /><span></span>
							<input type="radio" name="attr_persuade" value="3" /><span></span>
							<input type="radio" name="attr_persuade" value="4" /><span></span>
							<input type="radio" name="attr_persuade" value="5" /><span></span>
							<input type="radio" name="attr_persuade" value="6" /><span></span>
						</div>
					</div>
		
					<div class="sheet-row">
						<button type="roll" class="table-rolls" value="/me rolls for Stealth against Wits TN (@{witstn}) .\n/roll @{favorill} + (@{stealth}+?{Bonus Dice|0})t[@{wearytype}]" name="roll_stealthcheck"></button>
						<button type="action" class="parsed-rolls" name="act_stealth" id="roll_stealth"></button>
						<input type="checkbox" name="attr_stealth_favoured">
						<label for="roll_stealthcheck" class="label table-rolls" data-i18n="stealth">Stealth</label>
						<label for="roll_stealth" class="label parsed-rolls" data-i18n="stealth">Stealth</label>
						<div class="sheet-hover-info" data-i18n="stealth-description">A hero resorts to <span class='sheet-strong'>Stealth</span> whenever he needs, or is forced, to act in a furtive or secret way. The skill includes hiding, moving quietly and shadowing others. These activities often rely on quickness and precision, so a stealthy hero combines practiced caution with the ability to judge the right moment to take a chance. Hunters, burglars, and solitary fighters use <span class='sheet-strong'>Stealth</span> to prosper in their trade.<br><br>A successful <span class='sheet-strong'>Stealth</span> roll indicates that the character has gone unnoticed, while a failure has almost certainly attracts unwanted attention.<br><br>A great or extraordinary success produces an outcome so flawless that it even be impossible to trace the hero's actions after the fact.</div>
						<div class="sheet-dots">
							<input type="radio" name="attr_stealth" value="0" checked="checked" /><span></span>
							<input type="radio" name="attr_stealth" value="1" /><span></span>
							<input type="radio" name="attr_stealth" value="2" /><span></span>
							<input type="radio" name="attr_stealth" value="3" /><span></span>
							<input type="radio" name="attr_stealth" value="4" /><span></span>
							<input type="radio" name="attr_stealth" value="5" /><span></span>
							<input type="radio" name="attr_stealth" value="6" /><span></span>
						</div>
					</div>
		
					<div class="sheet-row">
						<button type="roll" class="table-rolls" value="/me rolls for Scan against Wits TN (@{witstn}) .\n/roll @{favorill} + (@{scan}+?{Bonus Dice|0})t[@{wearytype}]" name="roll_scancheck"></button>
						<button type="action" class="parsed-rolls" name="act_scan" id="roll_scan"></button>
						<input type="checkbox" name="attr_scan_favoured">
						<label for="roll_scancheck" class="label table-rolls" data-i18n="scan">Scan</label>
						<label for="roll_scan" class="label parsed-rolls" data-i18n="scan">Scan</label>
						<div class="sheet-hover-info">Player-heroes can use the SCAN Skill when examining something closely or attentively. This Skill allows a Player-hero to skim through a book to locate a piece of relevant information, look for concealed doors or hidden inscriptions, recognise a familiar face in a crowd, or locate a set of tracks on the ground. SCAN rolls are generally initiated by the players rather than the Loremaster. One roll is required for each inspection of a small area, such as a room. AWARENESS, rather than SCAN, is used to see if a hero passively notices something. A successful SCAN roll generally lets Player-heroes find what they are looking for — if it is to be found at all. A superior success usually means the object is found more quickly.</div>
						<div class="sheet-dots">
							<input type="radio" name="attr_scan" value="0" checked="checked" /><span></span>
							<input type="radio" name="attr_scan" value="1" /><span></span>
							<input type="radio" name="attr_scan" value="2" /><span></span>
							<input type="radio" name="attr_scan" value="3" /><span></span>
							<input type="radio" name="attr_scan" value="4" /><span></span>
							<input type="radio" name="attr_scan" value="5" /><span></span>
							<input type="radio" name="attr_scan" value="6" /><span></span>
						</div>
					</div>
		
					<div class="sheet-row">
						<button type="roll" class="table-rolls" value="/me rolls for Explore against Wits TN (@{witstn}) .\n/roll @{favorill} + (@{explore}+?{Bonus Dice|0})t[@{wearytype}]" name="roll_explorecheck"></button>
						<button type="action" class="parsed-rolls" name="act_explore" id="roll_explore"></button>
						<input type="checkbox" name="attr_explore_favoured">
						<label for="roll_explorecheck" class="label table-rolls" data-i18n="explore">Explore</label>
						<label for="roll_explore" class="label parsed-rolls" data-i18n="explore">Explore</label>
						<div class="sheet-hover-info" data-i18n="explore-description">Adventurers rely on their <span class='sheet-strong'>Explore</span> skill when they move through an unfamiliar area of the Wild. An <span class='sheet-strong'>Explore</span> test may be required during a journey to find the company's heading, or to get back on track after a detour; to cope with adverse weather conditions or other natural hazards; to create paths through the wilderness suitable for others to follow; or to choose a suitable place to set up camp. A high <span class='sheet-strong'>Explore</span> rating is an invaluable resource for a companion acting as a scout for his group of adventurers.</div>
						<div class="sheet-dots">
							<input type="radio" name="attr_explore" value="0" checked="checked" /><span></span>
							<input type="radio" name="attr_explore" value="1" /><span></span>
							<input type="radio" name="attr_explore" value="2" /><span></span>
							<input type="radio" name="attr_explore" value="3" /><span></span>
							<input type="radio" name="attr_explore" value="4" /><span></span>
							<input type="radio" name="attr_explore" value="5" /><span></span>
							<input type="radio" name="attr_explore" value="6" /><span></span>
						</div>
					</div>
		
					<div class="sheet-row">
						<button type="roll" class="table-rolls" value="/me rolls for Riddle against Wits TN (@{witstn}) .\n/roll @{favorill} + (@{riddle}+?{Bonus Dice|0})t[@{wearytype}]" name="roll_riddlecheck"></button>
						<button type="action" class="parsed-rolls" name="act_riddle" id="roll_riddle"></button>
						<input type="checkbox" name="attr_riddle_favoured">
						<label for="roll_riddlecheck" class="label table-rolls" data-i18n="riddle">Riddle</label>
						<label for="roll_riddle" class="label parsed-rolls" data-i18n="riddle">Riddle</label>
						<div class="sheet-hover-info" data-i18n="riddle-description">Owing its name to the ancient Game, the <span class='sheet-strong'>Riddle</span> skill represents a hero's ability to draw conclusions from seemingly unconnected scraps of information, by deduction, reasoning and intuition.<br><br>An adventurer also relies on <span class='sheet-strong'>Riddle</span> whenever he is forced to talk about a subject but wants to conceal part of what he knows, for example to explain something about himself without revealing his true identity.<br><br>An accepted custom among many creatures, speaking in riddles is usually allowed among strangers meeting for the first time who want to speak guardedly. This skill is also used to gain helpful insight from a spoken or written riddle.</div>
						<div class="sheet-dots">
							<input type="radio" name="attr_riddle" value="0" checked="checked" /><span></span>
							<input type="radio" name="attr_riddle" value="1" /><span></span>
							<input type="radio" name="attr_riddle" value="2" /><span></span>
							<input type="radio" name="attr_riddle" value="3" /><span></span>
							<input type="radio" name="attr_riddle" value="4" /><span></span>
							<input type="radio" name="attr_riddle" value="5" /><span></span>
							<input type="radio" name="attr_riddle" value="6" /><span></span>
						</div>
					</div>
		
					<div class="sheet-row">
						<button type="roll" class="table-rolls" value="/me rolls for Lore against Wits TN (@{witstn}) .\n/roll @{favorill} + (@{lore}+?{Bonus Dice|0})t[@{wearytype}]" name="roll_lorecheck"></button>
						<button type="action" class="parsed-rolls" name="act_lore" id="roll_lore"></button>
						<input type="checkbox" name="attr_lore_favoured">
						<label for="roll_lorecheck" class="label table-rolls" data-i18n="lore">Lore</label>
						<label for="roll_lore" class="label parsed-rolls" data-i18n="lore">Lore</label>
						<div class="sheet-hover-info" data-i18n="lore-description"><span class='sheet-strong'>Lore</span> expresses a hero's love for learning, be it a fascination with descriptions of distant lands, or an interest in family genealogy. Whenever an action involves knowledge of some kind, a <span class='sheet-strong'>Lore</span> roll is required. Heroes are considered to be knowledgeable in the traditions of their own people, and so the Loremaster should rarely require a player to make a <span class='sheet-strong'>Lore</span> test for information regarding their character's culture, background or the area they originally come from.</div>
						<div class="sheet-dots">
							<input type="radio" name="attr_lore" value="0" checked="checked" /><span></span>
							<input type="radio" name="attr_lore" value="1" /><span></span>
							<input type="radio" name="attr_lore" value="2" /><span></span>
							<input type="radio" name="attr_lore" value="3" /><span></span>
							<input type="radio" name="attr_lore" value="4" /><span></span>
							<input type="radio" name="attr_lore" value="5" /><span></span>
							<input type="radio" name="attr_lore" value="6" /><span></span>
						</div>
					</div>		
				</div>
				<div class="sheet-col col1 row4 skill-header vertical-redbg"></div>
				<div class="sheet-col col1 row5 additional-row virtues heart-virtues">
					<div class="sheet-row">
						<h3>Virtues</h3>
					</div>
					<div class="sheet-row virtues">
						<button type="roll" class="table-rolls" value="/me rolls for Wisdom against Wits TN (@{witstn}) .\n/roll @{favorill} + (@{wisdom}+?{Bonus Dice|0})t[@{wearytype}]" name="roll_wisdomcheck"></button>
						<button type="action" class="parsed-rolls" name="act_wisdom" id="roll_wisdom"></button>
						<input type="checkbox" name="attr_wisdom_favoured">
						<label for="roll_wisdomcheck" class="label table-rolls" data-i18n="wisdom">Wisdom</label>
						<label for="roll_wisdom" class="label parsed-rolls" data-i18n="wisdom">Wisdom</label>
						<div class="sheet-hover-info" data-i18n="wisdom-description">A character’s knowledge of his own capabilities, his self- confidence and capacity for good judgement changes and improves with struggles and strife. A characteristic with deeply personal implications, a hero’s rank in Wisdom also determines the stature of the hero in the eyes of those that prize these qualities.<br><br>When Wisdom is chosen over Valour when spending Experience points, it suggests that the hero’s adventures are affecting him subtly but profoundly. Starting as a more or less ingenuous individual with an adventurous spirit, the hero can achieve the maturity and sagacity of the Wise.</div>
						<input id="wisdom-input" name="attr_wisdom" value="0" type="number">
					</div>
					<div class="sheet-row">
						<textarea name="attr_virtues" style="width: 100%;"></textarea>
					</div>
				</div>
			</div>
		</div>
		<div class="vertical-spacer row4 border-bottom-double">&nbsp;</div>
		<div class="sheetgrid-3cols row5 weapons-armour">
			<div class="sheetgrid-cols1-2 weapons">
				<div class="sheet-col">
					<div class="weapons-grid">
						<span class="button-cell"></span>
						<label data-i18n-title="weapon" class="weapon-cell" title="Weapon">
							<h3 class="left">War Gear</h3>
						</label>
						<label data-i18n-title="dmg" class="type-cell weapon-header" title="Weapon type">
							<span class="label center">Type</span>
						</label>
						<label data-i18n-title="dmg" class="damage-cell weapon-header" title="Damage">
							<span class="label center">Dmg</span>
						</label>
						<label data-i18n-title="inj" class="injury-cell weapon-header" title="Injury">
							<span class="label center">Inj.</span>
						</label>
						<label data-i18n-title="load" class="load-cell weapon-header" title="Load">
							<span class="label center">Load</span>
						</label>
						<label data-i18n-title="load" class="fell-cell weapon-header" title="Fell">
							<span class="label center" title="Fell">F</span>
						</label>
						<label data-i18n-title="load" class="grievous-cell weapon-header" title="Grievous">
							<span class="label center" title="Grievous">G</span>
						</label>
						<label data-i18n-title="load" class="keen-cell weapon-header" title="Keen">
							<span class="label center" title="Keen">K</span>
						</label>
						<label data-i18n-title="notes" class="notes-cell weapon-header" title="Notes">
							<span class="label center">Notes</span>
						</label>

						<!-- <button type="roll" class="table-rolls" value="/me rolls for Wisdom against Wits TN (@{witstn}) .\n/roll @{favorill} + (@{wisdom}+?{Bonus Dice|0})t[@{wearytype}]" name="roll_wisdomcheck"></button>
						 --><button type="action" class="parsed-rolls button-cell" name="act_weapon_1" id="roll_weapon1"></button>
						<input name="attr_weapon_skill_name_1" class="weapon-cell" type="text">
						<select name="attr_weapon_combat_prof_1">
							<option value="" selected default></option>
							<option value="axes">Axes</option>
							<option value="bows">Bows</option>
							<option value="spears">Spears</option>
							<option value="swords">Swords</option>
						</select>
						<input name="attr_weapon_damage_1" min="0" class="center number damage-cell" type="number">
						<input name="attr_weapon_injury_1" min="0" class="center number injury-cell" type="number">
						<input name="attr_weapon_load_1" min="0" class="center number load-cell" type="number">
						<input type="checkbox" class="center fell-cell" value="1" name="attr_weapon_fell_1"> 
						<input type="checkbox" class="center grievous-cell" value="1" name="attr_weapon_grievous_1"> 
						<input type="checkbox" class="center keen-cell" value="1" name="attr_weapon_keen_1"> 
						<input name="attr_weapon_notes_1" type="text" class="notes-cell">
						
						<!-- <button type="roll" class="table-rolls" value="/me rolls for Wisdom against Wits TN (@{witstn}) .\n/roll @{favorill} + (@{wisdom}+?{Bonus Dice|0})t[@{wearytype}]" name="roll_wisdomcheck"></button>
						 --><button type="action" class="parsed-rolls button-cell" name="act_weapon_2" id="roll_weapon2"></button>
						<input name="attr_weapon_skill_name_2" class="weapon-cell" type="text">
						<select name="attr_weapon_combat_prof_2">
							<option value="" selected default></option>
							<option value="axes">Axes</option>
							<option value="bows">Bows</option>
							<option value="spears">Spears</option>
							<option value="swords">Swords</option>
						</select>
						<input name="attr_weapon_damage_2" min="0" class="center number damage-cell" type="number">
						<input name="attr_weapon_injury_2" min="0" class="center number injury-cell" type="number">
						<input name="attr_weapon_load_2" min="0" class="center number load-cell" type="number">
						<input type="checkbox" class="center fell-cell" name="attr_weapon_fell_2"> 
						<input type="checkbox" class="center grievous-cell" name="attr_weapon_grievous_2"> 
						<input type="checkbox" class="center keen-cell" name="attr_weapon_keen_2"> 
						<input name="attr_weapon_notes_2" class="notes-cell" type="text">

						<!-- <button type="roll" class="table-rolls" value="/me rolls for Wisdom against Wits TN (@{witstn}) .\n/roll @{favorill} + (@{wisdom}+?{Bonus Dice|0})t[@{wearytype}]" name="roll_wisdomcheck"></button>
						 --><button type="action" class="parsed-rolls button-cell" name="act_weapon_3" id="roll_weapon3"></button>
						<input name="attr_weapon_skill_name_3" class="weapon-cell" type="text">
						<select name="attr_weapon_combat_prof_3">
							<option value="" selected default></option>
							<option value="axes">Axes</option>
							<option value="bows">Bows</option>
							<option value="spears">Spears</option>
							<option value="swords">Swords</option>
						</select>
						<input name="attr_weapon_damage_3" min="0" class="center number damage-cell" type="number">
						<input name="attr_weapon_injury_3" min="0" class="center number injury-cell" type="number">
						<input name="attr_weapon_load_3" min="0" class="center number load-cell" type="number">
						<input type="checkbox" class="center fell-cell" name="attr_weapon_fell_3"> 
						<input type="checkbox" class="center grievous-cell" name="attr_weapon_grievous_3"> 
						<input type="checkbox" class="center keen-cell" name="attr_weapon_keen_3"> 
						<input name="attr_weapon_notes_3" class="notes-cell" type="text">

						<!-- <button type="roll" class="table-rolls" value="/me rolls for Wisdom against Wits TN (@{witstn}) .\n/roll @{favorill} + (@{wisdom}+?{Bonus Dice|0})t[@{wearytype}]" name="roll_wisdomcheck"></button>
						 --><button type="action" class="parsed-rolls button-cell" name="act_weapon_4" id="roll_weapon4"></button>
						<input name="attr_weapon_skill_name_4" class="weapon-cell" type="text">
						<select name="attr_weapon_combat_prof_4">
							<option value="" selected default></option>
							<option value="axes">Axes</option>
							<option value="bows">Bows</option>
							<option value="spears">Spears</option>
							<option value="swords">Swords</option>
						</select>
						<input name="attr_weapon_damage_4" min="0" class="center number damage-cell" type="number">
						<input name="attr_weapon_injury_4" min="0" class="center number injury-cell" type="number">
						<input name="attr_weapon_load_4" min="0" class="center number load-cell" type="number">
						<input type="checkbox" class="center fell-cell" name="attr_weapon_fell_4"> 
						<input type="checkbox" class="center grievous-cell" name="attr_weapon_grievous_4"> 
						<input type="checkbox" class="center keen-cell" name="attr_weapon_keen_4"> 
						<input name="attr_weapon_notes_4" class="notes-cell" type="text">

						<!-- <button type="roll" class="table-rolls" value="/me rolls for Wisdom against Wits TN (@{witstn}) .\n/roll @{favorill} + (@{wisdom}+?{Bonus Dice|0})t[@{wearytype}]" name="roll_wisdomcheck"></button>
						 --><button type="action" class="parsed-rolls button-cell" name="act_weapon_5" id="roll_weapon5"></button>
						<input name="attr_weapon_skill_name_5" class="weapon-cell" type="text">
						<select name="attr_weapon_combat_prof_5">
							<option value="" selected default></option>
							<option value="axes">Axes</option>
							<option value="bows">Bows</option>
							<option value="spears">Spears</option>
							<option value="swords">Swords</option>
						</select>
						<input name="attr_weapon_damage_5" min="0" class="center number damage-cell" type="number">
						<input name="attr_weapon_injury_5" min="0" class="center number injury-cell" type="number">
						<input name="attr_weapon_load_5" min="0" class="center number load-cell" type="number">
						<input type="checkbox" class="center fell-cell" name="attr_weapon_fell_5"> 
						<input type="checkbox" class="center grievous-cell" name="attr_weapon_grievous_5"> 
						<input type="checkbox" class="center keen-cell" name="attr_weapon_keen_5"> 
						<input name="attr_weapon_notes_5" class="notes-cell" type="text">

						<!-- <button type="roll" class="table-rolls" value="/me rolls for Wisdom against Wits TN (@{witstn}) .\n/roll @{favorill} + (@{wisdom}+?{Bonus Dice|0})t[@{wearytype}]" name="roll_wisdomcheck"></button>
						 --><button type="action" class="parsed-rolls button-cell" name="act_weapon_6" id="roll_weapon6"></button>
						<input name="attr_weapon_skill_name_6" class="weapon-cell" type="text">
						<select name="attr_weapon_combat_prof_6">
							<option value="" selected default></option>
							<option value="axes">Axes</option>
							<option value="bows">Bows</option>
							<option value="spears">Spears</option>
							<option value="swords">Swords</option>
						</select>
						<input name="attr_weapon_damage_6" min="0" class="center number damage-cell" type="number">
						<input name="attr_weapon_injury_6" min="0" class="center number injury-cell" type="number">
						<input name="attr_weapon_load_6" min="0" class="center number load-cell" type="number">
						<input type="checkbox" class="center fell-cell" name="attr_weapon_fell_6"> 
						<input type="checkbox" class="center grievous-cell" name="attr_weapon_grievous_6"> 
						<input type="checkbox" class="center keen-cell" name="attr_weapon_keen_6"> 
						<input name="attr_weapon_notes_5" class="notes-cell" type="text">
						</label>
					</div>
				</div>
			</div>
			<div class="sheetgrid-cols3 armour">
				<div class="sheet-col">
					<div class="sheet-row armour-grid">
						<span class="label oneq gridcol1 left">Armour
							<button type="roll" class="table-rolls" value="/me rolls for Protection against Injury TN.\n/roll @{favorill} + (@{armourprot}+@{helmprot}+?{Bonus Dice|0})t[@{wearytype}]" name="roll_protectioncheck"></button>
							<button type="action" class="parsed-rolls" name="act_protection" id="roll_protection"></button>
						</span>
						<span class="label oneq gridcol2 center">Prot.</span>
						<span class="label oneq gridcol3 center">Load</span>
						<span class="label gridcol4 center" title="Close fitting">CF</span>
						<span class="label gridcol5 center" title="Cunning make">CM</span>
					</div>
					<div class="sheet-row armour-grid">
						<input class="text oneq gridcol1" type="text" name="attr_armour" >
						<input class="number oneq gridcol2" type="number" name="attr_armourprot" value="0">				
						<input class="number oneq gridcol3" type="number" name="attr_armourload" value="0">
						<input type="checkbox" class="center gridcol4" value="1" name="attr_armourcf"></checkbox> 	 
						<input type="checkbox" class="center gridcol5" value="1" name="attr_armourcm"></checkbox> 	 				
					</div>
					<div class="sheet-row armour-grid">
						<span class="label oneq gridcol1 left">Helm</span>
						<span class="label oneq gridcol2 center">Prot.</span>
						<span class="label oneq gridcol3 center">Load</span>
						<span class="label gridcol4 center" title="Close fitting">CF</span>
						<span class="label gridcol5 center" title="Cunning make">CM</span>
					</div>
					<div class="sheet-row armour-grid">
						<input class="text oneq gridcol1" type="text" name="attr_helm" >
						<input class="number oneq gridcol2" type="number" name="attr_helmprot" value="0">				
						<input class="number oneq gridcol3" type="number" name="attr_helmload" value="0">
						<input type="checkbox" class="center gridcol4" value="1" name="attr_helmetcf"></checkbox> 	 
						<input type="checkbox" class="center gridcol5" value="1" name="attr_helmetcm"></checkbox> 	 								
					</div>
					<div class="sheet-row armour-grid">
						<span class="label oneq gridcol1 left">Shield</span>
						<span class="label oneq gridcol2 center">Parry</span>
						<span class="label oneq gridcol3 center">Load</span>
						<span class="label gridcol4 center" title="Reinforced">R</span>
						<span class="label gridcol5 center" title="Cunning make">CM</span>
					</div>
					<div class="sheet-row armour-grid">
						<input class="text oneq gridcol1" type="text" name="attr_shield" >
						<input class="number oneq gridcol2" type="number" name="attr_shieldparry" value="0">
						<input class="number oneq gridcol3" type="number" name="attr_shieldload" value="0">
						<input type="checkbox" class="center gridcol4" value="1" name="attr_shieldreinf"></checkbox> 	
						<input type="checkbox" class="center gridcol5" value="1" name="attr_shieldcm"></checkbox> 								
					</div>
				</div>
			</div>
		</div>
		<div class="sheetgrid-1col row6 notes">
			<div class="sheet-row">
				<h2>Notes</h2>
			</div>
			<div class="sheet-row">
				<textarea name="attr_notes" style="width:100%;"/>
			</div>
		</div>
	</div>

	<div class="sheetgrid-1col col2 sheetgrid-1cols right-pane">
		<div class="sheet-col">
			<div class="sheet-row avatar-img">
				<img name="attr_character_avatar" class="avatar-img" />
			</div>
			<div class="sheet-row experience">
				<label class="h3">Experience</label>
			</div>
			<div class="sheet-row experience">
				<span class="label">Skill Points</span>
				<input name="attr_skillpoints" value="0" type="number">
				<span class="label">Total</span>
				<input name="attr_totalskillpoints" value="0" type="number">
			</div>
			<div class="sheet-row experience">
				<span class="label">Adventure Points</span>
				<input name="attr_adventurepoints" value="0" type="number">
				<span class="label">Total</span>
				<input name="attr_totaladventurepoints" value="0" type="number">
			</div>
			<div class="sheet-row experience">
				<span class="label">Fellowship Score</span>
				<input name="attr_fellowshipscore" value="0" type="number">
				<span class="label">Total</span>
				<input name="attr_totalfellowshipscore" value="0" type="number">
			</div>
			<div class="sheet-row endurance">
				<label class="h3">Current Endurance</label><input type="number" name="attr_currentendurance" class="number">
			</div>
			<div class="sheet-row endurance">
				<span class="label">Load</span>
				<input name="attr_load" value="0" type="number">
				<span class="label">Fatigue</span>
				<input name="attr_fatigue" value="0" type="number">
			</div>
			<div class="sheet-row hope">
				<label class="h3">Current Hope</label><input type="number" name="attr_currenthope" class="number"></input>
			</div>
			<div class="sheet-row hope">
				<span class="label">Shadow</span>
				<input name="attr_shadow" value="0" type="number">
				<span class="label">Scars</span>
				<input name="attr_shadowscar" value="0" type="number">
			</div>
			<div class="sheet-row conditions">
				<label class="h3">Conditions<label>
			</div>
			<div class="sheet-row conditions">
				<div><input name="attr_weary" type="checkbox">
				<span class="label">Weary</span></div>
				<div><input name="attr_miserable" type="checkbox">
				<span class="label">Miserable</span></div>
				<div><input name="attr_wounded" type="checkbox">
				<span class="label">Wounded</span></div>
				
			</div>
			<div class="sheet-row injury">
				<span class="label">Injury</span>
				<input name="attr_injury" type="text">
			</div>

			<div class="sheet-row rolltypes">
				<h3>Roll Types</h3>
			</div>
			<div class="sheet-row rolltypes">
				<!-- <label class="h3 oneh">Roll Types</label> -->
				<div class="oneh center">
					<div class="center">
						<span class="label">Parsed rolls</span>
						<div class="sheet-hover-info" data-i18n="parsedroll-description">When enabled the dice rolls will be parsed and calculated, with output displayed in a rolltemplate. This removes the need for roll tables. </div>
						<span class="toggle">
							<input type="radio" name="attr_parsedrolls" value="1" selected id="config_parsedrolls" />
							&nbsp;
							<input type="radio" name="attr_parsedrolls" value="0" id="config_tablerolls" />
						</span>						
						<span class="label">Table rolls</span>
						<div class="sheet-hover-info" data-i18n="tableroll-description">When enabled the dice rolls will be using preconfigured rollable tables according to instructions for The One Ring 1st Edition, with output displayed in a rolltemplate. This removes the needed rollable tables to be preconfigured. </div>
						</div>
				</div>	
			</div>
	
			<div class="sheet-row parsed-rolls custom-roll custom-roll-title">	
				<span class="oneh center">Custom&nbsp;roll</span>
				<span class="oneh center"><input type="text" name="attr_customname"></span>		
			</div>
			<div class="sheet-row parsed-rolls custom-roll custom-roll-headers">
				<span class="oneh">Feat</span>				
				<span class="oneq center">Success</span>
				<span class="oneq center">Target</span>
			</div>				
			<div class="sheet-row parsed-rolls custom-roll">
				<select name="attr_customfeatdie" class="oneh class center">
					<option value="-1">None</option>
					<option value="1">Normal</option>
					<option value="2">Favoured</option>
					<option value="0">Ill-favoured</option>
				</select>
				<span class="oneq center"><input class="center" type="number" value="0" name="attr_customsuccessdice"></span>
				<span class="oneq center"><input class="center" type="number" value="15" name="attr_customtn"></span>
				<button type="action" class="parsed-rolls" name="act_customroll" id="roll_custom"></button>
			</div>

			<div class="sheet-row table-rolls-block">
				<input name="attr_favorill" type="radio" value="{1t[feat]}">
				<span class="label">Normal</span>
			</div>
			<div class="sheet-row table-rolls-block">
				<input name="attr_favorill" type="radio" value="{2t[feat]}kh1">
				<span class="label">Favoured</span>
			</div>
			<div class="sheet-row table-rolls-block">
				<input name="attr_favorill" type="radio" value="{2t[feat]}kl1">
				<span class="label">Ill Favoured</span>
			</div>

			<div class="sheet-row treasure">
				<h3>Treasure</h3>
			</div>
			<div class="sheet-row treasure">
				<span class="label oneh center">Treasure Rating</span>
				<span class="label oneh center">Treasure Carried</span>
			</div>
			<div class="sheet-row treasure treasure-input">
				<span class="oneh center"><input class="number center" type="number" name="attr_treaure" ></span>
				<span class="oneh center"><input class="number center" type="number" name="attr_treasureload" value="0"></span>
								
			</div>
			<div class="sheet-row mount">
				<h3 class="">Mount</h3>
			</div>
			<div class="sheet-row mount">
				<span class="label oneq">&nbsp;</span>
				<span class="label oneq">Quality</span>
				<span class="label oneq">Vigour</span>
				<span class="label oneq">Treasure</span>
			</div>
			<div class="sheet-row mount-input">
				<input class="text oneq" placeholder="Name" type="text" name="attr_mount" >
				<input class="number oneq" type="number" name="attr_mountquality" value="0">
				<input class="number oneq" type="number" name="attr_mountvigour" value="0">	
				<input class="number oneq" type="number" name="attr_mounttreasure" value="0" max="10">				
			</div>
			<div class="sheet-row useful-items">
				<h3>Useful items</h3>
			</div>
			<div class="sheet-row useful-items">
				<fieldset class="useful-items repeating_usefulitems">
					<input type="text" name="attr_item" class="useful-item whole" />
				</fieldset>
			</div>
			<div class="sheet-row">
				<h3>Traveling Gear</h3>
			</div>
			<div class="sheet-row">
				<textarea name="attr_travellinggear" style="width:100%;"/>
			</div>
		</div>
	</div>
</div>
<input type="hidden" name="attr_wearytype">
<input type="hidden" name="attr_awe_fav">
<input type="hidden" name="attr_athletics_fav">
<input type="hidden" name="attr_awareness_fav">
<input type="hidden" name="attr_hunting_fav">
<input type="hidden" name="attr_song_fav">
<input type="hidden" name="attr_craft_fav">
<input type="hidden" name="attr_enhearten_fav">
<input type="hidden" name="attr_travel_fav">
<input type="hidden" name="attr_insight_fav">
<input type="hidden" name="attr_healing_fav">
<input type="hidden" name="attr_courtesy_fav">
<input type="hidden" name="attr_battle_fav">
<input type="hidden" name="attr_persuade_fav">
<input type="hidden" name="attr_stealth_fav">
<input type="hidden" name="attr_scan_fav">
<input type="hidden" name="attr_explore_fav">
<input type="hidden" name="attr_riddle_fav">
<input type="hidden" name="attr_lore_fav">
<input type="hidden" name="attr_valour_fav">
<input type="hidden" name="attr_wisdom_fav">
<input type="hidden" name="attr_awe_favill">
<input type="hidden" name="attr_athletics_favill">
<input type="hidden" name="attr_awareness_favill">
<input type="hidden" name="attr_hunting_favill">
<input type="hidden" name="attr_song_favill">
<input type="hidden" name="attr_craft_favill">
<input type="hidden" name="attr_enhearten_favill">
<input type="hidden" name="attr_travel_favill">
<input type="hidden" name="attr_insight_favill">
<input type="hidden" name="attr_healing_favill">
<input type="hidden" name="attr_courtesy_favill">
<input type="hidden" name="attr_battle_favill">
<input type="hidden" name="attr_persuade_favill">
<input type="hidden" name="attr_stealth_favill">
<input type="hidden" name="attr_scan_favill">
<input type="hidden" name="attr_explore_favill">
<input type="hidden" name="attr_riddle_favill">
<input type="hidden" name="attr_lore_favill">
<input type="hidden" name="attr_valour_favill">
<input type="hidden" name="attr_wisdom_favill">
<input type="hidden" name="attr_illfavoured">

<!-- Sheet Workers -->
<script type="text/worker">
	      
    /* number and log handling */
    const int = (score, on_error = 0) => parseInt(score) || on_error;
    const float = (score, on_error = 0) => parseFloat(score) || on_error;
    const clog = (text, title = "", color = "green", style = "font-size:12px; font-weight:normal;", headerstyle = "font-size:13px; font-weight:bold;") => {
        let titleStyle = `color:${color}; ${headerstyle} text-decoration:underline;`;
        let textStyle = `color:${color}; ${style}`;
        let output = `%c${title} %c${text}`;
        if (title) {
        console.log(output, titleStyle, textStyle);
        } else {
        output = `%c${text}`;
        console.log(output, textStyle);
        }
    };

	// ASYNC ATTRIBUTE METHODS
	const asw = (() => {
		const setActiveCharacterId = function(charId){
			let oldAcid=getActiveCharacterId();
			let ev = new CustomEvent("message");
			ev.data={"id":"0", "type":"setActiveCharacter", "data":charId};
			self.dispatchEvent(ev);
			return oldAcid;
		};
		const promisifyWorker = (worker, parameters) => {
			let acid=getActiveCharacterId(); 
			let prevAcid=null;               
			return new Promise((res,rej)=>{
				prevAcid=setActiveCharacterId(acid);  
				try {if (worker===0) getAttrs(parameters[0]||[],(v)=>res(v));
					else if (worker===1) setAttrs(parameters[0]||{}, parameters[1]||{},(v)=>res(v));
					else if (worker===2) getSectionIDs(parameters[0]||'',(v)=>res(v));
				} catch(err) {rej(console.error(err))}
			}).finally(()=>setActiveCharacterId(prevAcid));
		}
		return {
			getAttrs(attrArray) {return promisifyWorker(0, [attrArray])},
			setAttrs(attrObj, options) {return promisifyWorker(1, [attrObj, options])},
			getSectionIDs(section) {return promisifyWorker(2, [section])},
			setActiveCharacterId,
		}
	})();

	// Helper function to grab player input
	const getQuery = async (queryText) => {
		const rxGrab = /^0\[(.*)\]\s*$/;
		let rollBase = `! {{query1=[[ 0[${queryText}] ]]}}`, // just a [[0]] roll with an inline tag
			queryRoll = await startRoll(rollBase),
			queryResponse = (queryRoll.results.query1.expression.match(rxGrab) || [])[1]; 
		finishRoll(queryRoll.rollId); // you can just let this time out if you want - we're done with it
		return queryResponse;
	};

	// STRING PARSING METHODS FOR ROLLS
    const rollEscape = {
        chars: { '"': '%quot;', ',': '%comma;', ':': '%colon;', '}': '%rcub;', '{': '%lcub;', },
        escape(str) {
            str = (typeof(str) === 'object') ? JSON.stringify(str) : (typeof(str) === 'string') ? str : null;
            return (str) ? `${str}`.replace(new RegExp(`[${Object.keys(this.chars)}]`, 'g'), (r) => this.chars[r]) : null;
        },
        unescape(str) {
            str = `${str}`.replace(new RegExp(`(${Object.values(this.chars).join('|')})`, 'g'), (r) => Object.entries(this.chars).find(e=>e[1]===r)[0]);
            return JSON.parse(str);
        }
    }

    // ROLL FROM ACTION BUTTONS, FUNCTIONS BELOW
    const rollFirst = async (char, act, dice, tn, act_fav, rolltype, additional="") => {
		
		let outcome = 0,
			favId = 1,
			featRoll = "1d12",
			favouredStr = "",
			modifiers = 0,
			successdice = 0,
			successStr = "",
			rollBase = "",
			successDegree = 0,
			weaponinfo = "",
			additionalinfo = "",
			additionalStr = "";

		act = act.charAt(0).toUpperCase() + act.slice(1); // Capitalise the action
		act = (act === "Wisdom" || act === "Valour") ? "Shadow test: "+act : act; 
        clog(`Character name: ${name}, Roll name: ${act}, Target number: ${tn}, favoured: ${act_fav}`);

		// ATTRIBUTES
        const attrs = await asw.getAttrs(["favorill", "weary", "miserable", "currenthope", "shadow", "shadowscar", "illfavoured"]);
		clog(`Weary: ${attrs.weary}, Miserable: ${attrs.miserable}`);
		let wearyStr = (attrs.weary == "on" || attrs.weary == 1) ? "{{weary=Weary}}" : "",
			weary = (attrs.weary == "on" || attrs.weary == 1) ? 1 : 0;
			miserableStr = (attrs.miserable == "on" || attrs.miserable == 1) ? "{{miserable=Miserable}}" : "",
			miserable = (attrs.miserable == "on" || attrs.miserable == 1) ? 1 : 0,
			hope = int(attrs.currenthope),
			shadow = int(attrs.shadow) + int(attrs.shadowscars),
			illfavoured = int(attrs.illfavoured);
		clog(`Weary: ${wearyStr}, Miserable: ${miserableStr}, Illfavoured: ${illfavoured}`);

		// GET MODIFIER AND FAVOURED HERE
		if (rolltype === "protection") {
			tn = await getQuery(`?{Injury rating of weapon (Target number)?|0}`);
		} else if (rolltype === "combat") {
			favId = 1; 
			tn = await getQuery(`?{Target number incl. Parry rating|${tn}}`);
		} else if (rolltype === "custom" ) {
			favId = act_fav; 
		} else {
			if ( illfavoured === 1) {
				favId = 0;
			} else {
				if (act_fav === "1" || act_fav === "on") {
					favId = await getQuery(`?{Favoured?| Favoured,2 | Normal,1 | Ill-favoured,0}`);
				} else {
					favId = await getQuery(`?{Favoured?| Normal,1 | Favoured,2 | Ill-favoured,0}`);
				}
			}
		}
		modifiers = rolltype !== "custom" ? await getQuery(`?{Modifiers?|0}`) : 0;
		let modStr = modifiers == 0 ? "" : (modifiers > 0 ? `{{modification=+${modifiers}}}` : `{{modification=${modifiers}}}`);

		// FEAT DIE ROLL DATA
		//clog(`Favoured test 1: ${!!(favId == 2)}`);
		featRoll = favId == 2 ? "{{feat=[[2d12kh1-1]]}}" : ( favId == 0 ? "{{feat=[[2d12kl1-1]]}}" : "{{feat=[[1d12-1]]}}" );
		featRoll = favId == -1 ? "{{feat=[[0d12]]}}" : featRoll; // For custom rolls without Feat die, the feat die is 0
		//clog(`Favoured string: ${featRoll}`);
		favouredStr = favId == 2 ? "{{favoured=Favoured}}" : ( favId == 0 ? "{{favoured=Ill-favoured}}" : "" );
		//clog(`Favoured output: ${favouredStr}`);

		// REWARDS, KEEN WEAPONS AND CLOSE FITTING ARMOUR
		keen = (additional.match(/Keen/g) || []).length;
		if( keen > 0 ) { clog("Weapon is keen!"); }
		closefit = int((additional.match(/Close fitting/g) || []).length)*2;
		let closefitStr = "";
		if( closefit > 0 ) { 
			clog(`Armour is close fitting: ${closefit}`); 
			closefitStr = `+${closefit}[Close fit]`;
		}

		// SUCCESS DICE ROLL DATA
		successdice = int(dice) + int(modifiers); 
		successdice = successdice < 0 ? 0 : successdice;
        successStr = `${successdice}d6${closefitStr}`;

		// WEAPON INFO & ADDITIONAL INFO
		// Weapon info
		weaponinfo = additional.match(/weapon='(.*?)';/);
		clog(`Weapon info: ${JSON.stringify(weaponinfo)}`);
		weaponStr = ( weaponinfo ) ? ` {{weaponinfo=${weaponinfo[1]}}}` : "";
		clog(`Weapon info: ${weaponinfo}`);
		// Additional info
		additionalinfo = additional.match(/additional='(.*?)';/);
		clog(`Additional info: ${JSON.stringify(additionalinfo)}`);
		additionalStr = additionalStr + (( additionalinfo ) ? ` {{additional=${additionalinfo[1]}}}` : "");
		clog(`Additional info: ${additionalStr}`);

		//LOG 
		clog(`Character: ${char}, Base dice: ${successdice}, base string ${successStr}, modifiers: ${modifiers}, target: ${tn}, favoured ${featRoll}, skill favoured: ${act_fav}`);

		// START ROLL
        rollBase = `&{template:tor} {{character-name=${char} }} {{roll-name=${act} }} {{total=[[0]]}} {{diff=[[0]]}} {{greatness=[[0]]}} {{passthroughdata=[[0]]}} {{outcome=[[0]]}} {{successes=[[0]]}} ${featRoll} {{feat1=[[1d12]]}} {{feat2=[[1d12]]}} {{r1=[[ ${successStr} ]] }} {{target=${tn} }} ${favouredStr} ${wearyStr} ${miserableStr} ${modStr} {{skill-fav=${act_fav}}} ${weaponStr} ${additionalStr}`;
        let rollresult = await startRoll(rollBase),
        	rollSuccess = int(rollresult.results.r1.result,0),
        	rollFeat1 = int(rollresult.results.feat1.result,0),
        	rollFeat2 = int(rollresult.results.feat2.result,0),
			rollFeat = int(rollresult.results.feat.result,0);

		// FEAT DIE AND MISERABLE
		// Outcomes: Failure = 0, Success = 1, Feat success = 2, Piercing blow = 3, Weary failure = -1, Miserable failure = -2 
		clog(`Roll result results I: ${JSON.stringify(rollresult.results)}`);
		// Miserable logic, if Feat die is 0 (eye) then fail automatically, overrides all of below
		outcome = (miserable === 1 && rollFeat === 0) ? -2 : outcome;
		clog(`Outcome after Miserable: ${outcome}`);
		if ( rollFeat === 11 ) {
			outcome = 2; // outcome 2 = Feat Success
			//rollFeat = 0; // Gandalf rune face doesnt have a value, also doesnt matter with regards to success since it always succeeds
		}
		clog(`Outcome after Gandalf rune: ${outcome}`);
		let rollTotal = rollSuccess + rollFeat,
			rollDiff = rollTotal - int(tn);
		clog(`rollSuccess: ${rollSuccess}, Feat1: ${rollFeat1}, RollFeat2: ${rollFeat2}, rollTotal: ${rollTotal}, Target Number: ${tn}, Diff: ${rollDiff}`);
		clog(`Testing logic: ${!!(outcome !== 2 || outcome !== -2)}`);
		outcome = (outcome === 2 || outcome === -2) ? outcome : ((rollTotal >= tn) ? 1 : 0);
		clog(`Outcome after successes: ${outcome}`);
		
		// WEARY LOGIC
		// Weary logic, if weary then disregard all rolls below or equal to 3. 
		if (weary === 1) {
			// remove the 1, 2, 3, results, still add any closefitting bonus for protection rolls (already done)
			// Weary condition affects protections rolls, see discussion here: https://boardgamegeek.com/thread/2031462/protection-tests-when-weary
			rollSuccess = (_.reduce(rollresult.results.r1.dice, (memo, num) => { if(num <= 3) {return memo} else {return memo+num} }, 0)); 
			rollTotal = rollSuccess + rollFeat;
			rollDiff = rollTotal - int(tn); 
			outcome = (outcome === 2 || outcome === -2) ? outcome : ((rollTotal >= tn) ? 1 : -1);
			clog(`Weary successes: ${rollSuccess}, Weary total: ${rollTotal}, Weary diff: ${rollDiff}, outcome: ${outcome}`);
			clog(`Outcome after Weary: ${outcome}`);
		}
		
		// GREATNESS & FEAT DIE 
		// If feat die = 11 (Gandalf rune) then automatical success,  1s12-1 already covers for Eye side = 0
		// outcome = featSuccess === 11 ? 2 : outcome; // outcome 2 = Feat Success // Handled above
		// Test for piercing blow on a Gandalf rune or 10
		outcome = (rolltype === "combat") && (outcome === 1 || outcome === 2) && (rollFeat === 11 || rollFeat === 10) ? 3 : outcome; 
		clog(`Outcome after Piercing: ${outcome}`);
		// Piercing blow also at 9 if the weapon used is keen 
		outcome = rolltype === "combat" && keen > 0 && rollFeat === 9 && (outcome === 1 || outcome === 2) ? 3 : outcome; 
		clog(`Outcome after Keen: ${outcome}`);
		// count number of 6s in success, great or extraordinary success
		// Count the number of sixes rolled, to report degree of success
		clog(`Roll r1 : ${JSON.stringify(rollresult.results.r1.dice)}`);
		successDegree = (outcome === 1 || outcome === 2 || outcome === 3) ? _.reduce(rollresult.results.r1.dice, (memo, num) => { if(num == 6) {return ++memo} else {return memo} }, 0) : 0;
		clog(`Calculated degree of success: ${successDegree}`);	
		// Remove the 11 for Gandalf Rune, if three
		rollTotal = rollFeat === 11 ? rollTotal-11 : rollTotal;	

		// PASSTHROUGH DATA
		// Storing all the passthrough data required for the next roll in an Object helps for larger rolls
		//rollresult.results.difference.result = rollDiff; 
		//rollresult.results.passthroughdata = "This is a test";
        //clog(`Roll result results II: ${JSON.stringify(rollresult.results)}`);

        //clog(`First roll data: ${JSON.stringify(rollresult)}`);
        //clog(`First roll diff: ${JSON.stringify(rollDiff)}`);
		//clog(`Roll data: ${rollEscape.escape(rollData)}`);
        // Storing all the passthrough data required for the next roll in an Object helps for larger rolls

		// CALCULATED ROLL DATA 
		//let rollData = rollresult.results; // Holding the computed data in an object is a bit cleaner if your rolls get more complex
		let rollData = Object.assign(rollresult); // Holding the computed data in an object is a bit cleaner if your rolls get more complex
		rollData.total = rollTotal; 
		rollData.diff = rollDiff;
		rollData.successes = rollSuccess;
		//rollData.favoured = favouredStr; 
		rollData.outcome = outcome;
		rollData.greatness = successDegree;
		console.log('Roll data: ' + JSON.stringify(rollData));
		//rollData.passthroughdata = "This is a test";

		// FINISH ROLL
        finishRoll(rollresult.rollId, rollData);

    };

    // The attribute rolls
    on('clicked:strength clicked:wits clicked:heart', async (ev) => {
        clog(`Starting first roll`);		
		let action = (ev.htmlAttributes.name).slice(4),
			data = await asw.getAttrs(['character_name', '${action}tn', action, `${action}_favoured`]),
			actdice = data[action],
			act_fav = data[`${action}_favoured`],
			tn = data[`${action}tn`];
		clog(`First roll: ${JSON.stringify(data)}, Action : ${action}, Action value: ${actdice}, Action favoured value: ${act_fav}`);
        await rollFirst(data.character_name, action, actdice, tn, act_fav, "attribute");
        clog(`Completed first roll`);
    });

    // Strength based skill rolls
    on('clicked:awe clicked:athletics clicked:awareness clicked:hunting clicked:song clicked:craft', async (ev) => {
        clog(`Starting first roll`);
		let action = (ev.htmlAttributes.name).slice(4),
			data = await asw.getAttrs(['character_name', 'strengthtn', action, `${action}_favoured`]),
			actdice = data[action],
			act_fav = data[`${action}_favoured`];
		clog(`First roll: ${JSON.stringify(data)}, Action : ${action}, Action value: ${actdice}, Action favoured value: ${act_fav}`);
        await rollFirst(data.character_name, action, actdice, data.strengthtn, act_fav, "skill");
        clog(`Completed first roll`);
    });

    // Heart based skill rolls
    on('clicked:enhearten clicked:travel clicked:insight clicked:healing clicked:courtesy clicked:battle', async (ev) => {
        clog(`Starting first roll`);
		let action = (ev.htmlAttributes.name).slice(4),
			data = await asw.getAttrs(['character_name', 'hearttn', action, `${action}_favoured`]),
			actdice = data[action],
			act_fav = data[`${action}_favoured`];
		clog(`First roll: ${JSON.stringify(data)}, Action : ${action}, Action value: ${actdice}, Action favoured value: ${act_fav}`);
        await rollFirst(data.character_name, action, actdice, data.hearttn, act_fav, "skill");
        clog(`Completed first roll`);
    });

    // Wits based skill rolls
    on('clicked:persuade clicked:stealth clicked:scan clicked:explore clicked:riddle clicked:lore', async (ev) => {
        clog(`Starting first roll`);
		let action = (ev.htmlAttributes.name).slice(4),
			data = await asw.getAttrs(['character_name', 'witstn', action, `${action}_favoured`]),
			actdice = data[action],
			act_fav = data[`${action}_favoured`];
		clog(`First roll: ${JSON.stringify(data)}, Action : ${action}, Action value: ${actdice}, Action favoured value: ${act_fav}`);
        await rollFirst(data.character_name, action, actdice, data.witstn, act_fav, "skill");
        clog(`Completed first roll`);
    });

    // Combat proficiency rolls
    on('clicked:axes clicked:bows clicked:spears clicked:swords', async (ev) => {
        clog(`Starting first roll`);
		let action = (ev.htmlAttributes.name).slice(4),
			data = await asw.getAttrs(['character_name', 'strengthtn', action, `${action}_favoured`]),
			actdice = data[action],
			act_fav = data[`${action}_favoured`];
		clog(`First roll: ${JSON.stringify(data)}, Action : ${action}, Action value: ${actdice}, Action favoured value: ${act_fav}`);
        await rollFirst(data.character_name, action, actdice, data.strengthtn, act_fav, "combat");
        clog(`Completed first roll`);
    });

    // Weapon rolls
	//for ( let index = 1; index <= 5; index++ ) {
		on("clicked:weapon_1 clicked:weapon_2 clicked:weapon_3 clicked:weapon_4 clicked:weapon_5", async (ev) => {
			let index = (ev.htmlAttributes.name).slice(11);
			clog(`Starting first roll: weapon_${index}`);
			let data = await asw.getAttrs(['character_name', 'strengthtn', `weapon_skill_name_${index}`, `weapon_combat_prof_${index}`, `weapon_damage_${index}`, `weapon_injury_${index}`, `weapon_notes_${index}`, `weapon_fell_${index}`, `weapon_grievous_${index}`, `weapon_keen_${index}`, 'axes', 'bows', 'spears', 'swords']),
				action = data[`weapon_skill_name_${index}`],
				combatprof = data[`weapon_combat_prof_${index}`],
				damage = data[`weapon_damage_${index}`],
				injury = data[`weapon_injury_${index}`],
				notes = data[`weapon_notes_${index}`],
				keen = int(data[`weapon_keen_${index}`],0) === 0 ? "" : "Keen, ",
				fell = int(data[`weapon_fell_${index}`],0) === 0 ? "" : "Fell, ",
				grievous = int(data[`weapon_grievous_${index}`],0) === 0 ? "" : "Grievous, ",
				actdice = int(data[`${combatprof}`]);
			clog(`First roll: ${JSON.stringify(data)}, Action: ${action}, Dice: ${actdice}, Keen: ${keen}, tn: ${data.strengthtn}`);
			await rollFirst(data.character_name, action, actdice, data.strengthtn, 0, "combat", `weapon='${keen}${fell}${grievous}Damage: ${damage}, Injury: ${injury}'; additional='Notes: ${notes}';`);
			clog(`Completed first roll: weapon_${index}`);
		});
	//}	

    // Protection rolls
    on('clicked:protection', async (ev) => {
        clog(`Starting first roll`);
		let action = (ev.htmlAttributes.name).slice(4),
			data = await asw.getAttrs(['character_name', action, 'armourprot', 'helmprot', 'armourcf', 'armourcm', 'helmetcf', 'helmetcm']),
			actdice = int(data.armourprot,0) + int(data.helmprot,0);
		let additionalStr = "";
		additionalStr = additionalStr + ((data.armourcf == "1") ? "Close fitting armour, " : "");
		additionalStr = additionalStr + ((data.helmetcf == "1") ? "Close fitting helm, " : "");
		additionalStr = additionalStr + ((data.armourcm == "1") ? "Cunning made armour, " : "");
		additionalStr = additionalStr + ((data.helmetcm == "1") ? "Cunning made helm, " : "");
		additionalStr = additionalStr.slice(0,-2);
		clog(`First roll: ${JSON.stringify(data)}, Action : ${action}, protection value: ${actdice}, Additional: ${additionalStr}`);
        await rollFirst(data.character_name, action, actdice, "0", "0", "protection", `additional='${additionalStr}';`);
        clog(`Completed first roll`);
    });

    // Valour roll
    on('clicked:valour', async (ev) => {
        clog(`Starting first roll`);
		let action = 'valour',
			data = await asw.getAttrs(['character_name', 'hearttn', 'valour', 'valour_favoured']),
			actdice = data.valour,
			actfav = data.valour_favoured;
		clog(`First roll: ${JSON.stringify(data)}, Action : ${action}, protection value: ${actdice}`);
        await rollFirst(data.character_name, action, actdice, data.hearttn, actfav, "valour");
        clog(`Completed first roll`);
    });

    // Wisdom roll
    on('clicked:wisdom', async (ev) => {
        clog(`Starting first roll`);
		let action = 'wisdom',
			data = await asw.getAttrs(['character_name', 'witstn', 'wisdom', 'wisdom_favoured']),
			actdice = data.wisdom,
			actfav = data.wisdom_favoured;
		clog(`First roll: ${JSON.stringify(data)}, Action : ${action}, protection value: ${actdice}`);
        await rollFirst(data.character_name, action, actdice, data.witstn, actfav, "wisdom");
        clog(`Completed first roll`);
    });

    // Custom roll
    on('clicked:customroll', async (ev) => {
        clog(`Starting first roll`);
		let data = await asw.getAttrs(['character_name', 'customtn', 'customfeatdie', 'customsuccessdice', 'customname']),
			action = data.customname,
			actdice = data.customsuccessdice,
			actfav = data.customfeatdie;
		clog(`First roll: ${JSON.stringify(data)}, Action : ${action}, protection value: ${actdice}`);
        await rollFirst(data.character_name, action, actdice, data.customtn, actfav, "custom");
        clog(`Completed first roll`);
    });

	// VERSIONING
    // If need for specific data updates with new version then include as a case comparing sheet version with version in the below Switch statement
    on("sheet:opened", () => {
        getAttrs(["sheetversion", "version", "newchar"], (values) => {
            var sheet = float(values.sheetversion),
            actual = float(values.version),
            newchar = int(values.newchar);
            clog(`Versioning; sheet version: ${sheet}, actual: ${actual}, new char: ${newchar}`);

            // Add additional check below, e.g. case newchar != 1 && actual < 2.02
            // In the case statements, call on a separate function to handle data upgrades and other necessary changes
            switch (true) {
                case newchar == 1 :
                    // A new character would always be on the sheet version, no need to bother with upgrades but need to reset the newchar attribute
                    clog(`New character identified. New char: ${newchar}, sheet version: ${sheet}, actual: ${actual}`);
                    setAttrs({
                        version: sheet,
                        newchar: 0,
                        config_notice: 1
                    });
                    break;  
                case actual < sheet :
                    // This can be use as example of upgrade handling, use specific versions in the case logic to handle version specific upgrade of attributes, e.g. actual < 2.10 :
                    // Any upgrade handling needs to be done above this one, and may set the actual variable to be same as sheet to avoid doing the below setAttrs twice.
                    clog(`New version identified. New char: ${newchar}, sheet version: ${sheet}, actual: ${actual}`);
                    // Add reference to upgrade function here, if needed, e.g. upgrade_to_2.24() 
                    setAttrs({
                        version: sheet,
                        newchar: 0,
                        config_notice: 1
                    });
                    // In case an upgrade can be followed by further upgrading, then omit the break at this stage to move down the list of cases
                    break;
            }
        });
    });

    on("change:weapon_load_1 change:weapon_load_2 change:weapon_load_3 change:weapon_load_4 change:weapon_load_5 change:weapon_load_6 change:armourload change:helmload change:shieldload sheet:opened change:treasureload", function() {
	getAttrs(["weapon_load_1","weapon_load_2","weapon_load_3","weapon_load_4","weapon_load_5","weapon_load_6","armourload","shieldload","helmload","treasureload"], function(values) {
		const weaponload1 = int(values.weapon_load_1),
			weaponload2 = int(values.weapon_load_2),
			weaponload3 = int(values.weapon_load_3),
			weaponload4 = int(values.weapon_load_4),
			weaponload5 = int(values.weapon_load_5),
			weaponload6 = int(values.weapon_load_6),
			armourload = int(values.armourload),
			shieldload = int(values.shieldload),
			helmload = int(values.helmload),
			treasureload = int(values.treasureload),
			load = armourload + shieldload + helmload + weaponload1 + weaponload2 + weaponload3 + weaponload4 + weaponload5 + weaponload6 + treasureload; // Removed Fatigue, used to calculate vs Current Endurance and Weary condition below. 
		setAttrs({
			load: load,
			});
		});
	});

	// Replaced separate functions with a foreach to cover all changeable attributes. However, these are not used...
	attrs = ["awe", "athletics", "awareness", "hunting", "song", "craft", "enhearten", "travel", "insight", "healing", "courtesy", "battle", "persuade", "stealth", "scan", "explore", "riddle", "lore", "valour", "wisdom"];
	_.each(attrs, (element, index, attrs) => {
		on(`change:${element}_favoured sheet:opened`, function() {
			getAttrs([`${element}_favoured`], function(values) {
				let value = values[`${element}_favoured`]||0;
				valuetype = value == 0 ? "normal" : "favoured";
				setAttrs({
					[`${element}_fav`]: valuetype,
				});
			});
		});
	});

	on("change:weary sheet:opened", function() {
		getAttrs(["weary"], function(values) {
			let weary = values.weary||0;
			wearytype = weary == 0 ? "normal" : "weary";
			setAttrs({
				wearytype: wearytype,
			});
		});
	});

	// Calculate Weary condition and check that current endurance is not higher than max endurance
	on("change:endurance change:currentendurance change:load change:fatigue sheet:opened", () => {
		getAttrs(["endurance", "currentendurance", "weary", "fatigue", "load"], (values) => {
			const fatigue = int(values.fatigue),
				load = int(values.load),
				endurance = int(values.endurance);
				let weary = values.weary,
					currentendurance = int(values.currentendurance); 
				clog(`Endurance: ${JSON.stringify(values)}`);
				if ( load >= (currentendurance-fatigue) ) { weary = "on"; } else { weary = "off"}
				if ( currentendurance > endurance ) { currentendurance = endurance; }
				setAttrs({
					weary: weary,
					currentendurance: currentendurance,
				});
		});
	});

	on("change:currenthope change:shadow change:shadowscars sheet:opened", () => {
		getAttrs(["currenthope", "hope", "shadow", "shadowscar", "illfavoured"], (values) => {
			const currenthope = int(values.currenthope),
				hope = int(values.hope),
				shadow = int(values.shadow),
				scars = int(values.shadowscar),
				maxshadow = hope - scars;
				if ( (shadow + scars) >= currenthope ) {
					setAttrs({
						miserable: 'on',
					});
					clog(`Set miserable based on shadow score: shadow ${shadow} + scars ${scars} higher than current hope ${currenthope}.`);
				}  else {				
					setAttrs({
						miserable: 'off',
					});
				} /**/
				if ( (shadow + scars) >= hope ) {
					setAttrs({
						illfavoured: 1,
						shadow: maxshadow,
					});
					clog(`Set illfavoured based on shadow score: shadow ${shadow} + scars ${scars} higher than maximum hope ${hope}.`);
				} else {
					setAttrs({
						illfavoured: 0,
					});
					clog(`Reset illfavoured based on shadow score: shadow ${shadow} + scars ${scars} higher than maximum hope ${hope}.`);
				}
		});
	});

</script>


<rolltemplate class="sheet-rolltemplate-standard">
    <div class="sheet=pc">
        <div class="sheet-main">{{skill}}</div>
		{{#rollTotal() favorill 1}}
			<div class="sheet-main">stand {{standard}}</div>
		{{/rollTotal() favorill 1}}
		{{#rollTotal() favorill 2}}
			<div class="sheet-main">fav {{fav}}</div>
		{{/rollTotal() favorill 2}}
		{{#rollTotal() favorill 3}}
			<div class="sheet-main">ill {{ill}}</div>
		{{/rollTotal() favorill 3}}
    </div>
</rolltemplate>
<rolltemplate class="sheet-rolltemplate-tor">
	<div class="sheet-container sheet-color-{{color}}">
		<div class="sheet-header">
			{{#character-name}}<div class="sheet-title charname text-center">{{character-name}}</div>{{/character-name}}
			{{#roll-name}}<div class="sheet-subtitle rollname text-center">{{roll-name}}</div>{{/roll-name}}
		</div>
		<div class="sheet-content">
			<div class="full-col center die-title target-number">Target Number</div>
			<div class="full-col center die-result target-number"><span class="rotated-box"><span class="die-result">{{target}}</span></span></div>
			<div class="half-col die-title feat-label">Feat Die</div>
			<div class="half-col die-title success-label">Success<br/> Dice</div>
			{{#rollWasCrit() feat}}<div class="half-col die-result feat-die"><span class="rotated-box fullcrit">{{feat}}</span><span class="gandalf"></span></div>{{/rollWasCrit() feat}}
			{{#rollWasFumble() feat}}<div class="half-col die-result feat-die"><span class="rotated-box fullfail">{{feat}}</span><span class="eye"></span></div>{{/rollWasFumble() feat}}
			{{#rollBetween() feat 1 10}}<div class="half-col die-result feat-die"><span class="rotated-box">{{feat}}</span></div>{{/rollBetween() feat 1 10}}
			{{^feat}}<div class="half-col die-result feat-die"><span class="rotated-box"><span>-</span></span></div>{{/feat}}
			<div class="half-col die-result success-die"><span class="rotated-box">{{r1}}</span></div>
			<div class="half-col die-comment favoured">
				{{#favoured}}{{favoured}}{{/favoured}}
			</div>
			<div class="half-col die-comment modification">
				{{#modification}}Bonus {{modification}}{{/modification}}
			</div>
			<div class="half-col die-comment favoured red">
				{{#miserable}}{{miserable}}{{/miserable}}
			</div>
			<div class="half-col die-comment weary red">
				{{#weary}}{{weary}}{{/weary}}
			</div>
			<div class="full-col center die-result roll-total"><span class="rotated-box">{{computed::total}}</span></div>
			<div class="full-col center die-title roll-total">Total</div>
			<div class="full-col center die-result roll-diff"><span class="rotated-box">{{computed::diff}}</span></div>
			<div class="full-col center die-title roll-diff">Diff</div>
			<div class="full-col center roll-outcome">
				<div class="center die-title">
					{{#rollLess() computed::outcome 1}}
						{{#rollTotal() computed::outcome -2}}Miserable&nbsp;&nbsp;{{/rollTotal() computed::outcome -2}}
						{{#rollTotal() computed::outcome -1}}Weary&nbsp;&nbsp;{{/rollTotal() computed::outcome -1}}
						Failure!
					{{/rollLess() computed::outcome 1}}
					{{#rollBetween() computed::outcome 1 3}}
						{{#rollTotal() computed::greatness 1}}Great&nbsp;&nbsp;({{computed::greatness}})&nbsp;{{/rollTotal() computed::greatness 1}}
						{{#rollGreater() computed::greatness 1}}Extraordinary&nbsp;&nbsp;({{computed::greatness}})&nbsp;{{/rollGreater() computed::greatness 1}}
						{{#rollTotal() computed::outcome 2}}Feat&nbsp;&nbsp;{{/rollTotal() computed::outcome 2}}
						{{#rollBetween() computed::outcome 1 2}}Success!{{/rollBetween() computed::outcome 1 2}}
						{{#rollTotal() computed::outcome 3}}Piercing&nbsp;&nbsp;Blow!{{/rollTotal() computed::outcome 3}}
					{{/rollBetween() computed::outcome 1 3}}
				</div>
			</div>
		</div>
		<div class="sheet-footer">
			{{#weaponinfo}}
			<div class="full-col center additional">
				<div class="center">
					{{weaponinfo}}
				</div>
			</div>	
			{{/weaponinfo}}	
			{{#additional}}
			<div class="full-col center additional">
				<div class="center">
					{{additional}}
				</div>
			</div>	
			{{/additional}}	
		</div>
		<!-- 
		<div class="sheet-extra">
			<div class="sheet-key">Roll greatness</div>
			<div class="sheet-value">{{computed::greatness}}</div>
			<div class="sheet-key">Roll total</div>
			<div class="sheet-value">{{computed::total}}</div>
			<div class="sheet-key">Roll diff</div>
			<div class="sheet-value">{{computed::diff}}</div>
			<div class="sheet-key">Favour</div>
			<div class="sheet-value">{{computed::favour}}</div>
			{{#allprops() character-name roll-name favour total diff feat1 feat2}}
			<div class="sheet-key">{{key}}</div>
			<div class="sheet-value">{{value}}</div>
			{{/allprops() character-name roll-name favour total diff feat1 feat2}}
			{{#desc}}<div class="sheet-desc">{{desc}}</div>{{/desc}}
		</div> -->
	</div>
</rolltemplate>