<div class="sheet-overall-wrapper">
    <!--Main Header -->
    <div class="sheet-core-header sheet-padb">
        <div class="sheet-row">
            <div class="sheet-col-1-4 sheet-margin-top">
                <img src="https://raw.githubusercontent.com/dedurrett/lfg-character-sheet/master/LFG_LOGO.png" alt="Low Fantasy Gaming" width=50 >
            </div>
            <div class="sheet-col-1-8 sheet-center sheet-margin-top">
                <p class="sheet-last-updated">Sheet version 2.0<br/>November 2018</p>
                <input name="attr_version" type="hidden">
            </div>
                <div class="sheet-col-1-4 sheet-small-label sheet-center">
                <input class="sheet-underlined sheet-center" type="text" name="attr_character_name"><br/>Character Name
            </div>
            <div class="sheet-col-1-8 sheet-small-label sheet-center">
                <input class="sheet-underlined sheet-center" type="text" name="attr_class"><br/>Class
            </div>
            <div class="sheet-col-1-8 sheet-small-label sheet-center">
                <input class="sheet-underlined sheet-center" type="number" name="attr_level"><br/>Level
            </div>
        </div>
    </div>
    <h4 class="sheet-center">Personal Details </h4>
	<div class="sheet-row">
		<div class="sheet-col-1-7 sheet-small-label sheet-center"><input class="sheet-underlined sheet-center" type="text" name="attr_gender"><br/>Gender</div>
		<div class="sheet-col-1-7 sheet-small-label sheet-center"><input class="sheet-underlined sheet-center" type="number" name="attr_age"><br/>Age</div>
		<div class="sheet-col-1-7 sheet-small-label sheet-center"><input class="sheet-underlined sheet-center" type="text" name="attr_height"><br/>Height</div>
		<div class="sheet-col-1-7 sheet-small-label sheet-center"><input class="sheet-underlined sheet-center" type="text" name="attr_weight"><br/>Weight</div>
		<div class="sheet-col-1-7 sheet-small-label sheet-center"><input class="sheet-underlined sheet-center" type="text" name="attr_eyes"><br/>Eyes</div>
		<div class="sheet-col-1-7 sheet-small-label sheet-center"><input class="sheet-underlined sheet-center" type="text" name="attr_hair"><br/>Hair</div>
		<div class="sheet-col-1-7 sheet-small-label sheet-center"><input class="sheet-underlined sheet-center" type="text" name="attr_race"><br/>Race</div>
	</div>
	<div class="sheet-row sheet-padb">
		<div class="sheet-col-1-4 sheet-small-label sheet-center"><input class="sheet-underlined sheet-center" type="text" name="attr_background"><br/>Background</div>
		<div class="sheet-col-5-8 sheet-small-label sheet-center"><input class="sheet-underlined sheet-center" type="text" name="attr_languages"><br/>Languages</div>
		<div class="sheet-col-1-8 sheet-small-label sheet-center"><input class="sheet-underlined sheet-center" type="text" name="attr_vision"><br/>Vision</div>
	</div>
    <!-- Tabs-->
    <input type="checkbox" name="attr_tab1" class="sheet-tab sheet-tab1" value="1" checked />
    <span class="sheet-tab sheet-tab1">Main</span>
    <input type="checkbox" name="attr_tab2" class="sheet-tab sheet-tab2" value="1" checked />
    <span class="sheet-tab sheet-tab2">Skills & Features</span>
    <input type="checkbox" name="attr_tab3" class="sheet-tab sheet-tab3" value="1" checked />
    <span class="sheet-tab sheet-tab3">Weapons</span>
    <input type="checkbox" name="attr_tab4" class="sheet-tab sheet-tab4" value="1" checked />
    <span class="sheet-tab sheet-tab4">Spellbook</span>
    <input type="checkbox" name="attr_tab5" class="sheet-tab sheet-tab5" value="1" checked />
    <span class="sheet-tab sheet-tab5">Inventory</span>
    <input type="checkbox" name="attr_tab6" class="sheet-tab sheet-tab6" value="1" checked />
    <span class="sheet-tab sheet-tab6">Injuries & Setbacks</span>
	<span class="sheet-spacer"></span>
    <!--Main Page-->
    <div class="sheet-section-main">
		<div class="sheet-row">
			<div class="sheet-col-1-2 sheet-padr">
				<h4 class="sheet-center">Attributes</h4>
				<div class="sheet-row sheet-sub-header">
					<div class="sheet-col-1-10 sheet-center sheet-small-label">Score</div>
					<div class="sheet-col-1-10 sheet-center sheet-small-label">Max</div>
					<div class="sheet-col-1-8 sheet-center sheet-small-label">&nbsp;</div>
					<div class="sheet-col-1-13 sheet-center sheet-small-label">Adj.</div>
					<div class="sheet-col-1-7 sheet-center sheet-small-label">Advantage</div>
					<div class="sheet-col-1-8 sheet-center sheet-small-label">Roll</div>
					<div class="sheet-col-1-3 sheet-center sheet-small-label">Notes</div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-10"><input type="number" name="attr_strength" min="1" step="1" /></div>
					<div class="sheet-col-1-10"><input type="number" name="attr_strength_max" min="1" step="1" /></div>
					<div class="sheet-col-1-8 sheet-core-stat-label">Str</div>
					<div class="sheet-col-1-13">
						<input type="text" name="attr_strength_mod" value="0" readonly/>
					</div>
				   <div class="sheet-col-1-7">
                        <select name="attr_strengthadvantage">
                            <option value="2d20kl1">ADV</option>
                            <option value="1d20" selected>NO</option>
                            <option value="2d20kh1">DIS</option>
                        </select>
                    </div>
					<div class="sheet-col-1-8 sheet-center">
					    <!-- Rolling Advantage h/l swap depending -->
					    <!-- ?{Advantage|Normal,1d20|Advantage,2d20kl1|Disadvantage,2d20kh1} -->
					    <!-- How to show advantage in the roll template
					        {{subheaderright= @{strengthadvantage}}} -> this will just eval as the roll result
					    -->
						<button type="roll" name="roll_Str" value="&{template:5eDefault} {{ability=1}} {{title=Strength Check}} {{subheader=@{character_name}}} {{roll=[[@{strength}-(@{strengthadvantage}-(?{Modifier|0}))]]}}"></button>
					</div>
					<div class="sheet-col-1-3 sheet-tiny-note">Melee,&nbsp;Athletics</div>
				</div>
				<div class="sheet-row">
                    <div class="sheet-col-1-10"><input type="number" name="attr_dexterity" min="1" step="1" /></div>
                    <div class="sheet-col-1-10"><input type="number" name="attr_dexterity_max" min="1" step="1" /></div>
					<div class="sheet-col-1-8 sheet-core-stat-label">Dex</div>
					<div class="sheet-col-1-13">
						<input type="text" name="attr_dexterity_mod" value="0" readonly/>
					</div>
				   <div class="sheet-col-1-7">
                        <select name="attr_dexterityadvantage">
                            <option value="2d20kl1">ADV</option>
                            <option value="1d20" selected>NO</option>
                            <option value="2d20kh1">DIS</option>
                        </select>
                    </div>
					<div class="sheet-col-1-8 sheet-center">
						<button type="roll" name="roll_Dex" value="&{template:5eDefault} {{ability=1}} {{title=Dexterity Check}} {{subheader=@{character_name}}} {{roll=[[@{dexterity}-(@{dexterityadvantage}-(?{Modifier|0}))]]}}"></button>
					</div>
					<div class="sheet-col-1-3 sheet-tiny-note">Ranged,&nbsp;AC</div>
				</div>
                <div class="sheet-row">
                    <div class="sheet-col-1-10"><input type="number" name="attr_constitution" min="1" step="1" /></div>
                    <div class="sheet-col-1-10"><input type="number" name="attr_constitution_max" min="1" step="1" /></div>
					<div class="sheet-col-1-8 sheet-core-stat-label">Con</div>
					<div class="sheet-col-1-13">
						<input type="text" name="attr_constitution_mod" value="0" readonly/>
					</div>
				   <div class="sheet-col-1-7">
                        <select name="attr_constitutionadvantage">
                            <option value="2d20kl1">ADV</option>
                            <option value="1d20" selected>NO</option>
                            <option value="2d20kh1">DIS</option>
                        </select>
                    </div>
					<div class="sheet-col-1-8 sheet-center">
						<button type="roll" name="roll_Con" value="&{template:5eDefault} {{ability=1}} {{title=Constitution Check}} {{subheader=@{character_name}}} {{roll=[[@{constitution}-(@{constitutionadvantage}-(?{Modifier|0}))]]}}"></button>
					</div>
					<div class="sheet-col-1-3 sheet-tiny-note">Hit&nbsp;Points,&nbsp;Poison</div>
				</div>
                <div class="sheet-row">
					<div class="sheet-col-1-10"><input type="number" name="attr_intelligence" min="1" step="1" /></div>
					<div class="sheet-col-1-10"><input type="number" name="attr_intelligence_max" min="1" step="1" /></div>
					<div class="sheet-col-1-8 sheet-core-stat-label">Int</div>
					<div class="sheet-col-1-13">
						<input type="text" name="attr_intelligence_mod" value="0" readonly/>
					</div>
				   <div class="sheet-col-1-7">
                        <select name="attr_intelligenceadvantage">
                            <option value="2d20kl1">ADV</option>
                            <option value="1d20" selected>NO</option>
                            <option value="2d20kh1">DIS</option>
                        </select>
                    </div>
					<div class="sheet-col-1-8 sheet-center">
						<button type="roll" name="roll_Int" value="&{template:5eDefault} {{ability=1}} {{title=Intelligence Check}} {{subheader=@{character_name}}} {{roll=[[@{intelligence}-(@{intelligenceadvantage}-(?{Modifier|0}))]]}}"></button>
					</div>
					<div class="sheet-col-1-3 sheet-tiny-note">Lore,&nbsp;Insight,&nbsp;Lang</div>
				</div>
                <div class="sheet-row">
                    <div class="sheet-col-1-10"><input type="number" name="attr_perception" min="1" step="1" /></div>
                    <div class="sheet-col-1-10"><input type="number" name="attr_perception_max" min="1" step="1" /></div>
					<div class="sheet-col-1-8 sheet-core-stat-label">Per</div>
					<div class="sheet-col-1-13">
						<input type="text" name="attr_perception_mod" value="0" readonly/>
					</div>
				   <div class="sheet-col-1-7">
                        <select name="attr_perceptionadvantage">
                            <option value="2d20kl1">ADV</option>
                            <option value="1d20" selected>NO</option>
                            <option value="2d20kh1">DIS</option>
                        </select>
                    </div>
					<div class="sheet-col-1-8 sheet-center">
						<button type="roll" name="roll_Per" value="&{template:5eDefault} {{ability=1}} {{title=Perception Check}} {{subheader=@{character_name}}} {{roll=[[@{perception}-(@{perceptionadvantage}-(?{Modifier|0}))]]}}"></button>
					</div>
					<div class="sheet-col-1-3 sheet-tiny-note">Alertness,&nbsp;Detection</div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-10"><input type="number" name="attr_willpower" min="1" step="1" /></div>
					<div class="sheet-col-1-10"><input type="number" name="attr_willpower_max" min="1" step="1" /></div>
					<div class="sheet-col-1-8 sheet-core-stat-label">Will</div>
					<div class="sheet-col-1-13">
						<input type="text" name="attr_willpower_mod" value="0" readonly/>
					</div>
				   <div class="sheet-col-1-7">
                        <select name="attr_willpoweradvantage">
                            <option value="2d20kl1">ADV</option>
                            <option value="1d20" selected>NO</option>
                            <option value="2d20kh1">DIS</option>
                        </select>
                    </div>
					<div class="sheet-col-1-8 sheet-center">
						<button type="roll" name="roll_Will" value="&{template:5eDefault} {{ability=1}} {{title=Willpower Check}} {{subheader=@{character_name}}} {{roll=[[@{willpower}-(@{willpoweradvantage}-(?{Modifier|0}))]]}}"></button>
					</div>
					<div class="sheet-col-1-3 sheet-tiny-note">Mental&nbsp;Defence,&nbsp;Recovery</div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-10"><input type="number" name="attr_charisma" min="1" step="1" /></div>
					<div class="sheet-col-1-10"><input type="number" name="attr_charisma_max" min="1" step="1" /></div>
					<div class="sheet-col-1-8 sheet-core-stat-label">Cha</div>
					<div class="sheet-col-1-13">
						<input type="text" name="attr_charisma_mod" value="0" readonly/>
					</div>
				   <div class="sheet-col-1-7">
                        <select name="attr_charismaadvantage">
                            <option value="2d20kl1">ADV</option>
                            <option value="1d20" selected>NO</option>
                            <option value="2d20kh1">DIS</option>
                        </select>
                    </div>
					<div class="sheet-col-1-8 sheet-center">
						<button type="roll" name="roll_Cha" value="&{template:5eDefault} {{ability=1}} {{title=Charisma Check}} {{subheader=@{character_name}}} {{roll=[[@{charisma}-(@{charismaadvantage}-(?{Modifier|0}))]]}}"></button>
					</div>
					<div class="sheet-col-1-3 sheet-tiny-note">Influence,&nbsp;Morale</div>
				</div>
                <div class="sheet-row">
                    <div class="sheet-col-1-10"><input type="number" name="attr_luck" min="1" step="1" /></div>
                    <div class="sheet-col-1-10"><input type="number" name="attr_luck_max" min="1" step="1" /></div>
					<div class="sheet-col-1-8 sheet-core-stat-label">Luck</div>
					<div class="sheet-col-1-13">
						<input type="text" name="attr_luck_mod" value="0" readonly/>
					</div>
				   <div class="sheet-col-1-7">
                        <select name="attr_luckadvantage">
                            <option value="2d20kl1">ADV</option>
                            <option value="1d20" selected>NO</option>
                            <option value="2d20kh1">DIS</option>
                        </select>
                    </div>
					<div class="sheet-col-1-8 sheet-center">
					    <!-- +(?{Luck Save|Luck,0|Luck(STR),@{strength_mod}|Luck(DEX),@{dexterity_mod}|Luck(CON),@{constitution_mod}|Luck(INT),@{intelligence_mod}|Luck(PER),@{perception_mod}|Luck(WILL),@{willpower_mod}|Luck(CHA),@{charisma_mod}}) -->
						<button type="roll" name="roll_Luck" value="&{template:5eDefault} {{ability=1}} {{title=Luck Check}} {{subheader=@{character_name}}} {{roll=[[@{luck}-(@{luckadvantage}-(?{Modifier|0}))]]}}"></button>
					</div>
					<div class="sheet-col-1-3 sheet-tiny-note">Saves,&nbsp;Exploits</div>
				</div>
			</div>
			<!--Buncha Stats-->
			<div class="sheet-col-1-2 sheet-padr">
				<h4 class="sheet-center">Statistics</h4>
				<div class="sheet-row">
                    <div class="sheet-col-1-2 sheet-padr">
                        <div class="sheet-center sheet-small-label sheet-vert-bottom sheet-sub-header">Hit Points</div>
                        <div class="sheet-row">
                            <div class="sheet-col-1-2 sheet-small-label sheet-center">
                                <input class="sheet-underlined" type="number" name="attr_HP" step="1" value="0">
                                <br/>Current
                            </div>
                            <div class="sheet-col-1-2 sheet-small-label sheet-center">
                                <input class="sheet-underlined" type="number" name="attr_HP_max" min="1" step="1" value="1">
                                <br/>Max
                            </div>
                        </div>
                    </div>
                    <div class="sheet-col-1-2 sheet-padr">
                        <div class="sheet-center sheet-small-label sheet-vert-bottom sheet-sub-header">Initiative</div>
                        <div class="sheet-row">
                            <div class="sheet-col-1-2 sheet-small-label sheet-center">
                                <input class="sheet-underlined" type="number" name="attr_initiative" step="1" value="0">
                                Misc Bonus
                            </div>
        				   <div class="sheet-col-1-3 sheet-small-label sheet-center">
                                <select name="attr_initiativeadvantage">
                                    <option value="2d20kh1">ADV</option>
                                    <option value="1d20" selected>NO</option>
                                    <option value="2d20kl1">DIS</option>
                                </select>
                                <br/>Advantage
                            </div>
                            <div class="sheet-col-1-6 sheet-small-label sheet-center">
                                <button type="roll" name="roll_Initiative" value="&{template:5eDefault} {{title=Initiative}} {{subheader=@{character_name}}} {{rollname=Initiative}} {{roll=[[ 1d20+(@{dexterity_mod})+(@{initiative}) &{tracker} ]]}}"></button>
                                <div class="sheet-tiny-spacer"></div>Roll
                            </div>
                        </div>
                    </div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-col-1-2 sheet-padr">
                        <div class="sheet-center sheet-small-label sheet-vert-bottom sheet-sub-header">Attack Bonus</div>
                        <div class="sheet-row">
                            <div class="sheet-col-1-1 sheet-small-label sheet-center">
                                <input class="sheet-underlined sheet-center" type="number" name="attr_class_hitbonus" step="1" value="0">
                                <br/>&nbsp;
                            </div>
                        </div>
                    </div>
                    <div class="sheet-col-1-2 sheet-padr">
                        <div class="sheet-center sheet-small-label sheet-vert-bottom sheet-sub-header">Armour Class</div>
                        <div class="sheet-row">
                            <div class="sheet-col-1-1 sheet-small-label sheet-center">
                                <input class="sheet-underlined sheet-center" type="number" name="attr_armour_class" step="1" value="10">
                                <br/>&nbsp;
                            </div>
                        </div>
                    </div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-col-1 sheet-padr">
                        <div class="sheet-center sheet-small-label sheet-vert-bottom sheet-sub-header">Reroll Pool</div>
                    </div>
                    <div class="sheet-col-1-2 sheet-padr">
                        <div class="sheet-row">
                            <div class="sheet-col-1-2 sheet-small-label sheet-center">
                                <input class="sheet-underlined" type="number" name="attr_rerolls" step="1" value="0">
                                <br/>Current
                            </div>
                            <div class="sheet-col-1-2 sheet-small-label sheet-center">
                                <input class="sheet-underlined" type="number" name="attr_rerolls_max" value="@{level}" disabled="disabled">
                                <br/>Max
                            </div>
                        </div>
                    </div>
                    <div class="sheet-col-1-2 sheet-padr">
                        <div class="sheet-row">
                            <div class="sheet-col-1-4 sheet-tiny-note">Skill&nbsp;checks,&nbsp;Luck&nbsp;rolls,&nbsp;Rest recoveries,&nbsp;and&nbsp;Dead&nbsp;tests.</div>
                        </div>
                    </div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-col-1 sheet-padr">
                        <div class="sheet-center sheet-small-label sheet-vert-bottom sheet-sub-header">Dark and Dangerous Magic</div>
                    </div>
                    <div class="sheet-col-1-12 sheet-padr">
                        <button type="roll" class="sheet-roll" name="roll_DDM" value="&{template:5eDefault} {{ddm=1}} {{title=Dark & Dangerous Magic}} {{subheader=@{character_name}}} {{ddmroll=[[1d20]]}} {{ddmthreshold=[[@{DDM}]]}}"></button>
                    </div>
                    <div class="sheet-col-5-12 sheet-padr">
                        <input class="sheet-underlined sheet-center" type="number" name="attr_DDM" step="1" value="1">
                    </div>
                    <div class="sheet-col-1-2 sheet-padr">
                        <div class="sheet-row">
                            <div class="sheet-col-1-4 sheet-tiny-note">Threshold&nbsp;by&nbsp;which&nbsp;a&nbsp;roll&nbsp;on&nbsp;the Dark&nbsp;and&nbsp;Dangerous&nbsp;Magic&nbsp;table&nbsp;is triggered.</div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
<!----------------------------------------------------------->
    <!--Class-->
    <div class="sheet-section-class">
		<div class="sheet-row">
			<div class="sheet-col-1-2 sheet-padr">
				<h4 class="sheet-center">Features</h4>
				<div class="sheet-row sheet-sub-header">
					<div class="sheet-col-2-7 sheet-center sheet-small-label">Feature Name / Uses</div>
					<div class="sheet-col-5-7 sheet-center sheet-small-label">Feature Description</div>
				</div>
				<fieldset class="repeating_features">
				    <div class="sheet-row">
                        <div class="sheet-col-2-7">
                            <div class="sheet-row">
                                <input type="text" name="attr_featurename">
                            </div>
                            <div class="sheet-row">
                                <div class="sheet-col-1-4">
                                    <button type="roll" name="roll_Feature" value="&{template:5eDefault} {{feature=1}} {{featuresubheader=@{character_name}}} {{featureuses=@{feature_uses}}} {{featureusesmax=@{feature_uses_max}}} {{featureusesmaxnum=[[@{feature_uses_max}]]}} {{title=@{featurename}}} {{featureshowdesc=@{featuredescr}}}"></button>
                                </div>
                                <div class="sheet-col-3-10">
                                    <input type="number" name="attr_feature_uses" min="0" step="1" value="0" />
                                </div>
                                <div class="sheet-col-1-10 sheet-tiny-note">
                                    &nbsp;/&nbsp;
                                </div>
                                <div class="sheet-col-3-10">
                                    <input type="number" name="attr_feature_uses_max" min="1" step="1" value="0" />
                                </div>
                            </div>
                        </div>
                        <div class="sheet-col-5-7">
                            <div class="sheet-auto-expand">
                            	<span name="attr_featuredescr"></span>
                            	<textarea class="sheet-auto-expand" spellcheck="false" name="attr_featuredescr"></textarea>
                            </div>
                        </div>
                    </div>
                </fieldset>
			</div>
			<!--Buncha Stats-->
			<div class="sheet-col-1-2 sheet-padr">
				<h4 class="sheet-center">Skills</h4>
				<div class="sheet-row sheet-sub-header">
					<div class="sheet-col-1-2 sheet-center sheet-small-label">Skill Name</div>
					<div class="sheet-col-1-7 sheet-center sheet-small-label">Attribute</div>
					<div class="sheet-col-1-7 sheet-center sheet-small-label">Advantage</div>
					<div class="sheet-col-1-10 sheet-center sheet-small-label">Modifier</div>
					<div class="sheet-col-1-10 sheet-center sheet-small-label">Roll</div>
				</div>
				<fieldset class="repeating_skills">
				    <div class="sheet-row">
                        <div class="sheet-col-1-2">
                            <input type="text" name="attr_skillname">
                        </div>
                        <div class="sheet-col-1-7">
                            <select name="attr_skilltype">
                                <option value="@{strength}" selected>STR</option>
                                <option value="@{dexterity}">DEX</option>
                                <option value="@{constitution}">CON</option>
                                <option value="@{intelligence}">INT</option>
                                <option value="@{perception}">PER</option>
                                <option value="@{willpower}">WILL</option>
                                <option value="@{charisma}">CHA</option>
                                <option value="@{luck}">LUCK</option>
                            </select>
                        </div>
                        <div class="sheet-col-1-7">
                            <select name="attr_skilladvantage">
                                <option value="2d20kl1">ADV</option>
                                <option value="1d20" selected>NO</option>
                                <option value="2d20kh1">DIS</option>
                            </select>
                        </div>
                        <div class="sheet-col-1-10">
                            <input type="number" name="attr_skillmod" value="0" step="1">
                        </div>
                        <div class="sheet-col-1-10 sheet-center">
                            <button type="roll" name="roll_Skill" value="&{template:5eDefault} {{ability=1}} {{title=@{skillname} Check}} {{subheader=@{character_name}}} {{roll=[[@{skilltype}+1-(@{skilladvantage}-@{skillmod}-(?{Modifier|0}))]]}}"></button>
                        </div>
                    </div>
                </fieldset>
            </div>
        </div>
    </div>
<!----------------------------------------------------------->
    <!--Combat-->
    <div class="sheet-section-combat">
        <span class="sheet-spacer"></span>
        <div class="sheet-col-1">
            <h4 class="sheet-center">Melee Weapons</h4>
            <div class="sheet-row">
                <div class="sheet-row sheet-sub-header">
                    <div class="sheet-col-1-6 sheet-center sheet-small-label">Weapon Name</div>
                    <div class="sheet-col-1-16 sheet-center sheet-small-label sheet-padr">+Hit</div>
                    <div class="sheet-col-1-16 sheet-center sheet-small-label sheet-padr">+Damage</div>
                    <div class="sheet-col-1-12 sheet-center sheet-small-label">Base Damage</div>
                    <div class="sheet-col-13-24 sheet-center sheet-small-label">Weapon Notes</div>
                    <div class="sheet-col-1-24 sheet-center sheet-small-label sheet-padr"></div>
                    <div class="sheet-col-1-24 sheet-center sheet-small-label sheet-padr">Roll</div>
                </div>
            </div>
        </div>
        <fieldset class="repeating_meleeattacks">
            <div class="sheet-row">
                <div class="sheet-col-1-6 sheet-padr"><input type="text" name="attr_melee_weaponname"></div>
                <div class="sheet-col-1-16 sheet-padr"><input type="number" name="attr_melee_hitbonus" value="0" step="1"></div>
                <div class="sheet-col-1-16 sheet-padr"><input type="number" name="attr_melee_dmgbonus" value="0" step="1"></div>
                <div class="sheet-col-1-12 sheet-padr"><input class="sheet-center" type="text" name="attr_melee_dmgbase" value="1d4"></div>
                <div class="sheet-col-13-24 sheet-padr"><input type="text" name="attr_melee_description" placeholder="STR adustment factored in."></div>
                <div class="sheet-col-1-24 sheet-padr"><input type="checkbox" name="attr_meleedescr_toggle" value="@{meleedescr_var}"></div>
                <input type="hidden" name="attr_meleedescr_var" value={{attackdescription=@{melee_description}}}>
                <div class="sheet-col-1-24 sheet-padr sheet-center">
                    <button type="roll" class="sheet-roll" name="roll_MeleeAttack" value="&{template:5eDefault} {{weapon=1}} {{title=@{melee_weaponname}}} {{subheader=@{character_name}}} {{attack=[[@{class_hitbonus}+(@{strength_mod})+(@{melee_hitbonus})+?{Advantage|Normal,1d20|Advantage,2d20kh1|Disadvantage,2d20kl1}+(?{Hit Modifier|0})]]}} {{damage=[[{@{melee_dmgbase}+(@{strength_mod})+(@{melee_dmgbonus})+(?{Damage Modifier|0}), 1d1}k1]]}} @{meleedescr_toggle}"></button>
                </div>
            </div>
        </fieldset>
        <span class="sheet-spacer"></span>
        <div class="sheet-col-1">
            <h4 class="sheet-center">Ranged Weapons</h4>
            <div class="sheet-row">
                <div class="sheet-row sheet-sub-header">
                    <div class="sheet-col-1-6 sheet-center sheet-small-label">Weapon Name</div>
                    <div class="sheet-col-1-16 sheet-center sheet-small-label sheet-padr">+Hit</div>
                    <div class="sheet-col-1-16 sheet-center sheet-small-label sheet-padr">+Damage</div>
                    <div class="sheet-col-1-12 sheet-center sheet-small-label">Base Damage</div>
                    <div class="sheet-col-1-12 sheet-center sheet-small-label sheet-padr">Range</div>
                    <div class="sheet-col-11-24 sheet-center sheet-small-label">Weapon Notes</div>
                    <div class="sheet-col-1-24 sheet-center sheet-small-label sheet-padr"></div>
                    <div class="sheet-col-1-24 sheet-center sheet-small-label sheet-padr">Roll</div>
                </div>
            </div>
        </div>
        <fieldset class="repeating_rangedattacks">
            <div class="sheet-row">
                <div class="sheet-col-1-6 sheet-padr"><input type="text" name="attr_range_weaponname"></div>
                <div class="sheet-col-1-16 sheet-padr"><input type="number" name="attr_range_hitbonus" value="0" step="1"></div>
                <div class="sheet-col-1-16 sheet-padr"><input type="number" name="attr_range_dmgbonus" value="0" step="1"></div>
                <div class="sheet-col-1-12 sheet-padr"><input class="sheet-center" type="text" name="attr_range_dmgbase" value="1d4"></div>
                <div class="sheet-col-1-12 sheet-padr"><input type="text" name="attr_range_distance"></div>
                <div class="sheet-col-11-24 sheet-padr"><input type="text" name="attr_range_description" placeholder="DEX adjustment factored in."></div>
                <div class="sheet-col-1-24 sheet-padr"><input type="checkbox" name="attr_rangedescr_toggle" value="@{rangedescr_var}"></div>
                <input type="hidden" name="attr_rangedescr_var" value={{attackdescription=@{range_description}}}>
                <div class="sheet-col-1-24 sheet-padr sheet-center">
                    <button type="roll" class="sheet-roll" name="roll_RangeAttack" value="&{template:5eDefault} {{weapon=1}} {{title=@{range_weaponname}}} {{subheader=@{character_name}}} {{attack=[[@{class_hitbonus}+(@{dexterity_mod})+(@{range_hitbonus})+?{Advantage|Normal,1d20|Advantage,2d20kh1|Disadvantage,2d20kl1}+(?{Hit Modifier|0})]]}} {{damage=[[{@{range_dmgbase}+(@{dexterity_mod})+(@{range_dmgbonus})+(?{Damage Modifier|0}), 1d1}k1]]}} @{rangedescr_toggle}"></button>
                </div>
            </div>
        </fieldset>
    </div>
<!----------------------------------------------------------->
    <!--Spellbook-->
    <div class="sheet-section-spellbook">
		<h4 class="sheet-center">Spellbook</h4>
		<input type="radio" name="attr_spellpagetab" class="sheet-spellpagetab sheet-spelltab1" value="1" title="Level 1" checked/>
		<span class="sheet-spellpagetab sheet-spelltab1">Level 1</span>
		<input type="radio" name="attr_spellpagetab" class="sheet-spellpagetab sheet-spelltab2" value="2" title="Level 2"/>
		<span class="sheet-spellpagetab sheet-spelltab2">Level 2</span>
		<input type="radio" name="attr_spellpagetab" class="sheet-spellpagetab sheet-spelltab3" value="3" title="Level 3"/>
		<span class="sheet-spellpagetab sheet-spelltab3">Level 3</span>
		<input type="radio" name="attr_spellpagetab" class="sheet-spellpagetab sheet-spelltab4" value="4" title="Level 4"/>
		<span class="sheet-spellpagetab sheet-spelltab4">Level 4</span>
		<input type="radio" name="attr_spellpagetab" class="sheet-spellpagetab sheet-spelltab5" value="5" title="Level 5"/>
		<span class="sheet-spellpagetab sheet-spelltab5">Level 5</span>
		<input type="radio" name="attr_spellpagetab" class="sheet-spellpagetab sheet-spelltab6" value="6" title="Level 6"/>
		<span class="sheet-spellpagetab sheet-spelltab6">Level 6</span>
		<input type="radio" name="attr_spellpagetab" class="sheet-spellpagetab sheet-spelltab99" value="99" title="Show All"/>
		<span class="sheet-spellpagetab sheet-spelltab99">Show All</span>
		<span class="sheet-spacer"></span>	
		<!-- BEGIN AUTO GENERATED SPELL PAGES -->
	    <!-- BEGIN new spell page -->
		<div class="sheet-spell-page1">
		    <div class="sheet-row sheet-sub-header">
				<div class="sheet-col-1 sheet-vert-bottom sheet-center sheet-small-label">Level 1</div>
			</div>
			<fieldset class="repeating_spellbooklevel1">
			<!-- BEGIN spell row -->
			    <span class="sheet-spacer"></span>
    			<div class="sheet-margin-bottom sheet-padr sheet-padl">
    				<div class="sheet-row">
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Spell Level</div>
    					<div class="sheet-col-13-24 sheet-vert-bottom sheet-center sheet-small-label">Spell Name</div>
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Range</div>
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Duration</div>
    					<div class="sheet-col-1-12 sheet-center sheet-small-label sheet-vert-bottom">Roll</div>
    				</div>
    				
    				<div class="sheet-row">
    					<div class="sheet-col-1-8 sheet-vert-middle sheet-center">Level 1<input type="hidden" name="attr_spellbaselevel" value="1"></div>
    					<div class="sheet-col-13-24 sheet-vert-middle"><input type="text" name="attr_spellname"></div>
    					<div class="sheet-col-1-8 sheet-vert-middle"><input type="text" name="attr_spellrange"></div>
    					<div class="sheet-col-1-8 sheet-vert-middle"><input type="text" name="attr_spellduration"></div>
                        <div class="sheet-col-1-12 sheet-center">
                            <button type="roll" class="sheet-roll" name="roll_SpellCast" value="&{template:5eDefault} {{spell=1}} {{spellshowinfoblock=1}} {{spellshowdesc=1}} {{title=@{spellname}}} {{subheader=@{character_name}}} {{subheaderright=Level @{spellbaselevel} Spell}} {{spellduration=@{spellduration}}} {{spellrange=@{spellrange}}} {{spelldescription=@{spelldescr}}} {{ddmrequest=[Dark & Dangerous Magic Roll](~@{character_id}|DDM)}}"></button>
                        </div>
    				</div>
    				<div class="sheet-row">
    				    <div class="sheet-col-1">
        					<div class="sheet-auto-expand">
                                <span name="attr_spelldescr"></span>
                                <textarea class="sheet-auto-expand" spellcheck="false" name="attr_spelldescr" placeholder="Spell Description and Effects"></textarea>
                            </div>
                        </div>
    				</div>
    				<span class="sheet-spacer"></span>
    			</div>
			<!-- END spell row -->	
			</fieldset>
		</div>
		<!-- END spell page -->
		<!-- BEGIN new spell page -->
		<div class="sheet-spell-page2">
		    <div class="sheet-row sheet-sub-header">
				<div class="sheet-col-1 sheet-vert-bottom sheet-center sheet-small-label">Level 2</div>
			</div>
			<fieldset class="repeating_spellbooklevel2">
			<!-- BEGIN spell row -->
			    <span class="sheet-spacer"></span>
    			<div class="sheet-margin-bottom sheet-padr sheet-padl">
    				<div class="sheet-row">
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Spell Level</div>
    					<div class="sheet-col-13-24 sheet-vert-bottom sheet-center sheet-small-label">Spell Name</div>
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Range</div>
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Duration</div>
    					<div class="sheet-col-1-12 sheet-center sheet-small-label sheet-vert-bottom">Roll</div>
    				</div>
    				
    				<div class="sheet-row">
    					<div class="sheet-col-1-8 sheet-vert-middle sheet-center">Level 2<input type="hidden" name="attr_spellbaselevel" value="2"></div>
    					<div class="sheet-col-13-24 sheet-vert-middle"><input type="text" name="attr_spellname"></div>
    					<div class="sheet-col-1-8 sheet-vert-middle"><input type="text" name="attr_spellrange"></div>
    					<div class="sheet-col-1-8 sheet-vert-middle"><input type="text" name="attr_spellduration"></div>
                        <div class="sheet-col-1-12 sheet-center">
                            <button type="roll" class="sheet-roll" name="roll_SpellCast" value="&{template:5eDefault} {{spell=1}} {{spellshowinfoblock=1}} {{spellshowdesc=1}} {{title=@{spellname}}} {{subheader=@{character_name}}} {{subheaderright=Level @{spellbaselevel} Spell}} {{spellduration=@{spellduration}}} {{spellrange=@{spellrange}}} {{spelldescription=@{spelldescr}}} {{ddmrequest=[Dark & Dangerous Magic Roll](~@{character_id}|DDM)}}"></button>
                        </div>
    				</div>
    				<div class="sheet-row">
    				    <div class="sheet-col-1">
        					<div class="sheet-auto-expand">
                                <span name="attr_spelldescr"></span>
                                <textarea class="sheet-auto-expand" spellcheck="false" name="attr_spelldescr" placeholder="Spell Description and Effects"></textarea>
                            </div>
                        </div>
    				</div>
    				<span class="sheet-spacer"></span>
    			</div>
			<!-- END spell row -->	
			</fieldset>
		</div>
		<!-- END spell page -->
		<!-- BEGIN new spell page -->
		<div class="sheet-spell-page3">
		    <div class="sheet-row sheet-sub-header">
				<div class="sheet-col-1 sheet-vert-bottom sheet-center sheet-small-label">Level 3</div>
			</div>
			<fieldset class="repeating_spellbooklevel3">
			<!-- BEGIN spell row -->
			    <span class="sheet-spacer"></span>
    			<div class="sheet-margin-bottom sheet-padr sheet-padl">
    				<div class="sheet-row">
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Spell Level</div>
    					<div class="sheet-col-13-24 sheet-vert-bottom sheet-center sheet-small-label">Spell Name</div>
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Range</div>
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Duration</div>
    					<div class="sheet-col-1-12 sheet-center sheet-small-label sheet-vert-bottom">Roll</div>
    				</div>
    				
    				<div class="sheet-row">
    					<div class="sheet-col-1-8 sheet-vert-middle sheet-center">Level 3<input type="hidden" name="attr_spellbaselevel" value="3"></div>
    					<div class="sheet-col-13-24 sheet-vert-middle"><input type="text" name="attr_spellname"></div>
    					<div class="sheet-col-1-8 sheet-vert-middle"><input type="text" name="attr_spellrange"></div>
    					<div class="sheet-col-1-8 sheet-vert-middle"><input type="text" name="attr_spellduration"></div>
                        <div class="sheet-col-1-12 sheet-center">
                            <button type="roll" class="sheet-roll" name="roll_SpellCast" value="&{template:5eDefault} {{spell=1}} {{spellshowinfoblock=1}} {{spellshowdesc=1}} {{title=@{spellname}}} {{subheader=@{character_name}}} {{subheaderright=Level @{spellbaselevel} Spell}} {{spellduration=@{spellduration}}} {{spellrange=@{spellrange}}} {{spelldescription=@{spelldescr}}} {{ddmrequest=[Dark & Dangerous Magic Roll](~@{character_id}|DDM)}}"></button>
                        </div>
    				</div>
    				<div class="sheet-row">
    				    <div class="sheet-col-1">
        					<div class="sheet-auto-expand">
                                <span name="attr_spelldescr"></span>
                                <textarea class="sheet-auto-expand" spellcheck="false" name="attr_spelldescr" placeholder="Spell Description and Effects"></textarea>
                            </div>
                        </div>
    				</div>
    				<span class="sheet-spacer"></span>
    			</div>
			<!-- END spell row -->	
			</fieldset>
		</div>
		<!-- END spell page -->
		<!-- BEGIN new spell page -->
		<div class="sheet-spell-page4">
		    <div class="sheet-row sheet-sub-header">
				<div class="sheet-col-1 sheet-vert-bottom sheet-center sheet-small-label">Level 4</div>
			</div>
			<fieldset class="repeating_spellbooklevel4">
			<!-- BEGIN spell row -->
			    <span class="sheet-spacer"></span>
    			<div class="sheet-margin-bottom sheet-padr sheet-padl">
    				<div class="sheet-row">
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Spell Level</div>
    					<div class="sheet-col-13-24 sheet-vert-bottom sheet-center sheet-small-label">Spell Name</div>
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Range</div>
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Duration</div>
    					<div class="sheet-col-1-12 sheet-center sheet-small-label sheet-vert-bottom">Roll</div>
    				</div>
    				
    				<div class="sheet-row">
    					<div class="sheet-col-1-8 sheet-vert-middle sheet-center">Level 4<input type="hidden" name="attr_spellbaselevel" value="4"></div>
    					<div class="sheet-col-13-24 sheet-vert-middle"><input type="text" name="attr_spellname"></div>
    					<div class="sheet-col-1-8 sheet-vert-middle"><input type="text" name="attr_spellrange"></div>
    					<div class="sheet-col-1-8 sheet-vert-middle"><input type="text" name="attr_spellduration"></div>
                        <div class="sheet-col-1-12 sheet-center">
                            <button type="roll" class="sheet-roll" name="roll_SpellCast" value="&{template:5eDefault} {{spell=1}} {{spellshowinfoblock=1}} {{spellshowdesc=1}} {{title=@{spellname}}} {{subheader=@{character_name}}} {{subheaderright=Level @{spellbaselevel} Spell}} {{spellduration=@{spellduration}}} {{spellrange=@{spellrange}}} {{spelldescription=@{spelldescr}}} {{ddmrequest=[Dark & Dangerous Magic Roll](~@{character_id}|DDM)}}"></button>
                        </div>
    				</div>
    				<div class="sheet-row">
    				    <div class="sheet-col-1">
        					<div class="sheet-auto-expand">
                                <span name="attr_spelldescr"></span>
                                <textarea class="sheet-auto-expand" spellcheck="false" name="attr_spelldescr" placeholder="Spell Description and Effects"></textarea>
                            </div>
                        </div>
    				</div>
    				<span class="sheet-spacer"></span>
    			</div>
			<!-- END spell row -->	
			</fieldset>
		</div>
		<!-- END spell page -->
		<!-- BEGIN new spell page -->
		<div class="sheet-spell-page5">
		    <div class="sheet-row sheet-sub-header">
				<div class="sheet-col-1 sheet-vert-bottom sheet-center sheet-small-label">Level 5</div>
			</div>
			<fieldset class="repeating_spellbooklevel5">
			<!-- BEGIN spell row -->
			    <span class="sheet-spacer"></span>
    			<div class="sheet-margin-bottom sheet-padr sheet-padl">
    				<div class="sheet-row">
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Spell Level</div>
    					<div class="sheet-col-13-24 sheet-vert-bottom sheet-center sheet-small-label">Spell Name</div>
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Range</div>
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Duration</div>
    					<div class="sheet-col-1-12 sheet-center sheet-small-label sheet-vert-bottom">Roll</div>
    				</div>
    				
    				<div class="sheet-row">
    					<div class="sheet-col-1-8 sheet-vert-middle sheet-center">Level 5<input type="hidden" name="attr_spellbaselevel" value="5"></div>
    					<div class="sheet-col-13-24 sheet-vert-middle"><input type="text" name="attr_spellname"></div>
    					<div class="sheet-col-1-8 sheet-vert-middle"><input type="text" name="attr_spellrange"></div>
    					<div class="sheet-col-1-8 sheet-vert-middle"><input type="text" name="attr_spellduration"></div>
                        <div class="sheet-col-1-12 sheet-center">
                            <button type="roll" class="sheet-roll" name="roll_SpellCast" value="&{template:5eDefault} {{spell=1}} {{spellshowinfoblock=1}} {{spellshowdesc=1}} {{title=@{spellname}}} {{subheader=@{character_name}}} {{subheaderright=Level @{spellbaselevel} Spell}} {{spellduration=@{spellduration}}} {{spellrange=@{spellrange}}} {{spelldescription=@{spelldescr}}} {{ddmrequest=[Dark & Dangerous Magic Roll](~@{character_id}|DDM)}}"></button>
                        </div>
    				</div>
    				<div class="sheet-row">
    				    <div class="sheet-col-1">
        					<div class="sheet-auto-expand">
                                <span name="attr_spelldescr"></span>
                                <textarea class="sheet-auto-expand" spellcheck="false" name="attr_spelldescr" placeholder="Spell Description and Effects"></textarea>
                            </div>
                        </div>
    				</div>
    				<span class="sheet-spacer"></span>
    			</div>
			<!-- END spell row -->	
			</fieldset>
		</div>
		<!-- END spell page -->
		<!-- BEGIN new spell page -->
		<div class="sheet-spell-page6">
		    <div class="sheet-row sheet-sub-header">
				<div class="sheet-col-1 sheet-vert-bottom sheet-center sheet-small-label">Level 6</div>
			</div>
			<fieldset class="repeating_spellbooklevel6">
			<!-- BEGIN spell row -->
			    <span class="sheet-spacer"></span>
    			<div class="sheet-margin-bottom sheet-padr sheet-padl">
    				<div class="sheet-row">
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Spell Level</div>
    					<div class="sheet-col-13-24 sheet-vert-bottom sheet-center sheet-small-label">Spell Name</div>
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Range</div>
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Duration</div>
    					<div class="sheet-col-1-12 sheet-center sheet-small-label sheet-vert-bottom">Roll</div>
    				</div>
    				
    				<div class="sheet-row">
    					<div class="sheet-col-1-8 sheet-vert-middle sheet-center">Level 6<input type="hidden" name="attr_spellbaselevel" value="6"></div>
    					<div class="sheet-col-13-24 sheet-vert-middle"><input type="text" name="attr_spellname"></div>
    					<div class="sheet-col-1-8 sheet-vert-middle"><input type="text" name="attr_spellrange"></div>
    					<div class="sheet-col-1-8 sheet-vert-middle"><input type="text" name="attr_spellduration"></div>
                        <div class="sheet-col-1-12 sheet-center">
                            <button type="roll" class="sheet-roll" name="roll_SpellCast" value="&{template:5eDefault} {{spell=1}} {{spellshowinfoblock=1}} {{spellshowdesc=1}} {{title=@{spellname}}} {{subheader=@{character_name}}} {{subheaderright=Level @{spellbaselevel} Spell}} {{spellduration=@{spellduration}}} {{spellrange=@{spellrange}}} {{spelldescription=@{spelldescr}}} {{ddmrequest=[Dark & Dangerous Magic Roll](~@{character_id}|DDM)}}"></button>
                        </div>
    				</div>
    				<div class="sheet-row">
    				    <div class="sheet-col-1">
        					<div class="sheet-auto-expand">
                                <span name="attr_spelldescr"></span>
                                <textarea class="sheet-auto-expand" spellcheck="false" name="attr_spelldescr" placeholder="Spell Description and Effects"></textarea>
                            </div>
                        </div>
    				</div>
    				<span class="sheet-spacer"></span>
    			</div>
			<!-- END spell row -->	
			</fieldset>
		</div>
		<!-- END spell page -->
		<!-- END AUTO GENERATED SPELL PAGES -->
	</div>

<!----------------------------------------------------------->
    <!--Inventory-->
<!----------------------------------------------------------->

	<!--Inventory -->
	<div class="sheet-section-inventory">
		<div class="sheet-row ">
			<!-- Loot-->
			<div class="sheet-col-1-2 sheet-padr">
				<h4 class="sheet-center">Coin</h4>
				<div class="sheet-row sheet-sub-header">
					<div class="sheet-col-1-6 sheet-center sheet-small-label">CP</div>
					<div class="sheet-col-1-6 sheet-center sheet-small-label">SP</div>
					<div class="sheet-col-1-6 sheet-center sheet-small-label">EP</div>
					<div class="sheet-col-1-6 sheet-center sheet-small-label">GP</div>
					<div class="sheet-col-1-6 sheet-center sheet-small-label">PP</div>
					<div class="sheet-col-1-6 sheet-center sheet-small-label">Total (GP)</div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-6" title="Copper Pieces"><input type="number" name="attr_cp" value="0" min="0" step="1"></div>
					<div class="sheet-col-1-6" title="Silver Pieces"><input type="number" name="attr_sp" value="0" min="0" step="1"></div>
					<div class="sheet-col-1-6" title="Electrum Pieces"><input type="number" name="attr_ep" value="0" min="0" step="1"></div>
					<div class="sheet-col-1-6" title="Gold Pieces"><input type="number" name="attr_gp" value="0" min="0" step="1"></div>
					<div class="sheet-col-1-6" title="Platinum Pieces"><input type="number" name="attr_pp" value="0" min="0" step="1"></div>
					<div class="sheet-col-1-6" title="Total (in Gold Pieces)"><input type="number" name="attr_money_total_gp" value="(@{cp} / 100) + (@{sp} / 10) + (@{ep} / 2) + @{gp} + (@{pp} * 5) " disabled="disabled"></div>
				</div>
				<h4 class="sheet-center">Treasure/Loot/Inventory Notes</h4>
				<textarea name="attr_lootnotes"></textarea>
			</div>
			<!--Encumbrance and Inventory Locations -->
			<div class="sheet-col-1-2">
				<h4 class="sheet-center">Inventory Locations</h4>
				<div class="sheet-row sheet-sub-header">
					<div class="sheet-col-1-8 sheet-center sheet-small-label sheet-padl">Tab</div>
					<div class="sheet-col-7-8 sheet-center sheet-small-label">Name</div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-8 sheet-center sheet-padl">1</div>
					<div class="sheet-col-7-8 sheet-center"><input type="text" name="attr_itab1" value="Worn"></div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-8 sheet-center sheet-padl">2</div>
					<div class="sheet-col-7-8 sheet-center"><input type="text" name="attr_itab2" value="Carried"></div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-8 sheet-center sheet-padl">3</div>
					<div class="sheet-col-7-8 sheet-center"><input type="text" name="attr_itab3" value="Backpack"></div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-8 sheet-center sheet-padl">4</div>
					<div class="sheet-col-7-8 sheet-center"><input type="text" name="attr_itab4" value="Belt pouch"></div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-8 sheet-center sheet-padl">5</div>
					<div class="sheet-col-7-8 sheet-center"><input type="text" name="attr_itab5" value="Sack large"></div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-8 sheet-center sheet-padl">6</div>
					<div class="sheet-col-7-8 sheet-center"><input type="text" name="attr_itab6" value="Mount"></div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-8 sheet-center sheet-padl">7</div>
					<div class="sheet-col-7-8 sheet-center"><input type="text" name="attr_itab7" value="Other"></div>
				</div>
			</div>
		</div>
		<h4 class="sheet-center">Inventory</h4>
		<input type="checkbox" name="attr_inventorytab1" class="sheet-inventorytab sheet-inventorytab1" value="1" title="Page 1" />
		<span class="sheet-inventorytab sheet-inventorytab1" name="attr_itab1"></span>
		<input type="checkbox" name="attr_inventorytab2" class="sheet-inventorytab sheet-inventorytab2" value="2" title="Page 2" />
		<span class="sheet-inventorytab sheet-inventorytab2" name="attr_itab2"></span>
		<input type="checkbox" name="attr_inventorytab3" class="sheet-inventorytab sheet-inventorytab3" value="3" title="Page 3" />
		<span class="sheet-inventorytab sheet-inventorytab3" name="attr_itab3"></span>
		<input type="checkbox" name="attr_inventorytab4" class="sheet-inventorytab sheet-inventorytab4" value="4" title="Page 4" />
		<span class="sheet-inventorytab sheet-inventorytab4" name="attr_itab4"></span>
		<input type="checkbox" name="attr_inventorytab5" class="sheet-inventorytab sheet-inventorytab5" value="5" title="Page 5" />
		<span class="sheet-inventorytab sheet-inventorytab5" name="attr_itab5"></span>
		<input type="checkbox" name="attr_inventorytab6" class="sheet-inventorytab sheet-inventorytab6" value="6" title="Page 6" />
		<span class="sheet-inventorytab sheet-inventorytab6" name="attr_itab6"></span>
		<input type="checkbox" name="attr_inventorytab7" class="sheet-inventorytab sheet-inventorytab7" value="7" title="Page 7" />
		<span class="sheet-inventorytab sheet-inventorytab7" name="attr_itab7"></span>
		<span class="sheet-spacer"></span>
		<!-- Inventory Page 1-->
		<div class="sheet-inventory-page1">
			<div class="sheet-row sheet-sub-header">
			    <div class="sheet-col-1 sheet-center sheet-small-label sheet-padl"><span name="attr_itab1"></span></div>
				<div class="sheet-col-1-4 sheet-center sheet-small-label sheet-padl">Name</div>
				<div class="sheet-col-2-21 sheet-center sheet-small-label">Qty</div>
				<div class="sheet-col-2-21 sheet-center sheet-small-label">Uses</div>
				<div class="sheet-col-13-24 sheet-center sheet-small-label sheet-padl">Notes</div>
			</div>
			<fieldset class="repeating_inventtab1">
				<div class="sheet-row">
					<div class="sheet-col-1-4 sheet-small-label sheet-left"><input type="text" name="attr_itemname"></div>
					<div class="sheet-col-2-21 sheet-padl sheet-center"><input type="number" name="attr_itemquantity"></div>
					<div class="sheet-col-2-21 sheet-padl sheet-center"><input type="number" name="attr_itemuses"></div>
					<div class="sheet-col-13-24 sheet-padl sheet-small-label sheet-left"><input type="text" name="attr_itemdesc"></div>
				</div>
			</fieldset>
		</div>
		<!-- Inventory Page 2-->
		<div class="sheet-inventory-page2">
			<div class="sheet-row sheet-sub-header">
			    <div class="sheet-col-1 sheet-center sheet-small-label sheet-padl"><span name="attr_itab2"></span></div>
				<div class="sheet-col-1-4 sheet-center sheet-small-label sheet-padl">Name</div>
				<div class="sheet-col-2-21 sheet-center sheet-small-label">Qty</div>
				<div class="sheet-col-2-21 sheet-center sheet-small-label">Uses</div>
				<div class="sheet-col-13-24 sheet-center sheet-small-label sheet-padl">Notes</div>
			</div>
			<fieldset class="repeating_inventtab2">
				<div class="sheet-row">
					<div class="sheet-col-1-4 sheet-small-label sheet-left"><input type="text" name="attr_itemname"></div>
					<div class="sheet-col-2-21 sheet-padl sheet-center"><input type="number" name="attr_itemquantity"></div>
					<div class="sheet-col-2-21 sheet-padl sheet-center"><input type="number" name="attr_itemuses"></div>
					<div class="sheet-col-13-24 sheet-padl sheet-small-label sheet-left"><input type="text" name="attr_itemdesc"></div>
				</div>
			</fieldset>
		</div>
		<!-- Inventory Page 3-->
		<div class="sheet-inventory-page3">
			<div class="sheet-row sheet-sub-header">
			    <div class="sheet-col-1 sheet-center sheet-small-label sheet-padl"><span name="attr_itab3"></span></div>
				<div class="sheet-col-1-4 sheet-center sheet-small-label sheet-padl">Name</div>
				<div class="sheet-col-2-21 sheet-center sheet-small-label">Qty</div>
				<div class="sheet-col-2-21 sheet-center sheet-small-label">Uses</div>
				<div class="sheet-col-13-24 sheet-center sheet-small-label sheet-padl">Notes</div>
			</div>
			<fieldset class="repeating_inventtab3">
				<div class="sheet-row">
					<div class="sheet-col-1-4 sheet-small-label sheet-left"><input type="text" name="attr_itemname"></div>
					<div class="sheet-col-2-21 sheet-padl sheet-center"><input type="number" name="attr_itemquantity"></div>
					<div class="sheet-col-2-21 sheet-padl sheet-center"><input type="number" name="attr_itemuses"></div>
					<div class="sheet-col-13-24 sheet-padl sheet-small-label sheet-left"><input type="text" name="attr_itemdesc"></div>
				</div>
			</fieldset>
		</div>
		<!-- Inventory Page 4-->
		<div class="sheet-inventory-page4">
			<div class="sheet-row sheet-sub-header">
			    <div class="sheet-col-1 sheet-center sheet-small-label sheet-padl"><span name="attr_itab4"></span></div>
				<div class="sheet-col-1-4 sheet-center sheet-small-label sheet-padl">Name</div>
				<div class="sheet-col-2-21 sheet-center sheet-small-label">Qty</div>
				<div class="sheet-col-2-21 sheet-center sheet-small-label">Uses</div>
				<div class="sheet-col-13-24 sheet-center sheet-small-label sheet-padl">Notes</div>
			</div>
			<fieldset class="repeating_inventtab4">
				<div class="sheet-row">
					<div class="sheet-col-1-4 sheet-small-label sheet-left"><input type="text" name="attr_itemname"></div>
					<div class="sheet-col-2-21 sheet-padl sheet-center"><input type="number" name="attr_itemquantity"></div>
					<div class="sheet-col-2-21 sheet-padl sheet-center"><input type="number" name="attr_itemuses"></div>
					<div class="sheet-col-13-24 sheet-padl sheet-small-label sheet-left"><input type="text" name="attr_itemdesc"></div>
				</div>
			</fieldset>
		</div>
		<!-- Inventory Page 5-->
		<div class="sheet-inventory-page5">
			<div class="sheet-row sheet-sub-header">
			    <div class="sheet-col-1 sheet-center sheet-small-label sheet-padl"><span name="attr_itab5"></span></div>
				<div class="sheet-col-1-4 sheet-center sheet-small-label sheet-padl">Name</div>
				<div class="sheet-col-2-21 sheet-center sheet-small-label">Qty</div>
				<div class="sheet-col-2-21 sheet-center sheet-small-label">Uses</div>
				<div class="sheet-col-13-24 sheet-center sheet-small-label sheet-padl">Notes</div>
			</div>
			<fieldset class="repeating_inventtab5">
				<div class="sheet-row">
					<div class="sheet-col-1-4 sheet-small-label sheet-left"><input type="text" name="attr_itemname"></div>
					<div class="sheet-col-2-21 sheet-padl sheet-center"><input type="number" name="attr_itemquantity"></div>
					<div class="sheet-col-2-21 sheet-padl sheet-center"><input type="number" name="attr_itemuses"></div>
					<div class="sheet-col-13-24 sheet-padl sheet-small-label sheet-left"><input type="text" name="attr_itemdesc"></div>
				</div>
			</fieldset>
		</div>
		<!-- Inventory Page 6-->
		<div class="sheet-inventory-page6">
			<div class="sheet-row sheet-sub-header">
			    <div class="sheet-col-1 sheet-center sheet-small-label sheet-padl"><span name="attr_itab6"></span></div>
				<div class="sheet-col-1-4 sheet-center sheet-small-label sheet-padl">Name</div>
				<div class="sheet-col-2-21 sheet-center sheet-small-label">Qty</div>
				<div class="sheet-col-2-21 sheet-center sheet-small-label">Uses</div>
				<div class="sheet-col-13-24 sheet-center sheet-small-label sheet-padl">Notes</div>
			</div>
			<fieldset class="repeating_inventtab6">
				<div class="sheet-row">
					<div class="sheet-col-1-4 sheet-small-label sheet-left"><input type="text" name="attr_itemname"></div>
					<div class="sheet-col-2-21 sheet-padl sheet-center"><input type="number" name="attr_itemquantity"></div>
					<div class="sheet-col-2-21 sheet-padl sheet-center"><input type="number" name="attr_itemuses"></div>
					<div class="sheet-col-13-24 sheet-padl sheet-small-label sheet-left"><input type="text" name="attr_itemdesc"></div>
				</div>
			</fieldset>
		</div>
		<!-- Inventory Page 7-->
		<div class="sheet-inventory-page7">
			<div class="sheet-row sheet-sub-header">
			    <div class="sheet-col-1 sheet-center sheet-small-label sheet-padl"><span name="attr_itab7"></span></div>
				<div class="sheet-col-1-4 sheet-center sheet-small-label sheet-padl">Name</div>
				<div class="sheet-col-2-21 sheet-center sheet-small-label">Qty</div>
				<div class="sheet-col-2-21 sheet-center sheet-small-label">Uses</div>
				<div class="sheet-col-13-24 sheet-center sheet-small-label sheet-padl">Notes</div>
			</div>
			<fieldset class="repeating_inventtab7">
				<div class="sheet-row">
					<div class="sheet-col-1-4 sheet-small-label sheet-left"><input type="text" name="attr_itemname"></div>
					<div class="sheet-col-2-21 sheet-padl sheet-center"><input type="number" name="attr_itemquantity"></div>
					<div class="sheet-col-2-21 sheet-padl sheet-center"><input type="number" name="attr_itemuses"></div>
					<div class="sheet-col-13-24 sheet-padl sheet-small-label sheet-left"><input type="text" name="attr_itemdesc"></div>
				</div>
			</fieldset>
		</div>
	</div>
<!----------------------------------------------------------->
    <!--Injury-->
    <div class="sheet-section-injury">
		<div class="sheet-row">
			<div class="sheet-col-1 sheet-padr">
				<h4 class="sheet-center">Injuries & Setbacks</h4>
				<div class="sheet-row sheet-sub-header">
					<div class="sheet-col-1-6 sheet-center sheet-small-label">Type</div>
					<div class="sheet-col-5-6 sheet-center sheet-small-label">Description</div>
				</div>
				<fieldset class="repeating_injuries">
				    <div class="sheet-row">
                        <div class="sheet-col-1-6">
                            <input type="text" name="attr_injuryname">
                        </div>
                        <div class="sheet-col-5-6">
                            <div class="sheet-auto-expand">
                            	<span name="attr_injurydescr"></span>
                            	<textarea class="sheet-auto-expand" spellcheck="false" name="attr_injurydescr"></textarea>
                            </div>
                        </div>
                    </div>
                </fieldset>
			</div>
        </div>
    </div>
<!----------------------------------------------------------->
</div>
<!-- Roll Templates -->
<rolltemplate class="sheet-rolltemplate-5eDefault">
	<div class="sheet-rt-card">
		<div class="sheet-rt-header{{#weapon}} sheet-weapon{{/weapon}}{{#spell}} sheet-spell{{/spell}}{{#ability}} sheet-ability{{/ability}}{{#save}} sheet-save{{/save}}{{#feature}} sheet-feature{{/feature}}{{#ddm}} sheet-ddm{{/ddm}}">
			<div class="sheet-rt-title">{{title}}</div>
			{{#subheader}}
			<div class="sheet-rt-subheader">{{subheader}}{{#subheaderright}} &bullet; {{subheaderright}}{{/subheaderright}}</div>
			{{/subheader}}
			{{#featuresubheader}}
			    {{#rollGreater() featureusesmaxnum 0}}
			        <div class="sheet-rt-subheader">{{featuresubheader}} &bullet; {{featureuses}}/{{featureusesmax}} Uses</div>
			    {{/rollGreater() featureusesmaxnum 0}}
			    {{#^rollGreater() featureusesmaxnum 0}}
			        <div class="sheet-rt-subheader">{{featuresubheader}}</div>
			    {{/^rollGreater() featureusesmaxnum 0}}
			{{/featuresubheader}}
			{{#subheader2}}
			<div class="sheet-rt-subheader">{{subheader2}}{{#subheaderright2}} &bullet; {{subheaderright2}}{{/subheaderright2}}</div>
			{{/subheader2}}
		</div>
			{{#emote}}
			<p class="sheet-rt-emote">{{character_name}} {{emote}}</p>
			{{/emote}}
			<div class="sheet-main-content">
				<!--Weapon based attacks-->
				{{#attack}}
				<div class="sheet-row">
					<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Attack</div>
					<div class="sheet-col-7-12 sheet-padr sheet-rt-value">hits AC {{attack}}</div>
				</div>
				{{/attack}}
				{{#damage}}
				<div class="sheet-row">
					<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Damage</div>
					<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{damage}}</div>
				</div>
				{{/damage}}
				{{#attackdescription}}
                <div class="sheet-row">
					<div class="sheet-col-1 sheet-padl sheet-padr sheet-rt-value">{{attackdescription}}</div>
				</div>
				{{/attackdescription}}
				{{#ddm}}
			    <div class="sheet-row">
				    <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Threshold</div>
				    <div class="sheet-col-7-12 sheet-padl sheet-padr sheet-rt-value">{{ddmthreshold}}</div>
				</div>
				<div class="sheet-row">
                    {{#rollLess() ddmroll ddmthreshold}}
                        <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Result</div>
				        <div class="sheet-col-7-12 sheet-padl sheet-padr sheet-rt-value" style="color: red;">{{ddmroll}} Trigger!</div>
                    {{/rollLess() ddmroll ddmthreshold}}
                    {{#rollTotal() ddmroll ddmthreshold}}
                        <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Result</div>
				        <div class="sheet-col-7-12 sheet-padl sheet-padr sheet-rt-value" style="color: red;">{{ddmroll}} Trigger!</div>
                    {{/rollTotal() ddmroll ddmthreshold}}
                    {{#rollGreater() ddmroll ddmthreshold}}
                        <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Result</div>
				        <div class="sheet-col-7-12 sheet-padl sheet-padr sheet-rt-value">{{ddmroll}}</div>
                    {{/rollGreater() ddmroll ddmthreshold}}
                </div>
				{{/ddm}}
				<!--Spellcasting-->
				{{#spellshowinfoblock}}
				<div class="sheet-row sheet-padb">
					<div class="sheet-col-1-2 sheet-padl sheet-padr sheet-center"><span class="sheet-rt-key">Duration</span><br/><span class="sheet-rt-value">{{spellduration}}</span></div>
					<div class="sheet-col-1-2 sheet-padl sheet-padr sheet-center"><span class="sheet-rt-key">Range</span><br/><span class="sheet-rt-value">{{spellrange}}</span></div>
				</div>
				{{/spellshowinfoblock}}
				{{#spellshowattack}}
				<div class="sheet-row">
					<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Attack</div>
					<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{spellattack}} AC Hit</div>
				</div>
				{{/spellshowattack}}
				{{#spellshowsavethrow}}
				<div class="sheet-row">
					<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Save</div>
					<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{spellsavestat}}</div>
				</div>
				{{/spellshowsavethrow}}
				{{#spellshowhealing}}
				<div class="sheet-row">
					<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Healing</div>
					<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{spellhealing}} HP healed</div>
				</div>
				{{/spellshowhealing}}
				{{#spellshowdamage}}
				<div class="sheet-row">
					<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Damage</div>
					<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{spelldamage}}</div>
				</div>
				{{/spellshowdamage}}
				{{#spellshoweffects}}
				<div class="sheet-row">
					<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Effect</div>
					<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{spelleffect}}</div>
				</div>
				{{/spellshoweffects}}
				{{#spellshowsavethrow}}
				<div class="sheet-row">
					<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Save success</div>
					<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{spellsavesuccess}}</div>
				</div>
				{{/spellshowsavethrow}}
				{{#spellshowdesc}}
				<div class="sheet-row">
					<div class="sheet-col-1 sheet-padl sheet-padr sheet-rt-key">Spell Description</div>
					<div class="sheet-col-1 sheet-padl sheet-padr sheet-rt-value">{{spelldescription}}</div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1 sheet-padl sheet-padr sheet-rt-value sheet-center">{{ddmrequest}}</div>
				</div>
				{{/spellshowdesc}}
				{{#featureshowdesc}}
				<div class="sheet-row">
					<div class="sheet-col-1 sheet-padl sheet-padr sheet-rt-key">Description</div>
					<div class="sheet-col-1 sheet-padl sheet-padr sheet-rt-value">{{featureshowdesc}}</div>
				</div>
				{{/featureshowdesc}}
				<!--NPC-->
				{{#npccorestats}}
				<div class="sheet-row">
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-key">Stat</div>
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-key">Score</div>
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-key">Mod</div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">STR</div>
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">{{npc_strength}}</div>
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">{{npc_strength_mod}}</div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">DEX</div>
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">{{npc_dexterity}}</div>
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">{{npc_dexterity_mod}}</div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">CON</div>
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">{{npc_constitution}}</div>
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">{{npc_constitution_mod}}</div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">INT</div>
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">{{npc_intelligence}}</div>
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">{{npc_intelligence_mod}}</div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">WILL</div>
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">{{npc_willpower}}</div>
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">{{npc_willpower_mod}}</div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">CHA</div>
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">{{npc_charisma}}</div>
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">{{npc_charisma_mod}}</div>
				</div>
				{{/npccorestats}}
				{{#npctraits}}
				<div class="sheet-row">
					<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Dmg Resistance</div>
					<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{npc_damage_resistance}}</div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Dmg Vuln.</div>
					<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{npc_damage_vulnerability}}</div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Dmg Immunity</div>
					<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{npc_damage_immunity}}</div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Condition Immunity</div>
					<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{npc_condition_immunity}}</div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Other Traits</div>
					<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{npc_traits}}</div>
				</div>
				{{/npctraits}}
				{{#npcaction}}
					{{#npc_showmultiattack}}
					<div class="sheet-row">
						<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Multi Attack</div>
						<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{npc_multiattack}}</div>
					</div>
					{{/npc_showmultiattack}}
				<div class="sheet-row">
					<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Desc.</div>
					<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{npc_action_description}}</div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Effect</div>
					<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{npc_action_effect}}</div>
				</div>
				{{/npcaction}}
				<!--Generic section-->
				{{#freetext}}
					<div class="sheet-row">
						<div class="sheet-col-1 sheet-padl sheet-padr sheet-rt-key-wide">{{freetextname}}</div>
						<div class="sheet-col-1 sheet-padl sheet-padr sheet-rt-value">{{freetext}}</div>
					</div>
				{{/freetext}}
				{{#roll}}
				<div class="sheet-row">
					<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">{{rollname}}</div>
					<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{roll}}</div>
				</div>
				{{/roll}}
				<!--Outputall-->
				{{#outputall}}
					{{#allprops() outputall title subheader subheaderright subheader2 subheaderright2 emote weapon spell ability save feature ddm}}
						<div class="sheet-row">
							<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">{{key}}</div>
							<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{value}}</div>
						</div>
					{{/allprops() outputall title subheader subheaderright subheader2 subheaderright2 emote weapon spell ability save feature ddm}}
				{{/outputall}}
				<!--DEBUG-->
				{{#debug}}
					{{#allprops()}}
						<div class="sheet-row">
							<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">{{key}} (DEBUG)</div>
							<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{value}}</div>
						</div>
					{{/allprops()}}
				{{/debug}}
			</div>
		</div>
</rolltemplate>
<!-- Sheet workers -->
<script type="text/worker">

// Ability modifiers
['strength', 'dexterity', 'constitution', 'intelligence', 'perception', 'willpower', 'charisma', 'luck'].forEach(ability => {
  on(`sheet:opened change:${ability.toLowerCase()}`, () => {
    getAttrs([ability.toLowerCase()], v => {
      const value = parseInt(v[ability.toLowerCase()]) || 10,
        setting = {};
      if (value <= 4) setting[`${ability}_mod`] = -3;
      else if (value <= 6) setting[`${ability}_mod`] = -2;
      else if (value <= 8) setting[`${ability}_mod`] = -1;
      else if (value <= 12) setting[`${ability}_mod`] = 0;
      else if (value <= 14) setting[`${ability}_mod`] = 1;
      else if (value <= 16) setting[`${ability}_mod`] = 2;
      else if (value <= 18) setting[`${ability}_mod`] = 3;
      else setting[`${ability}Mod`] = 4;
      setAttrs(setting);
    });
  });
});

var convertFromOldSheet = function () {
    // Non-repeating attributes to rename
    let conversionData = {
        "size" : "race",
        "vision" : "background",
        "prolanguages" : "languages",
        "alignment" : "vision",
        "strength" : "strength_max",
        "dexterity" : "dexterity_max",
        "constitution" : "constitution_max",
        "intelligence" : "intelligence_max",
        "perception" : "perception_max",
        "willpower" : "willpower_max",
        "charisma" : "charisma_max",
        "luck" : "luck_max",
        "nil" : "armour_class",
        "initiative" : "rerolls"
    };
    // Non-repeating attribute renaming
    getAttrs(Object.keys(conversionData), function (values) {
        let setting = {};
        Object.keys(conversionData).forEach(function (oldAttr) {
            if (values[oldAttr] != null) {
                // set value of new attribute to the old one
                setting[conversionData[oldAttr]] = values[oldAttr];
            }
        });
        console.log("Setting non-repeating attributes.");
        setAttrs(setting);
    });

    //Special Case to bring over the two note fields into one notes field here.
    getAttrs(["notey","noob"], function(values) {
        setAttrs({lootnotes: (values.notey + "\n" + values.noob)});
    });
    
	getSectionIDs('repeating_meleeattacks', function (idArray) {
	    console.log("Setting repeating_meleeattacks attributes.");
		getAttrs(idArray.map(id => `repeating_meleeattacks_${id}_meleeweaponname`), function (values) {
			let setting = {};
			idArray.forEach(function (id) {
				setting[`repeating_meleeattacks_${id}_melee_weaponname`] = values[`repeating_meleeattacks_${id}_meleeweaponname`];
			});
			setAttrs(setting);
		});
		getAttrs(idArray.map(id => `repeating_meleeattacks_${id}_meleemagic`), function (values) {
			let setting = {};
			idArray.forEach(function (id) {
				setting[`class_hitbonus`] = values[`repeating_meleeattacks_${id}_meleemagic`];
			});
			setAttrs(setting);
		});
		getAttrs(idArray.map(id => `repeating_meleeattacks_${id}_meleemisc`), function (values) {
			let setting = {};
			idArray.forEach(function (id) {
				setting[`repeating_meleeattacks_${id}_melee_hitbonus`] = values[`repeating_meleeattacks_${id}_meleemisc`];
				setting[`repeating_meleeattacks_${id}_melee_dmgbonus`] = values[`repeating_meleeattacks_${id}_meleemisc`];
			});
			setAttrs(setting);
		});
		getAttrs(idArray.map(id => `repeating_meleeattacks_${id}_meleedmg`), function (values) {
			let setting = {};
			idArray.forEach(function (id) {
				setting[`repeating_meleeattacks_${id}_melee_dmgbase`] = values[`repeating_meleeattacks_${id}_meleedmg`];
			});
			setAttrs(setting);
		});
		getAttrs(idArray.map(id => `repeating_meleeattacks_${id}_meleeacbonus`), function (values) {
			let setting = {};
			idArray.forEach(function (id) {
				setting[`repeating_meleeattacks_${id}_melee_description`] = values[`repeating_meleeattacks_${id}_meleeacbonus`];
			});
			setAttrs(setting);
		});
	});
	
	getSectionIDs('repeating_rangedattacks', function (idArray) {
	    console.log("Setting repeating_rangedattacks attributes.");
		getAttrs(idArray.map(id => `repeating_rangedattacks_${id}_rangeweaponname`), function (values) {
			let setting = {};
			idArray.forEach(function (id) {
				setting[`repeating_rangedattacks_${id}_range_weaponname`] = values[`repeating_rangedattacks_${id}_rangeweaponname`];
			});
			setAttrs(setting);
		});
		getAttrs(idArray.map(id => `repeating_rangedattacks_${id}_rangemisc`), function (values) {
			let setting = {};
			idArray.forEach(function (id) {
				setting[`repeating_rangedattacks_${id}_range_hitbonus`] = values[`repeating_rangedattacks_${id}_rangemisc`];
				setting[`repeating_rangedattacks_${id}_range_dmgbonus`] = values[`repeating_rangedattacks_${id}_rangemisc`];
			});
			setAttrs(setting);
		});
		getAttrs(idArray.map(id => `repeating_rangedattacks_${id}_rangedmg`), function (values) {
			let setting = {};
			idArray.forEach(function (id) {
				setting[`repeating_rangedattacks_${id}_range_dmgbase`] = values[`repeating_rangedattacks_${id}_rangedmg`];
			});
			setAttrs(setting);
		});
		getAttrs(idArray.map(id => `repeating_rangedattacks_${id}_rangeacbonus`), function (values) {
			let setting = {};
			idArray.forEach(function (id) {
				setting[`repeating_rangedattacks_${id}_range_distance`] = values[`repeating_rangedattacks_${id}_rangeacbonus`];
			});
			setAttrs(setting);
		});
		getAttrs(idArray.map(id => `repeating_rangedattacks_${id}_rangesaves`), function (values) {
			let setting = {};
			idArray.forEach(function (id) {
				setting[`repeating_rangedattacks_${id}_range_description`] = values[`repeating_rangedattacks_${id}_rangesaves`];
			});
			setAttrs(setting);
		});
	});
};
on('sheet:opened', function () {
    let currentVersion = '2.0';
    getAttrs(['version','lootnotes'], function (values) {
        if (!values.version) {
            //Special Case to check if the custom sheet was already in use prior to adding version control logic
            if (values.lootnotes) {
                console.log("Special Case Cancel Upgrade from V1.0");
            }
            else{
                //The old sheet had many variables whose names did not match sheet headings.
                //I do my best to assign them to appropriate variables in the upgraded sheet.
                console.log("Upgrading Sheet from V1.0");
                convertFromOldSheet();
            }
        }
        else{
            switch (values.version) {
                case 2.0:
                    // upgrade v2 to next version
                    // fallthrough, continue
                case 3.0:
                    //etc
            }
        }
        setAttrs({
            version: currentVersion
        });
    });
});
</script>
