<!-- BLACK SWORD HACK - BY THE MERRY MUSHMEN -->
<!-- Character sheet for Roll20 by VJ Rolmasters -->

	<div class="sheet-contenedorvj">
        
        <div class="sheet-BSHpergamino">
              <div class="sheet-columnA">
                      
                      
                      <div class="sheet-columndata">
                      
                               <div class="sheet-width100">
                                        <div class="sheet-BSHtitles">
                                                Name:
                                        </div><!-- end .sheet-BSHtitles -->
                                           <input class="sheet-characterinfo" type="text" name="attr_character_name" title="Character name" value="" style="width:180px; margin: 10px 0px 0px 5px;" />
                               </div><!-- end .sheet-width100 -->


                               <div class="sheet-width100">
                                        <div class="sheet-BSHtitles">
                                                Player:
                                        </div><!-- end .sheet-BSHtitles -->
                                           <input class="sheet-characterinfo" type="text" name="attr_player_name" title="Player name" value="" style="width:180px; margin: 10px 0px 0px 5px;" />
                               </div><!-- end .sheet-width100 -->  


                               <div class="sheet-width100">
                                        <div class="sheet-BSHtitles">
                                                Origin:
                                        </div><!-- end .sheet-BSHtitles -->
                                            <input class="sheet-characterinfo" type="text" name="attr_origin" title="Character Origin" value="" style="width:180px; margin: 10px 0px 0px 5px;" />
                               </div><!-- end .sheet-width100 -->
                      
                      </div><!-- end .sheet-columndata -->
                          
                      
                      
                      
                      <div class="sheet-columnpjbackground">  
                          <div class="sheet-espai-30"></div><!-- end .sheet-espai-30 -->
                          
                                   <div class="sheet-width100">
                                            <div class="sheet-BSHtitles2">
                                                    Background
                                            </div><!-- end .sheet-BSHtitles2 -->
                                             <textarea style="position: relative; float: left; margin: 0px 0px 0px 1%; padding: 0px 5px; width:95%; height:160px; resize: none; box-sizing: border-box; background-color: transparent; border: none; font-size: 13px; font-family: 'Quintessential', serif; color:#000000; line-height: 20px;" name="attr_background"></textarea>    
                                   </div><!-- end .sheet-width100 -->


                               <div class="sheet-espai-20"></div><!-- end .sheet-espai-20 -->

                                   <div class="sheet-width100">
                                            <div class="sheet-BSHtitles2">
                                                    Equipment
                                            </div><!-- end .sheet-BSHtitles2 -->
                                             <textarea style="position: relative; float: left; margin: 0px 0px 0px 1%; padding: 0px 5px; width:95%; height:280px; resize: none; box-sizing: border-box; background-color: transparent; border: none; font-size: 13px; font-family: 'Quintessential', serif; color:#000000; line-height: 20px;" name="attr_equipment"></textarea>    
                                   </div><!-- end .sheet-width100 -->


                              <div class="sheet-espai-30"></div><!-- end .sheet-espai-30 -->

                                   <div class="sheet-width100">
                                            <div class="sheet-BSHtitles2">
                                                    Armor
                                            </div><!-- end .sheet-BSHtitles2 -->
                                             
                                                   
                                           <input class="sheet-item1Armor" type="text" name="attr_armadura" title="" value="Armadura"/>
                                           <select  class="sheet-armaselect-A" name="attr_tipoparada" title="Choose the type of defense of your character." style="  "> 
                                                        <option value="@{fue}">STR : Block the attack</option> 
                                                        <option value="@{des}" selected>DEX : Dodge the attack</option>
                                            </select> 
                                            <button type="roll" style="margin:6px 0px 0px 3px;" class="sheet-VJBTN2" name="roll_armadura" value="@{tirada_secreta} &{template:bsh} {{title= DEFENDER : @{paradatemplate}}} {{subtitle=@{character_name}}} {{caracteristica=[[@{tipoparada}]]}} {{rollResult=[[?{Difficulty?|Normal,1d20|Advantage,2d20kl1|Disadvantage,2d20kh1}cs<1cf>20+?{Modifier|0}]]}}"/>
                                            
                                             <input class="sheet-item2B" type="text" name="attr_paradatemplate" title="Campo oculto para definir template" value="0" readonly hidden/>

                                           <input class="sheet-item2Armor" type="text" name="attr_armadurapa" title="Armor resistance points" value="0"/>
           
                                       
                                   </div><!-- end .sheet-width100 -->
                          
                          
                          <div class="sheet-espai-30"></div><!-- end .sheet-espai-30 -->
                                            
                           <div class="sheet-width100">
                                    <div class="sheet-BSHtitles2">
                                            Weapons
                                    </div><!-- end .sheet-BSHtitles2 -->
                               
                            </div><!-- end .sheet-width100 -->         
                      
                      </div><!-- end .sheet-columnpjbackground -->  
                      
                      
                      
                      
                      <div class="sheet-columnsword">
                                                   
                              <div class="sheet-columnroundsL">
                                  
                                    <div class="sheet-roundbox">
                                            <div class="sheet-atributename">
                                                   STR         
                                            </div><!-- end .sheet-atributename -->     


                                            <div class="sheet-atributevalue">
                                                   <input class="sheet-valorcaracteristicas1" type="number" max="50" min="0" name="attr_fue" title="Character Strength" value="0" style="margin: 0px 0px 0px 0px; " />      
                                            </div><!-- end .sheet-atributevalue -->   
                                            <button type="roll" style="margin:2px 0px 0px 30px;" class="sheet-VJBTN" name="roll_fuerza" value="@{tirada_secreta} &{template:bsh} {{title=Prueba de fuerza}} {{subtitle=@{character_name}}} {{caracteristica=[[@{fue}]]}} {{rollResult=[[?{Difficulty?|Normal,1d20|Advantage,2d20kl1|Disadvantage,2d20kh1}cs<1cf>20+?{Modifier|0}]]}}"/>
                                    </div><!-- end .sheet-roundbox -->            
                                  
                                      
                                    <div class="sheet-roundbox">
                                            <div class="sheet-atributename">
                                                   DEX         
                                            </div><!-- end .sheet-atributename -->     


                                            <div class="sheet-atributevalue">
                                                  <input class="sheet-valorcaracteristicas1" type="number" max="50" min="0" name="attr_des" title="Character Dexterity" value="0" style="margin: 0px 0px 0px 0px;" />      
                                            </div><!-- end .sheet-atributevalue -->   
                                            <button type="roll" style="margin:2px 0px 0px 30px;" class="sheet-VJBTN" name="roll_destreza" value="@{tirada_secreta} &{template:bsh} {{title=Prueba de destreza}} {{subtitle=@{character_name}}} {{caracteristica=[[@{des}]]}} {{rollResult=[[?{Difficulty?|Normal,1d20|Advantage,2d20kl1|Disadvantage,2d20kh1}cs<1cf>20+?{Modifier|0}]]}}"/>
                                    </div><!-- end .sheet-roundbox -->
                                  
                                  
                                    <div class="sheet-roundbox">
                                            <div class="sheet-atributename">
                                                   CON         
                                            </div><!-- end .sheet-atributename -->     


                                            <div class="sheet-atributevalue">
                                                   <input class="sheet-valorcaracteristicas1" type="number" max="50" min="0" name="attr_con" title="Character Constitution" value="0" style="margin: 0px 0px 0px 0px; " />      
                                            </div><!-- end .sheet-atributevalue -->   
                                            <button type="roll" style="margin:2px 0px 0px 30px;" class="sheet-VJBTN" name="roll_constitucion" value="@{tirada_secreta} &{template:bsh} {{title=Prueba de constitución }} {{subtitle=@{character_name}}} {{caracteristica=[[@{con}]]}} {{rollResult=[[?{Difficulty?|Normal,1d20|Advantage,2d20kl1|Disadvantage,2d20kh1}cs<1cf>20+?{Modifier|0}]]}}"/>
                                    </div><!-- end .sheet-roundbox -->  
                                  
                              </div><!-- end .sheet-columnroundsL -->
                          
                          
                              <div class="sheet-columnroundsR">
                                  
                                      <div class="sheet-roundbox">
                                            <div class="sheet-atributename">
                                                   INT         
                                            </div><!-- end .sheet-atributename -->     


                                            <div class="sheet-atributevalue">
                                                   <input class="sheet-valorcaracteristicas1" type="number" max="50" min="0" name="attr_int" title="Character Intelligence" value="0" style="margin: 0px 0px 0px 0px; " />    
                                            </div><!-- end .sheet-atributevalue -->   
                                            <button type="roll" style="margin:2px 0px 0px 30px;" class="sheet-VJBTN" name="roll_inteligencia" value="@{tirada_secreta} &{template:bsh} {{title=Prueba de inteligencia }} {{subtitle=@{character_name}}} {{caracteristica=[[@{int}]]}} {{rollResult=[[?{Difficulty?|Normal,1d20|Advantage,2d20kl1|Disadvantage,2d20kh1}cs<1cf>20+?{Modifier|0}]]}}"/>
                                     </div><!-- end .sheet-roundbox -->
                                  
                                      
                                    <div class="sheet-roundbox">
                                            <div class="sheet-atributename">
                                                   WIS         
                                            </div><!-- end .sheet-atributename -->     


                                            <div class="sheet-atributevalue">
                                                   <input class="sheet-valorcaracteristicas1" type="number" max="50" min="0" name="attr_wis" title="Character Wisdom" value="0" style="margin: 0px 0px 0px 0px; " />     
                                            </div><!-- end .sheet-atributevalue -->   
                                            <button type="roll" style="margin:2px 0px 0px 30px;" class="sheet-VJBTN" name="roll_wisdom" value="@{tirada_secreta} &{template:bsh} {{title=Prueba de Sabiduría}} {{subtitle=@{character_name}}} {{caracteristica=[[@{wis}]]}} {{rollResult=[[?{Difficulty?|Normal,1d20|Advantage,2d20kl1|Disadvantage,2d20kh1}cs<1cf>20+?{Modifier|0}]]}}"/>
                                     </div><!-- end .sheet-roundbox -->  
                                  
                                  
                                    <div class="sheet-roundbox">
                                            <div class="sheet-atributename">
                                                   CHA         
                                            </div><!-- end .sheet-atributename -->     


                                            <div class="sheet-atributevalue">
                                                   <input class="sheet-valorcaracteristicas1" type="number" max="50" min="0" name="attr_car" title="Character Charisma" value="0" style="margin: 0px 0px 0px 0px; " />      
                                            </div><!-- end .sheet-atributevalue -->   
                                            <button type="roll" style="margin:2px 0px 0px 30px;" class="sheet-VJBTN" name="roll_carisma" value="@{tirada_secreta} &{template:bsh} {{title=Prueba de carisma }} {{subtitle=@{character_name}}} {{caracteristica=[[@{car}]]}} {{rollResult=[[?{Difficulty?|Normal,1d20|Advantage,2d20kl1|Disadvantage,2d20kh1}cs<1cf>20+?{Modifier|0}]]}}"/>
                                     </div><!-- end .sheet-roundbox -->  


                              </div><!-- end .sheet-columnroundsR -->

                      </div><!-- end .sheet-columnsword -->
                      
                  
                  
                      <div class="sheet-columnweapons">
                  
                                            <fieldset class="repeating_armas">
                                           <input class="sheet-item2A" type="text" name="attr_arma" title="" value="Weapon"/>
                                           <select  class="sheet-armaselect-A" name="attr_tipoarma" title="Choose the combat type of the character's weapon. " style="  "> 
                                                        <option value="@{fue}">STR : Hand to hand</option> 
                                                        <option value="@{des}" selected>DEX : Distance</option>
                                            </select> 
                                            <button type="roll" style="margin:6px 0px 0px 3px;" class="sheet-VJBTN2" name="roll_arma" value="@{tirada_secreta} &{template:bsh} {{title= @{arma}}} {{subtitle=@{character_name}}} {{caracteristica=[[@{tipoarma}]]}} {{rollResult=[[?{Difficulty?|Normal,1d20|Advantage,2d20kl1|Disadvantage,2d20kh1}cs<1cf>20+?{Modifier|0}]]}}"/>


                                           <input class="sheet-item2B" type="text" name="attr_armadu" title="Weapon DU" value="Du"/>
                                           <input class="sheet-item2B" type="text" name="attr_armacarga" title="Weapon charges" value="0"/>
                                               <details>
                                                   <div class="sheet-item2detalles">
                                                          <textarea name="attr_armadetalles"></textarea>          
                                                   </div><!-- end .sheet-armadetalls --> 
                                               </details>        
                                      </fieldset>  
                                                     
                      </div><!-- end .sheet-columnweapons -->
                  
            </div><!-- end .sheet-columnA -->            
        
            
                     
            <div class="sheet-level">
                       <div class="sheet-levelname">
                              LEVEL         
                       </div><!-- end .sheet-levelname -->    
                        
                         <input class="sheet-valorlevel" type="number" max="50" min="0" name="attr_level" title="Character Level" value="0" style="margin: 0px 0px 0px 25px;" />    
                   
                <div class="sheet-espai-20"></div><!-- end .sheet-espai-20 -->
                
                       <div class="sheet-levelname">
                               ROLL         
                       </div><!-- end .sheet-levelname --> 
                       <button type="roll" style="margin:8px 0px 0px 0px; float: right!important;" name="roll_instinto" value="@{tirada_secreta} &{template:bshdice} {{title= LANZA EL DADO }} {{subtitle= @{character_name} }} {{tiradados= @{lanzardados} }} {{rollResult= [[@{lanzardados}]]}}" class="sheet-VJBTN" ></button>
                          
                       <select name="attr_lanzardados" class="sheet-barralanzadados">                                 
                               <option value="1d4" selected>1D4</option>
                               <option value="1d6">1D6</option>
                               <option value="1d8">1D8</option>
                               <option value="1d10">1D10</option>
                               <option value="1d12">1D12</option>
                               <option value="1d20">1D20</option>
                       </select>
            </div><!-- end .sheet-level -->
        
                    
            
                  <div class="sheet-columnB">
                                                  
                                   <div class="sheet-marcavatar"> </div><!-- end .sheet-marcavatar -->
               
                                   <div class="sheet-width100">    
                                        <div class="sheet-avatarbox">
                                             <img name="attr_character_avatar" alt="">     
                                        </div><!-- end .sheet-avatar-box -->  
                                   </div><!-- end .sheet-width100 -->  
                                      
                      
                            <div class="sheet-espai-30"></div><!-- end .sheet-espai-30 -->
                      
                      
                                   <div class="sheet-width100">
                                            <div class="sheet-tiradasecreta">
                                                    <input type="checkbox"  class="sheet-check-morat" style="margin: 0px 3px 0px 15px; "  value="/w gm" name="attr_tirada_secreta"> Perform your secret rolls, just for the GM.
                                            </div><!-- end .sheet-tiradasecreta -->
                                   </div><!-- end .sheet-width100 -->   
                      
                      
                            <div class="sheet-espai-10"></div><!-- end .sheet-espai-10 -->
                      
                      
                                   <div class="sheet-darksecrets">
                                            <div class="sheet-BSHtitles2">
                                                    Gifts
                                            </div><!-- end .sheet-BSHtitles2 -->
                                             <textarea style="position: relative; float: left; margin: 0px 1% 0px 1%; padding: 0px 5px; width:98%; height:180px; resize: none; box-sizing: border-box; background-color: transparent; border: none; font-size: 13px; font-family: 'Quintessential', serif; color:#000000; line-height: 20px;" name="attr_gifts"></textarea>    
                                   </div><!-- end .sheet-darksecrets -->
                      
                      
                             <div class="sheet-espai-20"></div><!-- end .sheet-espai-20 -->
                      
                      
                                   <div class="sheet-darksecrets">
                                            <div class="sheet-BSHtitles2">
                                                    Stories
                                            </div><!-- end .sheet-BSHtitles2 -->
                                            <div class="sheet-BSHtitles2">
                                                    & Dark Secrets
                                            </div><!-- end .sheet-BSHtitles2 -->
                                             <textarea style="position: relative; float: left; margin: 0px 1% 0px 1%; padding: 0px 5px; width:98%; height:240px; resize: none; box-sizing: border-box; background-color: transparent; border: none; font-size: 13px; font-family: 'Quintessential', serif; color:#000000; line-height: 20px;" name="attr_stories"></textarea>    
                                   </div><!-- end .sheet-darksecrets --> 
                      
                      
                      <div class="sheet-espai-40"></div><!-- end .sheet-espai-40 -->
                      
                                  <div class="sheet-columnvida">
                                      
                                      <div class="sheet-damage">
                                              <div class="sheet-vidaname1">
                                                  CHARACTER        
                                              </div><!-- end .sheet-vidaname1 -->
                                              <div class="sheet-vidaname1">
                                                  DAMAGE         
                                              </div><!-- end .sheet-vidaname1 -->
                                      
                                              <input class="sheet-valorvida" type="text" max="40" min="0" name="attr_dano" title="" value="d4" style="margin: 5px 0px 0px 5px;" /> 
                                      
                                              <input class="sheet-valorvida" type="text" max="40" min="0" name="attr_danodesarmado" title="" value="d2" style="margin: 5px 0px 0px 5px;" /> 
                                              
                                              <div class="sheet-vidaname2">
                                                  Normal/Unarmed         
                                              </div><!-- end .sheet-vidaname2 -->
                                          
                                          <button type="roll" style="margin: 5px 0px 0px 20px !important; float: left !important;" name="roll_instinto" value="@{tirada_secreta} &{template:bshdice} {{title= DAÑO ARMADO }} {{subtitle= @{character_name} }} {{tiradados= @{dano} }} {{rollResult=[[?{Difficulty?|Normal,@{dano}|Advantage,2@{dano}kh1|Disadvantage,2@{dano}kl1}+?{Modifier|0}]]}}" class="sheet-VJBTN" ></button>
                                          
                                          <button type="roll" style="margin:5px 20px 0px 0px !important; float: right !important;" name="roll_instinto" value="@{tirada_secreta} &{template:bshdice} {{title= DAÑO DESARMADO }} {{subtitle= @{character_name} }} {{tiradados= @{danodesarmado} }} {{rollResult=[[?{Difficulty?|Normal,@{danodesarmado}|Advantage,2@{danodesarmado}kh1|Disadvantage,2@{danodesarmado}kl1}+?{Modifier|0}]]}}" class="sheet-VJBTN" ></button>
                                          
                                          
                                      </div><!-- end .sheet-damage -->
                                      
                                      
                                      <div class="sheet-doomdie">
                                              <div class="sheet-vidaname1">
                                                  DOOM          
                                              </div><!-- end .sheet-vidaname1 -->
                                              <div class="sheet-vidaname1">
                                                  DIE          
                                              </div><!-- end .sheet-vidaname1 -->
                                      
                                              <input class="sheet-valorvida" type="number" max="40" min="0" name="attr_doomdie" title="" value="0" style="margin: 5px 0px 0px 15px;" /> 
                                      </div><!-- end .sheet-damage -->
                                      
                                      
                                      
                                      <div class="sheet-damage">
                                      
                                              <div class="sheet-vidaname1">
                                                  HIT          
                                              </div><!-- end .sheet-vidaname1 -->
                                              <div class="sheet-vidaname1">
                                                   POINTS         
                                              </div><!-- end .sheet-vidaname1 -->
                                      
                                              <input class="sheet-valorvida" type="number" max="40" min="0" name="attr_currenthitpoints" title="" value="0" style="margin: 5px 0px 0px 5px;" /> 
                                      
                                              <input class="sheet-valorvida" type="number" max="40" min="0" name="attr_maxhitpoints" title="" value="0" style="margin: 5px 5px 0px 5px;" /> 
                                              
                                              <div class="sheet-vidaname2">
                                                  Actual/Total         
                                              </div><!-- end .sheet-vidaname2 -->
                                      </div><!-- end .sheet-damage -->
                                                
                                  </div><!-- end .sheet-columnvida -->    
                      
                  </div><!-- end .sheet-columnB --> 
        
        </div><!-- end .sheet-BSHpergamino -->
                
                
            <div class="sheet-firma-foot">
                    BLACK SWORD HACK - Roll20 Character Sheet by VJ Rolmasters
            </div><!-- end .sheet-firma-foot -->
              
                
            <div class="sheet-logoeditorial"></div><!-- end .sheet-logoeditorial -->    
            
              
       <div class="sheet-espai-10"></div><!-- end .sheet-espai-10 -->      
                     
        <div class="clearfloat"></div>
   
        
</div><!-- end .sheet-contenedorvj -->

    
         <!--  BLACK SWORD HACK ROLLTEMPLATE -->   
                   <rolltemplate class="sheet-rolltemplate-bsh">
                      <div class="sheet-fotofondo">

                        <div class="sheet-header">
                          {{#title}}<div class="sheet-title">{{title}}</div>{{/title}}
                          {{#subtitle}}<div class="sheet-subtitle">{{subtitle}}</div>{{/subtitle}}
                        </div><!-- end .sheet-header -->

                            <div class="sheet-contento">
                              {{#caracteristica}}
                                <div class="sheet-filatemplate1">
                                  Attribute: {{caracteristica}}
                                </div>
                              {{/caracteristica}}

                              {{#rollResult}}
                                <div class="sheet-filatemplate1">
                                  Result: {{rollResult}}
                                </div>
                              {{/rollResult}}

                                  <div class="sheet-filatemplate2">
                                    {{#rollLess() rollResult caracteristica}}
                                      <span style="color: green; font-weight: bold;">SUCCESS!</span>
                                    {{/rollLess() rollResult caracteristica}}

                                    {{#rollGreater() rollResult caracteristica}}
                                      <span style="color: red; font-weight: bold;">FAIL!</span>
                                    {{/rollGreater() rollResult caracteristica}}

                                    {{#rollTotal() rollResult caracteristica}}
                                      <span style="color: orange; font-weight: bold;">FALLO! IT WAS CLOSE!</span>
                                    {{/rollTotal() rollResult caracteristica}}
                                  </div><!-- end .sheet-filatemplate2 -->

                        </div><!-- end .sheet-contento -->
                      </div><!-- end .sheet-fotofondo -->
                </rolltemplate>  
                                

<!--  BLACK SWORD HACK DICE ROLLTEMPLATE -->   
                <rolltemplate class="sheet-rolltemplate-bshdice">
                          <div class="sheet-fotofondo">  
                                        <div class="sheet-header">
                                              {{#title}}<div class="sheet-title">{{title}}</div>{{/title}}
                                              {{#subtitle}}<div class="sheet-subtitle">{{subtitle}}</div>{{/subtitle}}
                                        </div><!-- end .sheet-header -->
                                     
                                        <div class="sheet-contento">
                                                 {{#tiradados}}<div class="sheet-filatemplate1">Roll {{tiradados}}</div>{{/tiradados}}
                                                 {{#rollResult}}<div class="sheet-filatemplate2">Result: {{rollResult}}</div>{{/rollResult}}
                                        </div><!--  end .sheet-contento --> 
                                     
                          </div><!--  end .sheet-fotofondo -->     
                </rolltemplate> 


<script type="text/worker">

/* ===== ACTUALIZAR PARADA TEMPLATE SEGÚN EL TIPO DE PARADA ===== */
on("change:tipoparada", function() {
    getAttrs(["tipoparada"], function(values) {
        const tipo = values["tipoparada"];
        let nuevoValor = "";

        // Según el valor del selector, asigna el texto correspondiente
        switch (tipo) {
            case "@{fue}": // Opción FUE → Parada
                nuevoValor = "Parada";
                break;
            case "@{des}": // Opción DES → Esquivar
                nuevoValor = "Esquivar";
                break;
            default:
                nuevoValor = "";
        }

        setAttrs({ "paradatemplate": nuevoValor });
        console.log(`Tipo de parada: ${tipo} → paradatemplate = ${nuevoValor}`);
    });
});
     
 </script>	