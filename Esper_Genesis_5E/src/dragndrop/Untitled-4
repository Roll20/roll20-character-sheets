{
  "prof_names": [
    null
  ],
  "traits": [],
  "tool": {},
  "resource": {},
  "spell-cantrip": {
    "-MFfW8AR6oZEKGFWXSuh": {
      "spellname": "Acid Splash"
    },
    "-MFfW8LVt8dilLJZ27Zb": {
      "spellname": "Mage Hand"
    },
    "-MFfW9FdgrymZZJVsetq": {
      "spellname": "Abhorrence"
    },
    "-MFfWRCC1bJiqXRx3kmS": {
      "spellname": "Mage Hand"
    }
  },
  "savemod": {},
  "tohitmod": {},
  "damagemod": {
    "-MFfW5rVTPmIk4jJONn5": "Sneak Attack"
  },
  "acmod": {},
  "skillmod": {},
  "attack": {},
  "hpmod": {},
  "spell-1": {
    "-MFfW8Xd4HHlIOSga0if": {
      "spellname": "Alarm"
    },
    "-MFfW8hxFTdGqPb5BjPN": {
      "spellname": "Adjust Positioning"
    },
    "-MFfW917zuvp9uIegmdb": {
      "spellname": "Ambush"
    }
  },
  "spell-2": {},
  "spell-3": {},
  "spell-4": {},
  "spell-5": {},
  "spell-6": {},
  "spell-7": {},
  "spell-8": {},
  "spell-9": {}
}


{
  "drop_category": "",
  "drop_name": "",
  "drop_data": "",
  "drop_content": "",
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_details-flag": 0,
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_options-flag": 0,
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_rollcontent": "",
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_spell_ability": "spell",
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_innate": "",
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_spell_damage_progression": "",
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_spellathigherlevels": "",
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_spellattack": "",
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_spellcastingtime": "1 action",
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_spellclass": "",
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_spellcomp_m": 0,
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_spellcomp_materials": "",
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_spellcomp_s": "{{s=1}}",
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_spellcomp_v": "{{v=1}}",
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_spellconcentration": "",
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_spelldamage2": "",
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_spelldamage": "",
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_spelldamagetype2": "",
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_spelldamagetype": "",
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_spelldescription": "A spectral, floating hand appears at a point you choose within range. The hand lasts for the duration or until you dismiss it as an action. The hand vanishes if it is ever more than 30 feet away from you or if you cast this spell again. You can use your action to control the hand. You can use the hand to manipulate an object, open an unlocked door or container, stow or retrieve an item from an open container, or pour the contents out of a vial. You can move the hand up to 30 feet each time you use it. The hand canâ€™t attack, activate magic items, or carry more than 10 pounds.",
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_spelldmgmod": "",
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_spellduration": "1 minute",
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_spellhealing": "",
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_spellhlbonus": "",
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_spellhldie": "",
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_spellhldietype": "",
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_spelllevel": "cantrip",
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_spellname": "Mage Hand",
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_spelloutput": "SPELLCARD",
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_spellrange": "30 feet",
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_spellritual": "",
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_spellsave": "",
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_spellsavesuccess": "",
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_spellschool": "Conjuration",
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_spellsource": "",
  "repeating_spell-cantrip_-MFfW8LVt8dilLJZ27Zb_spelltarget": "A point you choose within range"
}



const spellRepeating = ["cantrip", "1", "2", "3", "4", "5", "6", "7", "8", "9"];
const spellsFromUpdate = Object.keys(spellUpdate).filter(entry => { return entry.indexOf('_spellname') > -1; });
spellsFromUpdate.forEach(spell => {
    const spellName = spellUpdate[spell];
    const spellLevel = spellUpdate[spell.replace('_spellname', '_spelllevel')];
    let found = false;
    if(repeating[`spell-${spellLevel}`]) {
        Object.keys(repeating[`spell-${spellLevel}`]).forEach(entry => {
            if(repeating[`spell-${spellLevel}`][entry]['spellname'] === spellName) {
                found = true;
                return;
            }
        });
    }
    if(found) {
        const uid = SheetUtils.getUID(spell);
        const toRemove = Object.keys(spellUpdate).filter(entry => { return entry.indexOf(uid) > -1; });
        toRemove.forEach(entry => {
            delete spellUpdate[entry];
        });
    }
});

const processedSpell = processDrop(mockPage, currentData, repeating);

on processSpells()
const assignedRowID = (newObject.reprowid) ? newObject.reprowid : generateRowID();
repeating[`${section}`][assignedRowID] = { spellname: page.name };



var inSpellBook = function(name) {
    let found = false;
    const spellRepeating = ["cantrip", "1", "2", "3", "4", "5", "6", "7", "8", "9"];
    spellRepeating.forEach(spellLevel => {
    if(found) return;
    if(repeating[`spell-${spellLevel}`]) {
        Object.keys(repeating[`spell-${spellLevel}`]).forEach(entry => {
            if(repeating[`spell-${spellLevel}`][entry]['spellname'] === name) {
                found = true;
                return;
            }
        });
    }
    });
    return found;
};