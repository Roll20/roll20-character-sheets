<!-- Version N# -->
<input type="hidden" name="attr_version" value="0">
<!-- AutoCalc fields for sheet worker-->
<input type="hidden" name="attr_Poids_Materiels" value="0" /> <!-- temp charge du materiel -->
<input type="hidden" name="attr_Poids_Butins" value="0" /> <!-- temp charge du butin -->
<input type="hidden" name="attr_Poids_Livres" value="0" /> <!-- temp charge des livres -->
<input type="hidden" name="attr_Poids_Bouffes" value="0" /> <!-- temp charge de la bouffe -->

<!--- night mode --->
<input type="checkbox" class="sheet-hidden sheet-nightMode" name="attr_nightMode" value="1" />
<div class="sheet-wrapper">
	<!--- Header --->
	<div class="sheet-header sheet-row">
		<div class="sheet-col-2">
			<img src="https://i49.servimg.com/u/f49/19/87/23/15/logo10.png" alt="Le Donjon de Naheulbeuk" />
		</div>
		<div class="sheet-col-9">
			<div class="sheet-row">
				<div class="sheet-col-1">Nom&nbsp;:</div>
				<div class="sheet-col-3">
					<input type="text" name="attr_Personnage_Nom" class="sheet-noBorder">
				</div>
				<div class="sheet-col-2">Origine&nbsp;:</div>
				<div class="sheet-col-2">
					<input type="text" name="attr_Personnage_Origine" class="sheet-noBorder">
				</div>
				<div class="sheet-col-2">Métier(s)&nbsp;:</div>
				<div class="sheet-col-2">
					<input type="text" name="attr_Personnage_Metiers" class="sheet-noBorder">
				</div>
			</div>
			<div class="sheet-row">
				<div class="sheet-col-1">Sexe&nbsp;: </div>
				<div class="sheet-col-2">
					<input type="text" class="sheet-noBorder" name="attr_Personnage_Sex" >
				</div>
				<div class="sheet-col-1">Âge&nbsp;: </div>
				<div class="sheet-col-2">
					<input type="text" class="sheet-noBorder" name="attr_Personnage_Age">
				</div>
				<div class="sheet-col-1">Taille&nbsp;: </div>
				<div class="sheet-col-2">
					<input type="text" class="sheet-noBorder" name="attr_Personnage_Taille">
				</div>
				<div class="sheet-col-1">Poids&nbsp;: </div>
				<div class="sheet-col-2">
					<input type="text" class="sheet-noBorder" name="attr_Personnage_Poids">
				</div>
			</div>
		</div>
		<div class="sheet-col-1">
			<input type="checkbox" class="sheet-display-pnj" name="attr_tab_pnj" value="1" title="Personnage Non Joueur" /><span class="sheet-display-pnj"></span>
			<input type="checkbox" class="sheet-display-reglages" name="attr_tab_reglages" value="1" title="Réglages" /><span class="sheet-cog sheet-display-reglages">y</span><br />
			<input type="checkbox" class="sheet-modal sheet-compendium" name="attr_modal_compendium" value="1" title="Compendium"><span class="sheet-cog sheet-compendium">x</span>
			<div class="sheet-modal-wrapper">
				<div class="sheet-modal">
					<div class="sheet-modal_header">
						<h2>Compendium <span class="sheet-close">*</span><input type="checkbox" class="sheet-modal" name="attr_modal_compendium" value="1"></h2>
					</div>
					<div class="sheet-modal_body">
						<p>Peut recevoir un objet, un coup spécial, une compétence, un sort (...) du <a href="https://bit.ly/ddn20" target="_blank">compendium</a></p>
						<textarea name="attr_compendium"></textarea>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!--- Repeat and hide checkbox from header to do css trick --->
	<input type="checkbox" class="sheet-display-pnj sheet-hidden" name="attr_tab_pnj" value="1" />
	<input type="checkbox" class="sheet-display-reglages sheet-hidden" name="attr_tab_reglages" value="1" />

	<br clear="all" />

	<!--- SHEET PJ --->
	<div class="sheet-body sheet-pj">
		<!--- checkbox disguised in Navigation tabs --->
		<input type="radio" name="attr_tab_nav" class="sheet-tab sheet-tab_caracteristiques" value="caracteristiques" title="Caractéristiques" checked="checked" /><span class="sheet-tab">Caractéristiques</span>
		<input type="radio" name="attr_tab_nav" class="sheet-tab sheet-tab_competences" value="competences" title="Compétences" /><span class="sheet-tab">Compétences</span>
		<input type="radio" name="attr_tab_nav" class="sheet-tab sheet-tab_equipement" value="equipement" title="Equipement" /><span class="sheet-tab">Equipement</span>
		<input type="radio" name="attr_tab_nav" class="sheet-tab sheet-tab_magie" value="magie" title="Compétences" /><span class="sheet-tab">Magie</span>
		<input type="radio" name="attr_tab_nav" class="sheet-tab sheet-tab_inventaire" value="inventaire" title="Inventaire" /><span class="sheet-tab">Inventaire</span>
		<input type="radio" name="attr_tab_nav" class="sheet-tab sheet-tab_craft" value="craft" title="Fabrication" /><span class="sheet-tab">Artisanat</span>
		<input type="radio" name="attr_tab_nav" class="sheet-tab sheet-tab_compagnons" value="compagnons" title="Compagnons" /><span class="sheet-tab">Compagnons</span>
		<br />
		<br />

		<!-- TAB Caractéristiques -->
		<div class="sheet-tab_caracteristiques">
			<div class="sheet-row">
				<div class="sheet-col-6 sheet-stats">
					<h2>Caractéristiques</h2>
					<table>
						<thead>
							<tr>
								<th width="130"></th>
								<th width="70">Tot.</th>
								<th width="70">Base</th>
								<th width="70">Mod.</th>
								<th width="70">Temp.</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<th title="La bravoure du personnage face au danger et à la mort, ainsi que sa rapidité à se décider"><button type="roll" name="roll_Courage" value="@{displayJet} &{template:default} {{name=@{Personnage_Nom} tente une épreuve de Courage }} {{ Courage=@{Stats_Courage_total} }} {{ Résultat=[[1d20cs<1cf>20]] }}"> Courage</button></th>
								<td><input type="text" class="sheet-autoCalc" name="attr_Stats_Courage_total" value="0" readonly></td>
								<td><input type="number" name="attr_Stats_Courage" value="0"></td>
								<td><input type="number" name="attr_Stats_Courage_mod" value="0"></td>
								<td class="sheet-spin">
									<input type="number" name="attr_Stats_Courage_temp" value="0">
									<input type="hidden" name="attr_Stats_Courage_buff" value="0">
									<input type="text" class="sheet-autoCalc" name="attr_Stats_Courage_temp_total" value="0" readonly>
								</td>
							</tr>
							<tr>
								<th title="La capacité à réfléchir et l'érudition"><button type="roll" name="roll_Intelligence" value="@{displayJet} &{template:default} {{name=@{Personnage_Nom} tente une épreuve d'Intelligence }} {{ Intelligence=@{Stats_Intelligence_total} }} {{ Résultat=[[1d20cs<1cf>20]] }}"> Intelligence</button></th>
								<td><input type="text" class="sheet-autoCalc" name="attr_Stats_Intelligence_total" value="0" readonly></td>
								<td><input type="number" name="attr_Stats_Intelligence" value="0"></td>
								<td><input type="number" name="attr_Stats_Intelligence_mod" value="0"></td>
								<td class="sheet-spin">
									<input type="number" name="attr_Stats_Intelligence_temp" value="0">
									<input type="hidden" name="attr_Stats_Intelligence_buff" value="0">
									<input type="text" class="sheet-autoCalc" name="attr_Stats_Intelligence_temp_total" value="0" readonly>
								</td>
							</tr>
							<tr>
								<th title="La beauté physique et la capacité à convaincre les autres"><button type="roll" name="roll_Charisme" value="@{displayJet} &{template:default} {{name=@{Personnage_Nom} tente une épreuve de Charisme}} {{ Charisme=@{Stats_Charisme_total} }} {{ Résultat=[[1d20cs<1cf>20]] }}"> Charisme</button></th>
								<td><input type="text" class="sheet-autoCalc" name="attr_Stats_Charisme_total" value="0" readonly></td>
								<td><input type="number" name="attr_Stats_Charisme" value="0"></td>
								<td><input type="number" name="attr_Stats_Charisme_mod" value="0"></td>
								<td class="sheet-spin">
									<input type="number" name="attr_Stats_Charisme_temp" value="0">
									<input type="hidden" name="attr_Stats_Charisme_buff" value="0">
									<input type="text" class="sheet-autoCalc" name="attr_Stats_Charisme_temp_total" value="0" readonly>
								</td>
							</tr>
							<tr>
								<th title="L'agilité, la souplesse et la précision"><button type="roll" name="roll_Adresse" value="@{displayJet} &{template:default} {{name=@{Personnage_Nom} tente une épreuve d'Adresse}} {{ Adresse=@{Stats_Adresse_total} }} {{ Résultat=[[1d20cs<1cf>20]] }}"> Adresse</button></th>
								<td><input type="text" class="sheet-autoCalc" name="attr_Stats_Adresse_total" value="0" readonly></td>
								<td><input type="number" name="attr_Stats_Adresse" value="0"></td>
								<td><input type="number" name="attr_Stats_Adresse_mod" value="0"></td>
								<td class="sheet-spin">
									<input type="number" name="attr_Stats_Adresse_temp" value="0">
									<input type="hidden" name="attr_Stats_Adresse_buff" value="0">
									<input type="text" class="sheet-autoCalc" name="attr_Stats_Adresse_temp_total" value="0" readonly>
								</td>
							</tr>
							<tr>
								<th title="La capacité musculaire du personnage, qui influe sur la résistance"><button type="roll" name="roll_Force" value="@{displayJet} &{template:default} {{name=@{Personnage_Nom} tente une épreuve de Force}} {{ Force=@{Stats_Force_total} }} {{ Résultat=[[1d20cs<1cf>20]] }}"> Force</button></th>
								<td><input type="text" class="sheet-autoCalc" name="attr_Stats_Force_total" value="0" readonly></td>
								<td><input type="number" name="attr_Stats_Force" value="0"></td>
								<td><input type="number" name="attr_Stats_Force_mod" value="0"></td>
								<td class="sheet-spin">
									<input type="number" name="attr_Stats_Force_temp" value="0">
									<input type="hidden" name="attr_Stats_Force_buff" value="0">
									<input type="text" class="sheet-autoCalc" name="attr_Stats_Force_temp_total" value="0" readonly>
								</td>
							</tr>
							<tr>
								<td colspan="4">&nbsp;</td>
							</tr>
							<tr>
								<th title="Chance de toucher son adversaire"><button type="roll" name="roll_Attaque" value="@{displayJet} &{template:default} {{name=@{Personnage_Nom} tente une Attaque }} {{ Attaque=@{Stats_Attaque_total} }} {{ Résultat=[[1d20cs<1cf>20]] }}"> Attaque</button></th>
								<td><input type="text" class="sheet-autoCalc" name="attr_Stats_Attaque_total" value="0" readonly></td>
								<td><input type="number" name="attr_Stats_Attaque" value="8"></td>
								<td><input type="number" name="attr_Stats_Attaque_mod" value="0"></td>
								<td class="sheet-spin">
									<input type="number" name="attr_Stats_Attaque_temp" value="0">
									<input type="hidden" name="attr_Stats_Attaque_buff" value="0">
									<input type="text" class="sheet-autoCalc" name="attr_Stats_Attaque_temp_total" value="0" readonly>
								</td>
							</tr>
							<tr>
								<th title="Chance de Parer son adversaire"><button type="roll" name="roll_Parade" value="@{displayJet} &{template:default} {{name=@{Personnage_Nom} tente une Parade }} {{ Parade=@{Stats_Parade_total} }} {{ Résultat=[[1d20cs<1cf>20]] }}"> Parade</button></th>
								<td><input type="text" class="sheet-autoCalc" name="attr_Stats_Parade_total" value="0" readonly></td>
								<td><input type="number" name="attr_Stats_Parade" value="10"></td>
								<td><input type="number" name="attr_Stats_Parade_mod" value="0"></td>
								<td class="sheet-spin">
									<input type="number" name="attr_Stats_Parade_temp" value="0">
									<input type="hidden" name="attr_Stats_Parade_buff" value="0">
									<input type="text" class="sheet-autoCalc" name="attr_Stats_Parade_temp_total" value="0" readonly>
								</td>
							</tr>
							<tr>
								<th title="Chance de toucher avec les armes à distance"><button type="roll" name="roll_Jet" value="@{displayJet} &{template:default} {{name=@{Personnage_Nom} tente une Attaque à distance }} {{ Jet=@{Stats_Jet_total} }} {{ Résultat=[[1d20cs<1cf>20]] }}"> Jet</button></th>
								<td><input type="text" class="sheet-autoCalc" name="attr_Stats_Jet_total" value="0" readonly></td>
								<td title="Calculée en fonction de l'Adresse"><input type="text" class="sheet-autoCalc" name="attr_Stats_Jet" value="0" readonly></td>
								<td><input type="number" name="attr_Stats_Jet_mod" value="0"></td>
								<td class="sheet-spin">
									<input type="number" name="attr_Stats_Jet_temp" value="0">
									<input type="hidden" name="attr_Stats_Jet_buff" value="0">
									<input type="text" class="sheet-autoCalc" name="attr_Stats_Jet_temp_total" value="0" readonly>
								</td>
							</tr>
							<tr>
								<th title="Le héros qui Esquive va se déplacer rapidement d'environ 2 mètres"><button type="roll" name="roll_Esquive" value="@{displayJet} &{template:default} {{name=@{Personnage_Nom} tente une Esquive }} {{ Esquive=@{Stats_Esquive_total} }} {{ Résultat=[[1d20cs<1cf>20]] }}"> Esquive</button></th>
								<td><input type="text" class="sheet-autoCalc" name="attr_Stats_Esquive_total" value="0" readonly></td>
								<td title="Calculée en fonction de l'Adresse, la PR phy et l'encombrement"><input type="text" class="sheet-autoCalc" name="attr_Stats_Esquive" value="0" readonly></td>
								<td><input type="number" name="attr_Stats_Esquive_mod" value="0"></td>
								<td class="sheet-spin">
									<input type="number" name="attr_Stats_Esquive_temp" value="0">
									<input type="hidden" name="attr_Stats_Esquive_buff" value="0">
									<input type="text" class="sheet-autoCalc" name="attr_Stats_Esquive_temp_total" value="0" readonly>
								</td>
							</tr>
							<tr>
								<th title="Change de trouver des objets / indices"><button type="roll" name="roll_Fouille" value="@{displayJet} &{template:default} {{name=@{Personnage_Nom} commence à Fouiller }} {{ Fouille=@{Stats_Fouille_total} }} {{ Résultat=[[1d20cs<1cf>20]] }}"> Fouille</button></th>
								<td><input type="text" class="sheet-autoCalc" name="attr_Stats_Fouille_total" value="0" readonly></td>
								<td title="Calculée en fonction de l'Intelligence"><input type="text" class="sheet-autoCalc" name="attr_Stats_Fouille" value="0" readonly></td>
								<td><input type="number" name="attr_Stats_Fouille_mod" value="0"></td>
								<td class="sheet-spin">
									<input type="number" name="attr_Stats_Fouille_temp" value="0">
									<input type="hidden" name="attr_Stats_Fouille_buff" value="0">
									<input type="text" class="sheet-autoCalc" name="attr_Stats_Fouille_temp_total" value="0" readonly>
								</td>
							</tr>
							<tr>
								<td colspan="4">&nbsp;</td>
							</tr>
							<tr>
								<th title="Chance de réussir une Confection"><button type="roll" name="roll_Ingeniosite" value="@{displayJet} &{template:default} {{name=@{Personnage_Nom} tente une confection}} {{ Ingéniosité=@{Stats_Inge_total} }} {{ Résultat=[[1d20cs<1cf>20]] }}"> Ingéniosité</button></th>
								<td><input type="text" class="sheet-autoCalc" name="attr_Stats_Inge_total" value="0" readonly></td>
								<td><input type="text" class="sheet-autoCalc" name="attr_Stats_Inge" value="0" readonly></td>
								<td><input type="number" name="attr_Stats_Inge_mod" value="0"></td>
								<td class="sheet-spin">
									<input type="number" name="attr_Stats_Inge_temp" value="0">
									<input type="hidden" name="attr_Stats_Inge_buff" value="0">
									<input type="text" class="sheet-autoCalc" name="attr_Stats_Inge_temp_total" value="0" readonly>
								</td>
							</tr>
							<tr>
								<th title="Chance de réussir une Magie Physique"><button type="roll" name="roll_MagiePhys" value="@{displayJet} &{template:default} {{name=@{Personnage_Nom} concentre sa Magie}} {{ Magie&nbsp;Phys=@{Stats_MagiePhy_total} }} {{ Résultat=[[1d20cs<1cf>20]] }}"> Magie Phys.</button></th>
								<td><input type="text" class="sheet-autoCalc" name="attr_Stats_MagiePhy_total" value="0" readonly></td>
								<td><input type="text" class="sheet-autoCalc" name="attr_Stats_MagiePhy" value="0" readonly></td>
								<td><input type="number" name="attr_Stats_MagiePhy_mod" value="0"></td>
								<td class="sheet-spin">
									<input type="number" name="attr_Stats_MagiePhy_temp" value="0">
									<input type="hidden" name="attr_Stats_MagiePhy_buff" value="0">
									<input type="text" class="sheet-autoCalc" name="attr_Stats_MagiePhy_temp_total" value="0" readonly>
								</td>
							</tr>
							<tr>
								<th title="Chance de réussir une Magie Psychique"><button type="roll" name="roll_MagiePsy" value="@{displayJet} &{template:default} {{name=@{Personnage_Nom} concentre sa Magie }} {{ Magie&nbsp;Psy=@{Stats_MagiePsy_total} }} {{ Résultat=[[1d20cs<1cf>20]] }}"> Magie Psy.</button></th>
								<td><input type="text" class="sheet-autoCalc" name="attr_Stats_MagiePsy_total" value="0" readonly></td>
								<td title="Calculée en fonction de l'Int"><input type="text" class="sheet-autoCalc" name="attr_Stats_MagiePsy" value="0" readonly></td>
								<td><input type="number" name="attr_Stats_MagiePsy_mod" value="0"></td>
								<td class="sheet-spin">
									<input type="number" name="attr_Stats_MagiePsy_temp" value="0">
									<input type="hidden" name="attr_Stats_MagiePsy_buff" value="0">
									<input type="text" class="sheet-autoCalc" name="attr_Stats_MagiePsy_temp_total" value="0" readonly>
								</td>
							</tr>
							<tr>
								<th title="Chance de résister à la Magie"><button type="roll" name="roll_ResistMagie" value="@{displayJet} &{template:default} {{name=@{Personnage_Nom} tente de résiter à la Magie}} {{ Résist.&nbsp;Magie=@{Stats_ResiMagie_total} }} {{ Résultat=[[1d20cs<1cf>20]] }}"> Résist. Magie</button></th>
								<td><input type="text" class="sheet-autoCalc" name="attr_Stats_ResiMagie_total" value="0" readonly></td>
								<td><input type="text" class="sheet-autoCalc" name="attr_Stats_ResiMagie" value="0" readonly></td>
								<td><input type="number" name="attr_Stats_ResiMagie_mod" value="0"></td>
								<td class="sheet-spin">
									<input type="number" name="attr_Stats_ResiMagie_temp" value="0">
									<input type="hidden" name="attr_Stats_ResiMagie_buff" value="0">
									<input type="text" class="sheet-autoCalc" name="attr_Stats_ResiMagie_temp_total" value="0" readonly>
								</td>
							</tr>
						</tbody>
					</table>
				</div>
				<div class="sheet-col-2">
					<div class="sheet-energie">
						<h2 class="sheet-ev-bar">Energie Vitale :</h2>
						<div class="sheet-row">
							<div class="sheet-col-6">
								<input type="number" name="attr_EV" value="0" step="1">
							</div>
							<div class="sheet-col-6">
								<input type="number" name="attr_EV_max" value="0" min="1" step="1">
							</div>
						</div>
						<br />
						<h2 class="sheet-ea-bar">Energie Astrale :</h2>
						<div class="sheet-row">
							<div class="sheet-col-6">
								<input type="number" name="attr_EA" value="0" step="1">
							</div>
							<div class="sheet-col-6">
								<input type="number" name="attr_EA_max" value="0" min="0" step="1">
							</div>
						</div>
					</div>
					<br />
					<div class="sheet-xp">
						<div class="sheet-hex">
							<div class="sheet-inner">
								<h4>Niveau</h4>
								<input type="number" class="sheet-square" name="attr_Personnage_Niveau" min="1" step="1" value="1" />
							</div>
							<div class="sheet-corner-1"></div>
							<div class="sheet-corner-2"></div>
						</div>
						<br />
						<h2>Expérience (xp)</h2>
						<div class="sheet-row">
							<div class="sheet-col-6"><input type="number" name="attr_Personnage_XP" value="0"></div>
							<div class="sheet-col-6"><input type="text" class="sheet-autoCalc" name="attr_Personnage_XP_max" value="100"></div>
						</div>
						<br />
						<h2>Points de destin</h2>
						<div class="sheet-row">
							<div class="sheet-col-3"></div>
							<div class="sheet-col-6"><input type="number" name="attr_Personnage_PointDestin" value="0"></div>
							<div class="sheet-col-3"></div>
						</div>
					</div>
				</div>
				<div class="sheet-col-4">
					<div class="sheet-sens">
						<h2>Sens</h2>
						<div class="sheet-row">
							<div class="sheet-col-4 sheet-bold">Langue(s)</div>
							<div class="sheet-col-8"><input type="text" class="sheet-noBorder" name="attr_Personnage_Langue" value="" placeholder="Commun" /></div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-4 sheet-bold">Vision</div>
							<div class="sheet-col-8"><input type="text" class="sheet-noBorder" name="attr_Personnage_Vision" value="" placeholder="Standard" /></div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-4 sheet-bold">Nyctalopie</div>
							<div class="sheet-col-8"><input type="text" class="sheet-noBorder" name="attr_Personnage_Nyctalopie" value="" placeholder="non" /></div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-4 sheet-bold">Ouïe</div>
							<div class="sheet-col-8"><input type="text" class="sheet-noBorder" name="attr_Personnage_Ouie" value="" placeholder="Standard" /></div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-4 sheet-bold">Odorat</div>
							<div class="sheet-col-8"><input type="text" class="sheet-noBorder" name="attr_Personnage_Odorat" value="" placeholder="Standard" /></div>
						</div>
					</div>
					<br />
					<div class="sheet-sens">
						<h2>Déplacement</h2>
						<div class="sheet-row">
							<div class="sheet-col-4 sheet-bold">Mod.</div>
							<div class="sheet-col-4" title="Modificateur de déplacement">
								<input type="number" name="attr_Deplacement_mod" value="100" />
							</div>
							<div class="sheet-col-4">
							 	%
								<input type="checkbox" name="attr_modal_HowToDeplacement" class="sheet-modal" value="1" style="float: right;"><span class="sheet-cog" style="float: right;">?</span>
								<div class="sheet-modal-wrapper">
									<div class="sheet-modal">
										<div class="sheet-modal_header">
											<h2>Modificateur de déplacement <span class="sheet-close">*</span><input type="checkbox" class="sheet-modal" name="attr_modal_HowToDeplacement" value="1"></h2>
										</div>
										<div class="sheet-modal_body">
											<b>Pour plus de précision et de justesse :</b><br>
											<ul>
												<li>Base pour les Humanoïdes, <b>100%</b></li>
												<li>Pour les Nains et les Gobelins, <b>80%</b></li>
												<li>Pour les Semi-Hommes et Gnômes, <b>50%</b></li>
												<li>Pour un Elfe Sylvain ou Elfe Noir, <b>120%</b></li>
												<li>Pour les Barbares, multipliez par 2 la durée de la vitesse de course, par 5 pour le déplacement rapide</li>
											</ul>
											<br>
											<b>Conséquences blessures graves :</b><br>
											<ul>
												<li>Genou luxé, <b>-50%</b></li>
												<li>Pied écrasé, <b>-50%</b></li>
												<li>1 Jambe cassée / tranchée, <b>-75%</b></li>
												<li>2 Jambes cassées / tranchées, <b>-100%</b></li>
												<li>Organes génitaux endommagés, <b>-50%</b></li>
												<li>Projectile dans une jambe, <b>-50%</b></li>
											</ul>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-4 sheet-bold">Mod. Temp.</div>
							<div class="sheet-col-4" title="Modificateur de déplacement">
								<input class="sheet-autoCalc" type="text" name="attr_stats_mvt_buff" value="0" readonly="readonly" />
							</div>
							<div class="sheet-col-4">%</div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-4 sheet-bold">Rapide</div>
							<div class="sheet-col-4" title="Calculée en fonction de la PR Phy.">
								<input type="text" class="sheet-autoCalc" name="attr_DeplacementRapide" value="8" readonly />
							</div>
							<div class="sheet-col-4"> m / assault</div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-4 sheet-bold">Durée</div>
							<div class="sheet-col-4" title="Calculée en fonction de la Force">
								<input type="text" class="sheet-autoCalc" name="attr_DeplacementRapide_Duree" value="20" readonly />
							</div>
							<div class="sheet-col-4"> sec</div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-4 sheet-bold">Sprint (*)</div>
							<div class="sheet-col-4" title="Calculée en fonction de la PR Phy.">
								<input type="text" class="sheet-autoCalc" name="attr_DeplacementSprint" value="12" readonly />
							</div>
							<div class="sheet-col-4"> m / assault</div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-4 sheet-bold">Durée</div>
							<div class="sheet-col-4" title="Calculée en fonction de la Force">
								<input type="text" class="sheet-autoCalc" name="attr_DeplacementSprint_Duree" value="5" readonly />
							</div>
							<div class="sheet-col-4"> sec</div>
						</div>
						<span class="sheet-hint">* Après un assaut en déplacement rapide, on est considéré comme lancé et on peut sprinter.</span>
					</div>
					<br />
					<div class="sheet-confrontation">
						<h2>Confrontation</h2>
						<div class="sheet-row">
							<div class="sheet-col-5">
								<select name="attr_Confrontation_jet">
									<option value="" selected="selected"></option>
									<option value="COU : [[ @{Stats_Courage_total} + @{Confrontation_mod} ]]">COU</option>
									<option value="INT : [[ @{Stats_Intelligence_total} + @{Confrontation_mod} ]]">INT</option>
									<option value="CHA : [[ @{Stats_Charisme_total} + @{Confrontation_mod} ]]">CHA</option>
									<option value="AD : [[ @{Stats_Adresse_total} + @{Confrontation_mod} ]]">AD</option>
									<option value="FO : [[ @{Stats_Force_total} + @{Confrontation_mod} ]]">FO</option>
									<option value="AT : [[ @{Stats_Attaque_total} + @{Confrontation_mod} ]]">AT</option>
									<option value="PRD : [[ @{Stats_Parade_total} + @{Confrontation_mod} ]]">PRD</option>
									<option value="Magie Phy. : [[ @{Stats_MagiePhy_total} + @{Confrontation_mod} ]]">Magie Phy.</option>
									<option value="Magie Psy. : [[ @{Stats_MagiePsy_total} + @{Confrontation_mod} ]]">Magie Psy.</option>
									<option value="Résist. Magie : [[ @{Stats_MagiePsy_total} + @{Confrontation_mod} ]]">Résist. Magie</option>
								</select>
							</div>
							<div class="sheet-col-1"></div>
							<div class="sheet-col-4">
								<input type="text" name="attr_Confrontation_mod" value="1d6">
							</div>
							<div class="sheet-col-2">
								<button type="roll" name="roll_Confrontation" value="@{displayJet} &{template:default} {{name=Confrontation de @{Personnage_Nom} }} {{ Résultat = @{Confrontation_jet} }}"></button>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!--- Disply usefull hint depending on stats --->
			<div class="sheet-row sheet-hint"><div class="sheet-col-12"><span name="attr_BonusIntel"></span></div></div>
			<div class="sheet-row sheet-hint"><div class="sheet-col-12"><span name="attr_BonusAdresse"></span></div></div>
			<div class="sheet-row sheet-hint"><div class="sheet-col-12"><span name="attr_BonusForce"></span></div></div>
		</div>

		<!-- TAB Compétences -->
		<div class="sheet-tab_competences">
			<div class="sheet-competences">
				<input type="checkbox" class="sheet-display sheet-display-competences" name="attr_displayCompetences" value="1" checked="checked"><h2 class="sheet-display">Compétences</h2>
				<div class="sheet-tableth sheet-row">
					<div class="sheet-col-4">Compétence</div>
					<div class="sheet-col-3">Effets</div>
					<div class="sheet-col-1">Épreuve ?</div>
					<div class="sheet-col-1">Stat.</div>
					<div class="sheet-col-1">Mod.</div>
					<div class="sheet-col-2">Épreuve</div>
				</div>
				<fieldset class="repeating_competences">
					<!--- display row compétences --->
					<div class="sheet-group">
						<div class="sheet-row">
							<div class="sheet-col-4">
								<input type="text" class="sheet-noBorder" name="attr_Competence_Nom" value="" />
							</div>
							<div class="sheet-col-3">
								<input type="text" class="sheet-noBorder" name="attr_Competence_Effet" value="" />
							</div>
							<div class="sheet-col-1">
								<input type="checkbox" class="sheet-display-competenceEpreuve" name="attr_Competence_Epreuve" value="1" />
							</div>

							<input type="checkbox" class="sheet-display-competenceEpreuve sheet-hidden" name="attr_Competence_Epreuve" value="1" />
							<div class="sheet-display-competenceEpreuve">
								<div class="sheet-col-1">
									<select name="attr_Competence_Jet">
										<option value="COU : [[ @{Stats_Courage_total} + @{Competence_mod} ]]">COU</option>
										<option value="INT : [[ @{Stats_Intelligence_total} + @{Competence_mod} ]]">INT</option>
										<option value="CHA : [[ @{Stats_Charisme_total} + @{Competence_mod} ]]">CHA</option>
										<option value="AD : [[ @{Stats_Adresse_total} + @{Competence_mod} ]]">AD</option>
										<option value="FO : [[ @{Stats_Force_total} + @{Competence_mod} ]]">FO</option>
									</select>
								</div>
								<div class="sheet-col-1">
									<input type="number" name="attr_Competence_mod" value="0" />
								</div>
								<div class="sheet-col-2 sheet-center">
									<button type="roll" value="@{rollCompetence}" name="roll_Epreuve"> Épreuve</button>
								</div>
							</div>
						</div>
					</div>
					<input type="checkbox" class="sheet-display-competenceEpreuve sheet-hidden" name="attr_Competence_Epreuve" value="1" />
					<!--- or display btn compétences --->
					<div class="sheet-col sheet-btnRoll">
						<button type="roll" value="@{rollCompetence}" name="roll_Epreuve"> <span name="attr_Competence_Nom"></span></button>
					</div>
					<!--- or display compétences --->
					<div class="sheet-col sheet-noRoll">
						<span name="attr_Competence_Nom"></span>
					</div>
					<input type="hidden" name="attr_rollCompetence" value="@{displayJet} &{template:default} {{name=Épreuve de @{Competence_Nom} par @{Personnage_Nom} }} {{Épreuve=@{Competence_Jet} }} {{ Résultat=[[1d20cs<1cf>20]] }}">
				</fieldset>
			</div>
			<br clear="all" />
			<br />
			<div class="sheet-coupsspeciaux">
				<h2>Coups spéciaux</h2>
				<fieldset class="repeating_coupsSpeciaux">
					<div class="sheet-group">
						<div class="sheet-row">
							<div class="sheet-col-8">
								<input type="text" class="sheet-noBorder" name="attr_CoupSpecial_Nom" value="" />
							</div>
							<div class="sheet-col-4">
								<button type="roll" name="roll_Epreuve" value="@{displayJet} &{template:default} {{name=@{Personnage_Nom} prépare son coup spécial @{CoupSpecial_Nom} }} {{ Épreuve=@{CoupSpecial_Jet} }} {{ Résultat=[[1d20cs<1cf>20]] }}" > Épreuve</button>
								<button type="roll" name="roll_Degats" class="sheet-rollDegats" value="@{displayJet} &{template:default} {{name=Dégats de @{Personnage_Nom} avec @{CoupSpecial_Nom}}} {{ Dégats=[[@{CoupSpecial_Degats}[Dégats] + @{CoupSpecial_Degats_arme}[Arme]]] }}" > Dégats</button>
								<button type="roll" name="roll_Grimoire" class="sheet-rollGrimoire" value="@{displayJet} &{template:coupSpecial} {{name=@{coupspecial_nom}}} {{coupspecial_jet=@{coupspecial_jet}}} {{coupspecial_degats=@{coupspecial_degats}}} {{coupspecial_degats_arme=@{coupspecial_degats_arme}}} {{coupspecial_utilisation=@{coupspecial_utilisation}}} {{coupspecial_echec=@{coupspecial_echec}}} {{coupspecial_effet=@{coupspecial_effet}}} {{coupspecial_note=@{coupspecial_note}}} {{coupspecial_condition=@{coupspecial_condition}}} {{coupspecial_critique=@{coupspecial_critique}}} {{coupspecial_fumble=@{coupspecial_fumble}}}"> Grimoire </button>
							</div>
						</div>
						<input type="checkbox" name="attr_CoupSpecial_config" class="sheet-config-flag" value="1" /><span class="sheet-cog">y</span>
						<div class="sheet-config">
							<br>
							<div class="sheet-row">
								<div class="sheet-col-2"><b>Utilisation :</b></div>
								<div class="sheet-col-4"><input type="text" class="sheet-noBorder" name="attr_CoupSpecial_utilisation"></div>
								<div class="sheet-col-2"><b>Echec :</b></div>
								<div class="sheet-col-4"><input type="text" class="sheet-noBorder" name="attr_CoupSpecial_echec"></div>
							</div>
							<hr>
							<div class="sheet-row">
								<div class="sheet-col-2"><b>Effets :</b></div>
								<div class="sheet-col-4"><input type="text" class="sheet-noBorder" name="attr_CoupSpecial_effet"></div>
								<div class="sheet-col-2"><b>Notes :</b></div>
								<div class="sheet-col-4"><input type="text" class="sheet-noBorder" name="attr_CoupSpecial_note"></div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-2"><b>Epreuve :</b></div>
								<div class="sheet-col-2">
									<select name="attr_CoupSpecial_Jet">
										<option value="AT : [[ @{Stats_Attaque_total} + @{CoupSpecial_Mod} ]]">AT</option>
										<option value="PRD : [[ @{Stats_Parade_total} + @{CoupSpecial_Mod} ]]">PRD</option>
										<option value="ESQ : [[ @{Stats_Esquive_total} + @{CoupSpecial_Mod} ]]">ESQ</option>
										<option value="COU : [[ @{Stats_Courage_total} + @{CoupSpecial_Mod} ]]">COU</option>
										<option value="INT : [[ @{Stats_Intelligence_total} + @{CoupSpecial_Mod} ]]">INT</option>
										<option value="CHA : [[ @{Stats_Charisme_total} + @{CoupSpecial_Mod} ]]">CHA</option>
										<option value="AD : [[ @{Stats_Adresse_total} + @{CoupSpecial_Mod} ]]">AD</option>
										<option value="FO : [[ @{Stats_Force_total} + @{CoupSpecial_Mod} ]]">FO</option>
										<option value="JET : [[ @{Stats_Jet_total} + @{CoupSpecial_Mod} ]]">JET</option>
										<option value="AD/FO : [[ ceil((@{Stats_Force_total}+@{Stats_Adresse_total})/2) + @{CoupSpecial_Mod} ]] ">AD/FO</option>
									</select>
								</div>
								<div class="sheet-col-1">
									<input type="number" name="attr_CoupSpecial_Mod" value="0" />
								</div>
								<div class="sheet-col-1"></div>
								<div class="sheet-col-2"><b>Conditions :</b></div>
								<div class="sheet-col-4"><input type="text" class="sheet-noBorder" name="attr_CoupSpecial_condition"></div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-2"><b>Dégats :</b></div>
								<div class="sheet-col-1"><input type="text" name="attr_CoupSpecial_Degats" value="1d6" /></div>
								<div class="sheet-col-3"></div>
								<div class="sheet-col-2"><b>+Dégats de l'arme :</b></div>
								<div class="sheet-col-1"><input type="text" name="attr_CoupSpecial_Degats_arme" value="" /></div>
							</div>
							<hr>
							<div class="sheet-row">
								<div class="sheet-col-2"><b>Critique :</b></div>
								<div class="sheet-col-4"><input type="text" class="sheet-noBorder" name="attr_CoupSpecial_critique"></div>
								<div class="sheet-col-2"><b>Echec critique :</b></div>
								<div class="sheet-col-4"><input type="text" class="sheet-noBorder" name="attr_CoupSpecial_fumble"></div>
							</div>
						</div>
					</div>
				</fieldset>
			</div>
			<br />
			<div class="sheet-traits">
				<h2>Traits particuliers (Débilibeuks / Mankdebols / Mutations / Maladies / Malédictions...) <input type="checkbox" name="attr_modal_traits" class="sheet-modal" value="1" title="Comment ca marche ?"><span class="sheet-cog" title="Comment ca marche ?">?</span></h2>
				<input type="checkbox" class="sheet-hidden sheet-modal" name="attr_modal_traits" value="1">
				<div class="sheet-modal-wrapper">
					<div class="sheet-modal">
						<div class="sheet-modal_header">
							<h2>Traits particuliers <span class="sheet-close">*</span><input type="checkbox" class="sheet-modal" name="attr_modal_traits" value="1"></h2>
						</div>
						<div class="sheet-modal_body">
							Dans le champ Effets, listez les bonus (+) et malus (-) séparés par des virgules, en minuscules ou majuscules, avec ou sans espaces.<br /><br />
							Activez le trait en fonction des circonstances (blessure, bonus temporaire, arme dégainée...)<br /><br />
							<b>Statistiques disponibles :</b><br />
							<ul>
								<li>cou, int, cha, ad, fo</li>
								<li>at, prd, jet, esq, fouille</li>
								<li>inge, mphy, mpsy, rm</li>
								<li>pr, mvt (en %)</li>
							</ul>
							Ex: COU+2, int-3,cha +4, pr-2
						</div>
					</div>
				</div>
				<div class="sheet-tableth sheet-row">
					<div class="sheet-col-2">Provenance</div>
					<div class="sheet-col-2">Nom</div>
					<div class="sheet-col-7">Effets</div>
					<div class="sheet-col-1">Actif ?</div>
				</div>
				<fieldset class="repeating_conditions">
					<div class="sheet-group">
						<div class="sheet-row">
							<div class="sheet-col-2">
								<input type="text" class="sheet-noBorder" name="attr_condition_provenance" value="" />
							</div>
							<div class="sheet-col-2">
								<input type="text" class="sheet-noBorder" name="attr_condition_nom" value="" />
							</div>
							<div class="sheet-col-7">
								<input type="text" class="sheet-noBorder" name="attr_condition_effet" value="" />
							</div>
							<div class="sheet-col-1 sheet-center">
								<input type="checkbox" name="attr_condition_actif" value="1" />
							</div>
						</div>
					</div>
				</fieldset>
			</div>
			<br />
			<div class="sheet-ape">
				<h2>Aptitudes Parfois Étranges</h2>
				<div class="sheet-tableth sheet-row">
					<div class="sheet-col-3">Nom</div>
					<div class="sheet-col-4">Description et Conditions</div>
					<div class="sheet-col-3">Bonus</div>
					<div class="sheet-col-2">Occurences</div>
				</div>
				<fieldset class="repeating_ape">
					<div class="sheet-group">
						<div class="sheet-row">
							<div class="sheet-col-3">
								<input type="text" class="sheet-noBorder" name="attr_ape_nom" value="" />
							</div>
							<div class="sheet-col-4">
								<input type="text" class="sheet-noBorder" name="attr_ape_note" value="" />
							</div>
							<div class="sheet-col-4">
								<input type="text" class="sheet-noBorder" name="attr_ape_effet" value="" />
							</div>
							<div class="sheet-col-1">
								<input type="number" name="attr_ape_occurence" value="1" min=1 max=3 step=1 />
							</div>
						</div>
					</div>
				</fieldset>
			</div>
		</div>

		<!-- TAB Equipement -->
		<div class="sheet-tab_equipement">
			<div class="sheet-row sheet-hint sheet-center">
				<div class="sheet-col-4">Bonus de Force aux dégats :</div>
				<div class="sheet-col-1"><input class="sheet-autoCalc" name="attr_BonusDegatsForce" value="0" readonly type="text"></div>
				<div class="sheet-col-4">Bonus d'équipement aux dégats :</div>
				<div class="sheet-col-1"><input name="attr_BonusDegatsAtk" value="0" type="text"></div>
			</div>
			<br />
			<div class="sheet-armes">
				<h2>Armement & Baston</h2>
				<!-- hidden roll for chat buttons --->
				<button type="roll" class="sheet-hidden" name="roll_confirmation_fumble_atk" value="@{displayJet} &{template:fumble_atk} {{name=Maladresse attaque ou parade de @{Personnage_Nom}}} {{results=[[1d20cs<1cf>20]]}} {{subresults=[[1d6]]}} {{displayEffets=[[@{displayCritEffets}]]}}"></button>
				<button type="roll" class="sheet-hidden" name="roll_confirmation_crit_prd" value="@{displayJet} &{template:crit_prd} {{name=Parade critique de @{Personnage_Nom}}} {{results=[[1d20cs<1cf>20]]}} {{displayEffets=[[@{displayCritEffets}]]}}"></button>
				<button type="roll" class="sheet-hidden" name="roll_confirmation_crit_tranchant" value="@{displayJet} &{template:crit_tranchant} {{name=Attaque critique tranchante de @{Personnage_Nom}}} {{results=[[1d20cs<1cf>20]]}} {{subresults=[[1d6]]}} {{displayEffets=[[@{displayCritEffets}]]}}"></button>
				<button type="roll" class="sheet-hidden" name="roll_confirmation_crit_contondant" value="@{displayJet} &{template:crit_contondant} {{name=Attaque critique contondante de @{Personnage_Nom}}} {{results=[[1d20cs<1cf>20]]}} {{subresults=[[1d6]]}} {{displayEffets=[[@{displayCritEffets}]]}}"></button>
				<button type="roll" class="sheet-hidden" name="roll_confirmation_crit_projectile" value="@{displayJet} &{template:crit_projectile} {{name=Attaque critique au projectile de @{Personnage_Nom}}} {{results=[[1d20cs<1cf>20]]}} {{displayEffets=[[@{displayCritEffets}]]}}"></button>
				<button type="roll" class="sheet-hidden" name="roll_confirmation_crit_pugilat" value="@{displayJet} &{template:crit_pugilat} {{name=Attaque critique à mains nues de @{Personnage_Nom}}} {{results=[[1d20cs<1cf>20]]}} {{subresults=[[1d6]]}} {{displayEffets=[[@{displayCritEffets}]]}}"></button>

				<div class="sheet-tableth sheet-row">
					<div class="sheet-col-4">Arme</div>
					<div class="sheet-col-1">Portée</div>
					<div class="sheet-col-1">AT</div>
					<div class="sheet-col-1">PRD</div>
					<div class="sheet-col-2">Dégats</div>
					<div class="sheet-col-3">Jets</div>
				</div>

				<fieldset class="repeating_armes">
					<div class="sheet-group">
						<div class="sheet-row">
							<div class="sheet-col-4">
								<input type="text" class="sheet-noBorder" name="attr_Arme_Nom" value="" />
							</div>
							<div class="sheet-col-1">
								<select name="attr_Arme_Portee">
									<option value="Mélée" selected="selected">Mélée</option>
									<option value="Dist.">Dist.</option>
								</select>
							</div>
							<div class="sheet-col-1">
								<input type="text" class="sheet-autoCalc" name="attr_Arme_TotalAT" value="0" readonly />
							</div>
							<div class="sheet-col-1">
								<input type="text" class="sheet-autoCalc" name="attr_Arme_TotalPRD" value="@{Stats_Parade_total}+@{Arme_PRD}" readonly disabled="true" />
							</div>
							<div class="sheet-col-2">
								<input type="text" class="sheet-autoCalc" name="attr_Arme_TotalDegats" value="1d6" readonly />
							</div>
							<div class="sheet-col-3">
								<button type="roll" name="roll_AT" value="@{displayJet} &{template:atk} {{name=Attaque de @{Personnage_Nom} avec @{Arme_Nom} }} {{at=@{Arme_TotalAT} }} {{notes=@{Arme_Note} }} {{effets= @{Arme_Effet} }} {{portee= @{arme_portee} }} {{display_effets= [[@{arme_Effet_display}]] }} {{display_notes= [[@{Arme_Note_display}]] }} {{btn_critique= [Critique](~@{character_name}|confirmation_crit_@{Arme_typeDegat}) }} {{btn_fumble= [Fumble](~@{character_name}|confirmation_fumble_atk) }} {{results=[[1d20cs<@{Arme_Critique}cf>@{Arme_Fumble}]] }} {{btn_degats=[Dégats](~repeating_armes_Degats)}}"> AT </button>
								<button type="roll" name="roll_PRD" value="@{displayJet} &{template:prd} {{name=Parade de @{Personnage_Nom} avec @{Arme_Nom} }} {{prd=@{Arme_TotalPRD} }} {{results=[[1d20cs<@{Arme_Critique}cf>@{Arme_Fumble}]] }} {{btn_critique= [Critique](~@{character_name}|confirmation_crit_prd) }} {{btn_fumble=[Fumble](~@{character_name}|confirmation_fumble_atk) }}"> PRD </button>
								<button type="roll" name="roll_Degats" class="sheet-rollDegats" value="@{displayJet} &{template:dmg} {{name=Dégats de @{Personnage_Nom} avec @{Arme_Nom}}} {{dmg= [[ @{Arme_TotalDegats} ]] }} {{munition=@{munition_nom}}}  {{munition_effet=@{munition_effet}}} {{typeDegat=@{Arme_typeDegat}}}"> Dégats </button>
							</div>
						</div>
						<input type="checkbox" name="attr_Arme_config" class="sheet-config-flag" value="1" /><span class="sheet-cog">y</span>
						<div class="sheet-config">
							<div class="sheet-row">
								<div class="sheet-col-2"><b>Mod. AT :</b></div>
								<div class="sheet-col-1">
									<input type="number" name="attr_Arme_AT" value="0" />
								</div>
								<div class="sheet-col-2 sheet-right"><b>Mod. PRD :</b></div>
								<div class="sheet-col-1">
									<input type="number" name="attr_Arme_PRD" value="0" />
								</div>
								<div class="sheet-col-2 sheet-right"><b>RUP :</b></div>
								<div class="sheet-col-1">
									<input type="text" name="attr_Arme_RUP" value="" />
								</div>
							</div>

							<div class="sheet-row">
								<div class="sheet-col-2"><b>Dégats :</b></div>
								<div class="sheet-col-1">
									<input type="text" name="attr_Arme_Degats" value="1d6" />
								</div>
								<div class="sheet-col-2 sheet-right"><b>Types de dégats :</b></div>
								<div class="sheet-col-1">
									<select name="attr_Arme_typeDegat">
										<option value="tranchant">Tranchant</option>
										<option value="contondant">Contondant</option>
										<option value="projectile">Projectile</option>
										<option value="pugilat">Main nue</option>
									</select>
								</div>
								<div class="sheet-col-2 sheet-right"><b>Critique :</b></div>
								<div class="sheet-col-1">
									<input type="number" name="attr_Arme_Critique" value="1" />
								</div>
								<div class="sheet-col-2 sheet-right"><b>Fumble :</b></div>
								<div class="sheet-col-1">
									<input type="number" name="attr_Arme_Fumble" value="20" />
								</div>
							</div>

							<input type="checkbox" class="sheet-hidden sheet-display-arme_munition" name="attr_Arme_Munition_display" value=1>
							<div class="sheet-display-arme_munition">

								<div class="sheet-row">
									<div class="sheet-col-2"><b>Bonus Force ? :</b></div>
									<div class="sheet-col-2"><input type="checkbox" name="attr_Arme_bonusForce" value="1" checked="checked"></div>
								</div>

								<div class="sheet-row">
									<div class="sheet-col-2"><b>Munition : </b></div>
									<div class="sheet-col-2">
										<input type="text" class="sheet-noBorder" name="attr_munition_nom" value="" />
										<input type="hidden" name="attr_munition_effet" value="" />
									</div>
									<div class="sheet-col-1 sheet-right"><b>Dégats : </b></div>
									<div class="sheet-col-1">
										<input type="text" class="sheet-autoCalc" name="attr_munition_degats" value="0" readonly />
									</div>
									<div class="sheet-col-2 sheet-right"><b>Mod. AD : </b></div>
									<div class="sheet-col-1">
										<input type="text" class="sheet-autoCalc" name="attr_munition_modAd" value="0" readonly />
									</div>
								</div>
							</div>

							<div class="sheet-row">
								<div class="sheet-col-2">
									<b>Bonus / Effets : </b>
								</div>
								<div class="sheet-col-9" >
									<input type="text" class="sheet-noBorder" name="attr_Arme_Effet" value="" />
								</div>
								<div class="sheet-col-1">
									<input type="checkbox" name="attr_Arme_Effet_display" value="1" title="Afficher dans le chat">
								</div>
							</div>

							<div class="sheet-row">
								<div class="sheet-col-2">
									<b>Notes : </b>
								</div>
								<div class="sheet-col-9">
									<input type="text" class="sheet-noBorder" name="attr_Arme_Note" value="" />
								</div>
								<div class="sheet-col-1">
									<input type="checkbox" name="attr_Arme_Note_display" value="1" title="Afficher dans le chat">
								</div>
							</div>
						</div>
					</div>
				</fieldset>
			</div>
			<br />
			<div class="sheet-guns">
				<input type="checkbox" class="sheet-display sheet-display-guns" name="attr_displayGuns" value="1" checked="checked" /><h2 class="sheet-display">Armes à poudres</h2>
				<div class="sheet-display-guns">
					<div class="sheet-tableth sheet-row">
						<div class="sheet-col-4">Arme</div>
						<div class="sheet-col-1"></div>
						<div class="sheet-col-1">AT</div>
						<div class="sheet-col-6">Jets</div>
					</div>

					<fieldset class="repeating_guns">
						<div class="sheet-group">
							<div class="sheet-row">
								<div class="sheet-col-4">
									<input type="text" class="sheet-noBorder" name="attr_Gun_Nom" value="" />
								</div>
								<div class="sheet-col-1">
								</div>
								<div class="sheet-col-1">
									<input type="text" class="sheet-autoCalc" name="attr_Gun_TotalAT" value="@{Gun_Epreuve} + @{Gun_Epreuve_mod} + @{munition_modAd}" readonly disabled="true" />
								</div>
								<div class="sheet-col-5 sheet-right">
									<button type="roll" name="roll_Test" value="@{displayJet} &{template:gun_atk} {{name=@{Personnage_Nom} test @{Gun_Nom} }} {{fonctionnement=@{Gun_Fonctionnement} }} {{fonctionnement_results1=[[1d6]] }} {{fonctionnement_results2=[[1d6]] }} {{btn_tir=[Tir](~repeating_guns_Tir)}}"> Fonctionnement </button>
									<button type="roll" name="roll_Tir" value="@{displayJet} &{template:gun_atk} {{name=Attaque de @{Personnage_Nom} avec @{Gun_Nom} }} {{at=@{Gun_TotalAT} }} {{special=@{Gun_Special} }} {{display_special=[[@{Gun_Special_display}]] }} {{btn_degats=[Dégats](~repeating_guns_Degats)}} {{btn_critique= [Critique](~@{character_name}|confirmation_crit_projectile}) }} {{btn_fumble= [Fumble](~@{character_name}|confirmation_fumble_atk) }} {{results=[[1d20cs<@{Gun_Critique}cf>@{Gun_Fumble}]] }}"> Tir </button>
									<button type="roll" name="roll_Degats" class="sheet-rollDegats" value="@{displayJet} &{template:gun_dmg} {{name=Dégats de @{Personnage_Nom} avec @{Gun_Nom} }} {{btn_degats1=[Dégats @{Gun_Portee1}](~repeating_guns_Degats1)}} {{btn_degats2_display=[[@{Gun_Portee2_display}]]}} {{btn_degats2=[Dégats @{Gun_Portee2}](~repeating_guns_Degats2)}} {{btn_degats3_display=[[@{Gun_Portee3_display}]]}} {{btn_degats3=[Dégats @{Gun_Portee3}](~repeating_guns_Degats3)}}"> Dégats </button>
								</div>
							</div>
							<input type="checkbox" name="attr_gun_config" class="sheet-config-flag" value="1" /><span class="sheet-cog">y</span>
							<div class="sheet-config">
								<div class="sheet-row">
									<div class="sheet-col-2"><b>Portée(s) :</b></div>
									<div class="sheet-col-2">
										<input type="text" class="sheet-noBorder" name="attr_Gun_Portee1" value="" placeholder="Au contact" />
									</div>
									<div class="sheet-col-1"></div>
									<div class="sheet-col-2">
										<input type="text" class="sheet-noBorder" name="attr_Gun_Portee2" value="" placeholder="à 3-10m" />
									</div>
									<div class="sheet-col-1">
										<input type="checkbox" name="attr_Gun_Portee2_display" value="1" title="Afficher dans le chat" />
									</div>
									<div class="sheet-col-2">
										<input type="text" class="sheet-noBorder" name="attr_Gun_Portee3" value="" placeholder="à 11-20m" />
									</div>
									<div class="sheet-col-1">
										<input type="checkbox" name="attr_Gun_Portee3_display" value="1" title="Afficher dans le chat" />
									</div>
								</div>
								<div class="sheet-row">
									<div class="sheet-col-2"><b>Dégats :</b></div>
									<div class="sheet-col-1">
										<input type="text" name="attr_Gun_Degats1" value="1d6" />
									</div>
									<div class="sheet-col-2">
										<button type="roll" name="roll_Degats1" class="sheet-rollDegats" value="@{displayJet} &{template:dmg} {{name=Dégats de @{Personnage_Nom} avec @{Gun_Nom} (@{Gun_Portee1}) }} {{dmg= [[ @{Gun_Degats1}[Arme] + @{munition_degats}[Munition] ]] }} {{munition=@{munition_nom}}} {{munition_effet=@{munition_effet}}}"> Dégats </button>
									</div>
									<div class="sheet-col-1">
										<input type="text" name="attr_Gun_Degats2" value="" placeholder="1d6" />
									</div>
									<div class="sheet-col-2">
										<button type="roll" name="roll_Degats2" class="sheet-rollDegats" value="@{displayJet} &{template:dmg} {{name=Dégats de @{Personnage_Nom} avec @{Gun_Nom} (@{Gun_Portee2}) }} {{dmg= [[ @{Gun_Degats2}[Arme] + @{munition_degats}[Munition] ]] }} {{munition=@{munition_nom}}} {{munition_effet=@{munition_effet}}}"> Dégats </button>
									</div>
									<div class="sheet-col-1">
										<input type="text" name="attr_Gun_Degats3" value="" placeholder="1d6" />
									</div>
									<div class="sheet-col-2">
										<button type="roll" name="roll_Degats3" class="sheet-rollDegats" value="@{displayJet} &{template:dmg} {{name=Dégats de @{Personnage_Nom} avec @{Gun_Nom} (@{Gun_Portee3}) }} {{dmg= [[ @{Gun_Degats3}[Arme] + @{munition_degats}[Munition] ]] }} {{munition=@{munition_nom}}} {{munition_effet=@{munition_effet}}}"> Dégats </button>
									</div>
								</div>

								<hr />
								<div class="sheet-row">
									<div class="sheet-col-2"><b>Épreuve :</b></div>
									<div class="sheet-col-2">
										<select name="attr_Gun_Epreuve">
											<option value="@{Stats_Jet_total}">AD</option>
											<option value="ceil((@{Stats_Jet_total}+@{Stats_Intelligence_total})/2)">AD / INT</option>
											<option value="ceil((@{Stats_Jet_total}+@{Stats_Force_total})/2)">AD / FO</option>
										</select>
									</div>
									<div class="sheet-col-1"><input type="number" name="attr_Gun_Epreuve_mod" value="0" /></div>
									<div class="sheet-col-2 sheet-right"><b>Critique :</b></div>
									<div class="sheet-col-1">
										<input type="number" name="attr_Gun_Critique" value="1" />
									</div>
									<div class="sheet-col-2 sheet-right"><b>Fumble :</b></div>
									<div class="sheet-col-1">
										<input type="number" name="attr_Gun_Fumble" value="20" />
									</div>
								</div>

								<div class="sheet-row">
									<div class="sheet-col-2"><b>Munition : </b></div>
									<div class="sheet-col-2">
										<input type="text" class="sheet-noBorder" name="attr_munition_nom" value="" />
										<input type="hidden" name="attr_munition_effet" value="" />
									</div>
									<div class="sheet-col-1 sheet-right"><b>Dégats : </b></div>
									<div class="sheet-col-1">
										<input type="text" class="sheet-autoCalc" name="attr_munition_degats" value="0" readonly />
									</div>
									<div class="sheet-col-2 sheet-right"><b>Mod. AD : </b></div>
									<div class="sheet-col-1">
										<input type="text" class="sheet-autoCalc" name="attr_munition_modAd" value="0" readonly />
									</div>
								</div>

								<hr />

								<div class="sheet-row">
									<div class="sheet-col-3">
										<b>Spécial : </b>
									</div>
									<div class="sheet-col-8" >
										<input type="text" class="sheet-noBorder" name="attr_Gun_Special" value="" />
									</div>
									<div class="sheet-col-1">
										<input type="checkbox" name="attr_Gun_Special_display" value="1" title="Afficher dans le chat" />
									</div>
								</div>

								<div class="sheet-row">
									<div class="sheet-col-3">
										<b>Cadence de tir : </b>
									</div>
									<div class="sheet-col-9">
										<input type="text" class="sheet-noBorder" name="attr_Gun_Cadence" value="" />
									</div>
								</div>
								<div class="sheet-row">
									<div class="sheet-col-3">
										<b>Délai de rechargement : </b>
									</div>
									<div class="sheet-col-9">
										<input type="text" class="sheet-noBorder" name="attr_Gun_Reload" value="" />
									</div>
								</div>

								<hr />
								<div class="sheet-row">
									<div class="sheet-col-3">
										<b>Combustion par coup : </b>
									</div>
									<div class="sheet-col-9">
										<input type="text" class="sheet-noBorder" name="attr_Gun_Combustion" value="" />
									</div>
								</div>
								<div class="sheet-row">
									<div class="sheet-col-3">
										<b>Munitions par coup : </b>
									</div>
									<div class="sheet-col-9">
										<input type="text" class="sheet-noBorder" name="attr_Gun_Munition" value="" />
									</div>
								</div>
								<hr />
								<div class="sheet-row">
									<div class="sheet-col-3">
										<b>Chances de fonctionnement : </b>
									</div>
									<div class="sheet-col-9">
										<input type="text" class="sheet-noBorder" name="attr_Gun_Fonctionnement" value="" />
									</div>
								</div>

								<div class="sheet-row">
									<div class="sheet-col-3">
										<b>Description : </b>
									</div>
									<div class="sheet-col-9">
										<input type="text" class="sheet-noBorder" name="attr_Gun_Note" value="" />
									</div>
								</div>
							</div>
						</div>
					</fieldset>
				</div>
			</div>
			<br />
			<div class="sheet-munitions">
				<input type="checkbox" class="sheet-display sheet-display-munitions" name="attr_displayMunitions" value="1" checked="checked" /><h2 class="sheet-display">Munitions</h2>
				<div class="sheet-display-munitions">
					<div class="sheet-tableth sheet-row">
						<div class="sheet-col-4"></div>
						<div class="sheet-col-1">Nb.</div>
						<div class="sheet-col-1">Mod. AD</div>
						<div class="sheet-col-1">Dégats</div>
						<div class="sheet-col-1">RUP.</div>
						<div class="sheet-col-4">Bonus / Effets</div>
					</div>
					<fieldset class="repeating_munitions">
						<div class="sheet-group">
							<div class="sheet-row">
								<div class="sheet-col-4">
									<input type="text" class="sheet-noBorder" name="attr_Munition_Nom" value="" />
								</div>
								<div class="sheet-col-1">
									<input type="number" name="attr_Munition_Count" value="" />
								</div>
								<div class="sheet-col-1">
									<input type="number" name="attr_Munition_ModAd" value="" />
								</div>
								<div class="sheet-col-1">
									<input type="text" name="attr_Munition_Degats" value="" />
								</div>
								<div class="sheet-col-1">
									<input type="text" name="attr_Munition_RUP" value="" />
								</div>
								<div class="sheet-col-4">
									<input type="text" class="sheet-noBorder" name="attr_Munition_Effet" value="" />
								</div>
							</div>
						</div>
					</fieldset>
				</div>
			</div>
			<br />
			<div class="sheet-bagues">
				<input type="checkbox" class="sheet-display sheet-display-bagues" name="attr_displayBagues" value="1" checked="checked" /><h2 class="sheet-display">Objets chargés (Bagues, Pendentifs, Broches...)</h2>
				<div class="sheet-display-bagues">
					<div class="sheet-tableth sheet-row">
						<div class="sheet-col-5"></div>
						<div class="sheet-col-1">Charges</div>
						<div class="sheet-col-6">Bonus / Effets</div>
					</div>
					<fieldset class="repeating_bagues">
						<div class="sheet-group">
							<div class="sheet-row">
								<div class="sheet-col-5">
									<input type="text" class="sheet-noBorder" name="attr_Bague_Nom" value="" />
								</div>
								<div class="sheet-col-1">
									<input type="number" name="attr_Bague_Count" value="" />
								</div>
								<div class="sheet-col-6">
									<input type="text" class="sheet-noBorder" name="attr_Bague_Bonus" value="" />
								</div>
							</div>
						</div>
					</fieldset>
				</div>
			</div>
			<br />
			<div class="sheet-armure">
				<h2>Armures & Protections</h2>

				<div class="sheet-tableth sheet-row">
					<div class="sheet-col-4">Pièce d'Armure</div>
					<div class="sheet-col-1">PR Phys.</div>
					<div class="sheet-col-1">PR Mag.</div>
					<div class="sheet-col-1">RUP.</div>
					<div class="sheet-col-5">Bonus / Effets</div>
				</div>
				<fieldset class="repeating_armures">
					<div class="sheet-group">
						<div class="sheet-row">
							<div class="sheet-col-4">
								<input type="text" class="sheet-noBorder" name="attr_Armure_Nom" value="" />
							</div>
							<div class="sheet-col-1">
								<input type="number" name="attr_Armure_PRPhy" value="0" />
							</div>
							<div class="sheet-col-1">
								<input type="number" name="attr_Armure_PRMag" value="0" />
							</div>
							<div class="sheet-col-1">
								<input type="text" name="attr_Armure_RUP" value="" />
							</div>
							<div class="sheet-col-5">
								<input type="text" class="sheet-noBorder" name="attr_Armure_Effet" value="" />
							</div>
						</div>
					</div>
				</fieldset>

				<br clear="all" />
				<br />
				<div class="sheet-row">
					<div class="sheet-col-5">
						<div class="sheet-armure-pieces">
							<table style="margin:auto;">
								<tr>
									<td></td>
									<th class="sheet-center">Tête</th>
									<td></td>
								</tr>
								<tr>
									<th class="sheet-center">Bras</th>
									<td rowspan="2"><input type="number" class="sheet-square" name="attr_PR_Tete" value="" placeholder="-" /></td>
									<td></td>
								</tr>
								<tr>
									<td rowspan="2" class="sheet-center"><input type="number" class="sheet-square" name="attr_PR_Bras" value="" placeholder="-" /></td>
									<td rowspan="2"></td>
								</tr>
								<tr>
									<th class="sheet-center">Torse</th>
								</tr>
								<tr>
									<th class="sheet-center">Mains</th>
									<td rowspan="2" class="sheet-center"><input type="number" class="sheet-square" name="attr_PR_Torse" value="" placeholder="-" /></td>
									<th class="sheet-center">Bouclier</th>
								</tr>
								<tr>
									<td rowspan="2" class="sheet-center"><input type="number" class="sheet-square" name="attr_PR_Mains" value="" placeholder="-" /></td>
									<td rowspan="2" class="sheet-center"><input type="number" class="sheet-square" name="attr_PR_Bouclier" value="" placeholder="-" /></td>
								</tr>
								<tr>
									<th class="sheet-center">Jambes</th>
								</tr>
								<tr>
									<td></td>
									<td rowspan="2" class="sheet-center"><input type="number" class="sheet-square" name="attr_PR_Jambes" value="" placeholder="-" /></td>
									<th class="sheet-center">Pieds</th>
								</tr>
								<tr>
									<td></td>
									<td class="sheet-center"><input type="number" class="sheet-square" name="attr_PR_Pieds" value="" placeholder="-" /></td>
								</tr>
							</table>
						</div>
						<br />
						<div class="sheet-row">
							<div class="sheet-col-7">
								<div class="sheet-tableth sheet-row sheet-bold sheet-center">
									PR détaillée
								</div>
								<div class="sheet-row">
									<div class="sheet-col-7 sheet-bold" title="Protection par l'Origine ou Compétences - Protège toutes les localisations du corps">PR Naturelle</div>
									<div class="sheet-col-5"><input type="number" name="attr_PRNat" value="0" /></div>
								</div>
								<div class="sheet-row">
									<div class="sheet-col-7 sheet-bold" title="Protection par l'Armure">PR Physique</div>
									<div class="sheet-col-5"><input type="text" class="sheet-autoCalc" name="attr_PRPhy" value="0" readonly /></div>
								</div>
								<div class="sheet-row">
									<div class="sheet-col-7 sheet-bold" title="Protection par la Magie - Protège toutes les localisations du corps">PR Magique</div>
									<div class="sheet-col-5"><input type="text" class="sheet-autoCalc" name="attr_PRMag" value="0" readonly /></div>
								</div>
								<div class="sheet-row">
									<div class="sheet-col-7 sheet-bold" title="Protection par bonus temporaire - Protège toutes les localisations du corps">PR Temp.</div>
									<div class="sheet-col-5"><input type="text" class="sheet-autoCalc" name="attr_stats_pr_buff" value="0" readonly /></div>
								</div>
								<span class="sheet-hint">PR : Valeur de protection</span>
							</div>
							<div class="sheet-col-2">
								<div class="sheet-tableth sheet-row sheet-bold sheet-center">Totale</div>
								<div class="sheet-row sheet-center">
									<input type="text" class="sheet-square sheet-autoCalc" name="attr_PR" value="0" readonly />
								</div>
							</div>
							<div class="sheet-col-2">
								<div class="sheet-tableth sheet-row sheet-bold sheet-center">Max</div>
								<div class="sheet-row sheet-center">
									<input type="text" class="sheet-square" name="attr_PR_max" value="0" />
								</div>
							</div>
							<div class="sheet-col-1">
								<input type="checkbox" name="attr_modal_HowToPrMax" class="sheet-modal" value="1" style="float: right"><span class="sheet-cog" style="float: right">?</span>
								<div class="sheet-modal-wrapper">
									<div class="sheet-modal">
										<div class="sheet-modal_header">
											<h2>PR Max <span class="sheet-close">*</span><input type="checkbox" class="sheet-modal" name="attr_modal_HowToPrMax" value="1"></h2>
										</div>
										<div class="sheet-modal_body">
											<p>La PR max est le score d'armure maximum (hors magique) que peux porter le personnage.<br /><br>
											Elle dépend de son Origine :</p>
											<ul>
												<li>Gnôme, <b>PR 2</b></li>
												<li>Elfe noir et Semi-Homme, <b>PR 3</b></li>
												<li>Haut-Elfe et Elfe Sylvain, <b>PR 4</b></li>
												<li>Gobelin et Ogre, <b>PR 4</b></li>
												<li>Demi-Elfe, <b>PR 5</b></li>
												<li>Barbare, <b>Sans restriction</b>, mais pas d'armure complète</li>
												<li>Humain et Nain, <b>Sans restriction</b></li>
												<li>Demi-Orque, Orque, <b>Sans restriction</b></li>
											</ul>
											<p>De son Métier :</p>
											<ul>
												<li>Mage et Ménestrel, <b>PR 2</b></li>
												<li>Assassin, Ingénieur, Marchand, Pirate et Voleur <b>PR 3</b></li>
												<li>Ranger, <b>PR 4</b></li>
												<li>Prêtre et Paladin <b>Selon dieu</b></li>
												<li>Guerrier et Noble <b>Selon origine</b></li>
											</ul>
											<p>De son culte pour Prêtres :</p>
											<ul>
												<li>Dlul et Adathie, <b>PR 5</b></li>
												<li>Youclidh, <b>Selon origine</b>, mais interdiction de porter des armures métalliques</li>
												<li>Slanoush, <b>Selon origine</b>, mais obligation de porter des armures en cuir</b></li>
											</ul>
											<p>De son culte les Paladins :</p>
											<ul>
												<li>Slanoush, <b>Selon origine</b>, mais interdiction de porter une armure avec malus CHA, obligation de porter du cuir ou cuir renforcé</li>
												<li>Dlul, <b>Selon origine</b></li>
												<li>Braav', <b>Selon origine</b></li>
												<li>Khornettoh, <b>Selon origine</b></li>
											</ul>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>

					<div class="sheet-col-7">
						<div class="sheet-tableth sheet-row">
							<div class="sheet-col-6">Vêtements</div>
							<div class="sheet-col-6">Bonus / Effets</div>
						</div>
						<fieldset class="repeating_vetements">
							<div class="sheet-row">
								<div class="sheet-col-6">
									<input type="text" class="sheet-noBorder" name="attr_Vetement_Nom" value="" />
								</div>
								<div class="sheet-col-6">
									<input type="text" class="sheet-noBorder" name="attr_Vetement_Effet" value="" />
								</div>
							</div>
						</fieldset>
					</div>
				</div>
			</div>
		</div>

		<!-- TAB Magie -->
		<div class="sheet-tab_magie">
			<div class="sheet-row">
				<!--- Magic school --->
				<div class="sheet-col-2">
					<div class="sheet-tableth sheet-row">
						<div class="sheet-col-12"> v Ecoles / Niveaux > </div>
					</div>
					<br />
					<input type="checkbox" name="attr_ecoleMagie_SelectALL" class="sheet-tab" value="1" checked="checked" /><span class="sheet-tab">Toutes</span>
					<br /><br />
					<fieldset class="repeating_EcolesMagie">
						<input type="checkbox" name="attr_EcoleMagie_Selected" class="sheet-tab" value="1" /><span class="sheet-tab" name="attr_EcoleMagie">&nbsp;</span>
						<input type="checkbox" name="attr_EcoleMagie_Modal" class="sheet-modal" value="1" /><span class="sheet-cog">y</span>
						<div class="sheet-modal-wrapper">
							<div class="sheet-modal">
								<div class="sheet-modal_header">
									<h2>Ecole de magie : <span class="sheet-close">*</span><input type="checkbox" class="sheet-modal" name="attr_EcoleMagie_Modal" value="1" /></h2>
								</div>
								<div class="sheet-modal_body sheet-center">
									<input type="text" class="sheet-noBorder" name="attr_EcoleMagie" value="Généraliste" />
								</div>
							</div>
						</div>
						<br />
						<br />
					</fieldset>
					<br clear="all" />
					<input type="hidden" name="attr_tab_EcoleMagie" class="sheet-tab" value="" />
					<input type="checkbox" name="attr_modal_HowToMagie" class="sheet-modal" value="1" /><span class="sheet-cog">?</span> <span class="sheet-hint"> Comment ça marche ?</span>
					<div class="sheet-modal-wrapper">
						<div class="sheet-modal">
							<div class="sheet-modal_header">
								<h2>La magie, comment ca marche ? <span class="sheet-close">*</span><input type="checkbox" class="sheet-modal" name="attr_modal_HowToMagie" value="1" /></h2>
							</div>
							<div class="sheet-modal_body">
								<b>Avant toute chose :</b><br />
								<ol>
									<li>Commencez par ajouter des écoles de magie dans la colonne de gauche</li>
									<li>Pour renommer une école, cliquez sur la roue dentée en face</li>
								</ol>
								<br />
								<b>Ajouter un sort :</b><br />
								<ol>
									<li>Créez un nouveau sort</li>
									<li>Inscrivez l'école de magie du sort (attention l'école de magie doit exister dans la liste de gauche !)</li>
									<li>Sélectionnez le niveau du sort</li>
									<li>Configurez votre sort (portée, épreuve, dégats...), il sera automatiquement associé à l'école et au niveau séléctionnés en cas de filtre.</li>
								</ol>
								<br />
								<b>Mon sort a disparu ? :</b><br />
								<ol>
									<li>Cochez la case "Toutes les écoles de magie"</li>
									<li>Vérifiez que l'école du sort est bien <b><u>strictement identique</u></b> à une des écoles de magie</li>
								</ol>
							</div>
						</div>
					</div>
				</div>
				<div class="sheet-col-10 sheet-center">
					<!--- Magic level --->
					<input type="radio" name="attr_tab_NiveauMagie" class="sheet-rounded-tab" value="0" checked="checked" title="Multi-niveau" /><span class="sheet-rounded-tab">M</span>
					<input type="radio" name="attr_tab_NiveauMagie" class="sheet-rounded-tab" value="1" /><span class="sheet-rounded-tab">1</span>
					<input type="radio" name="attr_tab_NiveauMagie" class="sheet-rounded-tab" value="2" /><span class="sheet-rounded-tab">2</span>
					<input type="radio" name="attr_tab_NiveauMagie" class="sheet-rounded-tab" value="3" /><span class="sheet-rounded-tab">3</span>
					<input type="radio" name="attr_tab_NiveauMagie" class="sheet-rounded-tab" value="4" /><span class="sheet-rounded-tab">4</span>
					<input type="radio" name="attr_tab_NiveauMagie" class="sheet-rounded-tab" value="5" /><span class="sheet-rounded-tab">5</span>
					<input type="radio" name="attr_tab_NiveauMagie" class="sheet-rounded-tab" value="6" /><span class="sheet-rounded-tab">6</span>
					<input type="radio" name="attr_tab_NiveauMagie" class="sheet-rounded-tab" value="7" /><span class="sheet-rounded-tab">7</span>
					<input type="radio" name="attr_tab_NiveauMagie" class="sheet-rounded-tab" value="8" /><span class="sheet-rounded-tab">8</span>
					<input type="radio" name="attr_tab_NiveauMagie" class="sheet-rounded-tab" value="9" /><span class="sheet-rounded-tab">9</span>
					<input type="radio" name="attr_tab_NiveauMagie" class="sheet-rounded-tab" value="10" /><span class="sheet-rounded-tab">10</span>
					<input type="radio" name="attr_tab_NiveauMagie" class="sheet-rounded-tab" value="11" /><span class="sheet-rounded-tab">11</span>
					<input type="radio" name="attr_tab_NiveauMagie" class="sheet-rounded-tab" value="12" /><span class="sheet-rounded-tab">12</span>
					<input type="radio" name="attr_tab_NiveauMagie" class="sheet-rounded-tab" value="13" /><span class="sheet-rounded-tab">13</span>
					<input type="radio" name="attr_tab_NiveauMagie" class="sheet-rounded-tab" value="14" /><span class="sheet-rounded-tab">14</span>
					<input type="radio" name="attr_tab_NiveauMagie" class="sheet-rounded-tab" value="15" /><span class="sheet-rounded-tab">15</span>
					<input type="radio" name="attr_tab_NiveauMagie" class="sheet-rounded-tab" value="all" title="Tous les niveaux" /><span class="sheet-rounded-tab">X</span>

					<br />
					<br />

					<!--- Magic bonus --->
					<div class="sheet-row sheet-hint">
						<div class="sheet-col-1"></div>
						<div class="sheet-col-4">Bonus d'intelligence aux dégats :</div>
						<div class="sheet-col-1"><input class="sheet-autoCalc" name="attr_bonusDegatsIntel" value="0" readonly type="text"></div>
						<div class="sheet-col-4">Bonus d'équipement aux dégats :</div>
						<div class="sheet-col-1"><input name="attr_bonusDegatsSorts" value="0" type="text"></div>
					</div>

					<!--- Magic spells --->
					<div class="sheet-section sheet-section-sp-list">
						<fieldset class="repeating_magies">
							<input type="checkbox" class="sheet-hidden sheet-magie-filtre" name="attr_Magie_Filtre" checked="checked" value="1" />

							<div class="sheet-magie-filtre sheet-group">
								<div class="sheet-row">
									<div class="sheet-col-4">
										<input type="text" class="sheet-noBorder" name="attr_Magie_Nom" value="" />
									</div>
									<div class="sheet-col-1">
										<b>Ecole </b>
									</div>
									<div class="sheet-col-2">
										<input type="text" class="sheet-noBorder" name="attr_Magie_Ecole" value="" />
									</div>
									<div class="sheet-col-3">
										<b>Niveau </b><select name="attr_Magie_Niveau">
											<option value="0">Multi</option>
											<option value="1">1</option>
											<option value="2">2</option>
											<option value="3">3</option>
											<option value="4">4</option>
											<option value="5">5</option>
											<option value="6">6</option>
											<option value="7">7</option>
											<option value="8">8</option>
											<option value="9">9</option>
											<option value="10">10</option>
											<option value="11">11</option>
											<option value="12">12</option>
											<option value="13">13</option>
											<option value="14">14</option>
											<option value="15">15</option>
										</select>
									</div>

									<div class="sheet-col-2">
										<button type="roll" name="roll_Grimoire" class="sheet-rollGrimoire" value="@{displayJet} &{template:magie} {{name=@{magie_nom}}} {{magie_ecole=@{magie_ecole}}} {{magie_niveau=@{magie_niveau}}} {{magie_display_epreuve=@{Magie_EpreuveLanceur_Jet}}} {{magie_display_resistance=@{Magie_EpreuveCible_Jet}}} {{magie_incantation=@{magie_incantation}}} {{magie_duree=@{magie_duree}}} {{magie_cout=@{magie_cout}}} {{magie_portee=@{magie_portee}}} {{magie_critique=@{magie_critique}}} {{magie_fumble=@{magie_fumble}}} {{magie_formule=@{magie_formule}}} {{magie_effet=@{magie_effet}}} {{magie_ingre=@{magie_ingre}}} {{magie_aireeffet=@{magie_aireeffet}}} {{magie_soin=@{magie_soin}}} {{magie_degats=@{Magie_Degats}}} {{magie_bonusint=[[@{MagieBonusInt}]]}} {{magie_epreuve=@{Magie_EpreuveLanceur_Jet} }} {{magie_resistance=@{Magie_EpreuveCible_Jet} + @{Magie_EpreuveCible_mod}}} {{creature_ev=@{creature_ev}}} {{creature_int=@{creature_int}}} {{creature_at=@{creature_at}}} {{creature_def=@{creature_def}}} {{creature_cou=@{creature_cou}}} {{creature_pr=@{creature_pr}}} {{creature_xp=@{creature_xp}}} {{creature_resimagie=@{creature_resimagie}}} {{creature_degats=@{creature_degats}}} {{magie_epreuveappel_mod=@{magie_epreuveappel_mod}}} {{magie_epreuvecontrol_mod=@{magie_epreuvecontrol_mod}}} {{magie_epreuverevocation_mod=@{magie_epreuverevocation_mod}}} {{magie_notes=@{magie_notes}}}"> Grimoire </button>
									</div>
								</div>
								<div class="sheet-row">
									<input type="checkbox" class="sheet-display-magie sheet-display-magie-incantation" name="attr_Magie_Display_Incantation" value="1" /> <span class="sheet-display-magie">Incantation</span>
									<input type="checkbox" class="sheet-display-magie sheet-display-magie-epreuve" name="attr_Magie_Display_Epreuve" value="1" /> <span class="sheet-display-magie">Épreuves</span>
									<input type="checkbox" class="sheet-display-magie sheet-display-magie-soins" name="attr_Magie_Display_Soins" value="1" /> <span class="sheet-display-magie">Soins</span>
									<input type="checkbox" class="sheet-display-magie sheet-display-magie-degats" name="attr_Magie_Display_Degats" value="1" /> <span class="sheet-display-magie">Dégats</span>
									<input type="checkbox" class="sheet-display-magie sheet-display-magie-effet" name="attr_Magie_Display_Effet" value="1" /> <span class="sheet-display-magie">Effets</span>
									<input type="checkbox" class="sheet-display-magie sheet-display-magie-ingre" name="attr_Magie_Display_Ingre" value="1" /> <span class="sheet-display-magie">Ingré.</span>
									<input type="checkbox" class="sheet-display-magie sheet-display-magie-creature" name="attr_Magie_Display_Creature" value="1" /> <span class="sheet-display-magie">Créature</span>
									<br clear="all" />
									<div class="sheet-display-magie-incantation">
										<br />
										<div class="sheet-row">
											<div class="sheet-col-2 sheet-bold">Incantation :</div>
											<div class="sheet-col-4"><input type="text" class="sheet-noBorder" name="attr_Magie_Incantation" value="" /></div>
											<div class="sheet-col-2 sheet-bold sheet-right">Durée :</div>
											<div class="sheet-col-4"><input type="text" class="sheet-noBorder" name="attr_Magie_Duree" value="" /></div>
										</div>
										<div class="sheet-row">
											<div class="sheet-col-2 sheet-bold">Portée :</div>
											<div class="sheet-col-4"><input type="text" class="sheet-noBorder" name="attr_Magie_Portee" value="" /></div>
											<div class="sheet-col-2 sheet-bold sheet-right">Aire d'éffet :</div>
											<div class="sheet-col-4"><input type="text" class="sheet-noBorder" name="attr_Magie_AireEffet" value="" /></div>
										</div>
										<div class="sheet-row">
											<div class="sheet-col-2 sheet-bold">Cout :</div>
											<div class="sheet-col-4"><input type="text" class="sheet-noBorder" name="attr_Magie_Cout" value="" /></div>
											<div class="sheet-col-2 sheet-bold sheet-right">Formule :</div>
											<div class="sheet-col-4"><input type="text" class="sheet-noBorder" name="attr_Magie_Formule" value="" /></div>
										</div>
										<div class="sheet-row">
											<div class="sheet-col-2 sheet-bold">Notes :</div>
											<div class="sheet-col-10"><textarea name="attr_Magie_Notes"></textarea></div>
										</div>
									</div>
									<div class="sheet-display-magie-epreuve">
										<br />
										<div class="sheet-row">
											<div class="sheet-col-2 sheet-bold">Lanceur :</div>
											<div class="sheet-col-1 sheet-bold">Stat.</div>
											<div class="sheet-col-3">
												<select name="attr_Magie_EpreuveLanceur_Jet">
													<option value="" selected="selected"></option>
													<option value="Magie Phy. : [[ @{Stats_MagiePhy_total} + @{magie_EpreuveLanceur_mod} ]]">Magie Phy.</option>
													<option value="Magie Psy. : [[ @{Stats_MagiePsy_total} + @{magie_EpreuveLanceur_mod} ]]">Magie Psy.</option>
													<option value="INT : [[ @{Stats_Intelligence_total} + @{magie_EpreuveLanceur_mod} ]]">INT</option>
													<option value="COU : [[ @{Stats_Courage_total} + @{magie_EpreuveLanceur_mod} ]]">COU</option>
													<option value="CHA : [[ @{Stats_Charisme_total} + @{magie_EpreuveLanceur_mod} ]]">CHA</option>
													<option value="AD : [[ @{Stats_Adresse_total} + @{magie_EpreuveLanceur_mod} ]]">AD</option>
													<option value="FO : [[ @{Stats_Force_total} + @{magie_EpreuveLanceur_mod} ]]">FO</option>
													<option value="AT : [[ @{Stats_Attaque_total} + @{magie_EpreuveLanceur_mod} ]]">AT</option>
													<option value="PRD : [[ @{Stats_Parade_total} + @{magie_EpreuveLanceur_mod} ]]">PRD</option>
												</select>
											</div>
											<div class="sheet-col-1 sheet-bold">Mod.</div>
											<div class="sheet-col-1">
												<input type="text" name="attr_Magie_EpreuveLanceur_mod" value="0" />
											</div>
											<div class="sheet-col-1"></div>
											<div class="sheet-col-2">
												<button type="roll" name="roll_Epreuve" value="@{displayJet} &{template:default} {{name=@{Personnage_Nom} se concentre pour lancer @{Magie_Nom} }} {{ Épreuve=@{Magie_EpreuveLanceur_Jet} }} {{ Résultat = [[1d20cs<1cf>20]] }}"> Épreuve </button>
											</div>
										</div>

										<div class="sheet-row">
											<div class="sheet-col-2 sheet-bold">Cible :</div>
											<div class="sheet-col-1 sheet-bold">Stat.</div>
											<div class="sheet-col-3">
												<select name="attr_Magie_EpreuveCible_Jet">
													<option value="" selected="selected"></option>
													<option value="Resist. Magie">Résist. Magie</option>
													<option value="Magie Phy.">Magie Phys.</option>
													<option value="Magie Psy.">Magie Psy.</option>
													<option value="INT">INT</option>
													<option value="COU">COU</option>
													<option value="CHA">CHA</option>
													<option value="AD">AD</option>
													<option value="FO">FO</option>
												</select>
											</div>
											<div class="sheet-col-1 sheet-bold">Mod.</div>
											<div class="sheet-col-1">
												<input type="text" name="attr_Magie_EpreuveCible_mod" value="0" />
											</div>
											<div class="sheet-col-1"></div>
											<div class="sheet-col-2">
												<button type="roll" name="roll_Confrontation" value="@{displayJet} &{template:default} {{name=Confrontation magique}} {{ @{Personnage_Nom}=@{Magie_EpreuveLanceur_Jet} }} {{ Cible = @{Magie_EpreuveCible_Jet} + @{Magie_EpreuveCible_mod} }}"> Confrontation </button>
											</div>
										</div>
									</div>
									<div class="sheet-display-magie-soins">
										<br />
										<div class="sheet-row">
											<div class="sheet-col-3 sheet-bold">
												Montant des soins :
											</div>
											<div class="sheet-col-3">
												<input type="text" name="attr_Magie_Soin" value="" placeholder="1d6" />
											</div>
											<div class="sheet-col-3">
											</div>
											<div class="sheet-col-2">
												<button type="roll" name="roll_Soin" class="sheet-rollDegats" value="@{displayJet} &{template:default} {{name=@{Magie_Nom} de @{Personnage_Nom} soigne à hauteur de }} {{EV = [[@{Magie_Soin}]] }}"> Soigner </button>
											</div>
										</div>
									</div>
									<div class="sheet-display-magie-degats">
										<br />
										<div class="sheet-row">
											<div class="sheet-col-3 sheet-bold">
												Montant des dégats :
											</div>
											<div class="sheet-col-3">
												<input type="text" name="attr_Magie_Degats" value="" placeholder="1d6" />
											</div>
											<div class="sheet-col-2 sheet-bold sheet-right">+ intel ?</div>
											<div class="sheet-col-1"><input type="checkbox" name="attr_MagieBonusInt" value="@{bonusDegatsIntel}" /></div>
											<div class="sheet-col-2">
												<button type="roll" name="roll_Degats" class="sheet-rollDegats" value="@{displayJet} &{template:default} {{name=Dégats de @{Personnage_Nom} avec @{Magie_Nom}}} {{Dégats = [[@{Magie_Degats}[Magie] + @{magieBonusInt}[Bonus Int] + @{bonusDegatsSorts}[Bonus Equipement]]] }}"> Dégats </button>
											</div>
										</div>
									</div>
									<div class="sheet-display-magie-effet">
										<br />
										<div class="sheet-row">
											<div class="sheet-col-2 sheet-bold">Effets :</div>
											<div class="sheet-col-10"><textarea name="attr_Magie_Effet"></textarea></div>
										</div>
										<div class="sheet-row">
											<div class="sheet-col-2 sheet-bold">Critique :</div>
											<div class="sheet-col-4"> <input type="text" class="sheet-noBorder" name="attr_Magie_Critique" value="" /></div>
											<div class="sheet-col-2 sheet-bold">Échec critique :</div>
											<div class="sheet-col-4"> <input type="text" class="sheet-noBorder" name="attr_Magie_Fumble" value="" /></div>
										</div>
									</div>
									<div class="sheet-display-magie-ingre">
										<br />
										<div class="sheet-row">
											<div class="sheet-col-2 sheet-bold">Ingrédients :</div>
											<div class="sheet-col-10"><textarea name="attr_Magie_Ingre"></textarea></div>
										</div>
									</div>
									<div class="sheet-display-magie-creature">
										<br />
										<div class="sheet-row">
											<div class="sheet-col-1"></div>
											<div class="sheet-col-1 sheet-bold">INT</div>
											<div class="sheet-col-1"><input type="number" name="attr_Creature_INT" value="" /></div>
											<div class="sheet-col-1"></div>
											<div class="sheet-col-1 sheet-bold">COU</div>
											<div class="sheet-col-1"><input type="number" name="attr_Creature_COU" value="" /></div>
											<div class="sheet-col-1"></div>
											<div class="sheet-col-1 sheet-bold">AT</div>
											<div class="sheet-col-1"><input type="number" name="attr_Creature_AT" value="" /></div>
											<div class="sheet-col-1"></div>
											<div class="sheet-col-1 sheet-bold">PR</div>
											<div class="sheet-col-1"><input type="number" name="attr_Creature_PR" value="" /></div>
										</div>
											<div class="sheet-row">
											<div class="sheet-col-2 sheet-bold">Énergie vitale</div>
											<div class="sheet-col-1"><input type="number" name="attr_Creature_EV" value="" /></div>
											<div class="sheet-col-2 sheet-bold sheet-right">PRD / Esquive</div>
											<div class="sheet-col-1"><input type="number" name="attr_Creature_DEF" value="" /></div>
											<div class="sheet-col-2 sheet-bold sheet-right">Classe/XP</div>
											<div class="sheet-col-1"><input type="number" name="attr_Creature_XP" value="" /></div>
											<div class="sheet-col-2 sheet-bold sheet-right">Résist. Magie</div>
											<div class="sheet-col-1"><input type="number" name="attr_Creature_ResiMagie" value="" /></div>
										</div>
										<div class="sheet-row">
											<div class="sheet-col-2 sheet-bold">Dégâts</div>
											<div class="sheet-col-2"><input type="text" name="attr_Creature_Degats" value="1d6" /></div>
											<div class="sheet-col-2"><button type="roll" class="sheet-rollDegats" value="@{displayJet} &{template:default} {{name=Attaque de @{Magie_Nom}, invoqué par @{Personnage_Nom} }} {{ Dégats = [[@{Creature_Degats}]] }}"> Dégats </button></div>
										</div>
										<br />
										<div class="sheet-row">
											<div class="sheet-col-4 sheet-bold">Épreuve d'Appel :</div>
											<div class="sheet-col-2">Magie Psy. + </div>
											<div class="sheet-col-1"><input type="number" name="attr_Magie_EpreuveAppel_mod" value="0" /></div>
											<div class="sheet-col-2"></div>
											<div class="sheet-col-2"><button type="roll" value="@{displayJet} &{template:default} {{name=@{Personnage_Nom} tente d'appeler @{Magie_Nom} }} {{Épreuve=@{Stats_MagiePsy_total} + [[@{Magie_EpreuveAppel_mod}]] }} {{ Résultat = [[1d20cs<1cf>20]] }}"> Épreuve </button></div>
										</div>
										<div class="sheet-row">
											<div class="sheet-col-4 sheet-bold">Épreuve de Contrôle :</div>
											<div class="sheet-col-2">Magie Psy. + </div>
											<div class="sheet-col-1"><input type="text" name="attr_Magie_EpreuveControl_mod" value="2D6" /></div>
											<div class="sheet-col-2 sheet-hint">vs 2D6 + RM</div>
											<div class="sheet-col-2"><button type="roll" value="@{displayJet} &{template:default} {{name=@{Personnage_Nom} tente de controler @{Magie_Nom} }} {{ @{Personnage_Nom}=@{Stats_MagiePsy_total} + [[@{Magie_EpreuveControl_mod}]] }} {{ Cible = Résist. Magie + 2D6 }} "> Confrontation </button></div>
										</div>
										<div class="sheet-row">
											<div class="sheet-col-4 sheet-bold">Épreuve de Révocation :</div>
											<div class="sheet-col-2">Magie Psy. + </div>
											<div class="sheet-col-1"><input type="text" name="attr_Magie_EpreuveRevocation_mod" value="3D6" /></div>
											<div class="sheet-col-2 sheet-hint">vs 3D6 + RM</div>
											<div class="sheet-col-2"><button type="roll" value="@{displayJet} &{template:default} {{name=@{Personnage_Nom} tente de révoquer @{Magie_Nom} }} {{ @{Personnage_Nom}=@{Stats_MagiePsy_total} + [[@{Magie_EpreuveRevocation_mod}]] }} {{ Cible = Résist. Magie + 3D6 }} "> Confrontation </button></div>
										</div>
									</div>
								</div>
							</div>
						</fieldset>
					</div>
					<br clear="all" />
				</div>
			</div>
		</div>

		<!-- TAB Inventaire -->
		<div class="sheet-tab_inventaire">
			<div class="sheet-row">
				<div class="sheet-col-3">
					<h2>Mes richesses</h2>
					<div class="sheet-row">
						<div class="sheet-col-8 sheet-bold">Pièces d'Or</div>
						<div class="sheet-col-4"><input type="number" name="attr_Richesse_Or" value="0" /></div>
					</div>
					<div class="sheet-row">
						<div class="sheet-col-8 sheet-bold">Pièces d'Argent</div>
						<div class="sheet-col-4"><input type="number" name="attr_Richesse_Argent" value="0" /></div>
					</div>
					<div class="sheet-row">
						<div class="sheet-col-8 sheet-bold">Pièces de Cuivre</div>
						<div class="sheet-col-4"><input type="number" name="attr_Richesse_Cuivre" value="0" /></div>
					</div>
					<br />
					<div class="sheet-row">
						<div class="sheet-col-8 sheet-bold">Lingots de Berylium</div>
						<div class="sheet-col-4"><input type="number" name="attr_Richesse_Berylium" value="0" /></div>
					</div>
					<div class="sheet-row">
						<div class="sheet-col-8 sheet-bold">Lingots de Thritil</div>
						<div class="sheet-col-4"><input type="number" name="attr_Richesse_Thritil" value="0" /></div>
					</div>
					<br />
					<div class="sheet-row">
						<div class="sheet-col-8 sheet-bold">Billets 10</div>
						<div class="sheet-col-4"><input type="number" name="attr_Richesse_Billet10" value="0" /></div>
					</div>
					<div class="sheet-row">
						<div class="sheet-col-8 sheet-bold">Billets 50</div>
						<div class="sheet-col-4"><input type="number" name="attr_Richesse_Billet50" value="0" /></div>
					</div>
					<div class="sheet-row">
						<div class="sheet-col-8 sheet-bold">Billets 100</div>
						<div class="sheet-col-4"><input type="number" name="attr_Richesse_Billet100" value="0" /></div>
					</div>
					<div class="sheet-row">
						<div class="sheet-col-8 sheet-bold">Billets 500</div>
						<div class="sheet-col-4"><input type="number" name="attr_Richesse_Billet500" value="0" /></div>
					</div>
					<div class="sheet-row">
						<div class="sheet-col-8 sheet-bold">Billets 1000</div>
						<div class="sheet-col-4"><input type="number" name="attr_Richesse_Billet1000" value="0" /></div>
					</div>
					<br />
					<div class="sheet-row">
						<div class="sheet-col-8 sheet-bold">Total (en Or)</div>
						<div class="sheet-col-4"><input type="text" class="sheet-autoCalc" name="attr_Richesse_Total" value="0" readonly></div>
					</div>
					<div class="sheet-row">
						<div class="sheet-col-8 sheet-bold">Banque (en Or)</div>
						<div class="sheet-col-4"><input type="number" name="attr_Richesse_EnBanque" value="0" /></div>
					</div>
				</div>
				<div class="sheet-col-9">
					<div class="sheet-row">
						<div class="sheet-col-7">
							<h2>Bivouac & Camping</h2>
							<div class="sheet-row">
								<div class="sheet-col-6"></div>
								<div class="sheet-col-6 sheet-tableth sheet-bold sheet-center">Récup.</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-6"><input type="text" class="sheet-noBorder" name="attr_bivouac_Couverture" value="" placeholder="Couverture" /></div>
								<div class="sheet-col-6"><input type="text" class="sheet-noBorder" name="attr_bivouac_Couverture_Recup" value="" placeholder="1EV / 2H - 3EA / 1H" /></div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-6"><input type="text" class="sheet-noBorder" name="attr_bivouac_Matelas" value="" placeholder="Matelas" /></div>
								<div class="sheet-col-6"><input type="text" class="sheet-noBorder" name="attr_bivouac_Matelas_Recup" value="" /></div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-6"><input type="text" class="sheet-noBorder" name="attr_bivouac_Tente" value="" placeholder="Tente" /></div>
								<div class="sheet-col-6"><input type="text" class="sheet-noBorder" name="attr_bivouac_Tente_Recup" value="" /></div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-12 sheet-hint">Récup. : <span class="sheet-pointer" title="+1 EV pour 4H de repos&#10;+2 EA pour 1H de repos">Basse</span>, <span class="sheet-pointer" title="+1 EV pour 2H de repos&#10;+3 EA pour 1H de repos">Normale</span>, <span class="sheet-pointer" title="+1 EV pour 1H de repos&#10;+4 EA pour 1H de repos">Excellente</span></div>
							</div>
						</div>

						<div class="sheet-col-5">
							<h2>Encombrement</h2>
							<div class="sheet-row" title="Selon Origine du personnage">
								<div class="sheet-col-4 sheet-bold">Charge max</div>
								<div class="sheet-col-3"><input type="number" name="attr_Personnage_Charge_max" value="0" /> </div>
								<div class="sheet-col-4"> KG</div>
								<div class="sheet-col-1">
									<input type="checkbox" name="attr_modal_HowToChargeMax" class="sheet-modal" value="1"><span class="sheet-cog">?</span>
									<div class="sheet-modal-wrapper">
										<div class="sheet-modal">
											<div class="sheet-modal_header">
												<h2>La charge max ? <span class="sheet-close">*</span><input type="checkbox" class="sheet-modal" name="attr_modal_HowToChargeMax" value="1"></h2>
											</div>
											<div class="sheet-modal_body">
												<p>La charge max dépend de l'Origine et / ou du Métier du personnage :</p>
												<ul>
													<li>Gnôme : 2 kilos</li>
													<li>Gobelin : 10 kilos</li>
													<li>Semi-Homme : 10 kilos</li>
													<li>Haut Elfe : 10 kilos</li>
													<li>Elfe Sylvain : 10 kilos</li>
													<li>Elfe Noir : 15 kilos</li>
													<li>Demi-Elfe : 15 kilos</li>
													<li>Mage : 10 kilos (ou moins selon origine)</li>
												</ul>
												<p>Pour les autres Origines / Métiers, la charge max dépendra de la Force</p>
												<ul>
													<li>FO 8 : 10 kilos</li>
													<li>FO 9 : 15 kilos</li>
													<li>FO 10 : 20 kilos</li>
													<li>FO 11 : 25 kilos</li>
													<li>FO 12 : 30 kilos</li>
													<li>FO 13 : 35 kilos</li>
													<li>FO 14 : 40 kilos</li>
													<li>FO 15 : 45 kilos</li>
												</ul>
												<p>Attention, au dela de 50 kilos le personnage ne pourra plus bouger (sauf Ogre, à l'appréciation du MJ).</p>
											</div>
										</div>
									</div>
								</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-4 sheet-bold">Bourses</div>
								<div class="sheet-col-3"><input type="text" class="sheet-autoCalc" name="attr_poids_Bourses" value="0" readonly /></div>
								<div class="sheet-col-3"><input type="text" class="sheet-autoCalc" name="attr_poids_Bourses_max" value="0" readonly /></div>
								<div class="sheet-col-2">Pièces</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-4 sheet-bold">Sacs</div>
								<div class="sheet-col-3"><input type="text" class="sheet-autoCalc" name="attr_poids_Sacs" value="0" readonly /></div>
								<div class="sheet-col-3"><input type="text" class="sheet-autoCalc" name="attr_poids_Sacs_max" value="0" readonly /></div>
								<div class="sheet-col-2">Kg</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-12">
									<!--- cs trick for loading bar --->
									<input type="radio" value="0" name="attr_Personnage_Surcharge" class="sheet-hidden sheet-overweight-checkbox sheet-overweight-0" checked>
									<input type="radio" value="1" name="attr_Personnage_Surcharge" class="sheet-hidden sheet-overweight-checkbox sheet-overweight-1">
									<input type="radio" value="2" name="attr_Personnage_Surcharge" class="sheet-hidden sheet-overweight-checkbox sheet-overweight-2">
									<input type="radio" value="3" name="attr_Personnage_Surcharge" class="sheet-hidden sheet-overweight-checkbox sheet-overweight-3">
									<input type="radio" value="4" name="attr_Personnage_Surcharge" class="sheet-hidden sheet-overweight-checkbox sheet-overweight-4">
									<input type="radio" value="5" name="attr_Personnage_Surcharge" class="sheet-hidden sheet-overweight-checkbox sheet-overweight-5">
									<div class="sheet-overweight">
									</div>
								</div>
							</div>
						</div>
					</div>
					<br />
					<div class="sheet-row">
						<h2>Sacs & Bourses</h2>
						<div class="sheet-col-6">
							<div class="sheet-tableth sheet-row">
								<div class="sheet-col-9">Sacs</div>
								<div class="sheet-col-3">Poids max</div>
							</div>
							<fieldset class="repeating_sacs">
								<div class="sheet-row">
									<div class="sheet-col-9">
										<input type="text" class="sheet-noBorder" name="attr_Sac_Nom" value="" />
									</div>
									<div class="sheet-col-3">
										<input type="number" name="attr_Sac_Charge_max" value="0" />
									</div>
								</div>
							</fieldset>
						</div>
						<div class="sheet-col-6">
							<div class="sheet-tableth sheet-row">
								<div class="sheet-col-9">Bourses</div>
								<div class="sheet-col-3">Pièces max</div>
							</div>
							<fieldset class="repeating_bourses">
								<div class="sheet-row">
									<div class="sheet-col-9">
										<input type="text" class="sheet-noBorder" name="attr_Bourse_Nom" value="" />
									</div>
									<div class="sheet-col-3">
										<input type="number" name="attr_Bourse_Charge_max" value="0" />
									</div>
								</div>
							</fieldset>
						</div>
					</div>
				</div>
			</div>

			<br clear="all" />
			<br />

			<input type="radio" class="sheet-tab sheet-tab_materiel" name="attr_tab_inventaire" value="Matériel" checked="checked" /><span class="sheet-tab">Matériel</span>
			<input type="radio" class="sheet-tab sheet-tab_butin" name="attr_tab_inventaire" value="Butins" /><span class="sheet-tab">Butins</span>
			<input type="radio" class="sheet-tab sheet-tab_divers" name="attr_tab_inventaire" value="Divers" title="Bouffe, Boissons, Gemmes, Objets de quête, Livres" /><span class="sheet-tab">Divers</span>
			<input type="radio" class="sheet-tab sheet-tab_conso" name="attr_tab_inventaire" value="Potions" title="Potions / Poisons / Antidotes" /><span class="sheet-tab">Potions</span>
			<input type="radio" class="sheet-tab sheet-tab_ingre" name="attr_tab_inventaire" value="Ingrédients" /><span class="sheet-tab">Ingrédients</span>
			<input type="radio" class="sheet-tab sheet-tab_reliques" name="attr_tab_inventaire" value="Spéciaux" title="Objets spéciaux, Maudits, Reliques" /><span class="sheet-tab">Objets spéciaux</span>
			<input type="radio" class="sheet-tab sheet-tab_tout" name="attr_tab_inventaire" value="Tout" title="Tout afficher" /><span class="sheet-tab">Tout afficher</span>

			<br clear="all" />
			<br />

			<div class="sheet-tab_materiel">
				<div class="sheet-row">
					<div class="sheet-col-1 sheet-center">
						<img src="https://i49.servimg.com/u/f49/19/87/23/15/materi10.png" width="34" height="34" />
					</div>
					<div class="sheet-col-11">
						<div class="sheet-tableth sheet-row">
							<div class="sheet-col-5">Matériel</div>
							<div class="sheet-col-1">Poids</div>
							<div class="sheet-col-5"></div>
							<div class="sheet-col-1">Poids</div>
						</div>
						<div class="sheet-row">
							<fieldset class="repeating_materiels">
								<div class="sheet-col-10">
									<input type="text" class="sheet-noBorder" name="attr_Materiel_Nom" value="" />
								</div>
								<div class="sheet-col-2">
									<input type="number" name="attr_Materiel_Poids" value="0.1" step="0.1" />
								</div>
							</fieldset>
						</div>
					</div>
				</div>
				<br />
			</div>

			<div class="sheet-tab_butin">
				<div class="sheet-row">
					<div class="sheet-col-1 sheet-center">
						<img src="https://i49.servimg.com/u/f49/19/87/23/15/butin10.png" width="34" height="34" />
					</div>
					<div class="sheet-col-11">
						<div class="sheet-tableth sheet-row">
							<div class="sheet-col-5">Butins</div>
							<div class="sheet-col-1">Poids</div>
							<div class="sheet-col-5"></div>
							<div class="sheet-col-1">Poids</div>
						</div>
						<div class="sheet-row">
							<fieldset class="repeating_butins">
								<div class="sheet-col-10">
									<input type="text" class="sheet-noBorder" name="attr_Butin_Nom" value="" />
								</div>
								<div class="sheet-col-2">
									<input type="number" name="attr_Butin_Poids" value="0.1" step="0.1" />
								</div>
							</fieldset>
						</div>
					</div>
				</div>
				<br />
			</div>

			<div class="sheet-tab_divers">
				<div class="sheet-row">
					<div class="sheet-col-1 sheet-center">
						<img src="https://i49.servimg.com/u/f49/19/87/23/15/bouffe10.png" width="34" height="34" />
					</div>
					<div class="sheet-col-5">
						<div class="sheet-tableth sheet-row">
							<div class="sheet-col-10">Bouffe & Boisson</div>
							<div class="sheet-col-2">Poids</div>
						</div>
						<fieldset class="repeating_bouffes">
							<div class="sheet-row">
								<div class="sheet-col-10">
									<input type="text" class="sheet-noBorder" name="attr_Bouffe_Nom" value="" />
								</div>
								<div class="sheet-col-2">
									<input type="number" name="attr_Bouffe_Poids" value="0.1" step="0.1" />
								</div>
							</div>
						</fieldset>
					</div>

					<div class="sheet-col-5">
						<div class="sheet-tableth sheet-row">
							<div class="sheet-col-10">Gemmes</div>
							<div class="sheet-col-2">U.G</div>
						</div>

						<fieldset class="repeating_gemmes">
							<div class="sheet-row">
								<div class="sheet-col-10">
									<input type="text" class="sheet-noBorder" name="attr_Gemme_Nom" value="" />
								</div>
								<div class="sheet-col-2">
									<input type="number" name="attr_Gemme_UG" value="" />
								</div>
							</div>
						</fieldset>
					</div>
					<div class="sheet-col-1 sheet-center">
						<img src="https://i49.servimg.com/u/f49/19/87/23/15/gemme10.png" width="34" height="34" />
					</div>
				</div>

				<br />
				<div class="sheet-row">
					<div class="sheet-col-1 sheet-center">
						<img src="https://i49.servimg.com/u/f49/19/87/23/15/quete10.png" width="34" height="34" />
					</div>
					<div class="sheet-col-5">
						<div class="sheet-tableth sheet-row">
							<div class="sheet-col-12">Objets de Quête</div>
						</div>
						<fieldset class="repeating_quetes">
							<div class="sheet-row">
								<div class="sheet-col-12">
									<input type="text" class="sheet-noBorder" name="attr_Quete_Nom" value="" />
								</div>
							</div>
						</fieldset>
					</div>

					<div class="sheet-col-5">
						<div class="sheet-tableth sheet-row">
							<div class="sheet-col-12">Livres (500 gr)</div>
						</div>
						<fieldset class="repeating_livres">
							<div class="sheet-row">
								<div class="sheet-col-12">
									<input type="text" class="sheet-noBorder" name="attr_Livre_Nom" value="" />
								</div>
							</div>
						</fieldset>
					</div>
					<div class="sheet-col-1 sheet-center">
						<img src="https://i49.servimg.com/u/f49/19/87/23/15/livre10.png" width="34" height="34" />
					</div>
				</div>
				<br />
			</div>

			<div class="sheet-tab_conso">
				<div class="sheet-row">
					<div class="sheet-col-1 sheet-center">
						<img src="https://i49.servimg.com/u/f49/19/87/23/15/potion10.png" width="34" height="34" />
					</div>
					<div class="sheet-col-11">
						<div class="sheet-tableth sheet-row">
							<div class="sheet-col-5">Potions</div>
							<div class="sheet-col-1">Doses</div>
							<div class="sheet-col-6">Effets</div>
						</div>
						<fieldset class="repeating_potions">
							<div class="sheet-row">
								<div class="sheet-col-5">
									<input type="text" class="sheet-noBorder" name="attr_Conso_Nom" value="" />
								</div>
								<div class="sheet-col-1">
									<input type="number" name="attr_Conso_Count" value="0" />
								</div>
								<div class="sheet-col-6">
									<input type="text" class="sheet-noBorder" name="attr_Conso_Effet" value="" />
								</div>
							</div>
						</fieldset>
					</div>
				</div>

				<br />
				<div class="sheet-row">
					<div class="sheet-col-1 sheet-center">
						<img src="https://i49.servimg.com/u/f49/19/87/23/15/poison10.png" width="34" height="34" />
					</div>
					<div class="sheet-col-11">
						<div class="sheet-tableth sheet-row">
							<div class="sheet-col-5">Poisons</div>
							<div class="sheet-col-1">Doses</div>
							<div class="sheet-col-6">Effets</div>
						</div>
						<fieldset class="repeating_poisons">
							<div class="sheet-row">
								<div class="sheet-col-5">
									<input type="text" class="sheet-noBorder" name="attr_Conso_Nom" value="" />
								</div>
								<div class="sheet-col-1">
									<input type="number" name="attr_Conso_Count" value="0" />
								</div>
								<div class="sheet-col-6">
									<input type="text" class="sheet-noBorder" name="attr_Conso_Effet" value="" />
								</div>
							</div>
						</fieldset>
					</div>
				</div>

				<br />
				<div class="sheet-row">
					<div class="sheet-col-1 sheet-center">
						<img src="https://i49.servimg.com/u/f49/19/87/23/15/antido10.png" width="34" height="34" />
					</div>
					<div class="sheet-col-11">
						<div class="sheet-tableth sheet-row">
							<div class="sheet-col-5">Antidotes</div>
							<div class="sheet-col-1">Doses</div>
							<div class="sheet-col-6">Effets</div>
						</div>
						<fieldset class="repeating_antidotes">
							<div class="sheet-row">
								<div class="sheet-col-5">
									<input type="text" class="sheet-noBorder" name="attr_Conso_Nom" value="" />
								</div>
								<div class="sheet-col-1">
									<input type="number" name="attr_Conso_Count" value="0" />
								</div>
								<div class="sheet-col-6">
									<input type="text" class="sheet-noBorder" name="attr_Conso_Effet" value="" />
								</div>
							</div>
						</fieldset>
					</div>
				</div>
				<br />
			</div>

			<div class="sheet-tab_ingre">
				<div class="sheet-row">
					<div class="sheet-col-1 sheet-center">
						<img src="https://i49.servimg.com/u/f49/19/87/23/15/ingred10.png" width="34" height="34" />
					</div>
					<div class="sheet-col-11">
						<div class="sheet-tableth sheet-row">
							<div class="sheet-col-5">Ingrédients</div>
							<div class="sheet-col-1">NB</div>
							<div class="sheet-col-5"></div>
							<div class="sheet-col-1">NB</div>
						</div>
						<div class="sheet-row">
							<fieldset class="repeating_ingre">
								<div class="sheet-col-10">
									<input type="text" class="sheet-noBorder" name="attr_Ingre_Nom" value="" />
								</div>
								<div class="sheet-col-2">
									<input type="number" name="attr_Ingre_Count" value="0" />
								</div>
							</fieldset>
						</div>
					</div>
				</div>
				<br />
			</div>

			<div class="sheet-tab_reliques">
				<div class="sheet-row">
					<div class="sheet-col-1 sheet-center">
						<img src="https://i49.servimg.com/u/f49/19/87/23/15/reliqu10.png" width="34" height="34" />
					</div>
					<div class="sheet-col-11">
						<div class="sheet-tableth sheet-row">
							<div class="sheet-col-6">Objets spéciaux, Maudits, Reliques</div>
							<div class="sheet-col-6">Effets</div>
						</div>
						<fieldset class="repeating_reliques">
							<div class="sheet-row">
								<div class="sheet-col-6">
									<input type="text" class="sheet-noBorder" name="attr_Relique_Nom" value="" />
								</div>
								<div class="sheet-col-6">
									<input type="text" class="sheet-noBorder" name="attr_Relique_Effet" value="" />
								</div>
							</div>
						</fieldset>
					</div>
				</div>
			</div>
			<br />
		</div>

		<!-- TAB Craft -->
		<div class="sheet-tab_craft">
			<input class="sheet-display sheet-display-reparation" name="attr_displayReparation" value="1" checked="checked" type="checkbox">
			<h2 class="sheet-display">Réparations</h2>
			<div class="sheet-display-reparation">
				<div class="sheet-row sheet-tableth">
					<div class="sheet-col-3">Qualité ?</div>
					<div class="sheet-col-3">Spécialiste ?</div>
					<div class="sheet-col-3">Mod.</div>
					<div class="sheet-col-3">Épreuve</div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-3 sheet-center">
						<select name="attr_Reparation_Qualite">
							<option value="0" selected="selected"></option>
							<option value="1">Matériel perrave</option>
							<option value="2">Matériel de base</option>
							<option value="3">Matériel de correct</option>
							<option value="4">Matériel de qualité</option>
							<option value="5">Matériel de luxe</option>
							<option value="6">Matériel d'artisan</option>
						</select>
					</div>
					<div class="sheet-col-3 sheet-center"><input type="checkbox" name="attr_Reparation_Specialiste" value="1"></div>
					<div class="sheet-col-1"></div>
					<div class="sheet-col-1 sheet-center"><input type="number" name="attr_Reparation_Mod" value="0"></div>
					<div class="sheet-col-1"></div>
					<div class="sheet-col-3 sheet-center">
					<input type="hidden" name="attr_Reparation_Bonus" value="0">
						<input type="hidden" name="attr_Reparation_Difficulte" value="0">
						<input type="checkbox" name="attr_Reparation_impossible" value="1" class="sheet-hidden sheet-reparation-impossible">
						<div class="sheet-reparation-epreuve">
							<button type="roll" name="roll_Reparation" value="@{displayJet} &{template:default} {{name=@{Personnage_Nom} tente de réparer un objet }} {{ Difficulté = @{reparation_difficulte} }}{{ Ingéniosité= [[ @{stats_inge_total}[Ingéniosité] + @{reparation_bonus}[Bonus] + @{reparation_mod}[Mod.] ]] }} {{ Résultat = [[1d20cs<1cf>20]] }}"> Réparation </button>
						</div>
						<div class="sheet-reparation-impossible">
							<span class="sheet-hint">Réparation impossible</span>
						</div>
					</div>
				</div>
			</div>
			<br />
			<input class="sheet-display sheet-display-confection" name="attr_displayConfection" value="1" checked="checked" type="checkbox">
			<h2 class="sheet-display">Confection rapide</h2>
			<div class="sheet-display-confection">
				<div class="sheet-row sheet-tableth">
					<div class="sheet-col-3"></div>
					<div class="sheet-col-3">Difficulté</div>
					<div class="sheet-col-3">Mod.</div>
					<div class="sheet-col-3">Épreuve</div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-4"></div>
					<div class="sheet-col-1 sheet-center"><input type="number" name="attr_Confection_Difficulte" value="0"></div>
					<div class="sheet-col-2"></div>
					<div class="sheet-col-1 sheet-center"><input type="number" name="attr_Confection_Mod" value="0"></div>
					<div class="sheet-col-1"></div>
					<div class="sheet-col-3 sheet-center"><button type="roll" name="roll_Confection" value="@{displayJet} &{template:default} {{name=@{Personnage_Nom} tente de fabriquer un objet }} {{ Ingéniosité=[[ @{stats_inge_total}[Ingéniosité] + ( @{stats_inge_total}[Ingéniosité] - @{confection_difficulte}[Difficulté] ) + @{confection_mod}[Mod.] ]] }} {{ Résultat = [[1d20cs<1cf>20]] }}"> Confection </button></div>
				</div>
			</div>
			<br />
			<input class="sheet-display sheet-display-recettes" name="attr_displayRecettes" value="1" checked="checked" type="checkbox">
			<h2 class="sheet-display">Recettes</h2>
			<div class="sheet-display-recettes">
				<fieldset class="repeating_recettes">
					<div class="sheet-recette-filtre">
						<div class="sheet-row">
							<div class="sheet-col-4">
								<input type="text" class="sheet-noBorder" name="attr_Recette_Nom" value="" />
							</div>
							<div class="sheet-col-1 sheet-bold">Desc.</div>
							<div class="sheet-col-5"><input type="text" class="sheet-noBorder" name="attr_Recette_effet" value="" /></div>
							<div class="sheet-col-2">
								<button type="roll" name="roll_Grimoire" class="sheet-rollGrimoire" value="@{displayJet} &{template:recette} {{recette_nom=@{recette_nom}}} {{recette_effet=@{recette_effet}}} {{recette_niveau=@{recette_niveau}}} {{recette_resultats=@{recette_resultats}}} {{recette_materiaux=@{recette_materiaux}}} {{recette_materiauxspe=@{recette_materiauxspe}}} {{recette_duree=@{recette_duree}}} {{recette_outils=@{recette_outils}}} {{recette_difficulte=@{recette_difficulte}}} {{recette_xp=@{recette_xp}}} {{recette_prix=@{recette_prix}}} {{recette_prixfabrication=@{recette_prixfabrication}}}"> Recette </button>
							</div>
						</div>
						<br />
						<div class="sheet-row">
							<input type="checkbox" class="sheet-display-recette sheet-display-recette-preparation" name="attr_Recette_Display_Preparation" value="1" /> <span class="sheet-display-recette">Préparation</span>
							<input type="checkbox" class="sheet-display-recette sheet-display-recette-epreuve" name="attr_Recette_Display_Epreuve" value="1" /> <span class="sheet-display-recette">Épreuve</span>
							<input type="checkbox" class="sheet-display-recette sheet-display-recette-results" name="attr_Recette_Display_Results" value="1" /> <span class="sheet-display-recette">Résultats</span>
							<br clear="all" />

							<div class="sheet-display-recette-preparation">
								<br />
								<div class="sheet-row">
									<div class="sheet-col-2 sheet-bold">Spécialiste ?</div>
									<div class="sheet-col-1"><input type="checkbox" name="attr_Recette_Specialiste" value="1" /></div>
									<div class="sheet-col-2 sheet-bold sheet-right">Niveau requis</div>
									<div class="sheet-col-1"><input type="number" name="attr_Recette_Niveau" value="1" /></div>
									<div class="sheet-col-1"></div>
									<div class="sheet-col-1 sheet-bold sheet-right">XP</div>
									<div class="sheet-col-1"><input type="number" name="attr_Recette_Xp" value="0" /></div>
								</div>
								<div class="sheet-row">
									<div class="sheet-col-2 sheet-bold">Durée confection</div>
									<div class="sheet-col-4"><input type="text" class="sheet-noBorder" name="attr_Recette_Duree" value="" /></div>
									<div class="sheet-col-2 sheet-bold sheet-right">Outils</div>
									<div class="sheet-col-4"><input type="text" class="sheet-noBorder" name="attr_Recette_Outils" value="" /></div>
								</div>
								<hr />
								<div class="sheet-row">
									<div class="sheet-col-4 sheet-bold">Matériaux</div>
									<div class="sheet-col-4 sheet-bold">Matériaux spéciaux</div>
									<div class="sheet-col-4 sheet-bold">Bonus Assistant</div>
								</div>
								<div class="sheet-row">
									<div class="sheet-col-4"><textarea name="attr_Recette_Materiaux"></textarea></div>
									<div class="sheet-col-4"><textarea name="attr_Recette_MateriauxSpe"></textarea></div>
									<div class="sheet-col-4"><textarea name="attr_Recette_Assistant"></textarea></div>
								</div>
							</div>
							<div class="sheet-display-recette-epreuve">
								<br />
								<div class="sheet-row">
									<div class="sheet-col-1 sheet-bold">Difficulté</div>
									<div class="sheet-col-1"><input type="number" name="attr_Recette_Difficulte" value="0" /></div>
									<div class="sheet-col-3 sheet-bold sheet-right">Malus non-spécialiste</div>
									<div class="sheet-col-1"><input type="number" name="attr_Recette_MalusSpecialiste" value="0" /></div>
									<div class="sheet-col-1"></div>
									<div class="sheet-col-1 sheet-bold">Mod.</div>
									<div class="sheet-col-1"><input type="number" name="attr_Recette_Mod" value="0" /></div>
									<div class="sheet-col-1"></div>
									<div class="sheet-col-1">
										<input type="hidden" name="attr_Recette_Bonus" value="0" />
										<button type="roll" name="roll_Confection" value="@{displayJet} &{template:default} {{name=@{Personnage_Nom} tente de fabriquer un(e) @{Recette_Nom} }} {{ Ingéniosité=[[ @{stats_inge_total}[Ingéniosité] + @{recette_bonus}[Bonus recette] + @{recette_mod}[Mod.] ]] }} {{ Résultat = [[1d20cs<1cf>20]] }}"> Confection </button>
									</div>
								</div>
							</div>
							<div class="sheet-display-recette-results">
								<br />
								<div class="sheet-row">
									<div class="sheet-col-2 sheet-bold">Résultats</div>
									<div class="sheet-col-10"><textarea name="attr_Recette_Resultats"></textarea></div>
								</div>
								<div class="sheet-row">
									<div class="sheet-col-2 sheet-bold">Prix :</div>
									<div class="sheet-col-2 sheet-bold sheet-right">de Fabrication</div>
									<div class="sheet-col-2"><input type="text" class="sheet-noBorder" name="attr_Recette_PrixFabrication" value="0"></div>
									<div class="sheet-col-1"></div>
									<div class="sheet-col-2 sheet-bold sheet-right">de Vente</div>
									<div class="sheet-col-2"><input type="text" class="sheet-noBorder" name="attr_Recette_Prix" value="0"></div>
								</div>
							</div>
						</div>
					</div>
					<br />
				</fieldset>
			</div>
			<div class="sheet-row sheet-hint"><b>Règles de réparation / Confection :</b><br>
			Si le personnage est Spécialiste (ex: Un forgeron qui répare une épée ou un ébéniste qui travail un arc), il peut disposer d'un bonus ou d'un malus au jet en fonction de son Ingéniosité (moy. Int et AD) et de la Difficulté (en fonction de la qualité de l'objet) suivant cette formule : Ingéniosité - Difficulté = Bonus (ou Malus) au jet. <br>
			Si le personnage n'est pas spécialiste, il ne peut avoir de bonus, le jet est systématiquement malussé celons la difficulté !<br>
			Le personnage peut bénéficier d'un bonus grâce à un assistant, des outils de qualité ou un atelier mais aussi d'un malus à cause d'un handicap, de la météo...</div>
		</div>

		<!-- TAB Compagnons -->
		<div class="sheet-tab_compagnons">
			<fieldset class="repeating_compagnons">
				<div class="sheet-group">
					<div class="sheet-row">
						<div class="sheet-col-1 sheet-bold">Nom :</div>
						<div class="sheet-col-5"><input type="text" name="attr_Compagnon_Nom" class="sheet-noBorder"></div>
						<div class="sheet-col-1 sheet-bold">Type :</div>
						<div class="sheet-col-4"><input type="text" name="attr_Compagnon_Type" class="sheet-noBorder"></div>
					</div>
					<input type="checkbox" name="attr_Compagnon_display" class="sheet-config-flag" value="1" /><span class="sheet-cog">y</span>
					<div class="sheet-config">
						<div class="sheet-row">
							<div class="sheet-col-4">
								<div class="sheet-monture_stats">
									<h2>Caractéristiques</h2>
									<div class="sheet-row">
										<div class="sheet-col-6 sheet-bold">Énergie vitale</div>
										<div class="sheet-col-3"><input type="number" name="attr_Compagnon_EV" value="" /></div>
										<div class="sheet-col-3"><input type="number" name="attr_Compagnon_EV_max" value="" /></div>
									</div>
									<div class="sheet-row">
										<div class="sheet-col-6 sheet-bold">Charge / max</div>
										<div class="sheet-col-3"><input type="number" name="attr_Compagnon_Charge" value="" /></div>
										<div class="sheet-col-3"><input type="number" name="attr_Compagnon_Charge_max" value="" /></div>
									</div>
									<div class="sheet-row">
										<div class="sheet-col-3 sheet-bold">COU</div>
										<div class="sheet-col-3"><input type="number" name="attr_Compagnon_Cou" value="" /></div>
										<div class="sheet-col-3 sheet-bold sheet-center">AT</div>
										<div class="sheet-col-3"><input type="number" name="attr_Compagnon_AT" value="" /></div>
									</div>
									<div class="sheet-row">
										<div class="sheet-col-3 sheet-bold">Esquive</div>
										<div class="sheet-col-3"><input type="number" name="attr_Compagnon_Esquive" value="" /></div>
										<div class="sheet-col-3 sheet-bold sheet-center">PRD</div>
										<div class="sheet-col-3"><input type="number" name="attr_Compagnon_PRD" value="" /></div>
									</div>
									<div class="sheet-row">
										<div class="sheet-col-3 sheet-bold">PR</div>
										<div class="sheet-col-3"><input type="number" name="attr_Compagnon_PR" value="" /></div>
										<div class="sheet-col-3 sheet-bold sheet-center" title="Résistance Magique">RM</div>
										<div class="sheet-col-3"><input type="number" name="attr_Compagnon_ResiMagie" value="" /></div>
									</div>
								</div>
								<div class="sheet-monture_deplacement">
									<br>
									<h2>Déplacement</h2>
									<div class="sheet-row sheet-tableth">
										<div class="sheet-col-3"></div>
										<div class="sheet-col-3">Sol</div>
										<div class="sheet-col-3">Air</div>
										<div class="sheet-col-3"></div>
									</div>
									<div class="sheet-row">
										<div class="sheet-col-3 sheet-bold">Assault</div>
										<div class="sheet-col-3"><input type="number" name="attr_Compagnon_Deplacement_Assaut_sol" value="0" /></div>
										<div class="sheet-col-3"><input type="number" name="attr_Compagnon_Deplacement_Assaut_air" value="0" /></div>
										<div class="sheet-col-3 sheet-hint">M</div>
									</div>
									<div class="sheet-row">
										<div class="sheet-col-3 sheet-bold">Charge</div>
										<div class="sheet-col-3"><input type="number" name="attr_Compagnon_Deplacement_Charge_sol" value="0" /></div>
										<div class="sheet-col-3"><input type="number" name="attr_Compagnon_Deplacement_Charge_air" value="0" /></div>
										<div class="sheet-col-3 sheet-hint">M</div>
									</div>
									<div class="sheet-row">
										<div class="sheet-col-3 sheet-bold">Voyage</div>
										<div class="sheet-col-3"><input type="number" name="attr_Compagnon_Deplacement_Voyage_sol" value="0" /></div>
										<div class="sheet-col-3"><input type="number" name="attr_Compagnon_Deplacement_Voyage_air" value="0" /></div>
										<div class="sheet-col-3 sheet-hint">KM/H</div>
									</div>
									<div class="sheet-row">
										<div class="sheet-col-3 sheet-bold">Voyage</div>
										<div class="sheet-col-3"><input type="number" name="attr_Compagnon_Deplacement_Jour_sol" value="0" /></div>
										<div class="sheet-col-3"><input type="number" name="attr_Compagnon_Deplacement_Jour_air" value="0" /></div>
										<div class="sheet-col-3 sheet-hint">KM/J</div>
									</div>
								</div>
							</div>
							<div class="sheet-col-8">
								<div class="sheet-monture_combat">
									<h2>Combat</h2>
									<textarea name="attr_Compagnon_Combat"></textarea>
								</div>
								<div class="sheet-monture_entretien">
									<h2>Entretien</h2>
									<textarea name="attr_Compagnon_Entretien"></textarea>
								</div>
								<div class="sheet-monture_autres">
									<h2>Autres</h2>
									<textarea name="attr_Compagnon_Autres"></textarea>
								</div>
							</div>
						</div>
						<br>
						<div class="sheet-monture_materiel">
							<h2>Matériel</h2>
							<div class="sheet-row">
								<div class="sheet-col-4">
									<input type="text" class="sheet-noBorder" name="attr_Compagnon_Materiel1_Nom" value="Sac N°1">
									<textarea name="attr_Compagnon_Materiel1"></textarea>
								</div>
								<div class="sheet-col-4">
									<input type="text" class="sheet-noBorder" name="attr_Compagnon_Materiel2_Nom" value="Sac N°2">
									<textarea name="attr_Compagnon_Materiel2"></textarea>
								</div>
								<div class="sheet-col-4">
									<input type="text" class="sheet-noBorder" name="attr_Compagnon_Materiel3_Nom" value="Sac N°3">
									<textarea name="attr_Compagnon_Materiel3"></textarea>
								</div>
							</div>
						</div>
						<br clear="all">
					</div>
				</div>
			</fieldset>
		</div>
	</div>

	<!-- TAB Reglages -->
	<div class="sheet-body sheet-reglages">
		<h2>Réglages (v2.9) <input type="checkbox" name="attr_modal_patchNote" class="sheet-modal" value="1" title="Notes de mise à jour"><span class="sheet-cog" title="Notes de mise à jour">?</span></h2>
		<!-- Patch note --->
		<input type="checkbox" class="sheet-hidden sheet-modal" name="attr_modal_patchNote" value="1" />
		<div class="sheet-modal-wrapper">
			<div class="sheet-modal">
				<div class="sheet-modal_header">
					<h2>Notes de mise à jour <span class="sheet-close">*</span><input type="checkbox" class="sheet-modal" name="attr_modal_patchNote" value="1"></h2>
				</div>
				<div class="sheet-modal_body">
					<b>v2.9</b><br>
					<ul>
						<li>Rajout des jets de <b>COU,INT,CHA</b> pour les Coups Spéciaux</li>
						<li>Permet de noter les Traits Particulier avec du texte plutôt que le tableau de cases</li>
						<li>Rajout du <b>bonus d'équipement aux dégâts</b> pour les attaques physiques</li>
						<li>Tous les boutons peuvent êtres Drag&Drop dans la barre de macro</li>
						<li>Passe la Confrontation sur 1d6 par défaut</li>
						<li>Corrections mineures</li>
						<li>Mise à jour graphique mineure</li>
					</ul>
					<b>v2.8.2</b><br>
					<ul>
						<li>Rajout des <b>Notes de mise à jour</b> dans les Réglages&nbsp;<span class="sheet-pictos">y</span></li>
						<li>Rajout du score de <b>PR max</b> dans l'Equipement</li>
						<li>Rajout du <b>bonus / malus temporaire de PR</b> dans les Traits particuliers</li>
						<li>Corrections mineures</li>
						<li>Mise à jour graphique mineure</li>
					</ul>
					<b>v2.8.1</b><br>
					<ul>
						<li>Corrections mineures</li>
					</ul>
					<b>v2.8</b><br>
					<ul>
						<li>Rajout du <b>Mode nuit</b> dans les Réglages&nbsp;<span class="sheet-pictos">y</span></li>
						<li>Intégration & support d'imports via copié-collé depuis le <b>compendium</b> bit.ly/ddn20&nbsp;<span class="sheet-pictos">x</span></li>
						<li>Rajout des <b>Armes à poudres</b></li>
						<li>Mise à jour graphique de l'<b>Inventaire</b></li>
						<li>Mise à jour mineure de la <b>Magie</b></li>
					</ul>
				</div>
			</div>
		</div>
		<div class="sheet-row">
			<div class="sheet-col-6">
				<p>
					<input type="checkbox" name="attr_nightMode" value="1" class="sheet-col-1"> Mode nuit
				</p>
			</div>
			<div class="sheet-col-6">
			</div>
		</div>
		<div class="sheet-row">
			<div class="sheet-col-6">
				<p>
					<input type="checkbox" name="attr_displayJet" value="/w gm" class="sheet-col-1"> Envoyer les jets au MJ uniquement
					<br />
					<span class="sheet-hint">Cochez cette option pour que tous les jets soient cachés aux autres joueurs.</span>
				</p>
			</div>
			<div class="sheet-col-6">
				<p>
					<input type="checkbox" name="attr_displayCritEffets" value="1" class="sheet-col-1"> Afficher les effets des Critiques / Fumbles
					<br />
					<span class="sheet-hint">Cochez cette option pour que les effets des Critiques / Fumbles soient affichés en plus de la confirmation.</span>
				</p>
			</div>
		</div>
		<br />
		<div class="sheet-row">
			<div class="sheet-col-6">
				<h2>Sauvegarder</h2>
				<textarea name="attr_json_export"></textarea>
				<span class="sheet-hint">Sauvegarder son personnage Roll20 pour l'importer dans une autre partie</span>
				<div class="sheet-center">
					<input type="checkbox" class="sheet-tab" name="attr_export_start" value="1"><span class="sheet-tab">Démarrer</span>
				</div>
			</div>
			<div class="sheet-col-6">
				<h2>Importer</h2>
				<textarea name="attr_json_import"></textarea>
				<span class="sheet-hint"><span style="color:#F00;">Attention</span>, toutes les données de la fiche seront écrasées</span>
				<div class="sheet-center">
					<input type="checkbox" class="sheet-tab" name="attr_import_start" value="1"><span class="sheet-tab">Démarrer</span>
				</div>
			</div>
		</div>
	</div>

	<!--- SHEET PNJ --->
	<div class="sheet-body sheet-pnj">
		<h2>Caractéristiques</h2>
		<div class="sheet-row sheet-tableth">
			<div class="sheet-col-1"><button type="roll" value="@{displayJet} &{template:default} {{name=@{Personnage_Nom} tente une épreuve de Courage }} {{ Courage=@{Stats_Courage} }} {{ Résultat=[[1d20cs<1cf>20]] }}"> COU</button></div>
			<div class="sheet-col-1"><button type="roll" value="@{displayJet} &{template:default} {{name=@{Personnage_Nom} tente une épreuve d'Intelligence }} {{ Intelligence=@{Stats_Intelligence} }} {{ Résultat=[[1d20cs<1cf>20]] }}"> INT</button></div>
			<div class="sheet-col-1"><button type="roll" value="@{displayJet} &{template:default} {{name=@{Personnage_Nom} tente une épreuve de Charisme}} {{ Charisme=@{Stats_Charisme} }} {{ Résultat=[[1d20cs<1cf>20]] }}"> CHA</button></div>
			<div class="sheet-col-1"><button type="roll" value="@{displayJet} &{template:default} {{name=@{Personnage_Nom} tente une épreuve d'Adresse}} {{ Adresse=@{Stats_Adresse} }} {{ Résultat=[[1d20cs<1cf>20]] }}"> AD</button></div>
			<div class="sheet-col-1"><button type="roll" value="@{displayJet} &{template:default} {{name=@{Personnage_Nom} tente une épreuve de Force}} {{ Force=@{Stats_Force} }} {{ Résultat=[[1d20cs<1cf>20]] }}"> FO</button></div>
			<div class="sheet-col-1"><button type="roll" value="@{displayJet} &{template:default} {{name=@{Personnage_Nom} tente une Attaque }} {{ Attaque=@{Stats_Attaque} }} {{ Résultat=[[1d20cs<1cf>20]] }}"> AT</button></div>
			<div class="sheet-col-1"><button type="roll" value="@{displayJet} &{template:default} {{name=@{Personnage_Nom} tente une Parade }} {{ Parade=@{Stats_Parade} }} {{ Résultat=[[1d20cs<1cf>20]] }}"> PRD</button></div>
			<div class="sheet-col-1"><button type="roll" value="@{displayJet} &{template:default} {{name=@{Personnage_Nom} tente une Attaque à distance }} {{ Jet=@{Stats_Jet} }} {{ Résultat=[[1d20cs<1cf>20]] }}"> JET</button></div>
			<div class="sheet-col-1"><button type="roll" value="@{displayJet} &{template:default} {{name=@{Personnage_Nom} tente une Esquive }} {{ Esquive=@{Stats_Esquive} }} {{ Résultat=[[1d20cs<1cf>20]] }}"> ESQ</button></div>
			<div class="sheet-col-1"><button type="roll" value="@{displayJet} &{template:default} {{name=@{Personnage_Nom} concentre sa Magie}} {{ Magie&nbsp;Phys=@{Stats_MagiePhy} }} {{ Résultat=[[1d20cs<1cf>20]] }} "> MPhy</button></div>
			<div class="sheet-col-1"><button type="roll" value="@{displayJet} &{template:default} {{name=@{Personnage_Nom} concentre sa Magie}} {{ Magie&nbsp;Psy=@{Stats_MagiePsy} }} {{ Résultat=[[1d20cs<1cf>20]] }}"> MPsy</button></div>
			<div class="sheet-col-1"><button type="roll" value="@{displayJet} &{template:default} {{name=@{Personnage_Nom} tente de résiter à la Magie}} {{ Résist.&nbsp;Magie=@{Stats_ResiMagie} }} {{ Résultat=[[1d20cs<1cf>20]] }} "> RM</button></div>
		</div>
		<div class="sheet-row">
			<div class="sheet-col-1"><input type="number" name="attr_Stats_Courage" value="0"></div>
			<div class="sheet-col-1"><input type="number" name="attr_Stats_Intelligence" value="0"></div>
			<div class="sheet-col-1"><input type="number" name="attr_Stats_Charisme" value="0"></div>
			<div class="sheet-col-1"><input type="number" name="attr_Stats_Adresse" value="0"></div>
			<div class="sheet-col-1"><input type="number" name="attr_Stats_Force" value="0"></div>
			<div class="sheet-col-1"><input type="number" name="attr_Stats_Attaque" value="8"></div>
			<div class="sheet-col-1"><input type="number" name="attr_Stats_Parade" value="10"></div>
			<div class="sheet-col-1"><input type="number" name="attr_Stats_Jet" value="0"></div>
			<div class="sheet-col-1"><input type="number" name="attr_Stats_Esquive" value="0"></div>
			<div class="sheet-col-1"><input type="number" name="attr_Stats_MagiePhy" value="0"></div>
			<div class="sheet-col-1"><input type="number" name="attr_Stats_MagiePsy" value="0"></div>
			<div class="sheet-col-1"><input type="number" name="attr_Stats_ResiMagie" value="0"></div>
		</div>
		<br />
		<div class="sheet-row sheet-energie">
			<div class="sheet-col-2">
				<h2 class="sheet-ev-bar">Energie Vitale :</h2>
				<div class="sheet-row">
					<div class="sheet-col-6">
						<input type="number" name="attr_EV" value="0" step="1">
					</div>
					<div class="sheet-col-6">
						<input type="number" name="attr_EV_max" value="0" min="1" step="1">
					</div>
				</div>
			</div>
			<div class="sheet-col-2">
				<h2 class="sheet-ea-bar">Energie Astrale :</h2>
				<div class="sheet-row">
					<div class="sheet-col-6">
						<input type="number" name="attr_EA" value="0" step="1">
					</div>
					<div class="sheet-col-6">
						<input type="number" name="attr_EA_max" value="0" min="0" step="1">
					</div>
				</div>
			</div>
			<div class="sheet-col-1">
				<h2>Niveau</h2>
				<div class="sheet-row">
					<div class="sheet-col-12"><input type="number" name="attr_Personnage_Niveau" value="0" step="1"></div>
				</div>
			</div>
			<div class="sheet-col-1">
				<h2>XP</h2>
				<div class="sheet-row">
					<div class="sheet-col-12"><input type="number" name="attr_Personnage_XP" value="0" step="1"></div>
				</div>
			</div>
			<div class="sheet-col-4"></div>
			<div class="sheet-col-2">
				<input type="checkbox" name="attr_modal_PNJ" class="sheet-modal" value="1" /><span class="sheet-cog">?</span> <span class="sheet-hint"> Macros utiles</span>
				<div class="sheet-modal-wrapper">
					<div class="sheet-modal">
						<div class="sheet-modal_header">
							<h2>Macros globales pour PNJ <span class="sheet-close">*</span><input type="checkbox" class="sheet-modal" name="attr_modal_PNJ" value="1" /></h2>
						</div>
						<div class="sheet-modal_body">
							Il est possible d'ajouter ces macros en tant que "Token action" (Action de Pion) pour fluidifier les combats.<br /><br />
							<b>Rajouter le PNJ dans le Turn Order :</b><br />
							<textarea class="sheet-code" rows="1">[[@{selected|Stats_Courage} &{tracker}]] </textarea>
							<b>Faire attaquer le PNJ avec son Arme N°1 :</b><br />
							<textarea class="sheet-code" rows="1">@{selected|displayJet} &{template:default} {{name=Attaque de @{selected|Personnage_Nom} avec @{selected|repeating_PNJarmes_$0_Arme_Nom} }} {{ Cible = @{target|Personnage_Nom} }} {{ AT=@{selected|repeating_PNJarmes_$0_Arme_Jet} }} {{ Résultat=[[1d20cs<1cf>20]] }}</textarea>
							<b>Faire parer le PNJ avec son Arme N°1 :</b><br />
							<textarea class="sheet-code" rows="1">@{selected|displayJet} &{template:default} {{name=Parade de @{selected|Personnage_Nom} avec @{selected|repeating_PNJarmes_$0_Arme_Nom} }} {{ PRD=@{selected|Stats_Parade_total} + @{selected|repeating_PNJarmes_$0_Arme_PRD} }} {{ Résultat=[[1d20cs<1cf>20]] }}</textarea>
							<b>Dégats de l'Arme N°1 :</b><br />
							<textarea class="sheet-code" rows="1">@{selected|displayJet} &{template:default} {{name=Dégats de @{selected|Personnage_Nom} avec @{selected|repeating_PNJarmes_$0_Arme_Nom}}} {{ Cible = @{target|Personnage_Nom} }} {{ Dégats=[[@{selected|repeating_PNJarmes_$0_Arme_Degats} + @{selected|BonusDegatsForce}]] }}</textarea>
							<span class="sheet-hint">Pour utiliser l'arme N°2, remplacer $0 par $1 et ainsi de suite.</span>
						</div>
					</div>
				</div>
			</div>
		</div>
		<br />
		<div class="sheet-armes">
			<h2>Armement & Baston</h2>
			<div class="sheet-tableth sheet-row">
				<div class="sheet-col-4">Arme</div>
				<div class="sheet-col-1">Portée</div>
				<div class="sheet-col-1">AT</div>
				<div class="sheet-col-1">PRD</div>
				<div class="sheet-col-1">Dégats</div>
				<div class="sheet-col-1">RUP.</div>
				<div class="sheet-col-3">Jets</div>
			</div>

			<fieldset class="repeating_PNJarmes">
				<div class="sheet-row">
					<div class="sheet-col-4">
						<input type="text" class="sheet-noBorder" name="attr_Arme_Nom" value="" />
					</div>
					<div class="sheet-col-1">
						<select name="attr_Arme_Jet">
							<option value="[[ @{Stats_Attaque_total} + @{Arme_AT} ]]" selected="selected">Mélée</option>
							<option value="[[ @{Stats_Jet_total} + @{Arme_AT} ]]">Dist.</option>
						</select>
					</div>
					<div class="sheet-col-1">
						<input type="number" name="attr_Arme_AT" value="0" />
					</div>
					<div class="sheet-col-1">
						<input type="number" name="attr_Arme_PRD" value="0" />
					</div>
					<div class="sheet-col-1">
						<input type="text" name="attr_Arme_Degats" value="1d6" />
					</div>
					<div class="sheet-col-1">
						<input type="text" name="attr_Arme_RUP" value="" />
					</div>
					<div class="sheet-col-3">
						<button type="roll" value="@{displayJet} &{template:default} {{name=Attaque de @{Personnage_Nom} avec @{Arme_Nom} }} {{ AT=@{Arme_Jet} }} {{ Résultat=[[1d20cs<1cf>20]] }}"> AT </button>
						<button type="roll" value="@{displayJet} &{template:default} {{name=Parade de @{Personnage_Nom} avec @{Arme_Nom} }} {{ PRD=[[@{Stats_Parade_total} + @{Arme_PRD}]] }} {{ Résultat=[[1d20cs<1cf>20]] }}"> PRD </button>
						<button type="roll" class="sheet-rollDegats" value="@{displayJet} &{template:default} {{name=Dégats de @{Personnage_Nom} avec @{Arme_Nom}}} {{ Dégats=[[@{Arme_Degats} + @{BonusDegatsForce}]] }}"> Dégats </button>
					</div>
				</div>
			</fieldset>
		</div>
		<br />
		<div class="sheet-armure">
			<h2>Armures & Protections</h2>
			<div class="sheet-row">
				<div class="sheet-col-6">
					<table>
						<thead>
							<tr>
								<th class="sheet-center">Tête</th>
								<th class="sheet-center">Bras</th>
								<th class="sheet-center">Mains</th>
								<th class="sheet-center">Torse</th>
								<th class="sheet-center">Jambes</th>
								<th class="sheet-center">Pieds</th>
								<th class="sheet-center">Bouclier</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td class="sheet-center"><input type="number" name="attr_PR_Tete" value="0" /></td>
								<td class="sheet-center"><input type="number" name="attr_PR_Bras" value="0" /></td>
								<td class="sheet-center"><input type="number" name="attr_PR_Mains" value="0" /></td>
								<td class="sheet-center"><input type="number" name="attr_PR_Torse" value="0" /></td>
								<td class="sheet-center"><input type="number" name="attr_PR_Jambes" value="0" /></td>
								<td class="sheet-center"><input type="number" name="attr_PR_Pieds" value="0" /></td>
								<td class="sheet-center"><input type="number" name="attr_PR_Bouclier" value="0" /></td>
							</tr>
						</tbody>
					</table>
				</div>
				<div class="sheet-col-6">
					<table class="sheet-center">
						<thead>
							<tr>
								<th>PR Naturelle</th>
								<th>PR Physique</th>
								<th>PR Magique</th>
								<th>PR Totale</th>
							</tr>
						</thead>
						<tr>
							<td class="sheet-center"><input type="number" name="attr_PRNat" value="0" /></td>
							<td class="sheet-center"><input type="number" name="attr_PRPhy" value="0" /></td>
							<td class="sheet-center"><input type="number" name="attr_PRMag" value="0" /></td>
							<td class="sheet-center"><input type="number" name="attr_PR" value="0" /></td>
						</tr>
					</table>
				</div>
			</div>
		</div>
		<br />
		<div class="sheet-traits">
			<h2>Traits spéciaux</h2>
			<div class="sheet-tableth sheet-row">
				<div class="sheet-col-4">Nom</div>
				<div class="sheet-col-8">Effet</div>
			</div>
			<fieldset class="repeating_traits">
				<div class="sheet-row">
					<div class="sheet-col-4">
						<input type="text" class="sheet-noBorder" name="attr_trait_nom" value="" />
					</div>
					<div class="sheet-col-8">
						<input type="text" class="sheet-noBorder" name="attr_trait_effet" value="" />
					</div>
				</div>
			</fieldset>
		</div>
		<br />
		<div class="sheet-row">
			<h2>Notes</h2>
			<div class="sheet-col-12">
				<textarea name="attr_Personnage_Notes"></textarea>
			</div>
		</div>
		<br />
		<div class="sheet-row">
			<h2>Butins</h2>
			<div class="sheet-col-12">
				<textarea name="attr_Personnage_Butins"></textarea>
			</div>
		</div>
	</div>
</div>

<script type="text/worker">
	// Primary Stats
	var primaryStats = [ "stats_courage", "stats_intelligence", "stats_charisme", "stats_adresse", "stats_force", "stats_attaque", "stats_parade"];
	// Secondary Stats
	var secondaryStats = [	"stats_charisme_total", "stats_intelligence_total", "stats_adresse_total", "stats_force_total", "stats_courage_total",
							"stats_inge_mod", "stats_magiepsy_mod", "stats_magiephy_mod", "stats_resimagie_mod", "stats_fouille_mod", "stats_jet_mod",
							"stats_inge_temp_total", "stats_magiepsy_temp_total", "stats_magiephy_temp_total", "stats_resimagie_temp_total", "stats_fouille_temp_total", "stats_jet_temp_total" ];
	// Temp Stats
	var tempStats = [	"stats_courage", "stats_intelligence", "stats_charisme", "stats_adresse", "stats_force",
						"stats_attaque", "stats_parade", "stats_jet", "stats_esquive", "stats_fouille",
						"stats_inge", "stats_magiephy", "stats_magiepsy", "stats_resimagie", "stats_pr", "stats_mvt" ];
	// Buff Stats
	var buffStats = [	"cou", "int", "cha", "ad", "fo",
						"at", "prd", "jet", "esq", "fouille",
						"inge", "mphy", "mpsy", "rm", "pr", "mvt" ];
	var prStats = {
		change: [ "repeating_armures:armure_prphy", "repeating_armures:armure_prmag", "prnat", "stats_pr_buff" ],
		remove: [ "repeating_armures" ]
	};
	// items weight
	var weightStats = [	"richesse_berylium", "richesse_thritil", "poids_bourses",
						"poids_materiels", "poids_butins", "poids_livres", "poids_bouffes", "personnage_charge_max", "poids_sacs_max" ];
	// repeating items sections
	var weightSections = [ "repeating_materiels", "repeating_butins", "repeating_bouffes", "repeating_livres" ];

	// max available weight
	var weightStats_max = {
		change: [ "repeating_sacs:sac_charge_max", "repeating_bourses:bourse_charge_max" ],
		remove: [ "repeating_sacs", "repeating_bourses" ]
	}

	var levelAndXP = [	0, 100, 300, 600, 1000, 1500, 2100, 2800, 3600, 4500,
						5500, 6600, 7800, 9100, 10500, 12000, 13600, 15300, 17100, 19000,
						21000, 24000, 29000, 35000, 45000, 60000 ];

	/*---------
		EVENTS
	----------*/
	// Primary Stats
	on( primaryStats.map( stat => `change:${stat} change:${stat}_mod change:${stat}_temp_total` ).join(" "), function(e) {
		updatePrimaryStat( e.sourceAttribute.replace( "_mod", "" ).replace( "_temp_total", "" ) );
	});
	// Secondary Stats & Secondary Mods
	on( secondaryStats.map( stat => `change:${stat}` ).join(" "), function() {
		updateSecondaryStats();
	});
	// Temp Stats
	on( tempStats.map( stat => `change:${stat}_temp change:${stat}_buff` ).join(" "), function(e) {
		updateTempStat( e.sourceAttribute.replace( "_temp", "" ).replace( "_buff", "" ) );
	});
	// PR Physique et magique
	on( prStats[ "change" ].map( stat => `change:${stat}` ).join(" ") + " " + prStats[ "remove" ].map( stat => `remove:${stat}` ).join(" "), function() {
		updatePR();
	});
	// Déplacement
	on("change:prphy change:deplacement_mod change:stats_force_total change:stats_mvt_buff", function() {
		updateDeplacement();
	});
	// Equive
	on("change:stats_adresse_total change:prphy change:stats_esquive_mod change:stats_esquive_temp_total change:personnage_surcharge", function() {
		updateEsquive();
	});
	// Level
	on("change:personnage_niveau", function() {
		updateXP();
	});
	// Ammos & Weapons
	on("change:repeating_armes:munition_nom change:repeating_guns:munition_nom", function( e ) {
		if( e[ "sourceType"] === "player" ) {
			updateAmmo( e );
		}
	});
	on("change:repeating_armes:arme_portee change:repeating_armes:arme_at change:repeating_armes:arme_degats change:repeating_armes:arme_bonusforce change:repeating_armes:munition_modad change:repeating_armes:munition_degats", function( e ) {
		var idRow = e[ "sourceAttribute" ].split( '_' )[2];
		updateWeapon( idRow );
	});
	on("change:stats_jet_total change:stats_attaque_total change:bonusdegatsforce change:bonusdegatsatk", function( e ) {
		updateWeapons();
	});
	// Total golds
	on("change:richesse_or change:richesse_argent change:richesse_cuivre change:richesse_berylium change:richesse_thritil change:richesse_billet10 change:richesse_billet50 change:richesse_billet100 change:richesse_billet500 change:richesse_billet1000", function() {
		updatePO();
	});
	// total repeating section weight
	on( weightSections.map( section => `change:${section}` ).join(" ") + " " + weightSections.map( section => `remove:${section}` ).join(" "), function( e ) {
		var section = e[ 'sourceAttribute' ].split('-')[0];

		if( section === "repeating_materiels_" ) {
			updateRSSum( "repeating_materiels", "materiel_poids", "poids_materiels" );
		} else if( section === "repeating_butins_" ) {
			updateRSSum( "repeating_butins", "butin_poids", "poids_butins" );
		} else if( section === "repeating_bouffes_" ) {
			updateRSSum( "repeating_bouffes", "bouffe_poids", "poids_bouffes" );
		} else if( section === "repeating_livres_" ) {
			updateLivresCharge();
		}
	});
	// total weight
	on( weightStats.map( stat => `change:${stat}` ).join(" "), function() {
		updateCharge();
	});
	// max available weight
	on( weightStats_max[ "change" ].map( stat => `change:${stat}` ).join(" ") + " " + weightStats_max[ "remove" ].map( stat => `remove:${stat}` ).join(" "), function( e ) {
		var section = e[ 'sourceAttribute' ].split('-')[0];

		if( section === "repeating_sacs_" ) {
			updateRSSum( "repeating_sacs", "sac_charge_max", "poids_sacs_max" );
		} else if( section === "repeating_bourses_" ) {
			updateRSSum( "repeating_bourses", "bourse_charge_max", "poids_bourses_max" );
		}
	});
	// change magic school tab
	on("change:repeating_ecolesmagie:ecolemagie_selected change:ecolemagie_selectall", function( e ) {
		if( e[ "sourceType"] === "player" ) {
			updateMagicSchoolTab( e );
		}
	});
	// change magic Filter
	on("change:tab_ecolemagie change:tab_niveaumagie", function() {
		displayMagicSpells();
	});
	// Crating
	on("change:reparation_qualite change:reparation_specialiste", function( ) {
		updateRepair();
	});
	on("change:repeating_recettes:recette_specialiste change:repeating_recettes:recette_difficulte change:repeating_recettes:recette_malusspecialiste", function( e ) {
		var idRow = e[ 'sourceAttribute' ].split('_')[2];
		updateRecipe( idRow );
	});
	on("change:stats_inge_total", function() {
		updateRepair();
		updateRecipes();
	});
	// Buff / Debuff
	on("change:repeating_conditions:condition_actif remove:repeating_conditions change:repeating_conditions:condition_effet", function(e) {
		updateBuffs();
	});
	// compendium import
	on("change:compendium", function( e ) {
		if( e[ "sourceType"] === "player" ) {
			importCompendium();
		}
	});
	// export
	on("change:export_start", function() {
		start_export();
	});
	on("change:import_start", function( e ) {
		start_import();
	});
	on("change:tab_reglages sheet:opened", function( e ) {
		reset_export();
	});

	/*------------
		FUNCTIONS
	-------------*/
	function safeInt( val ) { return parseInt( val, 10 ) || 0;	}

	function structSafeInt( v ) {
		for( var attr in v ) {
			v[ attr ] = safeInt( v[ attr ] );
		}
		return v;
	}

	function safeFloat( val ) { return parseFloat( val ) || 0;	}

	function structSafeFloat( v ) {
		for( var attr in v ) {
			v[ attr ] = safeFloat( v[ attr ] );
		}
		return v;
	}

	// sum base + _mod + _temp_total to set _total
	function updatePrimaryStat( attr ) {
		getAttrs( [ attr, `${attr}_mod`, `${attr}_temp_total` ], function( v ) {
			setAttrs({
				[ `${attr}_total` ]: safeInt( v[ attr ] ) + safeInt( v[ attr + "_mod" ] ) + safeInt( v[ attr + "_temp_total" ] )
			});
		});
	}

	// update secondary stats and hints when primary are updated
	function updateSecondaryStats() {
		getAttrs( [ "tab_pnj" ], function( v ) {
			if( v[ "tab_pnj" ] != 1 ) {
				getAttrs( secondaryStats, function( sValues ) {
					var v = structSafeInt( sValues );
					var ingeniosite = Math.ceil( ( v[ "stats_intelligence_total"] + v[ "stats_adresse_total" ] ) / 2 );
					var magiePsy = Math.ceil( ( v[ "stats_intelligence_total"] + v[ "stats_charisme_total" ] ) / 2 );
					var magiePhy = Math.ceil( ( v[ "stats_intelligence_total"] + v[ "stats_adresse_total" ] ) / 2 );
					var resiMagie = Math.ceil( ( v[ "stats_intelligence_total"] + v[ "stats_courage_total" ] + v[ "stats_force_total" ] ) / 3 );

					var bonusIntel = " ";
					var bonusDegatsIntel = 0;
					var bonusAdresse = " ";
					var bonusForce = " ";
					var bonusDegatsForce = 0;

					if( v[ "stats_intelligence_total" ] > 12 ) {
						bonusIntel = "Pour chaque point d'Intelligence supérieur à 12 : +1 point de dégâts des sorts (selon sortilège).";
						bonusDegatsIntel = v[ "stats_intelligence_total" ] - 12;
					}

					if( v[ "stats_adresse_total" ] > 12 ) {
						bonusAdresse = "Adresse supérieure à 12 : +1 à l'Attaque OU à la Parade (un seul point quel que soit le score).";
					} else if( v[ "stats_adresse_total" ] <= 8 ) {
						bonusAdresse = "Adresse à 8 ou inférieur : -1 à l'Attaque OU à la Parade.";
					}

					if( v[ "stats_force_total" ] > 12 ) {
						bonusForce = "Pour chaque point de Force supérieur à 12 : +1 Point d'Impact.";
						bonusDegatsForce = v[ "stats_force_total" ] - 12;
					} else if( v[ "stats_force_total" ] <= 8 ) {
						bonusForce = "Force de 8 ou inférieure : -1 Point d'Impact.";
						bonusDegatsForce = -1;
					}

					setAttrs({
						"stats_inge": ingeniosite,
						"stats_inge_total": ingeniosite + v[ "stats_inge_mod" ] + v[ "stats_inge_temp_total" ],
						"stats_magiepsy": magiePsy,
						"stats_magiepsy_total": magiePsy + v[ "stats_magiepsy_mod" ] + v[ "stats_magiepsy_temp_total" ],
						"stats_magiephy": magiePhy,
						"stats_magiephy_total": magiePhy + v[ "stats_magiephy_mod" ] + v[ "stats_magiephy_temp_total" ],
						"stats_resimagie": resiMagie,
						"stats_resimagie_total": resiMagie + v[ "stats_resimagie_mod" ] + v[ "stats_resimagie_temp_total" ],
						"stats_fouille": v[ "stats_intelligence_total"],
						"stats_fouille_total": v[ "stats_intelligence_total"] + v[ "stats_fouille_mod" ] + v[ "stats_fouille_temp_total" ],
						"bonusintel": bonusIntel,
						"bonusdegatsintel": bonusDegatsIntel,
						"stats_jet": v[ "stats_adresse_total" ],
						"stats_jet_total": v[ "stats_adresse_total" ] + v[ "stats_jet_mod" ] + v[ "stats_jet_temp_total" ],
						"bonusadresse": bonusAdresse,
						"bonusforce": bonusForce,
						"bonusdegatsforce": bonusDegatsForce
					});
				});
			}
		});
	}

	// sum _temp + _buff to set _temp_total
	function updateTempStat( attr ) {
		getAttrs( [ `${attr}_temp`, `${attr}_buff` ], function( v ) {
			setAttrs({
				[ `${attr}_temp_total` ]: safeInt( v[ attr + "_temp" ] ) + safeInt( v[ attr + "_buff" ] )
			});
		});
	}

	// parse actives buff to update temp_stats
	function updateBuffs() {
		var aBuffs = [];
		var sBuffs = {};
		var statName ='';
		var keyName ='';

		// reset buffs
		_.each( tempStats, function(_stat) {
			sBuffs[ _stat + "_buff" ] = 0;
		});

		getSectionIDs( "repeating_conditions", function(idArray) {
			getAttrs( [ ...idArray.map(id => `repeating_conditions_${id}_condition_actif`) ], function( sValues ) {
				for( var i in idArray ) {
					if( sValues[ `repeating_conditions_${idArray[i]}_condition_actif`] === "1" ) {
						aBuffs.push("repeating_conditions_" + idArray[i] + "_condition_effet" );
					}
				}

				if ( aBuffs.length > 0 ) {
					// apply buffs
					getAttrs(aBuffs, function(v) {
						for( var _effets in v ) {
							// cut all the effects by group
							_mods = v[ _effets ].split(',');
							_.each(_mods, function(_mod) {
								var _aMod = _mod.match(/([a-zA-Z]*) *([\+\-]) *([0-9]+)\%?/);

								if( !!_aMod ) {
									// get value of effect
									var _tempValue = safeInt( _aMod[3] );

									// get index of effect in buffStats array
									var _tempIndex = buffStats.indexOf( _aMod[1].toLowerCase().trim() );

									if( _tempIndex > -1 ) {
										// change short notation (cou,fo,int) in attribute (courage, intelligence...)
										var keyName = tempStats[ _tempIndex ] + "_buff";

										if( _aMod[2] === "-" ) {
											_tempValue = _tempValue * -1;
										}

										if( sBuffs[ keyName ] != undefined ) {
											sBuffs[ keyName ] += _tempValue;
										} else {
											sBuffs[ keyName ] = _tempValue;
										}
									}
								}
							});
						}
						setAttrs( sBuffs );
					});
				} else {
					setAttrs( sBuffs );
				}
			});
		});
	}

	// update walk speed when force, deplacement_mod or PR is updated
	function updateDeplacement() {
		getAttrs( [ "stats_force_total", "deplacement_mod", "deplacementrapide", "deplacementrapide_duree", "deplacementsprint", "deplacementsprint_duree", "prphy", "stats_mvt_buff" ], function( sValues ) {
			var v = structSafeInt( sValues );
			var prPhy = v[ "prphy" ];
			var deplacementRapide = v[ "deplacementrapide" ];
			var deplacementRapideDuree = v[ "deplacementrapide_duree" ];
			var deplacementSprint = v[ "deplacementsprint" ];
			var deplacementSprintDuree = v[ "deplacementsprint_duree" ];
			var deplacement_mod = v[ "deplacement_mod" ] / 100;
			var deplacement_temp = v[ "stats_mvt_buff" ] / 100;

			// PR vs Déplacement
			if( prPhy === 0 || prPhy === 1 ) {
				deplacementRapide = 8;
				deplacementRapideDuree = v[ "stats_force_total" ] * 20;
				deplacementSprint = 12;
				deplacementSprintDuree = v[ "stats_force_total" ] * 5;
			} else if( prPhy === 2 ) {
				deplacementRapide = 6;
				deplacementRapideDuree = v[ "stats_force_total" ] * 18;
				deplacementSprint = 10;
				deplacementSprintDuree = v[ "stats_force_total" ] * 4;
			} else if( prPhy === 3 || prPhy === 4 ) {
				deplacementRapide = 4;
				deplacementRapideDuree = v[ "stats_force_total" ] * 15;
				deplacementSprint = 8;
				deplacementSprintDuree = v[ "stats_force_total" ] * 4;
			} else if( prPhy === 5 ) {
				deplacementRapide = 4;
				deplacementRapideDuree = v[ "stats_force_total" ] * 10;
				deplacementSprint = 6;
				deplacementSprintDuree = v[ "stats_force_total" ] * 3;
			} else if( prPhy === 6 ) {
				deplacementRapide = 3;
				deplacementRapideDuree = v[ "stats_force_total" ] * 8;
				deplacementSprint = 4;
				deplacementSprintDuree = v[ "stats_force_total" ] * 3;
			} else if( prPhy === 7 ) {
				deplacementRapide = 2;
				deplacementRapideDuree = v[ "stats_force_total" ] * 7;
				deplacementSprint = 3;
				deplacementSprintDuree = v[ "stats_force_total" ] * 2;
			} else if( prPhy > 7 ) {
				deplacementRapide = 1;
				deplacementRapideDuree = v[ "stats_force_total" ] * 5;
				deplacementSprint = 2;
				deplacementSprintDuree = v[ "stats_force_total" ] * 2;
			}

			deplacement_mod += deplacement_temp;

			// apply mod
			deplacementRapide = Math.ceil( deplacementRapide * deplacement_mod * 100 ) / 100;
			deplacementRapideDuree = Math.ceil( deplacementRapideDuree * deplacement_mod * 100 ) / 100;
			deplacementSprint = Math.ceil( deplacementSprint * deplacement_mod * 100 ) / 100;
			deplacementSprintDuree = Math.ceil( deplacementSprintDuree * deplacement_mod * 100 ) / 100;

			setAttrs({
				"deplacementrapide": deplacementRapide,
				"deplacementrapide_duree": deplacementRapideDuree,
				"deplacementsprint": deplacementSprint,
				"deplacementsprint_duree": deplacementSprintDuree
			}, { silent: true });
		});
	}

	// update Esquive when addresse or PR or overweight is updated
	function updateEsquive() {
		getAttrs( [ "tab_pnj" ], function( v ) {
			if( v[ "tab_pnj" ] != 1 ) {
				getAttrs( [ "stats_adresse_total", "stats_esquive_mod", "stats_esquive_temp_total", "prphy", "personnage_surcharge" ], function( sValues ) {
					var v = structSafeInt( sValues );
					var esquive = v[ "stats_adresse_total" ];
					var prPhy = v[ "prphy" ];
					var surcharge = v[ "personnage_surcharge" ];

					// PR vs Esquive
					if( prPhy === 0 || prPhy === 1 ) {
						esquive += 1;
					} else if( prPhy === 3 || prPhy === 4 ) {
						esquive += - 2;
					} else if( prPhy === 5 ) {
						esquive += -4;
					} else if( prPhy === 6 ) {
						esquive += - 5;
					} else if( prPhy === 7 ) {
						esquive += - 6;
					} else if( prPhy > 7 ) {
						esquive = 0;
					}

					// surcharge vs Esquive
					if( surcharge === 4 ) {
						esquive += -2;
					} else if( surcharge === 5 ) {
						esquive = 0;
					}

					setAttrs({
						"stats_esquive": esquive,
						"stats_esquive_total": esquive + v[ "stats_esquive_mod" ] + v[ "stats_esquive_temp_total" ]
					}, { silent: true });
				});
			}
		});
	}

	// update xp threshold when level is updated
	function updateXP() {
		getAttrs( [ "personnage_niveau" ], function( v ) {
			var level = safeInt( v[ "personnage_niveau" ] );

			setAttrs({
				"personnage_xp_max": safeInt( levelAndXP[ level ], { silent : true} )
			});
		});
	}

	// update weapons roll and apply bonus depending on weapon types (ranged or not)
	function updateWeapon( idRow ) {
		var sWeapon = {};

		getAttrs( [
					`repeating_armes_${idRow}_arme_portee`, `repeating_armes_${idRow}_arme_at`, `repeating_armes_${idRow}_arme_degats`, `repeating_armes_${idRow}_arme_bonusforce`,
					`repeating_armes_${idRow}_munition_modAd`, `repeating_armes_${idRow}_munition_degats`,
					"stats_jet_total", "stats_attaque_total", "bonusdegatsforce", "bonusdegatsatk"
				] , function( v ) {

			sWeapon[ 'repeating_armes_' + idRow + '_arme_munition_display' ] = 0;
			sWeapon[ 'repeating_armes_' + idRow + '_arme_totalat' ] = safeInt( v[ "stats_attaque_total" ] ) + safeInt( v[ `repeating_armes_${idRow}_arme_at` ] );
			sWeapon[ 'repeating_armes_' + idRow + '_arme_totaldegats' ] = v[ `repeating_armes_${idRow}_arme_degats` ] + "[Arme]";

			if( v[ `repeating_armes_${idRow}_arme_portee` ] === 'Dist.' ) {
				sWeapon[ 'repeating_armes_' + idRow + '_arme_munition_display' ] = 1;
				sWeapon[ 'repeating_armes_' + idRow + '_arme_totalat' ] = safeInt( v[ "stats_jet_total" ] ) + safeInt( v[ `repeating_armes_${idRow}_arme_at` ] ) + safeInt( v[ `repeating_armes_${idRow}_munition_modAd` ] );
				sWeapon[ 'repeating_armes_' + idRow + '_arme_totaldegats' ] = v[ `repeating_armes_${idRow}_arme_degats` ] + "[Arme] + " + v[ `repeating_armes_${idRow}_munition_degats` ] + "[Munition]";
			}

			if( v[ `repeating_armes_${idRow}_arme_bonusforce` ] === "1" ) {
				sWeapon[ 'repeating_armes_' + idRow + '_arme_totaldegats' ] += " + " + v[ "bonusdegatsforce" ] + "[Bonus FO]";
			}

			sWeapon[ 'repeating_armes_' + idRow + '_arme_totaldegats' ] += " + " + v[ "bonusdegatsatk" ] + "[Bonus Equipement]";

			setAttrs( sWeapon, { silent: true } );
		});
	}

	// update all weapons roll if FO or JET is updated
	function updateWeapons() {
		getSectionIDs( "repeating_armes", function(idArray) {
			for( var i in idArray ) {
				updateWeapon( idArray[ i ] );
			}
		});
	}

	// attach an existing ammo to a weapon
	function updateAmmo( eventInfo ) {
		var ammo_selected = eventInfo[ "newValue" ];
		var section_selecd = eventInfo[ "sourceAttribute" ].split('-')[0]; // switch beetwen weapons or guns
		var idAmmo = 0;
		var sWeapon = {};

		sWeapon[ section_selecd + 'munition_degats' ] = "";
		sWeapon[ section_selecd + 'munition_modAd' ] = 0;
		sWeapon[ section_selecd + 'munition_nom' ] = "";
		sWeapon[ section_selecd + 'munition_effet' ] = "";

		getSectionIDs( "repeating_munitions", function(idarray) {
			// Search ammo_selected from weapon into munitions list
			getAttrs( [ ...idarray.map(id => `repeating_munitions_${id}_munition_nom`) ], function( sValues ) {
				for( var i in idarray ) {
					if( ammo_selected === sValues[`repeating_munitions_${idarray[i]}_munition_nom`] ) {
						idAmmo = idarray[i];
					}
				}

				if( idAmmo != 0 ) {
					// copy munition values into weapon's attr
					getAttrs( [ `repeating_munitions_${idAmmo}_munition_modAd`, `repeating_munitions_${idAmmo}_munition_degats`, `repeating_munitions_${idAmmo}_munition_effet` ], function( v ) {
						sWeapon[ section_selecd + 'munition_degats' ] = v[ `repeating_munitions_${idAmmo}_munition_degats` ];
						sWeapon[ section_selecd + 'munition_modAd' ] = v[ `repeating_munitions_${idAmmo}_munition_modAd` ];
						sWeapon[ section_selecd + 'munition_nom' ] = ammo_selected;
						sWeapon[ section_selecd + 'munition_effet' ] = v[ `repeating_munitions_${idAmmo}_munition_effet` ];

						setAttrs( sWeapon );
					});
				} else {
					setAttrs( sWeapon );
				}
			});
		});
	}

	// sum of armor's PR (physical or magical)
	function updatePR() {
		var prPhy = 0;
		var prMag = 0;
		getSectionIDs( "repeating_armures", function(idarray) {
			getAttrs( [ "prnat", "stats_pr_buff", ...idarray.map(id => `repeating_armures_${id}_armure_prphy`), ...idarray.map(id => `repeating_armures_${id}_armure_prmag`) ], function( sValues ) {
				var v = structSafeInt( sValues );

				for( var i in idarray) {
					prPhy += v[`repeating_armures_${idarray[i]}_armure_prphy`];
					prMag += v[`repeating_armures_${idarray[i]}_armure_prmag`];
				}

				setAttrs({
					"prphy": prPhy,
					"prmag": prMag,
					"pr": prPhy + prMag + v[ "prnat" ] + v[ "stats_pr_buff" ]
				});
			});
		});
	}

	// sum of gold and wealth
	function updatePO() {
		getAttrs( [	"richesse_or","richesse_argent","richesse_cuivre",
					"richesse_berylium","richesse_thritil",
					"richesse_billet10","richesse_billet50","richesse_billet100","richesse_billet500","richesse_billet1000" ],
				function( sValues ) {
			var v = structSafeInt( sValues );
			var richesse_total = v[ "richesse_or" ] + Math.floor( v[ "richesse_argent" ] * 0.1 ) + Math.floor( v[ "richesse_cuivre" ] * 0.01 );
			richesse_total += ( v[ "richesse_berylium" ] * 500 ) + ( v[ "richesse_thritil" ] * 100 );
			richesse_total += ( v[ "richesse_billet10" ] * 10 ) + ( v[ "richesse_billet50" ] * 50 ) + ( v[ "richesse_billet100" ] * 100 ) + ( v[ "richesse_billet500" ] * 500 ) + ( v[ "richesse_billet1000" ] * 1000 );

			setAttrs({
				"poids_bourses": v[ "richesse_or" ] + v[ "richesse_argent" ] + v[ "richesse_cuivre" ],
				"richesse_total": richesse_total
			});
		});
	}

	// sum of weight
	function updateCharge() {
		getAttrs( weightStats, function( sValues ) {
			var v = structSafeFloat( sValues );
			var boursesCharge = Math.floor( v[ "poids_bourses" ] * 0.1 ) * 0.1;
			var lingotsCharge = ( Math.floor( v[ "richesse_berylium" ] * 5 ) * 0.1 ) + ( Math.floor( v[ "richesse_thritil" ] * 3 ) * 0.1 );

			var livresCharge = v[ "poids_livres" ] * 0.5;
			var matosCharge = v[ "poids_materiels" ] + v[ "poids_butins" ] + v[ "poids_bouffes" ];
			var sacsCharge = ( boursesCharge + lingotsCharge + matosCharge + livresCharge ).toFixed( 1 );

			// Charge vs Encombrement
			var charCharge_max = v["personnage_charge_max" ];
			var sacsCharge_max= v[ "poids_sacs_max" ];
			var percentCharge = Math.floor( sacsCharge * 100 / sacsCharge_max );
			var surcharge = 0;

			if( sacsCharge >= charCharge_max ) {
				surcharge = 5; // Equipement très encombrant
			} else if( percentCharge >= 90 ) {
				surcharge = 4; // Sacs plein
			} else if( percentCharge >= 75 ) {
				surcharge = 3; // Sacs preque plein
			} else if( percentCharge >= 50 ) {
				surcharge = 2; // Sacs moitié plein
			} else if( percentCharge >= 25 ) {
				surcharge = 1; // Sacs pas trop plein
			}

			setAttrs({
				"poids_sacs": sacsCharge,
				"personnage_surcharge": surcharge
			});
		});
	}

	// update total weight
	function updateRSSum( section, attr, total ) {
		var sum = 0;
		getSectionIDs( section, function(idarray) {
			getAttrs( [ ...idarray.map(id => `${section}_${id}_${attr}`) ], function( sValues ) {
				var v = structSafeFloat( sValues );
				for( var i in idarray ) {
					sum += v[`${section}_${idarray[i]}_${attr}`];
				}
				setAttrs({
					[ total ]: sum
				});
			});

		});
	}

	// update book weight
	function updateLivresCharge() {
		getSectionIDs( 'repeating_livres', function(idarray) {
			setAttrs({
				"poids_livres": safeInt( idarray.length )
			});
		});
	}

	// set selected magic school into filter field
	function updateMagicSchoolTab( eventInfo ) {
		var sTabs = {};
		var selected = "all";

		getSectionIDs( "repeating_ecolesmagie", function(idarray) {
			for( var i in idarray ) {
				sTabs[ `repeating_ecolesmagie_${idarray[ i ]}_ecolemagie_selected` ] = 0;
			}

			if( eventInfo[ "sourceAttribute" ] === "ecolemagie_selectall" )
			{
				setAttrs( {"tab_ecolemagie": "all" } );
				sTabs[ "ecolemagie_selectall" ] = 1;
			}
			else
			{
				var field = eventInfo[ "sourceAttribute" ].replace( "_selected", "" );
				getAttrs( [ field ], function( v ) {
					setAttrs( { "tab_ecolemagie": v[ field ] } );
				});

				sTabs[ eventInfo[ "sourceAttribute" ] ] = 1;
				sTabs[ "ecolemagie_selectall" ] = 0;
			}

			setAttrs( sTabs, { silent: true } );
		});
	}

	// display spells depending on selected filter and level
	function displayMagicSpells() {
		var sDisplay = {};

		getSectionIDs( "repeating_magies", function(idarray) {
			getAttrs( [ "tab_ecolemagie", "tab_niveaumagie",
						...idarray.map(id => `repeating_magies_${id}_magie_ecole`),
						...idarray.map(id => `repeating_magies_${id}_magie_niveau`) ], function( v ) {
				var cur_ecole = v[ "tab_ecolemagie" ].trim().toLowerCase();
				var cur_level = v[ "tab_niveaumagie" ];

				for( var i in idarray ) {
					if( ( v[ `repeating_magies_${idarray[ i ]}_magie_ecole` ].trim().toLowerCase() === cur_ecole || cur_ecole === "all" ) && ( v[ `repeating_magies_${idarray[ i ]}_magie_niveau` ] === cur_level || cur_level === "all" ) ) {
						sDisplay[ `repeating_magies_${idarray[ i ]}_magie_filtre` ] = 1;
					} else {
						sDisplay[ `repeating_magies_${idarray[ i ]}_magie_filtre` ] = 0;
					}
				}
				setAttrs( sDisplay, { silent: true } );
			});
		});
	}

	// import json from compendium
	function importCompendium() {
		var err = "";
		var sAttrs = {};
		getAttrs( [ "compendium" ], function( v ) {
			// open json
			try {
				var sJson = JSON.parse( v[ "compendium" ] );
			} catch(e) {
				err = "Données non valides";
			}

			var newid = generateRowID();

			// set values
			for( var i in sJson ) {
				// replace placeholder 'rowid' by a new generatedID to create rows
				sAttrs[ i.replace( 'rowID', newid ) ] = sJson[ i ];
			}

			sAttrs[ "compendium" ] = err;

			setAttrs( sAttrs );
		});
	}

	// calculate the repair difficulty depending on specialisaiton, quality...
	function updateRepair() {
		getAttrs( [ "reparation_qualite", "reparation_specialiste", "stats_inge_total", "personnage_niveau" ], function( sValues ) {

			var v = structSafeInt( sValues );
			var reparation_difficulte = 0;
			var reparation_malusSpecialiste = 0;
			var requiredLevel = 1;
			var reparation_impossible = 0;

			if( v[ "reparation_qualite" ] === 1 ) { // Matos perrave
				reparation_difficulte = 6;
				reparation_malusSpecialiste = -2;
				requiredLevel = 1;
			} else if( v[ "reparation_qualite" ] === 2 ) { // Matos de base
				reparation_difficulte = 8;
				reparation_malusSpecialiste = -2;
				requiredLevel = 1;
			} else if( v[ "reparation_qualite" ] === 3 ) { // Matos correct
				reparation_difficulte = 10;
				reparation_malusSpecialiste = -4;
				requiredLevel = 2;
			} else if( v[ "reparation_qualite" ] === 4 ) { // Matos de qualité
				reparation_difficulte = 12;
				reparation_malusSpecialiste = -6;
				requiredLevel = 3;
			} else if( v[ "reparation_qualite" ] === 5 ) { // Matos de luxe
				reparation_difficulte = 14;
				reparation_malusSpecialiste = -20;
				requiredLevel = 5;
			} else if( v[ "reparation_qualite" ] === 6 ) { // Matos d'artisan
				reparation_difficulte = 16;
				reparation_malusSpecialiste = -20;
				requiredLevel = 5;
			}

			var reparation_bonus = v[ "stats_inge_total" ] - reparation_difficulte;
			// bonus only for specialists
			if( v[ "reparation_specialiste" ] === 0 ) {
				if( reparation_bonus > 0 ) {
					reparation_bonus = 0;
				}

				reparation_bonus = reparation_bonus + reparation_malusSpecialiste;
			}

			// Check required level
			var charLevel = v[ "personnage_niveau" ] || 1;
			if( requiredLevel > charLevel ) {
				reparation_bonus = -20;
			}

			// Impossible task
			if( reparation_bonus <= -20 ) {
				reparation_impossible = 1;
			}

			setAttrs({
				"reparation_difficulte": reparation_difficulte,
				"reparation_bonus": reparation_bonus,
				"reparation_impossible": reparation_impossible
			});
		});
	}

	// update recipe difficulty depending on inge stats
	function updateRecipe( idRow ) {
		var sRecette = {};
		var recette_bonus = 0;

		getAttrs( [ 'stats_inge_total',
					`repeating_recettes_${idRow}_recette_specialiste`, `repeating_recettes_${idRow}_recette_difficulte`, `repeating_recettes_${idRow}_recette_malusspecialiste`
				], function ( sValues ) {
			var v = structSafeInt( sValues );

			recette_bonus = v[ "stats_inge_total" ] - v[ `repeating_recettes_${idRow}_recette_difficulte` ];

			if( v[ `repeating_recettes_${idRow}_recette_specialiste` ] === 0 ) {
				if( recette_bonus > 0 ) {
					recette_bonus = 0;
				}

				recette_bonus = recette_bonus + v[ `repeating_recettes_${idRow}_recette_malusspecialiste` ];
			}

			sRecette[ `repeating_recettes_${idRow}_recette_bonus` ] = recette_bonus;
			setAttrs( sRecette );
		});
	}

	// Update ALL recipes if inge is updated
	function updateRecipes() {
		getSectionIDs( "repeating_recettes", function(idArray) {
			for( var i in idArray ) {
				updateRecipe( idArray[ i ] );
			}
		});
	}

	function start_export() {
		var sJson = {};
		var dataBase = {
			"simple": [ "personnage_nom", "personnage_origine", "personnage_metiers", "personnage_sex", "personnage_age", "personnage_poids", "personnage_taille", "personnage_notes", "personnage_butins",
						"ev", "ev_max", "ea", "ea_max", "personnage_niveau", "personnage_xp", "personnage_pointdestin", "bonusdegatssorts",
						"personnage_langue", "personnage_vision", "personnage_nyctalopie", "personnage_ouie", "personnage_odorat", "personnage_charge_max", "deplacement_mod", "stats_mvt_buff",
						"pr_tete", "pr_bras", "pr_torse", "pr_bouclier", "pr_jambes", "pr_pieds", "pr_mains", "prnat", "prphy", "prmag", "pr", "pr_max", "stats_pr_buff",
						"bivouac_couverture", "bivouac_couverture_recup", "bivouac_matelas", "bivouac_matelas_recup", "bivouac_tente", "bivouac_tente_recup",
						"stats_courage", "stats_courage_mod", "stats_courage_temp", "stats_intelligence", "stats_intelligence_mod", "stats_intelligence_temp", "stats_charisme", "stats_charisme_mod", "stats_charisme_temp", "stats_adresse", "stats_adresse_mod", "stats_adresse_temp", "stats_force", "stats_force_mod", "stats_force_temp",
						"stats_attaque", "stats_attaque_mod", "stats_attaque_temp", "stats_parade", "stats_parade_mod", "stats_parade_temp", "stats_jet", "stats_jet_mod", "stats_jet_temp", "stats_esquive", "stats_esquive_mod", "stats_esquive_temp", "stats_fouille_mod", "stats_fouille_temp", "stats_inge", "stats_inge_mod", "stats_inge_temp",
						"stats_magiephy", "stats_magiephy_mod", "stats_magiephy_temp", "stats_magiepsy", "stats_magiepsy_mod", "stats_magiepsy_temp", "stats_resimagie", "stats_resimagie_mod", "stats_resimagie_temp",
						"richesse_or", "richesse_argent", "richesse_cuivre", "richesse_berylium", "richesse_thritil", "richesse_billet10", "richesse_billet50", "richesse_billet100", "richesse_billet500", "richesse_billet1000", "richesse_enbanque",
						"displayjet", "displaycriteffets", "tab_pnj" ],
			"repeating": [
				{ zone:"competences", attr: ["competence_nom", "competence_effet", "competence_epreuve", "competence_jet", "competence_mod"] },
				{ zone:"armes", attr: ["arme_nom", "arme_portee", "arme_at", "arme_prd", "arme_degats", "arme_rup", "arme_munition_display", "munition_nom", "munition_effet", "munition_modad", "munition_degats", "arme_effet", "arme_note", "arme_bonusforce", "arme_note_display", "arme_bonusforce", "arme_critique", "arme_fumble", "arme_effet_display" ] },
				{ zone:"guns", attr: ["gun_nom", "gun_portee1", "gun_portee2", "gun_portee2_display", "gun_portee3", "gun_portee3_display", "gun_degats1", "gun_degats2", "gun_degats3", "gun_epreuve", "gun_epreuve_mod", "gun_critique", "gun_fumble", "munition_nom", "munition_effet", "munition_degats", "munition_modad", "gun_special", "gun_special_display", "gun_cadence", "gun_reload", "gun_combustion", "gun_munition", "gun_fonctionnement", "gun_note" ] },
				{ zone:"armures", attr: ["armure_nom", "armure_prphy", "armure_prmag", "armure_rup", "armure_effet"] },
				{ zone:"sacs", attr: ["sac_nom", "sac_charge_max"] },
				{ zone:"materiels", attr: ["materiel_nom", "materiel_poids"] },
				{ zone:"recettes", attr: ["recette_nom", "recette_effet", "recette_specialiste", "recette_niveau", "recette_xp", "recette_duree", "recette_outils", "recette_materiaux", "recette_materiauxspe", "recette_assistant", "recette_difficulte", "recette_malusspecialiste", "recette_mod", "recette_resultats", "recette_prix", "recette_prixfabrication" ] },
				{ zone:"ape", attr: ["ape_nom", "ape_note", "ape_effet", "ape_occurence"] },
				{ zone:"conditions", attr: ["condition_provenance", "condition_nom", "condition_effet", "condition_actif" ] },
				{ zone:"gemmes", attr: ["gemme_nom", "gemme_ug"] },
				{ zone:"potions", attr: ["conso_nom", "conso_count", "conso_effet"] },
				{ zone:"coupsspeciaux", attr: ["coupspecial_nom", "coupspecial_jet", "coupspecial_mod", "coupspecial_degats", "coupspecial_degats_arme", "coupspecial_utilisation", "coupspecial_echec", "coupspecial_effet", "coupspecial_note", "coupspecial_condition", "coupspecial_critique", "coupspecial_fumble" ] },
				{ zone:"munitions", attr: ["munition_nom", "munition_modad", "munition_count", "munition_degats", "munition_rup", "munition_effet"] },
				{ zone:"vetements", attr: ["vetement_nom", "vetement_effet"] },
				{ zone:"bourses", attr: ["bourse_nom", "bourse_charge_max"] },
				{ zone:"butins", attr: ["butin_nom", "butin_poids"] },
				{ zone:"quetes", attr: ["quete_nom"] },
				{ zone:"poisons", attr: ["conso_nom", "conso_count", "conso_effet"] },
				{ zone:"bagues", attr: ["bague_nom", "bague_count", "bague_bonus"] },
				{ zone:"ecolesmagie", attr: ["ecolemagie"] },
				{ zone:"reliques", attr: ["relique_nom", "relique_effet"] },
				{ zone:"bouffes", attr: ["bouffe_nom", "bouffe_poids"] },
				{ zone:"livres", attr: ["livre_nom"] },
				{ zone:"antidotes", attr: ["conso_nom", "conso_count", "conso_effet"] },
				{ zone:"magies", attr: ["magie_ecole", "magie_niveau", "magie_nom", "magie_incantation", "magie_duree", "magie_cout", "magie_portee", "magie_aireeffet", "magie_notes", "magie_epreuvelanceur_jet", "magie_epreuvelanceur_mod", "magie_epreuvecible_jet", "magie_epreuvecible_mod", "magie_soin", "magie_degats", "magiebonusint", "magie_effet", "magie_ingre", "creature_ev", "creature_int", "creature_at", "creature_def", "creature_cou", "creature_pr", "creature_xp", "creature_resimagie", "creature_degats", "magie_epreuveappel_mod", "magie_epreuvecontrol_mod", "magie_epreuverevocation_mod", "magie_critique", "magie_fumble", "magie_formule"] },
				{ zone:"ingre", attr: ["ingre_nom", "ingre_count"] },
				{ zone:"compagnons", attr: ["compagnon_nom", "compagnon_type", "compagnon_ev", "compagnon_ev_max", "compagnon_cou", "compagnon_at", "compagnon_esquive", "compagnon_prd", "compagnon_charge", "compagnon_charge", "compagnon_pr", "compagnon_resimagie", "compagnon_deplacement_assaut_sol", "compagnon_deplacement_assaut_air", "compagnon_deplacement_charge_sol", "compagnon_deplacement_charge_air", "compagnon_deplacement_voyage_sol", "compagnon_deplacement_voyage_air", "compagnon_deplacement_jour_sol", "compagnon_deplacement_jour_air", "compagnon_combat", "compagnon_entretien", "compagnon_autres", "compagnon_materiel1_nom", "compagnon_materiel2_nom", "compagnon_materiel3_nom", "compagnon_materiel1", "compagnon_materiel2", "compagnon_materiel3"] },
				{ zone:"pnjarmes", attr: ["arme_nom", "arme_jet", "arme_at", "arme_prd", "arme_degats", "arme_rup"] },
				{ zone:"traits", attr: ["trait_nom", "trait_effet"] }
			]
		};
		// get all simple values
		getAttrs( dataBase.simple, function( v ) {
			sJson = v;
			// Get repeating values with recursive function to avoid asynch problems
			getRepeatingFields( dataBase.repeating, 0, sJson );
		});
	}

	function getRepeatingFields( dataBase, i, sJson ) {
		var _aAttr = [];
		var zone = dataBase[ i ][ "zone" ];
		var attr = dataBase[ i ][ "attr" ];
		var i = i + 1;

		// get sections ids
		getSectionIDs( `repeating_${zone}`, function( idarray ) {
			if ( idarray.length > 0 ) {
				for( var j in attr ) {
					_aAttr.push( ...idarray.map(id => `repeating_${zone}_${id}_${attr[ j ]}`) );
				}
				// get all attrs for all sections ids
				getAttrs( _aAttr, function ( v ) {
					var sSection = {};
					// reassemble attrs by id
					for( var key in v ) {
						var id = key.split( '_' )[2];
						// replace the id by a placeholder "rowID" cause we can't import existing ids
						var attr_name = key.replace( id, 'rowID' );

						if( sSection[ id ] === undefined ) {
							sSection[ id ] = {};
						}
						sSection[ id ][ attr_name ] = v[ key ];
					}
					// add an array with all attrs for each sections
					sJson[ zone ] = [];
					for( var id in sSection) {
						sJson[ zone ].push( sSection[ id ] );
					}
					if( dataBase.length > i ) {
						// call recursively getRepeatingFields depending on dataBase.repeating.length
						getRepeatingFields( dataBase, i, sJson);
					} else if( dataBase.length === i ) {
						// or call finish function
						updateExportJson( sJson );
					}
				});
			} else {
				if( dataBase.length > i ) {
					getRepeatingFields( dataBase, i, sJson);
				} else if( dataBase.length === i ) {
					updateExportJson( sJson );
				}
			}
		});
	}

	function updateExportJson( sJson ) {
		// stringify all our simple and repeating attrs / values
		setAttrs( {
			"json_export" : JSON.stringify( sJson ),
			"export_start": 0
		}, { silent: true } );
	}

	function reset_export() {
		setAttrs( {
			"json_export" : "",
			"export_start": 0
		}, { silent: true } );
	}

	function start_import() {
		var err = "";

		getAttrs( [ "json_import", "import_start" ], function ( v ) {
			if( v[ "import_start" ] === "1" )
			{
				// open json
				try {
					var sJson = JSON.parse( v[ "json_import" ] );
				} catch(e) {
					err = "Données non valides";
				}

				if( err === "" ) {
					// reset sheet repeating section
					var aSections = [	"antidotes","ape","armes","armures","bagues","bouffes","bourses","butins","compagnons","competences","conditions","coupsspeciaux","ecolesmagie",
										"gemmes","guns","ingre","livres","magies","materiels","munitions","pnjarmes","poisons","potions","quetes","recettes","reliques","sacs","traits","vetements" ];
					for( var i in aSections ) {
						var section = `repeating_${aSections[ i ]}`;
						(function( section ) {
							getSectionIDs( section, function(idarray) {
								for( var j in idarray ) {
									removeRepeatingRow( `${section}_${idarray[ j ]}` );
								}
							});
						})(section);
					}

					var sAttrs = {};
					for( var i in sJson ) {
						if( sJson[ i ] instanceof Array ) {
							// import repeating values
							for( var j in sJson[ i ] ) {
								var newid = generateRowID();
								for( var k in sJson[ i ][ j ] ) {
									// replace placeholder 'rowid' by a new generatedID to create rows
									sAttrs[ k.replace( 'rowID', newid ) ] = sJson[ i ][ j ][ k ];
								}
							}
						} else {
							// Import simple values
							sAttrs[ i ] = sJson[ i ];
						}
					}
					var _silent = false;
					if( sAttrs[ "tab_pnj" ] === "1" ) {
						_silent = true;
					}
					setAttrs( sAttrs, { silent: _silent } );
				}

				setAttrs( {
					"json_import": err,
					"import_start": 0
				}, { silent: true } );
			}
		});
	}

	/*----------------
	Version handling
	----------------*/
	on("sheet:opened", function() {
		detect_version();
	});

	function detect_version() {
		getAttrs( [ "version" ], function( v ) {
			var vrs = parseFloat( v[ "version" ] ) || 1.0;
			console.log("Détection de la version : " + vrs );
			if( vrs < 2.0 ) {
				getAttrs( [ "level", "valattaque", "valparade", "class", "race", "experience" ], function( v ) {
					if( v[ "level" ] != undefined || v[ "valattaque" ] != undefined || v[ "valparade" ] != undefined || v[ "class" ] != undefined || v[ "race" ] != undefined || v[ "experience" ] != undefined ) {
						console.log( "Début du process d'import..." );
						update_process();
					}
					console.log( "Mise à jour de la version..." );
				});
			} else if( vrs < 2.4 ) {
				// uptodate
				updateSecondaryStats();
				updateWeapons();
				return;
			} else if( vrs < 2.82 ) {
				console.log( "nouvelle version, ouverture du patch note" );
				setAttrs( { "modal_patchnote" : 1 } );
			}
			setAttrs( { "version" : 2.9 } );
			console.log( "ok" );
		});
	}

	function update_process() {
		var _aNewAttr = [];
		var _aOldAttr = [];
		var _sNewValues = {};

		// sheet2.0 attr "Character"
		_aNewAttr = _aNewAttr.concat( [ "personnage_nom", "personnage_niveau","personnage_xp","personnage_metiers","personnage_origine","personnage_pointdestin","personnage_langue" ] );
		_aOldAttr = _aOldAttr.concat( [ "charactername", "level","experience","class","race","pointdestin","langue" ] );

		// sheet2.0 attr "stats"
		_aNewAttr = _aNewAttr.concat( [ "stats_courage", "stats_intelligence","stats_charisme","stats_adresse","stats_force" ] );
		_aOldAttr = _aOldAttr.concat( [ "courage","intelligence","charisme","adresse","force" ] );

		// sheet2.0 attr "stats_mod"
		_aNewAttr = _aNewAttr.concat( [ "stats_courage_mod", "stats_intelligence_mod","stats_charisme_mod","stats_adresse_mod","stats_force_mod" ] );
		_aOldAttr = _aOldAttr.concat( [ "couragemod", "intelligencemod","charismemod","adressemod","forcemod" ] );

		// Sheet2.0 attr "richesses"
		_aNewAttr = _aNewAttr.concat( [ "richesse_or","richesse_argent" ] );
		_aOldAttr = _aOldAttr.concat( [ "po","pa" ] );

		// sheet2.0 attr "Combat"
		_aNewAttr = _aNewAttr.concat( [ "ev_max","ea_max","stats_attaque","stats_attaque_mod","stats_parade","stats_parade_mod" ] );
		_aOldAttr = _aOldAttr.concat( [ "evmax","eamax","ValAttaque","ValAttaqueMod","ValParade","ValParadeMod" ] );

		// sheet2.0 attr "magie"
		_aNewAttr = _aNewAttr.concat( [ "stats_magiephy","stats_magiephy_mod","stats_magiepsy","stats_magiepsy_mod","stats_resimagie","stats_resimagie_mod" ] );
		_aOldAttr = _aOldAttr.concat( [ "magiephy","magiephymod","magiepsy","magiepsymod","resimagie","resimagiemod" ] );

		// Sheet2.0 attr "arme"
		_aNewAttr = _aNewAttr.concat( [ "repeating_butins_rowID_butin_nom","repeating_butins_rowID_butin_nom","repeating_butins_rowID_butin_nom","repeating_butins_rowID_butin_nom" ] );
		_aOldAttr = _aOldAttr.concat( [ "arme01","arme02","arme03","arme04" ] );

		// Sheet2.0 attr "armures"
		_aNewAttr = _aNewAttr.concat( [ "repeating_armures_rowID_armure_nom","repeating_armures_rowID_armure_nom","repeating_armures_rowID_armure_nom","repeating_armures_rowID_armure_nom" ] );
		_aOldAttr = _aOldAttr.concat( [ "equip01","equip02","equip03","equip04" ] );

		// Sheet2.0 attr "Inventaire"
		_aNewAttr = _aNewAttr.concat( [ "repeating_materiels_rowID_materiel_nom","repeating_materiels_rowID_materiel_nom","repeating_materiels_rowID_materiel_nom","repeating_materiels_rowID_materiel_nom" ] );
		_aOldAttr = _aOldAttr.concat( [ "inv01","inv02","inv03","inv04" ] );

		// Sheet2.0 attr "Compétences"
		_aNewAttr = _aNewAttr.concat( [ "repeating_competences_rowID_competence_nom","repeating_competences_rowID_competence_nom","repeating_competences_rowID_competence_nom","repeating_competences_rowID_competence_nom" ] );
		_aOldAttr = _aOldAttr.concat( [ "raceability01","raceability02","raceability03","raceability04" ] );

		// Sheet2.0 attr "Compétences"
		_aNewAttr = _aNewAttr.concat( [ "repeating_competences_rowID_competence_nom","repeating_competences_rowID_competence_nom","repeating_competences_rowID_competence_nom","repeating_competences_rowID_competence_nom" ] );
		_aOldAttr = _aOldAttr.concat( [ "classability01","classability02","classability03","classability04" ] );

		// Get the old attr values
		getAttrs( _aOldAttr, function( v ) {
			// Each new attr take the value of the old attr
			for( var i in _aNewAttr ) {
				var _oldAttr = _aOldAttr[ i ];
				var _newAttr = _aNewAttr[ i ];
				var _oldValue = v[ _oldAttr ];

				if( _oldValue != undefined ) {
					// If the new attr is a repeating row > get a rowId
					if( _newAttr.indexOf( "_rowID_" ) !== -1 ) {
						_newAttr = _newAttr.replace( "rowID", generateRowID() );
					}

					_sNewValues[ _newAttr ] = _oldValue;
				}
			}
			// Update
			setAttrs( _sNewValues );
		});

		// old sheet sections attr to new sheet sections attr
		_sNewValues = {};
		var _aOldSections = [
			{
				oldSection: "cac",
				newSection: "armes",
				oldAttr: [ "armenom", "armeat", "armeprd", "armedes", "armedegats" ],
				newAttr: [ "arme_nom", "arme_at", "arme_prd", "arme_degats", "arme_degats" ]
			},
			{
				oldSection: "arme",
				newSection: "butins",
				oldAttr: [ "armes" ],
				newAttr: [ "butin_nom" ]
			},
			{
				oldSection: "equipement",
				newSection: "armures",
				oldAttr: [ "equipement" ],
				newAttr: [ "armure_nom" ]
			},
			{
				oldSection: "inventaire",
				newSection: "materiels",
				oldAttr: [ "inventaire" ],
				newAttr: [ "materiel_nom" ]
			},
			{
				oldSection: "compin",
				newSection: "competences",
				oldAttr: [ "compin" ],
				newAttr: [ "competence_nom" ]
			},
			{
				oldSection: "classabilities",
				newSection: "competences",
				oldAttr: [ "classabilities" ],
				newAttr: [ "competence_nom" ]
			},
			{
				oldSection: "spells",
				newSection: "magies",
				oldAttr: [ "sortnom_1","magietype","sortdesattaque_1","sortdesbonusattaque_1","sortdegatdes_1","sortdegatbonus_1","sortcout_1" ],
				newAttr: [ "magie_nom","magie_epreuvelanceur_jet","magie_epreuvelanceur_mod","magie_epreuvelanceur_mod","magie_degats","magie_degats","magie_cout" ]
			},
			{
				oldSection: "spells",
				newSection: "magies",
				oldAttr: [ "creaturenom_1","invocbonus_1","invoccontrole_1","invocrevoc_1","invoccout_1" ],
				newAttr: [ "magie_nom","magie_epreuveappel_mod","magie_epreuvecontrol_mod","magie_epreuverevocation_mod","magie_cout" ]
			}
		];

		for( var i in _aOldSections ) {
			// Get Old section IDs
			convertRS( _aOldSections[ i ] );
		}
	}

	function convertRS( sOldSections ) {
		var _oldSection = "repeating_" + sOldSections[ "oldSection" ];
		var _newSection = "repeating_" + sOldSections[ "newSection" ];
		var _aOldAttr = [];

		// get sections id of the old Section
		getSectionIDs( _oldSection, function( idarray ) {
			if ( idarray.length > 0 ) {
				_aOldAttr = [];

				// create an array with all attr combine with all ids of the section
				for( var i_oldAttr in sOldSections[ "oldAttr" ] ) {
					_oldAttr = sOldSections[ "oldAttr" ][ i_oldAttr ];
					_aOldAttr.push( ...idarray.map(id => `${_oldSection}_${id}_${_oldAttr}`) );
				}

				// get all values for a section
				getAttrs( _aOldAttr, function (v) {
					var _sNewValues = {}
					for( var i_idarray in idarray ) {

						// Create new rows in new section
						var newrowid = generateRowID();
						var _oldSectionID = _oldSection + "_" + idarray[ i_idarray ] + "_";
						var _newSectionID = _newSection + "_" + newrowid + "_";

						for( var i_attr in sOldSections[ "newAttr" ] ) {
							// Each new attr take the value of the old attr
							var _oldAttr = _oldSectionID + sOldSections[ "oldAttr" ][ i_attr ];
							var _newAttr = _newSectionID + sOldSections[ "newAttr" ][ i_attr ];
							var _oldValue = v[ _oldAttr ];

							if( _oldValue != undefined ) {
								// exceptions
								if( sOldSections[ "oldAttr" ][ i_attr ] === "armedes" || sOldSections[ "oldAttr" ][ i_attr ] === "SortDesAttaque_1" || sOldSections[ "oldAttr" ][ i_attr ] === "SortDegatDes_1" ) {
									_sNewValues[ _newAttr ] = _oldValue + "d6";
								} else if( sOldSections[ "oldAttr" ][ i_attr ] === "armedegats" || sOldSections[ "oldAttr" ][ i_attr ] === "SortDesBonusAttaque_1" || sOldSections[ "oldAttr" ][ i_attr ] === "SortDegatBonus_1" ) {
									_sNewValues[ _newAttr ] = ( _sNewValues[ _newAttr ] || "1d6" ) + "+" + _oldValue;
								} else {
									_sNewValues[ _newAttr ] = _oldValue;
								}
							}
						}
					}
					setAttrs( _sNewValues );
				});
			}
		});
	}
</script>

<rolltemplate class="sheet-rolltemplate-magie">
	<table class="sheet-rolltemplate-table">
		<tr><th>{{name}}</th></tr>
		<tr>
			<td><span class="tcat">Ecole </span>{{magie_ecole}} - <span class="tcat">Niveau </span>{{magie_niveau}}</td>
		</tr>
		{{#magie_formule}}
			<tr>
				<td><span class="tcat">Mot de pouvoir </span>{{magie_formule}}</td>
			</tr>
		{{/magie_formule}}
		{{#magie_incantation}}
			<tr>
				<td><span class="tcat">Durée d'incantation </span>{{magie_incantation}}</td>
			</tr>
		{{/magie_incantation}}
		{{#magie_duree}}
			<tr>
				<td><span class="tcat">Durée </span>{{magie_duree}}</td>
			</tr>
		{{/magie_duree}}
		{{#magie_cout}}
			<tr>
				<td><span class="tcat">Coût </span>{{magie_cout}}</td>
			</tr>
		{{/magie_cout}}
		{{#magie_portee}}
			<tr>
				<td><span class="tcat">Portée </span>{{magie_portee}}</td>
			</tr>
		{{/magie_portee}}
		{{#magie_aireeffet}}
			<tr>
				<td><span class="tcat">Aire d’effet </span>{{magie_aireeffet}}</td>
			</tr>
		{{/magie_aireeffet}}
		{{#magie_display_epreuve}}
			<tr>
				<td><span class="tcat">Épreuve </span>{{magie_epreuve}}</td>
			</tr>
		{{/magie_display_epreuve}}
		{{#magie_display_resistance}}
			<tr>
				<td><span class="tcat">Resistance </span>{{magie_resistance}}</td>
			</tr>
		{{/magie_display_resistance}}
		<tr><td><hr></td></tr>
		{{#magie_soin}}
			<tr>
				<td><span class="tcat">Soin </span>{{magie_soin}}</td>
			</tr>
		{{/magie_soin}}
		{{#magie_degats}}
			<tr>
				<td><span class="tcat">Dégats </span>{{magie_degats}} {{#rollGreater() magie_bonusint 0}}+ Bonus Int{{/rollGreater() magie_bonusint 0}}</td>
			</tr>
		{{/magie_degats}}
		<tr>
			<td>{{magie_effet}}</td>
		</tr>
		{{#magie_critique}}
			<tr>
				<td><span class="tcat">Critique </span>{{magie_critique}}</td>
			</tr>
		{{/magie_critique}}
		{{#magie_fumble}}
			<tr>
				<td><span class="tcat">Échec critique </span>{{magie_fumble}}</td>
			</tr>
		{{/magie_fumble}}
		{{#magie_ingre}}
			<tr><td><hr></td></tr>
			<tr>
				<td><span class="tcat">Ingrédients </span><br>{{magie_ingre}}</td>
			</tr>
		{{/magie_ingre}}

		{{#creature_ev}}
			<tr><td><hr></td></tr>
			<tr><th>Créature invoquée :</th></tr>
			<tr><td><span class="tcat">EV </span>{{creature_ev}} - <span class="tcat">INT </span>{{creature_int}}</td></tr>
			<tr><td><span class="tcat">AT </span>{{creature_at}} - <span class="tcat">PRD/ESQ </span>{{creature_def}}</td><tr>
			<tr><td><span class="tcat">COU </span>{{creature_cou}} - <span class="tcat">RM </span>{{creature_resimagie}}</td><tr>
			<tr><td><span class="tcat">XP </span>{{creature_xp}} - <span class="tcat">PR </span>{{creature_pr}}</td><tr>
			<tr><td><span class="tcat">Dégats </span>{{creature_degats}}</td><tr>
			<tr><td><span class="tcat">Appel </span>Magie PSY + {{magie_epreuveappel_mod}}</td><tr>
			<tr><td><span class="tcat">Contrôle </span>Magie PSY + {{magie_epreuvecontrol_mod}}</td><tr>
			<tr><td><span class="tcat">Révocation </span>Magie PSY + {{magie_epreuverevocation_mod}}</td><tr>
		{{/creature_ev}}

		{{#magie_notes}}
			<tr><td><hr></td></tr>
			<tr>
				<td><span class="tcat">Notes : </span><br>{{magie_notes}}</td>
			</tr>
		{{/magie_notes}}
	</table>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-recette">
	<table class="sheet-rolltemplate-table">
		<tr><th>{{recette_nom}}</th></tr>
		<tr><td>{{recette_effet}}</td></tr>
		<tr>
			<td><span class="tcat">Niveau : </span>à partir du niveau {{recette_niveau}}</td>
		</tr>
		<tr>
			<td><span class="tcat">Caractéristiques : </span>{{recette_resultats}}</td>
		</tr>
		<tr><td><hr></td></tr>
		<tr>
			<td><span class="tcat">Matériaux : </span>{{recette_materiaux}}</td>
		</tr>
		{{#recette_materiauxspe}}
			<tr>
				<td><span class="tcat">+Matériaux spéciaux : </span>{{recette_materiauxspe}}</td>
			</tr>
		{{/recette_materiauxspe}}
		<tr>
			<td><span class="tcat">Temps de confection : </span>{{recette_duree}}</td>
		</tr>
		<tr>
			<td><span class="tcat">Outils : </span>{{recette_outils}}</td>
		</tr>
		<tr>
			<td><span class="tcat">Difficulté : </span>{{recette_difficulte}} (+{{recette_xp}} XP en cas de réussite)</td>
		</tr>
		<tr>
			<td>
				<span class="tcat">Prix de fabrication : </span> {{recette_prixfabrication}}<br />
			 	<span class="tcat">Prix de vente : </span> {{recette_prix}}
			</td>
		</tr>
	</table>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-coupSpecial">
	<table class="sheet-rolltemplate-table">
		<tr><th>{{name}}</th></tr>
		<tr>
			<td><span class="tcat">Utilisation : </span>{{coupspecial_utilisation}}</td>
		</tr>
		<tr>
			<td><span class="tcat">- En cas d'échec, </span>{{coupspecial_echec}}</td>
		</tr>
		<tr><td><hr></td></tr>
		<tr>
			<td><span class="tcat">Effets : </span>{{coupspecial_effet}}</td>
		</tr>
		{{#coupspecial_condition}}
		<tr>
			<td><span class="tcat">Conditions : </span>{{coupspecial_condition}}</td>
		</tr>
		{{/coupspecial_condition}}
		<tr>
			<td><span class="tcat">Dégats : </span>{{#coupspecial_degats_arme}}Dégats de l'arme + {{/coupspecial_degats_arme}}{{coupspecial_degats}}</td>
		</tr>
		{{#coupspecial_note}}
		<tr>
			<td><span class="tcat">- </span>{{coupspecial_note}}</td>
		</tr>
		{{/coupspecial_note}}
		<tr><td><hr></td></tr>
		<tr>
			<td><span class="tcat">En cas d'échec critique : </span><br />{{coupspecial_fumble}}</td>
		</tr>
		<tr>
			<td><span class="tcat">Reussite critique : </span>{{coupspecial_critique}}</td>
		</tr>
	</table>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-atk">
	<table class="sheet-rolltemplate-default">
		<caption>{{name}}</caption>
		<tbody>
			<tr>
				<td>AT</td>
				<td>{{at}}</td>
			</tr>
			{{#rollGreater() display_effets 0}}
			<tr>
				<td>Effets</td>
				<td>{{effets}}</td>
			</tr>
			{{/rollGreater() display_effets 0}}
			{{#rollGreater() display_notes 0}}
			<tr>
				<td>Notes</td>
				<td>{{notes}}</td>
			</tr>
			{{/rollGreater() display_notes 0}}
			<tr>
				<td>Résultat</td>
				<td>{{results}}</td>
			</tr>
			<tr>
				<td>{{btn_degats}}</td>
				<td>
					{{#rollWasCrit() results }}{{btn_critique}}{{/rollWasCrit() results }}
					{{#rollWasFumble() results }}{{btn_fumble}}{{/rollWasFumble() results }}
				</td>
			</tr>
		</tbody>
	</table>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-prd">
	<table class="sheet-rolltemplate-default">
		<caption>{{name}}</caption>
		<tbody>
			<tr>
				<td>PRD</td>
				<td>{{prd}}</td>
			</tr>
			<tr>
				<td>Résultat</td>
				<td>{{results}}</td>
			</tr>
			<tr>
				<td></td>
				<td>
					{{#rollWasCrit() results }}{{btn_critique}}{{/rollWasCrit() results }}
					{{#rollWasFumble() results }}{{btn_fumble}}{{/rollWasFumble() results }}
				</td>
			</tr>
		</tbody>
	</table>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-dmg">
	<table class="sheet-rolltemplate-default">
		<caption>{{name}}</caption>
		<tbody>
			<tr>
				<td>Dégats</td>
				<td>{{dmg}}{{#typeDegat}} ({{typeDegat}}){{/typeDegat}}</td>
			</tr>
			{{#munition}}
			<tr>
				<td>Munition</td>
				<td>{{munition}}</td>
			</tr>
			{{#munition_effet}}
			<tr>
				<td>Effets</td>
				<td></td>
			<tr>
				<td colspan="2" class="sheet-td-noFirst">{{munition_effet}}</td>
			</tr>
			{{/munition_effet}}
			{{/munition}}
		</tbody>
	</table>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-gun_atk">
	<table class="sheet-rolltemplate-default">
		<caption>{{name}}</caption>
		<tbody>
			{{#fonctionnement}}
			<tr>
				<td>Fonctionnement</td>
				<td></td>
			</tr>
			<tr>
				<td colspan="2" class="sheet-td-noFirst">{{fonctionnement}}</td>
			</tr>
			<tr>
				<td>Résultat</td>
				<td>{{fonctionnement_results1}} & {{fonctionnement_results2}}</td>
			</tr>
			<tr>
				<td class="sheet-td-noFirst">{{btn_tir}}</td>
				<td></td>
			</tr>
			{{/fonctionnement}}
			{{#at}}
			<tr>
				<td>Tir</td>
				<td>{{at}}</td>
			</tr>
			<tr>
				<td>Résultat</td>
				<td>{{results}}</td>
			</tr>
			{{#rollGreater() display_special 0}}
			<tr>
				<td>Spécial</td>
				<td></td>
			</tr>
			<tr>
				<td colspan="2" class="sheet-td-noFirst">{{special}}</td>
			</tr>
			{{/rollGreater() display_special 0}}
			<tr>
				<td class="sheet-td-noFirst">{{btn_degats}}</td>
				<td>
					{{#rollWasCrit() results }}{{btn_critique}}{{/rollWasCrit() results }}
					{{#rollWasFumble() results }}{{btn_fumble}}{{/rollWasFumble() results }}
				</td>
			</tr>
			{{/at}}
		</tbody>
	</table>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-gun_dmg">
	<table class="sheet-rolltemplate-default">
		<caption>{{name}}</caption>
		<tbody>
			<tr>
				<td class="sheet-td-noFirst">{{btn_degats1}}</td>
				{{#rollGreater() btn_degats2_display 0}}
				<td>{{btn_degats2}}</td>
				{{/rollGreater() btn_degats2_display 0}}
				{{#rollGreater() btn_degats3_display 0}}
				<td>{{btn_degats3}}</td>
				{{/rollGreater() btn_degats3_display 0}}
			</tr>
		</tbody>
	</table>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-crit_tranchant">
	<table class="sheet-rolltemplate-default">
		<caption>{{name}}</caption>
		<tbody>
			<tr>
				<td>Résolution</td>
				<td>{{results}}</td>
			</tr>
			{{#rollTotal() displayEffets 1}}
				{{#rollBetween() results 1 2}}
					<tr><td colspan="2" class="sheet-td-noFirst">Incision profonde</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Degâts +1</td></tr>
				{{/rollBetween() results 1 2}}
				{{#rollBetween() results 3 4}}
					<tr><td colspan="2" class="sheet-td-noFirst">Incision vraiment profonde</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Degâts +2</td></tr>
				{{/rollBetween() results 3 4}}
				{{#rollBetween() results 5 6}}
					<tr><td colspan="2" class="sheet-td-noFirst">Plaie impressionnate et dommages à l'armure</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Degâts +3</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Pièce d'armure concernée PR -1</td></tr>
				{{/rollBetween() results 5 6}}
				{{#rollBetween() results 7 8}}
					<tr><td colspan="2" class="sheet-td-noFirst">Coup précis et dommages à l'armure</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Degâts +4</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Pièce d'armure PR -2</td></tr>
				{{/rollBetween() results 7 8}}
				{{#rollBetween() results 9 10}}
					<tr><td colspan="2" class="sheet-td-noFirst">Coup précis de bourrin et dommages à l'armure</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Degâts +5</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Pièce d'armure concernée PR -3</td></tr>
				{{/rollBetween() results 9 10}}
				{{#rollTotal() results 11}}
					<tr><td colspan="2" class="sheet-td-noFirst">Une partie de l'armure est détruite</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Pièce d'armure concernée PR = 0</td></tr>
				{{/rollTotal() results 11}}
				{{#rollTotal() results 12}}
					<tr><td colspan="2" class="sheet-td-noFirst">Oeil crevé</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Dégats +5</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">AD-1 | CHA -3 | AT -1 | PRD -2</td></tr>
				{{/rollTotal() results 12}}
				{{#rollTotal() results 13}}
					{{#rollBetween() subresults 1 3}}
						<tr><td colspan="2" class="sheet-td-noFirst">Main droite tranchée</td></tr>
						<tr><td colspan="2" class="sheet-td-noFirst">Dégats +6</td></tr>
						<tr><td colspan="2" class="sheet-td-noFirst">AD -4 | COU -1 | FO -2 | AT -5 | PRD -6</td></tr>
					{{/rollBetween() subresults 1 3}}
					{{#rollBetween() subresults 4 6}}
						<tr><td colspan="2" class="sheet-td-noFirst">Main gauche tranchée</td></tr>
						<tr><td colspan="2" class="sheet-td-noFirst">Dégats +6</td></tr>
						<tr><td colspan="2" class="sheet-td-noFirst">AD -2 | COU -1 | FO -1 | AT -2 | PRD -3</td></tr>
					{{/rollBetween() subresults 4 6}}
				{{/rollTotal() results 13}}
				{{#rollTotal() results 14}}
					{{#rollBetween() subresults 1 3}}
						<tr><td colspan="2" class="sheet-td-noFirst">Pied droit tranché</td></tr>
						<tr><td colspan="2" class="sheet-td-noFirst">Dégats +6</td></tr>
						<tr><td colspan="2" class="sheet-td-noFirst">AD -2 | 50% MV | AT -2 | PRD -2</td></tr>
					{{/rollBetween() subresults 1 3}}
					{{#rollBetween() subresults 4 6}}
						<tr><td colspan="2" class="sheet-td-noFirst">Pied gauche tranché</td></tr>
						<tr><td colspan="2" class="sheet-td-noFirst">Dégats +6</td></tr>
						<tr><td colspan="2" class="sheet-td-noFirst">AD -2 | 50% MV | AT -2 | PRD -2</td></tr>
					{{/rollBetween() subresults 4 6}}
				{{/rollTotal() results 14}}
				{{#rollTotal() results 15}}
					{{#rollBetween() subresults 1 3}}
						<tr><td colspan="2" class="sheet-td-noFirst">Bras droit tranché</td></tr>
						<tr><td colspan="2" class="sheet-td-noFirst">Dégats +7</td></tr>
						<tr><td colspan="2" class="sheet-td-noFirst">AD -2 | COU -4 | FO -4 | AT -5 | PRD -6 | CHA -5</td></tr>
					{{/rollBetween() subresults 1 3}}
					{{#rollBetween() subresults 4 6}}
						<tr><td colspan="2" class="sheet-td-noFirst">Bras gauche tranché</td></tr>
						<tr><td colspan="2" class="sheet-td-noFirst">Dégats +7</td></tr>
						<tr><td colspan="2" class="sheet-td-noFirst">AD -2 | COU -2 | FO -2 | AT -3 | PRD -4</td></tr>
					{{/rollBetween() subresults 4 6}}
				{{/rollTotal() results 15}}
				{{#rollTotal() results 16}}
					{{#rollBetween() subresults 1 3}}
						<tr><td colspan="2" class="sheet-td-noFirst">Jambe droite tranchée</td></tr>
						<tr><td colspan="2" class="sheet-td-noFirst">Dégats +8</td></tr>
						<tr><td colspan="2" class="sheet-td-noFirst">AD -4 | COU -3 | FO -3 | AT -4 | PRD -6 | 25% MV</td></tr>
					{{/rollBetween() subresults 1 3}}
					{{#rollBetween() subresults 4 6}}
						<tr><td colspan="2" class="sheet-td-noFirst">Jambe gauche tranchée</td></tr>
						<tr><td colspan="2" class="sheet-td-noFirst">Dégats +8</td></tr>
						<tr><td colspan="2" class="sheet-td-noFirst">AD -4 | COU -3 | FO -3 | AT -4 | PRD -6 | 25% MV</td></tr>
					{{/rollBetween() subresults 4 6}}
				{{/rollTotal() results 16}}
				{{#rollTotal() results 17}}
					<tr><td colspan="2" class="sheet-td-noFirst">Organes génitaux endommagés</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Dégats +5</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Perd 1d6PV chaque minute</td></tr>
				{{/rollTotal() results 17}}
				{{#rollTotal() results 18}}
					<tr><td colspan="2" class="sheet-td-noFirst">Organes vital endommagé</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Dégats +9</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Perd 1d6PV chaque minute</td></tr>
				{{/rollTotal() results 18}}
				{{#rollTotal() results 19}}
					<tr><td colspan="2" class="sheet-td-noFirst">Blessure au coeur</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Décès</td></tr>
				{{/rollTotal() results 19}}
				{{#rollTotal() results 20}}
					<tr><td colspan="2" class="sheet-td-noFirst">Blessure grave à la tête</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Décès</td></tr>
				{{/rollTotal() results 20}}
			{{/rollTotal() displayEffets 1}}
		</tbody>
	</table>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-crit_contondant">
	<table class="sheet-rolltemplate-default">
		<caption>{{name}}</caption>
		<tbody>
			<tr>
				<td>Résolution</td>
				<td>{{results}}</td>
			</tr>
			{{#rollTotal() displayEffets 1}}
				{{#rollBetween() results 1 2}}
					<tr><td colspan="2" class="sheet-td-noFirst">Ématome impressionnant</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Dégats +1</td></tr>
				{{/rollBetween() results 1 2}}
				{{#rollBetween() results 3 4}}
					<tr><td colspan="2" class="sheet-td-noFirst">Ématome et luxation d'un membre</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Dégats +5</td></tr>
				{{/rollBetween() results 3 4}}
				{{#rollBetween() results 5 6}}
					<tr><td colspan="2" class="sheet-td-noFirst">Fracture de côte</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Dégats +3</td></tr>
				{{/rollBetween() results 5 6}}
				{{#rollBetween() results 7 8}}
					<tr><td colspan="2" class="sheet-td-noFirst">Coup précis et dommages à l'armure</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Degâts +4</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Pièce d'armure PR -1</td></tr>
				{{/rollBetween() results 7 8}}
				{{#rollBetween() results 9 10}}
					<tr><td colspan="2" class="sheet-td-noFirst">Coup précis de bourrin et dommages à l'armure</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Degâts +5 </td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Pièce d'armure PR -2</td></tr>
				{{/rollBetween() results 9 10}}
				{{#rollTotal() results 11}}
					<tr><td colspan="2" class="sheet-td-noFirst">Une partie de l'armure est détruite ()</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Pièce d'armure concernée PR=0</td></tr>
				{{/rollTotal() results 11}}
				{{#rollTotal() results 12}}
					<tr><td colspan="2" class="sheet-td-noFirst">Luxation du genou (Dégâts +3 / AD -2 | MV 50% | AT -1 | PRD -2)</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Dégats +9</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Perd 1d6PV chaque minute</td></tr>
				{{/rollTotal() results 12}}
				{{#rollTotal() results 13}}
					{{#rollBetween() subresults 1 3}}
						<tr><td colspan="2" class="sheet-td-noFirst">Main droite cassée</td></tr>
						<tr><td colspan="2" class="sheet-td-noFirst">Dégats +3</td></tr>
						<tr><td colspan="2" class="sheet-td-noFirst">AD -4 | COU -1 | FO -2 | AT -5 | PRD -6</td></tr>
					{{/rollBetween() subresults 1 3}}
					{{#rollBetween() subresults 4 6}}
						<tr><td colspan="2" class="sheet-td-noFirst">Main gauche cassée</td></tr>
						<tr><td colspan="2" class="sheet-td-noFirst">Dégats +3</td></tr>
						<tr><td colspan="2" class="sheet-td-noFirst">AD -2 | COU -1 | FO -1 | AT -2 | PRD -3</td></tr>
					{{/rollBetween() subresults 4 6}}
				{{/rollTotal() results 13}}
				{{#rollTotal() results 14}}
					{{#rollBetween() subresults 1 3}}
						<tr><td colspan="2" class="sheet-td-noFirst">Pied droit écrasé</td></tr>
						<tr><td colspan="2" class="sheet-td-noFirst">Dégats +3</td></tr>
						<tr><td colspan="2" class="sheet-td-noFirst">AD -2 | 50% MV | AT -2 | PRD -2</td></tr>
					{{/rollBetween() subresults 1 3}}
					{{#rollBetween() subresults 4 6}}
						<tr><td colspan="2" class="sheet-td-noFirst">Pied gauche écrasé</td></tr>
						<tr><td colspan="2" class="sheet-td-noFirst">Dégats +3</td></tr>
						<tr><td colspan="2" class="sheet-td-noFirst">AD -2 | 50% MV | AT -2 | PRD -2</td></tr>
					{{/rollBetween() subresults 4 6}}
				{{/rollTotal() results 14}}
				{{#rollTotal() results 15}}
					{{#rollBetween() subresults 1 3}}
						<tr><td colspan="2" class="sheet-td-noFirst">Bras droit cassé ( / )</td></tr>
						<tr><td colspan="2" class="sheet-td-noFirst">Dégats +4</td></tr>
						<tr><td colspan="2" class="sheet-td-noFirst">AD -4 | COU -2 | FO -4 | AT -5 | PRD -6</td></tr>
					{{/rollBetween() subresults 1 3}}
					{{#rollBetween() subresults 4 6}}
						<tr><td colspan="2" class="sheet-td-noFirst">Bras gauche cassé</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Dégats +4</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">AD -2 | COU -1 | FO -2 | AT -2 | PRD -3</td></tr>
					{{/rollBetween() subresults 4 6}}
				{{/rollTotal() results 15}}
				{{#rollTotal() results 16}}
					{{#rollBetween() subresults 1 3}}
						<tr><td colspan="2" class="sheet-td-noFirst">Jambe droite cassée</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Dégats +5</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">AD -4 | COU -3 | FO -3 | AT -4 | PRD -6 | MV 25%</td></tr>
					{{/rollBetween() subresults 1 3}}
					{{#rollBetween() subresults 4 6}}
						<tr><td colspan="2" class="sheet-td-noFirst">Jambe gauche cassée</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Dégats +5</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">AD -4 | COU -3 | FO -3 | AT -4 | PRD -6 | MV 25%</td></tr>
					{{/rollBetween() subresults 4 6}}
				{{/rollTotal() results 16}}
				{{#rollTotal() results 17}}
					<tr><td colspan="2" class="sheet-td-noFirst">Organes génitaux écrasés</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Dégats +5</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">AD -2 | COU -5 | MV 50%</td></tr>
				{{/rollTotal() results 17}}
				{{#rollTotal() results 18}}
					<tr><td colspan="2" class="sheet-td-noFirst">Assommé</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Inconscient</td></tr>
				{{/rollTotal() results 18}}
				{{#rollTotal() results 19}}
					<tr><td colspan="2" class="sheet-td-noFirst">Fracture ouverte du crâne</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Décès</td></tr>
				{{/rollTotal() results 19}}
				{{#rollTotal() results 20}}
					<tr><td colspan="2" class="sheet-td-noFirst">Ecrasement violent d'un organe vital</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Décès</td></tr>
				{{/rollTotal() results 20}}
			{{/rollTotal() displayEffets 1}}
		</tbody>
	</table>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-crit_projectile">
	<table class="sheet-rolltemplate-default">
		<caption>{{name}}</caption>
		<tbody>
			<tr>
				<td>Résolution</td>
				<td>{{results}}</td>
			</tr>
			{{#rollTotal() displayEffets 1}}
				{{#rollBetween() results 1 2}}
					<tr><td colspan="2" class="sheet-td-noFirst">Projectile bien placé</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Dégats +1</td></tr>
				{{/rollBetween() results 1 2}}
				{{#rollBetween() results 3 4}}
					<tr><td colspan="2" class="sheet-td-noFirst">Projectile magistralement placé</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Dégats +2</td></tr>
				{{/rollBetween() results 3 4}}
				{{#rollBetween() results 5 6}}
					<tr><td colspan="2" class="sheet-td-noFirst">Projectile dans une articulation du bras</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Dégats +3</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">AT -2 | PRD -2</td></tr>
				{{/rollBetween() results 5 6}}
				{{#rollBetween() results 7 8}}
					<tr><td colspan="2" class="sheet-td-noFirst">Projectile dans une articulation de la jambe</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Dégats +3</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">MV 50%</td></tr>
				{{/rollBetween() results 7 8}}
				{{#rollBetween() results 9 11}}
					<tr><td colspan="2" class="sheet-td-noFirst">Projectile dans un poumon</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Degâts +3</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Toutes caracs -1</td></tr>
				{{/rollBetween() results 9 11}}
				{{#rollBetween() results 12 16}}
					<tr><td colspan="2" class="sheet-td-noFirst">Projectile de maître</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Dégâts +5</td></tr>
				{{/rollBetween() results 12 16}}
				{{#rollTotal() results 17}}
					<tr><td colspan="2" class="sheet-td-noFirst">En plein dans les organes génitaux, bien fait !</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Dégats +5</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Perd 1d6PV chaque minute</td></tr>
				{{/rollTotal() results 17}}
				{{#rollTotal() results 18}}
					<tr><td colspan="2" class="sheet-td-noFirst">Organe vital endommagé !</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Dégâts +5</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Perd 1d6PV chaque minute</td></tr>
				{{/rollTotal() results 18}}
				{{#rollTotal() results 19}}
					<tr><td colspan="2" class="sheet-td-noFirst">Coeur transpercé</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Décès</td></tr>
				{{/rollTotal() results 19}}
				{{#rollTotal() results 20}}
					<tr><td colspan="2" class="sheet-td-noFirst">Oeil et cerveau transpercé, bien fait !</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Décès</td></tr>
				{{/rollTotal() results 20}}
			{{/rollTotal() displayEffets 1}}
		</tbody>
	</table>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-crit_pugilat">
	<table class="sheet-rolltemplate-default">
		<caption>{{name}}</caption>
		<tbody>
			<tr>
				<td>Résolution</td>
				<td>{{results}}</td>
			</tr>
			{{#rollTotal() displayEffets 1}}
				{{#rollBetween() results 1 2}}
					<tr><td colspan="2" class="sheet-td-noFirst">Ématome impressionnant</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Dégats +1</td></tr>
				{{/rollBetween() results 1 2}}
				{{#rollBetween() results 3 4}}
					<tr><td colspan="2" class="sheet-td-noFirst">Ématome et luxation d'un membre</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Dégats +2</td></tr>
				{{/rollBetween() results 3 4}}
				{{#rollBetween() results 5 6}}
					<tr><td colspan="2" class="sheet-td-noFirst">Fracture du nez, hémorragie nasale</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Dégats +3</td></tr>
				{{/rollBetween() results 5 6}}
				{{#rollBetween() results 7 8}}
					<tr><td colspan="2" class="sheet-td-noFirst">Fracture de côte</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Dégats +4</td></tr>
				{{/rollBetween() results 7 8}}
				{{#rollBetween() results 9 10}}
					<tr><td colspan="2" class="sheet-td-noFirst">Coup précis de bourrin dans la tempe</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Dégats +2</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Cible étourdie 3 assauts</td></tr>
				{{/rollBetween() results 9 10}}
				{{#rollTotal() results 11}}
					<tr><td colspan="2" class="sheet-td-noFirst">Coup précis au sternum</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Cible étourdie 4 assauts</td></tr>
				{{/rollTotal() results 11}}
				{{#rollTotal() results 12}}
					<tr><td colspan="2" class="sheet-td-noFirst">Luxation du genou</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Dégâts +3</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">AD -2 | MV 50% | AT -1 | PRD -2</td></tr>
				{{/rollTotal() results 12}}
				{{#rollTotal() results 13}}
					{{#rollBetween() subresults 1 3}}
						<tr><td colspan="2" class="sheet-td-noFirst">Main droite cassée</td></tr>
						<tr><td colspan="2" class="sheet-td-noFirst">Dégats +3</td></tr>
						<tr><td colspan="2" class="sheet-td-noFirst">AD -4 | COU -1 | FO -2 | AT -5 | PRD -6</td></tr>
					{{/rollBetween() subresults 1 3}}
					{{#rollBetween() subresults 4 6}}
						<tr><td colspan="2" class="sheet-td-noFirst">Main gauche cassée</td></tr>
						<tr><td colspan="2" class="sheet-td-noFirst">Dégats +3</td></tr>
						<tr><td colspan="2" class="sheet-td-noFirst">AD -2 | COU -1 | FO -1 | AT -2 | PRD -3</td></tr>
					{{/rollBetween() subresults 4 6}}
				{{/rollTotal() results 13}}
				{{#rollTotal() results 14}}
					<tr><td colspan="2" class="sheet-td-noFirst">Mâchoire brisée</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Dégâts +3</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Incapacité à parler</td></tr>
				{{/rollTotal() results 14}}
				{{#rollTotal() results 15}}
					{{#rollBetween() subresults 1 3}}
						<tr><td colspan="2" class="sheet-td-noFirst">Bras droit cassé</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Dégats +4</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">AD -4 | COU -2 | FO -4 | AT -5 | PRD -6</td></tr>
					{{/rollBetween() subresults 1 3}}
					{{#rollBetween() subresults 4 6}}
						<tr><td colspan="2" class="sheet-td-noFirst">Bras gauche cassé</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Dégats +4</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">AD -2 | COU -1 | FO -2 | AT -2 | PRD -3</td></tr>
					{{/rollBetween() subresults 4 6}}
				{{/rollTotal() results 15}}
				{{#rollBetween() results 16 17}}
					<tr><td colspan="2" class="sheet-td-noFirst">Organes génitaux écrasés, houlala</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Degâts +5</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Cible étourdie 3 assauts</td></tr>
				{{/rollBetween() results 16 17}}
				{{#rollBetween() results 18 19}}
					<tr><td colspan="2" class="sheet-td-noFirst">Assommé</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Inconscient</td></tr>
				{{/rollBetween() results 18 19}}
				{{#rollTotal() results 20}}
					<tr><td colspan="2" class="sheet-td-noFirst">Enfoncement du nez dans le cerveau</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Décès</td></tr>
				{{/rollTotal() results 20}}
			{{/rollTotal() displayEffets 1}}
		</tbody>
	</table>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-fumble_atk">
	<table class="sheet-rolltemplate-default">
		<caption>{{name}}</caption>
		<tbody>
			<tr>
				<td>Résolution</td>
				<td>{{results}}</td>
			</tr>
			{{#rollTotal() displayEffets 1}}
				{{#rollBetween() results 1 2}}
					<tr><td colspan="2" class="sheet-td-noFirst">Rattrape son erreur in extramis</td></tr>
				{{/rollBetween() results 1 2}}
				{{#rollBetween() results 3 5}}
					<tr><td colspan="2" class="sheet-td-noFirst">Trèbuche et chute maladroitement</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Rate 2 assauts</td></tr>
				{{/rollBetween() results 3 5}}
				{{#rollBetween() results 6 7}}
					<tr><td colspan="2" class="sheet-td-noFirst">Frappe un allié proche vers la gauche</td></tr>
				{{/rollBetween() results 6 7}}
				{{#rollBetween() results 8 9}}
					<tr><td colspan="2" class="sheet-td-noFirst">Frappe un allié proche vers la droite</td></tr>
				{{/rollBetween() results 8 9}}
				{{#rollBetween() results 10 12}}
					<tr><td colspan="2" class="sheet-td-noFirst">Lâche son arme comme un loser</td></tr>
				{{/rollBetween() results 10 12}}
				{{#rollBetween() results 13 15}}
					<tr><td colspan="2" class="sheet-td-noFirst">Casse son arme</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Voir point de rupture</td></tr>
				{{/rollBetween() results 13 15}}
				{{#rollBetween() results 16 18}}
					<tr><td colspan="2" class="sheet-td-noFirst">Se blesse tout seul comme un cake</td></tr>
				{{/rollBetween() results 16 18}}
				{{#rollTotal() results 19}}
					<tr><td colspan="2" class="sheet-td-noFirst">Se blesse très sévèrement de façcon atroce et douloureuse</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Dégâts critique</td></tr>
				{{/rollTotal() results 19}}
				{{#rollTotal() results 20}}
					{{#rollBetween() subresults 1 2}}
						<tr><td colspan="2" class="sheet-td-noFirst">Perd un oeil</td></tr>
						<tr><td colspan="2" class="sheet-td-noFirst">AD -1 | CHA -3 | AT -1 | PRD -2</td></tr>
					{{/rollBetween() subresults 1 2}}
					{{#rollBetween() subresults 3 6}}
						<tr><td colspan="2" class="sheet-td-noFirst">Perd un doigt</td></tr>
						<tr><td colspan="2" class="sheet-td-noFirst">AD -2</td></tr>
					{{/rollBetween() subresults 3 6}}
				{{/rollTotal() results 20}}
			{{/rollTotal() displayEffets 1}}
		</tbody>
	</table>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-crit_prd">
	<table class="sheet-rolltemplate-default">
		<caption>{{name}}</caption>
		<tbody>
			<tr>
				<td>Résolution</td>
				<td>{{results}}</td>
			</tr>
			{{#rollTotal() displayEffets 1}}
				{{#rollBetween() results 1 2}}
					<tr><td colspan="2" class="sheet-td-noFirst">Mais non en fait : la parade était normale</td></tr>
				{{/rollBetween() results 1 2}}
				{{#rollBetween() results 3 5}}
					<tr><td colspan="2" class="sheet-td-noFirst">Projectile magistralement placé</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Dégats +2</td></tr>
				{{/rollBetween() results 3 5}}
				{{#rollBetween() results 6 7}}
					<tr><td colspan="2" class="sheet-td-noFirst">L'ennemi trébuche</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Il subit 1 attaque imparable</td></tr>
				{{/rollBetween() results 6 7}}
				{{#rollBetween() results 8 9}}
					<tr><td colspan="2" class="sheet-td-noFirst">L'ennemi tombe</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Il subit 2 attaques imparables</td></tr>
				{{/rollBetween() results 8 9}}
				{{#rollBetween() results 10 12}}
					<tr><td colspan="2" class="sheet-td-noFirst">L'ennemi lâche son arme à 1D6 mètres</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Il combat à mains nues</td></tr>
				{{/rollBetween() results 10 12}}
				{{#rollBetween() results 13 15}}
					<tr><td colspan="2" class="sheet-td-noFirst">L'ennemi casse son arme</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Il combat à mains nues</td></tr>
				{{/rollBetween() results 13 15}}
				{{#rollBetween() results 16 18}}
					<tr><td colspan="2" class="sheet-td-noFirst">L'ennemi reçoit un coup de votre arme</td></tr>
					<tr><td colspan="2" class="sheet-td-noFirst">Il subit des dégâts</td></tr>
				{{/rollBetween() results 16 18}}
				{{#rollTotal() results 19}}
					<tr><td colspan="2" class="sheet-td-noFirst">L'ennemi subit un coup critique avec votre arme</td></tr>
				{{/rollTotal() results 19}}
				{{#rollTotal() results 20}}
					<tr><td colspan="2" class="sheet-td-noFirst">L'ennemi, ce loser, subit un coup critique avec son arme</td></tr>
				{{/rollTotal() results 20}}
			{{/rollTotal() displayEffets 1}}
		</tbody>
	</table>
</rolltemplate>




