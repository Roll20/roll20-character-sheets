<div class="sheet-imserso">
<div class="sheet-personal-details">
    <div class="sheet-datos">
        <div class="sheet-section-header">1. Datos de la persona solicitante</div>
        <div class="sheet-datos-body">
            <div class="field-wrap"><label>Nombre del jugador</label><input type="text" name="attr_player_name" spellcheck="false" /></div>
            <div class="field-wrap"><label>Nombre del pj</label><input type="text" name="attr_character_name" spellcheck="false" /></div>
            <div class="field-wrap"><label>Arquetipo</label><textarea rows="2" name="attr_arquetipo" spellcheck="false"></textarea></div>
            <div class="field-wrap"><label>Talento</label><textarea rows="2" name="attr_talento" spellcheck="false"></textarea></div>
            <div class="field-wrap"><label>Lugar de Nacimiento</label><input type="text" name="attr_lugar" spellcheck="false"/></div>
            <div class="field-wrap"><label>Años</label><input type="text" name="attr_edad"/></div>
            <div class="field-wrap"><label>Antigua Profesión(+3)</label><input type="text" name="attr_profesion" spellcheck="false" /></div>
            <div class="field-wrap"><label>Partido</label><select><option>Con Franco se vivía mejor.</option><option>PEPÉ.</option><option>Ciutadanos.</option><option>SOE.</option><option>El del Coletas.</option></select></div>
            <div class="field-wrap"><label>Familia y Nietos</label><textarea rows="8" name="attr_familia" spellcheck="false"></textarea></div>
        </div>
    </div>
    <div class="sheet-logo">
        <img src="https://jorsermar.github.io/roll20-jorsermar-sheets/Imserso_ToTheLimit/img/logo.png"/>
        <div class="sheet-datos-body">
            <div class="field-wrap"><label>CACUMEN</label><input type="text" name="attr_cac" spellcheck="false" /></div>
            <div class="field-wrap"><label>GRACEJO</label><input type="text" name="attr_gra" spellcheck="false" /></div>
            <div class="field-wrap"><label>PRESTEZA</label><input type="text" name="attr_pre" spellcheck="false" /></div>
            <div class="field-wrap"><label>ROBUSTEZ</label><input type="text" name="attr_rob" spellcheck="false" /></div>
        </div>
        <div class="sheet-derivados">
        <div class="sheet-domino"></div>
        <div class="sheet-bemoles"><label>BEMOLES</label><input type="number" name="attr_bemoles" value="(@{cac}+7)" disabled="true"/></div>
        <div class="sheet-nervio"><label>NERVIO</label><input type="number" name="attr_nervio" value="(3*@{gimnasia}+@{pre})" disabled="true"/></div>
        <div class="field-wrap sheet-yayopoints"><label>YAYOPOINTS</label><div class="sheet-data"><input type="number" name="attr_proezas_actual" placeholder="" /><input type="number" name="attr_proezas_total" value="(floor((@{cac}+@{rob})/2 + 2))" disabled="true"/><p>Actuales</p><p>Iniciales</p></div></div>
    </div>
    </div>
</div>

<div class="sheet-habilidades">
    <div class="sheet-section-header">3. HABILIDADES <div class="sheet-hab-aux"><label>Antigua Profesión</label><input type="checkbox" name="attr_prof" value="3"/><label>Dados +</label><input type="number" name="attr_bonus" min="0" max="5" value="0"/><label>Dados -</label><input type="number" name="attr_malus" min="0" max="5" value="0"/></div></div>
    <input type="hidden" name="attr_colaboradores" value="0" />
    <div class="sheet-lista-habilidades">
        <div class="field-wrap">
            <label>AMBULATORIO (CAC)</label>
            <div class="sheet-habilidades-container"><input checked type="radio" name="attr_ambulatorio" value="1" /><input type="radio" name="attr_ambulatorio" value="2" /><input type="radio" name="attr_ambulatorio" value="3" /><input type="hidden" name="attr_dados_ambulatorio" disabled value="@{bonus}-@{malus}-@{penalizador}+@{ambulatorio}"/>
            <button type="roll" name="roll_Ambulatorio" value="&{template:imserso} {{name=Tirada Ambulatorio}} {{dados=[[@{dados_ambulatorio}]]}} {{tirada=[[[[(floor((@{dados_ambulatorio}+8)/9))*d6]] + [[(floor((@{dados_ambulatorio}+7)/9))*d6]] + [[(floor((@{dados_ambulatorio}+6)/9))*d6]] + [[(floor((@{dados_ambulatorio}+5)/9))*d6]] + [[(floor((@{dados_ambulatorio}+4)/9))*d6]] + [[(floor((@{dados_ambulatorio}+3)/9))*d6]] + [[(floor((@{dados_ambulatorio}+2)/9))*d6]] + [[(floor((@{dados_ambulatorio}+1)/9))*d6]] + [[(floor((@{dados_ambulatorio}+0)/9))*d6]] + @{cac} + @{prof} + 3*@{colaboradores}]]}} {{r1=$[[1]]}} {{r2=$[[2]]}} {{r3=$[[3]]}} {{r4=$[[4]]}} {{r5=$[[5]]}} {{r6=$[[6]]}} {{r7=$[[7]]}} {{r8=$[[8]]}} {{r9=$[[9]]}} {{prf=[[@{prof}]]}} {{col=[[@{colaboradores}]]}}" /></div>
        </div>
        <div class="field-wrap">
            <label>ARCHIPERRES (PRE)</label>
            <div class="sheet-habilidades-container"><input checked type="radio" name="attr_archiperres" value="1" /><input type="radio" name="attr_archiperres" value="2" /><input type="radio" name="attr_archiperres" value="3" /><input type="hidden" name="attr_dados_archiperres" disabled value="@{bonus}-@{malus}-@{penalizador}+@{archiperres}"/>
            <button type="roll" name="roll_Archiperres" value="&{template:imserso} {{name=Tirada Archiperres}} {{dados=[[@{dados_archiperres}]]}} {{tirada=[[[[(floor((@{dados_archiperres}+8)/9))*d6]] + [[(floor((@{dados_archiperres}+7)/9))*d6]] + [[(floor((@{dados_archiperres}+6)/9))*d6]] + [[(floor((@{dados_archiperres}+5)/9))*d6]] + [[(floor((@{dados_archiperres}+4)/9))*d6]] + [[(floor((@{dados_archiperres}+3)/9))*d6]] + [[(floor((@{dados_archiperres}+2)/9))*d6]] + [[(floor((@{dados_archiperres}+1)/9))*d6]] + [[(floor((@{dados_archiperres}+0)/9))*d6]] + @{pre} + @{prof} + 3*@{colaboradores}]]}} {{r1=$[[1]]}} {{r2=$[[2]]}} {{r3=$[[3]]}} {{r4=$[[4]]}} {{r5=$[[5]]}} {{r6=$[[6]]}} {{r7=$[[7]]}} {{r8=$[[8]]}} {{r9=$[[9]]}} {{prf=[[@{prof}]]}} {{col=[[@{colaboradores}]]}}" /></div>
        </div>
        <div class="field-wrap">
            <label>BATALLITAS (GRA)</label>
            <div class="sheet-habilidades-container"><input checked type="radio" name="attr_batallitas" value="1" /><input type="radio" name="attr_batallitas" value="2" /><input type="radio" name="attr_batallitas" value="3" /><input type="hidden" name="attr_dados_batallitas" disabled value="@{bonus}-@{malus}-@{penalizador}+@{batallitas}"/>
            <button type="roll" name="roll_Batallitas" value="&{template:imserso} {{name=Tirada Batallitas}} {{dados=[[@{dados_batallitas}]]}} {{tirada=[[[[(floor((@{dados_batallitas}+8)/9))*d6]] + [[(floor((@{dados_batallitas}+7)/9))*d6]] + [[(floor((@{dados_batallitas}+6)/9))*d6]] + [[(floor((@{dados_batallitas}+5)/9))*d6]] + [[(floor((@{dados_batallitas}+4)/9))*d6]] + [[(floor((@{dados_batallitas}+3)/9))*d6]] + [[(floor((@{dados_batallitas}+2)/9))*d6]] + [[(floor((@{dados_batallitas}+1)/9))*d6]] + [[(floor((@{dados_batallitas}+0)/9))*d6]] + @{gra} + @{prof} + 3*@{colaboradores}]]}} {{r1=$[[1]]}} {{r2=$[[2]]}} {{r3=$[[3]]}} {{r4=$[[4]]}} {{r5=$[[5]]}} {{r6=$[[6]]}} {{r7=$[[7]]}} {{r8=$[[8]]}} {{r9=$[[9]]}} {{prf=[[@{prof}]]}} {{col=[[@{colaboradores}]]}}" /></div>
        </div>
        <div class="field-wrap">
            <label>COSAS DEL CAMPO (PRE)</label>
            <div class="sheet-habilidades-container"><input checked type="radio" name="attr_cosas_del_campo" value="1" /><input type="radio" name="attr_cosas_del_campo" value="2" /><input type="radio" name="attr_cosas_del_campo" value="3" /><input type="hidden" name="attr_dados_cosas_del_campo" disabled value="@{bonus}-@{malus}-@{penalizador}+@{cosas_del_campo}"/>
            <button type="roll" name="roll_Cosas_del_campo" value="&{template:imserso} {{name=Tirada Cosas del Campo}} {{dados=[[@{dados_cosas_del_campo}]]}} {{tirada=[[[[(floor((@{dados_cosas_del_campo}+8)/9))*d6]] + [[(floor((@{dados_cosas_del_campo}+7)/9))*d6]] + [[(floor((@{dados_cosas_del_campo}+6)/9))*d6]] + [[(floor((@{dados_cosas_del_campo}+5)/9))*d6]] + [[(floor((@{dados_cosas_del_campo}+4)/9))*d6]] + [[(floor((@{dados_cosas_del_campo}+3)/9))*d6]] + [[(floor((@{dados_cosas_del_campo}+2)/9))*d6]] + [[(floor((@{dados_cosas_del_campo}+1)/9))*d6]] + [[(floor((@{dados_cosas_del_campo}+0)/9))*d6]] + @{pre} + @{prof} + 3*@{colaboradores}]]}} {{r1=$[[1]]}} {{r2=$[[2]]}} {{r3=$[[3]]}} {{r4=$[[4]]}} {{r5=$[[5]]}} {{r6=$[[6]]}} {{r7=$[[7]]}} {{r8=$[[8]]}} {{r9=$[[9]]}} {{prf=[[@{prof}]]}} {{col=[[@{colaboradores}]]}}" /></div>
        </div>
        <div class="field-wrap">
            <label>COTILLEO (GRA)</label>
            <div class="sheet-habilidades-container"><input checked type="radio" name="attr_cotilleo" value="1" /><input type="radio" name="attr_cotilleo" value="2" /><input type="radio" name="attr_cotilleo" value="3" /><input type="hidden" name="attr_dados_cotilleo" disabled value="@{bonus}-@{malus}-@{penalizador}+@{cotilleo}"/>
            <button type="roll" name="roll_Cotilleo" value="&{template:imserso} {{name=Tirada Cotilleo}} {{dados=[[@{dados_cotilleo}]]}} {{tirada=[[[[(floor((@{dados_cotilleo}+8)/9))*d6]] + [[(floor((@{dados_cotilleo}+7)/9))*d6]] + [[(floor((@{dados_cotilleo}+6)/9))*d6]] + [[(floor((@{dados_cotilleo}+5)/9))*d6]] + [[(floor((@{dados_cotilleo}+4)/9))*d6]] + [[(floor((@{dados_cotilleo}+3)/9))*d6]] + [[(floor((@{dados_cotilleo}+2)/9))*d6]] + [[(floor((@{dados_cotilleo}+1)/9))*d6]] + [[(floor((@{dados_cotilleo}+0)/9))*d6]] + @{gra} + @{prof} + 3*@{colaboradores}]]}} {{r1=$[[1]]}} {{r2=$[[2]]}} {{r3=$[[3]]}} {{r4=$[[4]]}} {{r5=$[[5]]}} {{r6=$[[6]]}} {{r7=$[[7]]}} {{r8=$[[8]]}} {{r9=$[[9]]}} {{prf=[[@{prof}]]}} {{col=[[@{colaboradores}]]}}" /></div>
        </div>                
        <div class="field-wrap">
            <label>DISCUSIÓN (GRA)</label>
            <div class="sheet-habilidades-container"><input checked type="radio" name="attr_discusion" value="1" /><input type="radio" name="attr_discusion" value="2" /><input type="radio" name="attr_discusion" value="3" /><input type="hidden" name="attr_dados_discusion" disabled value="@{bonus}-@{malus}-@{penalizador}+@{discusion}"/>
            <button type="roll" name="roll_Discusion" value="&{template:imserso} {{name=Tirada Discusión}} {{dados=[[@{dados_discusion}]]}} {{tirada=[[[[(floor((@{dados_discusion}+8)/9))*d6]] + [[(floor((@{dados_discusion}+7)/9))*d6]] + [[(floor((@{dados_discusion}+6)/9))*d6]] + [[(floor((@{dados_discusion}+5)/9))*d6]] + [[(floor((@{dados_discusion}+4)/9))*d6]] + [[(floor((@{dados_discusion}+3)/9))*d6]] + [[(floor((@{dados_discusion}+2)/9))*d6]] + [[(floor((@{dados_discusion}+1)/9))*d6]] + [[(floor((@{dados_discusion}+0)/9))*d6]] + @{gra} + @{prof} + 3*@{colaboradores}]]}} {{r1=$[[1]]}} {{r2=$[[2]]}} {{r3=$[[3]]}} {{r4=$[[4]]}} {{r5=$[[5]]}} {{r6=$[[6]]}} {{r7=$[[7]]}} {{r8=$[[8]]}} {{r9=$[[9]]}} {{prf=[[@{prof}]]}} {{col=[[@{colaboradores}]]}}" /></div>
        </div>
        <div class="field-wrap">
            <label>GIMNASIA (PRE)</label>
            <div class="sheet-habilidades-container"><input checked type="radio" name="attr_gimnasia" value="1" /><input type="radio" name="attr_gimnasia" value="2" /><input type="radio" name="attr_gimnasia" value="3" /><input type="hidden" name="attr_dados_gimnasia" disabled value="@{bonus}-@{malus}-@{penalizador}+@{gimnasia}"/>
            <button type="roll" name="roll_Gimnasia" value="&{template:imserso} {{name=Tirada Gimnasia}} {{dados=[[@{dados_gimnasia}]]}} {{tirada=[[[[(floor((@{dados_gimnasia}+8)/9))*d6]] + [[(floor((@{dados_gimnasia}+7)/9))*d6]] + [[(floor((@{dados_gimnasia}+6)/9))*d6]] + [[(floor((@{dados_gimnasia}+5)/9))*d6]] + [[(floor((@{dados_gimnasia}+4)/9))*d6]] + [[(floor((@{dados_gimnasia}+3)/9))*d6]] + [[(floor((@{dados_gimnasia}+2)/9))*d6]] + [[(floor((@{dados_gimnasia}+1)/9))*d6]] + [[(floor((@{dados_gimnasia}+0)/9))*d6]] + @{pre} + @{prof} + 3*@{colaboradores}]]}} {{r1=$[[1]]}} {{r2=$[[2]]}} {{r3=$[[3]]}} {{r4=$[[4]]}} {{r5=$[[5]]}} {{r6=$[[6]]}} {{r7=$[[7]]}} {{r8=$[[8]]}} {{r9=$[[9]]}} {{prf=[[@{prof}]]}} {{col=[[@{colaboradores}]]}}" /></div>
        </div>
        <div class="field-wrap">
            <label>INGESTA (ROB)</label>
            <div class="sheet-habilidades-container"><input checked type="radio" name="attr_ingesta" value="1" /><input type="radio" name="attr_ingesta" value="2" /><input type="radio" name="attr_ingesta" value="3" /><input type="hidden" name="attr_dados_ingesta" disabled value="@{bonus}-@{malus}-@{penalizador}+@{ingesta}"/>
            <button type="roll" name="roll_Ingesta" value="&{template:imserso} {{name=Tirada Ingesta}} {{dados=[[@{dados_ingesta}]]}} {{tirada=[[[[(floor((@{dados_ingesta}+8)/9))*d6]] + [[(floor((@{dados_ingesta}+7)/9))*d6]] + [[(floor((@{dados_ingesta}+6)/9))*d6]] + [[(floor((@{dados_ingesta}+5)/9))*d6]] + [[(floor((@{dados_ingesta}+4)/9))*d6]] + [[(floor((@{dados_ingesta}+3)/9))*d6]] + [[(floor((@{dados_ingesta}+2)/9))*d6]] + [[(floor((@{dados_ingesta}+1)/9))*d6]] + [[(floor((@{dados_ingesta}+0)/9))*d6]] + @{rob} + @{prof} + 3*@{colaboradores}]]}} {{r1=$[[1]]}} {{r2=$[[2]]}} {{r3=$[[3]]}} {{r4=$[[4]]}} {{r5=$[[5]]}} {{r6=$[[6]]}} {{r7=$[[7]]}} {{r8=$[[8]]}} {{r9=$[[9]]}} {{prf=[[@{prof}]]}} {{col=[[@{colaboradores}]]}}" /></div>
        </div>
        
        <div class="field-wrap">
            <label>INTERNÉS (CAC)</label>
            <div class="sheet-habilidades-container"><input type="radio" name="attr_internes" value="1" /><input type="radio" name="attr_internes" value="2" /><input type="radio" name="attr_internes" value="3" /><input type="hidden" name="attr_dados_internes" disabled value="@{bonus}-@{malus}-@{penalizador}+@{internes}"/>
            <button type="roll" name="roll_Internes" value="&{template:imserso} {{name=Tirada Internés}} {{dados=[[@{dados_internes}]]}} {{tirada=[[[[(floor((@{dados_internes}+8)/9))*d6]] + [[(floor((@{dados_internes}+7)/9))*d6]] + [[(floor((@{dados_internes}+6)/9))*d6]] + [[(floor((@{dados_internes}+5)/9))*d6]] + [[(floor((@{dados_internes}+4)/9))*d6]] + [[(floor((@{dados_internes}+3)/9))*d6]] + [[(floor((@{dados_internes}+2)/9))*d6]] + [[(floor((@{dados_internes}+1)/9))*d6]] + [[(floor((@{dados_internes}+0)/9))*d6]] + @{cac} + @{prof} + 3*@{colaboradores}]]}} {{r1=$[[1]]}} {{r2=$[[2]]}} {{r3=$[[3]]}} {{r4=$[[4]]}} {{r5=$[[5]]}} {{r6=$[[6]]}} {{r7=$[[7]]}} {{r8=$[[8]]}} {{r9=$[[9]]}} {{prf=[[@{prof}]]}} {{col=[[@{colaboradores}]]}}" /></div>
        </div>
        <div class="field-wrap">
            <label>LENTES PROGRESIVAS (CAC)</label>
            <div class="sheet-habilidades-container"><input checked type="radio" name="attr_lentes_progresivas" value="1" /><input type="radio" name="attr_lentes_progresivas" value="2" /><input type="radio" name="attr_lentes_progresivas" value="3" /><input type="hidden" name="attr_dados_lentes_progresivas" disabled value="@{bonus}-@{malus}-@{penalizador}+@{lentes_progresivas}"/>
            <button type="roll" name="roll_Lentes_progresivas" value="&{template:imserso} {{name=Tirada Lentes Progresivas}} {{dados=[[@{dados_lentes_progresivas}]]}} {{tirada=[[[[(floor((@{dados_lentes_progresivas}+8)/9))*d6]] + [[(floor((@{dados_lentes_progresivas}+7)/9))*d6]] + [[(floor((@{dados_lentes_progresivas}+6)/9))*d6]] + [[(floor((@{dados_lentes_progresivas}+5)/9))*d6]] + [[(floor((@{dados_lentes_progresivas}+4)/9))*d6]] + [[(floor((@{dados_lentes_progresivas}+3)/9))*d6]] + [[(floor((@{dados_lentes_progresivas}+2)/9))*d6]] + [[(floor((@{dados_lentes_progresivas}+1)/9))*d6]] + [[(floor((@{dados_lentes_progresivas}+0)/9))*d6]] + @{cac} + @{prof} + 3*@{colaboradores}]]}} {{r1=$[[1]]}} {{r2=$[[2]]}} {{r3=$[[3]]}} {{r4=$[[4]]}} {{r5=$[[5]]}} {{r6=$[[6]]}} {{r7=$[[7]]}} {{r8=$[[8]]}} {{r9=$[[9]]}} {{prf=[[@{prof}]]}} {{col=[[@{colaboradores}]]}}" /></div>
        </div>
        <div class="field-wrap">
            <label>MEMORIA (CAC)</label>
            <div class="sheet-habilidades-container"><input checked type="radio" name="attr_memoria" value="1" /><input type="radio" name="attr_memoria" value="2" /><input type="radio" name="attr_memoria" value="3" /><input type="hidden" name="attr_dados_memoria" disabled value="@{bonus}-@{malus}-@{penalizador}+@{memoria}"/>
            <button type="roll" name="roll_Memoria" value="&{template:imserso} {{name=Tirada Memoria}} {{dados=[[@{dados_memoria}]]}} {{tirada=[[[[(floor((@{dados_memoria}+8)/9))*d6]] + [[(floor((@{dados_memoria}+7)/9))*d6]] + [[(floor((@{dados_memoria}+6)/9))*d6]] + [[(floor((@{dados_memoria}+5)/9))*d6]] + [[(floor((@{dados_memoria}+4)/9))*d6]] + [[(floor((@{dados_memoria}+3)/9))*d6]] + [[(floor((@{dados_memoria}+2)/9))*d6]] + [[(floor((@{dados_memoria}+1)/9))*d6]] + [[(floor((@{dados_memoria}+0)/9))*d6]] + @{cac} + @{prof} + 3*@{colaboradores}]]}} {{r1=$[[1]]}} {{r2=$[[2]]}} {{r3=$[[3]]}} {{r4=$[[4]]}} {{r5=$[[5]]}} {{r6=$[[6]]}} {{r7=$[[7]]}} {{r8=$[[8]]}} {{r9=$[[9]]}} {{prf=[[@{prof}]]}} {{col=[[@{colaboradores}]]}}" /></div>
        </div>
        <div class="field-wrap">
            <label>MULA PARDA (ROB)</label>
            <div class="sheet-habilidades-container"><input checked type="radio" name="attr_mula_parda" value="1" /><input type="radio" name="attr_mula_parda" value="2" /><input type="radio" name="attr_mula_parda" value="3" /><input type="hidden" name="attr_dados_mula_parda" disabled value="@{bonus}-@{malus}-@{penalizador}+@{mula_parda}"/>
            <button type="roll" name="roll_Mula_parda" value="&{template:imserso} {{name=Tirada Mula Parda}} {{dados=[[@{dados_mula_parda}]]}} {{tirada=[[[[(floor((@{dados_mula_parda}+8)/9))*d6]] + [[(floor((@{dados_mula_parda}+7)/9))*d6]] + [[(floor((@{dados_mula_parda}+6)/9))*d6]] + [[(floor((@{dados_mula_parda}+5)/9))*d6]] + [[(floor((@{dados_mula_parda}+4)/9))*d6]] + [[(floor((@{dados_mula_parda}+3)/9))*d6]] + [[(floor((@{dados_mula_parda}+2)/9))*d6]] + [[(floor((@{dados_mula_parda}+1)/9))*d6]] + [[(floor((@{dados_mula_parda}+0)/9))*d6]] + @{rob} + @{prof} + 3*@{colaboradores}]]}} {{r1=$[[1]]}} {{r2=$[[2]]}} {{r3=$[[3]]}} {{r4=$[[4]]}} {{r5=$[[5]]}} {{r6=$[[6]]}} {{r7=$[[7]]}} {{r8=$[[8]]}} {{r9=$[[9]]}} {{prf=[[@{prof}]]}} {{col=[[@{colaboradores}]]}}" /></div>
        </div>
        <div class="field-wrap">
            <label>NIETOS (PRE)</label>
            <div class="sheet-habilidades-container"><input checked type="radio" name="attr_nietos" value="1" /><input type="radio" name="attr_nietos" value="2" /><input type="radio" name="attr_nietos" value="3" /><input type="hidden" name="attr_dados_nietos" disabled value="@{bonus}-@{malus}-@{penalizador}+@{nietos}"/>
            <button type="roll" name="roll_Nietos" value="&{template:imserso} {{name=Tirada Nietos}} {{dados=[[@{dados_nietos}]]}} {{tirada=[[[[(floor((@{dados_nietos}+8)/9))*d6]] + [[(floor((@{dados_nietos}+7)/9))*d6]] + [[(floor((@{dados_nietos}+6)/9))*d6]] + [[(floor((@{dados_nietos}+5)/9))*d6]] + [[(floor((@{dados_nietos}+4)/9))*d6]] + [[(floor((@{dados_nietos}+3)/9))*d6]] + [[(floor((@{dados_nietos}+2)/9))*d6]] + [[(floor((@{dados_nietos}+1)/9))*d6]] + [[(floor((@{dados_nietos}+0)/9))*d6]] + @{pre} + @{prof} + 3*@{colaboradores}]]}} {{r1=$[[1]]}} {{r2=$[[2]]}} {{r3=$[[3]]}} {{r4=$[[4]]}} {{r5=$[[5]]}} {{r6=$[[6]]}} {{r7=$[[7]]}} {{r8=$[[8]]}} {{r9=$[[9]]}} {{prf=[[@{prof}]]}} {{col=[[@{colaboradores}]]}}" /></div>
        </div>                
        <div class="field-wrap">
            <label>PETANCA (PRE)</label>
            <div class="sheet-habilidades-container"><input checked type="radio" name="attr_petanca" value="1" /><input type="radio" name="attr_petanca" value="2" /><input type="radio" name="attr_petanca" value="3" /><input type="hidden" name="attr_dados_petanca" disabled value="@{bonus}-@{malus}-@{penalizador}+@{petanca}"/>
            <button type="roll" name="roll_Petanca" value="&{template:imserso} {{name=Tirada Petanca}} {{dados=[[@{dados_petanca}]]}} {{tirada=[[[[(floor((@{dados_petanca}+8)/9))*d6]] + [[(floor((@{dados_petanca}+7)/9))*d6]] + [[(floor((@{dados_petanca}+6)/9))*d6]] + [[(floor((@{dados_petanca}+5)/9))*d6]] + [[(floor((@{dados_petanca}+4)/9))*d6]] + [[(floor((@{dados_petanca}+3)/9))*d6]] + [[(floor((@{dados_petanca}+2)/9))*d6]] + [[(floor((@{dados_petanca}+1)/9))*d6]] + [[(floor((@{dados_petanca}+0)/9))*d6]] + @{pre} + @{prof} + 3*@{colaboradores}]]}} {{r1=$[[1]]}} {{r2=$[[2]]}} {{r3=$[[3]]}} {{r4=$[[4]]}} {{r5=$[[5]]}} {{r6=$[[6]]}} {{r7=$[[7]]}} {{r8=$[[8]]}} {{r9=$[[9]]}} {{prf=[[@{prof}]]}} {{col=[[@{colaboradores}]]}}" /></div>
        </div>  
        <div class="field-wrap">
            <label>SALERO (GRA)</label>
            <div class="sheet-habilidades-container"><input checked type="radio" name="attr_salero" value="1" /><input type="radio" name="attr_salero" value="2" /><input type="radio" name="attr_salero" value="3" /><input type="hidden" name="attr_dados_salero" disabled value="@{bonus}-@{malus}-@{penalizador}+@{salero}"/>
            <button type="roll" name="roll_Salero" value="&{template:imserso} {{name=Tirada Salero}} {{dados=[[@{dados_salero}]]}} {{tirada=[[[[(floor((@{dados_salero}+8)/9))*d6]] + [[(floor((@{dados_salero}+7)/9))*d6]] + [[(floor((@{dados_salero}+6)/9))*d6]] + [[(floor((@{dados_salero}+5)/9))*d6]] + [[(floor((@{dados_salero}+4)/9))*d6]] + [[(floor((@{dados_salero}+3)/9))*d6]] + [[(floor((@{dados_salero}+2)/9))*d6]] + [[(floor((@{dados_salero}+1)/9))*d6]] + [[(floor((@{dados_salero}+0)/9))*d6]] + @{gra} + @{prof} + 3*@{colaboradores}]]}} {{r1=$[[1]]}} {{r2=$[[2]]}} {{r3=$[[3]]}} {{r4=$[[4]]}} {{r5=$[[5]]}} {{r6=$[[6]]}} {{r7=$[[7]]}} {{r8=$[[8]]}} {{r9=$[[9]]}} {{prf=[[@{prof}]]}} {{col=[[@{colaboradores}]]}}" /></div>
        </div>
        <div class="field-wrap">
            <label>SILBIDO (GRA)</label>
            <div class="sheet-habilidades-container"><input checked type="radio" name="attr_silbido" value="1" /><input type="radio" name="attr_silbido" value="2" /><input type="radio" name="attr_silbido" value="3" /><input type="hidden" name="attr_dados_silbido" disabled value="@{bonus}-@{malus}-@{penalizador}+@{silbido}"/>
            <button type="roll" name="roll_Silbido" value="&{template:imserso} {{name=Tirada Silbido}} {{dados=[[@{dados_silbido}]]}} {{tirada=[[[[(floor((@{dados_silbido}+8)/9))*d6]] + [[(floor((@{dados_silbido}+7)/9))*d6]] + [[(floor((@{dados_silbido}+6)/9))*d6]] + [[(floor((@{dados_silbido}+5)/9))*d6]] + [[(floor((@{dados_silbido}+4)/9))*d6]] + [[(floor((@{dados_silbido}+3)/9))*d6]] + [[(floor((@{dados_silbido}+2)/9))*d6]] + [[(floor((@{dados_silbido}+1)/9))*d6]] + [[(floor((@{dados_silbido}+0)/9))*d6]] + @{gra} + @{prof} + 3*@{colaboradores}]]}} {{r1=$[[1]]}} {{r2=$[[2]]}} {{r3=$[[3]]}} {{r4=$[[4]]}} {{r5=$[[5]]}} {{r6=$[[6]]}} {{r7=$[[7]]}} {{r8=$[[8]]}} {{r9=$[[9]]}} {{prf=[[@{prof}]]}} {{col=[[@{colaboradores}]]}}" /></div>
        </div>
       
        <div class="field-wrap">
            <label>SONOTONE (CAC)</label>
            <div class="sheet-habilidades-container"><input checked type="radio" name="attr_sonotone" value="1" /><input type="radio" name="attr_sonotone" value="2" /><input type="radio" name="attr_sonotone" value="3" /><input type="hidden" name="attr_dados_sonotone" disabled value="@{bonus}-@{malus}-@{penalizador}+@{sonotone}"/>
            <button type="roll" name="roll_Sonotone" value="&{template:imserso} {{name=Tirada Sonotone}} {{dados=[[@{dados_sonotone}]]}} {{tirada=[[[[(floor((@{dados_sonotone}+8)/9))*d6]] + [[(floor((@{dados_sonotone}+7)/9))*d6]] + [[(floor((@{dados_sonotone}+6)/9))*d6]] + [[(floor((@{dados_sonotone}+5)/9))*d6]] + [[(floor((@{dados_sonotone}+4)/9))*d6]] + [[(floor((@{dados_sonotone}+3)/9))*d6]] + [[(floor((@{dados_sonotone}+2)/9))*d6]] + [[(floor((@{dados_sonotone}+1)/9))*d6]] + [[(floor((@{dados_sonotone}+0)/9))*d6]] + @{cac} + @{prof} + 3*@{colaboradores}]]}} {{r1=$[[1]]}} {{r2=$[[2]]}} {{r3=$[[3]]}} {{r4=$[[4]]}} {{r5=$[[5]]}} {{r6=$[[6]]}} {{r7=$[[7]]}} {{r8=$[[8]]}} {{r9=$[[9]]}} {{prf=[[@{prof}]]}} {{col=[[@{colaboradores}]]}}" /></div>
        </div>
        <div class="field-wrap">
            <label>SUS LABORES (PRE)</label>
            <div class="sheet-habilidades-container"><input checked type="radio" name="attr_sus_labores" value="1" /><input type="radio" name="attr_sus_labores" value="2" /><input type="radio" name="attr_sus_labores" value="3" /><input type="hidden" name="attr_dados_sus_labores" disabled value="@{bonus}-@{malus}-@{penalizador}+@{sus_labores}"/>
            <button type="roll" name="roll_Sus_labores" value="&{template:imserso} {{name=Tirada Sus Labores}} {{dados=[[@{dados_sus_labores}]]}} {{tirada=[[[[(floor((@{dados_sus_labores}+8)/9))*d6]] + [[(floor((@{dados_sus_labores}+7)/9))*d6]] + [[(floor((@{dados_sus_labores}+6)/9))*d6]] + [[(floor((@{dados_sus_labores}+5)/9))*d6]] + [[(floor((@{dados_sus_labores}+4)/9))*d6]] + [[(floor((@{dados_sus_labores}+3)/9))*d6]] + [[(floor((@{dados_sus_labores}+2)/9))*d6]] + [[(floor((@{dados_sus_labores}+1)/9))*d6]] + [[(floor((@{dados_sus_labores}+0)/9))*d6]] + @{pre} + @{prof} + 3*@{colaboradores}]]}} {{r1=$[[1]]}} {{r2=$[[2]]}} {{r3=$[[3]]}} {{r4=$[[4]]}} {{r5=$[[5]]}} {{r6=$[[6]]}} {{r7=$[[7]]}} {{r8=$[[8]]}} {{r9=$[[9]]}} {{prf=[[@{prof}]]}} {{col=[[@{colaboradores}]]}}" /></div>
        </div>
        <div class="field-wrap">
            <label>TELEDIARIOS (CAC)</label>
            <div class="sheet-habilidades-container"><input checked type="radio" name="attr_telediarios" value="1" /><input type="radio" name="attr_telediarios" value="2" /><input type="radio" name="attr_telediarios" value="3" /><input type="hidden" name="attr_dados_telediarios" disabled value="@{bonus}-@{malus}-@{penalizador}+@{telediarios}"/>
            <button type="roll" name="roll_Telediarios" value="&{template:imserso} {{name=Tirada Telediarios}} {{dados=[[@{dados_telediarios}]]}} {{tirada=[[[[(floor((@{dados_telediarios}+8)/9))*d6]] + [[(floor((@{dados_telediarios}+7)/9))*d6]] + [[(floor((@{dados_telediarios}+6)/9))*d6]] + [[(floor((@{dados_telediarios}+5)/9))*d6]] + [[(floor((@{dados_telediarios}+4)/9))*d6]] + [[(floor((@{dados_telediarios}+3)/9))*d6]] + [[(floor((@{dados_telediarios}+2)/9))*d6]] + [[(floor((@{dados_telediarios}+1)/9))*d6]] + [[(floor((@{dados_telediarios}+0)/9))*d6]] + @{cac} + @{prof} + 3*@{colaboradores}]]}} {{r1=$[[1]]}} {{r2=$[[2]]}} {{r3=$[[3]]}} {{r4=$[[4]]}} {{r5=$[[5]]}} {{r6=$[[6]]}} {{r7=$[[7]]}} {{r8=$[[8]]}} {{r9=$[[9]]}} {{prf=[[@{prof}]]}} {{col=[[@{colaboradores}]]}}" /></div>
        </div>
        <div class="field-wrap">
            <label>TOLLINAS (ROB)</label>
            <div class="sheet-habilidades-container"><input checked type="radio" name="attr_tollinas" value="1" /><input type="radio" name="attr_tollinas" value="2" /><input type="radio" name="attr_tollinas" value="3" /><input type="hidden" name="attr_dados_tollinas" disabled value="@{bonus}-@{malus}-@{penalizador}+@{tollinas}"/>
            <button type="roll" name="roll_Tollinas" value="&{template:imserso} {{name=Tirada Tollinas}} {{dados=[[@{dados_tollinas}]]}} {{tirada=[[[[(floor((@{dados_tollinas}+8)/9))*d6]] + [[(floor((@{dados_tollinas}+7)/9))*d6]] + [[(floor((@{dados_tollinas}+6)/9))*d6]] + [[(floor((@{dados_tollinas}+5)/9))*d6]] + [[(floor((@{dados_tollinas}+4)/9))*d6]] + [[(floor((@{dados_tollinas}+3)/9))*d6]] + [[(floor((@{dados_tollinas}+2)/9))*d6]] + [[(floor((@{dados_tollinas}+1)/9))*d6]] + [[(floor((@{dados_tollinas}+0)/9))*d6]] + @{rob} + @{prof} + 3*@{colaboradores}]]}} {{r1=$[[1]]}} {{r2=$[[2]]}} {{r3=$[[3]]}} {{r4=$[[4]]}} {{r5=$[[5]]}} {{r6=$[[6]]}} {{r7=$[[7]]}} {{r8=$[[8]]}} {{r9=$[[9]]}} {{prf=[[@{prof}]]}} {{col=[[@{colaboradores}]]}}" /></div>
        </div>
        <div class="field-wrap">
            <label style="font-size: 10px">CADA CÍRCULO MARCADO ES 1D EN LA HABILIDAD</label>
        </div>
    </div>
    
</div>

<div class="sheet-achaques">
    <div class="sheet-achaque-mayor">
        <label>ACHAQUE MENOR <input type="checkbox" name="attr_def"/></label>
        <p>Repetir tirada. Solo una vez por sesión.</p>
        <textarea name="attr_defecto_leve"></textarea>
    </div>
    <div class="sheet-achaque-menor">
        <label>ACHAQUE MAYOR</label>
        <p>Repetir tirada -1D. Se gana un yayopoint. Sin límite</p>
        <textarea name="attr_defecto_grave"></textarea>
    </div>
    <div class="sheet-esqueyo">
        <label>Es que yo a tus años... <input type="checkbox" name="attr_rec"/></label>
        <p>Añade un dado a una tirada.</p>
    </div>
</div>

<div class="sheet-salud">
    <div class="sheet-section-header">4. SALUD</div>
    <div class="sheet-salud-body">
        <div class="field-wrap">
            <input type="number" name="attr_salud_actual" value="0" min="0"/>
            <label>SALUD ACTUAL</label>
            <div>Penalización <span name="attr_penalizador" value="0"/>D</div>
            <div>(aplicado automáticamente)</div>
        </div>
        <div class="field-wrap">
            <input type="number" name="attr_salud_total" value="0" min="0"/>
            <label>SALUD TOTAL</label>
            <div>ROBx2 + 10 + 1d6</div>
        </div>
        <div class="field-wrap">
            <input type="number" name="attr_jamacuco" value="(- @{rob} + 12)" disabled/>
            <label>VALOR DE JAMACUCO</label>
        </div>
        <div class="field-wrap sheet-tirada-jamacuco">
            <input type="hidden" name="attr_jam" value="3"/>
            <input type="hidden" name="attr_dados_jam" disabled value="@{bonus}-@{malus}-@{penalizador}+@{jam}"/>
            <button type="roll" name="roll_Jamacuco" value="&{template:imserso} {{name=Tirada de Jamacuco}} {{dados=[[@{dados_jam}]]}} {{tirada=[[[[(floor((@{dados_jam}+8)/9))*d6]] + [[(floor((@{dados_jam}+7)/9))*d6]] + [[(floor((@{dados_jam}+6)/9))*d6]] + [[(floor((@{dados_jam}+5)/9))*d6]] + [[(floor((@{dados_jam}+4)/9))*d6]] + [[(floor((@{dados_jam}+3)/9))*d6]] + [[(floor((@{dados_jam}+2)/9))*d6]] + [[(floor((@{dados_jam}+1)/9))*d6]] + [[(floor((@{dados_jam}+0)/9))*d6]] + @{prof} + 3*@{colaboradores}]]}} {{r1=$[[1]]}} {{r2=$[[2]]}} {{r3=$[[3]]}} {{r4=$[[4]]}} {{r5=$[[5]]}} {{r6=$[[6]]}} {{r7=$[[7]]}} {{r8=$[[8]]}} {{r9=$[[9]]}} {{prf=[[@{prof}]]}} {{col=[[@{colaboradores}]]}}"></button>
            <label>PRIMERA TIRADA DE JAMACUCO <input type="checkbox" name="attr_jamtirada"/></label>
            
        </div>
    </div>
</div>

<div class="sheet-salud sheet-last">
    <div class="sheet-section-header">5. PERTENENCIAS</div>
    <textarea name="attr_pertenencias"></textarea>
</div>

<div class="sheet-salud sheet-last">
    <div class="sheet-section-header">6. VIDA Y MILAGROS</div>
    <textarea name="attr_vidas"></textarea>
</div>

</div>


<!--
&{template:imserso-ini} ---------------------------------------------------------------------------------------------------------
-->
<rolltemplate class="sheet-rolltemplate-imserso-ini">
    <table>
        <caption>{{name}}</caption>
        <td class="template_label" >Dado</td>
        <td class="template_value dice">{{r1}}</td>
        <td class="template_label" >Total</td>
        <td class="template_value">{{iniciativa}}</td>
    </table>
</rolltemplate>


<!--
&{template:imserso} ---------------------------------------------------------------------------------------------------------
-->
<rolltemplate class="sheet-rolltemplate-imserso">
    <table>
        <caption>{{name}}</caption>
        
        <tr><td colspan="4" class="extrainfo">{{#rollTotal() prf 3}}Antigua Profesión<br/>{{/rollTotal() prf 3}}</td></tr>
        <tr>
            <td class="template_label" >Dados</td>
        
        {{#rollLess dados 0}}
            <td class="template_value dice">{{dados}}</td>
        {{/rollLess dados 0}}

        {{#rollTotal() dados 1}}
            <td class="template_value dice d1">{{r1}}</td>
        {{/rollTotal() dados 1}}

        {{#rollTotal() dados 2}}
            <td class="template_value dice d2">{{r1}} {{r2}}</td>
        {{/rollTotal() dados 2}}

        {{#rollTotal() dados 3}}
            <td class="template_value dice d3">{{r1}} {{r2}} {{r3}}</td>
        {{/rollTotal() dados 3}}

        {{#rollTotal() dados 4}}
            <td class="template_value dice d4">{{r1}} {{r2}} {{r3}} {{r4}}</td>
        {{/rollTotal() dados 4}}

        {{#rollTotal() dados 5}}
            <td class="template_value dice d5">{{r1}} {{r2}} {{r3}} {{r4}} {{r5}}</td>
        {{/rollTotal() dados 5}}

        {{#rollTotal() dados 6}}
            <td class="template_value dice d6">{{r1}} {{r2}} {{r3}} {{r4}} {{r5}} {{r6}}</td>
        {{/rollTotal() dados 6}}

        {{#rollTotal() dados 7}}
            <td class="template_value dice d7">{{r1}} {{r2}} {{r3}} {{r4}} {{r5}} {{r6}} {{r7}}</td>
        {{/rollTotal() dados 7}}

        {{#rollTotal() dados 8}}
            <td class="template_value dice d8">{{r1}} {{r2}} {{r3}} {{r4}} {{r5}} {{r6}} {{r7}} {{r8}}</td>
        {{/rollTotal() dados 8}}

        {{#rollTotal() dados 9}}
            <td class="template_value dice d9">{{r1}} {{r2}} {{r3}} {{r4}} {{r5}} {{r6}} {{r7}} {{r8}} {{r9}}</td>
        {{/rollTotal() dados 9}}
            <td class="template_label" >Total</td>
            <td class="template_value">{{tirada}} {{total}}</td>
        </tr>
    </table>
</rolltemplate>

<script type="text/worker">
on("change:salud_actual sheet:opened", function() {  
    getAttrs(["salud_actual","penalizador"], function(values) {
        let salud_actual = parseInt(values.salud_actual)||0;
        let rpen = 0;
        if (salud_actual < 11) rpen = 1;
        if (salud_actual < 7) rpen = 2;
        if (salud_actual < 4) rpen = 3;
        setAttrs({ penalizador: rpen });
    });  
});
</script>