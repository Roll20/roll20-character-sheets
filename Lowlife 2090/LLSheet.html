<div class="sheet-overall-wrapper">
    <!--Main Header -->
    <div class="sheet-core-header sheet-padb">
        <div class="sheet-row">
            <div class="sheet-col-1-8 sheet-margin-top">
                <img src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/Lowlife%202090/LOWLIFE_LOGO.png" alt="Lowlife 2090" width=100 >
            </div>
            <div class="sheet-col-1-8 sheet-center sheet-margin-top">
                &nbsp;<br/>&nbsp;<br/>
                <p class="sheet-last-updated">Sheet version 3.0<br/>December 2020</p>
                <input name="attr_version" type="hidden">
            </div>
            <div class="sheet-col-1-4 sheet-small-label sheet-center">
                &nbsp;<br/>&nbsp;<br/>&nbsp;<br/>
                <input class="sheet-underlined sheet-center" type="text" name="attr_character_name"><br/>Character Name
            </div>
            <div class="sheet-col-1-8 sheet-small-label sheet-center">
                &nbsp;<br/>&nbsp;<br/>&nbsp;<br/>
                <input class="sheet-underlined sheet-center" type="text" name="attr_class"><br/>Class
            </div>
            <div class="sheet-col-1-8 sheet-small-label sheet-center">
                &nbsp;<br/>&nbsp;<br/>&nbsp;<br/>
                <input class="sheet-underlined sheet-center" type="number" min="0" step="1" value="1" name="attr_level"><br/>Level
			</div>
			<div class="sheet-col-1-8 sheet-small-label sheet-center">
				&nbsp;<br/>&nbsp;<br/>&nbsp;<br/>
				<input class="sheet-underlined sheet-center" type="number" min="0" step="1" value="0" name="attr_xp"><br/>XP
			</div>
            <div class="sheet-col-1-8 sheet-small-label sheet-center">
				&nbsp;<br/>&nbsp;<br/>&nbsp;<br/>
				<input class="sheet-underlined sheet-center" type="number" min="0" step="1" value="0" name="attr_xp_goal"><br/>XP Goal
			</div>
        </div>
    </div>
    <h4 class="sheet-center">Personal Details </h4>
	<div class="sheet-row">
		<div class="sheet-col-1-7 sheet-small-label sheet-center"><input class="sheet-underlined sheet-center" type="text" name="attr_gender"><br/>Gender</div>
		<div class="sheet-col-1-7 sheet-small-label sheet-center"><input class="sheet-underlined sheet-center" type="number" name="attr_age"><br/>Age</div>
		<div class="sheet-col-1-7 sheet-small-label sheet-center"><input class="sheet-underlined sheet-center" type="text" name="attr_height"><br/>Height</div>
		<div class="sheet-col-1-7 sheet-small-label sheet-center"><input class="sheet-underlined sheet-center" type="text" name="attr_weight"><br/>Weight</div>
		<div class="sheet-col-1-7 sheet-small-label sheet-center"><input class="sheet-underlined sheet-center" type="text" name="attr_eyes"><br/>Eyes</div>
		<div class="sheet-col-1-7 sheet-small-label sheet-center"><input class="sheet-underlined sheet-center" type="text" name="attr_hair"><br/>Hair</div>
		<div class="sheet-col-1-7 sheet-small-label sheet-center"><input class="sheet-underlined sheet-center" type="text" name="attr_race"><br/>Race</div>
	</div>
	<div class="sheet-row sheet-padb">
		<div class="sheet-col-1-4 sheet-small-label sheet-center"><input class="sheet-underlined sheet-center" type="text" name="attr_background"><br/>Background</div>
		<div class="sheet-col-5-8 sheet-small-label sheet-center"><input class="sheet-underlined sheet-center" type="text" name="attr_languages"><br/>Languages</div>
		<div class="sheet-col-1-8 sheet-small-label sheet-center"><input class="sheet-underlined sheet-center" type="text" name="attr_vision"><br/>Vision</div>
	</div>
    <!-- Tabs-->
    <input type="checkbox" name="attr_tab1" class="sheet-tab sheet-tab1" value="1" checked />
    <span class="sheet-tab sheet-tab1">Main</span>
    <input type="checkbox" name="attr_tab2" class="sheet-tab sheet-tab2" value="1" checked />
    <span class="sheet-tab sheet-tab2">Skills & Features</span>
    <input type="checkbox" name="attr_tab3" class="sheet-tab sheet-tab3" value="1" checked />
    <span class="sheet-tab sheet-tab3">Weapons</span>
    <input type="checkbox" name="attr_tab4" class="sheet-tab sheet-tab4" value="1" checked />
    <span class="sheet-tab sheet-tab4">Spellbook</span>
    <input type="checkbox" name="attr_tab5" class="sheet-tab sheet-tab5" value="1" checked />
	<span class="sheet-tab sheet-tab5">Gear</span>
	<input type="checkbox" name="attr_tab6" class="sheet-tab sheet-tab6" value="1" checked />
	<span class="sheet-tab sheet-tab6">Network</span>
    <input type="checkbox" name="attr_tab7" class="sheet-tab sheet-tab7" value="1" checked />
    <span class="sheet-tab sheet-tab7">Injuries & Setbacks</span>
	<span class="sheet-spacer"></span>
    <!--Main Page-->
    <div class="sheet-section-main">
		<div class="sheet-row">
			<div class="sheet-col-7-12 sheet-padr">
				<h4 class="sheet-center">Attributes</h4>
				<div class="sheet-row sheet-sub-header">
					<div class="sheet-col-1-12 sheet-center sheet-small-label">Score</div>
					<div class="sheet-col-1-12 sheet-center sheet-small-label">Max</div>
					<div class="sheet-col-1-10 sheet-center sheet-small-label">&nbsp;</div>
					<div class="sheet-col-1-16 sheet-center sheet-small-label">Mod</div>
					<div class="sheet-col-1-12 sheet-center sheet-small-label">GS</div>
					<div class="sheet-col-1-12 sheet-center sheet-small-label">TF</div>
					<div class="sheet-col-1-8 sheet-center sheet-small-label">Advantage</div>
					<div class="sheet-col-1-14 sheet-center sheet-small-label">Roll</div>
					<div class="sheet-col-1-4 sheet-center sheet-small-label">Notes</div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-12"><input type="number" name="attr_strength" min="1" step="1" value="10"/></div>
					<div class="sheet-col-1-12"><input type="number" name="attr_strength_max" min="1" step="1" value="10"/></div>
					<div class="sheet-col-1-10 sheet-core-stat-label">Str</div>
					<div class="sheet-col-1-16">
						<input type="text" name="attr_strength_mod" value="0" readonly/>
					</div>
					<div class="sheet-col-1-12"><input type="number" name="attr_strength_gs" value="1" readonly/></div>
					<div class="sheet-col-1-12"><input type="number" name="attr_strength_tf" value="20" readonly/></div>
                    <div class="sheet-col-1-8">
                        <select name="attr_strengthadvantage">
                            <option value="2d20cs=1cf=20kl1">ADV</option>
                            <option value="1d20cs=1cf=20" selected>NO</option>
                            <option value="2d20cs=1cf=20kh1">DIS</option>
                        </select>
                    </div>
					<div class="sheet-col-1-14 sheet-center">
					    <!-- Rolling Advantage h/l swap depending -->
					    <!-- ?{Advantage|Normal,1d20|Advantage,2d20kl1|Disadvantage,2d20kh1} -->
					    <!-- How to show advantage in the roll template
					        {{subheaderright= @{strengthadvantage}}} -> this will just eval as the roll result
					    -->
						<button type="roll" name="roll_Str" value="&{template:5eDefault} {{ability=1}} {{title=Strength Check}} {{subheader=@{character_name}}} {{check=[[@{strengthadvantage}]]}} {{target=[[{@{strength}, 19}kl1]]}} {{gsresult=[[@{strength_gs}]]}} {{tfresult=[[@{strength_tf}]]}}"></button>
					</div>
					<div class="sheet-col-1-4 sheet-tiny-note">Melee,&nbsp;Athletics</div>
				</div>
				<div class="sheet-row">
                    <div class="sheet-col-1-12"><input type="number" name="attr_dexterity" min="1" step="1" value="10"/></div>
                    <div class="sheet-col-1-12"><input type="number" name="attr_dexterity_max" min="1" step="1" value="10"/></div>
                    <div class="sheet-col-1-10 sheet-core-stat-label">Dex</div>
                    <div class="sheet-col-1-16">
						<input type="text" name="attr_dexterity_mod" value="0" readonly/>
					</div>
                    <div class="sheet-col-1-12"><input type="number" name="attr_dexterity_gs" value="1" readonly/></div>
					<div class="sheet-col-1-12"><input type="number" name="attr_dexterity_tf" value="20" readonly/></div>
                    <div class="sheet-col-1-8">
                        <select name="attr_dexterityadvantage">
                            <option value="2d20cs=1cf=20kl1">ADV</option>
                            <option value="1d20cs=1cf=20" selected>NO</option>
                            <option value="2d20cs=1cf=20kh1">DIS</option>
                        </select>
                    </div>
					<div class="sheet-col-1-14 sheet-center">
						<button type="roll" name="roll_Dex" value="&{template:5eDefault} {{ability=1}} {{title=Dexterity Check}} {{subheader=@{character_name}}} {{check=[[@{dexterityadvantage}]]}} {{target=[[{@{dexterity}, 19}kl1]]}} {{gsresult=[[@{dexterity_gs}]]}} {{tfresult=[[@{dexterity_tf}]]}}"></button>
					</div>
					<div class="sheet-col-1-4 sheet-tiny-note">Defence</div>
				</div>
                <div class="sheet-row">
                    <div class="sheet-col-1-12"><input type="number" name="attr_constitution" min="1" step="1" value="10"/></div>
                    <div class="sheet-col-1-12"><input type="number" name="attr_constitution_max" min="1" step="1" value="10"/></div>
					<div class="sheet-col-1-10 sheet-core-stat-label">Con</div>
					<div class="sheet-col-1-16">
                        <input type="text" name="attr_constitution_mod" value="0" readonly/>
					</div>
                    <div class="sheet-col-1-12"><input type="number" name="attr_constitution_gs" value="1" readonly/></div>
                    <div class="sheet-col-1-12"><input type="number" name="attr_constitution_tf" value="20" readonly/></div>
                    <div class="sheet-col-1-8">
                        <select name="attr_constitutionadvantage">
                            <option value="2d20cs=1cf=20kl1">ADV</option>
                            <option value="1d20cs=1cf=20" selected>NO</option>
                            <option value="2d20cs=1cf=20kh1">DIS</option>
                        </select>
                    </div>
					<div class="sheet-col-1-14 sheet-center">
						<button type="roll" name="roll_Con" value="&{template:5eDefault} {{ability=1}} {{title=Constitution Check}} {{subheader=@{character_name}}} {{check=[[@{constitutionadvantage}]]}} {{target=[[{@{constitution}, 19}kl1]]}} {{gsresult=[[@{constitution_gs}]]}} {{tfresult=[[@{constitution_tf}]]}}"></button>
					</div>
					<div class="sheet-col-1-4 sheet-tiny-note">Hit&nbsp;Points,&nbsp;Toxin</div>
				</div>
                <div class="sheet-row">
					<div class="sheet-col-1-12"><input type="number" name="attr_intelligence" min="1" step="1" value="10"/></div>
					<div class="sheet-col-1-12"><input type="number" name="attr_intelligence_max" min="1" step="1" value="10"/></div>
					<div class="sheet-col-1-10 sheet-core-stat-label">Int</div>
					<div class="sheet-col-1-16">
						<input type="text" name="attr_intelligence_mod" value="0" readonly/>
					</div>
					<div class="sheet-col-1-12"><input type="number" name="attr_intelligence_gs" value="1" readonly/></div>
					<div class="sheet-col-1-12"><input type="number" name="attr_intelligence_tf" value="20" readonly/></div>
                    <div class="sheet-col-1-8">
                        <select name="attr_intelligenceadvantage">
                            <option value="2d20cs=1cf=20kl1">ADV</option>
                            <option value="1d20cs=1cf=20" selected>NO</option>
                            <option value="2d20cs=1cf=20kh1">DIS</option>
                        </select>
                    </div>
					<div class="sheet-col-1-14 sheet-center">
						<button type="roll" name="roll_Int" value="&{template:5eDefault} {{ability=1}} {{title=Intelligence Check}} {{subheader=@{character_name}}} {{check=[[@{intelligenceadvantage}]]}} {{target=[[{@{intelligence}, 19}kl1]]}} {{gsresult=[[@{intelligence_gs}]]}} {{tfresult=[[@{intelligence_tf}]]}}"></button>
					</div>
					<div class="sheet-col-1-4 sheet-tiny-note">Knowledge,&nbsp;Lang</div>
				</div>
                <div class="sheet-row">
                    <div class="sheet-col-1-12"><input type="number" name="attr_perception" min="1" step="1" value="10"/></div>
                    <div class="sheet-col-1-12"><input type="number" name="attr_perception_max" min="1" step="1" value="10"/></div>
					<div class="sheet-col-1-10 sheet-core-stat-label">Per</div>
					<div class="sheet-col-1-16">
						<input type="text" name="attr_perception_mod" value="0" readonly/>
					</div>
					<div class="sheet-col-1-12"><input type="number" name="attr_perception_gs" value="1" readonly/></div>
                    <div class="sheet-col-1-12"><input type="number" name="attr_perception_tf" value="20" readonly/></div>
				   <div class="sheet-col-1-8">
                        <select name="attr_perceptionadvantage">
                            <option value="2d20cs=1cf=20kl1">ADV</option>
                            <option value="1d20cs=1cf=20" selected>NO</option>
                            <option value="2d20cs=1cf=20kh1">DIS</option>
                        </select>
                    </div>
					<div class="sheet-col-1-14 sheet-center">
						<button type="roll" name="roll_Per" value="&{template:5eDefault} {{ability=1}} {{title=Perception Check}} {{subheader=@{character_name}}} {{check=[[@{perceptionadvantage}]]}} {{target=[[{@{perception}, 19}kl1]]}} {{gsresult=[[@{perception_gs}]]}} {{tfresult=[[@{perception_tf}]]}}"></button>
					</div>
					<div class="sheet-col-1-4 sheet-tiny-note">Ranged,&nbsp;Detection</div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-12"><input type="number" name="attr_willpower" min="1" step="1" value="10"/></div>
					<div class="sheet-col-1-12"><input type="number" name="attr_willpower_max" min="1" step="1" value="10"/></div>
					<div class="sheet-col-1-10 sheet-core-stat-label">Will</div>
					<div class="sheet-col-1-16">
						<input type="text" name="attr_willpower_mod" value="0" readonly/>
					</div>
					<div class="sheet-col-1-12"><input type="number" name="attr_willpower_gs" value="1" readonly/></div>
					<div class="sheet-col-1-12"><input type="number" name="attr_willpower_tf" value="20" readonly/></div>
				   <div class="sheet-col-1-8">
                        <select name="attr_willpoweradvantage">
                            <option value="2d20cs=1cf=20kl1">ADV</option>
                            <option value="1d20cs=1cf=20" selected>NO</option>
                            <option value="2d20cs=1cf=20kh1">DIS</option>
                        </select>
                    </div>
					<div class="sheet-col-1-14 sheet-center">
						<button type="roll" name="roll_Will" value="&{template:5eDefault} {{ability=1}} {{title=Willpower Check}} {{subheader=@{character_name}}} {{check=[[@{willpoweradvantage}]]}} {{target=[[{@{willpower}, 19}kl1]]}} {{gsresult=[[@{willpower_gs}]]}} {{tfresult=[[@{willpower_tf}]]}}"></button>
						<button type="roll" name="roll_WillCyber" style="display:none" value="&{template:5eDefault} {{ability=1}} {{title=Willpower Casting Check}} {{subheader=@{character_name}}} {{check=[[@{willpoweradvantage}]]}} {{target=[[{@{willpower}-(@{cyberware}*2), 19}kl1]]}} {{gsresult=[[floor((@{willpower}-(@{cyberware}*2))/2)]]}} {{tfresult=[[{floor((@{willpower}-(@{cyberware}*2)*1.5))+1,20}kl1]]}}"></button>
					</div>
					<div class="sheet-col-1-4 sheet-tiny-note">Mental&nbsp;Defence,&nbsp;Recovery</div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-12"><input type="number" name="attr_charisma" min="1" step="1" value="10"/></div>
					<div class="sheet-col-1-12"><input type="number" name="attr_charisma_max" min="1" step="1" value="10"/></div>
					<div class="sheet-col-1-10 sheet-core-stat-label">Cha</div>
					<div class="sheet-col-1-16">
						<input type="text" name="attr_charisma_mod" value="0" readonly/>
					</div>
					<div class="sheet-col-1-12"><input type="number" name="attr_charisma_gs" value="1" readonly/></div>
					<div class="sheet-col-1-12"><input type="number" name="attr_charisma_tf" value="20" readonly/></div>
                    <div class="sheet-col-1-8">
                        <select name="attr_charismaadvantage">
                            <option value="2d20cs=1cf=20kl1">ADV</option>
                            <option value="1d20cs=1cf=20" selected>NO</option>
                            <option value="2d20cs=1cf=20kh1">DIS</option>
                        </select>
                    </div>
					<div class="sheet-col-1-14 sheet-center">
						<button type="roll" name="roll_Cha" value="&{template:5eDefault} {{ability=1}} {{title=Charisma Check}} {{subheader=@{character_name}}} {{check=[[@{charismaadvantage}]]}} {{target=[[{@{charisma}, 19}kl1]]}} {{gsresult=[[@{charisma_gs}]]}} {{tfresult=[[@{charisma_tf}]]}}"></button>
					</div>
					<div class="sheet-col-1-4 sheet-tiny-note">Influence,&nbsp;Networking</div>
				</div>
                <div class="sheet-row">
                    <div class="sheet-col-1-12"><input type="number" name="attr_luck" min="1" step="1" value="10"/></div>
                    <div class="sheet-col-1-12"><input type="number" name="attr_luck_max" min="1" step="1" value="10"/></div>
					<div class="sheet-col-1-10 sheet-luck-stat-label">Luck</div>
					<!--<div class="sheet-col-1-16">
						<input type="text" name="attr_luck_mod" value="0" readonly/>
					</div>-->
					<div class="sheet-col-11-48">
                        <select name="attr_luckvs">
                            <option value="1" selected>Luck Check</option>
                            <option value="2">(STR) Save</option>
                            <option value="3">(DEX) Save</option>
                            <option value="4">(CON) Save</option>
                            <option value="5">(INT) Save</option>
                            <option value="6">(PER) Save</option>
                            <option value="7">(WILL) Save</option>
                            <option value="8">(CHA) Save</option>
                        </select>
					</div>
                    <div class="sheet-col-1-8">
                        <select name="attr_luckadvantage">
                            <option value="2d20cs=1cf=20kl1">ADV</option>
                            <option value="1d20cs=1cf=20" selected>NO</option>
                            <option value="2d20cs=1cf=20kh1">DIS</option>
                        </select>
                    </div>
					<div class="sheet-col-1-14 sheet-center">
                        <input class="sheet-hide-it" type="text" name="attr_lucksave_title" value="Luck Check">
						<input class="sheet-hide-it" type="text" name="attr_lucksave_mod" value="0">
						<button type="roll" name="roll_Luck" value="&{template:5eDefault} {{ability=1}} {{title=@{lucksave_title}}} {{subheader=@{character_name}}} {{check=[[@{luckadvantage}]]}} {{target=[[{[[{@{luck}, ceil(@{level}/2)}kh1]] + @{lucksave_mod}, 19}kl1]]}} {{gsresult=[[ ([[{@{luck}, ceil(@{level}/2)}kh1]] + @{lucksave_mod})/2]]}} {{tfresult=[[ {[[floor(([[{@{luck}, ceil(@{level}/2)}kh1]] + @{lucksave_mod})*1.5)]], 19}kl1]]}}"></button>
					</div>
					<div class="sheet-col-1-4 sheet-tiny-note">Saves,&nbsp;Exploits</div>
				</div>
			</div>
			<!--Buncha Stats-->
			<div class="sheet-col-5-12 sheet-padr">
				<h4 class="sheet-center">Statistics</h4>
				<div class="sheet-row">
                    <div class="sheet-col-1-2 sheet-padr">
                        <div class="sheet-center sheet-small-label sheet-vert-bottom sheet-sub-header">Hit Points</div>
                        <div class="sheet-row">
                            <div class="sheet-col-1-2 sheet-small-label sheet-center">
                                <input class="sheet-underlined" type="number" name="attr_HP" step="1" value="0">
                                <br/>Current
                            </div>
                            <div class="sheet-col-1-2 sheet-small-label sheet-center">
                                <input class="sheet-underlined" type="number" name="attr_HP_max" min="1" step="1" value="1">
                                <br/>Max
                            </div>
                        </div>
                    </div>
                    <div class="sheet-col-1-2 sheet-padr">
                        <input type="hidden" class="sheet-newinit" name="attr_newinit_toggle" value="1"/>
                        <div class="sheet-center sheet-small-label sheet-vert-bottom sheet-sub-header">Initiative</div>
                        <div class="sheet-section-oldinit">
                            <div class="sheet-row">
                                <div class="sheet-col-1-6 sheet-small-label sheet-center">
                                    <input type="checkbox" name="attr_newinit_toggle" value="1" checked>
                                    Dlx
                                </div>
                                <div class="sheet-col-1-3 sheet-small-label sheet-center">
                                    <input class="sheet-underlined" type="number" name="attr_initiative" step="1" value="0">
                                    +Misc
                                </div>
            				   <div class="sheet-col-1-3 sheet-small-label sheet-center">
                                    <select name="attr_oldinitiativeadvantage">
                                        <option value="2d20kh1">ADV</option>
                                        <option value="1d20" selected>NO</option>
                                        <option value="2d20kl1">DIS</option>
                                    </select>
                                    <br/>Advantage
                                </div>
                                <div class="sheet-col-1-6 sheet-small-label sheet-center">
                                    <button type="roll" name="roll_ClassicInitiative" value="&{template:5eDefault} {{ability=1}} {{title=Classic Initiative Roll}} {{subheader=@{character_name}}} {{roll=[[ @{oldinitiativeadvantage}+(@{initiative}) &{tracker} ]]}}"></button>
                                    <div class="sheet-tiny-spacer"></div>Roll
                                </div>
                            </div>
                        </div>
                        <div class=" sheet-section-newinit">
                            <div class="sheet-row">
                                <div class="sheet-col-1-6 sheet-small-label sheet-center">
                                    <input type="checkbox" name="attr_newinit_toggle" value="1" checked>
                                    Dlx
                                </div>
                                <div class="sheet-col-1-3 sheet-small-label sheet-center">
                                    <input class="sheet-underlined" type="number" name="attr_initiative" step="1" value="0">
                                    +Misc
                                </div>
                                <div class="sheet-col-1-3 sheet-small-label sheet-center">
                                    <select name="attr_initiativeadvantage">
                                        <option value="2d20cs=1cf=20kl1">ADV</option>
                                        <option value="1d20cs=1cf=20" selected>NO</option>
                                        <option value="2d20cs=1cf=20kh1">DIS</option>
                                    </select>
                                    <br/>Advantage
                                </div>
    				            <div class="sheet-col-1-6 sheet-small-label sheet-center">
                                    <button type="roll" name="roll_DeluxeInitiative" value="&{template:5eDefault} {{ability=1}} {{title=Initiative Check}} {{subheader=@{character_name}}} {{check=[[@{initiativeadvantage}]]}} {{target=[[{floor((@{dexterity}+@{intelligence})/2)+(@{initiative}), 18}kl1]]}} {{gsresult=[[floor((@{dexterity}+@{intelligence})/4)]]}} {{tfresult=[[{floor(((@{dexterity}+@{intelligence})/2)*1.5)+1, 20}kl1]]}}"></button>
                                    <div class="sheet-tiny-spacer"></div>Roll
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-col-1-3 sheet-padr">
                        <div class="sheet-center sheet-small-label sheet-vert-bottom sheet-sub-header">Attack Bonus</div>
                        <div class="sheet-row">
                            <div class="sheet-col-1-1 sheet-small-label sheet-center">
                                <input class="sheet-underlined sheet-center" type="number" name="attr_class_hitbonus" step="1" value="0">
                                <br/>&nbsp;
                            </div>
                        </div>
                    </div>
                    <div class="sheet-col-1-3 sheet-padr">
                        <div class="sheet-center sheet-small-label sheet-vert-bottom sheet-sub-header">Defense</div>
                        <div class="sheet-row">
                            <div class="sheet-col-1-1 sheet-small-label sheet-center">
                                <input class="sheet-underlined sheet-center" type="number" name="attr_armour_class" step="1" value="10">
                                <br/>&nbsp;
                            </div>
                        </div>
					</div>
					<div class="sheet-col-1-3 sheet-padr">
						<div class="sheet-center sheet-small-label sheet-vert-bottom sheet-sub-header">Armour Rating</div>
						<div class="sheet-row">
							<div class="sheet-col-1-1 sheet-small-label sheet-center">
								<input class="sheet-underlined sheet-center" type="number" name="attr_armour_rating" step="1" value="0">
								<br/>&nbsp;
							</div>
						</div>
					</div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-col-1 sheet-padr">
                        <div class="sheet-center sheet-small-label sheet-vert-bottom sheet-sub-header">Reroll Pool</div>
                    </div>
                    <div class="sheet-col-3-8 sheet-padr">
                        <div class="sheet-row">
                            <div class="sheet-col-1-2 sheet-small-label sheet-center">
                                <input class="sheet-underlined" type="number" name="attr_rerolls" step="1" value="0">
                                <br/>Current
                            </div>
                            <div class="sheet-col-1-2 sheet-small-label sheet-center">
                                <input class="sheet-underlined" type="number" name="attr_rerolls_max" value="0">
                                <br/>Max
                            </div>
                        </div>
                    </div>
                    <div class="sheet-col-5-8 sheet-padr">
                        <div class="sheet-row">
                            <div class="sheet-col-1-4 sheet-tiny-note">Skill&nbsp;checks,&nbsp;Luck&nbsp;rolls,&nbsp;Rest recoveries,&nbsp;and&nbsp;Dead&nbsp;tests.</div>
                        </div>
                    </div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-col-1 sheet-padr">
                        <div class="sheet-center sheet-small-label sheet-vert-bottom sheet-sub-header">Cyberware</div>
                    </div>
                    <div class="sheet-col-1-8 sheet-padr">
                    </div>
                    <div class="sheet-col-3-16 sheet-padr">
                        <input class="sheet-underlined sheet-center" type="number" name="attr_cyberware" step="1" value="0">
                    </div>
                    <div class="sheet-col-11-16 sheet-padr">
                        <div class="sheet-row">
                            <div class="sheet-col-1-4 sheet-tiny-note">The&nbsp;number&nbsp;of&nbsp;pieces&nbsp;of&nbsp;cyberware&nbsp;you &nbsp;have&nbsp;equipped.</div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
<!----------------------------------------------------------->
    <!--Class-->
    <div class="sheet-section-class">
		<div class="sheet-row">
			<div class="sheet-col-1-2 sheet-padr">
				<h4 class="sheet-center">Features</h4>
				<div class="sheet-row sheet-sub-header">
					<div class="sheet-col-2-7 sheet-center sheet-small-label">Feature Name / Uses</div>
					<div class="sheet-col-5-7 sheet-center sheet-small-label">Feature Description</div>
				</div>
				<fieldset class="repeating_features">
				    <div class="sheet-row">
                        <div class="sheet-col-2-7">
                            <div class="sheet-row">
                                <input type="text" name="attr_featurename">
                            </div>
                            <div class="sheet-row">
                                <div class="sheet-col-1-4">
                                    <button type="roll" name="roll_Feature" value="&{template:5eDefault} {{feature=1}} {{featuresubheader=@{character_name}}} {{featureuses=@{feature_uses}}} {{featureusesmax=@{feature_uses|max}}} {{featureusesmaxnum=[[@{feature_uses|max}]]}} {{title=@{featurename}}} {{featureshowdesc=@{featuredescr}}}"></button>
                                </div>
                                <div class="sheet-col-3-10">
                                    <input type="number" name="attr_feature_uses" min="0" step="1" value="0" />
                                </div>
                                <div class="sheet-col-1-10 sheet-tiny-note">
                                    &nbsp;/&nbsp;
                                </div>
                                <div class="sheet-col-3-10">
                                    <input type="number" name="attr_feature_uses_max" min="0" step="1" value="0" />
                                </div>
                            </div>
                        </div>
                        <div class="sheet-col-5-7">
                            <div class="sheet-row">
                            	<textarea class="sheet-auto-expand" spellcheck="false" name="attr_featuredescr"></textarea>
                            </div>
                        </div>
                    </div>
                </fieldset>
			</div>
			<!--Buncha Stats-->
			<div class="sheet-col-1-2 sheet-padr">
				<h4 class="sheet-center">Skills</h4>
				<div class="sheet-row sheet-sub-header">
					<div class="sheet-col-1-2 sheet-center sheet-small-label">Skill Name</div>
					<div class="sheet-col-1-7 sheet-center sheet-small-label">Attribute</div>
					<div class="sheet-col-1-7 sheet-center sheet-small-label">Advantage</div>
					<div class="sheet-col-1-10 sheet-center sheet-small-label">Modifier</div>
					<div class="sheet-col-1-10 sheet-center sheet-small-label">Roll</div>
				</div>
				<fieldset class="repeating_skills">
				    <div class="sheet-row">
                        <div class="sheet-col-1-2">
                            <input type="text" name="attr_skillname">
                        </div>
                        <div class="sheet-col-1-7">
                            <select name="attr_skilltype">
                                <option value="STR" selected>STR</option>
                                <option value="DEX">DEX</option>
                                <option value="CON">CON</option>
                                <option value="INT">INT</option>
                                <option value="PER">PER</option>
                                <option value="WILL">WILL</option>
                                <option value="CHA">CHA</option>
                                <option value="LUCK">LUCK</option>
                            </select>
                        </div>
                        <input type="hidden" name="attr_skilltarget" value="@{strength}" readonly>
                        <input type="hidden" name="attr_skillgs" value="@{strength_gs}" readonly>
                        <input type="hidden" name="attr_skilltf" value="@{strength_tf}" readonly>
                        <div class="sheet-col-1-7">
                            <select name="attr_skilladvantage">
                                <option value="2d20cs=1cf=20kl1">ADV</option>
                                <option value="1d20cs=1cf=20" selected>NO</option>
                                <option value="2d20cs=1cf=20kh1">DIS</option>
                            </select>
                        </div>
                        <div class="sheet-col-1-10">
                            <input type="number" name="attr_skillmod" value="0" step="1">
                        </div>
                        <div class="sheet-col-1-10 sheet-center">
                            <button type="roll" name="roll_Skill" value="&{template:5eDefault} {{ability=1}} {{title=@{skillname} Check (@{skilltype})}} {{subheader=@{character_name}}} {{check=[[@{skilladvantage}]]}} {{target=[[{[[@{skilltarget}+(@{skillmod})]],19}kl1]]}} {{gsresult=[[@{skillgs}]]}} {{tfresult=[[@{skilltf}]]}}"></button>
                        </div>
                    </div>
                </fieldset>
            </div>
        </div>
    </div>
<!----------------------------------------------------------->
    <!--Combat-->
    <div class="sheet-section-combat">
        <span class="sheet-spacer"></span>
        <div class="sheet-col-1">
            <h4 class="sheet-center">Melee Weapons</h4>
            <div class="sheet-row">
                <div class="sheet-row sheet-sub-header">
                    <div class="sheet-col-9-24 sheet-center sheet-small-label">Weapon Name</div>
                    <div class="sheet-col-1-12 sheet-center sheet-small-label">Advantage</div>
                    <div class="sheet-col-1-12 sheet-center sheet-small-label sheet-padr">+Hit</div>
                    <div class="sheet-col-1-12 sheet-center sheet-small-label sheet-padr">+Dmg</div>
                    <div class="sheet-col-1-6 sheet-center sheet-small-label">Base Dmg</div>
                    <div class="sheet-col-1-12 sheet-center sheet-small-label">Crit Range</div>
                    <div class="sheet-col-1-12 sheet-center sheet-small-label">Crit Dmg</div>
                    <div class="sheet-col-1-24 sheet-center sheet-small-label sheet-padr">Roll</div>
                </div>
            </div>
        </div>
        <fieldset class="repeating_meleeattacks">
            <div class="sheet-row">
                <div class="sheet-col-9-24 sheet-padr"><input type="text" name="attr_melee_weaponname"></div>
                <div class="sheet-col-1-12 sheet-padr">
                    <select name="attr_melee_advantage">
                        <option value="2d20kh1">ADV</option>
                        <option value="1d20" selected>NO</option>
                        <option value="2d20kl1">DIS</option>
                    </select>
                </div>
                <div class="sheet-col-1-12 sheet-padr"><input type="number" name="attr_melee_hitbonus" value="0" step="1"></div>
                <div class="sheet-col-1-12 sheet-padr"><input type="number" name="attr_melee_dmgbonus" value="0" step="1"></div>
                <div class="sheet-col-1-6 sheet-padr"><input class="sheet-center" type="text" name="attr_melee_dmgbase" value="1d4"></div>
                <div class="sheet-col-1-12 sheet-padr">
                    <select name="attr_melee_critrange">
                                <option value="" selected>20</option>
                                <option value="cs>19">19-20</option>
                                <option value="cs>18">18-20</option>
                    </select>
                </div>
                <div class="sheet-col-1-12 sheet-padr"><input type="number" name="attr_melee_dmgcrit" value="4"></div>
                <div class="sheet-col-1-24 sheet-padr sheet-center">
                    <button type="roll" class="sheet-roll" name="roll_MeleeAttack" value="&{template:5eDefault} {{weapon=1}} {{title=@{melee_weaponname}}} {{subheader=@{character_name}}} {{attack=[[@{melee_advantage}@{melee_critrange}+@{class_hitbonus}+(@{strength_mod})+(@{melee_hitbonus})]]}} {{damage=[[@{melee_dmgbase}+(@{strength_mod})+(@{melee_dmgbonus})]]}} {{critdamage=[[@{melee_dmgcrit}]]}} @{meleedescr_toggle}"></button>
                </div>
            </div>
            <div class="sheet-row">
                <div class="sheet-col-23-24 sheet-padr">
                    <div class="sheet-auto-expand">
                    	<span name="attr_melee_description"></span>
                    	<textarea class="sheet-auto-expand" spellcheck="false" name="attr_melee_description" placeholder="Notes: STR mod factored in."></textarea>
                    </div>
                </div>
                <div class="sheet-col-1-24 sheet-padr">
                    <input type="checkbox" name="attr_meleedescr_toggle" value="@{meleedescr_var}">
                    <input type="hidden" name="attr_meleedescr_var" value={{attackdescription=@{melee_description}}}>
                </div>
            </div><hr/>
            <span class="sheet-spacer"></span>
        </fieldset>
        <div class="sheet-col-1">
            <h4 class="sheet-center">Ranged Weapons</h4>
            <div class="sheet-row">
                <div class="sheet-row sheet-sub-header">
                    <div class="sheet-col-7-24 sheet-center sheet-small-label">Weapon Name</div>
                    <div class="sheet-col-1-12 sheet-center sheet-small-label">Advantage</div>
                    <div class="sheet-col-1-12 sheet-center sheet-small-label">Range</div>
                    <div class="sheet-col-1-12 sheet-center sheet-small-label sheet-padr">+Hit</div>
                    <div class="sheet-col-1-12 sheet-center sheet-small-label sheet-padr">+Dmg</div>
					<div class="sheet-col-1-12 sheet-center sheet-small-label">Base Dmg</div>
                    <div class="sheet-col-1-12 sheet-center sheet-small-label">Crit Range</div>
					<div class="sheet-col-1-12 sheet-center sheet-small-label">Crit Dmg</div>
					<div class="sheet-col-1-12 sheet-center sheet-small-label">Burst</div>
                    <div class="sheet-col-1-24 sheet-center sheet-small-label sheet-padr">Roll</div>
                </div>
            </div>
        </div>
        <fieldset class="repeating_rangedattacks">
            <div class="sheet-row">
                <div class="sheet-col-7-24 sheet-padr"><input type="text" name="attr_range_weaponname"></div>
                <div class="sheet-col-1-12 sheet-padr">
                    <select name="attr_range_advantage">
                        <option value="2d20kh1">ADV</option>
                        <option value="1d20" selected>NO</option>
                        <option value="2d20kl1">DIS</option>
                    </select>
                </div>
                <div class="sheet-col-1-12 sheet-padr"><input type="text" name="attr_range_distance"></div>
                <div class="sheet-col-1-12 sheet-padr"><input type="number" name="attr_range_hitbonus" value="0" step="1"></div>
                <div class="sheet-col-1-12 sheet-padr"><input type="number" name="attr_range_dmgbonus" value="0" step="1"></div>
                <div class="sheet-col-1-12 sheet-padr"><input class="sheet-center" type="text" name="attr_range_dmgbase" value="1d4"></div>
                <div class="sheet-col-1-12 sheet-padr">
                    <select name="attr_range_critrange">
                                <option value="" selected>20</option>
                                <option value="cs>19">19-20</option>
                                <option value="cs>18">18-20</option>
                    </select>
                </div>
				<div class="sheet-col-1-12 sheet-padr"><input type="number" name="attr_range_dmgcrit" value="4"></div>
				<div class="sheet-col-1-12 sheet-padr">
					<select name="attr_range_burst">
						<option value="0" selected>Normal</option>
						<option value="2">Spray</option>
						<option value="-2">Focus Fire</option>
					</select>
				</div>
                <div class="sheet-col-1-24 sheet-padr sheet-center">
                    <button type="roll" class="sheet-roll" name="roll_RangeAttack" value="&{template:5eDefault} {{weapon=1}} {{title=@{range_weaponname} (Range:@{range_distance})}} {{subheader=@{character_name}}} {{attack=[[@{range_advantage}@{range_critrange}+@{class_hitbonus}+(@{perception_mod})+(@{range_hitbonus}+@{range_burst})]]}} {{damage=[[@{range_dmgbase}+(@{perception_mod})+(@{range_dmgbonus})]]}} {{critdamage=[[@{range_dmgcrit}]]}} @{rangedescr_toggle}"></button>
                </div>
            </div>
            <div class="sheet-row">
                <div class="sheet-col-23-24 sheet-padr">
                    <div class="sheet-auto-expand">
                    	<span name="attr_range_description"></span>
                    	<textarea class="sheet-auto-expand" spellcheck="false" name="attr_range_description" placeholder="Notes: Perception mod factored in. Focus fire does not include extra damage die."></textarea>
                    </div>
                </div>
                <div class="sheet-col-1-24 sheet-padr">
                    <input type="checkbox" name="attr_rangedescr_toggle" value="@{rangedescr_var}">
                    <input type="hidden" name="attr_rangedescr_var" value={{attackdescription=@{range_description}}}>
                </div>
            </div><hr/>
            <span class="sheet-spacer"></span>
        </fieldset>
    </div>
<!----------------------------------------------------------->
    <!--Spellbook-->
    <div class="sheet-section-spellbook">
		<h4 class="sheet-center">Spellbook</h4>
        <span class="sheet-spacer"></span>
		<input type="radio" name="attr_spellpagetab" class="sheet-spellpagetab sheet-spelltab99" value="99" title="Show All"/>
		<span class="sheet-spellpagetab sheet-spelltab99">Show All</span>
		<input type="radio" name="attr_spellpagetab" class="sheet-spellpagetab sheet-spelltab1" value="1" title="Level 1" checked/>
		<span class="sheet-spellpagetab sheet-spelltab1">Level 1</span>
		<input type="radio" name="attr_spellpagetab" class="sheet-spellpagetab sheet-spelltab2" value="2" title="Level 2"/>
		<span class="sheet-spellpagetab sheet-spelltab2">Level 2</span>
		<input type="radio" name="attr_spellpagetab" class="sheet-spellpagetab sheet-spelltab3" value="3" title="Level 3"/>
		<span class="sheet-spellpagetab sheet-spelltab3">Level 3</span>
		<input type="radio" name="attr_spellpagetab" class="sheet-spellpagetab sheet-spelltab4" value="4" title="Level 4"/>
		<span class="sheet-spellpagetab sheet-spelltab4">Level 4</span>
		<input type="radio" name="attr_spellpagetab" class="sheet-spellpagetab sheet-spelltab5" value="5" title="Level 5"/>
		<span class="sheet-spellpagetab sheet-spelltab5">Level 5</span>
		<input type="radio" name="attr_spellpagetab" class="sheet-spellpagetab sheet-spelltab6" value="6" title="Level 6"/>
		<span class="sheet-spellpagetab sheet-spelltab6">Level 6</span>
		<span class="sheet-spacer"></span>
		<!-- BEGIN AUTO GENERATED SPELL PAGES -->
	    <!-- BEGIN new spell page -->
		<div class="sheet-spell-page1">
		    <div class="sheet-row sheet-sub-header">
				<div class="sheet-col-1 sheet-vert-bottom sheet-center sheet-small-label">
				    <div class="sheet-row">
				        <div class="sheet-col-6-7">
				            Level 1
				        </div>
				        <div class="sheet-col-1-7">
				            <div class="sheet-row">
    				            <div class="sheet-col-1-3"><input type="number" name="attr_spellscast1" value="0" min="0" step="1"/></div>
                                <div class="sheet-col-1-24">/</div>
    				            <div class="sheet-col-1-3"><input type="number" name="attr_spellscast1_max" value="0" min="0" step="1"/></div>
    				            <div class="sheet-col-7-24 sheet-small-label">Spells Cast</div>
    				        </div>
				        </div>
				    </div>
				</div>
			</div>
			<fieldset class="repeating_spellbooklevel1">
			<!-- BEGIN spell row -->
			    <span class="sheet-spacer"></span>
    			<div class="sheet-margin-bottom sheet-padr sheet-padl">
    				<div class="sheet-row">
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Spell Level</div>
    					<div class="sheet-col-13-24 sheet-vert-bottom sheet-center sheet-small-label">Spell Name</div>
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Range</div>
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Duration</div>
    					<div class="sheet-col-1-12 sheet-center sheet-small-label sheet-vert-bottom">Roll</div>
    				</div>
    				
    				<div class="sheet-row">
    					<div class="sheet-col-1-8 sheet-vert-middle sheet-center">Level 1<input type="hidden" name="attr_spellbaselevel" value="1"></div>
    					<div class="sheet-col-13-24 sheet-vert-middle"><input type="text" name="attr_spellname"></div>
    					<div class="sheet-col-1-8 sheet-vert-middle"><input type="text" name="attr_spellrange"></div>
    					<div class="sheet-col-1-8 sheet-vert-middle"><input type="text" name="attr_spellduration"></div>
                        <div class="sheet-col-1-12 sheet-center">
                            <button type="roll" class="sheet-roll" name="roll_SpellCast" value="&{template:5eDefault} {{spell=1}} {{spellshowinfoblock=1}} {{spellshowdesc=1}} {{title=@{spellname}}} {{subheader=@{character_name}}} {{subheaderright=Level @{spellbaselevel} Spell • @{spellscast1}/@{spellscast1|max}}} {{spellduration=@{spellduration}}} {{spellrange=@{spellrange}}} {{spelldescription=@{spelldescr}}} {{ddmrequest=[Willpower Casting Check](~@{character_id}|WillCyber)}}"></button>
                        </div>
    				</div>
    				<div class="sheet-row">
    				    <div class="sheet-col-1">
        					<div class="sheet-auto-expand">
                                <span name="attr_spelldescr"></span>
                                <textarea class="sheet-auto-expand" spellcheck="false" name="attr_spelldescr" placeholder="Spell Description and Effects"></textarea>
                            </div>
                        </div>
    				</div>
    				<span class="sheet-spacer"></span>
    			</div>
			<!-- END spell row -->	
			</fieldset>
		</div>
		<!-- END spell page -->
		<!-- BEGIN new spell page -->
		<div class="sheet-spell-page2">
		    <div class="sheet-row sheet-sub-header">
				<div class="sheet-col-1 sheet-vert-bottom sheet-center sheet-small-label">
				    <div class="sheet-row">
				        <div class="sheet-col-6-7">
				            Level 2
				        </div>
				        <div class="sheet-col-1-7">
				            <div class="sheet-row">
    				            <div class="sheet-col-1-3"><input type="number" name="attr_spellscast2" value="0" min="0" step="1"/></div>
                                <div class="sheet-col-1-24">/</div>
    				            <div class="sheet-col-1-3"><input type="number" name="attr_spellscast2_max" value="0" min="0" step="1"/></div>
    				            <div class="sheet-col-7-24 sheet-small-label">Spells Cast</div>
    				        </div>
				        </div>
				    </div>
				</div>
			</div>
			<fieldset class="repeating_spellbooklevel2">
			<!-- BEGIN spell row -->
			    <span class="sheet-spacer"></span>
    			<div class="sheet-margin-bottom sheet-padr sheet-padl">
    				<div class="sheet-row">
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Spell Level</div>
    					<div class="sheet-col-13-24 sheet-vert-bottom sheet-center sheet-small-label">Spell Name</div>
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Range</div>
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Duration</div>
    					<div class="sheet-col-1-12 sheet-center sheet-small-label sheet-vert-bottom">Roll</div>
    				</div>
    				
    				<div class="sheet-row">
    					<div class="sheet-col-1-8 sheet-vert-middle sheet-center">Level 2<input type="hidden" name="attr_spellbaselevel" value="2"></div>
    					<div class="sheet-col-13-24 sheet-vert-middle"><input type="text" name="attr_spellname"></div>
    					<div class="sheet-col-1-8 sheet-vert-middle"><input type="text" name="attr_spellrange"></div>
    					<div class="sheet-col-1-8 sheet-vert-middle"><input type="text" name="attr_spellduration"></div>
                        <div class="sheet-col-1-12 sheet-center">
                            <button type="roll" class="sheet-roll" name="roll_SpellCast" value="&{template:5eDefault} {{spell=1}} {{spellshowinfoblock=1}} {{spellshowdesc=1}} {{title=@{spellname}}} {{subheader=@{character_name}}} {{subheaderright=Level @{spellbaselevel} Spell • @{spellscast2}/@{spellscast2|max}}} {{spellduration=@{spellduration}}} {{spellrange=@{spellrange}}} {{spelldescription=@{spelldescr}}} {{ddmrequest=[Willpower Casting Check](~@{character_id}|WillCyber)}}"></button>
                        </div>
    				</div>
    				<div class="sheet-row">
    				    <div class="sheet-col-1">
        					<div class="sheet-auto-expand">
                                <span name="attr_spelldescr"></span>
                                <textarea class="sheet-auto-expand" spellcheck="false" name="attr_spelldescr" placeholder="Spell Description and Effects"></textarea>
                            </div>
                        </div>
    				</div>
    				<span class="sheet-spacer"></span>
    			</div>
			<!-- END spell row -->	
			</fieldset>
		</div>
		<!-- END spell page -->
		<!-- BEGIN new spell page -->
		<div class="sheet-spell-page3">
		    <div class="sheet-row sheet-sub-header">
				<div class="sheet-col-1 sheet-vert-bottom sheet-center sheet-small-label">
				    <div class="sheet-row">
				        <div class="sheet-col-6-7">
				            Level 3
				        </div>
				        <div class="sheet-col-1-7">
				            <div class="sheet-row">
    				            <div class="sheet-col-1-3"><input type="number" name="attr_spellscast3" value="0" min="0" step="1"/></div>
                                <div class="sheet-col-1-24">/</div>
    				            <div class="sheet-col-1-3"><input type="number" name="attr_spellscast3_max" value="0" min="0" step="1"/></div>
    				            <div class="sheet-col-7-24 sheet-small-label">Spells Cast</div>
    				        </div>
				        </div>
				    </div>
				</div>
			</div>
			<fieldset class="repeating_spellbooklevel3">
			<!-- BEGIN spell row -->
			    <span class="sheet-spacer"></span>
    			<div class="sheet-margin-bottom sheet-padr sheet-padl">
    				<div class="sheet-row">
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Spell Level</div>
    					<div class="sheet-col-13-24 sheet-vert-bottom sheet-center sheet-small-label">Spell Name</div>
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Range</div>
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Duration</div>
    					<div class="sheet-col-1-12 sheet-center sheet-small-label sheet-vert-bottom">Roll</div>
    				</div>
    				
    				<div class="sheet-row">
    					<div class="sheet-col-1-8 sheet-vert-middle sheet-center">Level 3<input type="hidden" name="attr_spellbaselevel" value="3"></div>
    					<div class="sheet-col-13-24 sheet-vert-middle"><input type="text" name="attr_spellname"></div>
    					<div class="sheet-col-1-8 sheet-vert-middle"><input type="text" name="attr_spellrange"></div>
    					<div class="sheet-col-1-8 sheet-vert-middle"><input type="text" name="attr_spellduration"></div>
                        <div class="sheet-col-1-12 sheet-center">
                            <button type="roll" class="sheet-roll" name="roll_SpellCast" value="&{template:5eDefault} {{spell=1}} {{spellshowinfoblock=1}} {{spellshowdesc=1}} {{title=@{spellname}}} {{subheader=@{character_name}}} {{subheaderright=Level @{spellbaselevel} Spell • @{spellscast3}/@{spellscast3|max}}} {{spellduration=@{spellduration}}} {{spellrange=@{spellrange}}} {{spelldescription=@{spelldescr}}} {{ddmrequest=[Willpower Casting Check](~@{character_id}|WillCyber)}}"></button>
                        </div>
    				</div>
    				<div class="sheet-row">
    				    <div class="sheet-col-1">
        					<div class="sheet-auto-expand">
                                <span name="attr_spelldescr"></span>
                                <textarea class="sheet-auto-expand" spellcheck="false" name="attr_spelldescr" placeholder="Spell Description and Effects"></textarea>
                            </div>
                        </div>
    				</div>
    				<span class="sheet-spacer"></span>
    			</div>
			<!-- END spell row -->	
			</fieldset>
		</div>
		<!-- END spell page -->
		<!-- BEGIN new spell page -->
		<div class="sheet-spell-page4">
		    <div class="sheet-row sheet-sub-header">
				<div class="sheet-col-1 sheet-vert-bottom sheet-center sheet-small-label">
				    <div class="sheet-row">
				        <div class="sheet-col-6-7">
				            Level 4
				        </div>
				        <div class="sheet-col-1-7">
				            <div class="sheet-row">
    				            <div class="sheet-col-1-3"><input type="number" name="attr_spellscast4" value="0" min="0" step="1"/></div>
                                <div class="sheet-col-1-24">/</div>
    				            <div class="sheet-col-1-3"><input type="number" name="attr_spellscast4_max" value="0" min="0" step="1"/></div>
    				            <div class="sheet-col-7-24 sheet-small-label">Spells Cast</div>
    				        </div>
				        </div>
				    </div>
				</div>
			</div>
			<fieldset class="repeating_spellbooklevel4">
			<!-- BEGIN spell row -->
			    <span class="sheet-spacer"></span>
    			<div class="sheet-margin-bottom sheet-padr sheet-padl">
    				<div class="sheet-row">
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Spell Level</div>
    					<div class="sheet-col-13-24 sheet-vert-bottom sheet-center sheet-small-label">Spell Name</div>
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Range</div>
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Duration</div>
    					<div class="sheet-col-1-12 sheet-center sheet-small-label sheet-vert-bottom">Roll</div>
    				</div>
    				
    				<div class="sheet-row">
    					<div class="sheet-col-1-8 sheet-vert-middle sheet-center">Level 4<input type="hidden" name="attr_spellbaselevel" value="4"></div>
    					<div class="sheet-col-13-24 sheet-vert-middle"><input type="text" name="attr_spellname"></div>
    					<div class="sheet-col-1-8 sheet-vert-middle"><input type="text" name="attr_spellrange"></div>
    					<div class="sheet-col-1-8 sheet-vert-middle"><input type="text" name="attr_spellduration"></div>
                        <div class="sheet-col-1-12 sheet-center">
                            <button type="roll" class="sheet-roll" name="roll_SpellCast" value="&{template:5eDefault} {{spell=1}} {{spellshowinfoblock=1}} {{spellshowdesc=1}} {{title=@{spellname}}} {{subheader=@{character_name}}} {{subheaderright=Level @{spellbaselevel} Spell • @{spellscast4}/@{spellscast4|max}}} {{spellduration=@{spellduration}}} {{spellrange=@{spellrange}}} {{spelldescription=@{spelldescr}}} {{ddmrequest=[Willpower Casting Check](~@{character_id}|WillCyber)}}"></button>
                        </div>
    				</div>
    				<div class="sheet-row">
    				    <div class="sheet-col-1">
        					<div class="sheet-auto-expand">
                                <span name="attr_spelldescr"></span>
                                <textarea class="sheet-auto-expand" spellcheck="false" name="attr_spelldescr" placeholder="Spell Description and Effects"></textarea>
                            </div>
                        </div>
    				</div>
    				<span class="sheet-spacer"></span>
    			</div>
			<!-- END spell row -->	
			</fieldset>
		</div>
		<!-- END spell page -->
		<!-- BEGIN new spell page -->
		<div class="sheet-spell-page5">
		    <div class="sheet-row sheet-sub-header">
				<div class="sheet-col-1 sheet-vert-bottom sheet-center sheet-small-label">
				    <div class="sheet-row">
				        <div class="sheet-col-6-7">Level 5</div>
				        <div class="sheet-col-1-7">
				            <div class="sheet-row">
    				            <div class="sheet-col-1-3"><input type="number" name="attr_spellscast5" value="0" min="0" step="1"/></div>
                                <div class="sheet-col-1-24">/</div>
    				            <div class="sheet-col-1-3"><input type="number" name="attr_spellscast5_max" value="0" min="0" step="1"/></div>
    				            <div class="sheet-col-7-24 sheet-small-label">Spells Cast</div>
    				        </div>
				        </div>
				    </div>
				</div>
			</div>
			<fieldset class="repeating_spellbooklevel5">
			<!-- BEGIN spell row -->
			    <span class="sheet-spacer"></span>
    			<div class="sheet-margin-bottom sheet-padr sheet-padl">
    				<div class="sheet-row">
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Spell Level</div>
    					<div class="sheet-col-13-24 sheet-vert-bottom sheet-center sheet-small-label">Spell Name</div>
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Range</div>
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Duration</div>
    					<div class="sheet-col-1-12 sheet-center sheet-small-label sheet-vert-bottom">Roll</div>
    				</div>
    				
    				<div class="sheet-row">
    					<div class="sheet-col-1-8 sheet-vert-middle sheet-center">Level 5<input type="hidden" name="attr_spellbaselevel" value="5"></div>
    					<div class="sheet-col-13-24 sheet-vert-middle"><input type="text" name="attr_spellname"></div>
    					<div class="sheet-col-1-8 sheet-vert-middle"><input type="text" name="attr_spellrange"></div>
    					<div class="sheet-col-1-8 sheet-vert-middle"><input type="text" name="attr_spellduration"></div>
                        <div class="sheet-col-1-12 sheet-center">
                            <button type="roll" class="sheet-roll" name="roll_SpellCast" value="&{template:5eDefault} {{spell=1}} {{spellshowinfoblock=1}} {{spellshowdesc=1}} {{title=@{spellname}}} {{subheader=@{character_name}}} {{subheaderright=Level @{spellbaselevel} Spell • @{spellscast5}/@{spellscast5|max}}} {{spellduration=@{spellduration}}} {{spellrange=@{spellrange}}} {{spelldescription=@{spelldescr}}} {{ddmrequest=[Willpower Casting Check](~@{character_id}|WillCyber)}}"></button>
                        </div>
    				</div>
    				<div class="sheet-row">
    				    <div class="sheet-col-1">
        					<div class="sheet-auto-expand">
                                <span name="attr_spelldescr"></span>
                                <textarea class="sheet-auto-expand" spellcheck="false" name="attr_spelldescr" placeholder="Spell Description and Effects"></textarea>
                            </div>
                        </div>
    				</div>
    				<span class="sheet-spacer"></span>
    			</div>
			<!-- END spell row -->	
			</fieldset>
		</div>
		<!-- END spell page -->
		<!-- BEGIN new spell page -->
		<div class="sheet-spell-page6">
		    <div class="sheet-row sheet-sub-header">
				<div class="sheet-col-1 sheet-vert-bottom sheet-center sheet-small-label">
				    <div class="sheet-row">
				        <div class="sheet-col-6-7">Level 6</div>
				        <div class="sheet-col-1-7">
				            <div class="sheet-row">
    				            <div class="sheet-col-1-3"><input type="number" name="attr_spellscast6" value="0" min="0" step="1"/></div>
                                <div class="sheet-col-1-24">/</div>
    				            <div class="sheet-col-1-3"><input type="number" name="attr_spellscast6_max" value="0" min="0" step="1"/></div>
    				            <div class="sheet-col-7-24 sheet-small-label">Spells Cast</div>
    				        </div>
				        </div>
				    </div>
				</div>
			</div>
			<fieldset class="repeating_spellbooklevel6">
			<!-- BEGIN spell row -->
			    <span class="sheet-spacer"></span>
    			<div class="sheet-margin-bottom sheet-padr sheet-padl">
    				<div class="sheet-row">
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Spell Level</div>
    					<div class="sheet-col-13-24 sheet-vert-bottom sheet-center sheet-small-label">Spell Name</div>
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Range</div>
    					<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Duration</div>
    					<div class="sheet-col-1-12 sheet-center sheet-small-label sheet-vert-bottom">Roll</div>
    				</div>
    				
    				<div class="sheet-row">
    					<div class="sheet-col-1-8 sheet-vert-middle sheet-center">Level 6<input type="hidden" name="attr_spellbaselevel" value="6"></div>
    					<div class="sheet-col-13-24 sheet-vert-middle"><input type="text" name="attr_spellname"></div>
    					<div class="sheet-col-1-8 sheet-vert-middle"><input type="text" name="attr_spellrange"></div>
    					<div class="sheet-col-1-8 sheet-vert-middle"><input type="text" name="attr_spellduration"></div>
                        <div class="sheet-col-1-12 sheet-center">
                            <button type="roll" class="sheet-roll" name="roll_SpellCast" value="&{template:5eDefault} {{spell=1}} {{spellshowinfoblock=1}} {{spellshowdesc=1}} {{title=@{spellname}}} {{subheader=@{character_name}}} {{subheaderright=Level @{spellbaselevel} Spell • @{spellscast6}/@{spellscast6|max}}} {{spellduration=@{spellduration}}} {{spellrange=@{spellrange}}} {{spelldescription=@{spelldescr}}} {{ddmrequest=[Willpower Casting Check](~@{character_id}|WillCyber)}}"></button>
                        </div>
    				</div>
    				<div class="sheet-row">
    				    <div class="sheet-col-1">
        					<div class="sheet-auto-expand">
                                <span name="attr_spelldescr"></span>
                                <textarea class="sheet-auto-expand" spellcheck="false" name="attr_spelldescr" placeholder="Spell Description and Effects"></textarea>
                            </div>
                        </div>
    				</div>
    				<span class="sheet-spacer"></span>
    			</div>
			<!-- END spell row -->	
			</fieldset>
		</div>
		<!-- END spell page -->
		<!-- END AUTO GENERATED SPELL PAGES -->
	</div>

<!----------------------------------------------------------->
    <!--Inventory-->
<!----------------------------------------------------------->

	<!--Inventory -->
	<div class="sheet-section-inventory">
		<div class="sheet-row ">
			<!-- Loot-->
			<div class="sheet-col-1-2 sheet-padr">
				<h4 class="sheet-center">Gear & Notes</h4>
				<textarea name="attr_lootnotes" style="height:215px"></textarea>
			</div>
			<!--Encumbrance and Inventory Locations -->
			<div class="sheet-col-1-2">
				<h4 class="sheet-center">Inventory Locations</h4>
				<div class="sheet-row sheet-sub-header">
					<div class="sheet-col-1-8 sheet-center sheet-small-label sheet-padl">Tab</div>
					<div class="sheet-col-7-8 sheet-center sheet-small-label">Name</div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-8 sheet-center sheet-padl">1</div>
					<div class="sheet-col-7-8 sheet-center"><input type="text" name="attr_itab1" value="Worn"></div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-8 sheet-center sheet-padl">2</div>
					<div class="sheet-col-7-8 sheet-center"><input type="text" name="attr_itab2" value="Carried"></div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-8 sheet-center sheet-padl">3</div>
					<div class="sheet-col-7-8 sheet-center"><input type="text" name="attr_itab3" value="Pack/Sling"></div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-8 sheet-center sheet-padl">4</div>
					<div class="sheet-col-7-8 sheet-center"><input type="text" name="attr_itab4" value="Belt"></div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-8 sheet-center sheet-padl">5</div>
					<div class="sheet-col-7-8 sheet-center"><input type="text" name="attr_itab5" value="Bag"></div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-8 sheet-center sheet-padl">6</div>
					<div class="sheet-col-7-8 sheet-center"><input type="text" name="attr_itab6" value="Vehicle"></div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-8 sheet-center sheet-padl">7</div>
					<div class="sheet-col-7-8 sheet-center"><input type="text" name="attr_itab7" value="Other"></div>
				</div>
			</div>
		</div>
		<h4 class="sheet-center">Gear</h4>
		<input type="checkbox" name="attr_inventorytab1" class="sheet-inventorytab sheet-inventorytab1" value="1" title="Page 1" />
		<span class="sheet-inventorytab sheet-inventorytab1" name="attr_itab1"></span>
		<input type="checkbox" name="attr_inventorytab2" class="sheet-inventorytab sheet-inventorytab2" value="2" title="Page 2" />
		<span class="sheet-inventorytab sheet-inventorytab2" name="attr_itab2"></span>
		<input type="checkbox" name="attr_inventorytab3" class="sheet-inventorytab sheet-inventorytab3" value="3" title="Page 3" />
		<span class="sheet-inventorytab sheet-inventorytab3" name="attr_itab3"></span>
		<input type="checkbox" name="attr_inventorytab4" class="sheet-inventorytab sheet-inventorytab4" value="4" title="Page 4" />
		<span class="sheet-inventorytab sheet-inventorytab4" name="attr_itab4"></span>
		<input type="checkbox" name="attr_inventorytab5" class="sheet-inventorytab sheet-inventorytab5" value="5" title="Page 5" />
		<span class="sheet-inventorytab sheet-inventorytab5" name="attr_itab5"></span>
		<input type="checkbox" name="attr_inventorytab6" class="sheet-inventorytab sheet-inventorytab6" value="6" title="Page 6" />
		<span class="sheet-inventorytab sheet-inventorytab6" name="attr_itab6"></span>
		<input type="checkbox" name="attr_inventorytab7" class="sheet-inventorytab sheet-inventorytab7" value="7" title="Page 7" />
		<span class="sheet-inventorytab sheet-inventorytab7" name="attr_itab7"></span>
		<span class="sheet-spacer"></span>
		<!-- Inventory Page 1-->
		<div class="sheet-inventory-page1">
			<div class="sheet-row sheet-sub-header">
			    <div class="sheet-col-1 sheet-center sheet-small-label sheet-padl"><span name="attr_itab1"></span></div>
				<div class="sheet-col-1-4 sheet-center sheet-small-label sheet-padl">Name</div>
				<div class="sheet-col-2-21 sheet-center sheet-small-label">Qty</div>
				<div class="sheet-col-2-21 sheet-center sheet-small-label">Uses</div>
				<div class="sheet-col-13-24 sheet-center sheet-small-label sheet-padl">Notes</div>
			</div>
			<fieldset class="repeating_inventtab1">
				<div class="sheet-row">
					<div class="sheet-col-1-4 sheet-small-label sheet-left"><input type="text" name="attr_itemname"></div>
					<div class="sheet-col-2-21 sheet-padl sheet-center"><input type="number" name="attr_itemquantity"></div>
					<div class="sheet-col-2-21 sheet-padl sheet-center"><input type="number" name="attr_itemuses"></div>
					<div class="sheet-col-13-24 sheet-padl sheet-small-label sheet-left"><input type="text" name="attr_itemdesc"></div>
				</div>
			</fieldset>
		</div>
		<!-- Inventory Page 2-->
		<div class="sheet-inventory-page2">
			<div class="sheet-row sheet-sub-header">
			    <div class="sheet-col-1 sheet-center sheet-small-label sheet-padl"><span name="attr_itab2"></span></div>
				<div class="sheet-col-1-4 sheet-center sheet-small-label sheet-padl">Name</div>
				<div class="sheet-col-2-21 sheet-center sheet-small-label">Qty</div>
				<div class="sheet-col-2-21 sheet-center sheet-small-label">Uses</div>
				<div class="sheet-col-13-24 sheet-center sheet-small-label sheet-padl">Notes</div>
			</div>
			<fieldset class="repeating_inventtab2">
				<div class="sheet-row">
					<div class="sheet-col-1-4 sheet-small-label sheet-left"><input type="text" name="attr_itemname"></div>
					<div class="sheet-col-2-21 sheet-padl sheet-center"><input type="number" name="attr_itemquantity"></div>
					<div class="sheet-col-2-21 sheet-padl sheet-center"><input type="number" name="attr_itemuses"></div>
					<div class="sheet-col-13-24 sheet-padl sheet-small-label sheet-left"><input type="text" name="attr_itemdesc"></div>
				</div>
			</fieldset>
		</div>
		<!-- Inventory Page 3-->
		<div class="sheet-inventory-page3">
			<div class="sheet-row sheet-sub-header">
			    <div class="sheet-col-1 sheet-center sheet-small-label sheet-padl"><span name="attr_itab3"></span></div>
				<div class="sheet-col-1-4 sheet-center sheet-small-label sheet-padl">Name</div>
				<div class="sheet-col-2-21 sheet-center sheet-small-label">Qty</div>
				<div class="sheet-col-2-21 sheet-center sheet-small-label">Uses</div>
				<div class="sheet-col-13-24 sheet-center sheet-small-label sheet-padl">Notes</div>
			</div>
			<fieldset class="repeating_inventtab3">
				<div class="sheet-row">
					<div class="sheet-col-1-4 sheet-small-label sheet-left"><input type="text" name="attr_itemname"></div>
					<div class="sheet-col-2-21 sheet-padl sheet-center"><input type="number" name="attr_itemquantity"></div>
					<div class="sheet-col-2-21 sheet-padl sheet-center"><input type="number" name="attr_itemuses"></div>
					<div class="sheet-col-13-24 sheet-padl sheet-small-label sheet-left"><input type="text" name="attr_itemdesc"></div>
				</div>
			</fieldset>
		</div>
		<!-- Inventory Page 4-->
		<div class="sheet-inventory-page4">
			<div class="sheet-row sheet-sub-header">
			    <div class="sheet-col-1 sheet-center sheet-small-label sheet-padl"><span name="attr_itab4"></span></div>
				<div class="sheet-col-1-4 sheet-center sheet-small-label sheet-padl">Name</div>
				<div class="sheet-col-2-21 sheet-center sheet-small-label">Qty</div>
				<div class="sheet-col-2-21 sheet-center sheet-small-label">Uses</div>
				<div class="sheet-col-13-24 sheet-center sheet-small-label sheet-padl">Notes</div>
			</div>
			<fieldset class="repeating_inventtab4">
				<div class="sheet-row">
					<div class="sheet-col-1-4 sheet-small-label sheet-left"><input type="text" name="attr_itemname"></div>
					<div class="sheet-col-2-21 sheet-padl sheet-center"><input type="number" name="attr_itemquantity"></div>
					<div class="sheet-col-2-21 sheet-padl sheet-center"><input type="number" name="attr_itemuses"></div>
					<div class="sheet-col-13-24 sheet-padl sheet-small-label sheet-left"><input type="text" name="attr_itemdesc"></div>
				</div>
			</fieldset>
		</div>
		<!-- Inventory Page 5-->
		<div class="sheet-inventory-page5">
			<div class="sheet-row sheet-sub-header">
			    <div class="sheet-col-1 sheet-center sheet-small-label sheet-padl"><span name="attr_itab5"></span></div>
				<div class="sheet-col-1-4 sheet-center sheet-small-label sheet-padl">Name</div>
				<div class="sheet-col-2-21 sheet-center sheet-small-label">Qty</div>
				<div class="sheet-col-2-21 sheet-center sheet-small-label">Uses</div>
				<div class="sheet-col-13-24 sheet-center sheet-small-label sheet-padl">Notes</div>
			</div>
			<fieldset class="repeating_inventtab5">
				<div class="sheet-row">
					<div class="sheet-col-1-4 sheet-small-label sheet-left"><input type="text" name="attr_itemname"></div>
					<div class="sheet-col-2-21 sheet-padl sheet-center"><input type="number" name="attr_itemquantity"></div>
					<div class="sheet-col-2-21 sheet-padl sheet-center"><input type="number" name="attr_itemuses"></div>
					<div class="sheet-col-13-24 sheet-padl sheet-small-label sheet-left"><input type="text" name="attr_itemdesc"></div>
				</div>
			</fieldset>
		</div>
		<!-- Inventory Page 6-->
		<div class="sheet-inventory-page6">
			<div class="sheet-row sheet-sub-header">
			    <div class="sheet-col-1 sheet-center sheet-small-label sheet-padl"><span name="attr_itab6"></span></div>
				<div class="sheet-col-1-4 sheet-center sheet-small-label sheet-padl">Name</div>
				<div class="sheet-col-2-21 sheet-center sheet-small-label">Qty</div>
				<div class="sheet-col-2-21 sheet-center sheet-small-label">Uses</div>
				<div class="sheet-col-13-24 sheet-center sheet-small-label sheet-padl">Notes</div>
			</div>
			<fieldset class="repeating_inventtab6">
				<div class="sheet-row">
					<div class="sheet-col-1-4 sheet-small-label sheet-left"><input type="text" name="attr_itemname"></div>
					<div class="sheet-col-2-21 sheet-padl sheet-center"><input type="number" name="attr_itemquantity"></div>
					<div class="sheet-col-2-21 sheet-padl sheet-center"><input type="number" name="attr_itemuses"></div>
					<div class="sheet-col-13-24 sheet-padl sheet-small-label sheet-left"><input type="text" name="attr_itemdesc"></div>
				</div>
			</fieldset>
		</div>
		<!-- Inventory Page 7-->
		<div class="sheet-inventory-page7">
			<div class="sheet-row sheet-sub-header">
			    <div class="sheet-col-1 sheet-center sheet-small-label sheet-padl"><span name="attr_itab7"></span></div>
				<div class="sheet-col-1-4 sheet-center sheet-small-label sheet-padl">Name</div>
				<div class="sheet-col-2-21 sheet-center sheet-small-label">Qty</div>
				<div class="sheet-col-2-21 sheet-center sheet-small-label">Uses</div>
				<div class="sheet-col-13-24 sheet-center sheet-small-label sheet-padl">Notes</div>
			</div>
			<fieldset class="repeating_inventtab7">
				<div class="sheet-row">
					<div class="sheet-col-1-4 sheet-small-label sheet-left"><input type="text" name="attr_itemname"></div>
					<div class="sheet-col-2-21 sheet-padl sheet-center"><input type="number" name="attr_itemquantity"></div>
					<div class="sheet-col-2-21 sheet-padl sheet-center"><input type="number" name="attr_itemuses"></div>
					<div class="sheet-col-13-24 sheet-padl sheet-small-label sheet-left"><input type="text" name="attr_itemdesc"></div>
				</div>
			</fieldset>
		</div>
	</div>
<!----------------------------------------------------------->
	<!--Network-->
	<div class="sheet-section-network">
		<div class="sheet-row">
			<div class="sheet-col-1 sheet-padr">
				<h4 class="sheet-center">Network</h4>
				<div class="sheet-row sheet-sub-header">
					<div class="sheet-col-1-6 sheet-center sheet-small-label">Contact Name</div>
					<div class="sheet-col-5-6 sheet-center sheet-small-label">Notes/Description</div>
				</div>
				<fieldset class="repeating_network">
					<div class="sheet-row">
						<div class="sheet-col-1-6">
							<input type="text" name="attr_networkname">
						</div>
						<div class="sheet-col-5-6">
							<div class="sheet-auto-expand">
								<span name="attr_networkdescription"></span>
								<textarea class="sheet-auto-expand" spellcheck="false" name="attr_networkdescription"></textarea>
							</div>
						</div>
					</div>
				</fieldset>
			</div>
		</div>
	</div>
<!----------------------------------------------------------->
    <!--Injury-->
    <div class="sheet-section-injury">
		<div class="sheet-row">
			<div class="sheet-col-1 sheet-padr">
				<h4 class="sheet-center">Injuries & Setbacks</h4>
				<div class="sheet-row sheet-sub-header">
					<div class="sheet-col-1-6 sheet-center sheet-small-label">Type</div>
					<div class="sheet-col-5-6 sheet-center sheet-small-label">Description</div>
				</div>
				<fieldset class="repeating_injuries">
				    <div class="sheet-row">
                        <div class="sheet-col-1-6">
                            <input type="text" name="attr_injuryname">
                        </div>
                        <div class="sheet-col-5-6">
                            <div class="sheet-auto-expand">
                            	<span name="attr_injurydescr"></span>
                            	<textarea class="sheet-auto-expand" spellcheck="false" name="attr_injurydescr"></textarea>
                            </div>
                        </div>
                    </div>
                </fieldset>
			</div>
        </div>
    </div>
<!----------------------------------------------------------->
</div>
<!-- Roll Templates -->
<rolltemplate class="sheet-rolltemplate-5eDefault">
	<div class="sheet-rt-card">
		<div class="sheet-rt-header{{#weapon}} sheet-weapon{{/weapon}}{{#spell}} sheet-spell{{/spell}}{{#ability}} sheet-ability{{/ability}}{{#save}} sheet-save{{/save}}{{#feature}} sheet-feature{{/feature}}{{#ddm}} sheet-ddm{{/ddm}}">
			<div class="sheet-rt-title">{{title}}</div>
			{{#subheader}}
			<div class="sheet-rt-subheader">{{subheader}}{{#subheaderright}} &bullet; {{subheaderright}}{{/subheaderright}}</div>
			{{/subheader}}
			{{#featuresubheader}}
			    {{#rollGreater() featureusesmaxnum 0}}
			        <div class="sheet-rt-subheader">{{featuresubheader}} &bullet; {{featureuses}}/{{featureusesmax}} Uses</div>
			    {{/rollGreater() featureusesmaxnum 0}}
			    {{#^rollGreater() featureusesmaxnum 0}}
			        <div class="sheet-rt-subheader">{{featuresubheader}}</div>
			    {{/^rollGreater() featureusesmaxnum 0}}
			{{/featuresubheader}}
			{{#subheader2}}
			<div class="sheet-rt-subheader">{{subheader2}}{{#subheaderright2}} &bullet; {{subheaderright2}}{{/subheaderright2}}</div>
			{{/subheader2}}
		</div>
			{{#emote}}
			<p class="sheet-rt-emote">{{character_name}} {{emote}}</p>
			{{/emote}}
			<div class="sheet-main-content">
                {{#roll}}
				<div class="sheet-row">
					<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Result</div>
					<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{roll}}</div>
				</div>
				{{/roll}}
				{{#check}}
                    <div class="sheet-row">
                        <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Check</div>
                        <div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{check}}</div>
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Target</div>
                        <div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{target}}</div>
                    </div>
                    {{#rollGreater() check target}}
                        {{#rollGreater() check tfresult}}
                            <div class="sheet-row">
                                <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Result</div>
                                <div class="sheet-col-7-12 sheet-padr sheet-rt-value" style="color:red;">Terrible Failure!</div>
                            </div>
                        {{/rollGreater() check tfresult}}
                        {{#^rollGreater() check tfresult}}
                            {{#rollTotal() check 20}}
                                <div class="sheet-row">
                                    <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Result</div>
                                    <div class="sheet-col-7-12 sheet-padr sheet-rt-value" style="color:red;">Terrible Failure!</div>
                                </div>
                            {{/rollTotal() check 20}}
                            {{#^rollTotal() check 20}}
                                <div class="sheet-row">
                                    <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Result</div>
                                    <div class="sheet-col-7-12 sheet-padr sheet-rt-value" style="color:red;">Failure!</div>
                                </div>
                            {{/^rollTotal() check 20}}
                        {{/^rollGreater() check tfresult}}
                    {{/rollGreater() check target}}
                    {{#^rollGreater() check target}}
                        {{#rollLess() check gsresult}}
                            <div class="sheet-row">
                                <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Result</div>
                                <div class="sheet-col-7-12 sheet-padr sheet-rt-value" style="color:green;">Great Success!</div>
                            </div>
                        {{/rollLess() check gsresult}}
                        {{#^rollLess() check gsresult}}
                            {{#rollTotal() check gsresult}}
                                <div class="sheet-row">
                                    <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Result</div>
                                    <div class="sheet-col-7-12 sheet-padr sheet-rt-value" style="color:green;">Great Success!</div>
                                </div>
                            {{/rollTotal() check gsresult}}
                            {{#^rollTotal() check gsresult}}
                                <div class="sheet-row">
                                    <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Result</div>
                                    <div class="sheet-col-7-12 sheet-padr sheet-rt-value" style="color:green;">Success!</div>
                                </div>
                            {{/^rollTotal() check gsresult}}
                        {{/^rollLess() check gsresult}}
                    {{/^rollGreater() check target}}
				{{/check}}
                {{#save}}
                    <div class="sheet-row">
                        <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Save</div>
                        <div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{save}}</div>
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Target</div>
                        <div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{target}}</div>
                    </div>
                    {{#rollGreater() save target}}
                        <div class="sheet-row">
                            <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Result</div>
                            <div class="sheet-col-7-12 sheet-padr sheet-rt-value" style="color:red;">Failure!</div>
                        </div>
                    {{/rollGreater() save target}}
                    {{#^rollGreater() save target}}
                        <div class="sheet-row">
                            <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Result</div>
                            <div class="sheet-col-7-12 sheet-padr sheet-rt-value" style="color:green;">Success!</div>
                        </div>
                    {{/^rollGreater() save target}}
				{{/save}}
				<!--Weapon based attacks-->
				{{#attack}}
                    {{#rollWasFumble() attack}}
                        <div class="sheet-row">
                            <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Attack</div>
                            <div class="sheet-col-7-12 sheet-padr sheet-rt-value" style="color:red;">hits AC {{attack}}, Fumble!</div>
                        </div>
                    {{/rollWasFumble() attack}}
                    {{#^rollWasFumble() attack}}
                        {{#rollWasCrit() attack}}
                            <div class="sheet-row">
                                <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Attack</div>
                                <div class="sheet-col-7-12 sheet-padr sheet-rt-value" style="color:green;">hits AC {{attack}}, Critical!</div>
                            </div>
                            <div class="sheet-row">
                                <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Crit Damage</div>
                                <div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{critdamage}}</div>
                            </div>
                        {{/rollWasCrit() attack}}
                        {{#^rollWasCrit() attack}}
                            <div class="sheet-row">
                                <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Attack</div>
                                <div class="sheet-col-7-12 sheet-padr sheet-rt-value">hits AC {{attack}}</div>
                            </div>
                            <div class="sheet-row">
                                <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Damage</div>
                                <div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{damage}}</div>
                            </div>
                        {{/^rollWasCrit() attack}}
                    {{/^rollWasFumble() attack}}
				{{/attack}}
				{{#attackdescription}}
                <div class="sheet-row">
					<div class="sheet-col-1 sheet-padl sheet-padr sheet-rt-value">{{attackdescription}}</div>
				</div>
				{{/attackdescription}}
				{{#ddm}}
                <div class="sheet-row">
				    <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Threshold</div>
				    <div class="sheet-col-7-12 sheet-padl sheet-padr sheet-rt-value">{{ddmthreshold}}</div>
				</div>
				<div class="sheet-row">
                    {{#rollLess() ddmroll ddmthreshold}}
                        <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Result</div>
                        <div class="sheet-col-7-12 sheet-padl sheet-padr sheet-rt-value" style="color: red;">{{ddmroll}} Trigger!</div>
                    {{/rollLess() ddmroll ddmthreshold}}
                    {{#rollTotal() ddmroll ddmthreshold}}
                        <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Result</div>
                        <div class="sheet-col-7-12 sheet-padl sheet-padr sheet-rt-value" style="color: red;">{{ddmroll}} Trigger!</div>
                    {{/rollTotal() ddmroll ddmthreshold}}
                    {{#rollGreater() ddmroll ddmthreshold}}
                        <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Result</div>
                        <div class="sheet-col-7-12 sheet-padl sheet-padr sheet-rt-value">{{ddmroll}}</div>
                    {{/rollGreater() ddmroll ddmthreshold}}
                </div>
				{{/ddm}}
				<!--Spellcasting-->
				{{#spellshowinfoblock}}
				<div class="sheet-row sheet-padb">
					<div class="sheet-col-1-2 sheet-padl sheet-padr sheet-center"><span class="sheet-rt-key">Duration</span><br/><span class="sheet-rt-value">{{spellduration}}</span></div>
					<div class="sheet-col-1-2 sheet-padl sheet-padr sheet-center"><span class="sheet-rt-key">Range</span><br/><span class="sheet-rt-value">{{spellrange}}</span></div>
				</div>
				{{/spellshowinfoblock}}
				{{#spellshowattack}}
				<div class="sheet-row">
					<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Attack</div>
					<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{spellattack}} AC Hit</div>
				</div>
				{{/spellshowattack}}
				{{#spellshowsavethrow}}
				<div class="sheet-row">
					<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Save</div>
					<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{spellsavestat}}</div>
				</div>
				{{/spellshowsavethrow}}
				{{#spellshowhealing}}
				<div class="sheet-row">
					<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Healing</div>
					<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{spellhealing}} HP healed</div>
				</div>
				{{/spellshowhealing}}
				{{#spellshowdamage}}
				<div class="sheet-row">
					<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Damage</div>
					<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{spelldamage}}</div>
				</div>
				{{/spellshowdamage}}
				{{#spellshoweffects}}
				<div class="sheet-row">
					<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Effect</div>
					<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{spelleffect}}</div>
				</div>
				{{/spellshoweffects}}
				{{#spellshowsavethrow}}
				<div class="sheet-row">
					<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Save success</div>
					<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{spellsavesuccess}}</div>
				</div>
				{{/spellshowsavethrow}}
				{{#spellshowdesc}}
				<div class="sheet-row">
					<div class="sheet-col-1 sheet-padl sheet-padr sheet-rt-key">Spell Description</div>
					<div class="sheet-col-1 sheet-padl sheet-padr sheet-rt-value">{{spelldescription}}</div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1 sheet-padl sheet-padr sheet-rt-value sheet-center">{{ddmrequest}}</div>
				</div>
				{{/spellshowdesc}}
				{{#featureshowdesc}}
				<div class="sheet-row">
					<div class="sheet-col-1 sheet-padl sheet-padr sheet-rt-key">Description</div>
					<div class="sheet-col-1 sheet-padl sheet-padr sheet-rt-value">{{featureshowdesc}}</div>
				</div>
				{{/featureshowdesc}}
				<!--NPC-->
				<!--Generic section-->
				{{#freetext}}
					<div class="sheet-row">
						<div class="sheet-col-1 sheet-padl sheet-padr sheet-rt-key-wide">{{freetextname}}</div>
						<div class="sheet-col-1 sheet-padl sheet-padr sheet-rt-value">{{freetext}}</div>
					</div>
				{{/freetext}}
				<!--Outputall-->
				{{#outputall}}
					{{#allprops() outputall title subheader subheaderright subheader2 subheaderright2 emote weapon spell ability save feature ddm}}
						<div class="sheet-row">
							<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">{{key}}</div>
							<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{value}}</div>
						</div>
					{{/allprops() outputall title subheader subheaderright subheader2 subheaderright2 emote weapon spell ability save feature ddm}}
				{{/outputall}}
				{{#chatmenu}}
					{{#allprops() chatmenu title subheader subheaderright subheader2 subheaderright2 emote weapon spell ability save feature ddm}}
						<div class="sheet-row">
                            <div class="sheet-col-1 sheet-padl sheet-padr sheet-rt-key-wide">{{key}}</div>
    						<div class="sheet-col-1 sheet-padl sheet-padr sheet-rt-value">{{value}}</div>
						</div>
					{{/allprops() chatmenu title subheader subheaderright subheader2 subheaderright2 emote weapon spell ability save feature ddm}}
				{{/chatmenu}}
				<!--DEBUG-->
				{{#debug}}
					{{#allprops()}}
						<div class="sheet-row">
							<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">{{key}} (DEBUG)</div>
							<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{value}}</div>
						</div>
					{{/allprops()}}
				{{/debug}}
			</div>
		</div>
</rolltemplate>
<!-- Sheet workers -->
<script type="text/worker">

// Ability modifiers
['strength', 'dexterity', 'constitution', 'intelligence', 'perception', 'willpower', 'charisma', 'luck'].forEach(ability => {
  on(`sheet:opened change:${ability.toLowerCase()}`, () => {
    getAttrs([ability.toLowerCase()], v => {
      const value = parseInt(v[ability.toLowerCase()]) || 10,
		setting = {};
	  setting[`${ability}_gs`] = Math.floor(value/2);
	  setting[`${ability}_tf`] = Math.min(Math.floor(value*1.5) + 1, 20);
      if (value <= 4) setting[`${ability}_mod`] = -3;
      else if (value <= 6) setting[`${ability}_mod`] = -2;
      else if (value <= 8) setting[`${ability}_mod`] = -1;
      else if (value <= 12) setting[`${ability}_mod`] = 0;
      else if (value <= 14) setting[`${ability}_mod`] = 1;
      else if (value <= 16) setting[`${ability}_mod`] = 2;
      else if (value <= 18) setting[`${ability}_mod`] = 3;
      else if (value <= 20) setting[`${ability}_mod`] = 4;
      else if (value <= 22) setting[`${ability}_mod`] = 5;
      else if (value <= 24) setting[`${ability}_mod`] = 6;
      else if (value <= 26) setting[`${ability}_mod`] = 7;
      else if (value <= 28) setting[`${ability}_mod`] = 8;
      else if (value <= 30) setting[`${ability}_mod`] = 9;
      else setting[`${ability}_mod`] = 10;
      setAttrs(setting);
    });
  });
});

//Update associated attribute for luck save
on("change:luckvs", function() {
    getAttrs(["luckvs"], function(values) {
        switch (values.luckvs) {
            case "1":
                setAttrs({ lucksave_title: "Luck Check", lucksave_mod: "0" });
                break;
            case "2":
                getAttrs(["strength_mod"], function(values) {
                    setAttrs({ lucksave_title: "Luck(STR) Save", lucksave_mod: values.strength_mod });
                });
                break;
            case "3":
                getAttrs(["dexterity_mod"], function(values) {
                    setAttrs({ lucksave_title: "Luck(DEX) Save", lucksave_mod: values.dexterity_mod });
                });
                break;
            case "4":
                getAttrs(["constitution_mod"], function(values) {
                    setAttrs({ lucksave_title: "Luck(CON) Save", lucksave_mod: values.constitution_mod });
                });
                break;
            case "5":
                getAttrs(["intelligence_mod"], function(values) {
                    setAttrs({ lucksave_title: "Luck(INT) Save", lucksave_mod: values.intelligence_mod });
                });
                break;
            case "6":
                getAttrs(["perception_mod"], function(values) {
                    setAttrs({ lucksave_title: "Luck(PER) Save", lucksave_mod: values.perception_mod });
                });
                break;
            case "7":
                getAttrs(["willpower_mod"], function(values) {
                    setAttrs({ lucksave_title: "Luck(WILL) Save", lucksave_mod: values.willpower_mod });
                });
                break;
            case "8":
                getAttrs(["charisma_mod"], function(values) {
                    setAttrs({ lucksave_title: "Luck(CHA) Save", lucksave_mod: values.charisma_mod });
                });
                break;
            default:
                setAttrs({ lucksave_title: "Luck Check", lucksave_mod: "0" });
        }
    });
});

//Update associated attribute for skill
on("change:repeating_skills:skilltype", function() {
    getAttrs(["repeating_skills_skilltype"], function(values) {
        switch (values.repeating_skills_skilltype) {
            case "STR":
                getAttrs(["strength","strength_gs","strength_tf"], function(values) {
                    setAttrs({ repeating_skills_skilltarget: values.strength, repeating_skills_skillgs: values.strength_gs, repeating_skills_skilltf: values.strength_tf });
                });
                break;
            case "DEX":
                getAttrs(["dexterity","dexterity_gs","dexterity_tf"], function(values) {
                    setAttrs({ repeating_skills_skilltarget: values.dexterity, repeating_skills_skillgs: values.dexterity_gs, repeating_skills_skilltf: values.dexterity_tf });
                });
                break;
            case "CON":
                getAttrs(["constitution","constitution_gs","constitution_tf"], function(values) {
                    setAttrs({ repeating_skills_skilltarget: values.constitution, repeating_skills_skillgs: values.constitution_gs, repeating_skills_skilltf: values.constitution_tf });
                });
                break;
            case "INT":
                getAttrs(["intelligence","intelligence_gs","intelligence_tf"], function(values) {
                    setAttrs({ repeating_skills_skilltarget: values.intelligence, repeating_skills_skillgs: values.intelligence_gs, repeating_skills_skilltf: values.intelligence_tf });
                });
                break;
            case "PER":
                getAttrs(["perception","perception_gs","perception_tf"], function(values) {
                    setAttrs({ repeating_skills_skilltarget: values.perception, repeating_skills_skillgs: values.perception_gs, repeating_skills_skilltf: values.perception_tf });
                });
                break;
            case "WILL":
                getAttrs(["willpower","willpower_gs","willpower_tf"], function(values) {
                    setAttrs({ repeating_skills_skilltarget: values.willpower, repeating_skills_skillgs: values.willpower_gs, repeating_skills_skilltf: values.willpower_tf });
                });
                break;
            case "CHA":
                getAttrs(["charisma","charisma_gs","charisma_tf"], function(values) {
                    setAttrs({ repeating_skills_skilltarget: values.charisma, repeating_skills_skillgs: values.charisma_gs, repeating_skills_skilltf: values.charisma_tf });
                });
                break;
            case "LUCK":
                getAttrs(["luck","luck_gs","luck_tf"], function(values) {
                    setAttrs({ repeating_skills_skilltarget: values.luck, repeating_skills_skillgs: values.luck_gs, repeating_skills_skilltf: values.luck_tf });
                });
                break;
            default:
                getAttrs(["strength","strength_gs","strength_tf"], function(values) {
                    setAttrs({ repeating_skills_skilltarget: values.strength, repeating_skills_skillgs: values.strength_gs, repeating_skills_skilltf: values.strength_tf });
                });
        }
    });
});
//Update associated attribute for all skills when attribute is updated
on("change:strength change:strength_gs change:strength_tf change:dexterity change:dexterity_gs change:dexterity_tf change:constitution change:constitution_gs change:constitution_tf change:intelligence change:intelligence_gs change:intelligence_tf change:perception change:perception_gs change:perception_tf change:willpower change:willpower_gs change:willpower_tf change:charisma change:charisma_gs change:charisma_tf change:luck change:luck_gs change:luck_tf", function() {
	getSectionIDs('repeating_skills', function (idArray) {
		getAttrs(idArray.map(id => `repeating_skills_${id}_skilltype`), function (values) {
			idArray.forEach(function (id) {
                switch (values[`repeating_skills_${id}_skilltype`]) {
                    case "STR":
                        getAttrs(["strength","strength_gs","strength_tf"], function(strval) {
                            let setting = {};
                            setting[`repeating_skills_${id}_skilltarget`] = strval.strength;
                            setting[`repeating_skills_${id}_skillgs`] = strval.strength_gs;
                            setting[`repeating_skills_${id}_skilltf`] = strval.strength_tf;
                            setAttrs(setting);
                        });
                        break;
                    case "DEX":
                        getAttrs(["dexterity","dexterity_gs","dexterity_tf"], function(dexval) {
                            let setting = {};
                            setting[`repeating_skills_${id}_skilltarget`] = dexval.dexterity;
                            setting[`repeating_skills_${id}_skillgs`] = dexval.dexterity_gs;
                            setting[`repeating_skills_${id}_skilltf`] = dexval.dexterity_tf;
                            setAttrs(setting);
                        });
                        break;
                    case "CON":
                        getAttrs(["constitution","constitution_gs","constitution_tf"], function(conval) {
                            let setting = {};
                            setting[`repeating_skills_${id}_skilltarget`] = conval.constitution;
                            setting[`repeating_skills_${id}_skillgs`] = conval.constitution_gs;
                            setting[`repeating_skills_${id}_skilltf`] = conval.constitution_tf;
                            setAttrs(setting);
                        });
                        break;
                    case "INT":
                        getAttrs(["intelligence","intelligence_gs","intelligence_tf"], function(intval) {
                            let setting = {};
                            setting[`repeating_skills_${id}_skilltarget`] = intval.intelligence;
                            setting[`repeating_skills_${id}_skillgs`] = intval.intelligence_gs;
                            setting[`repeating_skills_${id}_skilltf`] = intval.intelligence_tf;
                            setAttrs(setting);
                        });
                        break;
                    case "PER":
                        getAttrs(["perception","perception_gs","perception_tf"], function(perval) {
                            let setting = {};
                            setting[`repeating_skills_${id}_skilltarget`] = perval.perception;
                            setting[`repeating_skills_${id}_skillgs`] = perval.perception_gs;
                            setting[`repeating_skills_${id}_skilltf`] = perval.perception_tf;
                            setAttrs(setting);
                        });
                        break;
                    case "WILL":
                        getAttrs(["willpower","willpower_gs","willpower_tf"], function(willval) {
                            let setting = {};
                            setting[`repeating_skills_${id}_skilltarget`] = willval.willpower;
                            setting[`repeating_skills_${id}_skillgs`] = willval.willpower_gs;
                            setting[`repeating_skills_${id}_skilltf`] = willval.willpower_tf;
                            setAttrs(setting);
                        });
                        break;
                    case "CHA":
                        getAttrs(["charisma","charisma_gs","charisma_tf"], function(chaval) {
                            let setting = {};
                            setting[`repeating_skills_${id}_skilltarget`] = chaval.charisma;
                            setting[`repeating_skills_${id}_skillgs`] = chaval.charisma_gs;
                            setting[`repeating_skills_${id}_skilltf`] = chaval.charisma_tf;
                            setAttrs(setting);
                        });
                        break;
                    case "LUCK":
                        getAttrs(["luck","luck_gs","luck_tf"], function(luckval) {
                            let setting = {};
                            setting[`repeating_skills_${id}_skilltarget`] = luckval.luck;
                            setting[`repeating_skills_${id}_skillgs`] = luckval.luck_gs;
                            setting[`repeating_skills_${id}_skilltf`] = luckval.luck_tf;
                            setAttrs(setting);
                        });
                        break;
                    default:
                }
			});
		});
	});
});
var convertFromOldSheet = function () {
    var notes1="";
    var notes2="";
    // Non-repeating attributes to rename
    let conversionData = {
        "size" : "race",
        "vision" : "background",
        "prolanguages" : "languages",
        "alignment" : "vision",
        "strength" : "strength_max",
        "dexterity" : "dexterity_max",
        "constitution" : "constitution_max",
        "intelligence" : "intelligence_max",
        "perception" : "perception_max",
        "willpower" : "willpower_max",
        "charisma" : "charisma_max",
        "luck" : "luck_max",
        "nil" : "armour_class",
        "initiative" : "rerolls"
    };
    // Non-repeating attribute renaming
    getAttrs(Object.keys(conversionData), function (values) {
        let setting = {};
        Object.keys(conversionData).forEach(function (oldAttr) {
            if (values[oldAttr] != null) {
                // set value of new attribute to the old one
                setting[conversionData[oldAttr]] = values[oldAttr];
            }
        });
        console.log("Setting non-repeating attributes.");
        setAttrs(setting);
    });

    //Special Case to bring over the two note fields into one notes field here.
    getAttrs(["notey","noob"], function(values) {
        if (values.notey != null) { notes1=values.notey; }
        if (values.noob != null) { notes2=values.notey; }
        setAttrs({lootnotes: (notes1 + "\n" + notes2)});
    });
    
	getSectionIDs('repeating_meleeattacks', function (idArray) {
	    console.log("Setting repeating_meleeattacks attributes.");
		getAttrs(idArray.map(id => `repeating_meleeattacks_${id}_meleeweaponname`), function (values) {
			let setting = {};
			idArray.forEach(function (id) {
				setting[`repeating_meleeattacks_${id}_melee_weaponname`] = values[`repeating_meleeattacks_${id}_meleeweaponname`];
			});
			setAttrs(setting);
		});
		getAttrs(idArray.map(id => `repeating_meleeattacks_${id}_meleemagic`), function (values) {
			let setting = {};
			idArray.forEach(function (id) {
				setting[`class_hitbonus`] = values[`repeating_meleeattacks_${id}_meleemagic`];
			});
			setAttrs(setting);
		});
		getAttrs(idArray.map(id => `repeating_meleeattacks_${id}_meleemisc`), function (values) {
			let setting = {};
			idArray.forEach(function (id) {
				setting[`repeating_meleeattacks_${id}_melee_hitbonus`] = values[`repeating_meleeattacks_${id}_meleemisc`];
				setting[`repeating_meleeattacks_${id}_melee_dmgbonus`] = values[`repeating_meleeattacks_${id}_meleemisc`];
			});
			setAttrs(setting);
		});
		getAttrs(idArray.map(id => `repeating_meleeattacks_${id}_meleedmg`), function (values) {
			let setting = {};
			idArray.forEach(function (id) {
				setting[`repeating_meleeattacks_${id}_melee_dmgbase`] = values[`repeating_meleeattacks_${id}_meleedmg`];
			});
			setAttrs(setting);
		});
		getAttrs(idArray.map(id => `repeating_meleeattacks_${id}_meleeacbonus`), function (values) {
			let setting = {};
			idArray.forEach(function (id) {
				setting[`repeating_meleeattacks_${id}_melee_description`] = values[`repeating_meleeattacks_${id}_meleeacbonus`];
			});
			setAttrs(setting);
		});
	});
	
	getSectionIDs('repeating_rangedattacks', function (idArray) {
	    console.log("Setting repeating_rangedattacks attributes.");
		getAttrs(idArray.map(id => `repeating_rangedattacks_${id}_rangeweaponname`), function (values) {
			let setting = {};
			idArray.forEach(function (id) {
				setting[`repeating_rangedattacks_${id}_range_weaponname`] = values[`repeating_rangedattacks_${id}_rangeweaponname`];
			});
			setAttrs(setting);
		});
		getAttrs(idArray.map(id => `repeating_rangedattacks_${id}_rangemisc`), function (values) {
			let setting = {};
			idArray.forEach(function (id) {
				setting[`repeating_rangedattacks_${id}_range_hitbonus`] = values[`repeating_rangedattacks_${id}_rangemisc`];
				setting[`repeating_rangedattacks_${id}_range_dmgbonus`] = values[`repeating_rangedattacks_${id}_rangemisc`];
			});
			setAttrs(setting);
		});
		getAttrs(idArray.map(id => `repeating_rangedattacks_${id}_rangedmg`), function (values) {
			let setting = {};
			idArray.forEach(function (id) {
				setting[`repeating_rangedattacks_${id}_range_dmgbase`] = values[`repeating_rangedattacks_${id}_rangedmg`];
			});
			setAttrs(setting);
		});
		getAttrs(idArray.map(id => `repeating_rangedattacks_${id}_rangeacbonus`), function (values) {
			let setting = {};
			idArray.forEach(function (id) {
				setting[`repeating_rangedattacks_${id}_range_distance`] = values[`repeating_rangedattacks_${id}_rangeacbonus`];
			});
			setAttrs(setting);
		});
		getAttrs(idArray.map(id => `repeating_rangedattacks_${id}_rangesaves`), function (values) {
			let setting = {};
			idArray.forEach(function (id) {
				setting[`repeating_rangedattacks_${id}_range_description`] = values[`repeating_rangedattacks_${id}_rangesaves`];
			});
			setAttrs(setting);
		});
	});
};
on('sheet:opened', function () {
    let currentVersion = '3.0';
    getAttrs(['version','lootnotes'], function (values) {
        if (!values.version) {
            //Special Case to check if the custom sheet was already in use prior to adding version control logic
            if (values.lootnotes) {
                console.log("Special Case Cancel Upgrade from V1.0");
            }
            else{
                //The old sheet had many variables whose names did not match sheet headings.
                //I do my best to assign them to appropriate variables in the upgraded sheet.
                console.log("Upgrading Sheet from V1.0");
                convertFromOldSheet();
            }
        }
        else{
            switch (values.version) {
                case 2.1:
                    // V3 won't require any conversion.
                    // Making compatible with Deluxe Edition of LFG.
                case 3.0:
                    //etc
            }
        }
        setAttrs({
            version: currentVersion
        });
    });
});
</script>




