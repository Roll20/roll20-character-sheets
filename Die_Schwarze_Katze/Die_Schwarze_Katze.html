<input class="nsc-charactersheet" type="checkbox" name="attr_toggle_nsc_charactersheet" />
<div class="container">
    <div class="tab-navi">
        <button class="player-character-sheet" type="action" name="act_charactertab" >Charakter</button>
        <button class="nsc-sheet-block" type="action" name="act_charactertab" >NSC</button>
        <button type="action" name="act_skillstab" >Fertigkeiten</button>
        <button type="action" name="act_ancestortab" >Ahnen</button>
        <button type="action" name="act_inventorytab" >Inventar</button>
        <button type="action" name="act_settingstab" >y</button>
    </div>
    <input type='hidden' class='sheet-tabstoggle' name='attr_sheetTab'  value='charactertab'  />
    <div class="charactertab">
        <div class="character-container">
            <div class="character-base-info-container">
                <div class="base-info-left">
                    <div class="character-base-info-1">
                        <h3 class="input-label-left">Name</h3>
                        <input class="base-info-character-name" type="text" name="attr_character_name" />
                        <h3 class="input-label-left">Geschlecht</h3>
                        <input class="base-info-character-geschlecht" type="text" name="attr_geschlecht" />
                        <h3 class="input-label-left player-character-sheet">Rasse</h3>
                        <input class="base-info-character-rasse player-character-sheet" type="text" name="attr_rasse" />
                        <h3 class="input-label-left player-character-sheet">Profession</h3>
                        <input class="base-info-character-profession player-character-sheet" type="text" name="attr_profession" />
                        <h3 class="input-label-left player-character-sheet">Kultur</h3>
                        <input class="base-info-character-kultur player-character-sheet" type="text" name="attr_kultur" />
                        <h3 class="input-label-left player-character-sheet">Rudel</h3>
                        <input class="base-info-character-rudel player-character-sheet" type="text" name="attr_rudel" />
                        <h3 class="input-label-left">Alter</h3>
                        <input class="base-info-character-alter" type="text" name="attr_alter" />
                        <h3 class="input-label-left nsc-sheet-block">Typus</h3>
                        <input class="base-info-character-typus nsc-sheet-block" type="text" name="attr_typus" />
                        <h3 class="input-label-left nsc-sheet-block">Größe</h3>
                        <input class="base-info-character-groesse nsc-sheet-block" type="text" name="attr_groesse" />
                        <h3 class="input-label-left nsc-sheet-block">Gewicht</h3>
                        <input class="base-info-character-gewicht nsc-sheet-block" type="text" name="attr_gewicht" />
                        <h3 class="input-label-left nsc-sheet-block">Länge</h3>
                        <input class="base-info-character-laenge nsc-sheet-block" type="text" name="attr_laenge" />
                    </div>
                    <div class="character-base-info-3">
                        <div>
                            <h3 class="input-label-top">Lebensenergie (LE)</h3>
                            <div class="base-info-3-content">
                                <input class="pictos toggle-lebensenergie-detail detail-toggle" name='act_toggle_lebensenergie_detail' type='checkbox'><label class="inline-label"></label>
                                <span class="player-character-sheet">2 x KO + Mod</span>
                                <input class="player-character-sheet" type="number" name="attr_lebensenergiemod" value="0" />
                                <span class="player-character-sheet">=</span>
                                <span class="nsc-sheet-inline">Maximal</span>
                                <input class="player-character-sheet" type="number" name="attr_lebensenergie_max" value="((@{konstitution}*2)+@{lebensenergiemod})" disabled />
                                <input class="nsc-sheet-inline-block" type="number" name="attr_lebensenergie_max" value="0" />
                                <span class="lebensenergie-aktuell-label">Aktuell </span>
                                <input class="aktuellelebensenergie" type="number" name="attr_lebensenergie" value="0" />
                                <div class="base-info-lebensenergie-detail detail-container">
                                    <label>Notizen</label>
                                    <textarea name="attr_lebensenergie_detail"></textarea>
                                </div>
                            </div>
                        </div>
                        <div>
                            <h3 class="input-label-top">Ahnenenergie (AE)</h3>
                            <div class="base-info-3-content">
                                <input class="pictos toggle-ahnenenergie-detail detail-toggle" name='act_toggle_ahnenenergie_detail' type='checkbox'><label class="inline-label"></label>
                                <span class="player-character-sheet">20 +</span>
                                <select class="base-info-leiteigenschaft player-character-sheet" name="attr_leiteigenschaft" title="Ahnentradition">
                                    <option selected value="" title="Keine">Keine</option>
                                    <option value="charisma" title="Charisma">Aphasma (CH)</option>
                                    <option value="klugheit" title="Klugheit">Nurti (KL)</option>
                                    <option value="mut" title="Mut">Rondra (MU)</option>
                                    <option value="intuition" title="Intuition">Zerzal (IN)</option>
                                </select>
                                <span class="player-character-sheet">+ Mod</span>
                                <input class="player-character-sheet" type="number" name="attr_ahnenenergiemod" value="0" />
                                <span class="player-character-sheet">=</span>
                                <input class="player-character-sheet" type="number" name="attr_ahnenenergie_max" readonly />
                                <input class="nsc-sheet-inline-block" type="number" name="attr_ahnenenergie_max" />
                                <div class="base-info-ahnenenergie-detail detail-container">
                                    <label>Notizen</label>
                                    <textarea name="attr_ahnenenergie_detail"></textarea>
                                </div>
                            </div>
                        </div>
                        <div>
                            <h3 class="input-label-top">Seelenkraft (SK)</h3>
                            <div class="base-info-3-content">
                                <input class="pictos toggle-seelenkraft-detail detail-toggle" name='act_toggle_seelenkraft_detail' type='checkbox'><label class="inline-label"></label>
                                <span class="player-character-sheet">(MU + KL + IN) / 3 - 10 + Mod</span>
                                <input class="player-character-sheet" type="number" name="attr_seelenkraftmod" value="0" />
                                <span class="player-character-sheet">=</span>
                                <input class="player-character-sheet" type="number" name="attr_seelenkraft" value="0" readonly />
                                <input class="nsc-sheet-inline-block" type="number" name="attr_seelenkraft" value="0" />
                                <div class="base-info-seelenkraft-detail detail-container">
                                    <label>Notizen</label>
                                    <textarea name="attr_seelenkraft_detail"></textarea>
                                </div>
                            </div>
                        </div>
                        <div>
                            <h3 class="input-label-top">Zähigkeit (ZK)</h3>
                            <div class="base-info-3-content">
                                <input class="pictos toggle-zaehigkeit-detail detail-toggle" name='act_toggle_zaehigkeit_detail' type='checkbox'><label class="inline-label"></label>
                                <span class="player-character-sheet">(KO + KO + KK) / 3 - 10 + Mod</span>
                                <input class="player-character-sheet" type="number" name="attr_zaehigkeitmod" value="0" />
                                <span class="player-character-sheet">=</span>
                                <input class="player-character-sheet" type="number" name="attr_zaehigkeit" value="0" readonly />
                                <input class="nsc-sheet-inline-block" type="number" name="attr_zaehigkeit" value="0" />
                                <div class="base-info-zaehigkeit-detail detail-container">
                                    <label>Notizen</label>
                                    <textarea name="attr_zaehigkeit_detail"></textarea>
                                </div>
                            </div>
                        </div>
                        <div>
                            <h3 class="input-label-top">Initiative <button type='roll' name='roll_initiative' value='&{template:initiative} {{result=[[1d6+[[@{initiative}]]+([[@{initiative}]]/100)[tie-breaker]&amp;{tracker}]]}}'></button></h3>
                            <div class="base-info-3-content">
                                <input class="pictos toggle-initiative-detail detail-toggle" name='act_toggle_initiative_detail' type='checkbox'><label class="inline-label"></label>
                                <span class="player-character-sheet">(MU + GE) / 2 + Mod</span>
                                <input class="player-character-sheet" type="number" name="attr_initiativemod" value="0" />
                                <span class="player-character-sheet">=</span>
                                <input class="player-character-sheet" type="number" name="attr_initiative" value="0" readonly />
                                <input class="nsc-sheet-inline-block" type="number" name="attr_initiative" value="0" />
                                <div class="base-info-initiative-detail detail-container">
                                    <label>Notizen</label>
                                    <textarea name="attr_initiative_detail"></textarea>
                                </div>
                            </div>
                        </div>
                        <div class="character-schicksalspunkte-geschwindigkeit-container">
                            <div class="inline-block character-schicksalspunkte">
                                <h3 class="input-label-top">Schicksalspunkte</h3>
                                <div class="base-info-3-content">
                                    <input type="number" name="attr_schicksalspunkte" value="3" />
                                </div>
                            </div>
                            <div class="inline-block character-geschwindigkeit">
                                <h3 class="input-label-top" title="Geschwindigkeit mit 2/4 Beinen">Geschwindigkeit</h3>
                                <div class="base-info-3-content">
                                    <input class="small-input" type="number" name="attr_geschwindigkeit2beine" value="6" title="Geschwindigkeit auf 2 Beinen" />
                                    <span>/</span>
                                    <input class="small-input" type="number" name="attr_geschwindigkeit4beine" value="12" title="Geschwindigkeit auf 4 Beinen" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="base-info-right">
                    <div class="character-base-info-2">
                        <h3 class="input-label-left" title="Rüstungsschutz">Rüstung (RS)</h3><input type="number" name="attr_ruestungsschutz" value="0" />
                        <h3 class="input-label-left player-character-sheet" title="Verfügbare Abenteuerpunkte">AP verfügbar</h3>
                        <input class="player-character-sheet" type="number" name="attr_apavailable" value="0" />
                        <h3 class="input-label-left" >Belastung (BE)</h3><input type="number" name="attr_belastung" value="0" />
                        <h3 class="input-label-left player-character-sheet" title="Abenteuerpunkte gesamt">AP gesamt</h3>
                        <input class="player-character-sheet" type="number" name="attr_aptotal" value="0" />
                        <div class="characterzustaende-container">
                            <input class="pictos toggle-characterzustaende-detail detail-toggle" name='act_toggle_characterzustaende_detail' type='checkbox'><label class="inline-label"></label>
                            <h3 class="character-zustaende-label">Zustände</h3>
                            <div class="characterzustaende-detail detail-container">
                                <fieldset class="repeating_characterzustaende">
                                    <input class="characterzustand" type="text" name="attr_characterzustand" />
                                    <input class="characterzustand" type="number" name="attr_characterzustand_stufe" value="0" />
                                </fieldset>
                            </div>
                        </div>
                        <div class="characterstatus-container">
                            <input class="pictos toggle-characterstatus-detail detail-toggle" name='act_toggle_characterstatus_detail' type='checkbox'><label class="inline-label"></label>
                            <h3 class="character-status-label">Status</h3>
                            <div class="characterstatus-detail detail-container">
                                <fieldset class="repeating_characterstatus">
                                    <input class="characterstatus" type="text" name="attr_characterstatus" />
                                </fieldset>
                            </div>
                        </div>
                    </div>
                    <div class="character-base-info-eigenschaften">
                        <h3 class="input-label-left">Mut (MU)</h3><input type="number" name="attr_mut" value="0" />
                        <h3 class="input-label-left">Charisma (CH)</h3><input type="number" name="attr_charisma" value="0" />
                        <h3 class="input-label-left">Klugheit (KL)</h3><input type="number" name="attr_klugheit" value="0" />
                        <h3 class="input-label-left">Intuition (IN)</h3><input type="number" name="attr_intuition" value="0" />
                        <h3 class="input-label-left">Gewandtheit (GE)</h3><input type="number" name="attr_gewandtheit" value="0" />
                        <h3 class="input-label-left">Fingerfertigkeit (FF)</h3><input type="number" name="attr_fingerfertigkeit" value="0" />
                        <h3 class="input-label-left">Körperkraft (KK)</h3><input type="number" name="attr_koerperkraft" value="0" />
                        <h3 class="input-label-left">Konstitution (KO)</h3><input type="number" name="attr_konstitution" value="0" />
                        <div class="character-eigenschaften-gesamt">
                            <h3 class="input-label-left">Gesamt vergebene Eigenschaftspunkte</h3>
                            <input type="number" name="attr_eigenschaftengesamt" value="(@{mut}+@{charisma}+@{klugheit}+@{intuition}+@{gewandtheit}+@{fingerfertigkeit}+@{koerperkraft}+@{konstitution})" disabled />
                        </div>
                        <div class="character-eigenschaften-probe">
                            <h3>Eigenschaftsprobe</h3>
                            <button type='roll' name='roll_eigenschaftsprobe'
                                    value='&{template:skillcheck} [[ ceil(([[?{1. Eigenschaft|MU, @{mut}[MU]|CH, @{charisma}[CH]|KL, @{klugheit}[KL]|IN, @{intuition}[IN]|GE, @{gewandtheit}[GE]|FF, @{fingerfertigkeit}[FF]|KK, @{koerperkraft}[KK]|KO, @{konstitution}[KO]}+?{2. Eigenschaft|MU,@{mut}[MU]|CH, @{charisma}[CH]|KL, @{klugheit}[KL]|IN, @{intuition}[IN]|GE, @{gewandtheit}[GE]|FF, @{fingerfertigkeit}[FF]|KK, @{koerperkraft}[KK]|KO, @{konstitution}[KO]}-5+(?{Modifikatoren (Reichweite, Zustände etc.)|0}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]] {{name=Eigenschaftsprobe}} {{probenwert=$[[0]]}} {{result=$[[1]]}} {{qs=$[[4]]}}{{Angreifer=@{character_name}}}'>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="nsc-additional-info-container">
                <label>NSC Zusatzinformationen</label>
                <textarea name="attr_nsc_zusatzinformationen"></textarea>
            </div>
            <div class="character-combat-container">
                <div class="melee-weapon-container">
                    <div class="melee-weapon-headers">
                        <h3>Nahkampfwaffe</h3>
                        <h3>Angriffstyp</h3>
                        <h3 title="Trefferpunkte">TP</h3>
                        <h3 title="Angriffswert Modifikator">AW Mod</h3>
                        <h3 title="Verteidigungswert Modifikator">VW Mod</h3>
                        <h3 title="Reichweite">RW</h3>
                        <h3 title="Angriffswert">AW</h3>
                        <h3 title="Verteidigungswert">VW</h3>
                        <h3 title="Angriffswurf">Angriff</h3>
                    </div>
                    <fieldset class="repeating_meleeweapon">
                        <input class="pictos detail-toggle" name='act_toggle_meleeweapon_detail' type='checkbox'><label class="inline-label"></label>
                        <input class="weapon-text" type="text" name="attr_meleeweapon">
                        <div>
                            <select class="weapon-type" name="attr_meleetype">
                                <option selected value="raufen">Raufen</option>
                                <option value="einhandwaffen">Einhandwaffe</option>
                                <option value="zweihandwaffen">Zweihandwaffe</option>
                                <option value="schilde">Schild</option>
                            </select>
                        </div>
                        <input class="weapon-short-text" type="text" name="attr_meleetp" value="1d6" />
                        <input class="player-character-sheet" type="number" name="attr_meleemodaw" value="0" />
                        <input class="nsc-sheet-block" type="number" name="attr_meleemodaw" value="0" readonly />
                        <input class="player-character-sheet" type="number" name="attr_meleemodvw" value="0" />
                        <input class="nsc-sheet-block" type="number" name="attr_meleemodvw" value="0" readonly />
                        <input class="weapon-short-text" type="text"  name="attr_meleerw" />
                        <input class="player-character-sheet" type="number" name="attr_meleeaw" value="0" readonly />
                        <input class="nsc-sheet-block" type="number" name="attr_meleeaw" value="0" />
                        <input class="player-character-sheet" type="number" name="attr_meleevw" value="0" readonly />
                        <input class="nsc-sheet-block" type="number" name="attr_meleevw" value="0" />
                        <div>
                            <button type='roll' name='roll_attackmelee'
                                    value='&{template:attack} [[[[[[ceil(([[@{meleeaw}[AW] - (@{belastung}[BE]) + (?{Probewert Modifikator (Zustände etc.)|0}[Modifikator]) - (?{Verteidigungswert des Ziels|0}[Ziel VW])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]][QS] + [[@{meleetp}]][TP] ]][Gesamtschaden] * 3[Kritisch] ]] {{weapon=@{meleeweapon}}} {{probenwert=$[[0]]}} {{qs=$[[4]]}} {{result=$[[1]]}} {{damageroll=$[[5]]}} {{totaldamage=$[[6]]}} {{totaldamagekritisch=$[[7]]}}{{Angreifer=@{character_name}}}'>
                            </button>
                        </div>
                        <div class="meleeweapon-detail detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_meleeweapon_detail"></textarea>
                        </div>
                    </fieldset>
                </div>
                <div class="ranged-weapon-container">
                    <div class="ranged-weapon-headers">
                        <h3>Fernkampfwaffe</h3>
                        <h3>Angriffstyp</h3>
                        <h3 title="Trefferpunkte">TP</h3>
                        <h3 title="Ladezeit (in Aktionen)">LZ</h3>
                        <h3 title="Reichweite">RW</h3>
                        <h3 title="Angriffswert">AW</h3>
                        <h3 title="Angriffswurf">Angriff</h3>
                    </div>
                    <fieldset class="repeating_rangedweapon">
                        <input class="pictos detail-toggle" name='act_toggle_rangedweapon_detail' type='checkbox'><label class="inline-label"></label>
                        <input class="weapon-text" type="text" name="attr_rangedweapon">
                        <select class="weapon-type" name="attr_rangedtype">
                            <option selected value="schusswaffen">Schusswaffe</option>
                            <option value="wurfwaffen">Wurfwaffe</option>
                        </select>
                        <input class="weapon-short-text" type="text" name="attr_rangedtp" value="1d6" />
                        <input type="number" name="attr_rangedmod" value="0" />
                        <input class="weapon-short-text" type="text" name="attr_rangedrw" value="Mittel" />
                        <input class="player-character-sheet" type="number" name="attr_rangedaw" value="0" readonly />
                        <input class="nsc-sheet-block" type="number" name="attr_rangedaw" value="0" />
                        <div>
                            <button type='roll' name='roll_attackranged'
                                    value='&{template:attack} [[[[[[ceil(([[@{rangedaw}[AW] - (@{belastung}[BE]) + (?{Probewert Modifikator (Zustände, Deckung, Bewegung etc.)|0}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]][QS] + [[@{rangedtp}]][TP] ]][Gesamtschaden] * 3[Kritisch] ]] {{weapon=@{rangedweapon}}} {{probenwert=$[[0]]}} {{qs=$[[4]]}} {{result=$[[1]]}} {{damageroll=$[[5]]}} {{totaldamage=$[[6]]}} {{totaldamagekritisch=$[[7]]}} {{Angreifer=@{character_name}}}'>
                            </button>
                        </div>
                        <div class="rangedweapon-detail detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_rangedweapon_detail"></textarea>
                        </div>
                    </fieldset>
                </div>
                <div class="ammunition-container">
                    <h3 class="input-label-left">Munition (Pfeile)</h3><input class="small-input ammunition-arrows-input" type="text" name="attr_ammunitionarrow" value="0">
                    <h3 class="input-label-left">Munition (Bolzen)</h3><input class="small-input" type="text" name="attr_ammunitionbolt" value="0">
                </div>
            </div>
            <div class="character-base-info-4">
                <div></div>
                <div class="character-vorteile">
                    <div class="character-vorteile-header">
                        <h3>Vorteile</h3>
                        <h3 title="AP Kosten">AP</h3>
                    </div>
                    <fieldset class="repeating_vorteile">
                        <input class="pictos toggle-vorteil-detail detail-toggle" name='act_toggle_vorteil_detail' type='checkbox'><label class="inline-label repeating-toggle-label"></label>
                        <input type="text" name="attr_vorteil">
                        <input type="number" name="attr_vorteil_ap" value="0" />
                        <div class="vorteil-detail detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_vorteil_detail"></textarea>
                        </div>
                    </fieldset>
                </div>
                <div class="character-nachteile">
                    <div class="character-vorteile-header">
                        <h3>Nachteile</h3>
                        <h3 title="AP Gutschrift">AP</h3>
                    </div>
                    <fieldset class="repeating_nachteile">
                        <input class="pictos toggle-nachteil-detail detail-toggle" name='act_toggle_nachteil_detail' type='checkbox'><label class="inline-label repeating-toggle-label"></label>
                        <input type="text" name="attr_nachteil">
                        <input type="number" name="attr_nachteil_ap" value="0" />
                        <div class="nachteil-detail detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_nachteil_detail"></textarea>
                        </div>
                    </fieldset>
                </div>
                <div class="character-sonderfertigkeiten">
                    <div class="character-sonderfertigkeiten-header">
                        <h3>Sonderfertigkeiten</h3>
                        <h3>Art</h3>
                        <h3 title="AP Kosten">AP</h3>
                    </div>
                    <fieldset class="repeating_sonderfertigkeiten">
                        <input class="pictos toggle-sonderfertigkeit-detail detail-toggle" name='act_toggle_sonderfertigkeit_detail' type='checkbox'><label class="inline-label repeating-toggle-label"></label>
                        <input type="text" name="attr_sonderfertigkeit">
                        <select class="base-info-sonderfertigkeit" name="attr_sonderfertigkeit_art" title="Art der Sonderfertigkeit">
                            <option selected value="allgemein">Allgemein</option>
                            <option value="kampf">Kampf</option>
                            <option value="ahnen">Ahnen</option>
                        </select>
                        <input type="number" name="attr_sonderfertigkeit_ap" value="0" />
                        <div class="sonderfertigkeit-detail detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_sonderfertigkeit_detail"></textarea>
                        </div>
                    </fieldset>
                </div>
            </div>
        </div>
    </div>
    <div class="skillstab">
        <div class="skills-container">
            <div class="skills-left">
                <div class="skills-koerper skill-list">
                    <div class="skill-list-row">
                        <h3>Körper</h3>
                        <h3 title="Belastung">BE</h3>
                        <h3 title="Steigerungsfaktor">STF</h3>
                        <h3 title="Fertigkeitswert">FW</h3>
                        <h3>Eigens.</h3>
                        <h3 title="Eigenschaftswert = (Eigenschaft 1 + Eigenschaft 2) / 2">EW</h3>
                        <h3 title="Probenwert = FW + EW + 5">PW</h3>
                        <h3 title="Fertigkeitsprobe">Probe</h3>
                    </div>
                    <div class="skill-list-row">
                        <input class="pictos detail-toggle" name='act_toggle_friemeln_detail' type='checkbox'><label class="inline-label"></label>
                        <label class="skill-name">Friemeln</label>
                        <label>ja</label>
                        <label>C</label>
                        <input class="fw" type="number" name="attr_skillfriemeln" value="0" />
                        <input class="fw" type="number" name="attr_skillfriemeln" value="0" readonly />
                        <div class="skill-eigenschaft">
                            <input type="text" value="FF" name="attr_skillfriemelnEw1" readonly />
                            <span>/</span>
                            <input type="text" value="GE" name="attr_skillfriemelnEw2" readonly />
                        </div>
                        <input class="skill-disabled-number" type="number" name="attr_skillfriemelnew" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillfriemelnpw" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillfriemelnpw" value="0" />
                        <button type='roll' name='roll_skillcheckfriemeln'
                                value='&{template:skillcheck} [[ ceil(([[@{skillfriemelnpw}[PW] - (@{belastung}[BE]) + (?{Probewert Modifikator (Zustände etc.)|0}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]] {{name=Friemeln}} {{probenwert=$[[0]]}} {{result=$[[1]]}} {{qs=$[[4]]}}{{Angreifer=@{character_name}}}'> </button>
                        <div class="detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_friemeln_detail"></textarea>
                        </div>
                    </div>

                    <div class="skill-list-row">
                        <input class="pictos detail-toggle" name='act_toggle_koerperbeherrschung_detail' type='checkbox'><label class="inline-label"></label>
                        <label class="skill-name">Körperbeherrschung</label>
                        <label>ja</label>
                        <label>E</label>
                        <input class="fw" type="number" name="attr_skillkoerperbeherrschung" value="0" />
                        <input class="fw" type="number" name="attr_skillkoerperbeherrschung" value="0" readonly />
                        <div class="skill-eigenschaft">
                            <input type="text" value="GE" name="attr_skillkoerperbeherrschungEw1" readonly />
                            <span>/</span>
                            <input type="text" value="KO" name="attr_skillkoerperbeherrschungEw2" readonly />
                        </div>
                        <input class="skill-disabled-number" type="number" name="attr_skillkoerperbeherrschungew" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillkoerperbeherrschungpw" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillkoerperbeherrschungpw" value="0" />
                        <button type='roll' name='roll_skillcheckkoerperbeherrschung'
                                value='&{template:skillcheck} [[ ceil(([[@{skillkoerperbeherrschungpw}[PW] - (@{belastung}[BE]) + (?{Probewert Modifikator (Zustände etc.)|0}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]] {{name=Körperbeherrschung}} {{probenwert=$[[0]]}} {{result=$[[1]]}} {{qs=$[[4]]}}{{Angreifer=@{character_name}}}'>
                        </button>
                        <div class="detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_koerperbeherrschung_detail"></textarea>
                        </div>
                    </div>

                    <div class="skill-list-row">
                        <input class="pictos detail-toggle" name='act_toggle_kraftakt_detail' type='checkbox'><label class="inline-label"></label>
                        <label class="skill-name">Kraftakt</label>
                        <label>ja</label>
                        <label>B</label>
                        <input class="fw" type="number" name="attr_skillkraftakt" value="0" />
                        <input class="fw" type="number" name="attr_skillkraftakt" value="0" readonly />
                        <div class="skill-eigenschaft">
                            <input type="text" value="KO" name="attr_skillkraftaktEw1" readonly />
                            <span>/</span>
                            <input type="text" value="KK" name="attr_skillkraftaktEw2" readonly />
                        </div>
                        <input class="skill-disabled-number" type="number" name="attr_skillkraftaktew" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillkraftaktpw" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillkraftaktpw" value="0" />
                        <button type='roll' name='roll_skillcheckkraftakt'
                                value='&{template:skillcheck} [[ ceil(([[@{skillkraftaktpw}[PW] - (@{belastung}[BE]) + (?{Probewert Modifikator (Zustände etc.)|0}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]] {{name=Kraftakt}} {{probenwert=$[[0]]}} {{result=$[[1]]}} {{qs=$[[4]]}}{{Angreifer=@{character_name}}}'>
                        </button>
                        <div class="detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_kraftakt_detail"></textarea>
                        </div>
                    </div>

                    <div class="skill-list-row">
                        <input class="pictos detail-toggle" name='act_toggle_selbstbeherrschung_detail' type='checkbox'><label class="inline-label"></label>
                        <label class="skill-name">Selbstbeherrschung</label>
                        <label>nein</label>
                        <label>D</label>
                        <input class="fw" type="number" name="attr_skillselbstbeherrschung" value="0" />
                        <input class="fw" type="number" name="attr_skillselbstbeherrschung" value="0" readonly />
                        <div class="skill-eigenschaft">
                            <input type="text" value="MU" name="attr_skillselbstbeherrschungEw1" readonly />
                            <span>/</span>
                            <input type="text" value="KO" name="attr_skillselbstbeherrschungEw2" readonly />
                        </div>
                        <input class="skill-disabled-number" type="number" name="attr_skillselbstbeherrschungew" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillselbstbeherrschungpw" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillselbstbeherrschungpw" value="0" />
                        <button type='roll' name='roll_skillcheckselbstbeherrschung'
                                value='&{template:skillcheck} [[ ceil(([[@{skillselbstbeherrschungpw}[PW] + (?{Probewert Modifikator (Zustände etc.)|0}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]] {{name=Selbstbeherrschung}} {{probenwert=$[[0]]}} {{result=$[[1]]}} {{qs=$[[4]]}}{{Angreifer=@{character_name}}}'>
                        </button>
                        <div class="detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_selbstbeherrschung_detail"></textarea>
                        </div>
                    </div>

                    <div class="skill-list-row">
                        <input class="pictos detail-toggle" name='act_toggle_verbergen_detail' type='checkbox'><label class="inline-label"></label>
                        <label class="skill-name">Verbergen</label>
                        <label>ja</label>
                        <label>C</label>
                        <input class="fw" type="number" name="attr_skillverbergen" value="0" />
                        <input class="fw" type="number" name="attr_skillverbergen" value="0" readonly />
                        <div class="skill-eigenschaft">
                            <input type="text" value="KL" name="attr_skillverbergenEw1" readonly />
                            <span>/</span>
                            <input type="text" value="GE" name="attr_skillverbergenEw2" readonly />
                        </div>
                        <input class="skill-disabled-number" type="number" name="attr_skillverbergenew" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillverbergenpw" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillverbergenpw" value="0" />
                        <button type='roll' name='roll_skillcheckverbergen'
                                value='&{template:skillcheck} [[ ceil(([[@{skillverbergenpw}[PW] - (@{belastung}[BE]) + (?{Probewert Modifikator (Zustände etc.)|0}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]] {{name=Verbergen}} {{probenwert=$[[0]]}} {{result=$[[1]]}} {{qs=$[[4]]}}{{Angreifer=@{character_name}}}'>
                        </button>
                        <div class="detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_verbergen_detail"></textarea>
                        </div>
                    </div>

                </div>
                <div class="skills-gesellschaft skill-list">
                    <div class="skill-list-row">
                        <h3>Gesellschaft</h3>
                        <h3 title="Belastung">BE</h3>
                        <h3 title="Steigerungsfaktor">STF</h3>
                        <h3 title="Fertigkeitswert">FW</h3>
                        <h3>Eigens.</h3>
                        <h3 title="Eigenschaftswert = (Eigenschaft 1 + Eigenschaft 2) / 2">EW</h3>
                        <h3 title="Probenwert = FW + EW + 5">PW</h3>
                        <h3 title="Fertigkeitsprobe">Probe</h3>
                    </div>

                    <div class="skill-list-row">
                        <input class="pictos detail-toggle" name='act_toggle_betteln_detail' type='checkbox'><label class="inline-label"></label>
                        <label class="skill-name">Betteln</label>
                        <label>nein</label>
                        <label>A</label>
                        <input class="fw" type="number" name="attr_skillbetteln" value="0" />
                        <input class="fw" type="number" name="attr_skillbetteln" value="0" readonly />
                        <div class="skill-eigenschaft">
                            <input type="text" value="CH" name="attr_skillbettelnEw1" readonly />
                            <span>/</span>
                            <input type="text" value="GE" name="attr_skillbettelnEw2" readonly />
                        </div>
                        <input class="skill-disabled-number" type="number" name="attr_skillbettelnew" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillbettelnpw" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillbettelnpw" value="0" />
                        <button type='roll' name='roll_skillcheckbetteln'
                                value='&{template:skillcheck} [[ ceil(([[@{skillbettelnpw}[PW] + (?{Probewert Modifikator (Zustände etc.)|0}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]] {{name=Gesellschaftsfertigkeiten}} {{probenwert=$[[0]]}} {{result=$[[1]]}} {{qs=$[[4]]}}{{Angreifer=@{character_name}}}'>
                        </button>
                        <div class="detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_betteln_detail"></textarea>
                        </div>
                    </div>

                    <div class="skill-list-row">
                        <input class="pictos detail-toggle" name='act_toggle_durchschauen_detail' type='checkbox'><label class="inline-label"></label>
                        <label class="skill-name">Durchschauen</label>
                        <label>nein</label>
                        <label>C</label>
                        <input class="fw" type="number" name="attr_skilldurchschauen" value="0" />
                        <input class="fw" type="number" name="attr_skilldurchschauen" value="0" readonly />
                        <div class="skill-eigenschaft">
                            <input type="text" value="KL" name="attr_skilldurchschauenEw1" readonly />
                            <span>/</span>
                            <input type="text" value="IN" name="attr_skilldurchschauenEw2" readonly />
                        </div>
                        <input class="skill-disabled-number" type="number" name="attr_skilldurchschauenew" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skilldurchschauenpw" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skilldurchschauenpw" value="0" />
                        <button type='roll' name='roll_skillcheckdurchschauen'
                                value='&{template:skillcheck} [[ ceil(([[@{skilldurchschauenpw}[PW] + (?{Probewert Modifikator (Zustände etc.)|0}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]] {{name=Durchschauen}} {{probenwert=$[[0]]}} {{result=$[[1]]}} {{qs=$[[4]]}}{{Angreifer=@{character_name}}}'>
                        </button>
                        <div class="detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_durchschauen_detail"></textarea>
                        </div>
                    </div>

                    <div class="skill-list-row">
                        <input class="pictos detail-toggle" name='act_toggle_einschuechtern_detail' type='checkbox'><label class="inline-label"></label>
                        <label class="skill-name">Einschüchtern</label>
                        <label>nein</label>
                        <label>B</label>
                        <input class="fw" type="number" name="attr_skilleinschuechtern" value="0" />
                        <input class="fw" type="number" name="attr_skilleinschuechtern" value="0" readonly />
                        <div class="skill-eigenschaft">
                            <input type="text" value="MU" name="attr_skilleinschuechternEw1" readonly />
                            <span>/</span>
                            <input type="text" value="CH" name="attr_skilleinschuechternEw2" readonly />
                        </div>
                        <input class="skill-disabled-number" type="number" name="attr_skilleinschuechternew" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skilleinschuechternpw" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skilleinschuechternpw" value="0" />
                        <button type='roll' name='roll_skillcheckeinschuechtern'
                                value='&{template:skillcheck} [[ ceil(([[@{skilleinschuechternpw}[PW] + (?{Probewert Modifikator (Zustände etc.)|0}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]] {{name=Einschüchtern}} {{probenwert=$[[0]]}} {{result=$[[1]]}} {{qs=$[[4]]}}{{Angreifer=@{character_name}}}'>
                        </button>
                        <div class="detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_einschuechtern_detail"></textarea>
                        </div>
                    </div>

                    <div class="skill-list-row">
                        <input class="pictos detail-toggle" name='act_toggle_umschmeicheln_detail' type='checkbox'><label class="inline-label"></label>
                        <label class="skill-name">Umschmeicheln</label>
                        <label>evtl.</label>
                        <label>D</label>
                        <input class="fw" type="number" name="attr_skillumschmeicheln" value="0" />
                        <input class="fw" type="number" name="attr_skillumschmeicheln" value="0" readonly />
                        <div class="skill-eigenschaft">
                            <input type="text" value="IN" name="attr_skillumschmeichelnEw1" readonly />
                            <span>/</span>
                            <input type="text" value="CH" name="attr_skillumschmeichelnEw2" readonly />
                        </div>
                        <input class="skill-disabled-number" type="number" name="attr_skillumschmeichelnew" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillumschmeichelnpw" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillumschmeichelnpw" value="0" />
                        <button type='roll' name='roll_skillcheckumschmeicheln'
                                value='&{template:skillcheck} [[ ceil(([[@{skillumschmeichelnpw}[PW] + (?{Probewert Modifikator (Belastung, Zustände etc.)|-@{belastung}}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]] {{name=Umschmeicheln}} {{probenwert=$[[0]]}} {{result=$[[1]]}} {{qs=$[[4]]}}{{Angreifer=@{character_name}}}'>
                        </button>
                        <div class="detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_umschmeicheln_detail"></textarea>
                        </div>
                    </div>

                    <div class="skill-list-row">
                        <input class="pictos detail-toggle" name='act_toggle_willenskraft_detail' type='checkbox'><label class="inline-label"></label>
                        <label class="skill-name">Willenskraft</label>
                        <label>nein</label>
                        <label>D</label>
                        <input class="fw" type="number" name="attr_skillwillenskraft" value="0" />
                        <input class="fw" type="number" name="attr_skillwillenskraft" value="0" readonly />
                        <div class="skill-eigenschaft">
                            <input type="text" value="MU" name="attr_skillwillenskraftEw1" readonly />
                            <span>/</span>
                            <input type="text" value="KO" name="attr_skillwillenskraftEw2" readonly />
                        </div>
                        <input class="skill-disabled-number" type="number" name="attr_skillwillenskraftew" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillwillenskraftpw" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillwillenskraftpw" value="0" />
                        <button type='roll' name='roll_skillcheckwillenskraft'
                                value='&{template:skillcheck} [[ ceil(([[@{skillwillenskraftpw}[PW] + (?{Probewert Modifikator (Zustände etc.)|0}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]] {{name=Willenskraft}} {{probenwert=$[[0]]}} {{result=$[[1]]}} {{qs=$[[4]]}}{{Angreifer=@{character_name}}}'>
                        </button>
                        <div class="detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_willenskraft_detail"></textarea>
                        </div>
                    </div>
                </div>
                <div class="skills-handwerk skill-list">
                    <div class="skill-list-row">
                        <h3>Handwerk</h3>
                        <h3 title="Belastung">BE</h3>
                        <h3 title="Steigerungsfaktor">STF</h3>
                        <h3 title="Fertigkeitswert">FW</h3>
                        <h3>Eigens.</h3>
                        <h3 title="Eigenschaftswert = (Eigenschaft 1 + Eigenschaft 2) / 2">EW</h3>
                        <h3 title="Probenwert = FW + EW + 5">PW</h3>
                        <h3 title="Fertigkeitsprobe">Probe</h3>
                    </div>

                    <div class="skill-list-row">
                        <input class="pictos detail-toggle" name='act_toggle_basteln_detail' type='checkbox'><label class="inline-label"></label>
                        <label class="skill-name">Basteln</label>
                        <label>ja</label>
                        <label>D</label>
                        <input class="fw" type="number" name="attr_skillbasteln" value="0" />
                        <input class="fw" type="number" name="attr_skillbasteln" value="0" readonly />
                        <div class="skill-eigenschaft">
                            <input type="text" value="FF" name="attr_skillbastelnEw1" readonly />
                            <span>/</span>
                            <input type="text" value="GE" name="attr_skillbastelnEw2" readonly />
                        </div>
                        <input class="skill-disabled-number" type="number" name="attr_skillbastelnew" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillbastelnpw" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillbastelnpw" value="0" />
                        <button type='roll' name='roll_skillcheckbasteln'
                                value='&{template:skillcheck} [[ ceil(([[@{skillbastelnpw}[PW] - (@{belastung}[BE]) + (?{Probewert Modifikator (Zustände etc.)|0}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]] {{name=Basteln}} {{probenwert=$[[0]]}} {{result=$[[1]]}} {{qs=$[[4]]}}{{Angreifer=@{character_name}}} '>
                        </button>
                        <div class="detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_basteln_detail"></textarea>
                        </div>
                    </div>

                    <div class="skill-list-row">
                        <input class="pictos detail-toggle" name='act_toggle_heilkunde_detail' type='checkbox'><label class="inline-label"></label>
                        <label class="skill-name">Heilkunde</label>
                        <label>ja</label>
                        <label>D</label>
                        <input class="fw" type="number" name="attr_skillheilkunde" value="0" />
                        <input class="fw" type="number" name="attr_skillheilkunde" value="0" readonly />
                        <div class="skill-eigenschaft">
                            <input type="text" value="KL" name="attr_skillheilkundeEw1" readonly />
                            <span>/</span>
                            <input type="text" value="FF" name="attr_skillheilkundeEw2" readonly />
                        </div>
                        <input class="skill-disabled-number" type="number" name="attr_skillheilkundeew" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillheilkundepw" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillheilkundepw" value="0" />
                        <button type='roll' name='roll_skillcheckheilkunde'
                                value='&{template:skillcheck} [[ ceil(([[@{skillheilkundepw}[PW] - (@{belastung}[BE]) + (?{Probewert Modifikator (Zustände etc.)|0}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]] {{name=Heilkunde}} {{probenwert=$[[0]]}} {{result=$[[1]]}} {{qs=$[[4]]}}{{Angreifer=@{character_name}}} '>
                        </button>
                        <div class="detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_heilkunde_detail"></textarea>
                        </div>
                    </div>

                    <div class="skill-list-row">
                        <input class="pictos detail-toggle" name='act_toggle_kochen_detail' type='checkbox'><label class="inline-label"></label>
                        <label class="skill-name">Kochen</label>
                        <label>ja</label>
                        <label>A</label>
                        <input class="fw" type="number" name="attr_skillkochen" value="0" />
                        <input class="fw" type="number" name="attr_skillkochen" value="0" readonly />
                        <div class="skill-eigenschaft">
                            <input type="text" value="IN" name="attr_skillkochenEw1" readonly />
                            <span>/</span>
                            <input type="text" value="FF" name="attr_skillkochenEw2" readonly />
                        </div>
                        <input class="skill-disabled-number" type="number" name="attr_skillkochenew" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillkochenpw" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillkochenpw" value="0" />
                        <button type='roll' name='roll_skillcheckkochen'
                                value='&{template:skillcheck} [[ ceil(([[@{skillkochenpw}[PW] - (@{belastung}[BE]) + (?{Probewert Modifikator (Zustände etc.)|0}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]] {{name=Kochen}} {{probenwert=$[[0]]}} {{result=$[[1]]}} {{qs=$[[4]]}}{{Angreifer=@{character_name}}} '>
                        </button>
                        <div class="detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_kochen_detail"></textarea>
                        </div>
                    </div>

                    <div class="skill-list-row">
                        <input class="pictos detail-toggle" name='act_toggle_musizieren_detail' type='checkbox'><label class="inline-label"></label>
                        <label class="skill-name">Musizieren</label>
                        <label>ja</label>
                        <label>A</label>
                        <input class="fw" type="number" name="attr_skillmusizieren" value="0" />
                        <input class="fw" type="number" name="attr_skillmusizieren" value="0" readonly />
                        <div class="skill-eigenschaft">
                            <input type="text" value="CH" name="attr_skillmusizierenEw1" readonly />
                            <span>/</span>
                            <input type="text" value="FF" name="attr_skillmusizierenEw2" readonly />
                        </div>
                        <input class="skill-disabled-number" type="number" name="attr_skillmusizierenew" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillmusizierenpw" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillmusizierenpw" value="0" />
                        <button type='roll' name='roll_skillcheckmusizieren'
                                value='&{template:skillcheck} [[ ceil(([[@{skillmusizierenpw}[PW] - (@{belastung}[BE]) + (?{Probewert Modifikator (Zustände etc.)|0}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]] {{name=Musizieren}} {{probenwert=$[[0]]}} {{result=$[[1]]}} {{qs=$[[4]]}}{{Angreifer=@{character_name}}} '>
                        </button>
                        <div class="detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_musizieren_detail"></textarea>
                        </div>
                    </div>

                    <div class="skill-list-row">
                        <input class="pictos detail-toggle" name='act_toggle_ueberleben_detail' type='checkbox'><label class="inline-label"></label>
                        <label class="skill-name">Überleben</label>
                        <label>ja</label>
                        <label>C</label>
                        <input class="fw" type="number" name="attr_skillueberleben" value="0" />
                        <input class="fw" type="number" name="attr_skillueberleben" value="0" readonly />
                        <div class="skill-eigenschaft">
                            <input type="text" value="MU" name="attr_skillueberlebenEw1" readonly />
                            <span>/</span>
                            <input type="text" value="GE" name="attr_skillueberlebenEw2" readonly />
                        </div>
                        <input class="skill-disabled-number" type="number" name="attr_skillueberlebenew" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillueberlebenpw" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillueberlebenpw" value="0" />
                        <button type='roll' name='roll_skillcheckueberleben'
                                value='&{template:skillcheck} [[ ceil(([[@{skillueberlebenpw}[PW] - (@{belastung}[BE]) + (?{Probewert Modifikator (Zustände etc.)|0}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]] {{name=Überleben}} {{probenwert=$[[0]]}} {{result=$[[1]]}} {{qs=$[[4]]}}{{Angreifer=@{character_name}}} '>
                        </button>
                        <div class="detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_ueberleben_detail"></textarea>
                        </div>
                    </div>
                </div>
            </div>
            <div class="skills-right">
                <div class="skills-geist skill-list">
                    <div class="skill-list-row">
                        <h3>Geist</h3>
                        <h3 title="Belastung">BE</h3>
                        <h3 title="Steigerungsfaktor">STF</h3>
                        <h3 title="Fertigkeitswert">FW</h3>
                        <h3>Eigens.</h3>
                        <h3 title="Eigenschaftswert = (Eigenschaft 1 + Eigenschaft 2) / 2">EW</h3>
                        <h3 title="Probenwert = FW + EW + 5">PW</h3>
                        <h3 title="Fertigkeitsprobe">Probe</h3>
                    </div>

                    <div class="skill-list-row">
                        <input class="pictos detail-toggle" name='act_toggle_gassenkunde_detail' type='checkbox'><label class="inline-label"></label>
                        <label class="skill-name">Gassenkunde</label>
                        <label>nein</label>
                        <label>C</label>
                        <input class="fw" type="number" name="attr_skillgassenkunde" value="0" />
                        <input class="fw" type="number" name="attr_skillgassenkunde" value="0" readonly />
                        <div class="skill-eigenschaft">
                            <input type="text" value="KL" name="attr_skillgassenkundeEw1" readonly />
                            <span>/</span>
                            <input type="text" value="CH" name="attr_skillgassenkundeEw2" readonly />
                        </div>
                        <input class="skill-disabled-number" type="number" name="attr_skillgassenkundeew" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillgassenkundepw" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillgassenkundepw" value="0" />
                        <button type='roll' name='roll_skillcheckgassenkunde'
                                value='&{template:skillcheck} [[ ceil(([[@{skillgassenkundepw}[PW] + (?{Probewert Modifikator (Zustände etc.)|0}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]] {{name=Gassenkunde}} {{probenwert=$[[0]]}} {{result=$[[1]]}} {{qs=$[[4]]}}{{Angreifer=@{character_name}}} '>
                        </button>
                        <div class="detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_gassenkunde_detail"></textarea>
                        </div>
                    </div>

                    <div class="skill-list-row">
                        <input class="pictos detail-toggle" name='act_toggle_geisterkunde_detail' type='checkbox'><label class="inline-label"></label>
                        <label class="skill-name">Geisterkunde</label>
                        <label>nein</label>
                        <label>B</label>
                        <input class="fw" type="number" name="attr_skillgeisterkunde" value="0" />
                        <input class="fw" type="number" name="attr_skillgeisterkunde" value="0" readonly />
                        <div class="skill-eigenschaft">
                            <input type="text" value="MU" name="attr_skillgeisterkundeEw1" readonly />
                            <span>/</span>
                            <input type="text" value="KL" name="attr_skillgeisterkundeEw2" readonly />
                        </div>
                        <input class="skill-disabled-number" type="number" name="attr_skillgeisterkundeew" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillgeisterkundepw" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillgeisterkundepw" value="0" />
                        <button type='roll' name='roll_skillcheckgeisterkunde'
                                value='&{template:skillcheck} [[ ceil(([[@{skillgeisterkundepw}[PW] + (?{Probewert Modifikator (Zustände etc.)|0}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]] {{name=Geisterkunde}} {{probenwert=$[[0]]}} {{result=$[[1]]}} {{qs=$[[4]]}}{{Angreifer=@{character_name}}} '>
                        </button>
                        <div class="detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_geisterkunde_detail"></textarea>
                        </div>
                    </div>

                    <div class="skill-list-row">
                        <input class="pictos detail-toggle" name='act_toggle_geographie_detail' type='checkbox'><label class="inline-label"></label>
                        <label class="skill-name">Geographie</label>
                        <label>nein</label>
                        <label>A</label>
                        <input class="fw" type="number" name="attr_skillgeographie" value="0" />
                        <input class="fw" type="number" name="attr_skillgeographie" value="0" readonly />
                        <div class="skill-eigenschaft">
                            <input type="text" value="KL" name="attr_skillgeographieEw1" readonly />
                            <span>/</span>
                            <input type="text" value="IN" name="attr_skillgeographieEw2" readonly />
                        </div>
                        <input class="skill-disabled-number" type="number" name="attr_skillgeographieew" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillgeographiepw" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillgeographiepw" value="0" />
                        <button type='roll' name='roll_skillcheckgeographie'
                                value='&{template:skillcheck} [[ ceil(([[@{skillgeographiepw}[PW] + (?{Probewert Modifikator (Zustände etc.)|0}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]] {{name=Geographie}} {{probenwert=$[[0]]}} {{result=$[[1]]}} {{qs=$[[4]]}}{{Angreifer=@{character_name}}} '>
                        </button>
                        <div class="detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_geographie_detail"></textarea>
                        </div>
                    </div>

                    <div class="skill-list-row">
                        <input class="pictos detail-toggle" name='act_toggle_geschichten_detail' type='checkbox'><label class="inline-label"></label>
                        <label class="skill-name">Geschichten</label>
                        <label>nein</label>
                        <label>C</label>
                        <input class="fw" type="number" name="attr_skillgeschichten" value="0" />
                        <input class="fw" type="number" name="attr_skillgeschichten" value="0" readonly />
                        <div class="skill-eigenschaft">
                            <input type="text" value="KL" name="attr_skillgeschichtenEw1" readonly />
                            <span>/</span>
                            <input type="text" value="IN" name="attr_skillgeschichtenEw2" readonly />
                        </div>
                        <input class="skill-disabled-number" type="number" name="attr_skillgeschichtenew" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillgeschichtenpw" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillgeschichtenpw" value="0" />
                        <button type='roll' name='roll_skillcheckgeschichten'
                                value='&{template:skillcheck} [[ ceil(([[@{skillgeschichtenpw}[PW] + (?{Probewert Modifikator (Zustände etc.)|0}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]] {{name=Geschichten}} {{probenwert=$[[0]]}} {{result=$[[1]]}} {{qs=$[[4]]}}{{Angreifer=@{character_name}}} '>
                        </button>
                        <div class="detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_geschichten_detail"></textarea>
                        </div>
                    </div>

                    <div class="skill-list-row">
                        <input class="pictos detail-toggle" name='act_toggle_menschenkunde_detail' type='checkbox'><label class="inline-label"></label>
                        <label class="skill-name">Menschenkunde</label>
                        <label>nein</label>
                        <label>B</label>
                        <input class="fw" type="number" name="attr_skillmenschenkunde" value="0" />
                        <input class="fw" type="number" name="attr_skillmenschenkunde" value="0" readonly />
                        <div class="skill-eigenschaft">
                            <input type="text" value="KL" name="attr_skillmenschenkundeEw1" readonly />
                            <span>/</span>
                            <input type="text" value="IN" name="attr_skillmenschenkundeEw2" readonly />
                        </div>
                        <input class="skill-disabled-number" type="number" name="attr_skillmenschenkundeew" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillmenschenkundepw" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillmenschenkundepw" value="0" />
                        <button type='roll' name='roll_skillcheckmenschenkunde'
                                value='&{template:skillcheck} [[ ceil(([[@{skillmenschenkundepw}[PW] + (?{Probewert Modifikator (Zustände etc.)|0}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]] {{name=Menschenkunde}} {{probenwert=$[[0]]}} {{result=$[[1]]}} {{qs=$[[4]]}}{{Angreifer=@{character_name}}} '>
                        </button>
                        <div class="detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_menschenkunde_detail"></textarea>
                        </div>
                    </div>

                    <div class="skill-list-row">
                        <input class="pictos detail-toggle" name='act_toggle_orientierung_detail' type='checkbox'><label class="inline-label"></label>
                        <label class="skill-name">Orientierung</label>
                        <label>nein</label>
                        <label>B</label>
                        <input class="fw" type="number" name="attr_skillorientierung" value="0" />
                        <input class="fw" type="number" name="attr_skillorientierung" value="0" readonly />
                        <div class="skill-eigenschaft">
                            <input type="text" value="KL" name="attr_skillorientierungEw1" readonly />
                            <span>/</span>
                            <input type="text" value="IN" name="attr_skillorientierungEw2" readonly />
                        </div>
                        <input class="skill-disabled-number" type="number" name="attr_skillorientierungew" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillorientierungpw" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillorientierungpw" value="0" />
                        <button type='roll' name='roll_skillcheckorientierung'
                                value='&{template:skillcheck} [[ ceil(([[@{skillorientierungpw}[PW] + (?{Probewert Modifikator (Zustände etc.)|0}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]] {{name=Orientierung}} {{probenwert=$[[0]]}} {{result=$[[1]]}} {{qs=$[[4]]}}{{Angreifer=@{character_name}}} '>
                        </button>
                        <div class="detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_orientierung_detail"></textarea>
                        </div>
                    </div>

                    <div class="skill-list-row">
                        <input class="pictos detail-toggle" name='act_toggle_pflanzenkunde_detail' type='checkbox'><label class="inline-label"></label>
                        <label class="skill-name">Pflanzenkunde</label>
                        <label>evtl.</label>
                        <label>B</label>
                        <input class="fw" type="number" name="attr_skillpflanzenkunde" value="0" />
                        <input class="fw" type="number" name="attr_skillpflanzenkunde" value="0" readonly />
                        <div class="skill-eigenschaft">
                            <input type="text" value="KL" name="attr_skillpflanzenkundeEw1" readonly />
                            <span>/</span>
                            <input type="text" value="FF" name="attr_skillpflanzenkundeEw2" readonly />
                        </div>
                        <input class="skill-disabled-number" type="number" name="attr_skillpflanzenkundeew" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillpflanzenkundepw" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillpflanzenkundepw" value="0" />
                        <button type='roll' name='roll_skillcheckpflanzenkunde'
                                value='&{template:skillcheck} [[ ceil(([[@{skillpflanzenkundepw}[PW] + (?{Probewert Modifikator (Belastung, Zustände etc.)|-@{belastung}}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]] {{name=Pflanzenkunde}} {{probenwert=$[[0]]}} {{result=$[[1]]}} {{qs=$[[4]]}}{{Angreifer=@{character_name}}} '>
                        </button>
                        <div class="detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_pflanzenkunde_detail"></textarea>
                        </div>
                    </div>

                    <div class="skill-list-row">
                        <input class="pictos detail-toggle" name='act_toggle_sinnesschaerfe_detail' type='checkbox'><label class="inline-label"></label>
                        <label class="skill-name">Sinnesschärfe</label>
                        <label>evtl.</label>
                        <label>D</label>
                        <input class="fw" type="number" name="attr_skillsinnesschaerfe" value="0" />
                        <input class="fw" type="number" name="attr_skillsinnesschaerfe" value="0" readonly />
                        <div class="skill-eigenschaft">
                            <input type="text" value="KL" name="attr_skillsinnesschaerfeEw1" readonly />
                            <span>/</span>
                            <input type="text" value="IN" name="attr_skillsinnesschaerfeEw2" readonly />
                        </div>
                        <input class="skill-disabled-number" type="number" name="attr_skillsinnesschaerfeew" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillsinnesschaerfepw" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillsinnesschaerfepw" value="0" />
                        <button type='roll' name='roll_skillchecksinnesschaerfe'
                                value='&{template:skillcheck} [[ ceil(([[@{skillsinnesschaerfepw}[PW] + (?{Probewert Modifikator (Belastung, Zustände etc.)|-@{belastung}}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]] {{name=Sinnesschärfe}} {{probenwert=$[[0]]}} {{result=$[[1]]}} {{qs=$[[4]]}}{{Angreifer=@{character_name}}} '>
                        </button>
                        <div class="detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_sinnesschaerfe_detail"></textarea>
                        </div>
                    </div>

                    <div class="skill-list-row">
                        <input class="pictos detail-toggle" name='act_toggle_tierkunde_detail' type='checkbox'><label class="inline-label"></label>
                        <label class="skill-name">Tierkunde</label>
                        <label>evtl.</label>
                        <label>B</label>
                        <input class="fw" type="number" name="attr_skilltierkunde" value="0" />
                        <input class="fw" type="number" name="attr_skilltierkunde" value="0" readonly />
                        <div class="skill-eigenschaft">
                            <input type="text" value="MU" name="attr_skilltierkundeEw1" readonly />
                            <span>/</span>
                            <input type="text" value="CH" name="attr_skilltierkundeEw2" readonly />
                        </div>
                        <input class="skill-disabled-number" type="number" name="attr_skilltierkundeew" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skilltierkundepw" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skilltierkundepw" value="0" />
                        <button type='roll' name='roll_skillchecktierkunde'
                                value='&{template:skillcheck} [[ ceil(([[@{skilltierkundepw}[PW] + (?{Probewert Modifikator (Belastung, Zustände etc.)|-@{belastung}}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]] {{name=Tierkunde}} {{probenwert=$[[0]]}} {{result=$[[1]]}} {{qs=$[[4]]}}{{Angreifer=@{character_name}}} '>
                        </button>
                        <div class="detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_tierkunde_detail"></textarea>
                        </div>
                    </div>

                    <div class="skill-list-row">
                        <input class="pictos detail-toggle" name='act_toggle_zahlenkunde_detail' type='checkbox'><label class="inline-label"></label>
                        <label class="skill-name">Zahlenkunde</label>
                        <label>nein</label>
                        <label>A</label>
                        <input class="fw" type="number" name="attr_skillzahlenkunde" value="0" />
                        <input class="fw" type="number" name="attr_skillzahlenkunde" value="0" readonly />
                        <div class="skill-eigenschaft">
                            <input type="text" value="KL" name="attr_skillzahlenkundeEw1" readonly />
                            <span>/</span>
                            <input type="text" value="IN" name="attr_skillzahlenkundeEw2" readonly />
                        </div>
                        <input class="skill-disabled-number" type="number" name="attr_skillzahlenkundeew" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillzahlenkundepw" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillzahlenkundepw" value="0" />
                        <button type='roll' name='roll_skillcheckzahlenkunde'
                                value='&{template:skillcheck} [[ ceil(([[@{skillzahlenkundepw}[PW] + (?{Probewert Modifikator (Zustände etc.)|0}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]] {{name=Zahlenkunde}} {{probenwert=$[[0]]}} {{result=$[[1]]}} {{qs=$[[4]]}}{{Angreifer=@{character_name}}} '>
                        </button>
                        <div class="detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_zahlenkunde_detail"></textarea>
                        </div>
                    </div>

                    <div class="skill-list-row">
                        <input class="pictos detail-toggle" name='act_toggle_wissender_detail' type='checkbox'><label class="inline-label"></label>
                        <div class="skill-name skill-wissender">
                            <label class="inline-label">Wissender (</label><input type="text" value="" name="attr_skillwissenderText" /><label class="inline-label">)</label>
                        </div>
                        <label>nein</label>
                        <label>A</label>
                        <input class="fw" type="number" name="attr_skillwissender" value="0" />
                        <input class="fw" type="number" name="attr_skillwissender" value="0" readonly />
                        <div class="skill-eigenschaft">
                            <input type="text" value="KL" name="attr_skillwissenderEw1" readonly />
                            <span>/</span>
                            <input type="text" value="IN" name="attr_skillwissenderEw2" readonly />
                        </div>
                        <input class="skill-disabled-number" type="number" name="attr_skillwissenderew" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillwissenderpw" value="0" readonly />
                        <input class="skill-disabled-number pw" type="number" name="attr_skillwissenderpw" value="0" />
                        <div>
                            <input class="wissendertoggle" type="checkbox" name="attr_vorteilwissender" readonly>
                            <button class="wissenderdisabled" type='roll' disabled></button>
                            <button class="wissenderenabled" type='roll' name='roll_skillcheckwissender'
                                    value='&{template:skillcheck} [[ ceil(([[@{skillwissenderpw}[PW] + (?{Probewert Modifikator (Zustände etc.)|0}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]] {{name=Wissender (@{skillwissenderText})}} {{probenwert=$[[0]]}} {{result=$[[1]]}} {{qs=$[[4]]}}{{Angreifer=@{character_name}}} '>
                            </button>
                        </div>

                        <div class="skill-wissender-detail detail-container">
                            <div class="skill-wissender-detail-header">
                                <label>Notizen</label>
                                <label>Vorteil: Wissender</label>
                                <input type="checkbox" name="attr_vorteilwissender">
                            </div>
                            <textarea name="attr_wissender_detail"></textarea>
                        </div>
                    </div>
                </div>
                <div class="skills-kampf skill-list">
                    <div class="skill-list-row">
                        <h3>Kampf</h3>
                        <h3 title="Belastung">BE</h3>
                        <h3 title="Steigerungsfaktor">STF</h3>
                        <h3 title="Fertigkeitswert">FW</h3>
                        <h3>Eigens.</h3>
                        <h3 title="Eigenschaftswert = (Eigenschaft 1 + Eigenschaft 2) / 2">EW</h3>
                        <h3 title="Angriffswert = FW + EW + 5">AW</h3>
                        <h3 title="Verteidigungswert = AW / 4">VW</h3>
                        <h3 title="Fertigkeitsprobe">Probe</h3>
                    </div>

                    <div class="skill-list-row">
                        <input class="pictos detail-toggle" name='act_toggle_einhandwaffen_detail' type='checkbox'><label class="inline-label"></label>
                        <label class="skill-name">Einhandwaffen</label>
                        <label>ja</label>
                        <label>E</label>
                        <input class="fw" type="number" name="attr_skilleinhandwaffen" value="0" />
                        <input class="fw" type="number" name="attr_skilleinhandwaffen" value="0" readonly />
                        <div class="skill-eigenschaft">
                            <input type="text" value="GE" name="attr_skilleinhandwaffenEw1" readonly />
                            <span>/</span>
                            <input type="text" value="KK" name="attr_skilleinhandwaffenEw2" readonly />
                        </div>
                        <input class="skill-disabled-number" type="number" name="attr_skilleinhandwaffenew" value="0" readonly />
                        <input class="skill-disabled-number aw" type="number" name="attr_skilleinhandwaffenaw" value="0" readonly />
                        <input class="skill-disabled-number aw" type="number" name="attr_skilleinhandwaffenaw" value="0" />
                        <input class="skill-disabled-number vw" type="number" name="attr_skilleinhandwaffenvw" value="0" readonly />
                        <input class="skill-disabled-number vw" type="number" name="attr_skilleinhandwaffenvw" value="0" />
                        <button type='roll' name='roll_skillcheckeinhandwaffen'
                                value='&{template:skillcheck} [[ ceil(([[@{skilleinhandwaffenpw}[PW] - (@{belastung}[BE]) + (?{Probewert Modifikator (Zustände etc.)|0}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]] {{name=Einhandwaffen}} {{probenwert=$[[0]]}} {{result=$[[1]]}} {{qs=$[[4]]}}{{Angreifer=@{character_name}}} '>
                        </button>
                        <div class="detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_einhandwaffen_detail"></textarea>
                        </div>
                    </div>

                    <div class="skill-list-row">
                        <input class="pictos detail-toggle" name='act_toggle_raufen_detail' type='checkbox'><label class="inline-label"></label>
                        <label class="skill-name">Raufen</label>
                        <label>ja</label>
                        <label>C</label>
                        <input class="fw" type="number" name="attr_skillraufen" value="0" />
                        <input class="fw" type="number" name="attr_skillraufen" value="0" readonly />
                        <div class="skill-eigenschaft">
                            <input type="text" value="GE" name="attr_skillraufenEw1" readonly />
                            <span>/</span>
                            <input type="text" value="KK" name="attr_skillraufenEw2" readonly />
                        </div>
                        <input class="skill-disabled-number" type="number" name="attr_skillraufenew" value="0" readonly />
                        <input class="skill-disabled-number aw" type="number" name="attr_skillraufenaw" value="0" readonly />
                        <input class="skill-disabled-number aw" type="number" name="attr_skillraufenaw" value="0" />
                        <input class="skill-disabled-number vw" type="number" name="attr_skillraufenvw" value="0" readonly />
                        <input class="skill-disabled-number vw" type="number" name="attr_skillraufenvw" value="0" />
                        <button type='roll' name='roll_skillcheckraufen'
                                value='&{template:skillcheck} [[ ceil(([[@{skillraufenpw}[PW] - (@{belastung}[BE]) + (?{Probewert Modifikator (Zustände etc.)|0}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]] {{name=Raufen}} {{probenwert=$[[0]]}} {{result=$[[1]]}} {{qs=$[[4]]}}{{Angreifer=@{character_name}}} '>
                        </button>
                        <div class="detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_raufen_detail"></textarea>
                        </div>
                    </div>

                    <div class="skill-list-row">
                        <input class="pictos detail-toggle" name='act_toggle_schilde_detail' type='checkbox'><label class="inline-label"></label>
                        <label class="skill-name">Schilde</label>
                        <label>ja</label>
                        <label>C</label>
                        <input class="fw" type="number" name="attr_skillschilde" value="0" />
                        <input class="fw" type="number" name="attr_skillschilde" value="0" readonly />
                        <div class="skill-eigenschaft">
                            <input type="text" value="GE" name="attr_skillschildeEw1" readonly />
                            <span>/</span>
                            <input type="text" value="KK" name="attr_skillschildeEw2" readonly />
                        </div>
                        <input class="skill-disabled-number" type="number" name="attr_skillschildeew" value="0" readonly />
                        <input class="skill-disabled-number aw" type="number" name="attr_skillschildeaw" value="0" readonly />
                        <input class="skill-disabled-number aw" type="number" name="attr_skillschildeaw" value="0" />
                        <input class="skill-disabled-number vw" type="number" name="attr_skillschildevw" value="0" readonly />
                        <input class="skill-disabled-number vw" type="number" name="attr_skillschildevw" value="0" />
                        <button type='roll' name='roll_skillcheckschilde'
                                value='&{template:skillcheck} [[ ceil(([[@{skillschildepw}[PW] - (@{belastung}[BE]) + (?{Probewert Modifikator (Zustände etc.)|0}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]] {{name=Schilde}} {{probenwert=$[[0]]}} {{result=$[[1]]}} {{qs=$[[4]]}}{{Angreifer=@{character_name}}} '>
                        </button>
                        <div class="detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_schilde_detail"></textarea>
                        </div>
                    </div>

                    <div class="skill-list-row">
                        <input class="pictos detail-toggle" name='act_toggle_schusswaffen_detail' type='checkbox'><label class="inline-label"></label>
                        <label class="skill-name">Schusswaffen</label>
                        <label>ja</label>
                        <label>D</label>
                        <input class="fw" type="number" name="attr_skillschusswaffen" value="0" />
                        <input class="fw" type="number" name="attr_skillschusswaffen" value="0" readonly />
                        <div class="skill-eigenschaft">
                            <input type="text" value="IN" name="attr_skillschusswaffenEw1" readonly />
                            <span>/</span>
                            <input type="text" value="FF" name="attr_skillschusswaffenEw2" readonly />
                        </div>
                        <input class="skill-disabled-number" type="number" name="attr_skillschusswaffenew" value="0" readonly />
                        <input class="skill-disabled-number aw" type="number" name="attr_skillschusswaffenaw" value="0" readonly />
                        <input class="skill-disabled-number aw" type="number" name="attr_skillschusswaffenaw" value="0" />
                        <div></div>
                        <button type='roll' name='roll_skillcheckschusswaffen'
                                value='&{template:skillcheck} [[ ceil(([[@{skillschusswaffenpw}[PW] - (@{belastung}[BE]) + (?{Probewert Modifikator (Zustände etc.)|0}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]] {{name=Schusswaffen}} {{probenwert=$[[0]]}} {{result=$[[1]]}} {{qs=$[[4]]}} {{Angreifer=@{character_name}}} '>
                        </button>
                        <div class="detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_schusswaffen_detail"></textarea>
                        </div>
                    </div>

                    <div class="skill-list-row">
                        <input class="pictos detail-toggle" name='act_toggle_wurfwaffen_detail' type='checkbox'><label class="inline-label"></label>
                        <label class="skill-name">Wurfwaffen</label>
                        <label>ja</label>
                        <label>B</label>
                        <input class="fw" type="number" name="attr_skillwurfwaffen" value="0" />
                        <input class="fw" type="number" name="attr_skillwurfwaffen" value="0" readonly />
                        <div class="skill-eigenschaft">
                            <input type="text" value="IN" name="attr_skillwurfwaffenEw1" readonly />
                            <span>/</span>
                            <input type="text" value="FF" name="attr_skillwurfwaffenEw2" readonly />
                        </div>
                        <input class="skill-disabled-number" type="number" name="attr_skillwurfwaffenew" value="0" readonly />
                        <input class="skill-disabled-number aw" type="number" name="attr_skillwurfwaffenaw" value="0" readonly />
                        <input class="skill-disabled-number aw" type="number" name="attr_skillwurfwaffenaw" value="0" />
                        <div></div>
                        <button type='roll' name='roll_skillcheckwurfwaffen'
                                value='&{template:skillcheck} [[ ceil(([[@{skillwurfwaffenpw}[PW] - (@{belastung}[BE]) + (?{Probewert Modifikator (Zustände etc.)|0}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]] {{name=Wurfwaffen}} {{probenwert=$[[0]]}} {{result=$[[1]]}} {{qs=$[[4]]}}{{Angreifer=@{character_name}}} '>
                        </button>
                        <div class="detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_wurfwaffen_detail"></textarea>
                        </div>
                    </div>

                    <div class="skill-list-row">
                        <input class="pictos detail-toggle" name='act_toggle_zweihandwaffen_detail' type='checkbox'><label class="inline-label"></label>
                        <label class="skill-name">Zweihandwaffen</label>
                        <label>ja</label>
                        <label>E</label>
                        <input class="fw" type="number" name="attr_skillzweihandwaffen" value="0" />
                        <input class="fw" type="number" name="attr_skillzweihandwaffen" value="0" readonly />
                        <div class="skill-eigenschaft">
                            <input type="text" value="GE" name="attr_skillzweihandwaffenEw1" readonly />
                            <span>/</span>
                            <input type="text" value="KK" name="attr_skillzweihandwaffenEw2" readonly />
                        </div>
                        <input class="skill-disabled-number" type="number" name="attr_skillzweihandwaffenew" value="0" readonly />
                        <input class="skill-disabled-number aw" type="number" name="attr_skillzweihandwaffenaw" value="0" readonly />
                        <input class="skill-disabled-number aw" type="number" name="attr_skillzweihandwaffenaw" value="0" />
                        <input class="skill-disabled-number vw" type="number" name="attr_skillzweihandwaffenvw" value="0" readonly />
                        <input class="skill-disabled-number vw" type="number" name="attr_skillzweihandwaffenvw" value="0" />
                        <button type='roll' name='roll_skillcheckzweihandwaffen'
                                value='&{template:skillcheck} [[ ceil(([[@{skillzweihandwaffenpw}[PW] - (@{belastung}[BE]) + (?{Probewert Modifikator (Zustände etc.)|0}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]] {{name=Zweihandwaffen}} {{probenwert=$[[0]]}} {{result=$[[1]]}} {{qs=$[[4]]}}{{Angreifer=@{character_name}}} '>
                        </button>
                        <div class="detail-container">
                            <label>Notizen</label>
                            <textarea name="attr_zweihandwaffen_detail"></textarea>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="ancestortab">
        <div class="ancestor-container">
            <div class="ancestor-status">
                <h3 class="input-label-left">Aktuelle Ahnenenergie</h3>
                <input class="aktuelleahnenenergie" type="number" name="attr_ahnenenergie" value="0" />
                <h3 class="input-label-left">Maximale Ahnenenergie</h3>
                <input type="number" name="attr_ahnenenergie_max" readonly />
            </div>
            <div class="ancestor-ahnengeschenke">
                <div class="ancestor-ahnengeschenke-headers">
                    <h3>Ahnengeschenk</h3>
                    <h3>Reichweite</h3>
                    <h3>Wirkungsdauer</h3>
                </div>
                <fieldset class="repeating_ahnengeschenke">
                    <input class="pictos detail-toggle" name='act_toggle_ahnengeschenk_detail' type='checkbox'><label class="inline-label"></label>
                    <input class="ancestor-ahnengeschenk-name" type="text" name="attr_ahnengeschenk">
                    <input class="ancestor-ahnengeschenk-rw" type="text" name="attr_ahnengeschenkreichweite">
                    <input class="ancestor-ahnengeschenk-dauer" type="text" name="attr_ahnengeschenkwirkungsdauer">
                    <div class="detail-container">
                        <label>Notizen</label>
                        <textarea name="attr_ahnengeschenk_detail"></textarea>
                    </div>
                </fieldset>
            </div>
            <div></div>
            <div class="ancestor-ahnengaben">
                <div class="ancestor-ahnengaben-headers">
                    <h3>Ahnengabe</h3>
                    <h3 title="Ahnenenergie Punkte Kosten">AeP</h3>
                    <h3 title="Steigerungsfaktor">STF</h3>
                    <h3 title="Fertigkeitswert">FW</h3>
                    <h3 >Eigenschaften</h3>
                    <h3 title="Eigenschaftswert = (Eigenschaft 1 + Eigenschaft 2) / 2">EW</h3>
                    <h3 title="Probenwert = FW + EW + 5">PW</h3>
                    <h3 title="Fertigkeitsprobe">Probe</h3>
                </div>
                <fieldset class="repeating_ahnengaben">
                    <input class="pictos detail-toggle" name='act_toggle_ahnengabe_detail' type='checkbox'><label class="inline-label"></label>
                    <input class="ancestor-ahnengabe-name" type="text" name="attr_ahnengabename">
                    <input type="number" name="attr_ahnengabeaep" value="0">
                    <select class="ancestor-ahnengaben-stf" name="attr_ahnengabestf">
                        <option selected value="a">A</option>
                        <option value="b">B</option>
                        <option value="c">C</option>
                        <option value="d">D</option>
                        <option value="e">E</option>
                    </select>
                    <input class="player-character-sheet" type="number" name="attr_ahnengabefw" value="0">
                    <input class="nsc-sheet-block" type="number" name="attr_ahnengabefw" value="0" readonly>
                    <div class="ancestor-ahnengaben-eigenschaften">
                        <select class="ancestor-ahnengaben-eigenschaft" name="attr_ahnengabeEw1">
                            <option value="mu">MU</option>
                            <option value="ch">CH</option>
                            <option value="kl">KL</option>
                            <option value="in">IN</option>
                            <option value="ge">GE</option>
                            <option value="ff">FF</option>
                            <option value="kk">KK</option>
                            <option value="ko">KO</option>
                        </select>
                        <span>/</span>
                        <select class="ancestor-ahnengaben-eigenschaft" name="attr_ahnengabeEw2">
                            <option value="mu">MU</option>
                            <option value="ch">CH</option>
                            <option value="kl">KL</option>
                            <option value="in">IN</option>
                            <option value="ge">GE</option>
                            <option value="ff">FF</option>
                            <option value="kk">KK</option>
                            <option value="ko">KO</option>
                        </select>
                    </div>
                    <input type="number" name="attr_ahnengabeew" readonly>
                    <input class="player-character-sheet"  type="number" name="attr_ahnengabepw" readonly>
                    <input class="nsc-sheet-block" type="number" name="attr_ahnengabepw" >
                    <button type='roll' name='roll_ahnengabe'
                            value='&{template:ahnengabe} [[ ceil(([[@{ahnengabepw}[PW] + (?{Probewert Modifikator (Belastung, Zustände etc.)|0}[Modifikator])]] - [[2d20cs1cf20]] + [[1]]) / [[5]]) ]] {{name=@{ahnengabename}}} {{wirkung=@{ahnengabe_wirkung}}} {{probenwert=$[[0]]}} {{result=$[[1]]}} {{qs=$[[4]]}}{{Angreifer=@{character_name}}} '>
                    </button>
                    <div class="detail-container">
                        <input class="ahnengabe-notes-toggle" name='attr_toggle_ahnengabe_notes' type='checkbox'>
                        <label class="ahnengabe-notes-label">Notizen</label>
                        <label class="ahnengabe-wirkung-label" title="Wird mit der Würfelprobe angezeigt">Wirkung</label>
                        <textarea class="detail-notes" name="attr_ahnengabe_notes"></textarea>
                        <textarea class="detail-wirkung" name="attr_ahnengabe_wirkung"></textarea>
                    </div>
                </fieldset>
            </div>
        </div>
    </div>
    <div class="inventorytab">
        <div class="inventory-container">
            <div class="inventory-ausruestung">
                <div class="inventory-ausruestung-header">
                    <h3>Ausrüstung</h3>
                    <h3>Menge</h3>
                    <h3 title="Gewicht in Zehntstein">Gewicht</h3>
                </div>
                <fieldset class="repeating_ausruestung">
                    <input class="pictos toggle-ausruestung-detail detail-toggle" name='act_toggle_ausruestung_detail' type='checkbox'><label class="inline-label repeating-toggle-label"></label>
                    <input type="text" name="attr_ausruestung">
                    <input class="small-input" type="number" name="attr_ausruestung_menge" value="1">
                    <input class="small-input" type="number" step="0.01" name="attr_ausruestung_gewicht" value="0">
                    <div class="ausruestung-detail detail-container">
                        <label>Notizen</label>
                        <textarea name="attr_ausruestung_detail"></textarea>
                    </div>
                </fieldset>
            </div>
            <div class="inventory-schoenedinge">
                <div class="inventory-schoenedinge-header">
                    <h3>Schöne Dinge</h3>
                    <h3>Menge</h3>
                    <h3>Wert</h3>
                </div>
                <fieldset class="repeating_schoenedinge">
                    <input class="pictos toggle-schoenedinge-detail detail-toggle" name='act_toggle_schoenedinge_detail' type='checkbox'><label class="inline-label repeating-toggle-label"></label>
                    <input class="inventory-schoenedinge-name" type="text" name="attr_schoenedingename">
                    <input class="inventory-schoenedinge-menge" type="number" name="attr_schoenedingemenge" value="0">
                    <input class="inventory-schoenedinge-wert" type="number" name="attr_schoenedingewert" value="0">
                    <div class="schoenedinge-detail detail-container">
                        <label>Notizen</label>
                        <textarea name="attr_schoenedinge_detail"></textarea>
                    </div>
                </fieldset>
            </div>
            <div class="inventory-mondgloeckchen">
                <h3 class="input-label-left">Mondglöckchen</h3>
                <input type="number" name="attr_mondgloeckchen" value="0">
            </div>
            <div class="inventory-tierbegleiter">
                <h3>Tierbegleiter</h3>
                <textarea name="attr_tierbegleiter" ></textarea>
            </div>
        </div>
    </div>
    <div class="settingstab">
        <div class="settings-container">
            <h2>Einstellungen</h2>
            <h4><input name='attr_toggle_nsc_charactersheet' type='checkbox'>&nbsp;NSC Modus</h4>
            <p>
                Schaltet den Charakterbogen in den NSC Modus. Die meisten Charakterwerte (z.B. Probenwerte von Fertigkeiten) werden damit nicht mehr automatisch berechnet, sondern können manuell eingetragen werden.
                Nach dem Ausschalten der Funktion sollte der Charakterbogen einmal neu geöffnet werden.
            </p>
            <h2>Informationen</h2>
            <h4>Belastung und Zustände</h4>
            <p>
                Die im Charakterbogen eingetragene Belastung (BE) wird automatisch von allen von Belastung betroffenen Proben abgezogen und muss daher nicht extra als Modifikator angegeben werden.
                Bei Proben bei denen die Belastung optional berücksichtigt werden kann, wird der Belastungswert nicht automatisch abgezogen sondern nur im Modifikator-Dialog vorausgewählt.
            </p>
            <p>
                Andere Zustände werden in der Berechnung nicht automatisch berücksichtigt.
            </p>
            <h4>Abenteuerpunkte</h4>
            <p>
                Verbrauchte Abenteuerpunkte werden nicht automatisch berechnet. Die Eingabefelder dienen nur einer besseren Übersicht.
            </p>
        </div>
    </div>
</div>

<rolltemplate class="sheet-rolltemplate-attack">
    <div class="sheet-template-container">
        <div class="sheet-template-header">Angriff mit {{weapon}}<br>von <br> {{Angreifer}}</div>
        <div class="sheet-template-body">
            <label>Würfelwurf:</label><span>{{result}}</span>
            <label>Probenwert:</label><span>{{probenwert}}</span>

            {{#rollTotal() result 2}}
                <div class="sheet-template-success">
                    Angriff kritisch erfolgreich!
                </div>
                <label>QS:</label><span>{{qs}}</span>
                <label>Schadenswurf:</label><span>{{damageroll}}</span>
                <label>Gesamtschaden (kritisch):</label><span>{{totaldamagekritisch}}</span>
            {{/rollTotal() result 2}}
            {{#rollTotal() result 40}}
                <div class="sheet-template-miss">
                    Angriff kritisch fehlgeschlagen!
                </div>
            {{/rollTotal() result 40}}

            {{#rollBetween() result 3 39}}
                {{#rollGreater() result probenwert}}
                    <div class="sheet-template-miss">
                        Angriff fehlgeschlagen!
                    </div>
                {{/rollGreater() result probenwert}}
                {{#^rollGreater() result probenwert}}
                    <div class="sheet-template-success">
                        Angriff erfolgreich!
                    </div>
                    <label>QS:</label><span>{{qs}}</span>
                    <label>Schadenswurf:</label><span>{{damageroll}}</span>
                    <label>Gesamtschaden:</label><span>{{totaldamage}}</span>
                {{/^rollGreater() result probenwert}}
            {{/rollBetween() result 3 39}}
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-ahnengabe">
    <div class="sheet-template-container">
        <div class="sheet-template-header">{{name}}<br>von <br> {{Angreifer}}</div>
        <div class="sheet-template-body">
            <label>Würfelwurf:</label><span>{{result}}</span>
            <label>Probenwert:</label><span>{{probenwert}}</span>

            {{#rollTotal() result 2}}
                <div class="sheet-template-success">
                    Kritischer Erfolg!
                </div>
                <label>QS:</label><span>{{qs}}</span>
            {{/rollTotal() result 2}}
            {{#rollTotal() result 40}}
                <div class="sheet-template-miss">
                    Kritischer Fehlschlag!
                </div>
            {{/rollTotal() result 40}}

            {{#rollBetween() result 3 39}}
                {{#rollGreater() result probenwert}}
                    <div class="sheet-template-miss">
                        Fehlschlag!
                    </div>
                {{/rollGreater() result probenwert}}
                {{#^rollGreater() result probenwert}}
                    <div class="sheet-template-success">
                        Erfolg!
                    </div>
                    <label>QS:</label><span>{{qs}}</span>
                {{/^rollGreater() result probenwert}}
            {{/rollBetween() result 3 39}}
            {{#wirkung}}
                <label class="sheet-rolltemplate-desciption-header">Wirkung</label>
                <span class="sheet-rolltemplate-desciption-body">{{wirkung}}</span>
            {{/wirkung}}
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-skillcheck">
    <div class="sheet-template-container">
        <div class="sheet-template-header">{{name}}<br>von <br> {{Angreifer}}</div>
        <div class="sheet-template-body">
            <label>Würfelwurf:</label><span>{{result}}</span>
            <label>Probenwert:</label><span>{{probenwert}}</span>

            {{#rollTotal() result 2}}
                <div class="sheet-template-success">
                    Kritischer Erfolg!
                </div>
                <label>QS:</label><span>{{qs}}</span>
            {{/rollTotal() result 2}}
            {{#rollTotal() result 40}}
                <div class="sheet-template-miss">
                    Kritischer Fehlschlag!
                </div>
            {{/rollTotal() result 40}}
            {{#rollBetween() result 3 39}}
                {{#rollGreater() result probenwert}}
                    <div class="sheet-template-miss">
                        Fehlschlag!
                    </div>
                {{/rollGreater() result probenwert}}
                {{#^rollGreater() result probenwert}}
                    <div class="sheet-template-success">
                        Erfolg!
                    </div>
                    <label>QS:</label><span>{{qs}}</span>
                {{/^rollGreater() result probenwert}}
            {{/rollBetween() result 3 39}}
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-initiative">
    <div class="sheet-template-container">
        <div class="sheet-template-header">Initiative</div>
        <div class="sheet-template-body">
            <label>Würfelwurf:</label><span>{{result}}</span>
        </div>
    </div>
</rolltemplate>

<script type="text/worker">
    // character sheet tab control
    const buttonlist = ["charactertab", "skillstab", "ancestortab", "inventorytab", "settingstab"];
    buttonlist.forEach(button => {
        on(`clicked:${button}`, function() {
            setAttrs({
                sheetTab: button
            });
        });
    });

    function isNscSheet(toggle_nsc_charactersheet) {
        return toggle_nsc_charactersheet !== "0";
    }

    function parseIntValue(attr) {
        return parseInt(attr)||0;
    }

    // Skill value calculation
    function calculateEw(e1, e2) {
        let e1Int = parseIntValue(e1);
        let e2Int = parseIntValue(e2);
        return Math.ceil((e1Int + e2Int) / 2);
    }

    function getAttributeName(abbreviation) {
        switch (abbreviation.toLowerCase()) {
            case "mu": return "mut";
            case "kl": return "klugheit";
            case "ch": return "charisma";
            case "in": return "intuition";
            case "ge": return "gewandtheit";
            case "ff": return "fingerfertigkeit";
            case "kk": return "koerperkraft";
            case "ko": return "konstitution";
            default: return "";
        }
    }

    let attributeList = ["mut", "klugheit", "charisma", "intuition", "gewandtheit", "fingerfertigkeit", "koerperkraft", "konstitution"];

    let skillsList = ["skillfriemeln", "skillkoerperbeherrschung", "skillkraftakt", "skillselbstbeherrschung", "skillverbergen",
    "skillbetteln", "skilldurchschauen", "skilleinschuechtern", "skillumschmeicheln", "skillwillenskraft",
    "skillgassenkunde", "skillgeisterkunde", "skillgeographie", "skillgeschichten", "skillmenschenkunde", "skillorientierung", "skillpflanzenkunde", "skillsinnesschaerfe", "skilltierkunde", "skillzahlenkunde", "skillwissender",
    "skillbasteln", "skillheilkunde", "skillkochen", "skillmusizieren", "skillueberleben",
    "skillraufen", "skilleinhandwaffen", "skillschilde", "skillschusswaffen", "skillwurfwaffen", "skillzweihandwaffen"];

    let skillsListEw1 = skillsList.map(skill => skill + "Ew1");
    let skillsListEw2 = skillsList.map(skill => skill + "Ew2");
    let attributeChangeRequiredAttrs = skillsList.concat(skillsListEw1).concat(skillsListEw2).concat(attributeList).concat(["toggle_nsc_charactersheet"]);


    // update calculated values
    on("sheet:opened change:initiativemod change:mut change:gewandtheit change:klugheit change:leiteigenschaft change:ahnenenergiemod change:konstitution change:intuition change:koerperkraft " +
       "change:lebensenergiemod change:seelenkraftmod change:zaehigkeitmod"
        , function() {
        getAttrs(["leiteigenschaft", "ahnenenergiemod", "charisma", "klugheit", "intuition", "konstitution", "initiativemod", "mut",
                  "gewandtheit", "seelenkraftmod", "toggle_nsc_charactersheet", "lebensenergiemod", "koerperkraft", "zaehigkeitmod"], function(values) {

            if (isNscSheet(values.toggle_nsc_charactersheet)) {
                return;
            }

            let mut = parseIntValue(values.mut);
            let gewandtheit = parseIntValue(values.gewandtheit);
            let klugheit = parseIntValue(values.klugheit);
            let konstitution = parseIntValue(values.konstitution);
            let intuition = parseIntValue(values.intuition);
            let koerperkraft = parseIntValue(values.koerperkraft);

            let lebensenergiemod = parseIntValue(values.lebensenergiemod);
            let initiativemod = parseIntValue(values.initiativemod);
            let ahnenenergiemod = parseIntValue(values.ahnenenergiemod);
            let seelenkraftmod = parseIntValue(values.seelenkraftmod);
            let zaehigkeitmod = parseIntValue(values.zaehigkeitmod);

            // Ahnenenergie calculation
            let leiteigenschaft = values.leiteigenschaft;
            let leiteigenschaftAttribut = parseIntValue(values[leiteigenschaft]);
            let ahnenenergieCalculated = leiteigenschaftAttribut === 0 ? 0 : 20 + leiteigenschaftAttribut + ahnenenergiemod;

            setAttrs({
                "lebensenergie_max": (konstitution*2)+lebensenergiemod,
                "ahnenenergie_max": ahnenenergieCalculated,
                "seelenkraft": Math.round((mut+klugheit+intuition)/3)-10+seelenkraftmod,
                "zaehigkeit": Math.round((konstitution+konstitution+koerperkraft)/3)-10+zaehigkeitmod,
                "initiative": Math.round((mut + gewandtheit) / 2) + initiativemod
            });
        });
    });

    // on attribute change skill update
    attributeList.forEach(attr => {
        on(`change:${attr}`, function() {
            getAttrs(attributeChangeRequiredAttrs, function(values) {

                if (isNscSheet(values.toggle_nsc_charactersheet)) {
                    return;
                }

                let attrsToSet = {};
                skillsList.forEach(skill => {
                    // update Skill ew properties
                    let skillEw1Abbr = values[skill+"Ew1"];
                    let skillEw1 = getAttributeName(skillEw1Abbr);
                    let skillEw1Value = parseIntValue(values[skillEw1]);

                    let skillEw2Abbr = values[skill+"Ew2"];
                    let skillEw2 = getAttributeName(skillEw2Abbr);
                    let skillEw2Value = parseIntValue(values[skillEw2]);

                    let skillEw = calculateEw(skillEw1Value, skillEw2Value);
                    attrsToSet[skill+"ew"] = skillEw;
                });
                setAttrs(attrsToSet);
            });
        });
    });

    // on skill ew & skill fw change
    skillsList.forEach(skill => {
        on("change:"+skill+"ew change:"+skill, function() {
            getAttrs([skill, skill+"ew", "mut", "klugheit", "charisma", "intuition", "gewandtheit", "fingerfertigkeit", "koerperkraft", "konstitution"], function(values) {
                // console.log("Skill: "+skill);
                let skillEw = parseIntValue(values[skill+"ew"])||0;
                // console.log("skillEw: " + skillEw);

                let skillFw = parseIntValue(values[skill])||0;
                // console.log("skillFw: " + skillFw);

                // update skill pw, aw, vw properties
                let attrsToSet = {};
                let skillPw = skillEw + skillFw + 5;
                // console.log("skillPw: "+skillPw);
                let skillAw = skillPw;
                let skillVw = Math.round(skillAw / 4);

                // console.log("Set Attr: pw "+skillPw+", aw "+skillAw+", vw "+skillVw);
                setAttrs({
                    [skill+"pw"]: skillPw,
                    [skill+"aw"]: skillAw,
                    [skill+"vw"]: skillVw,
                });
            });
        });
    });

    // get skillAw or skillVw from meleetype or rangedtype as int
    function getSkillAwOrVw(values, attacktype, awOrVw) {
        return parseIntValue(values["skill"+attacktype+awOrVw]);
    }

    // on melee weapon mod aw / vw & melee type change
    on("change:repeating_meleeweapon:meleetype change:repeating_meleeweapon:meleemodaw change:repeating_meleeweapon:meleemodvw", function() {
        getAttrs(["repeating_meleeweapon_meleetype", "repeating_meleeweapon_meleemodaw", "repeating_meleeweapon_meleemodvw",
        "skillraufenaw", "skillraufenvw", "skilleinhandwaffenaw", "skilleinhandwaffenvw", "skillzweihandwaffenaw", "skillzweihandwaffenvw",
        "skillschildeaw", "skillschildevw", "toggle_nsc_charactersheet"], function(values) {
            if (isNscSheet(values.toggle_nsc_charactersheet)) {
                return;
            }

            let meleetype = values.repeating_meleeweapon_meleetype;
            let skillaw = getSkillAwOrVw(values, meleetype, "aw");
            let skillvw = getSkillAwOrVw(values, meleetype, "vw");
            let skillawMod = parseIntValue(values.repeating_meleeweapon_meleemodaw);
            let skillvwMod = parseIntValue(values.repeating_meleeweapon_meleemodvw);

            let weaponawCalculated = skillaw + skillawMod;
            let weaponvwCalculated = skillvw + skillvwMod;

            // console.log("calculated weapon aw = " + weaponawCalculated);
            // console.log("calculated weapon vw = " + weaponvwCalculated);

            setAttrs({
                repeating_meleeweapon_meleeaw: weaponawCalculated,
                repeating_meleeweapon_meleevw: weaponvwCalculated
            });
        });
    });

    // on ranged weapon ranged type change
    on("change:repeating_rangedweapon:rangedtype", function() {
        getAttrs(["repeating_rangedweapon_rangedtype", "skillschusswaffenaw", "skillwurfwaffenaw", "toggle_nsc_charactersheet"], function(values) {

            if (isNscSheet(values.toggle_nsc_charactersheet)) {
                return;
            }

            let rangedtype = values.repeating_rangedweapon_rangedtype;
            // console.log("rangedtype "+rangedtype);
            let skillaw = parseIntValue(values["skill"+rangedtype+"aw"]);
            // console.log("skillaw = " + skillaw);

            setAttrs({
                repeating_rangedweapon_rangedaw: skillaw
            });
        });
    });

    // on melee skill aw / vw change
    on("change:skillraufenaw change:skillraufenvw change:skilleinhandwaffenaw change:skilleinhandwaffenvw change:skillzweihandwaffenaw change:skillzweihandwaffenvw change:skillschildeaw change:skillschildevw", function() {
        getSectionIDs("meleeweapon", function(idarray) {
            let repeating_attrs = [];
            for(var i=0; i < idarray.length; i++) {
                let id = idarray[i];
                repeating_attrs.push("repeating_meleeweapon_" + id + "_meleemodaw");
                repeating_attrs.push("repeating_meleeweapon_" + id + "_meleemodvw");
                repeating_attrs.push("repeating_meleeweapon_" + id + "_meleetype");
            }
            // console.log("repeating_attrs "+repeating_attrs);

            getAttrs([...repeating_attrs, "skillraufenaw", "skillraufenvw", "skilleinhandwaffenaw", "skilleinhandwaffenvw", "skillzweihandwaffenaw", "skillzweihandwaffenvw",
                 "skillschildeaw", "skillschildevw", "toggle_nsc_charactersheet"], function(values) {

                if (isNscSheet(values.toggle_nsc_charactersheet)) {
                    return;
                }

                let attrsToSet = {};

                for(var i=0; i < idarray.length; i++) {
                    let id = idarray[i];
                    // console.log("id "+id);
                    let meleetype = values["repeating_meleeweapon_" + id + "_meleetype"];
                    // console.log("meleetype "+meleetype);
                    let skillaw = getSkillAwOrVw(values, meleetype, "aw");
                    let skillvw = getSkillAwOrVw(values, meleetype, "vw");

                    let skillawMod = parseIntValue(values["repeating_meleeweapon_" + id + "_meleemodaw"]);
                    let skillvwMod = parseIntValue(values["repeating_meleeweapon_" + id + "_meleemodvw"]);

                    // console.log("skillaw "+skillaw+", skillvw "+skillvw+", skillawMod "+skillawMod+", skillvwMod "+skillvwMod);

                    let weaponawCalculated = skillaw + skillawMod;
                    let weaponvwCalculated = skillvw + skillvwMod;

                    attrsToSet["repeating_meleeweapon_"+id+"_meleeaw"] = weaponawCalculated;
                    attrsToSet["repeating_meleeweapon_"+id+"_meleevw"] = weaponvwCalculated;
                }
                // console.log("attrsToSet "+JSON.stringify(attrsToSet));
                setAttrs(attrsToSet);
            });
        });
    });

    // on ranged skill aw change
    on("change:skillwurfwaffenaw change:skillschusswaffenaw", function() {
        let repeating_attrs = [];
        getSectionIDs("rangedweapon", function(idarray) {
            for(var i=0; i < idarray.length; i++) {
                let id = idarray[i];
                repeating_attrs.push("repeating_rangedweapon_" + id + "_rangedtype");
            }
            // console.log("repeating_attrs "+repeating_attrs);

            getAttrs([...repeating_attrs, "skillwurfwaffenaw", "skillschusswaffenaw", "toggle_nsc_charactersheet"], function(values) {

                if (isNscSheet(values.toggle_nsc_charactersheet)) {
                    return;
                }

                let attrsToSet = {};

                for(var i=0; i < idarray.length; i++) {
                    let id = idarray[i];
                    // console.log("id "+id);
                    let rangedtype = values["repeating_rangedweapon_" + id + "_rangedtype"];
                    // console.log("rangedtype "+rangedtype);
                    let skillaw = getSkillAwOrVw(values, rangedtype, "aw");
                    // console.log("skillaw "+skillaw);

                    attrsToSet["repeating_rangedweapon_" + id + "_rangedaw"] = skillaw;
                }
                setAttrs(attrsToSet);
            });
        });
    });

    // on ahnengaben fw & eigenschaft change
    on("change:repeating_ahnengaben:ahnengabefw change:repeating_ahnengaben:ahnengabeEw1 change:repeating_ahnengaben:ahnengabeEw2", function() {
        getAttrs([...attributeList, "repeating_ahnengaben_ahnengabefw", "repeating_ahnengaben_ahnengabeEw1", "repeating_ahnengaben_ahnengabeEw2", "toggle_nsc_charactersheet"], function(values) {

            if (isNscSheet(values.toggle_nsc_charactersheet)) {
                return;
            }

            let skillFw = parseIntValue(values.repeating_ahnengaben_ahnengabefw);

            let skillEw1Abbr = values["repeating_ahnengaben_ahnengabeEw1"];
            let skillEw1 = getAttributeName(skillEw1Abbr);
            let skillEw1Value = parseIntValue(values[skillEw1]);
            let skillEw2Abbr = values["repeating_ahnengaben_ahnengabeEw2"];
            let skillEw2 = getAttributeName(skillEw2Abbr);
            let skillEw2Value = parseIntValue(values[skillEw2]);

            let skillEw = calculateEw(skillEw1Value, skillEw2Value);
            let skillPw = skillEw + skillFw + 5;

            setAttrs({
                "repeating_ahnengaben_ahnengabeew": skillEw,
                "repeating_ahnengaben_ahnengabepw": skillPw
            });
        });
    });

    // on attribute change ahnengaben update
    attributeList.forEach(attr => {
        on(`change:${attr}`, function() {
            getSectionIDs("ahnengaben", function(idarray) {
                let repeating_attrs = [];
                for(var i=0; i < idarray.length; i++) {
                    let id = idarray[i];
                    repeating_attrs.push("repeating_ahnengaben_" + id + "_ahnengabefw");
                    repeating_attrs.push("repeating_ahnengaben_" + id + "_ahnengabeEw1");
                    repeating_attrs.push("repeating_ahnengaben_" + id + "_ahnengabeEw2");
                }
                // console.log("repeating_attrs "+repeating_attrs);
                getAttrs(repeating_attrs.concat(attributeList).concat(["toggle_nsc_charactersheet"]), function(values) {

                    if (isNscSheet(values.toggle_nsc_charactersheet)) {
                        return;
                    }

                    let attrsToSet = {};
                    for(var i=0; i < idarray.length; i++) {
                        let id = idarray[i];
                        let skillFw = parseIntValue(values["repeating_ahnengaben_" + id + "_ahnengabefw"]);
                        let skillEw1Abbr = values["repeating_ahnengaben_" + id + "_ahnengabeEw1"];
                        let skillEw1 = getAttributeName(skillEw1Abbr);
                        let skillEw1Value = parseIntValue(values[skillEw1]);

                        let skillEw2Abbr = values["repeating_ahnengaben_" + id + "_ahnengabeEw2"];
                        let skillEw2 = getAttributeName(skillEw2Abbr);
                        let skillEw2Value = parseIntValue(values[skillEw2]);

                        let skillEw = calculateEw(skillEw1Value, skillEw2Value);
                        let skillPw = skillEw + skillFw + 5;
                        attrsToSet["repeating_ahnengaben_" + id + "_ahnengabeew"] = skillEw;
                        attrsToSet["repeating_ahnengaben_" + id + "_ahnengabepw"] = skillPw;
                    }
                    setAttrs(attrsToSet);
                });
            });
        });
    });

</script>




