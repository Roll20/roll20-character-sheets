<div class="characterwrapper">
	<div class="menuwrapper">

		<span data-i18n="spire-the-city-must-fall">Spire - The City Must Fall</span>
		<button type="action" name="act_Profile" class="tab"checked="checked" data-i18n-placeholder="profile"/>Profile</button>
		<button type="action" name="act_Stress" class="tab" checked="checked" data-i18n-placeholder="stress" />Stress</button>
		<button type="roll" class="tab" value="&{template:roll} {{name= @{character-name} }} {{skill= @{selector-skill} }} {{domain= @{selector-domain} }} {{result= [[?{Total Dice|1}d10k1]]}}"  data-i18n-placeholder="roll"/>Roll</button>

	</div>
	<input type='hidden' class='sheet-tabstoggle' name='attr_sheetTab'  value='profile'  />

	<!--------Profile-------------->
	<div class="sheet-profile">
		<div class="biginfo"><span data-i18n="character-name">Character Name:</span> <input type="text" name="attr_character-name"></div>
		<div class="biginfo"><span data-i18n="class">Class:</span> <input type="text" name="attr_character-class"></div>
		<div class="biginfo"><span data-i18n="durance">Durance:</span> <input type="text" name="attr_character-durance"></div>

		<div class="flexrow">
			<!------------ Skill List ------------>
			<div class="flexcol smaller">
				<div class="check-listing" data-i18n-list="list-skill">
					<label class="labelradio"><input type="radio" name="attr_selector-skill" value="Struggle" checked="checked"><span><h1 data-i18n="skills">Skills</h1></span></label>
					<div class="flexrow" data-i18n-list-item="compel">
						<label class="labelradio"><input type="radio" name="attr_selector-skill" value="Compel"><span data-i18n="compel">Compel</span></label><input type="checkbox" class="check-proficiency" name="attr_skill-compel"/><span></span>
						<input type="checkbox" class="check-proficiency knackrevealer" name="attr_knack-check-compel"/><span></span><input type="text" class="knackinput" name="attr_knack-desc-compel" />
					</div>
					<div class="flexrow" data-i18n-list-item="deceive">
						<label class="labelradio"><input type="radio" name="attr_selector-skill" value="Deceive"><span data-i18n="deceive">Deceive</span></label><input type="checkbox" name="attr_skill-deceive"><span></span>
						<input type="checkbox" class="check-proficiency knackrevealer" name="attr_knack-check-deceive"/><span></span><input type="text" class="knackinput" name="attr_knack-desc-deceive">
					</div>
					<div class="flexrow" data-i18n-list-item="fight">
						<label class="labelradio"><input type="radio" name="attr_selector-skill" value="Fight"><span data-i18n="fight">Fight</span></label><input type="checkbox" name="attr_skill-fight"><span></span>
						<input type="checkbox" class="check-proficiency knackrevealer" name="attr_knack-check-fight"/><span></span><input type="text" class="knackinput" name="attr_knack-desc-fight">
					</div>
					<div class="flexrow" data-i18n-list-item="fix">
						<label class="labelradio"><input type="radio" name="attr_selector-skill" value="Fix"><span data-i18n="fix">Fix</span></label><input type="checkbox" name="attr_skill-fix"><span></span>
						<input type="checkbox" class="check-proficiency knackrevealer" name="attr_knack-check-fix"/><span></span><input type="text" class="knackinput" name="attr_knack-desc-fix">
					</div>
					<div class="flexrow" data-i18n-list-item="investigate">
						<label class="labelradio"><input type="radio" name="attr_selector-skill" value="Investigate"><span data-i18n="investigate">Investigate</span></label><input type="checkbox" name="attr_skill-investigate"><span></span>
						<input type="checkbox" class="check-proficiency knackrevealer" name="attr_knack-check-investigate"/><span></span><input type="text" class="knackinput" name="attr_knack-desc-investigate">
					</div>
					<div class="flexrow" data-i18n-list-item="pursue">
						<label class="labelradio"><input type="radio" name="attr_selector-skill" value="Pursue"><span data-i18n="pursue">Pursue</span></label><input type="checkbox" name="attr_skill-pursue"><span></span>
						<input type="checkbox" class="check-proficiency knackrevealer" name="attr_knack-check-pursue"/><span></span><input type="text" class="knackinput" name="attr_knack-desc-pursue">
					</div>
					<div class="flexrow" data-i18n-list-item="resist">
						<label class="labelradio"><input type="radio" name="attr_selector-skill" value="Resist"><span data-i18n="resist">Resist</span></label><input type="checkbox" name="attr_skill-resist"><span></span>
						<input type="checkbox" class="check-proficiency knackrevealer" name="attr_knack-check-resist"/><span></span><input type="text" class="knackinput" name="attr_knack-desc-resist">
					</div>
					<div class="flexrow" data-i18n-list-item="sneak">
						<label class="labelradio"><input type="radio" name="attr_selector-skill" value="Sneak"><span data-i18n="sneak">Sneak</span></label><input type="checkbox" name="attr_skill-sneak"><span></span>
						<input type="checkbox" class="check-proficiency knackrevealer" name="attr_knack-check-sneak"/><span></span><input type="text" class="knackinput" name="attr_knack-desc-sneak">
					</div>
					<div class="flexrow" data-i18n-list-item="steal">
						<label class="labelradio"><input type="radio" name="attr_selector-skill" value="Steal"><span data-i18n="steal">Steal</span></label><input type="checkbox" name="attr_skill-steal"><span></span>
						<input type="checkbox" class="check-proficiency knackrevealer" name="attr_knack-check-steal"/><span></span><input type="text" class="knackinput" name="attr_knack-desc-steal">
					</div>
				</div>
				<!------------ Domains ------------->
				<div class="check-listing" data-i18n-list="list-domains">
					<label class="labelradio"><input type="radio" name="attr_selector-domain" value="Unfamiliar" checked="checked"><span><h1 data-i18n="domains">Domains</h1></span></label>
					<div class="flexrow">
						<label class="labelradio"><input type="radio" name="attr_selector-domain" value="Academia"><span data-i18n="academia">Academia</span></span></label><input type="checkbox" name="attr_skill-academia"><span></span>
						<input type="checkbox" class="check-proficiency knackrevealer" name="attr_knack-check-academia"/><span></span><input type="text" class="knackinput" name="attr_knack-desc-academia">
					</div>
					<div class="flexrow">
						<label class="labelradio"><input type="radio" name="attr_selector-domain" value="Crime"><span data-i18n="crime">Crime</span></label><input type="checkbox" name="attr_skill-crime"><span></span>
						<input type="checkbox" class="check-proficiency knackrevealer" name="attr_knack-check-crime"/><span></span><input type="text" class="knackinput" name="attr_knack-desc-crime">
					</div>
					<div class="flexrow">
						<label class="labelradio"><input type="radio" name="attr_selector-domain" value="Commerce"><span  data-i18n="commerce">Commerce</span></label><input type="checkbox" name="attr_skill-commerce"><span></span>
						<input type="checkbox" class="check-proficiency knackrevealer" name="attr_knack-check-commerce"/><span></span><input type="text" class="knackinput" name="attr_knack-desc-commerce">
					</div>
					<div class="flexrow">
						<label class="labelradio"><input type="radio" name="attr_selector-domain" value="High Society"><span data-i18n="high-society">High Society</span></label><input type="checkbox" name="attr_skill-highsociety"><span></span>
						<input type="checkbox" class="check-proficiency knackrevealer" name="attr_knack-check-highsociety"/><span></span><input type="text" class="knackinput" name="attr_knack-desc-highsociety">
					</div>
					<div class="flexrow">
						<label class="labelradio"><input type="radio" name="attr_selector-domain" value="Low Society"><span data-i18n="low-society">Low Society</span></label><input type="checkbox" name="attr_skill-lowsociety"><span></span>
						<input type="checkbox" class="check-proficiency knackrevealer" name="attr_knack-check-lowsociety"/><span></span><input type="text" class="knackinput" name="attr_knack-desc-lowsociety">
					</div>
					<div class="flexrow">
						<label class="labelradio"><input type="radio" name="attr_selector-domain" value="Occult"><span data-i18n="occult">Occult</span></label><input type="checkbox" name="attr_skill-occult"><span></span>
						<input type="checkbox" class="check-proficiency knackrevealer" name="attr_knack-check-occult"/><span></span><input type="text" class="knackinput" name="attr_knack-desc-occult">
					</div>
					<div class="flexrow">
						<label class="labelradio"><input type="radio" name="attr_selector-domain" value="Order"><span data-i18n="order">Order</span></label><input type="checkbox" name="attr_skill-order"><span></span>
						<input type="checkbox" class="check-proficiency knackrevealer" name="attr_knack-check-order"/><span></span><input type="text" class="knackinput" name="attr_knack-desc-order">
					</div>
					<div class="flexrow">
						<label class="labelradio"><input type="radio" name="attr_selector-domain" value="Religion"><span data-i18n="religion">Religion</span></label><input type="checkbox" name="attr_skill-religion"><span></span>
						<input type="checkbox" class="check-proficiency knackrevealer" name="attr_knack-check-religion"/><span></span><input type="text" class="knackinput" name="attr_knack-desc-religion">
					</div>
					<div class="flexrow">
						<label class="labelradio"><input type="radio" name="attr_selector-domain" value="Technology"><span data-i18n="technology">Technology</span></label><input type="checkbox" name="attr_skill-technology"><span></span>
						<input type="checkbox" class="check-proficiency knackrevealer" name="attr_knack-check-technology"/><span></span><input type="text" class="knackinput" name="attr_knack-desc-technology">
					</div>
				</div>
			</div>
			<!------ Column B ----->
			<div class="flexcol bigger">
				<!------------------- Advances ------------------->
				<div class="flexcol">
					<div class="header" data-i18n="advances">Advances</div>
					<fieldset class="repeating_skills advances">
					<div class="advances">
						<input type="text" class="advance-title" name="attr_advance-title" placeholder="Ability Name"/>
						<textarea class="advance-info" name="attr_advance-info" placeholder="Description"/></textarea>
					</div>
					</fieldset>
				</div>
				<!------------- Dual Columns --------------------------------->
				<div class="flexrow">
					<!------------------------ Refresh ----------------------->
					<div class="flexcol writebox">
						<span data-i18n="refresh">Refresh</span>
						<textarea name="attr_refresh"></textarea>
					</div>
					<!------------------------ Equipment ----------------------->
					<div class="flexcol writebox">
						<span data-i18n="equipment">Equipment</span>
						<textarea name="attr_equipment"></textarea>
					</div>
				</div>
				<!----------------- Bonds -------------------------------------->
				<div class="flexrow">
					<div class="flexcol writebox">
						<span data-i18n="bonds">Bonds</span>
						<textarea name="attr_bonds"></textarea>
					</div>
				</div>
				
			</div>
		</div>
	</div>
	
	<!--------Stress--------------->
	<div class="sheet-stress" style="margin-top: 10px;">
		<fieldset class="repeating_stress"> 
		<div class="flexrow stressjustify"><input class="stress-header" type="text" name="attr_charactername" placeholder="Player Name" /><button type="roll" class="fallout" value="/w gm [[1d10]]"><span  data-i18n="fallout">Fallout</span><input type="number" class="stress-result" disabled="true" name="attr_sumstress" value="@{current-stress-blood} + @{current-stress-mind} + @{current-stress-silver} + @{current-stress-shadow} + @{current-stress-reputation}"></button></div>
			<div class="divTable stress">	
					<div class="divTableHeading">
						<div class="divTableCell" data-i18n="free-slots">Free Slots</div>
						<div class="divTableCell" data-i18n="resistances">Resistances</div>
						<div class="divTableCell" data-i18n="current">Current</div>
						<div class="divTableCell" data-i18n="fallout">Fallout</div>
					</div>
					
					<!----------- Armor ------------->
					<div class="divTableRow">
						<div class="divTableCell colStress">
							<input type="hidden" disabled="true" name="attr_sumstress" value="@{current-stress-blood} + @{current-stress-mind} + @{current-stress-silver} + @{current-stress-shadow} + @{current-stress-reputation}" disabled>
							<input type="radio" class="radiostress none" name="attr_free-armor" value="0" checked="checked"><span></span>
							<input type="radio" class="radiostress" name="attr_free-armor" value="1"><span></span>
							<input type="radio" class="radiostress" name="attr_free-armor" value="2"><span></span>
							<input type="radio" class="radiostress" name="attr_free-armor" value="3"><span></span>
							<input type="radio" class="radiostress" name="attr_free-armor" value="4"><span></span>
							<input type="radio" class="radiostress" name="attr_free-armor" value="5"><span></span>
							<input type="radio" class="radiostress" name="attr_free-armor" value="6"><span></span>
							<input type="radio" class="radiostress" name="attr_free-armor" value="7"><span></span>
						</div>
							<h3 class="divTableCell colResistance" data-i18n="armor">Armor</h3>
							<div class="divTableCell colCurrent">
								<input type="number" name="attr_current-stress-armor" value="0">
							</div>
							<div class="divTableCell colFallout">
								<input type="text" name="attr_fallout-armor">
							</div>
					</div>
					
					<!----------- Blood ------------->
					<div class="divTableRow">
						<div class="divTableCell colStress">
							<input type="radio" class="radiostress none" name="attr_free-blood" value="0" checked="checked"><span></span>
							<input type="radio" class="radiostress" name="attr_free-blood" value="1"><span></span>
							<input type="radio" class="radiostress" name="attr_free-blood" value="2"><span></span>
							<input type="radio" class="radiostress" name="attr_free-blood" value="3"><span></span>
							<input type="radio" class="radiostress" name="attr_free-blood" value="4"><span></span>
							<input type="radio" class="radiostress" name="attr_free-blood" value="5"><span></span>
							<input type="radio" class="radiostress" name="attr_free-blood" value="6"><span></span>
							<input type="radio" class="radiostress" name="attr_free-blood" value="7"><span></span>
						</div>
							<h3 class="divTableCell colResistance" data-i18n="blood">Blood</h3>
							<div class="divTableCell colCurrent">
								<input type="number" name="attr_current-stress-blood" value="0">
							</div>
							<div class="divTableCell colFallout">
								<input type="text" name="attr_fallout-blood">
							</div>
					</div>
					
					<!----------- Mind ------------->
					<div class="divTableRow">
						<div class="divTableCell colStress">
							<input type="radio" class="radiostress none" name="attr_free-mind" value="0" checked="checked"><span></span>
							<input type="radio" class="radiostress" name="attr_free-mind" value="1"><span></span>
							<input type="radio" class="radiostress" name="attr_free-mind" value="2"><span></span>
							<input type="radio" class="radiostress" name="attr_free-mind" value="3"><span></span>
							<input type="radio" class="radiostress" name="attr_free-mind" value="4"><span></span>
							<input type="radio" class="radiostress" name="attr_free-mind" value="5"><span></span>
							<input type="radio" class="radiostress" name="attr_free-mind" value="6"><span></span>
							<input type="radio" class="radiostress" name="attr_free-mind" value="7"><span></span>
						</div>
							<h3 class="divTableCell colResistance" data-i18n="mind">Mind</h3>
							<div class="divTableCell colCurrent">
								<input type="number" name="attr_current-stress-mind" value="0">
							</div>
							<div class="divTableCell colFallout">
								<input type="text" name="attr_fallout-mind">
							</div>
					</div>
					
					<!----------- Silver ------------->
					<div class="divTableRow">
						<div class="divTableCell colStress">
							<input type="radio" class="radiostress none" name="attr_free-silver" value="0" checked="checked"><span></span>
							<input type="radio" class="radiostress" name="attr_free-silver" value="1"><span></span>
							<input type="radio" class="radiostress" name="attr_free-silver" value="2"><span></span>
							<input type="radio" class="radiostress" name="attr_free-silver" value="3"><span></span>
							<input type="radio" class="radiostress" name="attr_free-silver" value="4"><span></span>
							<input type="radio" class="radiostress" name="attr_free-silver" value="5"><span></span>
							<input type="radio" class="radiostress" name="attr_free-silver" value="6"><span></span>
							<input type="radio" class="radiostress" name="attr_free-silver" value="7"><span></span>
						</div>
							<h3 class="divTableCell colResistance" data-i18n="silver">Silver</h3>
							<div class="divTableCell colCurrent">
								<input type="number" name="attr_current-stress-silver" value="0">
							</div>
							<div class="divTableCell colFallout">
								<input type="text" name="attr_fallout-silver">
							</div>
					</div>
					
					<!----------- Shadow ------------->
					<div class="divTableRow">
						<div class="divTableCell colStress">
							<input type="radio" class="radiostress none" name="attr_free-shadow" value="0" checked="checked"><span></span>
							<input type="radio" class="radiostress" name="attr_free-shadow" value="1"><span></span>
							<input type="radio" class="radiostress" name="attr_free-shadow" value="2"><span></span>
							<input type="radio" class="radiostress" name="attr_free-shadow" value="3"><span></span>
							<input type="radio" class="radiostress" name="attr_free-shadow" value="4"><span></span>
							<input type="radio" class="radiostress" name="attr_free-shadow" value="5"><span></span>
							<input type="radio" class="radiostress" name="attr_free-shadow" value="6"><span></span>
							<input type="radio" class="radiostress" name="attr_free-shadow" value="7"><span></span>
						</div>
							<h3 class="divTableCell colResistance" data-i18n="shadow">Shadow</h3>
							<div class="divTableCell colCurrent">
								<input type="number" name="attr_current-stress-shadow" value="0">
							</div>
							<div class="divTableCell colFallout">
								<input type="text" name="attr_fallout-shadow">
							</div>
					</div>
					
					<!----------- Reputation ------------->
					<div class="divTableRow">
						<div class="divTableCell colStress">
							<input type="radio" class="radiostress none" name="attr_free-reputation" value="0" checked="checked"><span></span>
							<input type="radio" class="radiostress" name="attr_free-reputation" value="1"><span></span>
							<input type="radio" class="radiostress" name="attr_free-reputation" value="2"><span></span>
							<input type="radio" class="radiostress" name="attr_free-reputation" value="3"><span></span>
							<input type="radio" class="radiostress" name="attr_free-reputation" value="4"><span></span>
							<input type="radio" class="radiostress" name="attr_free-reputation" value="5"><span></span>
							<input type="radio" class="radiostress" name="attr_free-reputation" value="6"><span></span>
							<input type="radio" class="radiostress" name="attr_free-reputation" value="7"><span></span>
						</div>
							<h3 class="divTableCell colResistance" data-i18n="reputation">Reputation</h3>
							<div class="divTableCell colCurrent">
								<input type="number" name="attr_current-stress-reputation" value="0">
							</div>
							<div class="divTableCell colFallout">
								<input type="text" name="attr_fallout-reputation">
							</div>
					</div>
					
			</div>
		</fieldset>
	</div>
</div>

<rolltemplate class="sheet-rolltemplate-roll">
	<div class="sheet-rolltemplate-container">
		<div class="sheet-header">{{name}}</div>
		<div class="sheet-description">
			<span data-i18n="tries-to">tries to</span> {{skill}} <span data-i18n="with">with</span> {{domain}}
			<div class="sheet-result">{{result}}</div>
		</div>
	</div>
</rolltemplate>

<script type="text/worker">

const skills = ['Academics', 'Athletics', 'CloseCombat', 'Culture', 'Empathy', 'Firearms', 'Integrity', 'Leadership', 'Medicine', 'Occult', 'Persuasion', 'Pilot', 'Science', 'Subterfuge', 'Survival', 'Technology'];
on(`change:${skills.join(' change:')} change:selector-skill sheet:opened`, function() {
    console.log("----------SCRIPT WORKER SETTINGS CONSOLE");
    getAttrs([...skills, 'selector-skill'],function(values) {    
        const skill_name = values.selector-skill;    
        const skill_value = values[skill_name];
        console.log(`-------SKILL TEST--------Name: ${skill_name}; Value: ${skill_value}`);

        setAttrs({ active_skill: skill_value || -9 });    
    });
});
const attributes = ['Intellect', 'Cunning', 'Resolve', 'Might', 'Dexterity', 'Stamina', 'Presence', 'Manipulation', 'Composure'];
on(`change:${attributes.join(' change:')} change:selector-domain sheet:opened`, function() {

    getAttrs([...attributes, 'selector-domain'],function(values) {    
        const attr_name = values.selector-domain;    
        const attr_value = values[attr_name];
        console.log(`-------SKILL TEST--------Name: ${attr_name}; Value: ${attr_value}`);

        setAttrs({ active_attribute: attr_value || -9 });    
    });
});


    const buttonlist = ["profile","stress"];
    buttonlist.forEach(button => {
        on(`clicked:${button}`, function() {
            setAttrs({
                sheetTab: button
            });
        });
    });
</script>