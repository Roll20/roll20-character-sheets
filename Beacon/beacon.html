<!-- Beacon: Tabbed Character Sheet -->
<!-- Version 2 -->
<div class="sheet-overall-wrapper">
	<div class="sheet-row">
		<div class="sheet-col-1-1 sheet-margin-top sheet-center"><img src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/Beacon/Assets/logo.png" alt="Beacon Character Record Sheet"></div>
	</div>
	<hr/>
	<!-- switch between play and update mode -->
	<div class="sheet-col-1-3"><input class="sheet-underlined sheet-center" type="text" placeholder="Player Name" name="attr_playerName"></div>
	<div class="sheet-col-1-6">&nbsp;</div>
	<input type="radio" name="attr_maintab" class="sheet-maintab sheet-player" value="1" title="Use PC Play mode during regular play" checked="checked" />
	<span class="sheet-maintab sheet-player">Play Mode</span>
	<input type="radio" name="attr_maintab" class="sheet-maintab sheet-update" value="2" title="Use PC Update Mode create a character, to level up, change your base stats, race, hp etc." />
	<span class="sheet-maintab sheet-update">Update Mode</span>
	<input type="radio" name="attr_maintab" class="sheet-maintab sheet-monster" value="3" title="Use NPC/Monster Mode sheet for important NPC's and monsters." />
	<span class="sheet-maintab sheet-monster">NPC / Monster</span>
	<!-- BEACON CHARACTER SHEET -->
	<div class="sheet-maintab-content sheet-player">
		<input type="radio" name="attr_tab" class="sheet-tab sheet-tab1" value="1" checked="checked"/>
		<span class="sheet-tab sheet-tab1">Character</span>	
		<input type="radio" name="attr_tab" class="sheet-tab sheet-tab2" value="2"/>
		<span class="sheet-tab sheet-tab2">Combat</span>
		<input type="radio" name="attr_tab" class="sheet-tab sheet-tab3" value="3"/>
		<span class="sheet-tab sheet-tab3">Inventory</span>
		<input type="radio" name="attr_tab" class="sheet-tab sheet-tab4" value="4"/>
		<span class="sheet-tab sheet-tab4">Notes</span>
		<input type="radio" name="attr_tab" class="sheet-tab sheet-tab5" value="5"/>
		<span class="sheet-tab sheet-tab5">Spells</span>
		<input type="radio" name="attr_tab" class="sheet-tab sheet-tab99" value="99"/>
		<span class="sheet-tab sheet-tab99">Show All</span>			
		<span class="sheet-spacer"></span>
		<!-- CORE STATS -->				
		<div class="sheet-section-core">
			<div class="sheet-row">
				<div class="sheet-col-1">
					<h3 class="sheet-center">Character Information</h3>
				</div>
				<!-- Character Information -->
				<div class="sheet-col-1-2 sheet-padr">
					<div class="sheet-row">
						<div class="sheet-col-1-2 sheet-center"><input class="sheet-underlined sheet-center" type="text" placeholder="Character Name" name="attr_character_name"><br/>Character Name</div>
						<div class="sheet-col-1-2 sheet-center"><input class="sheet-center sheet-underlined" type="text" placeholder="Title" name="attr_Title"><br/>Title</div>
					</div>
					<div class="sheet-col-1-1 sheet-center">&nbsp;</div>
					<div class="sheet-row">
						<div class="sheet-col-1-4 sheet-center"><input class="sheet-center sheet-highlight" type="text" name="attr_showRace" value="@{Race}" disabled="disabled"><span>Race</span></div>
						<div class="sheet-col-1-4 sheet-padl sheet-center"><input class="sheet-center sheet-highlight" type="text" name="attr_showClass" value="@{Class}" disabled="disabled"><span>Class</span></div>
						<div class="sheet-col-1-3 sheet-padl sheet-center"><input title="Spend current level X 1000 to level up" class="sheet-center" type="text" Placeholder="Experience" name="attr_XP"><span>Experience Points</span></div>
						<div class="sheet-col-1-8 sheet-padl sheet-center"><input class="sheet-center sheet-highlight" type="number" name="attr_showlevel" value="@{Level}" disabled="disabled"><span>Level</span></div>
					</div>
					<div class="sheet-col-1-1 sheet-center">&nbsp;</div>
					<div class="sheet-row sheet-center">
						<div class="sheet-col-1-4 sheet-center"><input class="sheet-underlined sheet-center" type="text" name="attr_gender"><br/>Gender</div>
						<div class="sheet-col-1-6 sheet-padl sheet-center"><input class="sheet-underlined sheet-center" type="number" min="0" name="attr_age"><br/>Age</div>
						<div class="sheet-col-1-6 sheet-padl sheet-center"><input class="sheet-underlined sheet-center" type="text" name="attr_height"><br/>Height</div>
						<div class="sheet-col-1-6 sheet-padl sheet-center"><input class="sheet-underlined sheet-center" type="text" name="attr_weight"><br/>Weight</div>
												
					</div>
					<div class="sheet-row">
						<div class="sheet-col-1 sheet-center">&nbsp;</div>
					</div>
					<div class="sheet-row">
						<div class="sheet-col-1 sheet-center"><input class="sheet-center" type="text" name="attr_raceSpecials" readonly="readonly"><span>Racial Abilities</span></div>
					</div>
					<div class="sheet-row">
						<div class="sheet-col-1 sheet-center">&nbsp;</div>
					</div>
				</div>	
				<!--Combat Basics -->
				<div class="sheet-col-1-2 sheet-padr">
					<div class="sheet-row">
						<div class="sheet-col-1-16">&nbsp;</div>
						<div class="sheet-col-1-4">
							<div class="sheet-ACBG">
								<div class="sheet-col-1-4 sheet-center">&nbsp;</div>
								<div class="sheet-col-1-4 sheet-center"><input title="Base AC is 10 plus armour, dex and other bonuses/penalties" class="sheet-AC" type="number" name="attr_AC" value="@{acCalc}" disabled="disabled"/><br/>.</div>
							</div>
						</div>
						<div class="sheet-col-1-4">
							<div class="sheet-HPBG">
								<div class="sheet-col-1-4 sheet-center">&nbsp;</div>
								<div class="sheet-col-1-4 sheet-center "><input title="Total HP minus damage and spell fatigue." class="sheet-HP" type="text" name="attr_CurrentHP" value="(@{HP}+@{BonusHP})-(@{UsedHP}+@{fatigue})" disabled="disabled"/><br/>.</div>
							</div>
						</div>
						<div class="sheet-col-1-5 sheet-padl sheet-center"><input title="HP damage taken." class="sheet-HP2 sheet-center" type="number" name="attr_UsedHP" min="0" value="0"/><span>Damage Fatigue<span></div>
						<div class="sheet-col-1-5 sheet-padl sheet-center"><input title="HP used for spell casting." class="sheet-HP2 sheet-center" type="number" name="attr_fatigue" min="0" value="0"/><span>Spell Fatigue<span></div>
					</div>
					<div class="sheet-row">
						<div class="sheet-col-1-16">&nbsp;</div>
						<div class="sheet-col-1-4 sheet-center">Armor Class</div>
						<div class="sheet-col-1-4 sheet-center">Current HP</div>
					</div>
					<div class="sheet-col-1-1 sheet-center">&nbsp;</div>
					<div class="sheet-col-1-1 sheet-center">&nbsp;</div>
					<div class="sheet-row sheet-center">
						<div class="sheet-col-1-6 sheet-padl sheet-center" title="Racial Hit Die Type"><input class="sheet-center sheet-highlight" type="text" name="attr_showRaceHD" value="@{RaceHD}" disabled="disabled"><span>HD Type</span></div>
						<div class="sheet-col-1-6 sheet-padl sheet-center" title="Total HP"><input class="sheet-center sheet-highlight" type="text" name="attr_totalHP" value="(@{HP}+@{BonusHP})" disabled="disabled"><span>Total HP</span></div>
						<div class="sheet-col-1-7 sheet-padl sheet-center" title="Speed is based on your Race modified by armour"><input class="sheet-center sheet-highlight" type="number" name="attr_showSpeed" value="(@{Speed}+@{armorspeedTotal})" disabled="disabled"><span>Speed</span></div>
						<div class="sheet-col-1-6 sheet-padl sheet-center" title="Morale"><input class="sheet-center" type="number" name="attr_Morale" value="0" min="-10" max="10"><span>Morale</span></div>
						<div class="sheet-col-1-7 sheet-padl sheet-center" title="Current Load">
						<input type="hidden" class="enccheck" value="0" name="attr_enc_exceeded"/>
						<input class="sheet-center sheet-redbox" type="number" name="attr_showLoad" value="@{currentEncumbrance}" disabled="disabled"><span>Current Load</span>
						</div>
					</div>
				</div>		
				<div class="sheet-row">
				<!-- Core Stats -->
					<div class="sheet-col-1-2 sheet-padr">						
						<h3 class="sheet-center">Stats</h3>									
						<div class="sheet-row sheet-sub-header">
							<div class="sheet-col-1-3 sheet-center">&nbsp;</div>
							<div class="sheet-col-1-8 sheet-center sheet-vert-bottom">Base</div>
							<div class="sheet-col-1-8 sheet-center sheet-vert-bottom">Mods</div>
							<div class="sheet-col-1-8 sheet-center sheet-vert-bottom">Damage</div>
							<div class="sheet-col-1-8 sheet-center sheet-vert-bottom">Current</div>
							<div class="sheet-col-1-8 sheet-center sheet-vert-bottom">Bonus</div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-1-3 sheet-core-stat-label">Strength</div>
							<div class="sheet-col-1-8"><input type="number" name="attr_showstr" value="@{str}" disabled="disabled"/></div>
							<div class="sheet-col-1-8 sheet-padl" title="Enter any additional bonus' ie. from spells or equipment"><input type="number" name="attr_strMod" value="0"/></div>
							<div class="sheet-col-1-8 sheet-padl" title="Enter any damage to Strength. Subtracts from base."><input type="number" name="attr_strDam" value="0" min="0"/></div>
							<div class="sheet-col-1-8 sheet-padl"><input class="sheet-center" type="number" name="attr_strCurrent" readonly="readonly"/></div>
							<div class="sheet-col-1-8 sheet-padl"><input class="sheet-center sheet-highlight" type="number" name="attr_strBonus" readonly="readonly"></div>
						</div>							
						<div class="sheet-row">
							<div class="sheet-col-1-3 sheet-core-stat-label">Dexterity</div>
							<div class="sheet-col-1-8"><input type="number" name="attr_showdex" value="@{dex}" disabled="disabled"/></div>
							<div class="sheet-col-1-8 sheet-padl" title="Enter any additional bonus' ie. from spells or equipment"><input type="number" name="attr_dexMod" value="0"/></div>
							<div class="sheet-col-1-8 sheet-padl" title="Enter any damage to Dexterity. Subtracts from base."><input type="number" name="attr_dexDam" value="0" min="0"/></div>
							<div class="sheet-col-1-8 sheet-padl"><input class="sheet-center" type="number" name="attr_dexCurrent" readonly="readonly"/></div>
							<div class="sheet-col-1-8 sheet-padl"><input class="sheet-center sheet-highlight" type="number" name="attr_dexBonus" readonly="readonly" ></div>
						</div>												
						<div class="sheet-row">
							<div class="sheet-col-1-3 sheet-core-stat-label">Mind</div>
							<div class="sheet-col-1-8"><input type="number" name="attr_showmind" value="@{mind}" disabled="disabled"/></div>
							<div class="sheet-col-1-8 sheet-padl" title="Enter any additional bonus' ie. from spells or equipment"><input type="number" name="attr_mindMod" value="0"/></div>
							<div class="sheet-col-1-8 sheet-padl" title="Enter any damage to Mind. Subtracts from base."><input type="number" name="attr_mindDam" value="0" min="0"/></div>
							<div class="sheet-col-1-8 sheet-padl"><input class="sheet-center" type="number" name="attr_mindCurrent" readonly="readonly"/></div>
							<div class="sheet-col-1-8 sheet-padl"><input class="sheet-center sheet-highlight" type="number" name="attr_mindBonus" readonly="readonly" ></div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-1-3 sheet-core-stat-label">Charisma</div>
							<div class="sheet-col-1-8"><input type="number" name="attr_showcha" value="@{cha}" disabled="disabled"/></div>
							<div class="sheet-col-1-8 sheet-padl" title="Enter any additional bonus' ie. from spells or equipment"><input type="number" name="attr_chaMod" value="0"/></div>
							<div class="sheet-col-1-8 sheet-padl" title="Enter any damage to Charisma. Subtracts from base."><input type="number" name="attr_chaDam" value="0" min="0"/></div>
							<div class="sheet-col-1-8 sheet-padl"><input class="sheet-center" type="number" name="attr_chaCurrent" readonly="readonly"/></div>
							<div class="sheet-col-1-8 sheet-padl"><input class="sheet-center sheet-highlight" type="number" name="attr_chaBonus" readonly="readonly" ></div>
						</div>
						<div class="sheet-row">&nbsp;</div>
						<div class="sheet-row sheet-sub-header">
							<div class="sheet-col-1 sheet-center">Conditions</div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-1-3 sheet-center sheet-padl"><input name="attr_Conditions" class="sheet-center" type="text"></div>
							<div class="sheet-col-1-3 sheet-center sheet-padl"><input name="attr_Conditions2" class="sheet-center" type="text"></div>
							<div class="sheet-col-1-3 sheet-center sheet-padl"><input name="attr_Conditions3" class="sheet-center" type="text"></div>
						</div>						
					</div>
				<!-- Skills, Movement -->	
					<div class="sheet-col-1-2 sheet-padr">							
						<h3 class="sheet-center">Skills</h3>
						<div class="sheet-row sheet-sub-header">
							<div class="sheet-col-1-6 sheet-center">&nbsp;</div>
							<div class="sheet-col-1-3 sheet-center">&nbsp;</div>
							<div class="sheet-col-1-8 sheet-center sheet-vert-bottom">Base</div>
							<div class="sheet-col-1-8 sheet-center sheet-vert-bottom">Mods</div>
							<div class="sheet-col-1-8 sheet-center sheet-vert-bottom">Bonus</div>
							<div class="sheet-col-1-8 sheet-center"></div>
						</div>							
						<div class="sheet-row">
							<div class="sheet-col-1-6 sheet-center">&nbsp;</div>
							<div class="sheet-col-1-3 sheet-core-stat-label">Physical</div>
							<div class="sheet-col-1-8"><input type="number" name="attr_showphys" value="@{phys}" disabled="disabled"></div>
							<div class="sheet-col-1-8 sheet-padl" title="Enter any additional bonus' ie. from spells or equipment"><input type="number" name="attr_physMod" value="0"></div>
							<div class="sheet-col-1-8 sheet sheet-padl"><input class="sheet-center sheet-highlight" type="number" name="attr_physBonus" readonly="readonly" ></div>
						</div>							
						<div class="sheet-row">
							<div class="sheet-col-1-6 sheet-center">&nbsp;</div>
							<div class="sheet-col-1-3 sheet-core-stat-label">Subterfuge</div>
							<div class="sheet-col-1-8"><input type="number" name="attr_showsubt" value="@{subt}" disabled="disabled"></div>
							<div class="sheet-col-1-8 sheet-padl" title="Enter any additional bonus' ie. from spells or equipment"><input type="number" name="attr_subtMod" value="0"></div>
							<div class="sheet-col-1-8 sheet sheet-padl"><input class="sheet-center sheet-highlight" type="number" name="attr_subtBonus" readonly="readonly"></div>
						</div>							
						<div class="sheet-row">
							<div class="sheet-col-1-6 sheet-center">&nbsp;</div>
							<div class="sheet-col-1-3 sheet-core-stat-label">Knowledge</div>
							<div class="sheet-col-1-8"><input type="number" name="attr_showknow" value="@{know}" disabled="disabled"></div>
							<div class="sheet-col-1-8 sheet-padl" title="Enter any additional bonus' ie. from spells or equipment"><input type="number" name="attr_knowMod" value="0"></div>
							<div class="sheet-col-1-8 sheet sheet-padl"><input class="sheet-center sheet-highlight" type="number" name="attr_knowBonus" readonly="readonly"></div>
						</div>							
						<div class="sheet-row">
							<div class="sheet-col-1-6 sheet-center">&nbsp;</div>
							<div class="sheet-col-1-3 sheet-core-stat-label">Communion</div>
							<div class="sheet-col-1-8"><input type="number" name="attr_showcomm" value="@{comm}" disabled="disabled"></div>
							<div class="sheet-col-1-8 sheet-padl" title="Enter any additional bonus' ie. from spells or equipment"><input type="number" name="attr_commMod" value="0"></div>
							<div class="sheet-col-1-8 sheet sheet-padl"><input class="sheet-center sheet-highlight" type="number" name="attr_commBonus" readonly="readonly"></div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-1-6 sheet-center">&nbsp;</div>
							<div class="sheet-col-1-3 sheet-core-stat-label">Survival</div>
							<div class="sheet-col-1-8"><input type="number" name="attr_showsurv" value="@{surv}" disabled="disabled"></div>
							<div class="sheet-col-1-8 sheet-padl" title="Enter any additional bonus' ie. from spells or equipment"><input type="number" name="attr_survMod" value="0"></div>
							<div class="sheet-col-1-8 sheet sheet-padl"><input class="sheet-center sheet-highlight" type="number" name="attr_survBonus" readonly="readonly"></div>
						</div>					
						<div class="sheet-row">
							<div class="sheet-col-1-6 sheet-center">&nbsp;</div>
							<div class="sheet-col-1-3 sheet-core-stat-label">Crafting</div>
							<div class="sheet-col-1-8"><input type="number" name="attr_showcraf" value="@{craf}" disabled="disabled"></div>
							<div class="sheet-col-1-8 sheet-padl" title="Enter any additional bonus' ie. from spells or equipment"><input type="number" name="attr_crafMod" value="0"></div>
							<div class="sheet-col-1-8 sheet sheet-padl"><input class="sheet-center sheet-highlight" type="number" name="attr_crafBonus" readonly="readonly"></div>
						</div>
						<div class="sheet-col-1-1 sheet-center">&nbsp;</div>
					</div>
				</div>
			</div>	
			<!-- Misc -->	
			<div class="sheet-col-1-1">							
				<h3 class="sheet-center">Character Details</h3>
				<div class="sheet-row sheet-sub-header">
					<div class="sheet-col-1-3 sheet-center sheet-padl">Special Items and Abilities</div>
					<div class="sheet-col-1-3 sheet-center sheet-padl">Tasks, Deeds & Events</div>
					<div class="sheet-col-1-3 sheet-center sheet-padl sheet-padr">Appearance, Scars & Phobias</div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-3 sheet-padl"><textarea name="attr_charSpecial"></textarea></div>
					<div class="sheet-col-1-3 sheet-padl"><textarea name="attr_charDeeds"></textarea></div>
					<div class="sheet-col-1-3 sheet-padl sheet-padr"><textarea name="attr_charScars"></textarea></div>
				</div>			
			</div>		
		</div>
		<!--END CORE SHEET-->
		<!-- COMBAT SECTION -->
		<div class="sheet-section-combat">
			<h3 class="sheet-center">Combat</h3>
			<!-- ARMOR -->		
			<div class="sheet-row">
				<div class="sheet-col-1">
					<div class="sheet-row sheet-padb">
						<input type="hidden" name="attr_armorLoadTotal" readonly="readonly"/>
						<input type="hidden" name="attr_meleeLoadTotal" readonly="readonly"/>
						<input type="hidden" name="attr_rangedLoadTotal" readonly="readonly"/>
						<input type="hidden" name="attr_dexPenalty" readonly="readonly"/>
						<div class="sheet-col-1-16 sheet-right sheet-large-label">&nbsp;</div>
						<div class="sheet-col-1-10 sheet-large-label sheet-center" title="Base Attack Bonus"><input class="sheet-center sheet-highlight" type="number" name="attr_showATK" value="@{ATK}" disabled="disabled"><br/>Base Attack Bonus</div>
						<div class="sheet-col-1-10 sheet-large-label sheet-center" title="Base Damage Bonus"><input class="sheet-center sheet-highlight" type="number" name="attr_showDAM" value="@{DAM}" disabled="disabled"><br/>Base Damage Bonus</div>
						<div class="sheet-col-1-10 sheet-large-label sheet-center" title="Number of Attacks"><input class="sheet-center sheet-highlight" type="number" name="attr_shownumATK" value="@{numATK}" disabled="disabled"><br/># Attacks</div>
						<div class="sheet-col-1-16 sheet-right sheet-large-label">&nbsp;</div>
						<div class="sheet-col-1-10 sheet-large-label sheet-center"><input class="sheet-highlight sheet-center" type="number" name="attr_acCalc" readonly="readonly"><br/>AC (worn armor)</div>	
						<div class="sheet-col-1-6 sheet-large-label sheet-center"><input class="sheet-highlight sheet-center" type="text" name="attr_dexPenaltyText" readonly="readonly"><br/>Dexerity Penalty</div>
						<div class="sheet-col-1-10 sheet-large-label sheet-center"><input class="sheet-highlight sheet-center" type="number" name="attr_armorSpeedTotal" readonly="readonly"><br/>Total Speed Reduction</div>
						<div class="sheet-col-1-16 sheet-right sheet-large-label">&nbsp;</div>
						<div class="sheet-col-1-10 sheet-large-label sheet-center"><input class="sheet-highlight sheet-center" type="number" name="attr_combatEncumbranceTotal" value="@{combatLoadTotal}" disabled="disabled"><br/>Combat Load</div>
					</div>
					<h4 class="sheet-center">Armor</h4>
					<p class="sheet-small-note">Add any equipment, effects or items here that give a benefit to your Armor Class (AC).  This includes Armor, shields and any magical items or spells. 
					<br/> Use the checkboxes to indicate whether each row is is worn/equipped and update AC.  If you have another feature that also modifies your AC then add that here too.</p>
					<div class="sheet-row">					
						<div class="sheet-col-1">				
							<div class="sheet-row sheet-sub-header">
								<div class="sheet-col-1-11 sheet-center sheet-vert-bottom">Carried?</div>							
								<div class="sheet-col-1-11 sheet-center sheet-vert-bottom">Worn?</div>
								<div class="sheet-col-1-3 sheet-padl sheet-center sheet-vert-bottom">Name</div>
								<div class="sheet-col-1-7 sheet-padl sheet-center sheet-vert-bottom">Type</div>					
								<div class="sheet-col-1-11 sheet-padl sheet-center sheet-vert-bottom">AC</div>
							</div>
							<!-- BEGIN ARMOR repeating rows -->
							<fieldset class="repeating_armor">
								<div class="sheet-margin-bottom sheet-padr sheet-padl">
									<div class="sheet-col-1 sheet-padb"></div>
									<div class="sheet-row">
										<div class="sheet-col-1-11 sheet-vert-middle sheet-checkbox-row"><input type="checkbox" name="attr_armorCarried" checked /></div>
										<div class="sheet-col-1-11 sheet-vert-middle sheet-checkbox-row"><input type="checkbox" name="attr_armorActive"/></div>
										<div class="sheet-col-1-3 sheet-padl"><input type="text" name="attr_armorName"></div>
										<div class="sheet-col-1-7 sheet-padl"><select name="attr_armorType">
												<option value="s_buckler">Buckler</option>
												<option value="s_small">small Shield</option>
												<option value="s_woodsmall">Wood Shield</option>
												<option value="s_large">Large Shield</option>
												<option value="s_tower">Tower Shield</option>
												<option value="padded">Padded</option>
												<option value="leather">Leather</option>
												<option value="st_leather">Studded Leather</option>
												<option value="scale">Scale Mail</option>
												<option value="splint">Splint Mail</option>	
												<option value="chain">Chain Mail</option>
												<option value="banded">Banded Mail</option>
												<option value="halfplate">Half Plate</option>
												<option value="fullplate">Full Plate</option>
												<option value="other">item or other</option>										
											</select>
										</div>
										<input type="hidden" name="attr_armorDexPen" readonly="readonly"/>
										<input type="hidden" name="attr_armorEncumbrance" readonly="readonly"/>
										<div class="sheet-col-1-12 sheet-padl"><input class="sheet-center sheet-highlight" type="number" name="attr_armorTotalAc" value="@{armorAcBase} + @{armorMagicBonus}" disabled="disabled"></div>
										<input type="checkbox" name="attr_armorButton" class="sheet-spelltypetab sheet-spelltypeDescription" value="1"/>
										<span class="sheet-col-1-14 sheet-spelltypetab sheet-spelltypeDescription">Details</span>
										<div class="sheet-spell-type-Description">
											<div class="sheet-row">
												<div class="sheet-col-1-14 sheet-padl sheet-center sheet-vert-bottom">Base AC</div>
												<div class="sheet-col-1-11 sheet-padl sheet-center sheet-vert-bottom">Modifier</div>
												<div class="sheet-col-1-14 sheet-padl sheet-center sheet-vert-bottom">Speed</div>
												<div class="sheet-col-1-9 sheet-padl sheet-center sheet-vert-bottom">Durability</div>
												<div class="sheet-col-1-3 sheet-padl sheet-center sheet-vert-bottom">Notes</div>
											</div>
											<div class="sheet-row">
												<div class="sheet-col-1-14 sheet-padl"><input type="number" name="attr_armorAcBase" readonly="readonly"></div>
												<div class="sheet-col-1-12 sheet-padl"><input type="number" name="attr_armorMagicBonus" value="0" step="1"></div>
												<div class="sheet-col-1-14 sheet-padl"><input type="number" name="attr_armorSpeed" readonly="readonly"></div>
												<div class="sheet-col-1-9 sheet-padl" title="Armour Durability">
													<select name="attr_armordurable">
														<option value="1">1-Poor</option>
														<option value="2">2-Worn</option>
														<option value="3" selected="selected">3-Good</option>
														<option value="4">4-Excellent</option>
														<option value="5">5-Superior</option>										
													</select>
												</div>
												<div class="sheet-col-1-2 sheet-padl sheet-large-label sheet-center"><textarea class="sheet-fluid" name="attr_armorNotes"></textarea></div>
											</div>
										</div>
									</div>	
								</div>	
							</fieldset>
						</div>
					</div>
				</div>
			</div>		
			<!-- END ARMOUR -->
			<!-- BEGIN WEAPON SECTION -->
			<div class="sheet-row">	
				<div class="sheet-col-1">
					<h4 class="sheet-center">Melee Weapons</h4>
				</div>	
					<div class="sheet-row sheet-sub-header">
						<div class="sheet-col-1-11 sheet-center sheet-vert-bottom">Carried?</div>
						<div class="sheet-col-1-14 sheet-padl sheet-center sheet-vert-bottom">Number</div>
						<div class="sheet-col-1-3 sheet-padl sheet-center sheet-vert-bottom">Weapon</div>	
						<div class="sheet-col-1-14 sheet-padl sheet-center sheet-vert-bottom">To Hit Bonus</div>
						<div class="sheet-col-1-14 sheet-padl sheet-center sheet-vert-bottom">Base Damage</div>
						<div class="sheet-col-1-14 sheet-padl sheet-center sheet-vert-bottom">Dmg Bonus</div>
					</div>
					<!-- BEGIN MELEE weapon repeating row -->	
					<fieldset class="repeating_meleeweapon">
					<div class="sheet-margin-bottom sheet-padr sheet-padl">
							<div class="sheet-col-1 sheet-padb"></div>
							<div class="sheet-row">
								<div class="sheet-col-1-11 sheet-vert-middle sheet-checkbox-row"><input type="checkbox" name="attr_meleeEquip" checked /></div>
								<div class="sheet-col-1-14 sheet-padl"><input type="number" name="attr_meleeCount" min="1" value="1"></div>
								<div class="sheet-col-1-3 sheet-padl"><input type="text" name="attr_meleeWeaponName"></div>
								<div class="sheet-col-1-14 sheet-padl"><input class=" sheet-center sheet-highlight" type="number" name="attr_meleeToHit" readonly="readonly"></div>
								<div class="sheet-col-1-14 sheet-padl"><input class="sheet-center sheet-highlight" type="text" name="attr_meleeDam" readonly="readonly"></div>	
								<div class="sheet-col-1-14 sheet-padl"><input class="sheet-center sheet-highlight" type="number" name="attr_meleeDamBonus" readonly="readonly"></div>
								<input type="checkbox" name="attr_rangedButton" class="sheet-spelltypetab sheet-spelltypeDescription" value="1"/>
								<span class="sheet-col-1-14 sheet-spelltypetab sheet-spelltypeDescription">Details</span>
								<div class="sheet-spell-type-Description">
									<div class="sheet-row">
										<div class="sheet-col-1-12 sheet-padl sheet-center sheet-vert-bottom">Atk Mod</div>
										<div class="sheet-col-1-10 sheet-padl sheet-center sheet-vert-bottom">Magic Mod</div>
										<div class="sheet-col-1-12 sheet-padl sheet-center sheet-vert-bottom">Dmg Mod</div>
										<div class="sheet-col-1-7 sheet-padl sheet-center sheet-vert-bottom">Type</div>
										<div class="sheet-col-1-8 sheet-padl sheet-vert-bottom sheet-center sheet-padl">Durability</div>
										<div class="sheet-col-1-3 sheet-padl sheet-vert-bottom sheet-center">Notes</div>
									</div>	
									<div class="sheet-row">
										<div class="sheet-col-1-12 sheet-padl" title="The attack bonus will be added to the attack rolls."><input class="sheet-center" type="number" name="attr_meleeAtkMod" value="0"></div>
										<div class="sheet-col-1-10 sheet-padl" title="The magic bonus will be added to BOTH the attack and damage rolls."><input class="sheet-center" type="number" name="attr_meleeMagic" value="0"></div>
										<div class="sheet-col-1-12 sheet-padl" title="The damage bonus will be added to damage rolls."><input class="sheet-center" type="number" name="attr_meleeDamMod" value="0"></div>		
										<div class="sheet-col-1-7 sheet-padl" title="Small/light Weapons do 3 damage, Rogues can use DEXbonus to hit, heavy weapons do 4 damage and add STR bonus.">
										<select name="attr_meleeWeaponsize">
											<option value="small">Small</option>
											<option value="small-rogue">Small (Rogues)</option>
											<option value="light" selected="selected">Light</option>
											<option value="light-rogue">Light (Rogues)</option>
											<option value="heavy">Heavy</option>								
										</select>
										</div>
										<div class="sheet-col-1-8 sheet-padl" title="Weapon Durability">
											<select name="attr_weapondurable">
												<option value="1">1-Poor</option>
												<option value="2">2-Worn</option>
												<option value="3" selected="selected">3-Good</option>
												<option value="4">4-Excellent</option>
												<option value="5">5-Superior</option>										
											</select>
										</div>
										<div class="sheet-col-1-3 sheet-padl sheet-center"><textarea class="sheet-fluid" name="attr_meleeNotes"></textarea></div>	
									</div>	
								</div>
							</div>
						</div>
					</fieldset>
				</div>
			<div class="sheet-row">
				<div class="sheet-col-1">
					<h4 class="sheet-center">Ranged Weapons</h4>
				</div>
			</div>
			<div class="sheet-row sheet-sub-header">
				<div class="sheet-col-1-12 sheet-center sheet-vert-bottom sheet-padl">Carried?</div>
				<div class="sheet-col-1-12 sheet-center sheet-vert-bottom sheet-padl">Ammo</div>
				<div class="sheet-col-1-4 sheet-center sheet-vert-bottom sheet-padl">Weapon</div>	
				<div class="sheet-col-1-14 sheet-center sheet-vert-bottom sheet-padl">Max Range</div>
				<div class="sheet-col-1-12 sheet-center sheet-vert-bottom sheet-padl">To Hit Bonus</div>
				<div class="sheet-col-1-14 sheet-center sheet-vert-bottom sheet-padl">Base Dmg</div>
				<div class="sheet-col-1-14 sheet-center sheet-vert-bottom">Dmg Bonus</div>
			</div>
			<!-- BEGIN RANGED weapon repeating rows -->
			<fieldset class="repeating_rangedweapon">
				<div class="sheet-margin-bottom sheet-padr sheet-padl">
					<div class="sheet-col-1 sheet-padb"></div>
					<div class="sheet-row">
						<div class="sheet-col-1-12 sheet-vert-middle sheet-checkbox-row sheet-padl"><input type="checkbox" name="attr_rangedEquip" checked /></div>
						<div class="sheet-col-1-12 sheet-padl"><input class="sheet-center" type="number" name="attr_rangedAmmo" min="0" value="0" step="1"></div>
						<div class="sheet-col-1-4 sheet-padl"><input type="text" name="attr_rangedWeaponName"></div>
						<div class="sheet-col-1-14 sheet-padl" title="Maximum weapon range."><input class="sheet-center sheet-highlight" type="text" name="attr_rangedMax" readonly="readonly"></div>
						<div class="sheet-col-1-12 sheet-padl"><input class="sheet-center sheet-highlight" type="number" name="attr_rangedToHit" readonly="readonly"></div>
						<div class="sheet-col-1-14 sheet-padl"><input class="sheet-center sheet-highlight" type="text" name="attr_rangedDam" readonly="readonly"></div>
						<div class="sheet-col-1-14 sheet-padl"><input class="sheet-center sheet-highlight" type="number" name="attr_rangedDamBonus" readonly="readonly"></div>
						<input type="checkbox" name="attr_rangedButton" class="sheet-spelltypetab sheet-spelltypeDescription" value="1"/>
						<span class="sheet-col-1-14 sheet-spelltypetab sheet-spelltypeDescription">Details</span>
						<div class="sheet-spell-type-Description">
							<div class="sheet-row">
								<div class="sheet-col-1-12 sheet-padl sheet-center sheet-vert-bottom">Atk Mod</div>
								<div class="sheet-col-1-10 sheet-padl sheet-center sheet-vert-bottom">Magic Mod</div>
								<div class="sheet-col-1-12 sheet-padl sheet-center sheet-vert-bottom">Dmg Mod</div>
								<div class="sheet-col-1-14 sheet-center sheet-vert-bottom sheet-padl">Range</div>
								<div class="sheet-col-1-10 sheet-padl sheet-center sheet-vert-bottom">Type</div>
								<div class="sheet-col-1-10 sheet-padl sheet-vert-bottom sheet-center sheet-padl">Size</div>
								<div class="sheet-col-1-8 sheet-padl sheet-vert-bottom sheet-center sheet-padl">Durability</div>
								<div class="sheet-col-1-3 sheet-padl sheet-vert-bottom sheet-center">Notes</div>
							</div>	
							<div class="sheet-row">
								<div class="sheet-col-1-12 sheet-padl" title="The attack bonus will be added to the attack rolls."><input class="sheet-center" type="number" name="attr_rangedAtkMod" value="0"></div>
								<div class="sheet-col-1-10 sheet-padl" title="The magic bonus will be added to BOTH the attack and damage rolls."><input class="sheet-center" type="number" name="attr_rangedMagic" value="0"></div>
								<div class="sheet-col-1-12 sheet-padl" title="The damage bonus will be added to damage rolls."><input class="sheet-center" type="number" name="attr_rangedDamMod" value="0"></div>
								<div class="sheet-col-1-14 sheet-padl" title="Base weapon range."><input class="sheet-center" type="text" name="attr_rangedDistance" value="0"></div>
								<div class="sheet-col-1-10 sheet-padl" title="Select Thrown or Missile weapon">
									<select name="attr_rangedWeaponType">
										<option value="missile" selected="selected">Missile</option>
										<option value="thrown">Thrown</option>								
									</select>
								</div>		
								<div class="sheet-col-1-10 sheet-padl" title="Small/light Weapons do 3 damage, Rogues can use DEXbonus to hit, heavy weapons do 4 damage and add STR bonus.">
									<select name="attr_rangedWeaponsize">
										<option value="small">Small</option>
										<option value="small-rogue">Small (Rogues)</option>
										<option value="light" selected="selected">Light</option>
										<option value="light-rogue">Light (Rogues)</option>
										<option value="heavy">Heavy</option>			
									</select>
								</div>
								<div class="sheet-col-1-8 sheet-padl" title="Weapon Durability">
									<select name="attr_weapondurable">
										<option value="1">1-Poor</option>
										<option value="2">2-Worn</option>
										<option value="3" selected="selected">3-Good</option>
										<option value="4">4-Excellent</option>
										<option value="5">5-Superior</option>										
									</select>
								</div>
								<div class="sheet-col-1-3 sheet-padl sheet-center"><textarea class="sheet-fluid" name="attr_rangedNotes"></textarea></div>	
							</div>	
						</div>
					</div>
				</div>
			</fieldset>
			<!-- END WEAPON SECTION -->
		</div>
		<!-- END COMBAT Section  -->
		<!-- INVENTORY -->
		<div class="sheet-section-inventory">
			<h3 class="sheet-center">Inventory</h3>
			<!-- start of containers -->
			<div class="sheet-row">
				<div class="sheet-col-1-2 sheet-padr">
				<h4 class="sheet-center">Packs, Bags and Large Items</h4>
					<input type="hidden" readonly="readonly" name="attr_containerLoadTotal">
					<fieldset class="repeating_containers">
					<!-- BEGIN Container repeating row -->	
						<div class="sheet-row">
							<div class="sheet-col-1-8 sheet-padl sheet-center sheet-vert-bottom">Carried?</div>
							<div class="sheet-col-1-3 sheet-padl sheet-center sheet-vert-bottom sheet-padl">Item/Container</div>
							<div class="sheet-col-1-8 sheet-padl sheet-center sheet-vert-bottom">Load</div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-1-8 sheet-padl sheet-vert-middle sheet-checkbox-row"><input type="checkbox" name="attr_containerEquip" checked /></div>
							<div class="sheet-col-1-3 sheet-padl sheet-center"><input type="text" name="attr_containerName"></div>
							<div class="sheet-col-1-8 sheet-padl sheet-center"><input type="number" value="0" min="0" name="attr_containerWeight"></div>
							<input type="checkbox" name="attr_containerShowContent" class="sheet-spelltypetab sheet-spelltypeDescription" value="1"/>
							<span class="sheet-col-1-14 sheet-spelltypetab sheet-spelltypeDescription">Contents</span>
							<div class="sheet-spell-type-Description">
								<div class="sheet-row">
									<div class="sheet-col-1-2 sheet-vert-bottom sheet-center">Contents</div>
									<div class="sheet-col-1-3 sheet-vert-bottom sheet-center">Notes</div>
								</div>
								<div class="sheet-row">
									<div class="sheet-col-1-2 sheet-center sheet-padl"><textarea class="sheet-medium" name="attr_containerContent"></textarea></div>
									<div class="sheet-col-1-2 sheet-center sheet-padl sheet-padr"><textarea class="sheet-medium" name="attr_containerNote"></textarea></div>
								</div>
							</div>
						</div>
					</fieldset>
				</div>
				<div class="sheet-col-1-2 sheet-padr">
					<h4 class="sheet-center">Encumbrance</h4>
					<div class="sheet-row sheet-center">
						<div class="sheet-col-1-6 sheet-centre"><input class="sheet-centre sheet-highlight" type="number" name="attr_showencumbrance" value="@{encumbrance}" disabled="disabled"><span>Can Carry</span></input></div>
						<div class="sheet-col-1-6 sheet-centre"><input class="sheet-center sheet-highlight" type="number" name="attr_itemEncumbranceTotal" value="@{itemLoadTotal}" disabled="disabled"/><span>Items</span></div>
						<div class="sheet-col-1-6 sheet-centre"><input class="sheet-center sheet-highlight" type="number" disabled="disabled" name="attr_show_combatEncumbrance" value="@{combatLoadTotal}"/><span>Combat</span></div>
						<div class="sheet-col-1-6 sheet-centre"><input class="sheet-center sheet-highlight" type="number" name="attr_coinEncumbranceTotal" value="@{coinLoadTotal}" disabled="disabled"/><span>Coins</span></div>
						<div class="sheet-col-1-6 sheet-centre">
							<input type="hidden" class="enccheck" value="0" name="attr_enc_exceeded"/>
							<input class="sheet-centre sheet-highlight sheet-redbox" type="number" disabled="disabled" name="attr_showCurrentEncumbrance" value="@{currentEncumbrance}"/><span>Total Load</span>
						</div>
					</div>
					<div class="sheet-row sheet-padb">&nbsp;</div>
					<h4 class="sheet-center">Consumables</h4>
					<div class="sheet-row sheet-center">	
						<div class="sheet-col-1-6 sheet-center"><input type="number" value="0" min="0" name="attr_itemCount">Water</div>
						<div class="sheet-col-1-6 sheet-center"><input type="number" value="0" min="0" name="attr_itemCount2">Field Rations</div>
						<div class="sheet-col-1-6 sheet-center"><input type="number" value="0" min="0" name="attr_itemCount3">Bulk Rations</div>
						<div class="sheet-col-1-6 sheet-center"><input type="number" value="0" min="0" name="attr_itemCount4">Torches</div>
					    <div class="sheet-col-1-6 sheet-center"><input type="number" value="0" min="0" name="attr_itemCount5">Potions & Flasks</div>	
					</div>
					<div class="sheet-row sheet-padb">&nbsp;</div>
					<h4 class="sheet-center">Money</h4>
					<div class="sheet-row sheet-center">				
						<div class="sheet-col-1-6 sheet-center" title="Copper Pieces"><input type="number" name="attr_CP" value="0" min="0" step="1">Copper</div>
						<div class="sheet-col-1-6 sheet-center" title="Silver Pieces"><input type="number" name="attr_SP" value="0" min="0" step="1">Silver</div>
						<div class="sheet-col-1-6 sheet-center" title="Gold Pieces"><input type="number" name="attr_GP" value="0" min="0" step="1">Gold</div>
						<div class="sheet-col-1-6 sheet-center" title="Platinum Pieces"><input type="number" name="attr_PP" value="0" min="0" step="1">Platinum</div>
						<div class="sheet-col-1-4 sheet-center" title="Total (in Silver Pieces)"><input class="sheet-center sheet-highlight" type="number" name="attr_moneyTotalGp" value="(@{CP} / 10) + (@{SP}) + (@{GP} * 10) + (@{PP} * 100)" disabled="disabled">Total Silver</div>
					</div>	
				</div>
			</div>
			<!-- end of containers -->
			<div class="sheet-row sheet-padb">&nbsp;</div>
			<div class="sheet-row">
				<div class="sheet-col-1">
					<h4 class="sheet-center">Small and Miscellaneous Items</h4>
				</div>
			</div>
			<div class="sheet-col-1-1">
				<fieldset class="repeating_items">
					<div class="sheet-margin-bottom sheet-padr sheet-padl">
						<div class="sheet-col-1 sheet-padb"></div>
						<div class="sheet-row sheet-center">
							<div class="sheet-col-1-8 sheet-center">Item</div>
							<div class="sheet-col-1-17 sheet-center">Amount</div>
							<div class="sheet-col-1-8 sheet-center">Location</div>
							<div class="sheet-col-1-8 sheet-padl sheet-center">Item</div>
							<div class="sheet-col-1-17 sheet-center">Amount</div>
							<div class="sheet-col-1-8 sheet-center">Location</div>
							<div class="sheet-col-1-8 sheet-padl sheet-center">Item</div>
							<div class="sheet-col-1-17 sheet-center">Amount</div>
							<div class="sheet-col-1-8 sheet-center">Location</div>
						</div>	
						<div class="sheet-row sheet-center">
							<div class="sheet-col-1-8 sheet-center"><input type="text" name="attr_itemName"></div>
							<div class="sheet-col-1-17 sheet-center"><input type="number" value="0" min="0" name="attr_itemCount"></div>
							<div class="sheet-col-1-8 sheet-center"><input type="text" name="attr_itemLocation"></div>
							<div class="sheet-col-1-8 sheet-padl sheet-center"><input type="text" name="attr_itemName2"></div>
							<div class="sheet-col-1-17 sheet-center"><input type="number" value="0" min="0" name="attr_itemCount2"></div>
							<div class="sheet-col-1-8 sheet-center"><input type="text" name="attr_itemLocation2"></div>
							<div class="sheet-col-1-8  sheet-padl sheet-center"><input type="text" name="attr_itemName3"></div>
							<div class="sheet-col-1-17 sheet-center"><input type="number" value="0" min="0" name="attr_itemCount3"></div>
							<div class="sheet-col-1-8 sheet-center"><input type="text" name="attr_itemLocation3"></div>
						</div>
					</div>	
				</fieldset>
			</div>
		</div>
		<!-- END INVENTORY -->
		<!-- START NOTES -->
		<div class="sheet-section-notes">
			<div class="sheet-col-1-1">							
				<h3 class="sheet-center">Notes</h3>
				<div class="sheet-row">
					<div class="sheet-col-1-3 sheet-padl"><textarea name="attr_miscNotes"></textarea></div>
					<div class="sheet-col-1-3 sheet-padl"><textarea name="attr_miscNotes2"></textarea></div>
					<div class="sheet-col-1-3 sheet-padl"><textarea name="attr_miscNotes3"></textarea></div>
				</div>			
			</div>	
			<!-- BEGIN Companions section -->				
			<div class="sheet-row">
				<div class="sheet-col-1">
					<h3 class="sheet-center">Henchmen, Hirelings and Companions</h3> 
				</div>
					<div class="sheet-margin-bottom sheet-padr sheet-padl">
						<div class="sheet-row sheet-sub-header">
							<div class="sheet-col-1-17 sheet-vert-bottom sheet-padl sheet-center">Dead?</div>
							<div class="sheet-col-1-6 sheet-vert-bottom sheet-center">Name</div>
							<div class="sheet-col-1-12 sheet-vert-bottom sheet-center">Max HP</div>
							<div class="sheet-col-1-12 sheet-vert-bottom sheet-center">Damage</div>
							<div class="sheet-col-1-16 sheet-vert-bottom sheet-center">AC</div>
							<div class="sheet-col-1-12 sheet-vert-bottom sheet-center">Attack Bonus</div>
							<div class="sheet-col-1-12 sheet-vert-bottom sheet-center">Attack Dmg</div>
							<div class="sheet-col-1-16 sheet-vert-bottom sheet-center">Ammo</div>
							<div class="sheet-col-1-12 sheet-vert-bottom sheet-center">Morale</div>
						</div>
					<!-- BEGIN companion row -->
					<fieldset class="repeating_companionList">
						<div class="sheet-margin-bottom sheet-padr sheet-padl">
							<div class="sheet-col-1 sheet-padb"></div>
							<div class="sheet-row">
								<div class="sheet-col-1-17 sheet-vert-middle sheet-checkbox-row"><input type="checkbox" name="attr_companionDead"/></div>
								<div class="sheet-col-1-6 sheet-vert-middle"><input type="text" class="sheet-center" name="attr_companionName"></div>
								<div class="sheet-col-1-12 sheet-vert-middle sheet-padl"><input type="number" class="sheet-center" name="attr_companionMaxHP" value="0"></div>
								<div class="sheet-col-1-12 sheet-vert-middle"><input type="number" class="sheet-center" name="attr_companionDamage" value="0"></div>
								<div class="sheet-col-1-16 sheet-vert-middle sheet-padl"><input type="number" class="sheet-center" name="attr_companionAC" value="10"></div>
								<div class="sheet-col-1-12 sheet-vert-middle sheet-padl"><input type="number" class="sheet-center" name="attr_companionTohit" value="0"></div>
								<div class="sheet-col-1-12 sheet-vert-middle"><input type="number" class="sheet-center" name="attr_companionAttackDamage" value="0"></div>
								<div class="sheet-col-1-16 sheet-vert-middle sheet-padl"><input type="number" class="sheet-center" name="attr_companionAmmo" value="0"></div>
								<div class="sheet-col-1-12 sheet-vert-middle sheet-padl"><input type="number" class="sheet-center" name="attr_companionMorale" value="0" min="-10" max="10"></div> 
								<input type="checkbox" name="attr_companionButton" class="sheet-spelltypetab sheet-spelltypeDescription" value="1"/>
								<span class="sheet-col-1-14 sheet-spelltypetab sheet-spelltypeDescription">Notes</span>
								<div class="sheet-spell-type-Description">
									<div class="sheet-row">
										<div class="sheet-col-1-3 sheet-vert-bottom sheet-center">Companion Notes</div>
										<div class="sheet-col-1-3 sheet-vert-bottom sheet-center sheet-padl">Companion Inventory</div>		
										<div class="sheet-row">
											<div class="sheet-col-1-3 sheet-center sheet-padl"><textarea class="sheet-medium" name="attr_companionNotes"></textarea></div>
											<div class="sheet-col-1-3 sheet-center sheet-padl"><textarea class="sheet-medium" name="attr_companionInventory"></textarea></div>	
											<div class="sheet-col-1-3 sheet-center">
												<div class="sheet-row">
													<div class="sheet-col-1-3 sheet-vert-bottom sheet-center">Load</div>
													<div class="sheet-col-1-3 sheet-vert-bottom sheet-center sheet-padl">Silver Owed</div>
												</div>	
												<div class="sheet-row">
													<div class="sheet-col-1-3 sheet-vert-middle"><input type="number" class="sheet-center" name="attr_companionWeight" value="1"></div>
													<div class="sheet-col-1-3 sheet-vert-middle sheet-padl"><input type="number" class="sheet-center" name="attr_companionOwed" value="1"></div>
												</div>
												<div class="sheet-row">
													<div class="sheet-col-1-3 sheet-vert-bottom sheet-center">Rations</div>
													<div class="sheet-col-1-3 sheet-vert-bottom sheet-center sheet-padl">Torches/Oil</div>
												</div>
												<div class="sheet-row">
													<div class="sheet-col-1-3 sheet-vert-middle"><input type="number" class="sheet-center" name="attr_companionRations" value="0"></div>
													<div class="sheet-col-1-3 sheet-vert-middle sheet-padl"><input type="number" class="sheet-center" name="attr_companionLights" value="0"></div>
												</div>
											</div>	
										</div>
									</div>
								</div>
							</div>	
						</div>
					</fieldset>
				</div>	
			</div>
			<!--END Companions -->
			<div class="sheet-row">
				<div class="sheet-col-1">
					<h3 class="sheet-center">Other Inventory</h3>
				</div>
			</div>	
				<div class="sheet-row sheet-sub-header">
					<div class="sheet-col-1-3 sheet-center sheet-inspiration-label">Equipment</div>
					<div class="sheet-col-1-3 sheet-center sheet-inspiration-label">Treasure</div>
					<div class="sheet-col-1-3 sheet-center sheet-inspiration-label">Other</div>
				</div>
			<div class="sheet-row">
				<div class="sheet-col-1-3 sheet-padl"><textarea class="sheet-medium" name="attr_Equipment"></textarea></div>
				<div class="sheet-col-1-3 sheet-padl"><textarea class="sheet-medium" name="attr_Treasure"></textarea></div>
				<div class="sheet-col-1-3 sheet-padl"><textarea class="sheet-medium" name="attr_Other"></textarea></div>
			</div>		
			<h4 class="sheet-center">Stuff Not Carried</h4>
			<div class="sheet-col-1-1">
				<div class="sheet-row sheet-sub-header">
					<div class="sheet-col-1-3 sheet-center sheet-inspiration-label">Equipment</div>
					<div class="sheet-col-1-3 sheet-center sheet-inspiration-label">Treasure</div>
					<div class="sheet-col-1-3 sheet-center sheet-inspiration-label">Other</div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-3 sheet-padl"><textarea class="sheet-medium" name="attr_Equipment2"></textarea></div>
					<div class="sheet-col-1-3 sheet-padl"><textarea class="sheet-medium" name="attr_Treasure2"></textarea></div>
					<div class="sheet-col-1-3 sheet-padl"><textarea class="sheet-medium" name="attr_Other2"></textarea></div>
				</div>
			</div>
		</div>
		<!--END NOTES -->
		<!-- START SPELLBOOK SECTION -->
		<div class="sheet-section-magic">
		<!-- Caster Spellbooks -->
			<div class="sheet-Caster">
				<h3 class="sheet-center">Spells</h3>
				<div class="sheet-row">
					<div class="sheet-col-1-2" title="Casting Text"><input class="sheet-center sheet-highlight sheet-vert-bottom" type="text" name="attr_castingText" readonly="readonly"></div>
					<div class="sheet-col-1-6">&nbsp;</div>
					<div class="sheet-col-1-13 sheet-padl sheet-center" title="Additional or temporary Spell Points"><input class="sheet-center" type="number" name="attr_extraSpellpoints" value="0" min="0"><span>Temp Points</span></div>
					<div class="sheet-col-1-13 sheet-padl sheet-center" title="Spell Fatigue"><input class="sheet-center" type="number" name="attr_fatigue" value="0" min="0"><span>Spell Fatigue</span></div>
					<div class="sheet-col-1-13 sheet-padl sheet-center" title="Spell Bonus"><input class="sheet-center sheet-highlight" type="number" name="attr_spellBonus" readonly="readonly"><span>Casting Bonus</span></div>
					<div class="sheet-col-1-13 sheet-padl sheet-center" title="Target's spell resistance"><input class="sheet-center sheet-highlight" type="number" name="attr_spellresist" value="({12} + @{level})" disabled="disabled"><span>DC to Resist</span></div>
				</div>
				<input type="radio" name="attr_spellpagetab" class="sheet-spellpagetab sheet-spelltab0" value="0" title="Level 0" checked="checked"/>
				<span class="sheet-spellpagetab sheet-spelltab0">Level 0</span>		
				<input type="radio" name="attr_spellpagetab" class="sheet-spellpagetab sheet-spelltab1" value="1" title="Level 1"/>
				<span class="sheet-spellpagetab sheet-spelltab1">Level 1</span>
				<input type="radio" name="attr_spellpagetab" class="sheet-spellpagetab sheet-spelltab2" value="2" title="Level 2"/>
				<span class="sheet-spellpagetab sheet-spelltab2">Level 2</span>
				<input type="radio" name="attr_spellpagetab" class="sheet-spellpagetab sheet-spelltab3" value="3" title="Level 3"/>
				<span class="sheet-spellpagetab sheet-spelltab3">Level 3</span>
				<input type="radio" name="attr_spellpagetab" class="sheet-spellpagetab sheet-spelltab4" value="4" title="Level 4"/>
				<span class="sheet-spellpagetab sheet-spelltab4">Level 4</span>
				<input type="radio" name="attr_spellpagetab" class="sheet-spellpagetab sheet-spelltab5" value="5" title="Level 5"/>
				<span class="sheet-spellpagetab sheet-spelltab5">Level 5</span>
				<input type="radio" name="attr_spellpagetab" class="sheet-spellpagetab sheet-spelltab6" value="6" title="Level 6"/>
				<span class="sheet-spellpagetab sheet-spelltab6">Level 6</span>
				<input type="radio" name="attr_spellpagetab" class="sheet-spellpagetab sheet-spelltab99" value="99" title="Show All"/>
				<span class="sheet-spellpagetab sheet-spelltab99">Show All</span>
				<span class="sheet-spacer"></span>
				<!-- BEGIN SPELL PAGES -->
				<!-- BEGIN new spell page -->
				<div class="sheet-spell-page0">			
					<div class="sheet-row sheet-spell-header">
						<div class="sheet-col-1 sheet-vert-bottom sheet-center sheet-large-label">Cantrips (Level 0)</div>
					</div>
				<!-- BEGIN spellbook 0 row -->	
					<fieldset class="repeating_spellbooklevel0">
						<div class="sheet-margin-bottom sheet-padr sheet-padl">
							<div class="sheet-row">
								<div class="sheet-col-1-3 sheet-vert-bottom sheet-center sheet-large-label">Spell name</div>
								<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-large-label">Range</div>
								<div class="sheet-col-1-7 sheet-vert-bottom sheet-center sheet-large-label">Duration</div>
								<div class="sheet-col-1-7 sheet-vert-bottom sheet-center sheet-large-label">Cost</div>
							</div>
							<div class="sheet-row">
								<input type="hidden" name="attr_spellBaseLevel" value="0">
								<input type="hidden" name="attr_spellFriendlyLevel" value="Level 0">
								<div class="sheet-col-1-3 sheet-vert-middle sheet-padl"><input type="text" class=" sheet-center" name="attr_spellName"></div>
								<div class="sheet-col-1-7 sheet-vert-middle sheet-padl"><input type="text" class="sheet-center" name="attr_spellRange"></div>
								<div class="sheet-col-1-7 sheet-vert-middle sheet-padl"><input type="text" class="sheet-center" name="attr_spellDuration"></div>
								<div class="sheet-col-1-9 sheet-vert-middle sheet-padl"><input type="number" class="sheet-center" name="attr_spellcost" value="1"></div>
								<input type="checkbox" name="attr_spellTypeDescription" class="sheet-spelltypetab sheet-spelltypeDescription" value="1"/>
								<span class="sheet-col-1-9 sheet-spelltypetab sheet-spelltypeDescription">Description</span>
								<div class="sheet-spell-type-Description">
									<div class="sheet-row">
										<div class="sheet-col-1-2 sheet-vert-bottom sheet-center sheet-large-label sheet-padl">Description</div>
										<div class="sheet-col-1-2 sheet-vert-bottom sheet-center sheet-large-label sheet-padl">Notes</div>
									</div>
									<div class="sheet-row">
										<div class="sheet-col-1-2 sheet-large-label sheet-center sheet-padl"><textarea class="sheet-medium" name="attr_spellDescription"></textarea></div>
										<div class="sheet-col-1-2 sheet-large-label sheet-center sheet-padl"><textarea class="sheet-medium" name="attr_spellNotes"></textarea></div>
									</div>
								</div>
							</div>
						</div>
					<!-- END spellbook 0 row -->	
					</fieldset>
				</div>
				<!-- END spell page -->	
				<!-- BEGIN new spell page -->
				<div class="sheet-spell-page1">			
					<div class="sheet-row sheet-spell-header">
						<div class="sheet-col-1 sheet-vert-bottom sheet-center sheet-large-label">First Level</div>
					</div>
				<!-- BEGIN spellbook 1 row -->	
					<fieldset class="repeating_spellbooklevel1">
						<div class="sheet-margin-bottom sheet-padr sheet-padl">
							<div class="sheet-row">
								<div class="sheet-col-1-3 sheet-vert-bottom sheet-center sheet-large-label">Spell name</div>
								<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-large-label">Range</div>
								<div class="sheet-col-1-7 sheet-vert-bottom sheet-center sheet-large-label">Duration</div>
								<div class="sheet-col-1-7 sheet-vert-bottom sheet-center sheet-large-label">Cost</div>
							</div>
							<div class="sheet-row">
								<input type="hidden" name="attr_spellBaseLevel" value="1">
								<input type="hidden" name="attr_spellFriendlyLevel" value="Level 1">
								<div class="sheet-col-1-3 sheet-vert-middle sheet-padl"><input type="text" class=" sheet-center" name="attr_spellName"></div>
								<div class="sheet-col-1-7 sheet-vert-middle sheet-padl"><input type="text" class="sheet-center" name="attr_spellRange"></div>
								<div class="sheet-col-1-7 sheet-vert-middle sheet-padl"><input type="text" class="sheet-center" name="attr_spellDuration"></div>
								<div class="sheet-col-1-9 sheet-vert-middle sheet-padl"><input type="number" class="sheet-center" name="attr_spellcost" value="3"></div>
								<input type="checkbox" name="attr_spellTypeDescription" class="sheet-spelltypetab sheet-spelltypeDescription" value="1"/>
								<span class="sheet-col-1-9 sheet-spelltypetab sheet-spelltypeDescription">Description</span>
								<div class="sheet-spell-type-Description">
									<div class="sheet-row">
										<div class="sheet-col-1-2 sheet-vert-bottom sheet-center sheet-large-label sheet-padl">Description</div>
										<div class="sheet-col-1-2 sheet-vert-bottom sheet-center sheet-large-label sheet-padl">Notes</div>
									</div>
									<div class="sheet-row">
										<div class="sheet-col-1-2 sheet-large-label sheet-center sheet-padl"><textarea class="sheet-medium" name="attr_spellDescription"></textarea></div>
										<div class="sheet-col-1-2 sheet-large-label sheet-center sheet-padl"><textarea class="sheet-medium" name="attr_spellNotes"></textarea></div>
									</div>
								</div>
							</div>	
						</div>
					<!-- END spellbook 1 row -->	
					</fieldset>
				</div>
				<!-- END spell page -->
				<!-- BEGIN new spell page -->
				<div class="sheet-spell-page2">			
					<div class="sheet-row sheet-spell-header">
						<div class="sheet-col-1 sheet-vert-bottom sheet-center sheet-large-label">Second Level</div>
					</div>
				<!-- BEGIN spellbook 2 row -->	
					<fieldset class="repeating_spellbooklevel2">
						<div class="sheet-margin-bottom sheet-padr sheet-padl">
							<div class="sheet-row">
								<div class="sheet-col-1-3 sheet-vert-bottom sheet-center sheet-large-label">Spell name</div>
								<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-large-label">Range</div>
								<div class="sheet-col-1-7 sheet-vert-bottom sheet-center sheet-large-label">Duration</div>
								<div class="sheet-col-1-7 sheet-vert-bottom sheet-center sheet-large-label">Cost</div>
							</div>
							<div class="sheet-row">
								<input type="hidden" name="attr_spellBaseLevel" value="2">
								<input type="hidden" name="attr_spellFriendlyLevel" value="Level 2">
								<div class="sheet-col-1-3 sheet-vert-middle sheet-padl"><input type="text" class=" sheet-center" name="attr_spellName"></div>
								<div class="sheet-col-1-7 sheet-vert-middle sheet-padl"><input type="text" class="sheet-center" name="attr_spellRange"></div>
								<div class="sheet-col-1-7 sheet-vert-middle sheet-padl"><input type="text" class="sheet-center" name="attr_spellDuration"></div>
								<div class="sheet-col-1-9 sheet-vert-middle sheet-padl"><input type="number" class="sheet-center" name="attr_spellcost" value="5"></div>
								<input type="checkbox" name="attr_spellTypeDescription" class="sheet-spelltypetab sheet-spelltypeDescription" value="1"/>
								<span class="sheet-col-1-9 sheet-spelltypetab sheet-spelltypeDescription">Description</span>
								<div class="sheet-spell-type-Description">
									<div class="sheet-row">
										<div class="sheet-col-1-2 sheet-vert-bottom sheet-center sheet-large-label sheet-padl">Description</div>
										<div class="sheet-col-1-2 sheet-vert-bottom sheet-center sheet-large-label sheet-padl">Notes</div>
									</div>
									<div class="sheet-row">
										<div class="sheet-col-1-2 sheet-large-label sheet-center sheet-padl"><textarea class="sheet-medium" name="attr_spellDescription"></textarea></div>
										<div class="sheet-col-1-2 sheet-large-label sheet-center sheet-padl"><textarea class="sheet-medium" name="attr_spellNotes"></textarea></div>
									</div>
								</div>
							</div>
						</div>
					<!-- END spellbook 2 row -->	
					</fieldset>
				</div>
				<!-- END spell page -->
				<!-- BEGIN new spell page -->
				<div class="sheet-spell-page3">			
					<div class="sheet-row sheet-spell-header">
						<div class="sheet-col-1 sheet-vert-bottom sheet-center sheet-large-label">Third Level</div>
					</div>
				<!-- BEGIN spellbook 3 row -->	
					<fieldset class="repeating_spellbooklevel3">
						<div class="sheet-margin-bottom sheet-padr sheet-padl">
							<div class="sheet-row">
								<div class="sheet-col-1-3 sheet-vert-bottom sheet-center sheet-large-label">Spell name</div>
								<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-large-label">Range</div>
								<div class="sheet-col-1-7 sheet-vert-bottom sheet-center sheet-large-label">Duration</div>
								<div class="sheet-col-1-7 sheet-vert-bottom sheet-center sheet-large-label">Cost</div>
							</div>
							<div class="sheet-row">
								<input type="hidden" name="attr_spellBaseLevel" value="3">
								<input type="hidden" name="attr_spellFriendlyLevel" value="Level 3">
								<div class="sheet-col-1-3 sheet-vert-middle sheet-padl"><input type="text" class=" sheet-center" name="attr_spellName"></div>
								<div class="sheet-col-1-7 sheet-vert-middle sheet-padl"><input type="text" class="sheet-center" name="attr_spellRange"></div>
								<div class="sheet-col-1-7 sheet-vert-middle sheet-padl"><input type="text" class="sheet-center" name="attr_spellDuration"></div>
								<div class="sheet-col-1-9 sheet-vert-middle sheet-padl"><input type="number" class="sheet-center" name="attr_spellcost" value="7"></div>
								<input type="checkbox" name="attr_spellTypeDescription" class="sheet-spelltypetab sheet-spelltypeDescription" value="1"/>
								<span class="sheet-col-1-9 sheet-spelltypetab sheet-spelltypeDescription">Description</span>
								<div class="sheet-spell-type-Description">
									<div class="sheet-row">
										<div class="sheet-col-1-2 sheet-vert-bottom sheet-center sheet-large-label sheet-padl">Description</div>
										<div class="sheet-col-1-2 sheet-vert-bottom sheet-center sheet-large-label sheet-padl">Notes</div>
									</div>
									<div class="sheet-row">
										<div class="sheet-col-1-2 sheet-large-label sheet-center sheet-padl"><textarea class="sheet-medium" name="attr_spellDescription"></textarea></div>
										<div class="sheet-col-1-2 sheet-large-label sheet-center sheet-padl"><textarea class="sheet-medium" name="attr_spellNotes"></textarea></div>
									</div>
								</div>
							</div>
						</div>
					<!-- END spellbook 3 row -->	
					</fieldset>
				</div>
				<!-- END spell page -->
				<!-- BEGIN new spell page -->
				<div class="sheet-spell-page4">			
					<div class="sheet-row sheet-spell-header">
						<div class="sheet-col-1 sheet-vert-bottom sheet-center sheet-large-label">Fourth Level</div>
					</div>
				<!-- BEGIN spellbook 4 row -->	
					<fieldset class="repeating_spellbooklevel4">
						<div class="sheet-margin-bottom sheet-padr sheet-padl">
							<div class="sheet-row">
								<div class="sheet-col-1-3 sheet-vert-bottom sheet-center sheet-large-label">Spell name</div>
								<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-large-label">Range</div>
								<div class="sheet-col-1-7 sheet-vert-bottom sheet-center sheet-large-label">Duration</div>
								<div class="sheet-col-1-7 sheet-vert-bottom sheet-center sheet-large-label">Cost</div>
							</div>
							<div class="sheet-row">
								<input type="hidden" name="attr_spellBaseLevel" value="4">
								<input type="hidden" name="attr_spellFriendlyLevel" value="Level 4">
								<div class="sheet-col-1-3 sheet-vert-middle sheet-padl"><input type="text" class=" sheet-center" name="attr_spellName"></div>
								<div class="sheet-col-1-7 sheet-vert-middle sheet-padl"><input type="text" class="sheet-center" name="attr_spellRange"></div>
								<div class="sheet-col-1-7 sheet-vert-middle sheet-padl"><input type="text" class="sheet-center" name="attr_spellDuration"></div>
								<div class="sheet-col-1-9 sheet-vert-middle sheet-padl"><input type="number" class="sheet-center" name="attr_spellcost" value="9"></div>
								<input type="checkbox" name="attr_spellTypeDescription" class="sheet-spelltypetab sheet-spelltypeDescription" value="1"/>
								<span class="sheet-col-1-9 sheet-spelltypetab sheet-spelltypeDescription">Description</span>
								<div class="sheet-spell-type-Description">
									<div class="sheet-row">
										<div class="sheet-col-1-2 sheet-vert-bottom sheet-center sheet-large-label sheet-padl">Description</div>
										<div class="sheet-col-1-2 sheet-vert-bottom sheet-center sheet-large-label sheet-padl">Notes</div>
									</div>
									<div class="sheet-row">
										<div class="sheet-col-1-2 sheet-large-label sheet-center sheet-padl"><textarea class="sheet-medium" name="attr_spellDescription"></textarea></div>
										<div class="sheet-col-1-2 sheet-large-label sheet-center sheet-padl"><textarea class="sheet-medium" name="attr_spellNotes"></textarea></div>
									</div>
								</div>
							</div>
						</div>
					<!-- END spellbook 4 row -->	
					</fieldset>
				</div>
				<!-- END spell page -->
				<!-- BEGIN new spell page -->
				<div class="sheet-spell-page5">			
					<div class="sheet-row sheet-spell-header">
						<div class="sheet-col-1 sheet-vert-bottom sheet-center sheet-large-label">Fifth Level</div>
					</div>
				<!-- BEGIN spellbook 5 row -->	
					<fieldset class="repeating_spellbooklevel5">
						<div class="sheet-margin-bottom sheet-padr sheet-padl">
							<div class="sheet-row">
								<div class="sheet-col-1-3 sheet-vert-bottom sheet-center sheet-large-label">Spell name</div>
								<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-large-label">Range</div>
								<div class="sheet-col-1-7 sheet-vert-bottom sheet-center sheet-large-label">Duration</div>
								<div class="sheet-col-1-7 sheet-vert-bottom sheet-center sheet-large-label">Cost</div>
							</div>
							<div class="sheet-row">
								<input type="hidden" name="attr_spellBaseLevel" value="5">
								<input type="hidden" name="attr_spellFriendlyLevel" value="Level 5">
								<div class="sheet-col-1-3 sheet-vert-middle sheet-padl"><input type="text" class=" sheet-center" name="attr_spellName"></div>
								<div class="sheet-col-1-7 sheet-vert-middle sheet-padl"><input type="text" class="sheet-center" name="attr_spellRange"></div>
								<div class="sheet-col-1-7 sheet-vert-middle sheet-padl"><input type="text" class="sheet-center" name="attr_spellDuration"></div>
								<div class="sheet-col-1-9 sheet-vert-middle sheet-padl"><input type="number" class="sheet-center" name="attr_spellcost" value="11"></div>
								<input type="checkbox" name="attr_spellTypeDescription" class="sheet-spelltypetab sheet-spelltypeDescription" value="1"/>
								<span class="sheet-col-1-9 sheet-spelltypetab sheet-spelltypeDescription">Description</span>
								<div class="sheet-spell-type-Description">
									<div class="sheet-row">
										<div class="sheet-col-1-2 sheet-vert-bottom sheet-center sheet-large-label sheet-padl">Description</div>
										<div class="sheet-col-1-2 sheet-vert-bottom sheet-center sheet-large-label sheet-padl">Notes</div>
									</div>
									<div class="sheet-row">
										<div class="sheet-col-1-2 sheet-large-label sheet-center sheet-padl"><textarea class="sheet-medium" name="attr_spellDescription"></textarea></div>
										<div class="sheet-col-1-2 sheet-large-label sheet-center sheet-padl"><textarea class="sheet-medium" name="attr_spellNotes"></textarea></div>
									</div>
								</div>
							</div>
						</div>
					<!-- END spellbook 5 row -->	
					</fieldset>
				</div>
				<!-- END spell page -->
				<!-- BEGIN new spell page -->
				<div class="sheet-spell-page6">			
					<div class="sheet-row sheet-spell-header">
						<div class="sheet-col-1 sheet-vert-bottom sheet-center sheet-large-label">Sixth Level</div>
					</div>
				<!-- BEGIN spellbook 6 row -->	
					<fieldset class="repeating_spellbooklevel6">
						<div class="sheet-margin-bottom sheet-padr sheet-padl">
							<div class="sheet-row">
								<div class="sheet-col-1-3 sheet-vert-bottom sheet-center sheet-large-label">Spell name</div>
								<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-large-label">Range</div>
								<div class="sheet-col-1-7 sheet-vert-bottom sheet-center sheet-large-label">Duration</div>
								<div class="sheet-col-1-7 sheet-vert-bottom sheet-center sheet-large-label">Cost</div>
							</div>
							<div class="sheet-row">
								<input type="hidden" name="attr_spellBaseLevel" value="6">
								<input type="hidden" name="attr_spellFriendlyLevel" value="Level 6">
								<div class="sheet-col-1-3 sheet-vert-middle sheet-padl"><input type="text" class=" sheet-center" name="attr_spellName"></div>
								<div class="sheet-col-1-7 sheet-vert-middle sheet-padl"><input type="text" class="sheet-center" name="attr_spellRange"></div>
								<div class="sheet-col-1-7 sheet-vert-middle sheet-padl"><input type="text" class="sheet-center" name="attr_spellDuration"></div>
								<div class="sheet-col-1-9 sheet-vert-middle sheet-padl"><input type="number" class="sheet-center" name="attr_spellcost" value="13"></div>
								<input type="checkbox" name="attr_spellTypeDescription" class="sheet-spelltypetab sheet-spelltypeDescription" value="1"/>
								<span class="sheet-col-1-9 sheet-spelltypetab sheet-spelltypeDescription">Description</span>
								<div class="sheet-spell-type-Description">
									<div class="sheet-row">
										<div class="sheet-col-1-2 sheet-vert-bottom sheet-center sheet-large-label sheet-padl">Description</div>
										<div class="sheet-col-1-2 sheet-vert-bottom sheet-center sheet-large-label sheet-padl">Notes</div>
									</div>
									<div class="sheet-row">
										<div class="sheet-col-1-2 sheet-large-label sheet-center sheet-padl"><textarea class="sheet-medium" name="attr_spellDescription"></textarea></div>
										<div class="sheet-col-1-2 sheet-large-label sheet-center sheet-padl"><textarea class="sheet-medium" name="attr_spellNotes"></textarea></div>
									</div>
								</div>
							</div>	
						</div>
					<!-- END spellbook 6 row -->	
					</fieldset>
				</div>
				<!-- END spell book -->
			</div>
		</div>
		<!--END MAGIC -->
	</div>	
	<!-- END of Player Sheet -->
	<!-- SHEET Update Mode -->
	<div class="sheet-maintab-content sheet-update">
		<h3 class="sheet-center">UPDATE MODE</h3>
		<div class="sheet-row">
			<div class="sheet-col-1-3 sheet-padr">							
				<h4 class="sheet-center">Update Level and HP</h4>
				<div class="sheet-row">
					<div class="sheet-row sheet-sub-header">
						<div class="sheet-col-1-2 sheet-center sheet-vert-bottom sheet-large-label">Class</div>
						<div class="sheet-col-1-2 sheet-center sheet-vert-bottom sheet-large-label">Race</div>
					</div>
					<input type="hidden" name="attr_Speed">
					<input type="hidden" name="attr_RaceHD">
					<input type="hidden" name="attr_ATK">
					<input type="hidden" name="attr_DAM">
					<input type="hidden" name="attr_encumbrance">
					<div class="sheet-row">
						<div class="sheet-col-1-2 sheet-center">
							<select name="attr_Class">
								<option value="Cleric">Cleric</option>
								<option value="Druid">Druid</option>
								<option value="Enchanter">Enchanter</option>
								<option value="Fighter">Fighter</option>
								<option value="Hunter">Hunter</option>
								<option value="Mage">Mage</option>
								<option value="Rogue">Rogue</option>
							</select>
						</div>
						<input name="attr_raceACbonus" type="hidden" value="0">
						<div class="sheet-col-1-2 sheet-padl sheet-center">
							<select name="attr_Race">
								<option value="Beastman">Beastman</option>
								<option value="Dwarf">Dwarf</option>
								<option value="Elf">Elf</option>
								<option value="Halfling">Halfling</option>
								<option value="Human" selected="selected">Human</option>
								<option value="Other">Other</option>
							</select>
						</div>
					</div>	
					<div class="sheet-row">
						<div class="sheet-col-1 sheet-center">&nbsp;</div>
					</div>
					<div class="sheet-row">
						<div class="sheet-col-1-2 sheet-core-stat-label">Level</div>
						<div class="sheet-col-1-4"><input type="number" name="attr_Level" value="1" min="1" step="1"></div>
					</div>
					<div class="sheet-row">				
						<div class="sheet-col-1-2 sheet-core-stat-label">Base HP</div>
						<div class="sheet-col-1-4"><input type="number" name="attr_HP" value="1" min="1" step="1"></div>
					</div>
					<div class="sheet-row">				
						<div class="sheet-col-1-2 sheet-core-stat-label">Bonus HP</div>
						<div class="sheet-col-1-4"><input type="number" name="attr_BonusHP" value="0" step="1"></div>
					</div>
				</div>
			</div>	
			<div class="sheet-col-1-3 sheet-padr">						
				<h4 class="sheet-center">Modify Base Stats</h4>									
				<div class="sheet-row sheet-sub-header">
					<div class="sheet-col-1-2 sheet-center sheet-vert-bottom sheet-large-label">Stat</div>
					<div class="sheet-col-1-4 sheet-center sheet-vert-bottom sheet-large-label">Base</div>
					<div class="sheet-col-1-4 sheet-center sheet-vert-bottom sheet-large-label">Bonus</div>
				</div>
				<div class="sheet-row sheet-center">
					<div class="sheet-col-1-2 sheet-core-stat-label">Strength</div>
					<div class="sheet-col-1-5"><input type="number" name="attr_str" min="3" value="10" step="1"/></div>
					<div class="sheet-col-1-5"><input class="sheet-center sheet-highlight" type="number" name="attr_UpstrBonus" value="floor((@{str}/2)-5)" disabled="disabled"></div>
				</div>
				<div class="sheet-row sheet-center">
					<div class="sheet-col-1-2 sheet-core-stat-label">Dexterity</div>
					<div class="sheet-col-1-5"><input type="number" name="attr_dex" min="3" value="10" step="1"/></div>
					<div class="sheet-col-1-5"><input class="sheet-center sheet-highlight" type="number" name="attr_UpdexBonus" value="floor((@{dex}/2)-5)" disabled="disabled"></div>
				</div>
				<div class="sheet-row sheet-center">
					<div class="sheet-col-1-2 sheet-core-stat-label">Mind</div>
					<div class="sheet-col-1-5"><input type="number" name="attr_mind" min="3" value="10" step="1"/></div>
					<div class="sheet-col-1-5"><input class="sheet-center sheet-highlight" type="number" name="attr_UpmindBonus" value="floor((@{mind}/2)-5)" disabled="disabled"></div>
				</div>
				<div class="sheet-row sheet-center">
					<div class="sheet-col-1-2 sheet-core-stat-label">Charisma</div>
					<div class="sheet-col-1-5"><input type="number" name="attr_cha" min="3" value="10" step="1"/></div>
					<div class="sheet-col-1-5"><input class="sheet-center sheet-highlight" type="number" name="attr_UpchaBonus" value="floor((@{cha}/2)-5)" disabled="disabled"></div>
				</div>	
				<div class="sheet-row">
						<div class="sheet-col-1 sheet-center">&nbsp;</div>
				</div>
				<div class="sheet-row sheet-center">
					<div class="sheet-col-1-2"><span class="sheet-large-label">Rogue Skill</span>
						<select name="attr_rogueSkill">
							<option value="na" selected="selected">N/A</option>
							<option value="phys">Physical</option>
							<option value="subt">Subterfuge</option>
							<option value="know">Knowledge</option>
							<option value="comm">Communion</option>
							<option value="surv">Survival</option>
							<option value="craf">Crafting</option>
						</select>
					</div>	
				</div>
			</div>		
			<div class="sheet-col-1-3">							
				<h4 class="sheet-center">Modify Base Skills</h4>
				<div class="sheet-row sheet-sub-header">
					<div class="sheet-col-1-2 sheet-center sheet-vert-bottom sheet-large-label">Skill</div>
					<div class="sheet-col-1-4 sheet-center sheet-vert-bottom sheet-large-label">Base</div>
					<div class="sheet-col-1-4 sheet-center sheet-vert-bottom sheet-large-label">Bonus</div>
				</div>							
				<div class="sheet-row sheet-center">
					<div class="sheet-col-1-2 sheet-core-stat-label">Physical</div>
					<div class="sheet-col-1-5" title="Enter the base value listed in Class Advancement Table"><input type="number" name="attr_phys" value="0" min="0" step="1"></div>
					<div class="sheet-col-1-5"><input class="sheet-center sheet-highlight" type="number" name="attr_UpphysBonus" value="floor(@{phys}/2)" disabled="disabled"></div>
				</div>							
				<div class="sheet-row sheet-center">
					<div class="sheet-col-1-2 sheet-core-stat-label">Subterfuge</div>
					<div class="sheet-col-1-5" title="Enter the base value listed in Class Advancement Table"><input type="number" name="attr_subt" value="0" min="0" step="1"></div>
					<div class="sheet-col-1-5"><input class="sheet-center sheet-highlight" type="number" name="attr_UpsubtBonus" value="floor(@{subt}/2)" disabled="disabled"></div>
				</div>							
				<div class="sheet-row sheet-center">
					<div class="sheet-col-1-2 sheet-core-stat-label">Knowledge</div>
					<div class="sheet-col-1-5" title="Enter the base value listed in Class Advancement Table"><input type="number" name="attr_know" value="0" min="0" step="1"></div>
					<div class="sheet-col-1-5"><input class="sheet-center sheet-highlight" type="number" name="attr_UpknowBonus" value="floor(@{know}/2)" disabled="disabled"></div>
				</div>							
				<div class="sheet-row sheet-center">
					<div class="sheet-col-1-2 sheet-core-stat-label">Communion</div>
					<div class="sheet-col-1-5" title="Enter the base value listed in Class Advancement Table"><input type="number" name="attr_comm" value="0" min="0" step="1"></div>
					<div class="sheet-col-1-5"><input class="sheet-center sheet-highlight" type="number" name="attr_UpcommBonus" value="floor(@{comm}/2)" disabled="disabled"></div>
				</div>
				<div class="sheet-row sheet-center">
					<div class="sheet-col-1-2 sheet-core-stat-label">Survival</div>
					<div class="sheet-col-1-5" title="Enter the base value listed in Class Advancement Table"><input type="number" name="attr_surv" value="0" min="0" step="1"></div>
					<div class="sheet-col-1-5"><input class="sheet-center sheet-highlight" type="number" name="attr_UpsurvBonus" value="floor(@{surv}/2)" disabled="disabled"></div>
				</div>					
				<div class="sheet-row sheet-center">
					<div class="sheet-col-1-2 sheet-core-stat-label">Crafting</div>
					<div class="sheet-col-1-5" title="Enter the base value listed in Class Advancement Table"><input type="number" name="attr_craf" value="0" min="0" step="1"></div>
					<div class="sheet-col-1-5"><input class="sheet-center sheet-highlight" type="number" name="attr_UpcrafBonus" value="floor(@{craf}/2)" disabled="disabled"></div>
				</div>
			</div>
		</div>
			<div class="sheet-row">
				<div class="sheet-col-1 sheet-center">&nbsp;</div>
			</div>
			<div class="sheet-row">
				<div class="sheet-col-1 sheet-center"><span class="sheet-large-label">Race Starting</span></div>
				<div class="sheet-col-1 sheet-center"><input class="sheet-center" type="text" name="attr_raceProg" readonly="readonly"></div>
			</div>
			<div class="sheet-row">
				<div class="sheet-col-1 sheet-center"><span class="sheet-large-label">Class Starting</span></div>
				<div class="sheet-col-1 sheet-center"><input class="sheet-center" type="text" name="attr_classStart" readonly="readonly"></div>
			</div>
			<div class="sheet-row">
				<div class="sheet-col-1 sheet-center"><span class="sheet-large-label">Class Progression</span></div>
				<div class="sheet-col-1 sheet-center"><input class="sheet-center" type="text" name="attr_classProg" readonly="readonly"></div>
			</div>
	</div>
	<!-- SHEET END Update Mode -->
	<!-- SHEET Monster Mode -->
	<div class="sheet-maintab-content sheet-monster">
		<h3 class="sheet-center">NPC / MONSTER</h3>
		<div class="sheet-row">
			<div class="sheet-col-1-2 sheet-padr">
					<div class="sheet-row">
						<div class="sheet-col-1-2 sheet-center"><input class="sheet-underlined sheet-center" type="text" placeholder="Monster Name" name="attr_monster_name"><br/>Monster Name</div>
						<div class="sheet-col-1-2 sheet-center"><input class="sheet-center sheet-underlined" type="text" placeholder="Type/Title" name="attr_monsterTitle"><br/>Title</div>
					</div>
					<div class="sheet-col-1-1 sheet-center">&nbsp;</div>
					<div class="sheet-row">
						<div class="sheet-row sheet-sub-header">
							<div class="sheet-col-1-6 sheet-center sheet-vert-bottom">HD/Level</div>
							<div class="sheet-col-1-6 sheet-center sheet-vert-bottom">HD Type</div>
							<div class="sheet-col-1-6 sheet-center sheet-vert-bottom">HP</div>
							<div class="sheet-col-1-6 sheet-center sheet-vert-bottom">AC</div>
							<div class="sheet-col-1-6 sheet-center sheet-vert-bottom">Atk Mod</div>
							<div class="sheet-col-1-6 sheet-center sheet-vert-bottom">Dmg Mod</div>
						</div>
						<div class="sheet-col-1-6 sheet-padl sheet-center"><input class="sheet-center" type="number" name="attr_MonsterHD" value="1" min="0"></div>
						<div class="sheet-col-1-6 sheet-padl sheet-center"><select name="attr_monsterHDtype">
							<option value="4">d4</option>
							<option value="6">d6</option>
							<option value="8" selected="selected">d8</option>
							<option value="10">d10</option>
							<option value="12">d12</option>
							<option value="20">d20</option>								
						</select></div>
						<div class="sheet-col-1-6 sheet-padl sheet-center"><input class="sheet-center" type="number" name="attr_MonsterHP" value="1"></div>
						<div class="sheet-col-1-6 sheet-padl sheet-center"><input class="sheet-center" type="number" name="attr_MonsterAC" value="10" min="0"></div>
						<div class="sheet-col-1-6 sheet-padl sheet-center"><input class="sheet-center" type="number" name="attr_MonsterATKmod" value="0"></div>
						<div class="sheet-col-1-6 sheet-padl sheet-center"><input class="sheet-center" type="number" name="attr_MonsterDMGmod" value="0"></div>
					</div>
					<div class="sheet-col-1-1 sheet-center">&nbsp;</div>
			</div>
			<div class="sheet-col-1-2 sheet-padr">
					<div class="sheet-row">
						<div class="sheet-col-1-4">
							<div class="sheet-ACBG">
								<div class="sheet-col-1-4 sheet-center">&nbsp;</div>
								<div class="sheet-col-1-3 sheet-center"><input title="Base AC is 10 plus armour, dex and other bonuses/penalties" class="sheet-AC" type="number" name="attr_MAC" value="@{MonsterAC}" disabled="disabled"/><br/>.</div>
							</div>
						</div>
						<div class="sheet-col-1-4">
							<div class="sheet-HPBG">
								<div class="sheet-col-1-4 sheet-center">&nbsp;</div>
								<div class="sheet-col-1-3 sheet-center "><input title="Total HP minus damage and spell fatigue." class="sheet-HP" type="text" name="attr_MonsterCurrentHP" value="(@{MonsterHP})-(@{MonsterUsedHP}+@{Monsterfatigue})" disabled="disabled"/><br/>.</div>
							</div>
						</div>
						<div class="sheet-col-1-5 sheet-padl sheet-center"><input title="HP damage taken." class="sheet-HP2 sheet-center" type="number" name="attr_MonsterUsedHP" value="0"/><span>Damage<span></div>
						<div class="sheet-col-1-5 sheet-padl sheet-center"><input title="HP used for spell casting." class="sheet-HP2 sheet-center" type="number" name="attr_Monsterfatigue" value="0"/><span>Spell Fatigue<span></div>
					</div>
					<div class="sheet-row">
						<div class="sheet-col-1-4 sheet-center">Armor Class</div>
						<div class="sheet-col-1-4 sheet-center">Current Hit Points</div>
					</div>
					<div class="sheet-col-1-1 sheet-center">&nbsp;</div>
					<div class="sheet-row sheet-padl">
						<div class="sheet-col-1-6 sheet-padl sheet-center"><input class="sheet-center" type="number" name="attr_MonsterSuggestedHP" value="(@{monsterHDtype}*@{MonsterHD})" disabled="disabled"><span>Suggested HP</span></div>
						<div class="sheet-col-1-7 sheet-padl sheet-center" title="Base Attack Bonus"><input class="sheet-center" type="number" name="attr_showATK" value="(@{MonsterHD}+@{MonsterATKmod})" disabled="disabled"><span>Attack Bonus</span></div>
						<div class="sheet-col-1-7 sheet-padl sheet-center" title="Base Damage"><input class="sheet-center" type="number" name="attr_monsterDAM" value="((@{monsterHDtype}/2)+@{MonsterDMGmod})" disabled="disabled"><span>Base Damage</span></div>
						<div class="sheet-col-1-7 sheet-padl sheet-center" title="Number of Attacks"><input class="sheet-center" type="number" name="attr_monsterNumATK" value="1"><span># Attacks</span></div>
						<div class="sheet-col-1-6 sheet-padl sheet-center"><input class="sheet-center" type="number" name="attr_showMonsterSpeed" value="30" min="0" step="5"><span>Speed</span></div>
						<div class="sheet-col-1-6 sheet-padl sheet-center" title="Morale"><input class="sheet-center" type="number" name="attr_MonsterMorale" value="0" min="-10" max="10"><span>Morale</span></div>
					</div>
			</div>		
		</div>
			<div class="sheet-col-1-1">							
				<h4 class="sheet-center">Notes</h4>
				<div class="sheet-row">
					<div class="sheet-col-1-3 sheet-padl"><textarea name="attr_MonsterNotes"></textarea></div>
					<div class="sheet-col-1-3 sheet-padl"><textarea name="attr_MonsterNotes2"></textarea></div>
					<div class="sheet-col-1-3 sheet-padl"><textarea name="attr_MonsterNotes3"></textarea></div>
				</div>			
			</div>	
	</div>
	<!-- SHEET END Monster Mode -->
	<div class="sheet-row">
		<div class="sheet-col-1-2 sheet-left sheet-margin-bottom"><p class="sheet-last-updated">Rules available at: https://beacond20.blogspot.com/p/get-beacon.html</p></div>
		<div class="sheet-col-1-2 sheet-right sheet-margin-bottom"><p class="sheet-last-updated">Sheet last updated January 2022</p></div>
	</div>
</div>

<script type="text/worker">

on("sheet:opened change:Class change:Level change:str change:mind change:dex change:cha change:strMod change:mindMod change:dexMod change:chaMod change:strDam change:mindDam change:dexDam change:chaDam change:dexPenalty change:phys change:subt change:know change:comm change:surv change:craf change:physMod change:subtMod change:knowMod change:commMod change:survMod change:crafMod", function() {
	getAttrs(["Level","Class","str","mind","dex","dexPenalty","cha","strMod","mindMod","dexMod","chaMod","strDam","mindDam","dexDam","chaDam","phys","subt","know","comm","surv","craf","physMod","subtMod","knowMod","commMod","survMod","crafMod", "currentEncumbrance"], function(v) {
	const level=parseInt(v.Level)||1;
	const Str = parseInt(v["str"])||0;
	const SMod = parseInt(v["strMod"])||0;
	const SDam = parseInt(v["strDam"])||0;
	const Mind = parseInt(v["mind"])||0;
	const MMod = parseInt(v["mindMod"])||0;
	const MDam = parseInt(v["mindDam"])||0;
	const Dex = parseInt(v["dex"])||0;
	const DMod = parseInt(v["dexMod"])||0;
	const DDam = parseInt(v["dexDam"])||0;
	const DPen = parseInt(v["dexPenalty"])||0;
	var dexpentext="Full Bonuses";
	const Cha = parseInt(v["cha"])||0;
	const CMod = parseInt(v["chaMod"])||0;
	const CDam = parseInt(v["chaDam"])||0;
	const Phys = parseInt(v["phys"])||0;
	const PhysMod = parseInt(v["physMod"])||0;
	const Subt = parseInt(v["subt"])||0;
	const SubtMod = parseInt(v["subtMod"])||0;
	const Know = parseInt(v["know"])||0;
	const KnowMod = parseInt(v["knowMod"])||0;
	const Comm = parseInt(v["comm"])||0;
	const CommMod = parseInt(v["commMod"])||0;
	const Surv = parseInt(v["surv"])||0;
	const SurvMod = parseInt(v["survMod"])||0;
	const Craf = parseInt(v["craf"])||0;
	const CrafMod = parseInt(v["crafMod"])||0;
	//Encumbrabce
	var EncmbBASE = 10;
	var calcEncum = EncmbBASE+Math.floor((Str+SMod-SDam)/2)-5;
    //class dependents
	var damage=parseInt(0);
	var attack=parseInt(0);
	var spellbonus=parseInt(0);
	var spelltext="None"
	var numAttacks=parseInt(1);
	var skills = "See Notes";
  
	//if (DPen >= 2 && dexbonus > 0) {dexbonus=0;} 
	if (DPen >= 2 ) {dexpentext="No Dex Bonuses";}
	else if (DPen >= 1 ) {dexpentext="No Dex Bonus to AC";}
	else {dexpentext="Full Bonuses";}
 
	var strBonus = Math.floor((Str+SMod-SDam)/2)-5;
	var dexBonus = Math.floor((Dex+DMod-DDam)/2)-5;
	var mindBonus = Math.floor((Mind+MMod-MDam)/2)-5;
	var chaBonus = Math.floor((Cha+CMod-CDam)/2)-5;
	var physBonus = Math.floor((Phys+PhysMod)/2);
	var subtBonus = Math.floor((Subt+SubtMod)/2);
	var knowBonus = Math.floor((Know+KnowMod)/2);
	var commBonus = Math.floor((Comm+CommMod)/2);
	var survBonus = Math.floor((Surv+SurvMod)/2);
	var crafBonus = Math.floor((Craf+CrafMod)/2);

	switch (v.Class) {
		case "Fighter" : attack=physBonus+1; damage=physBonus; numAttacks=Math.floor(level/5)+1; skills1="Fighters start with +3 Physical, +1 to attack, and 1 Bonus HP."; skills2="+1 Physical at levels 3/6/9/12. Add phyiscal bonus to damage. Additional attacks at levels 5 and 10. +1 Bonus HP every level."; break;
		case "Cleric" : attack=physBonus; spellbonus=commBonus+chaBonus; spelltext="Cleric casting roll: Communion/Charisma check vs. DC10 + spell level."; numAttacks=Math.floor(level/10)+1; skills1="The Cleric starts with +3 points in Communion.  They cast Divine magic."; skills2="+1 Communion at levels 3/6/9/12."; break;
		case "Rogue" : attack=physBonus; spellbonus=subtBonus+mindBonus; spelltext="Reading Scrolls: Knowledge/Mind check vs. DC10 + spell level."; numAttacks=Math.floor(level/10)+1; skills1="Rogues start with +2 points Subterfuge and +1 in any other skill."; skills2="+1 any skill at levels 2/4/6/8/10/12."; break;
		case "Hunter" : attack=physBonus; numAttacks=Math.floor(level/5)+1; skills1="The Hunter starts with +2 points in Survival,+1 Physical and +1 to ranged attack."; skills2="+1 Survival at levels 3/6/9/12. They get an additional attack at level 8."; break;
		case "Mage" : attack=physBonus; spellbonus=knowBonus+mindBonus; spelltext="Mage casting:Subterfuge/Mind check vs. DC10 + spell level."; skills1="Mages start with +3 Knowledge. They cast Arcane magic."; skills2="+1 Knowledge at levels 3/6/9/12."; break;
		case "Druid" : attack=physBonus; spellbonus=survBonus+chaBonus; spelltext="Druid casting: Survival/Charisma check vs. DC10 + spell level."; numAttacks=Math.floor(level/10)+1; skills1="The Druid starts with +2 Survival, +1 Communion.  They cast Divine magic."; skills2="+1 Surival at levels 3/6/9/12."; break;
		case "Enchanter" : attack=physBonus; spellbonus=subtBonus+mindBonus; spelltext="Enchanter casting: Subterfuge/Mind check vs. DC10 + spell level."; skills1="Enchanter starts with +1 Knowledge and +2 Subterfuge.  They cast Arcane magic."; skills2="+1 Subterfuge at levels 3/6/9/12."; break;
	}

  setAttrs({
			strCurrent : Str+SMod-SDam,
			strBonus : strBonus,
			mindCurrent : Mind+MMod-MDam,
			mindBonus : mindBonus,
			dexCurrent : Dex+DMod-DDam,
			dexBonus : dexBonus,
			dexPenaltyText : dexpentext,
			chaCurrent : Cha+CMod-CDam,
			chaBonus : chaBonus,
			physBonus : physBonus,
			subtBonus : subtBonus,
			knowBonus : knowBonus,
			commBonus : commBonus,
			survBonus : survBonus,
			crafBonus : crafBonus,
			encumbrance : calcEncum,
			ATK : attack, 
			DAM : damage, 
			numATK : numAttacks,
			spellBonus : spellbonus,
			castingText : spelltext,
			classStart: skills1, 
			classProg : skills2
        });
  });
});

// set race abilities and HD
on("sheet:opened change:Race", function() {
  getAttrs(["Race"], function(v) {
  var RACE = v.Race;
  var HD = "?";
  var specials = "";
  var skills = "";
  var racespeed = parseInt(30);
  var ACB = "0";
  //race sets HD
  switch (v.Race) {
  case "Dwarf" : HD = "d8"; specials="Dark sight, direction finding, larger die for initiative. Cannot swim."; skills="Starts with +2 Strength and +1 Crafting. Dark sight and direction finding (underground), larger die for initiative. Cannot swim."; racespeed=25; break;
  case "Human" : HD = "d8"; specials="Found everywhere. Adaptable"; skills="Starts with +1 point in 4 different skills."; break;
  case "Elf" : HD = "d6"; specials="Night vision, immune to charm and sleep effects."; skills="+1 to Mind, Charisma, Knowledge and Survival.  Night vision (above ground), immune to charm and sleep effects."; racespeed=35; break;
  case "Halfling" : HD = "d6"; ACB = "1"; specials="Small, quick and nimble, no heavy weapons."; skills="AC Bonus, +1 Dexerity, +1 Subterfuge and +1 to any other skill.  Can not use heavy weapons."; break;
  case "Beastman" : HD = "d10"; specials = "Cannot cast arcane spells or scrolls, +1 spell cost."; skills="Starts with -2 Charisma, +2 Survival. Has built-in light weapon. Cannot cast arcane spells or scrolls, +1 casting cost."; break;
  case "Other" : HD = "?"; specials = "See Notes."; skills="See Notes."; break;
  }
  setAttrs({RaceHD : HD, RaceSpecials : specials, raceACbonus : ACB, raceProg : skills, Speed : racespeed});
  
  });
});

//calculate encumbrance
var recalculateEncumbrance = function recalculateEncumbrance() {
	getAttrs(["encumbrance","enc_exceeded","containerLoadTotal","itemcount","itemcount2","itemcount3","itemcount4", "itemcount5", "CP", "SP", "GP", "PP", "armorLoadTotal", "rangedLoadTotal", "meleeLoadTotal"], function(v) {
	
	const canCarry = v.encumbrance||10;
	var toggle_overload = 0;
	const armorLoad = v.armorLoadTotal||0;
	const rangedLoad = v.rangedLoadTotal||0;
	const meleeLoad = v.meleeLoadTotal||0;
	var totalCombatLoad = (armorLoad + rangedLoad + meleeLoad);
	
	const water = parseInt(v.itemcount)||0;
	const fRats = parseInt(v.itemcount2)||0;
	const bRats = parseInt(v.itemcount3)||0;
	const torch = parseInt(v.itemcount4) ||0;
	const flask = parseInt(v.itemcount5) ||0;
	var totalContainerLoad = v.containerLoadTotal||0;
	var totalItemLoad = (water/2) + (fRats/4) + (bRats/2) +(torch/10) +(flask/4);
	
	var cp=parseInt(v.CP)||0;
	var sp=parseInt(v.SP)||0;
	var gp=parseInt(v.GP)||0;
	var pp=parseInt(v.PP)||0;
	var totalCoinLoad=(cp+sp+gp+pp)/500;
	
	var totalEncumbrance = (totalCoinLoad + totalCombatLoad + totalItemLoad + totalContainerLoad);
	if (totalEncumbrance > canCarry) {toggle_overload = 1;}
	
		setAttrs({
			itemLoadTotal : (totalItemLoad + totalContainerLoad).toFixed(1),
			combatLoadTotal : totalCombatLoad.toFixed(1),
			coinLoadTotal : totalCoinLoad.toFixed(1),
			currentEncumbrance: totalEncumbrance.toFixed(1),
			enc_exceeded: toggle_overload
	
		});
	})
};
on("sheet:opened change:encumbrance change:containerLoadTotal change:itemcount change:itemcount2 change:itemcount3 change:itemcount4 change:itemcount5 change:meleeLoadTotal change:rangedLoadTotal change:armorLoadTotal change:CP change:SP change:GP change:PP", recalculateEncumbrance);

// Calculate Armour
var recalculateArmorModifiers = function recalculateArmorModifiers() {
	getSectionIDs(`repeating_armor`, function(idArray) {
	// create a variable to hold all the needed attribute names
	var fieldnames = [];
	// loop throw the rowIDs and build their actual attributes names. adding them to the fieldnames array
    for(var i = 0; i < idArray.length; i++) {
        fieldnames.push(
			"repeating_armor_" + idArray[i] + "_armorAcBase",
			"repeating_armor_" + idArray[i] + "_armorSpeed",
			"repeating_armor_" + idArray[i] + "_armorDexPen",
			"repeating_armor_" + idArray[i] + "_armorEncumbrance",
			"repeating_armor_" + idArray[i] + "_armorCarried",
            "repeating_armor_" + idArray[i] + "_armorType",
            "repeating_armor_" + idArray[i] + "_rangedWeaponType",
			"repeating_armor_" + idArray[i] + "_armorCarried",
			"repeating_armor_" + idArray[i] + "_armorActive",
			"repeating_armor_" + idArray[i] + "_armorMagicBonus"
        );
	}
	fieldnames.push("raceACbonus","dexBonus","dexPenalty");
	
	getAttrs(fieldnames, function(values) {
		const raceBonus = parseInt(values.raceACbonus)||0;
        const agiAC = parseInt(values.dexBonus)||0;
		const dexpen = parseInt(values.dexPenalty)||0;
		var baseAC = parseInt(10);
		var Encumb = parseInt(0);
		var totalSpeed = parseInt(0);
		var totalDexPen = parseInt(0);
		var totalAC = parseInt(0);
		//create a container for the output
		const output ={};
		//loop the rows
		for(var i = 0; i < idArray.length; i++) {
			var enc = parseInt(0);
			var acBase = parseInt(0);
			var dpen = parseInt(0);
			var speed = parseInt(0);
			//Set up defaults for armor types
			switch (values["repeating_armor_"+ idArray[i] +"_armorType"]) {
				case "padded" : acBase=1; speed=0; dpen=0; enc=0; break;
				case "leather" : acBase=2; speed=0; dpen=0; enc=0; break;
				case "st_leather" : acBase=3; speed=0; dpen=0; enc=0; break;
				case "scale" : acBase=4; speed=-5; dpen=1; enc=1; break;
				case "splint" : acBase=5; speed=-5; dpen=1; enc=1; break;
				case "chain" : acBase=4; speed=-5; dpen=1; enc=1; break;
				case "banded" : acBase=6; speed=-10; dpen=2; enc=2; break;
				case "halfplate" : acBase=7; speed=-10; dpen=2; enc=2; break;
				case "fullplate" : acBase=8; speed=-10; dpen=2; enc=2; break;
				case "s_small" : acBase=1; speed=0; dpen=0; enc=0; break;
				case "s_woodsmall" : acBase=1; speed=0; dpen=1; enc=1; break;
				case "s_large" : acBase=2; speed=0; dpen=1; enc=1; break;
				case "s_tower" : acBase=2; speed=-5; dpen=2; enc=2; break;
			}
			//get bonus
			const acBonus = parseInt(values["repeating_armor_"+ idArray[i] +"_armorMagicBonus"])||0;
			//check is carried and worn
			var wornArmor = (values["repeating_armor_"+ idArray[i] +"_armorActive"] == "on") ? true : false;
			var carryArmor = values["repeating_armor_"+ idArray[i] +"_armorCarried"]
			var iscarried = (carryArmor == "on") ? true : false;
			
			if ((iscarried) == true && (wornArmor) == false) {Encumb += enc+1;}
			else if ((wornArmor) == true) {
				baseAC += (acBase + acBonus);
				totalSpeed += speed;
				Encumb += enc;
				totalDexPen += dpen;
				carryArmor = "on"; //force worn armor to be carried too
			}
			//load up the row level
			output["repeating_armor_"+ idArray[i] +"_armorAcBase"] = acBase;
			output["repeating_armor_"+ idArray[i] +"_armorSpeed"] = speed;
			output["repeating_armor_"+ idArray[i] +"_armorDexPen"] = dpen;
			output["repeating_armor_"+ idArray[i] +"_armorEncumbrance"] = enc;
			output["repeating_armor_"+ idArray[i] +"_armorCarried"] = carryArmor;
		}
		//calulate dex penalties and stuff
		if ((totalDexPen) >= 1 && agiAC > 0) {totalAC = baseAC + raceBonus;}
		else {totalAC = baseAC + agiAC + raceBonus;}
		//load up the sheet level 	
		output["acCalc"]=totalAC;
		output["dexPenalty"]=totalDexPen;
		output["armorLoadTotal"]= Encumb;
		output["armorSpeedTotal"]= totalSpeed;
		//send it all back to the sheet
		setAttrs(output);		
		});
	});
};		
on("sheet:opened remove:repeating_armor change:dexBonus change:raceACbonus change:repeating_armor:armorType change:repeating_armor:armorActive change:repeating_armor:armorCarried", recalculateArmorModifiers);

//calc Container Encumbrance 
var recalculateContainerModifiers = function recalculateContainerModifiers() {
	getSectionIDs(`repeating_containers`, function(idArray) {
	// create a variable to hold all the needed attribute names
	var fieldnames = [];
	// loop throw the rowIDs and build their actual attributes names. adding them to the fieldnames array
    for(var i = 0; i < idArray.length; i++) {
		fieldnames.push(
			"repeating_containers_" + idArray[i] + "_containerEquip",
			"repeating_containers_" + idArray[i] + "_containerWeight"
        );
	}
	getAttrs(fieldnames, function(values) {
		var Encumb = parseInt(0);
		for(var i = 0; i < idArray.length; i++) {
			var checkContainer = (values["repeating_containers_" + idArray[i] + "_containerEquip"] == "on") ? true : false;
			var Enc = parseInt(values["repeating_containers_" + idArray[i] + "_containerWeight"])||0;
			
			if ((checkContainer) == true) {Encumb += Enc;}
		}
		setAttrs({containerLoadTotal: Encumb});
		});
	});
};	
on("sheet:opened remove:repeating_containers change:repeating_containers:containerEquip change:repeating_containers:containerWeight", recalculateContainerModifiers);

//calc fields on ranged weapons
var recalculateRangedModifiers = function recalculateRangedModifiers() {
	getSectionIDs(`repeating_rangedweapon`, function(idArray) {

	var fieldnames = [];
	
	// loop throw the rowIDs and build their actual attributes names. adding them to the fieldnames array
    for(var i = 0; i < idArray.length; i++) {
        fieldnames.push(
            "repeating_rangedweapon_" + idArray[i] + "_rangedWeaponsize",
            "repeating_rangedweapon_" + idArray[i] + "_rangedWeaponType",
			"repeating_rangedweapon_" + idArray[i] + "_rangedAtkMod",
			"repeating_rangedweapon_" + idArray[i] + "_rangedDamMod",
			"repeating_rangedweapon_" + idArray[i] + "_rangedDistance",
			"repeating_rangedweapon_" + idArray[i] + "_rangedMagic",
			"repeating_rangedweapon_" + idArray[i] + "_rangedEquip",
			"repeating_rangedweapon_" + idArray[i] + "_rangedAmmo"
        );
	}
// if you need any other attributes in your worker, dont forget to include those
        fieldnames.push("Class","ATK","DAM","dexBonus","strBonus","subtBonus","survBonus","rangedLoadTotal");

        // now  use getAttrs to extract those attribute values from the sheet and store them in an object called values.
        // since fieldnames is already an array, we dont need to use the usual [ ] brackets.
        getAttrs(fieldnames, function(values) {
            // get the externals
			const sclass = values.Class;
			const STRBonus = parseInt(values.strBonus)||0;
			const DEXBonus = parseInt(values.dexBonus)||0;
			const subtBonus = parseInt(values.subtBonus)||0;
			const survBonus = parseInt(values.survBonus)||0;
			const Attack = parseInt(values.ATK)||0;
			const Damage = parseInt(values.DAM)||0;
			var Encumb = parseInt(0);
			//create a container for the output
			const output ={};
			// now loop through the row ids again, and grab their values, adding them to the spent total
            // the idArray variable created earlier by getSectionIDs still exists so we can use that.
            for(var i = 0; i < idArray.length; i++) {
				const AttackMod = parseInt(values["repeating_rangedweapon_"+ idArray[i] + "_rangedAtkMod"])||0;
				const DamageMod = parseInt(values["repeating_rangedweapon_"+ idArray[i] + "_rangedDamMod"])||0;
				const magicBonus = parseInt(values["repeating_rangedweapon_"+ idArray[i] + "_rangedMagic"])||0;
				const range = parseInt(values["repeating_rangedweapon_"+ idArray[i] + "_rangedDistance"])||0;
				const type = values["repeating_rangedweapon_"+ idArray[i] + "_rangedWeaponType"];
				var Ammo = parseInt(values["repeating_rangedweapon_"+ idArray[i] + "_rangedAmmo"])||0;
				var Dam = 3;
				var maxrange = parseInt(3);
				var Enc = parseInt(1);
				var size = values["repeating_rangedweapon_"+ idArray[i] + "_rangedWeaponsize"];
				var checkEquip = (values["repeating_rangedweapon_"+ idArray[i] + "_rangedEquip"] == "on") ? true : false;
				var calcHitbonus = parseInt(0);
				var calcDambonus = parseInt(0);
				
				if (size == "light-rogue" && sclass != "Rogue") {size="light";}
				if (size == "small-rogue" && sclass != "Rogue") {size="small";}
				
				if (type == "missile") {maxrange=5*range; Ammo=1}
				else {maxrange=3*range;}
				
				switch (size) {
					case "small":  Dam = 3; Enc = 0.2*Ammo; calcHitbonus = Attack + DEXBonus + AttackMod + magicBonus; calcDambonus = Damage + DamageMod + magicBonus; break;
					case "small-rogue":  Dam = 3; Enc = 0.2*Ammo; calcHitbonus = Attack + DEXBonus + AttackMod + magicBonus; calcDambonus = Damage + subtBonus + DamageMod + magicBonus; break;
					case "light":  Dam = 3; Enc = 0.5*Ammo; calcHitbonus = Attack + DEXBonus + AttackMod + magicBonus; calcDambonus = Damage + DamageMod + magicBonus; break;
					case "light-rogue":  Dam = 3; Enc = 0.5*Ammo; calcHitbonus = Attack + DEXBonus + AttackMod + magicBonus; calcDambonus = Damage + subtBonus + DamageMod + magicBonus; break;
					case "heavy":  Dam = 4; Enc = Ammo; calcHitbonus = Attack + DEXBonus + AttackMod + magicBonus; calcDambonus = Damage + STRBonus + DamageMod + magicBonus; break;
					}
				
				if (sclass == "Hunter") {calcHitbonus += 1; calcDambonus += survBonus;}
				if ((checkEquip) == true) {Encumb += Enc;}
				output["repeating_rangedweapon_"+ idArray[i] + "_rangedWeaponsize"] = size;
				output["repeating_rangedweapon_"+ idArray[i] +"_rangedDam"] = Dam;
				output["repeating_rangedweapon_"+ idArray[i] +"_rangedMax"] = maxrange;
				output["repeating_rangedweapon_"+ idArray[i] +"_rangedToHit"] = calcHitbonus;
				output["repeating_rangedweapon_"+ idArray[i] +"_rangedDamBonus"] = calcDambonus;
			}
			output["rangedLoadTotal"] = Encumb
			//send it back to sheet
			setAttrs(output);
		});			
	});
};	
on("sheet:opened change:dexBonus change:strBonus change:survBonus change:subtBonus change:ATK change:DAM change:Class remove:repeating_rangedweapon change:repeating_rangedweapon:rangedEquip change:repeating_rangedweapon:rangedAtkMod change:repeating_rangedweapon:rangedDamMod change:repeating_rangedweapon:rangedWeaponsize change:repeating_rangedweapon:rangedDistance change:repeating_rangedweapon:rangedWeaponType change:repeating_rangedweapon:rangedMagic change:repeating_rangedweapon:rangedAmmo", recalculateRangedModifiers);

var recalculateMeleeModifiers = function recalculateMeleeModifiers() {
	getSectionIDs(`repeating_meleeweapon`, function(idArray) {
	
	// create a variable to hold all the needed attribute names
	var fieldnames = [];
	
	// loop throw the rowIDs and build their actual attributes names. adding them to the fieldnames array
    for(var i = 0; i < idArray.length; i++) {
        fieldnames.push(
            "repeating_meleeweapon_" + idArray[i] + "_meleeWeaponsize",
			"repeating_meleeweapon_" + idArray[i] + "_meleeAtkMod",
			"repeating_meleeweapon_" + idArray[i] + "_meleeDamMod",
			"repeating_meleeweapon_" + idArray[i] + "_meleeMagic",
			"repeating_meleeweapon_" + idArray[i] + "_meleeEquip",
			"repeating_meleeweapon_" + idArray[i] + "_meleeCount"
        );
	}
		// get sheet level items
        fieldnames.push("Class","ATK","DAM","dexBonus","strBonus","subtBonus","meleeLoadTotal");
        // now  use getAttrs to extract those attribute values from the sheet and store them in an object called values.
        // since fieldnames is already an array, we dont need to use the usual [ ] brackets.
        getAttrs(fieldnames, function(values) {
            // set the externals
			const sclass = values.Class;
			const STRBonus = parseInt(values.strBonus)||0;
			const DEXBonus = parseInt(values.dexBonus)||0;
			const subtb = parseInt(values.subtBonus)||0;
			const Attack = parseInt(values.ATK)||0;
			const Damage = parseInt(values.DAM)||0;
			var Encumb = parseInt(0);
			//create a container for the output
			const output ={};
			// now loop through the row ids again, and grab their values, adding them to the spent total
            // the idArray variable created earlier by getSectionIDs still exists so we can use that.
            for(var i = 0; i < idArray.length; i++) {
				var Dam = parseInt(3);
				var Enc = parseInt(0);
				const AttackMod = parseInt(values["repeating_meleeweapon_"+ idArray[i] + "_meleeAtkMod"])||0;
				const DamageMod = parseInt(values["repeating_meleeweapon_"+ idArray[i] + "_meleeDamMod"])||0;
				const magicBonus = parseInt(values["repeating_meleeweapon_"+ idArray[i] + "_meleeMagic"])||0;
				const Num = parseInt(values["repeating_meleeweapon_"+ idArray[i] + "_meleeCount"])||0;
				var size = values["repeating_meleeweapon_"+ idArray[i] + "_meleeWeaponsize"];
				var calcHitbonus = parseInt(0);
				var calcDambonus = parseInt(0);
				var checkEquip = (values["repeating_meleeweapon_"+ idArray[i] + "_meleeEquip"] == "on") ? true : false;
				
				//check if they a rogue
				if (size == "light-rogue" && sclass != "Rogue") {size="light";}
				if (size == "small-rogue" && sclass != "Rogue") {size="small";}
				if (size == "heavy-2hand") {size="heavy";}
		
				switch (size) {
					case "small":  Dam = 3; Enc = 0.2*Num; calcHitbonus = Attack + AttackMod + magicBonus;  calcDambonus = Damage + DamageMod + magicBonus; break;
					case "small-rogue": Dam = 3; Enc = 0.2*Num; calcHitbonus = Attack + AttackMod + DEXBonus + magicBonus;  calcDambonus = Damage + subtb + DamageMod + magicBonus; break;
					case "light": Dam = 3; Enc = 0.5*Num; calcHitbonus = Attack + AttackMod + STRBonus + magicBonus;  calcDambonus = Damage + DamageMod + magicBonus; break;
					case "light-rogue": Dam = 3; Enc = 0.5*Num; calcHitbonus = Attack + AttackMod + DEXBonus + magicBonus; calcDambonus = Damage + subtb + DamageMod + magicBonus; break;
//					case "heavy-2hand" : Dam = 5; Enc = 1.5*Num; calcHitbonus = Attack + STRBonus + AttackMod + magicBonus;  calcDambonus = Damage + STRBonus + DamageMod + magicBonus; break;
					case "heavy" :  Dam = 4; Enc = 1*Num; calcHitbonus = Attack + STRBonus + AttackMod + magicBonus;  calcDambonus = Damage + STRBonus + DamageMod + magicBonus; break;
					}
				//calculate load
				if ((checkEquip) == true) {Encumb += Enc;}
				//load up the row level
				output["repeating_meleeweapon_"+ idArray[i] + "_meleeDam"] = Dam;
				output["repeating_meleeweapon_"+ idArray[i] + "_meleeToHit"] = calcHitbonus;
				output["repeating_meleeweapon_"+ idArray[i] + "_meleeDamBonus"] = calcDambonus;
				output["repeating_meleeweapon_"+ idArray[i] + "_meleeWeaponsize"] = size;
			}
			//load up the sheet level
			output["meleeLoadTotal"] = Encumb
			//send it back to sheet
			setAttrs(output);
		});			
	});
};	
on("sheet:opened change:dexPenalty change:dexBonus change:physBonus change:strBonus change:ATK change:DAM change:Class remove:repeating_meleeweapon change:repeating_meleeweapon:meleeEquip change:repeating_meleeweapon:meleeAtkMod change:repeating_meleeweapon:meleeCount change:repeating_meleeweapon:meleeDamMod change:repeating_meleeweapon:meleeWeaponsize change:repeating_meleeweapon:meleeMagic", recalculateMeleeModifiers);
</script>