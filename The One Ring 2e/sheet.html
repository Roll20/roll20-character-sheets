<input type="hidden" name="attr_version" value="01-01-00"/>
<input type="hidden" class="sheet-tabstoggle" name="attr_sheetTab" />
<div class="sheet-pc">
	<div id="content">
		<div id="character">
			<h1 data-i18n="general">General</h1>
			<div id="character-nested">
				<div class="onecol">
					<label data-i18n="character-name">Name</label><input type="text" name="attr_name">
				</div>
				<div class="twocols">
					<label data-i18n="culture">Heroic Culture</label><input type="text" name="attr_culture">
					<label data-i18n="calling">Calling</label><input type="text" name="attr_calling">
					<label data-i18n="standard-of-living">Living standard</label><input type="text"
						name="attr_standard_of_living">
					<label data-i18n="shadow-weakness">Shadow Weakness</label><input type="text"
						name="attr_shadow_weakness">
					<label data-i18n="patron">Patron</label><input type="text" name="attr_patron">
					<label data-i18n="age">Age</label><input type="text" name="attr_age">
				</div>
				<div class="onecol">
					<label data-i18n="cultural-blessing">Cultural Blessing</label><input type="text"
						name="attr_cultural_blessing">
					<label data-i18n="distinctive-features">Dist. Features</label><input type="text"
						name="attr_distinctive_features" />
					<label data-i18n="flaws">Flaws</label><input type="text" name="attr_flaws">
				</div>
			</div>
		</div>
		<div id="virtues">
			<h2 data-i18n="virtues">Virtues</h2>
			<textarea name="attr_virtues" />
		</div>
		<div id="rewards">
			<h2 data-i18n="rewards">Rewards</h2>
			<textarea name="attr_rewards" />
		</div>
		<div id="gear">
			<h2 data-i18n="gear">Gear</h2>
			<textarea name="attr_travellinggear" />
		</div>
		<div id="experience">
			<h2 data-i18n="experience" data-i18n-title="experience-description">Experience</h2>
			<div id="experience-nested">
				<span class="diamond-small-red"><input name="attr_valour" value="0" type="number" min=1 max=6></span>
				<span class="diamond-small-red"><input name="attr_wisdom" value="0" type="number" min=1 max=6></span>
				<span class="diamond-small"><input name="attr_fellowship" value="0" type="number"></span>
				<span>
					<button type="roll" value="@{valour_roll}" name="roll_valourcheck"></button>
					<input type="checkbox" name="attr_valour_favoured">
					<label data-i18n="valour" data-i18n-title="valour-description">Valour</label>
				</span>
				<span>
					<button type="roll" value="@{wisdom_roll}" name="roll_wisdomcheck"></button>
					<input type="checkbox" name="attr_wisdom_favoured">
					<label data-i18n="wisdom" data-i18n-title="wisdom-description">Wisdom</label>
				</span>
				<label data-i18n="fellowship-pool">Fellowship</label>
				<span class="diamond-small"><input name="attr_adventurepoints" value="0" type="number"></span>
				<span class="diamond-small"><input name="attr_skillpoints" value="0" type="number"></span>
				<span class="diamond-small"><input name="attr_treasure" value="0" type="number"></span>
				<span><label data-i18n="adventure-points">Adv. Points</label></span>
				<span><label data-i18n="skill-points">Skill Points</label></span>
				<span><label data-i18n="treasure">Treasure</label></span>
				<span class="diamond-small"><input name="attr_totaladventurepoints" value="0" type="number"></span>
				<span class="diamond-small"><input name="attr_totalskillpoints" value="0" type="number"></span>
				<span class="diamond-small"><input name="attr_treasureload" value="0" type="number"></span>
				<span><label data-i18n="adventure-points-total">Adv. Total</label></span>
				<span><label data-i18n="skill-points-total">Skill Total</label></span>
				<span><label data-i18n="treasure-load">Tre. Load</label></span>
			</div>
		</div>
		<div id="strength">
			<h1 data-i18n="strength" data-i18n-title="strength-description">Strength</h1>
			<div id="attributes-nested">
				<span class="diamond"><input name="attr_strength" value="0" type="number"></span>
				<label data-i18n="endurance">Endurance</label>
				<span class="diamond-red"><input class="strong" name="attr_strengthtn" value="0" type="number"></span>
				<label data-i18n="rating">Rating</label>
				<span class="diamond-small-red"><input name="attr_currentendurance" value="0" type="number"></span>
				<label data-i18n="tn-strength">TN</label><span />
				<span /><span />
			</div>
		</div>
		<div id="heart">
			<h1 data-i18n="heart" data-i18n-title="heart-description">Heart</h1>
			<div id="attributes-nested">
				<span class="diamond"><input name="attr_heart" value="0" type="number"></span>
				<label data-i18n="hope">Hope</label>
				<span class="diamond-red"><input class="strong" name="attr_hearttn" value="0" type="number"></span>
				<label data-i18n="rating">Rating</label>
				<span class="diamond-small-red"><input name="attr_currenthope" value="0" type="number"></span>
				<label data-i18n="tn-heart">TN</label><span />
				<span /><span />
			</div>
		</div>
		<div id="wits">
			<h1 data-i18n="wits" data-i18n-title="wits-description">Wits</h1>
			<div id="attributes-nested">
				<span class="diamond"><input name="attr_wits" value="0" type="number"></span>
				<label data-i18n="parry">Parry</label>
				<span class="diamond-red"><input class="strong" name="attr_witstn" value="0" type="number"></span>
				<label data-i18n="rating">Rating</label>
				<span class="diamond-small-red"><input name="attr_totalparry" value="0" type="number"
						readonly="readonly"></span>
				<label data-i18n="tn-wits">TN (also Wisdom)</label><span />
				<span /><span />
			</div>
		</div>
		<div id="endurance">
			<div id="endurance-nested">
				<span class="diamond-small"><input name="attr_load" value="0" type="number" readonly="readonly"></span>
				<span class="diamond-small"><input name="attr_endurance" value="0" type="number"></span>
				<span class="diamond-small"><input name="attr_fatigue" value="0" type="number"></span>
				<label data-i18n="load">Load</label>
				<label data-i18n="endurance-max">Max</label>
				<label data-i18n="fatigue">Fatigue</label>
			</div>
		</div>
		<div id="hope">
			<div id="hope-nested">
				<span class="diamond-small"><input name="attr_shadow" value="0" type="number"></span>
				<span class="diamond-small"><input name="attr_hope" value="0" type="number"></span>
				<span class="diamond-small"><input name="attr_shadowscar" value="0" type="number"></span>
				<label data-i18n="shadow">Shadow</label>
				<label data-i18n="hope-max">Max</label>
				<label data-i18n="scars">Scars</label>
			</div>
		</div>
		<div id="parry">
			<div id="parry-nested">
				<span class="diamond-small"><input name="attr_parry" value="0" type="number"></span>
				<span class="diamond-small"><input name="attr_shieldparry" value="0" type="number"></span>
				<span class="diamond-small"><input name="attr_otherparry" value="0" type="number"></span>
				<span class="diamond-small"><input name="attr_stanceparry" value="0" type="number"></span>
				<label><input type="checkbox" name="attr_parry_active" value=1 checked="checked">Base</label>
				<label><input type="checkbox" name="attr_shieldparry_active" value=1 checked="checked">Shield</label>
				<label><input type="checkbox" name="attr_otherparry_active" value=1 checked="checked">Other</label>
				<label><input type="checkbox" name="attr_stanceparry_active" value=1 checked="checked">Stance</label>
			</div>
		</div>
		<div id="conditions">
			<h2>Conditions / Modifiers</h2>
			<div id="conditions-nested">
				<label><input name="attr_favorill" type="radio" value="{1t[feat]}" checked="checked">Normal</label>
				<label><input name="attr_favorill" type="radio" value="{2t[feat]}kh1">Favoured</label>
				<label><input name="attr_favorill" type="radio" value="{2t[feat]}kl1">Ill Fav.</label>
				<label><input name="attr_weary" type="checkbox">Weary</label>
				<label><input name="attr_miserable" type="checkbox">Miserable</label>
				<label><input name="attr_wounded" type="checkbox">Wounded</label>
			</div>
			<label>Injury<input name="attr_injury" type="text"></label>
			<br /><br /><br />
			<button type="action" name="act_notestoggle" data-i18n="notes">Notes</button>
		</div>
		<div id="protection">
			<h1 class="bordertop">Protection</h1>
			<div id="protection-nested">
				<label class="left"><input type="checkbox" name="attr_armourprot_active" value=1
						checked="checked">Armour</label>
				<span />
				<label class="right">Helm<input type="checkbox" name="attr_helmprot_active" value=1
						checked="checked"></label>
				<span class="diamond-small"><input name="attr_armourprot" value="0" type="number"></span>
				<span class="diamond-red"><input name="attr_protection" value="0" type="number"
						readonly="readonly"></span>
				<span class="diamond-small"><input name="attr_helmprot" value="0" type="number"></span>
				<span class="diamond-small"><input name="attr_otherprot" value="0" type="number"></span>
				<label><button type="roll"
						value="/me rolls for Protection against Injury TN.\n/roll @{favorill} + (@{protection}+?{Bonus Dice|0})t[@{wearytype}]"
						name="roll_protectioncheck"></button>Total</label>
				<span class="diamond-small"><input name="attr_stanceprot" value="0" type="number"></span>
				<label class="left"><input type="checkbox" name="attr_otherprot_active" value=1
						checked="checked">Other</label>
				<span />
				<label class="right">Stance<input type="checkbox" name="attr_stanceprot_active" value=1
						checked="checked"></label>
			</div>
		</div>
		<div id="skill-strength">
			<h1>&nbsp;</h1>
			<div class=sheet-row>
				<button type="roll" value="@{awe_roll}" name="roll_awecheck"></button>
				<input type="checkbox" name="attr_awe_favoured">
				<label data-i18n="awe">Awe</label>
				<div class="sheet-hover-info" data-i18n="awe-description"></div>
				<div class="sheet-dots">
					<input type="radio" name="attr_awe" value="0" checked="checked" /><span></span>
					<input type="radio" name="attr_awe" value="1" /><span></span>
					<input type="radio" name="attr_awe" value="2" /><span></span>
					<input type="radio" name="attr_awe" value="3" /><span></span>
					<input type="radio" name="attr_awe" value="4" /><span></span>
					<input type="radio" name="attr_awe" value="5" /><span></span>
					<input type="radio" name="attr_awe" value="6" /><span></span>
				</div>
			</div>
			<div class=sheet-row>
				<button type="roll" value="@{athletics_roll}" name="roll_athleticscheck"></button>
				<input type="checkbox" name="attr_athletics_favoured">
				<label data-i18n="athletics">Athletics</label>
				<div class="sheet-hover-info" data-i18n="athletics-description"></div>
				<div class="sheet-dots">
					<input type="radio" name="attr_athletics" value="0" checked="checked" /><span></span>
					<input type="radio" name="attr_athletics" value="1" /><span></span>
					<input type="radio" name="attr_athletics" value="2" /><span></span>
					<input type="radio" name="attr_athletics" value="3" /><span></span>
					<input type="radio" name="attr_athletics" value="4" /><span></span>
					<input type="radio" name="attr_athletics" value="5" /><span></span>
					<input type="radio" name="attr_athletics" value="6" /><span></span>
				</div>
			</div>
			<div class=sheet-row>
				<button type="roll" value="@{awareness_roll}" name="roll_awarenesscheck"></button>
				<input type="checkbox" name="attr_awareness_favoured">
				<label data-i18n="awareness">Awareness</label>
				<div class="sheet-hover-info" data-i18n="awareness-description"></div>
				<div class="sheet-dots">
					<input type="radio" name="attr_awareness" value="0" checked="checked" /><span></span>
					<input type="radio" name="attr_awareness" value="1" /><span></span>
					<input type="radio" name="attr_awareness" value="2" /><span></span>
					<input type="radio" name="attr_awareness" value="3" /><span></span>
					<input type="radio" name="attr_awareness" value="4" /><span></span>
					<input type="radio" name="attr_awareness" value="5" /><span></span>
					<input type="radio" name="attr_awareness" value="6" /><span></span>
				</div>
			</div>
			<div class=sheet-row>
				<button type="roll" value="@{hunting_roll}" name="roll_huntingcheck"></button>
				<input type="checkbox" name="attr_hunting_favoured">
				<label data-i18n="hunting">Hunting</label>
				<div class="sheet-hover-info" data-i18n="hunting-description"></div>
				<div class="sheet-dots">
					<input type="radio" name="attr_hunting" value="0" checked="checked" /><span></span>
					<input type="radio" name="attr_hunting" value="1" /><span></span>
					<input type="radio" name="attr_hunting" value="2" /><span></span>
					<input type="radio" name="attr_hunting" value="3" /><span></span>
					<input type="radio" name="attr_hunting" value="4" /><span></span>
					<input type="radio" name="attr_hunting" value="5" /><span></span>
					<input type="radio" name="attr_hunting" value="6" /><span></span>
				</div>
			</div>
			<div class=sheet-row>
				<button type="roll" value="@{song_roll}" name="roll_songcheck"></button>
				<input type="checkbox" name="attr_song_favoured">
				<label data-i18n="song">Song</label>
				<div class="sheet-hover-info" data-i18n="song-description"></div>
				<div class="sheet-dots">
					<input type="radio" name="attr_song" value="0" checked="checked" /><span></span>
					<input type="radio" name="attr_song" value="1" /><span></span>
					<input type="radio" name="attr_song" value="2" /><span></span>
					<input type="radio" name="attr_song" value="3" /><span></span>
					<input type="radio" name="attr_song" value="4" /><span></span>
					<input type="radio" name="attr_song" value="5" /><span></span>
					<input type="radio" name="attr_song" value="6" /><span></span>
				</div>
			</div>
			<div class=sheet-row>
				<button type="roll" value="@{craft_roll}" name="roll_craftcheck"></button>
				<input type="checkbox" name="attr_craft_favoured">
				<label data-i18n="craft">Craft</label>
				<div class="sheet-hover-info" data-i18n="craft-description"></div>
				<div class="sheet-dots">
					<input type="radio" name="attr_craft" value="0" checked="checked" /><span></span>
					<input type="radio" name="attr_craft" value="1" /><span></span>
					<input type="radio" name="attr_craft" value="2" /><span></span>
					<input type="radio" name="attr_craft" value="3" /><span></span>
					<input type="radio" name="attr_craft" value="4" /><span></span>
					<input type="radio" name="attr_craft" value="5" /><span></span>
					<input type="radio" name="attr_craft" value="6" /><span></span>
				</div>
			</div>
		</div>
		<div id="skill-heart">
			<h1 class="center">Skills</h1>
			<div class=sheet-row>
				<button type="roll" value="@{enhearten_roll}" name="roll_enheartencheck"></button>
				<input type="checkbox" name="attr_enhearten_favoured">
				<label data-i18n="enhearten">Enhearten</label>
				<div class="sheet-hover-info" data-i18n="enhearten-description"></div>
				<div class="sheet-dots">
					<input type="radio" name="attr_enhearten" value="0" checked="checked" /><span></span>
					<input type="radio" name="attr_enhearten" value="1" /><span></span>
					<input type="radio" name="attr_enhearten" value="2" /><span></span>
					<input type="radio" name="attr_enhearten" value="3" /><span></span>
					<input type="radio" name="attr_enhearten" value="4" /><span></span>
					<input type="radio" name="attr_enhearten" value="5" /><span></span>
					<input type="radio" name="attr_enhearten" value="6" /><span></span>
				</div>
			</div>
			<div class=sheet-row>
				<button type="roll" value="@{travel_roll}" name="roll_travelcheck"></button>
				<input type="checkbox" name="attr_travel_favoured">
				<label data-i18n="travel">Travel</label>
				<div class="sheet-hover-info" data-i18n="travel-description"></div>
				<div class="sheet-dots">
					<input type="radio" name="attr_travel" value="0" checked="checked" /><span></span>
					<input type="radio" name="attr_travel" value="1" /><span></span>
					<input type="radio" name="attr_travel" value="2" /><span></span>
					<input type="radio" name="attr_travel" value="3" /><span></span>
					<input type="radio" name="attr_travel" value="4" /><span></span>
					<input type="radio" name="attr_travel" value="5" /><span></span>
					<input type="radio" name="attr_travel" value="6" /><span></span>
				</div>
			</div>
			<div class=sheet-row>
				<button type="roll" value="@{insight_roll}" name="roll_insightcheck"></button>
				<input type="checkbox" name="attr_insight_favoured">
				<label data-i18n="insight">Insight</label>
				<div class="sheet-hover-info" data-i18n="insight-description"></div>
				<div class="sheet-dots">
					<input type="radio" name="attr_insight" value="0" checked="checked" /><span></span>
					<input type="radio" name="attr_insight" value="1" /><span></span>
					<input type="radio" name="attr_insight" value="2" /><span></span>
					<input type="radio" name="attr_insight" value="3" /><span></span>
					<input type="radio" name="attr_insight" value="4" /><span></span>
					<input type="radio" name="attr_insight" value="5" /><span></span>
					<input type="radio" name="attr_insight" value="6" /><span></span>
				</div>
			</div>
			<div class=sheet-row>
				<button type="roll" value="@{healing_roll}" name="roll_healingcheck"></button>
				<input type="checkbox" name="attr_healing_favoured">
				<label data-i18n="healing">Healing</label>
				<div class="sheet-hover-info" data-i18n="healing-description"></div>
				<div class="sheet-dots">
					<input type="radio" name="attr_healing" value="0" checked="checked" /><span></span>
					<input type="radio" name="attr_healing" value="1" /><span></span>
					<input type="radio" name="attr_healing" value="2" /><span></span>
					<input type="radio" name="attr_healing" value="3" /><span></span>
					<input type="radio" name="attr_healing" value="4" /><span></span>
					<input type="radio" name="attr_healing" value="5" /><span></span>
					<input type="radio" name="attr_healing" value="6" /><span></span>
				</div>
			</div>
			<div class=sheet-row>
				<button type="roll" value="@{courtesy_roll}" name="roll_courtesycheck"></button>
				<input type="checkbox" name="attr_courtesy_favoured">
				<label data-i18n="courtesy">Courtesy</label>
				<div class="sheet-hover-info" data-i18n="courtesy-description"></div>
				<div class="sheet-dots">
					<input type="radio" name="attr_courtesy" value="0" checked="checked" /><span></span>
					<input type="radio" name="attr_courtesy" value="1" /><span></span>
					<input type="radio" name="attr_courtesy" value="2" /><span></span>
					<input type="radio" name="attr_courtesy" value="3" /><span></span>
					<input type="radio" name="attr_courtesy" value="4" /><span></span>
					<input type="radio" name="attr_courtesy" value="5" /><span></span>
					<input type="radio" name="attr_courtesy" value="6" /><span></span>
				</div>
			</div>
			<div class=sheet-row>
				<button type="roll" value="@{battle_roll}" name="roll_battlecheck"></button>
				<input type="checkbox" name="attr_battle_favoured">
				<label data-i18n="battle">Battle</label>
				<div class="sheet-hover-info" data-i18n="battle-description"></div>
				<div class="sheet-dots">
					<input type="radio" name="attr_battle" value="0" checked="checked" /><span></span>
					<input type="radio" name="attr_battle" value="1" /><span></span>
					<input type="radio" name="attr_battle" value="2" /><span></span>
					<input type="radio" name="attr_battle" value="3" /><span></span>
					<input type="radio" name="attr_battle" value="4" /><span></span>
					<input type="radio" name="attr_battle" value="5" /><span></span>
					<input type="radio" name="attr_battle" value="6" /><span></span>
				</div>
			</div>
		</div>
		<div id="skill-wits">
			<h1>&nbsp;</h1>
			<div class=sheet-row>
				<button type="roll" value="@{persuade_roll}" name="roll_persuadecheck"></button>
				<input type="checkbox" name="attr_persuade_favoured">
				<label data-i18n="persuade">Persuade</label>
				<div class="sheet-hover-info" data-i18n="persuade-description"></div>
				<div class="sheet-dots">
					<input type="radio" name="attr_persuade" value="0" checked="checked" /><span></span>
					<input type="radio" name="attr_persuade" value="1" /><span></span>
					<input type="radio" name="attr_persuade" value="2" /><span></span>
					<input type="radio" name="attr_persuade" value="3" /><span></span>
					<input type="radio" name="attr_persuade" value="4" /><span></span>
					<input type="radio" name="attr_persuade" value="5" /><span></span>
					<input type="radio" name="attr_persuade" value="6" /><span></span>
				</div>
			</div>
			<div class=sheet-row>
				<button type="roll" value="@{stealth_roll}" name="roll_stealthcheck"></button>
				<input type="checkbox" name="attr_stealth_favoured">
				<label data-i18n="stealth">Stealth</label>
				<div class="sheet-hover-info" data-i18n="stealth-description"></div>
				<div class="sheet-dots">
					<input type="radio" name="attr_stealth" value="0" checked="checked" /><span></span>
					<input type="radio" name="attr_stealth" value="1" /><span></span>
					<input type="radio" name="attr_stealth" value="2" /><span></span>
					<input type="radio" name="attr_stealth" value="3" /><span></span>
					<input type="radio" name="attr_stealth" value="4" /><span></span>
					<input type="radio" name="attr_stealth" value="5" /><span></span>
					<input type="radio" name="attr_stealth" value="6" /><span></span>
				</div>
			</div>
			<div class=sheet-row>
				<button type="roll" value="@{scan_roll}" name="roll_scancheck"></button>
				<input type="checkbox" name="attr_scan_favoured">
				<label data-i18n="scan">Scan</label>
				<div class="sheet-hover-info" data-i18n="scan-description"></div>
				<div class="sheet-dots">
					<input type="radio" name="attr_scan" value="0" checked="checked" /><span></span>
					<input type="radio" name="attr_scan" value="1" /><span></span>
					<input type="radio" name="attr_scan" value="2" /><span></span>
					<input type="radio" name="attr_scan" value="3" /><span></span>
					<input type="radio" name="attr_scan" value="4" /><span></span>
					<input type="radio" name="attr_scan" value="5" /><span></span>
					<input type="radio" name="attr_scan" value="6" /><span></span>
				</div>
			</div>
			<div class=sheet-row>
				<button type="roll" value="@{explore_roll}" name="roll_explorecheck"></button>
				<input type="checkbox" name="attr_explore_favoured">
				<label data-i18n="explore">Explore</label>
				<div class="sheet-hover-info" data-i18n="explore-description"></div>
				<div class="sheet-dots">
					<input type="radio" name="attr_explore" value="0" checked="checked" /><span></span>
					<input type="radio" name="attr_explore" value="1" /><span></span>
					<input type="radio" name="attr_explore" value="2" /><span></span>
					<input type="radio" name="attr_explore" value="3" /><span></span>
					<input type="radio" name="attr_explore" value="4" /><span></span>
					<input type="radio" name="attr_explore" value="5" /><span></span>
					<input type="radio" name="attr_explore" value="6" /><span></span>
				</div>
			</div>
			<div class=sheet-row>
				<button type="roll" value="@{riddle_roll}" name="roll_riddlecheck"></button>
				<input type="checkbox" name="attr_riddle_favoured">
				<label data-i18n="riddle">Riddle</label>
				<div class="sheet-hover-info" data-i18n="riddle-description"></div>
				<div class="sheet-dots">
					<input type="radio" name="attr_riddle" value="0" checked="checked" /><span></span>
					<input type="radio" name="attr_riddle" value="1" /><span></span>
					<input type="radio" name="attr_riddle" value="2" /><span></span>
					<input type="radio" name="attr_riddle" value="3" /><span></span>
					<input type="radio" name="attr_riddle" value="4" /><span></span>
					<input type="radio" name="attr_riddle" value="5" /><span></span>
					<input type="radio" name="attr_riddle" value="6" /><span></span>
				</div>
			</div>
			<div class=sheet-row>
				<button type="roll" value="@{lore_roll}" name="roll_lorecheck"></button>
				<input type="checkbox" name="attr_lore_favoured">
				<label data-i18n="lore">Lore</label>
				<div class="sheet-hover-info" data-i18n="lore-description"></div>
				<div class="sheet-dots">
					<input type="radio" name="attr_lore" value="0" checked="checked" /><span></span>
					<input type="radio" name="attr_lore" value="1" /><span></span>
					<input type="radio" name="attr_lore" value="2" /><span></span>
					<input type="radio" name="attr_lore" value="3" /><span></span>
					<input type="radio" name="attr_lore" value="4" /><span></span>
					<input type="radio" name="attr_lore" value="5" /><span></span>
					<input type="radio" name="attr_lore" value="6" /><span></span>
				</div>
			</div>
		</div>
		<div id="proficiencies">
			<h1 class="center bordertop" data-i18n="combat">Combat</h1>
			<div class="sheet-row">
				<input type="hidden" name="attr_axes_roll1"/>
				<button type="roll" name="roll_axescheck1" value="@{axes_roll1}"></button>
				<input type="hidden" name="attr_axes_roll2"/>
				<button type="roll" name="roll_axescheck2" value="@{axes_roll2}"></button>
				<label data-i18n="axes">Axes</label>
				<div class="sheet-hover-info" data-i18n="axes-description"></div>
				<div class="sheet-dots">
					<input type="radio" name="attr_axes" value="0" checked="checked" /><span></span>
					<input type="radio" name="attr_axes" value="1" /><span></span>
					<input type="radio" name="attr_axes" value="2" /><span></span>
					<input type="radio" name="attr_axes" value="3" /><span></span>
					<input type="radio" name="attr_axes" value="4" /><span></span>
					<input type="radio" name="attr_axes" value="5" /><span></span>
					<input type="radio" name="attr_axes" value="6" /><span></span>
				</div>
			</div>

			<div class="sheet-row">
				<input type="hidden" name="attr_bows_roll1"/>
				<button type="roll" name="roll_bowscheck1" value="@{bows_roll1}"></button>
				<input type="hidden" name="attr_bows_roll2"/>
				<button type="roll" name="roll_bowscheck2" value="@{bows_roll2}"></button>
				<label data-i18n="bows">Bows</label>
				<div class="sheet-hover-info" data-i18n="bows-description"></div>
				<div class="sheet-dots">
					<input type="radio" name="attr_bows" value="0" checked="checked" /><span></span>
					<input type="radio" name="attr_bows" value="1" /><span></span>
					<input type="radio" name="attr_bows" value="2" /><span></span>
					<input type="radio" name="attr_bows" value="3" /><span></span>
					<input type="radio" name="attr_bows" value="4" /><span></span>
					<input type="radio" name="attr_bows" value="5" /><span></span>
					<input type="radio" name="attr_bows" value="6" /><span></span>
				</div>
			</div>

			<div class="sheet-row">
				<input type="hidden" name="attr_spears_roll1"/>
				<button type="roll" name="roll_spearscheck1" value="@{spears_roll1}"></button>
				<input type="hidden" name="attr_spears_roll2"/>
				<button type="roll" name="roll_spearscheck2" value="@{spears_roll2}"></button>
				<label data-i18n="spears">Spears</label>
				<div class="sheet-hover-info" data-i18n="spears-description"></div>
				<div class="sheet-dots">
					<input type="radio" name="attr_spears" value="0" checked="checked" /><span></span>
					<input type="radio" name="attr_spears" value="1" /><span></span>
					<input type="radio" name="attr_spears" value="2" /><span></span>
					<input type="radio" name="attr_spears" value="3" /><span></span>
					<input type="radio" name="attr_spears" value="4" /><span></span>
					<input type="radio" name="attr_spears" value="5" /><span></span>
					<input type="radio" name="attr_spears" value="6" /><span></span>
				</div>
			</div>

			<div class="sheet-row">
				<input type="hidden" name="attr_swords_roll1"/>
				<button type="roll" name="roll_swordscheck1" value="@{swords_roll1}"></button>
				<input type="hidden" name="attr_swords_roll2"/>
				<button type="roll" name="roll_swordscheck2" value="@{swords_roll2}"></button>
				<label data-i18n="swords">Swords</label>
				<div class="sheet-hover-info" data-i18n="swords-description"></div>
				<div class="sheet-dots">
					<input type="radio" name="attr_swords" value="0" checked="checked" /><span></span>
					<input type="radio" name="attr_swords" value="1" /><span></span>
					<input type="radio" name="attr_swords" value="2" /><span></span>
					<input type="radio" name="attr_swords" value="3" /><span></span>
					<input type="radio" name="attr_swords" value="4" /><span></span>
					<input type="radio" name="attr_swords" value="5" /><span></span>
					<input type="radio" name="attr_swords" value="6" /><span></span>
				</div>
			</div>
			<div class="center">
				<h3>Stance</h3>
				<label><input name="attr_stance" type="radio" value="Forward"> Forw.</label>
				<label><input name="attr_stance" type="radio" value="Open" checked="checked"> Open</label>
				<label><input name="attr_stance" type="radio" value="Defensive"> Def.</label>
				<label><input name="attr_stance" type="radio" value="Rearward"> Rear</label>
			</div>
			<div class="sheet-row">
				<div class="center">
					<label><input name="attr_stanceattack_active" type="checkbox" value="1">Stance</label>
					<label>Attack:</label><input name="attr_stanceattackbonus" value="0" type="number">
					<label>Damage:</label><input name="attr_stancedamagebonus" value="1" type="number">
				</div>
			</div>
		</div>
		<div id="armour">
			<!-- <h2>Armour</h2> -->
			<div id="armour-nested">
				<span /><span /><span /><span /><span /><span /><span />
				<label>Armour</label>
				<input class="text" type="text" name="attr_armour">
				<label>Protection</label>
				<input class="center number" type="number" name="attr_armourprot" value="0">
				<label>Load</label>
				<input class="center number" type="number" name="attr_armourload" value="0">
				<span />
				<label>Helm</label>
				<input class="text" type="text" name="attr_helm">
				<label>Protection</label>
				<input class="center number" type="number" name="attr_helmprot" value="0">
				<label>Load</label>
				<input class="center number" type="number" name="attr_helmload" value="0">
				<span />
				<label>Shield</label>
				<input class="text" type="text" name="attr_shield">
				<label>Parry</label>
				<input class="center number" type="number" name="attr_shieldparry" value="0">
				<label>Load</label>
				<input class="center number" type="number" name="attr_shieldload" value="0">
				<span />
				<label>Mount</label>
				<input class="text" type="text" name="attr_mount">
				<label>Quality</label>
				<input class="center number" type="number" name="attr_mountquality" value="0">
				<label>Vigour</label>
				<input class="center number" type="number" name="attr_mountvigour" value="0">
				<span />
			</div>
		</div>
		<div id="war-gear">
			<!-- <h2>War Gear</h2> -->
			<div id="war-gear-nested">
				<label>Weapon</label>
				<label class="center">Damage</label>
				<label class="center">Injury</label>
				<label class="center">Load</label>
				<label>Notes</label>
				<input name="attr_weapon_skill_name_1" type="text">
				<input name="attr_weapon_damage_1" value="0" class="center number" type="number">
				<input name="attr_weapon_injury_1" value="0" class="center number" type="number">
				<input name="attr_weapon_load_1" value="0" class="center number" type="number">
				<input name="attr_weapon_note_1" type="text">
				<input name="attr_weapon_skill_name_2" type="text">
				<input name="attr_weapon_damage_2" value="0" class="center number" type="number">
				<input name="attr_weapon_injury_2" value="0" class="center number" type="number">
				<input name="attr_weapon_load_2" value="0" class="center number" type="number">
				<input name="attr_weapon_note_2" type="text">
				<input name="attr_weapon_skill_name_3" type="text">
				<input name="attr_weapon_damage_3" value="0" class="center number" type="number">
				<input name="attr_weapon_injury_3" value="0" class="center number" type="number">
				<input name="attr_weapon_load_3" value="0" class="center number" type="number">
				<input name="attr_weapon_note_3" type="text">
				<input name="attr_weapon_skill_name_4" type="text">
				<input name="attr_weapon_damage_4" value="0" class="center number" type="number">
				<input name="attr_weapon_injury_4" value="0" class="center number" type="number">
				<input name="attr_weapon_load_4" value="0" class="center number" type="number">
				<input name="attr_weapon_note_4" type="text">
			</div>
		</div>
		<input type="hidden" class="sheet-notestoggle" name="attr_notesactive" />
		<div id="notes">
			<h1>NOTES</h1>
			<textarea name="attr_notes" />
		</div>
	</div>
</div>
<div class="sheet-adversary">
	<div class="sheet-adversary-header">
		<h1 class="left" data-i18n="character-name">Name</h1>
		<h1 data-i18n="attribute-level">Attribute Level</h1>
		<input type="text" name="attr_character-name" value="" />
		<div class="diamond-red"><input class="center" type="number" name="attr_attribute-level" value="0" />
		</div>
		<label data-i18n="distinctive-features">Distinctive Features</label><span />
		<input type="text" name="attr_distinctive-features" />
	</div>
	<br />
	<div class="sheet-adversary-attributes">
		<span />
		<h1 data-i18n="endurance">Endurance</h1>
		<h1 data-i18n="might">Might</h1>
		<h1 data-i18n="hate">Hate</h1>
		<h1 data-i18n="parry">Parry</h1>
		<h1 data-i18n="armour">
			Armour</h1>
		<span />
		<span />
		<div class="diamond-red"><input type="number" name="attr_endurance" /></div>
		<div class="diamond-red"><input type="number" name="attr_might" /></div>
		<div class="diamond-red"><input type="number" name="attr_hate" /></div>
		<div class="diamond-red"><input type="number" name="attr_parry" /></div>
		<div class="diamond-red"><input type="number" name="attr_armour" /></div>
		<span />
		<span />
		<span />
		<span />
		<span />
		<span />
		<button type="roll" value="/me rolls protection against ?{Injury|16}.\n/roll 1t[lm-feat] + @{armour}t[normal]"
			name="armourcheck"></button>
		<span />
	</div>
	<div class="sheet-combat-proficiencies">
		<h1 data-i18n-title="combat-proficiency" title="combat-proficiency">Combat Proficiency</h1>
		<label class="center" data-i18n-title="weapon-rating" title="dmg">Rating</label>
		<label class="center" data-i18n-title="weapon-damage" title="dmg">Damage</label>
		<label class="center" data-i18n-title="weapon-injury" title="inj">Injury</label>
		<label class="left" data-i18n-title="special-damage" title="special-damage">Special damage</label>
		<span>
			<button type="roll"
				value="/me attacks target against parry @{target|totalparry}.\n/roll 1t[lm-feat] + [[(@{weapon_rating_1}+?{Bonus Dice|0})]]t[normal]"
				name="roll_weapon1"></button>
			<input name="attr_weapon_skill_name_1" type="text">
		</span>
		<input name="attr_weapon_rating_1" value="0" class="number" type="number">
		<input name="attr_weapon_damage_1" value="0" class="number" type="number">
		<input name="attr_weapon_injury_1" value="0" class="number" type="number">
		<input name="attr_weapon_special_damage_1" type="text">
		<span>
			<button type="roll"
				value="/me attacks target against parry @{target|totalparry}.\n/roll 1t[lm-feat] + [[(@{weapon_rating_2}+?{Bonus Dice|0})]]t[normal]"
				name="roll_weapon1"></button>
			<input name="attr_weapon_skill_name_2" type="text">
		</span>
		<input name="attr_weapon_rating_2" value="0" class="number" type="number">
		<input name="attr_weapon_damage_2" value="0" class="number" type="number">
		<input name="attr_weapon_injury_2" value="0" class="number" type="number">
		<input name="attr_weapon_special_damage_2" type="text">
	</div>
	<br />
	<div class="sheet-fell-abilities">
		<h1 data-i18n-title="fell-ability" title="fell-ability">Fell Ability</h1>
		<label class="empf-black left" data-i18n-title="fell-ability-description"
			title="fell-ability-description">Description</label>
		<input name="attr_fell_ability_1" type="text" /><textarea name="attr_fell_ability_desc1" type="text" />
		<input name="attr_fell_ability_2" type="text" /><textarea name="attr_fell_ability_desc2" type="text" />
		<input name="attr_fell_ability_3" type="text" /><textarea name="attr_fell_ability_desc3" type="text" />
		<input name="attr_fell_ability_4" type="text" /><textarea name="attr_fell_ability_desc4" type="text" />
	</div>
	<div class="sheet-colrow sheet-left">
		<h2>Notes</h2>
		<div class=sheet-row>
			<textarea name="attr_notes" style="width:100%;" />
		</div>
	</div>
</div>
<div class="center">
	<button type="action" name="act_isPC" data-i18n="sheet-type-Player-Character">Player Character</button>
	<button type="action" name="act_isAdversary" data-i18n="sheet-type-Adversary">Adversary</button>
	<br />
	<h6>Version <span name="attr_version"></span></h6>
</div>
<div style="display: none;">
	<input name="attr_wearytype">
	<input name="attr_awe_fav">
	<input name="attr_athletics_fav">
	<input name="attr_awareness_fav">
	<input name="attr_hunting_fav">
	<input name="attr_song_fav">
	<input name="attr_craft_fav">
	<input name="attr_enhearten_fav">
	<input name="attr_travel_fav">
	<input name="attr_insight_fav">
	<input name="attr_healing_fav">
	<input name="attr_courtesy_fav">
	<input name="attr_battle_fav">
	<input name="attr_persuade_fav">
	<input name="attr_stealth_fav">
	<input name="attr_scan_fav">
	<input name="attr_explore_fav">
	<input name="attr_riddle_fav">
	<input name="attr_lore_fav">
	<input name="attr_valour_fav">
	<input name="attr_wisdom_fav">
	<input name="attr_awe_favill">
	<input name="attr_athletics_favill">
	<input name="attr_awareness_favill">
	<input name="attr_hunting_favill">
	<input name="attr_song_favill">
	<input name="attr_craft_favill">
	<input name="attr_enhearten_favill">
	<input name="attr_travel_favill">
	<input name="attr_insight_favill">
	<input name="attr_healing_favill">
	<input name="attr_courtesy_favill">
	<input name="attr_battle_favill">
	<input name="attr_persuade_favill">
	<input name="attr_stealth_favill">
	<input name="attr_scan_favill">
	<input name="attr_explore_favill">
	<input name="attr_riddle_favill">
	<input name="attr_lore_favill">
	<input name="attr_valour_favill">
	<input name="attr_wisdom_favill">
</div>
<!-- Sheet Workers -->
<script type="text/worker">
	const buttonlist = ["isPC","isAdversary"];
	buttonlist.forEach(button => {
		console.log(button);
		on(`clicked:${button}`, function() {
			console.log("Toggle charsheet: " + button);
			setAttrs({
				sheetTab: button,
			});
		});
	});
	// toggle notes area visibility
	on( "clicked:notestoggle", function(){
		getAttrs(["notesactive"], function(values){
			let state = parseInt(values.notesactive,10)||0;
			let newstate = 1-state; // xor
			setAttrs({notesactive:newstate});
			console.log("Toggle notes state: " + newstate);
		});
	});
	
	// calc total load on change events for weapons, armour and treasure
	on( "change:weapon_load_1 change:weapon_load_2 change:weapon_load_3 change:weapon_load_4 change:weapon_load_5 change:weapon_load_6 " + 
		"change:armourload change:helmload change:shieldload change:treasureload " + 
		"change:fatigue change:load sheet:opened", function() {
		getAttrs(["weapon_load_1","weapon_load_2","weapon_load_3","weapon_load_4","weapon_load_5","weapon_load_6",
					"armourload","shieldload","helmload","fatigue","treasureload"], function(values) {
			let weaponload1 = parseInt(values.weapon_load_1,10)||0;
			let weaponload2 = parseInt(values.weapon_load_2,10)||0;
			let weaponload3 = parseInt(values.weapon_load_3,10)||0;
			let weaponload4 = parseInt(values.weapon_load_4,10)||0;
			// the 2e sheet supports only 4 weapons by now, we include the rest for compatability - todo: remove
			let weaponload5 = parseInt(values.weapon_load_5,10)||0;
			let weaponload6 = parseInt(values.weapon_load_6,10)||0;
			let armourload = parseInt(values.armourload,10)||0;
			let shieldload = parseInt(values.shieldload,10)||0;
			let helmload = parseInt(values.helmload,10)||0;
			let fatigue = parseInt(values.fatigue,10)||0;
			let treasureload = parseInt(values.treasureload,10)||0;
			let loadtotal = weaponload1 + weaponload2 + weaponload3 + weaponload4 + weaponload5 + weaponload6 + 
							armourload + shieldload + helmload + treasureload + fatigue;
			setAttrs({
				load: loadtotal,
			});
		});
	});
	// calc total protection on change events for the checkboxes and values
	on( "change:armourprot_active change:helmprot_active change:otherprot_active change:stanceprot_active " +
		"change:armourprot change:helmprot change:otherprot change:stanceprot " +
		"change:protection sheet:opened", function() {
		getAttrs(["armourprot", "helmprot", "stanceprot", "otherprot",
					"armourprot_active", "helmprot_active", "stanceprot_active", "otherprot_active"], function(values) {
			let armourprot = (values.armourprot_active == 1) ? parseInt(values.armourprot,10)||0 : 0;
			let helmprot = (values.helmprot_active == 1) ? parseInt(values.helmprot,10)||0 : 0;	
			let otherprot = (values.otherprot_active == 1) ? parseInt(values.otherprot,10)||0 : 0;	
			let stanceprot = (values.stanceprot_active == 1) ? parseInt(values.stanceprot,10)||0 : 0;
			let protectiontotal = armourprot + helmprot + otherprot + stanceprot;
			setAttrs({
				protection: protectiontotal,
			});
			console.log("Updated protection to " + protectiontotal);
		});
	});

	// calc total parry on change events for the check boxes and values
	on( "change:parry_active change:shieldparry_active change:otherparry_active change:stanceparry_active " +
		"change:parry change:shieldparry change:otherparry change:stanceparry " +
		"change:totalparry sheet:opened", function() {
		getAttrs(["parry", "shieldparry", "stanceparry", "otherparry",
					"parry_active", "shieldparry_active", "stanceparry_active", "otherparry_active"], function(values) {
			let parry = (values.parry_active == 1) ? parseInt(values.parry,10)||0 : 0;
			let shieldparry = (values.shieldparry_active == 1) ? parseInt(values.shieldparry,10)||0 : 0;	
			let stanceparry = (values.stanceparry_active == 1) ? parseInt(values.stanceparry,10)||0 : 0;	
			let otherparry = (values.otherparry_active == 1) ? parseInt(values.otherparry,10)||0 : 0;
			let parrytotal = parry + shieldparry + stanceparry + otherparry;
			setAttrs({
				totalparry: parrytotal,
			});
			console.log("Updated total parry to " + parrytotal 
				+ " - parry: " + parry + " - shieldparry: " + shieldparry 
				+ " - stanceparry: " + stanceparry + " - otherparry: " + otherparry);
		});
	});

	// automatic stance toggle of parry (open stance) and protection (defensive)
	on( "change:stance sheet:opened", function() {
		getAttrs(["stance"], function(values) {
			let attr = new Map([
				["stanceparry_active", 0],
				["stanceprot_active", 0],
				["stanceattack_active", 0]
			]);
			
			if (values.stance === "Forward"){
				console.log("Handle forward stance toggle");
				attr.set("stanceattack_active", 1);
			} else if (values.stance === "Open"){
				console.log("Handle open stance toggle");
				attr.set("stanceparry_active", 1);
			} else if (values.stance === "Defensive"){
				console.log("Handle defensive stance toggle");
				attr.set("stanceprot_active", 1);
			} else if (values.stance === "Rear"){
				console.log("Handle rearward stance toggle");
			}
			setAttrs({
				stanceparry_active: attr.get("stanceparry_active"),
				stanceprot_active: attr.get("stanceprot_active"),
				stanceattack_active: attr.get("stanceattack_active")
			})
		});
	});

	on("change:weary sheet:opened", function() {
		getAttrs(["weary"], function(values) {
			let weary = values.weary||0;
			if (weary == 0) {
				wearytype = "normal";
			}
			else {
				wearytype = "weary";
			}

			setAttrs({
				wearytype: wearytype,
			});
		});
	});

	// This sheet worker will derive the correct normal / favoured / illfavoured rolls based on the 
	// global favoured status and the attribute specific favoured status	
	let attrmap = new Map([
		["strength", ["awe","athletics", "awareness", "hunting", "song", "craft"]],
		["heart", ["enhearten", "travel", "insight", "healing", "courtesy", "battle","valour"]],
		["wits", ["persuade", "stealth", "scan", "explore", "riddle", "lore","wisdom"]]
	]);
	attrmap.forEach((skillList, attr, attrmap) => {
		let attrcapitalized = attr.replace(/^\w/, (c) => c.toUpperCase()); // first letter
		skillList.forEach(skill => {
			let skillfav = `${skill}_favoured`;
			let skillcapitalized = skill.replace(/^\w/, (c) => c.toUpperCase()); // first letter
			on(`change:${skillfav} change:favorill sheet:opened`, function() {
				getAttrs([`${skillfav}`,"favorill"], function(values) {
					// get attribute favoured state, 0 if unset
					let faved = values[`${skillfav}`]||0;
					// convert checked state to 1
					let favattr = (faved == 0) ? 0 : 1;
					// get global favoured/illfavoured state, "normal" if unset
					let favorill = values.favorill ||"{1t[feat]}";
					// favoured / illfavoured states can negate each other
					// 2*favoured stays a simple favoured roll
					let favorill_result = favattr;
					if (favorill === "{2t[feat]}kh1"){
						favorill_result = favorill_result + 1;
					} else if (favorill === "{2t[feat]}kl1"){
						favorill_result = favorill_result - 1;
					}
					// derive resulting roll expression. we calculate the complete expression at this central location
					// to make easy maintenance later when this needs to be changed
					let favorill_roll = "{1t[feat]}";
					if (favorill_result >= 1){
						favorill_roll = "{2t[feat]}kh1";
					} else if (favorill_result <= -1) {
						favorill_roll = "{2t[feat]}kl1";
					}
					let roll = 
						`/me rolls for ${skillcapitalized} against ${attrcapitalized} TN (@{${attr}tn}).\n`
						+ `/roll ${favorill_roll} + (@{${skill}}+?{Bonus Dice|0})t[@{wearytype}] `; 
					setAttrs({
						[`${skill}_roll`]: roll,
					});
				});
			});
		});
	});

	// update battle rolls to reflect the active stance attack bonus 
	const battleattrs = ["axes", "bows", "spears", "swords"]; 
	on(`change:stanceattack_active sheet:opened`, function() {
		getAttrs(["stanceattack_active"], function(values) {
			let stanceattack_active = values.stanceattack_active ||0;
			battleattrs.forEach(battleattr => {
				let battleattrcapitalized = battleattr.replace(/^\w/, (c) => c.toUpperCase()); // first letter
				// convert checked state to 0/1 bonus
				let stanceattackbonus = (stanceattack_active == 0) ? "" : "+ @{stanceattackbonus} ";
				let roll1 = 
					`/me rolls for ${battleattrcapitalized} against Strength TN (@{strengthtn}).\n`
					+ `/roll @{favorill} + (@{${battleattr}} ${stanceattackbonus} + ?{Bonus Dice|0})t[@{wearytype}]`;
				let roll2 = 
					`/me rolls for ${battleattrcapitalized} against Strength TN (@{strengthtn}) - target's parry (@{target|totalparry}).\n`
					+ `/roll @{favorill} + (@{${battleattr}} ${stanceattackbonus} + ?{Bonus Dice|0})t[@{wearytype}] - @{target|totalparry}`;
				setAttrs({
					[`${battleattr}_roll1`]: roll1,
					[`${battleattr}_roll2`]: roll2,
				});
			});
		});
	});

	// Migration scripts. 
	on("sheet:opened", function() {
		getAttrs(["build", "version", "sheettab"], function(v) {
			const build = parseInt(v.build) || 0;
			var attrs = {};
			console.log("Current version: " + v.version);
			// get attribute updates for each version until the sheet has completed all steps
			// NOTE: to maintain backwards compatibility with sheets predating the version attribute, all steps will be performed for new sheets
			if (build < 1) {
				// Version 01.00.00
				console.log("Migration 01.00.00")
				attrs["build"] = 1;
				if (v.sheettab === "isPC"){
					getAttrs(["treaure"], function(values){
						let treaure = parseInt(values.treaure) || 0;
						attrs["treasure"] = treaure;
					});
				}
			}
			
			/*
			* if (build < 2) {
			*     attrs["build"] = 2;
			* }
			*/

			if (Object.keys(attrs).length) {
				setAttrs(attrs);
			}
		});
	});	
</script>
<rolltemplate class="sheet-rolltemplate-standard">
	<div class="sheet=pc">
		<div class="sheet-main">{{skill}}</div>
		{{#rollTotal() favorill 1}}
		<div class="sheet-main">stand {{standard}}</div>
		{{/rollTotal() favorill 1}}
		{{#rollTotal() favorill 2}}
		<div class="sheet-main">fav {{fav}}</div>
		{{/rollTotal() favorill 2}}
		{{#rollTotal() favorill 3}}
		<div class="sheet-main">ill {{ill}}</div>
		{{/rollTotal() favorill 3}}
	</div>
</rolltemplate>